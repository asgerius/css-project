[{"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 7, "last_activity_date": 1447892709, "last_edit_date": 1447892709, "creation_date": 1447891694, "answer_id": 33792973, "question_id": 33792545, "link": "https://stackoverflow.com/questions/33792545/convert-yyyymmdd-string-to-a-valid-date-in-go/33792973#33792973", "title": "convert YYYYMMDD string to a valid date in Go", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"noreferrer\">Package time</a></p>\n\n<pre><code>import \"time\" \n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"noreferrer\">Constants</a></p>\n\n<pre><code>const (\n        ANSIC       = \"Mon Jan _2 15:04:05 2006\"\n        UnixDate    = \"Mon Jan _2 15:04:05 MST 2006\"\n        RubyDate    = \"Mon Jan 02 15:04:05 -0700 2006\"\n        RFC822      = \"02 Jan 06 15:04 MST\"\n        RFC822Z     = \"02 Jan 06 15:04 -0700\" // RFC822 with numeric zone\n        RFC850      = \"Monday, 02-Jan-06 15:04:05 MST\"\n        RFC1123     = \"Mon, 02 Jan 2006 15:04:05 MST\"\n        RFC1123Z    = \"Mon, 02 Jan 2006 15:04:05 -0700\" // RFC1123 with numeric zone\n        RFC3339     = \"2006-01-02T15:04:05Z07:00\"\n        RFC3339Nano = \"2006-01-02T15:04:05.999999999Z07:00\"\n        Kitchen     = \"3:04PM\"\n        // Handy time stamps.\n        Stamp      = \"Jan _2 15:04:05\"\n        StampMilli = \"Jan _2 15:04:05.000\"\n        StampMicro = \"Jan _2 15:04:05.000000\"\n        StampNano  = \"Jan _2 15:04:05.000000000\"\n)\n</code></pre>\n  \n  <p>These are predefined layouts for use in Time.Format and Time.Parse.\n  The reference time used in the layouts is the specific time:</p>\n  \n  <p><code>Mon Jan 2 15:04:05 MST 2006</code></p>\n  \n  <p>which is Unix time 1136239445. Since MST is GMT-0700, the reference\n  time can be thought of as</p>\n\n<pre><code>01/02 03:04:05PM '06 -0700\n</code></pre>\n  \n  <p>To define your own format, write down what the reference time would\n  look like formatted your way; see the values of constants like ANSIC,\n  StampMicro or Kitchen for examples. The model is to demonstrate what\n  the reference time looks like so that the Format and Parse methods can\n  apply the same transformation to a general time value.</p>\n</blockquote>\n\n<p>Use the <code>time</code> format string <code>\"20060102\"</code> for <code>YYYYMMDD</code>. Use the <code>time</code> format string <code>\"2006-01-02\"</code> for <code>YYYY-MM-DD</code>.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    now := time.Now()\n    fmt.Println(now)\n    date := now.Format(\"20060102\")\n    fmt.Println(date)\n    date = now.Format(\"2006-01-02\")\n    fmt.Println(date)\n    date2, err := time.Parse(\"20060102\", \"20101011\")\n    if err == nil {\n        fmt.Println(date2)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2009-11-10 23:00:00 +0000 UTC\n20091110\n2009-11-10\n2010-10-11 00:00:00 +0000 UTC\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4298326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqQ94.jpg?s=128&g=1", "display_name": "Angel Motta", "link": "https://stackoverflow.com/users/4298326/angel-motta"}, "is_accepted": false, "score": 0, "last_activity_date": 1617023133, "creation_date": 1617023133, "answer_id": 66854756, "question_id": 33792545, "link": "https://stackoverflow.com/questions/33792545/convert-yyyymmdd-string-to-a-valid-date-in-go/66854756#66854756", "title": "convert YYYYMMDD string to a valid date in Go", "body": "<p>You can do the following:</p>\n<pre><code>dateStr := &quot;20210131&quot;                           // date in 'String' data type\ndateValue, _ := time.Parse(&quot;20060102&quot;, dateStr) // convert 'String' to 'Time' data type\nfmt.Println(dateValue)                          // output: 2021-01-31 00:00:00 +0000 UTC\ndateStr = dateValue.Format(&quot;2006-01-02&quot;)       // Format return a 'string' in your specified layout (YYYY-MM-DD)\nfmt.Println(dateStr)                           // Output: 2021-01-31\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 342673, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d9eed3c78b235158827600837a170f6e?s=128&d=identicon&r=PG", "display_name": "user342673", "link": "https://stackoverflow.com/users/342673/user342673"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7169, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1617023133, "creation_date": 1447889453, "last_edit_date": 1447893038, "question_id": 33792545, "link": "https://stackoverflow.com/questions/33792545/convert-yyyymmdd-string-to-a-valid-date-in-go", "title": "convert YYYYMMDD string to a valid date in Go", "body": "<p>I want to convert a string <code>\"20101011\"</code> to a valid date (<code>2010-10-11</code>), but could not figure our how to do it.  </p>\n\n<p>I tried:</p>\n\n<pre><code>now := time.Now()\ndate := now.Format(\"20101011\")\n</code></pre>\n\n<p>and</p>\n\n<pre><code>date, _ := time.Parse(\"20101011\", \"20101011\")\n</code></pre>\n\n<p>neither one worked. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 3, "creation_date": 1447886883, "post_id": 33791874, "comment_id": 55350933, "body": "Is there a reason why you don&#39;t just export <code>structThing</code>? I&#39;m not entirely sure how to answer your question but I don&#39;t think what you&#39;re proposing is very sound. Your scoping is just incongruous. In the containing package you&#39;re exporting a method to return a type which you don&#39;t export. The two things are inherently coupled and therefor should have the same exported vs unexported status imo. While you may be able to work around this and do something more like what you&#39;re describing I think you&#39;d save yourself a lot of trouble by just exporting <code>structThing</code>."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447887009, "post_id": 33791874, "comment_id": 55350973, "body": "@evanmcdonnal it&#39;s mainly created through a function to avoid unintentionally setting the wrong properties on the struct which should only be done by the package it&#39;s self. But I might have to just export it I guess. Thanks."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447887323, "post_id": 33791874, "comment_id": 55351079, "body": "One idea to work around that (and I haven&#39;t tested this concept so that&#39;s on you) would be to take the properties you don&#39;t want people touching, move them to another struct, embed that in <code>structThing</code> and don&#39;t export just that field. In <code>NewCS</code>&#39; calling scope people can have the object with no problems, they just won&#39;t see those properties. Provide a method to return their values if they need to be accessed. If that idea doesn&#39;t work you could use the same concept but do it on a field by field basis."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447887366, "post_id": 33791874, "comment_id": 55351099, "body": "@evanmcdonnal thanks I might just try that instead."}], "answers": [{"tags": [], "owner": {"reputation": 9371, "user_id": 196964, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/df6zG.jpg?s=128&g=1", "display_name": "Doug Richardson", "link": "https://stackoverflow.com/users/196964/doug-richardson"}, "is_accepted": true, "score": 5, "last_activity_date": 1447887391, "creation_date": 1447887391, "answer_id": 33792084, "question_id": 33791874, "link": "https://stackoverflow.com/questions/33791874/go-how-can-i-create-a-global-variable-to-hold-anything/33792084#33792084", "title": "Go: How can I create a global variable to hold anything?", "body": "<p>You can store it in an variable typed as an <code>interface{}</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype structThing struct {\n    x int\n}\n\nfunc NewCS() *structThing {\n    return &amp;structThing{x: 1}\n}\n\nvar cs interface{}\n\nfunc main() {\n    fmt.Println(\"cs is\", cs)\n    cs = NewCS()\n    fmt.Println(\"cs is now\", cs)\n}\n</code></pre>\n\n<p>Which prints:</p>\n\n<pre><code>cs is &lt;nil&gt;\ncs is now &amp;{1}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ZW_6FRfDvE\">https://play.golang.org/p/ZW_6FRfDvE</a></p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 33792084, "answer_count": 1, "score": 0, "last_activity_date": 1447887391, "creation_date": 1447886570, "question_id": 33791874, "link": "https://stackoverflow.com/questions/33791874/go-how-can-i-create-a-global-variable-to-hold-anything", "title": "Go: How can I create a global variable to hold anything?", "body": "<p>I'm curious on how to create a global variable that can be assigned to be anything when the chance comes, here's my scenario:</p>\n\n<p>I have to wait for an event that emits from a server that sends a populated struct, and I want to assign that to a variable the struct is created with:</p>\n\n<pre><code>func NewCS(client *thing.Thing) *structThing {\n\n}\n</code></pre>\n\n<p>But the <code>*structThing</code> is not exported so I can't do</p>\n\n<pre><code>var cs *structThing\n\n// Event finally ready\ncs = NewCS(eventData)\n</code></pre>\n\n<p>because I get the error that <code>*structThing</code> is not exported.</p>\n\n<p>So how else can I make <code>cs</code> a global variable?</p>\n"}, {"tags": ["python", "json", "go", "timestamp"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1447884865, "post_id": 33791172, "comment_id": 55350052, "body": "The time class requires a format string, in your case it would be <code>2006-01-02 15:04:05-0700</code>. I believe you can&#39;t supply that to the unmashaller directly so you have to implement <code>UnmarshalJSON</code> for your type to deal with it there or unmarshal into a string and convert it later. More on the format string stuff here; <a href=\"http://stackoverflow.com/questions/25845172/parsing-date-string-in-golang\" title=\"parsing date string in golang\">stackoverflow.com/questions/25845172/&hellip;</a> and here&#39;s an example implement MarshalJSON, what you&#39;ll need to do is similar, just for unmarshalling <a href=\"http://stackoverflow.com/questions/20475321/override-the-layout-used-by-json-marshal-to-format-time-time\" title=\"override the layout used by json marshal to format time time\">stackoverflow.com/questions/20475321/&hellip;</a>"}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447885408, "post_id": 33791172, "comment_id": 55350312, "body": "@evanmcdonnal Thanks for the comment, this has gotten me really close but I am still getting an error I am unsure about. See most recent edit"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447886069, "post_id": 33791172, "comment_id": 55350599, "body": "I&#39;m not sure how to help you on that one. I did a quick test here <a href=\"https://play.golang.org/p/fZ7soeHJhj\" rel=\"nofollow noreferrer\">play.golang.org/p/fZ7soeHJhj</a> and it should work. I generally suggest printing/inspecting the value of <code>string(b)</code> here cause the formats aren&#39;t matching for some reason however the error makes it seem like <code>string(b)</code> is producing the expected value."}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447888243, "post_id": 33791172, "comment_id": 55351460, "body": "Ok I got it working, but I needed to modify the library I was using to do so. I don&#39;t think that is right and should be able to make them think my struct IS a <code>time.Time</code> type. Is that possible?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447890770, "post_id": 33791172, "comment_id": 55352365, "body": "If you define <code>UnmarshalJSON</code> for the other type ( <code>OurCustomType</code> ) then you wouldn&#39;t need that <code>PythonTime</code> wrapper you could also declare it like <code>type PythonTime time.Time</code> so you&#39;re type is an alias for <code>time.Time</code> rather than a wrapper around it."}, {"owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "edited": false, "score": 2, "creation_date": 1447938522, "post_id": 33791172, "comment_id": 55374951, "body": "The last error you are getting is due to the presence of the <code>&quot;</code> marks in the beggining and in the end of byte array that represents your time. Since you are reading directly from the json structure you need to trim the <code>&quot;</code> to have a valid time."}], "answers": [{"tags": [], "owner": {"reputation": 1095, "user_id": 1030873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81783d79b9967bf327cdafdcc0f4cd46?s=128&d=identicon&r=PG", "display_name": "Sly", "link": "https://stackoverflow.com/users/1030873/sly"}, "is_accepted": true, "score": 0, "last_activity_date": 1449010849, "creation_date": 1449010849, "answer_id": 34031856, "question_id": 33791172, "link": "https://stackoverflow.com/questions/33791172/parsing-json-time-error/34031856#34031856", "title": "Parsing JSON Time error", "body": "<p>The problem here is that you've got quotations in the date being passed from Python.</p>\n\n<p>In the first error that you posted, you can see that it failed at reading <code>\"T\"</code>. That's because you were using a different format in Go than you were returning from Python.</p>\n\n<pre><code>parsing time \"\"2015-11-05 14:14:32-0700\"\" as \"\"2006-01-02T15:04:05Z07:00\"\": cannot parse \" 14:14:32-0700\"\" as \"T\"\n</code></pre>\n\n<p>You used <code>\"\"2006-01-02T15:04:05Z07:00\"\"</code> when the format from Python is <code>\"\"2006-01-02 15:04:05-0700\"\"</code>.</p>\n\n<p>The same is true in your last error, except that you dropped the one pair of the quotations in the date format verses what you have returned in Python.</p>\n\n<pre><code>parsing time \"\"2015-11-05 14:14:32-0700\"\" as \"2006-01-02 15:04:05-0700\": cannot parse \"\"2015-11-05 14:14:32-0700\"\" as \"2006\"\n</code></pre>\n\n<p>This is saying that you provided <code>\"2006-01-02 15:04:05-0700\"</code> but it's expecting <code>\"\"2006-01-02 15:04:05-0700\"\"</code> due to the extra quotes in the date returned by Python.</p>\n"}], "owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 34031856, "answer_count": 1, "score": 1, "last_activity_date": 1449010849, "creation_date": 1447883686, "last_edit_date": 1447885527, "question_id": 33791172, "link": "https://stackoverflow.com/questions/33791172/parsing-json-time-error", "title": "Parsing JSON Time error", "body": "<p>I am trying to parse a timestamp that is generated in python and posted over to here to be stored in cassandra and I am getting a weird error.</p>\n\n<pre><code>parsing time \"\"2015-11-05 14:14:32-0700\"\" as \"\"2006-01-02T15:04:05Z07:00\"\": cannot parse \" 14:14:32-0700\"\" as \"T\"\n</code></pre>\n\n<p>I don't want to modify the time given to me from the python in anyway, just want to pass it right into cassandra but the driver says I need to have it be <code>time.Time</code> (not string) to do so.</p>\n\n<p>Here is the code</p>\n\n<pre><code>type OurCustomType struct {\n    TimeStamp   time.Time `json:\"timestamp\"`\n}\n\n\nfunc extractJsonBody(r *http.Request) []byte {\n    body, err := ioutil.ReadAll(io.LimitReader(r.Body, 1048576))\n    if err != nil {\n        //...\n    }\n    if err := r.Body.Close(); err != nil {\n         //....\n    }\n    return body\n}\n\nfunc View(w http.ResponseWriter, r *http.Request) {\n    var variable OurCustomType\n\n    body := extractJsonBody(r)\n\n    if err := json.Unmarshal(body, &amp;variable); err != nil {\n        //..\n    } else {\n        //...\n    }\n}\n</code></pre>\n\n<p><strong>Edit:</strong> I have implemented my own <code>time.Time</code> type and implemented a custom <code>UnmarshalJSON</code> to attempt to fix this issue. </p>\n\n<pre><code>type PythonTime struct {\n    time.Time\n}\n\nfunc (self *PythonTime) UnmarshalJSON(b []byte) (err error) {\n    self.Time, err = time.Parse(\"2006-01-02 15:04:05-0700\", string(b))\n    return\n}\n</code></pre>\n\n<p>But I am not getting this error:</p>\n\n<pre><code>parsing time \"\"2015-11-05 14:14:32-0700\"\" as \"2006-01-02 15:04:05-0700\": cannot parse \"\"2015-11-05 14:14:32-0700\"\" as \"2006\"\n</code></pre>\n"}, {"tags": ["windows", "dll", "go", "32bit-64bit", "wow64"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1447948568, "post_id": 33790814, "comment_id": 55382441, "body": "Are you fully aware of the fact your code basically tests whether your Go code runs on WOW64 emulation or not, and not whether the OS is 32-bit arch or not? To answer the question <i>as stated,</i> you should call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724340\" rel=\"nofollow noreferrer\"><code>kernel32!GetNativeSystemInfo()</code></a> and inspect the architecture it returns. The value will be the same no matter whether you&#39;re running 32-bit Go process on a 32-bit os or 64-bit Go process on 64-bit OS or 32-bit Go process on 64-bit OS."}, {"owner": {"reputation": 331, "user_id": 2583075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5f3Xp.png?s=128&g=1", "display_name": "Lomanic", "link": "https://stackoverflow.com/users/2583075/lomanic"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447964866, "post_id": 33790814, "comment_id": 55392958, "body": "Thanks for your comment and clarification @kostix. Indeed you are right, I was biased by the fact I assumed it was a 32-bit compiled Go executable. Should I edit my question to reflect that I wanted to guess if we run on WOW64 or not and then re-ask a new question with the GetNativeSystemInfo function in Go? <a href=\"http://meta.stackoverflow.com/q/283408/2583075\">It looks like it is the stackoverflow-way to handle this kind of situation</a>."}, {"owner": {"reputation": 331, "user_id": 2583075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5f3Xp.png?s=128&g=1", "display_name": "Lomanic", "link": "https://stackoverflow.com/users/2583075/lomanic"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1448036847, "post_id": 33790814, "comment_id": 55428108, "body": "Question edited to reflect what was finally asked and answered, following @kostix comment."}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 2583075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5f3Xp.png?s=128&g=1", "display_name": "Lomanic", "link": "https://stackoverflow.com/users/2583075/lomanic"}, "edited": false, "score": 0, "creation_date": 1447933815, "post_id": 33791102, "comment_id": 55371589, "body": "Thanks for your answer. <a href=\"https://play.golang.org/p/q6YOUS58pf\" rel=\"nofollow noreferrer\">Here</a> is my code so far. Unfortunately I have a runtime exception (<a href=\"http://pastebin.aquilenet.fr/?11f1a1d75a631c63#xEoHdDHc6K56GtJOzlOAUrJ7qYpC6DjJI+Vv1DN94eg=\" rel=\"nofollow noreferrer\">link</a>) while running it that I can&#39;t diagnose. It occurs at the proc.Call() line. Looks like it does not like affecting the <code>result</code> var?"}], "tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": true, "score": 4, "last_activity_date": 1447884178, "last_edit_date": 1495542855, "creation_date": 1447883434, "answer_id": 33791102, "question_id": 33790814, "link": "https://stackoverflow.com/questions/33790814/determining-if-current-process-runs-in-wow64-or-not-in-go/33791102#33791102", "title": "Determining if current process runs in WOW64 or not in Go", "body": "<p>I believe the issue is the handle parameter on your <code>proc.Call</code>.  The expected parameter for <code>IsWow64Process</code> is a HANDLE which is not the same as a <code>pid</code>.  Which is why it is indicating that the handle is invalid.</p>\n\n<p>The following SO question <a href=\"https://stackoverflow.com/questions/2221103/how-to-get-process-handle-from-process-id\">How to get process handle from process id</a> indicates that you need to call <code>OpenProcess</code> passsing in the pid and it returns the handle.</p>\n\n<p>EDIT:  GetCurrentProcess is defined in <a href=\"https://golang.org/src/syscall/zsyscall_windows.go?h=GetCurrentProcess#L646\" rel=\"nofollow noreferrer\">syscall</a>.   So I think you can replace the <code>Getpid</code> call with the following:</p>\n\n<pre><code>handle, err := syscall.GetCurrentProcess()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 2583075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5f3Xp.png?s=128&g=1", "display_name": "Lomanic", "link": "https://stackoverflow.com/users/2583075/lomanic"}, "is_accepted": false, "score": 3, "last_activity_date": 1447934683, "creation_date": 1447934683, "answer_id": 33803455, "question_id": 33790814, "link": "https://stackoverflow.com/questions/33790814/determining-if-current-process-runs-in-wow64-or-not-in-go/33803455#33803455", "title": "Determining if current process runs in WOW64 or not in Go", "body": "<p>OK, so here is a working code:</p>\n\n<pre><code>package main\n\nimport (\n    \"syscall\"\n    \"fmt\"\n    \"unsafe\"\n)\nfunc main() {\n    dll, err := syscall.LoadDLL(\"kernel32.dll\")\n    if err != nil {\n        fmt.Println(\"Can't load kernel32\")\n        fmt.Println(err)\n    }\n    defer dll.Release()\n    proc, err := dll.FindProc(\"IsWow64Process\")\n    if err != nil {\n        fmt.Println(\"Proc not found\")\n        fmt.Println(err)\n    }\n    fmt.Printf(\"%v\\n\",proc)\n\n    handle, err := syscall.GetCurrentProcess()  \n    if err != nil {\n        fmt.Println(\"Handle not found\")\n        fmt.Println(err)\n    }\n    fmt.Printf(\"%v\\n\",handle)\n\n    var result bool\n\n    v, x, y := proc.Call(uintptr(handle), uintptr(unsafe.Pointer(&amp;result)))\n\n    fmt.Printf(\"%v %v %v\\n\",v,x,y)\n    fmt.Printf(\"%v\\n\",result)\n}\n</code></pre>\n\n<p>The <code>result</code> var will be true for a WOW64 system and false for a 32 bit system.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 10201459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vXCnyVNuGic/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pBGf7WVIqKK4oL4IWxJRlPWMd3pA/mo/photo.jpg?sz=128", "display_name": "Erfan Azhdari", "link": "https://stackoverflow.com/users/10201459/erfan-azhdari"}, "is_accepted": false, "score": 0, "last_activity_date": 1607842928, "creation_date": 1607842928, "answer_id": 65273178, "question_id": 33790814, "link": "https://stackoverflow.com/questions/33790814/determining-if-current-process-runs-in-wow64-or-not-in-go/65273178#65273178", "title": "Determining if current process runs in WOW64 or not in Go", "body": "<p>You can also use <code>golang.org/x/sys/windows</code></p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;golang.org/x/sys/windows&quot;\n)\n\nfunc main() {\n    handle := windows.CurrentProcess()\n    var isWow64 bool\n    err := windows.IsWow64Process(handle, &amp;isWow64)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(isWow64)\n}\n\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 2583075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5f3Xp.png?s=128&g=1", "display_name": "Lomanic", "link": "https://stackoverflow.com/users/2583075/lomanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 33791102, "answer_count": 3, "score": 3, "last_activity_date": 1607842928, "creation_date": 1447882348, "last_edit_date": 1448036748, "question_id": 33790814, "link": "https://stackoverflow.com/questions/33790814/determining-if-current-process-runs-in-wow64-or-not-in-go", "title": "Determining if current process runs in WOW64 or not in Go", "body": "<p>With Windows, the official way of guessing if the current 32-bit process is running on a 32 or 64-bit architecture (so on WOW64 or not) is to call the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684139%28v=vs.85%29.aspx\" rel=\"nofollow\">IsWow64Process</a> function from kernel32.dll, and see if it is present (as I understand the doc).</p>\n\n<p>In Go we can call functions exported in dll files with the <a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow\">syscall</a> package, so here is my attempt:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"syscall\"\n)\n\nfunc main() {\n    dll, err := syscall.LoadDLL(\"kernel32.dll\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer dll.Release()\n    proc, err := dll.FindProc(\"IsWow64Process\")\n    if err != nil {\n        fmt.Println(\"Proc not found\") // not a WOW64 so a 32 bit system?\n        fmt.Println(err)\n    }\n    fmt.Printf(\"%v\\n\", proc)\n\n    var handle uintptr = uintptr(os.Getpid())\n\n    var result uintptr\n    v, x, y := proc.Call(handle, result)\n\n    fmt.Printf(\"%v %v %v\\n\", v, x, y)\n    fmt.Printf(\"%v\\n\", result)\n}\n</code></pre>\n\n<p>Unfortunately, testing with or without a WOW64 system displays the same in stdout:</p>\n\n<pre><code>&amp;{0x10ada110 IsWow64Process 2088961457}\n0 7 The handle is invalid.\n0\n</code></pre>\n\n<p>What do I do wrong? How to achieve a test to determine if our 32-bit Go program runs on an emulated 32-bit on a 64-bit CPU (WOW64) or on a real 32-bit Windows?</p>\n"}, {"tags": ["go", "x509certificate"], "comments": [{"owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "edited": false, "score": 0, "creation_date": 1447881654, "post_id": 33789680, "comment_id": 55348269, "body": "If you read the x509.ParsePKIXPublicKey function you&#39;ll note it already returns one of these three types (masked as an interface{}): &amp;rsa.PublicKey, &amp;dsa.PublicKey or &amp;ecdsa.PublicKey, my guess is that your key is of the &amp;dsa.PublicKey type and therefore cannot be used by the CreateCertificate function. If this is not the case I need to see how exactly you are generating your key to figure out the problem."}, {"owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "reply_to_user": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "edited": false, "score": 0, "creation_date": 1447884026, "post_id": 33789680, "comment_id": 55349599, "body": "@hbejgel I added the generation of the public key with additional details in the question."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 1, "creation_date": 1451464103, "post_id": 33789680, "comment_id": 56792643, "body": "This should help: <a href=\"https://golang.org/src/crypto/tls/generate_cert.go\" rel=\"nofollow noreferrer\">golang.org/src/crypto/tls/generate_cert.go</a>"}, {"owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "reply_to_user": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1451916755, "post_id": 33789680, "comment_id": 56931181, "body": "@voutasaurus thanks! I modify the code based on the link you provided and it worked. Could you answer the question with the link so I can accept it?"}, {"owner": {"reputation": 1206, "user_id": 1127536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51b891c77b841186957d1e42b3d9f711?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/1127536/tony"}, "edited": false, "score": 0, "creation_date": 1523606602, "post_id": 33789680, "comment_id": 86638573, "body": "Might be related to the fact that x509.MarshalPKIXPublicKey(publicKey) expects a pointer to a public key struct."}], "answers": [{"comments": [{"owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "edited": false, "score": 0, "creation_date": 1447890740, "post_id": 33792355, "comment_id": 55352355, "body": "I tried but it didn&#39;t work, I think there is something with the protobuf that is not working correctly. Just to reduce the things to try, when you tried it, did you use protobuf? Or did you run it in a single main function?"}, {"owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "reply_to_user": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "edited": false, "score": 1, "creation_date": 1447894864, "post_id": 33792355, "comment_id": 55353724, "body": "I ran it as a single main function and received the full Certificate. But I don&#39;t think its a problem with protobuf, by the error you&#39;re getting its probably a problem in the bytes from the public key you are receiving from the protobuf. Make sure you are passing the correct slice of bytes."}, {"owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "edited": false, "score": 1, "creation_date": 1447898611, "post_id": 33792355, "comment_id": 55354759, "body": "I did the same, without protobuf and it worked, so probably I&#39;m doing something wrong when obtaining the bytes from the public key. Thanks for your help! I will continue trying to make it work."}], "tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": false, "score": 3, "last_activity_date": 1447888508, "creation_date": 1447888508, "answer_id": 33792355, "question_id": 33789680, "link": "https://stackoverflow.com/questions/33789680/error-generating-x-509-certificate-in-go/33792355#33792355", "title": "Error generating X.509 certificate in Go", "body": "<p>I got it to work doing something like this:</p>\n\n<pre><code>// Generate key pair\ncurve := elliptic.P384()\n//privateKey := new(ecdsa.PrivateKey)\nprivateKey, err := ecdsa.GenerateKey(curve, rand.Reader)\npublicKey := &amp;privateKey.PublicKey\n</code></pre>\n\n<p>And the rest as exactly what you wrote, see if you can mirror this and make it work.</p>\n"}, {"comments": [{"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 1, "creation_date": 1516967547, "post_id": 34598985, "comment_id": 83914429, "body": "That&#39;s a useful pointer, but it would be better if you also supplied specific advice to address the original question, or summarised the key points from that code in your answer. Otherwise, your answer is entirely dependent on that code sample and link remaining valid."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "reply_to_user": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 0, "creation_date": 1525588030, "post_id": 34598985, "comment_id": 87410612, "body": "Normally I&#39;d agree with you but in this case that code is about as likely to remain valid as Go is likely to remain a supported programming language since it&#39;s included in the standard library and has had two very minor edits since 2014: <a href=\"https://github.com/golang/go/commits/master/src/crypto/tls/generate_cert.go\" rel=\"nofollow noreferrer\">github.com/golang/go/commits/master/src/crypto/tls/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "is_accepted": true, "score": 2, "last_activity_date": 1451945885, "last_edit_date": 1451945885, "creation_date": 1451938115, "answer_id": 34598985, "question_id": 33789680, "link": "https://stackoverflow.com/questions/33789680/error-generating-x-509-certificate-in-go/34598985#34598985", "title": "Error generating X.509 certificate in Go", "body": "<p>The <code>crypto/tls</code> package contains a file called <code>generate_cert.go</code> which shows the proper and idiomatic way to generate a self signed certificate.</p>\n\n<p>You can find it here:\n<a href=\"https://golang.org/src/crypto/tls/generate_cert.go\" rel=\"nofollow\">https://golang.org/src/crypto/tls/generate_cert.go</a></p>\n\n<p>Or by browsing the files in the tls package directory in the filesystem location where you installed Go.</p>\n\n<p>There are a number of things that should be done correctly and short of enumerating them all, reading, running, modifying and understanding that code is the best way to get to grips with how to use the crypto packages when generating certs.</p>\n\n<p>In particular be careful of what you pass in to the <code>x509.CreateCertificate</code> function as the public and private keys. In the crypto packages keys are of the <code>interface{}</code> type which happily and dangerously turns compile time type checks into runtime type checks.</p>\n"}], "owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2055, "favorite_count": 0, "accepted_answer_id": 34598985, "answer_count": 2, "score": 3, "last_activity_date": 1451945885, "creation_date": 1447878301, "last_edit_date": 1447884063, "question_id": 33789680, "link": "https://stackoverflow.com/questions/33789680/error-generating-x-509-certificate-in-go", "title": "Error generating X.509 certificate in Go", "body": "<p>I'm new using Go and I'm trying to generate an X.509 certificate using this code:</p>\n\n<pre><code>cert, err := x509.CreateCertificate(\n    random,\n    &amp;certTemplate,\n    cert,\n    publicKey,\n    privateKey\n)\n</code></pre>\n\n<p>where the publicKey variable is typed as interface{} and it is the result of calling x509.ParsePKIXPublicKey(bytes).</p>\n\n<p>The error I'm having is:</p>\n\n<p><strong>x509: only RSA and ECDSA public keys supported</strong></p>\n\n<p>I arrived to the conclusion that this is a consequence of passing the publicKey typed as interface{} to the x509.CreateCertificate function, since it doesn't match the type switch inside that function. I tried passing &amp;publicKey with the same result. I also tried doing a type assertion using the publicKey, like this:</p>\n\n<pre><code>var pk *ecdsa.PublicKey\npk = publicKey.(*ecdsa.PublicKey)\n\ncert, err := x509.CreateCertificate(\n    random,\n    &amp;certTemplate,\n    cert,\n    pk,\n    privateKey\n)\n</code></pre>\n\n<p>but then I get this error: <strong>panic: interface conversion: interface {} is nil, not *ecdsa.PublicKey</strong> The same error occurs if I pass &amp;pk as a parameter.</p>\n\n<p>This is how I generate the public key:</p>\n\n<pre><code>// Generate key pair\ncurve := elliptic.P384()\nprivateKey := new(ecdsa.PrivateKey)\nprivateKey, err := ecdsa.GenerateKey(curve, rand.Reader)\npublicKey := &amp;privatekey.PublicKey\n\n// Obtain bytes from public key for communication using protobuf\npublicKeyBytes, err := x509.MarshalPKIXPublicKey(publicKey)\n\n// Protobuf communication takes place here\n\nreceivedPublicKey, err := x509.ParsePKIXPublicKey(publicKeyBytes)\n\n// verification of public key here (the verification ends successfully)\n// populate X.509 template\n\n// create certificate\ncertificate, err := x509.CreateCertificate(\n    random,\n    &amp;certificateTemplate,\n    certificate,\n    receivedPublicKey,\n    privateKey,\n)\n</code></pre>\n\n<p>If someone can point me in the right direction or knows how to solve this issue it will be really helpful. Thanks in advance!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 496, "user_id": 4042821, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-bLyOhWILdEg/AAAAAAAAAAI/AAAAAAAAACY/PLPlL9iwQTQ/photo.jpg?sz=128", "display_name": "Jeffrey Ellin", "link": "https://stackoverflow.com/users/4042821/jeffrey-ellin"}, "edited": false, "score": 0, "creation_date": 1447878725, "post_id": 33789739, "comment_id": 55346611, "body": "While that is the correct answer,  can you provide some explanation"}, {"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "reply_to_user": {"reputation": 496, "user_id": 4042821, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-bLyOhWILdEg/AAAAAAAAAAI/AAAAAAAAACY/PLPlL9iwQTQ/photo.jpg?sz=128", "display_name": "Jeffrey Ellin", "link": "https://stackoverflow.com/users/4042821/jeffrey-ellin"}, "edited": false, "score": 0, "creation_date": 1447878857, "post_id": 33789739, "comment_id": 55346694, "body": "I added some more context to my answer, but the gist is []cloudformation.Parameters as a type != []*cloudformation.Parameters as a type."}], "tags": [], "owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "is_accepted": true, "score": 0, "last_activity_date": 1447879126, "last_edit_date": 1447879126, "creation_date": 1447878491, "answer_id": 33789739, "question_id": 33789572, "link": "https://stackoverflow.com/questions/33789572/passing-a-slice-array-to-another-struct/33789739#33789739", "title": "passing a slice/array to another struct", "body": "<p>Pointer types are not compatible with the dereferenced types they point to, the error is telling you this very thing as you are trying to set a <code>[]*cloudformation.Parameter</code> to a <code>[]cloudformation.Parameter</code>.  Change the return type of <code>createParams</code> to <code>[]*cloudformation.Parameter</code> and set <code>par := &amp;cloudformation.Parameter</code>.</p>\n\n<pre><code>func (d *Driver) createParams() []*cloudformation.Parameter {\n  val := \"KeyName=Foo|KeyName2=bar\"\n  s := strings.Split(val, \"|\")\n  a := []*cloudformation.Parameter{} //a should be a slice of pointers\n  for _, element := range s {\n      pairs := strings.Split(element, \"=\")\n      key := pairs[0]\n      value := pairs[1]\n      par := &amp;cloudformation.Parameter{ //&amp; turns par into a pointer to the parameter\n          ParameterKey:   aws.String(key),\n          ParameterValue: aws.String(value),\n      }\n      a = append(a, par)\n    }\n  return a\n  }\n</code></pre>\n"}], "owner": {"reputation": 496, "user_id": 4042821, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-bLyOhWILdEg/AAAAAAAAAAI/AAAAAAAAACY/PLPlL9iwQTQ/photo.jpg?sz=128", "display_name": "Jeffrey Ellin", "link": "https://stackoverflow.com/users/4042821/jeffrey-ellin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 33789739, "answer_count": 1, "score": 1, "last_activity_date": 1447879126, "creation_date": 1447877894, "question_id": 33789572, "link": "https://stackoverflow.com/questions/33789572/passing-a-slice-array-to-another-struct", "title": "passing a slice/array to another struct", "body": "<p>I have the following code that works for me.</p>\n\n<pre><code>params := &amp;cloudformation.CreateStackInput{\n    StackName:   aws.String(d.MachineName),\n    TemplateURL: aws.String(d.CloudFormationURL),\n    Parameters: []*cloudformation.Parameter{\n        {\n            ParameterKey:   aws.String(\"KeyName\"),\n            ParameterValue: aws.String(d.KeyPairName),\n        },\n    },\n}\n</code></pre>\n\n<p>I would like to externalize the creation of the Parameters,  so I have created the following method.</p>\n\n<pre><code>func (d *Driver) createParams() []cloudformation.Parameter {\n\nval := \"KeyName=Foo|KeyName2=bar\"\n\ns := strings.Split(val, \"|\")\n\na := []cloudformation.Parameter{}\n\nfor _, element := range s {\n\n    pairs := strings.Split(element, \"=\")\n\n    key := pairs[0]\n    value := pairs[1]\n\n    par := cloudformation.Parameter{\n        ParameterKey:   aws.String(key),\n        ParameterValue: aws.String(value),\n    }\n\n    a = append(a, par)\n\n}\n\nreturn a\n</code></pre>\n\n<p>}</p>\n\n<p>My issue is how to I pass the output of createParams to the Parameters from CreateStackInput?</p>\n\n<pre><code>params := &amp;cloudformation.CreateStackInput{\n    StackName:   aws.String(d.MachineName),\n    TemplateURL: aws.String(d.CloudFormationURL),\n    Parameters:  d.createParam(),\n}\n</code></pre>\n\n<p>The above yields</p>\n\n<pre><code>cannot use d.createParam() (type []cloudformation.Parameter) as type []*cloudformation.Parameter in field value\n</code></pre>\n"}, {"tags": ["go", "delve"], "comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1447962332, "post_id": 33789220, "comment_id": 55391441, "body": "For my own interest could you post link to delve as I have not heard of it?"}, {"owner": {"reputation": 8069, "user_id": 296923, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb7b3af2d2d967711454dc8d9c21798f?s=128&d=identicon&r=PG", "display_name": "Ziffusion", "link": "https://stackoverflow.com/users/296923/ziffusion"}, "reply_to_user": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1447975897, "post_id": 33789220, "comment_id": 55398409, "body": "<a href=\"https://github.com/derekparker/delve\" rel=\"nofollow noreferrer\">github.com/derekparker/delve</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8069, "user_id": 296923, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb7b3af2d2d967711454dc8d9c21798f?s=128&d=identicon&r=PG", "display_name": "Ziffusion", "link": "https://stackoverflow.com/users/296923/ziffusion"}, "edited": false, "score": 0, "creation_date": 1485899917, "post_id": 41964560, "comment_id": 71115220, "body": "Didn&#39;t work for the last time I tried it. Will give it another try."}], "tags": [], "owner": {"reputation": 1330, "user_id": 5771861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cbtGq.jpg?s=128&g=1", "display_name": "Hakan Baba", "link": "https://stackoverflow.com/users/5771861/hakan-baba"}, "is_accepted": false, "score": 1, "last_activity_date": 1485886159, "creation_date": 1485886159, "answer_id": 41964560, "question_id": 33789220, "link": "https://stackoverflow.com/questions/33789220/is-there-a-way-to-see-the-programs-stdout-and-stderr-in-delve-debugger-for-golan/41964560#41964560", "title": "Is there a way to see the programs stdout and stderr in delve debugger for golang?", "body": "<p>You do not need to do anything. </p>\n\n<p>Delve by default prints the stdout and stderr to its console. \nI have tried this in MacOS ElCapitan delve version 0.11.0-alpha</p>\n\n<p>Have a main.go in the right subdir in your GOPATH</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"os\"\n\nfunc main() {\n    fmt.Fprintf(os.Stderr, \"Writing something to stderr\\n\")\n    fmt.Fprintf(os.Stdout, \"Writing something to stdout\\n\")\n}\n</code></pre>\n\n<p>Then run the delve in the same dir as the main.go</p>\n\n<pre><code>$ dlv debug\nType 'help' for list of commands.\n(dlv) restart\nProcess restarted with PID 70964\n(dlv) c\nWriting something to stderr\nWriting something to stdout\nProcess 70964 has exited with status 0\n(dlv)\n</code></pre>\n"}], "owner": {"reputation": 8069, "user_id": 296923, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb7b3af2d2d967711454dc8d9c21798f?s=128&d=identicon&r=PG", "display_name": "Ziffusion", "link": "https://stackoverflow.com/users/296923/ziffusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485886159, "creation_date": 1447876704, "question_id": 33789220, "link": "https://stackoverflow.com/questions/33789220/is-there-a-way-to-see-the-programs-stdout-and-stderr-in-delve-debugger-for-golan", "title": "Is there a way to see the programs stdout and stderr in delve debugger for golang?", "body": "<p>I'd like to be able to see the stdout and stderr when using delve to debug go programs. Is this possible? How would I do this?</p>\n"}, {"tags": ["oop", "go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1447875892, "post_id": 33788848, "comment_id": 55344869, "body": "Quick one: Code looks fine, though a Factory seems to be a bit of an overkill in this case \u2013 you could simply create a new instance by using a literal in place, so <code>vect:= Vector{x:1,y:2,z:3}</code>. Other than that, I&#39;d suggest using labels for initializing structs(like I did), as this is likely to reduce errors in the long run."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 2, "creation_date": 1447876349, "post_id": 33788848, "comment_id": 55345162, "body": "Putting aside the need for creating a &quot;factory&quot; (per previous comment), idiomatic name for it would be <code>NewVector</code>. <code>&amp;Vector{...}</code> is fine as well, probably nobody would really use <code>new</code> keyword here (it&#39;s usually useful for built-in types like <code>map</code> or <code>chan</code>). Also, no need to delete anything, Go has garbage collector. I can feel your impatience to learn a new language, but reading a Go (on its way!) book or <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a> will be very helpful to start being a gopher. Check out everything under <a href=\"https://golang.org/doc\" rel=\"nofollow noreferrer\">golang.org/doc</a> really and <i>voil&#224;!</i>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1447882171, "post_id": 33788848, "comment_id": 55348571, "body": "&quot;Constructors&quot; in Go are named &quot;NewVector&quot; and not &quot;VectorFactory&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": true, "score": 2, "last_activity_date": 1447927989, "creation_date": 1447927989, "answer_id": 33800898, "question_id": 33788848, "link": "https://stackoverflow.com/questions/33788848/object-oriented-programming-in-go-use-new-keyword-or-nah/33800898#33800898", "title": "Object-oriented programming in Go -- use &quot;new&quot; keyword or nah?", "body": "<p>Prefer <code>NewThing</code> to <code>ThingFactory</code>.</p>\n\n<p>Don't make a <code>NewThing</code> function, unless you have complex initialisation, or you're intentionally not exporting parts of a struct. Selectively setting only parts of a struct is not complex, that can be accomplished by using labels. Complex would be things like \"the value of slot Q depends on what the value of slot Zorb is\". Unexported struct fields can be useful for information hiding, but should be used with care.</p>\n\n<p>Go is garbage-collected, any piece of data that is not referenced is eligible to be collected. Start out y not worrying about it, then get to a point where you ensure you clean up any reference to data you're no longer interested in so as to avoid accidental liveness (\"accidental liveness\" is essentially the GC equivalent of \"memory leak\").</p>\n\n<p>If you expect to print your data structures frequently, consider making a <code>String</code> method for them (this is not exactly corresponding to the print you do, but might be generally more useful for a vector):</p>\n\n<pre><code>func (v Vector) String() string {\n  return fmt.Sprintf(\"V&lt;%d, %d, %d&gt;\", v.x v.y, v.z);\n}\n</code></pre>\n\n<p>Unless \"vect\" really means something to you, prefer either \"v\" or \"vector\" as a name.</p>\n"}], "owner": {"reputation": 25, "user_id": 5518022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5be27027111bf2b34fb2c4b514d2deb?s=128&d=identicon&r=PG", "display_name": "the_rover", "link": "https://stackoverflow.com/users/5518022/the-rover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 33800898, "answer_count": 1, "score": -3, "last_activity_date": 1447927989, "creation_date": 1447875408, "question_id": 33788848, "link": "https://stackoverflow.com/questions/33788848/object-oriented-programming-in-go-use-new-keyword-or-nah", "title": "Object-oriented programming in Go -- use &quot;new&quot; keyword or nah?", "body": "<p>I am learning Go, and I have a question based on the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Vector struct {\n    x, y, z int\n}\n\nfunc VectorFactory(x,y,z int) *Vector {\n    return &amp;Vector{x, y, z}\n}\n\nfunc main() {\n    vect := VectorFactory(1, 2, 3)\n    fmt.Printf(\"%d\\n\", (vect.x * vect.y * vect.z))\n}\n</code></pre>\n\n<p>Here I've defined a type <code>Vector</code> with <code>x</code>, <code>y</code>, and <code>z</code>, and I've defined function <code>VectorFactory</code> which declares a pointer to a <code>Vector</code> and returns that pointer. I use this function to create a new <code>Vector</code> named <code>vect</code>.</p>\n\n<ul>\n<li>Is this bad code? Should I be using the <code>new</code> keyword rather than building a <code>Factory</code>?</li>\n<li>Do I need to <code>delete</code> the <code>Vector</code> after using it, like in C++? If so, how?</li>\n</ul>\n\n<p>Thanks. I'm still waiting for my Go book to be delivered.</p>\n"}, {"tags": ["pointers", "go", "append", "slice"], "comments": [{"owner": {"reputation": 473, "user_id": 279890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c814f355aec49a73a7c3bbcc3b0eb27?s=128&d=identicon&r=PG", "display_name": "Yannick", "link": "https://stackoverflow.com/users/279890/yannick"}, "edited": false, "score": 0, "creation_date": 1447871963, "post_id": 33786353, "comment_id": 55342420, "body": "Defining <code>var value query.structType</code> and passing it as reference is the correct way. Your problem is the <code>results</code> slice and how you append values."}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 473, "user_id": 279890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c814f355aec49a73a7c3bbcc3b0eb27?s=128&d=identicon&r=PG", "display_name": "Yannick", "link": "https://stackoverflow.com/users/279890/yannick"}, "edited": false, "score": 0, "creation_date": 1447872025, "post_id": 33786353, "comment_id": 55342461, "body": "Trying to define <code>var value query.structType</code> gives <code>query.structType is not a type</code>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 473, "user_id": 279890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c814f355aec49a73a7c3bbcc3b0eb27?s=128&d=identicon&r=PG", "display_name": "Yannick", "link": "https://stackoverflow.com/users/279890/yannick"}, "edited": false, "score": 0, "creation_date": 1447873815, "post_id": 33786353, "comment_id": 55343589, "body": "@yene I think you&#39;re wrong about that. The problem is value is a pointer and whatever comes back from <code>Scan</code> is being written there. He keeps appending pointers to his slice, it happens to be the same address every time, when execution finishes only the final result exists at that location so he sees the same thing every time. What you need is for your slice to hold values rather than references and then you need to dereference value when you append."}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447874429, "post_id": 33786353, "comment_id": 55343961, "body": "@evanmcdonnal how would I go about doing that?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447876276, "post_id": 33786353, "comment_id": 55345119, "body": "I posted something as an answer if you wanna give it a try."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1447925373, "post_id": 33786353, "comment_id": 55365570, "body": "Do you know what types it could be? You can type switch that interface."}], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "is_accepted": true, "score": 0, "last_activity_date": 1447930195, "last_edit_date": 1447930195, "creation_date": 1447927629, "answer_id": 33800741, "question_id": 33786353, "link": "https://stackoverflow.com/questions/33786353/pointer-problems/33800741#33800741", "title": "Pointer problems", "body": "<p>Well I can at least tell you what you're doing. <code>bindQuery</code> takes a pointer. It changes the value stored at the address.</p>\n\n<p>What you're essentially doing is this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var q int\n    myInts := make([]*int, 0, 5)\n    for i := 0; i &lt; 5; i++ {\n        q = i\n        fmt.Printf(\"%d \", q)\n        myInts = append(myInts, &amp;q)\n    }\n    fmt.Printf(\"\\n\")\n    for _, value := range myInts {\n        fmt.Printf(\"%d \", *value)\n    }\n    fmt.Printf(\"\\n\")\n    fmt.Println(myInts)\n}\n</code></pre>\n\n<p>Which, as you can probably guess, gives you this:</p>\n\n<pre><code>0 1 2 3 4 \n4 4 4 4 4 \n[0x104382e0 0x104382e0 0x104382e0 0x104382e0 0x104382e0]\n</code></pre>\n\n<p>Things get a little more confusing with <code>reflect</code>. You can get your type as an interface, but that is it (unless you want to play with <code>unsafe</code>). An interface, in simple terms, contains a pointer to the original type underneath (and some other stuff). So in your function you are passing a pointer (and some other stuff). Then you're appending the pointer. It might be nice just to get concrete and type switch your interface. I assume you know what types it could be. In which case you'd have to have something along these lines: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype foo struct {\n    fooval string\n}\n\ntype bar struct {\n    barval string\n}\n\nfunc main() {\n    f1 := foo{\"hi\"}\n    f2 := &amp;foo{\"hi\"}\n    b1 := bar{\"bye\"}\n    b2 := &amp;bar{\"bye\"}\n\n    doSomething(f1)\n    doSomething(f2)\n    doSomething(b1)\n    doSomething(b2)\n\n}\n\nfunc doSomething(i interface{}) {\n    n := reflect.TypeOf(i)\n    // get a new one\n    newn := reflect.New(n).Interface()\n    // find out what we got and handle each case\n    switch t := newn.(type) {\n    case **foo:\n        *t = &amp;foo{\"hi!\"}\n        fmt.Printf(\"It was a **foo, here is the address %p and here is the value %v\\n\", *t, **t)\n    case **bar:\n        *t = &amp;bar{\"bye :(\"}\n        fmt.Printf(\"It was a **bar, here is the address %p and here is the value %v\\n\", *t, **t)\n    case *foo:\n        t = &amp;foo{\"hey!\"}\n        fmt.Printf(\"It was a *foo, here is the address %p and here is the value %v\\n\", t, *t)\n    case *bar:\n        t = &amp;bar{\"ahh!\"}\n        fmt.Printf(\"It was a *bar, here is the address %p and here is the value %v\\n\", t, *t)\n    default:\n        panic(\"AHHHH\")\n    }\n}\n</code></pre>\n\n<p>You could also just keep calling <code>value = reflect.New(query.structType).Interface()</code> inside of the loop which will give you new interfaces every time. Reassigning value after every append. Last time through the loop would make one extra though.. </p>\n"}], "owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 33800741, "answer_count": 1, "score": 0, "last_activity_date": 1447930195, "creation_date": 1447867223, "last_edit_date": 1447872066, "question_id": 33786353, "link": "https://stackoverflow.com/questions/33786353/pointer-problems", "title": "Pointer problems", "body": "<p><strong>TL;DR</strong> Somehow, I am appending a pointer to a list instead of the object within a for loop of objects so at the end the entire slice is composed of the same object multiple times. I just don't know how to fix that. </p>\n\n<p><strong>The Long Way</strong></p>\n\n<p>I am still having a super hard time trying to figure out pointers in go. I posted a question yesterday and got some help but now I am stuck on a slightly different issue in the same piece of code. </p>\n\n<p>I am working with <code>gocql</code> and <code>cqlr</code> go packages to try and bit a small object mapper for my Cassandra queries. Essentially the problem I am having is I am appending what appears to be a pointer to an object, not a new instance of the obj to the array. How do I fix that? I have tried adding <code>&amp;</code> and <code>*</code> in front of <code>value</code> but that doesn't seem to work. How do I fix these? The bind function needs an <code>&amp;</code> according to their docs.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>type Query struct {\n    query       string\n    values      interface{}\n    attempts    int\n    maxAttempts int\n    structType  reflect.Type\n}\n\nfunc (query Query) RetryingQuery() (results []interface{}) {\n    var q *gocql.Query\n    if query.values != nil {\n        q = c.Session.Query(query.query, query.values)\n    } else {\n        q = c.Session.Query(query.query)\n    }\n\n    bindQuery := cqlr.BindQuery(q)\n    value := reflect.New(query.structType).Interface()\n    for bindQuery.Scan(value) {\n        fmt.Println(value)\n        results = append(results, value)\n    }\n    return\n}\n</code></pre>\n\n<p>The docs ask for <code>var value type</code> then in bind you would pass <code>&amp;value</code>. I quoted the docs below.</p>\n\n<pre><code>var t Tweet\nvar s []Tweet\nfor b.Scan(&amp;t) {\n    // Application specific code goes here\n    append(s, t)\n}\n</code></pre>\n\n<p>The issue is I cannot directly go <code>var value query.structType</code> to define its type then pass the reference of that to <code>bindQuery.Scan()</code>. </p>\n\n<p><strong>What is printed</strong></p>\n\n<pre><code>&amp;{result1 x86_64 24 3.2.0-74-generic Linux}\n&amp;{result2 x86_64 24 3.19.0-25-generic Linux}\n&amp;{result3 x86_64 4 3.13.0-48-generic Linux}\n&amp;{result4 x86_64 2 3.13.0-62-generic Linux}\n&amp;{result5 x86_64 4 3.13.0-48-generic Linux}\n</code></pre>\n\n<p><strong>What is in the slice</strong> </p>\n\n<p><em>Spoiler</em>, it is <code>result5</code> repeated over and over. I understand that I am just appending the pointer to same object to the list and that every loop iteration the object is changed and that changes all the results in the slice to that new object. I just don't know how to fix it.</p>\n\n<pre><code>[{\"hostname\":\"result5\",\"machine\":\"x86_64\",\"num_cpus\":4,\"release\":\"3.13.0-48-generic\",\"sysname\":\"Linux\"},{\"hostname\":\"result5\",\"machine\":\"x86_64\",\"num_cpus\":4,\"release\":\"3.13.0-48-generic\",\"sysname\":\"Linux\"},{\"hostname\":\"result5\",\"machine\":\"x86_64\",\"num_cpus\":4,\"release\":\"3.13.0-48-generic\",\"sysname\":\"Linux\"},{\"hostname\":\"result5\",\"machine\":\"x86_64\",\"num_cpus\":4,\"release\":\"3.13.0-48-generic\",\"sysname\":\"Linux\"},{\"hostname\":\"result5\",\"machine\":\"x86_64\",\"num_cpus\":4,\"release\":\"3.13.0-48-generic\",\"sysname\":\"Linux\"}]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1526457825, "post_id": 33784283, "comment_id": 87746998, "body": "Using interface it means you have to multiple the code, like <code>WhoAmI</code> method, it repeatedly shows in both <code>Sub</code> and <code>Parent</code> struct. I think passing object and use <code>reflect.ValueOf(&amp;Sub{}).MethodByName(&quot;WhoAmI&quot;).Call(nil)</code> is a better option"}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 8, "last_activity_date": 1447861874, "last_edit_date": 1447861874, "creation_date": 1447861176, "answer_id": 33784283, "question_id": 33783491, "link": "https://stackoverflow.com/questions/33783491/how-to-call-child-method-in-parent-method/33784283#33784283", "title": "how to call child method in parent method?", "body": "<p>Embedding is not subclassing. There are no superclasses or subclasses in Go. <code>Sub</code> here is not a \"child\" of <code>Super</code>. It contains a <code>Super</code>. You can't do you're trying to do. You need to organize your code in a different way so that it's not needed.</p>\n\n<p>For example, here (<a href=\"http://play.golang.org/p/0_qZQ-V7EO\">playground</a>) is a more natural way to do this in Go:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Namer interface {\n    Name() string\n}\n\ntype Super struct{}\n\nfunc (sub *Super) Name() string {\n    return \"Super\"\n}\n\ntype Sub struct{}\n\nfunc (sub *Sub) Name() string {\n    return \"Sub\"\n}\n\nfunc WhoAmI(namer Namer) {\n    fmt.Printf(\"I'm %s.\\n\", namer.Name())\n}\n\nfunc main() {\n    sub := &amp;Sub{}\n    WhoAmI(sub)\n}\n</code></pre>\n\n<p>Rather than focus on classes (which Go doesn't have), this focuses on interfaces. It's not a question of what things <em>are</em>, it's a question of what they can <em>do</em>. This is a very powerful approach to programming, and in practice is often much more flexible and less error-prone than inheritance abstractions.</p>\n"}, {"tags": [], "owner": {"reputation": 14348, "user_id": 262808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5360382382b30ee62b7f85d1b1436b?s=128&d=identicon&r=PG", "display_name": "Todd Yandell", "link": "https://stackoverflow.com/users/262808/todd-yandell"}, "is_accepted": false, "score": 2, "last_activity_date": 1447861525, "creation_date": 1447861525, "answer_id": 33784401, "question_id": 33783491, "link": "https://stackoverflow.com/questions/33783491/how-to-call-child-method-in-parent-method/33784401#33784401", "title": "how to call child method in parent method?", "body": "<p>Think of functions in Go as if they all belong to a single namespace. Go really doesn\u2019t have classes, methods, or inheritance, so what you\u2019re attempting will never work the way you intend.</p>\n\n<p>To put it another way, when you define a function like this:</p>\n\n<pre><code>func (f *Foo) DoStuff()\n</code></pre>\n\n<p>You can imagine it <em>really</em> being defined as:</p>\n\n<pre><code>func DoStuff(f *Foo)\n</code></pre>\n\n<p>So you might notice why Go chose to call the <code>name</code> function on your <code>Super</code> struct\u2014it was the only function signature that matched. (Note that in your <code>WhoAmI</code> function <code>super</code> is defined as <code>super *Super</code> so Go matches it up with the corresponding function of the same type.)</p>\n\n<p>As for how you might do this the Go way, try using interfaces:</p>\n\n<p><strong><a href=\"http://play.golang.org/p/8ELw-9e7Re\" rel=\"nofollow\">http://play.golang.org/p/8ELw-9e7Re</a></strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Indentifier interface {\n    WhoAmI() string\n}\n\ntype A struct{}\n\nfunc (a *A) WhoAmI() string {\n    return \"A\"\n}\n\ntype B struct{}\n\nfunc (b *B) WhoAmI() string {\n    return \"B\"\n}\n\nfunc doSomething(x Indentifier) {\n    fmt.Println(\"x is a\", x.WhoAmI())\n}\n\nfunc main() {\n    doSomething(&amp;A{})\n    doSomething(&amp;B{})\n}\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4859529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cde42ced53ff87af39ff8ab7991a?s=128&d=identicon&r=PG&f=1", "display_name": "QthCN", "link": "https://stackoverflow.com/users/4859529/qthcn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 0, "closed_date": 1447873417, "accepted_answer_id": 33784283, "answer_count": 2, "score": 6, "last_activity_date": 1447861874, "creation_date": 1447859097, "question_id": 33783491, "link": "https://stackoverflow.com/questions/33783491/how-to-call-child-method-in-parent-method", "closed_reason": "Duplicate", "title": "how to call child method in parent method?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype Super struct{}\n\nfunc (super *Super) name() string {\n    return \"Super\"\n}\n\nfunc (super *Super) WhoAmI() {\n    fmt.Printf(\"I'm %s.\\n\", super.name())\n}\n\ntype Sub struct {\n    Super\n}\n\nfunc (sub *Sub) name() string {\n    return \"Sub\"\n}\n\nfunc main() {\n    sub := &amp;Sub{Super{}}\n    sub.WhoAmI()\n}\n</code></pre>\n\n<p>I want to get \"I'm Sub\", but I get \"I'm Super\" instead.</p>\n\n<p>I already know sub.WhoAmI will call sub.Super.WhoAmI, but I still want to know if there is a way to get \"I'm Sub\". In Python when I write following code:</p>\n\n<pre><code>class Super(object):\n\n    def name(self):\n        return \"Super\"\n\n    def WhoAmI(self):\n        print(\"I'm {name}\".format(name=self.name()))\n\nclass Sub(Super):\n\n    def name(self):\n        return \"Sub\"\n\n\nif __name__ == \"__main__\":\n    sub  = Sub()\n    sub.WhoAmI()\n</code></pre>\n\n<p>I can get \"I'm Sub\".</p>\n"}, {"tags": ["go", "append", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1447871856, "post_id": 33783281, "comment_id": 55342339, "body": "The &quot;problem&quot; is less the behaviour of append but your code which is needless complex."}, {"owner": {"reputation": 85, "user_id": 802833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c693ecdf3234f8b7b13797c2937e685?s=128&d=identicon&r=PG", "display_name": "kirk", "link": "https://stackoverflow.com/users/802833/kirk"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1447922486, "post_id": 33783281, "comment_id": 55363680, "body": "@Volker The example has been extracted out of a bigger context. If I need just to append the shown slices, there indeed is a simpler way :-)"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 802833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c693ecdf3234f8b7b13797c2937e685?s=128&d=identicon&r=PG", "display_name": "kirk", "link": "https://stackoverflow.com/users/802833/kirk"}, "edited": false, "score": 0, "creation_date": 1447922795, "post_id": 33786654, "comment_id": 55363875, "body": "Thanx for pointing to the blog post. So, in order to achieve the desired (and reproducible) behavior, I could write: <code>b := make([]int, len(a), len(a)+3); copy(b, a); b = append(b, []int{1, 2, 3})</code>"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "reply_to_user": {"reputation": 85, "user_id": 802833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c693ecdf3234f8b7b13797c2937e685?s=128&d=identicon&r=PG", "display_name": "kirk", "link": "https://stackoverflow.com/users/802833/kirk"}, "edited": false, "score": 1, "creation_date": 1447928697, "post_id": 33786654, "comment_id": 55368054, "body": "@kirk If you&#39;re appending to a slice <code>s</code>, always <i>always</i> write <code>s = append(s, value)</code>, so essentially &quot;yes&quot;."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 85, "user_id": 802833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c693ecdf3234f8b7b13797c2937e685?s=128&d=identicon&r=PG", "display_name": "kirk", "link": "https://stackoverflow.com/users/802833/kirk"}, "edited": false, "score": 0, "creation_date": 1447928940, "post_id": 33786654, "comment_id": 55368248, "body": "@kirk, yes, to make sure appending N elements won&#39;t reallocate the backing array, create a slice with enough capacity to hold your current data <i>plus</i> N, copy existing slice over to the new one and then append."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 6, "last_activity_date": 1447868098, "creation_date": 1447868098, "answer_id": 33786654, "question_id": 33783281, "link": "https://stackoverflow.com/questions/33783281/golang-appending-slices-with-or-w-o-allocation/33786654#33786654", "title": "Golang: appending slices with or w/o allocation", "body": "<p>You might maintain a wrong idea of how slices work in Go.</p>\n\n<p>When you append elements to a slice, the call to <code>append()</code> returns a new slice.  If reallocation did not happen, both slice values &mdash; the one you called <code>append()</code> on and the one it returned back &mdash; share the same backing array <em>but</em> they will have different lengths; observe:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := make([]int, 0, 10)\n    b := append(a, 1, 2, 3)\n    c := append(a, 4, 3, 2)\n    fmt.Printf(\"a=%#v\\nb=%#v\\nc=%#v\\n\", a, b, c)\n}\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>a=[]int{}\nb=[]int{4, 3, 2}\nc=[]int{4, 3, 2}\n</code></pre>\n\n<p>So, <code>len(a) == 0</code>, <code>len(b) == 3</code>, <code>len(c) == 3</code>, and the second call to <code>append()</code> owerwrote what the first one did because all the slices share the same underlying array.</p>\n\n<p>As to reallocation of the backing array, <a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"noreferrer\">the spec</a> is clear:</p>\n\n<blockquote>\n  <p>If the capacity of s is not large enough to fit the additional values, append allocates a new, sufficiently large underlying array that fits both the existing slice elements and the additional values. Otherwise, append re-uses the underlying array.</p>\n</blockquote>\n\n<p>From this, it follows that:</p>\n\n<ol>\n<li><code>append()</code> never copies the underlying storage if the capacity of the slice being appeneded to is sufficient.</li>\n<li>If there's not enough capacity, the array will be reallocated.</li>\n</ol>\n\n<p>That is, given a slice <code>s</code> to which you want to append <code>N</code> elements, the reallocation won't be done iff <code>cap(s) - len(s) \u2265 N</code>.</p>\n\n<p>Hence I suspect your problem is not about unexpected reallocation results but rather about the <em>concept</em> of slices as implemented in Go. The code idea to absorb is that <code>append()</code> <em>returns the resulting slice value,</em> which you're supposed to be using after the call <em>unless</em> you fully understand the repercussions.</p>\n\n<p>I recommend starting with <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">this</a> to fully understand them.</p>\n"}, {"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447929091, "post_id": 33799467, "comment_id": 55368362, "body": "About explicit memory allocation... That&#39;s yes and no. A common idiom to append to a slice is to just not bother and do <code>s = append(s, e1, e2, ...)</code> -- so that Go will make sure the backing array will be reallocated if appending would require it.  This frees you from thinking about memory management <i>unless</i> you have other slices pointing to the same data (i.e. you&#39;ve sliced the original slice before appending to it).  But that&#39;s a good tradeoff: it makes the simple case simple and the complex cases possible."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447929299, "post_id": 33799467, "comment_id": 55368510, "body": "One more point regarding that idiom I&#39;ve referred to, is that sometimes you know your slice will have <i>at least</i> N element (or may be more) or <i>at most</i> N elements. In either case it&#39;s possible to do a micro optimization and allocate the slice with length 0 and capacity <code>N</code> via <code>s := make([]T, 0, N)</code>. In the former case you will be guaranteed that appending the first <code>N</code> elements won&#39;t reallocate; in the second case you may waste some space trading this for appending speed. In either case, <i>please don&#39;t opmimize before you&#39;ve profiled!</i>"}], "tags": [], "owner": {"reputation": 85, "user_id": 802833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c693ecdf3234f8b7b13797c2937e685?s=128&d=identicon&r=PG", "display_name": "kirk", "link": "https://stackoverflow.com/users/802833/kirk"}, "is_accepted": true, "score": 0, "last_activity_date": 1447924223, "last_edit_date": 1592644375, "creation_date": 1447924223, "answer_id": 33799467, "question_id": 33783281, "link": "https://stackoverflow.com/questions/33783281/golang-appending-slices-with-or-w-o-allocation/33799467#33799467", "title": "Golang: appending slices with or w/o allocation", "body": "<p>Thanx for your feedback.</p>\n<p>So the solution to gain control of the memory allocation is to do it explicitely (which remembers me that Go is a more a system language than other (scripting) langs):</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\nfunc main() {\n\n    a1 := make([][]int, 3)\n    a2 := make([][]int, 3)\n    b := [][]int{{1, 1, 1}, {2, 2, 2}, {3, 3, 3}}\n    common1 := make([]int, 0)\n    common2 := make([]int, 0, 12) // provide sufficient capacity\n    common1 = append(common1, []int{10, 20}...)\n    common2 = append(common2, []int{10, 20}...)\n\n    idx := 0\n    for _, k := range b {\n        a1[idx] = append(common1, k...) // new slice is allocated\n        \n        a2[idx] = make([]int, len(common2), len(common2)+len(k))\n        copy(a2[idx], common2)      // copy &amp; append could probably be\n        a2[idx] = append(a2[idx], k...) // combined into a single copy step\n        \n        idx++\n    }\n\n    fmt.Println(a1)\n    fmt.Println(a2)\n}\n</code></pre>\n<p>output:</p>\n<blockquote>\n<p>[[10 20 1 1 1] [10 20 2 2 2] [10 20 3 3 3]]</p>\n<p>[[10 20 1 1 1] [10 20 2 2 2] [10 20 3 3 3]]</p>\n</blockquote>\n<p><a href=\"https://play.golang.org/p/Id_wSZwb84\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Id_wSZwb84</a></p>\n"}], "owner": {"reputation": 85, "user_id": 802833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c693ecdf3234f8b7b13797c2937e685?s=128&d=identicon&r=PG", "display_name": "kirk", "link": "https://stackoverflow.com/users/802833/kirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3039, "favorite_count": 0, "accepted_answer_id": 33799467, "answer_count": 2, "score": -4, "last_activity_date": 1447924223, "creation_date": 1447858545, "last_edit_date": 1592644375, "question_id": 33783281, "link": "https://stackoverflow.com/questions/33783281/golang-appending-slices-with-or-w-o-allocation", "title": "Golang: appending slices with or w/o allocation", "body": "<p>Go's <code>append()</code> function only allocates new slice data, when the capacity of the given slice is not sufficient (see also: <a href=\"https://stackoverflow.com/a/28143457/802833\">https://stackoverflow.com/a/28143457/802833</a>). This can lead to unexpected behavior (at least for me as a golang newbie):</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\nfunc main() {\n\n    a1 := make([][]int, 3)\n    a2 := make([][]int, 3)\n    b := [][]int{{1, 1, 1}, {2, 2, 2}, {3, 3, 3}}\n    common1 := make([]int, 0)\n    common2 := make([]int, 0, 12) // provide sufficient capacity\n    common1 = append(common1, []int{10, 20}...)\n    common2 = append(common2, []int{10, 20}...)\n\n    idx := 0\n    for _, k := range b {\n        a1[idx] = append(common1, k...) // new slice is allocated\n        a2[idx] = append(common2, k...) // no allocation\n        idx++\n    }\n\n    fmt.Println(a1)\n    fmt.Println(a2) // surprise!!!\n}\n</code></pre>\n<p>output:</p>\n<blockquote>\n<p>[[10 20 1 1 1] [10 20 2 2 2] [10 20 3 3 3]]</p>\n<p>[[10 20 3 3 3] [10 20 3 3 3] [10 20 3 3 3]]</p>\n</blockquote>\n<p><a href=\"https://play.golang.org/p/8PEqFxAsMt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8PEqFxAsMt</a></p>\n<p>So, what ist the (idomatic) way in Go to force allocation of new slice data or more precisely to make sure that the slice argument to <code>append()</code> remains unchanged?</p>\n"}, {"tags": ["csv", "logging", "go"], "comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447854128, "post_id": 33781161, "comment_id": 55329608, "body": "From your example it looks like only content of <code>msg</code> is the actual CSV. What is your expected output? <code>msg=&quot;100,Click,Android&quot;</code> or simply <code>100,Click,Android</code>?"}, {"owner": {"reputation": 4695, "user_id": 4057655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7e07910ec39b9b672b770c1a5c7613cd?s=128&d=identicon&r=PG&f=1", "display_name": "sag", "link": "https://stackoverflow.com/users/4057655/sag"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447908738, "post_id": 33781161, "comment_id": 55357603, "body": "Yes <code>msg</code> itself is a csv. So I simply need <code>100,Click,Android</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4695, "user_id": 4057655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7e07910ec39b9b672b770c1a5c7613cd?s=128&d=identicon&r=PG&f=1", "display_name": "sag", "link": "https://stackoverflow.com/users/4057655/sag"}, "edited": false, "score": 0, "creation_date": 1447996634, "post_id": 33806519, "comment_id": 55404733, "body": "That really helps. The reason I tried to use logger, is the file handling and daily rolling will be taken care by logger right? Is there any logger which take care of file rolling and also just prints the message?"}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "reply_to_user": {"reputation": 4695, "user_id": 4057655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7e07910ec39b9b672b770c1a5c7613cd?s=128&d=identicon&r=PG&f=1", "display_name": "sag", "link": "https://stackoverflow.com/users/4057655/sag"}, "edited": false, "score": 1, "creation_date": 1448019777, "post_id": 33806519, "comment_id": 55416938, "body": "Neither standard logger nor logrus can roll the log files. You can use <a href=\"https://github.com/natefinch/lumberjack\" rel=\"nofollow noreferrer\">lumberjack</a> package (which works with any <code>io.WriteCloser</code>) for this functionality, although I usually do this from outside, via process supervisors, like supervisord."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 1, "last_activity_date": 1448218481, "last_edit_date": 1448218481, "creation_date": 1447942945, "answer_id": 33806519, "question_id": 33781161, "link": "https://stackoverflow.com/questions/33781161/how-to-hide-loglevel-and-time-in-logrus/33806519#33806519", "title": "How to hide loglevel and time in logrus", "body": "<blockquote>\n  <p>I am trying to use logrus to write the CSV as logs. But I see the log level (info) and the time getting added to the CSV content in logs.</p>\n</blockquote>\n\n<p>It looks like you definitely shouldn't be using logrus, as the main reason it exists is creating <em>structured</em> logs, i.e. key-value style. Not sure why don't you simply do</p>\n\n<pre><code>fmt.Println(\"100,Click,Android\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>fmt.Fprintln(os.Stderr, \"100,Click,Android\")\n</code></pre>\n\n<p>if you want it to be written into the standard error (default for loggers).</p>\n\n<p>If for any reason you need a <em>logger,</em> you can pretty much do the same thing with the <a href=\"https://golang.org/pkg/log/\" rel=\"nofollow\">standard logger</a> by disabling flags:</p>\n\n<pre><code>log.SetFlags(0)\nlog.Println(\"100,Click,Android\")\n\n// Output:\n// 100,Click,Android\n</code></pre>\n\n<p>However, if you're creating a CSV output yourself (i.e. you have spearate fields rather than full CSV lines already), use <a href=\"https://golang.org/pkg/encoding/csv/\" rel=\"nofollow\">csv package</a> from the standard library:</p>\n\n<pre><code>w := csv.NewWriter(os.Stdout)\nw.Write([]string{\"100\", \"Click\", \"Android\"})\nw.Flush()\n\n// Output:\n// 100,Click,Android\n</code></pre>\n\n<p>Unless you just <em>want</em> to use logrus, then follow the concept of the package and stick with structured output:</p>\n\n<pre><code>logrus.WithFields(logrus.Fields{\n    \"id\": \"100\",\n    \"event\": \"Click\",\n    \"os\": \"Android\",\n}).Info(\"Hooray, we have some users!\")\n\n// Output:\n// time=\"2015-11-19T15:20:32+01:00\" level=info msg=\"Hooray, we have some users!\" event=Click id=100 os=Android\n</code></pre>\n"}], "owner": {"reputation": 4695, "user_id": 4057655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7e07910ec39b9b672b770c1a5c7613cd?s=128&d=identicon&r=PG&f=1", "display_name": "sag", "link": "https://stackoverflow.com/users/4057655/sag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1568, "favorite_count": 0, "accepted_answer_id": 33806519, "answer_count": 1, "score": 2, "last_activity_date": 1448218481, "creation_date": 1447852709, "last_edit_date": 1592644375, "question_id": 33781161, "link": "https://stackoverflow.com/questions/33781161/how-to-hide-loglevel-and-time-in-logrus", "title": "How to hide loglevel and time in logrus", "body": "<p>I am trying to write the logs in CSV format. I am trying to use <a href=\"https://github.com/Sirupsen/logrus\" rel=\"nofollow noreferrer\">logrus</a> to write the CSV as logs. But I see the log level (info) and the time getting added to the CSV content in logs. Like,</p>\n<p>time=&quot;2015-11-18T01:27:38-04:00&quot; level=info msg=&quot;100,Click,Android&quot;</p>\n<p>How can I write only my message using logrus?\nOr should I use any other loggers available in golang?</p>\n<p>Note: I am a newbie to go</p>\n"}, {"tags": ["arrays", "sorting", "multidimensional-array", "go", "slice"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1447852600, "post_id": 33781020, "comment_id": 55328429, "body": "You are mixing the term array and slice throughout your question. I would recommend reading <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">this article</a> for some clarification."}, {"owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "edited": false, "score": 1, "creation_date": 1447853593, "post_id": 33781020, "comment_id": 55329240, "body": "Fetching the smallest non-zero value does not require sorting the array, in fact  it&#39;ll be rather wasteful."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1447853595, "last_edit_date": 1447853595, "creation_date": 1447852516, "answer_id": 33781097, "question_id": 33781020, "link": "https://stackoverflow.com/questions/33781020/sort-multidimensional-array-slice/33781097#33781097", "title": "Sort multidimensional array/slice", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow\">Slice expressions</a></p>\n  \n  <p>Slice expressions construct a substring or slice from a string, array,\n  pointer to array, or slice. There are two variants: a simple form that\n  specifies a low and high bound, and a full form that also specifies a\n  bound on the capacity. </p>\n  \n  <p>Simple slice expressions</p>\n  \n  <p>For a string, array, pointer to array, or slice a, the primary\n  expression</p>\n\n<pre><code>a[low : high]\n</code></pre>\n  \n  <p>constructs a substring or slice. The indices low and high select which\n  elements of operand a appear in the result. The result has indices\n  starting at 0 and length equal to high - low. After slicing the array\n  a</p>\n\n<pre><code>a := [5]int{1, 2, 3, 4, 5}\ns := a[1:4]\n</code></pre>\n  \n  <p>the slice s has type []int, length 3, capacity 4, and elements</p>\n\n<pre><code>s[0] == 2\ns[1] == 3\ns[2] == 4\n</code></pre>\n  \n  <p>For convenience, any of the indices may be omitted. A missing low\n  index defaults to zero; a missing high index defaults to the length of\n  the sliced operand: </p>\n\n<pre><code>a[2:]  // same as a[2 : len(a)]\na[:3]  // same as a[0 : 3]\na[:]   // same as a[0 : len(a)]\n</code></pre>\n  \n  <p>If a is a pointer to an array, a[low : high] is shorthand for (*a)[low\n  : high].</p>\n</blockquote>\n\n<p>To convert type <code>[5]int</code> to type <code>[]int</code>, slice the array. For example,</p>\n\n<pre><code>package main\n\nimport \"sort\"\n\nfunc main() {\n    var distancematrix [5][5]int\n    sort.Ints(distancematrix[0][:])\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1447857755, "last_edit_date": 1447857755, "creation_date": 1447852789, "answer_id": 33781188, "question_id": 33781020, "link": "https://stackoverflow.com/questions/33781020/sort-multidimensional-array-slice/33781188#33781188", "title": "Sort multidimensional array/slice", "body": "<p>var distancematrix [5][5]int, will create multidimensional array slice of 5 * 5 int. And when you try to access distancematrix[0], it returns int array slice of type [5]int. Where as sort.Ints expects type []int. </p>\n\n<p>Here below I have declared distancematrix of type [][] and hence distancematrix[0] returns slice array of type []int. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc main() {\n    distancematrix := [][]int{{0, 154, 12, 35, 138}, {0, 0, 0, 0, 0}}\n    sort.Ints(distancematrix[0])\n    fmt.Println(distancematrix[0])\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 1, "creation_date": 1447854055, "post_id": 33781401, "comment_id": 55329565, "body": "+1 for the key points: 1. the array doesn&#39;t need to be sorted to find the smallest element, and 2. that sorting arrays/slices is typically a much more expensive operation than a one pass search."}, {"owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "edited": false, "score": 0, "creation_date": 1447859564, "post_id": 33781401, "comment_id": 55333931, "body": "Thanks a lot icza :)  That resolves my query.  Also, canyou tell me how can I get the index of the smallest positive number ?  Like I tried this :  func smallestNonZeroIndex(s []int) (n int) { \tvar i int \tfor i, v := range s { \t\tif v &gt; 0 &amp;&amp; (v &lt; n || n == 0) { \t\t\tn = v \t\t\ti++ \t\t} \t} \treturn i } but it returns 0 always.  Thanks in advance .."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "edited": false, "score": 0, "creation_date": 1447861227, "post_id": 33781401, "comment_id": 55335220, "body": "@fnaticRCggwp If you use <code>for range</code>, you shouldn&#39;t increment the loop variable <code>i</code> as it is incremented automatically/internally. Just copy my code from the answer."}, {"owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "edited": false, "score": 0, "creation_date": 1447884120, "post_id": 33781401, "comment_id": 55349652, "body": "@ICZA I need the INDEX of the SMALLLEST POSITIVE NUMBER.   How can I get that using FOR LOOP ?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1475313552, "last_edit_date": 1475313552, "creation_date": 1447853420, "answer_id": 33781401, "question_id": 33781020, "link": "https://stackoverflow.com/questions/33781020/sort-multidimensional-array-slice/33781401#33781401", "title": "Sort multidimensional array/slice", "body": "<p>To get the smallest non-zero element, you don't need to sort it. Sorting an array or slice is relatively a costly operation - compared to just getting the smallest non-zero element.</p>\n\n<p>Generally to get the smallest non-zero element, just loop over the values, and look for the value that fits you best. If you find a better one (in your example a smaller non-zero), keep that and continue.</p>\n\n<p>Example implementation:</p>\n\n<pre><code>func smallestNonZero(s []int) (n int) {\n    for _, v := range s {\n        if v != 0 &amp;&amp; (v &lt; n || n == 0) {\n            n = v\n        }\n    }\n    return\n}\n</code></pre>\n\n<p><strong>Note:</strong> This function will return <code>0</code> if and only if the passed slice does not contain any non-zero element (that is, it's either full of <code>0</code>s or it's empty or it's <code>nil</code>). This function also works properly if the slice (also) contains negative numbers.</p>\n\n<p>If you have an array and not a slice, simply slice the array (which results in a slice) and so you can pass it to the function above.</p>\n\n<p>Using it: </p>\n\n<pre><code>fmt.Println(smallestNonZero([]int{5, 3, 1, 4}))\nfmt.Println(smallestNonZero([]int{0, 3, 5, 8, 0, 2, 9}))\narr := [5]int{0, 154, 12, 35, 138}\nfmt.Println(smallestNonZero(arr[:]))\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/zQ0-XQP8Fq\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>1\n2\n12\n</code></pre>\n"}], "owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 1, "accepted_answer_id": 33781401, "answer_count": 3, "score": 4, "last_activity_date": 1475313700, "creation_date": 1447852308, "last_edit_date": 1475313700, "question_id": 33781020, "link": "https://stackoverflow.com/questions/33781020/sort-multidimensional-array-slice", "title": "Sort multidimensional array/slice", "body": "<p>I have created a multidimensional array (slice) in Go as follows: </p>\n\n<pre><code>var distancematrix [5][5]int\n</code></pre>\n\n<p>So it is a 5*5 array/slice.\nNow I am inserting values into this slice such that at a point:</p>\n\n<pre><code>distancematrix :  [[0 154 12 35 138] [0 0 0 0 0] [0 0 0 0 0] [0 0 0 0 0] [0 0 0 0 0]]\n</code></pre>\n\n<p>Now, I want to sort this array in ascending order, e.g.:</p>\n\n<pre><code>sorteddistancematrix :  [[0 12 35  138 154] [0 0 0 0 0] [0 0 0 0 0] [0 0 0 0 0] [0 0 0 0 0]]\n</code></pre>\n\n<p>I tried <code>sort.Ints(distancematrix[0])</code> but it throws an error saying: </p>\n\n<pre><code>cannot use distancematrix[0] (type [5]int) as type []int in argument to sort.Ints\n</code></pre>\n\n<p>Basically, <strong>I want to fetch the smallest non-zero value in the array</strong>. \nHow can I sort this array to achieve this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1447851367, "post_id": 33780595, "comment_id": 55327582, "body": "<i>isn&#39;t the golang&#39;s regexp.MatchString is fully match?</i> No, it&#39;s not."}, {"owner": {"reputation": 1748, "user_id": 930125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1ccd7cb24e271b7850448de4600b428b?s=128&d=identicon&r=PG", "display_name": "toolchainX", "link": "https://stackoverflow.com/users/930125/toolchainx"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1447851608, "post_id": 33780595, "comment_id": 55327751, "body": "is there any fully match function?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1447851801, "post_id": 33780595, "comment_id": 55327881, "body": "Just add anchors to your expression: <code>^[a-z]+$</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "reply_to_user": {"reputation": 1748, "user_id": 930125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1ccd7cb24e271b7850448de4600b428b?s=128&d=identicon&r=PG", "display_name": "toolchainX", "link": "https://stackoverflow.com/users/930125/toolchainx"}, "edited": false, "score": 0, "creation_date": 1448026558, "post_id": 33782185, "comment_id": 55420941, "body": "@toolchainX - thank you! Your question seemed reasonable to me, so I don&#39;t really understand the down votes without any links to existing answers or the web. Best of luck using Go; IMHO it is a lovely language."}], "tags": [], "owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "is_accepted": true, "score": 2, "last_activity_date": 1447855632, "creation_date": 1447855632, "answer_id": 33782185, "question_id": 33780595, "link": "https://stackoverflow.com/questions/33780595/whats-wrong-with-the-golang-regexp-matchstring/33782185#33782185", "title": "what&#39;s wrong with the golang regexp.matchString?", "body": "<p>The regular expression \"[a-z]+\" will match \"test\" is the search text \"test?\".<br>\nSimilarly, it will match \"<strong>testing</strong> testing\", \"2001 <strong>a</strong> space oddessy\", etc.</p>\n\n<p>Go lang's <a href=\"https://golang.org/pkg/regexp/\" rel=\"nofollow\">regexp package</a> matches search text according to the <em>syntax</em> and <em>meaning</em> of the regular expression. There isn't a method which <em>itself</em> tries to match the regular expression with the entire search text, and gives up if it can't, <em>unless</em> the regular expression defines that an entire search-text-match is the required behaviour. </p>\n\n<p>The syntax of regular expressions does enable matching the entire search text. </p>\n\n<p><strong>'^'</strong>, the start-anchor symbol at the start of the regular expression forces the match to include the start of the search text.<br>\n<strong>'$'</strong>, the end-anchor symbol at the end of the regular expression forces the match to include the end of the search text.<br>\nThey have different meaning in other positions within a regular expression.</p>\n\n<p>As @TomCooper commented, use both start and end anchors around the regular expression pattern you are looking for. These anchor the enclosed regular expression to the start and end of the search text to ensure the entire search text matches the regular expression.</p>\n"}], "owner": {"reputation": 1748, "user_id": 930125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1ccd7cb24e271b7850448de4600b428b?s=128&d=identicon&r=PG", "display_name": "toolchainX", "link": "https://stackoverflow.com/users/930125/toolchainx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1881, "favorite_count": 1, "accepted_answer_id": 33782185, "answer_count": 1, "score": 1, "last_activity_date": 1447855632, "creation_date": 1447851104, "last_edit_date": 1447854365, "question_id": 33780595, "link": "https://stackoverflow.com/questions/33780595/whats-wrong-with-the-golang-regexp-matchstring", "title": "what&#39;s wrong with the golang regexp.matchString?", "body": "<p>can any one explain why does this match <a href=\"https://play.golang.org/p/NJXD-nKnu7\" rel=\"nofollow\">play</a>? </p>\n\n<p>Source:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\n\nfunc main() {\n    match, _ := regexp.MatchString(\"[a-z]+\", \"test?\")\n    fmt.Printf(\"the result of match: %v\", match)\n}\n</code></pre>\n\n<p>isn't the golang's <code>regexp.MatchString</code> is fully match? I can't understand and I am a newbie for golang</p>\n"}, {"tags": ["json", "mongodb", "go"], "comments": [{"owner": {"reputation": 2459, "user_id": 5273255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xj4dE.jpg?s=128&g=1", "display_name": "Can O&#39; Spam", "link": "https://stackoverflow.com/users/5273255/can-o-spam"}, "edited": false, "score": 0, "creation_date": 1447841930, "post_id": 33777264, "comment_id": 55321181, "body": "What&#39;s the problem you are having? How to you struct you JSON? Can you provide code?"}], "answers": [{"tags": [], "owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "is_accepted": false, "score": 0, "last_activity_date": 1447843242, "last_edit_date": 1495541035, "creation_date": 1447843242, "answer_id": 33777839, "question_id": 33777264, "link": "https://stackoverflow.com/questions/33777264/embedded-json-struct/33777839#33777839", "title": "Embedded JSON struct", "body": "<p>For <code>encoding/json</code> to be able to marshal your struct, it needs to see the fields you want it to serialize.\nIn your case, <code>student.student</code> is not exported and therefore not visible to <code>encoding/json</code>. Export it and it works:</p>\n\n<pre><code>type student struct {\n    Student []studentData `json:\"student\"`\n}\n</code></pre>\n\n<p>A note on the side: Use something else than \"Student\" for a field of type <code>[]studentData</code> in a struct named \"student\". Maybe something like \"Grades\" or \"TranscriptInformation\"?</p>\n\n<p>Another note on the side: Your desired JSON is not \"right\", identifiers/keys should not be capitalized, i.e. <code>\"Name\"</code> should be <code>\"name\"</code>.</p>\n\n<p>Also, the search for <code>[go] embedded json</code> turned up questions like <a href=\"https://stackoverflow.com/questions/31599836/marshal-embedded-struct/31600100#31600100\">this</a> ;)</p>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 2, "last_activity_date": 1447857049, "creation_date": 1447857049, "answer_id": 33782693, "question_id": 33777264, "link": "https://stackoverflow.com/questions/33777264/embedded-json-struct/33782693#33782693", "title": "Embedded JSON struct", "body": "<p>Although your JSON doesn't make a lot of sense, this will output the exact JSON you want:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"os\"\n)\n\ntype Student struct {\n    Name  string `json:\"name\"`\n    Grade int    `json:\"Grade\"`\n}\n\ntype Students struct {\n    Array []Student `json:\"array\"`\n}\n\nfunc main() {\n\n    student1 := Student{\n        Name: \"Josh\",\n        Grade: 2,\n    }\n\n    student2 := Student{\n        Name: \"Sarah\",\n        Grade: 4,\n    }\n\n    students := Students{\n        Array: []Student{student1, student2},\n    }\n\n    b, err := json.Marshal(students)\n    if err != nil {\n        panic(err)\n    }\n\n    os.Stdout.Write(b)\n}\n</code></pre>\n\n<p>Try the code here <a href=\"https://play.golang.org/p/PcPZOuxJUM\" rel=\"nofollow\">https://play.golang.org/p/PcPZOuxJUM</a></p>\n"}], "owner": {"reputation": 249, "user_id": 1099048, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1260843c6e5f21070791189681043525?s=128&d=identicon&r=PG", "display_name": "ranggadablues", "link": "https://stackoverflow.com/users/1099048/ranggadablues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 33782693, "answer_count": 2, "score": -1, "last_activity_date": 1447857049, "creation_date": 1447841696, "last_edit_date": 1447843182, "question_id": 33777264, "link": "https://stackoverflow.com/questions/33777264/embedded-json-struct", "title": "Embedded JSON struct", "body": "<p>Here my struct</p>\n\n<pre><code>    type studentData struct {\n        Name  string `bson:\"name\"`\n        Grade int    `bson:\"Grade\"`\n    }\n\n    type student struct {\n        student []studentData `json:\"student\"`\n    }\n</code></pre>\n\n<p>I need my JSON result like this</p>\n\n<pre><code>{\n  \"array\": [\n    {\n      \"Name\": \"ethan\",\n      \"Grade\": 2\n    },\n    {\n      \"Name\": \"rangga\",\n      \"Grade\": 2\n    }\n  ]\n}\n</code></pre>\n\n<p>I get the data from mongoDB, already tried to search but did not found that i need, could someone help me?</p>\n"}, {"tags": ["go", "intellij-idea", "goland"], "comments": [{"owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "edited": false, "score": 3, "creation_date": 1448114628, "post_id": 33774950, "comment_id": 55452919, "body": "I&#39;d recommend using <a href=\"https://godoc.org/golang.org/x/tools/cmd/goimports\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/tools/cmd/goimports</a> instead of the standard gofmt. Goimports not only runs gofmt, but it also fixes your imports."}], "answers": [{"comments": [{"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "edited": false, "score": 5, "creation_date": 1448723407, "post_id": 33776710, "comment_id": 55701851, "body": "This always reformats every file in my repo, even Godeps/*.  So I hardcoded my path instead.  Any way to use $FilePath$ without recursively formatting every file in the repo every time?  Seems like FilePath is having a domino effect for me ."}, {"owner": {"reputation": 1847, "user_id": 391464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XdRz.png?s=128&g=1", "display_name": "yee", "link": "https://stackoverflow.com/users/391464/yee"}, "reply_to_user": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "edited": false, "score": 1, "creation_date": 1448856293, "post_id": 33776710, "comment_id": 55738368, "body": "@jayunit100 You can configure the <i>Scope</i> param  1. add a <b>local scope</b> 2. name it &amp; set <b>Pattern</b> to:     file[$proj]:*/&amp;&amp;!file[$proj]:Godeps//*  !<a href=\"http://i.imgur.com/OLxLu55.png?1\" rel=\"nofollow noreferrer\">snapshot</a>"}, {"owner": {"reputation": 1937, "user_id": 1824583, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/adcb2a18ddf812cf73f5dcf166ea8294?s=128&d=identicon&r=PG", "display_name": "bia.migueis", "link": "https://stackoverflow.com/users/1824583/bia-migueis"}, "edited": false, "score": 1, "creation_date": 1449616149, "post_id": 33776710, "comment_id": 56082976, "body": "This doesnt allow me to edit my files. When i try to add a new line to code some more the program brings me back to the previous line and deletes my new line. how do i stop that? note: using phpstorm"}, {"owner": {"reputation": 1937, "user_id": 1824583, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/adcb2a18ddf812cf73f5dcf166ea8294?s=128&d=identicon&r=PG", "display_name": "bia.migueis", "link": "https://stackoverflow.com/users/1824583/bia-migueis"}, "edited": false, "score": 6, "creation_date": 1449617439, "post_id": 33776710, "comment_id": 56083515, "body": "never mind, i figured it out. &quot;immediate file sync&quot; will make it so fmt runs as soon as you make any changes. just unselect it and it will only run on file save (or window unfocus)"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 1937, "user_id": 1824583, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/adcb2a18ddf812cf73f5dcf166ea8294?s=128&d=identicon&r=PG", "display_name": "bia.migueis", "link": "https://stackoverflow.com/users/1824583/bia-migueis"}, "edited": false, "score": 0, "creation_date": 1453214702, "post_id": 33776710, "comment_id": 57497248, "body": "@bia.migueis Yeah, you&#39;re right. Immediate file sync must be omitted to fmt only on save."}, {"owner": {"reputation": 1747, "user_id": 1759987, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/123bcfdcb5c7add924028320fc883683?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1759987/aaron"}, "edited": false, "score": 2, "creation_date": 1543601149, "post_id": 33776710, "comment_id": 93991046, "body": "Heads up, this answer is somewhat out of date now: the File Watchers plugin now has a pre-built &quot;go fmt&quot; watcher you can add without needing to do much work at all."}], "tags": [], "owner": {"reputation": 1847, "user_id": 391464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XdRz.png?s=128&g=1", "display_name": "yee", "link": "https://stackoverflow.com/users/391464/yee"}, "is_accepted": true, "score": 143, "last_activity_date": 1447841799, "last_edit_date": 1447841799, "creation_date": 1447840342, "answer_id": 33776710, "question_id": 33774950, "link": "https://stackoverflow.com/questions/33774950/execute-gofmt-on-file-save-in-intellij/33776710#33776710", "title": "Execute gofmt on file save in IntelliJ", "body": "<p>Of course you can.</p>\n\n<ol>\n<li>install <a href=\"http://plugins.jetbrains.com/plugin/7177\" rel=\"noreferrer\">File Watchers plugin</a></li>\n<li>open \"Preferences->Tools->File Watchers\" &amp; Add a new watcher</li>\n<li>set <code>File Type</code>: <code>Go</code>, <code>Program</code>: the abosolute path of <code>gofmt</code>, <code>Arguments</code>: <code>-w $FilePath$</code></li>\n<li>click <code>OK</code></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/dDSyh.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/dDSyh.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1086, "user_id": 1484264, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b618e0f5fe038679b5938a2123cc9304?s=128&d=identicon&r=PG", "display_name": "spotter", "link": "https://stackoverflow.com/users/1484264/spotter"}, "edited": false, "score": 1, "creation_date": 1488333637, "post_id": 42169265, "comment_id": 72180587, "body": "gogland isn&#39;t the same as the go plugin."}, {"owner": {"reputation": 399, "user_id": 4591217, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eA8-UOJE4rI/AAAAAAAAAAI/AAAAAAAAARI/kYrgAnLy2kI/photo.jpg?sz=128", "display_name": "Alex Pavlenko", "link": "https://stackoverflow.com/users/4591217/alex-pavlenko"}, "edited": false, "score": 0, "creation_date": 1493357838, "post_id": 42169265, "comment_id": 74391523, "body": "It&#39;s almost the same just like python plugin vs pycharm. The only possible difference is lag on updates. Other then this - it provides you with exactly the same features set."}, {"owner": {"reputation": 1410, "user_id": 1662069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076911833bf08bdd287142c5e26b833c?s=128&d=identicon&r=PG", "display_name": "Zangetsu", "link": "https://stackoverflow.com/users/1662069/zangetsu"}, "edited": false, "score": 27, "creation_date": 1509993719, "post_id": 42169265, "comment_id": 81237185, "body": "On Save mechanism is deprecated and will be removed in future. Use File Watchers plugin instead"}, {"owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 3, "creation_date": 1533224318, "post_id": 42169265, "comment_id": 90278666, "body": "But even in latest GoLand, I do not see this option. I though when right click on filename, under &quot;Go&quot;, I can fmt file. but I do not see the option to enable it during autosave."}], "tags": [], "owner": {"reputation": 1967, "user_id": 1031871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7g8bJ.jpg?s=128&g=1", "display_name": "Arun Gopalpuri", "link": "https://stackoverflow.com/users/1031871/arun-gopalpuri"}, "is_accepted": false, "score": 54, "last_activity_date": 1486763533, "creation_date": 1486763533, "answer_id": 42169265, "question_id": 33774950, "link": "https://stackoverflow.com/questions/33774950/execute-gofmt-on-file-save-in-intellij/42169265#42169265", "title": "Execute gofmt on file save in IntelliJ", "body": "<p>If you are using Gogland, you have an option On Save under Preferences</p>\n\n<p><a href=\"https://i.stack.imgur.com/3bDGd.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/3bDGd.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1264, "user_id": 978164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/IHZqs.jpg?s=128&g=1", "display_name": "dux2", "link": "https://stackoverflow.com/users/978164/dux2"}, "edited": false, "score": 9, "creation_date": 1527067657, "post_id": 49169729, "comment_id": 87982304, "body": "Actually its better to setup only goimports instead of go fmt because it also performs fmt, as specified in the goimports docs: &quot;in addition to fixing imports, goimports also formats your code in the same style as gofmt so it can be used as a replacement for your editor&#39;s gofmt-on-save hook&quot;"}, {"owner": {"reputation": 1045, "user_id": 1623885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OFggV.jpg?s=128&g=1", "display_name": "George Aristy", "link": "https://stackoverflow.com/users/1623885/george-aristy"}, "edited": false, "score": 2, "creation_date": 1539357254, "post_id": 49169729, "comment_id": 92486252, "body": "This is the correct answer for Goland as of Oct 2018"}], "tags": [], "owner": {"reputation": 6835, "user_id": 6305235, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kEy0G.jpg?s=128&g=1", "display_name": "David Miguel", "link": "https://stackoverflow.com/users/6305235/david-miguel"}, "is_accepted": false, "score": 61, "last_activity_date": 1520501640, "creation_date": 1520501640, "answer_id": 49169729, "question_id": 33774950, "link": "https://stackoverflow.com/questions/33774950/execute-gofmt-on-file-save-in-intellij/49169729#49169729", "title": "Execute gofmt on file save in IntelliJ", "body": "<p><a href=\"https://blog.jetbrains.com/go/2017/10/18/gogland-eap-16-file-watcher-tons-of-new-inspections-smarter-navigate-to-test-and-more/\" rel=\"noreferrer\">Gogland EAP 16</a> deprecated the On Save actions and replaced them with the <a href=\"https://plugins.jetbrains.com/plugin/7177-file-watchers\" rel=\"noreferrer\">File Watchers plugin</a>.</p>\n\n<p>If you have previously configured On Save actions, the IDE will prompt you to install the plugin and configure everything automatically. If you want to set it up from scratch yourself, check if you have File Watchers plugin and if not install it.</p>\n\n<p><strong>Enable gofmt:</strong></p>\n\n<ol>\n<li>Go to <code>Settings | Tools | File Watchers</code>.</li>\n<li>Click the <code>+</code> button and select <code>go fmt</code>.</li>\n<li>The default values are good. </li>\n<li>In Advance Options select:\n\n<ul>\n<li>Auto-save edited files to trigger the watcher</li>\n<li>Trigger the watcher on external changes</li>\n</ul></li>\n<li>Click ok!</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/vMXjQ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/vMXjQ.png\" alt=\"Config\"></a></p>\n\n<p>You can do the same for <code>goimports</code> and <code>gometalinter</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2725, "user_id": 303114, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/kBVST.jpg?s=128&g=1", "display_name": "danfromisrael", "link": "https://stackoverflow.com/users/303114/danfromisrael"}, "edited": false, "score": 1, "creation_date": 1611037585, "post_id": 65681774, "comment_id": 116314064, "body": "works like magic!"}], "tags": [], "owner": {"reputation": 1715, "user_id": 8712494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iWUnn1PqAuw/AAAAAAAAAAI/AAAAAAAAAGQ/2OslFo_DLk4/photo.jpg?sz=128", "display_name": "Amin Shojaei", "link": "https://stackoverflow.com/users/8712494/amin-shojaei"}, "is_accepted": false, "score": 2, "last_activity_date": 1610456239, "last_edit_date": 1610456239, "creation_date": 1610446141, "answer_id": 65681774, "question_id": 33774950, "link": "https://stackoverflow.com/questions/33774950/execute-gofmt-on-file-save-in-intellij/65681774#65681774", "title": "Execute gofmt on file save in IntelliJ", "body": "<p>Updated:</p>\n<p>For new versions of the Goland:</p>\n<ol>\n<li>open <code>File-&gt;Settings-&gt;Tools-&gt;File Watchers</code></li>\n<li>click on <code>+</code> button and choose <code>go fmt</code></li>\n<li>press <code>Ok</code></li>\n</ol>\n<p>Done :)</p>\n"}], "owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41159, "favorite_count": 16, "accepted_answer_id": 33776710, "answer_count": 4, "score": 95, "last_activity_date": 1610456239, "creation_date": 1447835088, "last_edit_date": 1520512209, "question_id": 33774950, "link": "https://stackoverflow.com/questions/33774950/execute-gofmt-on-file-save-in-intellij", "title": "Execute gofmt on file save in IntelliJ", "body": "<p>I use IntelliJ with the Golang plugin.  Is it possible to configure the IDE to execute gofmt on file save?</p>\n"}, {"tags": ["unit-testing", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 3732, "user_id": 1283020, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd2b1d4e7e61071b0c144d2d952e2213?s=128&d=identicon&r=PG", "display_name": "Krut", "link": "https://stackoverflow.com/users/1283020/krut"}, "edited": false, "score": 0, "creation_date": 1447878807, "post_id": 33774754, "comment_id": 55346666, "body": "Thanks for the response, I ended up dropping the const, adding a global <code>var testServer *httptest.Server</code> and a <code>func getURL() string</code> that checks if testServer is nil.  Logic being, it&#39;s less likely production code will set a testServer then accidentally mutate a global string var"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1447842788, "last_edit_date": 1447842788, "creation_date": 1447834405, "answer_id": 33774754, "question_id": 33774420, "link": "https://stackoverflow.com/questions/33774420/redefine-const-in-golang-for-test/33774754#33774754", "title": "Redefine const in golang for test", "body": "<p>If your code uses a const value, it is not <em>testing-friendly</em> (regarding testing with different values of that parameter).</p>\n\n<p>You could approach your problem with a slight refactoring. Let's say you have a function that uses this const:</p>\n\n<pre><code>const baseUrl = \"http://google.com\"\n\nfunc MyFunc() string {\n    // use baseUrl\n}\n</code></pre>\n\n<p>You could create another function that takes base URL as a parameter, and your original <code>MyFunc()</code> calls this:</p>\n\n<pre><code>const baseUrl_ = \"http://google.com\"\n\nfunc MyFunc() string {\n    // Call other function passing the const value\n    return myFuncImpl(baseUrl_)\n}\n\nfunc myFuncImpl(baseUrl string) string {\n    // use baseUrl\n    // Same implementation that was in your original MyFunc() function\n}\n</code></pre>\n\n<p>This way the API of your library doesn't change, but now you can test the functionality of your original <code>MyFunc()</code> by testing <code>myFuncImpl()</code>, and you can pass any value to test with.</p>\n\n<p>Calling <code>MyFunc()</code> will remain safe as it always passes the const <code>baseUrl_</code> to <code>myFuncImpl()</code> where the implementation now resides. It's your decision whether you make this new <code>myFuncImpl()</code> function exported or not; it may remain unexported as testing code may (should) be placed in the same package and can call it without problems.</p>\n"}], "owner": {"reputation": 3732, "user_id": 1283020, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd2b1d4e7e61071b0c144d2d952e2213?s=128&d=identicon&r=PG", "display_name": "Krut", "link": "https://stackoverflow.com/users/1283020/krut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6774, "favorite_count": 0, "accepted_answer_id": 33774754, "answer_count": 1, "score": 8, "last_activity_date": 1447842788, "creation_date": 1447833083, "last_edit_date": 1447834826, "question_id": 33774420, "link": "https://stackoverflow.com/questions/33774420/redefine-const-in-golang-for-test", "title": "Redefine const in golang for test", "body": "<p>I'm writing an http client for a service and for testing I want to use a <code>net/http/httptest</code> server instead of calling out to the remote API.  I can easily do this if I make the <code>baseUrl</code> a global variable which gets set to the url of my test server. However, this makes the production code more fragile because <code>baseUrl</code> can also be changed during runtime.  My preference would be to make <code>baseUrl</code> a <code>const</code> for production code but still be able to change.</p>\n\n<pre><code>package main\nconst baseUrl = \"http://google.com\"\n\n// in main_test.go\nts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n  ...\n }\nconst baseUrl = ts.URL\n// above line throws const baseUrl already defined error\n</code></pre>\n"}, {"tags": ["javascript", "html", "http", "go", "multipartform-data"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1447826389, "post_id": 33771167, "comment_id": 55312677, "body": "first step, use curl to check is server OK."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1447826489, "post_id": 33771167, "comment_id": 55312711, "body": "You need to set the method and enctype attributes on your form tag. The input tag is irrelevant for GET/POST decision, multipart encoding and content type setting."}, {"owner": {"reputation": 1206, "user_id": 5180802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-C9Feof_ezik/AAAAAAAAAAI/AAAAAAAATQo/-PlxZxs79hY/photo.jpg?sz=128", "display_name": "redsalt", "link": "https://stackoverflow.com/users/5180802/redsalt"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1447857461, "post_id": 33771167, "comment_id": 55332291, "body": "@Volker I thought that specifying <code>method: post</code> and <code>header: {&#39;Content-Type&#39;: &#39;multipart&#47;form-data&#39;}</code> in fetch was enough and that I didn&#39;t need a &lt;form&gt; tag, but I tried using a &lt;form&gt; tag as well which looks like this <code>&lt;form id=&quot;form&quot; method=&quot;post&quot; enctype=&quot;multipart&#47;form-data&quot; action=&quot;&#47;submit&quot;&gt;</code>, I then use <code>new FormData</code> to submit the data in that form but that doesn&#39;t work so I guess it must be something else."}, {"owner": {"reputation": 1206, "user_id": 5180802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-C9Feof_ezik/AAAAAAAAAAI/AAAAAAAATQo/-PlxZxs79hY/photo.jpg?sz=128", "display_name": "redsalt", "link": "https://stackoverflow.com/users/5180802/redsalt"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1447858471, "post_id": 33771167, "comment_id": 55333107, "body": "@JiangYD When I use curl the console where I&#39;m running <code>go run main.go</code> logs nothing as if the submit function was never run. I&#39;m using this command: <code>curl -v -F &#39;uploadFile=@\\&quot;C:&#47;Users&#47;raul-&#47;Desktop&#47;test.png\\&quot;&#39; http:&#47;&#47;localhost:8080&#47;submit</code> in Windows. I get a <code>HTTP&#47;1.1 301 Moved Permanently</code> response and says <code>HTTP error before end of send, stop sending</code> which may explain why the submit function is not run."}, {"owner": {"reputation": 1206, "user_id": 5180802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-C9Feof_ezik/AAAAAAAAAAI/AAAAAAAATQo/-PlxZxs79hY/photo.jpg?sz=128", "display_name": "redsalt", "link": "https://stackoverflow.com/users/5180802/redsalt"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1447858859, "post_id": 33771167, "comment_id": 55333386, "body": "@JiangYD I updated my question with the entire curl output in case you need more information"}], "answers": [{"comments": [{"owner": {"reputation": 356, "user_id": 3104032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FCOUO.jpg?s=128&g=1", "display_name": "darkdefender27", "link": "https://stackoverflow.com/users/3104032/darkdefender27"}, "edited": false, "score": 0, "creation_date": 1507617589, "post_id": 33809474, "comment_id": 80268660, "body": "Thanks for the insight. Helped me a lot."}, {"owner": {"reputation": 358, "user_id": 3257051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/URqC6.jpg?s=128&g=1", "display_name": "Odd", "link": "https://stackoverflow.com/users/3257051/odd"}, "edited": false, "score": 0, "creation_date": 1613995684, "post_id": 33809474, "comment_id": 117239901, "body": "&quot;note the missing slash&quot; saved my day. Please emphasise your note as this might often be the culprit- +1"}], "tags": [], "owner": {"reputation": 1206, "user_id": 5180802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-C9Feof_ezik/AAAAAAAAAAI/AAAAAAAATQo/-PlxZxs79hY/photo.jpg?sz=128", "display_name": "redsalt", "link": "https://stackoverflow.com/users/5180802/redsalt"}, "is_accepted": true, "score": 11, "last_activity_date": 1447950901, "creation_date": 1447950901, "answer_id": 33809474, "question_id": 33771167, "link": "https://stackoverflow.com/questions/33771167/handle-file-uploading-with-go/33809474#33809474", "title": "Handle file uploading with go", "body": "<p>I managed to solve my problem, so here it is in case someone else needs it. And thanks @JiangYD for the tip of using curl to test the server.</p>\n\n<h1>TL;DR</h1>\n\n<ul>\n<li>I wrote <code>http.HandleFunc(\"/submit/\", submit)</code> but I was making a POST request to <code>/submit</code> (note the missing slash) &lt;&lt; This is important because of redirections</li>\n<li>Don't specify the Content-Type yourself, the browser will do it for you</li>\n</ul>\n\n<h1>LONG ANSWER</h1>\n\n<p>I did as @JiangYD said and used <strong>curl to test the server</strong>, I updated my answer with the response. I found odd that there was a 301 Redirect since I didn't put it there, I decided to use the following curl command</p>\n\n<pre><code>curl -v -F 'uploadFile=@\\\"C:/Users/raul-/Desktop/test.png\\\"' -L http://localhost:8080/submit\n</code></pre>\n\n<p>(note the <strong>-L</strong>) That way curl followed the redirect, though it failed again because, when redirecting, curl switched from POST to GET but with that response I found out that the request to <code>/submit</code> was being redirected to <code>/submit/</code> and I remembered that's how I wrote it in the <code>main</code> function.</p>\n\n<p>After fixing that it still failed, the response was <code>http: no such file</code> and by looking at the <code>net/http</code> code I found that it meant the field didn't exist, so I did a quick test iterating over all the field names obtained:</p>\n\n<pre><code>for k, _ := range r.MultipartForm.File {\n    log.Println(k)\n}\n</code></pre>\n\n<p>I was getting <code>'uploadFile</code> as the field name, I removed the single quotes in the curl command and now it uploaded the file perfectly</p>\n\n<p>But it doesn't end here, I now knew the server was working correctly because I could upload a file using <code>curl</code> but when I tried uploading it through the hosted web page I got an error: <code>no multipart boundary param in Content-Type</code>.</p>\n\n<p>So I found out I was suppose to include the boundary in the header, I changed fetch to something like this:</p>\n\n<pre><code>fetch('/submit', {\n    method: 'post',\n    headers: {\n        \"Content-Type\": \"multipart/form-data; boundary=------------------------\" + boundary\n    }, body: formData})\n</code></pre>\n\n<p>I calculate the boundary like this:</p>\n\n<pre><code>var boundary = Math.random().toString().substr(2);\n</code></pre>\n\n<p>But I still got an error: <code>multipart: NextPart: EOF</code> So how do you calculate the boundary? I read the spec <a href=\"https://html.spec.whatwg.org/multipage/forms.html#multipart/form-data-encoding-algorithm\" rel=\"noreferrer\">https://html.spec.whatwg.org/multipage/forms.html#multipart/form-data-encoding-algorithm</a> and found out the boundary is calculated by the algorithm that encodes the file, which in my case is FormData, the FormData API doesn't expose a way to get that boundary but I found out that the browser adds the Content-Type with <code>multipart/form-data</code> and the boundary automatically if you don't specify it so I removed the headers object from the <code>fetch</code> call and now it finally works!</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13971407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GgRm5TAc1yPXgy7PPzYyVVG5dKSDrY3013dKwRxWA=k-s128", "display_name": "jayson mulwa", "link": "https://stackoverflow.com/users/13971407/jayson-mulwa"}, "is_accepted": false, "score": 0, "last_activity_date": 1596579417, "creation_date": 1596579417, "answer_id": 63255823, "question_id": 33771167, "link": "https://stackoverflow.com/questions/33771167/handle-file-uploading-with-go/63255823#63255823", "title": "Handle file uploading with go", "body": "<p>Removing the header altogether actually works. Especially when sending the request via fetch or axios.</p>\n<pre><code>axios.post(\n                    endpoint + &quot;/api/v1/personalslip&quot;,\n                    {\n                      newSlip\n                    },\n                    {\n\n\n                     \n                    }\n                  )\n                  .then(res =&gt; {\n                    console.log(res);\n                  });\n</code></pre>\n"}], "owner": {"reputation": 1206, "user_id": 5180802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-C9Feof_ezik/AAAAAAAAAAI/AAAAAAAATQo/-PlxZxs79hY/photo.jpg?sz=128", "display_name": "redsalt", "link": "https://stackoverflow.com/users/5180802/redsalt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9495, "favorite_count": 2, "accepted_answer_id": 33809474, "answer_count": 2, "score": 8, "last_activity_date": 1596579417, "creation_date": 1447816307, "last_edit_date": 1447883553, "question_id": 33771167, "link": "https://stackoverflow.com/questions/33771167/handle-file-uploading-with-go", "title": "Handle file uploading with go", "body": "<p>I've started playing with go very recently so I'm still a noob, sorry if I make too many mistakes. I've been trying to fix this for a long time but I just don't understand what's going on. In my main.go file I have a main function:</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/\", handler)\n    http.HandleFunc(\"/submit/\", submit)\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>The handler function looks like this:</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    data, _ := ioutil.ReadFile(\"web/index.html\")\n    w.Write(data)\n}\n</code></pre>\n\n<p>I know this is not the best way to serve a website\nThe submit function looks like this:</p>\n\n<pre><code>func submit(w http.ResponseWriter, r *http.Request) {\n    log.Println(\"METHOD IS \" + r.Method + \" AND CONTENT-TYPE IS \" + r.Header.Get(\"Content-Type\"))\n    r.ParseMultipartForm(32 &lt;&lt; 20)\n    file, header, err := r.FormFile(\"uploadFile\")\n    if err != nil {\n        json.NewEncoder(w).Encode(Response{err.Error(), true})\n        return\n    }\n    defer file.Close()\n\n    out, err := os.Create(\"/tmp/file_\" + time.Now().String() + \".png\")\n    if err != nil {\n        json.NewEncoder(w).Encode(Response{err.Error(), true})\n        return\n    }\n    defer out.Close()\n\n    _, err = io.Copy(out, file)\n    if err != nil {\n        json.NewEncoder(w).Encode(Response{err.Error(), true})\n        return\n    }\n\n    json.NewEncoder(w).Encode(Response{\"File '\" + header.Filename + \"' submited successfully\", false})\n}\n</code></pre>\n\n<p>The problem is when the submit function is executed, <code>r.Method</code> is <code>GET</code> and <code>r.Header.Get(\"Content-Type\")</code> is an empty string, then it continues until the first if where r.FormFile returns the following error:\n<code>request Content-Type isn't multipart/form-data</code>\nI don't understand why r.Method is always GET and there's no Content-Type. I've tried to do the index.html in many different ways but r.Method is always GET and Content-Type is empty. Here's the function in index.html that uploads a file:</p>\n\n<pre><code>function upload() {\n    var formData = new FormData();\n    formData.append('uploadFile', document.querySelector('#file-input').files[0]);\n    fetch('/submit', {\n        method: 'post',\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        },\n        body: formData\n    }).then(function json(response) {\n        return response.json()\n    }).then(function(data) {\n        window.console.log('Request succeeded with JSON response', data);\n    }).catch(function(error) {\n        window.console.log('Request failed', error);\n    });\n}\n</code></pre>\n\n<p>And here's the HTML:</p>\n\n<pre><code>&lt;input id=\"file-input\" type=\"file\" name=\"uploadFile\" /&gt;\n</code></pre>\n\n<p>Note that the  tag is not inside a  tag, I thought that could be the problem so I changed both the function and the HTML to something like this:</p>\n\n<pre><code>function upload() {\n    fetch('/submit', {\n        method: 'post',\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        },\n        body: new FormData(document.querySelector('#form')\n    }).then(function json(response) {\n        return response.json()\n    }).then(function(data) {\n        window.console.log('Request succeeded with JSON response', data);\n    }).catch(function(error) {\n        window.console.log('Request failed', error);\n    });\n}\n\n&lt;form id=\"form\" method=\"post\" enctype=\"multipart/form-data\" action=\"/submit\"&gt;&lt;input id=\"file-input\" type=\"file\" name=\"uploadFile\" /&gt;&lt;/form&gt;\n</code></pre>\n\n<p>But that didn't work neither. I've searched with Google how to use fetch() and how to receive a file upload from go and I've seen that they are pretty similar to mine, I don't know what I'm doing wrong.</p>\n\n<p><strong>UPDATE:</strong>\nAfter using <code>curl -v -F 'uploadFile=@\\\"C:/Users/raul-/Desktop/test.png\\\"' http://localhost:8080/submit</code> I get the following output:</p>\n\n<pre><code>* Trying ::1...\n* Connected to localhost (::1) port 8080 (#0)\n&gt; POST /submit HTTP/1.1\n&gt; Host: localhost:8080\n&gt; User-Agent: curl/7.45.0\n&gt; Accept: */*\n&gt; Content-Length: 522\n&gt; Expect: 100-continue\n&gt; Content-Type: multipart/form-data; boundary=---------------------------a17d4e54fcec53f8\n&gt;\n&lt; HTTP/1.1 301 Moved Permanently\n&lt; Location: /submit/\n&lt; Date: Wed, 18 Nov 2015 14:48:38 GMT\n&lt; Content-Length: 0\n&lt; Content-Type: text/plain; charset=utf-8\n* HTTP error before end of send, stop sending\n&lt;\n* Closing connection 0\n</code></pre>\n\n<p>The console where I'm running <code>go run main.go</code> outputs nothing when using curl.</p>\n"}, {"tags": ["go", "autocomplete", "liteide"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447814598, "post_id": 33770925, "comment_id": 55309326, "body": "I haven&#39;t seen a single decent working implementation of intellisense for Go. Good luck though. My experiences have been similar where it works in some scopes but not across the whole project."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1447825689, "creation_date": 1447825689, "answer_id": 33772675, "question_id": 33770925, "link": "https://stackoverflow.com/questions/33770925/how-do-i-set-up-liteide-so-that-golang-identifier-completion-works-across-packag/33772675#33772675", "title": "How do I set up LiteIDE so that Golang identifier completion works across packages?", "body": "<p>Try a <code>go install</code> of your app, then go back to your editor.</p>\n\n<p>If <code>pkg2</code> has not been compiled at least once, <code>pkg1</code> wouldn't be able to do any completion from <code>pkg2</code> methods.</p>\n"}], "owner": {"reputation": 564, "user_id": 612829, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/wB0H0.jpg?s=128&g=1", "display_name": "Martin Ellison", "link": "https://stackoverflow.com/users/612829/martin-ellison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1447825689, "creation_date": 1447814424, "question_id": 33770925, "link": "https://stackoverflow.com/questions/33770925/how-do-i-set-up-liteide-so-that-golang-identifier-completion-works-across-packag", "title": "How do I set up LiteIDE so that Golang identifier completion works across packages?", "body": "<p>I am currently trying to use LiteIDE to edit golang code, and my question is about setting up LiteIDE so that identifier completion works when I have more than one package.</p>\n\n<p>I have a directory structure like:</p>\n\n<ul>\n<li>myProject\n\n<ul>\n<li>stuff\n\n<ul>\n<li>various non-Go files</li>\n</ul></li>\n<li>src\n\n<ul>\n<li>pack1\n\n<ul>\n<li>pack1a.go</li>\n<li>pack1b.go</li>\n</ul></li>\n<li>pack2\n\n<ul>\n<li>pack2a.go</li>\n<li>pack2b.go</li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>So in pack2a.go, I want to be able to type something like pack1.So and then press Control Space and get a list of pack1.Something and pack1.SomethingElse. However, I am not getting this (it does not list anything).</p>\n\n<p>Does anyone know what I should be doing?</p>\n\n<p>(I have asked a similar question previously for Intellij Idea).</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1447832149, "last_edit_date": 1447832149, "creation_date": 1447814042, "answer_id": 33770866, "question_id": 33770691, "link": "https://stackoverflow.com/questions/33770691/is-golang-bufio-goroutine-safety/33770866#33770866", "title": "Is golang bufio goroutine safety", "body": "<p>No, reading from a buffer is not a thread safe operation. You have to manage coordination. Thing is, a read from the buffer modifies it's state there's not really any reasonable way to do it concurrently. There's a position marker that has to be moved at the end of the read so you can't begin a second read until the first completes.</p>\n"}], "owner": {"reputation": 123, "user_id": 5332240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-zgQXo-_vYps/AAAAAAAAAAI/AAAAAAAAAgs/dHE1BP-zZGo/photo.jpg?sz=128", "display_name": "Wei Jian Guo", "link": "https://stackoverflow.com/users/5332240/wei-jian-guo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1447832149, "creation_date": 1447812924, "question_id": 33770691, "link": "https://stackoverflow.com/questions/33770691/is-golang-bufio-goroutine-safety", "title": "Is golang bufio goroutine safety", "body": "<p>could multiple goroutines invoke bufio Read function at same time. I read the source code of bufio, and looks like it doesn't have proper method to protect buffer would only read by one goroutine.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "edited": false, "score": 0, "creation_date": 1447817391, "post_id": 33770763, "comment_id": 55310040, "body": "THANKS SO MUCH, this fixed most of my questions, like number notation if syntax and much more. props to rcmgleite"}, {"owner": {"reputation": 1105, "user_id": 3051060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZeQp.jpg?s=128&g=1", "display_name": "rcmgleite", "link": "https://stackoverflow.com/users/3051060/rcmgleite"}, "reply_to_user": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "edited": false, "score": 0, "creation_date": 1448836539, "post_id": 33770763, "comment_id": 55733624, "body": "@liam, could you Mark it as accepted if you believe this is the correct answer?"}], "tags": [], "owner": {"reputation": 1105, "user_id": 3051060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZeQp.jpg?s=128&g=1", "display_name": "rcmgleite", "link": "https://stackoverflow.com/users/3051060/rcmgleite"}, "is_accepted": false, "score": 3, "last_activity_date": 1447814577, "last_edit_date": 1447814577, "creation_date": 1447813445, "answer_id": 33770763, "question_id": 33770533, "link": "https://stackoverflow.com/questions/33770533/what-is-wrong-with-this-go-code-and-what-is-os-stdin/33770763#33770763", "title": "What is wrong with this go code, and what is os.Stdin?", "body": "<p>The Scan code documentation says:</p>\n\n<pre><code>//Scan advances the Scanner to the next token, which will then be\n//available through the Bytes or Text method. It returns false when the\n//scan stops, either by reaching the end of the input or an error.\n</code></pre>\n\n<p>So you could do something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    input := bufio.NewScanner(os.Stdin)\n    if input.Scan() &amp;&amp; input.Text() == \"1\" {\n        fmt.Println(\"true\")\n    }\n}\n</code></pre>\n\n<p>The os.Stdin is how you make your Scanner get it's input from the stdin.\n(<a href=\"https://en.wikipedia.org/wiki/Standard_streams#/media/File:Stdstreams-notitle.svg\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Standard_streams#/media/File:Stdstreams-notitle.svg</a>)</p>\n\n<p>One note, pay attention for uppercase letters for exported functions.\nOn line 12 you wrote </p>\n\n<pre><code>fmt.println  \n</code></pre>\n\n<p>and it should be</p>\n\n<pre><code>fmt.Println\n</code></pre>\n\n<p>You should go to \n<a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow\">https://tour.golang.org/welcome/1</a>\nto get started with golang.</p>\n"}], "owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "closed_date": 1447823006, "answer_count": 1, "score": -1, "last_activity_date": 1447814577, "creation_date": 1447811998, "last_edit_date": 1447813134, "question_id": 33770533, "link": "https://stackoverflow.com/questions/33770533/what-is-wrong-with-this-go-code-and-what-is-os-stdin", "closed_reason": "Not suitable for this site", "title": "What is wrong with this go code, and what is os.Stdin?", "body": "<pre><code>  1 package main                                                                                                          \n  2                                                                                                                       \n  3 import (                                                                                                              \n  4         \"bufio\"                                                                                                       \n  5         \"fmt\"                                                                                                         \n  6         \"os\"                                                                                                          \n  7 )                                                                                                                     \n  8                                                                                                                       \n  9 func main() {                                                                                                         \n 10         input := bufio.NewScanner(os.Stdin)                                                                           \n 11         if input.Scan == 1 {                                                                                          \n 12                 fmt.println(\"true\")                                                                                   \n 13         }                                                                                                             \n 14 }     \n</code></pre>\n\n<p>I want create something that will ask for user input, then check if that user input = 1</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 13, "last_activity_date": 1447809109, "creation_date": 1447809109, "answer_id": 33770094, "question_id": 33770053, "link": "https://stackoverflow.com/questions/33770053/how-to-create-a-writer-for-a-string-in-go/33770094#33770094", "title": "How to create a writer for a String in Go", "body": "<p>Use an instance of <a href=\"https://godoc.org/bytes#Buffer\" rel=\"noreferrer\"><code>bytes.Buffer</code></a>, which implements <code>io.Writer</code>:</p>\n\n<pre><code>var buff bytes.Buffer\nif err := tpl.Execute(&amp;buff, data); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>You can then get a <code>string</code> result using <a href=\"https://godoc.org/bytes#Buffer.String\" rel=\"noreferrer\"><code>buff.String()</code></a>, or a <code>[]byte</code> result using <a href=\"https://godoc.org/bytes#Buffer.Bytes\" rel=\"noreferrer\"><code>buff.Bytes()</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 1, "last_activity_date": 1611585590, "last_edit_date": 1611585590, "creation_date": 1609821575, "answer_id": 65573342, "question_id": 33770053, "link": "https://stackoverflow.com/questions/33770053/how-to-create-a-writer-for-a-string-in-go/65573342#65573342", "title": "How to create a writer for a String in Go", "body": "<p>You can also use <code>strings.Builder</code> for this purpose:</p>\n<pre><code>package main\n\nimport (\n   &quot;html/template&quot;\n   &quot;log&quot;\n   &quot;strings&quot;\n)\n\nfunc main() {\n   t, e := template.New(&quot;date&quot;).Parse(&quot;&lt;p&gt;{{ .month }} - {{ .day }}&lt;/p&gt;&quot;)\n   if e != nil {\n      log.Fatal(e)\n   }\n   b := strings.Builder{}\n   e = t.Execute(&amp;b, map[string]int{&quot;month&quot;: 12, &quot;day&quot;: 31})\n   if e != nil {\n      log.Fatal(e)\n   }\n   println(b.String())\n}\n</code></pre>\n<p><a href=\"https://golang.org/pkg/strings#Builder\" rel=\"nofollow noreferrer\">https://golang.org/pkg/strings#Builder</a></p>\n"}], "owner": {"reputation": 224, "user_id": 2237453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qdwws.jpg?s=128&g=1", "display_name": "NecroTheif", "link": "https://stackoverflow.com/users/2237453/necrotheif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4375, "favorite_count": 2, "accepted_answer_id": 33770094, "answer_count": 2, "score": 10, "last_activity_date": 1611585590, "creation_date": 1447808850, "question_id": 33770053, "link": "https://stackoverflow.com/questions/33770053/how-to-create-a-writer-for-a-string-in-go", "title": "How to create a writer for a String in Go", "body": "<p>I need to use the <a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"noreferrer\">*template.Execute</a> method but I want the result as a string or byte[] so that I can pass it to another <a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"noreferrer\">*template.Execute</a> but the method writes its results to a writer. Is there a way to create a writer that will write to a variable I define?</p>\n"}, {"tags": ["go", "ipv6"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447810836, "post_id": 33769800, "comment_id": 55308278, "body": "<code>bits</code> is 128 for IPv6, and 32 for IPv4.  For <code>ones</code>, it depends, it&#39;s not 100% clear what you&#39;re trying to do.  Are you trying to get the subnet mask of the CIDR that represents that 1 single IP?  If so, then <code>ones</code> should equal <code>bits</code>.  Furthermore, if you&#39;re always going to be calling the function with the same two pairs of inputs, why not just do them once, up front?"}, {"owner": {"reputation": 2399, "user_id": 661232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/df0b27d01ab5256952ed7c2a08e57cfd?s=128&d=identicon&r=PG", "display_name": "chrislovecnm", "link": "https://stackoverflow.com/users/661232/chrislovecnm"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447815214, "post_id": 33769800, "comment_id": 55309492, "body": "I am trying to get a subnet mask for a single ip address.  Let me be more clear... I think that is what the code is doing.  Newbie to golang :)"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447817808, "post_id": 33769800, "comment_id": 55310132, "body": "The subnet mask for any single IPv4 address will always be what you see on line 307 here: <a href=\"https://golang.org/src/net/ip_test.go#L307\" rel=\"nofollow noreferrer\">golang.org/src/net/ip_test.go#L307</a>.  For IPv6, it will always be what you see on line 311: <a href=\"https://golang.org/src/net/ip_test.go#L311\" rel=\"nofollow noreferrer\">golang.org/src/net/ip_test.go#L311</a>."}, {"owner": {"reputation": 2399, "user_id": 661232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/df0b27d01ab5256952ed7c2a08e57cfd?s=128&d=identicon&r=PG", "display_name": "chrislovecnm", "link": "https://stackoverflow.com/users/661232/chrislovecnm"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447819494, "post_id": 33769800, "comment_id": 55310496, "body": "So I should not recalculate it, create a constant and reuse it.  But now I am quite confused.  Is the code even doing what it is intending to do?"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447820678, "post_id": 33769800, "comment_id": 55310826, "body": "It&#39;s hard to tell what your code is doing because you haven&#39;t provided a minimal example that can run.  I don&#39;t know what <code>v</code> is, or what <code>v.IpConfig.IpAddress[0].PrefixLength</code> tends to be, but if the latter is 32, then yes, it does what you want."}, {"owner": {"reputation": 2399, "user_id": 661232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/df0b27d01ab5256952ed7c2a08e57cfd?s=128&d=identicon&r=PG", "display_name": "chrislovecnm", "link": "https://stackoverflow.com/users/661232/chrislovecnm"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447968484, "post_id": 33769800, "comment_id": 55394939, "body": "So it looks like ones should be the prefix length as before. Updated question. @AmitKumarGupta can you add an answer so I can give you some answered questions love?"}], "answers": [{"comments": [{"owner": {"reputation": 2399, "user_id": 661232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/df0b27d01ab5256952ed7c2a08e57cfd?s=128&d=identicon&r=PG", "display_name": "chrislovecnm", "link": "https://stackoverflow.com/users/661232/chrislovecnm"}, "edited": false, "score": 0, "creation_date": 1448045369, "post_id": 33818898, "comment_id": 55433064, "body": "PrefixLength is the value that I will use for <code>ones</code>, and is coming back from the govc api call, the json is above."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 1, "last_activity_date": 1447992997, "creation_date": 1447992997, "answer_id": 33818898, "question_id": 33769800, "link": "https://stackoverflow.com/questions/33769800/getting-ipv6-subnet-mask-from-net-cidrmask/33818898#33818898", "title": "Getting ipv6 subnet mask from net.CIDRMask", "body": "<p>I'm not sure what <code>PrefixLength</code> is, it may be some field defined in one of your structs, but it doesn't appear to be a field on anything in the <code>net</code> package, or in fact anywhere in the standard library: <a href=\"https://golang.org/search?q=PrefixLength\" rel=\"nofollow\">https://golang.org/search?q=PrefixLength</a>.</p>\n\n<p>So I'm not sure what <code>PrefixLength</code> is expected to give, but, I can tell you:</p>\n\n<ul>\n<li>IPv4 addresses consist of 32 bits of data (256 x 256 x 256 x 256 total IPs), so when dealing with IPv4, the value for the <code>bits</code> argument to <code>net.CIDRMask</code> should be 32.</li>\n<li>IPv4 addresses have 128 bits of data, so the <code>bits</code> argument is 128.</li>\n<li>The subnet mask for a CIDR range corresponding to a single IP will have the maximum number of ones, so the <code>ones</code> value is 32 or 128, depending on whether you're talking IPv4 or IPv6.</li>\n</ul>\n\n<p>Therefore, for IPv4, you should call <code>net.CIDRMask(32, 32)</code>, and for IPv6, <code>net.CIDRMask(128, 128)</code>.  Since these will be the exact same calculations every time, you have the option to simply set the values up front as constants in your code.  The correct values are:</p>\n\n<ul>\n<li>For IPv4: <a href=\"https://golang.org/src/net/ip_test.go#L307\" rel=\"nofollow\">https://golang.org/src/net/ip_test.go#L307</a></li>\n<li>For IPv6: <a href=\"https://golang.org/src/net/ip_test.go#L311\" rel=\"nofollow\">https://golang.org/src/net/ip_test.go#L311</a></li>\n</ul>\n"}], "owner": {"reputation": 2399, "user_id": 661232, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/df0b27d01ab5256952ed7c2a08e57cfd?s=128&d=identicon&r=PG", "display_name": "chrislovecnm", "link": "https://stackoverflow.com/users/661232/chrislovecnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 0, "accepted_answer_id": 33818898, "answer_count": 1, "score": 0, "last_activity_date": 1447992997, "creation_date": 1447807026, "last_edit_date": 1447968390, "question_id": 33769800, "link": "https://stackoverflow.com/questions/33769800/getting-ipv6-subnet-mask-from-net-cidrmask", "title": "Getting ipv6 subnet mask from net.CIDRMask", "body": "<p>I am working on code, and trying to add ipv6 support.  The following code is in the current code base for ipv4 support.  The code takes a ipv4 ip address and gets the subnet mask for the address on a /32.</p>\n\n<pre><code>// string of ip address\nnetworkInterface[\"ip_address\"] = v.IpAddress[0]\nm := net.CIDRMask(v.IpConfig.IpAddress[0].PrefixLength, 32)\nsubnetMask := net.IPv4(m[0], m[1], m[2], m[3])\nnetworkInterface[\"subnet_mask\"] = subnetMask.String()\n</code></pre>\n\n<p>I know that <code>net.CIDRMask</code> works with ipv6, I am uncertain how to use it with an ipv6 address.</p>\n\n<p>I am now testing the ip address to determine if the address is ipv4 or ipv6:</p>\n\n<pre><code>testInput := net.ParseIP(v.IpAddress[0])\nif testInput.To4() != nil {\n// find ipv4 subnet mask\n}\nif testInput.To16() != nil {\n// do ipv6 subnet mask\n}\n</code></pre>\n\n<p>The unit tests for <code>net.CIDRMask</code> have examples working with ipv6 located here: <a href=\"https://golang.org/src/net/ip_test.go\" rel=\"nofollow\">https://golang.org/src/net/ip_test.go</a></p>\n\n<p>But it is beyond both my golang experience and ipv6 knowledge.</p>\n\n<p>While RTFM'ing the docs <a href=\"https://golang.org/pkg/net/#CIDRMask\" rel=\"nofollow\">https://golang.org/pkg/net/#CIDRMask</a> mention:</p>\n\n<pre><code>func CIDRMask(ones, bits int) IPMask\n</code></pre>\n\n<blockquote>\n  <p>CIDRMask returns an IPMask consisting of `ones' 1 bits followed by 0s\n  up to a total length of `bits' bits. For a mask of this form, CIDRMask\n  is the inverse of IPMask.Size.</p>\n</blockquote>\n\n<p>So what values do I use for <code>ones</code> and <code>bits</code>?</p>\n\n<p>This is what is comming back from the api:</p>\n\n<pre><code>$ govc vm.info -json vcsa | jq .VirtualMachines[0].Guest.Net[0].IpConfig.IpAddress [   {\n    \"IpAddress\": \"10.20.128.218\",\n    \"PrefixLength\": 22,\n    \"Origin\": \"\",\n    \"State\": \"preferred\",\n    \"Lifetime\": null   } ]\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["winapi", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447811462, "post_id": 33769766, "comment_id": 55308455, "body": "Have you done deserialization with a byte buffer in C? Unfortunately I think you&#39;re going to have to do something similar here. Meaning, you need to know the layout of the data represented by the bytes, instantiate your type, then assign to each field accordingly, moving through the buffer until all data has been read. There&#39;s a package to help but it doesn&#39;t offer much abstraction, just some methods to convert binary to integers <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/binary</a>"}, {"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 1, "creation_date": 1447815427, "post_id": 33769766, "comment_id": 55309557, "body": "github.com/alexbrainman/printer does something similar."}], "answers": [{"tags": [], "owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "is_accepted": true, "score": 4, "last_activity_date": 1447850947, "creation_date": 1447850947, "answer_id": 33780535, "question_id": 33769766, "link": "https://stackoverflow.com/questions/33769766/use-structs-with-golang-syscall-on-windows/33780535#33780535", "title": "Use structs with Golang syscall on Windows?", "body": "<pre><code>uintptr(unsafe.Pointer(&amp;pPrnInfo))\n</code></pre>\n\n<p>in both places in the code above is wrong; it gives you a pointer to the slice header, not to the actual backing array. You want this instead:</p>\n\n<pre><code>uintptr(unsafe.Pointer(&amp;pPrnInfo[0]))\n</code></pre>\n\n<p>(Since the backing array is contiguous, a pointer to the first element of the backing array is the same as a pointer to the backing array itself.)</p>\n"}], "owner": {"reputation": 24556, "user_id": 110358, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/13c7ad63eb27047a7ff869d27e40c1ad?s=128&d=identicon&r=PG", "display_name": "Jacob Marble", "link": "https://stackoverflow.com/users/110358/jacob-marble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1566, "favorite_count": 1, "accepted_answer_id": 33780535, "answer_count": 1, "score": 2, "last_activity_date": 1447850947, "creation_date": 1447806825, "last_edit_date": 1447807967, "question_id": 33769766, "link": "https://stackoverflow.com/questions/33769766/use-structs-with-golang-syscall-on-windows", "title": "Use structs with Golang syscall on Windows?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd162692(v=vs.85).aspx\" rel=\"nofollow\"><code>EnumPrinters</code></a> Win32 function takes and argument <code>_Out_ LPBYTE  pPrinterEnum</code>, a pointer to an allocated buffer. In C, it works like this:</p>\n\n<pre><code>DWORD cbNeeded, nPrinters;\nEnumPrinters(PRINTER_ENUM_LOCAL, NULL, 5, NULL, 0, &amp;cbNeeded, &amp;nPrinters);\n\nBYTE *pPrnInfo = malloc(cbNeeded);\nEnumPrinters(PRINTER_ENUM_LOCAL, NULL, 5, pPrnInfo, cbNeeded, &amp;cbNeeded, &amp;nPrinters);\n\nPRINTER_INFO_5 *pPrinterInfo = (PRINTER_INFO_5 *) pPrnInfo;\nfor (int i=0; i &lt; nPrinters; i++) {\n  printf(\"pPrinterName: %s\\n\", pPrinterInfo[i].pPrinterName);\n}\n</code></pre>\n\n<p>How is the same accomplished in Go, using <code>syscall</code> instead of cgo? So far, this much compiles, but I don't know how to cast the resulting byte slice to an array of structs (without using cgo).</p>\n\n<pre><code>type PrinterInfo5 struct {\n    pPrinterName             *uint16\n    pPortName                *uint16\n    attributes               uint32\n    deviceNotSelectedTimeout uint32\n    transmissionRetryTimeout uint32\n}\n\n...\n\ndll := syscall.MustLoadDLL(\"winspool.drv\")\nf := dll.MustFindProc(\"EnumPrintersW\")\n\nvar cbNeeded, nPrinters uint32\nfmt.Println(cbNeeded, nPrinters)\nf.Call(PRINTER_ENUM_LOCAL, 0, 5, 0, 0, uintptr(unsafe.Pointer(&amp;cbNeeded)), uintptr(unsafe.Pointer(&amp;nPrinters)))\nfmt.Println(cbNeeded, nPrinters)\n\nvar pPrnInfo []byte = make([]byte, cbNeeded)\nf.Call(PRINTER_ENUM_LOCAL, 0, 5, uintptr(unsafe.Pointer(&amp;pPrnInfo)), uintptr(cbNeeded), uintptr(unsafe.Pointer(&amp;cbNeeded)), uintptr(unsafe.Pointer(&amp;nPrinters)))\n</code></pre>\n\n<p>I have tried this, which prints one iteration successfully, then fails with <code>fatal error: heapBitsBulkBarrier: unaligned arguments</code>:</p>\n\n<pre><code>hdr := reflect.SliceHeader{\n  Data: uintptr(unsafe.Pointer(&amp;pPrnInfo)),\n  Len:  int(nPrinters),\n  Cap:  int(nPrinters),\n}\ns := *(*[]PrinterInfo5)(unsafe.Pointer(&amp;hdr))\nfor _, t := range s {\n  fmt.Println(t)\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "cayley"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447806625, "post_id": 33769116, "comment_id": 55307055, "body": "Can you post what you have now and provide more specific information about what error you&#39;re facing? It might be more constructive to pose each specific error as a question since configuring a system can be pretty open ended (ie you&#39;re stuck on error A and resolve it to find error B and then get error C and so on)."}, {"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447808342, "post_id": 33769116, "comment_id": 55307587, "body": "@evanmcdonnal I provided more detail."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447812312, "post_id": 33769116, "comment_id": 55308683, "body": "Can you try using your <code>localhost:5432</code> config but with <code>&quot;database&quot;:&quot;mongo&quot;</code> ? In most examples the value is <code>leveldb</code> in the docs one of the values is <code>mongo</code>, however there is no <code>sql</code> value as far as I can tell. In between my other work I&#39;ll track down that file (<code>caylay.go</code>) and see what&#39;s going on there because the error would indicate there should be a trailing equals but I don&#39;t see any examples that have anything remotely similar (not like it&#39;s a sql connection string and has credentials ect after that)."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447812514, "post_id": 33769116, "comment_id": 55308727, "body": "Found part of what I&#39;m looking for. You&#39;re failing in here, the call to <code>Load</code> returns that error <a href=\"https://github.com/google/cayley/blob/master/cmd/cayley/cayley.go#L209\" rel=\"nofollow noreferrer\">github.com/google/cayley/blob/master/cmd/cayley/cayley.go#L2&zwnj;&#8203;09</a>"}, {"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447812777, "post_id": 33769116, "comment_id": 55308802, "body": "@evanmcdonnal using config with <code>&quot;database&quot;: &quot;mongo&quot;</code> if for using with a mongodb backend. There is a <code>sql</code> value for <code>database</code> (see <a href=\"https://github.com/google/cayley/blob/master/graph/sql/quadstore.go\" rel=\"nofollow noreferrer\">source</a>), however it isn&#39;t documented, and I haven&#39;t been able to figure it out yet."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447813174, "post_id": 33769116, "comment_id": 55308920, "body": "Well that answer seems like it might have some promise. I just suggested using <code>mongo</code> because you said your connection string was analogous to it."}, {"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447813432, "post_id": 33769116, "comment_id": 55308996, "body": "@evanmcdonnal yes, I&#39;ll check that that answer out."}], "answers": [{"comments": [{"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "edited": false, "score": 1, "creation_date": 1447814382, "post_id": 33770627, "comment_id": 55309275, "body": "I got it after checking the godocs, thanks! After that, I ran into an error that said that <code>db: failed to load data: pq: relation &quot;quads&quot; does not exist</code>, which I got around by creating a table <code>quads</code> according to the query found at <a href=\"https://github.com/google/cayley/blob/master/graph/sql/quadstore.go\" rel=\"nofollow noreferrer\">github.com/google/cayley/blob/master/graph/sql/quadstore.go</a>. After that, I managed to load the data."}], "tags": [], "owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "is_accepted": true, "score": 3, "last_activity_date": 1447812882, "last_edit_date": 1447812882, "creation_date": 1447812579, "answer_id": 33770627, "question_id": 33769116, "link": "https://stackoverflow.com/questions/33769116/how-to-use-cayley-with-a-postgres-backend/33770627#33770627", "title": "How to use Cayley with a Postgres backend?", "body": "<p>It looks like Cayley is using lib/pq under the covers. lib/pq connection strings look something like this: <code>\"user=pqgotest dbname=pqgotest sslmode=verify-full\"</code> or <code>\"postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full\"</code> \nFor full details see the lib/pq documentation at <a href=\"https://godoc.org/github.com/lib/pq\" rel=\"nofollow\">godoc.org</a>.</p>\n\n<p>(You can see where the sql.Open call is made in cayley/graph/sql/quadstore.go <code>connectSQLTables</code>.)</p>\n"}], "owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1248, "favorite_count": 1, "accepted_answer_id": 33770627, "answer_count": 1, "score": 3, "last_activity_date": 1447812882, "creation_date": 1447803214, "last_edit_date": 1447808310, "question_id": 33769116, "link": "https://stackoverflow.com/questions/33769116/how-to-use-cayley-with-a-postgres-backend", "title": "How to use Cayley with a Postgres backend?", "body": "<p>As per <a href=\"https://github.com/google/cayley/pull/289\" rel=\"nofollow\">this Github issue</a>, the Postgres backend feature for the <a href=\"https://github.com/google/cayley\" rel=\"nofollow\">Cayley</a> graph database is implemented. However, currently there aren't examples in the <a href=\"https://github.com/google/cayley/tree/master/docs\" rel=\"nofollow\">docs</a>, and I couldn't figure it out by reading the code. Could someone help?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>To start playing with Cayley, we can load data that comes with the source with the following command:</p>\n\n<p><code>./cayley load --config=cayley.cfg.overview --quads=data/30kmoviedata.nq.gz</code></p>\n\n<p>I tried two variations of the <code>cayley.cfg.overview</code> file:</p>\n\n<pre><code>{\n    \"database\": \"sql\",\n    \"db_path\": \"localhost:5432\",\n    \"read_only\": false\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>{\n    \"database\": \"sql\",\n    \"db_path\": \"/var/lib/postgresql/9.4/main/cayley\",\n    \"read_only\": false\n}\n</code></pre>\n\n<p>The first one being analogous to the one used with mongo (5432 being the port at which the postgres server is listening). As for the second one, I have no clue of what I'm doing there :D.</p>\n\n<p>In any case, when I use the <code>./cayley load --config=cayley.cfg.overview --quads=data/30kmoviedata.nq.gz</code> command I get the following error (varying only the value of <code>db_path</code>):</p>\n\n<pre><code>Couldn't open database at localhost:5432: \n&amp;errors.errorString{s:\"missing \\\"=\\\" after \\\"127.0.0.1:5432\\\" in connection \ninfo string\\\"\"}\nE1117 21:09:18.300033 16689 cayley.go:277] missing \"=\" after \"localhost:5432\" \nin connection info string\"\n</code></pre>\n"}, {"tags": ["http", "go", "ip"], "comments": [{"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447801097, "post_id": 33768557, "comment_id": 55305096, "body": "Certain NICs can talk to certain VLANs, so I need to specify which local address is used.  WGET for example, supports this with the --bind-address=ADDRESS command line flag."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 14, "last_activity_date": 1506494798, "last_edit_date": 1506494798, "creation_date": 1447802173, "answer_id": 33768929, "question_id": 33768557, "link": "https://stackoverflow.com/questions/33768557/how-to-bind-an-http-client-in-go-to-an-ip-address/33768929#33768929", "title": "How to bind an http.Client in Go to an IP Address", "body": "<p>Similar to <a href=\"https://stackoverflow.com/q/33681662/\">this question</a>, you need to set the <code>http.Client.Transport</code> field. Setting it to an instance of <code>net.Transport</code> allows you to specify which <code>net.Dialer</code> you want to use. <code>net.Dialer</code> then allows you to specify the local address to make connections from.</p>\n\n<p>Example:</p>\n\n<pre><code>localAddr, err := net.ResolveIPAddr(\"ip\", \"&lt;my local address&gt;\")\nif err != nil {\n  panic(err)\n}\n\n// You also need to do this to make it work and not give you a \n// \"mismatched local address type ip\"\n// This will make the ResolveIPAddr a TCPAddr without needing to \n// say what SRC port number to use.\nlocalTCPAddr := net.TCPAddr{\n    IP: localAddr.IP,\n}\n\n\nwebclient := &amp;http.Client{\n    Transport: &amp;http.Transport{\n        Proxy: http.ProxyFromEnvironment,\n        DialContext: (&amp;net.Dialer{\n            LocalAddr: &amp;localTCPAddr,\n            Timeout:   30 * time.Second,\n            KeepAlive: 30 * time.Second,\n            DualStack: true,\n        }).DialContext,\n        MaxIdleConns:          100,\n        IdleConnTimeout:       90 * time.Second,\n        TLSHandshakeTimeout:   10 * time.Second,\n        ExpectContinueTimeout: 1 * time.Second,\n    },\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "is_accepted": false, "score": 2, "last_activity_date": 1447886406, "creation_date": 1447886406, "answer_id": 33791840, "question_id": 33768557, "link": "https://stackoverflow.com/questions/33768557/how-to-bind-an-http-client-in-go-to-an-ip-address/33791840#33791840", "title": "How to bind an http.Client in Go to an IP Address", "body": "<p>Here is a fully working example that incorporates the answer from Tim.  I also broke out all of the nested pieces to make it easier to read and learn from.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    localAddr, err := net.ResolveIPAddr(\"ip\", \"10.128.64.219\")\n    if err != nil {\n        panic(err)\n    }\n\n    localTCPAddr := net.TCPAddr{\n        IP: localAddr.IP,\n    }\n\n    d := net.Dialer{\n        LocalAddr: &amp;localTCPAddr,\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n    }\n\n    tr := &amp;http.Transport{\n        Proxy:               http.ProxyFromEnvironment,\n        Dial:                d.Dial,\n        TLSHandshakeTimeout: 10 * time.Second,\n    }\n\n    webclient := &amp;http.Client{Transport: tr}\n\n    // Use NewRequest so we can change the UserAgent string in the header\n    req, err := http.NewRequest(\"GET\", \"http://www.google.com:80\", nil)\n    if err != nil {\n        panic(err)\n    }\n\n    res, err := webclient.Do(req)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"DEBUG\", res)\n    defer res.Body.Close()\n\n    content, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%s\", string(content))\n}\n</code></pre>\n"}], "owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5249, "favorite_count": 5, "accepted_answer_id": 33768929, "answer_count": 2, "score": 4, "last_activity_date": 1590169769, "creation_date": 1447800398, "question_id": 33768557, "link": "https://stackoverflow.com/questions/33768557/how-to-bind-an-http-client-in-go-to-an-ip-address", "title": "How to bind an http.Client in Go to an IP Address", "body": "<p>I have a client machine with multiple NICs, how do I bind an http.Client in Go to a certain NIC or to a certain SRC IP Address?</p>\n\n<p>Say you have some very basic http client code that looks like:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    webclient := &amp;http.Client{}\n    req, _ := http.NewRequest(\"GET\", \"http://www.google.com\", nil)\n    httpResponse, _ := webclient.Do(req)\n    defer httpResponse.Body.Close()\n}\n</code></pre>\n\n<p>Is there a way to bind to a certain NIC or IP?  </p>\n"}, {"tags": ["pointers", "struct", "go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447802301, "post_id": 33768554, "comment_id": 55305593, "body": "Do you mean to have <code>for bindQuery.Scan(&amp;value)</code> or <code>if bindQuery.Scan(&amp;value)</code>? That&#39;s not what&#39;s causing your panic, just clarifying."}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447802749, "post_id": 33768554, "comment_id": 55305754, "body": "should be for, bindQuery is a slice and we want to go through each of them and append them to the list. That is where I am having problems though, getting value right"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447803307, "post_id": 33768554, "comment_id": 55305937, "body": "<code>bindQuery.Scan</code> appears to return a bool: <a href=\"https://godoc.org/github.com/relops/cqlr#Binding.Scan\" rel=\"nofollow noreferrer\">godoc.org/github.com/relops/cqlr#Binding.Scan</a>"}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447803970, "post_id": 33768554, "comment_id": 55306165, "body": "I don&#39;t think I care about the bool, just wantto do the iterating over the <code>bindQuery</code>, Either way, see most recent edit."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447804085, "post_id": 33768554, "comment_id": 55306212, "body": "Oh, I see, it will keep doing the Scan until it returns false."}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447804462, "post_id": 33768554, "comment_id": 55306335, "body": "Ah, that might be how it works. I haven&#39;t really looked too much at the internals."}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 4, "last_activity_date": 1447804566, "creation_date": 1447804566, "answer_id": 33769379, "question_id": 33768554, "link": "https://stackoverflow.com/questions/33768554/need-help-getting-past-reflect-numfield-of-non-struct-type/33769379#33769379", "title": "Need help getting past &#39;reflect: NumField of non-struct type&#39;", "body": "<p>Change from:</p>\n\n<pre><code>value := reflect.New(query.structType)\nfor bindQuery.Scan(&amp;value) {\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>value := reflect.New(query.structType).Interface()\nfor bindQuery.Scan(value) {\n</code></pre>\n\n<p>See <a href=\"http://play.golang.org/p/1FIL0vzROZ\" rel=\"nofollow\">here</a> for a full working example (pasted below):</p>\n\n<pre><code>package main\n\nimport \"reflect\"\n\nfunc Scan(d interface{}) {\n    v := reflect.ValueOf(d)\n    i := reflect.Indirect(v)\n    s := i.Type()\n    println(s.NumField()) // will print out 0, if you change Host to have 1 field, it prints out 1\n}\n\nfunc query(t reflect.Type) {\n    value := reflect.New(t).Interface()\n    Scan(value)\n}\n\ntype Host struct{}\n// type Host struct{int} // comment above line, uncomment this one, and println above will print 1\n\nfunc main() {\n    var h Host\n    query(reflect.TypeOf(h))\n}\n</code></pre>\n\n<p>This emulates what your code, plus the clqr library, does (see <a href=\"https://github.com/relops/cqlr/blob/master/cqlr.go#L85-L99\" rel=\"nofollow\">https://github.com/relops/cqlr/blob/master/cqlr.go#L85-L99</a> and <a href=\"https://github.com/relops/cqlr/blob/master/cqlr.go#L154-L160\" rel=\"nofollow\">https://github.com/relops/cqlr/blob/master/cqlr.go#L154-L160</a>).  You basically need <code>s := i.Type()</code> to be the <code>TypeOf</code> your <code>Host</code> struct, so if you work backwards from what the clqr code is doing, you can deduce what you need to pass in to the <code>Scan</code> call.  And given that the input you have is a <code>reflect.Type</code>, you can deduce how you can get from that <code>Type</code> to the correct kind of object to pass into <code>Scan</code>.</p>\n"}], "owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9230, "favorite_count": 0, "accepted_answer_id": 33769379, "answer_count": 1, "score": 5, "last_activity_date": 1530708717, "creation_date": 1447800377, "last_edit_date": 1530708717, "question_id": 33768554, "link": "https://stackoverflow.com/questions/33768554/need-help-getting-past-reflect-numfield-of-non-struct-type", "title": "Need help getting past &#39;reflect: NumField of non-struct type&#39;", "body": "<p>I am trying to build a Query struct that will represent data to and from our Cassandra database.</p>\n\n<p>The issue is, I am trying to take a Type as one of my fields in the struct so I can reconstruct it later. I feel like I am really close, but it is giving me some issues. I get a really nasty looking error trying to do this:</p>\n\n<pre><code>2015/11/17 15:42:22 http: panic serving 127.0.0.1:57962: reflect: NumField of non-struct type\ngoroutine 34 [running]:\nnet/http.(*conn).serve.func1(0xc820184000, 0x7f36d7459b00, 0xc820180008)\n    /usr/lib/go/src/net/http/server.go:1287 +0xb5\nreflect.(*rtype).NumField(0x790820, 0xc8200b9a60)\n    /usr/lib/go/src/reflect/type.go:660 +0x7b\ngithub.com/relops/cqlr.(*Binding).compile(0xc82004f6f0, 0x77ab60, 0xc8200b9a60, 0x16, 0xc820194140, 0x5, 0x5, 0x0, 0x0)\n    /home/jared/dev/go-pp/src/github.com/relops/cqlr/cqlr.go:160 +0xf8\ngithub.com/relops/cqlr.(*Binding).Scan(0xc82004f6f0, 0x77ab60, 0xc8200b9a60, 0x825280)\n    /home/jared/dev/go-pp/src/github.com/relops/cqlr/cqlr.go:99 +0x199\nmain/cassandra/query.Query.RetryingQuery(0x9325e0, 0x19, 0x0, 0x0, 0x0, 0x0, 0x7f36d74580a8, 0x87b120, 0x0, 0x0, ...)\n    /home/jared/dev/go-pp/src/main/cassandra/query/query.go:39 +0x39e\nmain.ViewHosts(0x7f36d7459f88, 0xc8200e73f0, 0xc82018e000)\n    /home/jared/dev/go-pp/src/main/handlers.go:86 +0x1f3\nnet/http.HandlerFunc.ServeHTTP(0x9a03b0, 0x7f36d7459f88, 0xc8200e73f0, 0xc82018e000)\n    /usr/lib/go/src/net/http/server.go:1422 +0x3a\nmain/utils.Logger.func1(0x7f36d7459f88, 0xc8200e73f0, 0xc82018e000)\n    /home/jared/dev/go-pp/src/main/utils/logger.go:32 +0x9c\nnet/http.HandlerFunc.ServeHTTP(0xc820109200, 0x7f36d7459f88, 0xc8200e73f0, 0xc82018e000)\n    /usr/lib/go/src/net/http/server.go:1422 +0x3a\ngithub.com/gorilla/mux.(*Router).ServeHTTP(0xc82001aa00, 0x7f36d7459f88, 0xc8200e73f0, 0xc82018e000)\n    /home/jared/dev/go-pp/src/github.com/gorilla/mux/mux.go:100 +0x29e\nnet/http.serverHandler.ServeHTTP(0xc82016b1a0, 0x7f36d7459f88, 0xc8200e73f0, 0xc82018e000)\n    /usr/lib/go/src/net/http/server.go:1862 +0x19e\nnet/http.(*conn).serve(0xc820184000)\n    /usr/lib/go/src/net/http/server.go:1361 +0xbee\ncreated by net/http.(*Server).Serve\n    /usr/lib/go/src/net/http/server.go:1910 +0x3f6\n</code></pre>\n\n<p>Here is the code</p>\n\n<pre><code>type Query struct {\n    query       string\n    values      interface{}\n    attempts    int\n    maxAttempts int\n    structType  reflect.Type\n}\n\nfunc NewQuery(query string, t reflect.Type) (q Query) {\n    q.query = query\n    q.structType = t\n    return\n}\n\nfunc (query Query) RetryingQuery() (results []interface{}) {\n    var q *gocql.Query\n    if query.values != nil {\n        q = c.Session.Query(query.query, query.values)\n    } else {\n        q = c.Session.Query(query.query)\n    }\n\n    bindQuery := cqlr.BindQuery(q)\n\n    value := reflect.New(query.structType).Pointer()\n    for bindQuery.Scan(&amp;value) {\n        results = append(results, value)\n    }\n    return\n}\n\n\n// setting up and calling the query here (in another file)\nvar host cmodels.Host\nquery := query.NewQuery(\"SELECT * FROM server.host\", reflect.TypeOf(host))\nqueryResults := query.RetryingQuery()\n</code></pre>\n\n<p>However, with slight modification of the code I get past the error but I am getting a weird result.</p>\n\n<pre><code>func (query Query) RetryingQuery() (results []interface{}) {\n    var q *gocql.Query\n    if query.values != nil {\n        q = c.Session.Query(query.query, query.values)\n    } else {\n        q = c.Session.Query(query.query)\n    }\n\n    bindQuery := cqlr.BindQuery(q)\n    value := reflect.New(query.structType)\n    for bindQuery.Scan(&amp;value) {\n        results = append(results, value)\n    }\n    return\n}\n</code></pre>\n\n<p>That code above gives me:</p>\n\n<pre><code>[{\"flag\":22},{\"flag\":22},{\"flag\":22},{\"flag\":22},{\"flag\":22},...]\n</code></pre>\n"}, {"tags": ["go", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 1636883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f18625a3fce041f061d2e426c94bd7bd?s=128&d=identicon&r=PG", "display_name": "kkirsche", "link": "https://stackoverflow.com/users/1636883/kkirsche"}, "edited": false, "score": 0, "creation_date": 1447808884, "post_id": 33767190, "comment_id": 55307722, "body": "Thank you so much. I couldn&#39;t figure this out for the life of me and this makes much more sense and as soon as I switched to this things worked as expected. I really appreciate the help"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1447809147, "last_edit_date": 1447809147, "creation_date": 1447795151, "answer_id": 33767190, "question_id": 33766976, "link": "https://stackoverflow.com/questions/33766976/golang-go-sqlite3-cannot-iterate-over-type-error/33767190#33767190", "title": "Golang Go-SQLite3 cannot iterate over type error", "body": "<p>Yes, you are missing.</p>\n\n<p>You are not using the <a href=\"https://golang.org/pkg/database/sql/\" rel=\"nofollow\"><code>database/sql</code></a> package but you are using the <a href=\"https://godoc.org/code.google.com/p/go-sqlite/go1/sqlite3\" rel=\"nofollow\"><code>sqlite3</code></a> package!</p>\n\n<hr>\n\n<p><a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"nofollow\"><code>sql.Open()</code></a> returns an <a href=\"https://golang.org/pkg/database/sql/#DB\" rel=\"nofollow\"><code>sql.DB</code></a>, <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow\"><code>DB.Query()</code></a> returns an <a href=\"https://golang.org/pkg/database/sql/#Rows\" rel=\"nofollow\"><code>sql.Rows</code></a>, and <a href=\"https://golang.org/pkg/database/sql/#Rows.Next\" rel=\"nofollow\"><code>Rows.Next()</code></a> is:</p>\n\n<pre><code>func (rs *Rows) Next() bool\n</code></pre>\n\n<p>But instead you call <a href=\"https://godoc.org/code.google.com/p/go-sqlite/go1/sqlite3#Open\" rel=\"nofollow\"><code>sqlite3.Open()</code></a> which returns an <a href=\"https://godoc.org/code.google.com/p/go-sqlite/go1/sqlite3#Conn\" rel=\"nofollow\"><code>sqlite3.Conn</code></a>, then you call <a href=\"https://godoc.org/code.google.com/p/go-sqlite/go1/sqlite3#Conn.Query\" rel=\"nofollow\"><code>Conn.Query()</code></a> which returns an <a href=\"https://godoc.org/code.google.com/p/go-sqlite/go1/sqlite3#Stmt\" rel=\"nofollow\"><code>sqlite3.Stmt</code></a> which you name <strong><code>rows</code></strong>! So <strong><code>rows.Next()</code></strong> is <strong><a href=\"https://godoc.org/code.google.com/p/go-sqlite/go1/sqlite3#Stmt.Next\" rel=\"nofollow\"><code>Stmt.Next()</code></a></strong> which is:</p>\n\n<pre><code>func (s *Stmt) Next() error\n</code></pre>\n\n<hr>\n\n<h3>Source of confusion</h3>\n\n<p>It is confusing because sqlite3 is a driver conforming to the built-in <code>database/sql</code> interface, but it also provides another interface and you used it via its vendor-specific sqlite3 interface.</p>\n\n<p>Using the <code>database/sql</code> package you would start it like this:</p>\n\n<pre><code>db, err := sql.Open(\"sqlite3\", \"./foo.db\")\n</code></pre>\n"}], "owner": {"reputation": 1117, "user_id": 1636883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f18625a3fce041f061d2e426c94bd7bd?s=128&d=identicon&r=PG", "display_name": "kkirsche", "link": "https://stackoverflow.com/users/1636883/kkirsche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 33767190, "answer_count": 1, "score": 3, "last_activity_date": 1447809147, "creation_date": 1447794345, "question_id": 33766976, "link": "https://stackoverflow.com/questions/33766976/golang-go-sqlite3-cannot-iterate-over-type-error", "title": "Golang Go-SQLite3 cannot iterate over type error", "body": "<p>When attempting to use the examples from github.com/mattn/go-sqlite3's repository, I get the following error when trying to compile the code with Go 1.5.1 darwin/amd64:</p>\n\n<pre><code>non-bool rows.Next() (type error) used as for condition\n</code></pre>\n\n<p>The code I'm using is:</p>\n\n<pre><code>conn, err := sqlite3.Open(\"./example.db\")\nif err != nil {\n    log.Panic(err)\n}\ndefer conn.Close()\nrows, err := conn.Query(\"SELECT * FROM scans ORDER BY id DESC;\")\nif err != nil {\n    log.Panic(err)\n}\nfor rows.Next() {\n    var id int\n    var method string\n    var uuid string\n    var scan int\n    rows.Scan(&amp;id, &amp;method, &amp;uuid, &amp;scan)\n    log.Print(id, method, uuid, scan)\n}\n</code></pre>\n\n<p>Is there something which I am missing here? This is based on the example found here:\n<a href=\"https://github.com/mattn/go-sqlite3/blob/master/_example/simple/simple.go#L81-L91\" rel=\"nofollow\">https://github.com/mattn/go-sqlite3/blob/master/_example/simple/simple.go#L81-L91</a></p>\n"}, {"tags": ["go", "buffer", "stdin", "goroutine", "reader"], "answers": [{"comments": [{"owner": {"reputation": 281, "user_id": 5517206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f35a78e8cfdebb7a0223bf33c7d3e220?s=128&d=identicon&r=PG&f=1", "display_name": "linirod", "link": "https://stackoverflow.com/users/5517206/linirod"}, "edited": false, "score": 0, "creation_date": 1447796241, "post_id": 33767419, "comment_id": 55302722, "body": "I would like to thank you for your quick and detailed response/example :) I&#39;m new to Go and I&#39;m still experimenting. I&#39;ll try bufio.Scanner tonight. Again thanks for your feedback!"}, {"owner": {"reputation": 2593, "user_id": 2418793, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/nQ6dp.jpg?s=128&g=1", "display_name": "Azurespot", "link": "https://stackoverflow.com/users/2418793/azurespot"}, "edited": false, "score": 0, "creation_date": 1574395082, "post_id": 33767419, "comment_id": 104226502, "body": "I used your code to pull an integer from the user input in the command line, but <code>input.Text()</code> returns a string. I thought it would return an <code>int</code>, since a number was entered into the command line? I&#39;ll include my code: <code>input := bufio.NewScanner(os.Stdin) \tvar t TimeOfDay \tfor input.Scan() { \t\tnumber :=input.Text() \t\tt = append(t, timeFeatures[number - 1]) \t}</code>"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1574483842, "post_id": 33767419, "comment_id": 104259046, "body": "You have to keep in mind that the types of variables are decided at compile time, long before you&#39;ve actually provided input to a running program. The compiler has no way of knowing that you&#39;re going to provide a number in the future, so it has no choice but to pick a single type for all input - in this case, <code>string</code> is the only type that is correct for all inputs.  If you happen to know that you are expecting an integer, you could perform an explicit conversion on the string using something like <a href=\"https://golang.org/pkg/strconv/#Atoi\" rel=\"nofollow noreferrer\"><code>strconv.Atoi</code></a>."}], "tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": true, "score": 1, "last_activity_date": 1447795972, "creation_date": 1447795972, "answer_id": 33767419, "question_id": 33766251, "link": "https://stackoverflow.com/questions/33766251/golang-os-stdin-as-a-reader-in-goroutines/33767419#33767419", "title": "Golang os.stdin as a Reader in Goroutines", "body": "<p>Yes, this is perfectly fine. So long as this is the only goroutine that is interacting with <code>os.Stdin</code>, everything will work properly.</p>\n\n<p>By the way, you may want to use <a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow\"><code>bufio.Scanner</code></a> - it's a bit nicer to work with than <a href=\"https://golang.org/pkg/bufio/#Reader\" rel=\"nofollow\"><code>bufio.Reader</code></a>:</p>\n\n<pre><code>go func() {\n    consolescanner := bufio.NewScanner(os.Stdin)\n\n    // by default, bufio.Scanner scans newline-separated lines\n    for consolescanner.Scan() {\n        input := consolescanner.Text()\n        fmt.Println(input)\n    }\n\n    // check once at the end to see if any errors\n    // were encountered (the Scan() method will\n    // return false as soon as an error is encountered) \n    if err := consolescanner.Err(); err != nil {\n         fmt.Println(err)\n         os.Exit(1)\n    }\n}()\n</code></pre>\n"}], "owner": {"reputation": 281, "user_id": 5517206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f35a78e8cfdebb7a0223bf33c7d3e220?s=128&d=identicon&r=PG&f=1", "display_name": "linirod", "link": "https://stackoverflow.com/users/5517206/linirod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5356, "favorite_count": 1, "accepted_answer_id": 33767419, "answer_count": 1, "score": 2, "last_activity_date": 1447795972, "creation_date": 1447791705, "question_id": 33766251, "link": "https://stackoverflow.com/questions/33766251/golang-os-stdin-as-a-reader-in-goroutines", "title": "Golang os.stdin as a Reader in Goroutines", "body": "<p>Is it okay to use os.stdin as a Reader in a Goroutine? Basically what I would like to accomplish is to enable the user to enter a message without blocking the main thread.</p>\n\n<p>Example:</p>\n\n<pre><code>go func() {\n    for {\n        consolereader := bufio.NewReader(os.Stdin)\n\n        input, err := consolereader.ReadString('\\n') // this will prompt the user for input\n\n        if err != nil {\n             fmt.Println(err)\n             os.Exit(1)\n        }\n\n        fmt.Println(input)\n    }\n}()\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 1, "creation_date": 1447793319, "post_id": 33766070, "comment_id": 55301111, "body": "<a href=\"https://golang.org/pkg/io/#LimitReader\" rel=\"nofollow noreferrer\">Here</a> are docs for LimitReader"}], "answers": [{"comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447863265, "post_id": 33768884, "comment_id": 55336834, "body": "Yikes, totally missed <code>http.MaxBytesReader</code> although it&#39;s there from (at least) Go 1.0! Thanks, need to update some of my LimitedReader use cases now."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 11, "last_activity_date": 1447813588, "last_edit_date": 1447813588, "creation_date": 1447801994, "answer_id": 33768884, "question_id": 33766070, "link": "https://stackoverflow.com/questions/33766070/stop-processing-a-http-post-request-if-it-is-larger-than-x-size/33768884#33768884", "title": "Stop processing a http POST request if it is larger than x size", "body": "<p>Use <a href=\"https://godoc.org/net/http#MaxBytesReader\" rel=\"noreferrer\">http.MaxBytesReader</a> to limit the amount of data read from the client. Execute this line of code </p>\n\n<pre><code>r.Body = http.MaxBytesReader(w, r.Body, 100000) \n</code></pre>\n\n<p>before calling r.ParseForm, r.FormValue or any other request method that reads the body.</p>\n\n<p>Wrapping the request body with <a href=\"https://godoc.org/io#LimitedReader\" rel=\"noreferrer\">io.LimitedReader</a> limits the amount of data read by the application, but does not necessarily limit the amount of data read by the server on behalf of the application.</p>\n\n<p>Checking <a href=\"https://godoc.org/net/http#Request.ContentLength\" rel=\"noreferrer\">the request content length</a> is unreliable because the field is not set to the actual request body size when chunked encoding is used.</p>\n"}, {"comments": [{"owner": {"reputation": 1172, "user_id": 922457, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/56c9ee0dd7713d48f2ad2e50594a6d0c?s=128&d=identicon&r=PG", "display_name": "Edenshaw", "link": "https://stackoverflow.com/users/922457/edenshaw"}, "edited": false, "score": 1, "creation_date": 1562256222, "post_id": 33769417, "comment_id": 100329552, "body": "I didn&#39;t downvote, but in case you didn&#39;t read @Cerise&#39;s answer: <i>Checking the request content length is unreliable because the field is not set to the actual request body size when chunked encoding is used.</i>"}], "tags": [], "owner": {"reputation": 5072, "user_id": 537500, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cd1f9e76e6bc4adaa787e84f15b63eb6?s=128&d=identicon&r=PG", "display_name": "Rana", "link": "https://stackoverflow.com/users/537500/rana"}, "is_accepted": false, "score": -1, "last_activity_date": 1447804808, "creation_date": 1447804808, "answer_id": 33769417, "question_id": 33766070, "link": "https://stackoverflow.com/questions/33766070/stop-processing-a-http-post-request-if-it-is-larger-than-x-size/33769417#33769417", "title": "Stop processing a http POST request if it is larger than x size", "body": "<p>I believe you can simply check <code>http.Request.ContentLength</code> param to know about the size of the posted request prior to decide whether to go ahead or return error if larger than expected.</p>\n"}], "owner": {"reputation": 3699, "user_id": 4816175, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/697df6176ef55a7ea25f159e0fcdec38?s=128&d=identicon&r=PG", "display_name": "cool breeze", "link": "https://stackoverflow.com/users/4816175/cool-breeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2752, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1447813588, "creation_date": 1447791038, "question_id": 33766070, "link": "https://stackoverflow.com/questions/33766070/stop-processing-a-http-post-request-if-it-is-larger-than-x-size", "title": "Stop processing a http POST request if it is larger than x size", "body": "<p>If I have a basic http handler for POST requests, how can I stop processing if the payload is larger than 100 KB?</p>\n\n<p>From what I understand, in my POST Handler, behind the scenes the server is streaming the POSTED data.  But if I try and access it, it will block correct?\nI want to stop processing if it is over 100 KB in size.</p>\n"}, {"tags": ["go", "gomobile"], "comments": [{"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1447879655, "post_id": 33765527, "comment_id": 55347116, "body": "I can install the apk file, but when I run it on S3 it quits running in about 1 second. Have you run gomobile apps successfully on S3 before? If yes then may I know the software version you have? Thank you"}, {"owner": {"reputation": 694, "user_id": 2463472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94951a17712ce069f2ea3b686836a6f2?s=128&d=identicon&r=PG", "display_name": "saurabh", "link": "https://stackoverflow.com/users/2463472/saurabh"}, "edited": false, "score": 1, "creation_date": 1496113806, "post_id": 33765527, "comment_id": 75513963, "body": "Have you tried to install a Hello world application on the same hardware? Just to make sure the problem is with golang in general or with some of its API"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1513591200, "creation_date": 1513591200, "answer_id": 47865921, "question_id": 33765527, "link": "https://stackoverflow.com/questions/33765527/gomobile-compatibility/47865921#47865921", "title": "gomobile compatibility", "body": "<p>The only hardware compatibility note I can find for Go Mobile is <a href=\"https://github.com/golang/go/wiki/Mobile#building-and-deploying-to-android-1\" rel=\"nofollow noreferrer\">this one</a> which states:</p>\n\n<blockquote>\n  <p>Note: Go Mobile runs on the same architectures as Go, which currently means ARM, ARM64, 386 and amd64 devices and emulators. Notably, Android on MIPS devices is not yet supported.</p>\n</blockquote>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1513591200, "creation_date": 1447788939, "last_edit_date": 1491976253, "question_id": 33765527, "link": "https://stackoverflow.com/questions/33765527/gomobile-compatibility", "title": "gomobile compatibility", "body": "<p>I'm writing some test apps with gomobile and native golang. Strangely the apps don't run on Galaxy S3 with Android 4.1.1 but work on Galaxy Note 5 with Android 5.1.1. Does anyone know the clear hardware and software requirements for current version of gomobile? I don't think it's in any of the documents or speeches.</p>\n"}, {"tags": ["linux", "go", "system-calls"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1447781941, "post_id": 33763313, "comment_id": 55294650, "body": "This sounds exactly like the sort of question that needs a lot more detail because I am almost sure there are better ways to get to what you <i>actually</i> want to accomplish."}, {"owner": {"reputation": 11, "user_id": 5572976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac651fb4f969dede65c00303acfe677e?s=128&d=identicon&r=PG&f=1", "display_name": "Bj&#248;rg Henderssen", "link": "https://stackoverflow.com/users/5572976/bj%c3%b8rg-henderssen"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447782387, "post_id": 33763313, "comment_id": 55294890, "body": "@ZanLynx What I&#39;m trying to accomplish is to hook the fopen syscall globally using LD_PRELOAD and change the output of a file with a specific name. Using libraries mixing C and Go is fine as long as the submitted code is Go."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447782552, "post_id": 33763313, "comment_id": 55294981, "body": "You just restated your question for the most part. The only new bit is &quot;change the output of a file with a specific name.&quot; Seems more like a job for <code>inotify</code>."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447782588, "post_id": 33763313, "comment_id": 55295005, "body": "Also you can&#39;t hook <code>fopen</code> in Go because Go does not even use the C library. When Go makes a system call it makes it directly to the operating system kernel."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447782742, "post_id": 33763313, "comment_id": 55295102, "body": "Although I suppose that you could interpose <code>fopen</code> with C code and call into Go code from there. Of course then your interpose library has a Go runtime in it which can cause all kinds of problems if you load it into a program that already has a Go runtime."}, {"owner": {"reputation": 11, "user_id": 5572976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac651fb4f969dede65c00303acfe677e?s=128&d=identicon&r=PG&f=1", "display_name": "Bj&#248;rg Henderssen", "link": "https://stackoverflow.com/users/5572976/bj%c3%b8rg-henderssen"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447783351, "post_id": 33763313, "comment_id": 55295457, "body": "I gave you an example of how I would do it in C, and while it is what I&#39;m trying to do I&#39;m not looking for just the solution (I would&#39;ve used the C code I linked for that) I want to understand how syscall hooking would be implemented in Go.  EDIT: Types this without seeing your responses, sorry."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447783510, "post_id": 33763313, "comment_id": 55295548, "body": "Your question text is wrong though. Because fopen is not a syscall."}, {"owner": {"reputation": 11, "user_id": 5572976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac651fb4f969dede65c00303acfe677e?s=128&d=identicon&r=PG&f=1", "display_name": "Bj&#248;rg Henderssen", "link": "https://stackoverflow.com/users/5572976/bj%c3%b8rg-henderssen"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447783810, "post_id": 33763313, "comment_id": 55295726, "body": "Oh, sorry. I meant <b>open</b>, not fopen."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 1, "creation_date": 1447790895, "post_id": 33763313, "comment_id": 55299758, "body": "To help people who may become confused by your question, (as I have), please <b>consistently</b> correct your question; I assume it should say <i>open</i> everywhere, and not a mixture of <i>fopen</i> and <i>open</i>. Is that correct?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447804780, "post_id": 33763313, "comment_id": 55306438, "body": "BTW, <code>open</code> as in the question you linked is not a system call either. It is a call to glibc which then makes an actual system call."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1447805136, "post_id": 33763313, "comment_id": 55306551, "body": "To actually monitor all file access you will need to use inotify to look at a specific file or the audit system or fanotify. Or use SystemTap or kprobe."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6467958, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SUUDgMw2MsI/AAAAAAAAAAI/AAAAAAAAADQ/Ufbi5pPl6iI/photo.jpg?sz=128", "display_name": "James Li", "link": "https://stackoverflow.com/users/6467958/james-li"}, "is_accepted": false, "score": 1, "last_activity_date": 1611555962, "creation_date": 1611555962, "answer_id": 65879888, "question_id": 33763313, "link": "https://stackoverflow.com/questions/33763313/hooking-syscalls-in-go/65879888#65879888", "title": "Hooking syscalls in Go", "body": "<p>try this <a href=\"https://github.com/rainycape/dl\" rel=\"nofollow noreferrer\">Runtime dynamic library loader (dlopen / dlsym) for Go (golang)</a></p>\n"}], "owner": {"reputation": 11, "user_id": 5572976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac651fb4f969dede65c00303acfe677e?s=128&d=identicon&r=PG&f=1", "display_name": "Bj&#248;rg Henderssen", "link": "https://stackoverflow.com/users/5572976/bj%c3%b8rg-henderssen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1611555962, "creation_date": 1447781300, "last_edit_date": 1495540313, "question_id": 33763313, "link": "https://stackoverflow.com/questions/33763313/hooking-syscalls-in-go", "title": "Hooking syscalls in Go", "body": "<p>I'm trying to hook the fopen syscall in linux using Go. </p>\n\n<p>Normally I would use C for something like this (Example: <a href=\"https://stackoverflow.com/a/880278/5572976\">https://stackoverflow.com/a/880278/5572976</a>) but the CTF states that the solution needs to be written in Go.</p>\n\n<p>I've looked at the <a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow noreferrer\">syscall</a> package and basically what I'm looking for is using the following in Go.</p>\n\n<pre><code>dlsym(RTLD_NEXT, \"open\");\n</code></pre>\n\n<p>EDIT: That's <strong>open</strong>, not fopen.</p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"comments": [{"owner": {"reputation": 1746, "user_id": 1682922, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/42711b798e68daccb892480677e5ca34?s=128&d=identicon&r=PG", "display_name": "markz", "link": "https://stackoverflow.com/users/1682922/markz"}, "edited": false, "score": 0, "creation_date": 1447783598, "post_id": 33763595, "comment_id": 55295596, "body": "Oh, that&#39;s what I get for not reading the language specification first. A capital first letter makes the fields public and exportable, who would have thought :) Tnx, your answer works"}], "tags": [], "owner": {"reputation": 1399, "user_id": 536113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329f705a6d4ea0185f3aca9ee823d74?s=128&d=identicon&r=PG", "display_name": "vially", "link": "https://stackoverflow.com/users/536113/vially"}, "is_accepted": true, "score": 1, "last_activity_date": 1447782188, "creation_date": 1447782188, "answer_id": 33763595, "question_id": 33763287, "link": "https://stackoverflow.com/questions/33763287/empty-properties-when-serializing-mongodb-data-in-go/33763595#33763595", "title": "Empty properties when serializing MongoDB data in Go", "body": "<p>I'm not familiar with the MongoDB Go API but I think your struct fields should be public in order for the MongoDB API to be able to populate them.</p>\n\n<p>Try making your fields public and see if it works:</p>\n\n<pre><code>type StationConfig struct {\n        ID     string   `bson:\"_id,omitempty\"`\n        Name   string   `bson:\"nm\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 1746, "user_id": 1682922, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/42711b798e68daccb892480677e5ca34?s=128&d=identicon&r=PG", "display_name": "markz", "link": "https://stackoverflow.com/users/1682922/markz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 33763595, "answer_count": 1, "score": 2, "last_activity_date": 1447782188, "creation_date": 1447781236, "question_id": 33763287, "link": "https://stackoverflow.com/questions/33763287/empty-properties-when-serializing-mongodb-data-in-go", "title": "Empty properties when serializing MongoDB data in Go", "body": "<p>This might be a very silly problem, but after two hours of searching the net I am posting the question here.</p>\n\n<p>I tried learning Go and have a very simple \"Hello World\" application, which uses Mongo for the data source. I can connect normally, I can fetch the data, and the count of objects turns out ok. </p>\n\n<p>The problem is, the object I map data to has empty properties, although there is data in Mongo.</p>\n\n<p>I have a very simple collection in mongo, called stations with ~12k records like these:</p>\n\n<pre><code>{ \"_id\" : ObjectId(\"563c8d56819c3c91076b7c13\"), \"nm\" : \"00000BE8\" }\n{ \"_id\" : ObjectId(\"563c8d57819c3c91076b7c1a\"), \"nm\" : \"00000C01\" }\n{ \"_id\" : ObjectId(\"563c8d58819c3c91076b7c1d\"), \"nm\" : \"00000C02\" }\n{ \"_id\" : ObjectId(\"563c8d58819c3c91076b7c1f\"), \"nm\" : \"00000C31\" }\n{ \"_id\" : ObjectId(\"563c8d5d819c3c91076b86c1\"), \"nm\" : \"000013E0\" }\n{ \"_id\" : ObjectId(\"563c8d5d819c3c91076b86c5\"), \"nm\" : \"0000110B\" }\n</code></pre>\n\n<p>The entire Go program looks like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"gopkg.in/mgo.v2\"\n)\n\ntype StationConfig struct {\n        id     string   `bson:\"_id,omitempty\"`\n        name   string   `bson:\"nm\"`\n}\n\nfunc main() {\n        session, err := mgo.Dial(\"192.168.1.41\")\n        if err != nil {\n                panic(err)\n        }\n        defer session.Close()\n\n        c := session.DB(\"metos\").C(\"stations\")\n\n        var stationConfigs []StationConfig            \n        err = c.Find(nil).Limit(100).All(&amp;stationConfigs)\n\n        if err != nil {\n                log.Fatal(err)\n        }\n\n        log.Printf(\"Found document: %+v\\n\", stationConfigs)\n}\n</code></pre>\n\n<p>But when I run the program, the values of _id and nm are not assigned to the respective struct properties and I get the following output:</p>\n\n<pre><code>Found document: [{id: name:} {id: name:} {id: name:} {id: name:} \n    {id: name:} {id: name:} {id: name:} {id: name:} {id: name:} \n    {id: name:} {id: name:} {id: name:} {id: name:} {id: name:} \n    {id: name:} {id: name:} {id: name:} {id: name:} {id: name:} \n    {id: name:} {id: name:} {id: name:} ... and so on ... ]\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1447777056, "post_id": 33761640, "comment_id": 55291164, "body": "Either with reflection or as you did which looks fine to me."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 1, "creation_date": 1447778621, "post_id": 33761640, "comment_id": 55292359, "body": "Are you trying to check whether there is at least one non-empty field within the structure? Or do you actually want to find <i>every</i> non-empty field in there and somehow react on its name/value? (although a comment, the <code>pass the data</code> bit in your code is confusing for me)"}, {"owner": {"reputation": 3563, "user_id": 1327678, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Wc6id.jpg?s=128&g=1", "display_name": "thatgibbyguy", "link": "https://stackoverflow.com/users/1327678/thatgibbyguy"}, "edited": false, "score": 0, "creation_date": 1447802077, "post_id": 33761640, "comment_id": 55305503, "body": "Yeah that data comment was out of context i suppose. My apologies, updated it to be less confusing. But yes, I would like to loop through every field, empty or not, and handle it. It looks as though that can&#39;t be done in go. Which is ok, I just wanted to know."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447854668, "post_id": 33762592, "comment_id": 55330034, "body": "@thatgibbyguy, to expand on this answer: JS, being a dynamic typeless language, has the concepts of &quot;objects&quot; and &quot;maps&quot; (dictionaries, hashes) pretty much blended. Go, being a compiled language with static typing, has these concepts rather distinct: <code>struct</code>s can&#39;t be queried for their fields at runtime (except for the long and slow path through the <code>reflect</code> package) but you can use <code>.FieldName</code> notation to access the fields of the objects of <code>struct</code> types. And you can&#39;t add or remove fields to such objects at runtime."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447854746, "post_id": 33762592, "comment_id": 55330094, "body": "@thatgibbyguy, on the other hand, you are able to add and remove values to Go <code>map</code>s but you can&#39;t use <code>.KeyName</code> notation to access these values -- only the <code>map[KeyName]</code> notation.  And you are able to iterate over all the key/value pairs in a map at runtime."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447854861, "post_id": 33762592, "comment_id": 55330192, "body": "@thatgibbyguy, what this means, in the end, is that you should take your pick: either use struct and write the code which checks the invariant or deserialize your data to a map and then use a (possibly simpler) code to check your invariant. But please think your solution through -- don&#39;t buy on this on-the-spot simplicity; try overseeing a bigger picture instead."}, {"owner": {"reputation": 3563, "user_id": 1327678, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Wc6id.jpg?s=128&g=1", "display_name": "thatgibbyguy", "link": "https://stackoverflow.com/users/1327678/thatgibbyguy"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447858991, "post_id": 33762592, "comment_id": 55333487, "body": "@kostix thanks. yes this is a radical departure from my normal way of coding, and being that Go&#39;s biggest strength to me is its use of types and that it&#39;s compiled. As such, I should just bite the bullet and be as explicit as possible. Thanks for all your help and insight."}], "tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 1, "last_activity_date": 1447779000, "creation_date": 1447779000, "answer_id": 33762592, "question_id": 33761640, "link": "https://stackoverflow.com/questions/33761640/check-all-data-keys-in-golang-at-once/33762592#33762592", "title": "Check all data keys in golang at once", "body": "<p>You are trying compare uncomparable. Javascript object is similar to map[string]interface{} . In your case could also be map[string]string and for maps you can use len(m) == 0.</p>\n\n<p>Struct is much faster container, but less flexible container. You cannot change number or types of members. </p>\n"}, {"tags": [], "owner": {"reputation": 1399, "user_id": 536113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329f705a6d4ea0185f3aca9ee823d74?s=128&d=identicon&r=PG", "display_name": "vially", "link": "https://stackoverflow.com/users/536113/vially"}, "is_accepted": true, "score": 1, "last_activity_date": 1447781966, "creation_date": 1447781966, "answer_id": 33763527, "question_id": 33761640, "link": "https://stackoverflow.com/questions/33761640/check-all-data-keys-in-golang-at-once/33763527#33763527", "title": "Check all data keys in golang at once", "body": "<p>You could use reflection to accomplish something like that:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype DisplayObject struct {\n    ID      string `json:\"id,omitempty\" bson:\"id\"`\n    URI     string `json:\"uri,omitempty\" bson:\"uri\"`\n    Display string `json:\"display,omitempty\" bson:\"display\"`\n}\n\nfunc main() {\n    displayObj := &amp;DisplayObject{ID: \"foo\"}\n    s := reflect.ValueOf(displayObj).Elem()\n    for i := 0; i &lt; s.NumField(); i++ {\n        fieldName := s.Type().Field(i).Name\n        fieldValue := s.Field(i).String()\n        fmt.Printf(\"%s: %s\\n\", fieldName, fieldValue)\n        // do something with the field data\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3563, "user_id": 1327678, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Wc6id.jpg?s=128&g=1", "display_name": "thatgibbyguy", "link": "https://stackoverflow.com/users/1327678/thatgibbyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 33763527, "answer_count": 2, "score": 0, "last_activity_date": 1447802117, "creation_date": 1447776424, "last_edit_date": 1447802117, "question_id": 33761640, "link": "https://stackoverflow.com/questions/33761640/check-all-data-keys-in-golang-at-once", "title": "Check all data keys in golang at once", "body": "<p>I have the following code:</p>\n\n<pre><code>type DisplayObject struct {\n    ID      string `json:\"id,omitempty\" bson:\"id\"`\n    URI     string `json:\"uri,omitempty\" bson:\"uri\"`\n    Display string `json:\"display,omitempty\" bson:\"display\"`\n}\n\nif DisplayObject.ID != \"\" {\n    // do something\n}\n\nif DisplayObject.URI != \"\" {\n    // do something\n}\n\nif DisplayObject.Display != \"\" {\n    // do something\n}\n</code></pre>\n\n<p>In javascript I would do</p>\n\n<pre><code>for (var key in DisplayObject) {\n  if (DisplayObject.hasOwnProperty(key)) {\n    // do something\n  }\n}\n</code></pre>\n\n<p>How can I accomplish this for loop through an object in go?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1399, "user_id": 536113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329f705a6d4ea0185f3aca9ee823d74?s=128&d=identicon&r=PG", "display_name": "vially", "link": "https://stackoverflow.com/users/536113/vially"}, "is_accepted": true, "score": 3, "last_activity_date": 1447780769, "creation_date": 1447780769, "answer_id": 33763154, "question_id": 33759300, "link": "https://stackoverflow.com/questions/33759300/archlinux-golang-cant-use-go-build/33763154#33763154", "title": "Archlinux : golang can&#39;t use go build", "body": "<p>From the error message it seems like you might be trying to import the \"go\" package in <code>main.go</code> on line 11.</p>\n\n<p>Removing that import statement should fix the problem.</p>\n"}], "owner": {"reputation": 39, "user_id": 5273213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8225edf7e7e3658201e31ae323d63eb4?s=128&d=identicon&r=PG&f=1", "display_name": "RieuxThomas", "link": "https://stackoverflow.com/users/5273213/rieuxthomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "accepted_answer_id": 33763154, "answer_count": 1, "score": -1, "last_activity_date": 1459470526, "creation_date": 1447770178, "last_edit_date": 1459470526, "question_id": 33759300, "link": "https://stackoverflow.com/questions/33759300/archlinux-golang-cant-use-go-build", "title": "Archlinux : golang can&#39;t use go build", "body": "<p>i installed archlinux few days ago, and i want to configure golang but there is some problem,\nI installed go from pacman : </p>\n\n<pre><code>pacman -S go\n</code></pre>\n\n<p>and i export some env var in my .bashrc</p>\n\n<pre><code>export PATH=$PATH:/usr/lib/go\nexport GOPATH=$HOME/go\nexport GOBIN=$GOPATH/bin\n</code></pre>\n\n<p>But when i build with \"go build\" i've got the error message :</p>\n\n<pre><code>main.go:11:2: no buildable Go source files in /usr/lib/go/src/go\n</code></pre>\n\n<p><code>go env</code> includes:</p>\n\n<pre><code>GOBIN=\"/home/thomas/go/bin\" GOEXE=\"\" GOPATH=\"/home/thomas/go\" GOROOT=\"/usr/lib/go\" \n</code></pre>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447769755, "post_id": 33759003, "comment_id": 55285752, "body": "Your function accepts a <code>string</code> not a <code>[]string</code>"}, {"owner": {"reputation": 21, "user_id": 5549504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6ad30256cbb9e5c30d50fc5459cf56?s=128&d=identicon&r=PG&f=1", "display_name": "Hua Kai", "link": "https://stackoverflow.com/users/5549504/hua-kai"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447770474, "post_id": 33759003, "comment_id": 55286249, "body": "sorry, the code is <code>func Test(websites []string) { \tfmt.Print(websites) }</code>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447773810, "post_id": 33759003, "comment_id": 55288684, "body": "Does your Go code work if you use just <code>fmt.Println(&quot;test&quot;)</code> in the body of <code>Test()</code>?"}, {"owner": {"reputation": 21, "user_id": 5549504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6ad30256cbb9e5c30d50fc5459cf56?s=128&d=identicon&r=PG&f=1", "display_name": "Hua Kai", "link": "https://stackoverflow.com/users/5549504/hua-kai"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447783671, "post_id": 33759003, "comment_id": 55295652, "body": "@kostix no, it too many arguments in call to Test"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447785752, "post_id": 33759003, "comment_id": 55296852, "body": "Uh, what? I mean, replace <code>fmt.Print(websites)</code> with <code>fmt.Println(&quot;test&quot;)</code> but keep the rest of the code on both side the same. I did not tell you to not pass your data to <code>Test()</code>, just to ignore it inside that function to know whether it fails accessing the argument data or earlier."}, {"owner": {"reputation": 21, "user_id": 5549504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6ad30256cbb9e5c30d50fc5459cf56?s=128&d=identicon&r=PG&f=1", "display_name": "Hua Kai", "link": "https://stackoverflow.com/users/5549504/hua-kai"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447786265, "post_id": 33759003, "comment_id": 55297136, "body": "@kostix ok,i know.i use your method, go use <code>Test(&quot;aaa&quot;)</code>,it <code>cannot use &quot;aaa&quot; (type string) as type []string in argument to Test</code>, i dont&#39;t know how to send a []string use python,python import httptest,it still error:<code>panic: runtime error: invalid memory address or nil pointer dereference [signal 0xb code=0x1 addr=0x1 pc=0x102434698]</code>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447802249, "post_id": 33759003, "comment_id": 55305565, "body": "Are you kidding? I mean use <code>func Test(websites []string) { fmt.Println(&quot;test&quot;); }</code> to see if panicking happens upon accessing <code>websites</code> or not. Was it really this much undecipherable in my two attempts?"}, {"owner": {"reputation": 21, "user_id": 5549504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6ad30256cbb9e5c30d50fc5459cf56?s=128&d=identicon&r=PG&f=1", "display_name": "Hua Kai", "link": "https://stackoverflow.com/users/5549504/hua-kai"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447813503, "post_id": 33759003, "comment_id": 55309012, "body": "@kostix i already use your code <code>func Test(websites []string) { fmt.Println(&quot;test&quot;); }</code>  the same error."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5549504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6ad30256cbb9e5c30d50fc5459cf56?s=128&d=identicon&r=PG&f=1", "display_name": "Hua Kai", "link": "https://stackoverflow.com/users/5549504/hua-kai"}, "is_accepted": false, "score": 0, "last_activity_date": 1447818407, "creation_date": 1447818407, "answer_id": 33771479, "question_id": 33759003, "link": "https://stackoverflow.com/questions/33759003/using-gopy-how-to-properly-pass-string-from-python-to-go/33771479#33771479", "title": "Using `gopy`, how to properly pass []string from Python to Go?", "body": "<p>ok,i find the way!! 23333</p>\n\n<p>golang</p>\n\n<pre><code>var (\n    WebSites = [1]string{\"aaa\"}\n)\n</code></pre>\n\n<p>in the python </p>\n\n<pre><code>import httpget\ns = httpget.GetWebSites()\ns[0] = \"http://www.baidu.com\"\nhttpget.Test(s)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5549504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6ad30256cbb9e5c30d50fc5459cf56?s=128&d=identicon&r=PG&f=1", "display_name": "Hua Kai", "link": "https://stackoverflow.com/users/5549504/hua-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447818407, "creation_date": 1447769253, "last_edit_date": 1447813640, "question_id": 33759003, "link": "https://stackoverflow.com/questions/33759003/using-gopy-how-to-properly-pass-string-from-python-to-go", "title": "Using `gopy`, how to properly pass []string from Python to Go?", "body": "<p>My Go code is:</p>\n\n<pre><code>func Test(websites []string) {\n    fmt.Print(\"test\")\n}\n</code></pre>\n\n<p>I use <code>gopy build</code> to produce the <code>httpget.so</code> file</p>\n\n<p>I then try to load ans use this module, <code>httpget.so</code>, in my Python code:</p>\n\n<pre><code>import httpget\nprint dir(httpget)\n\nhttpget.Test([\"aaaa\"])\n</code></pre>\n\n<p>But calling that function results in a panic on the Go side:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x1 pc=0x103998688]\n\ngoroutine 17 [running, locked to thread]:\nmain.cgo_func_httpget_Test(0x1)\n    /private/var/folders/yg/tx1wr1c5233fd299lpqnvjy40000gn/T/gopy-066392802/httpget.go:173 +0x18\n\ngoroutine 18 [syscall, locked to thread]:\nruntime.goexit()\n    /usr/local/Cellar/go/1.5.1/libexec/src/runtime/asm_amd64.s:1696 +0x1\n</code></pre>\n\n<p>How should I fix this problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447769934, "post_id": 33758834, "comment_id": 55285871, "body": "There is no <code>while</code> loop in Go. Change it with <code>for</code>."}, {"owner": {"reputation": 57, "user_id": 4653552, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b8479c9010dff1ec6ace7225376449f3?s=128&d=identicon&r=PG&f=1", "display_name": "ellen zhu", "link": "https://stackoverflow.com/users/4653552/ellen-zhu"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447770671, "post_id": 33758834, "comment_id": 55286427, "body": "yes, I just checked the tutorial and noticed that. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4653552, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b8479c9010dff1ec6ace7225376449f3?s=128&d=identicon&r=PG&f=1", "display_name": "ellen zhu", "link": "https://stackoverflow.com/users/4653552/ellen-zhu"}, "edited": false, "score": 0, "creation_date": 1447770730, "post_id": 33759115, "comment_id": 55286470, "body": "Yes, you are right. Because I am a new learner, so there are manys things I do not know. Thanks."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 0, "last_activity_date": 1447769624, "creation_date": 1447769624, "answer_id": 33759115, "question_id": 33758834, "link": "https://stackoverflow.com/questions/33758834/non-declaration-statement-outside-function-body-error-in-go/33759115#33759115", "title": "non-declaration statement outside function body error in GO", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"math\"\n)\n\nfunc Min(a, b int) int {\n    if a &gt; b {\n        return b\n    }\n    return a\n}\n\nfunc isAvailable(k, mid int) bool {\n    // ...\n    return true\n}\n\nfunc Solution(A []int, B []int, K int) int {\n    largestId := 0\n    // ...\n    res := math.MaxInt32\n    low := 0\n    high := Min(900, largestId)\n\n    for low &lt;= high {\n        mid := (low + high) / 2\n        if isAvailable(K, mid) {\n            res = Min(res, mid)\n            high = mid - 1\n        } else {\n            low = mid + 1\n        }\n\n    }\n    return res\n}\n\nfunc main() {}\n</code></pre>\n\n<p>You need to learn basic Go syntax. Take the <a href=\"https://tour.golang.org/\" rel=\"nofollow\">Go Tour</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 2, "last_activity_date": 1447770788, "last_edit_date": 1447770788, "creation_date": 1447770256, "answer_id": 33759339, "question_id": 33758834, "link": "https://stackoverflow.com/questions/33758834/non-declaration-statement-outside-function-body-error-in-go/33759339#33759339", "title": "non-declaration statement outside function body error in GO", "body": "<p>There's no <code>while</code> loop in Go. Only <code>for</code>. If I do this:</p>\n\n<pre><code>package main\n\nfunc main() {\n    var n int\n    while (n &lt; 10) {\n        n++\n    }\n    return\n}\n</code></pre>\n\n<p>I get the following error (similar to yours):</p>\n\n<pre><code>untitled 3:6: syntax error: unexpected ++, expecting }\nuntitled 3:8: non-declaration statement outside function body\nuntitled 3:9: syntax error: unexpected }\n</code></pre>\n\n<p>If I do <code>while n &lt; 10</code> (no parentheses) I get more precise message, i.e. an <em>unexpected name</em> error on line 5 (<code>while</code>). I believe due to a bracket usage compiler treats (non-reserved word) <code>while</code> as a type (function call or type conversion), but before realising it's non-existent there are other errors to report. Hence, maybe, a confusing message for you.</p>\n\n<p>Unless you have other errors in your code, renaming <code>while</code> to <code>for</code> should work. And drop the brackets.</p>\n"}], "owner": {"reputation": 57, "user_id": 4653552, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b8479c9010dff1ec6ace7225376449f3?s=128&d=identicon&r=PG&f=1", "display_name": "ellen zhu", "link": "https://stackoverflow.com/users/4653552/ellen-zhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2374, "favorite_count": 1, "accepted_answer_id": 33759115, "answer_count": 2, "score": 0, "last_activity_date": 1447770788, "creation_date": 1447768753, "last_edit_date": 1447769871, "question_id": 33758834, "link": "https://stackoverflow.com/questions/33758834/non-declaration-statement-outside-function-body-error-in-go", "title": "non-declaration statement outside function body error in GO", "body": "<p>I am a new learner with Go, and these problems confused me a lot. I cannot solve them, could you guys give me a hand?</p>\n\n<pre><code>func Solution(A []int, B[]int, K int) int{\n.......\nres = MaxInt32 \nlow = 0\nhigh = Min(900, largestId) //largestId is limited here\nmid = 0\n\nwhile(low &lt;= high){\n    mid = {low + high} / 2         55\n    if(isAvailable(K, mid)){\n        res := Min(res, mid)\n        high :=mid - 1\n    } else{\n        low := mid + 1\n    }\n\n}\nreturn res                         64\n}                                  65\n</code></pre>\n\n<p>The errors show:</p>\n\n<pre><code>workspace/src/solution/solution.go:55: syntax error: unexpected =, expecting }\nworkspace/src/solution/solution.go:64: non-declaration statement outside function body\nworkspace/src/solution/solution.go:65: syntax error: unexpected }\n</code></pre>\n\n<p>I don't understand why these problems come?</p>\n"}, {"tags": ["go", "profiling"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1447765495, "post_id": 33757309, "comment_id": 55282899, "body": "Can you share some code? (a simplified version, just showing how you use the profiler)"}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1447791243, "post_id": 33757309, "comment_id": 55299953, "body": "Have you constructed a much simpler example, and got profiling working successfully? Profiling works on &#39;broken&#39; versions of Mac OS X, i.e. output is generated, but it becomes increasingly inaccurate with multiple go routines. There is also a report that profiling works correctly with OS X El Capitan. Hence it is likely that the program is set up incorrectly, hence the suggestion to do something simple first."}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 1380169, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2c56375fda28d2bc21d65758e05eea56?s=128&d=identicon&r=PG", "display_name": "alexandra.s", "link": "https://stackoverflow.com/users/1380169/alexandra-s"}, "edited": false, "score": 0, "creation_date": 1447927759, "post_id": 33778530, "comment_id": 55367360, "body": "I don&#39;t get any results with &quot;net/http/pprof&quot; either:                                     go tool pprof <a href=\"http://localhost:8080/debug/pprof/block\" rel=\"nofollow noreferrer\">localhost:8080/debug/pprof/block</a> Fetching profile from <a href=\"http://localhost:8080/debug/pprof/block\" rel=\"nofollow noreferrer\">localhost:8080/debug/pprof/block</a> server response: 204 No Content"}, {"owner": {"reputation": 1005, "user_id": 166374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6e814af3bff7aaca5d1e2c7b20c7b516?s=128&d=identicon&r=PG", "display_name": "code_martial", "link": "https://stackoverflow.com/users/166374/code-martial"}, "reply_to_user": {"reputation": 291, "user_id": 1380169, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2c56375fda28d2bc21d65758e05eea56?s=128&d=identicon&r=PG", "display_name": "alexandra.s", "link": "https://stackoverflow.com/users/1380169/alexandra-s"}, "edited": false, "score": 1, "creation_date": 1448540829, "post_id": 33778530, "comment_id": 55636500, "body": "1) Block Profiling needs to be enabled explicitly <a href=\"https://golang.org/pkg/runtime/#SetBlockProfileRate\" rel=\"nofollow noreferrer\">golang.org/pkg/runtime/#SetBlockProfileRate</a> 2) you need to include the path to the binary being profiled for the profiling data to make sense."}], "tags": [], "owner": {"reputation": 1005, "user_id": 166374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6e814af3bff7aaca5d1e2c7b20c7b516?s=128&d=identicon&r=PG", "display_name": "code_martial", "link": "https://stackoverflow.com/users/166374/code-martial"}, "is_accepted": false, "score": 1, "last_activity_date": 1447845058, "creation_date": 1447845058, "answer_id": 33778530, "question_id": 33757309, "link": "https://stackoverflow.com/questions/33757309/profiling-golang-server/33778530#33778530", "title": "Profiling Golang server", "body": "<p>Firstly, I'm not sure whether you're trying to do latency profiling. If so, be aware that Go's CPU profiler only reports time spent by a function executing on the CPU and doesn't include time spent sleeping, etc. If CPU Profiling really is what you're looking for, read on.</p>\n\n<p>If you're running a webserver, just include the following in your imports (in the file where main() is) and rebuild:</p>\n\n<pre><code>import _ \"net/http/pprof\"\n</code></pre>\n\n<p>Then, while applying load through jmeter, run:</p>\n\n<pre><code>go tool pprof /path/to/webserver/binary http://&lt;server&gt;/debug/pprof/profile\n</code></pre>\n\n<p>The <code>net/http/pprof</code> package provides profiling hooks that allow you to profile your webserver on demand any time, even while it's running in production. You may want to use a different, firewalled port for it, though, if your webserver is meant to be exposed publicly.</p>\n"}], "owner": {"reputation": 291, "user_id": 1380169, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2c56375fda28d2bc21d65758e05eea56?s=128&d=identicon&r=PG", "display_name": "alexandra.s", "link": "https://stackoverflow.com/users/1380169/alexandra-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1428, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447845058, "creation_date": 1447764341, "question_id": 33757309, "link": "https://stackoverflow.com/questions/33757309/profiling-golang-server", "title": "Profiling Golang server", "body": "<p>I want to profile a simple webserver that I wrote in Go. It accepts requests, maps the request to avro object and sends it to Kafka in a go routine. The requirement is that it answers immediately and sends an object to the Kafka later. Locally it answers in under 1 ms on average. I have been trying to profile it by starting the script with davecheney/profile package and sending test requests with jmeter. I can see in the output that the profile file is generated but it remains empty, no matter how long jemeter is sending the requests. I'm running it on Mac El Capitan. I read that there were some issues with profiling on Mac but it would be working on El Capitan. Do you have any tips?</p>\n"}, {"tags": ["go", "deadlock"], "answers": [{"comments": [{"owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "edited": false, "score": 0, "creation_date": 1447765025, "post_id": 33757408, "comment_id": 55282586, "body": "That is helpful and makes sense. So I&#39;m going to assume that theres no way the channel can have more than one value added to it - so that means that Go has already deemed a goroutine as &quot;asleep&quot; rather than just simply blocked by the channel. How/why would it be asleep?"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "reply_to_user": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "edited": false, "score": 0, "creation_date": 1447765131, "post_id": 33757408, "comment_id": 55282659, "body": "It is blocked by the channels operations, in a way that cannot unblock. The runtime detects that all goroutines are in a blocked state, so there is no event that could happen unblocking any of them."}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 1, "last_activity_date": 1447765038, "last_edit_date": 1447765038, "creation_date": 1447764628, "answer_id": 33757408, "question_id": 33757107, "link": "https://stackoverflow.com/questions/33757107/why-does-this-cause-a-deadlock-in-go/33757408#33757408", "title": "Why does this cause a deadlock in Go?", "body": "<pre><code>goroutine 1 [chan send]:\ngoroutine 5 [chan send]:\ngoroutine 6 [chan send]:\n</code></pre>\n\n<p>This tells it all: all your goroutines are blocked trying to send on a channel with no one to receive on the other end.</p>\n\n<p>So your first goroutine blocks on  <code>chan2 &lt;- true</code>, your second blocks on <code>chan1 &lt;- true</code> and your main goroutine blocks on its own <code>chan1 &lt;- true</code>.</p>\n\n<p>As to why it does two \"full ping-pings\" like you say, it depends on scheduling and from which sender <code>&lt;-chan1</code> decides to receive first.</p>\n\n<p>On my computer, I get more and it varies each time I run it:</p>\n\n<pre><code>chan1\nchan2\nchan1\nchan2\nchan1\nchan2\nchan1\nchan2\nchan1\nchan2\nchan1\nchan2\nchan1\nfatal error: all goroutines are asleep - deadlock!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4049, "user_id": 1133802, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c77d19fe400931dea2eb52303a851bb6?s=128&d=identicon&r=PG", "display_name": "mostruash", "link": "https://stackoverflow.com/users/1133802/mostruash"}, "is_accepted": false, "score": 1, "last_activity_date": 1447764963, "creation_date": 1447764963, "answer_id": 33757525, "question_id": 33757107, "link": "https://stackoverflow.com/questions/33757107/why-does-this-cause-a-deadlock-in-go/33757525#33757525", "title": "Why does this cause a deadlock in Go?", "body": "<p>It looks complicated but the answer is easy.</p>\n\n<p>It'll deadlock when:</p>\n\n<ul>\n<li>First routine is trying to write to <code>chan2</code></li>\n<li>Second route is trying to write to <code>chan1</code>.</li>\n<li>Main is trying to write to <code>chan1</code>.</li>\n</ul>\n\n<p>How can that happen? Example:</p>\n\n<ul>\n<li>Main writes <code>chan1</code>. Blocks on another write.</li>\n<li>Routine 1: <code>chan1</code> receives from Main. Prints. Blocks on write <code>chan2</code>.</li>\n<li>Routine 2: <code>chan2</code> receives. Prints. Blocks on write <code>chan1</code>.</li>\n<li>Routine 1: <code>chan1</code> receives from Routine 2. Prints. Blocks on write <code>chan2</code>.</li>\n<li>Routine 2: <code>chan2</code> receives. Prints. Blocks on write <code>chan1</code>.</li>\n<li>Main writes <code>chan1</code>. Blocks on another write.</li>\n<li>Routine 1: <code>chan1</code> receives from Main. Prints. Blocks on write <code>chan2</code>.</li>\n<li>Main writes <code>chan1</code>. Blocks on another write.</li>\n</ul>\n\n<p>Currently all routines are blocked. i.e.:</p>\n\n<p>Routine 1 cannot write to <code>chan2</code> because Routine 2 is not receiving but is actually blocked trying to write to <code>chan1</code>. But no one is listening on <code>chan1</code>.</p>\n\n<p>As @HectorJ said, it all depends on the scheduler. But in this setup, a deadlock is inevitable.</p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 7, "last_activity_date": 1447771025, "last_edit_date": 1447771025, "creation_date": 1447765715, "answer_id": 33757764, "question_id": 33757107, "link": "https://stackoverflow.com/questions/33757107/why-does-this-cause-a-deadlock-in-go/33757764#33757764", "title": "Why does this cause a deadlock in Go?", "body": "<p>From the runtime perspective you get a deadlock because all routines try to send onto a channel and there's no routine waiting to receive anything.</p>\n\n<p>But <em>why</em> is it happening? I will give you a story as I like visualising what my routines are doing when I encounter a deadlock.</p>\n\n<p>You have two players (routines) and one ball (<code>true</code> value). Every player waits for a ball and once they get it they pass it back to the other player (through a channel). This is what your <em>two</em> routines are really doing and this would indeed produce an infinite loop.</p>\n\n<p>The problem is the third player introduced in your main loop. He's hiding behind the second player and once he sees the first player has empty hands, he throws <em>another</em> ball at him. So we end up with both players holding a ball, couldn't pass it to another player because the other one has (the first) ball in his hands already. The hidden, evil player is also trying to pass <em>yet another</em> ball. Everyone is confused, because there're three balls, three players and no empty hands.</p>\n\n<p>In other words, you have introduced the third player who is breaking the game. He should be an arbiter passing the very first ball at the beginning of the game, watching it, but stop producing balls! It means, instead of having a loop in you main routine, there should be simply <code>chan1 &lt;- true</code> (and some condition to wait, so we don't exit the program).</p>\n\n<p>If you enable logging in the loop of main routine, you will see the deadlock occurs <em>always</em> on the third iteration. The number of times the other routines are executed depends on the scheduler. Bringing back the story: first iteration is a kick-off of the first ball; next iteration is a mysterious second ball, but this can be handled. The third iteration is a deadlock \u2013 it brings to life the third ball which can't be handled by anybody.</p>\n"}], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 33757764, "answer_count": 3, "score": 2, "last_activity_date": 1447771025, "creation_date": 1447763747, "question_id": 33757107, "link": "https://stackoverflow.com/questions/33757107/why-does-this-cause-a-deadlock-in-go", "title": "Why does this cause a deadlock in Go?", "body": "<p>This is not a question about how to better write this. It's a question specifically about why Go is causing a deadlock in this scenario.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    chan1 := make(chan bool)\n    chan2 := make(chan bool)\n\n    go func() {\n        for {\n            &lt;-chan1\n            fmt.Printf(\"chan1\\n\")\n            chan2 &lt;- true\n        }\n    }()\n\n    go func() {\n        for {\n            &lt;-chan2\n            fmt.Printf(\"chan2\\n\")\n            chan1 &lt;- true\n        }\n    }()\n\n    for {\n        chan1 &lt;- true\n    }\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>chan1\nchan2\nchan1\nchan2\nchan1\nfatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan send]:\ngoroutine 5 [chan send]:\ngoroutine 6 [chan send]:\nexit status 2\n</code></pre>\n\n<p>Why does this not cause an infinite loop? How come it does two full \"ping-pings\" (instead of just one) before giving up?</p>\n"}, {"tags": ["go", "installation", "silent"], "comments": [{"owner": {"reputation": 3136, "user_id": 3751577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9AQ6n.png?s=128&g=1", "display_name": "Hexaholic", "link": "https://stackoverflow.com/users/3751577/hexaholic"}, "edited": false, "score": 0, "creation_date": 1447757799, "post_id": 33755113, "comment_id": 55277787, "body": "Have you tried to run it as Administrator?"}, {"owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "reply_to_user": {"reputation": 3136, "user_id": 3751577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9AQ6n.png?s=128&g=1", "display_name": "Hexaholic", "link": "https://stackoverflow.com/users/3751577/hexaholic"}, "edited": false, "score": 0, "creation_date": 1447757906, "post_id": 33755113, "comment_id": 55277864, "body": "Yes I tried to Run this as Administrator still have the same problem"}, {"owner": {"reputation": 3136, "user_id": 3751577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9AQ6n.png?s=128&g=1", "display_name": "Hexaholic", "link": "https://stackoverflow.com/users/3751577/hexaholic"}, "edited": false, "score": 0, "creation_date": 1447758320, "post_id": 33755113, "comment_id": 55278162, "body": "I don&#39;t know Go, but it looks like you have to find a way to make the <code>exec.Command()</code> function run the program with admin rights. Sorry for not being more helpful :)"}, {"owner": {"reputation": 3136, "user_id": 3751577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9AQ6n.png?s=128&g=1", "display_name": "Hexaholic", "link": "https://stackoverflow.com/users/3751577/hexaholic"}, "edited": false, "score": 0, "creation_date": 1447759005, "post_id": 33755113, "comment_id": 55278582, "body": "One more thing... Do you know the <code>runas</code> command? For example like this: <code>runas &#47;user:Administrator &quot;C:\\Windows2008R2.exe&quot;</code>. It will prompt for the admin password, so I do not know if it is possible to use it in your situation, but you could try."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 5571690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kd14Y.jpg?s=128&g=1", "display_name": "Santhosh R", "link": "https://stackoverflow.com/users/5571690/santhosh-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1447759028, "creation_date": 1447759028, "answer_id": 33755557, "question_id": 33755113, "link": "https://stackoverflow.com/questions/33755113/authentication-issue-while-installing-microsoft-visual-c-2008-redistributable/33755557#33755557", "title": "Authentication Issue while installing Microsoft Visual c++ 2008 Redistributable package", "body": "<p>Seems like you are not the owner of the file.\nIn order to change the ownership of the files you can...</p>\n\n<ol>\n<li>go in to the properties of the folder that contains the files you need to take ownership of</li>\n<li>click on the security tab</li>\n<li>click Advanced</li>\n<li>click on the Owner tab</li>\n<li>Click Edit...</li>\n<li>Select the account name in the Change owner to list that you want to take ownership</li>\n<li>Check the box, Replace owner on subcontainers and objects</li>\n<li>Click OK </li>\n</ol>\n"}], "owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "accepted_answer_id": 33755557, "answer_count": 1, "score": 1, "last_activity_date": 1447759028, "creation_date": 1447757654, "last_edit_date": 1447757862, "question_id": 33755113, "link": "https://stackoverflow.com/questions/33755113/authentication-issue-while-installing-microsoft-visual-c-2008-redistributable", "title": "Authentication Issue while installing Microsoft Visual c++ 2008 Redistributable package", "body": "<p>When i try to install Microsoft Redistributable package silently through golang i get this error </p>\n\n<p>**</p>\n\n<blockquote>\n  <p>fork/exec C:\\Windows2008R2.exe: The requested operation requires\n  elevation.</p>\n</blockquote>\n\n<p>**</p>\n\n<p>And my code is as follows</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    co := exec.Command(\"C:\\\\Windows2008R2.exe\",\"/q\",\"/c:\\\"msiexec\",\"/i\",\"Windows2008R2.msi\",\"/qn\",\"/l*v\",\"C:\\\\Windows2008R2_x64.log\\\"\")\n    if err := co.Run(); err != nil { \n        fmt.Println(\"Error: \", err)\n    }  \n}\n</code></pre>\n"}, {"tags": ["xml", "parsing", "go"], "answers": [{"tags": [], "owner": {"reputation": 4110, "user_id": 517616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O19zB.jpg?s=128&g=1", "display_name": "Karl Laurentius Roos", "link": "https://stackoverflow.com/users/517616/karl-laurentius-roos"}, "is_accepted": false, "score": 2, "last_activity_date": 1447756835, "creation_date": 1447756835, "answer_id": 33754846, "question_id": 33754545, "link": "https://stackoverflow.com/questions/33754545/xml-parsing-in-golang-with-chardata/33754846#33754846", "title": "xml parsing in golang with chardata", "body": "<p>In your struct you're saying that the xml node is called <code>username</code> when it's actually called <code>userName</code>.</p>\n\n<p>Simply replace this:</p>\n\n<pre><code>Username CData `xml:\"username\"`\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>Username CData `xml:\"userName\"`\n</code></pre>\n\n<p>And it should work fine.</p>\n"}], "owner": {"reputation": 1, "user_id": 5538586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a71577ebeb3f3fec038d242a917de9?s=128&d=identicon&r=PG&f=1", "display_name": "Rehana", "link": "https://stackoverflow.com/users/5538586/rehana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 3, "answer_count": 1, "score": 0, "last_activity_date": 1447756835, "creation_date": 1447755968, "question_id": 33754545, "link": "https://stackoverflow.com/questions/33754545/xml-parsing-in-golang-with-chardata", "title": "xml parsing in golang with chardata", "body": "<p><a href=\"https://play.golang.org/p/RioZSwO6WB\" rel=\"nofollow\">https://play.golang.org/p/RioZSwO6WB</a> ,please look into it i am not able to get the username after parsing ,program in working fine ,please look into it.</p>\n\n<p>thanks in advance </p>\n"}, {"tags": ["performance", "go", "compilation"], "comments": [{"owner": {"reputation": 6266, "user_id": 5497207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e185da0f69447ef588089e15e15198?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz Ozgul", "link": "https://stackoverflow.com/users/5497207/oguz-ozgul"}, "edited": false, "score": 0, "creation_date": 1447753152, "post_id": 33753454, "comment_id": 55274596, "body": "You are not using them does not mean another consumer of your class will not. Unused variables don&#39;t by default block compiling. It&#39;s a warning as far as I know."}, {"owner": {"reputation": 426, "user_id": 5571277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IrSIrAF1xYo/AAAAAAAAAAI/AAAAAAAAAEY/YpqfdVW5VZ4/photo.jpg?sz=128", "display_name": "Mistermatt", "link": "https://stackoverflow.com/users/5571277/mistermatt"}, "reply_to_user": {"reputation": 6266, "user_id": 5497207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e185da0f69447ef588089e15e15198?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz Ozgul", "link": "https://stackoverflow.com/users/5497207/oguz-ozgul"}, "edited": false, "score": 0, "creation_date": 1447754817, "post_id": 33753454, "comment_id": 55275668, "body": "@OguzOzgul You&#39;re right but, in a main package ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1447758635, "post_id": 33753454, "comment_id": 55278351, "body": "This question is not a duplicate of the originally marked one (<a href=\"http://stackoverflow.com/questions/22549228/why-does-golang-allow-compilation-of-unused-function-parameters\">this</a>, as it&#39;s about unused function <i>parameters</i> and not the <i>functions</i> themselves), but this is a possible duplicate of <a href=\"http://stackoverflow.com/questions/32564935/why-does-golang-allow-compilation-of-unused-functions\">Why Does Golang Allow Compilation of Unused Functions?</a>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6266, "user_id": 5497207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e185da0f69447ef588089e15e15198?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz Ozgul", "link": "https://stackoverflow.com/users/5497207/oguz-ozgul"}, "edited": false, "score": 0, "creation_date": 1447758922, "post_id": 33753454, "comment_id": 55278534, "body": "@OguzOzgul Unused variables is a compile-time <i>error</i>, not a warning. There are no compiler warnings in Go. And if a package has an unexported function which if the package itself doesn&#39;t call, noone else will as noone else can reach that (not even with reflection)."}, {"owner": {"reputation": 6266, "user_id": 5497207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e185da0f69447ef588089e15e15198?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz Ozgul", "link": "https://stackoverflow.com/users/5497207/oguz-ozgul"}, "edited": false, "score": 0, "creation_date": 1447767361, "post_id": 33753454, "comment_id": 55284118, "body": "Please forgive my dumbness for commenting on this question as if it was tagged c#. I don&#39;t know what is wrong with me :)"}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447769294, "post_id": 33753454, "comment_id": 55285420, "body": "Not sure why the downvotes \u2013 although short, it&#39;s a completely valid question. Very healthy curiosity."}, {"owner": {"reputation": 426, "user_id": 5571277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IrSIrAF1xYo/AAAAAAAAAAI/AAAAAAAAAEY/YpqfdVW5VZ4/photo.jpg?sz=128", "display_name": "Mistermatt", "link": "https://stackoverflow.com/users/5571277/mistermatt"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447775948, "post_id": 33753454, "comment_id": 55290414, "body": "@tomasz thanks for the comment (:"}], "answers": [{"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 2, "last_activity_date": 1447847013, "last_edit_date": 1447847013, "creation_date": 1447769067, "answer_id": 33758942, "question_id": 33753454, "link": "https://stackoverflow.com/questions/33753454/why-can-we-have-unused-functions-but-we-cant-have-unused-variables/33758942#33758942", "title": "Why can we have unused functions but we can&#39;t have unused variables?", "body": "<p>The behaviour seems consistent between variables and functions \u2013 both are allowed in a package-level scope, even if unused.</p>\n\n<p>This snippet is compiling without any issues:</p>\n\n<pre><code>package main\n\nvar v int // unused variable\n\nfunc f() {} // unused function\n\nfunc main() {}\n</code></pre>\n\n<p>Now, when it comes to local scope things are different and unused variables generate errors. Same for function literals (named nested functions are not allowed in Go):</p>\n\n<pre><code>func main() {\n    func() {}\n}\n// Error: func literal evaluated but not used\n</code></pre>\n\n<p>Finally, why is only local scope checked for unused variables? Because usually it's a bug (for examples, in Go, due to an accidental usage of <code>:=</code>). And compiler saved me many times here. Consider this:</p>\n\n<pre><code>func f() (err error) {\n    if somthing {\n        err := g() // err is unused variable! I really meant `=`.\n    }\n    return\n}\n</code></pre>\n\n<p>For global (package-level) scopes unused variables and functions are usually just polluting the namespace as, for example, someone forgot to remove them after refactoring. There're some tools which helps detecting these, for example:</p>\n\n<ol>\n<li><a href=\"https://github.com/opennota/check\" rel=\"nofollow\">https://github.com/opennota/check</a></li>\n<li><a href=\"https://github.com/alecthomas/gometalinter\" rel=\"nofollow\">https://github.com/alecthomas/gometalinter</a> (uses the previous package)</li>\n<li><a href=\"https://github.com/remyoudompheng/go-misc/blob/master/deadcode/deadcode.go\" rel=\"nofollow\">https://github.com/remyoudompheng/go-misc/blob/master/deadcode/deadcode.go</a></li>\n</ol>\n\n<p>I also found a <a href=\"https://groups.google.com/d/msg/golang-nuts/Mo9gZDkg9vw/F23ZRPKVF_MJ\" rel=\"nofollow\">post by Russ Cox</a> commenting on the issue:</p>\n\n<blockquote>\n  <p>I have been writing some C code with gcc -Wall -Werror recently. It\n  makes prototyping code somewhat difficult to be told \"you didn't use\n  that function, go fix it\" when you're just trying to test what you've\n  got so far, or commenting out calls that are possibly causing trouble.\n  Of course the same is true for warning about unused local variables\n  too. The difference is that, in Go, because of :=, an unused local\n  variable is very often a bug, while an unused unexported function is\n  much less often a bug.</p>\n  \n  <p>Russ</p>\n</blockquote>\n"}], "owner": {"reputation": 426, "user_id": 5571277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IrSIrAF1xYo/AAAAAAAAAAI/AAAAAAAAAEY/YpqfdVW5VZ4/photo.jpg?sz=128", "display_name": "Mistermatt", "link": "https://stackoverflow.com/users/5571277/mistermatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 33758942, "answer_count": 1, "score": 1, "last_activity_date": 1447847013, "creation_date": 1447752954, "last_edit_date": 1447753510, "question_id": 33753454, "link": "https://stackoverflow.com/questions/33753454/why-can-we-have-unused-functions-but-we-cant-have-unused-variables", "title": "Why can we have unused functions but we can&#39;t have unused variables?", "body": "<p>Unused variables will block compiling (that's a good thing) but compiler don't really care about unused functions, is there an explanation ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1280, "user_id": 4932403, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uLzID.jpg?s=128&g=1", "display_name": "KeylorSanchez", "link": "https://stackoverflow.com/users/4932403/keylorsanchez"}, "edited": false, "score": 0, "creation_date": 1447749363, "post_id": 33752247, "comment_id": 55272264, "body": "Do you use a proxy ? And for your second error, are you sure that your Gopath contains the src, pgk and bin directories ?"}, {"owner": {"reputation": 2507, "user_id": 4364572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1f6ffcd1d5e5c0b2f8613afb95429f27?s=128&d=identicon&r=PG", "display_name": "utkbansal", "link": "https://stackoverflow.com/users/4364572/utkbansal"}, "reply_to_user": {"reputation": 1280, "user_id": 4932403, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uLzID.jpg?s=128&g=1", "display_name": "KeylorSanchez", "link": "https://stackoverflow.com/users/4932403/keylorsanchez"}, "edited": false, "score": 0, "creation_date": 1447749540, "post_id": 33752247, "comment_id": 55272360, "body": "<code>utkbansal@Dell:~$ ls $GOPATH</code> gives <code>bin  pkg  src</code>"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447755763, "post_id": 33752247, "comment_id": 55276341, "body": "Don&#39;t use <code>sudo</code>. Once you&#39;ve used it, you&#39;ve then changed the permissions of associated folders (hence permission denied). Remove <code>&#47;home&#47;utkbansal&#47;go</code> and below, and start over."}, {"owner": {"reputation": 1720, "user_id": 989659, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84d2d1476d96b093bd0f180412db2460?s=128&d=identicon&r=PG", "display_name": "Srgrn", "link": "https://stackoverflow.com/users/989659/srgrn"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447755971, "post_id": 33752247, "comment_id": 55276477, "body": "@elithrar: the error is not because of the permissions it is due to the fact that the godoc binary he tries to update sits in /usr/lib/go/bin/godoc"}, {"owner": {"reputation": 2507, "user_id": 4364572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1f6ffcd1d5e5c0b2f8613afb95429f27?s=128&d=identicon&r=PG", "display_name": "utkbansal", "link": "https://stackoverflow.com/users/4364572/utkbansal"}, "reply_to_user": {"reputation": 1720, "user_id": 989659, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84d2d1476d96b093bd0f180412db2460?s=128&d=identicon&r=PG", "display_name": "Srgrn", "link": "https://stackoverflow.com/users/989659/srgrn"}, "edited": false, "score": 0, "creation_date": 1447756218, "post_id": 33752247, "comment_id": 55276644, "body": "@Srgrn what should i do then?"}, {"owner": {"reputation": 2507, "user_id": 4364572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1f6ffcd1d5e5c0b2f8613afb95429f27?s=128&d=identicon&r=PG", "display_name": "utkbansal", "link": "https://stackoverflow.com/users/4364572/utkbansal"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447756351, "post_id": 33752247, "comment_id": 55276718, "body": "@elithrar removing the go folder and trying to install the package again doesn&#39;t work either. It gives the same error."}, {"owner": {"reputation": 1720, "user_id": 989659, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84d2d1476d96b093bd0f180412db2460?s=128&d=identicon&r=PG", "display_name": "Srgrn", "link": "https://stackoverflow.com/users/989659/srgrn"}, "edited": false, "score": 0, "creation_date": 1447756421, "post_id": 33752247, "comment_id": 55276762, "body": "see my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "is_accepted": false, "score": -1, "last_activity_date": 1447759105, "last_edit_date": 1447759105, "creation_date": 1447754350, "answer_id": 33753964, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages/33753964#33753964", "title": "Unable to install Go packages", "body": "<p>`sudo GOPATH=path_to_go_installation go get -u golang.org/x/tools/cmd/...</p>\n\n<p><code>sudo</code> - run followed commands as root.<br/></p>\n\n<p><code>GOPATH=path_to_go_installation</code> - sets environment variable for <code>sudo</code> session.<br/></p>\n\n<p><code>go get</code> - installs package into <code>GOPATH</code> that was set on the previous step. </p>\n"}, {"comments": [{"owner": {"reputation": 2507, "user_id": 4364572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1f6ffcd1d5e5c0b2f8613afb95429f27?s=128&d=identicon&r=PG", "display_name": "utkbansal", "link": "https://stackoverflow.com/users/4364572/utkbansal"}, "edited": false, "score": 0, "creation_date": 1447756531, "post_id": 33754131, "comment_id": 55276831, "body": "<code>root@Dell:&#47;home&#47;utkbansal# go get -u golang.org&#47;x&#47;tools&#47;cmd&#47;... package golang.org&#47;x&#47;tools&#47;cmd&#47;...: cannot download, $GOPATH not set. For more details see: go help gopath </code>"}, {"owner": {"reputation": 1720, "user_id": 989659, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84d2d1476d96b093bd0f180412db2460?s=128&d=identicon&r=PG", "display_name": "Srgrn", "link": "https://stackoverflow.com/users/989659/srgrn"}, "reply_to_user": {"reputation": 2507, "user_id": 4364572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1f6ffcd1d5e5c0b2f8613afb95429f27?s=128&d=identicon&r=PG", "display_name": "utkbansal", "link": "https://stackoverflow.com/users/4364572/utkbansal"}, "edited": false, "score": 0, "creation_date": 1447759567, "post_id": 33754131, "comment_id": 55278952, "body": "sorry I forgot a line  export GOROOT=&quot;/usr/lib/go&quot; export GOPATH=&quot;/home/utkbansal/go&quot;"}], "tags": [], "owner": {"reputation": 1720, "user_id": 989659, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84d2d1476d96b093bd0f180412db2460?s=128&d=identicon&r=PG", "display_name": "Srgrn", "link": "https://stackoverflow.com/users/989659/srgrn"}, "is_accepted": false, "score": 5, "last_activity_date": 1447759534, "last_edit_date": 1495535400, "creation_date": 1447754844, "answer_id": 33754131, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages/33754131#33754131", "title": "Unable to install Go packages", "body": "<p>See @mrd0ll4r answer which is better. ( <a href=\"https://stackoverflow.com/a/33755566/989659\">https://stackoverflow.com/a/33755566/989659</a> )</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>since you used the -u flag it first tries to update the package which is already installed and have a binary at /usr/lib/go/bin/godoc</p>\n\n<p>when you ran it with sudo it doesn't have your enviroment variables so it no longer has the GOPATH variable </p>\n\n<p>you can enter root mode and run it from there</p>\n\n<pre><code>sudo su \nexport GOROOT=\"/usr/lib/go\"\nexport GOPATH=\"/home/utkbansal/go\"\ngo get -u golang.org/x/tools/cmd/...\n# other commands\nexit\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2778, "user_id": 663551, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ef4804363d22e79e8b8a15adbdb887b?s=128&d=identicon&r=PG", "display_name": "Jakob Alexander Eichler", "link": "https://stackoverflow.com/users/663551/jakob-alexander-eichler"}, "edited": false, "score": 0, "creation_date": 1535692921, "post_id": 33755566, "comment_id": 91168419, "body": "Set $GOPATH to your normal user $GOPATH (&quot;/home/utkbansal/go&quot;) This needs to be done with export GOPATH=/home/..../go"}], "tags": [], "owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "is_accepted": true, "score": 14, "last_activity_date": 1447759054, "creation_date": 1447759054, "answer_id": 33755566, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages/33755566#33755566", "title": "Unable to install Go packages", "body": "<p><code>godoc</code> seems to be an exception to the general <code>go get</code> practice, because it installs to the go installation (<code>$GOROOT/bin</code>) instead of <code>$GOPATH</code>. So, if you really need to update <code>godoc</code> (why?), what you need to do is:</p>\n\n<ol>\n<li>Log in as root (or <code>su</code>, or <code>sudo su</code>, or ...)</li>\n<li>Set <code>$GOPATH</code> to your normal user <code>$GOPATH</code> (<code>\"/home/utkbansal/go\"</code>)</li>\n<li>Update <code>godoc</code>, using <code>go get -u golang.org/x/tools/cmd/godoc</code>, or all tools</li>\n<li><em>Set the appropriate permissions on for your <code>$GOPATH</code></em>, i.e. <code>chown -R utkbansal:utkbansal $GOPATH</code> (still as root)</li>\n</ol>\n\n<p>That should work I guess. BUT: Why would you want to update <code>godoc</code>? If you just want one specific tool that is not pre-installed, you should be able to <code>go get</code> it without root privileges.</p>\n"}, {"comments": [{"owner": {"reputation": 2455, "user_id": 1566636, "user_type": "registered", "profile_image": "https://graph.facebook.com/500291539/picture?type=large", "display_name": "Donn Lee", "link": "https://stackoverflow.com/users/1566636/donn-lee"}, "edited": false, "score": 3, "creation_date": 1463505640, "post_id": 35585494, "comment_id": 62090373, "body": "I had to do: <code>sudo -E &#47;usr&#47;local&#47;go&#47;bin&#47;go  get golang.org&#47;x&#47;tools&#47;cmd&#47;godoc</code>. Else, I get <code>sudo: go: command not found</code> (even though my root shell has a path to <code>go</code>  :/"}], "tags": [], "owner": {"reputation": 728, "user_id": 1929678, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/O6LDU.jpg?s=128&g=1", "display_name": "Bart Louwers", "link": "https://stackoverflow.com/users/1929678/bart-louwers"}, "is_accepted": false, "score": 8, "last_activity_date": 1456252613, "creation_date": 1456252613, "answer_id": 35585494, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages/35585494#35585494", "title": "Unable to install Go packages", "body": "<p>mrd0ll4r has an excellent explanation of the problem, though I would like to share an easier way to install <code>godoc</code>. Assuming you set your <code>$GOPATH</code> in your <code>.bashrc</code> (or similar) try:</p>\n\n<pre><code>sudo -E go get golang.org/x/tools/cmd/godoc\n</code></pre>\n\n<p>With the <code>-E</code> flag you perserve your current environment variables (including <code>$GOPATH</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 11839, "user_id": 730346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/86187a52f1e2f64890194d0451748ce5?s=128&d=identicon&r=PG", "display_name": "Daniel YC Lin", "link": "https://stackoverflow.com/users/730346/daniel-yc-lin"}, "is_accepted": false, "score": 1, "last_activity_date": 1459121994, "creation_date": 1459121994, "answer_id": 36253960, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages/36253960#36253960", "title": "Unable to install Go packages", "body": "<p>If you haven't the root permission, we can build binary into <code>$GOPATH/bin</code>, Let me use <code>godoc</code> as example</p>\n\n<pre><code>go get -u golang.org/x/tools/cmd/godoc\ncd $GOPATH/src/golang.org/x/tools/cmd/godoc\ngo build -o $GOPATH/bin/godoc\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 1, "last_activity_date": 1465549260, "creation_date": 1465549260, "answer_id": 37744111, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages/37744111#37744111", "title": "Unable to install Go packages", "body": "<p>Same problem appear in my computer. Problem was, that I had install go, but not godoc. And the simples was install standart godoc (on my fedora dnf install)</p>\n\n<pre><code>sudo dnf install golang-godoc\n</code></pre>\n\n<p>Thank mrd0ll4r for explanation what was wrong</p>\n"}, {"tags": [], "owner": {"reputation": 6612, "user_id": 1401202, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/c6c31f018cbb2c264b877339b9568568?s=128&d=identicon&r=PG", "display_name": "kpg", "link": "https://stackoverflow.com/users/1401202/kpg"}, "is_accepted": false, "score": 0, "last_activity_date": 1510063506, "creation_date": 1510063506, "answer_id": 47159930, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages/47159930#47159930", "title": "Unable to install Go packages", "body": "<p>I tried all the answers in this thread and couldn't get godoc installed.</p>\n\n<p><code>sudo apt install golang-golang-x-tools</code> </p>\n\n<p>I believe I now have a version of godocs which is older than my Go version but I will live with that.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 7209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02ffc42f044fa1e945bd9bdab4714289?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/7209003/fred"}, "is_accepted": false, "score": 0, "last_activity_date": 1539827073, "last_edit_date": 1539827073, "creation_date": 1539768853, "answer_id": 52851640, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages/52851640#52851640", "title": "Unable to install Go packages", "body": "<p>I have the same problem when installing delve</p>\n\n<pre><code>go get github.com/derekparker/delve/cmd/dlv: open /usr/local/go/bin/dlv: permission denied\n</code></pre>\n\n<p>But I solved it by using another way different form @mrd0ll4r, you needn't change anything.</p>\n\n<pre><code>sudo env \"PATH=$PATH\" go get -u github.com/derekparker/delve/cmd/dlv\n</code></pre>\n\n<p>It works well. </p>\n\n<p>refer to <a href=\"https://superuser.com/questions/709515/command-not-found-when-using-sudo\">command not found when using sudo</a></p>\n"}], "owner": {"reputation": 2507, "user_id": 4364572, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1f6ffcd1d5e5c0b2f8613afb95429f27?s=128&d=identicon&r=PG", "display_name": "utkbansal", "link": "https://stackoverflow.com/users/4364572/utkbansal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20687, "favorite_count": 2, "accepted_answer_id": 33755566, "answer_count": 8, "score": 9, "last_activity_date": 1539827073, "creation_date": 1447748950, "question_id": 33752247, "link": "https://stackoverflow.com/questions/33752247/unable-to-install-go-packages", "title": "Unable to install Go packages", "body": "<p>When I run <code>go get</code>, I get a permission Denied error and when I try <code>sudo go get</code> I get a GOPATH not set error.</p>\n\n<pre><code>utkbansal@Dell:~$ go  get -u golang.org/x/tools/cmd/...\ngo install golang.org/x/tools/cmd/godoc: open /usr/lib/go/bin/godoc: permission denied\n\nutkbansal@Dell:~$ sudo go  get -u golang.org/x/tools/cmd/...\npackage golang.org/x/tools/cmd/...: cannot download, $GOPATH not set. For more details see: go help gopath\n</code></pre>\n\n<p>Here are the result of my $PATH, go env and which go commands.</p>\n\n<pre><code>utkbansal@Dell:~$ which go\n/usr/lib/go/bin/go\n\nutkbansal@Dell:~$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/utkbansal/go\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go\"\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n\n\nutkbansal@Dell:~$ $PATH\nbash: /usr/lib/go/bin:/home/utkbansal/miniconda/bin:/usr/local/heroku/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/local/go/bin: No such file or directory\n</code></pre>\n\n<p>How do I fix this?</p>\n\n<p>I am using go1.5 from this PPA <a href=\"https://launchpad.net/~ubuntu-lxc/+archive/ubuntu/lxd-stable\" rel=\"noreferrer\">https://launchpad.net/~ubuntu-lxc/+archive/ubuntu/lxd-stable</a> (ppa:ubuntu-lxc/lxd-stable)</p>\n"}, {"tags": ["mongodb", "go", "bson", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3188248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9945e77266a8df3f460e8ae9ab2fed34?s=128&d=identicon&r=PG&f=1", "display_name": "Aramys", "link": "https://stackoverflow.com/users/3188248/aramys"}, "edited": false, "score": 1, "creation_date": 1447833464, "post_id": 33755152, "comment_id": 55315692, "body": "Thank you it looks like I tried everything except for the $elemMatch selector inside of Query.Select."}], "tags": [], "owner": {"reputation": 87200, "user_id": 122005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MX2CF.jpg?s=128&g=1", "display_name": "chridam", "link": "https://stackoverflow.com/users/122005/chridam"}, "is_accepted": true, "score": 9, "last_activity_date": 1479806808, "last_edit_date": 1479806808, "creation_date": 1447757760, "answer_id": 33755152, "question_id": 33751451, "link": "https://stackoverflow.com/questions/33751451/how-can-i-use-mongodb-projections-with-go-and-mgo/33755152#33755152", "title": "How can I use mongodb projections with Go and mgo?", "body": "<p>Would go with the <strong><a href=\"https://godoc.org/labix.org/v2/mgo#Query.Select\" rel=\"noreferrer\"><code>Select</code></a></strong> method as the doc states that this enables selecting which fields should be retrieved for the results found, thus the projection using <strong><a href=\"https://docs.mongodb.org/v3.0/reference/operator/projection/elemMatch/\" rel=\"noreferrer\"><code>$elemMatch</code></a></strong> operator can be applied here in conjuction with <strong><a href=\"https://godoc.org/labix.org/v2/mgo#Query.Select\" rel=\"noreferrer\"><code>Select</code></a></strong>, with your final query looking something like: </p>\n\n<pre><code>c.Find(bson.M{\n    \"_id\": bson.ObjectIdHex(p.ByName(\"id\"))\n}).Select(bson.M{\n    \"races\": bson.M{\n        \"$elemMatch\": bson.M{\n            \"_id\": bson.ObjectIdHex(p.ByName(\"raceId\"))\n        }\n    }\n}).One(&amp;result)\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 3188248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9945e77266a8df3f460e8ae9ab2fed34?s=128&d=identicon&r=PG&f=1", "display_name": "Aramys", "link": "https://stackoverflow.com/users/3188248/aramys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4001, "favorite_count": 0, "accepted_answer_id": 33755152, "answer_count": 1, "score": 4, "last_activity_date": 1479806808, "creation_date": 1447745764, "question_id": 33751451, "link": "https://stackoverflow.com/questions/33751451/how-can-i-use-mongodb-projections-with-go-and-mgo", "title": "How can I use mongodb projections with Go and mgo?", "body": "<p>I am currently trying to extract a single object within a document array inside of mongodb. \nThis is a sample dataset:</p>\n\n<pre><code>\"_id\" : ObjectId(\"564aae61e0c4e5dddb07343b\"),\n\"name\" : \"The Races\",\n\"description\" : \"Horse races\",\n\"capacity\" : 0,\n\"open\" : true,\n\"type\" : 0,\n\"races\" : [\n    {\n        \"_id\" : ObjectId(\"564ab9097628ba2c6ec54423\"),\n        \"race\" : {\n            \"distance\" : 3000,\n            \"user\" : {\n                \"_id\" : ObjectId(\"5648bdbe7628ba189e011b18\"),\n                \"status\" : 1,\n                \"lastName\" : \"Miranda\",\n                \"firstName\" : \"Aramys\"\n            }\n        }\n    },\n    {\n        \"_id\" : ObjectId(\"564ab9847628ba2c81f2f34a\"),\n        \"bet\" : {\n            \"distance\" : 3000,\n            \"user\" : {\n                \"_id\" : ObjectId(\"5648bdbe7628ba189e011b18\"),\n                \"status\" : 1,\n                \"lastName\" : \"Miranda\",\n                \"firstName\" : \"Aramys\"\n            }\n        }\n    },{...}\n]\n</code></pre>\n\n<p>I can successfully query using the following in mongo:</p>\n\n<pre><code>db.tracks.find({\"_id\": ObjectId(\"564aae61e0c4e5dddb07343b\")}, {\"races\": { $elemMatch: {\"_id\": ObjectId(\"564ab9847628ba2c81f2f34a\")}}}).pretty()\n</code></pre>\n\n<p>I am unable to do the same using mgo and have tried the following:</p>\n\n<p>Using nesting (Throws: missing type in composite literal, missing key in map literal)</p>\n\n<pre><code>// Using nesting (Throws: missing type in composite literal, missing key in map literal)\nc.Find(bson.M{{\"_id\": bson.ObjectIdHex(p.ByName(\"id\"))}, bson.M{\"races\": bson.M{\"$elemMatch\": bson.M{\"_id\": bson.ObjectIdHex(p.ByName(\"raceId\"))}}}}).One(&amp;result)\n\n// Using select (Returns empty)\nc.Find(bson.M{\"_id\": bson.ObjectIdHex(p.ByName(\"id\"))}).Select(bson.M{\"races._id\": bson.ObjectIdHex(p.ByName(\"raceId\"))}).One(&amp;result)\n\n//As an array (Returns empty)\nc.Find([]bson.M{{\"_id\": bson.ObjectIdHex(p.ByName(\"id\"))}, bson.M{\"races\": bson.M{\"$elemMatch\": bson.M{\"_id\": bson.ObjectIdHex(p.ByName(\"raceId\"))}}}}).One(&amp;result)\n</code></pre>\n\n<p>I am using httprouter and p.ByName(\"...\") invocations are parameters passed to the handler.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1447745764, "post_id": 33751165, "comment_id": 55270548, "body": "The id field in your db is called <code>&quot;idtemperatures&quot;</code> and you used <code>&quot;id&quot;</code> in your SQL statement."}, {"owner": {"reputation": 107, "user_id": 567035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109bac00f78b786ade90b801befcc205?s=128&d=identicon&r=PG&f=1", "display_name": "Donald J", "link": "https://stackoverflow.com/users/567035/donald-j"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1447746688, "post_id": 33751165, "comment_id": 55270972, "body": "Ah! Sorry, it is late. But why is there no error message? I&#39;m still learning Go and this has been the most frustrating part so far."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1447750791, "post_id": 33751165, "comment_id": 55273095, "body": "The lack of error is because you used <code>DB.Query()</code> but you really should&#39;ve used <code>DB.Exec()</code>. See my edited answer for details on this."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 567035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109bac00f78b786ade90b801befcc205?s=128&d=identicon&r=PG&f=1", "display_name": "Donald J", "link": "https://stackoverflow.com/users/567035/donald-j"}, "edited": false, "score": 0, "creation_date": 1447767964, "post_id": 33751807, "comment_id": 55284498, "body": "Unfortunately this is not working. I still get absolutely no output until the timeout occurs. I forgot to mention I am trying to run this on a raspberry pi with armv7l architecture. Not sure if that matters?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 107, "user_id": 567035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109bac00f78b786ade90b801befcc205?s=128&d=identicon&r=PG&f=1", "display_name": "Donald J", "link": "https://stackoverflow.com/users/567035/donald-j"}, "edited": false, "score": 0, "creation_date": 1447769576, "post_id": 33751807, "comment_id": 55285634, "body": "@DonaldJ It looks you can&#39;t connect to the db. Are you sure it uses default protocol (TCP) and host (localhost:3306)?"}, {"owner": {"reputation": 107, "user_id": 567035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109bac00f78b786ade90b801befcc205?s=128&d=identicon&r=PG&f=1", "display_name": "Donald J", "link": "https://stackoverflow.com/users/567035/donald-j"}, "edited": false, "score": 0, "creation_date": 1447769995, "post_id": 33751807, "comment_id": 55285908, "body": "Well, I&#39;m not sure what is going on to be honest. I just compiled on a separate machine (x86_64) and pointed it at the LAN address of the mysql instance and it worked. I am marking your answer as correct and I will try to figure out what is wrong with the mysql instance config locally. Thanks!"}, {"owner": {"reputation": 107, "user_id": 567035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109bac00f78b786ade90b801befcc205?s=128&d=identicon&r=PG&f=1", "display_name": "Donald J", "link": "https://stackoverflow.com/users/567035/donald-j"}, "edited": false, "score": 0, "creation_date": 1447863102, "post_id": 33751807, "comment_id": 55336732, "body": "For posterity I will add what I needed to finally fix the issue: <code>db, err := sql.Open(&quot;mysql&quot;, &quot;user:pass@unix(&#47;var&#47;run&#47;mysqld&#47;mysqld.sock)&#47;sysStats?loc=Lo&zwnj;&#8203;cal&quot;)</code>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1447770475, "last_edit_date": 1447770475, "creation_date": 1447747178, "answer_id": 33751807, "question_id": 33751165, "link": "https://stackoverflow.com/questions/33751165/mysql-insert-float32-and-float64-go/33751807#33751807", "title": "MySQL Insert Float32 and Float64 Go", "body": "<p>The id / primary key field in your db is called <code>\"idtemperatures\"</code> and you used <code>\"id\"</code> in your SQL statement.</p>\n\n<p>Also since you're not executing a query (but an <code>INSERT</code>), you should use the <a href=\"https://golang.org/pkg/database/sql/#DB.Exec\" rel=\"nofollow\"><code>DB.Exec()</code></a> method to execute it. You should never use <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow\"><code>DB.Query()</code></a>  to execute DML (Data Manipulation Language) statements.</p>\n\n<p>You may get a timeout error if you can't connect to your database. Make sure it uses default protocol (TCP) and host (localhost:3306). Another reason may be because you used <code>DB.Query()</code> to execute your SQL <code>INSERT</code> statement, and <code>DB.Query()</code> returns an <a href=\"https://golang.org/pkg/database/sql/#Rows\" rel=\"nofollow\"><code>*sql.Rows</code></a> value which holds a database connection until you close it with the <a href=\"https://golang.org/pkg/database/sql/#Rows.Close\" rel=\"nofollow\"><code>Rows.Close()</code></a> method - which you never do; you didn't even store the returned <code>db.Rows</code> value.</p>\n\n<p>Also you should call <code>db.Close()</code> as a deferred statement, right after the error check after opening it.</p>\n\n<p>Corrected example:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"user:pass@/sysStats\")\nif err != nil {\n    fmt.Println(\"Failed to open DB:\", err)\n    return\n}\ndefer db.Close()\n\ns := \"INSERT INTO temperatures (idtemperatures, cpu, gpu, timestamp) VALUES (?, ?, ?, ?)\"\nres, err = db.Exec(s, 1, temp_gpu, temp_cpu, time.Now())\n\nif err != nil {\n    fmt.Println(\"Failed to execute INSERT:\", err)\n} else {\n    n, err := res.RowsAffected()\n    fmt.Println(\"INSERT executed, rows affected: \", n, err)\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 567035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109bac00f78b786ade90b801befcc205?s=128&d=identicon&r=PG&f=1", "display_name": "Donald J", "link": "https://stackoverflow.com/users/567035/donald-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1861, "favorite_count": 0, "accepted_answer_id": 33751807, "answer_count": 1, "score": 2, "last_activity_date": 1447770475, "creation_date": 1447744531, "question_id": 33751165, "link": "https://stackoverflow.com/questions/33751165/mysql-insert-float32-and-float64-go", "title": "MySQL Insert Float32 and Float64 Go", "body": "<p>I'm trying to insert a row into a MySQL table:</p>\n\n<pre><code>package main\n\nimport (\n    \"strconv\"\n    \"io/ioutil\"\n    \"strings\"\n    \"os/exec\"\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\n    temp_cpu := getCPUTemp() // returns float32\n    temp_gpu := getGPUTemp() // returns float64\n\n    db, err := sql.Open(\"mysql\", \"user:pass@/sysStats\")\n    handleError(err)\n\n    _, err = db.Query(\"INSERT INTO temperatures (id, cpu, gpu, timestamp) VALUES (?, ?, ?, ?)\", 1, temp_gpu, temp_cpu, time.Now())\n    handleError(err)\n\n    db.Close()\n    return\n}\n</code></pre>\n\n<p>It builds successfully but when I run the resulting binary it just times out after a long time with a generic timeout error.</p>\n\n<p>The table has the following schema:</p>\n\n<pre><code>+----------------+-----------+------+-----+---------+-------+\n| Field          | Type      | Null | Key | Default | Extra |\n+----------------+-----------+------+-----+---------+-------+\n| idtemperatures | int(11)   | NO   | PRI | NULL    |       |\n| cpu            | float     | YES  |     | NULL    |       |\n| gpu            | float     | YES  |     | NULL    |       |\n| timestamp      | timestamp | YES  |     | NULL    |       |\n+----------------+-----------+------+-----+---------+-------+\n</code></pre>\n\n<p>I am running this on the same server the MySQL instance is hosted and I can access the database with the user/password from the terminal.</p>\n\n<p>Any help?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["struct", "go", "types", "arguments", "slice"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447742730, "post_id": 33750179, "comment_id": 55269173, "body": "What about using <code>json.RawMessage</code> as the type for each result, since you don&#39;t seem to know the JSON structure of the results up front. E.g. <a href=\"http://play.golang.org/p/jEx4UgBnLP\" rel=\"nofollow noreferrer\">play.golang.org/p/jEx4UgBnLP</a>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1447747804, "post_id": 33750179, "comment_id": 55271481, "body": "Package go/types cannot be used for stuff like this. Redesign your solution: All these ideas of &quot;any type&quot; do not work very well in Go. Redesign. That works."}], "answers": [{"comments": [{"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "edited": false, "score": 0, "creation_date": 1447793802, "post_id": 33754475, "comment_id": 55301384, "body": "Cannot seem to call <code>len(results)</code> if it is an interface."}, {"owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "reply_to_user": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "edited": false, "score": 0, "creation_date": 1447795872, "post_id": 33754475, "comment_id": 55302520, "body": "@electrometro: You can use reflection to get the length."}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": true, "score": 1, "last_activity_date": 1447818340, "last_edit_date": 1447818340, "creation_date": 1447755749, "answer_id": 33754475, "question_id": 33750179, "link": "https://stackoverflow.com/questions/33750179/allow-a-slice-of-any-type-into-as-argument/33754475#33754475", "title": "Allow a slice of any type into as argument", "body": "<p>you can use <code>interface{}</code> as any type.</p>\n\n<pre><code>type Response struct {\n  Count int `json:\"count\"`\n  Results []interface{} `json:\"results`\n}\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p><code>len(rsp.results)</code> should work.\n<a href=\"http://play.golang.org/p/RA2zVzWl2q\" rel=\"nofollow\">http://play.golang.org/p/RA2zVzWl2q</a></p>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 0, "last_activity_date": 1447859178, "creation_date": 1447859178, "answer_id": 33783518, "question_id": 33750179, "link": "https://stackoverflow.com/questions/33750179/allow-a-slice-of-any-type-into-as-argument/33783518#33783518", "title": "Allow a slice of any type into as argument", "body": "<p>Arbitrary types are totally legit in Go. In your case, it might be appropriate to use <code>[]interface{}</code> as the type of <code>Results</code>. When ever the types need to be known, use <strong>type switch</strong>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Response struct {\n    Count   int           `json:\"count\"`\n    Results []interface{} `json:\"results`\n}\n\nfunc NewResponse(results []interface{}) (r *Response) {\n    r.Count = len(results)\n    r.Results = results\n    return\n}\n\nfunc AssertResultType(results []interface{}) {\n\n    for _, v := range results {\n        switch v := v.(type) {\n        default:\n            fmt.Printf(\"unexpected type %T\\n\", v) //t has unexpected type\n        case bool:\n            fmt.Printf(\"boolean %t\\n\", v) // t has type bool\n        case int:\n            fmt.Printf(\"integer %d\\n\", v) // t has type int\n        case string:\n            fmt.Printf(\"string %q\\n\", v) // t has type string\n        }\n    }\n\n}\n\nfunc main() {\n\n    args := []interface{}{1, \"hello\", true, \"foo\", 21}    \n\n    r := NewResponse(args)\n\n    AssertResultType(r.Results)\n}\n</code></pre>\n\n<p>In case of JSON, <code>*json.RawMessage</code> can be marshaled to type <code>[]byte</code></p>\n\n<pre><code>type Response struct {\n    Count   int              `json:\"count\"`\n    Results *json.RawMessage `json:\"results`\n}\n</code></pre>\n"}], "owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 33754475, "answer_count": 2, "score": 0, "last_activity_date": 1447859178, "creation_date": 1447740207, "last_edit_date": 1447741588, "question_id": 33750179, "link": "https://stackoverflow.com/questions/33750179/allow-a-slice-of-any-type-into-as-argument", "title": "Allow a slice of any type into as argument", "body": "<p>I am new to Go (coming from python) and I am having a bit of a hard time here. I am trying to allow any type of slice into my struct/func and it just contains a count of the length of that slice.</p>\n\n<pre><code>import \"go/types\"\n\ntype Response struct {\n    Count int `json:\"count\"`\n    Results []types.Struct `json:\"results`\n}\n\nfunc NewResponse(results []types.Struct) (r *Response) {\n    r.Count = len(results)\n    r.Results = results\n    return\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "edited": false, "score": 1, "creation_date": 1447741086, "post_id": 33750021, "comment_id": 55268569, "body": "I think you&#39;ve nailed it -- Go and the appropriate way to use it (on any given environment, such as, App Engine) are changing fast, so code untouched and un-examined for a year bit-rotting... is far from surprising!"}, {"owner": {"reputation": 12074, "user_id": 143969, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e24a2c9715036c1c664bfc8a6c870911?s=128&d=identicon&r=PG", "display_name": "aperkins", "link": "https://stackoverflow.com/users/143969/aperkins"}, "edited": false, "score": 0, "creation_date": 1447773732, "post_id": 33750021, "comment_id": 55288635, "body": "Ahh, OK - I will try that today.  Thanks!  There isn&#39;t a ton of code, but there is enough that I wasn&#39;t even sure where to start."}, {"owner": {"reputation": 12074, "user_id": 143969, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e24a2c9715036c1c664bfc8a6c870911?s=128&d=identicon&r=PG", "display_name": "aperkins", "link": "https://stackoverflow.com/users/143969/aperkins"}, "edited": false, "score": 0, "creation_date": 1447775598, "post_id": 33750021, "comment_id": 55290119, "body": "Hmm, I just checked the code, and I am not importing syscall anywhere.  The project is here: <a href=\"https://github.com/redmanatee/bodger-bowl/tree/master/src\" rel=\"nofollow noreferrer\">github.com/redmanatee/bodger-bowl/tree/master/src</a> but I don&#39;t even know where to start.  I don&#39;t do a lot of go programming in my day to day, so I am struggling a bit here."}, {"owner": {"reputation": 12074, "user_id": 143969, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e24a2c9715036c1c664bfc8a6c870911?s=128&d=identicon&r=PG", "display_name": "aperkins", "link": "https://stackoverflow.com/users/143969/aperkins"}, "edited": false, "score": 0, "creation_date": 1447776123, "post_id": 33750021, "comment_id": 55290540, "body": "hmm, looks like it might be net/internal or something similar, based on some conversations with some other people.  I will look at that this evening."}, {"owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "edited": false, "score": 0, "creation_date": 1447779717, "post_id": 33750021, "comment_id": 55293147, "body": "Yep, like this guy: <a href=\"https://github.com/golang/go/blob/master/src/net/internal/socktest/sys_unix.go\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/net/internal/socktest/&hellip;</a>"}, {"owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "edited": false, "score": 0, "creation_date": 1447780144, "post_id": 33750021, "comment_id": 55293428, "body": "I would also make sure that you have the latest app engine go sdk <a href=\"https://code.google.com/p/appengine-go/\" rel=\"nofollow noreferrer\">code.google.com/p/appengine-go</a>"}, {"owner": {"reputation": 12074, "user_id": 143969, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e24a2c9715036c1c664bfc8a6c870911?s=128&d=identicon&r=PG", "display_name": "aperkins", "link": "https://stackoverflow.com/users/143969/aperkins"}, "edited": false, "score": 0, "creation_date": 1447862571, "post_id": 33750021, "comment_id": 55336311, "body": "Heh - first thing I did was update my appengine SDK, because of how long it had been.  I may end up rewriting the whole thing in Python, because that might be faster at this stage."}, {"owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "reply_to_user": {"reputation": 12074, "user_id": 143969, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e24a2c9715036c1c664bfc8a6c870911?s=128&d=identicon&r=PG", "display_name": "aperkins", "link": "https://stackoverflow.com/users/143969/aperkins"}, "edited": false, "score": 0, "creation_date": 1447862662, "post_id": 33750021, "comment_id": 55336382, "body": "@aperkins noooooo :-)"}], "tags": [], "owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "is_accepted": false, "score": 0, "last_activity_date": 1447739386, "creation_date": 1447739386, "answer_id": 33750021, "question_id": 33749342, "link": "https://stackoverflow.com/questions/33749342/golang-appengine-project-wont-build/33750021#33750021", "title": "Golang Appengine Project won&#39;t build", "body": "<p>I think the problem is this:</p>\n\n<blockquote>\n  <p>You are not permitted to import the syscall package in a Go App Engine\n  app for security reasons. Whatever file is importing it needs to be\n  changed to not do that, or be excluded from the build.</p>\n</blockquote>\n\n<p>as per <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/k2U66zaKHjU\" rel=\"nofollow\">this</a></p>\n\n<p>So you might want to try <a href=\"https://github.com/oschwald/maxminddb-golang/commit/3d1a0574c315c71f3d8131ca13e4b4256061be09\" rel=\"nofollow\">this workaround</a>. If you are importing the 'os' module. It fixes <a href=\"https://github.com/oschwald/maxminddb-golang/issues/11\" rel=\"nofollow\">this</a></p>\n\n<p>It would be helpful if you can post your code too.</p>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 1073990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e49afba91f5e9563f2a8efe54600a8b8?s=128&d=identicon&r=PG", "display_name": "Colby", "link": "https://stackoverflow.com/users/1073990/colby"}, "is_accepted": false, "score": 1, "last_activity_date": 1447776451, "creation_date": 1447776451, "answer_id": 33761650, "question_id": 33749342, "link": "https://stackoverflow.com/questions/33749342/golang-appengine-project-wont-build/33761650#33761650", "title": "Golang Appengine Project won&#39;t build", "body": "<p>That usage is in net/internal.  You are probably importing net in your app engine project someplace, and thus doing the illegal import.</p>\n\n<p>If you constrain your usage to net/http on an app engine project, you should be just fine.</p>\n"}], "owner": {"reputation": 12074, "user_id": 143969, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e24a2c9715036c1c664bfc8a6c870911?s=128&d=identicon&r=PG", "display_name": "aperkins", "link": "https://stackoverflow.com/users/143969/aperkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1447776451, "creation_date": 1447735461, "question_id": 33749342, "link": "https://stackoverflow.com/questions/33749342/golang-appengine-project-wont-build", "title": "Golang Appengine Project won&#39;t build", "body": "<p>I have an appengine project using golang that I haven't touched in about a year.  I cannot get it to build now on the machine where it was building before.  I get the following error</p>\n\n<blockquote>\n  <p>go-app-builder: Failed parsing input: parser: bad import \"syscall\" in src/golang.org/x/net/internal/nettest/rlimit_unix.go</p>\n</blockquote>\n\n<p>I am running on OS X if that helps at all.  I am not a Golang expert, by any stretch, and my attempts to find anything even related to this have all turned up nothing.  Any thoughts?</p>\n"}, {"tags": ["go", "martini", "go-html-template"], "comments": [{"owner": {"reputation": 7796, "user_id": 2334254, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-6e2XuTZAjgM/AAAAAAAAAAI/AAAAAAAAABU/JpF2-AkHsH4/photo.jpg?sz=128", "display_name": "kpie", "link": "https://stackoverflow.com/users/2334254/kpie"}, "edited": false, "score": 1, "creation_date": 1447722716, "post_id": 33747409, "comment_id": 55263253, "body": "Is it the capital t in Tmpl?"}, {"owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "edited": false, "score": 0, "creation_date": 1447740356, "post_id": 33747409, "comment_id": 55268281, "body": "You use sourcePage for r.HTML but variables are in indexPage. Should be r.HTML(http.StatusOK, &quot;index&quot;, indexPage)"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447743300, "post_id": 33747409, "comment_id": 55269399, "body": "It would be much easier to help if you had a full copy of the working code. I have to figure out what you&#39;re importing."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1447743383, "post_id": 33747409, "comment_id": 55269439, "body": "Also, you haven&#39;t said what command you ran and where you saw the error, just that there&#39;s an error somewhere when you do something."}, {"owner": {"reputation": 47, "user_id": 4356869, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-7hAGznMWdNc/AAAAAAAAAAI/AAAAAAAABts/0efjqMk-YIs/photo.jpg?sz=128", "display_name": "insomniac669", "link": "https://stackoverflow.com/users/4356869/insomniac669"}, "edited": false, "score": 0, "creation_date": 1447743469, "post_id": 33747409, "comment_id": 55269475, "body": "In struct Page Tmpl is capital, in filename it&#39;s not. I have tried just to print tmpl with {{ .Templ }} in index.tmpl and that is working, but when i want to passit like name of template it not..."}, {"owner": {"reputation": 47, "user_id": 4356869, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-7hAGznMWdNc/AAAAAAAAAAI/AAAAAAAABts/0efjqMk-YIs/photo.jpg?sz=128", "display_name": "insomniac669", "link": "https://stackoverflow.com/users/4356869/insomniac669"}, "edited": false, "score": 0, "creation_date": 1447749708, "post_id": 33747409, "comment_id": 55272444, "body": "I have updated my original post. :)"}, {"owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "edited": false, "score": 0, "creation_date": 1447835553, "post_id": 33747409, "comment_id": 55316762, "body": "From <a href=\"https://github.com/go-martini/martini\" rel=\"nofollow noreferrer\">github.com/go-martini/martini</a> NOTE: The martini framework is no longer maintained."}], "owner": {"reputation": 47, "user_id": 4356869, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-7hAGznMWdNc/AAAAAAAAAAI/AAAAAAAABts/0efjqMk-YIs/photo.jpg?sz=128", "display_name": "insomniac669", "link": "https://stackoverflow.com/users/4356869/insomniac669"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 713, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447749669, "creation_date": 1447721884, "last_edit_date": 1447749669, "question_id": 33747409, "link": "https://stackoverflow.com/questions/33747409/html-template-with-martini-in-golang", "title": "html template with martini in golang", "body": "<p>I have problem with go, martini and how martini works with templates.</p>\n\n<pre><code>package main\n\nimport (\n   \"github.com/go-martini/martini\"\n   \"github.com/martini-contrib/render\"\n)\ntype Page struct {\n    Caption string\n    Body    string\n    Tmpl    string\n}\nfunc main() {\n    webApp = martini.Classic()\n    webApp.Get(\"/\", indexHandler)\n    webApp.Use(render.Renderer(render.Options{\n      Directory:  \"templates\",\n      Layout:     \"layout\",\n      Extensions: []string{\".tmpl\", \".html\"},\n      Delims:     render.Delims{\"{{\", \"}}\"},\n      Charset:    \"UTF-8\",\n      IndentJSON: true}))\n    webApp.Run()\n\n}\nfunc indexHandler(r render.Render) {\n    var indexPage Page\n    indexPage.Caption = \"index\"\n    indexPage.Tmpl = \"subIndex\"\n    r.HTML(http.StatusOK, \"index\", indexPage)\n}\n</code></pre>\n\n<p>If I use in index.tmpl with fallowing code:</p>\n\n<pre><code> &lt;h2&gt;Caption{{.Caption}}&lt;/h2&gt;\n{{ .Tmpl }}\n</code></pre>\n\n<p>// caption works, .Tmpl works and see subIndex as string )</p>\n\n<p>If I use in index.tmpl with fallowing code:</p>\n\n<pre><code>&lt;h2&gt;Caption{{.Caption}}&lt;/h2&gt;\n{{ template .Tmpl }}\n</code></pre>\n\n<p>I get error unexpected \"Tmpl\" in template invocation\nSame error message</p>\n\n<pre><code> &lt;h2&gt;Caption{{.Caption}}&lt;/h2&gt;\n{{ $templateName := .Tmpl }}\n{{ $templateName }}\n\n{{ template $templateName }}\n</code></pre>\n\n<p>subIndex.tmpl is simple</p>\n\n<pre><code> &lt;h3&gt;subindex&lt;/h3&gt;\n</code></pre>\n\n<p>I have built program with go build, and stared it, when I open browsers with localhost:3000, i got errors which I have mentioned.</p>\n\n<p>What am I missing? </p>\n"}, {"tags": ["arrays", "struct", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 3, "creation_date": 1447716646, "post_id": 33746556, "comment_id": 55261492, "body": "I personally think it&#39;s a lot more clear if you don&#39;t define nested types in line. IE you would define an <code>Arg</code> type and a <code>Params</code> type then inside here it would have <code>Args []Arg</code>, but that&#39;s just me."}, {"owner": {"reputation": 95, "user_id": 3398940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/16406ac47da87674b5ce8f203de8b5ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3398940", "link": "https://stackoverflow.com/users/3398940/user3398940"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447718494, "post_id": 33746556, "comment_id": 55262042, "body": "How can I do it exactly, sorry I am really newbie :&lt;"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447720908, "post_id": 33746556, "comment_id": 55262782, "body": "not a problem, I just posted the expanded type declarations as an answer."}, {"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "edited": false, "score": 0, "creation_date": 1447739932, "post_id": 33746556, "comment_id": 55268142, "body": "I liked the OP&#39;s original attempt best. Admittedly I&#39;m thinking of aws in xml type responses, where you always throw away the first two levels of the response."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 3398940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/16406ac47da87674b5ce8f203de8b5ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3398940", "link": "https://stackoverflow.com/users/3398940/user3398940"}, "edited": false, "score": 0, "creation_date": 1447721351, "post_id": 33747252, "comment_id": 55262896, "body": "Thank you very much if this it not a lot I have one more question how can I initializ this structure ?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 95, "user_id": 3398940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/16406ac47da87674b5ce8f203de8b5ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3398940", "link": "https://stackoverflow.com/users/3398940/user3398940"}, "edited": false, "score": 0, "creation_date": 1447780481, "post_id": 33747252, "comment_id": 55293674, "body": "@user3398940 sure. Not a very readable example, but enough to give you the basic idea. You could also initialize items separate from one another and then assign a <code>[]Arg</code> to <code>Args</code> when you initialize an instance of <code>Channel</code> just as an example."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1447780387, "last_edit_date": 1447780387, "creation_date": 1447720868, "answer_id": 33747252, "question_id": 33746556, "link": "https://stackoverflow.com/questions/33746556/creating-advanced-structure-with-neast-and-arrays-in-golang/33747252#33747252", "title": "Creating advanced structure with neast and arrays in golang", "body": "<p>If you wanted to break the types out rather than having those anonymous declarations inline it would look like this;</p>\n\n<pre><code>type Channel struct {\n    Name string `json:\"name\"`\n    Args []Arg `json:\"args\"`\n}\n\ntype Arg struct {\n    Method string `json:\"method\"`\n    Params Params `json:\"params\"`\n}\n\ntype Params struct {\n      Channel string `json:\"channel\"`\n      Name string `json:\"name\"`\n      Token string `json:\"token\"`\n      Isadmin bool `json:\"isAdmin\"`\n}\n\n\nmyChan := Channel{\"Name\", []Arg{ Arg{\"Method\", Params{ \"Channel\", \"Name\", \"Token\", true } } } }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 5416282, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003104631153/picture?type=large", "display_name": "Yusuke  Hatanaka", "link": "https://stackoverflow.com/users/5416282/yusuke-hatanaka"}, "is_accepted": false, "score": 0, "last_activity_date": 1447721573, "creation_date": 1447721573, "answer_id": 33747362, "question_id": 33746556, "link": "https://stackoverflow.com/questions/33746556/creating-advanced-structure-with-neast-and-arrays-in-golang/33747362#33747362", "title": "Creating advanced structure with neast and arrays in golang", "body": "<p>You can separate nested struct like this.</p>\n\n<p><a href=\"http://play.golang.org/p/ghcMuFOdQC\" rel=\"nofollow\">http://play.golang.org/p/ghcMuFOdQC</a></p>\n"}], "owner": {"reputation": 95, "user_id": 3398940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/16406ac47da87674b5ce8f203de8b5ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3398940", "link": "https://stackoverflow.com/users/3398940/user3398940"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 33747252, "answer_count": 2, "score": 1, "last_activity_date": 1447780387, "creation_date": 1447716518, "question_id": 33746556, "link": "https://stackoverflow.com/questions/33746556/creating-advanced-structure-with-neast-and-arrays-in-golang", "title": "Creating advanced structure with neast and arrays in golang", "body": "<p>Hi guys I am trying to learn golang I am creating my own project which requires to create structure that I have hard times to write and initalized. I would be greatful if anyone can help me out with it.</p>\n\n<pre><code> {\n    \"name\":\"message\",\n    \"args\":[\n        {\n            \"method\":\"joinChannel\",\n            \"params\":{\n                \"channel\":\"CHANNEL\",\n                \"name\":\"USERNAME\",\n                \"token\":\"XXXX\",\n                \"isAdmin\":false\n            }\n        }\n    ]\n}\n</code></pre>\n\n<p>I was looking for some examples on google but only thing I could find was easie ones. This is what I came up </p>\n\n<pre><code>type Channel struct {\n    Name string `json:\"name\"`\n    Args []struct {\n        Method string `json:\"method\"`\n        Params struct {\n            Channel string `json:\"channel\"`\n            Name string `json:\"name\"`\n            Token string `json:\"token\"`\n            Isadmin bool `json:\"isAdmin\"`\n        } `json:\"params\"`\n    } `json:\"args\"`\n}\n</code></pre>\n\n<p>Is there more transparent way to do it?</p>\n"}, {"tags": ["macos", "go", "serial-port"], "comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 1, "creation_date": 1447711953, "post_id": 33744279, "comment_id": 55259656, "body": "What about <a href=\"http://stackoverflow.com/a/32468703/1643939\">USB tracer</a>?"}, {"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "reply_to_user": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1447802842, "post_id": 33744279, "comment_id": 55305790, "body": "@gbulmer It&#39;s a go executable.  and using a golang serial library.  But your right, it&#39;s definitly not obvious, I edited to show the serial library I&#39;m using."}, {"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "reply_to_user": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1447802899, "post_id": 33744279, "comment_id": 55305807, "body": "@nemo I already tried that, I didn&#39;t see anything from that tool.   I&#39;ll try again, could be me misusing it."}], "answers": [{"comments": [{"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1447947204, "post_id": 33779137, "comment_id": 55381439, "body": "Thanks for the info, I&#39;ll check into this.  I mentioned the hardware tracer to my boss, who to my great surprise... Has one at home for personal projects...  So I&#39;ll probably end up going that route."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "reply_to_user": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1448026216, "post_id": 33779137, "comment_id": 55420726, "body": "@Gary - if you can combine a USB sniffer with DTrace you may be able to see &#39;everything&#39;. Best of luck."}, {"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1448336944, "post_id": 33779137, "comment_id": 55534342, "body": "So update:  I used a hardware tracing module...  However the nature of the tracing meant using a USB -&gt; Serial adapter  To the sniffer then rs-232 -&gt; rs-232 to the hardware device.    This in effect meant I was using a different USB -&gt; serial device and the problem went away.  So we&#39;ve pretty conclusively proven it&#39;s a problem at the driver level or below."}], "tags": [], "owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "is_accepted": true, "score": 5, "last_activity_date": 1447846907, "creation_date": 1447846907, "answer_id": 33779137, "question_id": 33744279, "link": "https://stackoverflow.com/questions/33744279/method-to-sniff-usb-serial-communication-on-osx/33779137#33779137", "title": "method to sniff usb-serial communication on osx", "body": "<p>Have you used DTrace? </p>\n\n<p>I have used it to monitor USB comms between an FTDI USB/serial converter and a 3rd party 'Black Box' application. So I could get at <em>everything</em> that the application sent to the USB serial port.</p>\n\n<p>That was pretty straightforward because I knew the name of the application, so DTrace could observe that. I wrote DTrace script to observe the file descriptors the application opened, (looking for the '/dev/tty.usbmodem...') then observed interactions with that file descriptor.</p>\n\n<p>I have not observed a device driver. In principle DTrace can do that if the kernel or device driver is compiled to work with DTrace, though there is no certainty that it is. Apple can also build code which is 'invisible' to DTrace (for example I believe iTunes was made opaque to DTrace to protect its DRM mechanisms.)</p>\n\n<p>So one possible starting point is to observe all OS open/creat calls, looking for /dev/tty.usbmodemXXX, and try to identify the subsystem and observe that. You may find that the subsytem can be observed, and that should help see what the OS+device driver is doing.</p>\n\n<p>This isn't trivial. If your time has any value, it may be cheaper and more reliable to get a hardware USB sniffer and put it into the cable, especially if its only 1.2Mbits or 12MBits USB (sniffers are much more expensive for higher data rates).</p>\n\n<p>These links may help:<br>\n<a href=\"http://dtrace.org/blogs/about/\" rel=\"noreferrer\">About DTrace</a><br>\n<a href=\"http://www.dtracebook.com/index.php/DTrace_Guide\" rel=\"noreferrer\">DTrace Guide</a><br>\n<a href=\"http://www.dtracebook.com/index.php/Main_Page\" rel=\"noreferrer\">DTrace book</a><br>\n<a href=\"http://dtrace.org/blogs/brendan/2011/10/10/top-10-dtrace-scripts-for-mac-os-x/\" rel=\"noreferrer\">Brendan Gregg's Top 10 DTrace scripts for Mac OS X</a><br>\n<a href=\"https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/dtrace.1.html\" rel=\"noreferrer\">Apple DTrace manual</a><br>\n<a href=\"https://www.bignerdranch.com/blog/hooked-on-dtrace-part-1/\" rel=\"noreferrer\">Hooked on DTrace</a></p>\n"}], "owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5648, "favorite_count": 1, "accepted_answer_id": 33779137, "answer_count": 1, "score": 6, "last_activity_date": 1447846907, "creation_date": 1447706738, "last_edit_date": 1447802992, "question_id": 33744279, "link": "https://stackoverflow.com/questions/33744279/method-to-sniff-usb-serial-communication-on-osx", "title": "method to sniff usb-serial communication on osx", "body": "<p>On windows, there are several decent alternatives (mostly paid) which allow you to monitor serial port communications.  On OSX there are lots of terminal applications which let you talk to serial devices but I haven't found a mechanism to monitor serial port communication.</p>\n\n<p>The specific use case is:\nI have a USB-Serial device that lives on /dev/tty.usbmodem99999</p>\n\n<p>I have written an integration test that runs multiple commands (successfully).</p>\n\n<p>However on re-running the command the device does not respond.  I've confirmed (as well as I can) that the device is fine.  It works on other platforms as expected.  However on OSX I can only re-run the tests after resetting the device (power cycle).</p>\n\n<p>My theory is that my code is not releasing the device properly but that's hard to confirm when I can't see the communication between my device and my application.</p>\n\n<p>This application: \"<a href=\"http://www.aggsoft.com/serial-port-monitor.htm\" rel=\"noreferrer\">http://www.aggsoft.com/serial-port-monitor.htm</a>\" has a 'spy' feature that I have been unable to find similiar functionality to on OSX.  I've experimented with 'serial tools' on osx, but it doesn't look like it does spy operations on a single port, in that case it looks like the use case is as a passthrough between two devices rather than monitoring at the port.</p>\n\n<p>Any thoughts greatly appreciated.</p>\n\n<p>serial library being used is:\n<a href=\"https://github.com/jacobsa/go-serial\" rel=\"noreferrer\">https://github.com/jacobsa/go-serial</a></p>\n"}, {"tags": ["mysql", "ssh", "go", "tcp"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1447697570, "post_id": 33741491, "comment_id": 55252065, "body": "What&#39;s missing, is how do you intend to manage your SSH tunnel. Is is supposed to be managed by PuTTY or by your Go code? IOW, do you want to have a &quot;full Go&quot; solution or not? If the answer is &quot;no&quot;, then your code looks like a sample code from any Go+MySQL tutorial with the sole difference is that you use <code>localhost:3306</code> as your connection endpoint instead of <code>remoteserver:3306</code>. Note that <code>localhost:3306</code> is only true iff your SSH tunnel is listening on localhost and on the TCP port 3306."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447707433, "post_id": 33741491, "comment_id": 55257352, "body": "The preferred solution is the &quot;full Go&quot; solution, much like I do it with MySQL Workbench. In case it&#39;s too difficult to implement using putty is ok. I tried using putty with localhost:3306 but all I got was a connection timeout."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "edited": false, "score": 0, "creation_date": 1447839014, "post_id": 33764410, "comment_id": 55319014, "body": "Prior to ask the question in SO I found the example provided by you too, but could not figure out how to implement it. I also was uncertain whether it works with the key format I have or not (.ppk file)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "edited": false, "score": 0, "creation_date": 1447839049, "post_id": 33764410, "comment_id": 55319034, "body": "&quot;Stored in vault&quot; means the password will be entered once and then stored in a secured manner for later use."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "edited": false, "score": 0, "creation_date": 1447839117, "post_id": 33764410, "comment_id": 55319082, "body": "My key is protected with a password. I could create a key without one, that would make things easier, but it&#39;s against my security rules"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "edited": false, "score": 0, "creation_date": 1447839275, "post_id": 33764410, "comment_id": 55319205, "body": "I&#39;ll take a closer look again later this week and come back here to let you know my solution."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1447845912, "post_id": 33764410, "comment_id": 55324005, "body": "Well, plain <code>golang.org&#47;x&#47;crypto&#47;ssh</code> won&#39;t work with <code>.ppk</code> keys: this is a PuTTY&#39;s own format which is close to <code>PEM</code> used by OpenSSH but not quite it. So, <i>if</i> you will decide to attempt to read the key directly rather than communicating with the PuTTY&#39;s agent, you can use <code>puttygen.exe</code> to convert your <code>.ppk</code> key to a format compatible with OpenSSH (and hence <code>crypto&#47;ssh</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "edited": false, "score": 0, "creation_date": 1448223118, "post_id": 33764410, "comment_id": 55483642, "body": "Actually it was very easy to export the .ppk file into a .pem file by using puttygen.exe as you suggested. Meanwhile I managed to establish the connection I wanted. I will clean-up the code a little bit and post my solution here later."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 0, "last_activity_date": 1447785009, "creation_date": 1447785009, "answer_id": 33764410, "question_id": 33741491, "link": "https://stackoverflow.com/questions/33741491/how-to-connect-to-mysql-via-standard-tcp-ip-over-ssh-using-go-sql-driver/33764410#33764410", "title": "How to connect to MySQL via Standard TCP/IP over SSH using go-sql-driver?", "body": "<p>Well, you could do that \"full Go\", I think.</p>\n\n<h3>The SSH part and port-forwarding</h3>\n\n<p>I'd start with something like <a href=\"http://sosedoff.com/2015/05/25/ssh-port-forwarding-with-go.html\" rel=\"nofollow\">this</a> (I failed to google a better example).</p>\n\n<p>Note two problems with this code:</p>\n\n<ol>\n<li><p>It's not actually correct: it connects to a remote socket\n<em>before</em> accepting a client connection\nwhile it should do the reverse: accept a client connection to\na port-forwarded local socket then use the active SSH session to connect\nto the remote socket and if this succeeds, spawn two goroutines to shovel\nthe data between those two sockets.</p></li>\n<li><p>When configuring the SSH client, it explicitly allows password-based\nauthentication for unknown reason. You don't need this as you're using\npubkey-based auth.</p></li>\n</ol>\n\n<p>An obstacle which might trip you there is managing an access to your SSH key.\nThe problem with it is that a good key should be protected by a passphrase.</p>\n\n<p>You say the key's password is \"stored in valut\" and I honestly have no idea what \"the valut\" is.</p>\n\n<p>On the systems I use, an SSH client either asks for the password to decrypt the key or work with a so-called \"SSH agent\":</p>\n\n<ul>\n<li>On Linux-based systems it's typically an OpenSSH's <code>ssh-agent</code> binary working in the background which is accessed via a Unix-domain socket, and located by inspecting an environment variable named <code>SSH_AUTH_SOCK</code>.</li>\n<li>On Windows I use PuTTY, and it has its own agent, <code>pageant.exe</code>.\nI'm don't know which means PuTTY SSH client uses to locate it.</li>\n</ul>\n\n<p>To access the OpenSSH agent, <code>golang.org/x/crypto/ssh</code> provides the <code>agent</code> subpackage which can be used to locate the agent and communicate with it.\nIf you need to obtain keys from <code>pageant</code>, I'm afraid you'll need to figure out what protocol that uses and implement it.</p>\n\n<h3>The MySQL part</h3>\n\n<p>The next step would be to integrate this with <code>go-sql-driver</code>.</p>\n\n<p>I'd start the simplest way possible:</p>\n\n<ol>\n<li>When you have your SSH port forwarding working,\nmake it listen for incoming connections on a random port on localhost.\nWhen the connection is opened, get the port from the returned connection\nobject.</li>\n<li>Use that port number to constuct the connection string to pass to an instance of <code>sql.DB</code> you will create to use <code>go-sql-driver</code>.</li>\n</ol>\n\n<p>The driver will then connect to your port-forwarded port, and your SSH layer will do the rest.</p>\n\n<p>After you have this working, I'd explore whether the driver of your choice\nallows some more fine-grained tweaking like allowing you to directly pass it an instance of <code>io.ReadWriter</code> (an opened socket) so that you could skip the port-forwarding setup entirely and just produce new TCP connections forwarded through SSH, that is, skip the \"listening locally\" step.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "is_accepted": false, "score": 1, "last_activity_date": 1448831559, "creation_date": 1448831559, "answer_id": 33988192, "question_id": 33741491, "link": "https://stackoverflow.com/questions/33741491/how-to-connect-to-mysql-via-standard-tcp-ip-over-ssh-using-go-sql-driver/33988192#33988192", "title": "How to connect to MySQL via Standard TCP/IP over SSH using go-sql-driver?", "body": "<p>I promised to provide my example, here it comes. Basically my solution establishes an ssh tunnel to the remote server and queries the remote database through this tunnel. The ssh tunnel is part of the solution.</p>\n\n<p>The first thing I had to do is to convert my PuTTY .ppk private key file into a valid OpenSSH .pem key file. This can easily be done using the Export feature in PuTTYgen. As I wanted to support password encrypted private keys I also needed a function to decrypt the key and reformat it from its decrypted raw format into a valid format accepted by golang.org/x/crypto/ssh/ParsePrivateKey, which is needed to get the list of signers for authentication.</p>\n\n<p>The solution itself consists of a package contained in two files. The main part of the application is done in main.go which contains all relevant data assignments as well as the code related to the database query. Everything related to ssh tunneling and key handling is contained in sshTunnel.go.</p>\n\n<p>The solution does not provide a mechanismn for a secure password store, nor does it ask for a password. The password is provided in the code. However, it would not be too complicated to implement a callback method for password requests.</p>\n\n<p>Please note: from a performance perspective this is not an ideal solution. It also lacks of proper error handling. I have provided this as an example.</p>\n\n<p>The example is a tested and working example. I developed and used this from a Windows 8.1 PC. The database server is on a remote Linux system. All you need to change is the data and the query part in main.go.</p>\n\n<p>Here is the first part contained in main.go:</p>\n\n<pre><code>// mysqlSSHtunnel project main.go\n// Establish an ssh tunnel and connect to a remote mysql server using\n// go-sql-driver for database queries. Encrypted private key pem files\n// are supported.\n//\n// This is an example to give an idea. It's far from a performant solution. It \n// lacks of proper error handling and I'm sure it could really be much better \n// implemented. Please forgive me, as I just started with Go about 2 weeks ago.\n//\n// The database used in this example is from a real Opensimulator installation.\n// It queries the migrations table in the opensim database.\n//\npackage main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"os\"\n)\n\n// Declare your connection data and user credentials here\nconst (\n    // ssh connection related data\n    sshServerHost     = \"test.example.com\"\n    sshServerPort     = 22\n    sshUserName       = \"tester\"\n    sshPrivateKeyFile = \"testkey.pem\" // exported as OpenSSH key from .ppk\n    sshKeyPassphrase  = \"testoster0n\" // key file encrytion password\n\n    // ssh tunneling related data\n    sshLocalHost  = \"localhost\" // local localhost ip (client side)\n    sshLocalPort  = 9000        // local port used to forward the connection\n    sshRemoteHost = \"127.0.0.1\" // remote local ip (server side)\n    sshRemotePort = 3306        // remote MySQL port\n\n    // MySQL access data\n    mySqlUsername = \"opensim\"\n    mySqlPassword = \"h0tgrits\"\n    mySqlDatabase = \"opensimdb\"\n)\n\n// The main entry point of the application\nfunc main() {\n    fmt.Println(\"-&gt; mysqlSSHtunnel\")\n\n    tunnel := sshTunnel() // Initialize sshTunnel\n    go tunnel.Start()     // Start the sshTunnel\n\n    // Declare the dsn (aka database connection string)\n    // dsn := \"opensim:h0tgrits@tcp(localhost:9000)/opensimdb\"\n    dsn := fmt.Sprintf(\"%s:%s@tcp(%s:%d)/%s\",\n        mySqlUsername, mySqlPassword, sshLocalHost, sshLocalPort, mySqlDatabase)\n\n    // Open the database\n    db, err := sql.Open(\"mysql\", dsn)\n    if err != nil {\n        dbErrorHandler(err)\n    }\n    defer db.Close() // keep it open until we are finished\n\n    // Simple select query to check migrations (provided here as an example)\n    rows, err := db.Query(\"SELECT * FROM migrations\")\n    if err != nil {\n        dbErrorHandler(err)\n    }\n    defer rows.Close()\n\n    // Iterate though the rows returned and print them\n    for rows.Next() {\n        var version int\n        var name string\n        if err := rows.Scan(&amp;name, &amp;version); err != nil {\n            dbErrorHandler(err)\n        }\n        fmt.Printf(\"%s, %d\\n\", name, version)\n    }\n    if err := rows.Err(); err != nil {\n        dbErrorHandler(err)\n    }\n\n    // Done for now\n    fmt.Println(\"&lt;- mysqlSSHtunnel\")\n}\n\n// Simple mySql error handling (yet to implement)\nfunc dbErrorHandler(err error) {\n    switch err := err.(type) {\n    default:\n        fmt.Printf(\"Error %s\\n\", err)\n        os.Exit(-1)\n    }\n}\n</code></pre>\n\n<p>Now the second part in sshTunnel.go:    </p>\n\n<pre><code>// mysqlSSHtunnel project sshTunnel.go\n//\n// Everything regarding the ssh tunnel goes here. Credits go to Svett Ralchev.\n// Look at http://blog.ralch.com/tutorial/golang-ssh-tunneling for an excellent\n// explanation and most ssh-tunneling related details used in this code.\n//\n// PEM key decryption is valid for password proected SSH-2 RSA Keys generated as\n// .ppk files for putty and exported as OpenSSH .pem keyfile using PuTTYgen.\n//\npackage main\n\nimport (\n    \"bytes\"\n    \"crypto/x509\"\n    \"encoding/base64\"\n    \"encoding/pem\"\n    \"fmt\"\n    \"golang.org/x/crypto/ssh\"\n    \"io\"\n    \"io/ioutil\"\n    \"net\"\n)\n\n// Define an endpoint with ip and port\ntype Endpoint struct {\n    Host string\n    Port int\n}\n\n// Returns an endpoint as ip:port formatted string\nfunc (endpoint *Endpoint) String() string {\n    return fmt.Sprintf(\"%s:%d\", endpoint.Host, endpoint.Port)\n}\n\n// Define the endpoints along the tunnel\ntype SSHtunnel struct {\n    Local  *Endpoint\n    Server *Endpoint\n    Remote *Endpoint\n    Config *ssh.ClientConfig\n}\n\n// Start the tunnel\nfunc (tunnel *SSHtunnel) Start() error {\n    listener, err := net.Listen(\"tcp\", tunnel.Local.String())\n    if err != nil {\n        return err\n    }\n    defer listener.Close()\n\n    for {\n        conn, err := listener.Accept()\n        if err != nil {\n            return err\n        }\n        go tunnel.forward(conn)\n    }\n}\n\n// Port forwarding\nfunc (tunnel *SSHtunnel) forward(localConn net.Conn) {\n    // Establish connection to the intermediate server\n    serverConn, err := ssh.Dial(\"tcp\", tunnel.Server.String(), tunnel.Config)\n    if err != nil {\n        fmt.Printf(\"Server dial error: %s\\n\", err)\n        return\n    }\n\n    // access the target server\n    remoteConn, err := serverConn.Dial(\"tcp\", tunnel.Remote.String())\n    if err != nil {\n        fmt.Printf(\"Remote dial error: %s\\n\", err)\n        return\n    }\n\n    // Transfer the data between  and the remote server\n    copyConn := func(writer, reader net.Conn) {\n        _, err := io.Copy(writer, reader)\n        if err != nil {\n            fmt.Printf(\"io.Copy error: %s\", err)\n        }\n    }\n\n    go copyConn(localConn, remoteConn)\n    go copyConn(remoteConn, localConn)\n}\n\n// Decrypt encrypted PEM key data with a passphrase and embed it to key prefix\n// and postfix header data to make it valid for further private key parsing.\nfunc DecryptPEMkey(buffer []byte, passphrase string) []byte {\n    block, _ := pem.Decode(buffer)\n    der, err := x509.DecryptPEMBlock(block, []byte(passphrase))\n    if err != nil {\n        fmt.Println(\"decrypt failed: \", err)\n    }\n    encoded := base64.StdEncoding.EncodeToString(der)\n    encoded = \"-----BEGIN RSA PRIVATE KEY-----\\n\" + encoded +\n        \"\\n-----END RSA PRIVATE KEY-----\\n\"\n    return []byte(encoded)\n}\n\n// Get the signers from the OpenSSH key file (.pem) and return them for use in\n// the Authentication method. Decrypt encrypted key data with the passphrase.\nfunc PublicKeyFile(file string, passphrase string) ssh.AuthMethod {\n    buffer, err := ioutil.ReadFile(file)\n    if err != nil {\n        return nil\n    }\n\n    if bytes.Contains(buffer, []byte(\"ENCRYPTED\")) {\n        // Decrypt the key with the passphrase if it has been encrypted\n        buffer = DecryptPEMkey(buffer, passphrase)\n    }\n\n    // Get the signers from the key\n    signers, err := ssh.ParsePrivateKey(buffer)\n    if err != nil {\n        return nil\n    }\n    return ssh.PublicKeys(signers)\n}\n\n// Define the ssh tunnel using its endpoint and config data\nfunc sshTunnel() *SSHtunnel {\n    localEndpoint := &amp;Endpoint{\n        Host: sshLocalHost,\n        Port: sshLocalPort,\n    }\n\n    serverEndpoint := &amp;Endpoint{\n        Host: sshServerHost,\n        Port: sshServerPort,\n    }\n\n    remoteEndpoint := &amp;Endpoint{\n        Host: sshRemoteHost,\n        Port: sshRemotePort,\n    }\n\n    sshConfig := &amp;ssh.ClientConfig{\n        User: sshUserName,\n        Auth: []ssh.AuthMethod{\n            PublicKeyFile(sshPrivateKeyFile, sshKeyPassphrase)},\n    }\n\n    return &amp;SSHtunnel{\n        Config: sshConfig,\n        Local:  localEndpoint,\n        Server: serverEndpoint,\n        Remote: remoteEndpoint,\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4849927"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4887, "favorite_count": 1, "accepted_answer_id": 33764410, "answer_count": 2, "score": 3, "last_activity_date": 1448831559, "creation_date": 1447695923, "question_id": 33741491, "link": "https://stackoverflow.com/questions/33741491/how-to-connect-to-mysql-via-standard-tcp-ip-over-ssh-using-go-sql-driver", "title": "How to connect to MySQL via Standard TCP/IP over SSH using go-sql-driver?", "body": "<p>I'm currently using MySQL Workbench on Windows 8.1 to access a remote MySQL database on a Linux server using Standard TCP/IP over SSH. Basically I have the following information:</p>\n\n<ul>\n<li>SSH Hostname: dbserver.myorg.com:<em>ssh-port</em></li>\n<li>SSH Username: myRemoteLoginUsername</li>\n<li>SSH Password: (stored in vault)</li>\n<li><p>SSH Key File: <em>path to a local .ppk file</em></p></li>\n<li><p>MySQL Hostname: 127.0.0.1</p></li>\n<li>MySQL Server Port: 3306</li>\n<li>Username: myRemoteDbUsername</li>\n<li>Password: (stored in vault)</li>\n<li>Default schema: myRemoteDatabaseName</li>\n</ul>\n\n<p>How can I connect to the database from a Go command application using github.com/go-sql-driver/mysql?</p>\n\n<p>how should my DataSourceName string in the sql.Open statement look like?</p>\n\n<pre><code>    db, err := sql.Open(\"mysql\", &lt;DataSourceName&gt; ) {}\n</code></pre>\n\n<p>Is there any extra work needed to prepare a working DataSourceName string? </p>\n\n<p>On my Windows PC I have putty installed. I read about tunneling and added a Dynamic tunnel for port 3306 (D3306). I expected this will let me connect using a connection to localhost:3306 and automatically forward the request to the remote db whenever I'm connected to the remote host with putty, but this didn't work as expected either.</p>\n"}, {"tags": ["opengl", "go", "sdl-2"], "answers": [{"tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": true, "score": 2, "last_activity_date": 1447739729, "last_edit_date": 1447739729, "creation_date": 1447739233, "answer_id": 33750000, "question_id": 33740157, "link": "https://stackoverflow.com/questions/33740157/glreadpixels-does-not-write-data-to-array/33750000#33750000", "title": "glReadPixels does not write data to array", "body": "<p>The problem is likely</p>\n\n<pre><code>gl.ReadPixels(int32(rx), int32(ry), 1, 1, gl.RGB, gl.UNSIGNED_BYTE, gl.Ptr(&amp;data))\n</code></pre>\n\n<p>Specifically</p>\n\n<pre><code>gl.Ptr(&amp;data)\n</code></pre>\n\n<p>The documentation for that function is:</p>\n\n<pre><code>// Ptr takes a slice or pointer (to a singular scalar value or the first\n// element of an array or slice) and returns its GL-compatible address.\n</code></pre>\n\n<p>You're passing a POINTER to a slice. This is... problematic if you look at the implementation.</p>\n\n<pre><code>func Ptr(data interface{}) unsafe.Pointer {\n    if data == nil {\n        return unsafe.Pointer(nil)\n    }\n    var addr unsafe.Pointer\n    v := reflect.ValueOf(data)\n    switch v.Type().Kind() {\n    case reflect.Ptr:\n        e := v.Elem()\n        switch e.Kind() {\n        case\n            reflect.Int, reflect.Int8, reflect.Int16, reflect.Int32, reflect.Int64,\n            reflect.Uint, reflect.Uint8, reflect.Uint16, reflect.Uint32, reflect.Uint64,\n            reflect.Float32, reflect.Float64:\n            addr = unsafe.Pointer(e.UnsafeAddr())\n        }\n    case reflect.Uintptr:\n        addr = unsafe.Pointer(v.Pointer())\n    case reflect.Slice:\n\n\naddr = unsafe.Pointer(v.Index(0).UnsafeAddr())\n    default:\n        panic(fmt.Sprintf(\"Unsupported type %s; must be a pointer, slice, or array\", v.Type()))\n    }\n    return addr\n}\n</code></pre>\n\n<p>As you can see, if you pass in a pointer to anything other than a basic uint/float/int, it will fail silently and return a null <code>unsafe.Pointer</code> if it's not of the correct type. So you either want to pass in <code>gl.Ptr(&amp;data[0])</code> or <code>gl.Ptr(data)</code>. It's honestly kind of surprising this wasn't segfaulting.</p>\n"}], "owner": {"reputation": 9811, "user_id": 168717, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/851da71d0192b0e34ac44dd6c98c31d2?s=128&d=identicon&r=PG", "display_name": "AkiRoss", "link": "https://stackoverflow.com/users/168717/akiross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 33750000, "answer_count": 1, "score": 2, "last_activity_date": 1447739729, "creation_date": 1447691457, "question_id": 33740157, "link": "https://stackoverflow.com/questions/33740157/glreadpixels-does-not-write-data-to-array", "title": "glReadPixels does not write data to array", "body": "<p>I am stuck with <code>glReadPixels</code>: it appears that no data is written in the output array.</p>\n\n<p>From the manual (<a href=\"https://www.opengl.org/sdk/docs/man/docbook4/xhtml/glReadPixels.xml\" rel=\"nofollow\">https://www.opengl.org/sdk/docs/man/docbook4/xhtml/glReadPixels.xml</a>) it's written that <em>If an error is generated, no change is made to the contents of data.</em>, but apparently no error is returned by <code>glGetError()</code>.</p>\n\n<p>I really can't understand what's wrong... Here's the code - in golang - that samples random point in the screen. It always print <code>[0 0 0]</code>, although no pixel should be black (not even the background).</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/go-gl/gl/v4.1-core/gl\"\n    \"github.com/veandco/go-sdl2/sdl\"\n    \"math/rand\"\n    \"os\"\n    \"runtime\"\n)\n\nfunc main() {\n    // Random crashes, this seems to fix\n    runtime.LockOSThread()\n\n    var wWidth, wHeight int = 500, 500\n\n    // Initialize SDL\n    if err := sdl.Init(sdl.INIT_EVERYTHING); err != nil {\n        panic(err)\n    }\n    defer sdl.Quit()\n\n    // Initialize OpenGL\n    if err := gl.Init(); err != nil {\n        panic(err)\n    }\n\n    // Create the OpenGL-capable window\n    win, err := sdl.CreateWindow(\n        \"glReadPixels Test\",\n        sdl.WINDOWPOS_CENTERED,\n        sdl.WINDOWPOS_CENTERED,\n        wWidth, wHeight,\n        sdl.WINDOW_OPENGL)\n\n    if err != nil {\n        panic(err)\n    }\n    defer win.Destroy()\n\n    // Setup OpenGL context\n    var ctx sdl.GLContext\n    ctx, err = sdl.GL_CreateContext(win)\n    if err != nil {\n        panic(err)\n    }\n    defer sdl.GL_DeleteContext(ctx)\n\n    // Settings\n    initGL(wWidth, wHeight)\n\n    for {\n        for event := sdl.PollEvent(); event != nil; event = sdl.PollEvent() {\n            switch event.(type) {\n            case *sdl.QuitEvent:\n                os.Exit(0)\n            }\n        }\n\n        // Clear and draw\n        gl.Clear(gl.COLOR_BUFFER_BIT)\n        gl.DrawArrays(gl.TRIANGLE_STRIP, 0, 4)\n\n        rx, ry := rand.Intn(wWidth), rand.Intn(wHeight)\n\n        gl.ReadBuffer(gl.FRONT) // Not working with gl.BACK either\n        data := make([]byte, 3)\n        //data[0], data[1], data[2] = 123, 213, 132 // Test if it's overwritten\n        gl.ReadPixels(int32(rx), int32(ry), 1, 1, gl.RGB, gl.UNSIGNED_BYTE, gl.Ptr(&amp;data))\n        fmt.Println(\"Read at\", rx, ry, data)\n\n        // Show on window\n        sdl.GL_SwapWindow(win)\n\n        // Check for errors...\n        if gl.GetError() != gl.NO_ERROR {\n            fmt.Println(\"GL ERROR Somewhere!\")\n        }\n\n        sdl.Delay(uint32(300))\n    }\n}\n\nfunc initGL(winW, winH int) {\n    gl.ClearColor(0.2, 0.2, 0.3, 1.0)\n    gl.Viewport(0, 0, int32(winW), int32(winH))\n\n    // Shader sources\n    vertShaderSrc := gl.Str(`\n#version 130\n\nin vec3 vertPos;\nin vec2 vertUV;\n\nout vec2 fragUV;\n\nvoid main() {\n    gl_Position = vec4(vertPos, 1.0f);\n    fragUV = vertUV;\n}\n` + \"\\x00\")\n\n    fragShaderSrc := gl.Str(`#version 130\nin vec2 fragUV;\nout vec3 outColor;\n\nvoid main() {\n    if (fragUV.x &lt; 0.5 ^^ fragUV.y &lt; 0.5)\n        outColor = vec3(1.0, 0.0, 0.0);\n    else\n        outColor = vec3(0.0, 0.0, 1.0);\n}\n` + \"\\x00\")\n\n    // Shaders\n    var vShader, fShader uint32\n    vShader = gl.CreateShader(gl.VERTEX_SHADER)\n    fShader = gl.CreateShader(gl.FRAGMENT_SHADER)\n    gl.ShaderSource(vShader, 1, &amp;vertShaderSrc, nil)\n    gl.ShaderSource(fShader, 1, &amp;fragShaderSrc, nil)\n    gl.CompileShader(vShader)\n    gl.CompileShader(fShader)\n\n    // Program\n    var progr uint32 = gl.CreateProgram()\n    gl.AttachShader(progr, vShader)\n    gl.AttachShader(progr, fShader)\n    gl.BindAttribLocation(progr, 0, gl.Str(\"vertPos\\x00\"))\n    gl.BindAttribLocation(progr, 1, gl.Str(\"vertUV\\x00\"))\n    gl.LinkProgram(progr)\n    gl.UseProgram(progr)\n\n    const N float32 = -0.5\n    const P float32 = 0.5\n\n    // Setup the \"canvas\": a simple quad\n    canvasData := []float32{\n        N, N, 0, 0.0, 0.0,\n        P, N, 0, 1.0, 0.0,\n        N, P, 0, 0.0, 1.0,\n        P, P, 0, 1.0, 1.0,\n    }\n\n    var vboID uint32\n    gl.GenBuffers(1, &amp;vboID)\n    gl.BindBuffer(gl.ARRAY_BUFFER, vboID)\n    gl.BufferData(gl.ARRAY_BUFFER, len(canvasData)*4, gl.Ptr(canvasData), gl.STATIC_DRAW)\n\n    var vaoID uint32\n    gl.GenVertexArrays(1, &amp;vaoID)\n    gl.BindVertexArray(vaoID)\n\n    gl.EnableVertexAttribArray(0)\n    gl.EnableVertexAttribArray(1)\n\n    gl.VertexAttribPointer(0, 3, gl.FLOAT, false, 5*4, gl.PtrOffset(0))\n    gl.VertexAttribPointer(1, 2, gl.FLOAT, false, 5*4, gl.PtrOffset(3*4))\n}\n</code></pre>\n"}, {"tags": ["macos", "go", "pprof"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1447680216, "post_id": 33736363, "comment_id": 55241176, "body": "Show <i>how</i> you make the profiles. Especially your config for the <code>profile.Start</code>."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1447680909, "post_id": 33736363, "comment_id": 55241601, "body": "Updated to include everything I did on last run - thanks for looking"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1447681263, "post_id": 33736363, "comment_id": 55241843, "body": "Any reason why you feed <code>go build</code> files one by one instead of just <code>go build</code>? Also, <code>go tool pprof</code> call seems to be missing the binary itself, should be <code>go tool pprof .&#47;orig &#47;path&#47;to&#47;profile.pprof</code>."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1447681432, "post_id": 33736363, "comment_id": 55241939, "body": "go build picks up all the test files, thats why I list them individually (I have a script that spits out the list of files that arent tests (is there a better way?) - I think you may have the solution there with missing binary in options passed to pprof though -let me check"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1447681536, "post_id": 33736363, "comment_id": 55242017, "body": "@Ainar-G  yep missing the binary passed to pprof (user muppetry) - thanks for your help - if you submit as answer happy to accept :)"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1447681669, "post_id": 33736363, "comment_id": 55242115, "body": "Answered. Also, I don&#39;t quite get what you mean by &quot;go build picks up all the test files&quot;. It won&#39;t build any <code>foo_test.go</code> files unless you are using <code>go test</code> or <code>go build -tags test</code>."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1447682025, "post_id": 33736363, "comment_id": 55242330, "body": "You&#39;re right if building in same directory - I was trying to build subdir as go build subdir/* - that was why it was picking up test files (I have some temporary relative paths, so cant currently build from the subdir - not planning to keep going forward)"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 10, "last_activity_date": 1447681585, "creation_date": 1447681585, "answer_id": 33736898, "question_id": 33736363, "link": "https://stackoverflow.com/questions/33736363/golang-tool-pprof-not-working-properly-same-broken-output-regardless-of-profil/33736898#33736898", "title": "golang tool pprof not working properly - same broken output regardless of profiling target", "body": "<p>Your <code>go tool pprof</code> call is missing the binary itself. Call it as</p>\n\n<pre><code>go tool pprof ./orig /path/to/profile.pprof\n</code></pre>\n"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1673, "favorite_count": 0, "accepted_answer_id": 33736898, "answer_count": 1, "score": 7, "last_activity_date": 1447681585, "creation_date": 1447679834, "last_edit_date": 1447680861, "question_id": 33736363, "link": "https://stackoverflow.com/questions/33736363/golang-tool-pprof-not-working-properly-same-broken-output-regardless-of-profil", "title": "golang tool pprof not working properly - same broken output regardless of profiling target", "body": "<p>I've previously used the pprof tool without issue and it worked great - now I see output like the following no matter what I profile:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KKNRC.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/KKNRC.png\" alt=\"Output from pprof\"></a></p>\n\n<p>the application being profiled in this example probably makes 40+ function calls and even more complex apps are producing similar callgraphs for both cpu and memprofiling.</p>\n\n<p>The apps Im trying to profile are all web applications, I am profiling them for one minute at a time and using wrk to generate 200,000,000+ requests = all returning data and a 2xx response</p>\n\n<p>pprof suddenly stopped working a few days ago running osx yosemite - in an attempt to resolve the issue I recently upgraded to el capitan but result is the same.</p>\n\n<p>Note: this is not just call graphs - calling list or top command produce similarly barren results but the apps themselves work fine:</p>\n\n<pre><code>    (pprof) top\n269.97kB of 269.97kB total (  100%)\n      flat  flat%   sum%        cum   cum%\n  269.97kB   100%   100%   269.97kB   100%  \n(pprof) \n</code></pre>\n\n<p>I am using the following package: \"github.com/davecheney/profile\" with go v1.5.1</p>\n\n<p>For clarity, here's what I'm doing to generate the profiles::</p>\n\n<p>I import the above package into main.go and place the following at the top of my main func:</p>\n\n<pre><code>defer profile.Start(profile.MemProfile).Stop()\n</code></pre>\n\n<p>I then build the binary and run it:</p>\n\n<pre><code>go build -o orig /Users/danielwall/www/netlistener/application/adrequest.go /Users/danielwall/www/netlistener/application/cookie.go /Users/danielwall/www/netlistener/application/header.go /Users/danielwall/www/netlistener/application/lex.go /Users/danielwall/www/netlistener/application/main.go /Users/danielwall/www/netlistener/application/publisher_ids.go /Users/danielwall/www/netlistener/application/request.go /Users/danielwall/www/netlistener/application/response.go /Users/danielwall/www/netlistener/application/server.go /Users/danielwall/www/netlistener/application/sniff.go /Users/danielwall/www/netlistener/application/status.go /Users/danielwall/www/netlistener/application/transfer.go\n\n./orig\n</code></pre>\n\n<p>I then see output like this:</p>\n\n<pre><code>2015/11/16 11:39:49 profile: memory profiling enabled, /var/folders/26/2sj70_sn72l_93j7tf6r07gr0000gn/T/profile614358295/mem.pprof\n</code></pre>\n\n<p>Now I work the app from another terminal :</p>\n\n<pre><code>    wrk -d60 -c10 -H \"X-Device: desktop\" -H \"X-Country-Code: GB\" \"http://localhost:8189/app?id=111&amp;schema=xml2&amp;ad_type=auto&amp;url=http://test.com/&amp;category=bob\"\nRunning 1m test @ http://localhost:8189/app?id=111&amp;schema=xml2&amp;ad_type=auto&amp;url=http://test.com/&amp;category=bob\n  2 threads and 10 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   414.09us    0.92ms  55.36ms   95.66%\n    Req/Sec    17.57k     3.19k   22.59k    76.00%\n  2097764 requests in 1.00m, 684.20MB read\nRequests/sec:  34958.03\nTransfer/sec:     11.40MB\n</code></pre>\n\n<p>After 60 seconds, I go back to check my profile:</p>\n\n<pre><code>^C2015/11/16 12:05:20 profile: caught interrupt, stopping profiles\n\ngo tool pprof /var/folders/26/2sj70_sn72l_93j7tf6r07gr0000gn/T/profile614358295/mem.pprof\n</code></pre>\n\n<p>Any ideas what might be happening here or where I could start with trouble shooting/solving this?</p>\n\n<p>Any help suggestions welcome.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1447672945, "creation_date": 1447672945, "answer_id": 33734169, "question_id": 33733974, "link": "https://stackoverflow.com/questions/33733974/handler-function-execution-upon-http-responsewriter-flush-end/33734169#33734169", "title": "Handler function execution upon http.ResponseWriter flush/end?", "body": "<p>You could create your own <code>http.ResponseWriter</code> to do that, or you could just use a \"middleware pattern\":</p>\n\n<pre><code>// foo is the main handler\ntype foo struct{}\n\nfunc (foo) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"foo\"))\n}\n\n// bar writes after foo\ntype bar struct {\n    h http.Handler\n}\n\nfunc (b bar) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    b.h.ServeHTTP(w, r)\n    w.Write([]byte(\"BAR\"))\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/fB2OXNSTIe\" rel=\"nofollow\">http://play.golang.org/p/fB2OXNSTIe</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1447674070, "last_edit_date": 1447674070, "creation_date": 1447673093, "answer_id": 33734221, "question_id": 33733974, "link": "https://stackoverflow.com/questions/33733974/handler-function-execution-upon-http-responsewriter-flush-end/33734221#33734221", "title": "Handler function execution upon http.ResponseWriter flush/end?", "body": "<p>You can simply wrap your <a href=\"https://golang.org/pkg/net/http/#HandlerFunc\" rel=\"nofollow\"><code>HandleFunc</code></a>, and after the wrapped handler returns, you can write further data to the <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow\"><code>ResponseWriter</code></a>:</p>\n\n<pre><code>func myhandler(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Hello\"))\n}\n\nfunc wrapper(w http.ResponseWriter, r *http.Request) {\n    myhandler(w, r)           // Call original\n    w.Write([]byte(\" World\")) // Write further data to output\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", wrapper)\n    http.ListenAndServe(\"\", nil)\n}\n</code></pre>\n\n<p>Visiting any URL will result in response:</p>\n\n<pre><code>Hello World\n</code></pre>\n\n<p><strong>Things to keep in mind in production environment:</strong></p>\n\n<ul>\n<li>The wrapper should also examine response code or success of the wrapped handler, and act upon (e.g. if an error page is served, it might not be desired to still carry out the additional write).</li>\n<li>If <code>\"Content-length\"</code> header is set by the wrapped handler, writing more data will render it invalid (as the content will be bigger than indicated in the header).</li>\n</ul>\n\n<p>One possible \"protection\" against this might be to pass a custom <code>ResponseWriter</code> implementation which writes only to a buffer (e.g. <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow\"><code>bytes.Buffer</code></a>) and the wrapper will append to this and set <code>\"Content-length\"</code> according to the new length, and then write the content of the buffer to the \"real\" output.</p>\n"}], "owner": {"reputation": 1587, "user_id": 2692578, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/422308f27d72a059a020981097da6589?s=128&d=identicon&r=PG", "display_name": "paulkon", "link": "https://stackoverflow.com/users/2692578/paulkon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1447674070, "creation_date": 1447672306, "question_id": 33733974, "link": "https://stackoverflow.com/questions/33733974/handler-function-execution-upon-http-responsewriter-flush-end", "title": "Handler function execution upon http.ResponseWriter flush/end?", "body": "<p>Is there a way to hook onto a flush/end event on an http.ResponseWriter in order to execute a handler which writes more to the writer just before sending.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 473, "user_id": 279890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c814f355aec49a73a7c3bbcc3b0eb27?s=128&d=identicon&r=PG", "display_name": "Yannick", "link": "https://stackoverflow.com/users/279890/yannick"}, "edited": false, "score": 1, "creation_date": 1447665430, "post_id": 33730877, "comment_id": 55232354, "body": "I don&#39;t see any problem here. Can you post the handler."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 473, "user_id": 279890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c814f355aec49a73a7c3bbcc3b0eb27?s=128&d=identicon&r=PG", "display_name": "Yannick", "link": "https://stackoverflow.com/users/279890/yannick"}, "edited": false, "score": 0, "creation_date": 1447667259, "post_id": 33730877, "comment_id": 55233472, "body": "@yene thanks for looking into the problem. Added a handler, but I am not sure how exactly I could have screwed up the handler, that the compilation process fails only when both headers are set."}, {"owner": {"reputation": 473, "user_id": 279890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c814f355aec49a73a7c3bbcc3b0eb27?s=128&d=identicon&r=PG", "display_name": "Yannick", "link": "https://stackoverflow.com/users/279890/yannick"}, "edited": false, "score": 0, "creation_date": 1447670102, "post_id": 33730877, "comment_id": 55235194, "body": "I think it fails because the server responds an error which is not handled. Try adding more error reporting and check the server logs."}, {"owner": {"reputation": 1399, "user_id": 536113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329f705a6d4ea0185f3aca9ee823d74?s=128&d=identicon&r=PG", "display_name": "vially", "link": "https://stackoverflow.com/users/536113/vially"}, "edited": false, "score": 0, "creation_date": 1447674297, "post_id": 33730877, "comment_id": 55237536, "body": "I also think the problem is in the missing code of the handler. Would it be possible that somewhere in your ServeHTTP function you are checking the <code>Content-Type</code> or <code>Accept</code> header and when they are set to <code>application&#47;json</code> you are attempting to parse the request body which is nil, therefore the panic? But I guess this is just a shot in the dark and I doubt that&#39;s what&#39;s really happening."}], "answers": [{"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1447667183, "post_id": 33732176, "comment_id": 55233431, "body": "thanks for taking a look and even giving the working example."}], "tags": [], "owner": {"reputation": 51, "user_id": 1017888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2141eb6f75e467b32576faf1156f429a?s=128&d=identicon&r=PG", "display_name": "Wolfmetr", "link": "https://stackoverflow.com/users/1017888/wolfmetr"}, "is_accepted": false, "score": 1, "last_activity_date": 1447666580, "creation_date": 1447666580, "answer_id": 33732176, "question_id": 33730877, "link": "https://stackoverflow.com/questions/33730877/go-can-not-add-accept-and-content-type-headers-at-the-same-time/33732176#33732176", "title": "Go can not add accept and content-type headers at the same time", "body": "<p>I think error in your http server/handler implementation. I tried to reproduce it and it worked.</p>\n\n<p>You can see here:\n<a href=\"http://play.golang.org/p/n1YBl3OpbN\" rel=\"nofollow\">http://play.golang.org/p/n1YBl3OpbN</a></p>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1447667152, "creation_date": 1447661610, "last_edit_date": 1447667152, "question_id": 33730877, "link": "https://stackoverflow.com/questions/33730877/go-can-not-add-accept-and-content-type-headers-at-the-same-time", "title": "Go can not add accept and content-type headers at the same time", "body": "<p>I am trying to write tests for a simple rest application in go. So I write something like this:</p>\n\n<pre><code>func TestMyTestFunc(t *testing.T) {\n    var w = httptest.NewRecorder()\n    req, err := http.NewRequest(\"POST\", \"/\", nil)\n    if err != nil {\n        t.Errorf(\"Error creating request: %s\", err.Error())\n    }\n    // req.Header.Add(\"Content-Type\", \"application/json\")\n    // req.Header.Add(\"Accept\", \"application/json\")\n    l.ServeHTTP(w, req)  // l is defined somewhere above\n    // check for w.Code, w.Body\n}\n</code></pre>\n\n<p>This works perfectly fine. Now I would like to add headers. So I add the commented header part and end up with:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference [recovered]\npanic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>and the error is on this line: <code>l.ServeHTTP(w, req)</code>.</p>\n\n<p>Interesting part, that if I set only <code>Content-Type</code> or <code>Accept</code>, the test runs, but if I set both, it fails. What's wrong?</p>\n\n<p>P.S. I also tried to use <code>req.Header.Set</code>, but with no difference.\nHere is an stub for my handler:</p>\n\n<pre><code>func (l myHandler) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    // check for validity\n    if !valid {\n       http.Error(w, \"Invalid Accept\", http.StatusBadRequest)\n       return\n    }\n    w.WriteHeader(http.StatusNoContent)\n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1447657134, "post_id": 33729922, "comment_id": 55228811, "body": "Simple <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">type conversion</a>, short: <code>i := int(size)</code> or  verbose: <code>var intResult int = int(size)</code>."}, {"owner": {"reputation": 163, "user_id": 5365174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1601329510/picture?type=large", "display_name": "Brian Boyd", "link": "https://stackoverflow.com/users/5365174/brian-boyd"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1447657432, "post_id": 33729922, "comment_id": 55228925, "body": "At first I thought a simple cast would work too.  However, Go does not seem to allow this, the error message is not clear though."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 7, "creation_date": 1447658385, "post_id": 33729922, "comment_id": 55229272, "body": "What error message? Would you care to post it? And simple conversion does work, see this example on the Go playground: <a href=\"http://play.golang.org/p/iPJcmvW4MS\" rel=\"nofollow noreferrer\">play.golang.org/p/iPJcmvW4MS</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1447674760, "post_id": 33729922, "comment_id": 55237840, "body": "@icza: That&#39;s not a good solution to the question. There&#39;s no need for a temporary variable."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1447674892, "post_id": 33729922, "comment_id": 55237915, "body": "@peterSO Yes, temporary variable is not needed. I didn&#39;t mean to imply that, just wanted to show that a simple conversion will do it. It works with or without a temp variable."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 5365174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1601329510/picture?type=large", "display_name": "Brian Boyd", "link": "https://stackoverflow.com/users/5365174/brian-boyd"}, "edited": false, "score": 0, "creation_date": 1447724069, "post_id": 33734435, "comment_id": 55263683, "body": "Thank you, I think I have written too many c-like cast over the years.  Thank you for all the responses!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 11, "last_activity_date": 1447674354, "last_edit_date": 1447674354, "creation_date": 1447673793, "answer_id": 33734435, "question_id": 33729922, "link": "https://stackoverflow.com/questions/33729922/convert-uint32-to-int-in-go/33734435#33734435", "title": "Convert uint32 to int in Go", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">Conversions</a></p>\n  \n  <p>Conversions are expressions of the form <code>T(x)</code> where <code>T</code> is a type and\n  <code>x</code> is an expression that can be converted to type <code>T</code>.</p>\n</blockquote>\n\n<p>For example,</p>\n\n<pre><code>size := binary.BigEndian.Uint32(b[4:])\nn, err := rdr.Discard(int(size))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2421, "user_id": 445845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vrtJX.jpg?s=128&g=1", "display_name": "Ariel Monaco", "link": "https://stackoverflow.com/users/445845/ariel-monaco"}, "is_accepted": false, "score": 8, "last_activity_date": 1584650398, "creation_date": 1584650398, "answer_id": 60764723, "question_id": 33729922, "link": "https://stackoverflow.com/questions/33729922/convert-uint32-to-int-in-go/60764723#60764723", "title": "Convert uint32 to int in Go", "body": "<p>Simply Use the <code>int()</code> cast function</p>\n"}], "owner": {"reputation": 163, "user_id": 5365174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1601329510/picture?type=large", "display_name": "Brian Boyd", "link": "https://stackoverflow.com/users/5365174/brian-boyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18866, "favorite_count": 2, "accepted_answer_id": 33734435, "answer_count": 2, "score": 9, "last_activity_date": 1584650398, "creation_date": 1447657049, "last_edit_date": 1447740475, "question_id": 33729922, "link": "https://stackoverflow.com/questions/33729922/convert-uint32-to-int-in-go", "title": "Convert uint32 to int in Go", "body": "<p>How do I convert a <code>uint32</code> into an <code>int</code> in Go?</p>\n\n<p>A little background, I'm reading from a file and this gives me the correct size from a byte array like this:</p>\n\n<pre><code>size := binary.BigEndian.Uint32(b[4:])\n</code></pre>\n\n<p>However, the <code>bufio.Discard</code> func expects an int.  I was able to use fmt to convert size to a string and then use strconv to get it to an int. There has to be a more elegant way to do this.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1447633076, "post_id": 33726731, "comment_id": 55222713, "body": "what you&#39;re looking for is a <code>map</code> function. (as opposed to the <code>map</code> datatype that&#39;s analogous to Python&#39;s <code>dict</code>)"}, {"owner": {"reputation": 1055, "user_id": 1563701, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/63da13112be95f5fd032d1c3c409ec0c?s=128&d=identicon&r=PG", "display_name": "marczoid", "link": "https://stackoverflow.com/users/1563701/marczoid"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1447633622, "post_id": 33726731, "comment_id": 55222860, "body": "Thanks Adam, any idea where i could find them? Is it part of the standard liberaries? I can&#39;t find much about it..."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 4, "creation_date": 1447634324, "post_id": 33726731, "comment_id": 55223002, "body": "I threw an answer up, but googling for &quot;golang map function&quot; will give you more information. The short answer is No, there is no such function in golang"}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 9, "last_activity_date": 1518985422, "last_edit_date": 1518985422, "creation_date": 1447633802, "answer_id": 33726830, "question_id": 33726731, "link": "https://stackoverflow.com/questions/33726731/short-way-to-apply-a-function-to-all-elements-in-a-list-in-golang/33726830#33726830", "title": "Short way to apply a function to all elements in a list in golang", "body": "<p>I would do exactly as you did, with a few tweaks to fix typos</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    list := []int{1,2,3}\n\n    var list2 []string\n    for _, x := range list {\n        list2 = append(list2, strconv.Itoa(x * 2))  // note the = instead of :=\n    }\n\n    str := strings.Join(list2, \", \")\n    fmt.Println(str)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8130, "user_id": 239657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53c0fe850111d3f1bbd41c24c7c62b3?s=128&d=identicon&r=PG", "display_name": "Beni Cherniavsky-Paskin", "link": "https://stackoverflow.com/users/239657/beni-cherniavsky-paskin"}, "edited": false, "score": 5, "creation_date": 1549899031, "post_id": 50025091, "comment_id": 96059973, "body": "The reason it&#39;s not built-in is that Go has no generics (yet?).  So you have to write a different Map for each type."}, {"owner": {"reputation": 155, "user_id": 7952488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c92cdc2f1c0ec71794965e505bf7be2?s=128&d=identicon&r=PG", "display_name": "Anubhav", "link": "https://stackoverflow.com/users/7952488/anubhav"}, "edited": false, "score": 0, "creation_date": 1615231104, "post_id": 50025091, "comment_id": 117622375, "body": "After reading the comment above, I was wondering if reflection, interfaces can be used, then I found answer below. Surreal."}], "tags": [], "owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "is_accepted": false, "score": 7, "last_activity_date": 1524667178, "creation_date": 1524667178, "answer_id": 50025091, "question_id": 33726731, "link": "https://stackoverflow.com/questions/33726731/short-way-to-apply-a-function-to-all-elements-in-a-list-in-golang/50025091#50025091", "title": "Short way to apply a function to all elements in a list in golang", "body": "<p>This is an old question, but was the top hit in my Google search, and I found information that I believe will be helpful to the OP and anyone else who arrives here, looking for the same thing.</p>\n\n<p>There is a shorter way, although you have to write the map function yourself.</p>\n\n<p>In go, <code>func</code> is a type, which allows you to write a function that accepts as input the subject slice and a function, and which iterates over that slice, applying that function.</p>\n\n<p>See the <code>Map</code> function near the bottom of this Go by Example page : <a href=\"https://gobyexample.com/collection-functions\" rel=\"noreferrer\">https://gobyexample.com/collection-functions</a></p>\n\n<p>I've included it here for reference:</p>\n\n<pre><code>func Map(vs []string, f func(string) string) []string {\n    vsm := make([]string, len(vs))\n    for i, v := range vs {\n        vsm[i] = f(v)\n    }\n    return vsm\n}\n</code></pre>\n\n<p>You then call it like so:</p>\n\n<pre><code>fmt.Println(Map(strs, strings.ToUpper))\n</code></pre>\n\n<p>So, yes:  The shorter way you are looking for exists, although it is not built into the language itself.</p>\n"}, {"comments": [{"owner": {"reputation": 489, "user_id": 3842889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pZ5nu.png?s=128&g=1", "display_name": "gschenk", "link": "https://stackoverflow.com/users/3842889/gschenk"}, "edited": false, "score": 2, "creation_date": 1586891922, "post_id": 56373415, "comment_id": 108294699, "body": "That&#39;s a bit terse. Using two advanced concepts in go, namely <code>interface{}</code> and <code>reflect</code> explanation should be most welcome. I suppose you &#39;found&#39; <i>out</i> how to do it, not &#39;found&#39; <i>it somewhere and copied it</i>."}, {"owner": {"reputation": 155, "user_id": 7952488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c92cdc2f1c0ec71794965e505bf7be2?s=128&d=identicon&r=PG", "display_name": "Anubhav", "link": "https://stackoverflow.com/users/7952488/anubhav"}, "edited": false, "score": 0, "creation_date": 1615231159, "post_id": 56373415, "comment_id": 117622392, "body": "After reading the answer above, I thought of using reflect and interface, and how reflection might slow it down, scroll down a little, and behold."}], "tags": [], "owner": {"reputation": 41, "user_id": 2158290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08ab3b56dcb469fe0bd53ed19122b1da?s=128&d=identicon&r=PG", "display_name": "user2158290", "link": "https://stackoverflow.com/users/2158290/user2158290"}, "is_accepted": false, "score": 4, "last_activity_date": 1559200231, "creation_date": 1559200231, "answer_id": 56373415, "question_id": 33726731, "link": "https://stackoverflow.com/questions/33726731/short-way-to-apply-a-function-to-all-elements-in-a-list-in-golang/56373415#56373415", "title": "Short way to apply a function to all elements in a list in golang", "body": "<p>Found a way to define a generic map array function</p>\n\n<pre><code>func Map(t interface{}, f func(interface{}) interface{} ) []interface{} {\n    switch reflect.TypeOf(t).Kind() {\n    case reflect.Slice:\n        s := reflect.ValueOf(t)\n        arr := make([]interface{}, s.Len())\n        for i := 0; i &lt; s.Len(); i++ {\n            arr[i] = f(s.Index(i).Interface())\n        }\n        return arr\n    }\n    return nil\n}\n\norigin := []int{4,5,3}\nnewArray := Map(origin, func(item interface{}) interface{} { return item.(int) + 1})\n</code></pre>\n"}], "owner": {"reputation": 1055, "user_id": 1563701, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/63da13112be95f5fd032d1c3c409ec0c?s=128&d=identicon&r=PG", "display_name": "marczoid", "link": "https://stackoverflow.com/users/1563701/marczoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18011, "favorite_count": 2, "accepted_answer_id": 33726830, "answer_count": 3, "score": 13, "last_activity_date": 1559200231, "creation_date": 1447632866, "question_id": 33726731, "link": "https://stackoverflow.com/questions/33726731/short-way-to-apply-a-function-to-all-elements-in-a-list-in-golang", "title": "Short way to apply a function to all elements in a list in golang", "body": "<p>Suppose I would like to apply a function to every element in a list, and then put the resulting values in another list so I can immediately use them. In python, I would do something like this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>list = [1,2,3]\nstr = ', '.join(multiply(x, 2) for x in list)\n</code></pre>\n\n<p>In Go, I do something like this:</p>\n\n<pre><code>list := []int{1,2,3}\nlist2 := []int\n\nfor _,x := range list {\n    list2 := append(list2, multiply(x, 2))\n}\n\nstr := strings.Join(list2, \", \")\n</code></pre>\n\n<p>Is it possible to do this in a shorter way?</p>\n"}, {"tags": ["testing", "go", "benchmarking"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1447632452, "post_id": 33726201, "comment_id": 55222571, "body": "<a href=\"https://golang.org/pkg/testing/#B.ResetTimer\" rel=\"nofollow noreferrer\">golang.org/pkg/testing/#B.ResetTimer</a> ?"}, {"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447675646, "post_id": 33726201, "comment_id": 55238409, "body": "Thanks for your answer but to recreate the board inside the loop at the beginning of each iteration. By using ResetTimer() I would create an infinite loop since the timer be reset in each iteration and the benchmark never finishes."}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1447709214, "post_id": 33726201, "comment_id": 55258272, "body": "So aside from your current solution, I can only think that all the test data is setup outside of the loop, i.e setup <code>b.N</code> copies which would still require the StopTimer, StartTimer but only once."}, {"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1447711189, "post_id": 33726201, "comment_id": 55259313, "body": "What exactly do you mean with setup b.N copies?"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 1, "creation_date": 1447743075, "post_id": 33726201, "comment_id": 55269299, "body": "@miltonb <code>b.N</code> isn&#39;t a constant, it&#39;s dynamically adjusted based on the benchmark speed so that won&#39;t work."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1447743117, "post_id": 33726201, "comment_id": 55269316, "body": "Though you COULD precompute some suitably large number like 10000 boards and use those."}, {"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1447748041, "post_id": 33726201, "comment_id": 55271601, "body": "@Jsor you mean something like an array with 10000 copies of the board that will the loop will iterate trough?"}], "answers": [{"tags": [], "owner": {"reputation": 1005, "user_id": 166374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6e814af3bff7aaca5d1e2c7b20c7b516?s=128&d=identicon&r=PG", "display_name": "code_martial", "link": "https://stackoverflow.com/users/166374/code-martial"}, "is_accepted": false, "score": 1, "last_activity_date": 1447763165, "creation_date": 1447763165, "answer_id": 33756892, "question_id": 33726201, "link": "https://stackoverflow.com/questions/33726201/how-to-benchmark-if-i-need-a-reset-in-each-iteration/33756892#33756892", "title": "How to benchmark if I need a reset in each iteration?", "body": "<p>You could try providing a <code>func NewBoard([9][9]int) *Board</code> method, which just initializes a board from the example data. Then write a benchmark for <code>Backtrack()</code> on a new board and a separate benchmark for <code>NewBoard()</code>.</p>\n\n<p>Subtracting the two numbers should give you an idea of the speed of your Backtrack method alone.</p>\n\n<pre><code>type Board struct {\n    Cells [9][9]int\n}\n\nvar scratch *Board\n\nfunc NewBoard(cells [9][9]int) *Board {\n    return &amp;Board{Cells: cells}\n}\n\nfunc BenchmarkBacktrack(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        scratch = NewBoard(exampleBoard.Cells)\n        scratch.Backtrack()\n}\n\nfunc BenchmarkNewBoard(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        scratch = NewBoard(exampleBoard.Cells)\n}\n</code></pre>\n\n<p>Also note the use of <code>scratch</code> variable. Trying to create a loop local variable inside the benchmark loop could lead the compiler to optimise away the call to <code>NewBoard()</code> depending on presence/absence of side-effects. For parity, you need to use the <code>scratch</code> variable in both benchmarks.</p>\n"}, {"comments": [{"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1447879748, "post_id": 33758297, "comment_id": 55347166, "body": "I had the same thoughts while reading the docs since the testing package doesn&#39;t offer real alternatives for my usecase."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 1, "last_activity_date": 1447767266, "creation_date": 1447767266, "answer_id": 33758297, "question_id": 33726201, "link": "https://stackoverflow.com/questions/33726201/how-to-benchmark-if-i-need-a-reset-in-each-iteration/33758297#33758297", "title": "How to benchmark if I need a reset in each iteration?", "body": "<blockquote>\n  <p>And wouldn't cost the function calls a small amount of time that that impacts the benchmark?</p>\n</blockquote>\n\n<p>Of course they would. So does the <code>for</code> loop, which is included in the benchmark. Plus overhead of calling <code>copy.Backtrack</code> function. But the thing is, this should be all irrelevant, unless you're benchmarking a single operation taking nanoseconds (in which case you shouldn't). Creation of an empty board is probably a trivial operation, so I wouldn't touch the timers at all. If it's not trivial, then you're doing it right \u2013 call <code>StopTimer</code>. This is exactly why it was invented:</p>\n\n<blockquote>\n  <p>StopTimer stops timing a test. This can be used to pause the timer while performing <strong>complex</strong> initialization that you don't want to measure.</p>\n</blockquote>\n"}], "owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "accepted_answer_id": 33758297, "answer_count": 2, "score": 1, "last_activity_date": 1449485914, "creation_date": 1447628857, "last_edit_date": 1449485914, "question_id": 33726201, "link": "https://stackoverflow.com/questions/33726201/how-to-benchmark-if-i-need-a-reset-in-each-iteration", "title": "How to benchmark if I need a reset in each iteration?", "body": "<p>I've written a small Sudoku solver using backtracking. Now I want to benchmark the speed of this function. Here is my current code:</p>\n\n<pre><code>type Board struct {\n    Cells [9][9]int\n}\n\nfunc BenchmarkBacktrack(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        b.StopTimer()\n        // prevent the modification of the orignal board\n        copy := &amp;Board{\n            Cells: exampleBoard.Cells,\n        }\n        b.StartTimer()\n        copy.Backtrack()\n     }\n}\n</code></pre>\n\n<p>Since <code>&amp;Board</code> is pointer I would solve the Sudoku in the first iteration and in the next one I would backtrack a solved board. Therefore, I reset the board at the beginning of each iteration. <code>exampleBoard</code> is filled with sample values.</p>\n\n<p>Is their a better way to benchmark the function without stopping and restarting the timer over and over?</p>\n\n<p>And wouldn't cost the function calls a small amount of time that impacts the benchmark?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1447627352, "post_id": 33725883, "comment_id": 55221194, "body": "No. Take a look at the chapter &quot;Type Switches&quot; in the language spec."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1447627479, "post_id": 33725883, "comment_id": 55221229, "body": "@Volker The selection of the default case is actually only explained in &quot;Expression switches&quot;."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1447628329, "post_id": 33725883, "comment_id": 55221452, "body": "@Rhymoid: &quot;<a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow noreferrer\">Switch statement</a>: Type switches: A type switch compares types rather than values. It is otherwise similar to an expression switch.&quot; Therefore you should have read the specification for expression switches too."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1447628688, "post_id": 33725883, "comment_id": 55221549, "body": "@peterSO Aside from the questionable structuring of the Go language spec, I believe that an answer, or a comment pretending to be one, should be at least as specific as the question. Referring to the paragraph that doesn&#39;t define what the OP is asking about wouldn&#39;t suffice."}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 7, "last_activity_date": 1447627274, "creation_date": 1447627274, "answer_id": 33725966, "question_id": 33725883, "link": "https://stackoverflow.com/questions/33725883/evaluation-sequence-of-switch-in-go/33725966#33725966", "title": "evaluation sequence of `switch` in `go`", "body": "<p>From <a href=\"http://golangtutorials.blogspot.com/2011/06/control-structures-go-switch-case.html\" rel=\"noreferrer\">this Golang tutorial</a>:</p>\n\n<ul>\n<li>The code block of <code>default</code> is executed if none of the other <code>case</code> blocks match</li>\n<li>the <code>default</code> block can be anywhere within the <code>switch</code> block, and not necessarily last in lexical order</li>\n</ul>\n"}], "owner": {"reputation": 1585, "user_id": 853038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a9773c9d75baea0919e4412aeb4c89f8?s=128&d=identicon&r=PG", "display_name": "Enze Chi", "link": "https://stackoverflow.com/users/853038/enze-chi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 33725966, "answer_count": 1, "score": 3, "last_activity_date": 1447627274, "creation_date": 1447626658, "question_id": 33725883, "link": "https://stackoverflow.com/questions/33725883/evaluation-sequence-of-switch-in-go", "title": "evaluation sequence of `switch` in `go`", "body": "<p>I am learning Go language by reading \"Effective Go\". </p>\n\n<p>I found a example about type switch:</p>\n\n<pre><code>var t interface{}\nt = functionOfSomeType()\nswitch t := t.(type) {\ndefault:\n    fmt.Printf(\"unexpected type %T\\n\", t)     // %T prints whatever type t has\ncase bool:\n    fmt.Printf(\"boolean %t\\n\", t)             // t has type bool\ncase int:\n    fmt.Printf(\"integer %d\\n\", t)             // t has type int\ncase *bool:\n    fmt.Printf(\"pointer to boolean %t\\n\", *t) // t has type *bool\ncase *int:\n    fmt.Printf(\"pointer to integer %d\\n\", *t) // t has type *int\n}\n</code></pre>\n\n<p>My understanding is the cases in <code>switch</code> is evaluated from top to bottom and stop at a match condition. So isn't the example about would always stop at <code>default</code> and print \"unexpected type ...\"?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447624408, "post_id": 33725476, "comment_id": 55220353, "body": "Use Go&#39;s <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">html/template</a> package: don&#39;t print unescaped text to the response. You can call <code>range</code> in the template to populate a HTML checkbox with the current <code>.AnswerID</code> as the name, <code>.AnswerText</code> as the label and <code>.Selected</code> as the value."}], "answers": [{"comments": [{"owner": {"reputation": 1282, "user_id": 2697892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e038e8f4258c96427f6af482bf6f0202?s=128&d=identicon&r=PG&f=1", "display_name": "Stu1986C", "link": "https://stackoverflow.com/users/2697892/stu1986c"}, "edited": false, "score": 0, "creation_date": 1447625588, "post_id": 33725654, "comment_id": 55220725, "body": "Nice. Didn&#39;t answer my question but certainly improved by code. Thanks! :)"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 1282, "user_id": 2697892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e038e8f4258c96427f6af482bf6f0202?s=128&d=identicon&r=PG&f=1", "display_name": "Stu1986C", "link": "https://stackoverflow.com/users/2697892/stu1986c"}, "edited": false, "score": 0, "creation_date": 1447627268, "post_id": 33725654, "comment_id": 55221175, "body": "@Stu1986C Thought I couldn&#39;t type the code in the comment. Will check back on the question if it hasn&#39;t been answered."}, {"owner": {"reputation": 1282, "user_id": 2697892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e038e8f4258c96427f6af482bf6f0202?s=128&d=identicon&r=PG&f=1", "display_name": "Stu1986C", "link": "https://stackoverflow.com/users/2697892/stu1986c"}, "edited": false, "score": 0, "creation_date": 1447949678, "post_id": 33725654, "comment_id": 55383295, "body": "Thanks @pie-o-pah I&#39;ll take a look tonight to see how it works and let you know."}, {"owner": {"reputation": 1282, "user_id": 2697892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e038e8f4258c96427f6af482bf6f0202?s=128&d=identicon&r=PG&f=1", "display_name": "Stu1986C", "link": "https://stackoverflow.com/users/2697892/stu1986c"}, "edited": false, "score": 0, "creation_date": 1448485922, "post_id": 33725654, "comment_id": 55613839, "body": "I took my time getting to trying this out but it worked a treat. Thanks @pie-o-pah!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 1, "last_activity_date": 1447794784, "last_edit_date": 1447794784, "creation_date": 1447624973, "answer_id": 33725654, "question_id": 33725476, "link": "https://stackoverflow.com/questions/33725476/create-checkbox-group-from-slice/33725654#33725654", "title": "Create Checkbox Group from Slice", "body": "<p>First, here is what you can do to improve the code</p>\n\n<pre><code>Type Answers []Answer\n\ntype Question struct {\n    QuestionId int\n    // Question is not an \"Answers\" but has \"Answers\"\n    Answers Answers\n    QuestionText string\n}\n</code></pre>\n\n<p>Instead of using embedded type to represent \"IS-A\" relationship, having an attribute of type Answers should be more appropriate and to avoid complex struct definition.</p>\n\n<p>Now here is what your <code>viewHandler</code> might look like:</p>\n\n<pre><code>func ViewHandler(w http.ResponseWriter, r *http.Request) {\n\n    // This should be loaded from another template file\n    const tpl = `\n    &lt;!DOCTYPE html&gt;\n    &lt;html&gt;\n    &lt;body&gt;\n        &lt;form action=\"demo\" method=\"POST\"&gt;\n            &lt;!-- Once the pagedata struct exists in the context,\n             we can query its field value with dot notation --&gt;\n            &lt;h3&gt;{{.QuestionText}}&lt;/h3&gt;\n            {{range .Answers}}\n                &lt;input type=\"radio\" name=\"\" {{if .Selected}}checked{{end}}\n                &gt;{{.AnswerText}}&lt;br&gt;\n            {{end}}\n        &lt;/section&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n    `\n\n    t, _ := template.New(\"questionaire\").Parse(tpl)\n\n    pagedata, _ := loadPage()\n\n    // Pass in the data struct\n    _ = t.Execute(w, pagedata)\n}\n</code></pre>\n\n<p>You just have to parse the template, then with <code>Execute</code> pass the data struct you want its data available in the context of the response. </p>\n\n<p>See the full code here <a href=\"https://play.golang.org/p/6PbX6YsLNt\" rel=\"nofollow\">https://play.golang.org/p/6PbX6YsLNt</a></p>\n"}], "owner": {"reputation": 1282, "user_id": 2697892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e038e8f4258c96427f6af482bf6f0202?s=128&d=identicon&r=PG&f=1", "display_name": "Stu1986C", "link": "https://stackoverflow.com/users/2697892/stu1986c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 33725654, "answer_count": 1, "score": 0, "last_activity_date": 1447794784, "creation_date": 1447623887, "question_id": 33725476, "link": "https://stackoverflow.com/questions/33725476/create-checkbox-group-from-slice", "title": "Create Checkbox Group from Slice", "body": "<p>I'm starting out with Go and therefore this may be a simple answer but I can't find it on the net so far.</p>\n\n<p>I have the following structs:</p>\n\n<pre><code>type Answer struct {\n    AnswerId   int\n    AnswerText string\n    Selected   bool\n}\n\ntype Answers struct {\n    answers []Answer\n}\n\ntype Question struct {\n    QuestionId int\n    Answers\n    QuestionText string\n}\n</code></pre>\n\n<p>This is a simple look of the domain model that backs a web app for a questionnaire.</p>\n\n<pre><code>func loadPage() (*Question, error) {\n    return &amp;Question{\n        QuestionId:   321,\n        QuestionText: \"What's the answer?\",\n        Answers: Answers{\n            answers: []Answer{\n                Answer{\n                    AnswerId:   1,\n                    AnswerText: \"Answer number 1\",\n                    Selected:   false,\n                },\n                Answer{\n                    AnswerId:   2,\n                    AnswerText: \"Answer number 2\",\n                    Selected:   false,\n                },\n            },\n        },\n    }, nil\n}\n</code></pre>\n\n<p>Here you can see that I've stubbed out a Question with a few answers. This has been stubbed just so I can send something to the view.</p>\n\n<pre><code>func viewHandler(w http.ResponseWriter, r *http.Request) {\n    p, _ := loadPage()\n    fmt.Fprintf(w, for _,element := range p.Answers.answers {\n      //Do something with each element in answers\n    })\n}\n</code></pre>\n\n<p>This is where I'm stuck; my <code>viewHandler</code>. What is the syntax that will allow me to create a checkbox group based upon the contents of my <code>answers</code> slice? Any help will be gratefully received.</p>\n"}, {"tags": ["multithreading", "go", "fibers"], "comments": [{"owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1447615498, "post_id": 33723781, "comment_id": 55217300, "body": "Also, as an addition... A piece of code I wrote spawns off one thread per a core to wait for incoming socket connections. Upon receiving a connection request, a new thread is created by the thread that receives the request, and control of the fd is passed to that thread to handle the connection. At the same time, the worker threads are used to handle rw locks on a data structure in controls the job execution of the threads... Are the threads created by my schedulers worker threads considered &quot;fibers,&quot; or &quot;threads&quot; ? To reiterate: is a fiber just a thread controlled in the manner I described?"}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 1, "creation_date": 1447616330, "post_id": 33723781, "comment_id": 55217598, "body": "I think the definition that fibers are system level just isn&#39;t factual... co-routines and fibers could be included or excluded from your system... or be the same thing, also go could implement them differently on a Mac, and a windows box or a BeOS, or on an embedded RTOS, I don&#39;t think it is a useful conversation as broad as your questions are... In a normal POSIX system there are Processes, and Threads, but fibers are user land scheduling implementations..."}, {"owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "reply_to_user": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1447616727, "post_id": 33723781, "comment_id": 55217741, "body": "When you say &quot;user land scheduling implementations,&quot; is that to say a fiber would not be a POSIX thread that&#39;s controlled by a user land scheduler? Or would a fiber actually be a POSIX thread that&#39;s simply controlled by a scheduler implemented in user land?   The confusion comes in to play that my colleague insists a fiber would not in any way, shape or form be a POSIX thread that the underlying OS could even possibly see, and that it would be completely invisible to the OS/Kernel. My understanding is that it would, for instance, be a POSIX thread - but controlled by user land."}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 1, "creation_date": 1447617755, "post_id": 33723781, "comment_id": 55218116, "body": "fibers could be scheduled to run on one worker thread, but technically a fiber could possibly start on one thread, and yield, then be rejoined on a different thread, (there aren&#39;t any C standard, or Posix library fibers so the semantics are loose)"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447624546, "post_id": 33723781, "comment_id": 55220402, "body": "Note that a POSIX thread (by its definition) can&#39;t be controlled from user land. If it is, it&#39;s not a POSIX thread. Userland threads are typically called &#39;green threads&#39; (sometimes called &#39;fibers&#39;, as you&#39;re finding)."}, {"owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "edited": false, "score": 0, "creation_date": 1447768928, "post_id": 33723781, "comment_id": 55285143, "body": "So, on that note, am I correct in saying something like a coroutine could be dubbed a &quot;fiber&quot; ?"}], "owner": {"reputation": 180, "user_id": 5565110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fb39d1c89ba9883b693075c1fad580?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Whatshisface", "link": "https://stackoverflow.com/users/5565110/jonny-whatshisface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1595523289, "creation_date": 1447614710, "last_edit_date": 1595523289, "question_id": 33723781, "link": "https://stackoverflow.com/questions/33723781/threads-fibers-clarification", "title": "Threads / Fibers - Clarification", "body": "<p>I'm a bit confused regarding the concept of \"fibers\" as to their relation to 1) threads and 2) what they're seen as by the Kernel.</p>\n\n<p>To my understanding, a fiber is a thread that was created by a thread, and managed by its creating thread (i.e. perhaps a scheduler?). However, for all intensive purposes, I'd consider it as still being a \"thread\" and seen by the kernel as such. </p>\n\n<p>The explanation I'm receiving from a colleague is that fibers are completely invisible to the kernel and run entirely in user space, and are in no way \"threads\", as per his email here:</p>\n\n<blockquote>\n  <p>Threads are sometimes implemented in userspace libraries, thus called\n  user threads. The kernel is unaware of them, so they are managed and\n  scheduled in userspace. Some implementations base their user threads\n  on top of several kernel threads, to benefit from multi-processor\n  machines (M:N model). In this article the term \"thread\" (without\n  kernel or user qualifier) defaults to referring to kernel threads.\n  User threads as implemented by virtual machines are also called green\n  threads. User threads are generally fast to create and manage, but\n  cannot take advantage of multithreading or multiprocessing, and will\n  get blocked if all of their associated kernel threads get blocked even\n  if there are some user threads that are ready to run.</p>\n  \n  <p>Fibers are an even lighter unit of scheduling which are cooperatively\n  scheduled: a running fiber must explicitly \"yield\" to allow another\n  fiber to run, which makes their implementation much easier than kernel\n  or user threads. A fiber can be scheduled to run in any thread in the\n  same process. This permits applications to gain performance\n  improvements by managing scheduling themselves, instead of relying on\n  the kernel scheduler (which may not be tuned for the application).\n  Parallel programming environments such as OpenMP typically implement\n  their tasks through fibers. Closely related to fibers are coroutines,\n  with the distinction being that coroutines are a language-level\n  construct, while fibers are a system-level construct.</p>\n</blockquote>\n\n<p>I'm hoping to get a little bit of a better explanation in terms of exactly what a fiber is (is it an actual thread as far as the os/kernel are concerned, and simply managed by its creating thread?). </p>\n\n<p>I've researched it extensively via Google searches, but have only found one simple answer everywhere I've looked, including here: \"A fiber is a thread that's created and managed by a thread.\"</p>\n\n<p>If anyone has anything more informative they can share or point me to, it would be greatly appreciated. My colleagues argument is that Golang's Goroutines use \"fibers\" and those fibers are invisible to the OS - thus, a \"correct\" implementation of fibers. I, personally, feel that Goroutines are more closely related to coroutines, and do not implement a fiber/thread scenario at all... </p>\n"}, {"tags": ["testing", "go", "command-line-arguments"], "comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 3, "creation_date": 1447613322, "post_id": 33723300, "comment_id": 55216530, "body": "Have you tried <code>os.Args = []string{&quot;cmd&quot;, &quot;-user=bla&quot;}</code>? Remember the very first value in <code>os.Args</code> is a (path to) executable itself."}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447613487, "post_id": 33723300, "comment_id": 55216593, "body": "@tomasz This works. Thank you. <code>args_test.go:16: Test failed, expected: &#39;bla&#39;, got:  &#39;bla2&#39;</code>"}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447613808, "post_id": 33723300, "comment_id": 55216707, "body": "@tomasz Could you post your comment as an answer as it answers the question"}], "answers": [{"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 23, "last_activity_date": 1447613942, "creation_date": 1447613942, "answer_id": 33723649, "question_id": 33723300, "link": "https://stackoverflow.com/questions/33723300/how-to-test-the-passing-of-arguments-in-golang/33723649#33723649", "title": "How to test the passing of arguments in Golang?", "body": "<p>Per my comment, the very first value in <code>os.Args</code> is a (path to) executable itself, so <code>os.Args = []string{\"cmd\", \"-user=bla\"}</code> should fix your issue. You can take a look at <a href=\"https://golang.org/src/flag/flag_test.go#L318\" rel=\"noreferrer\">flag test</a> from the standard package where they're doing something similar.</p>\n\n<p>Also, as <code>os.Args</code> is a \"global variable\", it might be a good idea to keep the state from before the test and restore it after. Similarly to the linked test:</p>\n\n<pre><code>oldArgs := os.Args\ndefer func() { os.Args = oldArgs }()\n</code></pre>\n\n<p>This might be useful where other tests are, for example, examining the real arguments passed when evoking <code>go test</code>.</p>\n"}], "owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11405, "favorite_count": 3, "accepted_answer_id": 33723649, "answer_count": 1, "score": 15, "last_activity_date": 1447613942, "creation_date": 1447611905, "last_edit_date": 1447612928, "question_id": 33723300, "link": "https://stackoverflow.com/questions/33723300/how-to-test-the-passing-of-arguments-in-golang", "title": "How to test the passing of arguments in Golang?", "body": "<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n)\n\nfunc main() {\n    passArguments()\n}\n\nfunc passArguments() string {\n    username := flag.String(\"user\", \"root\", \"Username for this server\")\n    flag.Parse()\n    fmt.Printf(\"Your username is %q.\", *username)\n\n    usernameToString := *username\n    return usernameToString\n}\n</code></pre>\n\n<p>Passing an argument to the compiled code:</p>\n\n<p><code>./args -user=bla</code></p>\n\n<p>results in:</p>\n\n<p><code>Your username is \"bla\"</code></p>\n\n<p>the username that has been passed is displayed. </p>\n\n<hr>\n\n<p><strong>Aim:</strong> in order to prevent that the code needs to be build and run manually every time to test the code the aim is to write a test that is able to test the passing of arguments.</p>\n\n<hr>\n\n<p><strong>Attempt</strong></p>\n\n<p>Running the following test:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"testing\"\n)\n\nfunc TestArgs(t *testing.T) {\n    expected := \"bla\"\n    os.Args = []string{\"-user=bla\"}\n\n    actual := passArguments()\n\n    if actual != expected {\n        t.Errorf(\"Test failed, expected: '%s', got:  '%s'\", expected, actual)\n    }\n}\n</code></pre>\n\n<p>results in:</p>\n\n<pre><code>Your username is \"root\".Your username is \"root\".--- FAIL: TestArgs (0.00s)\n    args_test.go:15: Test failed, expected: 'bla', got:  'root'\nFAIL\ncoverage: 87.5% of statements\nFAIL    tool    0.008s\n</code></pre>\n\n<p><strong>Problem</strong></p>\n\n<p>It looks like that the <code>os.Args = []string{\"-user=bla</code> is not able to pass this argument to the function as the outcome is <code>root</code> instead of <code>bla</code></p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 6953, "user_id": 4541045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfffa01cff641ad93fa459b26d3cdb4?s=128&d=identicon&r=PG&f=1", "display_name": "ti7", "link": "https://stackoverflow.com/users/4541045/ti7"}, "edited": false, "score": 1, "creation_date": 1447609867, "post_id": 33722647, "comment_id": 55215413, "body": "Variables denoted with a * are pointers, or an address in memory (think of it as a mailing address where a variable is a house). Refer to <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/1</a> for more."}], "answers": [{"tags": [], "owner": {"reputation": 18961, "user_id": 1094941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4gVU2.jpg?s=128&g=1", "display_name": "mna", "link": "https://stackoverflow.com/users/1094941/mna"}, "is_accepted": true, "score": 8, "last_activity_date": 1447610320, "creation_date": 1447610320, "answer_id": 33723014, "question_id": 33722647, "link": "https://stackoverflow.com/questions/33722647/what-are-the-differences-between-a-string-and-a-string-in-golang/33723014#33723014", "title": "What are the differences between a *string and a string in Golang?", "body": "<p>A <code>*string</code> is a pointer to a string. If you're not familiar with pointers, let's just say that it's a value that holds the address of another value, instead of the value itself (it's a level of indirection).</p>\n\n<p>When a <code>*</code> is used in a type, it denotes a pointer to that type. <code>*int</code> is a pointer to an integer. <code>***bool</code> is a pointer to a pointer to a pointer to a bool.</p>\n\n<p><code>flag.String</code> returns a pointer to a string because it it can then modify the string value (after the call to <code>flag.Parse</code>) and you are able to retrieve that value using the dereference operator - that is, when using <code>*</code> on a variable, it <em>dereferences</em> it, or retrieves the value pointed to instead of the value of the variable itself (which in the case of a pointer would just be a memory address).</p>\n\n<p>So to answer your specific questions:</p>\n\n<ol>\n<li><p>the <code>%q</code> verb in the <code>fmt</code> package understands strings (and slices of bytes), not pointers, hence the apparent gibberish displayed (when a value is not of the expected type for the matching verb - here <code>%q</code> - the <code>fmt</code> functions display <code>%!q</code> along with the actual type and value passed)</p></li>\n<li><p>A pointer to a string is very rarely used. A string in Go is immutable (<a href=\"https://golang.org/ref/spec#String_types\" rel=\"noreferrer\">https://golang.org/ref/spec#String_types</a>) so in cases like <code>flag.String</code> where you need to return a string that will be mutated later on, you have to return a pointer to a string. But you won't see that very often in idiomatic Go.</p></li>\n<li><p>You are not assigning a <code>*string</code> (pointer to a string) to a <code>string</code>. What you are doing, as I mentioned earlier, is <strong>dereferencing</strong> the <code>*string</code> variable, extracting its <code>string</code> value. So you are in fact assigning a <code>string</code> to a <code>string</code>. Try removing the <code>*</code> on that line, you'll see the compiler error message. (actually, because you're using the short variable declaration notation, <code>:=</code>, you won't see a compiler error, but your variable will be declared as a pointer-to-a-string. Try this instead, to better understand what's going on:</p>\n\n<pre><code>var s string\ns = username\n</code></pre></li>\n</ol>\n\n<p>That will raise the compiler error).</p>\n"}], "owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3418, "favorite_count": 0, "accepted_answer_id": 33723014, "answer_count": 1, "score": 7, "last_activity_date": 1447610685, "creation_date": 1447608549, "last_edit_date": 1447610685, "question_id": 33722647, "link": "https://stackoverflow.com/questions/33722647/what-are-the-differences-between-a-string-and-a-string-in-golang", "title": "What are the differences between a *string and a string in Golang?", "body": "<p><strong>Aim:</strong> understanding the difference between <code>*string</code> and <code>string</code> in Golang</p>\n\n<hr>\n\n<p><strong>Attempt</strong></p>\n\n<pre><code>func passArguments() {\n    username := flag.String(\"user\", \"root\", \"Username for this server\")\n    flag.Parse()\n    fmt.Printf(\"Your username is %q.\", *username)\n    fmt.Printf(\"Your username is %q.\", username)\n}\n</code></pre>\n\n<p>results in:</p>\n\n<pre><code>Your username is \"root\".Your username is %!q(*string=0xc820072200)\n</code></pre>\n\n<p>but when the *string is assigned to a string:</p>\n\n<pre><code>bla:=*username\nfmt.Printf(\"Your username is %q.\", bla)\n</code></pre>\n\n<p>it is able to print the string again:</p>\n\n<pre><code>Your username is \"root\".Your username is %!q(*string=0xc8200781f0).Your username is \"root\".\n</code></pre>\n\n<hr>\n\n<p><strong>Questions</strong></p>\n\n<ol>\n<li>Why is a *string != string, e.g. display of: <code>\"root\"</code> vs.\n<code>%!q(*string=0xc8200781f0)</code>? </li>\n<li>In what other cases should a *string be\nused instead of a string and why? </li>\n<li>Why is it possible to assign a\n*string to a string variable, while the display of the string is different, e.g. display of: <code>\"root\"</code> vs.\n<code>%!q(*string=0xc8200781f0)</code>?</li>\n</ol>\n"}, {"tags": ["post", "curl", "go", "httpserver", "dhclient"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447607074, "post_id": 33722090, "comment_id": 55214336, "body": "What is the problem? Where is your code?"}, {"owner": {"reputation": 1183, "user_id": 2644513, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/yNtHc.jpg?s=128&g=1", "display_name": "Itachi", "link": "https://stackoverflow.com/users/2644513/itachi"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447608183, "post_id": 33722090, "comment_id": 55214765, "body": "@AmitKumarGupta Please let me know what else u need. I thought there is some extra header added by rest clients since cURL worked. I don&#39;t think anything wrong with the code that is why didn&#39;t paste the code."}, {"owner": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "edited": false, "score": 0, "creation_date": 1447608416, "post_id": 33722090, "comment_id": 55214858, "body": "Try running curl as verbose with --verbose to see exactly waht it&#39;s sending."}], "answers": [{"comments": [{"owner": {"reputation": 1183, "user_id": 2644513, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/yNtHc.jpg?s=128&g=1", "display_name": "Itachi", "link": "https://stackoverflow.com/users/2644513/itachi"}, "edited": false, "score": 0, "creation_date": 1447608737, "post_id": 33722676, "comment_id": 55214986, "body": "curl -X POST -d@&quot;Screen Shot 2015-11-15 at 6.09.58 pm.png&quot; <a href=\"http://localhost:8000/image/agentId/property\" rel=\"nofollow noreferrer\">localhost:8000/image/agentId/property</a> --header &quot;Content-Type:image/png&quot; --header &quot;X-User-Agent:agent-php&quot; {&quot;fileURL&quot;:&quot;<a href=\"http://testing.com\" rel=\"nofollow noreferrer\">testing.com</a>&quot;}%"}, {"owner": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "reply_to_user": {"reputation": 1183, "user_id": 2644513, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/yNtHc.jpg?s=128&g=1", "display_name": "Itachi", "link": "https://stackoverflow.com/users/2644513/itachi"}, "edited": false, "score": 0, "creation_date": 1447609043, "post_id": 33722676, "comment_id": 55215107, "body": "@Itachi I&#39;m still not convinced it&#39;s doing what you think it&#39;s doing, nonetheless you have to provide the route/receiving code if you want debugging help."}, {"owner": {"reputation": 1183, "user_id": 2644513, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/yNtHc.jpg?s=128&g=1", "display_name": "Itachi", "link": "https://stackoverflow.com/users/2644513/itachi"}, "edited": false, "score": 0, "creation_date": 1447609777, "post_id": 33722676, "comment_id": 55215383, "body": "Have added the request processing function. Are the information enough ?"}], "tags": [], "owner": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "is_accepted": false, "score": -1, "last_activity_date": 1447608870, "last_edit_date": 1447608870, "creation_date": 1447608668, "answer_id": 33722676, "question_id": 33722090, "link": "https://stackoverflow.com/questions/33722090/curl-works-but-none-of-the-rest-clients-with-go-sebserver/33722676#33722676", "title": "cURL works but none of the rest clients with Go sebserver", "body": "<p>I do not believe you're doing what you think you are.</p>\n\n<pre><code>curl -X POST -d \"Screen Shot 2015-11-15 at 6.09.58 pm.png\" http://localhost:8000/image/agent123/property --header \"Content-Type:image/png\" --header \"X-User-Agent:agent-php\" \n</code></pre>\n\n<p>Will not send the file \"Screen Shot 2015-11-15 at 6.09.58 pm.png\", it's gonig to send the literal text as the body. You probably want \"-d @'Screen Shot 2015-11-15 at 6.09.58 pm.png'\".</p>\n\n<p>Which then your \"good\" result is not exactly good, so you have to figure out what the bug is at the receiving end on the server. As the GUI client you're using is probably sending the file, whereas cURL is not. And your backend seems to accept text, not files. </p>\n"}], "owner": {"reputation": 1183, "user_id": 2644513, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/yNtHc.jpg?s=128&g=1", "display_name": "Itachi", "link": "https://stackoverflow.com/users/2644513/itachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447613181, "creation_date": 1447605403, "last_edit_date": 1447613181, "question_id": 33722090, "link": "https://stackoverflow.com/questions/33722090/curl-works-but-none-of-the-rest-clients-with-go-sebserver", "title": "cURL works but none of the rest clients with Go sebserver", "body": "<p>Having a simple GO WebServer which accepts an image as part of POST request. </p>\n\n<p>Code snippet - Request is mapped to this function</p>\n\n<pre><code> func UploadFile(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n        successResponse := models.HTTPResponse {\n            FileURL:\"http://testing.com\",\n        }\n        WrapResponse(w, successResponse, http.StatusOK)\n    }\n</code></pre>\n\n<p>Response writer function</p>\n\n<pre><code>func WrapResponse(writer http.ResponseWriter, content interface{}, status int) {    \n    writer.Header().Set(\"Content-Type\", \"application/json\")\n    writer.WriteHeader(status)\n    // Content is a struct Response { fileURL string }  \n    responseJson, err := json.Marshal(content)  \n    CheckError(err, \"Error wrapping response\")  \n    writer.Write(responseJson) \n    }\n\n    func CheckError(err error, msg string) {    \n    if err != nil {         \n    panic(fmt.Sprintf(\"%s : %s\", msg, err))     \n    } \n    }\n</code></pre>\n\n<p>When i hit the URL using cURL as below the response is 200 OK (as expected)</p>\n\n<blockquote>\n  <p>curl -X POST -d@ \"Screen Shot 2015-11-15 at 6.09.58 pm.png\"\n  <a href=\"http://localhost:8000/image/agent123/property\" rel=\"nofollow noreferrer\">http://localhost:8000/image/agent123/property</a> --header \"Content-Type:image/png\"\n  --header \"X-User-Agent:agent-php\"  response -->{\"fileURL\":\"<a href=\"http://testing.com\" rel=\"nofollow noreferrer\">http://testing.com</a>\"}%</p>\n</blockquote>\n\n<p>Entire cURL request &amp; response \n<a href=\"https://i.stack.imgur.com/lIoO1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lIoO1.png\" alt=\"Verbose\"></a></p>\n\n<p>But when i try the same from DHC rest client, have also tried with advanced rest client getting no response. </p>\n\n<p><a href=\"https://i.stack.imgur.com/gL5Ip.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gL5Ip.png\" alt=\"Same request via DHC\"></a></p>\n\n<p>Edit 1: Request does reach the server when fired from rest clients</p>\n"}, {"tags": ["go", "arguments", "command-line-arguments"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1447602948, "creation_date": 1447602948, "answer_id": 33721664, "question_id": 33721620, "link": "https://stackoverflow.com/questions/33721620/what-is-the-most-concise-way-of-passing-named-arguments-to-a-golang-tool-and-to/33721664#33721664", "title": "What is the most concise way of passing named arguments to a Golang tool and to use them?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow\">Package flag</a></p>\n\n<pre><code>import \"flag\" \n</code></pre>\n  \n  <p>Package flag implements command-line flag parsing.</p>\n</blockquote>\n\n<p>Try the <code>flag</code> and other similar packages.</p>\n"}], "owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 1, "accepted_answer_id": 33721664, "answer_count": 1, "score": 1, "last_activity_date": 1447602948, "creation_date": 1447602652, "question_id": 33721620, "link": "https://stackoverflow.com/questions/33721620/what-is-the-most-concise-way-of-passing-named-arguments-to-a-golang-tool-and-to", "title": "What is the most concise way of passing named arguments to a Golang tool and to use them?", "body": "<p><strong>Aim:</strong> to pass named arguments to a Golang tool and to use the passed arguments as variables</p>\n\n<hr>\n\n<p><strong>Attempt</strong></p>\n\n<p>Compiling the <a href=\"https://gobyexample.com/command-line-arguments\" rel=\"nofollow\">following example</a>:</p>\n\n<blockquote>\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"os\"\n)\n\nfunc main() {\n  argsWithProg := os.Args\n  argsWithoutProg := os.Args[1:]\n  arg := os.Args[3]\n\n  fmt.Println(argsWithProg)\n  fmt.Println(argsWithoutProg)\n  fmt.Println(arg)\n}\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>build it and pass arguments, e.g.: <code>./args -a=1 -b=2 -c=3 -d=4 -e=5 -f=6</code>, results in:</p>\n\n<pre><code>[./args -a=1 -b=2 -c=3 -d=4 -e=5 -f=6]\n[-a=1 -b=2 -c=3 -d=4 -e=5 -f=6]\n-c=3\n</code></pre>\n\n<p>Based on this answer, the following snippet was added to the example:</p>\n\n<pre><code>s := strings.Split(arg, \"=\")\nvariable, value := s[0], s[1]\nfmt.Println(variable, value)\n</code></pre>\n\n<p>and after building it and passing arguments the output is as follows:</p>\n\n<pre><code>[./args -a=1 -b=2 -c=3 -d=4 -e=5 -f=6]\n[-a=1 -b=2 -c=3 -d=4 -e=5 -f=6]\n-c=3\n-c 3\n</code></pre>\n\n<p><strong>Question</strong></p>\n\n<p>Although the aim has been accomplished I wonder whether this is the most concise way to pass named arguments and to use them in Golang.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 2, "creation_date": 1447590763, "post_id": 33719671, "comment_id": 55209370, "body": "Works flawlessly for me. Please show your directory structure and the commands you used for building it."}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1447593257, "post_id": 33719671, "comment_id": 55210119, "body": "The filepath is c:\\project\\main.go and I try and run it with the command go.exe run c:\\project\\main.go. It just hangs."}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1447593458, "post_id": 33719671, "comment_id": 55210176, "body": "The EOL characters are just line-feeds."}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1447594573, "post_id": 33719671, "comment_id": 55210482, "body": "Not sure what could be happening but since you are using c:\\project as your project directory I would recommend you to read this <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1447630819, "post_id": 33719671, "comment_id": 55222154, "body": "In your question, you say you&#39;re running &quot;go.exe run main.go&quot;, in the comments &quot;go.exe run c:\\project\\main.go&quot;, and in the attached image &quot;go run main.go&quot;.  Not sure where to start with this."}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "edited": false, "score": 0, "creation_date": 1447631045, "post_id": 33719671, "comment_id": 55222214, "body": "Hi I tried both &quot;go.exe run c:\\project\\main.go&quot; and &quot;go run main.go&quot; from the project folder. Before I ran these commands I ran &quot;cd c:\\project&quot; in the command prompt. Go.exe has been set as a PATH variable so I can use either go or go.exe."}, {"owner": {"reputation": 1, "user_id": 9764190, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vRxN-0NzTYk/AAAAAAAAAAI/AAAAAAAAyFQ/A0ZBiuoOtw4/photo.jpg?sz=128", "display_name": "Naman Lashkari", "link": "https://stackoverflow.com/users/9764190/naman-lashkari"}, "edited": false, "score": 0, "creation_date": 1579726998, "post_id": 33719671, "comment_id": 105871887, "body": "few primary checks that could also cause such error are 1. saving the main file. 2. run &quot;go install&quot; on the terminal you are from which you are running the code. let me know if any of this helps."}], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "edited": false, "score": 1, "creation_date": 1447661226, "post_id": 33728186, "comment_id": 55230385, "body": "I&#39;m using windows 10. I followed your instructions and it doesnt print anything to the command prompt. I have gopath set to &quot;set GOPATH=C:\\project&quot; so the file was stored in &quot;c:\\project\\sample\\main.go&quot;"}, {"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 0, "creation_date": 1447662023, "post_id": 33728186, "comment_id": 55230699, "body": "mkdir, cd and ~ are not things in Windows world, as far as I know."}, {"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "reply_to_user": {"reputation": 1061, "user_id": 4935297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9aafed331b6b2c6e3b9d72d2c239c47a?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/4935297/arjun"}, "edited": false, "score": 0, "creation_date": 1447669948, "post_id": 33728186, "comment_id": 55235115, "body": "@Arjun PowerShell only, it seems <a href=\"http://superuser.com/questions/332871/what-is-the-equivalent-of-linuxs-tilde-in-windows\" title=\"what is the equivalent of linuxs tilde in windows\">superuser.com/questions/332871/&hellip;</a>"}, {"owner": {"reputation": 1061, "user_id": 4935297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9aafed331b6b2c6e3b9d72d2c239c47a?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun", "link": "https://stackoverflow.com/users/4935297/arjun"}, "reply_to_user": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 0, "creation_date": 1447670166, "post_id": 33728186, "comment_id": 55235231, "body": "@PatrickCollins Oops! I did not know that. Thanks! :) But cd, mkdir are supported."}], "tags": [], "owner": {"reputation": 385, "user_id": 5252581, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7c5172b819057de36d2db9636712d2c5?s=128&d=identicon&r=PG&f=1", "display_name": "jojo", "link": "https://stackoverflow.com/users/5252581/jojo"}, "is_accepted": false, "score": 1, "last_activity_date": 1447645441, "creation_date": 1447645441, "answer_id": 33728186, "question_id": 33719671, "link": "https://stackoverflow.com/questions/33719671/golang-hello-world-doesnt-print-to-screen-and-program-doesnt-exit/33728186#33728186", "title": "Golang: Hello world doesn&#39;t print to screen and program doesnt exit", "body": "<p>Create a folder named ~/sample (Where ~ means your home directory)\nFrom the terminal you can do this by entering the following commands:</p>\n\n<pre><code>mkdir sample\n</code></pre>\n\n<p>Below program for hello world display</p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main() {\nfmt.Println(\"Hello World\")\n}\n</code></pre>\n\n<p>save it as main.go in the folder we just created.\nOpen up a new terminal and type in the following:</p>\n\n<pre><code>cd sample\ngo run main.go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1336, "user_id": 152946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1d37642fdaa1662ff46e4c65731e9ab?s=128&d=identicon&r=PG", "display_name": "Charles Oliver Nutter", "link": "https://stackoverflow.com/users/152946/charles-oliver-nutter"}, "is_accepted": false, "score": 2, "last_activity_date": 1575556600, "creation_date": 1575556600, "answer_id": 59197470, "question_id": 33719671, "link": "https://stackoverflow.com/questions/33719671/golang-hello-world-doesnt-print-to-screen-and-program-doesnt-exit/59197470#59197470", "title": "Golang: Hello world doesn&#39;t print to screen and program doesnt exit", "body": "<p>I ran into this same problem on a Windows 10 system. Running <code>go run main.go</code> would not print anything, while <code>go build main.go</code> followed by <code>.\\main.exe</code> would work correctly and print out \"hello, world\".</p>\n\n<p>The problem was due to the Comodo antivirus software quarantining the go.exe process as part of its <a href=\"https://containment.comodo.com/how-it-works/\" rel=\"nofollow noreferrer\">Auto Containment</a> feature. I believe the <code>go run</code> command compiles and tries to load the executable binary code of main.go into the same process, which triggers the Auto Containment to isolate the output of the application.</p>\n\n<p>The initial fix was to disable Auto Containment via the Comodo Antivirus settings. Upon disabling this feature, <code>go run main.go</code> began to work properly.</p>\n\n<p>The permanent fix was to <a href=\"https://help.comodo.com/topic-399-1-790-10386-.html\" rel=\"nofollow noreferrer\">add an \"ignore\" rule</a> for the go.exe executable. This allows the Auto Containment feature to be enabled but <code>go run</code> to work properly.</p>\n"}], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4448, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1579726998, "creation_date": 1447590612, "last_edit_date": 1447669192, "question_id": 33719671, "link": "https://stackoverflow.com/questions/33719671/golang-hello-world-doesnt-print-to-screen-and-program-doesnt-exit", "title": "Golang: Hello world doesn&#39;t print to screen and program doesnt exit", "body": "<p>When I run the following code with the command \"go.exe run main.go\", the program doesnt print text to the screen or exit. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\n    fmt.Println(\"Hello world\")\n}\n</code></pre>\n\n<p>go.exe version = go version go.1.5.1 windows/amd64</p>\n\n<p>set GOARCH=386</p>\n\n<p>set GOBIN=</p>\n\n<p>set GOEXE=.exe</p>\n\n<p>set GOHOSTARCH=386</p>\n\n<p>set GOHOSTOS=windows</p>\n\n<p>set GOOS=windows</p>\n\n<p>set GOPATH=C:\\project</p>\n\n<p>set GORACE=</p>\n\n<p>set GOROOT=C:\\Go</p>\n\n<p>set GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_386</p>\n\n<p>set GO15VENDOREXPERIMENT=</p>\n\n<p>set CC=gcc</p>\n\n<p>set GOGCCFLAGS=-m32 -mthreads -fmessage-length=0</p>\n\n<p>set CXX=g++</p>\n\n<p>set CGO_ENABLED=1</p>\n\n<p>Any ideas what's wrong?</p>\n\n<p>Thanks</p>\n\n<p>EDIT:</p>\n\n<p>I tried uninstalling the windows/amd64 version and installing windows/386 to no avail. It's installed in c:\\Go and the PATH is set. I'm using windows 10.</p>\n\n<p>Line feeds</p>\n\n<pre><code>package mainLF\nLF\nimport \"fmt\"LF\nLF\nfunc main(){LF\n    fmt.Println(\"Hello world\")LF\n}LF\n</code></pre>\n\n<p>The following doesn't print to the command prompt either.</p>\n\n<pre><code>package main\n\n//import \"fmt\"\n\nfunc main(){\n    println(\"Hello world\")\n}\n</code></pre>\n\n<p>The following gives the error \"fmt imported but not used\" so it must be doing something. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\n\n}\n</code></pre>\n\n<p>GOROOT is set to C:\\Go\\</p>\n\n<p>PATH: C:\\Go\\bin</p>\n\n<p><a href=\"http://i.stack.imgur.com/tfu9k.jpg\" rel=\"nofollow\">Image showing how I'm running the program</a></p>\n\n<p>EDIT: New Image </p>\n\n<p><a href=\"http://i.stack.imgur.com/58Asf.jpg\" rel=\"nofollow\">Updated image</a></p>\n"}, {"tags": ["json", "testing", "go", "software-design"], "answers": [{"tags": [], "owner": {"reputation": 3038, "user_id": 568689, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a68e2585beb59c1bd2a19c46045f57b?s=128&d=identicon&r=PG", "display_name": "Eden", "link": "https://stackoverflow.com/users/568689/eden"}, "is_accepted": false, "score": 0, "last_activity_date": 1447591381, "creation_date": 1447591381, "answer_id": 33719788, "question_id": 33719295, "link": "https://stackoverflow.com/questions/33719295/how-should-i-deal-with-a-large-blocks-of-text-in-source-code-so-that-i-the-reada/33719788#33719788", "title": "How should I deal with a large blocks of text in source code so that I the readability of the code is not compromised?", "body": "<p>I do not think this is a language depended issue. Having a large chunk of sting of any kind embedded inside the code compromise the readability of it.</p>\n\n<p>As for a solution I would consider 2 aspects:\n1. Is the string conent is really static - if you don't think it will ever change I believe putting it into another .go file is the best solution. Introducing more code to handle the loading of the content just makw things more complicated.\n2. Deployment - one of the nicest thing about Go is having a single file you can run without any external dependencies. If you load the content of the string from external source you compromise that. The next person who will need to run the test will have to know about this file... </p>\n"}, {"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1447591639, "creation_date": 1447591639, "answer_id": 33719836, "question_id": 33719295, "link": "https://stackoverflow.com/questions/33719295/how-should-i-deal-with-a-large-blocks-of-text-in-source-code-so-that-i-the-reada/33719836#33719836", "title": "How should I deal with a large blocks of text in source code so that I the readability of the code is not compromised?", "body": "<p>There are several packages available which deal with this kind of problem, most prominently Jim Teeuwen's excellent <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow\" title=\"go-bindata on Github\">go-bindata</a>. What it basically does is to take input files and store the contents of those files into constants.\nOf course, you can use this package.</p>\n\n<p>Of course, you can do this manually. But, to declutter the actual code, I'd put those constants into separate files for that purpose. So basically, my <code>data.go</code> would look like this</p>\n\n\n\n<pre class=\"lang-go prettyprint-override\"><code>package yours\n\nconst (\n\nFirstText =`\nLorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy \neirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam \nvoluptua. At vero eos et accusam et justo duo dolores et ea rebus.\n\nLorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy \neirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam    \nvoluptua. At vero eos et accusam et justo duo dolores et ea rebum.`\n\nSecondText = `\nLorem ipsum dolor sit met, consetetur sadipscing elitr, sed diam nonumy\neirmod tempor invidunt ut labore et dolore magna aliquyam`\n)\n</code></pre>\n\n<p>So, you can refer to those texts since they are global, but they do not clutter your code.</p>\n\n<p>This approach should work with every programming language I am aware of.</p>\n"}, {"tags": [], "owner": {"reputation": 11971, "user_id": 1100135, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e7b273722f4261cd61c3256374da73cc?s=128&d=identicon&r=PG", "display_name": "piotrek", "link": "https://stackoverflow.com/users/1100135/piotrek"}, "is_accepted": false, "score": 0, "last_activity_date": 1449024312, "creation_date": 1449024312, "answer_id": 34033992, "question_id": 33719295, "link": "https://stackoverflow.com/questions/33719295/how-should-i-deal-with-a-large-blocks-of-text-in-source-code-so-that-i-the-reada/34033992#34033992", "title": "How should I deal with a large blocks of text in source code so that I the readability of the code is not compromised?", "body": "<p>i don't know Go but in any other language i worked with, we kept data (like big static text) outside of the source. first check if there is no framework that solves your problem - most languages have very powerful test ecosystem.</p>\n\n<p>you are concerned about performance. have you measure the impact on the performance? it's just a few kb file</p>\n"}], "owner": {"reputation": 6120, "user_id": 1309352, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8ff1bfcff680fcc6dcd170ba54194ecb?s=128&d=identicon&r=PG", "display_name": "Bleeding Fingers", "link": "https://stackoverflow.com/users/1309352/bleeding-fingers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1449024312, "creation_date": 1447587828, "question_id": 33719295, "link": "https://stackoverflow.com/questions/33719295/how-should-i-deal-with-a-large-blocks-of-text-in-source-code-so-that-i-the-reada", "title": "How should I deal with a large blocks of text in source code so that I the readability of the code is not compromised?", "body": "<p>Recently while fixing a bug in the system and thereof writing test for it we placed a large block of html string in the test source code. My only concern with that is that the large block are distractive and compromise the readability of the code.</p>\n\n<p>Some, obvious, solutions for i that I came up with were:</p>\n\n<ul>\n<li>Move the individual block of text into separate text files which are read when the test is run. (My concern with this: efficiency and scalability)</li>\n<li>Move the blocks of text into a single json file and load it into a json object once (not quite confident about this solution. Overkill, if we only happen to have a few such tests with large blocks of text?)</li>\n<li>create a separate code file within the same package that would contain the blocks (same concerns as the previous one)</li>\n<li>stick with the current solution i.e. the large block of code inside the source code. And that it's not a big issue.</li>\n</ul>\n\n<p>Language: Go</p>\n\n<p>Questions:</p>\n\n<ul>\n<li>Which of the earilier solutions would be optimal? Or some other solution?</li>\n<li>Good to know: Is the solution to this concern dependent on the programming language that is in use?</li>\n</ul>\n"}, {"tags": ["xml", "parsing", "go"], "comments": [{"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1447585247, "post_id": 33718880, "comment_id": 55207948, "body": "Even my browser thinks that is invalid XML. Try to reduce it to a minimal example."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1447587476, "post_id": 33718880, "comment_id": 55208536, "body": "XML parsers cannot parse invalid XML. A possible solution is to preprocess your file. You also may want to send a heads up to this provider."}], "answers": [{"tags": [], "owner": {"reputation": 385, "user_id": 5252581, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7c5172b819057de36d2db9636712d2c5?s=128&d=identicon&r=PG&f=1", "display_name": "jojo", "link": "https://stackoverflow.com/users/5252581/jojo"}, "is_accepted": false, "score": 0, "last_activity_date": 1447646629, "creation_date": 1447646629, "answer_id": 33728329, "question_id": 33718880, "link": "https://stackoverflow.com/questions/33718880/go-parse-not-valid-xml/33728329#33728329", "title": "Go parse not valid XML", "body": "<p>XML tags  should be properly opened and closed. From the XML that you have posted, it seems like XML Declaration is not in the beginning.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n</code></pre>\n\n<p>This should be at the beginning. Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 3330, "user_id": 1075324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/750Qe.jpg?s=128&g=1", "display_name": "Abhijeet Kasurde", "link": "https://stackoverflow.com/users/1075324/abhijeet-kasurde"}, "is_accepted": false, "score": 0, "last_activity_date": 1451911238, "creation_date": 1451911238, "answer_id": 34591422, "question_id": 33718880, "link": "https://stackoverflow.com/questions/33718880/go-parse-not-valid-xml/34591422#34591422", "title": "Go parse not valid XML", "body": "<p>XML given in question seems to be wrong,</p>\n\n<p>Here is correct version of XML file and Go code </p>\n\n<p>XML File :</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;rss version=\"2.0\" xmlns:atom=\"http://www.w3.org/2005/Atom\"&gt;\n&lt;channel&gt;\n    &lt;title&gt;Guru Jobs&lt;/title&gt;\n    &lt;link&gt;http://www.guru.com&lt;/link&gt;\n    &lt;description&gt;Guru Jobs&lt;/description&gt;\n    &lt;lastBuildDate&gt;Sun, 15 Nov 2015 11:04:51 GMT&lt;/lastBuildDate&gt;\n    &lt;language&gt;en-us&lt;/language&gt;\n    &lt;atom:link href='http://www.guru.com/rss/jobs/' rel=\"self\" type=\"application/rss+xml\" /&gt;\n    &lt;item&gt;\n        &lt;title&gt;Imaging for Bespoke Curtain Website&lt;/title&gt;\n        &lt;link&gt;http://www.guru.com/jobs/imaging-for-bespoke-curtain-website/1203083&lt;/link&gt;\n        &lt;guid&gt;http://www.guru.com/jobs/imaging-for-bespoke-curtain-website/1203083&lt;/guid&gt;\n        &lt;description&gt;&lt;![CDATA[&lt;b&gt;Description:&lt;/b&gt; Hi,We are currently developing a made to measure curtain website and are looking for help in develo...&lt;br&gt;&lt;b&gt;Category:&lt;/b&gt; Web, Software &amp; IT&lt;br&gt;&lt;b&gt;Required skills:&lt;/b&gt; ecommerce, imaging software, opencart, web development&lt;br&gt;&lt;b&gt;Fixed Price budget:&lt;/b&gt; $500-$1k&lt;br&gt;&lt;b&gt;Job type:&lt;/b&gt; Public&lt;br&gt;&lt;b&gt;Freelancer Location:&lt;/b&gt; Worldwide&lt;br&gt;]]&gt;\n        &lt;/description&gt;\n        &lt;pubDate&gt;Mon, 04 Jan 2016 12:14:09 GMT&lt;/pubDate&gt;\n    &lt;/item&gt;\n&lt;/channel&gt;\n&lt;/rss&gt;\n</code></pre>\n\n<p>Sample Go Code </p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"encoding/xml\"\n    \"fmt\"\n    )\n\ntype Rss2 struct {\n    ItemList []Item `xml:\"channel&gt;item\"`\n}\ntype Item struct {\n    Title       string      `xml:\"title\"`\n    Link        string      `xml:\"link\"`\n    Description string      `xml:\"description\"`\n    PubDate     string      `xml:\"pubDate\"`\n    GUID        string      `xml:\"guid\"`\n}\n\nfunc main() {\n    r := Rss2{}\n    xmlContent, _ := ioutil.ReadFile(\"example2.xml\")\n    if err := xml.Unmarshal(xmlContent, &amp;r); err != nil {\n        panic(err)\n    }\n    fmt.Println(\"RSS item :\", r)\n}\n</code></pre>\n\n<p>Now, you can iterate and find you required data in XML.</p>\n"}], "owner": {"reputation": 41, "user_id": 5325331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69af802fca161001ffe24b6da65e8411?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/5325331/nikolay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459815746, "creation_date": 1447584885, "last_edit_date": 1459815746, "question_id": 33718880, "link": "https://stackoverflow.com/questions/33718880/go-parse-not-valid-xml", "title": "Go parse not valid XML", "body": "<p>There is a link to XML: <a href=\"http://www.guru.com/rss/jobs/\" rel=\"nofollow\">http://www.guru.com/rss/jobs/</a>\nWhen try to parse a XML with <code>encoding/xml</code>, get error: </p>\n\n<blockquote>\n  <p>XML syntax error on line 1: invalid XML name: t</p>\n</blockquote>\n\n<p>I know, this XML is broken, but how I can ignore this, and parse the first items?</p>\n\n<p>Last Item of XML looks like this: </p>\n\n<pre><code>&lt;item&gt;\n    &lt;title&gt;Online Ad Posting Data Entry Jobs&lt;/t\n    &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n    &lt;rss version=\"2.0\" xmlns:atom=\"http://www.w3.org/2005/Atom\"&gt;\n        &lt;channel&gt;\n            &lt;title&gt;Guru Jobs&lt;/title&gt;\n            &lt;link&gt;http://www.guru.com&lt;/link&gt;\n            &lt;description&gt;Guru Jobs&lt;/description&gt;\n            &lt;lastBuildDate&gt;Sun, 15 Nov 2015 11:04:51 GMT&lt;/lastBuildDate&gt;\n            &lt;language&gt;en-us&lt;/language&gt;\n            &lt;atom:link href='http://www.guru.com/rss/jobs/' rel=\"self\" type=\"application/rss+xml\" /&gt;\n        &lt;/channel&gt;\n    &lt;/rss&gt;\n    itle&gt;\n    &lt;link&gt;http://www.guru.com/jobs/online-ad-posting-data-entry-jobs/1189496&lt;/link&gt;\n    &lt;guid&gt;http://www.guru.com/jobs/online-ad-posting-data-entry-jobs/1189496&lt;/guid&gt;\n&lt;/item&gt; \n</code></pre>\n\n<p>Code example:</p>\n\n<pre><code>type Rss2 struct { \n    ItemList []Item `xml:\"channel&gt;item\"`\n}\ntype Item struct {\n    Title       string      `xml:\"title\"`\n    Link        string      `xml:\"link\"`\n    Description string      `xml:\"description\"`\n    PubDate     string      `xml:\"pubDate\"`\n    GUID        string      `xml:\"guid\"`    \n}\n\nr := Rss2{}\nreader := bytes.NewReader(xmlRead)\ndecoder := xml.NewDecoder(reader)\ndecoder.CharsetReader = charset.NewReaderLabel\ndecoder.Strict = false\nerr = decoder.Decode(&amp;r)\nif err != nil { fmt.Printf(err.Error()) }\n</code></pre>\n"}, {"tags": ["mongodb", "go", "bson", "mgo"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447587290, "post_id": 33718403, "comment_id": 55208494, "body": "How would you generate a string that meets the uniqueness requirements? Calling <code>ID.Hex()</code> when dealing with the ObjectID externally doesn&#39;t have any downsides - using your own string ID would as it would be larger (24 bytes vs. 12 bytes for ObjectID) and make your implementation more brittle."}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447588674, "post_id": 33718403, "comment_id": 55208832, "body": "It&#39;s fairly simple to generate a UUID string. Using ObjectId mechanism for this purpose seems redundant. Furthermore it has the downside of being incompatible with any system that doesn&#39;t use bson data types"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1447589059, "post_id": 33718403, "comment_id": 55208920, "body": "The hex representation is portable/compatible. A UUIDv4 is no different - in fact databases like Postgres store UUIDs as byte arrays, not strings."}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1447589857, "post_id": 33718403, "comment_id": 55209121, "body": "Thanks for the info. I guess the downsides of bson are use-case specific. However my questions still stands (what are the benefits of using bson.ObjectId vs string id? Will I lose anything significant if I store my mongo entities with a plain string id?)"}], "answers": [{"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1454497387, "last_edit_date": 1454497387, "creation_date": 1454430180, "answer_id": 35158592, "question_id": 33718403, "link": "https://stackoverflow.com/questions/33718403/mgo-bson-objectid-vs-string-id/35158592#35158592", "title": "mgo - bson.ObjectId vs string id", "body": "<p>As was already mentioned in the comments, storing the ObjectId as a hex string would double the space needed for it and in case you want to extract one of its values, you'd first need to construct an ObjectId from that string.</p>\n\n<p>But you have a misconception. There is <em>absolutely</em> no need to use an ObjectId for the mandatory <code>_id</code> field. Quite often, I advice against that. Here is why.</p>\n\n<p>Take the simple example of a book, relations and some other considerations set aside for simplicty:</p>\n\n<pre><code>{\n  _id: ObjectId(\"56b0d36c23da2af0363abe37\"),\n  isbn: \"978-3453056657\",\n  title: \"Neuromancer\",\n  author: \"William Gibson\",\n  language: \"German\"\n}\n</code></pre>\n\n<p>Now, what use would have the ObjectId here? Actually none. It would be an index with hardly any use, since you would never search your book databases by an artificial key like that. It holds no semantic value. It would be a unique ID for an object which already <em>has</em> a globally unique ID \u2013 the ISBN.</p>\n\n<p>So we simplify our book document like this:</p>\n\n<pre><code>{\n  _id: \"978-3453056657\",\n  title: \"Neuromancer\",\n  author: \"William Gibson\",\n  language: \"German\"\n}\n</code></pre>\n\n<p>We have reduced the size of the document, make use of a preexisting globally unique ID and do not have a basically unused index.</p>\n\n<p>Back to your basic question wether you loose something by not using ObjectIds: Quite often, not using the ObjectId is the better choice. But if you use it, use the binary form.</p>\n"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2786, "favorite_count": 1, "accepted_answer_id": 35158592, "answer_count": 1, "score": 1, "last_activity_date": 1454497387, "creation_date": 1447581299, "question_id": 33718403, "link": "https://stackoverflow.com/questions/33718403/mgo-bson-objectid-vs-string-id", "title": "mgo - bson.ObjectId vs string id", "body": "<p>Using <code>mgo</code>, it seems that best practice is to set object ids to be <code>bson.ObjectId</code>. </p>\n\n<p>This is not very convenient, as the result is that instead of a plain <code>string</code> id the id is stored as binary in the DB. Googling this seems to yield tons of questions like \"how do I get a string out of the bson id?\", and indeed in <code>golang</code> there is the <code>Hex()</code> method of the <code>ObjectId</code> to allow you to get the string.</p>\n\n<p>The bson becomes even more annoying to work with when exporting data from mongo to another DB platform (this is the case when dealing with big data that is collected and you want to merge it with some properties from the back office mongo DB), this means a lot of pain (you need to transform the binary ObjectId to a string in order to join with the id in different platforms that do not use bson representation). </p>\n\n<p>My question is: what are the benefits of using <code>bson.ObjectId</code> vs <code>string</code> id? Will I lose anything significant if I store my <code>mongo</code> entities with a plain string id? </p>\n"}, {"tags": ["go", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 436, "user_id": 5511980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0174993a67ce7b3ad2bcb2f12e135661?s=128&d=identicon&r=PG&f=1", "display_name": "W. Cybriwsky", "link": "https://stackoverflow.com/users/5511980/w-cybriwsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1447578276, "creation_date": 1447578276, "answer_id": 33718012, "question_id": 33717799, "link": "https://stackoverflow.com/questions/33717799/go-yaml-control-characters-are-not-allowed-error/33718012#33718012", "title": "Go-yaml control characters are not allowed error", "body": "<p>From the sounds of it, you're hitting the error block at <a href=\"https://github.com/go-yaml/yaml/blob/53feefa2559fb8dfa8d81baad31be332c97d6c77/readerc.go#L347\" rel=\"nofollow\">https://github.com/go-yaml/yaml/blob/53feefa2559fb8dfa8d81baad31be332c97d6c77/readerc.go#L347</a> , and it looks like that should also be telling you the offset (where in the file it's hitting the problematic character) and character code. If that info is enough to solve your problem, then great. If, on the other hand, the yaml library is spitting out validated yaml that it is not comfortable accepting as input, you should open an issue with the maintainer on Github at <a href=\"https://github.com/go-yaml/yaml/issues\" rel=\"nofollow\">https://github.com/go-yaml/yaml/issues</a></p>\n"}, {"comments": [{"owner": {"reputation": 7902, "user_id": 3356612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085070b2074edcce07bc4381c7b5d635?s=128&d=identicon&r=PG", "display_name": "Felix Frank", "link": "https://stackoverflow.com/users/3356612/felix-frank"}, "edited": false, "score": 0, "creation_date": 1464130035, "post_id": 33726617, "comment_id": 62355419, "body": "Spot on! I had read my data via from an <code>io.Reader</code>, so I sliced my buffer down to <code>[0:count]</code> (with <code>count</code> being the number of bytes as reported by the <code>Read</code> function)."}], "tags": [], "owner": {"reputation": 272, "user_id": 4234313, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0fe081e9b9eacdf4166046161afbfde3?s=128&d=identicon&r=PG&f=1", "display_name": "Inondle", "link": "https://stackoverflow.com/users/4234313/inondle"}, "is_accepted": true, "score": 5, "last_activity_date": 1447631951, "creation_date": 1447631951, "answer_id": 33726617, "question_id": 33717799, "link": "https://stackoverflow.com/questions/33717799/go-yaml-control-characters-are-not-allowed-error/33726617#33726617", "title": "Go-yaml control characters are not allowed error", "body": "<p>Figured it out, the problem was that my buffer was too big. If you have a []byte that is too big then go-yaml will read those extra bytes as characters and throw errors. I changed my code to :</p>\n\n<pre><code>func readConf(CONF string) *EntriesList {\n    confiFile, err := ioutil.ReadFile(CONF)\n    check(err)\n    var entries EntriesList\n    err = yaml.Unmarshal(confiFile, &amp;entries)\n    check(err)\n    return &amp;entries\n}\n</code></pre>\n\n<p>And it worked as expected. </p>\n"}], "owner": {"reputation": 272, "user_id": 4234313, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0fe081e9b9eacdf4166046161afbfde3?s=128&d=identicon&r=PG&f=1", "display_name": "Inondle", "link": "https://stackoverflow.com/users/4234313/inondle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7092, "favorite_count": 0, "accepted_answer_id": 33726617, "answer_count": 2, "score": 3, "last_activity_date": 1518033245, "creation_date": 1447576257, "last_edit_date": 1518033245, "question_id": 33717799, "link": "https://stackoverflow.com/questions/33717799/go-yaml-control-characters-are-not-allowed-error", "title": "Go-yaml control characters are not allowed error", "body": "<p>I'm trying to make a really simple ssh address book program. Takes some info about ssh addresses and stores them in a yaml document. I'm doing it partly to learn a bit about Go and am having a small problem. I can serialize the data and put a document into a file but I'm getting this error when I try to read it back:<br>\n<code>yaml: control characters are not allowed</code></p>\n\n<p>I'm not sure what this error message means, googling didn't yield any helpful results. Any ideas? </p>\n\n<p>These are the structs I'm using to organize the data:</p>\n\n<pre><code>type EntriesList struct {\n    SSHEntries []SSHEntry `yaml:\"sshentries\"`\n}   \n\ntype SSHEntry struct {\n    Name    string `yaml:\"name\"`\n    Command SSHCmd `yaml:\"command\"`\n}   \n\ntype SSHCmd struct {\n    Addr  string `yaml:\"addr\"`\n    Port  int    `yaml:\"port\"`\n    Uname string `yaml:\"uname\"`\n}   \n</code></pre>\n\n<p>The format it puts my data into is:</p>\n\n<pre><code>---\nentrieslist:\n - name: entry1\n   command:\n     addr: somewhere\n     port: 22\n     uname: someone\n - name: entry2 ... etc \n</code></pre>\n\n<p>I checked this ^^ with a YAML validator and it is legal YAML. \nHere is my function to read the file:</p>\n\n<pre><code>// CONF is the path to the file\nfunc readConf(CONF string) *EntriesList {\n    configFile := openConfigFile(CONF)\n    defer configFile.Close()\n\n    buffer := make([]byte, 512, 512)\n    _, err := configFile.Read(buffer)\n    check(err)\n\n    var entries EntriesList\n    err = yaml.Unmarshal(buffer, &amp;entries)\n    data, _ := yaml.Marshal(entries)\n    fmt.Println(string(data))\n\n    return &amp;entries\n}\n</code></pre>\n"}, {"tags": ["inheritance", "struct", "go", "subclass"], "answers": [{"tags": [], "owner": {"reputation": 436, "user_id": 5511980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0174993a67ce7b3ad2bcb2f12e135661?s=128&d=identicon&r=PG&f=1", "display_name": "W. Cybriwsky", "link": "https://stackoverflow.com/users/5511980/w-cybriwsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1447567538, "creation_date": 1447567538, "answer_id": 33716953, "question_id": 33716109, "link": "https://stackoverflow.com/questions/33716109/golang-when-typecasting-child-struct-to-parent-struct-is-child-struct-informat/33716953#33716953", "title": "Golang: when typecasting child struct to parent struct, is child struct information lost?", "body": "<p>It would not return the child struct. What you are doing is <em>not</em> typecasting the child struct, but just returning one of its fields. To use a more concrete example, the above go snippet would be like trying to use the name of an  Employee as if it were a super class of Employee. </p>\n\n<p>Your guess was right, though, that the way to achieve the \"is-a\" relationship like ArrayList and List is to use an interface.  Know, though, that interfaces can only provide polymorphism for method calls, not field access. A modified version of your example, which is hopefully helpful, can be found at: </p>\n\n<p><a href=\"http://play.golang.org/p/qclS5KR64H\" rel=\"nofollow\">http://play.golang.org/p/qclS5KR64H</a></p>\n\n<p>You would likely find it helpful to read the \"Struct Types\" portion of the go spec, and/or the whole spec (it's not that long! Or scary!):</p>\n\n<p><a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">https://golang.org/ref/spec#Struct_types</a></p>\n"}], "owner": {"reputation": 197, "user_id": 5212851, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204583028363428/picture?type=large", "display_name": "Oliver Wheeler", "link": "https://stackoverflow.com/users/5212851/oliver-wheeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3820, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447607960, "creation_date": 1447558310, "last_edit_date": 1447607960, "question_id": 33716109, "link": "https://stackoverflow.com/questions/33716109/golang-when-typecasting-child-struct-to-parent-struct-is-child-struct-informat", "title": "Golang: when typecasting child struct to parent struct, is child struct information lost?", "body": "<p>For example after embedding the parent struct in the child struct:</p>\n\n<pre><code>type ParentNode struct {\n}\n\ntype ChildNode struct {\n    ParentNode\n    Ident string\n}\n\nfunc ParentType() ParentNode { \n    child := ChildNode{Ident : \"node\"}\n    fmt.Println(child)\n    return child.ParentNode \n}\n\nfunc main() {\n    x := ParentType()\n    fmt.Println(x.Ident)\n\n}\n</code></pre>\n\n<p>Would this print out \"node\" and also return the child struct wrapped in the parent struct with all the information, such that we can manipulate the apparent parent struct while having the actual child struct? The idea for this is similar to Java where you can return an apparent type of List but return an actual type of LinkedList.</p>\n\n<p>If not, what would be the best way to achieve this functionality? Essentially I want to upcast the Child struct to a parent struct but manipulate it as if it was a child struct. Is there a way of solving this using an interface?</p>\n\n<p>How is it possible to get rid of error \"x.Ident undefined (type ParentNode has no field or method Ident)\" at line <code>fmt.Println(x.Ident)</code></p>\n"}, {"tags": ["time", "go"], "comments": [{"owner": {"reputation": 29910, "user_id": 3574819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b4f770584940ff6fc451e68565de5ed0?s=128&d=identicon&r=PG&f=1", "display_name": "FuzzyTree", "link": "https://stackoverflow.com/users/3574819/fuzzytree"}, "edited": false, "score": 4, "creation_date": 1447556061, "post_id": 33715842, "comment_id": 55202500, "body": "why not use a cron job to launch (and terminate if necessary) the program?"}], "answers": [{"comments": [{"owner": {"reputation": 2597, "user_id": 2291517, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gGDf0.jpg?s=128&g=1", "display_name": "surfearth", "link": "https://stackoverflow.com/users/2291517/surfearth"}, "edited": false, "score": 1, "creation_date": 1447560598, "post_id": 33715969, "comment_id": 55203284, "body": "I removed the tick function and now use crontab commands to run the compiled executable at specific intervals. This makes the program simpler and should increase reliability."}], "tags": [], "owner": {"reputation": 4616, "user_id": 1862779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347128a2fb95f783f2f211e706c3991d?s=128&d=identicon&r=PG", "display_name": "Chamila Chulatunga", "link": "https://stackoverflow.com/users/1862779/chamila-chulatunga"}, "is_accepted": true, "score": 3, "last_activity_date": 1447556895, "creation_date": 1447556895, "answer_id": 33715969, "question_id": 33715842, "link": "https://stackoverflow.com/questions/33715842/golang-how-to-execute-function-at-specific-times/33715969#33715969", "title": "Golang - How to execute function at specific times", "body": "<p>What you're really after here is a scheduler, so your options are:</p>\n\n<ul>\n<li><p>Limit your program to just what you want done at each interval, but use an existing scheduler to do the scheduling - a simple example would be to use a cron job (or for Windows, Task Scheduler) to launch your program according to the required schedule</p></li>\n<li><p>Turn your program into a scheduler in its own right, which invokes the required function correctly on schedule. Your program would then ideally need to run as a daemon (service, on Windows), or be launched once and left running all the time somehow</p></li>\n</ul>\n"}], "owner": {"reputation": 2597, "user_id": 2291517, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gGDf0.jpg?s=128&g=1", "display_name": "surfearth", "link": "https://stackoverflow.com/users/2291517/surfearth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2509, "favorite_count": 0, "accepted_answer_id": 33715969, "answer_count": 1, "score": 4, "last_activity_date": 1447556895, "creation_date": 1447555583, "question_id": 33715842, "link": "https://stackoverflow.com/questions/33715842/golang-how-to-execute-function-at-specific-times", "title": "Golang - How to execute function at specific times", "body": "<p>I'm need to run a function at specific times of the day (e.g. 0010, 0610, 1210, 1810). My current approach uses a ticker <code>for _ = range time.Tick(21600 * time.Second)</code> and I manually launch the program at one of these intervals (e.g 1210). This is obviously sub-optimal. </p>\n\n<p>What's the best solution to this? I thought of running the ticker every 60 seconds and then checking to see if the time matched one of the intervals, but that doesn't seem very elegant.</p>\n"}, {"tags": ["unit-testing", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 2900, "user_id": 677373, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/597e00d0daa530370410a6bf5f3f0795?s=128&d=identicon&r=PG", "display_name": "sjmh", "link": "https://stackoverflow.com/users/677373/sjmh"}, "edited": false, "score": 0, "creation_date": 1447564500, "post_id": 33715430, "comment_id": 55203908, "body": "Not sure I&#39;ve ever seen the &#39;&amp;portFlipSdn(*p)&#39; syntax before.  Is that documented somewhere?  I recognize the embedding of portFlipCommon into the portFlipSdn and portFlipLegacy struct&#39;s."}, {"owner": {"reputation": 2900, "user_id": 677373, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/597e00d0daa530370410a6bf5f3f0795?s=128&d=identicon&r=PG", "display_name": "sjmh", "link": "https://stackoverflow.com/users/677373/sjmh"}, "edited": false, "score": 0, "creation_date": 1447574471, "post_id": 33715430, "comment_id": 55205623, "body": "Think maybe you meant pf := &amp;portFlipSdn{*p} ?"}, {"owner": {"reputation": 7247, "user_id": 5109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4706c2ab77716bc68a4cd6db621af277?s=128&d=identicon&r=PG", "display_name": "Andrew Johnson", "link": "https://stackoverflow.com/users/5109/andrew-johnson"}, "reply_to_user": {"reputation": 2900, "user_id": 677373, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/597e00d0daa530370410a6bf5f3f0795?s=128&d=identicon&r=PG", "display_name": "sjmh", "link": "https://stackoverflow.com/users/677373/sjmh"}, "edited": false, "score": 0, "creation_date": 1447628607, "post_id": 33715430, "comment_id": 55221523, "body": "Yes, and I should have had &#39;=&#39; rather than &#39;:=&#39;, otherwise pf is declared in the block, shadowing the one declared earlier."}], "tags": [], "owner": {"reputation": 7247, "user_id": 5109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4706c2ab77716bc68a4cd6db621af277?s=128&d=identicon&r=PG", "display_name": "Andrew Johnson", "link": "https://stackoverflow.com/users/5109/andrew-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1447628528, "last_edit_date": 1447628528, "creation_date": 1447551238, "answer_id": 33715430, "question_id": 33714478, "link": "https://stackoverflow.com/questions/33714478/go-testing-function-equality/33715430#33715430", "title": "Go - testing function equality", "body": "<p>Make portFlip an interface and have newPortFlip construct either an sdnPortFlip or a legacyPortFlip depending on the incoming type. In your test you can then check it's returning the correct concrete type using a type assertion.</p>\n\n<p>If you embed the common type into the SDN and legacy types then you can directly call those methods.</p>\n\n<pre><code>type portFlip interface {\n    build()\n    ...\n}\n\ntype portFlipCommon struct {\n    config  PortFlipConfig\n    args    portFlipArgs\n}\n\ntype portFlipSdn struct {\n    portFlipCommon\n}\n\ntype portFlipLegacy struct {\n    portFlipCommon\n}\n\nfunc (pf *portFlipCommon) netType() { ... }\nfunc (pf *portFlipSdn)    build() { ... }\nfunc (pf *portFlipLegacy) build() { ... }\n\nfunc newPortFlip(args portFlipArgs, config PortFlipConfig) (portFlip, error) {\n    var pf portFlip\n    p := &amp;portFlipCommon{args: args, config: config}\n    if p.netType() == \"sdn\" {\n        // Either build directly or define build on the sdn type\n        pf = &amp;portFlipSdn{*p}\n    } else if p.netType() == \"legacy\" {\n        // Either build directly or define build on the legacy type\n        pf = &amp;portFlipLegacy{*p}\n    } else {\n        return nil, fmt.Errorf(\"Invalid or nil netType: %s\", p.netType())\n    }\n    return pf, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 2900, "user_id": 677373, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/597e00d0daa530370410a6bf5f3f0795?s=128&d=identicon&r=PG", "display_name": "sjmh", "link": "https://stackoverflow.com/users/677373/sjmh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447628528, "creation_date": 1447542773, "last_edit_date": 1495540316, "question_id": 33714478, "link": "https://stackoverflow.com/questions/33714478/go-testing-function-equality", "title": "Go - testing function equality", "body": "<p>So from what I've read, you can't test if a function is equal in Go, but I'm trying to solve a test-case issue, so any help in refactoring this would be helpful.</p>\n\n<p>I have a constructor and I'm passing it some configuration values.  Based on those configs, it assigns another constructor function to a member of the struct.  Later, in a different method, it calls that new constructor.  I did it this way because it made it easier to test the methods on the struct, since I could now create a test constructor and reassign the struct member to it, before calling the methods I was testing.  Similar to the approach here: <a href=\"https://stackoverflow.com/questions/19167970/mock-functions-in-golang\">Mock functions in Go</a></p>\n\n<p>Now though, I'm trying to write a test case on the struct constructor and I'm having a hard time figuring out how to test it.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>type requestBuilder func(portFlipArgs, PortFlipConfig) portFlipRequest\n\ntype portFlip struct {\n    config  PortFlipConfig\n    args    portFlipArgs\n    builder requestBuilder\n}\n\nfunc newPortFlip(args portFlipArgs, config PortFlipConfig) (*portFlip, error) {\n    p := &amp;portFlip{args: args, config: config}\n    if p.netType() == \"sdn\" {\n        p.builder = newSDNRequest\n    } else if p.netType() == \"legacy\" {\n        p.builder = newLegacyRequest\n    } else {\n        return nil, fmt.Errorf(\"Invalid or nil netType: %s\", p.netType())\n    }\n    return p, nil\n}\n</code></pre>\n\n<p>The 'newSDNRequest' and 'newLegacyRequest' are the new constructors.  I can't figure out how to test the newPortFlip method to make sure that's it assigning the right method to the 'builder' member, since you can't test function equality.</p>\n\n<p>My only thought at this point is to have a 'builderType string' member, and just assign it to the name of the new constructor and then I could just test that.  Something like:</p>\n\n<pre><code>func newPortFlip(args portFlipArgs, config PortFlipConfig) (*portFlip, error) {\n    p := &amp;portFlip{args: args, config: config}\n    if p.netType() == \"sdn\" {\n        p.builderType = \"newSDNRequest\"\n        p.builder = newSDNRequest\n    } else if p.netType() == \"legacy\" {\n        p.builderType = \"newLegacyRequest\"\n        p.builder = newLegacyRequest\n    } else {\n        return nil, fmt.Errorf(\"Invalid or nil netType: %s\", p.netType())\n    }\n    return p, nil\n}\n</code></pre>\n\n<p>But that seemed rather frivolous, so I figured I should seek a better way before I did that.</p>\n\n<p>Thoughts? </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1652, "user_id": 918176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bdb37b11c35de00bb68359342a82f38?s=128&d=identicon&r=PG", "display_name": "user918176", "link": "https://stackoverflow.com/users/918176/user918176"}, "is_accepted": false, "score": 0, "last_activity_date": 1448052397, "creation_date": 1448052397, "answer_id": 33835789, "question_id": 33714140, "link": "https://stackoverflow.com/questions/33714140/comparing-delimited-files-for-database-update/33835789#33835789", "title": "Comparing delimited files for database update", "body": "<p>Are you sure you <em>need</em> the intermediate step? 40 MB is not very much, and your database engine is specialized in handling data like that..</p>\n\n<p>For instance with postgresql just load the new data into a temporary table:</p>\n\n<pre><code>create table temptable (\n a varchar,\n b varchar,\n c varchar\n);\ncopy temptable from '/path/to/csv/newdata.txt' delimiter ',' csv;\n</code></pre>\n\n<p>Then you can use simple SQL query to get the lines that do not have exact match in the old data, for example:</p>\n\n<pre><code>select *\nfrom temptable t\nwhere not exists (\n select 1\n from oldtable o\n where t.a=o.a and t.b=o.b and t.c=o.c\n)\n</code></pre>\n\n<p>If you did not save the data from previous week's batch, then just remember to copy it to an other table for storing. Now the real question is what you want to do with the information, but you should be able to handle most scenarios.</p>\n"}], "owner": {"reputation": 58, "user_id": 100266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2757b59576b3aa78f4ba08f4f69bd7f8?s=128&d=identicon&r=PG", "display_name": "wdingus", "link": "https://stackoverflow.com/users/100266/wdingus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448052397, "creation_date": 1447540064, "last_edit_date": 1447544815, "question_id": 33714140, "link": "https://stackoverflow.com/questions/33714140/comparing-delimited-files-for-database-update", "title": "Comparing delimited files for database update", "body": "<p>Any suggestions on packages (or methodologies) that might help with this? I need to take a ~40MB file we receive weekly and determine what changed from the previous to the current file. Whatever those changes are, then need to be made to a single simple database table. In a previous life I've accomplished similar via Linux \"diff\" with -Hae parameters, resulting in an \"ed script\". The contents were then handled by a PERL program, using Tie::File to reference the changed record in the previous file. In an effort to strengthen my Go skills I'm trying to utilize it for this current task. <a href=\"https://github.com/sergi/go-diff\" rel=\"nofollow\">https://github.com/sergi/go-diff</a> looks like it might be the ticket, but I'm not sure \"patch\" output will quite do what I need (easily). </p>\n\n<p>Fixed width and/or delimited text files are still commonly used, does anyone have any samples or pointers or suggestions on packages that might help in dealing with them in this way?</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 2, "creation_date": 1447539193, "post_id": 33713531, "comment_id": 55198921, "body": "You would need to provide more context as there is not much we can tell from this snippet. For example, are you calling <code>wg.Add</code> at all? (for example <code>wg.Add(len(sams))</code> just before the loop)"}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 3342213, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/787dca87f677ecd27581651d9f0443c0?s=128&d=identicon&r=PG&f=1", "display_name": "KNgu", "link": "https://stackoverflow.com/users/3342213/kngu"}, "is_accepted": false, "score": 0, "last_activity_date": 1447601470, "last_edit_date": 1447601470, "creation_date": 1447543871, "answer_id": 33714610, "question_id": 33713531, "link": "https://stackoverflow.com/questions/33713531/goroutines-are-not-iterating-through-a-slice/33714610#33714610", "title": "Goroutines are not iterating through a slice", "body": "<p>I found out the reason. It is because I had <code>wg.Wait()</code> in <code>process</code> which in turn caused it to hang. </p>\n"}], "owner": {"reputation": 305, "user_id": 3342213, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/787dca87f677ecd27581651d9f0443c0?s=128&d=identicon&r=PG&f=1", "display_name": "KNgu", "link": "https://stackoverflow.com/users/3342213/kngu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447601470, "creation_date": 1447536199, "question_id": 33713531, "link": "https://stackoverflow.com/questions/33713531/goroutines-are-not-iterating-through-a-slice", "title": "Goroutines are not iterating through a slice", "body": "<p>I have this code:</p>\n\n<pre><code>for _, v := range sams {\n    sam := v\n    pid := getPracticeIdBySam(db, sam)\n\n    go func() {\n        defer wg.Done()\n\n        for _, v := range pid {\n            process(db, stmt, v, min_year, max_year, bar)\n        }\n    }()\n}\n</code></pre>\n\n<p>It iterates through the first \"pid\", however it stops there. Is there a reason for this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 7, "creation_date": 1447528834, "post_id": 33712242, "comment_id": 55195949, "body": "Note that you can (and IMHO should) address this with interfaces; you can define an interface that exposes an immutable view of your data structure. Re: &quot;Worse, you can pass an object by value, but if it contains a pointer, you can actually modify its contents&quot;: The same is true in C++; note that <code>const</code> is <i>not</i> transitively inherited by pointer members."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 3, "creation_date": 1447532350, "post_id": 33712242, "comment_id": 55196918, "body": "The same reasons that were given for C#: <a href=\"http://stackoverflow.com/questions/4150478/why-there-is-no-const-member-method-in-c-sharp-and-const-parameter\">why there is no const member method in c# and const parameter</a>."}, {"owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "reply_to_user": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1447560537, "post_id": 33712242, "comment_id": 55203276, "body": "@ruakh But in C++, you can prevent the object from being copied, or when copied, apply the desired semantics (ref-counting, deep copy, etc). The interface technique is valid thou. You can/should pass a Reader interface instead of a *File for example. Thanks."}, {"owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1447560971, "post_id": 33712242, "comment_id": 55203345, "body": "@peterSO The answer by the Eric dude is terrible. It&#39;s not about guarantee, it&#39;s about contracts. You can const-cast an object inside a function and modify it, the same way you can put a if random % 1000000 == 0 { panic() } inside a Go function. With the read-only interface technique, you can cast to the original object and modify it. <i>You should not do either ones</i>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1447562235, "post_id": 33712242, "comment_id": 55203535, "body": "@chila: Now you are making this about opinions so the question should be closed."}, {"owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1447597356, "post_id": 33712242, "comment_id": 55211283, "body": "@peterSO When someone answers a simple question in a rude, vague and misleading way, like Eric&#39;s answer, I will point that out. He&#39;s the one being opinionated actually. If another technique like the one ruakh gave me allows me to cope with the lacking of a feature, that&#39;s enough since doing something with less is better than doing something with more."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1447627922, "post_id": 33712242, "comment_id": 55221348, "body": "From at least <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/_XiGWtxhmhE/8iWxTYXCfn0J\" rel=\"nofollow noreferrer\">one of the developers</a> it would be &quot;While there  may be some benefit to marking objects immutable in some way, we don&#39;t  think a const type qualifier is to way to go.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 1, "creation_date": 1447626693, "post_id": 33725884, "comment_id": 55221023, "body": "Right, so this is what I called an <i>expanded comment</i>."}, {"owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 0, "creation_date": 1447641132, "post_id": 33725884, "comment_id": 55224601, "body": "1. I&#39;m not against immutable interfaces. I&#39;m against the rationale that const is worthless because your can circumvent it. 2. Mutable gives you an exception to the contract for situations where mutability doesn&#39;t affect the state of a const object in a meaningful way (like a mutex). 3. You don&#39;t write code like that in well written programs. You might use typedefs and stuff like that, to clarify. 3.5. You can solve the inner pointer problem at the constructor, if one should exist. 4. The structure &#39;S&#39; needs a constructor."}, {"owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 0, "creation_date": 1447641196, "post_id": 33725884, "comment_id": 55224606, "body": "C++&#39;s const is perfect and I never had any issues with it. But I realize for it to be effective, you might need other stuff like constructors. For now, the immutable interface is the way to go."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 2, "last_activity_date": 1447626664, "creation_date": 1447626664, "answer_id": 33725884, "question_id": 33712242, "link": "https://stackoverflow.com/questions/33712242/what-is-the-rationale-of-go-not-having-the-const-qualifier/33725884#33725884", "title": "What is the rationale of Go not having the const qualifier?", "body": "<p>Please treat it as an expanded comment. I'm not any programming language designer, so can't go deep inside the details here, but will present my opinion as a long-term developer in C++ and short-term developer in Go.</p>\n\n<p>Const is a non-trivial feature for the compiler, so one would have to make sure whether it's providing enough advantage for the user to implement it as well as won't sacrifice the simplicity of syntax. You might think it's just a <code>const</code> qualifier we're talking about, but looking at C++ itself, it's not so easy \u2013 there're a lot of caveats.</p>\n\n<ol>\n<li><p>You say <code>const</code> is a contract and you shouldn't be able to modify it at any circumstances. One of your arguments against using read only interfaces is that you can cast it to original type and do whatever you want. Sure you can. The same way you can show a middle finger to the contract in C++ by using <code>const_cast</code>. For some reason it was added to the language and, not sure I should be proud of it, I've used it once or twice.</p></li>\n<li><p>There's another modifier in C++ allowing you to relax the contract \u2013 <code>mutable</code>. Someone realised that <code>const</code> structures might actually need to have some fields modified, usually mutexes protecting internal variables. I guess you would need something similar in Go in order to be able to implement thread-safe structures.</p></li>\n<li><p>When it comes simple <code>const int x</code> people can easily follow. But then pointers jump in and people really get consfused. <code>const int * x</code>, <code>int * const x</code>, <code>const int * const x</code> \u2013 these are all valid declarations of <code>x</code>, each with different contract. I know it's not a rocket science to choose the right one, but does your experience as a senior C++ programmer tell you people widely understand these and are always using the right one? And I haven't even mentioned things like <code>const int * const * * * const * const x</code>. It blows my mind.</p></li>\n</ol>\n\n<p>Before I move to point 4, I would like to cite the following:</p>\n\n<blockquote>\n  <p>Worse, you can pass an object by value, but if it contains a pointer,\n  you can actually modify its contents</p>\n</blockquote>\n\n<p>Now this is interesting accusation. There's the same issue in C++; worse \u2013 it exists even if you declare object as const, which means you can't solve the problem with a simple <code>const</code> qualifier. See the next point:</p>\n\n<ol start=\"4\">\n<li><p>Per 3, and pointers, it's not so easy to express the very right contract and things sometimes get unexpected. This piece of code surprised a few people:</p>\n\n<pre><code>struct S {\n    int *x;\n};\n\nint main() {\n    int n = 7;\n    const S s = {&amp;n}; // don't touch s, it's read only!\n    *s.x = 666; // wait, what? s is const! is satan involved?\n}\n</code></pre>\n\n<p>I'm sure it's natural for you why the code above compiles. It's the pointer value you can't modify (the address it points to), not the value behind it. You must admit there're people around that would raise their eyebrow. </p></li>\n</ol>\n\n<p>I don't know if it makes any point, but I've been using const in C++ all the time. Very accurate. Going mental about it. Not sure whether is has ever saved my ass, but after moving to Go I must admit I've never missed it. And having in mind all these edge cases and exceptions I can really believe creators of a minimalistic language like Go would decide to skip on this one.</p>\n\n<blockquote>\n  <p>Type-safety is about having a contract that allows speed and prevents\n  type-related bugs.</p>\n</blockquote>\n\n<p>Agreed. For example, in Go, I love there're no implicit conversions between types. This is really preventing me from <em>type-related bugs</em>.</p>\n\n<blockquote>\n  <p>Another feature that does this too is the const qualifier.</p>\n</blockquote>\n\n<p>Per my whole answer \u2013 I don't agree. Where a general const contract would do this for sure, a simple const qualifier is not enough. You then need a <code>mutable</code> one, maybe kind of a const_cast feature and still \u2013 it can leave you with misleading believes of protection, because it's hard to understand what exactly is constant.</p>\n\n<p>Hopefully some language creators will design a perfect way of defining constants all over in our code and then we'll see it in Go. Or move over to the new language. But personally, I don't think C++'s way is a particularly good one. </p>\n\n<p>(Alternative would be to follow functional programming paradigms, which would love to see all their \"variables\" immutable.)</p>\n"}, {"comments": [{"owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 0, "creation_date": 1447787737, "post_id": 33743305, "comment_id": 55297993, "body": "Const in C++ is always about a an immutable value or a pointer to a immutable one. I don&#39;t think Go is about &quot;you write correct code by writing correct code&quot;, it&#39;s mostly about &quot;don&#39;t add a feature unless it&#39;s ultra necessary&quot;. With immutable interfaces and wrappers, it&#39;s seems not to be for const."}], "tags": [], "owner": {"reputation": 251, "user_id": 2774002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntpn9.gif?s=128&g=1", "display_name": "Ian Lance Taylor", "link": "https://stackoverflow.com/users/2774002/ian-lance-taylor"}, "is_accepted": false, "score": 4, "last_activity_date": 1447702907, "creation_date": 1447702907, "answer_id": 33743305, "question_id": 33712242, "link": "https://stackoverflow.com/questions/33712242/what-is-the-rationale-of-go-not-having-the-const-qualifier/33743305#33743305", "title": "What is the rationale of Go not having the const qualifier?", "body": "<p>The const type qualifier in C/C++ has various meanings.  When applied to a variable, it means that the variable is immutable.  That's a useful feature, and one that is missing from Go, but it's not the one you seem to be talking about.</p>\n\n<p>You are talking about the way that const can be used as a partially enforced contract for a function.  A function can give a pointer parameter the const qualifier to mean that the function won't change any values using that pointer.  (Unless, of course, the function uses a cast (a <code>const_cast</code> in C++).  Or, in C++, the pointer points to a field that is declared <code>mutable</code>.)</p>\n\n<p>Go has a very simple type system.  Many languages have a complex type system in which you enforce the correctness of your program by writing types.  In many cases this means that a good deal of programming involves writing type declarations.  Go takes a different approach: most of your programming involves writing code, not types.  You write correct code by writing correct code, not by writing types that catch cases where you write incorrect code.  If you want to catch incorrect code, you write analyzers, like <code>go vet</code> that look for cases that are invalid in your code.  These kinds of analyzers are much much easier to write for Go than for C/C++, because the language is simpler.</p>\n\n<p>There are advantages and disadvantages to this kind of approach.  Go is making a clear choice here: write code, not types.  It's not the right choice for everyone.</p>\n"}], "owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "answer_count": 2, "score": 9, "last_activity_date": 1447702907, "creation_date": 1447528193, "last_edit_date": 1447528595, "question_id": 33712242, "link": "https://stackoverflow.com/questions/33712242/what-is-the-rationale-of-go-not-having-the-const-qualifier", "title": "What is the rationale of Go not having the const qualifier?", "body": "<p>I'm a C++ senior programmer. I'm currently doing some Go programming. The only feature I really miss is the const qualifier. In go, if you want to modify an object, you pass its pointer. If you don't want to modify it, you pass it by value. But if the struct is big, you should pass it by pointer, which overrides the no-modification feature. Worse, you can pass an object by value, but if it contains a pointer, you can actually modify its contents, with terrible race condition dangers. Some language types like maps and slices have this feature. This happens in a language that's supposed to be built for concurrency. So the issue of avoiding modification is really non-existent in Go, and you should pass small objects that <em>do not contain pointers</em> (you must be aware that the object does not contain a pointer) by value, if they aren't gonna be modified. </p>\n\n<p>With const, you can pass objects by const pointer and don't worrying about modification. Type-safety is about having a contract that allows speed and prevents type-related bugs. Another feature that does this too is the const qualifier. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1447525955, "post_id": 33711835, "comment_id": 55194983, "body": "What is the value of <a href=\"https://godoc.org/runtime#GOMAXPROCS\" rel=\"nofollow noreferrer\"><code>GOMAXPROCS</code></a>?"}, {"owner": {"reputation": 13, "user_id": 5562521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027841164e3962992e966cb08cc5b0a3?s=128&d=identicon&r=PG&f=1", "display_name": "morefree", "link": "https://stackoverflow.com/users/5562521/morefree"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1447526852, "post_id": 33711835, "comment_id": 55195280, "body": "I didn&#39;t set this variable, but inspired by you, I tried <code>GOMAXPROCS=2</code>,  and it shows race condition now (print &lt; 20000000).  So does that indicate the default value might be 1, which indicates only a single OS thread will be used to execute the code ?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5562521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027841164e3962992e966cb08cc5b0a3?s=128&d=identicon&r=PG&f=1", "display_name": "morefree", "link": "https://stackoverflow.com/users/5562521/morefree"}, "edited": false, "score": 0, "creation_date": 1447527211, "post_id": 33711982, "comment_id": 55195389, "body": "Thanks very much !  Yes my GOMAXPROCS is set to 1.   So for a large scale project where we may use go routine excessively,  should we have to manually specify the value of GOMAXPROCS ?   Not setting that value may result in a completely &quot;single thread&quot; program ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 13, "user_id": 5562521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027841164e3962992e966cb08cc5b0a3?s=128&d=identicon&r=PG&f=1", "display_name": "morefree", "link": "https://stackoverflow.com/users/5562521/morefree"}, "edited": false, "score": 0, "creation_date": 1447527402, "post_id": 33711982, "comment_id": 55195465, "body": "@morefree Please read the last paragraph of my answer. If you use Go 1.5+, it is set to the number of CPU cores by default. Using &lt;1.5, it is set to 1 by default."}, {"owner": {"reputation": 13, "user_id": 5562521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027841164e3962992e966cb08cc5b0a3?s=128&d=identicon&r=PG&f=1", "display_name": "morefree", "link": "https://stackoverflow.com/users/5562521/morefree"}, "edited": false, "score": 0, "creation_date": 1447527649, "post_id": 33711982, "comment_id": 55195555, "body": "Thanks a lot !  that&#39;s really helpful"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1471854959, "last_edit_date": 1471854959, "creation_date": 1447526685, "answer_id": 33711982, "question_id": 33711835, "link": "https://stackoverflow.com/questions/33711835/why-shared-int-variable-show-atomic-behavior-when-incrementing-it-in-go-routine/33711982#33711982", "title": "Why shared int variable show atomic behavior when incrementing it in go routine?", "body": "<p><a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow\"><code>runtime.GOMAXPROCS(0)</code></a> will report you the number of goroutines that can be run parallel. If the value is 1, you may not observe any \"side effect\" of not synchronizing the <code>counter</code> variable.</p>\n\n<p>If first at the beginning of your program you set it to <code>2</code>:</p>\n\n<pre><code>runtime.GOMAXPROCS(2)\n</code></pre>\n\n<p>You will immediately see the effect:</p>\n\n<pre><code>Count:  10319575\n</code></pre>\n\n<p>If you want to have proof of the race condition, supply the <code>-race</code> argument. The output with <code>-race</code>:</p>\n\n<pre><code>==================\nWARNING: DATA RACE\nRead by goroutine 6:\n  main.main.func1()\n      V:/workspace/IczaGo/src/play/play.go:20 +0x48\n\nPrevious write by main goroutine:\n  main.main()\n      V:/workspace/IczaGo/src/play/play.go:26 +0xef\n\nGoroutine 6 (running) created at:\n  main.main()\n      V:/workspace/IczaGo/src/play/play.go:23 +0xbc\n==================\n</code></pre>\n\n<p>(Note that the race detector only works with 64-bit Go distributions.)</p>\n\n<p>On the Go playground, GOMAXPROCS is <code>1</code> by default. This line will print the previous value and set it to <code>2</code>:</p>\n\n<pre><code>fmt.Println(\"Previous GOMAXPROCS:\", runtime.GOMAXPROCS(2))\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/qZy6s9J0y0\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>Previous GOMAXPROCS: 1\nCount:  12844130\n</code></pre>\n\n<p>Also note that GOMAXPROCS is set to <code>1</code> in Go distributions prior to 1.5. Starting with 1.5 the default value of GOMAXPROCS is the number of CPU cores available on the machine running the program.</p>\n"}], "owner": {"reputation": 13, "user_id": 5562521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027841164e3962992e966cb08cc5b0a3?s=128&d=identicon&r=PG&f=1", "display_name": "morefree", "link": "https://stackoverflow.com/users/5562521/morefree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 33711982, "answer_count": 1, "score": 1, "last_activity_date": 1471854959, "creation_date": 1447525816, "question_id": 33711835, "link": "https://stackoverflow.com/questions/33711835/why-shared-int-variable-show-atomic-behavior-when-incrementing-it-in-go-routine", "title": "Why shared int variable show atomic behavior when incrementing it in go routine?", "body": "<p>when I run the following code snippet below, it looks it always prints the value 20000000. It shows similar behavior when I create more go routines to increment the counter without lock. But shouldn't there exist some kind of race condition ?  Thanks !</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nconst (\nN_INCREMENTS = 10000000\n)\n\nfunc main() {\n\nvar counter int = 0\ndonechan := make(chan bool)\n\ngo func(done chan&lt;- bool) {\n    for i := 0; i &lt; N_INCREMENTS; i++ {\n        counter++\n    }\n    done &lt;- true\n}(donechan)\n\nfor i := 0; i &lt; N_INCREMENTS; i++ {\n    counter++\n}\n\n_ = &lt;-donechan\n\nfmt.Println(\"Count: \", counter)\n}\n</code></pre>\n"}, {"tags": ["hash", "go", "md5"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1447522133, "last_edit_date": 1447522133, "creation_date": 1447520801, "answer_id": 33711013, "question_id": 33710672, "link": "https://stackoverflow.com/questions/33710672/golang-encode-string-utf16-little-endian-and-hash-with-md5/33711013#33711013", "title": "Golang encode string UTF16 little endian and hash with MD5", "body": "<p>You can use the <a href=\"https://golang.org/pkg/unicode/utf16/\" rel=\"nofollow\"><code>unicode/utf16</code></a> package for UTF-16 encoding. <a href=\"https://golang.org/pkg/unicode/utf16/#Encode\" rel=\"nofollow\"><code>utf16.Encode()</code></a> returns the UTF-16 encoding of the Unicode code point sequence (slice of runes: <code>[]rune</code>). You can simply convert a <code>string</code> to a slice of runes, e.g. <code>[]rune(\"some string\")</code>, and you can easily produce the byte sequence of the little-endian encoding by ranging over the <code>uint16</code> codes and sending/appending first the low byte then the high byte to the output (this is what Little Endian means).</p>\n\n<p>For Little Endian encoding, alternatively you can use the <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow\"><code>encoding/binary</code></a> package: it has an exported <code>LittleEndian</code> variable and it has a <code>PutUint16()</code> method.</p>\n\n<p>As for the MD5 checksum, the <a href=\"https://golang.org/pkg/crypto/md5/\" rel=\"nofollow\"><code>crypto/md5</code></a> package has what you want, <a href=\"https://golang.org/pkg/crypto/md5/#Sum\" rel=\"nofollow\"><code>md5.Sum()</code></a> simply returns the MD5 checksum of the byte slice passed to it.</p>\n\n<p>Here's a little function that captures what you want to do:</p>\n\n<pre><code>func utf16leMd5(s string) [16]byte {\n    codes := utf16.Encode([]rune(s))\n    b := make([]byte, len(codes)*2)\n    for i, r := range codes {\n        b[i*2] = byte(r)\n        b[i*2+1] = byte(r &gt;&gt; 8)\n    }\n    return md5.Sum(b)\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>s := \"Hello, playground\"\nfmt.Printf(\"%x\\n\", utf16leMd5(s))\n\ns = \"\u30a8\u30cc\u30ac\u30df\"\nfmt.Printf(\"%x\\n\", utf16leMd5(s))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>8f4a54c6ac7b88936e990256cc9d335b\n5f0db9e9859fd27f750eb1a212ad6212\n</code></pre>\n\n<p>Try it on the <kbd><a href=\"http://play.golang.org/p/KprUniZXjv\" rel=\"nofollow\">Go Playground</a></kbd>.</p>\n\n<p>The variant that uses <code>encoding/binary</code> would look like this:</p>\n\n<pre><code>for i, r := range codes {\n    binary.LittleEndian.PutUint16(b[i*2:], r)\n}\n</code></pre>\n\n<p>(Although this is slower as it creates lots of new slice headers.)</p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 7, "last_activity_date": 1447521921, "creation_date": 1447521921, "answer_id": 33711198, "question_id": 33710672, "link": "https://stackoverflow.com/questions/33710672/golang-encode-string-utf16-little-endian-and-hash-with-md5/33711198#33711198", "title": "Golang encode string UTF16 little endian and hash with MD5", "body": "<p>You can do it with less work (or at least more understandability, IMO) by using <a href=\"http://golang.org/x/text/encoding\">golang.org/x/text/encoding</a> and <a href=\"http://golang.org/x/text/transform\">golang.org/x/text/transform</a> to create a Writer chain that will do the encoding and hashing without so much manual byte slice handling. The equivalent function:</p>\n\n<pre><code>func utf16leMd5(s string) []byte {\n    enc := unicode.UTF16(unicode.LittleEndian, unicode.IgnoreBOM).NewEncoder()\n    hasher := md5.New()\n    t := transform.NewWriter(hasher, enc)\n    t.Write([]byte(s))\n    return hasher.Sum(nil)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 2, "last_activity_date": 1447523594, "last_edit_date": 1447523594, "creation_date": 1447522750, "answer_id": 33711331, "question_id": 33710672, "link": "https://stackoverflow.com/questions/33710672/golang-encode-string-utf16-little-endian-and-hash-with-md5/33711331#33711331", "title": "Golang encode string UTF16 little endian and hash with MD5", "body": "<p>So, for reference, I used this complete python program:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import hashlib\nimport codecs\n\nmd5 = hashlib.md5()\nmd5.update(codecs.encode('Hello, playground', 'utf-16le'))\nresponse = md5.hexdigest()\nprint response\n</code></pre>\n\n<p>It prints <code>8f4a54c6ac7b88936e990256cc9d335b</code></p>\n\n<p>Here is the Go equivalent: <a href=\"https://play.golang.org/p/Nbzz1dCSGI\" rel=\"nofollow\">https://play.golang.org/p/Nbzz1dCSGI</a></p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"encoding/binary\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"unicode/utf16\"\n)\n\nfunc main() {\n    s := \"Hello, playground\"\n\n    fmt.Println(md5Utf16le(s))\n}\n\nfunc md5Utf16le(s string) string {\n    encoded := utf16.Encode([]rune(s))\n\n    b := convertUTF16ToLittleEndianBytes(encoded)\n\n    return md5Hexadecimal(b)\n}\n\nfunc md5Hexadecimal(b []byte) string {\n    h := md5.New()\n    h.Write(b)\n    return hex.EncodeToString(h.Sum(nil))\n}\n\nfunc convertUTF16ToLittleEndianBytes(u []uint16) []byte {\n    b := make([]byte, 2*len(u))\n    for index, value := range u {\n        binary.LittleEndian.PutUint16(b[index*2:], value)\n    }\n    return b\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5562259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bfb0f1233545373e24781db5dc2e7e?s=128&d=identicon&r=PG&f=1", "display_name": "phips", "link": "https://stackoverflow.com/users/5562259/phips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3205, "favorite_count": 0, "accepted_answer_id": 33711198, "answer_count": 3, "score": 4, "last_activity_date": 1447523594, "creation_date": 1447518811, "last_edit_date": 1447518902, "question_id": 33710672, "link": "https://stackoverflow.com/questions/33710672/golang-encode-string-utf16-little-endian-and-hash-with-md5", "title": "Golang encode string UTF16 little endian and hash with MD5", "body": "<p>I am a Go beginner and stuck with a problem.\nI want to encode a string with UTF16 little endian and then hash it with MD5 (hexadecimal). I have found a piece of Python code, which does exactly what I want. But I am not able to transfer it to Google Go.</p>\n\n<pre><code>md5 = hashlib.md5()\nmd5.update(challenge.encode('utf-16le'))\nresponse = md5.hexdigest()\n</code></pre>\n\n<p>The challenge is a variable containing a string.</p>\n"}, {"tags": ["windows", "winapi", "dll", "go"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5561887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74c3d3c71dc9001c062beb9fc427e1ae?s=128&d=identicon&r=PG&f=1", "display_name": "enugami", "link": "https://stackoverflow.com/users/5561887/enugami"}, "edited": false, "score": 0, "creation_date": 1447513684, "post_id": 33709631, "comment_id": 55191021, "body": "&gt;size is an in-out parameter   omg I don&#39;t know that. Thanks icza, now my code working fine."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 63, "user_id": 5561887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74c3d3c71dc9001c062beb9fc427e1ae?s=128&d=identicon&r=PG&f=1", "display_name": "enugami", "link": "https://stackoverflow.com/users/5561887/enugami"}, "edited": false, "score": 0, "creation_date": 1447514527, "post_id": 33709631, "comment_id": 55191261, "body": "@\u30a8\u30cc\u30ac\u30df Please see edited code, added error handling which greatly helps detecting errors."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1447679711, "last_edit_date": 1447679711, "creation_date": 1447512546, "answer_id": 33709631, "question_id": 33709033, "link": "https://stackoverflow.com/questions/33709033/golang-how-can-i-call-win32-api-without-cgo/33709631#33709631", "title": "Golang: how can I call win32 API without cgo?", "body": "<p><code>size</code> is an in-out parameter. When you make the call, you have to set it to the size of the buffer (<code>arr</code>). Also its type is <code>PULONG</code>, so in Go use <code>uint32</code>. Windows <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383751(v=vs.85).aspx#PULONG\" rel=\"noreferrer\"><code>PULONG</code></a> type is a pointer to a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383751(v=vs.85).aspx#ULONG\" rel=\"noreferrer\"><code>ULONG</code></a> (which has range <code>0..4294967295</code>). See <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724435(v=vs.85).aspx\" rel=\"noreferrer\">source</a>.</p>\n\n<p>Also <code>Call()</code> returns 3 values: </p>\n\n<pre><code>func (p *Proc) Call(a ...uintptr) (r1, r2 uintptr, lastErr error)\n</code></pre>\n\n<p>Store the returned <code>lastErr</code> and print it. Would you have done so, you would find the error earlier:</p>\n\n<pre><code>_, _, lastErr := GetUserNameEx.Call(\n    3, uintptr(unsafe.Pointer(&amp;arr[0])), uintptr(unsafe.Pointer(&amp;size)))\n\nfmt.Println(lastErr)\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>More data is available.\n</code></pre>\n\n<p>This means more data is available than what fits into the buffer you pass  - <em>or rather</em> - by the size you indicated with the in-out parameter <code>size</code> (you passed <code>0</code> as the <code>size</code>).</p>\n\n<p>Working code (note the division by 2 due to unicode and minus 1 for the terminating <code>'\\0'</code> byte / character for the size calculation):</p>\n\n<pre><code>arr := make([]uint8, 256)\nvar size uint32 = uint32(len(arr)) / 2 - 1\n_, _, lastErr := GetUserNameEx.Call(\n    3, uintptr(unsafe.Pointer(&amp;arr[0])), uintptr(unsafe.Pointer(&amp;size)))\n\nfmt.Println(lastErr)\nfmt.Println(string(arr))\nfmt.Println(arr)\nfmt.Println(size)\n</code></pre>\n\n<p>In this case <code>lastErr</code> will be:</p>\n\n<pre><code>The operation completed successfully.\n</code></pre>\n\n<p>To properly handle error:</p>\n\n<blockquote>\n  <p>The returned error is always non-<code>nil</code>, constructed from the result of <code>GetLastError</code>. Callers must inspect the primary return value to decide whether an error occurred (according to the semantics of the specific function being called) before consulting the error. The error will be guaranteed to contain <code>syscall.Errno</code>.</p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>r1, _, lastErr := GetUserNameEx.Call(\n    3, uintptr(unsafe.Pointer(&amp;arr[0])), uintptr(unsafe.Pointer(&amp;size)))\n\nif r1 == 0 {\n    fmt.Println(\"ERROR:\", lastErr.Error())\n    return\n}\n// No error, proceed to print/use arr\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5561887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74c3d3c71dc9001c062beb9fc427e1ae?s=128&d=identicon&r=PG&f=1", "display_name": "enugami", "link": "https://stackoverflow.com/users/5561887/enugami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4205, "favorite_count": 1, "accepted_answer_id": 33709631, "answer_count": 1, "score": 6, "last_activity_date": 1450124303, "creation_date": 1447508538, "last_edit_date": 1450124303, "question_id": 33709033, "link": "https://stackoverflow.com/questions/33709033/golang-how-can-i-call-win32-api-without-cgo", "title": "Golang: how can I call win32 API without cgo?", "body": "<p>I'm trying to call <code>GetUserNameEx</code> from <code>secur32.dll</code> like this:</p>\n\n<pre><code>dll, err := syscall.LoadDLL(\"secur32.dll\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer dll.Release()\n\nGetUserNameEx, err := dll.FindProc(\"GetUserNameExW\")\nif err != nil {\n    log.Fatal(err)\n}\narr := make([]uint8, 256)\nvar size uint\nGetUserNameEx.Call(3, uintptr(unsafe.Pointer(&amp;arr[0])), uintptr(unsafe.Pointer(&amp;size)))\nfmt.Println(arr)\nfmt.Println(size)\n</code></pre>\n\n<p>This code compiles fine, but <code>GetUserNameEx.Call()</code> will fail. I don't know why I cannot get <code>UserName</code>. Could anyone help me?</p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1447505963, "post_id": 33708512, "comment_id": 55188873, "body": "If you have the solution which works flawlessly, this question might be off-topic, and is better suited for <a href=\"http://codereview.stackexchange.com/\">Codereview</a>."}, {"owner": {"reputation": 118, "user_id": 1942454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285bbfff0de0962f61f4f7dd75a72a5b?s=128&d=identicon&r=PG", "display_name": "Kelvin Yong", "link": "https://stackoverflow.com/users/1942454/kelvin-yong"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1447511886, "post_id": 33708512, "comment_id": 55190497, "body": "Thanks @icza for pointing out codereview to me. I will check out the site."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1447519664, "post_id": 33708512, "comment_id": 55192974, "body": "In your real code, aren&#39;t the workers (<code>digTreasure()</code>) using some common input channel? Often this is the case and gives you a natural way of stopping routines."}, {"owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "edited": false, "score": 0, "creation_date": 1447657652, "post_id": 33708512, "comment_id": 55229011, "body": "<a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">blog.golang.org/context</a>"}, {"owner": {"reputation": 118, "user_id": 1942454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285bbfff0de0962f61f4f7dd75a72a5b?s=128&d=identicon&r=PG", "display_name": "Kelvin Yong", "link": "https://stackoverflow.com/users/1942454/kelvin-yong"}, "edited": false, "score": 0, "creation_date": 1447683360, "post_id": 33708512, "comment_id": 55243223, "body": "@tomaszm, the workers are already a common quit channel."}, {"owner": {"reputation": 118, "user_id": 1942454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285bbfff0de0962f61f4f7dd75a72a5b?s=128&d=identicon&r=PG", "display_name": "Kelvin Yong", "link": "https://stackoverflow.com/users/1942454/kelvin-yong"}, "edited": false, "score": 0, "creation_date": 1447683896, "post_id": 33708512, "comment_id": 55243585, "body": "I found another way that uses an unbuffered channel. In a real example, that works better. See <a href=\"http://play.golang.org/p/2zQ6yRPIWL\" rel=\"nofollow noreferrer\">example at Go Playground</a>."}], "owner": {"reputation": 118, "user_id": 1942454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/285bbfff0de0962f61f4f7dd75a72a5b?s=128&d=identicon&r=PG", "display_name": "Kelvin Yong", "link": "https://stackoverflow.com/users/1942454/kelvin-yong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 738, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1447504938, "creation_date": 1447504938, "question_id": 33708512, "link": "https://stackoverflow.com/questions/33708512/golang-signal-other-goroutines-to-stop-and-return-when-one-goroutine-has-found", "title": "Golang - signal other goroutines to stop and return when one goroutine has found the result", "body": "<p>I would like to speed up a certain task in Go by starting several worker goroutines.</p>\n\n<p>In the <a href=\"http://play.golang.org/p/Jt9OnEbVHt\" rel=\"nofollow\">example</a> below, I'm looking for a \"treasure\". Worker goroutines that are started will dig forever for items until they are told to stop. If the item is a wanted treasure, then it is placed onto a shared buffered channel with a capacity equals to the number of workers.</p>\n\n<p>The program is only interested in getting one treasure. It also has to make sure that all workers goroutines will return and not be blocked forever.</p>\n\n<p>The example works, but is there a cleaner or more idiomatic way to ensuring the above? </p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\nvar wg sync.WaitGroup\n\nfunc digTreasure() int {\n    time.Sleep(5 * time.Millisecond)\n    return rand.Intn(1000)\n}\n\nfunc worker(i int, ch chan int, quit chan struct{}) {\n    defer func() {\n        fmt.Println(\"worker\", i, \"left\")\n        wg.Done()\n    }()\n    for {\n        treasure := digTreasure()\n        if treasure%100 == 0 {\n            fmt.Println(\"worker\", i, \"found treasure\", treasure)\n            ch &lt;- treasure\n            return\n        }\n\n        select {\n        case &lt;-quit:\n            fmt.Println(\"worker\", i, \"quitting\")\n            return\n        default:\n        }\n    }\n}\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n\n    n := 10\n    ch, quit := make(chan int, n), make(chan struct{})\n    fmt.Println(\"Searching...\")\n\n    wg.Add(n)\n    for i := 0; i &lt; n; i++ {\n        go worker(i, ch, quit)\n    }\n    fmt.Println(\"I found treasure:\", &lt;-ch)\n    close(quit)\n    wg.Wait()\n    fmt.Println(\"All workers left\")\n}\n</code></pre>\n"}, {"tags": ["go", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 1399, "user_id": 536113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329f705a6d4ea0185f3aca9ee823d74?s=128&d=identicon&r=PG", "display_name": "vially", "link": "https://stackoverflow.com/users/536113/vially"}, "reply_to_user": {"reputation": 6068, "user_id": 2066736, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2447c18eff4efd9deb35284950d4a4b7?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2066736/john"}, "edited": false, "score": 0, "creation_date": 1447484468, "post_id": 33705989, "comment_id": 55184027, "body": "No problem. It happens :) Good thing there&#39;s a compiler catching these small mistakes."}], "tags": [], "owner": {"reputation": 1399, "user_id": 536113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329f705a6d4ea0185f3aca9ee823d74?s=128&d=identicon&r=PG", "display_name": "vially", "link": "https://stackoverflow.com/users/536113/vially"}, "is_accepted": true, "score": 1, "last_activity_date": 1447484345, "creation_date": 1447484345, "answer_id": 33705989, "question_id": 33705973, "link": "https://stackoverflow.com/questions/33705973/syntax-error-unexpected-name-expecting-semicolon-or-newline-or/33705989#33705989", "title": "syntax error: unexpected name, expecting semicolon or newline or }", "body": "<p>You are trying to access variables called <code>1back</code> and <code>2back</code> but your variables are actually called <code>back1</code> and <code>back2</code> </p>\n"}, {"tags": [], "owner": {"reputation": 341, "user_id": 3051115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a9ycQ.jpg?s=128&g=1", "display_name": "mmaraya", "link": "https://stackoverflow.com/users/3051115/mmaraya"}, "is_accepted": false, "score": 2, "last_activity_date": 1447503584, "creation_date": 1447503584, "answer_id": 33708340, "question_id": 33705973, "link": "https://stackoverflow.com/questions/33705973/syntax-error-unexpected-name-expecting-semicolon-or-newline-or/33708340#33708340", "title": "syntax error: unexpected name, expecting semicolon or newline or }", "body": "<p>Refactoring issues aside, keep in mind that variables in go must begin with a letter, not a number. <code>back1</code> and <code>back2</code> are valid go variables, but <code>1back</code> and <code>2back</code> are not. See <a href=\"https://golang.org/ref/spec#Identifiers\" rel=\"nofollow\">https://golang.org/ref/spec#Identifiers</a>. </p>\n"}], "owner": {"reputation": 6068, "user_id": 2066736, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2447c18eff4efd9deb35284950d4a4b7?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2066736/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1610, "favorite_count": 0, "accepted_answer_id": 33705989, "answer_count": 2, "score": 1, "last_activity_date": 1447503584, "creation_date": 1447484201, "last_edit_date": 1447485790, "question_id": 33705973, "link": "https://stackoverflow.com/questions/33705973/syntax-error-unexpected-name-expecting-semicolon-or-newline-or", "title": "syntax error: unexpected name, expecting semicolon or newline or }", "body": "<p>Just as a precursor I've just barely started learning Go recently. This is probably my 3rd day spending some time on it. I've been working with this error for a couple hours now, and I can't figure out what is wrong.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main () {\n  nextFib := fibGenerator();\n  fmt.Println(nextFib());\n  fmt.Println(nextFib());\n  fmt.Println(nextFib());\n  fmt.Println(nextFib());\n  fmt.Println(nextFib());\n}\n\nfunc fibGenerator () uint {\n  var (\n    n uint = 0\n    back1 uint = 1\n    back2 uint = 0\n  )\n\n  _computeFib := func () uint {\n    if n == 0 {\n      n++\n      return 0\n    } else if n == 1 {\n      n++\n      return 1\n    }\n    fib := 1back + 2back // throws compile time error on this line\n    2back = 1back\n    1back = n\n    n++\n    return fib\n  }\n\n  return _computeFib\n}\n</code></pre>\n\n<p>This is the error it throws: \nsyntax error: unexpected name, expecting semicolon or newline or }</p>\n\n<p>It's probably something simple, but with my limited knowledge in Go I can't put my finger on it. Any help would be appreciated.</p>\n\n<p><strong>EDIT</strong>:\nThis is the final working function besides renaming my variables like the accepted answer says I also had to make the generator return a function that returns an int. I also had an error w/ Fibonacci logic.</p>\n\n<pre><code>func fibGenerator () func() uint {\n  var (\n    n uint = 0\n    back1 uint = 1\n    back2 uint = 0\n  )\n\n  _computeFib := func () uint {\n    if n == 0 {\n      n++\n      return 0\n    } else if n == 1 {\n      n++\n      return 1\n    }\n    fib := back1 + back2\n    back2 = back1\n    back1 = fib\n    n++\n    return fib\n  }\n\n  return _computeFib\n}\n</code></pre>\n"}, {"tags": ["go", "base64"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 8, "last_activity_date": 1447465639, "creation_date": 1447465639, "answer_id": 33704274, "question_id": 33704251, "link": "https://stackoverflow.com/questions/33704251/illegal-base64-data-when-trying-to-base64-decode/33704274#33704274", "title": "&quot;illegal base64 data&quot; when trying to base64 decode", "body": "<p>Your input does not have any <a href=\"https://en.wikipedia.org/wiki/Base64#Padding\">padding</a>. Therefore, you should use <a href=\"https://godoc.org/encoding/base64#pkg-variables\"><code>base64.RawStdEncoding</code> over <code>base64.StdEncoding</code></a>:</p>\n\n<pre><code>data, err := base64.RawStdEncoding.DecodeString(s)\n</code></pre>\n\n<p>Example: <a href=\"https://play.golang.org/p/ZWfzYXQ5Ye\">https://play.golang.org/p/ZWfzYXQ5Ye</a></p>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1594, "favorite_count": 0, "accepted_answer_id": 33704274, "answer_count": 1, "score": 3, "last_activity_date": 1570723104, "creation_date": 1447465433, "last_edit_date": 1570723104, "question_id": 33704251, "link": "https://stackoverflow.com/questions/33704251/illegal-base64-data-when-trying-to-base64-decode", "title": "&quot;illegal base64 data&quot; when trying to base64 decode", "body": "<p>I tried to decode a valid (based on my understanding) base64 encoded string in Go with:</p>\n\n<pre><code>data, err := base64.StdEncoding.DecodeString(s)\nif err != nil {\n     ...\n}\n</code></pre>\n\n<p>A full <a href=\"https://play.golang.org/p/CvQtKW8qi6\" rel=\"nofollow\">example is here</a>. I have a string <code>\"eyJlbWFpbF9hZGRyZXNzIjoiIiwiZXhwIjoxNDQ3NzIzMzY4LCJmaXJzdG5hbWUiOiIiLCJpYXQiOjE0NDc0NjQxNjgsImlzcyI6Imh0dHA6Ly91ZGFjaXR5LmNvbSIsImtpZCI6ImE3ZTg5ZWQyMSIsImxhc3RuYW1lIjoiIiwidXNlcl9pZCI6IjEyMzQ1Njc4IiwidXNlcm5hbWUiOiJoYW5zb2xvQGhvdGguY29tIn0\"</code>, which can be properly decoded for example <a href=\"https://www.base64decode.org/\" rel=\"nofollow\">here</a>\nor even in your browser's console with <code>atob(that_string);</code>, but for some reason go complains with:</p>\n\n<p><code>illegal base64 data at input byte 236</code></p>\n\n<p>Notice, that I can decode some other strings. So why can not I base64decode a valid encoded string in Go?</p>\n"}, {"tags": ["api", "go"], "answers": [{"comments": [{"owner": {"reputation": 3563, "user_id": 1327678, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Wc6id.jpg?s=128&g=1", "display_name": "thatgibbyguy", "link": "https://stackoverflow.com/users/1327678/thatgibbyguy"}, "edited": false, "score": 0, "creation_date": 1447469764, "post_id": 33704225, "comment_id": 55181499, "body": "Your comment about the instance &quot;somewhere&quot; is exactly what&#39;s killing me. Instantiated where? How can I pass data from a method in one file to another is essentially the crux of my question."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 3563, "user_id": 1327678, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Wc6id.jpg?s=128&g=1", "display_name": "thatgibbyguy", "link": "https://stackoverflow.com/users/1327678/thatgibbyguy"}, "edited": false, "score": 1, "creation_date": 1447480170, "post_id": 33704225, "comment_id": 55183262, "body": "@thatgibbyguy You pass data from one method to another (or from one function to another) by calling the methods (or function) with the data as parameters. Well, that should be dead obvious. Note that Go has no &quot;file-based boundaries&quot; it does <b>not</b> matter in which file some method resides. (The package is important but all is fine for Exported stuff). The &quot;instantiated somewhere&quot; stuff: That depends, e.g in the Update handler, or in the global scope or some where else. That depends on what you are trying to do."}, {"owner": {"reputation": 3563, "user_id": 1327678, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Wc6id.jpg?s=128&g=1", "display_name": "thatgibbyguy", "link": "https://stackoverflow.com/users/1327678/thatgibbyguy"}, "edited": false, "score": 0, "creation_date": 1447601251, "post_id": 33704225, "comment_id": 55212522, "body": "Actually, no the UpdateForm method should have two parameters - ID and DB because the ID should be passed to yet another function."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1447602728, "post_id": 33704225, "comment_id": 55212962, "body": "I was just saying your code wasn&#39;t consistent because at declaration the Save() method receives only one argument db."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 1, "last_activity_date": 1447465099, "creation_date": 1447465099, "answer_id": 33704225, "question_id": 33703642, "link": "https://stackoverflow.com/questions/33703642/how-can-i-pass-data-from-controller-to-form-in-go-lang/33704225#33704225", "title": "How can I pass data from controller to form in go lang?", "body": "<p>I think it has nothing to do with the handler, but your code isn't consistent. This line</p>\n\n<pre><code>UpdateForm.Save(ID,db)\n</code></pre>\n\n<p>The method <code>Save()</code> takes two arguments, while the original method signature takes only a single <code>mongo.Database</code> type argument.</p>\n\n<p>Here is what I assume was your intention:</p>\n\n<pre><code>type UpdateForm struct {\n    ID     string   `json:\"type\"`\n}\n\nfunc (u UpdateForm) Save(db mongo.Database) {\n    id := u.ID\n    repository.Update(id)\n}\n\n// UpdateForm instance somewhere\nvar u = UpdateForm{}\n\nfunc UpdateHandler(request *http.Request) {\n    u.ID := mux.Vars(request)[\"ID\"]\n    u.Save(db)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1399, "user_id": 536113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329f705a6d4ea0185f3aca9ee823d74?s=128&d=identicon&r=PG", "display_name": "vially", "link": "https://stackoverflow.com/users/536113/vially"}, "is_accepted": false, "score": 2, "last_activity_date": 1447480297, "creation_date": 1447480297, "answer_id": 33705569, "question_id": 33703642, "link": "https://stackoverflow.com/questions/33703642/how-can-i-pass-data-from-controller-to-form-in-go-lang/33705569#33705569", "title": "How can I pass data from controller to form in go lang?", "body": "<p>You can populate your form using data from the request. If your request contains a JSON encoded body than you could decode it into your form object like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"net/http\"\n    \"strings\"\n    \"fmt\"\n)\n\ntype UpdateForm struct {\n    ID string `json:\"type\"`\n}\n\nfunc main() {\n    req, _ := http.NewRequest(\n        \"POST\",\n        \"http://example.com\",\n        strings.NewReader(`{\"type\": \"foo\"}`),\n    )\n\n    var form *UpdateForm\n    json.NewDecoder(req.Body).Decode(&amp;form)\n    fmt.Println(form.ID) // Output: foo\n}\n</code></pre>\n\n<p>Or you can instantiate it directly like this:</p>\n\n<pre><code>func UpdateHandler(request *http.Request) {\n    ID := mux.Vars(request)[\"ID\"]\n    form := &amp;UpdateForm{ID: ID}\n    form.Save()\n}\n</code></pre>\n"}], "owner": {"reputation": 3563, "user_id": 1327678, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Wc6id.jpg?s=128&g=1", "display_name": "thatgibbyguy", "link": "https://stackoverflow.com/users/1327678/thatgibbyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1447480297, "creation_date": 1447459529, "question_id": 33703642, "link": "https://stackoverflow.com/questions/33703642/how-can-i-pass-data-from-controller-to-form-in-go-lang", "title": "How can I pass data from controller to form in go lang?", "body": "<p>I have a handler / controller that takes in an http request.</p>\n\n<pre><code>func UpdateHandler(request *http.Request) {\n    ID := mux.Vars(request)[\"ID\"]\n    UpdateForm.Save(ID,db)\n}\n</code></pre>\n\n<p>Then I have a form that I want to process the data and eventually update it.</p>\n\n<pre><code>type UpdateForm struct {\n    ID              string            `json:\"type\"`\n}\n\nfunc (UpdateForm) Save(db mongo.Database) {\n    id := ID\n    repository.Update(Id)\n}\n</code></pre>\n\n<p>Go will print out <code>undefined ID</code></p>\n\n<p>How can I make sure that the form gets the value from the controller?</p>\n"}, {"tags": ["json", "struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 1, "last_activity_date": 1447454001, "creation_date": 1447454001, "answer_id": 33702853, "question_id": 33702630, "link": "https://stackoverflow.com/questions/33702630/issue-with-using-custom-json-marshal-for-embedded-structs/33702853#33702853", "title": "Issue with using custom JSON Marshal() for Embedded Structs", "body": "<p>By embedding <code>Timestamp</code> in <code>Company</code> you not only shared member variables, but also the methods. This means you provided <code>Company.MarshalJSON</code> method, which is then used by <code>json</code> package for marshalling the whole structure. In order to see all the fields you would need to implement an explicit marshaler for <code>Company</code> structure as well.</p>\n\n<p>If you only want to format the timestamp in a specific way, the other solution would be to provide your own <code>time.Time</code> and providing JSON marshaller there.</p>\n\n<p>For example:</p>\n\n<pre><code>type AccessTime time.Time\n\nfunc (t AccessTime) MarshalJSON() ([]byte, error) {\n    return json.Marshal(time.Time(t).Format(\"Monday Jan _2 15:04:05 2006\"))\n}\n\ntype Timestamp struct {\n    Created  AccessTime\n    Modified AccessTime\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/PhZXPauSyz\" rel=\"nofollow\">https://play.golang.org/p/PhZXPauSyz</a></p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 5, "last_activity_date": 1447454134, "creation_date": 1447454134, "answer_id": 33702877, "question_id": 33702630, "link": "https://stackoverflow.com/questions/33702630/issue-with-using-custom-json-marshal-for-embedded-structs/33702877#33702877", "title": "Issue with using custom JSON Marshal() for Embedded Structs", "body": "<p>When a type embedded in a struct provides a method, that method becomes a part of the embedding struct. Since <code>Company</code> embeds <code>Timestamp</code>, <code>Timestamp</code>'s <code>MarshalJSON</code> is available for <code>Company</code> as well. When json is looking to marshal a <code>Company</code> it sees that it has a <code>MarshalJSON</code> method and calls it \u2014 and the method it finds only marshals the timestamp field. The default behavior of structs (to marshal each field into its own key in a JSON object) is overridden.</p>\n\n<p>What you can do:</p>\n\n<ol>\n<li>Don't use struct embedding, just make <code>Timestamp</code> a regular field (even if you declare it as <code>Timestamp Timestamp</code>). Then <code>Company</code> won't inherit its methods and JSON will work as expected (but other parts of your code that expect embedding might change). Or:</li>\n<li>Give <code>Company</code> its own <code>MarshalJSON</code> method that marshalls all of the fields including the timestamp. You could do this by<br>\na. Copying the fields into a different type that is identical to <code>Company</code> but without the embedding, and marshalling that.<br>\nb. Copying the fields into a map and marshalling that.<br>\nc. Marshalling each of the fields independently and string-pasting <code>fmt.Sprintf(<code>{\"key1\":%s,\"key2\":%s,...}</code>, m1, m2, ...)</code> yourself.</li>\n</ol>\n"}], "owner": {"reputation": 3730, "user_id": 464064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5b106b3ab0dfec1dcc591dd7b8d309fb?s=128&d=identicon&r=PG", "display_name": "John F.", "link": "https://stackoverflow.com/users/464064/john-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 2, "accepted_answer_id": 33702877, "answer_count": 2, "score": 6, "last_activity_date": 1447457386, "creation_date": 1447452804, "last_edit_date": 1447457386, "question_id": 33702630, "link": "https://stackoverflow.com/questions/33702630/issue-with-using-custom-json-marshal-for-embedded-structs", "title": "Issue with using custom JSON Marshal() for Embedded Structs", "body": "<p>I am attempting to define a custom JSON marshaler to display some time information in specific formats. Ideally, I'd like to have a struct that stores created/modified values and then embed them into structs that need to keep track of that information. In addition, I want to define a custom date format in the JSON marshaler to use from a client-side application.</p>\n\n<p>I currently have two structs</p>\n\n<pre><code>type Timestamp struct {\n    Created time.Time\n    Modified time.Time\n}\n\ntype Company struct {\n    Id string\n    Name string\n    Timestamp    \n}\n</code></pre>\n\n<p>I want to embed the Timestamp struct into objects that will need to record when items are updated/created. Nothing insane there.</p>\n\n<p>My issues comes when I define</p>\n\n<pre><code>func (t Timestamp) MarshalJSON() ([]byte, error) {\n    return json.Marshal(struct {\n        CreatedFormatted string\n    }{\n        CreatedFormatted: t.Created.Format(\"Monday Jan _2 15:04:05 2006\"),\n    })\n}\n</code></pre>\n\n<p>When I go to marshal <code>Company</code>, I only see the json for the Timestamp but nothing for the Company. I would have thought that the contents of the Company struct <strong>and</strong> the Timestamp struct would have been displayed. Am I doing something wrong here?</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 3, "last_activity_date": 1447473807, "last_edit_date": 1447473807, "creation_date": 1447472812, "answer_id": 33704885, "question_id": 33702558, "link": "https://stackoverflow.com/questions/33702558/what-is-the-best-way-to-work-around-the-overhead-of-reflection/33704885#33704885", "title": "What is the best way to work around the overhead of reflection?", "body": "<p>With #1, to be concurrency-safe you'd need a pool of those \"template-struct\" or at least a mutex protecting it. That adds some overhead and can be tricky to debug.</p>\n\n<p>#3 is a nightmare to maintain.</p>\n\n<p>I would go with #2. The running code will be fast, concurrency-safe and easy to debug. \nOnce your tool is setup, a change in your struct only requires running a command line to update the setters.</p>\n"}], "owner": {"reputation": 769, "user_id": 294916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1a9637acaccba514bf6c2cecf80c3f16?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/294916/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1610474540, "creation_date": 1447452505, "last_edit_date": 1447453207, "question_id": 33702558, "link": "https://stackoverflow.com/questions/33702558/what-is-the-best-way-to-work-around-the-overhead-of-reflection", "title": "What is the best way to work around the overhead of reflection?", "body": "<p>I have a program that reads 173 (c) data structures from a memory map that need to be converted to Go. The value of the type is stored as a string in those structures. The structures are received 60 times per second.</p>\n\n<p>I'm now using reflection (<code>FieldByName</code>) to get a reference to the go struct field and set the received data. But because there a many fields (173) and they get updated a lot this ads a lot of overhead and that function call is the slowest part of my program (jay <code>go prof</code>!).</p>\n\n<p>What is the best way to make this faster? As far as I can see I have three options:</p>\n\n<ol>\n<li>cache the <code>reflect.Value</code>'s in a map and make a function that receives data, use a template struct tied to the cache map, fill that struct and return a copy of that template-struct</li>\n<li><code>go generate</code> all the setters and a giant switch statement for each received field</li>\n<li>Just code all the different setters</li>\n</ol>\n\n<p>What would be the \"best\" option? Is there an option I'm overlooking?</p>\n"}, {"tags": ["go", "hashmap", "key"], "comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 1, "creation_date": 1447471641, "post_id": 33701828, "comment_id": 55181817, "body": "I am no <code>Ruby</code> expert, so I could be missing something. But I don&#39;t think it has functionality to look up <code>keys</code> by <code>values</code>. To get a <code>key</code> corresponding to given <code>value</code>, I would do something like this: <code>hashMap.invert[value]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 91, "user_id": 5542323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2107f5baaf1e0220be4fe28985ef946?s=128&d=identicon&r=PG&f=1", "display_name": "hhh", "link": "https://stackoverflow.com/users/5542323/hhh"}, "edited": false, "score": 0, "creation_date": 1447451570, "post_id": 33702094, "comment_id": 55176834, "body": "@hhh: No problem. Remember to <a href=\"http://stackoverflow.com/help/someone-answers\">accept answers</a> on your questions."}, {"owner": {"reputation": 91, "user_id": 5542323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2107f5baaf1e0220be4fe28985ef946?s=128&d=identicon&r=PG&f=1", "display_name": "hhh", "link": "https://stackoverflow.com/users/5542323/hhh"}, "edited": false, "score": 0, "creation_date": 1447451902, "post_id": 33702094, "comment_id": 55177014, "body": "got it! ... kind new to so"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 12, "last_activity_date": 1447450229, "creation_date": 1447450229, "answer_id": 33702094, "question_id": 33701828, "link": "https://stackoverflow.com/questions/33701828/simple-way-of-getting-key-depending-on-value-from-hashmap-in-golang/33702094#33702094", "title": "Simple way of getting key depending on value from hashmap in Golang", "body": "<p>There is no built-in function to do this; you will have to make your own. Below is an example function that will work for <code>map[string]int</code>, which you can adapt for other map types:</p>\n\n<pre><code>func mapkey(m map[string]int, value int) (key string, ok bool) {\n  for k, v := range m {\n    if v == value { \n      key = k\n      ok = true\n      return\n    }\n  }\n  return\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>key, ok := mapkey(hashMap, value)\nif !ok {\n  panic(\"value does not exist in map\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 9, "last_activity_date": 1447471169, "creation_date": 1447471169, "answer_id": 33704751, "question_id": 33701828, "link": "https://stackoverflow.com/questions/33701828/simple-way-of-getting-key-depending-on-value-from-hashmap-in-golang/33704751#33704751", "title": "Simple way of getting key depending on value from hashmap in Golang", "body": "<p>The important question is: How many times will you have to look up the value? </p>\n\n<p>If you only need to do it once, then you can iterate over the key, value pairs and keep the key (or keys) that match the value.</p>\n\n<p>If you have to do the look up often, then I would suggest you make another map that has key, values reversed (assuming all keys map to unique values), and use that for look up. </p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 7461738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D0yKjXEU0zI/AAAAAAAAAAI/AAAAAAAAACE/2YFhu24oiB0/photo.jpg?sz=128", "display_name": "Louki Sumirniy", "link": "https://stackoverflow.com/users/7461738/louki-sumirniy"}, "is_accepted": false, "score": 0, "last_activity_date": 1529141051, "creation_date": 1529141051, "answer_id": 50886607, "question_id": 33701828, "link": "https://stackoverflow.com/questions/33701828/simple-way-of-getting-key-depending-on-value-from-hashmap-in-golang/50886607#50886607", "title": "Simple way of getting key depending on value from hashmap in Golang", "body": "<p>I am in the midst of working on a server based on bitcoin and there is a list of constants and byte codes for the payment scripts. In the C++ version it has both identifiers with the codes and then another function that returns the string version. So it's really not much extra work to just take the original, with opcodes as string keys and the byte as value, and then reverse the order. The only thing that niggles me is duplicate keys on values. But since those are just true and false, overlapping zero and one, all of the first index of the string slice are the numbers and opcodes, and the truth values are the second index.</p>\n\n<p>To iterate the list every time to identify the script command to execute would cost on average 50% of the map elements being tested. It's much simpler to just have a reverse lookup table. Executing the scripts has to be done maybe up to as much as 10,000 times on a full block so it makes no sense to save memory and pay instead in processing.</p>\n"}], "owner": {"reputation": 91, "user_id": 5542323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2107f5baaf1e0220be4fe28985ef946?s=128&d=identicon&r=PG&f=1", "display_name": "hhh", "link": "https://stackoverflow.com/users/5542323/hhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9415, "favorite_count": 0, "accepted_answer_id": 33702094, "answer_count": 3, "score": 5, "last_activity_date": 1600003310, "creation_date": 1447449133, "last_edit_date": 1600003310, "question_id": 33701828, "link": "https://stackoverflow.com/questions/33701828/simple-way-of-getting-key-depending-on-value-from-hashmap-in-golang", "title": "Simple way of getting key depending on value from hashmap in Golang", "body": "<p>Given a hashmap in Golang which has a key and a value, what is the simplest way of retrieving the key given the value?</p>\n<p>For example Ruby equivalent would be\n<code>key = hashMap.key(value)</code></p>\n"}, {"tags": ["pointers", "go", "interface", "nested"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1447446208, "creation_date": 1447446208, "answer_id": 33701175, "question_id": 33700793, "link": "https://stackoverflow.com/questions/33700793/assert-interface-with-nested-struct-pointer/33701175#33701175", "title": "Assert interface with nested struct pointer", "body": "<p>In debugging your code I arrived at this (still broken state) which clearly shows what is problematic with your implementation; <a href=\"https://play.golang.org/p/MnyDxKvJsK\" rel=\"nofollow\">https://play.golang.org/p/MnyDxKvJsK</a></p>\n\n<p>The second link has the issue resolved. Basically, your type didn't actually implement the interface because of your return type. Yes the return type implements the interface, but it's <em>not an instance</em> of the interface. Look closely at the code below;</p>\n\n<pre><code>// your version *MyNestedStruct != MyNestedInterface\nfunc (this *MyStruct) GetNested() *MyNestedStruct {\n    return this.nested\n}\n\ntype MyInterface interface{\n    GetNested() MyNestedInterface\n}\n\n//my version\nfunc (this *MyStruct) GetNested() MyNestedInterface {\n    return this.nested\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/uf2FfvbATb\" rel=\"nofollow\">https://play.golang.org/p/uf2FfvbATb</a></p>\n"}], "owner": {"reputation": 389, "user_id": 3862502, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/26Xeo.jpg?s=128&g=1", "display_name": "tyftler", "link": "https://stackoverflow.com/users/3862502/tyftler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 1, "accepted_answer_id": 33701175, "answer_count": 1, "score": 0, "last_activity_date": 1447446208, "creation_date": 1447444576, "question_id": 33700793, "link": "https://stackoverflow.com/questions/33700793/assert-interface-with-nested-struct-pointer", "title": "Assert interface with nested struct pointer", "body": "<p>I need to assign the struct to an interface{} (a) and then assert it again (b) like in my example. I need MyStruct and MyNestedStruct to be convertible.</p>\n\n<p><a href=\"https://play.golang.org/p/LSae9dasJI\" rel=\"nofollow\">https://play.golang.org/p/LSae9dasJI</a></p>\n\n<p>How can I do that?</p>\n"}, {"tags": ["go", "docker", "docker-registry"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1447436971, "post_id": 33696277, "comment_id": 55169475, "body": "Your example code worked for me. Go1.5.1 linux/amd64 : <a href=\"http://pastebin.com/XwfV0MY8\" rel=\"nofollow noreferrer\">pastebin.com/XwfV0MY8</a>"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1447437037, "post_id": 33696277, "comment_id": 55169517, "body": "Can you <code>kill -ABRT &lt;pid&gt;</code> your program to get us the stack traces please? (see <a href=\"http://pro-tips-dot-com.tumblr.com/post/47677612115/kill-a-hung-go-process-and-print-stack-traces\" rel=\"nofollow noreferrer\">pro-tips-dot-com.tumblr.com/post/47677612115/&hellip;</a>)"}, {"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 1, "creation_date": 1447443644, "post_id": 33696277, "comment_id": 55172950, "body": "<a href=\"http://pastebin.ubuntu.com/13250025/\" rel=\"nofollow noreferrer\">pastebin.ubuntu.com/13250025</a>"}, {"owner": {"reputation": 1399, "user_id": 536113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4329f705a6d4ea0185f3aca9ee823d74?s=128&d=identicon&r=PG", "display_name": "vially", "link": "https://stackoverflow.com/users/536113/vially"}, "edited": false, "score": 1, "creation_date": 1447481766, "post_id": 33696277, "comment_id": 55183519, "body": "@mynameismevin From your log it seems that it&#39;s actually pulling from the registry. Are you sure that you&#39;ve waited enough time so that the image has enough time to download? Also, can you check your network activity while the script is running to see if it&#39;s actually performing the pull?"}, {"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 0, "creation_date": 1447623288, "post_id": 33696277, "comment_id": 55220005, "body": "That fixed it. Closing."}], "answers": [{"tags": [], "owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "is_accepted": false, "score": 0, "last_activity_date": 1447623321, "creation_date": 1447623321, "answer_id": 33725348, "question_id": 33696277, "link": "https://stackoverflow.com/questions/33696277/downloading-images-from-custom-registry-with-go-dockerclient-hangs/33725348#33725348", "title": "Downloading images from custom registry with go-dockerclient hangs", "body": "<p>There were networking issues that were preventing the download.</p>\n"}], "owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447623321, "creation_date": 1447428804, "question_id": 33696277, "link": "https://stackoverflow.com/questions/33696277/downloading-images-from-custom-registry-with-go-dockerclient-hangs", "title": "Downloading images from custom registry with go-dockerclient hangs", "body": "<p>I cannot seem to pull from a custom registry. Am I doing it wrong? I know those images exist, I can download them manually.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/fsouza/go-dockerclient\"\n    log \"github.com/Sirupsen/logrus\"\n)\n\nfunc main() {\n    log.SetFormatter(&amp;log.JSONFormatter{})\n    log.Infoln(\"pulling remote images.\")\n    pull_images()\n    log.Infoln(\"done.\")\n}\n\nvar (\n    gcr = \"gcr.io/google_containers/\"\n\n    fluentd = docker.PullImageOptions{\n        Repository: \"fluentd-elasticsearch\",\n        Registry: gcr,\n        RawJSONStream: true,\n    }\n    local_images = []docker.PullImageOptions{fluentd,{...}} // there is a long list of image, truncated for example.\n)\n\nfunc pull_images() {\n    // empty config as it is not needed at this point.\n    auth := docker.AuthConfiguration{}\n\n    client, err := docker.NewClientFromEnv()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, image := range local_images {\n        log.Infof(\"pulling %s%s\", image.Registry, image.Repository)\n        err = client.PullImage(image, auth)\n        if err != nil {\n            log.Warnln(err)\n        }\n    }\n}\n</code></pre>\n\n<p>It works if I specify the <code>docker.io</code> registry and use the Ubuntu image, but it's not working with the Google one. I can manually pull images with <code>docker pull -a gcr.io/google_containers/fluentd-elasticsearch</code>, so I know it exists and is actively available. I haven't logged into the Google registry with my docker client, so I know that anonymous pulls are allowed.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 4, "creation_date": 1447429688, "post_id": 33696296, "comment_id": 55164636, "body": "He&#39;s using Go. Tag is the main indicator here, although it was also mentioned in the question."}, {"owner": {"reputation": 743, "user_id": 6736591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w8ZvL.jpg?s=128&g=1", "display_name": "Nakamoto", "link": "https://stackoverflow.com/users/6736591/nakamoto"}, "edited": false, "score": 0, "creation_date": 1611883663, "post_id": 33696296, "comment_id": 116600436, "body": "Ricky you&#39;re welcome here anyway."}], "tags": [], "owner": {"reputation": 249, "user_id": 5517995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ce44aece190e46852520f6a920d1454c?s=128&d=identicon&r=PG&f=1", "display_name": "Rickybobby", "link": "https://stackoverflow.com/users/5517995/rickybobby"}, "is_accepted": false, "score": -17, "last_activity_date": 1447428866, "creation_date": 1447428866, "answer_id": 33696296, "question_id": 33696034, "link": "https://stackoverflow.com/questions/33696034/make-first-letter-of-words-uppercase-in-a-string/33696296#33696296", "title": "Make first letter of words uppercase in a string", "body": "<p>Well you didn't specify the language you're using, so I'll give you a general answer. You have an array with a bunch of strings in it. First I'd make the entire string lower case, then just go through each character in the string (capitalize the first one, rest stay lower case). At this point you need to look for the space, this will help you divide up the words in each string. The first character after finding a space is obviously a different word and should be capitalized. You can verify the next word isn't  and in with Or a as well.</p>\n\n<p>I'm not at a computer so I can't give to a specific example, but I hope this gets to in the right direction at least</p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 13, "last_activity_date": 1447430528, "last_edit_date": 1447430528, "creation_date": 1447429499, "answer_id": 33696519, "question_id": 33696034, "link": "https://stackoverflow.com/questions/33696034/make-first-letter-of-words-uppercase-in-a-string/33696519#33696519", "title": "Make first letter of words uppercase in a string", "body": "<p>You can use <a href=\"https://golang.org/pkg/regexp\" rel=\"noreferrer\">regular expressions</a> for this task. A <code>\\w+</code> regexp will match all the words, then by using <code>Regexp.ReplaceAllStringFunc</code> you can replace the words with intended content, skipping stop words. In your case, <code>strings.ToLower</code> and <code>strings.Title</code> will be also helpful.</p>\n\n<p>Example:</p>\n\n<pre><code>str := \"INTEGRATED ENGINEERING 5 Year (BSC with a Year in Industry)\"\n\n// Function replacing words (assuming lower case input)\nreplace := func(word string) string {\n    switch word {\n    case \"with\", \"in\", \"a\":\n        return word\n    }\n    return strings.Title(word)\n}\n\nr := regexp.MustCompile(`\\w+`)\nstr = r.ReplaceAllStringFunc(strings.ToLower(str), replace)\n\nfmt.Println(str)\n\n// Output:\n// Integrated Engineering 5 Year (Bsc with a Year in Industry)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/uMag7buHG8\" rel=\"noreferrer\">https://play.golang.org/p/uMag7buHG8</a></p>\n\n<p>You can easily adapt this to your <em>array of strings</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 1511, "user_id": 742167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303211595dd5a1de71e34356ec6e7b24?s=128&d=identicon&r=PG", "display_name": "boug", "link": "https://stackoverflow.com/users/742167/boug"}, "edited": false, "score": 5, "creation_date": 1478097682, "post_id": 40382340, "comment_id": 68017225, "body": "you probably want to lowercase the text first before calling the Title func"}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 2, "creation_date": 1490736319, "post_id": 40382340, "comment_id": 73243663, "body": "How does the answer addresses exceptions mentioned in the question? (and, in a, with)"}, {"owner": {"reputation": 18578, "user_id": 4031815, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a945fa2f0e9ecbcf3f670e0865fa7169?s=128&d=identicon&r=PG&f=1", "display_name": "CommonSenseCode", "link": "https://stackoverflow.com/users/4031815/commonsensecode"}, "edited": false, "score": 0, "creation_date": 1544974167, "post_id": 40382340, "comment_id": 94455780, "body": "strings.Title(&quot;capitlize me&quot;)"}, {"owner": {"reputation": 493, "user_id": 991883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5hEj.jpg?s=128&g=1", "display_name": "Nhan Tran", "link": "https://stackoverflow.com/users/991883/nhan-tran"}, "edited": false, "score": 5, "creation_date": 1572404929, "post_id": 40382340, "comment_id": 103545539, "body": "Be careful with this function, the strings.Title also make character after <code>&#39;</code> upcase. e.g: <code>strings.Title(&quot;capitlize&#39;s me&quot;)</code> =&gt; <code>Capitlize&#39;S Me</code>"}], "tags": [], "owner": {"reputation": 1511, "user_id": 742167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303211595dd5a1de71e34356ec6e7b24?s=128&d=identicon&r=PG", "display_name": "boug", "link": "https://stackoverflow.com/users/742167/boug"}, "is_accepted": true, "score": 98, "last_activity_date": 1570403836, "last_edit_date": 1570403836, "creation_date": 1478096616, "answer_id": 40382340, "question_id": 33696034, "link": "https://stackoverflow.com/questions/33696034/make-first-letter-of-words-uppercase-in-a-string/40382340#40382340", "title": "Make first letter of words uppercase in a string", "body": "<p>There is a function in the built-in <code>strings</code> package called <a href=\"https://golang.org/pkg/strings/#Title\" rel=\"noreferrer\"><code>Title</code></a>.</p>\n\n<p>please see <a href=\"https://play.golang.org/p/07dl3hMuGH\" rel=\"noreferrer\">https://play.golang.org/p/07dl3hMuGH</a></p>\n\n<pre><code>s := \"INTEGRATED ENGINEERING 5 Year (BSC with a Year in Industry)\"\nfmt.Println(strings.Title(strings.ToLower(s)))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/GLMVV10-4eX\" rel=\"noreferrer\">https://play.golang.org/p/GLMVV10-4eX</a></p>\n"}], "owner": {"reputation": 521, "user_id": 5142896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a6bbe0b8d0b678f1fb3b95493d42e8?s=128&d=identicon&r=PG&f=1", "display_name": "Conor", "link": "https://stackoverflow.com/users/5142896/conor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51282, "favorite_count": 5, "accepted_answer_id": 40382340, "answer_count": 3, "score": 38, "last_activity_date": 1592972813, "creation_date": 1447428122, "question_id": 33696034, "link": "https://stackoverflow.com/questions/33696034/make-first-letter-of-words-uppercase-in-a-string", "title": "Make first letter of words uppercase in a string", "body": "<p>I have a large array of strings such as this one:</p>\n\n<p>'INTEGRATED ENGINEERING 5 Year (BSC with a Year in Industry)'</p>\n\n<p>I want to capitalise the first letter of the words and make the rest of the words lowercase. So 'INTEGRATED' would become 'Integrated'.</p>\n\n<p>A second spanner in the works - I want an exception to a few words such as 'and', 'in', 'a', 'with'. </p>\n\n<p>So the above example would become:</p>\n\n<p>Integrated Engineering 5 Year (Bsc with a Year in Industry).</p>\n\n<p>How would I do this in Go? I can code the loop/arrays to manage the change but the actual string conversion is what I struggle with.</p>\n"}, {"tags": ["google-app-engine", "authentication", "go"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5559226, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2db6ec22bed47d6ba22da0fd9df3c75d?s=128&d=identicon&r=PG&f=1", "display_name": "David Kane", "link": "https://stackoverflow.com/users/5559226/david-kane"}, "edited": false, "score": 0, "creation_date": 1447446272, "post_id": 33696100, "comment_id": 55174321, "body": "That&#39;s really interesting and something I hadn&#39;t come across before. Definitely going to check it out."}], "tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": true, "score": 3, "last_activity_date": 1466165765, "last_edit_date": 1495539963, "creation_date": 1447428278, "answer_id": 33696100, "question_id": 33695307, "link": "https://stackoverflow.com/questions/33695307/google-app-engine-golang-register-users-without-google-account/33696100#33696100", "title": "Google App Engine Golang - Register Users Without Google Account", "body": "<p>IMHO it's easier to use an existing, reputable infrastructure/service.\nGoogle offers such services, see <a href=\"https://stackoverflow.com/questions/25442786/what-is-the-difference-between-google-identity-toolkit-google-oaauth-and-google/31053422#31053422\">What is the difference between Google identity toolkit, Google OAauth and Google+ sign in</a>.</p>\n\n<p>I opted for the <a href=\"https://developers.google.com/identity/toolkit/web/\" rel=\"nofollow noreferrer\">Google Identity Toolkit</a>, which nicely supports simultaneously both private accounts and federated logins with several popular identity providers.</p>\n\n<p><strong>Update June 17, 2016</strong>: The banner on the GITkit doumentation authentication indicates GITkit may be on its way out, to be absorbed into the <a href=\"https://firebase.google.com/docs/auth/\" rel=\"nofollow noreferrer\">Firebase Authentication</a>.</p>\n"}], "owner": {"reputation": 81, "user_id": 5559226, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2db6ec22bed47d6ba22da0fd9df3c75d?s=128&d=identicon&r=PG&f=1", "display_name": "David Kane", "link": "https://stackoverflow.com/users/5559226/david-kane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 1, "accepted_answer_id": 33696100, "answer_count": 1, "score": 3, "last_activity_date": 1466165765, "creation_date": 1447425905, "question_id": 33695307, "link": "https://stackoverflow.com/questions/33695307/google-app-engine-golang-register-users-without-google-account", "title": "Google App Engine Golang - Register Users Without Google Account", "body": "<p>I'm building a website in Go(lang) using Google App Engine. I want users to be able to register for the site by providing an Email and Password. I don't want to use the users API, because I don't want my users to require a google account and I eventually plan on making this a pay site.</p>\n\n<p>What is a good way to handle user registration/authentication on google app engine? Should I use the datastore for user accounts and credentials, or Cloud SQL? Any other good options? I don't know where to start.</p>\n"}, {"tags": ["arrays", "struct", "go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1447407331, "post_id": 33689553, "comment_id": 55151197, "body": "Those structs are semantically different. Please describe why you want to do that conversion, maybe you can use an interface."}, {"owner": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1447407489, "post_id": 33689553, "comment_id": 55151282, "body": "I&#39;m using third party package for something, this package returns me a huge struct, I want to convert this struct to my local struct for insert to db."}], "answers": [{"comments": [{"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "reply_to_user": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "edited": false, "score": 0, "creation_date": 1447407622, "post_id": 33689665, "comment_id": 55151345, "body": "@MelihMucuk yes, it should be enough. Over optimization is the root of all evil."}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1447407651, "post_id": 33689665, "comment_id": 55151363, "body": "I doubt there&#39;s a faster way to actually convert them. Depending on exactly what you&#39;re trying to do, it MAY be better to use an interface and skipping the explicit conversion."}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 2, "creation_date": 1447411817, "post_id": 33689665, "comment_id": 55153781, "body": "I think it&#39;s better to define length and capacity of <code>acc</code> slice, to reduce memory allocations. Because we know that: <code>len(bs)</code>"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1447411915, "post_id": 33689665, "comment_id": 55153837, "body": "That&#39;s sufficiently &quot;micro&quot; in optimization terms that I thought it would make the example less readable. But, sure, that&#39;s going to give you a slight run-time performace. I&#39;d still bench-mark both versions with, say, 10, 100 and 1000 elements and see if it&#39;s actually worth it..."}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1447412116, "post_id": 33689665, "comment_id": 55153938, "body": "I&#39;m not really sure that <code>acc := make([]Foo, 0, len(bs))</code> is less readable"}, {"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1447412128, "post_id": 33689665, "comment_id": 55153945, "body": "Premature one was Donald Trump&#39;s quote, this one is mine :P"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1447412424, "post_id": 33689665, "comment_id": 55154115, "body": "@RoninDev Sure it is, I suddenly need to double-check that you&#39;re taking the length of the right element. Not <i>much</i> less readable, I admit. Definitely something I would consider, if I could show that there was a clear advantage to the lessened readability. It&#39;s in the same realm of &quot;I can grab my mug by just moving my hand&quot; or &quot;I have to stretch and lean, just a smidgen&quot;. Eventually, it builds up."}, {"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1447412690, "post_id": 33689665, "comment_id": 55154255, "body": "HAHHAHAHAA I should get a coffee.. can&#39;t stop laughing"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "edited": false, "score": 0, "creation_date": 1447417837, "post_id": 33689665, "comment_id": 55157055, "body": "@MelihMucuk: To be performant in Go, which manages memory, minimize memory allocations and use. To provide constant cost, <code>append</code> over allocates. See my answer."}], "tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": true, "score": 5, "last_activity_date": 1447407465, "creation_date": 1447407465, "answer_id": 33689665, "question_id": 33689553, "link": "https://stackoverflow.com/questions/33689553/golang-struct-array-conversion/33689665#33689665", "title": "golang struct array conversion", "body": "<p>I don't think there's any \"magic\" way of doing the conversion. However, it is a very small piece of coding to create it. Something like this ought to do the trick.</p>\n\n<pre><code>func BarsToFoos(bs []Bar) []Foo {\n  var acc []Foo\n\n  for _, b := range bs {\n    newFoo := Foo{A: b.C, B: b.D.E}  // pulled out for clarity\n    acc = append(acc, newFoo)\n  }\n\n  return acc\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1447417121, "last_edit_date": 1447417121, "creation_date": 1447416754, "answer_id": 33692508, "question_id": 33689553, "link": "https://stackoverflow.com/questions/33689553/golang-struct-array-conversion/33692508#33692508", "title": "golang struct array conversion", "body": "<p>For example, concisely mininimizing memory allocations and use,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Foo struct {\n    A string\n    B string\n}\n\ntype Bar struct {\n    C string\n    D Baz\n}\n\ntype Baz struct {\n    E string\n    F string\n}\n\nfunc FooFromBar(bs []Bar) []Foo {\n    fs := make([]Foo, 0, len(bs))\n    for _, b := range bs {\n        fs = append(fs, Foo{\n            A: b.C,\n            B: b.D.E,\n        })\n    }\n    return fs\n}\n\nfunc main() {\n    b := []Bar{{C: \"C\", D: Baz{E: \"E\", F: \"F\"}}}\n    fmt.Println(b)\n    f := FooFromBar(b)\n    fmt.Println(f)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[{C {E F}}]\n[{C E}]\n</code></pre>\n"}], "owner": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2005, "favorite_count": 1, "accepted_answer_id": 33689665, "answer_count": 2, "score": 0, "last_activity_date": 1447417121, "creation_date": 1447407015, "question_id": 33689553, "link": "https://stackoverflow.com/questions/33689553/golang-struct-array-conversion", "title": "golang struct array conversion", "body": "<p>I have structs like below:</p>\n\n<pre><code>type Foo struct{\n  A string\n  B string\n}\n\ntype Bar struct{\n  C string\n  D Baz\n}\n\ntype Baz struct{\n  E string\n  F string\n}\n</code></pre>\n\n<p>Lets say I have <code>[]Bar</code>, how to convert this to <code>[]Foo</code> ?</p>\n\n<p><code>A</code> should be <code>C</code></p>\n\n<p><code>B</code> should be <code>E</code></p>\n"}, {"tags": ["go", "dependencies", "vendor", "golint"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1447408849, "post_id": 33688705, "comment_id": 55152000, "body": "What would be wrong with <code>go install</code> ? ANd running lint on a single package works perfectly fine. Maybe I do not understand your question?"}, {"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1447430565, "post_id": 33688705, "comment_id": 55165247, "body": "I&#39;m new to the language and ecosystem. Is there a way to pre-compile my dependencies (get <code>.a</code>) files, so it is faster to compile when I run <code>go install</code> or <code>go build</code>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1447433609, "post_id": 33688705, "comment_id": 55167408, "body": "Yes, as I said, that is what <code>go install</code> does."}], "answers": [{"comments": [{"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1447452186, "post_id": 33699213, "comment_id": 55177125, "body": "I appreciate all the links to documentation and development issues/solutions."}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 0, "last_activity_date": 1447438205, "creation_date": 1447438205, "answer_id": 33699213, "question_id": 33688705, "link": "https://stackoverflow.com/questions/33688705/compile-glide-vendored-packages/33699213#33699213", "title": "Compile glide vendored packages", "body": "<blockquote>\n  <p>Is there a way to pre-compile my dependencies (get .a) files, so it is\n  faster to compile when I run go install or go build</p>\n</blockquote>\n\n<p>See <a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"nofollow\">https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies</a></p>\n\n<blockquote>\n  <p>go build [-o output] [-i] [build flags] [packages]</p>\n</blockquote>\n\n<p>[...]</p>\n\n<blockquote>\n  <p>The -i flag installs the packages that are dependencies of the target.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>Also, how can I remove vendor/ from go's tools to lint and check the\n  codebase for errors?</p>\n</blockquote>\n\n<p>See <a href=\"https://github.com/golang/go/issues/11659#issuecomment-122139338\" rel=\"nofollow\">https://github.com/golang/go/issues/11659#issuecomment-122139338</a>:</p>\n\n<blockquote>\n  <p>Instead of using ./... you can do:</p>\n</blockquote>\n\n<p><code>go install $(go list ./... | grep -v /vendor/)</code></p>\n"}], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 33699213, "answer_count": 1, "score": 1, "last_activity_date": 1447438205, "creation_date": 1447404083, "question_id": 33688705, "link": "https://stackoverflow.com/questions/33688705/compile-glide-vendored-packages", "title": "Compile glide vendored packages", "body": "<p>Golang's <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow\">glide</a> downloads dependencies to the project's source. As a result, <code>go build</code> compiles those too, and go plugins that lint/vet the codebase also parse the dependencies.</p>\n\n<p>Assuming those dependencies are stable, how can I compile the dependencies so <code>go build</code> becomes faster?</p>\n\n<p>Also, how can I remove <code>vendor/</code> from go's tools to lint and check the codebase for errors?</p>\n"}, {"tags": ["go", "switch-statement", "default"], "comments": [{"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1447378450, "post_id": 33684386, "comment_id": 55141810, "body": "Is it possible you&#39;re getting something after your connect that is handled by the default? Try printing cmds[i] before the switch and see if there&#39;s something you&#39;re not expecting."}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1447378590, "post_id": 33684386, "comment_id": 55141852, "body": "Troubleshoot using print statement in loop before switch statement like fmt.Printf(&quot;&gt;&gt;&gt;%s&lt;&lt;&lt;&quot;, cmds[i])    You may find that &quot;exit&quot; and &quot;connect&quot; have no new lines"}], "answers": [{"tags": [], "owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "is_accepted": false, "score": -1, "last_activity_date": 1447378701, "creation_date": 1447378701, "answer_id": 33684579, "question_id": 33684386, "link": "https://stackoverflow.com/questions/33684386/switch-case-statement-falls-through-to-default/33684579#33684579", "title": "Switch case statement falls through to default", "body": "<p>Try wrapping the subject of your switch statement with <code>strings.Trim()</code> like so:</p>\n\n<pre><code>switch strings.TrimSpace(cmds[i]) {\n   // your cases\n}\n</code></pre>\n\n<p>In general though, it looks like the inner for loop is the wrong construct to be using in this case. Based on this snippet of code you probably want to remove that and just have the first element of the <code>cmds</code> array be the subject of your switch statement</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1447394497, "last_edit_date": 1495540742, "creation_date": 1447393297, "answer_id": 33686615, "question_id": 33684386, "link": "https://stackoverflow.com/questions/33684386/switch-case-statement-falls-through-to-default/33686615#33686615", "title": "Switch case statement falls through to default", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow noreferrer\">Switch statements</a></p>\n  \n  <p>\"Switch\" statements provide multi-way execution. An expression or type\n  specifier is compared to the \"cases\" inside </p>\n  \n  <p>Expression switches</p>\n  \n  <p>In an expression switch, the switch expression is evaluated and the\n  case expressions, which need not be constants, are evaluated\n  left-to-right and top-to-bottom; the first one that equals the switch\n  expression triggers execution of the statements of the associated\n  case; the other cases are skipped. If no case matches and there is a\n  \"default\" case, its statements are executed. There can be at most one\n  default case and it may appear anywhere in the \"switch\" statement. A\n  missing switch expression is equivalent to the boolean value true.</p>\n\n<pre><code>ExprSwitchStmt = \"switch\" [ SimpleStmt \";\" ] [ Expression ] \"{\" { ExprCaseClause } \"}\" .\nExprCaseClause = ExprSwitchCase \":\" StatementList .\nExprSwitchCase = \"case\" ExpressionList | \"default\" .\n</code></pre>\n</blockquote>\n\n<p>The last <code>switch</code> <code>case</code> clauses (<code>\"connect\"</code> and <code>\"test\"</code>) do not fall through to the <code>default</code> <code>case</code> clause. A <code>break</code> statement in a <code>switch</code> statement <code>case</code> clause breaks out of the <code>switch</code> statement; it does not break out of a surrounding  <code>for</code> clause.</p>\n\n<p>You have not provided us with a reproducible example: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>. For example, you haven't shown us your input and output.</p>\n\n<p>Here's an example, which is working as expected. There is a reason that the <code>default</code> clause is executed.</p>\n\n<pre><code>&gt;&gt; test 127.0.0.1 8080\ndont print anything else, dont fall through to default. There should be no reason why the default caluse is executed???\nUnrecognised command: 127.0.0.1\nUnrecognised command: 8080\n\n&gt;&gt; \n</code></pre>\n\n<p>The value of <code>cmds</code>, <code>fmt.Printf(\"%q\\n\", cmds)</code>, is <code>[\"test\" \"127.0.0.1\" \"8080\\r\\n\"]</code>.</p>\n\n<p>Your program logic is badly flawed.</p>\n"}], "owner": {"reputation": 19, "user_id": 5557011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae80fd90399d8ee6cc37284478f4ca7e?s=128&d=identicon&r=PG&f=1", "display_name": "GoNewb", "link": "https://stackoverflow.com/users/5557011/gonewb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1447394497, "creation_date": 1447377396, "question_id": 33684386, "link": "https://stackoverflow.com/questions/33684386/switch-case-statement-falls-through-to-default", "title": "Switch case statement falls through to default", "body": "<p>I am new to go and can't figure out why the last case clauses (connect and test) fall through to default. But the ones with the new line characters (exit\\r\\n and connect\\r\\n) don't</p>\n\n<p>There is no fallthrough statement. </p>\n\n<p>I've tried labeling the switch and calling break [lbl] but the default block still gets executed</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"strings\"\n\"bufio\"\n\"os\"\n)\n\nfunc main() {\n\nvar cmd string\nbio := bufio.NewReader(os.Stdin)\nfmt.Println(\"Hello\")\n\nproceed := true\n\nfor proceed {\n\n    fmt.Print(\"&gt;&gt; \")\n    cmd, _ = bio.ReadString('\\n')\n    cmds := strings.Split(cmd, \" \")\n\n    for i := range cmds{\n        switch cmds[i]{\n            case \"exit\\r\\n\" :\n                proceed = false\n            case \"connect\\r\\n\":\n                fmt.Println(\"The connect command requires more input\")\n            case \"connect\":\n                if i + 2 &gt;= len(cmds) {\n                    fmt.Println(\"Connect command usage: connect host port\")\n                } else {\n                    i++\n                    constring := cmds[i]\n                    i++\n                    port := cmds[i]\n                    con(constring, port)    \n                }\n                fmt.Println(\"dont print anything else, dont fall through to default. There should be no reason why the default caluse is executed???\")\n            case \"test\":\n                fmt.Println(\"dont print anything else, dont fall through to default. There should be no reason why the default caluse is executed???\")\n            default:\n                fmt.Println(\"Unrecognised command: \" + cmds[i])\n        } \n\n    }\n\n}\n}\n\nfunc con (conStr, port string){\npanic (conStr)\n}\n</code></pre>\n"}, {"tags": ["hash", "go", "passwords", "bcrypt"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 3, "creation_date": 1447381907, "post_id": 33684882, "comment_id": 55142642, "body": "Just to add to this: two &quot;new&quot; bcrypt hashes for the same password won&#39;t be the same, as the salt used will be unique for that hash and set of parameters. Using the comparison function will use the same salt, params and constant-time compare it correctly."}, {"owner": {"reputation": 305, "user_id": 3342213, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/787dca87f677ecd27581651d9f0443c0?s=128&d=identicon&r=PG&f=1", "display_name": "KNgu", "link": "https://stackoverflow.com/users/3342213/kngu"}, "edited": false, "score": 0, "creation_date": 1447427679, "post_id": 33684882, "comment_id": 55163271, "body": "It seems to not be working..  The current password in the database is: $2a$10$A/KM.HIbw3sdH79pML9Sv.MLvkWw3.Xbnxl7Gs  which is &#39;admin&#39;, but whenever I compare that in the code, it is always different. Would this be caused by the situation pointed above?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1447427755, "post_id": 33684882, "comment_id": 55163317, "body": "how are you storing the user&#39;s password?  you convert to []byte in your example, which makes me think as a string.  Did you base64 encode the password?  or did you store the binary directly in a column/field in your database? or was it simply you did string(bytesFromHash)?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1447429629, "post_id": 33684882, "comment_id": 55164590, "body": "yes, when you generate the hash, it is potentially different each time.  You can&#39;t do an == comparison on hashes which is why the CompareHashAndPassword function exists... what error are you getting?"}, {"owner": {"reputation": 305, "user_id": 3342213, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/787dca87f677ecd27581651d9f0443c0?s=128&d=identicon&r=PG&f=1", "display_name": "KNgu", "link": "https://stackoverflow.com/users/3342213/kngu"}, "edited": false, "score": 1, "creation_date": 1447436386, "post_id": 33684882, "comment_id": 55169127, "body": "The error I got was: crypto/bcrypt: hashedSecret too short to be a bcrypted password.  I am storing the password as what I receive from the function, verbatim."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1447444679, "post_id": 33684882, "comment_id": 55173465, "body": "are you sure the storage mechanism can store the raw bytes?  bcrypt produces plain old bytes.  Usually you would convert to hex or base64 encode them or something."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 5, "last_activity_date": 1447382751, "last_edit_date": 1447382751, "creation_date": 1447380985, "answer_id": 33684882, "question_id": 33684259, "link": "https://stackoverflow.com/questions/33684259/bcrypt-comparing-two-hashes-not-equal/33684882#33684882", "title": "BCrypt comparing two hashes not equal", "body": "<p>Re-read the <a href=\"https://godoc.org/golang.org/x/crypto/bcrypt#CompareHashAndPassword\" rel=\"nofollow\">docs</a> carefully.</p>\n\n<p>CompareHashAndPassword compares a bcrypt hashed password with its possible plaintext equivalent. Returns nil on success, or an error on failure.</p>\n\n<p>Basically, it is saying that you should compare the hash you have stored against the plain text password.</p>\n\n<p>you probably want:</p>\n\n<pre><code>u := models.Users{}\n\nu = u.FindByEmail(login.Email)\n\nplainPassword := []byte(login.Password)\n// Assumes that u.Password is the actual hash and that you didn't store plain text password.\nerr = bcrypt.CompareHashAndPassword([]byte(u.Password), plainPassword)\n\nfmt.Println(err)\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 3342213, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/787dca87f677ecd27581651d9f0443c0?s=128&d=identicon&r=PG&f=1", "display_name": "KNgu", "link": "https://stackoverflow.com/users/3342213/kngu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3794, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447382751, "creation_date": 1447376509, "question_id": 33684259, "link": "https://stackoverflow.com/questions/33684259/bcrypt-comparing-two-hashes-not-equal", "title": "BCrypt comparing two hashes not equal", "body": "<p>I have this code:</p>\n\n<p>u := models.Users{}</p>\n\n<p>u = u.FindByEmail(login.Email)</p>\n\n<p>password := []byte(login.Password)</p>\n\n<p>hashedPassword, err := bcrypt.GenerateFromPassword(password, bcrypt.DefaultCost)\n   if err != nil {\n       panic(err)\n   }</p>\n\n<p>err = bcrypt.CompareHashAndPassword(hashedPassword, []byte(u.Password))\n   fmt.Println(err)</p>\n\n<p>I end up getting this error: crypto/bcrypt: hashedPassword is not the hash of the given password</p>\n\n<p>However I previously saved my model to have the same hash as \"admin\", but when I run my application, it tells me it is not equal.</p>\n"}, {"tags": ["testing", "go", "mocking"], "answers": [{"comments": [{"owner": {"reputation": 358, "user_id": 1341745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19f29fa587f30c836926815a68ff910b?s=128&d=identicon&r=PG", "display_name": "lordbyron", "link": "https://stackoverflow.com/users/1341745/lordbyron"}, "edited": false, "score": 0, "creation_date": 1447720045, "post_id": 33685058, "comment_id": 55262518, "body": "Thanks @AlexGuerra. You&#39;re confirming what I&#39;ve heard from some other sources as well, and it seems to be the best option for my tests."}], "tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": true, "score": 2, "last_activity_date": 1447382323, "creation_date": 1447382323, "answer_id": 33685058, "question_id": 33684030, "link": "https://stackoverflow.com/questions/33684030/how-can-i-mock-multiple-types-when-the-signature-of-a-concrete-method-refers-to/33685058#33685058", "title": "How can I mock multiple types when the signature of a concrete method refers to another concrete type, not its interface?", "body": "<p>It's not very pretty, but one way would be to:</p>\n\n<pre><code>type fetcherWrapper struct {\n    ThirdPartyFetcher\n}\n\nfunc (fw fetcherWrapper) FetchEntry() Entry {\n    return fw.ThirdPartyFetcher.FetchEntry()\n}\n</code></pre>\n\n<p>I'd say mocking things that return structs vs interfaces is a relatively common problem without any great solutions apart from a lot of intermediate wrapping.</p>\n"}], "owner": {"reputation": 358, "user_id": 1341745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19f29fa587f30c836926815a68ff910b?s=128&d=identicon&r=PG", "display_name": "lordbyron", "link": "https://stackoverflow.com/users/1341745/lordbyron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 33685058, "answer_count": 1, "score": 1, "last_activity_date": 1447382323, "creation_date": 1447374876, "question_id": 33684030, "link": "https://stackoverflow.com/questions/33684030/how-can-i-mock-multiple-types-when-the-signature-of-a-concrete-method-refers-to", "title": "How can I mock multiple types when the signature of a concrete method refers to another concrete type, not its interface?", "body": "<p>I'm making use of a third party library that doesn't have any interfaces for its classes. I can use them in my structs no problem, but they have side effects that I want to avoid when unit testing.</p>\n\n<pre><code>// Somewhere there are a couple structs, with no interfaces. I don't own the code.\n// Each has only one method.\ntype ThirdPartyEntry struct {}\nfunc (e ThirdPartyEntry) Resolve() string {\n    // Do some complex stuff with side effects\n    return \"I'm me!\"\n}\n\n// This struct returns an instance of the other one.\ntype ThirdPartyFetcher struct {}\nfunc (f ThirdPartyFetcher) FetchEntry() ThirdPartyEntry {\n    // Do some complex stuff with side effects and return an entry\n    return ThirdPartyEntry{}\n}\n\n// Now my code.\ntype AwesomeThing interface {\n    BeAwesome() string\n}\n// I have a class that makes use of the third party.\ntype Awesome struct {\n    F ThirdPartyFetcher\n}\nfunc (a Awesome) BeAwesome() string {\n    return strings.Repeat(a.F.FetchEntry().Resolve(), 3)\n}\nfunc NewAwesome(fetcher ThirdPartyFetcher) Awesome {\n    return Awesome{\n        F: fetcher,\n    }\n}\n\nfunc main() {\n    myAwesome := NewAwesome(ThirdPartyFetcher{})\n    log.Println(myAwesome.BeAwesome())\n}\n</code></pre>\n\n<p>This works! But I want to write some unit tests, and so I'd like to Mock both the third party structs. To do so I believe I need interfaces for them, but since ThirdPartyFetcher returns ThirdPartyEntrys, I cannot figure out how.</p>\n\n<p>I created a pair of interfaces which match up with the two third party classes. I'd like to then rewrite the Awesome struct and method to use the generic Fetcher interface. In my test, I would call NewAwesome() passing in a testFetcher, a struct which also implements the interface.</p>\n\n<pre><code>type Awesome struct {\n    F Fetcher\n}\nfunc NewAwesome(fetcher Fetcher) Awesome {\n    return Awesome{\n        Fetcher: fetcher,\n    }\n}\n\ntype Entry interface {\n    Resolve() string\n}\n// Double check ThirdPartyEntry implements Entry\nvar _ Entry = (*ThirdPartyEntry)(nil)\n\ntype Fetcher interface {\n    FetchEntry() Entry\n}\n// Double check ThirdPartyFetcher implements Fetcher\nvar _ Fetcher = (*ThirdPartyFetcher)(nil)\n</code></pre>\n\n<p>I omit the test code because it's not relevant. This fails on the last line shown.</p>\n\n<pre><code>./main.go:49: cannot use (*ThirdPartyFetcher)(nil) (type *ThirdPartyFetcher) as type Fetcher in assignment:\n*ThirdPartyFetcher does not implement Fetcher (wrong type for FetchEntry method)\n    have FetchEntry() ThirdPartyEntry\n    want FetchEntry() Entry\n</code></pre>\n\n<p>The signatures are different, even though I already showed that ThirdPartyEntry implements Entry. I believe this is disallowed because to would lead to something like slicing (in the polymorphic sense, not the golang sense). Is there any way for me to write a pair of interfaces? It should be the case that the Awesome class doesn't even know ThirdParty exists - it's abstracted behind the interface and injected when main calls NewAwesome.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1447371984, "post_id": 33683394, "comment_id": 55140041, "body": "I&#39;d say you gotta be missing something. I think you&#39;re following the main steps, what happens after this code? <code>top10</code> is expecting that file to be full of data and giving you the top10 items based off whatever ordering is used. I would guess the profiler isn&#39;t collecting any data or has nothing to profile since a failure to write would probably result in a panic at that time. So chances are, the file is created and opened correctly but you&#39;re collecting no data to write there."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1447372409, "post_id": 33683394, "comment_id": 55140189, "body": "try running your code longer, the profiler needs some repetition to be able to output proper data."}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1447383383, "post_id": 33683394, "comment_id": 55143023, "body": "I ran the program again, this time longer, clicking on routes which is making the server generate a lot of data, still absolutely no output when I do <code>cat filename.prof</code> and the panic happens when I do <code>top10</code> or any other command after starting <code>go tool pprof...</code>. By the way, when I do run <code>go tool pprof</code>, do I pass the binary just by name i.e. <code>havlak1</code> or as I would start it i.e. <code>.&#47;havlak1</code>. Either way in my case, I get the panic if I try to do <code>top10</code>"}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1447416876, "post_id": 33683394, "comment_id": 55156527, "body": "I&#39;m certainly doing something wrong when trying to use it (i.e. nothing&#39;s broken) because when I try to gather data using this wrapper <a href=\"https://github.com/davecheney/profile\" rel=\"nofollow noreferrer\">github.com/davecheney/profile</a> it works fine  and gathers data immediately"}], "answers": [{"comments": [{"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1447416818, "post_id": 33687211, "comment_id": 55156485, "body": "The problem certainly seems to be the code because I can gather profile data using this wrapper for the tooling <a href=\"https://github.com/davecheney/profile\" rel=\"nofollow noreferrer\">github.com/davecheney/profile</a>, just not do it without the wrapper"}, {"owner": {"reputation": 479, "user_id": 3394031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96f26b579880b353ee545849404e399a?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Echols", "link": "https://stackoverflow.com/users/3394031/ben-echols"}, "reply_to_user": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1447544936, "post_id": 33687211, "comment_id": 55200391, "body": "Try to manually stop the profiler and close the file before exiting"}], "tags": [], "owner": {"reputation": 479, "user_id": 3394031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96f26b579880b353ee545849404e399a?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Echols", "link": "https://stackoverflow.com/users/3394031/ben-echols"}, "is_accepted": false, "score": 1, "last_activity_date": 1447396935, "creation_date": 1447396935, "answer_id": 33687211, "question_id": 33683394, "link": "https://stackoverflow.com/questions/33683394/index-out-of-range-error-when-profiling-go-program/33687211#33687211", "title": "index out of range error when profiling go program", "body": "<p>It sounds like the file isn't being written and it looks like you are using a defer for the profile to stop. If the application exits before that defer can run you won't get the profile written. </p>\n\n<p>You could try to stop the profiling at the end without using a defer statement. </p>\n\n<p>You could make sure the issue is your code and not your machine by writing a simple test and running <code>go test --cpuprofile=cpu.prof</code> ( all go tests can be profiled using that flag automatically) and then viewing the results by <code>go tool pprof mypackage.test cpu.prof</code></p>\n"}], "owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447431318, "creation_date": 1447371038, "last_edit_date": 1447431318, "question_id": 33683394, "link": "https://stackoverflow.com/questions/33683394/index-out-of-range-error-when-profiling-go-program", "title": "index out of range error when profiling go program", "body": "<p><a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow\">This</a> blog post provides instructions about how to profile a golang program using the <code>runtime/pprof</code> package. </p>\n\n<p>In addition to the above mentioned package import, it says (STEP 1) to add this code to the main func</p>\n\n<pre><code>var cpuprofile = flag.String(\"cpuprofile\", \"\", \"write cpu profile to file\")\n\nfunc main() {\n    flag.Parse()\n    if *cpuprofile != \"\" {\n        f, err := os.Create(*cpuprofile)\n        if err != nil {\n            log.Fatal(err)\n        }\n        pprof.StartCPUProfile(f)\n        defer pprof.StopCPUProfile()\n    }\n</code></pre>\n\n<p>Then (STEP2) to run the binary (in this case named ./havlak1) passing the name of a file (with extension .prof) to the cpuprofile flag</p>\n\n<pre><code> ./havlak1 -cpuprofile=havlak1.prof\n</code></pre>\n\n<p>Then, after the program stops, (STEP 3) to pass the binary and the <code>.prof</code> file to the <code>go tool pprof</code> program</p>\n\n<pre><code>$ go tool pprof havlak1 havlak1.prof\nWelcome to pprof!  For help, type 'help'.\n(pprof)\n</code></pre>\n\n<p>At this point, the blog author runs the \n<code>top10</code> command to get some output. </p>\n\n<p>I have done each of those steps with my program (but with different binary and .prof file name).  However, when I run the <code>top10</code> command, my program panics with an index out of range error. If I do</p>\n\n<pre><code>cat myfile.prof\n</code></pre>\n\n<p>to check the contents of the <code>.prof</code> file, there is no output. </p>\n\n<p>Question: is there a step missing in the blog post or what might I be doing wrong or not doing for the <code>.prof</code> file to be empty?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Just to clarify, after starting the binary with the cpu flag like this</p>\n\n<p><strong>./havlak1 -cpuprofile=havlak1.prof</strong></p>\n\n<p>I visit the routes of my application a bunch of times to give it an opportunity to collect data. After I stop the program, I do <code>cat filename.prof</code> and it's empty</p>\n\n<p>Once I run this command</p>\n\n<pre><code>go tool pprof havlak1 havlak1.prof\n</code></pre>\n\n<p>I can obviously no longer click around my application because the binary isn't running. (I'm assuming the binary is passed to the <code>go tool pprof havlak1</code> for reasons other than to run the program again/keep it running) </p>\n\n<p><strong>Update</strong></p>\n\n<p>Do I have to include code to manually close the file it writes to? I am able to profile my application using a wrapper program <code>github.com/davecheney/profile</code>, which has a line that closes the file that's been opened.</p>\n"}, {"tags": ["ssh", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1447372388, "post_id": 33681662, "comment_id": 55140181, "body": "If I have time I&#39;ll try to write up an answer but I haven&#39;t really dealt with this type of thing for awhile so might not be able to. Anyway, my advice is to checkout <code>http.Client</code>. It has a property called <code>Transport</code> which is an interface of type <code>RoundTripper</code>. I believe it will be necessary for you to provide an implementation of this."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1447374138, "post_id": 33681662, "comment_id": 55140696, "body": "Adding to what @evanmcdonnal said, your implementation of <code>http.RoundTripper</code> can be <a href=\"https://godoc.org/net/http#Transport\" rel=\"nofollow noreferrer\"><code>http.Transport</code></a>, with the <code>Dial</code> field set to the returned <code>Dial</code> function of <a href=\"https://godoc.org/golang.org/x/net/proxy#SOCKS5\" rel=\"nofollow noreferrer\"><code>proxy.SOCKS5</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 3984634, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8b7ad13444a999d352fac5fd1ed9a38?s=128&d=identicon&r=PG&f=1", "display_name": "Aragorn", "link": "https://stackoverflow.com/users/3984634/aragorn"}, "edited": false, "score": 0, "creation_date": 1447874523, "post_id": 33691694, "comment_id": 55344028, "body": "Nailed it. Thank you very much."}, {"owner": {"reputation": 411, "user_id": 1499847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f9d11ce41a41636e080cff796c840772?s=128&d=identicon&r=PG", "display_name": "Rafael Capucho", "link": "https://stackoverflow.com/users/1499847/rafael-capucho"}, "edited": false, "score": 0, "creation_date": 1447944136, "post_id": 33691694, "comment_id": 55379164, "body": "If I set my Firefox to connect to this socks proxy how can I use dinamically destination of URL? from the browser... thx"}, {"owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "edited": false, "score": 0, "creation_date": 1616847994, "post_id": 33691694, "comment_id": 118134598, "body": "Can I use this pattern to make the local socks proxy connect to an remote &quot;exit&quot; proxy?"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1447414004, "creation_date": 1447414004, "answer_id": 33691694, "question_id": 33681662, "link": "https://stackoverflow.com/questions/33681662/how-to-route-http-get-via-tunnel-in-go/33691694#33691694", "title": "How to route http Get via tunnel in Go?", "body": "<p>Using the information provided in the above comments, here is a working example on how to tunnel HTTP requests through a SOCKS proxy:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net\"\n    \"net/http\"\n    \"time\"\n\n    \"golang.org/x/net/proxy\"\n)\n\nfunc main() {\n    url := \"https://example.com\"\n    socksAddress := \"localhost:9998\"\n\n    socks, err := proxy.SOCKS5(\"tcp\", socksAddress, nil, &amp;net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n    })\n    if err != nil {\n        panic(err)\n    }\n\n    client := &amp;http.Client{\n        Transport: &amp;http.Transport{\n            Dial:                socks.Dial,\n            TLSHandshakeTimeout: 10 * time.Second,\n        },\n    }\n\n    res, err := client.Get(url)\n    if err != nil {\n        panic(err)\n    }\n    content, err := ioutil.ReadAll(res.Body)\n    res.Body.Close()\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%s\", string(content))\n}\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 3984634, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8b7ad13444a999d352fac5fd1ed9a38?s=128&d=identicon&r=PG&f=1", "display_name": "Aragorn", "link": "https://stackoverflow.com/users/3984634/aragorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1689, "favorite_count": 1, "accepted_answer_id": 33691694, "answer_count": 1, "score": 2, "last_activity_date": 1447414004, "creation_date": 1447363480, "question_id": 33681662, "link": "https://stackoverflow.com/questions/33681662/how-to-route-http-get-via-tunnel-in-go", "title": "How to route http Get via tunnel in Go?", "body": "<p>I have a ssh tunnel to my server (via port: 9998). I want my http GET/POST requests to be routed through this port in Go. In java I would specify the DsocksProxyHost and DsocksProxyPort. I am looking for a similar option in Go. Thank you for the help in advance.</p>\n"}, {"tags": ["struct", "go", "constants", "anonymous"], "answers": [{"tags": [], "owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "is_accepted": false, "score": 2, "last_activity_date": 1447362324, "creation_date": 1447362324, "answer_id": 33681337, "question_id": 33681153, "link": "https://stackoverflow.com/questions/33681153/what-does-a-const-value-do-in-an-anonymous-struct-field/33681337#33681337", "title": "What does a const value do in an anonymous struct field?", "body": "<p>For such an <em>anonymous</em> or <em>embedded field</em>, per <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\"><em>The Go Programming Language Specification</em></a>,</p>\n\n<blockquote>\n  <p>The unqualified type name acts as the field name. </p>\n</blockquote>\n\n<p>In your case, you can write the following:</p>\n\n<pre><code>var node1 ListNode\nnode1.NodeType = NodeText\n</code></pre>\n\n<p>or</p>\n\n<pre><code>node2 := ListNode{NodeText}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>node3 := ListNode{\n    NodeType: NodeText,\n}\n</code></pre>\n\n<p>All three create the same value.</p>\n"}, {"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 2, "last_activity_date": 1447362395, "creation_date": 1447362395, "answer_id": 33681356, "question_id": 33681153, "link": "https://stackoverflow.com/questions/33681153/what-does-a-const-value-do-in-an-anonymous-struct-field/33681356#33681356", "title": "What does a const value do in an anonymous struct field?", "body": "<p><code>NodeType</code> isn't a constant. It's a type, and it has been embedded into the <code>ListNode</code> struct.</p>\n\n<blockquote>\n  <p>Struct types have the ability to contain anonymous or embedded fields.\n  This is also called embedding a type. When we embed a type into a\n  struct, the name of the type acts as the field name for what is then\n  an embedded field.</p>\n</blockquote>\n\n<p>e.g. You would set the <code>NodeType</code> for a <code>ListNode</code> as per below:</p>\n\n<pre><code>ln := &amp;ListNode{NodeType: NodeText}\nfmt.Println(ln)\n// Outputs: &amp;{0}\n</code></pre>\n\n<p>Further reading: <a href=\"http://www.goinggo.net/2014/05/methods-interfaces-and-embedded-types.html\" rel=\"nofollow\">http://www.goinggo.net/2014/05/methods-interfaces-and-embedded-types.html</a> (scroll down) and <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#embedding</a></p>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1447362463, "creation_date": 1447362463, "answer_id": 33681377, "question_id": 33681153, "link": "https://stackoverflow.com/questions/33681153/what-does-a-const-value-do-in-an-anonymous-struct-field/33681377#33681377", "title": "What does a const value do in an anonymous struct field?", "body": "<p>That is not an 'anonymous field' the language feature being used is called 'embedding' and it's sort of Go's way of addressing inheritance. In Go, if <code>StructA</code> embeds <code>StructB</code> then fields on <code>StructB</code> and methods with a receiving type of <code>StructB</code> will become directly accessible on <code>StructA</code>. Same rules for exported vs unexported apply however (ie unexported fields in <code>StructB</code> won't be accessible outside the packages scope like normal). I can't say why you want this value in all your structs, this is just an efficient way of doing it. At the end of the day it's just an int and you're just saving a few lines of code by not giving it an actual name, nothing more really.</p>\n"}], "owner": {"reputation": 91, "user_id": 5542323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2107f5baaf1e0220be4fe28985ef946?s=128&d=identicon&r=PG&f=1", "display_name": "hhh", "link": "https://stackoverflow.com/users/5542323/hhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1447363422, "creation_date": 1447361698, "last_edit_date": 1447363422, "question_id": 33681153, "link": "https://stackoverflow.com/questions/33681153/what-does-a-const-value-do-in-an-anonymous-struct-field", "title": "What does a const value do in an anonymous struct field?", "body": "<p>Given the following code:</p>\n\n<pre><code>type NodeType int\n\nconst (\n    NodeText NodeType = iota\n    NodeAction\n    // etc..\n)\n\ntype ListNode struct {\n    NodeType\n}\n</code></pre>\n\n<p>What is the explanation of including the <code>NodeType</code> type as an anonymous field in the <code>ListNode</code> struct? Does it serve as some sort of identifier for the struct?</p>\n"}, {"tags": ["go", "structure", "organization", "tradeoff"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1447362834, "creation_date": 1447362834, "answer_id": 33681472, "question_id": 33681035, "link": "https://stackoverflow.com/questions/33681035/implications-of-not-using-repo-path-for-my-own-packages/33681472#33681472", "title": "Implications of not using repo path for my own packages", "body": "<p>For the Go compiler and all elements of the go tool except <code>go get</code> the package import path is an almost opaque string containing the import path. You can lay out your code like you want (the compiler itself happy compiles files from different folders into one package). If you don't need or want your code to be <code>go get</code>able there is no need to use a repo path. The analysis and refactoring tools in golang.org/x/tools work on the opaque import paths (as far as I know) and do not access the network.</p>\n"}], "owner": {"reputation": 5566, "user_id": 395744, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d302ee929f0d8b452dd2ff7cc5d89302?s=128&d=identicon&r=PG", "display_name": "eold", "link": "https://stackoverflow.com/users/395744/eold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 33681472, "answer_count": 1, "score": 0, "last_activity_date": 1447363950, "creation_date": 1447361275, "last_edit_date": 1447363950, "question_id": 33681035, "link": "https://stackoverflow.com/questions/33681035/implications-of-not-using-repo-path-for-my-own-packages", "title": "Implications of not using repo path for my own packages", "body": "<p>Suppose I decide to keep all personally developed packages organized\nas follows:</p>\n\n<pre><code>$GOPATH/\n    bin/\n    pkg/\n    src/\n        somepkg1\n        somepkg2\n        ...\n        somepkgN\n</code></pre>\n\n<p>Further, suppose there is a great deal of code reuse among them, so I\ndecide to keep the whole $GOPATH workspace under the same Git\nrepository (each package could be a submodule), as opposed to more\ntraditional scenario where subpackages are less coherent (co-existing\nsolely because of using <code>go get</code> from the same workspace):</p>\n\n<pre><code>$GOPATH/\n    bin/\n    pkg/\n    src/github.com/&lt;me&gt;/\n        somepkg1\n        somepkg2\n        ...\n        somepkgN\n</code></pre>\n\n<p>I can see that with the former approach (not using <code>github.com/&lt;me&gt;/</code>\nin the package paths), <code>go get</code> would not be able to fetch packages as\nthey are not \"declaring\" themselves to be available online. However,\none can easily work around that by using git submodules, so all\npackages would be fetched in the first place (note it's a tightly\ncontrolled ecosystem so there will be no name clashes).</p>\n\n<p>Is there any other limitation (besides <code>go get</code>) of not using full\npaths for packages?</p>\n\n<p>(I am mostly concerned about limitations arising from certain code\nrefactoring/analysis tools that exploit the <code>repository path as base path</code> <a href=\"https://golang.org/doc/code.html#PackagePaths\" rel=\"nofollow\">convention</a> that\nallows <code>go get</code> to look for the package online.)</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1447362468, "last_edit_date": 1495541741, "creation_date": 1447362468, "answer_id": 33681379, "question_id": 33680616, "link": "https://stackoverflow.com/questions/33680616/go-integers-in-maps-always-0/33681379#33681379", "title": "Go: integers in maps always 0", "body": "<p>You have not provided us with a reproducible example: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>.</p>\n\n<p>This seems to work,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar counts = make(map[string]int)\n\nvar tokenPresent0Times, tokenPresent1Times string\n\nfunc mockCheckTokenExists(counts map[string]int) func(token string) (bool, error) {\n    return func(token string) (bool, error) {\n        fmt.Println(\"count: \", counts[token])\n        if token == tokenPresent0Times {\n            return false, nil\n        } else if token == tokenPresent1Times &amp;&amp; counts[tokenPresent1Times] == 1 {\n            return false, nil\n        }\n        counts[token]++\n        return true, nil\n    }\n}\n\nfunc main() {\n    fn := mockCheckTokenExists(counts)\n    fn(\"atoken\")\n    fn(\"atoken\")\n    fmt.Println(counts)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>count:  0\ncount:  1\nmap[atoken:2]\n</code></pre>\n\n<p>What are you doing differently?</p>\n"}], "owner": {"reputation": 956, "user_id": 1674995, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/P2NAk.png?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1674995/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1447362468, "creation_date": 1447359762, "question_id": 33680616, "link": "https://stackoverflow.com/questions/33680616/go-integers-in-maps-always-0", "title": "Go: integers in maps always 0", "body": "<p>I'm trying to use a <code>map[string]int</code> to count elements in a test in Go, but the values inside my map are always <code>0</code>:</p>\n\n<pre><code>var counts = make(map[string]int)\n\nfunc mockCheckTokenExists(counts map[string]int) func(token string) (bool, error) {\n    return func(token string) (bool, error) {\n        fmt.Println(\"count: \", counts[token])\n\n        if token == tokenPresent0Times {\n            return false, nil\n        } else if token == tokenPresent1Times &amp;&amp; counts[tokenPresent1Times] == 1 {\n            return false, nil\n        }\n        counts[token]++;\n        return true, nil\n    }\n}\n</code></pre>\n\n<p>the function returned by this one is passed as parameter to another one. </p>\n\n<p>when printing the counts at each call they are always 0. What is wrong with this code?</p>\n"}]