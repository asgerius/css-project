[{"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1469059430, "post_id": 38492529, "comment_id": 64386692, "body": "It is rare to use pointers to interfaces in Go and even more rare to return a pointer to an interface from a function.  If you describe the larger problem that you are trying to solve, we might be able to give a better answer."}, {"owner": {"reputation": 3626, "user_id": 614262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1571ab128b2dcc275ee02903a59df66?s=128&d=identicon&r=PG", "display_name": "TimeEmit", "link": "https://stackoverflow.com/users/614262/timeemit"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1469070803, "post_id": 38492529, "comment_id": 64389210, "body": "@XyMcXface what you say makes sense.  I&#39;m not sure that the pointer is necessary anymore."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1469071351, "post_id": 38492529, "comment_id": 64389350, "body": "Agreed -- I can&#39;t see any case where this is actually necessary. If you have a function that accepts <code>interface{}</code>, or a variable of type <code>interface{}</code>, you can pass/assign whatever it is that you have, and it will get wrapped at the appropriate moment without any need for a cast."}], "answers": [{"tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1469072201, "last_edit_date": 1469072201, "creation_date": 1469058025, "answer_id": 38492544, "question_id": 38492529, "link": "https://stackoverflow.com/questions/38492529/succinctly-return-a-pointer-to-an-interface-of-a-literal-in-go/38492544#38492544", "title": "Succinctly return a pointer to an interface of a literal in Go", "body": "<p>If you want to cast something to <code>interface{}</code>, just use the normal casting syntax:</p>\n\n<pre><code>interface{}(whatever)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1469061401, "last_edit_date": 1469061401, "creation_date": 1469059677, "answer_id": 38492764, "question_id": 38492529, "link": "https://stackoverflow.com/questions/38492529/succinctly-return-a-pointer-to-an-interface-of-a-literal-in-go/38492764#38492764", "title": "Succinctly return a pointer to an interface of a literal in Go", "body": "<p>If the reflect value is a <code>*interface{}</code>, then use:</p>\n\n<pre><code> return reflect.Value(in).Interface().(*interface{})\n</code></pre>\n\n<p>If the reflect value is not an pointer to an interface, then the shortest code is:</p>\n\n<pre><code> x := reflect.ValueOf(in).Interface()\n return &amp;x\n</code></pre>\n\n<p>The application cannot use <code>&amp;reflect.ValueOf(in).Interface()</code> because the return value from a function is not <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">addressable</a>.</p>\n"}], "owner": {"reputation": 3626, "user_id": 614262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1571ab128b2dcc275ee02903a59df66?s=128&d=identicon&r=PG", "display_name": "TimeEmit", "link": "https://stackoverflow.com/users/614262/timeemit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469072201, "creation_date": 1469057873, "question_id": 38492529, "link": "https://stackoverflow.com/questions/38492529/succinctly-return-a-pointer-to-an-interface-of-a-literal-in-go", "title": "Succinctly return a pointer to an interface of a literal in Go", "body": "<p>Is there a more succinct of casting a literal into an empty interface? A lot of the relevant community issues are about coercing an interface to a literal but not vice versa.</p>\n\n<p>Looking for something of the form:</p>\n\n<pre><code>func pointerInterfaceOf(in interface{}) *interface{} {\n    return &amp;in\n}\n</code></pre>\n\n<p>I have tried </p>\n\n<pre><code>&amp;reflect.ValueOf(in).Interface() // Compiler error\n</code></pre>\n\n<p>But that is a compiler error. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 2, "creation_date": 1469056522, "post_id": 38492338, "comment_id": 64385990, "body": "There&#39;s also unsafe.Pointer which is, well, less safe because it can be coerced into an arbitrary type. You&#39;re right that <code>interface{}</code> is more akin to <code>Object</code> though as it&#39;s simply a type that every other type &quot;is&quot;."}, {"owner": {"reputation": 199, "user_id": 2904722, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Cxwqk.jpg?s=128&g=1", "display_name": "glowkeeper", "link": "https://stackoverflow.com/users/2904722/glowkeeper"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1588100276, "post_id": 38492338, "comment_id": 108769482, "body": "Late to the party, but for the convenience of anyone else reading this, @LinearZoetrope sure, but you can make them safe with a <a href=\"https://stackoverflow.com/questions/14289256/cannot-convert-data-type-interface-to-type-string-need-type-assertion\">Type Assertion</a>."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1469056321, "last_edit_date": 1495540733, "creation_date": 1469056321, "answer_id": 38492338, "question_id": 38492277, "link": "https://stackoverflow.com/questions/38492277/how-can-i-implement-a-void-in-golang/38492338#38492338", "title": "How can I implement a void* in golang?", "body": "<p>There are no void pointers in Go. The way to handle this is by using the empty interface <code>interface{}</code> which is inherently implemented by all types. I asked a question about this awhile back which you can find here; <a href=\"https://stackoverflow.com/questions/8996771/go-equivalent-of-a-void-pointer-in-c\">Go equivalent of a void pointer in C</a></p>\n"}, {"tags": [], "owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "is_accepted": true, "score": 4, "last_activity_date": 1469060276, "creation_date": 1469060276, "answer_id": 38492849, "question_id": 38492277, "link": "https://stackoverflow.com/questions/38492277/how-can-i-implement-a-void-in-golang/38492849#38492849", "title": "How can I implement a void* in golang?", "body": "<p>I've never tried to solve this problem in any language, would this work in Go?</p>\n\n<p><a href=\"https://play.golang.org/p/39QLlRQACl\" rel=\"nofollow\">go play link</a>\n<em>edit</em> after reading the duplicate question i see you're not asking about the implementation, enjoy anyway \u2665\ufe0e</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Node struct {\n    List []*Node\n    Data interface{}\n}\n\nfunc main() {\n    trivial := Node{}\n\n    leaf := Node{Data: 1}\n\n    tree := Node{\n        List: []*Node{\n            &amp;leaf,\n            &amp;leaf,\n        },\n    }\n    out(trivial)\n    out(leaf)\n    out(tree)\n}\n\nfunc out(x interface{}) {\n    fmt.Printf(\"%T:%+v\\n\", x, x)\n}\n\n// main.Node:{List:[] Data:&lt;nil&gt;}\n// main.Node:{List:[] Data:1}\n// main.Node:{List:[0xc82000e180 0xc82000e180] Data:&lt;nil&gt;}\n</code></pre>\n"}], "owner": {"reputation": 863, "user_id": 5849285, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UwK2I.jpg?s=128&g=1", "display_name": "Charles Shiller", "link": "https://stackoverflow.com/users/5849285/charles-shiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8321, "favorite_count": 0, "closed_date": 1469063501, "accepted_answer_id": 38492849, "answer_count": 2, "score": 4, "last_activity_date": 1469060276, "creation_date": 1469055895, "question_id": 38492277, "link": "https://stackoverflow.com/questions/38492277/how-can-i-implement-a-void-in-golang", "closed_reason": "Duplicate", "title": "How can I implement a void* in golang?", "body": "<p>I'm making a (non-binary) tree in Golang.</p>\n\n<p>In Java, I'd use something like</p>\n\n<pre><code> class Node{\n   List &lt;Object&gt; data;\n }\n</code></pre>\n\n<p>Where data can be either a pointer to data or to a child node</p>\n\n<p>In C or C++, I'd use a void*.</p>\n\n<p>What type should I use in golang</p>\n"}, {"tags": ["sqlite", "go"], "comments": [{"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1469054048, "post_id": 38491750, "comment_id": 64385315, "body": "@icza If I understand that properly, the issue is that I can&#39;t parameterize the column name, correct?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1469054450, "post_id": 38491750, "comment_id": 64385437, "body": "Correct, meaning not with the help of the <a href=\"https://golang.org/pkg/database/sql/\" rel=\"nofollow noreferrer\"><code>database&#47;sql</code></a> package. But as the linked answer shows, you can build the dynamic query prior to executing it e.g. with using the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package."}], "owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 595, "favorite_count": 0, "closed_date": 1469054953, "answer_count": 0, "score": 0, "last_activity_date": 1552382943, "creation_date": 1469052884, "last_edit_date": 1552382943, "question_id": 38491750, "link": "https://stackoverflow.com/questions/38491750/parameterized-queries-with-sqlite-in-golang", "closed_reason": "Duplicate", "title": "Parameterized queries with SQLite in Golang", "body": "<p>I'm trying to run a query against a sqlite database. This format seems to work:</p>\n\n<pre><code>stmt, _ = DBHandle.Prepare(\"SELECT * FROM Purchases WHERE Product LIKE ?\")\ndefer stmt.Close()\n\nrows, _ = stmt.Query(fmt.Sprintf(\"%\" + mapSearchValues[\"Product\"] + \"%\")\nrows.Close()\n\nfor rows.Next() {...\n</code></pre>\n\n<p>That returns results when there's a value in the map. If I try a variation like</p>\n\n<pre><code>stmt, _ = DBHandle.Prepare(\"SELECT * FROM Purchases WHERE ? LIKE ?\")\ndefer stmt.Close()\n\nrows, _ = stmt.Query(\"Product\", \"%\" + mapSearchValues[\"Product\"] + \"%\")\nrows.Close()\n\nfor rows.Next() {...\n</code></pre>\n\n<p>I get 0 results. </p>\n\n<p>I've tried different variations of the stmt.Query to get multiple parameters into the prepared statement, but it doesn't seem to like any of them.</p>\n\n<p>(The end result I'm trying to get is take a map of strings and run a query with those values; the function doesn't know what columns will necessarily be checked (product? Product and purchaser? Price?) so I was hoping to build a query from the map then run the query, iterating through the values to insert the values from the query built by previously iterating through the keys and constructing a string. Since I don't have much experience with Sqlite and Go, I may be approaching this incorrectly but thought using a parameterized prepare and query might work.)</p>\n"}, {"tags": ["json", "go", "embedding"], "comments": [{"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 1, "creation_date": 1469046668, "post_id": 38489776, "comment_id": 64382220, "body": "What if Person&#39;s <code>MarshalJSON</code> returned an array? There&#39;s no way to merge that into an object. Composition is hard."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 0, "creation_date": 1469047597, "post_id": 38489776, "comment_id": 64382722, "body": "@AlexGuerra: Quite. It&#39;s enough to make me wish MarshalJSON always skipped embedded types, for consistency sake. heh. I suppose an entirely different approach is probably called for in my application."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1469047857, "post_id": 38490547, "comment_id": 64382852, "body": "That works for my specific example, and is helpful (so +1) but I think it misses the main point of what I was trying to ask.  What if Person&#39;s MarshalJSON adds new fields, or other opaque data?"}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1469048823, "post_id": 38490547, "comment_id": 64383294, "body": "@Flimzy good point. I&#39;ve updated my answer with another example"}], "tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 11, "last_activity_date": 1469048810, "last_edit_date": 1469048810, "creation_date": 1469047648, "answer_id": 38490547, "question_id": 38489776, "link": "https://stackoverflow.com/questions/38489776/idiomatic-way-to-embed-struct-with-custom-marshaljson-method/38490547#38490547", "title": "Idiomatic way to embed struct with custom MarshalJSON() method", "body": "<p>Don't put <code>MarshalJSON</code> on <code>Person</code> since that's being promoted to the outer type. Instead make a <code>type Name string</code> and have <code>Name</code> implement <code>MarshalJSON</code>. Then change <code>Person</code> to</p>\n\n<pre><code>type Person struct {\n    Name Name `json:\"name\"`\n}\n</code></pre>\n\n<p>Example: <a href=\"https://play.golang.org/p/u96T4C6PaY\" rel=\"noreferrer\">https://play.golang.org/p/u96T4C6PaY</a></p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>To solve this more generically you're going to have to implement <code>MarshalJSON</code> on the outer type. Methods on the inner type are promoted to the outer type so you're not going to get around that. You could have the outer type call the inner type's <code>MarshalJSON</code> then unmarshal that into a generic structure like <code>map[string]interface{}</code> and add your own fields. This example does that but it has a side effect of changing the order of the final output fields</p>\n\n<p><a href=\"https://play.golang.org/p/ut3e21oRdj\" rel=\"noreferrer\">https://play.golang.org/p/ut3e21oRdj</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2253962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeab8def9bbf9bcb0ecd5edf570d352f?s=128&d=identicon&r=PG", "display_name": "user2253962", "link": "https://stackoverflow.com/users/2253962/user2253962"}, "is_accepted": false, "score": -1, "last_activity_date": 1583492582, "last_edit_date": 1583492582, "creation_date": 1583492098, "answer_id": 60562610, "question_id": 38489776, "link": "https://stackoverflow.com/questions/38489776/idiomatic-way-to-embed-struct-with-custom-marshaljson-method/60562610#60562610", "title": "Idiomatic way to embed struct with custom MarshalJSON() method", "body": "<p>A more generic way to support massive fields in both inner and outer fields.</p>\n\n<p>The side effect is you need to write this for every outer structs.</p>\n\n<p>Example: <a href=\"https://play.golang.org/p/iexkUYFJV9K\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iexkUYFJV9K</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"strings\"\n)\n\nfunc Struct2Json2Map(obj interface{}) (map[string]interface{}, error) {\n    data, err := json.Marshal(obj)\n    if err != nil {\n        return nil, err\n    }\n    var kvs map[string]interface{}\n    err = json.Unmarshal(data, &amp;kvs)\n    if err != nil {\n        return nil, err\n    }\n    return kvs, nil\n}\n\ntype Person struct {\n    Name string `json:\"-\"`\n}\n\nfunc (p Person) MarshalJSONHelper() (map[string]interface{}, error) {\n    return Struct2Json2Map(struct {\n        Name string `json:\"name\"`\n    }{\n        Name: strings.ToUpper(p.Name),\n    })\n\n}\n\ntype Employee struct {\n    Person\n    JobRole string `json:\"jobRole\"`\n}\n\nfunc (e Employee) MarshalJSON() ([]byte, error) {\n    personKvs, err := e.Person.MarshalJSONHelper()\n    if err != nil {\n        return nil, err\n    }\n\n    type AliasEmployee Employee\n    kvs, err := Struct2Json2Map(struct {\n        AliasEmployee\n    } {\n        AliasEmployee(e),\n    })\n\n    for k,v := range personKvs {\n        kvs[k] = v\n    }\n    return json.Marshal(kvs)\n}\n\nfunc main() {\n    bob := Employee{\n        Person: Person{\n            Name: \"Bob\",\n        },\n        JobRole: \"Sales\",\n    }\n\n    output, err := json.Marshal(bob)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(string(output))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 623, "user_id": 3604904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db7762846cbef5eb7ccb8173fff49250?s=128&d=identicon&r=PG&f=1", "display_name": "Jagoan Neon", "link": "https://stackoverflow.com/users/3604904/jagoan-neon"}, "edited": false, "score": 0, "creation_date": 1592163338, "post_id": 61951279, "comment_id": 110319925, "body": "this is awesome."}], "tags": [], "owner": {"reputation": 1081, "user_id": 963287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fTJWz.jpg?s=128&g=1", "display_name": "Rodolfo Carvalho", "link": "https://stackoverflow.com/users/963287/rodolfo-carvalho"}, "is_accepted": false, "score": 1, "last_activity_date": 1590137810, "creation_date": 1590137810, "answer_id": 61951279, "question_id": 38489776, "link": "https://stackoverflow.com/questions/38489776/idiomatic-way-to-embed-struct-with-custom-marshaljson-method/61951279#61951279", "title": "Idiomatic way to embed struct with custom MarshalJSON() method", "body": "<p><em>While this produces a different output than what the OP wants, I think it is still useful as a technique to prevent <code>MarshalJSON</code> of embedded structs from breaking the marshaling of structs that contain them.</em></p>\n\n<p>There is <a href=\"https://github.com/golang/go/issues/6213\" rel=\"nofollow noreferrer\">a proposal for <code>encoding/json</code> to recognize an <code>inline</code> option in struct tags</a>. If that ever gets implemented, then I think avoiding embedding structs for cases like in OP's example might be the best bet.</p>\n\n<hr>\n\n<p>Currently, a reasonable workaround was described in <a href=\"https://github.com/golang/go/issues/24466#issuecomment-374837257\" rel=\"nofollow noreferrer\">a comment on the Go issue tracker</a> and is the basis for this answer. It consists of defining a new type that will have the same memory layout as the original struct being embedded, but none of the methods:</p>\n\n<p><a href=\"https://play.golang.org/p/BCwcyIqv0F7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BCwcyIqv0F7</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype Person struct {\n    Name string `json:\"name\"`\n}\n\nfunc (p *Person) MarshalJSON() ([]byte, error) {\n    return json.Marshal(struct {\n        Name string `json:\"name\"`\n    }{\n        Name: strings.ToUpper(p.Name),\n    })\n}\n\n// person has all the fields of Person, but none of the methods.\n// It exists to be embedded in other structs.\ntype person Person\n\ntype EmployeeBroken struct {\n    *Person\n    JobRole string `json:\"jobRole\"`\n}\n\ntype EmployeeGood struct {\n    *person\n    JobRole string `json:\"jobRole\"`\n}\n\nfunc main() {\n    {\n        p := Person{\"Bob\"}\n        e := EmployeeBroken{&amp;p, \"Sales\"}\n        output, _ := json.Marshal(e)\n        fmt.Printf(\"%s\\n\", string(output))\n    }\n    {\n        p := Person{\"Bob\"}\n        e := EmployeeGood{(*person)(&amp;p), \"Sales\"}\n        output, _ := json.Marshal(e)\n        fmt.Printf(\"%s\\n\", string(output))\n    }\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>{\"name\":\"BOB\"}\n{\"name\":\"Bob\",\"jobRole\":\"Sales\"}\n</code></pre>\n\n<p>The OP wants <code>{\"name\":\"BOB\",\"jobRole\":\"Sales\"}</code>. To achieve that, one would need to \"inline\" the object returned by <code>Person.MarshalJSON</code> into the object produced by <code>Employee.MashalJSON</code>, excluding the fields defined in <code>Person</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 906, "user_id": 375262, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6917fe3946e5d358c5b7d80cec7b629e?s=128&d=identicon&r=PG", "display_name": "Thomas David Baker", "link": "https://stackoverflow.com/users/375262/thomas-david-baker"}, "edited": false, "score": 0, "creation_date": 1616121466, "post_id": 62599230, "comment_id": 117910202, "body": "This is very useful, thank you. What about if you have a custom UnmarshalJSON, too? :)"}, {"owner": {"reputation": 69, "user_id": 3821430, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nkCcI.jpg?s=128&g=1", "display_name": "svajone", "link": "https://stackoverflow.com/users/3821430/svajone"}, "edited": false, "score": 0, "creation_date": 1616815018, "post_id": 62599230, "comment_id": 118128892, "body": "This is actually by far the best answer I found that ensures that if the embedded struct has a custom MarshalJSON implementation that it&#39;s still accessible."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1593189700, "creation_date": 1593189700, "answer_id": 62599230, "question_id": 38489776, "link": "https://stackoverflow.com/questions/38489776/idiomatic-way-to-embed-struct-with-custom-marshaljson-method/62599230#62599230", "title": "Idiomatic way to embed struct with custom MarshalJSON() method", "body": "<p>Nearly 4 years later, I've come up with an answer that is fundamentally similar to @jcbwlkr's, but does not require the intermediate unmarshal/re-marshal step, by using a little bit of byte-slice manipulation to join two JSON segments.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>func (e *Employee) MarshalJSON() ([]byte, error) {\n    pJSON, err := e.Person.MarshalJSON()\n    if err != nil {\n        return nil, err\n    }\n    eJSON, err := json.Marshal(map[string]interface{}{\n        &quot;jobRole&quot;: e.JobRole,\n    })\n    if err != nil {\n        return nil, err\n    }\n    eJSON[0] = ','\n    return append(pJSON[:len(pJSON)-1], eJSON...), nil\n}\n</code></pre>\n<p>Additional details and discussion of this approach <a href=\"https://jhall.io/posts/go-json-tricks-embedded-marshaler/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 6354, "user_id": 4258430, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a2d5075177b2ff473c38f6d8fb64894?s=128&d=identicon&r=PG", "display_name": "Allen Luce", "link": "https://stackoverflow.com/users/4258430/allen-luce"}, "is_accepted": false, "score": 0, "last_activity_date": 1603075344, "creation_date": 1603075344, "answer_id": 64420452, "question_id": 38489776, "link": "https://stackoverflow.com/questions/38489776/idiomatic-way-to-embed-struct-with-custom-marshaljson-method/64420452#64420452", "title": "Idiomatic way to embed struct with custom MarshalJSON() method", "body": "<p>I've used this approach on parent structs to keep the embedded struct from overriding marshaling:</p>\n<pre><code>func (e Employee) MarshalJSON() ([]byte, error) {\n  v := reflect.ValueOf(e)\n\n  result := make(map[string]interface{})\n\n  for i := 0; i &lt; v.NumField(); i++ {\n    fieldName := v.Type().Field(i).Name\n    result[fieldName] = v.Field(i).Interface()\n  }\n\n  return json.Marshal(result)\n}\n</code></pre>\n<p>It's handy but nests the embedded structs in the output::</p>\n<pre><code>{&quot;JobRole&quot;:&quot;Sales&quot;,&quot;Person&quot;:{&quot;name&quot;:&quot;Bob&quot;}}\n</code></pre>\n<p>For a tiny struct like the one in the question, @Flimzy's answer is good but can be done more succinctly:</p>\n<pre><code>func (e Employee) MarshalJSON() ([]byte, error) {\n    return json.Marshal(map[string]interface{}{\n        &quot;jobRole&quot;: e.JobRole,\n        &quot;name&quot;:    e.Name,\n    })\n}\n</code></pre>\n"}], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3758, "favorite_count": 6, "answer_count": 5, "score": 12, "last_activity_date": 1603075344, "creation_date": 1469044797, "last_edit_date": 1469045828, "question_id": 38489776, "link": "https://stackoverflow.com/questions/38489776/idiomatic-way-to-embed-struct-with-custom-marshaljson-method", "title": "Idiomatic way to embed struct with custom MarshalJSON() method", "body": "<p>Given the following structs:</p>\n\n<pre><code>type Person {\n    Name string `json:\"name\"`\n}\n\ntype Employee {\n    Person\n    JobRole string `json:\"jobRole\"`\n}\n</code></pre>\n\n<p>I can easily marshal an Employee to JSON as expected:</p>\n\n<pre><code>p := Person{\"Bob\"}\ne := Employee{&amp;p, \"Sales\"}\noutput, _ := json.Marshal(e)\nfmt.Printf(\"%s\\n\", string(output))\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>{\"name\":\"Bob\",\"jobRole\":\"Sales\"}</p>\n</blockquote>\n\n<p>But when the embedded struct has a custom <code>MarshalJSON()</code> method...</p>\n\n<pre><code>func (p *Person) MarshalJSON() ([]byte,error) {\n    return json.Marshal(struct{\n        Name string `json:\"name\"`\n    }{\n        Name: strings.ToUpper(p.Name),\n    })\n}\n</code></pre>\n\n<p>it breaks entirely:</p>\n\n<pre><code>p := Person{\"Bob\"}\ne := Employee{&amp;p, \"Sales\"}\noutput, _ := json.Marshal(e)\nfmt.Printf(\"%s\\n\", string(output))\n</code></pre>\n\n<p>Now results in:</p>\n\n<blockquote>\n  <p>{\"name\":\"BOB\"}</p>\n</blockquote>\n\n<p>(Note the conspicuous lack of <code>jobRole</code> field)</p>\n\n<p>This is easily anticipated... the embedded <code>Person</code> struct implements the <code>MarshalJSON()</code> function, which is being called.</p>\n\n<p>The trouble is, it's not what I <em>want</em>. What I want would be:</p>\n\n<blockquote>\n  <p>{\"name\":\"BOB\",\"jobRole\":\"Sales\"}</p>\n</blockquote>\n\n<p>That is, encode <code>Employee</code>'s fields normally, and defer to <code>Person</code>'s <code>MarshalJSON()</code> method to marshal its fields, and hand back some tidy JSON.</p>\n\n<p>Now I could add a <code>MarshalJSON()</code> method to <code>Employee</code> as well, but this requires that I know that the embedded type implements <code>MarshalJSON()</code> as well, and either (a) duplicate its logic, or (b) call <code>Person</code>'s <code>MarshalJSON()</code> and somehow manipulate its output to fit where I want it. Either approach seems sloppy, and not very future proof (what if an embedded type I don't control some day adds a custom <code>MarshalJSON()</code> method?)</p>\n\n<p>Are there any alternatives here that I haven't considered?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1469041686, "post_id": 38488316, "comment_id": 64379464, "body": "you should pass in the dependency like <code>func moo(boom func(), s string)</code> see <a href=\"https://play.golang.org/p/CV14zqZvOk\" rel=\"nofollow noreferrer\">play.golang.org/p/CV14zqZvOk</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": false, "score": 1, "last_activity_date": 1469045123, "last_edit_date": 1469045123, "creation_date": 1469044471, "answer_id": 38489690, "question_id": 38488316, "link": "https://stackoverflow.com/questions/38488316/testing-golang-imported-function-is-called/38489690#38489690", "title": "Testing Golang imported function is called?", "body": "<p>The Go-way would be to use an interface. Even if you are not able to change the foobar package.</p>\n\n<p><strong>1) create a boomer interface</strong></p>\n\n<pre><code>type Boomer interface{\n  Boom(string)\n}\n</code></pre>\n\n<p><strong>2) change moo() that it accepts the boomer</strong></p>\n\n<pre><code>func moo(b Boomer) {\n  b.Boom(\"!\")\n}\n</code></pre>\n\n<p><strong>3) add a variable with the foobar</strong></p>\n\n<p>For the playground I use the following construct. But with a extern package you can use the foobar.Boom() instead of Println</p>\n\n<pre><code>type foobar struct{}\n\nfunc (fb foobar) Boom(s string) {\n    fmt.Println(s)\n}\n\nvar f Boomer = foobar{}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/200WIok1pL\" rel=\"nofollow\">https://play.golang.org/p/200WIok1pL</a></p>\n\n<p><strong>4) Inside your test you implement a test boomer</strong></p>\n\n<pre><code>type testboomer struct{\n  boomstring string\n}\n\nfunc (tb *testboomer) Boom(s string) {\n  tb.boomstring = s\n}\n</code></pre>\n\n<p>After you called the moo() function the testboomer.boomstring shows the value.</p>\n"}], "owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469208594, "creation_date": 1469039737, "question_id": 38488316, "link": "https://stackoverflow.com/questions/38488316/testing-golang-imported-function-is-called", "title": "Testing Golang imported function is called?", "body": "<p>Say I have in <code>main.go</code></p>\n\n<pre><code>package main\n\nimport \"foobar\"\n\nfunc moo() {\n  foobar.Boom(\"!\")\n}\n\nfunc main() {\n  moo()\n}\n</code></pre>\n\n<p>How do I stub out <code>Boom</code> and make sure it was called with the correct parameters?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469036962, "post_id": 38487390, "comment_id": 64376653, "body": "thanks. does <code>v2</code> in <code>labix.org&#47;v2&#47;mgo</code> mean version 2 or 1 of the driver?"}, {"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469037083, "post_id": 38487390, "comment_id": 64376726, "body": "I&#39;m not sure. Actually, I&#39;ve just noticed <code>gopkg.in</code> is actually a version-aware redirector. Hence, it&#39;s even possible that in reality <code>gopkg.in&#47;mgo.v2</code> is an alias for the labix.org path. I&#39;d use <code>gopkg.in&#47;mgo.v2</code> in any case."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 1, "last_activity_date": 1469036842, "creation_date": 1469036842, "answer_id": 38487390, "question_id": 38487333, "link": "https://stackoverflow.com/questions/38487333/are-these-the-same-versions-distributions-of-mgo/38487390#38487390", "title": "Are these the same versions/distributions of mgo?", "body": "<p>You can find more information <a href=\"http://labix.org/mgo\" rel=\"nofollow\">in the official page</a>. The page links</p>\n\n<pre><code>gopkg.in/mgo.v2\n</code></pre>\n\n<p>From what I can see, <code>labix.org/v2/mgo</code> is probably the version 1 of the driver, whereas <code>gopkg.in/mgo.v2</code> is the new version.</p>\n\n<p>Go doesn't have traditional package distribution or versioning. Therefore, if you need a major refactoring and you want to break backward-compatibility, a common approach is to publish a different version at a different path.</p>\n\n<p>I guess that's what happened here.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1469040640, "last_edit_date": 1469040640, "creation_date": 1469037013, "answer_id": 38487442, "question_id": 38487333, "link": "https://stackoverflow.com/questions/38487333/are-these-the-same-versions-distributions-of-mgo/38487442#38487442", "title": "Are these the same versions/distributions of mgo?", "body": "<p>The package labix.org/v2/mgo was moved to gopkg.in/mgo.v2 according to \n <a href=\"https://github.com/go-mgo/mgo/commit/d1fb2c3135adc0ef611f8700af3ea17b3385b6b7\" rel=\"nofollow\">a commit in the gopkg.in/mgo.v2 source</a>.  </p>\n\n<p>The author of mgo also created <a href=\"http://labix.org/gopkg.in\" rel=\"nofollow\">gopkg.in</a>. He moved several of his packages from his \"vanity\" path on labix.org to gopkg.in.</p>\n\n<p>The source for labix.org/v2/mgo is at <a href=\"http://bazaar.launchpad.net/+branch/mgo/v2/files/head:/\" rel=\"nofollow\">http://bazaar.launchpad.net/+branch/mgo/v2/files/head:/</a>. The most recent update is July 1, 2014.</p>\n\n<p>The source for gopkg.in/mgo.v2 is at <a href=\"https://github.com/go-mgo/mgo/tree/v2\" rel=\"nofollow\">https://github.com/go-mgo/mgo/tree/v2</a>. This tree is a continuation of bazaar.launchpad.net/+branch/mgo/v2. The most recent update is June 9, 2016. </p>\n\n<p>Use gopkg.in/mgo.v2.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469040640, "creation_date": 1469036636, "question_id": 38487333, "link": "https://stackoverflow.com/questions/38487333/are-these-the-same-versions-distributions-of-mgo", "title": "Are these the same versions/distributions of mgo?", "body": "<p>I have found two places of the mongodb driver in Go</p>\n\n<ul>\n<li><a href=\"http://godoc.org/gopkg.in/mgo.v2\" rel=\"nofollow\">http://godoc.org/gopkg.in/mgo.v2</a> and <a href=\"http://godoc.org/gopkg.in/mgo.v2/bson\" rel=\"nofollow\">http://godoc.org/gopkg.in/mgo.v2/bson</a>   </li>\n<li><a href=\"http://godoc.org/labix.org/v2/mgo\" rel=\"nofollow\">http://godoc.org/labix.org/v2/mgo</a>\nand <a href=\"http://godoc.org/labix.org/v2/mgo/bson\" rel=\"nofollow\">http://godoc.org/labix.org/v2/mgo/bson</a></li>\n</ul>\n\n<p>Are they the same distribution and version of mongodb driver in Go?</p>\n\n<p>Why are there two pathnames for the same package?</p>\n\n<p>Which one of the two shall I use?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "build", "configuration", "secret-key"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1469037925, "post_id": 38487315, "comment_id": 64377267, "body": "You do realize that if you put the secret in the binary, you now have to protect all copies of that binary too? This isn&#39;t really a good idea."}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1469038057, "post_id": 38487315, "comment_id": 64377357, "body": "The secret is accessible in the binary?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1469038434, "post_id": 38487315, "comment_id": 64377593, "body": "Of course. <i>Anything</i> that the program binary has access to is accessible if you have the binary. Otherwise the program wouldn&#39;t be able to use it itself."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1469038836, "post_id": 38487315, "comment_id": 64377842, "body": "(though for completeness, you can insert a string at link-time. It&#39;s been answered many times here, for example: <a href=\"http://stackoverflow.com/questions/11354518/golang-application-auto-build-versioning/11355611#11355611\" title=\"golang application auto build versioning\">stackoverflow.com/questions/11354518/&hellip;</a>)"}, {"owner": {"reputation": 3859, "user_id": 1007877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KVGNK.png?s=128&g=1", "display_name": "vimdude", "link": "https://stackoverflow.com/users/1007877/vimdude"}, "edited": false, "score": 0, "creation_date": 1506437770, "post_id": 38487315, "comment_id": 79816678, "body": "if your concern is to keep the api key out of git, you could use public key encryption to encrypt the key before check-in. Then you provide public key to your binary using the linker when building. You still need to protect the binary. Security is hard business :)"}], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1469036594, "creation_date": 1469036594, "question_id": 38487315, "link": "https://stackoverflow.com/questions/38487315/go-install-in-bin-with-secret-key-config-information", "title": "Go - Install in bin with secret key config information", "body": "<p>I've written a small golang program which reads from a configuration json file a secret api key. When I put the binary in bin, and set up an alias to call it from my shell, it will look for the configuration file in whatever directory I'm currently in. </p>\n\n<p>Is there a way to put the api key into the binary at build -- but keep it separate/secret for version control/git (it's free software)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1469038360, "post_id": 38487113, "comment_id": 64377545, "body": "import paths are defined by their directory relative to <code>$GOPATH&#47;src&#47;</code>. Please read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">&quot;How to Write Go Code&quot;</a>. It will explain how packages work in full."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4822272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-1hO9B8YySzg/AAAAAAAAAAI/AAAAAAAAAog/XHwsWTqts84/photo.jpg?sz=128", "display_name": "Joaquin No&#233;", "link": "https://stackoverflow.com/users/4822272/joaquin-no%c3%a9"}, "edited": false, "score": 0, "creation_date": 1469037825, "post_id": 38487545, "comment_id": 64377202, "body": "DBHelper.go not use helpers, i have something like this                package Repository  import (_&quot;github.com/minus5/gofreetds&quot; \t&quot;../Configuration&quot; \t&quot;database/sql&quot; \t&quot;fmt&quot; ) func Select(){}"}, {"owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "reply_to_user": {"reputation": 25, "user_id": 4822272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-1hO9B8YySzg/AAAAAAAAAAI/AAAAAAAAAog/XHwsWTqts84/photo.jpg?sz=128", "display_name": "Joaquin No&#233;", "link": "https://stackoverflow.com/users/4822272/joaquin-no%c3%a9"}, "edited": false, "score": 0, "creation_date": 1469038007, "post_id": 38487545, "comment_id": 64377318, "body": "@JoaquinNo&#233; I just used package name &quot;helpers&quot; as an example.  Replace it with whatever your package name actually is."}, {"owner": {"reputation": 25, "user_id": 4822272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-1hO9B8YySzg/AAAAAAAAAAI/AAAAAAAAAog/XHwsWTqts84/photo.jpg?sz=128", "display_name": "Joaquin No&#233;", "link": "https://stackoverflow.com/users/4822272/joaquin-no%c3%a9"}, "edited": false, "score": 0, "creation_date": 1469039365, "post_id": 38487545, "comment_id": 64378146, "body": "I not use &lt;name of project folder&gt;/Repository/helpers instead of i use  ../Repository"}], "tags": [], "owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "is_accepted": true, "score": 3, "last_activity_date": 1469037259, "last_edit_date": 1495542756, "creation_date": 1469037259, "answer_id": 38487545, "question_id": 38487113, "link": "https://stackoverflow.com/questions/38487113/how-to-import-local-package-in-go/38487545#38487545", "title": "How to import local package in Go?", "body": "<p>Package imports are relative from your GOPATH</p>\n\n<p>For example, if DBHelper.go uses package <em>\"helpers\"</em>, your import would look like this:</p>\n\n<pre><code>&lt;name of project folder&gt;/Repository/helpers\n</code></pre>\n\n<p>Here is a very similar question on the subject:\n<a href=\"https://stackoverflow.com/questions/15049903/how-to-use-custom-packages-in-golang\">How to use custom packages in Go</a></p>\n\n<p>--Edit</p>\n\n<p>Almost forgot, to perform the actual function call, you must use the package name / alias.  </p>\n\n<pre><code>helpers.MyFunc()\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4822272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-1hO9B8YySzg/AAAAAAAAAAI/AAAAAAAAAog/XHwsWTqts84/photo.jpg?sz=128", "display_name": "Joaquin No&#233;", "link": "https://stackoverflow.com/users/4822272/joaquin-no%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1673, "favorite_count": 0, "accepted_answer_id": 38487545, "answer_count": 1, "score": 0, "last_activity_date": 1469038172, "creation_date": 1469035892, "last_edit_date": 1469038172, "question_id": 38487113, "link": "https://stackoverflow.com/questions/38487113/how-to-import-local-package-in-go", "title": "How to import local package in Go?", "body": "<p>how can i do to import a package? </p>\n\n\n<p>myproject</p>\n<p>&nbsp&nbspmain.go</p>\n<p><b>&nbsp&nbspRepository</b></p>\n<p> &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp   DBHelper.go</p>\n<p><b>&nbsp&nbspConfiguration</b></p>\n<p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp   Configuration.go</p>\n\n\n<p>I need to call a function inside DBHelper.go from Configuration.go, how can i do it? </p>\n\n<p><a href=\"http://i.stack.imgur.com/AMiHl.png\" rel=\"nofollow\">I need to call Select function from Configuration.go</a>\nThanks! Regards!</p>\n\n<p><a href=\"http://i.stack.imgur.com/uXdCo.png\" rel=\"nofollow\">I Call Select but not working(undefined: DBHelper.Select in DBHelper)</a></p>\n"}, {"tags": ["json", "go", "blockchain", "hyperledger"], "answers": [{"comments": [{"owner": {"reputation": 4021, "user_id": 2813306, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a343ee677e1adf016a8934c0dfd15b87?s=128&d=identicon&r=PG&f=1", "display_name": "Davis Broda", "link": "https://stackoverflow.com/users/2813306/davis-broda"}, "edited": false, "score": 0, "creation_date": 1469042129, "post_id": 38487841, "comment_id": 64379711, "body": "Well, at least now I actually understand why it doesn&#39;t work the way I expect. Do you know how I would go about checking the status of the invoke calls with a query call? It&#39;s hardly ideal, but I could probably make it work."}], "tags": [], "owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "is_accepted": false, "score": 2, "last_activity_date": 1469038578, "last_edit_date": 1469038578, "creation_date": 1469038182, "answer_id": 38487841, "question_id": 38486970, "link": "https://stackoverflow.com/questions/38486970/how-to-return-values-in-invoke-json-response/38487841#38487841", "title": "How to return values in Invoke json response", "body": "<p>\u201cInvoke\u201d is not a synchronous call. Peer generates this OK message immediately when it receives your Web request. \nLater, when Validation peers will try to generate new block, this \u201cinvoke\u201d method will be executed together with other cached transactions. </p>\n\n<p>In its turn chaincode-to-chaincode calls are synchronous and executed simultaneously. </p>\n\n<p>As a workaround we use another Query request to check the status of this submitted Invoke. It would be great if anybody can propose better solution. </p>\n"}, {"tags": [], "owner": {"reputation": 198, "user_id": 6518667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/064c026bcea4d38a1964f01e429b34a3?s=128&d=identicon&r=PG&f=1", "display_name": "Lesterpig", "link": "https://stackoverflow.com/users/6518667/lesterpig"}, "is_accepted": true, "score": 1, "last_activity_date": 1469086057, "creation_date": 1469086057, "answer_id": 38497703, "question_id": 38486970, "link": "https://stackoverflow.com/questions/38486970/how-to-return-values-in-invoke-json-response/38497703#38497703", "title": "How to return values in Invoke json response", "body": "<p>If you need to get a return value as soon as the Invoke is processed (included in a block), your best bet is to use some events (for the moment I guess).</p>\n\n<p>In your chaincode, just setup the event with:</p>\n\n<pre><code>func (stub *ChaincodeStub) SetEvent(name string, payload []byte) error\n</code></pre>\n\n<p><a href=\"http://godoc.org/github.com/hyperledger/fabric/core/chaincode/shim#ChaincodeStub.SetEvent\" rel=\"nofollow\">GoDoc</a></p>\n\n<p>You may be able to listen for events in your application using the SDK or protobuf messages directly. I'm doing it like this on the developer preview; but it seems that the standard way to retrieve Invoke result is to poll the blockchain via Queries.</p>\n\n<p>There is a related GitHub issue <a href=\"https://github.com/hyperledger/fabric/issues/2253\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 4021, "user_id": 2813306, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a343ee677e1adf016a8934c0dfd15b87?s=128&d=identicon&r=PG&f=1", "display_name": "Davis Broda", "link": "https://stackoverflow.com/users/2813306/davis-broda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 1, "accepted_answer_id": 38497703, "answer_count": 2, "score": 0, "last_activity_date": 1469086057, "creation_date": 1469035380, "question_id": 38486970, "link": "https://stackoverflow.com/questions/38486970/how-to-return-values-in-invoke-json-response", "title": "How to return values in Invoke json response", "body": "<p>I am trying to design a hyperledger chaincode, that is accessed through a web API, which passes json objects to the code. However, whenever I do an invoke method, I cannot actually return values to the user in the json response. </p>\n\n<p>For instance, here is some sample code:</p>\n\n<pre><code>func (t *TLCChaincode) Invoke(stub *shim.ChaincodeStub, function string, args []string) ([]byte, error) {\n    //Do some stuff\n    return []byte(\"Some string\"), nil\n}\n</code></pre>\n\n<p>And some sample code for returning an error</p>\n\n<pre><code>func (t *TLCChaincode) Invoke(stub *shim.ChaincodeStub, function string, args []string) ([]byte, error) {\n    //Try to do some stuff\n    //Get some sort of error\n    return nil, errors.New(\"someError\")\n}\n</code></pre>\n\n<p>however both of these return a message like this, with the message always being some random character string like below (I suspect a hash of some sort): </p>\n\n<pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"result\": {\n    \"status\": \"OK\",\n    \"message\": \"1e1123e3-b484-4120-a28e-c3a8db384557\"\n  },\n  \"id\": 11\n}\n</code></pre>\n\n<p>As you can see, this response contains neither the response I returned (as in the first case), or the error I returned (in the second case). How would I go about getting the returned bytes, or the returned error into the returned json? </p>\n\n<p>Edit: Please note that if I call an invoke method from another chaincode, it receives the correct return values. It's only when it's returned to the user that it fails to work properly.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1467, "user_id": 1005866, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b2efb2cc52b0c41088f7ff2c9b590d72?s=128&d=identicon&r=PG", "display_name": "Jimmy Zoto", "link": "https://stackoverflow.com/users/1005866/jimmy-zoto"}, "edited": false, "score": 0, "creation_date": 1469036729, "post_id": 38487229, "comment_id": 64376494, "body": "I wasn&#39;t aware of reflect.Value.MapKeys(). Still learning the basic libs. Thanks!"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 1, "last_activity_date": 1469043647, "last_edit_date": 1469043647, "creation_date": 1469036291, "answer_id": 38487229, "question_id": 38486910, "link": "https://stackoverflow.com/questions/38486910/casting-map-types/38487229#38487229", "title": "Casting map types", "body": "<p>You cannot cast an existing map into a <code>map[interface{}]interface{}</code>. You'll have to make use of reflection:</p>\n\n<pre><code>func MapKeys(theMap interface{}) ([]interface{}, error) {\n    if theMap == nil {\n        return nil,errors.New(\"MapKeys arg is nil\")\n    }\n\n    v := reflect.ValueOf(theMap) // v is now a reflect.Value type\n    if v.Kind() != reflect.Map {\n        return nil, errors.New(\"Argument is not a map\")\n    }\n    var keys = make([]interface{}, v.Len(), v.Len())\n\n    for i, key := range v.MapKeys() {\n        keys[i] = key.Interface() // key is also a reflect.Value, key.Interface()\n                                  // converts it back into an interface\n    }\n    return keys, nil\n}\n</code></pre>\n\n<p>Working example: <a href=\"https://play.golang.org/p/h9ZfnLHXgX\" rel=\"nofollow\">https://play.golang.org/p/h9ZfnLHXgX</a></p>\n"}], "owner": {"reputation": 1467, "user_id": 1005866, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b2efb2cc52b0c41088f7ff2c9b590d72?s=128&d=identicon&r=PG", "display_name": "Jimmy Zoto", "link": "https://stackoverflow.com/users/1005866/jimmy-zoto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 38487229, "answer_count": 1, "score": 0, "last_activity_date": 1469043647, "creation_date": 1469035145, "question_id": 38486910, "link": "https://stackoverflow.com/questions/38486910/casting-map-types", "title": "Casting map types", "body": "<p>I'm trying to write a general function to get the keys of a map like so:</p>\n\n<pre><code>func MapKeys(theMap map[interface{}]interface{}) ([]interface{},error) {\n\n    if theMap == nil {\n        return nil,errors.New(\"MapKeys arg is nil\")\n    }\n\n    var keys = make([]interface{}, len(theMap), len(theMap))\n\n    i := 0\n    for idx,_ := range theMap {\n        keys[i] = idx\n        i++\n    }\n\n    return keys, nil\n}\n</code></pre>\n\n<p>A) Is there a better way to do this? and B) When calling this function, how do I cast the original map types to map[interface{}]interface{}?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1469034093, "post_id": 38486564, "comment_id": 64375006, "body": "you have <code>omitempty</code>, and 0 is the empty value."}, {"owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1469034158, "post_id": 38486564, "comment_id": 64375041, "body": "i need omitemtpy as I may not have the field altogether but I also need the value to be 0. so is there a way around this?"}, {"owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1469034240, "post_id": 38486564, "comment_id": 64375097, "body": "if the field is not present, in the program it&#39;s used in, it defaults to a value, which is not 0. So no field will default to say 10, but i need to be able to set 0. Is there way to set a default value for a struct field?"}], "answers": [{"comments": [{"owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "edited": false, "score": 1, "creation_date": 1469039288, "post_id": 38487668, "comment_id": 64378092, "body": "that seems to be the solution... Thanks!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 27, "last_activity_date": 1469037638, "creation_date": 1469037638, "answer_id": 38487668, "question_id": 38486564, "link": "https://stackoverflow.com/questions/38486564/unmarshal-marshal-json-with-int-set-to-0-does-not-seem-to-work/38487668#38487668", "title": "Unmarshal/Marshal json with int set to 0 does not seem to work", "body": "<p>Use a pointer for the fields, so that the zero value of the JSON type can be differentiated from the missing value.</p>\n\n<pre><code>type Test struct {\n    String  *string `json:\"string,omitempty\"`\n    Integer *int    `json:\"integer,omitempty\"`\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/yvYSHxubLy\" rel=\"noreferrer\">https://play.golang.org/p/yvYSHxubLy</a></p>\n"}, {"tags": [], "owner": {"reputation": 1239, "user_id": 1164866, "user_type": "registered", "profile_image": "https://graph.facebook.com/1403425322/picture?type=large", "display_name": "Javier Neyra", "link": "https://stackoverflow.com/users/1164866/javier-neyra"}, "is_accepted": false, "score": 3, "last_activity_date": 1469038495, "creation_date": 1469038495, "answer_id": 38487943, "question_id": 38486564, "link": "https://stackoverflow.com/questions/38486564/unmarshal-marshal-json-with-int-set-to-0-does-not-seem-to-work/38487943#38487943", "title": "Unmarshal/Marshal json with int set to 0 does not seem to work", "body": "<p>as the docs says in <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\">https://golang.org/pkg/encoding/json/#Marshal</a></p>\n\n<blockquote>\n  <p>Struct values encode as JSON objects. Each exported struct field\n  becomes a member of the object unless</p>\n  \n  <ul>\n  <li>the field's tag is \"-\", or</li>\n  <li>the field is empty and its tag specifies the \"omitempty\" option. The <strong>empty values are false, 0, any nil pointer or interface value, and any\n  array, slice, map, or string of length zero</strong>. The object's default key\n  string is the struct field name but can be specified in the struct\n  field's tag value. The \"json\" key in the struct field's tag value is\n  the key name, followed by an optional comma and options.</li>\n  </ul>\n</blockquote>\n\n<p>so no, unless you implement your own marshaller for your struct</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 1958936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1939e2abb60ac78843f8ef739b1190da?s=128&d=identicon&r=PG", "display_name": "Vadim Petrov", "link": "https://stackoverflow.com/users/1958936/vadim-petrov"}, "is_accepted": false, "score": 17, "last_activity_date": 1469110218, "creation_date": 1469110218, "answer_id": 38506566, "question_id": 38486564, "link": "https://stackoverflow.com/questions/38486564/unmarshal-marshal-json-with-int-set-to-0-does-not-seem-to-work/38506566#38506566", "title": "Unmarshal/Marshal json with int set to 0 does not seem to work", "body": "<p>\"omitempty\" tag makes sense only for marshaling from <strong>struct</strong> to <strong>JSON</strong>. It skips empty values so they won't be in <strong>JSON</strong>. It doesn't affect unmarshaling in any way. Use pointers if you want to detect whether the field is specified in <strong>JSON</strong> or not. If the field is not specified, the pointer value will be <strong>nil</strong>.</p>\n"}], "owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18496, "favorite_count": 3, "accepted_answer_id": 38487668, "answer_count": 3, "score": 13, "last_activity_date": 1562677114, "creation_date": 1469034035, "last_edit_date": 1562677114, "question_id": 38486564, "link": "https://stackoverflow.com/questions/38486564/unmarshal-marshal-json-with-int-set-to-0-does-not-seem-to-work", "title": "Unmarshal/Marshal json with int set to 0 does not seem to work", "body": "<p>I am trying to parse a <strong>json</strong> object into a <strong>struct</strong>, but <em>integer</em> values set to 0 won't work.</p>\n\n<pre><code>q := []byte(`{\"string\":\"this is a string\", \"integer\": 0}`)\n\ntype Test struct {\n    String string `json:\"string,omitempty\"`\n    Integer int `json:\"integer,omitempty\"`\n}    \n\nvar qq Test\nif err := json.Unmarshal(q, &amp;qq); err != nil {\n   panic(err)\n}\n\nqueryStr, err := json.Marshal(qq)\nif err != nil {\n    panic(err)\n}\nfmt.Println(string(queryStr))\n// Output: {\"string\": \"this is a string\"}\n</code></pre>\n\n<p>if I set the integer to anything but 0, this works fine.</p>\n\n<p>even if I Unmarshal the object and set the Integer field to 0, Marshalling it back removes the \"integer\" field.</p>\n\n<p>Why? and how to get around this?</p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>from what I gather from the comments, <code>omitempty</code> triggers when value is 0. So now the disappearance makes sense.</p>\n\n<p>I'm parsing json, editing it and forwarding it to another service, so this is unfortunate, especially as field not present defaults to other values than 0, and I would prefer not having to feed in the defaults for the downstream API.</p>\n\n<p>So is there a way to omit empty values but keep 0?</p>\n\n<p>or change empty to something else?</p>\n\n<p>Do I need to have 2 structs: one for input and one for output?</p>\n"}, {"tags": ["go", "postman", "auth0"], "answers": [{"comments": [{"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1469037302, "post_id": 38487005, "comment_id": 64376869, "body": "thanks. so I can&#39;t configure postman to authenticate to my web server and then use that authentication to send requests to the API server? I must do it manually ?"}, {"owner": {"reputation": 1064, "user_id": 507141, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c7028aebc73523c2dfa7d7067e29871c?s=128&d=identicon&r=PG", "display_name": "Rodrigo L&#243;pez Dato", "link": "https://stackoverflow.com/users/507141/rodrigo-l%c3%b3pez-dato"}, "reply_to_user": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1469039257, "post_id": 38487005, "comment_id": 64378076, "body": "I&#39;m not familiar with Postman specifically, but you might be able to configure the OAuth 2.0 integration to get a token for you automatically. In any case you would need the <code>id_token</code> and not the <code>access_token</code> for that, not sure if it&#39;s possible to configure Postman to do that."}], "tags": [], "owner": {"reputation": 1064, "user_id": 507141, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c7028aebc73523c2dfa7d7067e29871c?s=128&d=identicon&r=PG", "display_name": "Rodrigo L&#243;pez Dato", "link": "https://stackoverflow.com/users/507141/rodrigo-l%c3%b3pez-dato"}, "is_accepted": false, "score": 1, "last_activity_date": 1469035468, "creation_date": 1469035468, "answer_id": 38487005, "question_id": 38486272, "link": "https://stackoverflow.com/questions/38486272/getting-login-acess-token-with-auth0-to-postman/38487005#38487005", "title": "getting login acess_token with auth0 to postman", "body": "<p>Here are a few approaches to test JWT-based APIs: <a href=\"https://auth0.com/docs/local-testing-and-development#client-side-applications-and-jwt\" rel=\"nofollow\">https://auth0.com/docs/local-testing-and-development#client-side-applications-and-jwt</a></p>\n\n<blockquote>\n  <h1>Client-side applications and JWT</h1>\n  \n  <p>This is usually the easiest scenario to test. One of the benefits of\n  <a href=\"https://auth0.com/docs/jwt\" rel=\"nofollow\">JSON Web Tokens</a> is that they are stateless, which means that an\n  application that consumes them only cares about the JWT's contents and\n  not any previous state such as a session cookie.</p>\n  \n  <p>There are mainly three approaches to obtaining JWTs for testing:</p>\n  \n  <ol>\n  <li><p>Manually generate a JWT with the needed data, and sign it with your\n  Auth0 application's client secret. If you omit the exp claim from a\n  token, most JWT libraries will interpret it as a token which never\n  expires, though it's possible some libraries might reject it. The\n  benefit of this approach is that it does not require Internet access\n  or intervention from Auth0 at all.</p></li>\n  <li><p>Create a dummy user in a database connection, and programatically log\n  in with this user through the <a href=\"https://auth0.com/docs/auth-api#!#post--oauth-ro\" rel=\"nofollow\">resource owner endpoint</a>. In order to get\n  a JWT back, <a href=\"https://auth0.com/docs/scopes\" rel=\"nofollow\">make sure to set the correct <code>scope</code> value</a>. The benefit of\n  this approach is that it will execute any rules that you have\n  configured on your Auth0 account.</p></li>\n  <li><p>Use a browser bot (e.g. Selenium) which logs a dummy user in and\n  retrieves a JWT. This approach may take some effort to develop and\n  maintain, but it will also execute any <a href=\"https://auth0.com/docs/rules/redirect\" rel=\"nofollow\">redirection rules</a> or <a href=\"https://auth0.com/docs/multifactor-authentication\" rel=\"nofollow\">MFA prompts</a> that you have configured on your Auth0 account.</p></li>\n  </ol>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "is_accepted": false, "score": 0, "last_activity_date": 1469074835, "creation_date": 1469074835, "answer_id": 38494819, "question_id": 38486272, "link": "https://stackoverflow.com/questions/38486272/getting-login-acess-token-with-auth0-to-postman/38494819#38494819", "title": "getting login acess_token with auth0 to postman", "body": "<p>I found a tutorial on youtube on how to use postman to login with username and password credentials to a DB Connection.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=VDUzBn6SzIY\" rel=\"nofollow\">https://www.youtube.com/watch?v=VDUzBn6SzIY</a></p>\n\n<p>so I installed the Auth0 Authentication API collection, and opened DB Connections -> Login using username and password.</p>\n\n<p>so I saved the post request with the relevant params (client_id,userame,password,connection) and I just use it first to get the access token, and then paste it to Authorization header in order to fetch information from the Api Server.</p>\n"}, {"tags": [], "owner": {"reputation": 4638, "user_id": 5610383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y3XAK.jpg?s=128&g=1", "display_name": "Hung Vu", "link": "https://stackoverflow.com/users/5610383/hung-vu"}, "is_accepted": true, "score": 7, "last_activity_date": 1528029632, "last_edit_date": 1528029632, "creation_date": 1487662025, "answer_id": 42361093, "question_id": 38486272, "link": "https://stackoverflow.com/questions/38486272/getting-login-acess-token-with-auth0-to-postman/42361093#42361093", "title": "getting login acess_token with auth0 to postman", "body": "<p>It's quite interesting and tricky at the same time :)</p>\n\n<p>First you need to get the token from Auth0 using Postman, remember you can get any info from App Settings in Auth0\n<a href=\"https://i.stack.imgur.com/SzWzJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SzWzJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>In above picture, you see id_token and access_token. The trick here is to use Id_token to send with your requests, not Access_token. Do it as follow:\n<a href=\"https://i.stack.imgur.com/0JzSK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0JzSK.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, for any request sending to API, we need to add a header called Authorization with value=\"Bearer {id_token}\". Boom...Job's done :) Hope it helps</p>\n"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5685, "favorite_count": 1, "accepted_answer_id": 42361093, "answer_count": 3, "score": 2, "last_activity_date": 1528029632, "creation_date": 1469033079, "last_edit_date": 1592644375, "question_id": 38486272, "link": "https://stackoverflow.com/questions/38486272/getting-login-acess-token-with-auth0-to-postman", "title": "getting login acess_token with auth0 to postman", "body": "<p>I created an app in Go that includes https server with angular2 based client that uses auth0 for authentication,\nI have another app written in Go which is the API Server, this API Server has jwt middleware configured for auth0 at explained at <a href=\"https://auth0.com/docs/quickstart/backend/golang\" rel=\"nofollow noreferrer\">https://auth0.com/docs/quickstart/backend/golang</a>.</p>\n<p>now... I want to use postman to test requests o my API Server but first I need to authenticate. how do I add authentication to my  website to get an access token or something to forward with my API request?</p>\n<p>I read the docs but I got really confused.\nany information regarding the issue would be greatly appreciated.</p>\n<p>Using Postman Mac App 4.4.2</p>\n<p>thanks!</p>\n<h1>update</h1>\n<p>so I installed Authentication API Collections on my Postman Mac App while being logged in to my auth0 account.</p>\n<p>now I'm trying to get an access token to be used with the authentication header while posting to my Api Server.</p>\n<p>I don't know which method I should use in the collection in order to get an access token.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 678, "user_id": 595362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx7ju.png?s=128&g=1", "display_name": "noisewaterphd", "link": "https://stackoverflow.com/users/595362/noisewaterphd"}, "edited": false, "score": 0, "creation_date": 1469031613, "post_id": 38485656, "comment_id": 64373588, "body": "I must admit, I don&#39;t fully understand the problem. You need a new shell, in the shell?  If I understand correctly, something like the following might help:  <code>syscall.Exec(os.Getenv(&quot;SHELL&quot;), []string{os.Getenv(&quot;SHELL&quot;)}, syscall.Environ())</code>"}], "answers": [{"comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1511903724, "post_id": 38485746, "comment_id": 82039247, "body": "<code>Exec()</code> is <i>replacing</i> the Go process with a shell. That&#39;s not usually what folks mean when they say they want to run a program."}], "tags": [], "owner": {"reputation": 678, "user_id": 595362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx7ju.png?s=128&g=1", "display_name": "noisewaterphd", "link": "https://stackoverflow.com/users/595362/noisewaterphd"}, "is_accepted": false, "score": 1, "last_activity_date": 1469031389, "creation_date": 1469031389, "answer_id": 38485746, "question_id": 38485656, "link": "https://stackoverflow.com/questions/38485656/go-how-to-spawn-a-bash-shell/38485746#38485746", "title": "Go: How to spawn a bash shell", "body": "<p>I must admit, I don't fully understand the problem. You need a new shell, in the shell?</p>\n\n<p>If I understand correctly, something like the following might help:</p>\n\n<p><code>syscall.Exec(os.Getenv(\"SHELL\"), []string{os.Getenv(\"SHELL\")}, syscall.Environ())</code></p>\n"}, {"tags": [], "owner": {"reputation": 6305, "user_id": 72987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9d1484425e9a125402f85497c7f86a00?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/72987/mike"}, "is_accepted": false, "score": 2, "last_activity_date": 1469031614, "creation_date": 1469031614, "answer_id": 38485809, "question_id": 38485656, "link": "https://stackoverflow.com/questions/38485656/go-how-to-spawn-a-bash-shell/38485809#38485809", "title": "Go: How to spawn a bash shell", "body": "<p>Go figure.. figure it out after I post but here's what worked</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    shell := exec.Command(\"/bin/bash\")\n    shell.Stdout = os.Stdout\n    shell.Stdin = os.Stdin\n    shell.Stderr = os.Stderr\n    shell.Run()\n    fmt.Println(\"Ran a shell in go\")\n\n}\n</code></pre>\n"}], "owner": {"reputation": 6305, "user_id": 72987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9d1484425e9a125402f85497c7f86a00?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/72987/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1469031614, "creation_date": 1469031117, "question_id": 38485656, "link": "https://stackoverflow.com/questions/38485656/go-how-to-spawn-a-bash-shell", "title": "Go: How to spawn a bash shell", "body": "<p>I'm looking to do something in Go where I launch the user into another shell on login. So this go app will do some work on login and then drop the user in a bash shell and then on exit do more work then quit. I can't seem to get it into a shell.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    proc := exec.Command(\"/bin/bash\")\n    out, e := proc.StdoutPipe()\n    proc.Start()\n    fmt.Println(\"Ran a shell in go\")\n\n    fmt.Println(out)\n    fmt.Println(e)\n}\n</code></pre>\n\n<p>That just exits right away. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1469029359, "post_id": 38484942, "comment_id": 64372038, "body": "Not really. The point of the init function is to be called automatically before all other functions. If you want to be able to do something before init, you need to move it out of init. (also reading env variables isn&#39;t something you would normally test. The code that reads them should be tested separately)"}, {"owner": {"reputation": 1691, "user_id": 8502552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LuB1_FZJaRU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rFgW34rrcvEfULUVCx-KA37vpdNw/mo/photo.jpg?sz=128", "display_name": "asr9", "link": "https://stackoverflow.com/users/8502552/asr9"}, "edited": false, "score": 0, "creation_date": 1579584447, "post_id": 38484942, "comment_id": 105804705, "body": "Maybe this will help <a href=\"https://stackoverflow.com/questions/23729790/how-can-i-do-test-setup-using-the-testing-package-in-go\" title=\"how can i do test setup using the testing package in go\">stackoverflow.com/questions/23729790/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1691, "user_id": 8502552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LuB1_FZJaRU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rFgW34rrcvEfULUVCx-KA37vpdNw/mo/photo.jpg?sz=128", "display_name": "asr9", "link": "https://stackoverflow.com/users/8502552/asr9"}, "edited": false, "score": 0, "creation_date": 1579584543, "post_id": 57964939, "comment_id": 105804729, "body": "This is not the correct way to do it. Please refer <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">golang.org/pkg/testing</a> or <a href=\"https://stackoverflow.com/questions/23729790/how-can-i-do-test-setup-using-the-testing-package-in-go\" title=\"how can i do test setup using the testing package in go\">stackoverflow.com/questions/23729790/&hellip;</a>"}], "tags": [], "owner": {"reputation": 219, "user_id": 5432076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TwANx.png?s=128&g=1", "display_name": "VolatileCoder", "link": "https://stackoverflow.com/users/5432076/volatilecoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1568673502, "last_edit_date": 1568673502, "creation_date": 1568671403, "answer_id": 57964939, "question_id": 38484942, "link": "https://stackoverflow.com/questions/38484942/golang-testing-with-init-func/57964939#57964939", "title": "Golang: Testing with init() func", "body": "<p>Less than ideal, but this works for me. \nInside of the package that you're testing: </p>\n\n<pre><code>func init() {\n    if len(os.Args) &gt; 1 &amp;&amp; os.Args[1][:5] == \"-test\" {\n        log.Println(\"testing\")//special test setup goes goes here\n        return // ...or just skip the setup entirely\n    }\n    //...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13025930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e96ceedeef9eded3375eb5c6eeda9d?s=128&d=identicon&r=PG&f=1", "display_name": "uestcjoel", "link": "https://stackoverflow.com/users/13025930/uestcjoel"}, "is_accepted": false, "score": 0, "last_activity_date": 1583635124, "creation_date": 1583635124, "answer_id": 60584042, "question_id": 38484942, "link": "https://stackoverflow.com/questions/38484942/golang-testing-with-init-func/60584042#60584042", "title": "Golang: Testing with init() func", "body": "<p>You can add a Test_parse_params(t *testing.T) function before your real tests. Look like this:</p>\n\n<pre><code>type envVars struct {\n    Host     string `env:\"APP_HOST\"`\n    Username string `env:\"APP_USERNAME\"`\n    Password string `env:\"APP_PASSWORD\"`\n}\n\nvar envConfig envVars\n\n//parse command params\nfunc Test_parse_params(t *testing.T) {\n    if err := env.Parse(&amp;envConfig); err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc Test_real_test(t *testing.T) {\n....\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 3445608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4239680f98b8f92272d3f9828d602c?s=128&d=identicon&r=PG&f=1", "display_name": "jerrytao", "link": "https://stackoverflow.com/users/3445608/jerrytao"}, "is_accepted": false, "score": 0, "last_activity_date": 1605248144, "last_edit_date": 1605248144, "creation_date": 1605247743, "answer_id": 64816272, "question_id": 38484942, "link": "https://stackoverflow.com/questions/38484942/golang-testing-with-init-func/64816272#64816272", "title": "Golang: Testing with init() func", "body": "<p>No, you shouldn't expect init() run in some order, (in fact it based on file loaded order, but still, you should not count on it).</p>\n<p>The simple way is, if you want to test it, use a shell script to run you test, or something like Makefile.</p>\n<p>Shell example:</p>\n<pre><code>set +e\nexport APP_HOST=http://localhost:9999\nexport APP_USERNAME=john\nexport APP_PASSWORD=doe\ngo test .\nunset APP_HOST\nunset APP_USERNAME\nunset APP_PASSWORD\n</code></pre>\n<p>or a single line command:</p>\n<pre><code>APP_HOST=http://localhost:9999 APP_USERNAME=john APP_PASSWORD=doe go test .\n</code></pre>\n<p>Edit:</p>\n<p>Other solution: move out the read env from init func.</p>\n<pre><code>func init(){\n  envInit()\n}\nfunc envInit(){\n if err := env.Parse(&amp;envConfig); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n<p>Then you can call again envInit in your test to make sure it works.</p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 11993292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55485a25a51c8a98d9367a23d7768a?s=128&d=identicon&r=PG&f=1", "display_name": "tsubus", "link": "https://stackoverflow.com/users/11993292/tsubus"}, "is_accepted": false, "score": 3, "last_activity_date": 1605952442, "creation_date": 1605952442, "answer_id": 64941789, "question_id": 38484942, "link": "https://stackoverflow.com/questions/38484942/golang-testing-with-init-func/64941789#64941789", "title": "Golang: Testing with init() func", "body": "<p>You can use the TestMain func to control what happens before and after your tests.</p>\n<p>For example:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>func TestMain(m *testing.M) {\n    // Write code here to run before tests\n    \n    // Run tests\n    exitVal := m.Run()\n    \n    // Write code here to run after tests\n\n    // Exit with exit value from tests\n    os.Exit(exitVal)\n}\n\nfunc TestYourFunc(t *testing.T) {\n    // Test code\n}\n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 1529274, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/8ac6a566b5cefc0b7edc0461197ab642?s=128&d=identicon&r=PG", "display_name": "Shriram Sharma", "link": "https://stackoverflow.com/users/1529274/shriram-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10664, "favorite_count": 2, "answer_count": 4, "score": 8, "last_activity_date": 1605952442, "creation_date": 1469029153, "question_id": 38484942, "link": "https://stackoverflow.com/questions/38484942/golang-testing-with-init-func", "title": "Golang: Testing with init() func", "body": "<p>Hi I am new to Go and I am writing a simple app which gets some configuration from the env variables. I do this in the init function as shown below.</p>\n\n<pre><code>type envVars struct {\n    Host     string `env:\"APP_HOST\"`\n    Username string `env:\"APP_USERNAME\"`\n    Password string `env:\"APP_PASSWORD\"`\n}\n\nvar envConfig envVars\n\nfunc init() {\n    if err := env.Parse(&amp;envConfig); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>I wrote test to verify of the env variables are being read correctly. But the problem is that my program's init func gets called even before my test's init func. Is there any way I can do some sort of setup before my program's init func gets called.</p>\n\n<pre><code>func init() {\n    os.Setenv(\"APP_HOST\", \"http://localhost:9999\")\n    os.Setenv(\"APP_USERNAME\", \"john\")\n    os.Setenv(\"APP_PASSWORD\", \"doe\")\n}\n\nfunc TestEnvConfig(t *testing.T) {\n    assert.NotNil(t, envConfig)\n    assert.Equal(t, \"http://localhost:9999\", envConfig.Host)\n}\n</code></pre>\n"}, {"tags": ["http", "go", "concurrency", "simultaneous"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1469021428, "post_id": 38482664, "comment_id": 64367548, "body": "They were never at the same time, you&#39;re call each serially, they were just executed very quickly. Have you gone over any of the documentation on Go concurrency? For example: <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow noreferrer\">tour.golang.org/concurrency/1</a>"}, {"owner": {"reputation": 33, "user_id": 6565674, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/034e394f4221e6b84d4f8b7bdd08fa35?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisDave", "link": "https://stackoverflow.com/users/6565674/chrisdave"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1469022227, "post_id": 38482664, "comment_id": 64368232, "body": "I went through this <a href=\"https://www.goinggo.net/2014/01/concurrency-goroutines-and-gomaxprocs.html\" rel=\"nofollow noreferrer\">goinggo.net/2014/01/concurrency-goroutines-and-gomaxprocs.ht&zwnj;&#8203;ml</a>  and it should call concurrently. I tried multple times and it actually did call concurrently except when i added the post request. Is there a way to call multiple http post requests concurrently?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1469022670, "post_id": 38482664, "comment_id": 64368596, "body": "No where in there are you starting a new goroutine, so you&#39;re not adding any concurrency and those 2 calls could not be concurrently executed."}], "answers": [{"tags": [], "owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "is_accepted": true, "score": 3, "last_activity_date": 1469050489, "creation_date": 1469050489, "answer_id": 38491242, "question_id": 38482664, "link": "https://stackoverflow.com/questions/38482664/golang-simultaneous-function-calls-for-http-post-request/38491242#38491242", "title": "Golang: Simultaneous function Calls for http post request", "body": "<p>This is achieved by using <a href=\"https://gobyexample.com/goroutines\" rel=\"nofollow\">Goroutines</a></p>\n\n<pre><code>go Check(url1)\ngo Check(url2)\n\nfunc Check(xurl string) {\n\n    nowstartx    := time.Now()\n    startnanos   := nowstartx.UnixNano()\n    nowstart := startnanos / 1000000\n    fmt.Println(nowstart)\n\n    json = {\"name\" : \"test\"}\n    req, err := http.NewRequest(\"POST\", xurl, bytes.NewBuffer(json))\n    req.Header.Set(\"X-Custom-Header\", \"myvalue\")\n    req.Header.Set(\"Content-Type\", \"application/json\")\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n\n    if err != nil {\n        panic(err)\n\n    } else {\n        defer resp.Body.Close()\n        body, _ = ioutil.ReadAll(resp.Body)\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6565674, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/034e394f4221e6b84d4f8b7bdd08fa35?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisDave", "link": "https://stackoverflow.com/users/6565674/chrisdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3343, "favorite_count": 0, "accepted_answer_id": 38491242, "answer_count": 1, "score": 1, "last_activity_date": 1469050489, "creation_date": 1469021260, "last_edit_date": 1469022154, "question_id": 38482664, "link": "https://stackoverflow.com/questions/38482664/golang-simultaneous-function-calls-for-http-post-request", "title": "Golang: Simultaneous function Calls for http post request", "body": "<p>I need to call multiple URL at the same time. My functions get called at the same time (in milli seconds)  but the moment I add a Http post request to the code it gets called one after the other. Below is the code:</p>\n\n<pre><code>Check(url1)\nCheck(url2)\n\nfunc Check(xurl string) {\n\n    nowstartx    := time.Now()\n    startnanos   := nowstartx.UnixNano()\n    nowstart := startnanos / 1000000\n    fmt.Println(nowstart)\n\n    json = {\"name\" : \"test\"}\n    req, err := http.NewRequest(\"POST\", xurl, bytes.NewBuffer(json))\n    req.Header.Set(\"X-Custom-Header\", \"myvalue\")\n    req.Header.Set(\"Content-Type\", \"application/json\")\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n\n    if err != nil {\n        panic(err)\n\n    } else {\n        defer resp.Body.Close()\n        body, _ = ioutil.ReadAll(resp.Body)\n    }\n\n}\n</code></pre>\n\n<p>Appreciate help, I need to get the same time (in milliseconds) when I run the program.</p>\n"}, {"tags": ["function", "pointers", "go", "methods", "call"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1469018403, "post_id": 38481550, "comment_id": 64365145, "body": "Actually this is not a method value but a simple method call, so the <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Spec: Calls</a> section is relevant."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1469018578, "post_id": 38481550, "comment_id": 64365309, "body": "but it is the opposite in my example. in <code>v.Scale(10)</code>, <code>v</code> isn&#39;t a pointer, and <code>Scale</code> expects a pointer receiver."}, {"owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1469018743, "post_id": 38481550, "comment_id": 64365428, "body": "Tim, true. See @icza answer for the relevant section"}], "tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": false, "score": 3, "last_activity_date": 1469018309, "creation_date": 1469018309, "answer_id": 38481550, "question_id": 38481420, "link": "https://stackoverflow.com/questions/38481420/calling-a-method-with-a-pointer-receiver-by-an-object-instead-of-a-pointer-to-it/38481550#38481550", "title": "Calling a method with a pointer receiver by an object instead of a pointer to it?", "body": "<p>It's the Go automatic dereferencing:</p>\n\n<p>From <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow\">https://golang.org/ref/spec#Method_values</a>:</p>\n\n<blockquote>\n  <p>As with selectors, a reference to a non-interface method with a value receiver using a pointer will automatically dereference that pointer: pt.Mv is equivalent to (*pt).Mv.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 9, "last_activity_date": 1469019034, "last_edit_date": 1469019034, "creation_date": 1469018662, "answer_id": 38481697, "question_id": 38481420, "link": "https://stackoverflow.com/questions/38481420/calling-a-method-with-a-pointer-receiver-by-an-object-instead-of-a-pointer-to-it/38481697#38481697", "title": "Calling a method with a pointer receiver by an object instead of a pointer to it?", "body": "<p><a href=\"https://golang.org/ref/spec#Calls\" rel=\"noreferrer\">Spec: Calls:</a></p>\n\n<blockquote>\n  <p>A method call <code>x.m()</code> is valid if the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"noreferrer\">method set</a> of (the type of) <code>x</code> contains <code>m</code> and the argument list can be assigned to the parameter list of <code>m</code>. If <code>x</code> is <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"noreferrer\">addressable</a> and <code>&amp;x</code>'s method set contains <code>m</code>, <strong><code>x.m()</code> is shorthand for <code>(&amp;x).m()</code></strong>.</p>\n</blockquote>\n\n<p>The compiler sees that <code>Scale()</code> has a pointer receiver and also that <code>v</code> is addressable (as it is a local variable), so <code>v.Scale(10)</code> will be interpreted as <code>(&amp;v).Scale(10)</code>.</p>\n\n<p>This is just one of the many conveniences the spec offers you so the source code can remain clean.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1498568163, "creation_date": 1469017944, "last_edit_date": 1498568163, "question_id": 38481420, "link": "https://stackoverflow.com/questions/38481420/calling-a-method-with-a-pointer-receiver-by-an-object-instead-of-a-pointer-to-it", "title": "Calling a method with a pointer receiver by an object instead of a pointer to it?", "body": "<p><code>v</code> is an object of <code>Vertex</code>, and <code>Scale</code> is a method for a pointer to <code>Vertex</code>. Then why is <code>v.Scale(10)</code> not wrong, given that <code>v</code> isn't a pointer to a <code>Vertex</code> object? Thanks.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\ntype Vertex struct {\n    X, Y float64\n}\n\nfunc (v Vertex) Abs() float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc (v *Vertex) Scale(f float64) {\n    v.X = v.X * f\n    v.Y = v.Y * f\n}\n\nfunc main() {\n    v := Vertex{3, 4}\n    v.Scale(10)\n    fmt.Println(v.Abs())\n}\n</code></pre>\n"}, {"tags": ["go", "travis-ci"], "comments": [{"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1469022356, "post_id": 38478957, "comment_id": 64368348, "body": "If you have checked your dependencies into git under /vendor then Travis does not need to go get godep. For 1.5 you need to set the GO15VENDOREXPERIMENT env var to 1 but godep itself is irrelevant."}], "answers": [{"comments": [{"owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 0, "creation_date": 1469012579, "post_id": 38479194, "comment_id": 64361041, "body": "Thank you for your advice. Though I set version 1.6 and tit, but tip version can work. But 1.6 can&#39;t. And travis seems to try find package in vendor directory."}, {"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "reply_to_user": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 0, "creation_date": 1469089395, "post_id": 38479194, "comment_id": 64397407, "body": "@Harry it would be helpful to have the entire Travis log."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 1, "last_activity_date": 1469011796, "creation_date": 1469011796, "answer_id": 38479194, "question_id": 38478957, "link": "https://stackoverflow.com/questions/38478957/how-to-manage-building-golang-projects-on-travis-ci/38479194#38479194", "title": "How to manage building golang projects on travis-ci", "body": "<p>The way Go 1.6 manages dependencies is different than Go 1.5 and previous versions.</p>\n\n<p>1.6 introduces the <code>/vendor</code> folder. Whenever you import a dependency, if the library exists in <code>/vendor</code>, then the library is loaded.</p>\n\n<p>The behavior was introduced in 1.5, but in that version it was experimental. It means that you need to enable it using the <code>GO15VENDOREXPERIMENT=1</code> environment variable.</p>\n\n<p>If you only need to provide support for 1.5 and 1.6, then simply add the variable to Travis when building 1.5 projects.</p>\n\n<p>If you need to extend support also for versions before 1.5, then it's a little bit more complicated.</p>\n"}], "owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469016941, "creation_date": 1469011077, "last_edit_date": 1469016941, "question_id": 38478957, "link": "https://stackoverflow.com/questions/38478957/how-to-manage-building-golang-projects-on-travis-ci", "title": "How to manage building golang projects on travis-ci", "body": "<p>I'm developing Golang project and using TravisCI. As dependency tool, Godeps is used.</p>\n\n<p>After running test by git push, something error was happened as below.</p>\n\n<pre><code># command-line-arguments\ncmd/proj/main_test.go:6:2: cannot find package \n\"command-line-/vendor/github.com/xxxxx/xxxxx/abc\" in any of:\n/home/travis/.gimme/versions/go1.6.linux.amd64/src/command-line-/vendor/github.com/xxxxx/xxxxx/xxx \n</code></pre>\n\n<p>Why it can't find package?\nAs build log, it seems to work well by go get command.</p>\n\n<p>My travis.yml is here.</p>\n\n<pre><code>language: go\nsudo: false\ngo:\n  - 1.6\n  - tip\n\nservices:\n  - redis-server\n\nenv:\n  global:\n    - secure: \"xxxxx\"\n\nscript:\n  - go fmt ./...\n  - go vet $(go list ./... | grep -v /vendor/)\n  - go test -v cmd/xxxx/*.go -xxxx ${XXXXX}\n\nbefore_install:\n  - go get github.com/tools/godep\n\nbranches:\n  only:\n    - master\n</code></pre>\n\n<p>tip of go version is OK.\nBut 1.6 or 1.5 version can't run well.</p>\n\n<p>How can I manage that situation?</p>\n"}, {"tags": ["arrays", "dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "edited": false, "score": 0, "creation_date": 1469008625, "post_id": 38477962, "comment_id": 64358492, "body": "You won&#39;t be able to assign to assign values to underlying arrays then. If that&#39;s what you need, you need to create a map of pointers."}, {"owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 0, "creation_date": 1469008674, "post_id": 38477962, "comment_id": 64358526, "body": "@nessuno thank you, this solves the first problem at line 10 but I need to solve the rest also, I need to access a specific value of the array and then add to it , any solution?"}, {"owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "reply_to_user": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "edited": false, "score": 0, "creation_date": 1469009051, "post_id": 38477962, "comment_id": 64358769, "body": "I updated my answer following @Nebril hint"}], "tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": false, "score": 0, "last_activity_date": 1469009009, "last_edit_date": 1469009009, "creation_date": 1469008424, "answer_id": 38477962, "question_id": 38477567, "link": "https://stackoverflow.com/questions/38477567/how-to-create-a-mapstring-2int-in-go/38477962#38477962", "title": "How to create a map[string] [2]int in Go?", "body": "<p>Your map initialization is correct.\nYou just need to explicitly declare the type of your map element:</p>\n\n<pre><code>m:= make(map [string][2]int)\nm[\"test\"] = [2]int{1,3}\nfmt.Println(m)\n</code></pre>\n\n<p>This approach work if you don't need to access underlying elements.</p>\n\n<p>If you need this, you have to use pointers:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    m := make(map[string]*[2]int)\n    m[\"hi\"] = &amp;[2]int{2, 3}\n    m[\"heello\"] = &amp;[2]int{0, 1}\n    m[\"hi\"][0] = m[\"hi\"][0] + 1\n    // commented out. Initialize it first\n    //m[\"h\"][1]=m[\"h\"][1]+1\n    fmt.Println(m) // 2 address\n    fmt.Println(m[\"hi\"], m[\"heello\"])\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 0, "creation_date": 1469009440, "post_id": 38478089, "comment_id": 64359008, "body": "thank you but I need to add values without defining the key for example, if m[&quot;hi&quot;] [0]=m[&quot;hi&quot;][0]+1 and if m[&quot;hi&quot;][0] is not created then it automatically be set to the default value which is 0 then m[&quot;hi&quot;][0]=1"}, {"owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "reply_to_user": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 0, "creation_date": 1469025559, "post_id": 38478089, "comment_id": 64370819, "body": "@SaidSaifi You can wrap the assignment in function which will check for the key and create new array if needed. Updated the code above to do that."}], "tags": [], "owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "is_accepted": false, "score": 0, "last_activity_date": 1469025454, "last_edit_date": 1469025454, "creation_date": 1469008719, "answer_id": 38478089, "question_id": 38477567, "link": "https://stackoverflow.com/questions/38477567/how-to-create-a-mapstring-2int-in-go/38478089#38478089", "title": "How to create a map[string] [2]int in Go?", "body": "<p>You need to have a map of pointers to array if you want to be able to assign values to array indices. Check out this code (you need to initiate all map keys before using them as array though).</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc Assign(m map[string]*[2]int, key string, index int, value int) {\n    if _, ok := m[key]; !ok {\n        m[key] = &amp;[2]int{}\n    }\n\n    m[key][index] = value\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n\n    m := make(map[string]*[2]int)\n\n    m[\"hi\"] = &amp;[2]int{2, 3}\n    m[\"h\"] = &amp;[2]int{4, 5}\n\n    //existing key\n    Assign(m, \"h\", 1, 4)\n    //new key\n    Assign(m, \"howdy\", 1, 3)\n\n    fmt.Println(m[\"hi\"])\n    fmt.Println(m[\"h\"])\n    fmt.Println(m[\"howdy\"])\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 0, "creation_date": 1469009568, "post_id": 38478120, "comment_id": 64359085, "body": "thank you but I don&#39;t want to define my keys always I want to use them as their default value if they don&#39;t exist for example if m[&quot;hi&quot;] [0]=m[&quot;hi&quot;][0]+1 and if m[&quot;hi&quot;][0] is not created then it automatically be set to the default value which is 0 then m[&quot;hi&quot;][0]=1"}], "tags": [], "owner": {"reputation": 930, "user_id": 4328963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/505Lz.png?s=128&g=1", "display_name": "huygn", "link": "https://stackoverflow.com/users/4328963/huygn"}, "is_accepted": false, "score": 0, "last_activity_date": 1469008796, "creation_date": 1469008796, "answer_id": 38478120, "question_id": 38477567, "link": "https://stackoverflow.com/questions/38477567/how-to-create-a-mapstring-2int-in-go/38478120#38478120", "title": "How to create a map[string] [2]int in Go?", "body": "<p>See this issue: <a href=\"https://github.com/golang/go/issues/3117\" rel=\"nofollow\">https://github.com/golang/go/issues/3117</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    m := make(map[string][2]int)\n\n    m[\"hi\"] = [2]int{2, 3}\n\n    m[\"heello\"] = [2]int{}\n\n    var tmp = m[\"heello\"]\n    tmp[1] = 1\n    m[\"heello\"] = tmp\n\n    fmt.Println(m)\n}\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1938, "favorite_count": 0, "closed_date": 1469020308, "answer_count": 3, "score": 0, "last_activity_date": 1469025454, "creation_date": 1469007318, "last_edit_date": 1469008535, "question_id": 38477567, "link": "https://stackoverflow.com/questions/38477567/how-to-create-a-mapstring-2int-in-go", "closed_reason": "Duplicate", "title": "How to create a map[string] [2]int in Go?", "body": "<p>I want to create a <code>map[string][2]int</code> in Go. I tried <a href=\"https://play.golang.org/p/tV92Tc4QcN\" rel=\"nofollow\">this</a> at go playground but I got errors. How can I solve this?</p>\n\n<pre><code>fmt.Println(\"Hello, playground\")\nm:= make(map [string][2]int)\nm[\"hi\"]={2,3}\nm[\"heello\"][1]=1\nm[\"hi\"][0]=m[\"hi\"][0]+1\nm[\"h\"][1]=m[\"h\"][1]+1\nfmt.Println(m)\n</code></pre>\n"}, {"tags": ["postgresql", "go", "goroutine"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468997513, "post_id": 38474071, "comment_id": 64351309, "body": "Have you tried starting <code>Exec</code> in a separate goroutine? e.g. <code>go db.Exec(&quot;SELECT * FROM reviews LIMIT 1&quot;)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 6198490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64cda6509188d92b6f864070fedd73d8?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6198490/eric"}, "edited": false, "score": 0, "creation_date": 1468999702, "post_id": 38474536, "comment_id": 64352697, "body": "The first solution (with Go slice) uses too much memory because Query #1 returns more than 1 row in real application. <code>go db.Exec()</code> works for me. Thank you!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 155, "user_id": 6198490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64cda6509188d92b6f864070fedd73d8?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6198490/eric"}, "edited": false, "score": 0, "creation_date": 1469000163, "post_id": 38474536, "comment_id": 64352973, "body": "@Eric Even if query #1 returns more than 1 row, it may use less memory to store the results in a slice, contrary to launching a new goroutine for each row (which also requires memory)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 155, "user_id": 6198490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64cda6509188d92b6f864070fedd73d8?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6198490/eric"}, "edited": false, "score": 0, "creation_date": 1469003909, "post_id": 38474536, "comment_id": 64355236, "body": "@Eric Also note that if you go with the first solution (storing results in a slice), you can also take advantage of using a prepared statement. See edited answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1469017619, "last_edit_date": 1469017619, "creation_date": 1468998479, "answer_id": 38474536, "question_id": 38474071, "link": "https://stackoverflow.com/questions/38474071/goroutines-blocked-connection-pool/38474536#38474536", "title": "Goroutines blocked connection pool", "body": "<p>What you have is a <a href=\"https://en.wikipedia.org/wiki/Deadlock\" rel=\"nofollow\">deadlock</a>. In the worst case scenario you have 15 goroutines holding 15 database connections, and all of those 15 goroutines require a new connection to continue. But to get a new connection, one would have to advance and release a connection: deadlock.</p>\n\n<p>The linked wikipedia article details prevention of deadlock. For example a code execution should only enter a critical section (that locks resources) when it has all the resources it needs (or will need). In this case this means you would have to reserve 2 connections (exactly 2; if only 1 is available, leave it and wait), and if you have those 2, only then proceed with the queries. But in Go you can't reserve connections in advance. They are allocated as needed when you execute queries.</p>\n\n<p>Generally this pattern should be avoided. You should not write code which first reserves a (finite) resource (db connection in this case), and before it would release it, it demands another one.</p>\n\n<p>An easy workaround is to execute the first query, save its result (e.g. into a Go slice), and when you're done with that, then proceed with the subsequent queries (but also don't forget to close <a href=\"https://golang.org/pkg/database/sql/#Rows\" rel=\"nofollow\"><code>sql.Rows</code></a> first). This way your code does not need 2 connections at the same time.</p>\n\n<p>And don't forget to handle errors! I omitted them for brevity, but you should not in your code.</p>\n\n<p>This is how it could look like:</p>\n\n<pre><code>go func() {\n    defer wg.Done()\n\n    rows, _ := db.Query(\"SELECT * FROM reviews LIMIT 1\")\n    var data []int // Use whatever type describes data you query\n    for rows.Next() {\n        var something int\n        rows.Scan(&amp;something)\n        data = append(data, something)\n    }\n    rows.Close()\n\n    for _, v := range data {\n        // You may use v as a query parameter if needed\n        db.Exec(\"SELECT * FROM reviews LIMIT 1\")\n    }\n}()\n</code></pre>\n\n<p>Note that <code>rows.Close()</code> should be executed as a <code>defer</code> statement to make sure it will get executed (even in case of a panic). But if you simply use <code>defer rows.Close()</code>, that would only be executed after the subsequent queries are executed, so it won't prevent the deadlock. So I would refactor it to call it in another function (which may be an anonymous function) in which you can use a <code>defer</code>:</p>\n\n<pre><code>    rows, _ := db.Query(\"SELECT * FROM reviews LIMIT 1\")\n    var data []int // Use whatever type describes data you query\n    func() {\n        defer rows.Close()\n        for rows.Next() {\n            var something int\n            rows.Scan(&amp;something)\n            data = append(data, something)\n        }\n    }()\n</code></pre>\n\n<p>Also note that in the second <code>for</code> loop a prepared statement (<a href=\"https://golang.org/pkg/database/sql/#Stmt\" rel=\"nofollow\"><code>sql.Stmt</code></a>) acquired by <a href=\"https://golang.org/pkg/database/sql/#DB.Prepare\" rel=\"nofollow\"><code>DB.Prepare()</code></a> would probably be a much better choice to execute the same (parameterized) query multiple times.</p>\n\n<p>Another option is to launch subsequent queries in new goroutines so that the query executed in that can happen when the currently locked connection is released (or any other connection locked by any other goroutine), but then without explicit synchronization you don't have control when they get executed. It could look like this:</p>\n\n<pre><code>go func() {\n    defer wg.Done()\n\n    rows, _ := db.Query(\"SELECT * FROM reviews LIMIT 1\")\n    defer rows.Close()\n    for rows.Next() {\n        var something int\n        rows.Scan(&amp;something)\n        // Pass something if needed\n        go db.Exec(\"SELECT * FROM reviews LIMIT 1\")\n    }\n}()\n</code></pre>\n\n<p>To make your program wait for these goroutines too, use the <code>WaitGroup</code> you already have in action:</p>\n\n<pre><code>        // Pass something if needed\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            db.Exec(\"SELECT * FROM reviews LIMIT 1\")\n        }()\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 6198490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64cda6509188d92b6f864070fedd73d8?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6198490/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2145, "favorite_count": 1, "accepted_answer_id": 38474536, "answer_count": 1, "score": 5, "last_activity_date": 1469017619, "creation_date": 1468996997, "question_id": 38474071, "link": "https://stackoverflow.com/questions/38474071/goroutines-blocked-connection-pool", "title": "Goroutines blocked connection pool", "body": "<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    _ \"github.com/lib/pq\"\n    \"sync\"\n)\n\nfunc main() {\n    db, _ := sql.Open(\"postgres\", fmt.Sprintf(\"host=%s dbname=%s user=%s sslmode=disable\", \"localhost\", \"dbname\", \"postgres\"))\n    defer db.Close()\n\n    db.SetMaxOpenConns(15)\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 15; i++ {\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            //#1\n            rows, _ := db.Query(\"SELECT * FROM reviews LIMIT 1\")\n            for rows.Next() {\n                //#2\n                db.Exec(\"SELECT * FROM reviews LIMIT 1\")\n            }\n        }()\n    }\n\n    wg.Wait()\n}\n</code></pre>\n\n<p>Query #1 opens 15 connections and they will be closed when <code>rows.Next()</code> is executed. But <code>rows.Next()</code> will be never executed because it contains <code>db.Exec()</code> that waits for a free connection.</p>\n\n<p>How to solve this problem?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 2, "last_activity_date": 1468992964, "creation_date": 1468992964, "answer_id": 38473043, "question_id": 38472840, "link": "https://stackoverflow.com/questions/38472840/golang-regexp-replaceallstring-ignores-the-replacement-string-x/38473043#38473043", "title": "Golang regexp.ReplaceAllString ignores the replacement string &quot;$X_&quot;", "body": "<p>The fix is to use <code>${1}_$2</code> (or <code>${1}_${2}</code> for symmetry).</p>\n\n<p>Per <a href=\"https://golang.org/pkg/regexp/#Regexp.Expand\" rel=\"nofollow\">https://golang.org/pkg/regexp/#Regexp.Expand</a> (my emphasis):</p>\n\n<blockquote>\n  <p>In the template, a variable is denoted by a substring of the form\n  $name or ${name}, where name is a non-empty sequence of letters,\n  digits, <strong>and underscores</strong>.</p>\n  \n  <p>...</p>\n  \n  <p>In the $name form, name is taken to\n  be as long as possible: $1x is equivalent to ${1x}, not ${1}x, and,\n  $10 is equivalent to ${10}, not ${1}0.</p>\n</blockquote>\n\n<p>So in <code>$1_$2</code>, you're actually looking for a group named <code>1_</code> and then another group named <code>2</code> and putting them together.</p>\n\n<p>As to why using <code>$1_$2</code> (or <code>$foo$2</code> for that matter) results in \"cameCase,\" that same documentation says:</p>\n\n<blockquote>\n  <p>A reference to an out of range or unmatched index or a name that is\n  not present in the regular expression is replaced with an empty slice.</p>\n</blockquote>\n\n<p>So replacing with <code>\"$1_$2\"</code> is equivalent to replacing with just <code>\"$2\"</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 6611635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45db469d93ea61dcd3082caa0b21d859?s=128&d=identicon&r=PG&f=1", "display_name": "user-4859", "link": "https://stackoverflow.com/users/6611635/user-4859"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 38473043, "answer_count": 1, "score": 1, "last_activity_date": 1468993494, "creation_date": 1468991880, "last_edit_date": 1495542747, "question_id": 38472840, "link": "https://stackoverflow.com/questions/38472840/golang-regexp-replaceallstring-ignores-the-replacement-string-x", "title": "Golang regexp.ReplaceAllString ignores the replacement string &quot;$X_&quot;", "body": "<p>I'm trying to convert CamelCase to snake_case using the regex I found <a href=\"https://stackoverflow.com/a/1176023\">here</a>. Here's a snippet of the code I'm using:</p>\n\n<pre><code>in := \"camelCase\"\nvar re1 = regexp.MustCompile(`(.)([A-Z][a-z]+)`)\nout := re1.ReplaceAllString(in, \"$1_$2\")\n</code></pre>\n\n<p>The regex will match <code>lCase</code>. <code>$1</code> here is <code>l</code> and <code>$2</code> is <code>Case</code>, so using the replacement string <code>\"$1_$2\"</code> should result in <code>camel_Case</code>. Instead, it results in <code>cameCase</code>. </p>\n\n<p>Changing the replacement string to <code>\"$1_\"</code> results in <code>came</code>. If I change it to <code>\"$1+$2\"</code>, the result will be <code>camel+Case</code> as expected (<a href=\"https://play.golang.org/p/GemEuXGGxw\" rel=\"nofollow noreferrer\">see playground</a>).</p>\n\n<p>Right now, my workaround is to use <code>\"$1+$2\"</code> as the replacement string, and then using <code>strings.Replace</code> to change the plus sign to an underscore. Is this a bug or am I doing something wrong here?</p>\n"}, {"tags": ["go", "blockchain", "hyperledger"], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "edited": false, "score": 0, "creation_date": 1468992730, "post_id": 38472887, "comment_id": 64348989, "body": "so, my GOPATH is &#39;/opt/gopath/&#39; and my chaincode resides inside the &#39;/src&#39; directory. So, I tried with the following command : &quot; peer chaincode deploy -p /src/ProductBC/ProductBC/finished -n mycc -c &#39;{&quot;Function&quot;:&quot;init&quot;, &quot;Args&quot;: <code>[&quot;hi there&quot;]}&#39;</code> &quot;, it doesn&#39;t throw any error now but seems to get stuck. Updated the question with the new status."}, {"owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "reply_to_user": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "edited": false, "score": 0, "creation_date": 1468993199, "post_id": 38472887, "comment_id": 64349160, "body": "&#39;src&#39; is not necessary. can you try to run this command without it ? (just updated the example in answer)"}, {"owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "edited": false, "score": 0, "creation_date": 1468993758, "post_id": 38472887, "comment_id": 64349364, "body": "by restart the peer you mean building the peer again via &#39;make peer&#39; or just restart the peer by &#39;peer node start&#39; command ?"}, {"owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "edited": false, "score": 0, "creation_date": 1468993889, "post_id": 38472887, "comment_id": 64349419, "body": "still the same issue"}, {"owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "reply_to_user": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "edited": false, "score": 0, "creation_date": 1468993995, "post_id": 38472887, "comment_id": 64349473, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/117769/discussion-between-sergey-balashevich-and-tortuga\">continue this discussion in chat</a>."}, {"owner": {"reputation": 733, "user_id": 1143406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ry7e3.jpg?s=128&g=1", "display_name": "Attila Klenik", "link": "https://stackoverflow.com/users/1143406/attila-klenik"}, "edited": false, "score": 0, "creation_date": 1512064104, "post_id": 38472887, "comment_id": 82116269, "body": "I wondered why they used different path structures (relative/absolute) for golang and node chaincodes. Now I know, thank you for the insight."}], "tags": [], "owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "is_accepted": true, "score": 5, "last_activity_date": 1468994668, "last_edit_date": 1468994668, "creation_date": 1468992134, "answer_id": 38472887, "question_id": 38472750, "link": "https://stackoverflow.com/questions/38472750/hyperledger-custom-chaincode-deployment-error/38472887#38472887", "title": "Hyperledger Custom Chaincode deployment error", "body": "<p>It looks like that you use full path to your chaincode  \u201c/opt/gopath/src/ProductBC/ProductBC/finished/\u201d but <code>peer</code> will try to find chaincode in you gopath by default. </p>\n\n<p>Just try to run CLI command with \u201cProductBC/ProductBC/finished/\u201c instead.</p>\n\n<pre><code>peer chaincode deploy -p ProductBC/ProductBC/finished -c '{\"Function\":\"init\", \"Args\": `[\"hi there\"]}'`\n</code></pre>\n\n<p>in this case peer will try to find this chaincode in $GOPATH/src/ProductBC/ProductBC/finished</p>\n\n<p>P.S. Updated after discussion in chat. </p>\n"}], "owner": {"reputation": 656, "user_id": 827968, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/379f562f33b0bd36fe023e79643fceda?s=128&d=identicon&r=PG", "display_name": "tortuga", "link": "https://stackoverflow.com/users/827968/tortuga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2650, "favorite_count": 1, "accepted_answer_id": 38472887, "answer_count": 1, "score": 3, "last_activity_date": 1468994851, "creation_date": 1468991386, "last_edit_date": 1468994851, "question_id": 38472750, "link": "https://stackoverflow.com/questions/38472750/hyperledger-custom-chaincode-deployment-error", "title": "Hyperledger Custom Chaincode deployment error", "body": "<p>I'm using Hyperledger to work on a POC. I've set the chaincode setup as mentioned <a href=\"https://github.com/hyperledger/fabric/blob/master/docs/Setup/Chaincode-setup.md#chaincode-deploy-via-cli-and-rest\" rel=\"nofollow\">here</a> . I'm following the Option 1 mentioned in the link(using vagrant to run a CA server and one VP). In my current setup, I'm running with security disabled. My VP is running fine, and I'm able to start and register the chaincode just fine (as per mentioned <a href=\"https://github.com/hyperledger/fabric/blob/master/docs/Setup/Chaincode-setup.md#starting-and-registering-the-chaincode\" rel=\"nofollow\">here</a>. But, when I'm trying to deploy my chaincode via CLI with the following command :</p>\n\n<pre><code>peer chaincode deploy -n mycc -c '{\"Function\":\"init\", \"Args\": `[\"hi there\"]}'`\n</code></pre>\n\n<p>I am getting the following error</p>\n\n<pre><code>Error: Error building chaincode: rpc error: code = 2 desc = \"Error getting chaincode package bytes: Cannot generate hashcode from empty chaincode path\"\n</code></pre>\n\n<p>I tried specifically mentioning the path where I've stored my custom chaincode, I get the following error :</p>\n\n<pre><code>Error: Error building chaincode: rpc error: code = 2 desc = \"Path to chaincode does not exist: /opt/gopath/src/ProductBC/ProductBC/finished/\"\n</code></pre>\n\n<p>Has anyone faced a similar issue or any points on what can be done to overcome this ?</p>\n"}, {"tags": ["opengl", "go", "go-gl"], "comments": [{"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 1, "creation_date": 1468999282, "post_id": 38471708, "comment_id": 64352448, "body": "Two points: mgl32 is NOT glm. It is neither supported by glm nor are the functions completely identic. Second: Also the z coordinates are wrong. When you are 10 units away and the far-plane is at 10, then the z-coordinate in both results should be 1.0."}], "answers": [{"tags": [], "owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "is_accepted": true, "score": 3, "last_activity_date": 1468999631, "creation_date": 1468999631, "answer_id": 38474908, "question_id": 38471708, "link": "https://stackoverflow.com/questions/38471708/go-gl-project-method-giving-unexpected-results/38474908#38474908", "title": "Go-GL &quot;Project&quot; method giving unexpected results", "body": "<p>Out of curiosity I looked into the source code of mgl32. It seems that the <a href=\"https://github.com/go-gl/mathgl/blob/master/mgl32/project.go#L61\" rel=\"nofollow\"><code>project</code></a> method is simply wrong:</p>\n\n<pre><code>obj4 := obj.Vec4(1)\n\nvpp := projection.Mul4(modelview).Mul4x1(obj4)\nwin[0] = float32(initialX) + (float32(width)*(vpp[0]+1))/2\nwin[1] = float32(initialY) + (float32(height)*(vpp[1]+1))/2\nwin[2] = (vpp[2] + 1) / 2\n</code></pre>\n\n<p>As one might notice, the perspective divide is missing after the matrix multiplication, thus the function will not work whenever <code>w != 1.0f</code>.</p>\n\n<p>In the first example, one cannot notice the error since x and y are zero after the matrix multiplication, thus dividing by w does not make a difference (except for z). In the second example, the x coordinate is not zero anymore and the bug gets visible.</p>\n"}], "owner": {"reputation": 12272, "user_id": 157852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01bfcacef044c1c4e49a013c0fcbb8c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/157852/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 38474908, "answer_count": 1, "score": 0, "last_activity_date": 1469021139, "creation_date": 1468984453, "last_edit_date": 1469021139, "question_id": 38471708, "link": "https://stackoverflow.com/questions/38471708/go-gl-project-method-giving-unexpected-results", "title": "Go-GL &quot;Project&quot; method giving unexpected results", "body": "<p>Go-GL's Project method is giving me unexpectedly large screen coordinates.</p>\n\n<p>To summarize:</p>\n\n<pre><code>// Screen is 800x600.\nprojection := mgl32.Perspective(\n    mgl32.DegToRad(45), // Field of view (45 degrees).\n    800.0 / 600.0,      // Aspect ratio.\n    0.1,                // Near Z at 0.1.\n    10)                 // Far Z at 10.\ncamera := mgl32.LookAtV(\n    mgl32.Vec3{0, 0.1, 10}, // Camera out on Z and slightly above.\n    mgl32.Vec3{0, 0, 0},    // Looking at the origin.\n    mgl32.Vec3{0, 1, 0}     // Up is positive Y.\nmodel := mgl32.Ident4()     // Simple model matrix, to avoid confusion.\nmodelView := camera.Mul4(model) // The model-view matrix (== camera, here).\n\n// Okay, so what does the origin translate to? Expect center-of-screen, with arbitrary-seeming depth.\norigin := mgl32.Vec3{0, 0, 0}\nscreenOrigin := mgl32.Project(origin, modelView, projection, 0, 0, 800, 600)\nfmt.Printf(\"Origin: (%v, %v, %v)\", screenOrigin[0], screenOrigin[1], screenOrigin[2])\n\n// What about the point 5 to the right of the origin?\n// Expect increased X, but still less than screenWidth.\n// Y and Z should be the same as for the origin.\n// In my actual program, I drew (-1,-1,-1)-(1,1,1) cube at (5,0,0) and\n// it is completely visible in the window.\ntest := mgl32.Vec3{5, 0, 0}\nscreenTest := mgl32.Project(test, modelView, projection, 0, 0, 800, 600)\nfmt.Printf(\"Test:   (%v, %v, %v)\", screenTest[0], screenTest[1], screenTest[2])\n</code></pre>\n\n<p>The results?</p>\n\n<pre><code>Origin: (400, 300, 5.500255)\nTest:   (4021.32, 300, 5.500255)\n</code></pre>\n\n<p>4021.32? That's WAY off the screen!</p>\n\n<p>I've pretty much eliminated all the variables I can think of except for the cube rendering I'm using as a hint basicall. My code is based on this, but I moved the camera and the cube: <a href=\"https://github.com/go-gl/examples/tree/master/gl41core-cube\" rel=\"nofollow\">https://github.com/go-gl/examples/tree/master/gl41core-cube</a></p>\n\n<p>I get the same results if I use (0, 0, 0) as the input vector and translate Ident4() by 5 units in +X (which makes sense).</p>\n\n<p>So what am I doing wrong? Based on the position of the cube I'm drawing, I would expect something like X = 625.</p>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1468968474, "post_id": 38469672, "comment_id": 64343432, "body": "Sounds like <code>ulimit</code> is the right setting to change. According to this discussion it&#39;s not cross platform though <a href=\"https://github.com/golang/go/issues/9849\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/9849</a> so that might be why it&#39;s not working for you."}, {"owner": {"reputation": 8350, "user_id": 772000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0e951e108fe3c1243260497ca9cb4dc?s=128&d=identicon&r=PG", "display_name": "Ale\u0161", "link": "https://stackoverflow.com/users/772000/ale%c5%a1"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1468968743, "post_id": 38469672, "comment_id": 64343527, "body": "Yeah, I came across that discussion but that is only in the context of limiting GO to use &quot;max up to a certain limit&quot;. In my case, I have set the limit to be 16GB but the process&#39; heap never get even close to that max limit."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1468970299, "post_id": 38469672, "comment_id": 64343928, "body": "First, please start with a current version of Go, either 1.6.x or the current 1.7 RCs. there have been a lot of changes that might help. If you want go to use more heap between collections, increase GOGC, which starts off at 100 by default."}, {"owner": {"reputation": 8350, "user_id": 772000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0e951e108fe3c1243260497ca9cb4dc?s=128&d=identicon&r=PG", "display_name": "Ale\u0161", "link": "https://stackoverflow.com/users/772000/ale%c5%a1"}, "edited": false, "score": 0, "creation_date": 1468982568, "post_id": 38469672, "comment_id": 64346486, "body": "Unfortunately, I cannot upgrade to 1.6 yet, the affected production stack is currently running 1.5."}, {"owner": {"reputation": 8350, "user_id": 772000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0e951e108fe3c1243260497ca9cb4dc?s=128&d=identicon&r=PG", "display_name": "Ale\u0161", "link": "https://stackoverflow.com/users/772000/ale%c5%a1"}, "edited": false, "score": 0, "creation_date": 1468982702, "post_id": 38469672, "comment_id": 64346518, "body": "GOGC is a percentage, can it be set to higher than 100?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1469019348, "post_id": 38469672, "comment_id": 64365880, "body": "Yes, you can set GOGC higher, try 400 and see what happens. I don&#39;t recall exactly what the gctrace timings in go1.5 are, but I think it looks like most of your time is in the concurrent scan, so it shouldn&#39;t be impacting you too greatly. This is expected if you have a very large number of pointers."}], "answers": [{"comments": [{"owner": {"reputation": 4835, "user_id": 512378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/214e767631bd5a3ddc524639ad126735?s=128&d=identicon&r=PG", "display_name": "martinezdelariva", "link": "https://stackoverflow.com/users/512378/martinezdelariva"}, "edited": false, "score": 0, "creation_date": 1555059352, "post_id": 54113408, "comment_id": 97984841, "body": "good article about &quot;ballast&quot; to increase the heap allocating a very big slice <a href=\"https://blog.twitch.tv/go-memory-ballast-how-i-learnt-to-stop-worrying-and-love-the-heap-26c2462549a2\" rel=\"nofollow noreferrer\">blog.twitch.tv/&hellip;</a>"}], "tags": [], "owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "is_accepted": true, "score": 4, "last_activity_date": 1555951014, "last_edit_date": 1555951014, "creation_date": 1547047720, "answer_id": 54113408, "question_id": 38469672, "link": "https://stackoverflow.com/questions/38469672/increase-heap-size-in-go/54113408#54113408", "title": "Increase Heap size in GO", "body": "<p>You can control this with the <code>GOGC</code> environment variable.\nIt is a percentage: set it to 200 and the Go runtime will use twice as much memory as before.</p>\n\n<p>[this was buried in the comments; I'm making it visible as an answer]</p>\n\n<p>Update: there is a detailed discussion of different techniques at <a href=\"https://github.com/golang/go/issues/23044\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/23044</a>, including mention of the \"ballast\" technique.</p>\n"}, {"tags": [], "owner": {"reputation": 529, "user_id": 6131839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eb12d67d13faf27310097908bbc5964?s=128&d=identicon&r=PG&f=1", "display_name": "Tomer", "link": "https://stackoverflow.com/users/6131839/tomer"}, "is_accepted": false, "score": 3, "last_activity_date": 1597353428, "creation_date": 1597353428, "answer_id": 63403322, "question_id": 38469672, "link": "https://stackoverflow.com/questions/38469672/increase-heap-size-in-go/63403322#63403322", "title": "Increase Heap size in GO", "body": "<p>The Golang documentation describes GOGC:</p>\n<blockquote>\n<p>The GOGC variable sets the initial garbage collection target\npercentage. A collection is triggered when the ratio of freshly\nallocated data to live data remaining after the previous collection\nreaches this percentage. The default is GOGC=100. Setting GOGC=off\ndisables the garbage collector entirely.</p>\n</blockquote>\n<p>There is an optimal value for GOGC, and it depends on the application and system that you run the Go application on. You can read more in this <a href=\"https://blog.cloudflare.com/go-dont-collect-my-garbage/\" rel=\"nofollow noreferrer\">blog</a> and this <a href=\"https://concertio.com/2020/06/18/optimizing-the-go-garbage-collector-and-concurrency/\" rel=\"nofollow noreferrer\">one</a>.</p>\n<p>You can try different values and see the effects on performance, or use a free tool like <a href=\"https://optimizer.concertio.com\" rel=\"nofollow noreferrer\">Optimizer Studio</a> that will find the optimal GOGC value automatically.</p>\n"}], "owner": {"reputation": 8350, "user_id": 772000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0e951e108fe3c1243260497ca9cb4dc?s=128&d=identicon&r=PG", "display_name": "Ale\u0161", "link": "https://stackoverflow.com/users/772000/ale%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4666, "favorite_count": 2, "accepted_answer_id": 54113408, "answer_count": 2, "score": 4, "last_activity_date": 1597353428, "creation_date": 1468968206, "last_edit_date": 1469018427, "question_id": 38469672, "link": "https://stackoverflow.com/questions/38469672/increase-heap-size-in-go", "title": "Increase Heap size in GO", "body": "<p>Is there a way howto instruct GO runtime to use larger heaps? I am running <code>GO 1.5</code>.</p>\n\n<p>My GO process is currently spending 34% of time in GC but it uses unly 1/3 of available systems memory. </p>\n\n<p>I know <code>ulimit</code> can be used to limit max heap size. I have set ulimit to ~16GB (<code>ulimit -v 17179869184</code>) but the heap size never goes over 5GB.</p>\n\n<p>Using <code>GODEBUG=gctrace=1</code> I can see high GC overhead (34%):</p>\n\n<pre><code>20160719-220359.169294 :: gc 665 @5484.983s 34%: 3.3+2504+188+1635+8.0 ms clock, 26+2504+0+26950/3271/3.5+64 ms cpu, 4825-&gt;4964-&gt;2623 MB, 4948 MB goal, 8 P\n20160719-220406.322354 :: gc 666 @5492.411s 34%: 2.9+212+2111+1749+8.3 ms clock, 23+212+0+25010/3496/146+67 ms cpu, 4846-&gt;4990-&gt;2657 MB, 4970 MB goal, 8 P\n20160719-220413.703514 :: gc 667 @5499.452s 34%: 4.4+4411+0.021+0.25+8.4 ms clock, 35+4411+0+29365/0.054/38+67 ms cpu, 4908-&gt;5022-&gt;2618 MB, 5025 MB goal, 8 P\n</code></pre>\n"}, {"tags": ["go", "interface", "refactoring", "code-duplication"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468970470, "post_id": 38469452, "comment_id": 64343965, "body": "You&#39;ve pretty much outlined your options. And see dave&#39;s answer below. And think about this: what would happen, if a concrete type would already have a <code>MethodA()</code> method besides <code>key()</code>? At least <i>embedding</i> makes it unambiguous what <code>MethodA()</code> would mean (at the <i>&quot;shallowest depth&quot;</i>)."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1468980505, "post_id": 38469452, "comment_id": 64346063, "body": "Your question is essentially &quot;how do I do implementation inheritance and virtual methods in go&quot;, but I think perhaps you&#39;ve got an xy problem. <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a> . If you describe a little context of what you&#39;re doing, there&#39;s probably a solution that isn&#39;t rooted in java-style object-oriented design that&#39;ll fit better in go."}], "answers": [{"comments": [{"owner": {"reputation": 34590, "user_id": 150339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/55fd8ebbdc83c65f2d0fd26b4899df0a?s=128&d=identicon&r=PG", "display_name": "Bruno Reis", "link": "https://stackoverflow.com/users/150339/bruno-reis"}, "edited": false, "score": 0, "creation_date": 1469130075, "post_id": 38469655, "comment_id": 64423160, "body": "thanks! It definitely reduces the amount of boilerplate code. I&#39;ll certainly think of creating packages for certain scenarios. For the specific scenario I&#39;m working with right now, Kaedys&#39; suggestion seems a bit better -- I&#39;ll accept his solution; but thanks for your solution as well, very elegant and useful. +1!"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1468968047, "creation_date": 1468968047, "answer_id": 38469655, "question_id": 38469452, "link": "https://stackoverflow.com/questions/38469452/reducing-code-duplication-in-golang/38469655#38469655", "title": "Reducing code duplication in Golang", "body": "<p>It looks to me like you need to extract a package.  The way I would have the function is</p>\n\n<pre><code>package keyed\n\ntype hasKey interface {\n    Key() string\n}\n\nfunc MethodA(k hasKey) string {\n    key := k.Key()\n    // whatever\n}\n\nfunc MethodB(k hasKey) string {\n    key := k.Key()\n    // whatever\n}\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>package your_package\n\nimport \"keyed\"\n\ntype (\n    FirstType struct { ... }\n    SecondType struct { ... }\n)\n\nfunc (ft *FirstType) Key() string { ... }\nfunc (st *SecondType) Key() string { ... }\n\nfunc main() {\n    first := &amp;FirstType{}\n    second := &amp;SecondType{}\n    keyed.MethodA(first)\n    keyed.MethodA(second)\n    keyed.MethodB(first)\n    keyed.MethodB(second)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34590, "user_id": 150339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/55fd8ebbdc83c65f2d0fd26b4899df0a?s=128&d=identicon&r=PG", "display_name": "Bruno Reis", "link": "https://stackoverflow.com/users/150339/bruno-reis"}, "edited": false, "score": 0, "creation_date": 1469129912, "post_id": 38509703, "comment_id": 64423097, "body": "I like this approach. It still like I have to type <i>more</i> than I would expect (ie, doing the <code>NewSharedFunctionatily(firstTypeInstance)</code> so I can call my <code>.MethodA()</code>), but seems like it&#39;s the best I will get. I like Dave&#39;s approach as well, but, at least for now, it seems that this solution works better for me (ie, having an object implementing the methods, instead of having to call functions on a package). Thanks!"}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 1, "last_activity_date": 1469128624, "last_edit_date": 1469128624, "creation_date": 1469118778, "answer_id": 38509703, "question_id": 38469452, "link": "https://stackoverflow.com/questions/38469452/reducing-code-duplication-in-golang/38509703#38509703", "title": "Reducing code duplication in Golang", "body": "<p>Fun fact: you can embed interfaces into structs, and the struct then automatically fulfills that interface.  You can use this to effectively define methods on interfaces:</p>\n\n<p><a href=\"https://play.golang.org/p/ZufTOzr9ig\" rel=\"nofollow\">https://play.golang.org/p/ZufTOzr9ig</a></p>\n\n<pre><code>type (\n    WithKey interface {\n        key() string\n    }\n\n    SharedFunctionality interface {\n        WithKey\n        MethodA() string\n        MethodB() string\n    }\n\n    KeyHolder struct {\n        WithKey\n    }\n\n    FirstType struct { ... }\n    SecondType struct { ... }\n)\n\nfunc (k *KeyHolder) MethodA() string {\n    key := k.key()\n    // ...\n}\n\nfunc (k *KeyHolder) MethodB() string {\n    key := k.key()\n    // ...\n}\n\nfunc NewSharedFunctionality(w WithKey) SharedFunctionality {\n    return &amp;KeyHolder{w}\n}\n\nfunc (ft *FirstType) key() string { ... }\nfunc (st *SecondType) key() string { ... }\n</code></pre>\n\n<p>In this case, the <code>KeyHolder</code> struct embeds the <code>WithKey</code> interface, and thus can hold anything that has the <code>key() string</code> method (which both <code>FirstType</code> and <code>SecondType</code> have).  You can then define <code>MethodA</code> and <code>MethodB</code> on that struct, and that struct will then fulfill both the <code>WithKey</code> interface (because it embeds it) and the <code>SharedFunctionality</code> interface, using whatever key is returned by the embedded <code>WithKey</code>.</p>\n\n<p>In other words, instead of wrapping <code>FirstType</code> in <code>WithKey</code> and then in <code>SharedFunctionality</code> (meaning <code>FirstType</code> itself has to define <code>key()</code>, <code>MethodA()</code>, and <code>MethodB()</code>), you wrap <code>FirstType</code> in <code>WithKey</code>, then embed it (as a <code>WithKey</code> interface) in some other structure that exists solely to define those default methods <code>MethodA</code> and <code>MethodB</code>, which then fulfills the <code>SharedFunctionality</code> interface.</p>\n"}], "owner": {"reputation": 34590, "user_id": 150339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/55fd8ebbdc83c65f2d0fd26b4899df0a?s=128&d=identicon&r=PG", "display_name": "Bruno Reis", "link": "https://stackoverflow.com/users/150339/bruno-reis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2051, "favorite_count": 0, "accepted_answer_id": 38509703, "answer_count": 2, "score": 1, "last_activity_date": 1469128624, "creation_date": 1468966799, "last_edit_date": 1468967251, "question_id": 38469452, "link": "https://stackoverflow.com/questions/38469452/reducing-code-duplication-in-golang", "title": "Reducing code duplication in Golang", "body": "<p>I'm having trouble find the \"go-way\" to solve a code duplication issue. Here's the problem. Consider the following:</p>\n\n<pre><code>type (\n  WithKey interface {\n    key() string\n  }\n\n  SharedFunctionality interface {\n    WithKey\n    MethodA() string\n    MethodB() string\n    // ... etc ...\n  }\n\n  FirstType struct { ... }\n  SecondType struct { ... }\n  // ... etc ...\n)\nfunc (ft *FirstType) key() string { ... }\nfunc (st *SecondType) key() string { ... }\n</code></pre>\n\n<p>Now, the methods in <code>SharedFunctionality</code> they only depend on the results of the <code>key()</code> method. I could implement them like the following:</p>\n\n<pre><code>func runMethodA(k WithKey) string {\n  key := k.key()\n  // do something and return a string\n}\nfunc runMethodB(k WithKey) string {\n  key := k.key()\n  // do something else and return a string\n}\n\nfunc (ft *FirstType) MethodA() string { return runMethodA(ft) }\nfunc (ft *FirstType) MethodB() string { return runMethodB(ft) }\nfunc (st *SecondType) MethodA() string { return runMethodA(st) }\nfunc (st *SecondType) MethodB() string { return runMethodB(st) }\n</code></pre>\n\n<p>What I dislike about this approach is that, as I add more types (ThirdType, FourthType, etc) or as I add more methods to SharedFunctionality, I have to add tons of boilerplate code... specifically, for M methods in SharedFunctionality, and N types, I would have to spell out M*N one-liners like the 4 above.</p>\n\n<p>What I would <em>love</em> to do is something like:</p>\n\n<pre><code>func (k WithKey) MethodA() string {\n  key := k.key()\n  // do something\n}\n</code></pre>\n\n<p>In other words: I'd love to define a method on an Interface type. Meaning: all objects that implement \"WithKey\" would automatically get <code>MethodA() string</code>, <code>MethodB() string</code>, etc, therefore they would automatically implement the <code>SharedFunctionality</code> interface. Something like <em>default methods</em> in <em>Java interfaces</em>.</p>\n\n<p>However, I know it's impossible to define a method in an Interface type...</p>\n\n<p>What's the go-way of solving this problem?</p>\n\n<p>I've seen an approach where I would create a struct with an anonymous field of the interface type, and then implement the methods there:</p>\n\n<pre><code>type SharedFuncStruct struct {\n  WithKey\n}\nfunc (sfs *SharedFuncStruct) MethodA() string {\n  key := sfs.key()\n  // whatever\n}\n// same for MethodB()\n</code></pre>\n\n<p>Then to use it, I would do something like:</p>\n\n<pre><code>first := ... getFirstTypeValue()\nsfs := &amp;SharedFuncStruct{first}\nsfs.MethodA() // etc\n</code></pre>\n\n<p>This looks like it could work, but it still feels like too much boilerplate code.</p>\n\n<p>Any other alternatives?</p>\n"}, {"tags": ["pointers", "go", "slice"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1468961602, "post_id": 38468258, "comment_id": 64340658, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/38013922/slicing-a-slice-pointer-passed-as-argument\">Slicing a slice pointer passed as argument</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468961660, "post_id": 38468258, "comment_id": 64340690, "body": "and also <a href=\"http://stackoverflow.com/questions/28709254/how-to-access-elements-from-slice-using-index-which-is-passed-by-reference-in-go\" title=\"how to access elements from slice using index which is passed by reference in go\">stackoverflow.com/questions/28709254/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468961814, "post_id": 38468258, "comment_id": 64340786, "body": "indexing a slice pointer isn&#39;t allowed, just like most other operators aren&#39;t valid for pointers. The type of the pointer is separate type from the underlying slice."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468961880, "post_id": 38468258, "comment_id": 64340827, "body": "@JimB Note that indexing a pointer to array is allowed. See my linked answer."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468962076, "post_id": 38468258, "comment_id": 64340946, "body": "@icza: yes thanks, I always forget about that one"}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1468965033, "creation_date": 1468965033, "answer_id": 38469107, "question_id": 38468258, "link": "https://stackoverflow.com/questions/38468258/why-is-indexing-on-the-slice-pointer-not-allowed-in-golang/38469107#38469107", "title": "why is indexing on the slice pointer not allowed in golang", "body": "<p>There's an abstraction happening there and the language designer chose not to apply it to the pointer. To give some practical reason, this is likely due to the fact that the pointer doesn't point to the beginning of an array (like the block of memory. If you're familiar with indexing this is generally done with something like <code>startingAddress + index * sizeof(dataType)</code>). So when you have the value type, it's already providing an abstraction to hide the extra layer of indirection that occurs. I assume the language authors didn't think it made sense to do this when you have a pointer to the slice object, given that points off to the actual memory that would be a pretty misleading. It already causes some confusion as is, but for a lot of developers, they probably will never realize this abstraction exists at all (like in most cases there is no noticeable difference in syntax when operating on a slice vs and array).</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 22, "last_activity_date": 1530205271, "last_edit_date": 1530205271, "creation_date": 1530204618, "answer_id": 51087975, "question_id": 38468258, "link": "https://stackoverflow.com/questions/38468258/why-is-indexing-on-the-slice-pointer-not-allowed-in-golang/51087975#51087975", "title": "why is indexing on the slice pointer not allowed in golang", "body": "<p>Write <code>(*p)</code> to dereference the pointer <code>p</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    txs := make([]string, 2)\n    txs[0] = \"A\"\n    p := &amp;txs\n    fmt.Println((*p)[0])\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/6Ex-3jtmw44\" rel=\"noreferrer\">https://play.golang.org/p/6Ex-3jtmw44</a></p>\n\n<p>Output:</p>\n\n<pre><code>A\n</code></pre>\n"}], "owner": {"reputation": 802, "user_id": 2018909, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/10ebdad579fc333db3830e893baf977e?s=128&d=identicon&r=PG", "display_name": "srini", "link": "https://stackoverflow.com/users/2018909/srini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4279, "favorite_count": 5, "accepted_answer_id": 38469107, "answer_count": 2, "score": 6, "last_activity_date": 1530205271, "creation_date": 1468961372, "question_id": 38468258, "link": "https://stackoverflow.com/questions/38468258/why-is-indexing-on-the-slice-pointer-not-allowed-in-golang", "title": "why is indexing on the slice pointer not allowed in golang", "body": "<p>When I run the below code, I get the compiler error saying that indexing is not supported. </p>\n\n<pre><code>txs := make([]string, 2)\ntxs[0] = \"A\"\n\np := &amp;txs\n\nfmt.Println(p[0])\n</code></pre>\n\n<p>I'm trying to understand why indexing on the slice pointer is not supported. I can make a copy of the pointer variable to value variable and then do indexing, but I'm curious to understand why the language is not supporting the indexing on slice pointer; it'd be so much convenient to do so. or is there a way to do it that i'm not aware? please let me know your thoughts.</p>\n"}, {"tags": ["image", "go", "base64"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1468956702, "post_id": 38466804, "comment_id": 64337999, "body": "jpeg is a lossy compression and varies by encoder/decoder, so you can&#39;t exactly compare image data from to different jpeg files (and comparing visual similarity is a very large subject for an SO answer). However, if the file size is exactly the same, then you probably have the same image and are incorrectly comparing the base64. (also it&#39;s much more efficient to compare a hash, why compare the entire image data?)"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1468959241, "post_id": 38466804, "comment_id": 64339374, "body": "Two possibilities: 1) the actual image data is identical and only the headers are different, and 2) the image <i>looks</i> the same but is actually different at the level of the image data. For the former, you should be able to strip the metadata and compare just the image data. This would require some knowledge of the JPEG format. For the latter, you&#39;ll want some sort of &quot;image hashing&quot; algorithm, e.g. PhotoDNA. These algorithms hash images visually and are meant to be robust to scaling and rotation."}], "answers": [{"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 3, "last_activity_date": 1468964518, "creation_date": 1468964518, "answer_id": 38469006, "question_id": 38466804, "link": "https://stackoverflow.com/questions/38466804/comparing-base64-image-strings-in-golang/38469006#38469006", "title": "Comparing base64 image strings in Golang", "body": "<p><a href=\"http://www.phash.org/\" rel=\"nofollow noreferrer\">Perceptual Hash</a> is a library to calculate a phash; a hash of an image based on visual characteristics. <a href=\"https://github.com/carlogit/phash\" rel=\"nofollow noreferrer\">github.com/carlogit/phash</a> is a golang implementation. It has functions to create and compare two hashes to give a 'distance' indicating how dissimilar two images are.</p>\n\n<p>Out of interest I gave it a try, it's simple to use and effective with some test images. For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ynSxL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ynSxL.jpg\" alt=\"Queenstown\"></a> <a href=\"https://i.stack.imgur.com/ynSxL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ynSxL.jpg\" alt=\"Queenstown\"></a> <strong><code>distance: 0</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ynSxL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ynSxL.jpg\" alt=\"Queenstown\"></a> <a href=\"https://i.stack.imgur.com/mBekf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mBekf.jpg\" alt=\"Queenstown Gold\"></a> <strong><code>distance: 2</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ynSxL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ynSxL.jpg\" alt=\"Queenstown\"></a> <a href=\"https://i.stack.imgur.com/d0mIX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d0mIX.jpg\" alt=\"Homer Saddle\"></a> <strong><code>distance: 32</code></strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n\n    \"github.com/carlogit/phash\"\n)\n\nfunc main() {\n    if len(os.Args) &lt; 3 {\n        log.Fatalf(\"usage: %s &lt;ImageFileA&gt; &lt;ImageFileB&gt;\\n\", os.Args[0])\n    }\n\n    a := hash(os.Args[1])\n    b := hash(os.Args[2])\n    distance := phash.GetDistance(a, b)\n\n    fmt.Printf(\"distance: %d\\n\", distance)\n}\n\n//hash returns a phash of the image\nfunc hash(filename string) string {\n    img, err := os.Open(filename)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer img.Close()\n\n    ahash, err := phash.GetHash(img)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return ahash\n}\n</code></pre>\n"}], "owner": {"reputation": 7606, "user_id": 180253, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df46030788b7cc95cadb9778a2b9e7dd?s=128&d=identicon&r=PG", "display_name": "TheJediCowboy", "link": "https://stackoverflow.com/users/180253/thejedicowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1524, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535393089, "creation_date": 1468955976, "last_edit_date": 1468959063, "question_id": 38466804, "link": "https://stackoverflow.com/questions/38466804/comparing-base64-image-strings-in-golang", "title": "Comparing base64 image strings in Golang", "body": "<p>I have a service that compares two base64 encoded image strings</p>\n\n<p>My initial attempt revealed that there is differences in metadata while the actual image (JPG) in this case is identical (size,resolution,dimensions,etc).</p>\n\n<p>Is there a way to strip away much of the dynamic metadata so that I can just compare the visual aspect of the image?</p>\n\n<p>Currently, I am using the following...</p>\n\n<pre><code>package converter\n\nimport (\n    \"bufio\"\n    \"encoding/base64\"\n    \"log\"\n    \"os\"\n)\n\nfunc Base64(path string) (string, error) {\n    imgFile, err := os.Open(path)\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    defer imgFile.Close()\n\n    // create a new buffer base on file size\n    fInfo, _ := imgFile.Stat()\n    var size int64 = fInfo.Size()\n    buf := make([]byte, size)\n\n    // read file content into buffer\n    fReader := bufio.NewReader(imgFile)\n    fReader.Read(buf)\n\n    // convert the buffer bytes to base64 string - use buf.Bytes() for new image\n    imgBase64Str := base64.StdEncoding.EncodeToString(buf)\n\n    return imgBase64Str,nil\n}\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1468956981, "post_id": 38466686, "comment_id": 64338151, "body": "What is the database? What&#39;s the data type of the column receiving the date? Can you show the code you&#39;re using when presenting to the user?"}, {"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1468958343, "post_id": 38466686, "comment_id": 64338855, "body": "To echo @Mark - It sounds like you recognize the database field needs to stay UTC, so you&#39;ll need to adjust on insert and select statements instead.  This is a <b>very</b> common problem amongst most any dev (converting datetime values to local representation)."}, {"owner": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "edited": false, "score": 0, "creation_date": 1468993800, "post_id": 38466686, "comment_id": 64349377, "body": "Check out <a href=\"http://stackoverflow.com/questions/25318154/convert-utc-to-local-time-go\" title=\"convert utc to local time go\">stackoverflow.com/questions/25318154/&hellip;</a> this answer."}], "answers": [{"tags": [], "owner": {"reputation": 1241, "user_id": 1233410, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/876e9c31e7af3c04eaab42ac466674f1?s=128&d=identicon&r=PG", "display_name": "sope", "link": "https://stackoverflow.com/users/1233410/sope"}, "is_accepted": false, "score": -3, "last_activity_date": 1468993131, "creation_date": 1468993131, "answer_id": 38473074, "question_id": 38466686, "link": "https://stackoverflow.com/questions/38466686/golang-inserting-time-now-into-database-being-shifted-to-utc/38473074#38473074", "title": "Golang inserting time.Now into database being shifted to UTC", "body": "<p>because time in golang parse will use the UTC</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 5237024, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lnq7jBK21ho/AAAAAAAAAAI/AAAAAAAAAs0/e03ID_-lT1s/photo.jpg?sz=128", "display_name": "Gilmar Palega", "link": "https://stackoverflow.com/users/5237024/gilmar-palega"}, "is_accepted": false, "score": 5, "last_activity_date": 1469978283, "creation_date": 1469978283, "answer_id": 38685412, "question_id": 38466686, "link": "https://stackoverflow.com/questions/38466686/golang-inserting-time-now-into-database-being-shifted-to-utc/38685412#38685412", "title": "Golang inserting time.Now into database being shifted to UTC", "body": "<p>This is the way I use to always store local time. Works fine even if your VPS is located on another timezone country:</p>\n\n<pre><code>db, err = gorm.Open(\"mysql\", \"root:@tcp(localhost:3306)/mydatabase?charset=utf8&amp;parseTime=True&amp;loc=America%2FSao_Paulo\")\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 3689247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7a648a4c50aff110dba2c7116e22aa21?s=128&d=identicon&r=PG", "display_name": "Fireynis", "link": "https://stackoverflow.com/users/3689247/fireynis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3245, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1469978283, "creation_date": 1468955478, "last_edit_date": 1468958141, "question_id": 38466686, "link": "https://stackoverflow.com/questions/38466686/golang-inserting-time-now-into-database-being-shifted-to-utc", "title": "Golang inserting time.Now into database being shifted to UTC", "body": "<p>I am trying to insert a time.Now() field into the database, but what keeps happening is the time is shifted forward to UTC. I understand the idea is to always to that then convert to local time when presenting to the user. Problem is I have inherited this system and it is currently far to ingrained to be easily changed.</p>\n\n<p>Any tips? I saw that you can set the loc in the DSN but it does not explain what to change it to nor its actual effect, so I would appreciate information there.</p>\n\n<p>Edit: Some information, it is MySQL DB,using go-mysql 1.1 and go 1.6.3. The data is being inserted into a DATETIME field.</p>\n\n<p>The data is incorrect at the insert. GORM Debug shows one time and MySQL query logger  shows it shifted forward.</p>\n\n<p>I have found that the issue is that the go-mysql driver automatically shifts times to be UTC, and this can be altered using the loc parameter in the DSN. This however also changes how the time is returned.</p>\n\n<p>To resolve this add loc=Local to your DSN.</p>\n"}, {"tags": ["go", "profiling"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1468953487, "last_edit_date": 1468953487, "creation_date": 1468952695, "answer_id": 38465878, "question_id": 38465119, "link": "https://stackoverflow.com/questions/38465119/go-cpu-profile-is-lacking-function-call-information/38465878#38465878", "title": "Go CPU profile is lacking function call information", "body": "<p>You're missing the binary argument to pprof:</p>\n\n<pre><code>go tool pprof --text miniprofile prof\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 2870681, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/21264df3baa23f3231ee6d8bee1dea46?s=128&d=identicon&r=PG&f=1", "display_name": "borellini", "link": "https://stackoverflow.com/users/2870681/borellini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 38465878, "answer_count": 1, "score": 0, "last_activity_date": 1468953487, "creation_date": 1468949982, "question_id": 38465119, "link": "https://stackoverflow.com/questions/38465119/go-cpu-profile-is-lacking-function-call-information", "title": "Go CPU profile is lacking function call information", "body": "<p>I have been trying to dive in to Go (golang) performance analysis, based on articles like <a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"nofollow\">https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs</a> .</p>\n\n<p>However, in the actual profiled programs, the generated CPU profiles have very little information. The go tool either tells that the profile is empty or it has no information about any function calls. This happens on both OS X and Linux.</p>\n\n<p>I generated a minimal example of this situation - I am gathering the profile in a similar manner and facing the same issues in actual programs, too.</p>\n\n<p>Here's the source code for <code>miniprofile/main.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"runtime/pprof\"\n)\n\nfunc do_something(prev string, limit int) {\n    if len(prev) &lt; limit {\n        do_something(prev+\"a\", limit)\n    }\n}\n\nfunc main() {\n    f, err := os.Create(\"./prof\")\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n    pprof.StartCPUProfile(f)\n    defer pprof.StopCPUProfile()\n\n    do_something(\"\", 100000)\n}\n</code></pre>\n\n<p>I am expecting to see a CPU profile that tells that almost all the time has been spent on different recursive calls to do_something.</p>\n\n<p>However, this happens (the minimal app above is called miniprofile) - not very useful:</p>\n\n<pre><code>$ go version\ngo version go1.6.2 darwin/amd64\n$ go install .\n$ miniprofile\n$ go tool pprof --text prof\n1.91s of 1.91s total (  100%)\n      flat  flat%   sum%        cum   cum%\n     1.91s   100%   100%      1.91s   100%\n</code></pre>\n\n<p>Am I doing something in a horribly wrong way?</p>\n"}, {"tags": ["go", "localhost", "fileserver"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1468948842, "post_id": 38464730, "comment_id": 64333451, "body": "first, check the error from ListenAndServeTLS, then try using the same IP address in both the server and client."}, {"owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468949066, "post_id": 38464730, "comment_id": 64333579, "body": "How to check the error from <code>ListenAndServeTLS</code>? The messages in the console of LideIDE seems no error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1468950549, "post_id": 38464730, "comment_id": 64334467, "body": "There&#39;s no error, because you&#39;re not checking for an error. The output shows the server process exiting, which means it&#39;s not serving anything. You check the error from ListenAndServeTLS like any other error, or just print it out regardless with something like <code>log.Fatal(http.ListenAndServeTLS(...</code>"}, {"owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468953180, "post_id": 38464730, "comment_id": 64336022, "body": "<code>2016&#47;07&#47;20 02:29:02 open rui.crt: The system cannot find the file specified.</code>"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1468956286, "post_id": 38464730, "comment_id": 64337786, "body": "Use full path to specify the key and crt file."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1468957736, "last_edit_date": 1495540445, "creation_date": 1468956926, "answer_id": 38467076, "question_id": 38464730, "link": "https://stackoverflow.com/questions/38464730/making-a-simple-fileserver-with-go-and-localhost-refused-to-connect/38467076#38467076", "title": "Making a Simple FileServer with Go and Localhost Refused to Connect", "body": "<p><strong>your system cannot find the certificate file.</strong>:<br>\nthis error means you need \"rui.crt\" file alongside with your main binary file.<br>\nif you do not have certificate see: <a href=\"https://stackoverflow.com/questions/10175812/how-to-create-a-self-signed-certificate-with-openssl\">How to create a self-signed certificate with openssl?</a>  </p>\n\n<p>then copy \"server.pem\", \"server.key\" files to your binary(.exe) file directory</p>\n\n<p>and run this sample code (for test):  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\ntype server struct {\n}\n\nfunc (s server) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprint(w, \"*Hello World\\n*\")\n}\n\nfunc main() {\n    if err := http.ListenAndServeTLS(\":443\", \"server.pem\", \"server.key\", server{}); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>then open web page: <code>https://127.0.0.1/</code><br>\nif firewall poped up say yes,<br>\nif you see <code>There is a problem with this website\u2019s security certificate.</code>  say continue (advance).</p>\n\n<p>output:  </p>\n\n<pre><code>*Hello World\n*\n</code></pre>\n"}], "owner": {"reputation": 3199, "user_id": 2828227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CEPMO.jpg?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/2828227/casper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 1, "accepted_answer_id": 38467076, "answer_count": 1, "score": 0, "last_activity_date": 1469276168, "creation_date": 1468948665, "last_edit_date": 1469276168, "question_id": 38464730, "link": "https://stackoverflow.com/questions/38464730/making-a-simple-fileserver-with-go-and-localhost-refused-to-connect", "title": "Making a Simple FileServer with Go and Localhost Refused to Connect", "body": "<p>Now I have the following code extracted from a book.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    h := http.FileServer(http.Dir(\".\"))\n    http.ListenAndServeTLS(\":8001\", \"rui.crt\", \"rui.key\", h)\n}\n</code></pre>\n\n<p>I expect it can list all the file in the folder of <code>main.go</code> but when I browse to:<br>\n <a href=\"https://localhost:8001\" rel=\"nofollow\">https://localhost:8001</a><br>\nI can only see: </p>\n\n<pre><code>This site can\u2019t be reached.  \nlocalhost refused to connect.\n</code></pre>\n\n<p>I use LiteIDE to build and run the program. After <kbd>BuildAndRun</kbd> clicked, the following messages are shown.</p>\n\n<pre><code>F:/Go/bin/go.exe build -i [E:/Users/User/Desktop/codespace_v2.6.6/dev/server_side/golang/go_codespace_v2.1/server]\nSuccess: process exited with code 0.\nE:/Users/User/Desktop/codespace_v2.6.6/dev/server_side/golang/go_codespace_v2.1/server/server.exe  [E:/Users/User/Desktop/codespace_v2.6.6/dev/server_side/golang/go_codespace_v2.1/server]\nSuccess: process exited with code 0.\n</code></pre>\n\n<p>Why and how can I fix it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468945948, "post_id": 38463955, "comment_id": 64331924, "body": "Can you share the definition of <code>containsAny</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1468945998, "post_id": 38463955, "comment_id": 64331960, "body": "we can&#39;t guess what the rest of the code does. Please post a <a href=\"http://stackoverflow.com/help/mcve\">minimal, complete, verifiable example</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432453"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468946624, "post_id": 38463955, "comment_id": 64332296, "body": "@abhink No problem, I have edited the code with the containsAny func. Thanks for looking it over."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1468947702, "post_id": 38463955, "comment_id": 64332848, "body": "Probably gonna have to post more of your apps code. The logic in <code>containsArray</code> looks correct to me so the problem is likely upstream. Are you sure the tinder API has returned the data you were expecting? Was it unmarshalled successfully? I don&#39;t think character encoding would be an issue in Go (pretty sure it&#39;s all UTF-8 by default) but I would start thinking of things like this that may cause the contains to fail."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1468954244, "post_id": 38463955, "comment_id": 64336670, "body": "The <a href=\"https://play.golang.org/p/pP2oTWMbWR\" rel=\"nofollow noreferrer\">contains any</a> works"}], "owner": {"user_type": "does_not_exist", "display_name": "user6432453"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468947341, "creation_date": 1468945748, "last_edit_date": 1468946906, "question_id": 38463955, "link": "https://stackoverflow.com/questions/38463955/go-code-not-running-as-expected", "title": "Go code not running as expected", "body": "<p>I am building a bot that parses tinder for key words. Currently doing a test which should filter out specific names. For test purposes it is supposed to match rather than pass, hence 'true' rather than 'false'.</p>\n\n<p>\"Ex\" is an array of names declared in a JSON file called \"filter.json\".  </p>\n\n<p>The issue is that I get a \"nothing matched\" notification on names declared in the array, which it should match. </p>\n\n<pre><code>type Filter struct {\n    Ex     []string\n}\n\nfunc containsAny(text []string, keys []string) (string, bool) {\n    for _, part := range text {\n        for _, key := range keys {\n            if strings.Contains(strings.ToLower(part), strings.ToLower(key)) {\n                return key, true\n            }\n        }\n}\n\n    return \"\", false\n}\n\nfunc match(rec tinder.Recommendation) (string, bool) {\n    if name, ok := containsAny([]string{rec.Name}, filter.Ex); ok {\n        return fmt.Sprintf(\"ex name: %s\", name), true\n    }\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "testing", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1468944858, "post_id": 38463609, "comment_id": 64331256, "body": "Because the all the tests you specified, which was none, passed, or in other words you had no test failures."}, {"owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468945494, "post_id": 38463609, "comment_id": 64331641, "body": "That behaviour doesn&#39;t really make sense, I would expect it to say something like &quot;Test &#39;NotExist&#39; not found&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468945621, "post_id": 38463609, "comment_id": 64331710, "body": "It&#39;s just the behavior everyone has agreed upon. It&#39;s often how you run benchmarks without executing any tests, or check for test compilation errors."}], "answers": [{"comments": [{"owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "edited": false, "score": 0, "creation_date": 1468962122, "post_id": 38466246, "comment_id": 64340969, "body": "Thinking about this again the behaviour does make sense. I&#39;ve heard it said that you can&#39;t prove the absence of errors. You can only test for their presence. If nothing fails explicitly then assume it&#39;s working. The thing that annoys me is that if I made a typo in the command I won&#39;t get a warning."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "edited": false, "score": 1, "creation_date": 1468962896, "post_id": 38466246, "comment_id": 64341322, "body": "@mozey Agree. But a simple <code>go test</code> will reveal errors, and that is what you should use to test / validate. You should only use the <code>-run</code> option if you want to quickly test some changes."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1468956142, "last_edit_date": 1468956142, "creation_date": 1468953914, "answer_id": 38466246, "question_id": 38463609, "link": "https://stackoverflow.com/questions/38463609/why-does-go-test-run-notexist-pass/38466246#38466246", "title": "Why does `go test -run NotExist` pass?", "body": "<p>Without the <code>-run</code> option <code>go test</code> runs all tests. You use the <code>-run</code> option to <em>not run all tests</em>; to <em>filter out</em>, to <em>exclude</em> tests (and you do this in the form of <em>requiring</em> names of non-excludable tests to <em>match</em> a regexp pattern - but this is irrelevant form the point of discussion):</p>\n\n<p><a href=\"https://golang.org/cmd/go/#hdr-Test_packages\" rel=\"nofollow\">Command go, Test packages:</a></p>\n\n<blockquote>\n  <p>By default, go test needs no arguments. It compiles and tests the package with source in the current directory, including tests, and runs the tests.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/cmd/go/#hdr-Description_of_testing_flags\" rel=\"nofollow\">Description of testing flags:</a></p>\n\n<blockquote>\n<pre><code>-run regexp\n   Run only those tests and examples matching the regular expression.\n</code></pre>\n</blockquote>\n\n<p>It is a perfectly \"normal\" outcome that a filtering filters out all tests, that no tests remains in the set of tests that still need to be executed.</p>\n\n<p>When no tests FAIL, it is considered as the test run PASSes. If no tests match, no tests will run and no tests will FAIL, and thus the test run will PASS.</p>\n"}], "owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 38466246, "answer_count": 1, "score": 1, "last_activity_date": 1468959396, "creation_date": 1468944592, "last_edit_date": 1468959396, "question_id": 38463609, "link": "https://stackoverflow.com/questions/38463609/why-does-go-test-run-notexist-pass", "title": "Why does `go test -run NotExist` pass?", "body": "<p>If I run the following</p>\n\n<pre><code>go test -run NotExist\n</code></pre>\n\n<p>The response is PASS. Seeing as my test file does not contain a test called <code>TestNotExist</code> I would expect the command above to return FAIL</p>\n"}, {"tags": ["go", "vendor"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1468945343, "post_id": 38463367, "comment_id": 64331563, "body": "This is a vague question to me. What go version are you using? Have you considered trying the <code>vendor</code> directory that go supports in 1.5 and above?"}, {"owner": {"reputation": 26092, "user_id": 824377, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e600bd229c588891a7616f303e30efd9?s=128&d=identicon&r=PG", "display_name": "AJcodez", "link": "https://stackoverflow.com/users/824377/ajcodez"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1468946800, "post_id": 38463367, "comment_id": 64332391, "body": "@squiguy edited. I hope it makes more sense."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1468953221, "post_id": 38463367, "comment_id": 64336046, "body": "This is something which would need to be done by the tools you use to vendor. I don&#39;t know if godep can list missing packages, but I know others like <code>govendor</code> and <code>glide</code> can be used to do that. If you want something checked on commit, push, etc, that&#39;s what git hooks are for."}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1468955397, "post_id": 38463367, "comment_id": 64337332, "body": "I know it&#39;s not an answer to suggest other tools, but this is the reason I use <a href=\"https://getgb.io\" rel=\"nofollow noreferrer\">gb</a>."}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 1958936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1939e2abb60ac78843f8ef739b1190da?s=128&d=identicon&r=PG", "display_name": "Vadim Petrov", "link": "https://stackoverflow.com/users/1958936/vadim-petrov"}, "is_accepted": false, "score": 1, "last_activity_date": 1469196732, "creation_date": 1469196732, "answer_id": 38528629, "question_id": 38463367, "link": "https://stackoverflow.com/questions/38463367/how-to-run-go-command-using-only-vendor-dependencies/38528629#38528629", "title": "How to run go command using only vendor dependencies?", "body": "<p>There is no way to prevent builder to scan <code>$GOPATH</code> for packages. It seems, that you use not really good flow for manage dependencies. I recommend you to use <code>glide</code> for a vendoring.</p>\n\n<p>Most recommended workflow:</p>\n\n<ol>\n<li>Keep actual list of dependencies in <code>glide.yaml</code>.</li>\n<li>Run <code>glide up</code> after any changes in <code>glide.yaml</code>. It will install all dependencies to <code>vendor</code> directory and generate <code>glide.lock</code> with fixed package versions. Commit <code>glide.lock</code> to VCS. <strong>Do not</strong> change manually <code>glide.lock</code>.</li>\n<li><strong>Do not</strong> commit <code>vendor</code> directory to VCS.</li>\n<li>Run <code>glide install</code> on your CI or build server to install dependencies by <code>glide.lock</code> to <code>vendor</code>.</li>\n<li>Build.</li>\n</ol>\n\n<p>A migration from <code>godep</code> to <code>glide</code> may be done easily, because <code>glide</code> has a command to migrate <code>Godeps.json</code> to <code>glide.yaml</code>.</p>\n"}], "owner": {"reputation": 26092, "user_id": 824377, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e600bd229c588891a7616f303e30efd9?s=128&d=identicon&r=PG", "display_name": "AJcodez", "link": "https://stackoverflow.com/users/824377/ajcodez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469196732, "creation_date": 1468943836, "last_edit_date": 1468946786, "question_id": 38463367, "link": "https://stackoverflow.com/questions/38463367/how-to-run-go-command-using-only-vendor-dependencies", "title": "How to run go command using only vendor dependencies?", "body": "<p>I keep running into the issue where I install dependencies locally, it works fine, I push to continuous integration server, and then it breaks because I forgot to <code>godep save ./...</code> the dependency. </p>\n\n<p>How can I run the <code>go</code> command but require <code>vendor</code> imports?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I'm using <code>go1.6</code>. I want the command to fail if a 3rd-party dependency <em>does <strong>not</strong> resolve</em> to vendor. In other words, is there a way to stop resolving dependencies in <code>$GOPATH</code> during tests?</p>\n\n<p>I can't change the environment variable because then none of my project modules can be resolved. How can I force vendor dependencies?</p>\n"}, {"tags": ["go", "gzip", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 112874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a3acb4fb349118bd068a420ae5bcae?s=128&d=identicon&r=PG", "display_name": "Chris Passas", "link": "https://stackoverflow.com/users/112874/chris-passas"}, "is_accepted": false, "score": 3, "last_activity_date": 1468948986, "creation_date": 1468948986, "answer_id": 38464824, "question_id": 38461106, "link": "https://stackoverflow.com/questions/38461106/how-to-return-gzip-response-for-golang-gin-framework/38464824#38464824", "title": "How to return gzip response for golang gin framework", "body": "<p>Someone else had an issue with gzip. Their pull request resolved this problem for me. It's a bug in the gzip package for gin framework.</p>\n\n<p>This method was missing from contrib/gzip/gzip.go</p>\n\n<pre><code>func (g *gzipWriter) WriteString(s string) (n int, err error) {\n    return g.writer.Write([]byte(s))\n}\n</code></pre>\n\n<p>Link to original issue that includes pull request.\n<a href=\"https://github.com/gin-gonic/contrib/pull/59\" rel=\"nofollow\">https://github.com/gin-gonic/contrib/pull/59</a></p>\n\n<p>Once the owner of the project accepts the pull request this issue will be resolved.</p>\n"}], "owner": {"reputation": 81, "user_id": 112874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a3acb4fb349118bd068a420ae5bcae?s=128&d=identicon&r=PG", "display_name": "Chris Passas", "link": "https://stackoverflow.com/users/112874/chris-passas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2853, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1489451704, "creation_date": 1468937878, "last_edit_date": 1489451704, "question_id": 38461106, "link": "https://stackoverflow.com/questions/38461106/how-to-return-gzip-response-for-golang-gin-framework", "title": "How to return gzip response for golang gin framework", "body": "<p>I'm trying to return a gzip response using the golang framework gin.</p>\n\n<p>They provide an example here:\n<a href=\"https://github.com/gin-gonic/contrib/blob/master/gzip/example/example.go\" rel=\"nofollow\">https://github.com/gin-gonic/contrib/blob/master/gzip/example/example.go</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gin-gonic/contrib/gzip\"\n    \"github.com/gin-gonic/gin\"\n    \"time\"\n)\n\nfunc main() {\n    r := gin.Default()\n    r.Use(gzip.Gzip(gzip.DefaultCompression))\n    r.GET(\"/ping\", func(c *gin.Context) {\n        c.String(200, \"pong \"+fmt.Sprint(time.Now().Unix()))\n    })\n\n    // Listen and Server in 0.0.0.0:8080\n    r.Run(\":8080\")\n}\n</code></pre>\n\n<p>When I use this example its not returning gzipped content.</p>\n\n<p>With the code above I get the following output from curl</p>\n\n<pre><code>curl -v -H \"Accept-Encoding: gzip\" 'http://localhost:8080/ping'\n\nTrying ::1...\nConnected to localhost (::1) port 8080 (#0) GET /ping HTTP/1.1 Host: localhost:8080 User-Agent: curl/7.43.0 Accept: / Accept-Encoding: gzip\n&lt; HTTP/1.1 200 OK\n&lt; Content-Encoding: gzip\n&lt; Content-Type: text/plain; charset=utf-8\n&lt; Vary: Accept-Encoding\n&lt; Date: Mon, 18 Jul 2016 17:20:56 GMT\n&lt; Content-Length: 38\n&lt;\n\nConnection #0 to host localhost left intact pong 1468862456?n????\n</code></pre>\n\n<p>Notice the content is not gzipped and there are extra junk characters added on.</p>\n\n<p>\"?n????\"</p>\n\n<p>So far I can't figure out how to get it to return gzip. I think there is a mistake in the example code but I'm having trouble figuring it out.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["go", "nsnotificationcenter"], "answers": [{"comments": [{"owner": {"reputation": 965, "user_id": 6575454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/12c11be826f5e80bb145985858c5335b?s=128&d=identicon&r=PG&f=1", "display_name": "fiks", "link": "https://stackoverflow.com/users/6575454/fiks"}, "edited": false, "score": 0, "creation_date": 1469002209, "post_id": 38460952, "comment_id": 64354245, "body": "Thanks, I will give it a try!"}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1468937403, "creation_date": 1468937403, "answer_id": 38460952, "question_id": 38459842, "link": "https://stackoverflow.com/questions/38459842/notification-center-in-golang/38460952#38460952", "title": "Notification center in Golang", "body": "<p>I think you need something like <a href=\"https://github.com/asaskevich/EventBus\" rel=\"nofollow\">https://github.com/asaskevich/EventBus</a></p>\n"}], "owner": {"reputation": 965, "user_id": 6575454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/12c11be826f5e80bb145985858c5335b?s=128&d=identicon&r=PG&f=1", "display_name": "fiks", "link": "https://stackoverflow.com/users/6575454/fiks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 38460952, "answer_count": 1, "score": 1, "last_activity_date": 1468937403, "creation_date": 1468934411, "question_id": 38459842, "link": "https://stackoverflow.com/questions/38459842/notification-center-in-golang", "title": "Notification center in Golang", "body": "<p>I have an iOS development background and I am studying the Go language.\nI would like to know if there is something in Go similar to NSNotificationCenter in iOS?</p>\n\n<p>So say I want to update a couple of objects that I don't have direct access to. Is there an easy way to send notification to them?\nOr there is no such pattern and I need to do it in different way?</p>\n\n<p>P.S. More info about NSNotificationCenter: <a href=\"http://nshipster.com/nsnotification-and-nsnotificationcenter/\" rel=\"nofollow\">http://nshipster.com/nsnotification-and-nsnotificationcenter/</a></p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 4, "last_activity_date": 1537975345, "last_edit_date": 1537975345, "creation_date": 1468935043, "answer_id": 38460071, "question_id": 38457755, "link": "https://stackoverflow.com/questions/38457755/cast-interface-to-type-in-template/38460071#38460071", "title": "Cast interface{} to type in template", "body": "<p>I don't think it's possible to do type assertions from a template. You'll have to write your own function and call it from the template. For example:</p>\n\n<pre><code>func ToString(value interface{}) string {\n    switch v := value.(type) {\n    case string:\n        return v\n    case int:\n        return strconv.Itoa(v)\n    // Add whatever other types you need\n    default:\n        return \"\"\n    }\n}\n</code></pre>\n\n<p>To be able to call the function from template you have to call the Funcs() method on your template:</p>\n\n<pre><code>tpl.Funcs(template.FuncMap{\"tostring\": ToString})\n</code></pre>\n\n<p>Now you can do <code>{{$gval.name | tostring}}</code> inside your template</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 9727826, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dI1zfIvUJFo/AAAAAAAAAAI/AAAAAAAAAEM/AtAq1sE1T-s/photo.jpg?sz=128", "display_name": "Jerome Ortega", "link": "https://stackoverflow.com/users/9727826/jerome-ortega"}, "is_accepted": false, "score": 2, "last_activity_date": 1619019696, "creation_date": 1619019696, "answer_id": 67199077, "question_id": 38457755, "link": "https://stackoverflow.com/questions/38457755/cast-interface-to-type-in-template/67199077#67199077", "title": "Cast interface{} to type in template", "body": "<p>I believe accepted answer is no longer necessary. I was just able to use interface{} values without explicitly typecasting it in golang template. I am on go v1.16.</p>\n"}], "owner": {"reputation": 45, "user_id": 6169066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/73fd9b8daaf440e6f6a3da6dda6184a6?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Baranov", "link": "https://stackoverflow.com/users/6169066/oleg-baranov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5173, "favorite_count": 2, "accepted_answer_id": 38460071, "answer_count": 2, "score": 1, "last_activity_date": 1619019696, "creation_date": 1468929055, "question_id": 38457755, "link": "https://stackoverflow.com/questions/38457755/cast-interface-to-type-in-template", "title": "Cast interface{} to type in template", "body": "<pre><code>  Templates.ExecuteTemplate(w, \"index.html\", map[string]interface{} {\n        \"Games\": games})\n}\n</code></pre>\n\n<p>Where games is <code>[]map[string]interface{}</code> (mapped result of sql query)</p>\n\n<p>In template:</p>\n\n<pre><code>{{ range $gval := .Games }} \n    {{ how to make something like: $gval.name.(string) }} \n{{end}}\n</code></pre>\n\n<p>How to cast interface{} value of map to string(or int) in template? In 'go' i can do \n<code>games[0][\"name\"].(string)</code></p>\n\n<p>When i do  <code>$gval.name</code> it writes hex string</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1468925319, "post_id": 38456214, "comment_id": 64316753, "body": "Don&#39;t use relative paths for imports, and use <code>go install</code> or <code>go build</code>. <a href=\"http://stackoverflow.com/questions/28153203/golang-undefined-function-declared-in-another-file/28153553#28153553\" title=\"golang undefined function declared in another file\">stackoverflow.com/questions/28153203/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 5005042, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hWGqj-bApRk/AAAAAAAAAAI/AAAAAAAABR4/s12XC61aNE0/photo.jpg?sz=128", "display_name": "mechinn", "link": "https://stackoverflow.com/users/5005042/mechinn"}, "is_accepted": false, "score": 0, "last_activity_date": 1524346133, "creation_date": 1524346133, "answer_id": 49960393, "question_id": 38456214, "link": "https://stackoverflow.com/questions/38456214/go-run-but-notice-me-missing-a-file-i-have-run-go-get/49960393#49960393", "title": "&quot;go run&quot; but notice me missing .a file (I have run &quot;go get&quot;)", "body": "<p>As JimB said don't use relative paths for imports</p>\n\n<p>if you change <code>\"../http/server\"</code> to <code>myproj/http/server</code> it shouldn't have the linking problems anymore</p>\n"}], "owner": {"reputation": 39, "user_id": 6607932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/057ce40a060675876cd7d1152ef763fe?s=128&d=identicon&r=PG&f=1", "display_name": "user219031", "link": "https://stackoverflow.com/users/6607932/user219031"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 980, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1524346133, "creation_date": 1468924912, "question_id": 38456214, "link": "https://stackoverflow.com/questions/38456214/go-run-but-notice-me-missing-a-file-i-have-run-go-get", "title": "&quot;go run&quot; but notice me missing .a file (I have run &quot;go get&quot;)", "body": "<p>I want to run a go file, main package imported a local package which imported a github package. and get an error (missing .a file)</p>\n\n<p>ENV:\n$GOROOT=/usr/local/go\n$GOPATH=/gopath</p>\n\n<p>go version 1.6.3 (same problem in 1.6.2)</p>\n\n<p>I tried to run a go file like this:</p>\n\n<p>/gopath/src/myproj/main/app.go</p>\n\n<pre><code>package main\n\nimport (\n  \"../http/server\"\n)\n\nfunc main() {\n  server.Run()\n}\n</code></pre>\n\n<p>/gopath/src/myproj/http/server/route.go</p>\n\n<pre><code>package server\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n)\n\nfunc Run(){\n    router := mux.NewRouter()\n    router.HandleFunc(\"/\", handler)\n    http.Handle(\"/\", router)\n    http.ListenAndServe(\"9090\", nil)\n}\n\nfunc handler(res http.ResponseWriter, req *http.Request) {\n    res.Write([]byte(\"Hello\"))\n}\n</code></pre>\n\n<p>then,I run <code>go get github.com/gorilla/mux</code> and I can see there are files</p>\n\n<pre><code>/gopath/pkg/linux_amd64/github.com/gorilla/mux (there are context.a and mux.a)\n/gopath/src/github.com/gorilla/mux\n/gopath/src/github.com/gorilla/context\n</code></pre>\n\n<p>Yes, src file and pkg file(.a) has downloaded form github,</p>\n\n<p>BUT , I run \"go run main/app.go\" , get </p>\n\n<pre><code># command-line-arguments\n/usr/local/go/pkg/tool/linux_amd64/link: cannot open file /usr/local/go/pkg/linux_amd64/github.com/gorilla/mux.a: open /usr/local/go/pkg/linux_amd64/github.com/gorilla/mux.a: no such file or directory\n</code></pre>\n\n<p>compiler does not find file in GOPATH, but GOROOT\nif I copy $GOPATH/pkg files to $GOROOT/pkg was good.</p>\n\n<p>And, if I import github.com/gorilla/mux in main package directly was fine too. </p>\n"}, {"tags": ["unit-testing", "google-app-engine", "go", "mux"], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 1075283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0c08aacf97ba9d099e8575212681d1a?s=128&d=identicon&r=PG", "display_name": "cheeze", "link": "https://stackoverflow.com/users/1075283/cheeze"}, "edited": false, "score": 1, "creation_date": 1476803910, "post_id": 40050864, "comment_id": 67495545, "body": "Thanks for the reply! I think this works. At first I thought you suggested that I have to change the handler but upon closer reading, it is just helping to prove that the value is correctly read. I did a quick check and it seems to work. I&#39;ll mark this as the answer and update if there&#39;re any hiccups."}, {"owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "reply_to_user": {"reputation": 367, "user_id": 1075283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0c08aacf97ba9d099e8575212681d1a?s=128&d=identicon&r=PG", "display_name": "cheeze", "link": "https://stackoverflow.com/users/1075283/cheeze"}, "edited": false, "score": 0, "creation_date": 1476878653, "post_id": 40050864, "comment_id": 67531604, "body": "Awesome.. yeah, handlers are the same, the only difference is in test, and very minimal compared to what you have. Instead of calling the handler directly, you just create your mux router (<code>makeRouter</code>) and call <code>ServeHTTP</code> on it with your test request (<code>req</code>) and recorder (<code>rec</code>). Good luck!"}], "tags": [], "owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "is_accepted": true, "score": 0, "last_activity_date": 1476474114, "creation_date": 1476474114, "answer_id": 40050864, "question_id": 38456093, "link": "https://stackoverflow.com/questions/38456093/unit-testing-app-engine-with-gorilla-mux/40050864#40050864", "title": "Unit Testing App Engine with Gorilla MUX", "body": "<p>Since what you're testing is the handler, you could just get an instance of the router and call ServeHTTP on it. Here is how it should be based on your code.</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>func init() {\n    r := makeRouter()\n    http.Handle(\"/\", r)\n}\n\nfunc makeRouter() *mux.Router {\n    r := mux.NewRouter()\n    app := r.Headers(\"X-Requested-With\", \"XMLHttpRequest\").Subrouter()\n    app.HandleFunc(\"/user/{email}/{id}\", restHandler).Methods(http.MethodGet)\n\n    return r\n}\n\nfunc restHandler(w http.ResponseWriter, r *http.Request) {\n    params := mux.Vars(r)\n    email := params[\"email\"]\n    fmt.Fprintf(w, email)\n}\n</code></pre>\n\n<p><strong>main_test.go</strong></p>\n\n<pre><code>func TestRouter(t *testing.T) {\n    inst, _ := aetest.NewInstance(nil) //ignoring error for brevity\n    defer inst.Close()\n\n    req, _ := inst.NewRequest(\"GET\", \"/user/john@example.com/id-123\", nil)\n    req.Header.Add(\"X-Requested-With\", \"XMLHttpRequest\")\n    rec := httptest.NewRecorder()\n\n    r := makeRouter()\n    r.ServeHTTP(rec, req)\n\n    if email := rec.Body.String(); email != \"john@example.com\" {\n        t.Errorf(\"router failed, expected: %s, got: %s\", \"john@example.com\", email)\n    }\n}\n</code></pre>\n\n<p>Notice I removed the <code>rest</code> routes since that's not part of your test, but the idea would be the same. Also didn't check for errors for simplicity.</p>\n"}], "owner": {"reputation": 367, "user_id": 1075283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0c08aacf97ba9d099e8575212681d1a?s=128&d=identicon&r=PG", "display_name": "cheeze", "link": "https://stackoverflow.com/users/1075283/cheeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "accepted_answer_id": 40050864, "answer_count": 1, "score": 0, "last_activity_date": 1476474114, "creation_date": 1468924578, "question_id": 38456093, "link": "https://stackoverflow.com/questions/38456093/unit-testing-app-engine-with-gorilla-mux", "title": "Unit Testing App Engine with Gorilla MUX", "body": "<p>I want to write tests for handlers in Google App Engine that use Gorilla mux to read variables from the request URL.</p>\n\n<p>I understand from the <a href=\"https://cloud.google.com/appengine/docs/go/tools/localunittesting/#Go_Introducing_the_aetest_package\" rel=\"nofollow\">documentation</a> that you can create a fake context and request to use with testing.</p>\n\n<p>I'm calling the handler directly in the test but the handler isn't seeing the path parameter as expected.</p>\n\n<pre><code>func TestRouter(t *testing.T) {\n  inst, _ := aetest.NewInstance(nil) //ignoring error for brevity\n  defer inst.Close()\n  //tried adding this line because the test would not work with or without it\n  httptest.NewServer(makeRouter())\n  req, _ := inst.NewRequest(\"GET\", \"/user/john@example.com/id-123\", nil)\n  req.Header.Add(\"X-Requested-With\", \"XMLHttpRequest\")\n  resp := httptest.NewRecorder()\n  restHandler(resp, req)\n}\n\nfunc restHandler(w http.ResponseWriter, r *http.Request) {\n  ctx := appengine.NewContext(r)\n  params := mux.Vars(r)\n  email := params[\"email\"]\n  //`email` is always empty\n}\n</code></pre>\n\n<p>The problem is that the handler always sees an empty \"email\" parameter because the path is not interpreted by Gorilla mux.</p>\n\n<p>The router is as below:</p>\n\n<pre><code>func makeRouter() *mux.Router {\n  r := mux.Router()\n  rest := mux.NewRouter().Headers(\"Authorization\", \"\").\n    PathPrefix(\"/api\").Subrouter()\n\n  app := r.Headers(\"X-Requested-With\", \"XMLHttpRequest\").Subrouter()\n  app.HandleFunc(\"/user/{email}/{id}\", restHandler).Methods(http.MethodGet)\n\n  //using negroni for path prefix /api\n  r.PathPrefx(\"/api\").Handler(negroni.New(\n    negroni.HandlerFunc(authCheck), //for access control\n    negroni.Wrap(rest),\n  ))\n  return r\n}\n</code></pre>\n\n<p>All my searches have not gotten anything specific to App Engine unit testing with Gorilla mux.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1469093132, "post_id": 38499732, "comment_id": 64399995, "body": "Yes you are correct seeing this only when app is under heavy load. But the doubt I am having is even though I have specified <code>maxOpenConnections</code> to 50. But under load I am seeing open connections way above 50 that too in <code>ESTABLISHED</code> state as I have posted in my question. However in mysql process list it is showing 50. Why is this happening?"}, {"owner": {"reputation": 393, "user_id": 3430118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/351a10f392414345ed67a05e986dc4dd?s=128&d=identicon&r=PG", "display_name": "methane", "link": "https://stackoverflow.com/users/3430118/methane"}, "reply_to_user": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 1, "creation_date": 1469143279, "post_id": 38499732, "comment_id": 64428439, "body": "Your app sends COM_CLOSE packet to MySQL. MySQL closes connection. But your app doesn&#39;t read EOF yet.  TCP connection is alive in ESTABLISHED state until application reads EOF. Since your app is under heavy loads, your app can&#39;t read EOF quickly."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1469171440, "post_id": 38499732, "comment_id": 64436021, "body": "Can you please update your answer with the comments? One last query how will it help if I set <code>maxIdleConnections</code> equal to <code>maxOpenConnection</code>?"}, {"owner": {"reputation": 393, "user_id": 3430118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/351a10f392414345ed67a05e986dc4dd?s=128&d=identicon&r=PG", "display_name": "methane", "link": "https://stackoverflow.com/users/3430118/methane"}, "reply_to_user": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1469350116, "post_id": 38499732, "comment_id": 64491593, "body": "&gt; Can you please update your answer with the comments?  I did it.  &gt; One last query how will it help if I set maxIdleConnections equal to maxOpenConnection?  It already explained my answer: &quot; to avoid high reconnect rate&quot;. I don&#39;t want to explain why small maxIdleConns cause high reconnection rate.  Everyone should notice it if think carefully."}], "tags": [], "owner": {"reputation": 393, "user_id": 3430118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/351a10f392414345ed67a05e986dc4dd?s=128&d=identicon&r=PG", "display_name": "methane", "link": "https://stackoverflow.com/users/3430118/methane"}, "is_accepted": true, "score": 1, "last_activity_date": 1469350090, "last_edit_date": 1469350090, "creation_date": 1469091984, "answer_id": 38499732, "question_id": 38454970, "link": "https://stackoverflow.com/questions/38454970/connection-pooling-with-xorm-and-go-mysql/38499732#38499732", "title": "Connection pooling with xorm and go-mysql", "body": "<p>First of all, Go 1.4 is too old.  Use latest Go 1.6.\nThis answer is written with knowledge of Go 1.6.  So some details may be different in your case.</p>\n\n<p>There are four state in connection: connecting, idle, inuse, and closing.\nMaxOpenConnections limits number of connection in connecting, idle, inuse state.\nSo, if your application closes and reopen connection quickly, it can happen.</p>\n\n<p>Since TCP is <code>CLOSED_WAIT</code> state in MySQL server side, your app is waiting EOF from connection.  I suppose your app is under very high load\nand slow at reading EOF and closing connection.  Until read EOF and close connection, TCP state is ESTABLISHED on client side, regardless TCP state in server side.</p>\n\n<p>I recommend you to update Go and \"go-sql-driver/mysql\", and set MaxIdleConns equal to MaxOpenConns to avoid high reconnect rate.\nInstead, you can use <a href=\"https://golang.org/pkg/database/sql/#DB.SetConnMaxLifetime\" rel=\"nofollow\">SetConnMaxLifetime</a> (new API in Go 1.6) to close\nconnections when your app is idle.</p>\n"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 0, "accepted_answer_id": 38499732, "answer_count": 1, "score": 0, "last_activity_date": 1469350090, "creation_date": 1468921602, "question_id": 38454970, "link": "https://stackoverflow.com/questions/38454970/connection-pooling-with-xorm-and-go-mysql", "title": "Connection pooling with xorm and go-mysql", "body": "<p>Just cross-posting this from <a href=\"https://github.com/go-xorm/xorm/issues/422\" rel=\"nofollow\">github</a>.</p>\n\n<p>I am using xorm 0.4.3 with <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow\">go-mysql</a>. We are on Golang 1.4.</p>\n\n<p>We have specified <code>maxIdleConnetions</code> and <code>maxOpenConnections</code> in <code>xorm</code> as below:-</p>\n\n<pre><code>var orm *xorm.Engine\n...\norm.SetMaxOpenConns(50)\norm.SetMaxIdleConns(5)\n</code></pre>\n\n<p>And we are using the same single <code>xorm</code> instance to query Mysql.</p>\n\n<p>But still we are seeing lot of connections in <code>TCP Connection Establised</code> state which is way over the numbers I have configured in <code>maxIdleConnetions</code> and <code>maxOpenConnections</code>  state when we <code>lsof</code>:-</p>\n\n<pre><code>app 8747 10568 sandeshsharma 16u IPv4 691032 0t0 TCP 127.0.0.1:57337-&gt;127.0.0.1:mysql (ESTABLISHED)\n</code></pre>\n\n<p>We have also observed that even if we stop the MySQL, the connection numbers still remain fixed but in the <code>CLOSED_WAIT</code> state. If we shutdown the app then all connections go away.</p>\n\n<pre><code>app 8747 10844 sandeshsharma 38u IPv4 505058 0t0 TCP 127.0.0.1:54160-&gt;127.0.0.1:mysql (CLOSE_WAIT)\n</code></pre>\n\n<p>However in mysql process list it is showing the correct number of connections as I have specified in  <code>maxIdleConnetions</code> and <code>maxOpenConnections</code>.</p>\n\n<p>Can some one please explain me this behaviour? Why are we observing so much TCP connections even though we have specified <code>maxIdleConnetions</code> and <code>maxOpenConnections</code> to 5 &amp; 50 respectively?</p>\n"}, {"tags": ["go", "tar", "gzip"], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1468922289, "creation_date": 1468922289, "answer_id": 38455237, "question_id": 38454850, "link": "https://stackoverflow.com/questions/38454850/getting-write-too-long-error-when-trying-to-create-tar-gz-file-from-file-and-d/38455237#38455237", "title": "Getting `write too long` error when trying to create tar.gz file from file and directories", "body": "<blockquote>\n  <p>Write writes to the current entry in the tar archive. Write returns the error ErrWriteTooLong if more than hdr.Size bytes are written after WriteHeader.</p>\n</blockquote>\n\n<p>There is a <code>Size</code> option you can add to the Header. Haven't tried it but maybe that helps...</p>\n\n<p>See also <a href=\"https://golang.org/pkg/archive/tar/\" rel=\"nofollow\">https://golang.org/pkg/archive/tar/</a></p>\n"}, {"comments": [{"owner": {"reputation": 1658, "user_id": 516037, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b4987583409b6d79fca0bd1145c54609?s=128&d=identicon&r=PG&f=1", "display_name": "dpington", "link": "https://stackoverflow.com/users/516037/dpington"}, "edited": false, "score": 0, "creation_date": 1491746546, "post_id": 40003617, "comment_id": 73679771, "body": "It is also possible that the file has changed on disk and has became longer."}, {"owner": {"reputation": 790, "user_id": 623415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e88085394bf8eeaddeb13104d65ccf6?s=128&d=identicon&r=PG", "display_name": "BoeroBoy", "link": "https://stackoverflow.com/users/623415/boeroboy"}, "edited": false, "score": 0, "creation_date": 1545068171, "post_id": 40003617, "comment_id": 94489206, "body": "Heads up on this one - some filesystems don&#39;t accurate list file size in attrs, such as /proc.  I&#39;ve seen this happen when a rogue archive tries to include /proc/PID/attr/current which is SELinux context.  The file attr will always report size zero, but a read finds data.  In GoLang it invariably generates a &quot;write too long&quot; failure, whereas GNU tar/libz will have no problem.  Be careful what filesystem you&#39;re using to archive and whether it accurately reports lengths."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7009112"}, "is_accepted": true, "score": 7, "last_activity_date": 1476289381, "creation_date": 1476289381, "answer_id": 40003617, "question_id": 38454850, "link": "https://stackoverflow.com/questions/38454850/getting-write-too-long-error-when-trying-to-create-tar-gz-file-from-file-and-d/40003617#40003617", "title": "Getting `write too long` error when trying to create tar.gz file from file and directories", "body": "<p>I was having a similar issue until I looked more closely at the tar.FileInfoHeader doc:</p>\n\n<blockquote>\n  <p>FileInfoHeader creates a partially-populated Header from fi. If fi describes a symlink, FileInfoHeader records link as the link target. If fi describes a directory, a slash is appended to the name. Because os.FileInfo's Name method returns only the base name of the file it describes, it may be necessary to modify the Name field of the returned header to provide the full path name of the file.</p>\n</blockquote>\n\n<p>Essentially, FileInfoHeader isn't guaranteed to fill out all the header fields before you write it with WriteHeader, and if you look at the implementation the Size field is only set on <a href=\"https://golang.org/src/archive/tar/common.go?s=5495:5560#L207\" rel=\"noreferrer\">regular</a> files. Your code snippet seems to only handle directories, this means if you come across any other non regular file, you write the header with a size of zero then attempt to copy a potentially non-zero sized special file on disk into the tar. Go returns ErrWriteTooLong to stop you from creating a broken tar.</p>\n\n<p>I came up with this and haven't had the issue since.</p>\n\n<pre><code>    if err := filepath.Walk(directory, func(path string, info os.FileInfo, err error) error {\n        if err != nil {\n            return check(err)\n        }\n\n        var link string\n        if info.Mode()&amp;os.ModeSymlink == os.ModeSymlink {\n            if link, err = os.Readlink(path); err != nil {\n                return check(err)\n            }\n        }\n\n        header, err := tar.FileInfoHeader(info, link)\n        if err != nil {\n            return check(err)\n        }\n\n        header.Name = filepath.Join(baseDir, strings.TrimPrefix(path, directory))\n        if err = tw.WriteHeader(header); err != nil {\n            return check(err)\n        }\n\n        if !info.Mode().IsRegular() { //nothing more to do for non-regular\n            return nil\n        }\n\n        fh, err := os.Open(path)\n        if err != nil {\n            return check(err)\n        }\n        defer fh.Close()\n\n        if _, err = io.CopyBuffer(tw, fh, buf); err != nil {\n            return check(err)\n        }\n        return nil\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 5518004, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lATC2QuVgk8/AAAAAAAAAAI/AAAAAAAAEo8/4-Ny-KIMeuI/photo.jpg?sz=128", "display_name": "Rohit Durvasula", "link": "https://stackoverflow.com/users/5518004/rohit-durvasula"}, "is_accepted": false, "score": 0, "last_activity_date": 1607019599, "creation_date": 1607019599, "answer_id": 65131827, "question_id": 38454850, "link": "https://stackoverflow.com/questions/38454850/getting-write-too-long-error-when-trying-to-create-tar-gz-file-from-file-and-d/65131827#65131827", "title": "Getting `write too long` error when trying to create tar.gz file from file and directories", "body": "<p>Since you are seeing this issue with a large directory only, I think the following fix might not help, but this will address the issue of creating a tar from files that might be continuously growing.</p>\n<p>In my case the issue was that when we were creating the tar header, the header.Size (inside tar.FileInfoHeader) was getting setting to the file size (info.Size()) at that instant of time.</p>\n<p>When we later in the code, try to open the concerned file (os.Open) and copy its contents (io.Copy) we risk copying more data than what we earlier set the tar header size to because the file could have grown in the meantime.</p>\n<p>This piece of code will ensure we ONLY copy that much data as we set the tar header size to:</p>\n<pre><code>_, err = io.**CopyN**(tw, file, info.Size())\nif err != nil {\n    log.Println(&quot;failing here&quot;)\n    return err\n}\n</code></pre>\n"}], "owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5397, "favorite_count": 1, "accepted_answer_id": 40003617, "answer_count": 3, "score": 7, "last_activity_date": 1607019599, "creation_date": 1468921302, "question_id": 38454850, "link": "https://stackoverflow.com/questions/38454850/getting-write-too-long-error-when-trying-to-create-tar-gz-file-from-file-and-d", "title": "Getting `write too long` error when trying to create tar.gz file from file and directories", "body": "<p>So I'm trying to crate a tar.gz file file from multiple directories and files. Something with the same usage as:</p>\n\n<pre><code>tar -cvzf sometarfile.tar.gz somedir/ someotherdir/ somefile.json somefile.xml\n</code></pre>\n\n<p>Assuming the directories have other directories inside of them.\nI have this as an input:</p>\n\n<pre><code>    paths := []string{\n      \"somedir/\",\n      \"someotherdir/\",\n      \"somefile.json\",\n      \"somefile.xml\",\n    }\n</code></pre>\n\n<p>and using these:</p>\n\n<pre><code>    func TarFilesDirs(paths []string, tarFilePath string ) error {\n       // set up the output file\n       file, err := os.Create(tarFilePath)\n       if err != nil {\n           return err\n       }\n\n       defer file.Close()\n       // set up the gzip writer\n       gz := gzip.NewWriter(file)\n       defer gz.Close()\n\n       tw := tar.NewWriter(gz)\n       defer tw.Close()\n\n       // add each file/dir as needed into the current tar archive\n       for _,i := range paths {\n          if err := tarit(i, tw); err != nil {\n               return err\n          }\n       }\n\n       return nil\n   }\n\nfunc tarit(source string, tw *tar.Writer) error {\n    info, err := os.Stat(source)\n    if err != nil {\n        return nil\n    }\n\n    var baseDir string\n    if info.IsDir() {\n        baseDir = filepath.Base(source)\n    }\n\n    return filepath.Walk(source,\n        func(path string, info os.FileInfo, err error) error {\n            if err != nil {\n                return err\n            }\n\n            header, err := tar.FileInfoHeader(info, info.Name())\n            if err != nil {\n                return err\n            }\n\n            if baseDir != \"\" {\n                header.Name = filepath.Join(baseDir, strings.TrimPrefix(path, source))\n            }\n\n            if err := tw.WriteHeader(header); err != nil {\n                return err\n            }\n\n            if info.IsDir() {\n                return nil\n            }\n\n            file, err := os.Open(path)\n            if err != nil {\n                return err\n            }\n\n            defer file.Close()\n\n            _, err = io.Copy(tw, file)\n            if err != nil {\n                log.Println(\"failing here\")\n                return err\n            }\n\n            return err\n        })\n}\n</code></pre>\n\n<p><strong>Problem:</strong> if a directory is large I'm getting:</p>\n\n<pre><code>archive/tar: write too long\n</code></pre>\n\n<p>error, when I remove it everything works.</p>\n\n<p>Ran out of ideas and wasted many hours on this trying to find a solution...</p>\n\n<p>Any ideas? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468920995, "post_id": 38454475, "comment_id": 64313636, "body": "You could do things different depending on your surrounding. Is this the only code in a function or in a loop?"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468921416, "post_id": 38454475, "comment_id": 64313964, "body": "What do you need the two <code>len</code>s for?"}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 1, "last_activity_date": 1468921582, "creation_date": 1468921582, "answer_id": 38454959, "question_id": 38454475, "link": "https://stackoverflow.com/questions/38454475/go-converting-if-statements-into-short-statement/38454959#38454959", "title": "go - converting if statements into short statement", "body": "<p>Some options I can think of. Not sure if you like it better or if it works in your code:</p>\n\n<p>1) in a function (in a loop use <code>break</code>):</p>\n\n<pre><code>anotherName : =\"ABC\"\nif len(dict) = 0 {\n    return\n}\nif _, ok := dictA[\"Name\"]; !ok {\n    return\n}\nif fName, ok := dataDict[\"Name\"]; !ok {\n    return\n}\nif fName== \"SAM\" &amp;&amp; len(dict) &gt; 1 {\n   mainDict[anotherName] = dict\n}\n</code></pre>\n\n<p>2) not using check for <code>ok</code> but check for <code>nil</code>:</p>\n\n<pre><code>anotherName : =\"ABC\"\n\nif len(dict) &gt; 0 &amp;&amp; dictA[\"Name\"] != nil &amp;&amp; dataDict[\"Name\"] != nil &amp;&amp; dataDict[\"Name\"] == \"SAM\" &amp;&amp; len(dict) &gt; 1 {\n  mainDict[anotherName] = dict\n}\n</code></pre>\n\n<p>Maybe you can also eliminate one of the checks for <code>len(dict) &gt; 0</code> and <code>len(dict) &gt; 1</code>.</p>\n"}], "owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 38454959, "answer_count": 1, "score": 0, "last_activity_date": 1468921582, "creation_date": 1468920342, "last_edit_date": 1468920785, "question_id": 38454475, "link": "https://stackoverflow.com/questions/38454475/go-converting-if-statements-into-short-statement", "title": "go - converting if statements into short statement", "body": "<p>I have many if statements</p>\n\n<pre><code>anotherName : =\"ABC\"\n\nif len(dict) &gt; 0 {\n    if _, ok := dictA[\"Name\"]; ok {\n        if fName, ok := dataDict[\"Name\"]; ok {\n            if fName== \"SAM\" {\n                if len(dict) &gt; 1 {\n                    mainDict[anotherName] = dict\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I dont want to use so many if statements. I want to use operators but I am not able to use them here in this scenario.</p>\n\n<p>Can anyone let me know.</p>\n"}, {"tags": ["go", "error-handling", "aerospike"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1468917374, "post_id": 38453242, "comment_id": 64311071, "body": "Related / possible duplicates: <a href=\"http://stackoverflow.com/questions/30177860/does-go-have-standard-err-variables\">Does go have standard Err variables?</a>; and <a href=\"http://stackoverflow.com/a/32080378/1705598\">many links posted in this answer</a>."}, {"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468920729, "post_id": 38453242, "comment_id": 64313439, "body": "@icza so basically I have to rely on the type of struct the API provider is providing for error handling. If they don&#39;t provide any intelligible errors errors(as in this case) what are my options?"}], "answers": [{"comments": [{"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 0, "creation_date": 1468920819, "post_id": 38453344, "comment_id": 64313511, "body": "For me all the errors are of AerespikeError type. In general if API exposes different struct for different types of error this would help."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "reply_to_user": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 1, "creation_date": 1468921061, "post_id": 38453344, "comment_id": 64313687, "body": "Then you have to see does the package export some error variables you can compare the <code>err</code> against."}, {"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 0, "creation_date": 1468921522, "post_id": 38453344, "comment_id": 64314057, "body": "Just found that they have exported error codes. Thanks for the help"}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 2, "last_activity_date": 1468921310, "last_edit_date": 1468921310, "creation_date": 1468917286, "answer_id": 38453344, "question_id": 38453242, "link": "https://stackoverflow.com/questions/38453242/handling-aerospike-library-errors-in-go-lang/38453344#38453344", "title": "Handling Aerospike library errors in Go Lang", "body": "<p>If the function returns errors which are actually of different type, then you should use <a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow\">type switch</a>:</p>\n\n<pre><code>switch err.(type) {\ncase Error1:\n    fmt.Println(\"Error1\", err)\ncase Error2:\n    fmt.Println(\"Error2\", err)\ndefault:\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>But if the errors are of same type then you have to see does the package export some \"common errors\" as variables, so that you can check against those:</p>\n\n<pre><code>if err == aer.Error1 {\n   // do something specific to Error1\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 0, "creation_date": 1469360412, "post_id": 38497881, "comment_id": 64493839, "body": "Thanks, this is certainly concise. I am a total noob in Go."}], "tags": [], "owner": {"reputation": 141, "user_id": 4960414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed9229cac8ae44671f7468aa72429a5?s=128&d=identicon&r=PG&f=1", "display_name": "Khosrow Afroozeh", "link": "https://stackoverflow.com/users/4960414/khosrow-afroozeh"}, "is_accepted": false, "score": 2, "last_activity_date": 1469086623, "creation_date": 1469086623, "answer_id": 38497881, "question_id": 38453242, "link": "https://stackoverflow.com/questions/38453242/handling-aerospike-library-errors-in-go-lang/38497881#38497881", "title": "Handling Aerospike library errors in Go Lang", "body": "<p>Aerospike Go client dev here. In my experience, the concise conditional typecast shown below is more readable, albeit being the same as your own:</p>\n\n<pre><code>if ae, ok := err.(AerospikeError); ok {\n    println(ae.ResultCode())\n}\n</code></pre>\n"}], "owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 38453344, "answer_count": 2, "score": 2, "last_activity_date": 1469086623, "creation_date": 1468917022, "last_edit_date": 1468988684, "question_id": 38453242, "link": "https://stackoverflow.com/questions/38453242/handling-aerospike-library-errors-in-go-lang", "title": "Handling Aerospike library errors in Go Lang", "body": "<p>I am quite new to Go Lang development. Recently I am using Aerospike Go client to getObject</p>\n\n<pre><code>err = aer.AeroDB.getObject(nil, key, Record)\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>now the above error exposes only one method <code>Error()</code> which returns a string. I need to handle each type of errors differently. How do I do this, as there are no error codes returned. Do I do string matching to get the relevant type?</p>\n\n<p><strong>SOLUTION:</strong> Answer and comments below helped me to find an exact answer. I will share it here with the rest. Aerospike libraries export <code>AerospikeError</code> struct. Now, error could be nil or <code>AerospikeError</code> <code>struct</code>. Following code did the work.</p>\n\n<pre><code>import (\n  \"errors\"\n  \"fmt\"\n  aerospike \"github.com/aerospike/aerospike-client-go\"\n  \"github.com/aerospike/aerospike-client-go/types\"\n )\n\ntype ArDB struct {\n  Host   string\n  Port   int\n  AeroDB *aerospike.Client\n}\n\nArErr, failed := aer.AeroDB.GetObject(nil, key, Record).(types.AerospikeError)\nif failed {\n    if ArErr.ResultCode() == types.KEY_NOT_FOUND_ERROR {\n        //Key is not present, create new data\n        Record = NewAudienceRecord()\n    } else {\n        //Handle other errors!\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468916589, "post_id": 38451945, "comment_id": 64310581, "body": "Does it say on which line it is trying to write to closed channel? Can you add that information?"}], "answers": [{"comments": [{"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468916159, "post_id": 38452782, "comment_id": 64310326, "body": "Where informative thank you. However I cannot change data_channel in order to limit. For second solution can you explaining more? Because If i move write function to default section it will not write on given time. Or am I mistaken?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468916487, "post_id": 38452782, "comment_id": 64310525, "body": "@abhink: I don&#39;t understand. The error talks about sending on a closed channel. Its not hanging, is it?"}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468916548, "post_id": 38452782, "comment_id": 64310556, "body": "@TehSphinX it is hanging. And when I hit second time &quot;Ctrl-C&quot; it panics."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468916649, "post_id": 38452782, "comment_id": 64310612, "body": "Do you have to use timers to synchronize reading/writing? It is difficult to reason about behavior of the code with them. What is your actual use case?"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 1, "creation_date": 1468916712, "post_id": 38452782, "comment_id": 64310652, "body": "@TehSphinX the code hangs. You can see a second <code>^C</code> just before the error used to stop the program. It&#39;s because the signal channel has been closed."}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468916901, "post_id": 38452782, "comment_id": 64310759, "body": "@abhink I should pull read from network every 5 secs. May be I should close ticker somewhere else?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468917393, "post_id": 38452782, "comment_id": 64311082, "body": "@abhink: still this is not a clean solution in my opinion. For details why, see me answer."}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468917569, "post_id": 38452782, "comment_id": 64311206, "body": "@TehSphinX do you have some other suggestion?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468917617, "post_id": 38452782, "comment_id": 64311229, "body": "@Phoenix: yes, see my answer."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468917986, "post_id": 38452782, "comment_id": 64311479, "body": "Changing timer values don&#39;t affect synchronization issues generally. You might have to structure your code better."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468918080, "post_id": 38452782, "comment_id": 64311531, "body": "BTW, creating a buffered channel wouldn&#39;t make much difference because your writes are still being limited. It&#39;s just that the last value read will be thrown away."}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468918336, "post_id": 38452782, "comment_id": 64311697, "body": "@abhink can give me some suggestion how I can re organize the code? Async programming drawing me mad."}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468918732, "post_id": 38452782, "comment_id": 64311958, "body": "@abhink I guess what I should is re organize code as following order. Start reader and after that writer. Uppon receiving interrupt signal i should first stop writer and then stop reader."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 1, "creation_date": 1468919087, "post_id": 38452782, "comment_id": 64312194, "body": "Correct, since reader is the consumer it depends upon the writer. Make sure that the writer never blocks and is gracefully closed off. Then you should be able to manage the reader properly."}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468919534, "post_id": 38452782, "comment_id": 64312533, "body": "@abhink Ok i will try to fix it. I am giving vote up for your answer. But sorry I cannot accept your answer. Since it is incomplete and does not contain working code. So if you will have time please update your answer accordingly. Thank you."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468921301, "post_id": 38452782, "comment_id": 64313870, "body": "Added a working example. Although I&#39;m still not sure if that&#39;s the best way to go about it. Would do some more thinking."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1468921254, "last_edit_date": 1468921254, "creation_date": 1468915698, "answer_id": 38452782, "question_id": 38451945, "link": "https://stackoverflow.com/questions/38451945/gracefully-terminating-timer-based-writer-and-go-routine-for-reader-process/38452782#38452782", "title": "Gracefully terminating timer based writer and go routine for reader process", "body": "<p>What's happening in your code is that as soon as signal is sent, everything works until the end of the <code>reader</code> function. That is, signal is sent to <code>writer_stop</code> (statement <code>writer_stop &lt;- struct{}{}</code> gets executed.</p>\n\n<p>The problem is with your <code>select</code> in main. You are reading for a close value on <code>writer_stop</code> in a <code>case</code>.</p>\n\n<pre><code>    select {\n    case &lt;-ticker.C:\n        writer(&amp;item_id, data_channel)\n    case &lt;-writer_stop:\n        log.Println(\"About to stop timer\")\n        ticker.Stop()\n        log.Println(\"Timer stopped\")\n        flag = false\n    }\n</code></pre>\n\n<p>Due to nature of <code>select</code>, if more than one <code>cases</code> are ready to be selected, <code>select</code> selects one at random.</p>\n\n<p>Now in your <code>select</code> above, after the call to <code>writer_stop &lt;- struct{}{}</code> has occurred, somehow due to erroneous synchronization, <code>case &lt;-ticker.C:</code> is selected and <code>writer</code> gets called.</p>\n\n<p>Since <code>reader</code> has returned at this point, and it was the only method reading from <code>data_channel</code>, <code>writer</code> blocks at <code>data_channel &lt;- *item_id</code>, causing your program to hang.</p>\n\n<p>The error <code>panic: send on closed channel</code> occurs because you hit <code>^C</code> again and the signal channel has been closed.</p>\n\n<p>You can fix this in several way. One simple solution is to add buffer to data_channel:</p>\n\n<pre><code>data_channel := make(chan uint32, 1)\n</code></pre>\n\n<p>Here's one way to do this:</p>\n\n<pre><code>func user_interupt_register() (writer_stop, reader_stop chan struct{}) {\n    writer_stop = make(chan struct{}, 1)\n    // same as before\n\n    go func() {\n        sig := &lt;-signal_channel\n        writer_stop &lt;- struct{}{} // change to writer_stop\n        // same as before\n    }()\n\n    return writer_stop, reader_stop\n}\n\nfunc reader(data_channel chan uint32) {\n    for item := range data_channel {\n        log.Println(\"[READER] Item ID: \", item)\n    }\n}\n\nfunc main() {\n    log.Println(\"Starting Application\")\n\n    data_channel := make(chan uint32)\n    // defer close(data_channel)\n\n    writer_stop, _ := user_interupt_register()\n\n    log.Println(\"Start Timer\")\n    ticker := time.NewTicker(2 * time.Second)\n    readTicker := time.NewTicker(1 * time.Second)\n\n    go reader(data_channel)\n\n    go func() { // to print intermittent message\n        for _ = range readTicker.C {\n            data_channel &lt;- 0 // some insignificant value\n        }\n    }()\n\n    var item_id uint32 = 1\n\n    for _ = range ticker.C {\n        select {\n        case &lt;-writer_stop:\n            data_channel &lt;- item_id\n            close(data_channel)\n            ticker.Stop()\n            readTicker.Stop()\n            return\n        default:\n            data_channel &lt;- item_id\n            item_id++\n        }\n    }\n\n    close(writer_stop)\n}\n</code></pre>\n\n<p>Do note that this'll require a through testing.</p>\n"}, {"comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1468917882, "post_id": 38453351, "comment_id": 64311386, "body": "The OP uses the <code>flag</code> to terminate the loop, so he actually needs it :)"}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468917954, "post_id": 38453351, "comment_id": 64311450, "body": "If I replace it with your suggestion I will not be able to write every 2 seconds."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1468918028, "post_id": 38453351, "comment_id": 64311498, "body": "@ain: oh yeah, didn&#39;t realize that. Could be done with <code>break</code>. @Phoenix: see my Note2 I just added to the answer."}, {"owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468918211, "post_id": 38453351, "comment_id": 64311611, "body": "But I cannot understand your Note2 at all. What do you mean reader reading every 2 second. I need writer to write every 2 second to reader. Break can be used with mark. But I prefer using with flag. It does not matter anyway."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1468918342, "post_id": 38453351, "comment_id": 64311699, "body": "@TehSphinX <code>data_channel</code> is written to, not read from. @Phoenix: What @TehSphinx probably mean is that you can adapt the range loop within the reader instead the write. So writer still writes every 3 seconds, but reader can now loop on <code>data_channel</code>. I still think issue lies with the way interrupt is being handled though."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1468918735, "post_id": 38453351, "comment_id": 64311961, "body": "@abhink: you are right, I mixed them up. Adjusted my answer."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "edited": false, "score": 0, "creation_date": 1469538040, "post_id": 38453351, "comment_id": 64569428, "body": "@Phoenix: did this help? or is there anything I need to correct about my answer?"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 2, "last_activity_date": 1468920460, "last_edit_date": 1468920460, "creation_date": 1468917301, "answer_id": 38453351, "question_id": 38451945, "link": "https://stackoverflow.com/questions/38451945/gracefully-terminating-timer-based-writer-and-go-routine-for-reader-process/38453351#38453351", "title": "Gracefully terminating timer based writer and go routine for reader process", "body": "<p>IMO you should change your reader/writer structure. You do not need to stop the reader only the writer.</p>\n\n<p>The problem with the current structure is that there might be items that will be written and never read. That is probably why you don't want to make data_channel a buffered channel. But still one item might not get read that was already written to the channel.</p>\n\n<p>You only need a stop channel for the writer. The writer stops if that channel signals and closes the data channel. The reader has no select, just a <code>for item := range data_channel</code>. If the data_channel is closed, reader will empty the existing item(s) in it and stop by itself.</p>\n\n<p>Replace this:</p>\n\n<pre><code>func reader(reader_stop, writer_stop chan struct{}, data_channel chan uint32) {\n    var flag = true\n    for flag {\n        select {\n        case &lt;-reader_stop:\n            writer_stop &lt;- struct{}{}\n            flag = false\n        case data, ok := &lt;-data_channel:\n            if ok {\n                log.Println(\"[READER] Item ID: \", data)\n            }\n        default:\n            time.Sleep(1 * time.Second)\n            log.Println(\"[READER] No ID to print\")\n            continue\n        }\n    }\n\n    log.Println(\"About to close(reader_stop)\")\n    close(reader_stop)\n    log.Println(\"close(reader_stop) finished\")\n}\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>func reader(writer_stop chan struct{}, data_channel chan uint32) {\n    for item := range data_channel {\n      log.Println(\"[READER] Item ID: \", data)\n    }\n}\n</code></pre>\n\n<p>Remove:</p>\n\n<pre><code>defer close(data_channel)\n</code></pre>\n\n<p>and add it here:</p>\n\n<pre><code>case &lt;-writer_stop:\n   close(data_channel)\n   log.Println(\"About to stop timer\")\n   ticker.Stop()\n   log.Println(\"Timer stopped\")\n   flag = false\n</code></pre>\n\n<p>Then you will need something that waits for the reader to finish. Check out <code>sync.WaitGroup</code>. Better way would be to put the writer in the go routine and put the reader in the main routine. That way your main routine will stop if the reader is done (which in turn stops if it doesn't receive any more values from the writer - by the writer closing the channel).</p>\n\n<p>Here my working suggestion with as little changes as possible:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"os/signal\"\n    \"syscall\"\n    \"time\"\n)\n\nfunc user_interupt_register() (writer_stop chan struct{}) {\n    writer_stop = make(chan struct{}, 1)\n\n    signal_channel := make(chan os.Signal)\n    signal.Notify(signal_channel, syscall.SIGINT, syscall.SIGTERM)\n\n    go func() {\n        for sig := range signal_channel {\n            log.Println(\"Signal received: \", sig)\n            writer_stop &lt;- struct{}{}\n            log.Println(\"Signal sent\")\n            break\n        }\n\n        close(signal_channel)\n        log.Println(\"Closing User Interupt Register go routing\")\n    }()\n\n    return\n}\n\nfunc writer(item_id *uint32, data_channel chan uint32, writer_stop chan struct{}) {\n    log.Println(\"Start Timer\")\n    ticker := time.NewTicker(2 * time.Second)\n\n    var flag = true\n    for flag {\n        select {\n        case &lt;-ticker.C:\n            log.Println(\"[WRITER] Item ID: \", *item_id)\n            data_channel &lt;- *item_id\n            *item_id++\n        case &lt;-writer_stop:\n            close(data_channel)\n            log.Println(\"About to stop timer\")\n            ticker.Stop()\n            log.Println(\"Timer stopped\")\n            flag = false\n        }\n    }\n}\n\nfunc main() {\n    log.Println(\"Starting Application\")\n\n    data_channel := make(chan uint32)\n\n    writer_stop := user_interupt_register()\n\n    var item_id uint32\n    item_id = 1\n\n    go writer(&amp;item_id, data_channel, writer_stop)\n\n    for data := range data_channel {\n        log.Println(\"[READER] Item ID: \", data)\n    }\n\n    log.Println(\"About to close(writer_stop)\")\n    close(writer_stop)\n    log.Println(\"close(writer_stop) finished\")\n    log.Println(\"Exiting Application\")\n}\n</code></pre>\n\n<p>You will not have the <code>log.Println(\"[READER] No ID to print\")</code> message but otherwise it should produce the same result.</p>\n\n<p>Note: the other code needs to be adjusted accordingly... like removing the writer_stop channel.</p>\n"}], "owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1468921254, "creation_date": 1468912931, "last_edit_date": 1468916121, "question_id": 38451945, "link": "https://stackoverflow.com/questions/38451945/gracefully-terminating-timer-based-writer-and-go-routine-for-reader-process", "title": "Gracefully terminating timer based writer and go routine for reader process", "body": "<p>I have following code which contains:</p>\n\n<ul>\n<li>ticker based writer</li>\n<li>go routine for reading</li>\n<li>data channel for writer and reader communication</li>\n<li>stop_writer and stop_reader channels for stopping writer and reader gracefully</li>\n<li>signal handler in order to handle \"Ctrl-C\" user input</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"os/signal\"\n    \"syscall\"\n    \"time\"\n)\n\nfunc user_interupt_register() (writer_stop, reader_stop chan struct{}) {\n    writer_stop = make(chan struct{}, 1)\n    reader_stop = make(chan struct{}, 1)\n\n    signal_channel := make(chan os.Signal)\n    signal.Notify(signal_channel, syscall.SIGINT, syscall.SIGTERM)\n\n    go func() {\n        for sig := range signal_channel {\n            log.Println(\"Signal received: \", sig)\n            reader_stop &lt;- struct{}{}\n            log.Println(\"Signal sent\")\n            break\n        }\n\n        close(signal_channel)\n        log.Println(\"Closing User Interupt Register go routing\")\n    }()\n\n    return writer_stop, reader_stop\n}\n\nfunc writer(item_id *uint32, data_channel chan uint32) {\n    log.Println(\"[WRITER] Item ID: \", *item_id)\n    data_channel &lt;- *item_id\n    *item_id++\n}\n\nfunc reader(reader_stop, writer_stop chan struct{}, data_channel chan uint32) {\n    var flag = true\n    for flag {\n        select {\n        case &lt;-reader_stop:\n            writer_stop &lt;- struct{}{}\n            flag = false\n        case data, ok := &lt;-data_channel:\n            if ok {\n                log.Println(\"[READER] Item ID: \", data)\n            }\n        default:\n            time.Sleep(1 * time.Second)\n            log.Println(\"[READER] No ID to print\")\n            continue\n        }\n    }\n\n    log.Println(\"About to close(reader_stop)\")\n    close(reader_stop)\n    log.Println(\"close(reader_stop) finished\")\n}\n\nfunc main() {\n    log.Println(\"Starting Application\")\n\n    data_channel := make(chan uint32)\n    defer close(data_channel)\n\n    writer_stop, reader_stop := user_interupt_register()\n\n    log.Println(\"Start Timer\")\n    ticker := time.NewTicker(2 * time.Second)\n\n    go reader(reader_stop, writer_stop, data_channel)\n\n    var item_id uint32\n    item_id = 1\n\n    var flag = true\n    for flag {\n        select {\n        case &lt;-ticker.C:\n            writer(&amp;item_id, data_channel)\n        case &lt;-writer_stop:\n            log.Println(\"About to stop timer\")\n            ticker.Stop()\n            log.Println(\"Timer stopped\")\n            flag = false\n        }\n    }\n\n    log.Println(\"About to close(writer_stop)\")\n    close(writer_stop)\n    log.Println(\"close(writer_stop) finished\")\n    log.Println(\"Exiting Application\")\n}\n</code></pre>\n\n<p>When I am stopping it occasionally I am getting following outputs:</p>\n\n<pre><code>2016/07/19 16:02:46 Starting Application\n2016/07/19 16:02:46 Start Timer\n2016/07/19 16:02:47 [READER] No ID to print\n2016/07/19 16:02:48 [WRITER] Item ID:  1\n2016/07/19 16:02:48 [READER] No ID to print\n2016/07/19 16:02:48 [READER] Item ID:  1\n2016/07/19 16:02:49 [READER] No ID to print\n2016/07/19 16:02:50 [WRITER] Item ID:  2\n2016/07/19 16:02:50 [READER] No ID to print\n2016/07/19 16:02:50 [READER] Item ID:  2\n2016/07/19 16:02:51 [READER] No ID to print\n^C2016/07/19 16:02:52 Signal received:  interrupt\n2016/07/19 16:02:52 Signal sent\n2016/07/19 16:02:52 Closing User Interupt Register go routing\n2016/07/19 16:02:52 [WRITER] Item ID:  3\n2016/07/19 16:02:52 [READER] No ID to print\n2016/07/19 16:02:52 About to close(reader_stop)\n2016/07/19 16:02:52 close(reader_stop) finished\n^Cpanic: send on closed channel\n\ngoroutine 5 [running]:\npanic(0x4c1d00, 0xc8200980b0)\n    /usr/local/go/src/runtime/panic.go:481 +0x3e6\nos/signal.process(0x7ffa8f64d078, 0xc8200980a0)\n    /usr/local/go/src/os/signal/signal.go:176 +0x17a\nos/signal.loop()\n    /usr/local/go/src/os/signal/signal_unix.go:22 +0x75\ncreated by os/signal.init.1\n    /usr/local/go/src/os/signal/signal_unix.go:28 +0x37\n</code></pre>\n\n<p>However most of times it stops normally with following output.</p>\n\n<pre><code>2016/07/19 16:03:13 Starting Application\n2016/07/19 16:03:13 Start Timer\n2016/07/19 16:03:14 [READER] No ID to print\n2016/07/19 16:03:15 [WRITER] Item ID:  1\n2016/07/19 16:03:15 [READER] No ID to print\n2016/07/19 16:03:15 [READER] Item ID:  1\n2016/07/19 16:03:16 [READER] No ID to print\n^C2016/07/19 16:03:16 Signal received:  interrupt\n2016/07/19 16:03:16 Signal sent\n2016/07/19 16:03:16 Closing User Interupt Register go routing\n2016/07/19 16:03:17 [WRITER] Item ID:  2\n2016/07/19 16:03:17 [READER] No ID to print\n2016/07/19 16:03:17 [READER] Item ID:  2\n2016/07/19 16:03:17 About to close(reader_stop)\n2016/07/19 16:03:17 close(reader_stop) finished\n2016/07/19 16:03:17 About to stop timer\n2016/07/19 16:03:17 Timer stopped\n2016/07/19 16:03:17 About to close(writer_stop)\n2016/07/19 16:03:17 close(writer_stop) finished\n2016/07/19 16:03:17 Exiting Application\n</code></pre>\n\n<p>So what is wrong? How can I be sure that it will stop normally stop all go routine and close channels?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1468909831, "post_id": 38451002, "comment_id": 64306773, "body": "You want to obtain the last chunk of non-whitespace characters if the string starts with <code>111</code>?"}, {"owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1468909873, "post_id": 38451002, "comment_id": 64306799, "body": "yes true. in this case i wanted &quot;sam&quot;. i.e. last element after white space"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1468909896, "post_id": 38451002, "comment_id": 64306815, "body": "If <code>111</code> should not be checked, then <code>\\S+$</code> should suffice."}, {"owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1468909927, "post_id": 38451002, "comment_id": 64306835, "body": "but the string starting with 111"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1468910151, "post_id": 38451002, "comment_id": 64306961, "body": "Isn&#39;t a non-regex way easier? <code>func Index(s, sep string) int</code> + <code>func Split(s, sep string) []string</code> can yield the expected result."}, {"owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1468910313, "post_id": 38451002, "comment_id": 64307047, "body": "But I want to use the regex. I already used that but I am not getting the last element. Please see how I did in the question"}], "answers": [{"comments": [{"owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "edited": false, "score": 0, "creation_date": 1468910062, "post_id": 38451089, "comment_id": 64306915, "body": "it must start with 111"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "reply_to_user": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "edited": false, "score": 0, "creation_date": 1468910146, "post_id": 38451089, "comment_id": 64306955, "body": "can you show a concrete example with the desired result you want to obtain?"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1468910103, "last_edit_date": 1468910103, "creation_date": 1468910011, "answer_id": 38451089, "question_id": 38451002, "link": "https://stackoverflow.com/questions/38451002/regex-to-get-the-last-item-after-space/38451089#38451089", "title": "regex to get the last item after space", "body": "<p>This should work for you:</p>\n\n<pre><code>\\s(\\w+)$ // The output will be `sam`\n</code></pre>\n\n<p>This means capture the last string (<code>$</code>) after a whitespace.</p>\n"}, {"comments": [{"owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "edited": false, "score": 0, "creation_date": 1468910354, "post_id": 38451158, "comment_id": 64307076, "body": "yes but it should work for the line starts with 111."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "edited": false, "score": 1, "creation_date": 1468910483, "post_id": 38451158, "comment_id": 64307136, "body": "No problem, it is the same, just add it to the pattern. The point is the <code>\\s</code>. It is what makes this pattern work."}, {"owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "edited": false, "score": 0, "creation_date": 1468910606, "post_id": 38451158, "comment_id": 64307192, "body": "thanks very much. I have updated the string little. can you explain me hw it will work for that string?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "edited": false, "score": 0, "creation_date": 1468910686, "post_id": 38451158, "comment_id": 64307248, "body": "Your string is multiline. Either you split the string into an array of <i>trimmed</i> lines and use the regex above, or use <code>(?m)^\\s*111.*\\s(\\S+)$</code>"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "edited": false, "score": 1, "creation_date": 1468910906, "post_id": 38451158, "comment_id": 64307355, "body": "I think <code>(?m)^[^\\S\\r\\n]*111[^\\r\\n]*[^\\S\\r\\n](\\S+)$</code> is safer to use with a multiline string."}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1468911562, "last_edit_date": 1468911562, "creation_date": 1468910315, "answer_id": 38451158, "question_id": 38451002, "link": "https://stackoverflow.com/questions/38451002/regex-to-get-the-last-item-after-space/38451158#38451158", "title": "regex to get the last item after space", "body": "<p>Note that <code>111\\s(.*)$</code> matches <code>111</code> anywhere inside the string (the first occurrence) and then captures into Submatch 1 <strong>any</strong> 0+ characters up to the end of the string.</p>\n\n<p>If there is a space before the last <code>sam</code>, you may use</p>\n\n<pre><code>^111.*\\s(\\S+)$\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QkIyh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QkIyh.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Pattern explanation</strong>:</p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>111</code> - a literal substring <code>111</code></li>\n<li><code>.*</code> - any characters, 0 or more, as many as possible up to the <em>last</em>...</li>\n<li><code>\\s</code> - whitespace</li>\n<li><code>(\\S+)</code> - Submatch 1 capturing one or more non-whitespace characters</li>\n<li><code>$</code> - end of string.</li>\n</ul>\n\n<p>If you want to get the <strong><em>line</em></strong> that starts with <code>111</code> (and any leading whitespace is allowed) and has some whitespace after which your submatch is located, you may consider either</p>\n\n<pre><code>(?m)^\\s*111[^\\r\\n]*\\s(\\S+)$\n</code></pre>\n\n<p>(a <code>.</code> is replaced with <code>[^\\r\\n]</code> because in Go regex, a dot <code>.</code> matches any character <em>incl.</em> a newline), or - to make sure you only match <em>horizontal</em> whitespace:</p>\n\n<pre><code>(?m)^[^\\S\\r\\n]*111[^\\r\\n]*[^\\S\\r\\n](\\S+)$\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>(?m)^[^\\S\\r\\n]*111[^\\r\\n]*[^\\S\\r\\n](\\S+)$\n</code></pre>\n\n<p><strong>Explanation</strong>:</p>\n\n<ul>\n<li><code>(?m)^</code> - start of the line (due to the <code>(?m)</code> MULTILINE modifier, the <code>^</code> now matches a <em>line</em> start and <code>$</code> will match the <em>line</em> end)</li>\n<li><code>[^\\S\\r\\n]*</code> - zero or more whitespaces except LF and CR (=<em>horizontal whitespace</em>)</li>\n<li><code>111</code> - a literal <code>111</code></li>\n<li><code>[^\\r\\n]*</code> - any 0+ characters other than CR and LF as many as possible up to the last....</li>\n<li><code>[^\\S\\r\\n]</code> - horizontal space</li>\n<li><code>(\\S+)</code>  - Submatch 1 capturing 1+ non-whitespace chars</li>\n<li><code>$</code> - end of line (prepend with <code>[^\\S\\r\\n]*</code> or <code>[^\\S\\n]*</code> to allow trailing horizontal whitespace)</li>\n</ul>\n\n<p>Here is a <a href=\"https://play.golang.org/p/u4dLggL4RT\" rel=\"nofollow noreferrer\">Go demo</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    s := `Read SMART Log Directory failed.\n    111 a bcd sam\n       111 sam\n     SMART Error Log not supported`\n    rex := regexp.MustCompile(`(?m)^[^\\S\\r\\n]*111[^\\r\\n]*[^\\S\\r\\n](\\S+)$`)\n    fmt.Printf(\"%#v\\n\", rex.FindAllStringSubmatch(s,-1))\n}\n</code></pre>\n\n<p>Output: <code>[][]string{[]string{\"    111 a bcd sam\", \"sam\"}, []string{\"       111 sam\", \"sam\"}}</code></p>\n"}, {"tags": [], "owner": {"reputation": 1116, "user_id": 6408723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ac9YR.png?s=128&g=1", "display_name": "Maria Ivanova", "link": "https://stackoverflow.com/users/6408723/maria-ivanova"}, "is_accepted": false, "score": 1, "last_activity_date": 1468910647, "creation_date": 1468910647, "answer_id": 38451257, "question_id": 38451002, "link": "https://stackoverflow.com/questions/38451002/regex-to-get-the-last-item-after-space/38451257#38451257", "title": "regex to get the last item after space", "body": "<p>You can use this:</p>\n\n<pre><code>^\\s*1{3}.*\\s(\\S+)$\n</code></pre>\n\n<p><code>^</code> start of line</p>\n\n<p><code>\\s*</code> 0 or more occurrences of space in the beginning</p>\n\n<p><code>1{3}</code> followed by three ones (i.e. 111)</p>\n\n<p><code>.*</code> followed by anything </p>\n\n<p><code>\\s</code> followed by space</p>\n\n<p><code>(\\S+)$</code> ending with non-space characters. First capture group. </p>\n"}], "owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "accepted_answer_id": 38451158, "answer_count": 3, "score": 1, "last_activity_date": 1468911562, "creation_date": 1468909723, "last_edit_date": 1468910675, "question_id": 38451002, "link": "https://stackoverflow.com/questions/38451002/regex-to-get-the-last-item-after-space", "title": "regex to get the last item after space", "body": "<p>How to get the last item by regex?</p>\n\n<pre><code>\"Read the information failed.\n111 a bcd\n\nSAM Error Log not up supported\"\n</code></pre>\n\n<p>I did this </p>\n\n<pre><code>111\\s(.*)$\n</code></pre>\n\n<p>but it gives me</p>\n\n<pre><code>output = \"a bcd sam\"\n</code></pre>\n\n<p>But, I want output of regex which starts with 111 as</p>\n\n<pre><code>output = \"sam\" // for the line starts with 111\n</code></pre>\n\n<p>Also, how can i make change if there is any space before 111?</p>\n\n<p>you can test this at <a href=\"https://regex-golang.appspot.com/assets/html/index.html\" rel=\"nofollow\">https://regex-golang.appspot.com/assets/html/index.html</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 2, "last_activity_date": 1468909365, "last_edit_date": 1468909365, "creation_date": 1468907731, "answer_id": 38450555, "question_id": 38450432, "link": "https://stackoverflow.com/questions/38450432/go-creating-the-substring-start-to-end/38450555#38450555", "title": "go - creating the substring start to end", "body": "<p>You can try something like this:</p>\n\n<pre><code>start := strings.Index(s, \"super\")\nend := strings.Index(s[start:], \"love\")\nfmt.Println(s[start:end] + \"love\") // s[start:end+len(\"love\")] performs better\n</code></pre>\n\n<p>See <a href=\"https://golang.org/pkg/strings/#Index\" rel=\"nofollow\">here</a> for details and more similar methods.</p>\n"}], "owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 38450555, "answer_count": 1, "score": 0, "last_activity_date": 1468909365, "creation_date": 1468907258, "question_id": 38450432, "link": "https://stackoverflow.com/questions/38450432/go-creating-the-substring-start-to-end", "title": "go - creating the substring start to end", "body": "<p>I have a string.</p>\n\n<pre><code>s = \"This is a super dog. This dog is very nice. He play with other dogs. He love to eat.\"\n</code></pre>\n\n<p>substring() function in golang takes string and the substring string.  But, what if I want to specify the start and end string for my substring?</p>\n\n<p>For example, in this string s, I want the substring to be started from \"super\" and it should end on \"love\". so my substring should be, </p>\n\n<pre><code>substring = \"super dog. This dog is very nice. He play with other dogs. He love\"\n</code></pre>\n\n<p>I didnt see the golang provide any of such functionality. Please let me know if there is way we can do this.</p>\n"}, {"tags": ["ubuntu", "go"], "comments": [{"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1468907736, "post_id": 38449906, "comment_id": 64305892, "body": "<code>go build</code> if I right understand your problem."}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1468911877, "creation_date": 1468911877, "answer_id": 38451602, "question_id": 38449906, "link": "https://stackoverflow.com/questions/38449906/how-can-i-run-multiple-go-programs-exist-in-different-directory-at-a-time/38451602#38451602", "title": "how can I run multiple go programs exist in different directory at a time?", "body": "<p>If I understand your question correctly: you could write a little shell script executing them one after the other:</p>\n\n<pre><code>#!/usr/bin/env bash\n\ngo run /ParentPath/DBconnection/execfile.go\ngo run /ParentPath/APIRequest/execfile.go\ngo run /ParentPath/APIResponse/execfile.go\n</code></pre>\n\n<p>You could also create a go program executing the different packages in go routines, then you do not need to start multiple go programs.</p>\n"}], "owner": {"reputation": 1157, "user_id": 5154802, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZqLky3QxN2E/AAAAAAAAAAI/AAAAAAAAAEE/MyYiHfmqVe0/photo.jpg?sz=128", "display_name": "shivendra pratap singh", "link": "https://stackoverflow.com/users/5154802/shivendra-pratap-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1468911877, "creation_date": 1468904534, "last_edit_date": 1468907385, "question_id": 38449906, "link": "https://stackoverflow.com/questions/38449906/how-can-i-run-multiple-go-programs-exist-in-different-directory-at-a-time", "title": "how can I run multiple go programs exist in different directory at a time?", "body": "<p>I have different directories such as <code>DBconnection</code> , <code>APIRequest</code> , <code>APIResponse</code> etc. </p>\n\n<p>All codes are interconnected. How can I run these at a time. \nThe <strong>go run</strong> <em>.go</em> needed to be exist all files in a directory. </p>\n\n<p>But I have multiple directories.</p>\n\n<p>Any kind of help or suggestion will be appreciated</p>\n"}, {"tags": ["arrays", "go", "struct"], "comments": [{"owner": {"reputation": 832, "user_id": 6604750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d6cf5dd410b365b6c422526940d7018?s=128&d=identicon&r=PG&f=1", "display_name": "VortixDev", "link": "https://stackoverflow.com/users/6604750/vortixdev"}, "edited": false, "score": 0, "creation_date": 1468904518, "post_id": 38449863, "comment_id": 64304736, "body": "See if adding ... after msg helps (<a href=\"http://stackoverflow.com/questions/8461462/how-can-i-use-go-append-with-two-byte-slices-or-arrays\" title=\"how can i use go append with two byte slices or arrays\">stackoverflow.com/questions/8461462/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 5, "last_activity_date": 1468904550, "creation_date": 1468904550, "answer_id": 38449909, "question_id": 38449863, "link": "https://stackoverflow.com/questions/38449863/how-to-add-a-struct-to-an-array-of-structs-in-go/38449909#38449909", "title": "How to add a struct to an array of structs in Go", "body": "<p>In your code, <code>Messages</code> is a slice of <code>Message</code> type, and you are trying to append a pointer of <code>Message</code> type (<code>*Message</code>) to it.</p>\n\n<p>You can fix your program by doing the following:</p>\n\n<pre><code>func addMessage(m string) {\n    var msg = new(Message) // return a pointer to msg (type *msg)\n    msg.Name = \"Carol\"\n    msg.Content = m\n    Messages = append(Messages, *msg) // use the value pointed by mgs\n}\n</code></pre>\n\n<p>Alternatively, you can declare <code>Messages</code> as a slice of <code>*Message</code>:</p>\n\n<pre><code>var Messages = []*Message{\n    &amp;Message{ // Now each entry must be an address to a Message struct\n        Name: \"Alice\",\n        Content: \"Hello Universe\",\n    },\n    &amp;Message{\n        Name: \"Bob\",\n        Content: \"Hello World\",\n    },\n}\n</code></pre>\n\n<p>In above case, <code>addMessage</code> wouldn't require any changes. But you'll have to modify <code>Messages</code> access everywhere else.</p>\n"}, {"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 6, "last_activity_date": 1468908415, "creation_date": 1468908415, "answer_id": 38450698, "question_id": 38449863, "link": "https://stackoverflow.com/questions/38449863/how-to-add-a-struct-to-an-array-of-structs-in-go/38450698#38450698", "title": "How to add a struct to an array of structs in Go", "body": "<p>Change these 3 lines</p>\n\n<pre><code>var msg = new(Message)\nmsg.Name = \"Carol\"\nmsg.Content = m\n</code></pre>\n\n<p>to</p>\n\n<pre><code>msg := Message{\n    Name:    \"Carol\",\n    Content: m,\n}\n</code></pre>\n\n<p>and everything should work.  <code>new</code> creates a pointer to <code>Message</code>.  Your slice is not a slice of Message pointers, but a slice of Messages.</p>\n"}], "owner": {"reputation": 14727, "user_id": 1766230, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fb3eebee376e8d506503148d021a409a?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/1766230/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13343, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1468908415, "creation_date": 1468904261, "question_id": 38449863, "link": "https://stackoverflow.com/questions/38449863/how-to-add-a-struct-to-an-array-of-structs-in-go", "title": "How to add a struct to an array of structs in Go", "body": "<p>In golang I'm trying to make an array of messages, and the ability to easily add a new \"object\" to the array.</p>\n\n<pre><code>type Message struct {\n    Name string\n    Content string\n}\n\nvar Messages = []Message{\n    {\n        Name: \"Alice\",\n        Content: \"Hello Universe\",\n    },{\n        Name: \"Bob\",\n        Content: \"Hello World\",\n    },\n}\n\nfunc addMessage(m string) {\n    var msg = new(Message)\n    msg.Name = \"Carol\"\n    msg.Content = m\n    Messages = append(Messages, msg)\n}\n</code></pre>\n\n<p>When building I get an error that says: </p>\n\n<blockquote>\n  <p>cannot use msg (type *Message) as type Message in append</p>\n</blockquote>\n\n<p>Why is <code>append()</code> not working (as I might expect from JavaScript's <code>array.concat()</code>), or is <code>new()</code> not working?</p>\n\n<p>Any other tips on how to improve this code are welcome since I'm obviously new to Go.</p>\n"}, {"tags": ["mongodb", "go", "aggregation-framework"], "comments": [{"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1468904022, "post_id": 38449780, "comment_id": 64304592, "body": "Have you even tried to read <a href=\"https://docs.mongodb.com/manual/aggregation/\" rel=\"nofollow noreferrer\">MongoDB aggregation framework documentation</a> before asking the question? And by the way, NoSQL doesn&#39;t mean we don&#39;t need information about documents structure."}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "reply_to_user": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1468909747, "post_id": 38449780, "comment_id": 64306738, "body": "Yes, I did read the documentation but am still experiencing issues hence the reason I posted the question.  This is supposed to be a place we are to receive help when we run into an issue."}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1468910666, "post_id": 38449780, "comment_id": 64307233, "body": "I see no issue here. The issue is when you are trying to do something and result of your tries doesn&#39;t work. The issue is when you don&#39;t understand how something works and this thing is not documented. In your case, all I see is the request to do some job for you for free without ANY efforts from your side to solve it by yourself. Except writing this post, of course. Show us queries/code you have tried and we will see what is wrong with it."}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "reply_to_user": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1468911366, "post_id": 38449780, "comment_id": 64307615, "body": "Roman, everything I have seen via documentation and examples / posts are very basic queries resulting in only one sum or value returned for a date value. I&#39;m just asking for additional guidance or push in the right direction to build the correct solution myself. I&#39;m not even sure where to start other  than summing for one field.  If thats what you are asking for, then I can post it as well but it is going to lead to the same question of where should I go from here or how do I expand the operation pipe to include another sum on another field. Does that make sense?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468912044, "post_id": 38449780, "comment_id": 64307987, "body": "Hi CRob! Welcome to your first question! In order to help you we just need more information. Can you add the go code to your question with which you are experiencing problems? Currently we only have the sql statement which is only half of what we need. That will help us pinpoint the problem. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469126076, "post_id": 38452874, "comment_id": 64421126, "body": "This has been very helpful, and I would like to up vote your answers but cannot due to my reputation being too low.  Otherwise, it would definitely be done."}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469304786, "post_id": 38452874, "comment_id": 64483812, "body": "Roman, I&#39;m looking online for assistance in expanding the $cond to include an $and.  I don&#39;t see too many examples out there, can you point me in the right direction of where to look?  I read through the documentation you pointed out above. I also found another stackoverflow thread, but it isn&#39;t formatted for bson.  Should I start a new thread to show what I have tried, or expand on this one?"}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469305327, "post_id": 38452874, "comment_id": 64483942, "body": "@CRob I think would be easier to keep it here. And don&#39;t forget to link SQL version of the query as it makes easier to understand what final result you are expecting."}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469313504, "post_id": 38452874, "comment_id": 64485882, "body": "I&#39;ll post schema as well since I neglected that part before."}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469321565, "post_id": 38452874, "comment_id": 64487214, "body": "I think I have provided everything you asked for but if I missed something please let me know."}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469343672, "post_id": 38452874, "comment_id": 64490278, "body": "@CRob added new query."}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469595572, "post_id": 38452874, "comment_id": 64595244, "body": "Thank you so much! You have been so helpful on this learning curve. I have another question for you on how you unwrap the map...see above noted section.."}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469602008, "post_id": 38452874, "comment_id": 64598101, "body": "@CRob simple <code>resultRec[&quot;_id&quot;][&quot;date&quot;]</code>"}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469654342, "post_id": 38452874, "comment_id": 64632316, "body": "I tried that and receive back the following error: invalid operation: resultRec[&quot;_id&quot;][&quot;date&quot;] (type interface {} does not support indexing)"}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469655344, "post_id": 38452874, "comment_id": 64632789, "body": "@CRob <code>resultRec[&quot;_id&quot;].(bson.M)[&quot;date&quot;]</code>"}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1469655515, "post_id": 38452874, "comment_id": 64632870, "body": "once again you have rocked!   +1"}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 0, "last_activity_date": 1469343600, "last_edit_date": 1469343600, "creation_date": 1468915972, "answer_id": 38452874, "question_id": 38449780, "link": "https://stackoverflow.com/questions/38449780/transact-sql-equivalent-in-golang-mongodb-aggregate/38452874#38452874", "title": "Transact-SQL Equivalent in golang mongodb aggregate", "body": "<p>Ok. That's better but there is still no information about your DB schema to understand which data types you are using. Here is the Mongo's equivalent of SQL query in case if all fields are in string format:</p>\n\n<pre><code>package main\n\nimport (\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"fmt\"\n)\n\nfunc main() {\n    session, err := mgo.Dial(\"mongodb://127.0.0.1:27017/db\")\n\n    if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n\n    db := session.DB(\"db\")\n    c := db.C(\"MyTable\")\n\n    tf1c := bson.M{\"$cond\": []interface{}{bson.M{\"$eq\": []interface{}{\"$field1\", \"true\"}}, 1, 0}}\n    ff1c := bson.M{\"$cond\": []interface{}{bson.M{\"$eq\": []interface{}{\"$field1\", \"false\"}}, 1, 0}}\n    tf2c := bson.M{\"$cond\": []interface{}{bson.M{\"$eq\": []interface{}{\"$field2\", \"true\"}}, 1, 0}}\n    ff2c := bson.M{\"$cond\": []interface{}{bson.M{\"$eq\": []interface{}{\"$field2\", \"false\"}}, 1, 0}}\n\n    pipe := c.Pipe(\n        []bson.M{\n            bson.M{\n                \"$group\": bson.M{\n                    \"_id\": \"$date\",\n                    \"trueField1\": bson.M{\"$sum\": tf1c},\n                    \"falseField1\": bson.M{\"$sum\": ff1c},\n                    \"trueField2\": bson.M{\"$sum\": tf2c},\n                    \"falseField2\": bson.M{\"$sum\": ff2c},\n                },\n            },\n            bson.M{\n                \"$sort\": bson.M{\"_id\": -1},\n            },\n        },\n    )\n    result := []bson.M{}\n    err = pipe.All(&amp;result)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\", result)\n}\n</code></pre>\n\n<p><strong>Update</strong>:</p>\n\n<pre><code>pipe := c.Pipe(\n        []bson.M{\n            bson.M{\n                \"$project\": bson.M{\n                    \"year\": bson.M{\"$year\": \"$createdDate\"},\n                    \"month\": bson.M{\"$month\": \"$createdDate\"},\n                    \"day\": bson.M{\"$dayOfMonth\": \"$createdDate\"},\n                    \"val\": bson.M{\"$cond\":[]interface{}{\n                        bson.M{\n                            \"$and\": []interface{}{\n                                bson.M{\"$eq\": []interface{}{\"$isComplete\", true}},\n                                bson.M{\"$eq\": []interface{}{\"$status.finalized\", true}},\n                            },\n                        },\n                        1,\n                        0,\n                    }},\n                },\n            },\n            bson.M{\n                \"$group\": bson.M{\n                    \"_id\": bson.M{\n                        \"$concat\": []interface{}{\n                            bson.M{\"$substr\": []interface{}{\"$year\", 0, -1}},\n                            \"-\",\n                            bson.M{\"$substr\": []interface{}{\"$month\", 0, -1}},\n                            \"-\",\n                            bson.M{\"$substr\": []interface{}{\"$day\", 0, -1}},\n                        },\n                    },\n                    \"cnt\": bson.M{\"$sum\": \"$val\"},\n                },\n            },\n            bson.M{\n                \"$sort\": bson.M{\"_id\": -1},\n            },\n        },\n    )\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 38452874, "answer_count": 1, "score": 2, "last_activity_date": 1498218402, "creation_date": 1468903757, "last_edit_date": 1498218402, "question_id": 38449780, "link": "https://stackoverflow.com/questions/38449780/transact-sql-equivalent-in-golang-mongodb-aggregate", "title": "Transact-SQL Equivalent in golang mongodb aggregate", "body": "<p>I have a SQL statement that I am trying to recreate in golang using a mongodb database.  The statement that I am trying to recreate is the following:</p>\n\n<pre><code>select date,\n       sum(case when field1 = \"true\" then 1 else 0) trueField1,\n       sum(case when field1 = \"false\" then 1 else 0) falseField1,\n       sum(case when field2 = \"true\" then 1 else 0) trueField2,\n       sum(case when field2 = \"false\" then 1 else 0) falseField2\nfrom myTable\ngroup by date\n</code></pre>\n\n<p>I need to total out a few combinations on a given date and dump them out, but I am unsure how to accomplish it via golang / mongodb.</p>\n\n<p><strong>Edited:</strong>  here is the starting point that i have per the last request. as can be seen from o1 it shows what I'm going after on the first sum / count. i would also like to sum another field isDelivered and sum them on the same date returning the count for the same day. can i get some direction on how i would accomplish this task?</p>\n\n<pre><code>    o1 := bson.M{\n        \"$match\" : bson.M {\n            \"retailer\" : clientId,\n            \"isComplete\" : true,\n            \"pkgStatus.finalized\" : true,\n            },\n    }\n\n    o2 := bson.M {\n        \"$project\" : bson.M {\n            \"_id\" : 1,\n            \"createdAt\" : 1,\n        },\n    }\n\n    o3 := bson.M{\n        \"$group\": bson.M{\n            \"_id\" : bson.M{ \"$dayOfYear\": \"$createdAt\" },\n            \"total\" : bson.M{ \"$sum\" : 1},\n            \"first\" : bson.M{ \"$min\" : \"$createdAt\" },\n        },\n    }\n\n    o4 := bson.M {\n        \"$sort\" : bson.M { \"_id\" : 1 },\n    }\n\n    totalMessages := []bson.M{msgsStarted, o2, o3, o4}\n\n    operations := []bson.M{o1, o2, o3, o4}\n\n    pipe := cMessages.Pipe(operations)\n\n    results := []bson.M{}\n    err := pipe.All(&amp;results)\n\n    if err != nil {\n        fmt.Printf(\"Error: %s\\n\", err)\n        return\n    }\n\n    for _, resultRec := range results {\n        myDate := fmt.Sprintf(\"%s\", resultRec[\"first\"])\n        fmt.Printf(\"%s, %d\\n\", myDate[0:10], resultRec[\"total\"])\n    }\n</code></pre>\n\n<p><strong>EDIT2</strong></p>\n\n<p>Schema definition</p>\n\n<pre><code>messages {\n  \"_id\" : {\n    \"$oid\" : bson.ObjectId\n  },\n  \"isComplete\" : bool,\n  \"status\" : {\n    \"cancelled\" : bool,\n    \"finalized\" : bool,\n    \"delivered\" : bool\n  },\n  \"createdDate\" : {\n    \"$date\" : ISODate\n  } \n</code></pre>\n\n<p>I'm attempting to take the $cond statements that you provided guidance on before and nest it with an $and command, so that I can do the following:</p>\n\n<pre><code>sum(case when isComplete = true and status.finalized = true then 1 else 0)\n</code></pre>\n\n<p>I've been playing with the following:</p>\n\n<pre><code>tf1c := bson.M{\"$cond\": []interface{}{bson.M{\"$eq\": []interface{}{\"iscomplete\", true}}, 1, 0}}\n</code></pre>\n\n<p>but unsure of the syntax exactly.  I believe it should follow something like this, but not sure how to translate it exactly (the below is from another stackoverflow thread)</p>\n\n<pre><code>\"$cond\": [{\n    \"$and\": [{\n      \"$eq\": [\"isComplete\", true]\n    }, {\n      \"$eq\": [\"pkgStatus.finalized\", true]\n    }]\n}, 1, 0]\n</code></pre>\n\n<p>Thanks again for the guidance!</p>\n\n<p><strong>Unwrapping the Map</strong></p>\n\n<p>How do you unwrap the map? </p>\n\n<pre><code>map[_id:map[date:2014-12-25 retailer:ObjectIdHex(\"548a9de8a4ea9d690f6df8e4\")]] \n</code></pre>\n\n<p>to retrieve the values. I have tried the following but it returns null.</p>\n\n<pre><code>fmt.Printf(\"%s\\n\", resultRec[\"_id.date\"])\n</code></pre>\n"}, {"tags": ["curl", "memory", "go", "grep", "scalability"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 1, "creation_date": 1468894764, "post_id": 38447657, "comment_id": 64302431, "body": "I&#39;d be willing to bet bytes.Index is both the most concise and performant solution to your problem."}], "answers": [{"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1468901984, "creation_date": 1468901984, "answer_id": 38449527, "question_id": 38447657, "link": "https://stackoverflow.com/questions/38447657/what-is-the-most-efficient-and-scalable-equivalent-of-grepping-a-string-on-a-web/38449527#38449527", "title": "What is the most efficient and scalable equivalent of grepping a string on a website using curl in Golang?", "body": "<p>This code implements grep, stopping at the first line that contains the given string. It avoids reading the entire webpage into memory at once by using a <code>bufio.Scanner</code>, which apart from bounding the memory use might also speed up the program in the case where the string is found near the start of a huge page. It's careful to use <code>scan.Bytes()</code> to avoid converting every line into a string, which would cause significant memory churn.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    resp, err := http.Get(\"http://stackoverflow.com\")\n    if err != nil {\n        log.Fatalf(\"failed to open url\")\n    }\n    scan := bufio.NewScanner(resp.Body)\n    toFind := []byte(\"stackoverflow.com\")\n    defer resp.Body.Close()\n    for scan.Scan() {\n        if bytes.Contains(scan.Bytes(), toFind) {\n            fmt.Println(scan.Text())\n            return\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 38449527, "answer_count": 1, "score": 1, "last_activity_date": 1468919688, "creation_date": 1468886627, "last_edit_date": 1468919688, "question_id": 38447657, "link": "https://stackoverflow.com/questions/38447657/what-is-the-most-efficient-and-scalable-equivalent-of-grepping-a-string-on-a-web", "title": "What is the most efficient and scalable equivalent of grepping a string on a website using curl in Golang?", "body": "<p><strong>Background</strong></p>\n\n<pre><code>user@host curl -s http://stackoverflow.com | grep -m 1 stackoverflow.com\n</code></pre>\n\n<p>returns immediately if the string is found:</p>\n\n<pre><code>&lt;meta name=\"twitter:domain\" content=\"stackoverflow.com\"/&gt;\n</code></pre>\n\n<p><strong>Aim</strong></p>\n\n<p>find a string on a website using Golang</p>\n\n<p><strong>Method</strong></p>\n\n<p>Based on sources from <a href=\"https://gobyexample.com/regular-expressions\" rel=\"nofollow\">Go by Example</a> and <a href=\"http://schier.co/blog/2015/04/26/a-simple-web-scraper-in-go.html\" rel=\"nofollow\">Schier's Blog</a> the following code was created:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"regexp\"\n)\n\nfunc main() {\n    url := \"http://stackoverflow.com\"\n    resp, _ := http.Get(url)\n    bytes, _ := ioutil.ReadAll(resp.Body)\n    r, _ := regexp.Compile(\"stackoverflow.com\")\n    fmt.Println(r.FindString(string(bytes)))\n    resp.Body.Close()\n}\n</code></pre>\n\n<p><strong>Results</strong></p>\n\n<p>Running the code results in:</p>\n\n<pre><code>stackoverflow.com\n</code></pre>\n\n<p><strong>Discussion &amp; Conclusions</strong></p>\n\n<ol>\n<li>More code is required to achieve the same aim in Golang or is there a shorter solution</li>\n<li>Both options seems to return at the same time. Is static code in this case faster than dynamic code as well?</li>\n<li>I am concerned whether this code consumes too much memory. It should be used eventually to monitor hundreds of different websites</li>\n</ol>\n"}, {"tags": ["reactjs", "go", "continuous-integration", "webpack", "web-hosting"], "comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468919027, "post_id": 38447253, "comment_id": 64312148, "body": "Since go doesn&#39;t need a webserver or any other tools to run a website (it just needs to be compiled and deployed), I&#39;m not really sure what you are asking."}, {"owner": {"reputation": 43, "user_id": 6057672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08987bd7137e79161e0db880d230b336?s=128&d=identicon&r=PG&f=1", "display_name": "jagadeesh m", "link": "https://stackoverflow.com/users/6057672/jagadeesh-m"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1469029669, "post_id": 38447253, "comment_id": 64372262, "body": "If I implement Go WebAPI along with React Js in front end and use webpack to bundle front end UI, in this case Webpack transpiles code and create one js file. So my question is, what is the best tooling available in market for hosting this site (React Js) ?"}], "owner": {"reputation": 43, "user_id": 6057672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08987bd7137e79161e0db880d230b336?s=128&d=identicon&r=PG&f=1", "display_name": "jagadeesh m", "link": "https://stackoverflow.com/users/6057672/jagadeesh-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469071057, "creation_date": 1468883203, "last_edit_date": 1469071057, "question_id": 38447253, "link": "https://stackoverflow.com/questions/38447253/self-hosting-react-js-app-with-ci-tools", "title": "self hosting react js app with CI tools", "body": "<p>I am planning to deploy my own website using continuous integration deployment tools and technology stack i will be going with are React Js + Redux + Golang. What is the best tooling for hosting this site ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1469149022, "post_id": 38448048, "comment_id": 64429669, "body": "This buffers all the output until the command has finished. That works fine if the command is non-interactive and quick-running, but it&#39;s unsatisfactory for long-running programs, and it&#39;s not the same as the <code>system</code> command in perl."}], "tags": [], "owner": {"reputation": 11, "user_id": 2518837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2064af17149f601338a0d38f8954a75a?s=128&d=identicon&r=PG", "display_name": "user2518837", "link": "https://stackoverflow.com/users/2518837/user2518837"}, "is_accepted": false, "score": 1, "last_activity_date": 1468890457, "last_edit_date": 1468890457, "creation_date": 1468890030, "answer_id": 38448048, "question_id": 38447241, "link": "https://stackoverflow.com/questions/38447241/running-system-command-in-golang-like-system-command-in-perl/38448048#38448048", "title": "running system command in golang like system command in perl", "body": "<p>I can't see any built in options for what you want - but a 7 line function would suffice, I believe:</p>\n\n<pre><code>func system(cmd string, arg ...string) {\n    out, err := exec.Command(cmd, arg...).Output()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(out))\n}\n</code></pre>\n\n<p>Then you can simply call it:</p>\n\n<pre><code>system(\"ls\", \"-l\")\n</code></pre>\n\n<p>So a working full example would be:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc main() {\n    system(\"ls\", \"-l\")\n}\n\nfunc system(cmd string, arg ...string) {\n    out, err := exec.Command(cmd, arg...).Output()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(out))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1468943942, "post_id": 38448761, "comment_id": 64330654, "body": "since it&#39;s not being checked, I would attach <code>os.Stderr</code> too"}], "tags": [], "owner": {"reputation": 905, "user_id": 3781709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4fa60c6b287ee4f006d6c4e320daf5?s=128&d=identicon&r=PG", "display_name": "Pradip Patil", "link": "https://stackoverflow.com/users/3781709/pradip-patil"}, "is_accepted": false, "score": 6, "last_activity_date": 1469148473, "last_edit_date": 1469148473, "creation_date": 1468896220, "answer_id": 38448761, "question_id": 38447241, "link": "https://stackoverflow.com/questions/38447241/running-system-command-in-golang-like-system-command-in-perl/38448761#38448761", "title": "running system command in golang like system command in perl", "body": "<p>function <code>Command</code> returns the <code>Cmd</code> struct which has <code>Stdout</code> field among others.<br>\nYou just have to attach OS <code>Stdout</code> to <code>Cmd</code>'s <code>Stdout</code></p>\n\n<p>Example:</p>\n\n<pre><code>cmd := exec.Command(\"date\") // no need to call Output method here\ncmd.Stdout = os.Stdout // instead use Stdout\ncmd.Stderr = os.Stderr // attach Stderr as well\n\nerr := cmd.Run()\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Refer: <a href=\"https://golang.org/pkg/os/exec/#Command\" rel=\"nofollow\">Command documentation</a></p>\n"}], "owner": {"reputation": 41, "user_id": 4590134, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8jGYM1NJEag/AAAAAAAAAAI/AAAAAAAACRk/zRnl7OmA57o/photo.jpg?sz=128", "display_name": "srinivas reddy", "link": "https://stackoverflow.com/users/4590134/srinivas-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1886, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1469148473, "creation_date": 1468883097, "question_id": 38447241, "link": "https://stackoverflow.com/questions/38447241/running-system-command-in-golang-like-system-command-in-perl", "title": "running system command in golang like system command in perl", "body": "<p>I am trying to run the system commands in golang. I want the stdout to be printint directly out onto the screen.\nIn golang I use the following now :</p>\n\n<pre><code>out, err := exec.Command(cmd).Output()\n    if err != nil {\n        fmt.Println(\"error occured\")\n        fmt.Printf(\"%s\", err)\n   }\n</code></pre>\n\n<p>Here I am storing the output into \"out\" variable and then printing that onto the screen. But I want something which prints as a normal shell command like the system() command in perl.</p>\n\n<p>in perl:</p>\n\n<pre><code>system(\"ls -l\");\n</code></pre>\n\n<p>We don't need to store anything here.</p>\n\n<p>is there some command in golang which mimics exactly the system() cmd in perl. </p>\n"}, {"tags": ["linux", "go", "pid"], "answers": [{"tags": [], "owner": {"reputation": 1497, "user_id": 2716201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa113ebce9e4bd2034e26f88efe19aac?s=128&d=identicon&r=PG&f=1", "display_name": "chlunde", "link": "https://stackoverflow.com/users/2716201/chlunde"}, "is_accepted": false, "score": 0, "last_activity_date": 1468952960, "creation_date": 1468952960, "answer_id": 38465961, "question_id": 38446796, "link": "https://stackoverflow.com/questions/38446796/does-proc-pid-stat-in-all-linux-distributions-always-available/38465961#38465961", "title": "does /proc/[pid]/stat in all linux distributions always available?", "body": "<p>For child processes, you should use <code>waitpid</code>.</p>\n\n<p>There's a netlink API for process events (<a href=\"http://netsplit.com/the-proc-connector-and-socket-filters\" rel=\"nofollow\">http://netsplit.com/the-proc-connector-and-socket-filters</a>) which might be usable for your case:</p>\n\n<p><a href=\"http://godoc.org/github.com/cloudfoundry/gosigar/psnotify#PROC_EVENT_EXIT\" rel=\"nofollow\">http://godoc.org/github.com/cloudfoundry/gosigar/psnotify#PROC_EVENT_EXIT</a></p>\n\n<pre><code>import \"github.com/cloudfoundry/gosigar/psnotify\"\n\nfunc waitpid(pid int) error {\n    watcher, err := psnotify.NewWatcher()\n    if err != nil {\n        return err\n    }\n\n    if err := watcher.Watch(pid, psnotify.PROC_EVENT_EXIT); err != nil {\n        return err\n    }\n\n    defer watcher.Close()\n\n    // At this point, you should probably syscall.Kill(pid, 0) to check that the process is still running.\n\n    for {\n        select {\n        case ev := &lt;-watcher.Error:\n            // TODO..\n            return ev\n        case &lt;-watcher.Exit:\n            return nil\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468952960, "creation_date": 1468880080, "last_edit_date": 1495541297, "question_id": 38446796, "link": "https://stackoverflow.com/questions/38446796/does-proc-pid-stat-in-all-linux-distributions-always-available", "title": "does /proc/[pid]/stat in all linux distributions always available?", "body": "<p>I want to find the best universal way to check if a process exist and is running on any linux.</p>\n\n<p>In Unix / BSD I am available to do this via <a href=\"https://www.freebsd.org/cgi/man.cgi?kqueue\" rel=\"nofollow noreferrer\">kqueue</a> thanks to the <code>syscall.Kqueue()</code> using <code>EVFILT_PROC / NOTE_EXIT</code> it doesn't' matter if is a mac os X, netbsd, freebsd, etc the code will just work and help to monitor the status of a PID.</p>\n\n<p>Trying to achieve the same on linux, I came with the idea to check periodically for the existence of the  <code>/proc/[pid]/stat</code> file, instead of sending a signal 0, <code>kill -s 0</code> like suggested here: <a href=\"https://stackoverflow.com/a/15210305/1135424\">https://stackoverflow.com/a/15210305/1135424</a> mainly to simplify the logic due that <em>non-nil error could be returned for existing processes.</em></p>\n\n<p>Probably using something like:</p>\n\n<pre><code>initialStat, err := os.Stat(fmt.Sprintf(\"/proc/%d/stat\", self.pid)                                                                                                                                                           \nif err != nil {                                                                                                                                                                                                              \n    return                                                                                                                                                                                                                   \n}                                                                                                                                                                                                                            \n\nfor {                                                                                                                                                                                                                        \n    stat, err := os.Stat(fmt.Sprintf(\"/proc/%d/stat\", self.pid)                                                                                                                                                              \n    if err != nil {                                                                                                                                                                                                          \n        return err                                                                                                                                                                                                           \n    }                                                                                                                                                                                                                        \n\n    if stat.Size() != initialStat.Size() || stat.ModTime() != initialStat.ModTime() {                                                                                                                                        \n        return nil                                                                                                                                                                                                           \n    }       \n    // wondering how to avoid sleeping here\n    time.Sleep(time.Second)                                                                                                                                                                                                                 \n}\n</code></pre>\n\n<p>But wondering if in all linux <code>/proc/[pid]/stat</code> is always available or if by sending signal 0 <code>kill -0 $PID</code> is basically doing exactly the same thing.  </p>\n\n<p>At the end I can always fallback to <code>kill -O $PID</code> but just wondering what posible solutions could be used (probably inotify) with the intention to avoid having to sleep on the loop mainly for not consuming to much CPU resources.</p>\n"}, {"tags": ["ubuntu", "go", "web", "go-iris"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1468876159, "post_id": 38445818, "comment_id": 64297405, "body": "It looks like the API has been changed in master. The README recommends fetching the package via gopkg.in to get the V3 branch."}, {"owner": {"reputation": 111, "user_id": 1980477, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/c33bL.jpg?s=128&g=1", "display_name": "Cute Tom", "link": "https://stackoverflow.com/users/1980477/cute-tom"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468876547, "post_id": 38445818, "comment_id": 64297594, "body": "@JimB you mean I should reinstall iris (pull it from gopkg.in) ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468876705, "post_id": 38445818, "comment_id": 64297666, "body": "I&#39;m voting to close this question as off-topic because this is a problem with an offsite project&#39;s documentation, and not programming related."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468876836, "post_id": 38445818, "comment_id": 64297740, "body": "yes, it looks like changing all import paths to <code>gopkg.in&#47;kataras&#47;iris.v3</code> will fix this issue (or you could checkout the V3 branch locally, and keep the import paths)"}, {"owner": {"reputation": 111, "user_id": 1980477, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/c33bL.jpg?s=128&g=1", "display_name": "Cute Tom", "link": "https://stackoverflow.com/users/1980477/cute-tom"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468877571, "post_id": 38445818, "comment_id": 64298051, "body": "@JimB don&#39;t close it please."}, {"owner": {"reputation": 111, "user_id": 1980477, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/c33bL.jpg?s=128&g=1", "display_name": "Cute Tom", "link": "https://stackoverflow.com/users/1980477/cute-tom"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468877618, "post_id": 38445818, "comment_id": 64298063, "body": "@JimB I tried to install the framework from gopkg.in and it&#39;s giving problems in installation."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468877867, "post_id": 38445818, "comment_id": 64298167, "body": "Then I would try checking out the V3 branch locally, and raise and issue with directly with the iris project. The README for that branch shows using gopkg.in <a href=\"https://github.com/kataras/iris/tree/v3\" rel=\"nofollow noreferrer\">github.com/kataras/iris/tree/v3</a>"}], "answers": [{"tags": [], "owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "is_accepted": true, "score": 1, "last_activity_date": 1582270236, "last_edit_date": 1582270236, "creation_date": 1468878242, "answer_id": 38446467, "question_id": 38445818, "link": "https://stackoverflow.com/questions/38445818/iris-go-web-framework-iris-pongoengine-error-from-iris-official-book/38446467#38446467", "title": "iris (Go web framework) iris.PongoEngine error from iris official book", "body": "<pre><code>import \"github.com/kataras/iris/v12\"\n\nfunc main() {\n\n    app := iris.New()\n    app.RegisterView(iris.Django(\"./templates\", \".html\")) // &lt;-----\n\n    // RESOURCE: http://127.0.0.1:8080/hi\n    // METHOD: \"GET\"\n    app.Get(\"/hi\", hi)\n\n    app.Listen(\":8080\")\n}\n\nfunc hi(ctx iris.Context){\n   ctx.ViewData(\"Name\", \"iris\")\n   ctx.View(\"hi.html\")\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 1980477, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/c33bL.jpg?s=128&g=1", "display_name": "Cute Tom", "link": "https://stackoverflow.com/users/1980477/cute-tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 38446467, "answer_count": 1, "score": 1, "last_activity_date": 1582270236, "creation_date": 1468875221, "last_edit_date": 1527045198, "question_id": 38445818, "link": "https://stackoverflow.com/questions/38445818/iris-go-web-framework-iris-pongoengine-error-from-iris-official-book", "title": "iris (Go web framework) iris.PongoEngine error from iris official book", "body": "<p>I started using Golang's Web Framework (Iris). I'm using the official iris book from gitbooks.\nI'm working on the <a href=\"https://kataras.gitbooks.io/iris/content/hi.html\" rel=\"nofollow\">last example in this page</a> from the book.\nFollowing is the code used in the last example</p>\n\n<p><strong>./templates/hi.html</strong></p>\n\n<pre><code>&lt;!-- ./templates/hi.html --&gt;\n&lt;html&gt;&lt;head&gt; &lt;title&gt; Hi Iris [THE TITLE] &lt;/title&gt; &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt; Hi {{ Name }}\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>./main.go</strong></p>\n\n<pre><code>// ./main.go\nimport (\n    \"github.com/kataras/iris\"\n)\n\nfunc main() {\n    iris.Config.Render.Template.Engine = iris.PongoEngine\n    iris.Get(\"/hi\", hi)\n    iris.Listen(\":8080\")\n}\n\nfunc hi(ctx *iris.Context){\n   ctx.Render(\"hi.html\", map[string]interface{}{\"Name\": \"iris\"})\n}\n</code></pre>\n\n<p>When I run the main.go, following are the errors I got.</p>\n\n<pre><code># command-line-arguments\n./main.go:8: iris.Config.Render undefined (type *config.Iris has no field or method Render)\n./main.go:8: undefined: iris.PongoEngine\n</code></pre>\n\n<p>I followed all the steps correctly, and also downloaded all the dependencies. I already took <a href=\"https://www.udemy.com/learn-how-to-code/learn/v4/\" rel=\"nofollow\">Learn How To Code: Google's Go (golang) Programming Language - Udemy</a> and <a href=\"https://www.youtube.com/playlist?list=PLSak_q1UXfPrI6D67NF8ajfeJ6f7MH83S\" rel=\"nofollow\">Golang Workshop by Caleb Doxcy</a>, so I know the basics, like how to install dependencies, and how to import them etc. But the example shown in the book doesn't work. </p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1468875301, "creation_date": 1468875301, "answer_id": 38445832, "question_id": 38445733, "link": "https://stackoverflow.com/questions/38445733/read-response-content-from-gorilla-toolkit-client-get/38445832#38445832", "title": "Read response content from gorilla toolkit Client.get", "body": "<p>Use <a href=\"https://godoc.org/io/ioutil#ReadAll\" rel=\"nofollow\">ioutil.ReadAll</a> to read the entire response body as a []byte:</p>\n\n<pre><code>status, h, r, err := http.DefaultClient.Get(url, nil)\nif err != nil {\n    log.Fatal(err)\n}\nvar p []byte\nif r != nil {\n    p, err = ioutil.ReadAll(r)\n    r.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>I suggest that you use the <a href=\"https://godoc.org/net/http#Client\" rel=\"nofollow\">net/http client</a> instead of the Gorilla client.  There are more examples of how use the net/http client and the net/http client better maintained.</p>\n"}], "owner": {"reputation": 1166, "user_id": 55049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784247c4145b0d2cfc0827bb67256943?s=128&d=identicon&r=PG", "display_name": "perelin", "link": "https://stackoverflow.com/users/55049/perelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 1, "accepted_answer_id": 38445832, "answer_count": 1, "score": 0, "last_activity_date": 1468875301, "creation_date": 1468874824, "question_id": 38445733, "link": "https://stackoverflow.com/questions/38445733/read-response-content-from-gorilla-toolkit-client-get", "title": "Read response content from gorilla toolkit Client.get", "body": "<p>I\u00b4m using <a href=\"http://www.gorillatoolkit.org/pkg/http\" rel=\"nofollow\">Gorilla Toolkit</a> for golang to request a web resource (GET) and I want to process the response body but don\u00b4t know how to access it. Here is my main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/gorilla/http\"\n)\n\nfunc main() {\n    url := \"http://ubuntu.com\"\n\n    status, h, r, err := http.DefaultClient.Get(url, nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n    if r != nil {\n        defer r.Close()\n    }\n    log.Printf(\"Status: %v\", status)\n    log.Printf(\"Headers: %v\", h)\n\n    var p []byte\n    _, err = r.Read(p)\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"MSG: %v\", p)\n} \n</code></pre>\n\n<p>Gorillas response object is of the type <code>io.ReadCloser</code> and I can\u00b4t wrap my head around how to access it. Any help is appreciated.</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "is_accepted": false, "score": 5, "last_activity_date": 1521180821, "last_edit_date": 1521180821, "creation_date": 1468870710, "answer_id": 38444702, "question_id": 38443889, "link": "https://stackoverflow.com/questions/38443889/logging-http-responses-in-addition-to-requests/38444702#38444702", "title": "Logging http responses (in addition to requests)", "body": "<p><em>edit</em> sorry, I didn't notice your mention of gorilla-mux, I have only tried this with gin, but if it uses middlewares this should still work.</p>\n\n<hr>\n\n<p>the trick is, <code>c.Next()</code> in a middleware blocks until all subsequent middlewares return. Here's a logrus solution. Put this as your first middleware:</p>\n\n<pre><code>func Logrus(logger *logrus.Logger) gin.HandlerFunc {\n    return func(c *gin.Context) {\n        start := time.Now().UTC()\n        path := c.Request.URL.Path\n        c.Next()\n        end := time.Now().UTC()\n        latency := end.Sub(start)\n        logger.WithFields(logrus.Fields{\n            \"status\":     c.Writer.Status(),\n            \"method\":     c.Request.Method,\n            \"path\":       path,\n            \"ip\":         c.ClientIP(),\n            \"duration\":   latency,\n            \"user_agent\": c.Request.UserAgent(),\n        }).Info()\n    }\n}\nGinEngine.Use(Logrus(logrus.StandardLogger()))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 431, "user_id": 3271700, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c9d6e80a762e962de924bd6f1efc3ee0?s=128&d=identicon&r=PG&f=1", "display_name": "errolflynn", "link": "https://stackoverflow.com/users/3271700/errolflynn"}, "edited": false, "score": 0, "creation_date": 1589406552, "post_id": 38469116, "comment_id": 109286253, "body": "This solution will not deterministically work with the popular justinas/alice middleware chaining library. From the <code>justinas&#47;alice&#47;README.md</code>: &quot;Note that Alice makes no guarantees for how one or another piece of middleware will behave. Once it passes the execution to the outer layer of middleware, it has no saying in whether middleware will execute the inner handlers. This is intentional behavior.&quot;"}, {"owner": {"reputation": 3169, "user_id": 263175, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/765f241a1d4f83d4bf52d60f632e2030?s=128&d=identicon&r=PG", "display_name": "Seaux", "link": "https://stackoverflow.com/users/263175/seaux"}, "edited": false, "score": 0, "creation_date": 1618256388, "post_id": 38469116, "comment_id": 118542804, "body": "just a suggestion: <code>log.Printf(&quot;%q\\n&quot;, x)</code> may make your log lines cleaner. Additionally, error&#39;s have an <code>.Error()</code> func that returns the string repr of the error so you can avoid doing <code>fmt.Sprintf(err)</code>. In fact, under the fmt hood is exactly what they do for <code>error</code>s"}], "tags": [], "owner": {"reputation": 4531, "user_id": 3011570, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/4Ht66.jpg?s=128&g=1", "display_name": "Eric Broda", "link": "https://stackoverflow.com/users/3011570/eric-broda"}, "is_accepted": true, "score": 7, "last_activity_date": 1469040916, "last_edit_date": 1469040916, "creation_date": 1468965065, "answer_id": 38469116, "question_id": 38443889, "link": "https://stackoverflow.com/questions/38443889/logging-http-responses-in-addition-to-requests/38469116#38469116", "title": "Logging http responses (in addition to requests)", "body": "<p>Thanks for the great suggestions.  I tried a few of the suggestions and landed on a rather simple solution that uses a minimalist wrapper.  Here is the solution that worked for me (feel free to offer comments, or better yet, other solutions):</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"net/http/httputil\"\n    \"github.com/gorilla/mux\"\n)\n:\n\nfunc logHandler(fn http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        x, err := httputil.DumpRequest(r, true)\n        if err != nil {\n            http.Error(w, fmt.Sprint(err), http.StatusInternalServerError)\n            return\n        }\n        log.Println(fmt.Sprintf(\"%q\", x))\n        rec := httptest.NewRecorder()\n        fn(rec, r)\n        log.Println(fmt.Sprintf(\"%q\", rec.Body))            \n    }\n}\n\nfunc MessageHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"A message was received\")\n}\n</code></pre>\n\n<p>And the following code will use the aforementioned handler:</p>\n\n<pre><code>:\nrouter := mux.NewRouter()\nrouter.HandleFunc(\"/\", logHandler(MessageHandler))\n:\n</code></pre>\n\n<p>Output from the above code will be something along the lines of:</p>\n\n<pre><code>:\n2016/07/20 14:44:29 \"GET ... HTTP/1.1\\r\\nHost: localhost:8088\\r\\nAccept: */*\\r\\nUser-Agent: curl/7.43.0\\r\\n\\r\\n\"\n2016/07/20 14:44:29 ...[response body]\n:\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 8447207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e1b8348820278a1e8ada4420c8de4e?s=128&d=identicon&r=PG&f=1", "display_name": "ouidevelop", "link": "https://stackoverflow.com/users/8447207/ouidevelop"}, "is_accepted": false, "score": 7, "last_activity_date": 1523411272, "creation_date": 1523411272, "answer_id": 49765237, "question_id": 38443889, "link": "https://stackoverflow.com/questions/38443889/logging-http-responses-in-addition-to-requests/49765237#49765237", "title": "Logging http responses (in addition to requests)", "body": "<p>The accepted answer by Eric Broda won't help much if you want to actually send your response to the client. I've made a modification to that code that will actually work:</p>\n\n<pre><code>func logHandler(fn http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        x, err := httputil.DumpRequest(r, true)\n        if err != nil {\n            http.Error(w, fmt.Sprint(err), http.StatusInternalServerError)\n            return\n        }\n        log.Println(fmt.Sprintf(\"%q\", x))\n        rec := httptest.NewRecorder()\n        fn(rec, r)\n        log.Println(fmt.Sprintf(\"%q\", rec.Body))        \n\n        // this copies the recorded response to the response writer\n        for k, v := range rec.HeaderMap {\n            w.Header()[k] = v\n        }\n        w.WriteHeader(rec.Code)\n        rec.Body.WriteTo(w)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 4531, "user_id": 3011570, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/4Ht66.jpg?s=128&g=1", "display_name": "Eric Broda", "link": "https://stackoverflow.com/users/3011570/eric-broda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12875, "favorite_count": 1, "accepted_answer_id": 38469116, "answer_count": 3, "score": 9, "last_activity_date": 1615200250, "creation_date": 1468867330, "last_edit_date": 1615200250, "question_id": 38443889, "link": "https://stackoverflow.com/questions/38443889/logging-http-responses-in-addition-to-requests", "title": "Logging http responses (in addition to requests)", "body": "<p>I am using Go and the Gorilla web toolkit's mux and handler packages to build a complex application, part of which requires a http server.  Gorilla's mux and handler packages work wonderfully and I am able to successfully get the http server up and running and it has been quite simple to log requests.</p>\n<p>However, I am unable to determine how I may log responses.  Ideally, I would like a mechanism, similar to Gorilla's LoggingHandler, that &quot;wraps&quot; the logging mechanism easily.</p>\n<p>Is there a Go package that does easily wraps / logs responses?  Is there a way to use Go or Gorilla's capabilities in this fashion that I have not considered?</p>\n"}, {"tags": ["pointers", "go", "struct", "dereference"], "answers": [{"comments": [{"owner": {"reputation": 10804, "user_id": 2701130, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a8dc6466b051862029132d3c61ca48d?s=128&d=identicon&r=PG", "display_name": "ken", "link": "https://stackoverflow.com/users/2701130/ken"}, "edited": false, "score": 0, "creation_date": 1468867147, "post_id": 38443432, "comment_id": 64292920, "body": "is there a way to get the same dereferenced pointer to p? as in the main() func, if we are appending the struct as a slice, we will always have to dereference it inside the append itself, i.e. res = append(res, *p)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468867176, "post_id": 38443432, "comment_id": 64292933, "body": "It not just about &quot;creating&quot; a new variable, assignment to an existing variable via a dereference copies the value, e.g. <code>*a = *b</code> still copied copies <code>*b</code> to <code>*a</code>."}, {"owner": {"reputation": 10804, "user_id": 2701130, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a8dc6466b051862029132d3c61ca48d?s=128&d=identicon&r=PG", "display_name": "ken", "link": "https://stackoverflow.com/users/2701130/ken"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468917846, "post_id": 38443432, "comment_id": 64311363, "body": "@jimB yap, is there a way to avoid the repeated copy? as basically the operation just need to deal with the same p struct."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 10804, "user_id": 2701130, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a8dc6466b051862029132d3c61ca48d?s=128&d=identicon&r=PG", "display_name": "ken", "link": "https://stackoverflow.com/users/2701130/ken"}, "edited": false, "score": 1, "creation_date": 1468932429, "post_id": 38443432, "comment_id": 64322170, "body": "@ken: I don&#39;t understand what you mean. You need some sort of value, so it&#39;s either going to be the struct value or a pointer value. If you want to reference the same struct or avoid copying you use a pointer."}, {"owner": {"reputation": 10804, "user_id": 2701130, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a8dc6466b051862029132d3c61ca48d?s=128&d=identicon&r=PG", "display_name": "ken", "link": "https://stackoverflow.com/users/2701130/ken"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468937007, "post_id": 38443432, "comment_id": 64325857, "body": "@JimB okay, maybe i am thinking too much ;) I got what you mean, thanks for your replied!"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 16, "last_activity_date": 1468867778, "last_edit_date": 1495541385, "creation_date": 1468865725, "answer_id": 38443432, "question_id": 38443348, "link": "https://stackoverflow.com/questions/38443348/does-dereferencing-a-struct-return-a-new-copy-of-struct/38443432#38443432", "title": "Does dereferencing a struct return a new copy of struct?", "body": "<p>When you write</p>\n\n<pre><code>obj := *p\n</code></pre>\n\n<p>You are copying the value of struct pointed to by <code>p</code> (<code>*</code> dereferences <code>p</code>). It is similar to:</p>\n\n<pre><code>var obj me = *p\n</code></pre>\n\n<p>So <code>obj</code> is a new variable of type <code>me</code>, being initialized to the value of <code>*p</code>. This causes <code>obj</code> to have a different memory address.</p>\n\n<p>Note that <code>obj</code> if of type <code>me</code>, while <code>p</code> is of type <code>*me</code>. But they are separate values. Changing a value of a field of <code>obj</code> will not affect the value of that field in <code>p</code> (unless the <code>me</code> struct has a reference type in it as a field, i.e. slice, map or channels. See <a href=\"https://stackoverflow.com/questions/38263511/go-modify-dereferenced-struct-pointer-changes-most-struct-values-but-not-slic/38263938#38263938\">here</a> and <a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"noreferrer\">here</a>.). If you want to bring about that effect, use:</p>\n\n<pre><code>obj := p\n// equivalent to: var obj *me = p\n</code></pre>\n\n<p>Now <code>obj</code> points to the same object as <code>p</code>. They still have different addresses themselves, but hold within them the same address of the actual <code>me</code> object.</p>\n"}, {"comments": [{"owner": {"reputation": 10804, "user_id": 2701130, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a8dc6466b051862029132d3c61ca48d?s=128&d=identicon&r=PG", "display_name": "ken", "link": "https://stackoverflow.com/users/2701130/ken"}, "edited": false, "score": 1, "creation_date": 1468866889, "post_id": 38443456, "comment_id": 64292801, "body": "in fact, coming from c background, this make me confuse. Thanks, think both answer are correct and reach me about the same time, so chose a more details, but upvote this for your answer too!"}, {"owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "edited": false, "score": 2, "creation_date": 1492079678, "post_id": 38443456, "comment_id": 73840589, "body": "<code>dereferencing p itself does not create a copy</code> this clarified my confusion, thanks"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 15, "last_activity_date": 1468865798, "creation_date": 1468865798, "answer_id": 38443456, "question_id": 38443348, "link": "https://stackoverflow.com/questions/38443348/does-dereferencing-a-struct-return-a-new-copy-of-struct/38443456#38443456", "title": "Does dereferencing a struct return a new copy of struct?", "body": "<p>No, \"assignment\" always creates a copy in Go, including assignment to function and method arguments.  The statement <code>obj := *p</code> copies the value of <code>*p</code> to <code>obj</code>. </p>\n\n<p>If you change the statement <code>p.color = \"purple\"</code> to <code>(*p).color = \"purple\"</code> you will get the same output, because dereferencing <code>p</code> itself does not create a copy.</p>\n"}, {"comments": [{"owner": {"reputation": 314, "user_id": 5579463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b605f30fa77cd9f62b99fd74c2ce8cf2?s=128&d=identicon&r=PG&f=1", "display_name": "MrR", "link": "https://stackoverflow.com/users/5579463/mrr"}, "edited": false, "score": 1, "creation_date": 1561124999, "post_id": 54889907, "comment_id": 99972807, "body": "&quot;original&quot; is misleading, consider rephrasing?"}, {"owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "reply_to_user": {"reputation": 314, "user_id": 5579463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b605f30fa77cd9f62b99fd74c2ce8cf2?s=128&d=identicon&r=PG&f=1", "display_name": "MrR", "link": "https://stackoverflow.com/users/5579463/mrr"}, "edited": false, "score": 0, "creation_date": 1561132356, "post_id": 54889907, "comment_id": 99976812, "body": "What about just removing the word &quot;original&quot;?"}, {"owner": {"reputation": 918, "user_id": 429828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2028f8517e3123ca997938df3acd4fc5?s=128&d=identicon&r=PG", "display_name": "Allen Hamilton", "link": "https://stackoverflow.com/users/429828/allen-hamilton"}, "edited": false, "score": 0, "creation_date": 1579823114, "post_id": 54889907, "comment_id": 105905876, "body": "True, although an <i>assignment does copy</i>! (Note that for slices and maps it will only copy the header value, not the actual elements, so it may seem like it does not copy)"}], "tags": [], "owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "is_accepted": false, "score": 6, "last_activity_date": 1565287446, "last_edit_date": 1565287446, "creation_date": 1551198082, "answer_id": 54889907, "question_id": 38443348, "link": "https://stackoverflow.com/questions/38443348/does-dereferencing-a-struct-return-a-new-copy-of-struct/54889907#54889907", "title": "Does dereferencing a struct return a new copy of struct?", "body": "<p><strong>tl;dr</strong> Dereferencing (using the <code>*</code> operator) in Go does not make a copy. It returns the value the pointer points to.</p>\n"}], "owner": {"reputation": 10804, "user_id": 2701130, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9a8dc6466b051862029132d3c61ca48d?s=128&d=identicon&r=PG", "display_name": "ken", "link": "https://stackoverflow.com/users/2701130/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15026, "favorite_count": 6, "accepted_answer_id": 38443432, "answer_count": 3, "score": 15, "last_activity_date": 1565349960, "creation_date": 1468865424, "last_edit_date": 1565349960, "question_id": 38443348, "link": "https://stackoverflow.com/questions/38443348/does-dereferencing-a-struct-return-a-new-copy-of-struct", "title": "Does dereferencing a struct return a new copy of struct?", "body": "<p>Why when we reference struct using <code>(*structObj)</code> does Go seem to return a new copy of <code>structObj</code> rather than return the same address of original <code>structObj</code>? This might be some misunderstanding of mine, so I seek clarification</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype me struct {\n    color string\n    total int\n}\n\nfunc study() *me {\n    p := me{}\n    p.color = \"tomato\"\n    fmt.Printf(\"%p\\n\", &amp;p.color)\n    return &amp;p\n}\n\nfunc main() {\n    p := study()\n    fmt.Printf(\"&amp;p.color = %p\\n\", &amp;p.color)\n\n    obj := *p\n    fmt.Printf(\"&amp;obj.color = %p\\n\", &amp;obj.color)\n    fmt.Printf(\"obj = %+v\\n\", obj)\n\n    p.color = \"purple\"\n    fmt.Printf(\"p.color = %p\\n\", &amp;p.color)\n    fmt.Printf(\"p = %+v\\n\", p)\n    fmt.Printf(\"obj  = %+v\\n\", obj)\n\n    obj2 := *p\n    fmt.Printf(\"obj2 = %+v\\n\", obj2)\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>0x10434120\n&amp;p.color = 0x10434120\n&amp;obj.color = 0x10434140   //different than &amp;p.color!\nobj = {color:tomato total:0}\np.color = 0x10434120\np = &amp;{color:purple total:0}\nobj  = {color:tomato total:0}\nobj2 = {color:purple total:0} // we get purple now when dereference again\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/HCvajBAnsb\" rel=\"noreferrer\">Go playground</a> </p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468866540, "post_id": 38442545, "comment_id": 64292641, "body": "See also <a href=\"http://stackoverflow.com/questions/33179876/how-to-make-a-map-pointer-using-reflect\" title=\"how to make a map pointer using reflect\">stackoverflow.com/questions/33179876/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1468862735, "creation_date": 1468862735, "answer_id": 38442644, "question_id": 38442545, "link": "https://stackoverflow.com/questions/38442545/golang-lost-in-the-reflection/38442644#38442644", "title": "golang lost in the reflection", "body": "<p>You're passing a pointer to a <code>reflect.Value</code> into your <code>Select</code> call. A <code>reflect.Value</code> is a struct, which is why you're receiving this error. </p>\n\n<p>Instead, create a new pointer of the type you want using <a href=\"https://golang.org/pkg/reflect/#New\" rel=\"nofollow\"><code>reflect.New</code></a></p>\n\n<pre><code>slice := reflect.New(reflect.SliceOf(res.resourceType))\nerr := res.api.DB.Select(slice.Interface(), \"SELECT * FROM domains\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6604782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20e9027ae25da45a730a9155b73ca263?s=128&d=identicon&r=PG", "display_name": "Veselin Iordanov", "link": "https://stackoverflow.com/users/6604782/veselin-iordanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "accepted_answer_id": 38442644, "answer_count": 1, "score": 0, "last_activity_date": 1468862735, "creation_date": 1468862338, "question_id": 38442545, "link": "https://stackoverflow.com/questions/38442545/golang-lost-in-the-reflection", "title": "golang lost in the reflection", "body": "<p>I am traing  to abstract a rest API with go lang but i totally stuck in the reflection part.</p>\n\n<pre><code>    log.Printf(\"handleIndex resourceType = %v\", res.resourceType)\n\nslice := reflect.MakeSlice(reflect.SliceOf(res.resourceType), 0, 0)\nerr := res.api.DB.Select(&amp;slice, \"SELECT * FROM domains\")\nif err != nil {\n    log.Printf(\"SQL Error %s\", err)\n}\nfmt.Printf(\"\\n=================================== \\n%#v \\n=================================== \", slice)\n</code></pre>\n\n<p>resourceType is a reflect.Type of the model</p>\n\n<p>res.api.DB is sqlx.DB</p>\n\n<p>Output of the code is :</p>\n\n<p>handleIndex resourceType = main.Domain</p>\n\n<h1>SQL Error  expected slice but got struct</h1>\n\n<h1>[]main.Domain{}</h1>\n\n<p>so basically even i make a slice of reflect.Type i got a struct\nWhat i am missing ?</p>\n"}, {"tags": ["mysql", "templates", "go"], "comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468857687, "post_id": 38441258, "comment_id": 64288089, "body": "on which line does the error occur?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468857693, "post_id": 38441258, "comment_id": 64288096, "body": "The stack trace output will tell you <i>exactly</i> where the error is. What line in your code is panicking, and what was the call stack?"}, {"owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "edited": false, "score": 0, "creation_date": 1468864792, "post_id": 38441258, "comment_id": 64291840, "body": "Check if you have templates/index.html in the same directory where main.go is present."}, {"owner": {"reputation": 53, "user_id": 4670258, "user_type": "registered", "profile_image": "https://graph.facebook.com/790103484413801/picture?type=large", "display_name": "Oliver Mensah", "link": "https://stackoverflow.com/users/4670258/oliver-mensah"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468877655, "post_id": 38441258, "comment_id": 64298078, "body": "It shows runtime error of memory address deferencing which does not tell me the line of the code that has the problem. @JimB"}, {"owner": {"reputation": 53, "user_id": 4670258, "user_type": "registered", "profile_image": "https://graph.facebook.com/790103484413801/picture?type=large", "display_name": "Oliver Mensah", "link": "https://stackoverflow.com/users/4670258/oliver-mensah"}, "reply_to_user": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "edited": false, "score": 0, "creation_date": 1468877806, "post_id": 38441258, "comment_id": 64298141, "body": "The templates and the main.go are in the same directory. but the index.html is in the template which makes it have different directory from the main.go @KishoreVaishnav"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468878072, "post_id": 38441258, "comment_id": 64298255, "body": "@olivermensah: the stack trace will always tell you where the dereference happened. My guess is that since you never check <code>templatesErr</code>, <code>templates</code> is nil. Check your errors first."}, {"owner": {"reputation": 53, "user_id": 4670258, "user_type": "registered", "profile_image": "https://graph.facebook.com/790103484413801/picture?type=large", "display_name": "Oliver Mensah", "link": "https://stackoverflow.com/users/4670258/oliver-mensah"}, "edited": false, "score": 0, "creation_date": 1468880483, "post_id": 38441258, "comment_id": 64299103, "body": "This is what came after making the changes to  the file.  C:/go/src/net/http/server.go:2137 +0x455 2016/07/18 15:19:14 http: panic serving [::1]:55148: runtime error: invalid memory address or nil pointer dereference goroutine 10 [running]: net/http.(*conn).serve.func1(0xc0820a6e00)         C:/go/src/net/http/server.go:1389 +0xc8 panic(0x7e5600, 0xc082002080)         C:/go/src/runtime/panic.go:443 +0x4f7 html/template.(*Template).lookupAndEscapeTemplate(0x0, 0x874810, 0xa, 0x0, 0x0,"}, {"owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "edited": false, "score": 0, "creation_date": 1468910021, "post_id": 38441258, "comment_id": 64306892, "body": "@olivermensah find similar text in the stack trace output &quot;main.go:&quot; which will help you to find the line number. BTW, is your facilities.html is also present in the templates folder? What is the url you are browsing?"}, {"owner": {"reputation": 53, "user_id": 4670258, "user_type": "registered", "profile_image": "https://graph.facebook.com/790103484413801/picture?type=large", "display_name": "Oliver Mensah", "link": "https://stackoverflow.com/users/4670258/oliver-mensah"}, "edited": false, "score": 0, "creation_date": 1468923073, "post_id": 38441258, "comment_id": 64315106, "body": "Now  I have been able to fix the runtime error, it was from how the templates were parsed without checking for errors. t"}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1468924214, "creation_date": 1468924214, "answer_id": 38455967, "question_id": 38441258, "link": "https://stackoverflow.com/questions/38441258/i-need-help-on-this-golang-web-application-using-mysql-as-database/38455967#38455967", "title": "I need help on this Golang web application using mysql as database", "body": "<p>Tried your code and got the same error. It happened on this line:</p>\n\n<pre><code>templates.ExecuteTemplate(w, \"index.html\", rootData)\n</code></pre>\n\n<p>The problem is that your templates are not loaded correctly. I moved template parsing to the main function and it works. Here the relevant code snippet:</p>\n\n<pre><code>//Fetch all templates\nvar (\n    templates *template.Template\n)\n\nfunc main() {\n    var err error\n    templates, err = template.ParseGlob(\"templates/*\")\n    if err != nil {\n        panic(err)\n    }\n\n    PORT := \":9000\"\n    log.Println(\"Listening to port\", PORT)\n    http.HandleFunc(\"/\", root)\n    http.HandleFunc(\"/facilities\", allFacilities)\n    http.ListenAndServe(PORT, nil)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4670258, "user_type": "registered", "profile_image": "https://graph.facebook.com/790103484413801/picture?type=large", "display_name": "Oliver Mensah", "link": "https://stackoverflow.com/users/4670258/oliver-mensah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 1, "accepted_answer_id": 38455967, "answer_count": 1, "score": 0, "last_activity_date": 1468924214, "creation_date": 1468857578, "last_edit_date": 1468862219, "question_id": 38441258, "link": "https://stackoverflow.com/questions/38441258/i-need-help-on-this-golang-web-application-using-mysql-as-database", "title": "I need help on this Golang web application using mysql as database", "body": "<p>I am new to Golang  and had been following some tutorials and I want to put into practice what I have learned to create a website\nThis is the main.go file </p>\n\n<pre><code>package main\n\nimport (\n        \"html/template\"\n        \"net/http\"\n        \"log\"\n        \"database/sql\"\n        _\"github.com/go-sql-driver/mysql\"\n)\n\n//Fetch all templates\nvar templates, templatesErr = template.ParseGlob(\"templates/*\")\n func main() {\n  PORT  := \":9000\"\n  log.Println(\"Listening to port\", PORT)\n  http.HandleFunc(\"/\", root)\n  http.HandleFunc(\"/facilities\", allFacilities)\n  http.ListenAndServe(PORT, nil)\n\n}\nfunc root(w http.ResponseWriter, r *http.Request) {\n    rootData := make(map[string]string)\n    rootData[\"page_title\"]  = \"iSpace Open Data\"\n    rootData[\"body\"]    = \"\"\n\n    templates.ExecuteTemplate(w, \"index.html\", rootData)\n}\n\n type facility struct{\n   FacilityName string\n   Type string\n }\n\nfunc allFacilities(w http.ResponseWriter, r *http.Request){\n  db, err := sql.Open(\"mysql\", \"root:08swanzy@tcp(127.0.0.1:3306)/iod\")\n  if err !=nil{\n    log.Fatal(err)\n  }\n  defer db.Close()\n  rows, err := db.Query(\"Select FacilityName, Type from health_facilities \")\n  if err != nil {\n      log.Fatal(err)\n  }\n  defer rows.Close()\n\n  fac := facility{}\n  facilities := []facility{}\n  for rows.Next(){\n    var FacilityName, Type string\n    rows.Scan(&amp;FacilityName, &amp;Type)\n    fac.FacilityName= FacilityName\n    fac.Type= Type\n    facilities = append(facilities, fac)\n  }\n  templates.ExecuteTemplate(w, \"facilities.html\", facilities)\n}\n</code></pre>\n\n<p>This uses html files in templates folder for the view. But I  keep on getting runtime error saying it has pointer dereference. I need help please.</p>\n"}, {"tags": ["go", "go-toolchain"], "answers": [{"comments": [{"owner": {"reputation": 34332, "user_id": 2300597, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/OBo7Q.png?s=128&g=1", "display_name": "peter.petrov", "link": "https://stackoverflow.com/users/2300597/peter-petrov"}, "edited": false, "score": 0, "creation_date": 1468857365, "post_id": 38439840, "comment_id": 64287888, "body": "I see. Thanks. I was just worried that my installation did not go through quite fine."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1468854365, "last_edit_date": 1468854365, "creation_date": 1468853538, "answer_id": 38439840, "question_id": 38439795, "link": "https://stackoverflow.com/questions/38439795/go-bin-just-3-files/38439840#38439840", "title": "go bin - just 3 files", "body": "<p>That's normal. If you're looking for all the other executables (like linker, compiler etc.), check the:</p>\n\n<pre><code>%GOROOT%/pkg/tool/windows_amd64\n</code></pre>\n\n<p>(or similar) folders. These are not placed in the <code>bin</code> folder because you don't need to call these (they are called by the <code>go.exe</code> tool). <code>bin</code> contains only the tools you interact with, and is recommended to add <code>%GOROOT%/bin</code> to your <code>PATH</code>.</p>\n\n<p>For example in my <code>pkg/tool/windows_amd64</code> folder I have the following additional binaries:</p>\n\n<pre><code>addr2line.exe\napi.exe\nasm.exe\ncompile.exe\ncover.exe\ndist.exe\ndoc.exe\nfix.exe\nlink.exe\nnm.exe\nobjdump.exe\npack.exe\npprof.exe\ntour.exe\ntrace.exe\nvet.exe\nyacc.exe\n</code></pre>\n"}], "owner": {"reputation": 34332, "user_id": 2300597, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/OBo7Q.png?s=128&g=1", "display_name": "peter.petrov", "link": "https://stackoverflow.com/users/2300597/peter-petrov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468854365, "creation_date": 1468853433, "question_id": 38439795, "link": "https://stackoverflow.com/questions/38439795/go-bin-just-3-files", "title": "go bin - just 3 files", "body": "<p>I installed Go 1.6.2 on Windows but in my <code>bin</code> directory I now have only 3 files: </p>\n\n<pre><code> go.exe\n godoc.exe\n gofmt.exe \n</code></pre>\n\n<p>I wonder if that's normal or my installation didn't go quite well.    </p>\n"}, {"tags": ["http", "backbone.js", "go"], "answers": [{"comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1468927005, "post_id": 38456143, "comment_id": 64317940, "body": "Surely that can&#39;t be the reason as the code wouldn&#39;t compile with the typo... I suspect the OP doesn&#39;t post the actual code but some modified example he hasn&#39;t actually tested."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1468930355, "post_id": 38456143, "comment_id": 64320462, "body": "You are right, that must be the case. @Dev: Since the provided code is fine, can you edit your question to include a sample that reproduces the error?"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1468930364, "last_edit_date": 1468930364, "creation_date": 1468924722, "answer_id": 38456143, "question_id": 38439652, "link": "https://stackoverflow.com/questions/38439652/not-able-to-call-http-handlefunc-in-go/38456143#38456143", "title": "Not able to call http.HandleFunc in Go", "body": "<p>Actually your code is fine... that means almost fine. <code>fmt.println()</code> needs a capital \"P\":</p>\n\n<pre><code>func viewHandler(w http.ResponseWriter, r *http.Request) {\n     fmt.Println(\"in viewHandler\")\n}\n</code></pre>\n\n<p>When I test your code with this adjustment it prints \"in viewHandler\" to the terminal as expected.</p>\n"}], "owner": {"reputation": 59, "user_id": 4752563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32fcc64aca739b658f37655f5410fd33?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/4752563/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468930364, "creation_date": 1468853059, "last_edit_date": 1468884087, "question_id": 38439652, "link": "https://stackoverflow.com/questions/38439652/not-able-to-call-http-handlefunc-in-go", "title": "Not able to call http.HandleFunc in Go", "body": "<p>I am fairly new to Backbone and Go and trying to call a function depending on URL.</p>\n\n<p>This is my code in Router from where a request is going to a Go page.</p>\n\n<pre><code> collection.fetch({\n                url: \"/bands\"\n            })\n            .done(function(data) {\n                console.log(\"hello\");\n            });\n</code></pre>\n\n<p>This is my code in which I am handling all the request:</p>\n\n<pre><code>func viewHandler(w http.ResponseWriter, r *http.Request) {\n     fmt.println(\"in viewHandler\")\n}\n\nfunc main() {\n    http.Handle(\"/\", http.FileServer(http.Dir(\"../\")))\n    http.HandleFunc(\"/bands\", viewHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>In my Network tab the header is:</p>\n\n<pre><code>Request URL:http://localhost:8080/bands\nRequest Method:GET\nStatus Code:200 OK\nRemote Address:[::1]:8080\n</code></pre>\n\n<p>But nothing is getting printed on console since I guess <code>viewHandler</code> is not getting called. What is the reason for this?</p>\n"}, {"tags": ["go", "cross-compiling"], "answers": [{"tags": [], "owner": {"reputation": 1497, "user_id": 2716201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa113ebce9e4bd2034e26f88efe19aac?s=128&d=identicon&r=PG&f=1", "display_name": "chlunde", "link": "https://stackoverflow.com/users/2716201/chlunde"}, "is_accepted": true, "score": 1, "last_activity_date": 1468954921, "creation_date": 1468954921, "answer_id": 38466537, "question_id": 38439420, "link": "https://stackoverflow.com/questions/38439420/how-to-switch-select-what-code-to-use-while-doing-cross-compiling/38466537#38466537", "title": "how to switch/select what code to use while doing cross compiling", "body": "<p>Use <code>GOOS=linux go build</code></p>\n\n<p>Check out <a href=\"https://golang.org/cmd/go/#hdr-Environment_variables\" rel=\"nofollow\">https://golang.org/cmd/go/#hdr-Environment_variables</a> and <a href=\"http://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5\" rel=\"nofollow\">http://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5</a></p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 38466537, "answer_count": 1, "score": 2, "last_activity_date": 1468954921, "creation_date": 1468852478, "question_id": 38439420, "link": "https://stackoverflow.com/questions/38439420/how-to-switch-select-what-code-to-use-while-doing-cross-compiling", "title": "how to switch/select what code to use while doing cross compiling", "body": "<p>I am using the <code>+build</code> tag to define what to compile based on the architecture. </p>\n\n<p>For code that only runs on UNIX/BSD I use this:</p>\n\n<pre><code>// +build freebsd netbsd openbsd dragonfly darwin \n// +build amd64\n</code></pre>\n\n<p>And for linux I have:</p>\n\n<pre><code>// +build linux\n</code></pre>\n\n<p>The name of the files containing the source code is like this:</p>\n\n<pre><code>watchpid.go\nwatchpid_linux.go\n</code></pre>\n\n<p>The files contains the same method signature but different approaches.</p>\n\n<pre><code>func watchPid() {\n  // kqueue for UNIX, BSD\n  // for loop cross-platform version (linux)\n}\n</code></pre>\n\n<p>In case I would like to test/compile for example the linux version on a Mac OS X, is there a easy switch/trick to do it instead of editing the <code>+build</code> tag  or renaming the files?</p>\n"}, {"tags": ["go", "build", "compilation", "tags"], "comments": [{"owner": {"reputation": 442, "user_id": 3158232, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ol4CR.jpg?s=128&g=1", "display_name": "deankarn", "link": "https://stackoverflow.com/users/3158232/deankarn"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468853414, "post_id": 38439275, "comment_id": 64285226, "body": "Thanks, I searched around but didn&#39;t find anything; this is exactly what I was looking for. +1"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1468853843, "creation_date": 1468853843, "answer_id": 38439941, "question_id": 38439275, "link": "https://stackoverflow.com/questions/38439275/golang-build-tags-for-a-particular-go-version-possible/38439941#38439941", "title": "Golang build tags for a particular Go version possible?", "body": "<p>Put the code that depends on contexts in a file with the following build tag. This code is compiled for Go 1.7 and onward.</p>\n\n<pre><code>// +build go1.7\n</code></pre>\n\n<p>Put the backwards compatibility code in a file with the following build tag. This code is used for all versions of Go before 1.7.</p>\n\n<pre><code>// +build !go1.7\n</code></pre>\n"}], "owner": {"reputation": 442, "user_id": 3158232, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ol4CR.jpg?s=128&g=1", "display_name": "deankarn", "link": "https://stackoverflow.com/users/3158232/deankarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "closed_date": 1468894021, "accepted_answer_id": 38439941, "answer_count": 1, "score": 1, "last_activity_date": 1468853843, "creation_date": 1468852101, "question_id": 38439275, "link": "https://stackoverflow.com/questions/38439275/golang-build-tags-for-a-particular-go-version-possible", "closed_reason": "Duplicate", "title": "Golang build tags for a particular Go version possible?", "body": "<p>Using build tags alone is it possible to target a particular Go version in a file?</p>\n\n<p>// +build go1.7</p>\n\n<p>eg. with the adding of golang.org/x/net/context to the standard lib, I have some code that I want to update to use the std lib context ( when it's released ) but be able to maintain backward compatibility for those that have not yet updated.</p>\n\n<p>I know there are many ways to control this including the branch name and go get, just wondering if there's a way using build tags.</p>\n\n<p>Thanks in Advance.</p>\n"}, {"tags": ["go", "blockchain", "hyperledger"], "answers": [{"tags": [], "owner": {"reputation": 4021, "user_id": 2813306, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a343ee677e1adf016a8934c0dfd15b87?s=128&d=identicon&r=PG&f=1", "display_name": "Davis Broda", "link": "https://stackoverflow.com/users/2813306/davis-broda"}, "is_accepted": true, "score": 0, "last_activity_date": 1468864779, "creation_date": 1468864779, "answer_id": 38443167, "question_id": 38439015, "link": "https://stackoverflow.com/questions/38439015/passing-queries-between-chaincodes-with-privacy-enabled/38443167#38443167", "title": "Passing queries between chaincodes with privacy enabled", "body": "<p>It appears that this is a known issue with hyperledger, that is being worked on. As such there is no current workaround, but there will likely be one in the future when this issue is dealt with. </p>\n\n<p><a href=\"https://github.com/hyperledger/fabric/issues/905\" rel=\"nofollow\">Relevent Issue</a></p>\n"}], "owner": {"reputation": 4021, "user_id": 2813306, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a343ee677e1adf016a8934c0dfd15b87?s=128&d=identicon&r=PG&f=1", "display_name": "Davis Broda", "link": "https://stackoverflow.com/users/2813306/davis-broda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 38443167, "answer_count": 1, "score": 0, "last_activity_date": 1468864779, "creation_date": 1468851349, "question_id": 38439015, "link": "https://stackoverflow.com/questions/38439015/passing-queries-between-chaincodes-with-privacy-enabled", "title": "Passing queries between chaincodes with privacy enabled", "body": "<p>I have two chaincodes - let's call them A and B - and I am trying to get A to invoke a method on B, in a setup that has privacy enabled. An example of the sort of call I'm trying to make is shown below. </p>\n\n<pre><code>func (e *ChaincodeA) someFuncOnChaincodeA(stub *shim.ChaincodeStub, args []string) ([]byte, error) {\n\n    //Do stuff\n\n    newArgs := []string{\"somevalue1\",\"somevalue2\"}\n\n    msg, err := stub.InvokeChaincode(chaincodeBName,\"someFuncOnChaincodeB\",args)\n\n    if err != nil{\n        fmt.Println(err.Error())\n    }\n\n    return msg, err\n}\n</code></pre>\n\n<p>However, whenever I try to run this, it gives me the following error messages before killing my chaincode:</p>\n\n<blockquote>\n  <p>[72047168]Error chaincode-chaincode interactions not supported for\n  with privacy enabled. </p>\n  \n  <p>Sending ERROR Error starting Simple chaincode:\n  Error handling message:\n  [72047168-5f5a-4017-862a-1329660e2076]Chaincode handler FSM cannot\n  handle message (COMPLETED) with payload size (0) while in state: ready</p>\n  \n  <p>Process finished with exit code 0</p>\n</blockquote>\n\n<p>Evidently privacy interferes with chaincode-chaincode communications. Is there any way around this, to enable communications while maintaining privacy? Or is it a best-practice to put absolutely everything into a single gigantic chaincode?</p>\n\n<p>Additionally, why does privacy interfere with chaincode-chaincode communications? I don't understand exactly why this occurs. </p>\n"}, {"tags": ["go", "garbage-collection", "mmap"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1468851363, "post_id": 38438951, "comment_id": 64283648, "body": "The GC has no knowledge of manually allocated memory. I&#39;m not sure what you&#39;r expecting from your example."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468851877, "post_id": 38438951, "comment_id": 64284043, "body": "I&#39;m expecting it to not behave correctly because the memory pointed to by <code>m</code> (and hence <code>m2</code>) is freed by <code>Munmap()</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1468852007, "post_id": 38438951, "comment_id": 64284139, "body": "Yes, this will segfault. Did you try running an example? It doesn&#39;t have anything to do with garbage collection, it&#39;s simply accessing memory that&#39;s been freed."}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468851137, "creation_date": 1468851137, "question_id": 38438951, "link": "https://stackoverflow.com/questions/38438951/how-does-mmap-interract-with-gos-garbage-collector", "title": "How does mmap interract with Go&#39;s garbage collector?", "body": "<p>Go has a garbage collector for slices that only frees the slice when all references to it are dead. It also has an <a href=\"https://golang.org/pkg/syscall/#Mmap\" rel=\"nofollow\">Mmap function</a> that returns a <code>[]byte</code> that can be explicitly freed with <code>Munmap()</code>. So how does this work with Go's garbage collector.</p>\n\n<p>What happens if I do this?</p>\n\n<pre><code>m := syscall.Mmap(...)\nm2 = m[10:100]\nsyscall.Munmap(m)\na = m2[0]\n</code></pre>\n"}, {"tags": ["image", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1475884598, "last_edit_date": 1475884598, "creation_date": 1468850725, "answer_id": 38438807, "question_id": 38438444, "link": "https://stackoverflow.com/questions/38438444/golang-convert-raw-image-byte-to-image-image/38438807#38438807", "title": "Golang convert raw image []byte to image.Image", "body": "<p>The <a href=\"https://golang.org/pkg/image/\" rel=\"noreferrer\"><code>image</code></a> package has several implementations of the <a href=\"https://golang.org/pkg/image/#Image\" rel=\"noreferrer\"><code>image.Image</code></a> interface.</p>\n\n<p>If you can find an implementation which models the pixels just as you have it, you don't need to do anything just use that implementation.</p>\n\n<p>For example the <code>image</code> package has an <a href=\"https://golang.org/pkg/image/#Gray\" rel=\"noreferrer\"><code>image.Gray</code></a> type which implements <code>image.Image</code> and it models the pixels with one byte being  an 8-bit grayscale color.</p>\n\n<p>So if you have exactly this, simply create a value of <code>image.Gray</code> and \"tell it\" to use your <code>pixels</code>:</p>\n\n<pre><code>pixels := make([]byte, 100*100) // slice of your gray pixels, size of 100x100\n\nimg := image.NewGray(image.Rect(0, 0, 100, 100))\nimg.Pix = pixels\n</code></pre>\n\n<p><strong>Note #1:</strong></p>\n\n<p>Note that I used <a href=\"https://golang.org/pkg/image/#NewGray\" rel=\"noreferrer\"><code>image.NewGray()</code></a> which returns you an initialized value of <code>image.Gray</code>, so we only needed to set / change the pixels slice. Since <code>image.Gray</code> is a struct with exported fields, we could also create it by manually initializing all its fields:</p>\n\n<pre><code>img := &amp;image.Gray{Pix: pixels, Stride: 100, Rect: image.Rect(0, 0, 100, 100)}\n</code></pre>\n\n<p>(Note that I used a pointer because only <code>*image.Gray</code> implements <code>image.Image</code> as methods are defined with pointer receiver. <code>image.NewGray()</code> also returns a pointer.)</p>\n\n<p><strong>Note #2:</strong></p>\n\n<p>In our examples we set the <code>pixels</code> slice to be used by the image. The image is now bound to this slice. If we change anything in it, the pixel returned by <code>Image.At()</code> will also change (they use the same source). If you don't want this, you may copy the pixels to the <code>Gray.Pix</code> slice like this:</p>\n\n<pre><code>img := image.NewGray(image.Rect(0, 0, 100, 100))\ncopy(img.Pix, pixels)\n</code></pre>\n\n<p>Try these examples on the <a href=\"https://play.golang.org/p/JUvZYVnYAB\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6515, "favorite_count": 2, "accepted_answer_id": 38438807, "answer_count": 1, "score": 9, "last_activity_date": 1475884598, "creation_date": 1468849730, "question_id": 38438444, "link": "https://stackoverflow.com/questions/38438444/golang-convert-raw-image-byte-to-image-image", "title": "Golang convert raw image []byte to image.Image", "body": "<p>Suppose I have an 8-bit grayscale image like this:</p>\n\n<pre><code>var pixels []byte = ...\nwidth := 100\nheight := 100\n</code></pre>\n\n<p>How do I convert that into something that implements <a href=\"https://golang.org/pkg/image/#Image\" rel=\"noreferrer\"><code>image.Image</code></a>?</p>\n"}, {"tags": ["json", "templates", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 14, "last_activity_date": 1502939565, "last_edit_date": 1502939565, "creation_date": 1468846068, "answer_id": 38437140, "question_id": 38436854, "link": "https://stackoverflow.com/questions/38436854/golang-use-json-in-template-directly/38437140#38437140", "title": "Golang use json in template directly", "body": "<p>You can use <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"noreferrer\"><code>json.Unmarshal()</code></a> to unmarshal a JSON text into a Go value.</p>\n\n<p>And you can simply use a Go type <code>interface{}</code> to represent any arbitrary JSON value. Usually if it is a struct, <code>map[string]interface{}</code> is used and is more useful if you need to refer to values stored in it in Go code too (but this can't represent an array for example).</p>\n\n<p><a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"noreferrer\"><code>template.Execute()</code></a> and <a href=\"https://golang.org/pkg/html/template/#Template.ExecuteTemplate\" rel=\"noreferrer\"><code>template.ExecuteTemplate()</code></a> take the data / parameters of the template as a value of type <code>interface{}</code> to which you can pass anything in Go. And the <code>template</code> engine uses reflection (<a href=\"https://golang.org/pkg/reflect/\" rel=\"noreferrer\"><code>reflect</code></a> package) to \"discover\" its runtime type and navigate in it based on the selectors you provide in the template actions (which may designate fields of structs or keys in maps, or even method names).</p>\n\n<p>Beyond that, everything works as expected. See this example:</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Parse(templ))\n\n    m := map[string]interface{}{}\n    if err := json.Unmarshal([]byte(jsondata), &amp;m); err != nil {\n        panic(err)\n    }\n\n    if err := t.Execute(os.Stdout, m); err != nil {\n        panic(err)\n    }\n}\n\nconst templ = `&lt;html&gt;&lt;body&gt;\n    Value of a: {{.something.a}}\n    Something else: {{.somethingElse}}\n&lt;/body&gt;&lt;/html&gt;`\n\nconst jsondata = `{\"something\":{\"a\":\"valueofa\"}, \"somethingElse\": [1234, 5678]}`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/lM72bpbRso\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;\n    Value of a: valueofa\n    Something else: [1234 5678]\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 1526, "user_id": 2446374, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/Jlm82.jpg?s=128&g=1", "display_name": "Darren Oakey", "link": "https://stackoverflow.com/users/2446374/darren-oakey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14602, "favorite_count": 7, "accepted_answer_id": 38437140, "answer_count": 1, "score": 9, "last_activity_date": 1560267656, "creation_date": 1468845308, "last_edit_date": 1560267656, "question_id": 38436854, "link": "https://stackoverflow.com/questions/38436854/golang-use-json-in-template-directly", "title": "Golang use json in template directly", "body": "<p>I'm looking for a way of binding json data directly into a template (without any struct representation in golang) - and I'm coming up short.   Essentially, what I want is to have both template document and json to be just arbitrary data - and my handleFunc to essentially be:</p>\n\n<pre><code>func handler(writer http.ResponseWriter, request *http.Request) {\n    t, _ := template.ParseFiles( \"someTemplate.html\" )\n    rawJson, _ := ioutil.ReadFile( \"someData.json\" )\n\n    // here's where I need help\n    somethingTemplateUnderstands := ????( rawJson )\n\n    t.Execute( writer, somethingTemplateUnderstands )\n}\n</code></pre>\n\n<p>I've tried json.Unmarshal, but it seems to want a type.   The main thing is, in the actual program both the json and the template come from the database and are completely changeable at runtime, (and there are lots of different ones) so I can't encode any structure in the go program itself.   And obviously, I want to be able to make data like:</p>\n\n<pre><code>{ \"something\" : { \"a\" : \"whatever\" }}\n</code></pre>\n\n<p>and then a template like</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;\n    the value is {{ .something.a }}\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>Is this possible with the go http.template library, or do I need to go off to Node (or find another templating library?)</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1468844776, "post_id": 38436584, "comment_id": 64278796, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/30867337/golang-order-by-issue-with-mysql\">Golang ORDER BY issue with MySql</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1468846384, "last_edit_date": 1495539850, "creation_date": 1468846384, "answer_id": 38437216, "question_id": 38436584, "link": "https://stackoverflow.com/questions/38436584/postgres-prepare-query-columns-as-variable/38437216#38437216", "title": "postgres prepare query, columns as variable", "body": "<p>You are ignoring the error of the <code>Database.Prepare</code> statement. If you check the error you will realise, that it fails preparing the sql. The reason why it fails was already answered here by <a href=\"https://stackoverflow.com/users/1705598/icza\">icza</a>:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30867337/golang-order-by-issue-with-mysql\">Golang ORDER BY issue with MySql</a></p>\n"}, {"tags": [], "owner": {"reputation": 1214, "user_id": 5335287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uEvh1ZM7ni0/AAAAAAAAAAI/AAAAAAAADyY/DTG6CSTF2ps/photo.jpg?sz=128", "display_name": "R&#233;my  Baron", "link": "https://stackoverflow.com/users/5335287/r%c3%a9my-baron"}, "is_accepted": false, "score": 0, "last_activity_date": 1468849179, "creation_date": 1468849179, "answer_id": 38438249, "question_id": 38436584, "link": "https://stackoverflow.com/questions/38436584/postgres-prepare-query-columns-as-variable/38438249#38438249", "title": "postgres prepare query, columns as variable", "body": "<p>Effectively , you can't use variable as field name in a query , you have to pass by a dynamic query.</p>\n\n<p>Try creating a function :</p>\n\n<pre><code> CREATE OR REPLACE FUNCTION getFieldFromUserById(field_name character varying, id_user integer)\n   RETURNS SETOF character varying AS\n   $BODY$begin\n      return query execute 'SELECT '||field_name||' FROM users  WHERE nart='||id_user||' LIMIT 1';\nend\n$BODY$\nLANGUAGE plpgsql VOLATILE\n</code></pre>\n\n<p>and your code :</p>\n\n<pre><code>var SelectUser, _ = Database.Prepare(\"SELECT getFieldFromUserById($1,$2 );\")\nvar name string\nSelectUser.QueryRow(\"name\", 1).Scan(&amp;name)\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6169066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/73fd9b8daaf440e6f6a3da6dda6184a6?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Baranov", "link": "https://stackoverflow.com/users/6169066/oleg-baranov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 38437216, "answer_count": 2, "score": 1, "last_activity_date": 1468849179, "creation_date": 1468844402, "question_id": 38436584, "link": "https://stackoverflow.com/questions/38436584/postgres-prepare-query-columns-as-variable", "title": "postgres prepare query, columns as variable", "body": "<pre><code>    var SelectUser, _ = Database.Prepare(\"SELECT $1 FROM users WHERE id=$2 LIMIT 1;\")\n    var name string\n    SelectUser.QueryRow(\"name\", 1).Scan(&amp;name)\n</code></pre>\n\n<p>If i do like that i got an error:</p>\n\n<blockquote>\n  <p>runtime error: invalid memory address or nil pointer dereference</p>\n</blockquote>\n\n<p>But if column is not variable, all ok.</p>\n\n<pre><code>var SelectUser, _ = Database.Prepare(\"SELECT name FROM users WHERE id=$1 LIMIT 1;\")\nvar name string\nSelectUser.QueryRow(1).Scan(&amp;name)\n</code></pre>\n\n<p>How can I pass columns as variables?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 2, "creation_date": 1468842318, "post_id": 38435810, "comment_id": 64277096, "body": "<a href=\"https://golang.org/doc/effective_go.html#maps\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#maps</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 5, "last_activity_date": 1468843821, "creation_date": 1468843821, "answer_id": 38436364, "question_id": 38435810, "link": "https://stackoverflow.com/questions/38435810/go-checking-if-key-of-one-map-present-in-another/38436364#38436364", "title": "go - checking if key of one map present in another", "body": "<p>You can either use the go idiomatic way to check for a key presence:</p>\n\n<pre><code>if _, ok:= b[key]; ok\n</code></pre>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>var (\n    a = map[string]int{\n        \"alpha\": 34, \"bravo\": 56, \"charlie\": 23,\n        \"delta\": 87, \"echo\": 56, \"foxtrot\": 12, \"golf\": 34, \"hotel\": 16,\n        \"indio\": 87, \"juliet\": 65, \"kilo\": 43, \"lima\": 98}\n\n    b = map[string]int{\n        \"alpha\": 34, \"one\": 56, \"charlie\": 23,\n        \"insdio\": 87, \"julietta\": 65, \"kilo\": 43, \"lima\": 98}\n)\n\nfunc main() {\n    for key, _ := range a {\n        if _, ok:= b[key]; ok {         \n            fmt.Printf(\"%s\\n\", key)\n        }\n    }   \n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/qCq5_zn7Fd\" rel=\"noreferrer\">Playground Example 1</a></p>\n\n<p>Or you can check if the key value from the first map corresponds to the value from the second map:</p>\n\n<pre><code>for key, val := range a {\n    if val == b[key] {          \n        fmt.Printf(\"%s\\n\", key)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/tf95-qcRAW\" rel=\"noreferrer\">Playground Example 2</a></p>\n\n<p>But the first one is the idiomatic way.</p>\n"}], "owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10270, "favorite_count": 2, "closed_date": 1468845554, "accepted_answer_id": 38436364, "answer_count": 1, "score": 0, "last_activity_date": 1468843821, "creation_date": 1468842012, "last_edit_date": 1468843283, "question_id": 38435810, "link": "https://stackoverflow.com/questions/38435810/go-checking-if-key-of-one-map-present-in-another", "closed_reason": "Duplicate", "title": "go - checking if key of one map present in another", "body": "<p>I have one dictionary</p>\n\n<pre><code>a = {1:11, 2:22}\n</code></pre>\n\n<p>I want to check if key in <code>b</code> is present in <code>a</code> or not</p>\n\n<pre><code>b = {3:33, 1:11}\n</code></pre>\n\n<p>How can I do this in Go language?</p>\n\n<p>I have done it like this:</p>\n\n<pre><code>a:= make(map[string][]string)\na[\"1\"] = append(a[\"1\"], \"11\")\na[\"1\"] = append(a[\"1\"], \"22\")\n</code></pre>\n\n<p>I have a dict <code>b</code> as:</p>\n\n<pre><code>b:= make(map[string]string)\nb[\"1\"] = \"11\"\n</code></pre>\n\n<p>How can I check this? Essentially, I want to check if key <code>1</code> from <code>b</code> is present in <code>a</code> or not.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 4, "creation_date": 1468841289, "post_id": 38435527, "comment_id": 64276415, "body": "<a href=\"http://stackoverflow.com/questions/12677934/create-a-golang-map-of-lists\" title=\"create a golang map of lists\">stackoverflow.com/questions/12677934/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 5, "last_activity_date": 1468841758, "creation_date": 1468841758, "answer_id": 38435726, "question_id": 38435527, "link": "https://stackoverflow.com/questions/38435527/go-creating-dictionary-with-values-as-list/38435726#38435726", "title": "go - creating dictionary with values as list", "body": "<p>You can create a map of string to slice of strings:</p>\n\n<pre><code>func main() {\n\n    m := make(map[string][]string)\n\n    // Each string in the m maps to a string slice\n    m[\"A\"] = []string{\"1\", \"2\"}\n    m[\"B\"] = []string{\"3\", \"4\"}\n    fmt.Println(m[\"A\"])\n\n    // Adding to the list of a particular key\n    m[\"A\"] = append(m[\"A\"], \"10\")\n\n    // Creating a new key can be done similarly\n    m[\"C\"] = append(m[\"C\"], \"100\")\n\n    fmt.Printf(\"%+v\\n\", m)\n\n    fmt.Printf(\"m[\\\"C\\\"] = %#v\\n\", m[\"C\"]) // m[\"C\"] = []string{\"100\"}\n}\n</code></pre>\n"}], "owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2270, "favorite_count": 0, "closed_date": 1468845493, "answer_count": 1, "score": 2, "last_activity_date": 1468841758, "creation_date": 1468841157, "question_id": 38435527, "link": "https://stackoverflow.com/questions/38435527/go-creating-dictionary-with-values-as-list", "closed_reason": "Duplicate", "title": "go - creating dictionary with values as list", "body": "<p>I want to create dict in go language, but its value contains lists</p>\n\n<pre><code>dict= {\n\"A\" : [\"1\", \"2\"],\n\"B\" : [\"3\", \"4\"]\n}\n</code></pre>\n\n<p>How can we create the same in go?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1468840487, "post_id": 38435247, "comment_id": 64275881, "body": "(ABCD) ............"}, {"owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "reply_to_user": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1468840528, "post_id": 38435247, "comment_id": 64275917, "body": "but ABCD can be anything. its name it can vary"}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 3185654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/33cod.jpg?s=128&g=1", "display_name": "Twizty", "link": "https://stackoverflow.com/users/3185654/twizty"}, "is_accepted": false, "score": 3, "last_activity_date": 1468842202, "creation_date": 1468842202, "answer_id": 38435872, "question_id": 38435247, "link": "https://stackoverflow.com/questions/38435247/go-regex-operations/38435872#38435872", "title": "Go - Regex operations", "body": "<p>I think what you need is <a href=\"https://golang.org/pkg/regexp/#Regexp.FindAllString\" rel=\"nofollow\">Regexp.FindAllString</a></p>\n"}], "owner": {"reputation": 15260, "user_id": 778942, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f98033f7f2031b092d5ff33d0f32c9da?s=128&d=identicon&r=PG", "display_name": "sam", "link": "https://stackoverflow.com/users/778942/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1468845067, "creation_date": 1468840368, "last_edit_date": 1468845067, "question_id": 38435247, "link": "https://stackoverflow.com/questions/38435247/go-regex-operations", "title": "Go - Regex operations", "body": "<p>My string is : </p>\n\n<pre><code>First Name: ABCD\n</code></pre>\n\n<p>I want following string to be captured.</p>\n\n<pre><code>ABCD\n</code></pre>\n\n<p>How can I achieve it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468840587, "post_id": 38435091, "comment_id": 64275954, "body": "What do you mean by the &quot;only way&quot;? What other ways are you expecting?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468840638, "post_id": 38435091, "comment_id": 64275992, "body": "@icza: not to copy all std lib."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468840783, "post_id": 38435091, "comment_id": 64276092, "body": "You can&#39;t define methods for types in other packages. A code can only define methods for types being in the same package."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468840849, "post_id": 38435091, "comment_id": 64276138, "body": "@icza: so this is the only way, isn&#39;t it?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468840956, "post_id": 38435091, "comment_id": 64276208, "body": "Yes. <i>(padding...)</i>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1468841375, "last_edit_date": 1468841375, "creation_date": 1468841062, "answer_id": 38435486, "question_id": 38435091, "link": "https://stackoverflow.com/questions/38435091/how-to-extend-standard-golang-unexported-struct-type/38435486#38435486", "title": "How to extend standard Golang unexported struct type?", "body": "<p>You can't define methods for types in other packages. A code can only define methods for types being in the same package.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow\">Spec: Method declarations:</a></p>\n\n<blockquote>\n  <p>The type denoted by <code>T</code> is called the receiver <em>base type</em>; it must not be a pointer or interface type and <strong>it must be declared in the same package as the method</strong>.</p>\n</blockquote>\n\n<p>So there is no other way to extend the unexported type <code>io.multiWriter</code> with methods other than copy its full code and add the methods to your own type.</p>\n\n<p><strong>Note:</strong> As an implementation note, in your <code>multiWriter.Remove()</code> method once you find the removable writer, after reslicing you can \"break\" (from the inner loop) to omit the rest of the slice:</p>\n\n<pre><code>// ...\nif t.writers[i] == v {\n    t.writers = append(t.writers[:i], t.writers[i+1:]...)\n    break\n}\n// ...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 0, "accepted_answer_id": 38435486, "answer_count": 1, "score": 2, "last_activity_date": 1468841796, "creation_date": 1468839860, "last_edit_date": 1468841796, "question_id": 38435091, "link": "https://stackoverflow.com/questions/38435091/how-to-extend-standard-golang-unexported-struct-type", "title": "How to extend standard Golang unexported struct type?", "body": "<p>consider this working sample code, which extends (not exactly) the   </p>\n\n<pre><code>type multiWriter struct {\n    writers []Writer\n}\n</code></pre>\n\n<p>from <code>io</code> package, to add just two methods named <code>Remove</code> and <code>Append</code> to manipulate internal slice <code>writers</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"os\"\n)\n\nfunc main() {\n    w1, e := os.Create(\"file1.txt\")\n    if e != nil {\n        panic(e)\n    }\n    w2, e := os.Create(\"file2.txt\")\n    if e != nil {\n        panic(e)\n    }\n    mw := MultiWriter(w1, w2)\n    data := []byte(\"Hello \")\n    _, e = mw.Write(data)\n    if e != nil {\n        panic(e)\n    }\n\n    var m *multiWriter = mw.(*multiWriter)\n    m.Remove(w2)\n    w2.Close()\n    w3, e := os.Create(\"file3.txt\")\n    if e != nil {\n        panic(e)\n    }\n    m.Append(w3)\n    data = []byte(\"World \")\n    _, e = mw.Write(data)\n    if e != nil {\n        panic(e)\n    }\n    w3.Close()\n    w1.Close()\n}\nfunc (t *multiWriter) Remove(writers ...io.Writer) {\n    for i := len(t.writers) - 1; i &gt; 0; i-- {\n        for _, v := range writers {\n            if t.writers[i] == v {\n                t.writers = append(t.writers[:i], t.writers[i+1:]...)\n                break\n            }\n        }\n    }\n}\nfunc (t *multiWriter) Append(writers ...io.Writer) {\n    t.writers = append(t.writers, writers...)\n}\n\ntype multiWriter struct {\n    writers []io.Writer\n}\n\nfunc (t *multiWriter) Write(p []byte) (n int, err error) {\n    for _, w := range t.writers {\n        n, err = w.Write(p)\n        if err != nil {\n            return\n        }\n        if n != len(p) {\n            err = io.ErrShortWrite\n            return\n        }\n    }\n    return len(p), nil\n}\n\nvar _ stringWriter = (*multiWriter)(nil)\n\nfunc (t *multiWriter) WriteString(s string) (n int, err error) {\n    var p []byte // lazily initialized if/when needed\n    for _, w := range t.writers {\n        if sw, ok := w.(stringWriter); ok {\n            n, err = sw.WriteString(s)\n        } else {\n            if p == nil {\n                p = []byte(s)\n            }\n            n, err = w.Write(p)\n        }\n        if err != nil {\n            return\n        }\n        if n != len(s) {\n            err = io.ErrShortWrite\n            return\n        }\n    }\n    return len(s), nil\n}\n\n// MultiWriter creates a writer that duplicates its writes to all the\n// provided writers, similar to the Unix tee(1) command.\nfunc MultiWriter(writers ...io.Writer) io.Writer {\n    w := make([]io.Writer, len(writers))\n    copy(w, writers)\n    return &amp;multiWriter{w}\n}\n\n// stringWriter is the interface that wraps the WriteString method.\ntype stringWriter interface {\n    WriteString(s string) (n int, err error)\n}\n</code></pre>\n\n<p>is there any concise way to do this, to add just two methods named <code>Remove</code> and <code>Append</code> to <code>io.MultiWriter</code>?   </p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468825882, "post_id": 38430186, "comment_id": 64267138, "body": "When you do a write (either in case 1 or 2), do you want to write just a single <code>int</code> value from the channel, or you want to write the full content of the channel (to empty its buffer)?"}, {"owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468825975, "post_id": 38430186, "comment_id": 64267184, "body": "Ah thanks for asking. I want to write the full contents i.e. empty its buffer."}], "answers": [{"comments": [{"owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "edited": false, "score": 0, "creation_date": 1468827164, "post_id": 38430834, "comment_id": 64267837, "body": "If data enters <code>ch</code> at one int every 2 seconds, then the first case will be executed 5 times (total 10s). But we need to write every five seconds."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "edited": false, "score": 0, "creation_date": 1468827344, "post_id": 38430834, "comment_id": 64267916, "body": "@VarunPatro If data enters <code>ch</code> in every 2 seconds, yes, first case will be executed in every 2 seconds, <b>but write will not happen</b> only if buffer of <code>chInternal</code> is full (see the <code>if</code> statement), but it won&#39;t be full, so the first write will only happen after 5 seconds (as it should) when <code>timer</code> fires."}, {"owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "edited": false, "score": 0, "creation_date": 1468829713, "post_id": 38430834, "comment_id": 64269163, "body": "Thanks @icza! Looks really comprehensive including the doWrite method (didn&#39;t think of using default..)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "edited": false, "score": 0, "creation_date": 1468832574, "post_id": 38430834, "comment_id": 64270747, "body": "@VarunPatro Added alternatives how to improve it. You may even replace the 2nd channel with a slice, that way the <code>doWrite()</code> function also becomes simpler."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1468838833, "last_edit_date": 1468838833, "creation_date": 1468826758, "answer_id": 38430834, "question_id": 38430186, "link": "https://stackoverflow.com/questions/38430186/selecting-between-time-interval-and-length-of-channel/38430834#38430834", "title": "Selecting between time interval and length of channel", "body": "<p>There is no such \"event\" as <em>\"buffer of channel is full\"</em>, so you can't detect that [*]. This means you can't idiomatically solve your problem with language primitives using only 1 channel.</p>\n\n<p><sup>[*] Not entirely true: you could detect if the buffer of a channel is full by using <code>select</code> with <code>default</code> case when <em>sending</em> on the channel, but that requires logic from the senders, and repetitive attempts to send.</sup></p>\n\n<p>I would use another channel from which I would receive as values are sent on it, and \"redirect\", store the values in another channel which has a buffer of 100 as you mentioned. At each redirection you may check if the internal channel's buffer is full, and if so, do an immediate write. If not, continue to monitor the \"incoming\" channel and a timer channel with a <code>select</code> statement, and if the timer fires, do a \"regular\" write.</p>\n\n<p>You may use <code>len(chInternal)</code> to check how many elements are in the <code>chInternal</code> channel, and <code>cap(chInternal)</code> to check its capacity. Note that this is \"safe\" as we are the only goroutine handling the <code>chInternal</code> channel. If there would be multiple goroutines, value returned by <code>len(chInternal)</code> could be outdated by the time we use it to something (e.g. comparing it).</p>\n\n<p>In this solution <code>chInternal</code> (as its name says) is for internal use only. Others should only send values on <code>ch</code>. Note that <code>ch</code> may or may not be a buffered channel, solution works in both cases. However, you may improve efficiency if you also give some buffer to <code>ch</code> (so chances that senders get blocked will be lower).</p>\n\n<pre><code>var (\n    chInternal = make(chan int, 100)\n    ch         = make(chan int) // You may (should) make this a buffered channel too\n)\n\nfunc main() {\n    delay := time.Second * 5\n    timer := time.NewTimer(delay)\n    for {\n        select {\n        case v := &lt;-ch:\n            chInternal &lt;- v\n            if len(chInternal) == cap(chInternal) {\n                doWrite() // Buffer is full, we need to write immediately\n                timer.Reset(delay)\n            }\n        case &lt;-timer.C:\n            doWrite() // \"Regular\" write: 5 seconds have passed since last write\n            timer.Reset(delay)\n        }\n    }\n}\n</code></pre>\n\n<p>If an immediate write happens (due to a \"buffer full\" situation), this solution will time the next \"regular\" write 5 seconds after this. If you don't want this and you want the 5-second regular writes be independent from the immediate writes, simply do not reset the timer following the immediate write.</p>\n\n<p>An implementation of <code>doWrite()</code> may be as follows:</p>\n\n<pre><code>var f *os.File // Make sure to open file for writing\n\nfunc doWrite() {\n    for {\n        select {\n        case v := &lt;-chInternal:\n            fmt.Fprintf(f, \"%d \", v) // Write v to the file\n        default: // Stop when no more values in chInternal\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>We can't use <code>for ... range</code> as that only returns when the channel is closed, but our <code>chInternal</code> channel is not closed. So we use a <code>select</code> with a <code>default</code> case so when no more values are in the buffer of <code>chInternal</code>, we return.</p>\n\n<h2>Improvements</h2>\n\n<h3>Using a slice instead of 2nd channel</h3>\n\n<p>Since the <code>chInternal</code> channel is only used by us, and only on a single goroutine, we may also choose to use a single <code>[]int</code> slice instead of a channel (reading/writing a slice is much faster than a channel).</p>\n\n<p>Showing only the different / changed parts, it could look something like this:</p>\n\n<pre><code>var (\n    buf = make([]int, 0, 100)\n)\n\nfunc main() {\n    // ...\n\n    for {\n        select {\n        case v := &lt;-ch:\n            buf = append(buf, v)\n            if len(buf) == cap(buf) {\n            // ...\n    }\n}\n\nfunc doWrite() {\n    for _, v := range buf {\n        fmt.Fprintf(f, \"%d \", v) // Write v to the file\n    }\n    buf = buf[:0] // \"Clear\" the buffer\n}\n</code></pre>\n\n<h3>With multiple goroutines</h3>\n\n<p>If we stick to leave <code>chInternal</code> a channel, the <code>doWrite()</code> function may be called on another goroutine to not block the other one, e.g. <code>go doWrite()</code>. Since data to write is read from a channel (<code>chInternal</code>), this requires no further synchronization.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1468836333, "last_edit_date": 1468836333, "creation_date": 1468829192, "answer_id": 38431541, "question_id": 38430186, "link": "https://stackoverflow.com/questions/38430186/selecting-between-time-interval-and-length-of-channel/38431541#38431541", "title": "Selecting between time interval and length of channel", "body": "<p>if you just use 5 seconds write, to increase the file write performance,<br>\nyou may fill the channel any time you need,<br>\nthen writer goroutine writes that data to the buffered file,<br>\nsee this very simple and idiomatic sample without using timer<br>\nwith <strong>just using for...range</strong>:  </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc WriteToFile(filename string, ch chan int) {\n    f, e := os.Create(filename)\n    if e != nil {\n        panic(e)\n    }\n    w := bufio.NewWriterSize(f, 4*1024*1024)\n    defer wg.Done()\n    defer f.Close()\n    defer w.Flush()\n    for v := range ch {\n        fmt.Fprintf(w, \"%d \", v)\n    }\n}\n\nfunc main() {\n    ch := make(chan int, 100)\n    wg.Add(1)\n    go WriteToFile(\"file.txt\", ch)\n\n    for i := 0; i &lt; 500000; i++ {\n        ch &lt;- i // do the job\n    }\n    close(ch) // Finish the job and close output file\n    wg.Wait()\n}\n</code></pre>\n\n<p>and notice the <code>defer</code>s order.  </p>\n\n<p>and in case of 5 seconds write, you may add one interval timer just to flush the buffer of this file to the disk, like this:  </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"sync\"\n    \"time\"\n)\n\nvar wg sync.WaitGroup\n\nfunc WriteToFile(filename string, ch chan int) {\n    f, e := os.Create(filename)\n    if e != nil {\n        panic(e)\n    }\n    w := bufio.NewWriterSize(f, 4*1024*1024)\n\n    ticker := time.NewTicker(5 * time.Second)\n    quit := make(chan struct{})\n    go func() {\n        for {\n            select {\n            case &lt;-ticker.C:\n                if w.Buffered() &gt; 0 {\n                    fmt.Println(w.Buffered())\n                    w.Flush()\n                }\n            case &lt;-quit:\n                ticker.Stop()\n                return\n            }\n        }\n    }()\n\n    defer wg.Done()\n    defer f.Close()\n    defer w.Flush()\n    defer close(quit)\n    for v := range ch {\n        fmt.Fprintf(w, \"%d \", v)\n    }\n}\n\nfunc main() {\n    ch := make(chan int, 100)\n    wg.Add(1)\n    go WriteToFile(\"file.txt\", ch)\n\n    for i := 0; i &lt; 25; i++ {\n        ch &lt;- i // do the job\n        time.Sleep(500 * time.Millisecond)\n    }\n    close(ch) // Finish the job and close output file\n    wg.Wait()\n}\n</code></pre>\n\n<p>here I used <code>time.NewTicker(5 * time.Second)</code> for interval timer with <code>quit</code> channel, you may use <code>time.AfterFunc()</code> or <code>time.Tick()</code> or <code>time.Sleep()</code>.</p>\n\n<p>with some optimizations ( removing quit channel):  </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"sync\"\n    \"time\"\n)\n\nvar wg sync.WaitGroup\n\nfunc WriteToFile(filename string, ch chan int) {\n    f, e := os.Create(filename)\n    if e != nil {\n        panic(e)\n    }\n    w := bufio.NewWriterSize(f, 4*1024*1024)\n    ticker := time.NewTicker(5 * time.Second)\n    defer wg.Done()\n    defer f.Close()\n    defer w.Flush()\n\n    for {\n        select {\n        case v, ok := &lt;-ch:\n            if ok {\n                fmt.Fprintf(w, \"%d \", v)\n            } else {\n                fmt.Println(\"done.\")\n                ticker.Stop()\n                return\n            }\n        case &lt;-ticker.C:\n            if w.Buffered() &gt; 0 {\n                fmt.Println(w.Buffered())\n                w.Flush()\n            }\n        }\n    }\n}\nfunc main() {\n    ch := make(chan int, 100)\n    wg.Add(1)\n    go WriteToFile(\"file.txt\", ch)\n\n    for i := 0; i &lt; 25; i++ {\n        ch &lt;- i // do the job\n        time.Sleep(500 * time.Millisecond)\n    }\n    close(ch) // Finish the job and close output file\n    wg.Wait()\n}\n</code></pre>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 1, "accepted_answer_id": 38430834, "answer_count": 2, "score": 1, "last_activity_date": 1468838833, "creation_date": 1468824492, "question_id": 38430186, "link": "https://stackoverflow.com/questions/38430186/selecting-between-time-interval-and-length-of-channel", "title": "Selecting between time interval and length of channel", "body": "<p>I'm here to find out the most idiomatic way to do the follow task.</p>\n\n<p><strong>Task</strong>:</p>\n\n<p>Write data from a channel to a file.</p>\n\n<p><strong>Problem</strong>: </p>\n\n<p>I have a channel <code>ch := make(chan int, 100)</code></p>\n\n<p>I need to read from the channel and write the values I read from the channel to a file. My question is basically how do I do so given that </p>\n\n<ol>\n<li>If channel <code>ch</code> is full, write the values immediately</li>\n<li>If channel <code>ch</code> is not full, write every 5s. </li>\n</ol>\n\n<p>So essentially, data needs to be written to the file at least every 5s (assuming that data will be filled into the channel at least every 5s)</p>\n\n<p>Whats the best way to use <code>select</code>, <code>for</code> and <code>range</code> to do my above task?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["pointers", "go", "types", "interface", "go-interface"], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 6602000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5dcac1b0f7352f6750312830062607?s=128&d=identicon&r=PG&f=1", "display_name": "Ronin Goda", "link": "https://stackoverflow.com/users/6602000/ronin-goda"}, "edited": false, "score": 0, "creation_date": 1468827443, "post_id": 38429885, "comment_id": 64267969, "body": "Awesome... Thank u very much."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1499170417, "last_edit_date": 1499170417, "creation_date": 1468823342, "answer_id": 38429885, "question_id": 38429683, "link": "https://stackoverflow.com/questions/38429683/is-it-possible-to-pass-interface-obj-to-interface-type/38429885#38429885", "title": "Is it possible to pass interface obj to interface{} type?", "body": "<p>The \"problem\" is that <code>someStruct.toByte()</code> has a pointer receiver. This means the method <code>toByte()</code> belongs to the type <code>*someStruct</code> and not to <code>someStruct</code>. So <code>someStruct</code> does not implement <code>object</code>, only <code>*someStruct</code>. And you pass a value of <code>someStruct</code> to <code>overload()</code>.</p>\n\n<p>Pass a value of <code>*someStruct</code>, and you'll get what you want:</p>\n\n<pre><code>overload(&amp;someStruct{val: 5, some: \"say\"})\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/d8hOdEpJKW\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>string :  hello\nint :  5\ninterface obj &amp;{5 say}\n</code></pre>\n\n<p>Relevant section from the spec: <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">Method sets</a>:</p>\n\n<blockquote>\n  <p>A type may have a <em>method set</em> associated with it. The method set of an <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">interface type</a> is its interface. The method set of any other type <code>T</code> consists of all <a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">methods</a> declared with receiver type <code>T</code>. The method set of the corresponding <a href=\"https://golang.org/ref/spec#Pointer_types\" rel=\"nofollow noreferrer\">pointer type</a> <code>*T</code> is the set of all methods declared with receiver <code>*T</code> or <code>T</code> (that is, it also contains the method set of <code>T</code>).</p>\n</blockquote>\n\n<h3>Behind the scenes</h3>\n\n<p>Note that behind the scenes when you call <code>overload()</code> like this:</p>\n\n<pre><code>overload(&amp;someStruct{val: 5, some: \"say\"})\n</code></pre>\n\n<p>This will wrap the <code>*someStruct</code> pointer value in an <code>interface{}</code> value (because <code>overload()</code> has a parameter of <code>interface{}</code> type), and not in an interface value of type <code>object</code>.</p>\n\n<p>Inside <code>overload()</code>, the <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">type switch</a> will check types in the listed order. And when it reaches <code>case object</code>, it will see that the value wrapped in the <code>overLoadedObj</code> parameter does implement <code>object</code> so this case will be executed.</p>\n"}], "owner": {"reputation": 182, "user_id": 6602000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5dcac1b0f7352f6750312830062607?s=128&d=identicon&r=PG&f=1", "display_name": "Ronin Goda", "link": "https://stackoverflow.com/users/6602000/ronin-goda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 38429885, "answer_count": 1, "score": 1, "last_activity_date": 1499170417, "creation_date": 1468822475, "last_edit_date": 1468823624, "question_id": 38429683, "link": "https://stackoverflow.com/questions/38429683/is-it-possible-to-pass-interface-obj-to-interface-type", "title": "Is it possible to pass interface obj to interface{} type?", "body": "<p>I'm new to golang and I want to implement an overloaded method something similar to C++ overloading, and my code looks something like this:</p>\n\n<pre><code>type someStruct struct {\n    val  int\n    some string\n}\n\ntype object interface {\n    toByte()\n}\n\n// someStruct implementing an object interface\nfunc (s *someStruct) toByte() {\n}\n\nfunc overload(overLoadedObj interface{}) {\n\n    switch str := overLoadedObj .(type) {\n    case string:\n        fmt.Println(\"string : \", str)\n    case int:\n        fmt.Println(\"int : \", str)\n    case object: //* It doesn't come here at all*\n        fmt.Println(\"interface obj\", str)\n    }\n}\n\nfunc main() {\n    overload(\"hello\")\n    overload(5)\n    overload(someStruct{val: 5, some: \"say\"})\n}\n</code></pre>\n\n<p>So the question is:</p>\n\n<p>How to make sure that whoever implements <strong>object interface</strong> will fall in at <strong>case object</strong> type ?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["javascript", "html", "go"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "edited": false, "score": 0, "creation_date": 1468824456, "post_id": 38429502, "comment_id": 64266430, "body": "thanks got it. However, how to avoid XSS attack while achieving the same goal. What does twitter or facebook and other websites do? They also make part of tweets and comments clickable."}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 2, "last_activity_date": 1468821699, "creation_date": 1468821699, "answer_id": 38429502, "question_id": 38429446, "link": "https://stackoverflow.com/questions/38429446/making-links-clickable-while-pushing-the-data-into-templates/38429502#38429502", "title": "making links clickable while pushing the data into templates", "body": "<p>Try wrapping your string (<code>Msg</code>) in <code>template.HTML</code> to disable the escaping that html/template does.</p>\n\n<p>Example from <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow\">the docs</a>:</p>\n\n<blockquote>\n  <p>The template</p>\n\n<pre><code>Hello, {{.}}!\n</code></pre>\n  \n  <p>can be invoked with</p>\n\n<pre><code>tmpl.Execute(out, template.HTML(`&lt;b&gt;World&lt;/b&gt;`))\n</code></pre>\n  \n  <p>to produce</p>\n\n<pre><code>Hello, &lt;b&gt;World&lt;/b&gt;!\n</code></pre>\n  \n  <p>instead of the</p>\n\n<pre><code>Hello, &amp;lt;b&amp;gt;World&amp;lt;b&amp;gt;!\n</code></pre>\n  \n  <p>that would have been produced if {{.}}\n  was a regular string.</p>\n</blockquote>\n\n<p>Note that you should do this with great care... make sure that you trust the string you're wrapping in <code>template.HTML</code>. This is an easy way to open yourself up to XSS attacks.</p>\n"}], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 38429502, "answer_count": 1, "score": 0, "last_activity_date": 1468864193, "creation_date": 1468821314, "last_edit_date": 1468864193, "question_id": 38429446, "link": "https://stackoverflow.com/questions/38429446/making-links-clickable-while-pushing-the-data-into-templates", "title": "making links clickable while pushing the data into templates", "body": "<p>I am taking inputs from user, then adding links for mentioned users and then passing the same in the template</p>\n\n<p>Input: hello @ds<br>\nString after adding links - </p>\n\n<pre><code>\"@&lt;a class=\"tweet-url username\" href=\"/user/ds\" data-screen-name=\"ds\" rel=\"nofollow\"&gt;ds&lt;/a&gt;\"\n</code></pre>\n\n<p>Passing the above string in .Msg (using golang template) :</p>\n\n<pre><code>     &lt;div class=\"panel-body\" &gt;\n             &lt;p &gt; {{.Msg}} &lt;/p&gt;\n     &lt;/div&gt;\n</code></pre>\n\n<p>Expected outcome is: Hello @ds (with clickable link on @ds) \nHowever getting everything in text format (same as input). </p>\n\n<pre><code>@&lt;a class=\"tweet-url username\" href=\"/user/ds\" data-screen-name=\"ds\" rel=\"nofollow\"&gt;ds&lt;/a&gt;\n</code></pre>\n\n<p>What am I missing?</p>\n\n<hr>\n\n<p>Got a better solution. First of all I am doing htmlEscape on the input then store it in db, then while presenting adding links followed by using document.write(string) function. With this I dont have to change the template and I dont have to worry about XSS attach. Also I am also avoiding XSS scripts in my database. \u2013</p>\n"}, {"tags": ["go", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6505143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gFmFHpDKnHw/AAAAAAAAAAI/AAAAAAAAEGU/6kdrUbgJJVA/photo.jpg?sz=128", "display_name": "Martin Gignac", "link": "https://stackoverflow.com/users/6505143/martin-gignac"}, "edited": false, "score": 1, "creation_date": 1468845662, "post_id": 38428775, "comment_id": 64279459, "body": "A-ha! My issue was two-fold: 1) I hadn&#39;t picked up on the fact that <code>*os.ProcessState</code> was an anonymous field, and that 2) this meant that <code>ExitError</code> therefore &quot;inherited&quot; <code>*os.ProcessState</code>&#39;s fields and methods via embedding. That last link you included is what steered me in the right direction and pushed me to search for more info on the subject. It is now clear for me how this works. The way I now understand it is that <code>exiterror.Sys()</code> is a &quot;shortcut&quot; to <code>exiterror.ProcessState.Sys()</code> because of embedding. Thanks!"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 2, "last_activity_date": 1468817518, "creation_date": 1468817518, "answer_id": 38428775, "question_id": 38428678, "link": "https://stackoverflow.com/questions/38428678/how-can-go-type-exiterror-in-package-os-exec-support-the-sys-method-if-its-no/38428775#38428775", "title": "How can Go type ExitError in package os/exec support the Sys() method if it&#39;s not in the documentation?", "body": "<p><code>cmd.Wait()</code> already returns error of type <code>*ExitError</code>. If you look at <code>ExitError</code>'s definition, you can see that it embeds <code>*os.ProcessState</code>:</p>\n\n<pre><code>type ExitError struct {\n        *os.ProcessState\n        // other fields\n}\n</code></pre>\n\n<p>It is through <code>*os.ProcessState</code> that a value of type <code>ExitError</code> can call <code>Sys()</code> method.</p>\n\n<p>Note that within the definition of <code>ExitError</code>, there is no field name associated with <code>*os.ProcessState</code>, which means that a value of type <code>ExitError</code> can directly call any method on <code>*os.ProcessState</code> (sort of like inheritance, where <code>ExitError</code> inherits <code>*os.ProcessState</code>. But this is only to give you a very basic idea. Read the docs for clarification.) as long as there is no method defined on <code>ExitError</code> with the same name.</p>\n\n<p>There is of course more to it. You can read about it <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 35, "user_id": 6505143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gFmFHpDKnHw/AAAAAAAAAAI/AAAAAAAAEGU/6kdrUbgJJVA/photo.jpg?sz=128", "display_name": "Martin Gignac", "link": "https://stackoverflow.com/users/6505143/martin-gignac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 38428775, "answer_count": 1, "score": 3, "last_activity_date": 1503890759, "creation_date": 1468816718, "last_edit_date": 1495541686, "question_id": 38428678, "link": "https://stackoverflow.com/questions/38428678/how-can-go-type-exiterror-in-package-os-exec-support-the-sys-method-if-its-no", "title": "How can Go type ExitError in package os/exec support the Sys() method if it&#39;s not in the documentation?", "body": "<p>Based on various examples on the web and in the answer to <a href=\"https://stackoverflow.com/questions/10385551/get-exit-code-go\">this</a> SO question, I am trying to figure out how it is possible for type <strong>ExitError</strong> from package <strong>os/exec</strong> to support the <strong>Sys()</strong> method even if the docs only mention the <strong>Error()</strong> method for this type.</p>\n\n<p>I've guessed that the <strong>Sys()</strong> method in question is from type <strong>ProcessState</strong> in package <strong>os</strong>, but how does <strong>ExitError</strong> get to use it directly (<code>exiterror.Sys()</code>) without having to use the full (<code>exiterror.ProcessState.Sys()</code>)?</p>\n\n<p>This must be a basic Go question but I've yet to figure out the answer to this one one my own...</p>\n"}, {"tags": ["linux", "go", "command-line"], "comments": [{"owner": {"reputation": 2156, "user_id": 2076937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cced1ece0753c4e2028b34c04e074bfe?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2076937/ritesh"}, "edited": false, "score": 1, "creation_date": 1468814391, "post_id": 38427250, "comment_id": 64263138, "body": "<a href=\"https://github.com/skycoin/skycoin/blob/master/src/aether/wifi/wifi.go\" rel=\"nofollow noreferrer\">github.com/skycoin/skycoin/blob/master/src/aether/wifi/wifi.&zwnj;&#8203;go</a> here is an implementation for the same activity which you can checkout."}, {"owner": {"reputation": 49, "user_id": 6484326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F22Yv.jpg?s=128&g=1", "display_name": "Ulysses Figtree", "link": "https://stackoverflow.com/users/6484326/ulysses-figtree"}, "reply_to_user": {"reputation": 2156, "user_id": 2076937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cced1ece0753c4e2028b34c04e074bfe?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2076937/ritesh"}, "edited": false, "score": 0, "creation_date": 1468864311, "post_id": 38427250, "comment_id": 64291583, "body": "Hi Ritesh. Thanks for that. I found this one before but it&#39;s still using Linux commands to get the list of wireless networks. I might have to use OS-specific commands and handle the output to get the info I need. I&#39;ll keep trying!! ;)"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 6484326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F22Yv.jpg?s=128&g=1", "display_name": "Ulysses Figtree", "link": "https://stackoverflow.com/users/6484326/ulysses-figtree"}, "is_accepted": false, "score": 1, "last_activity_date": 1468952791, "creation_date": 1468952791, "answer_id": 38465911, "question_id": 38427250, "link": "https://stackoverflow.com/questions/38427250/list-of-available-wireless-networks-with-golang-under-linux/38465911#38465911", "title": "List of available wireless networks with golang (under Linux)", "body": "<p>I was able to get the information by executing a Linux command. Here's the piece of code:</p>\n\n<pre><code>    iwlistCmd := exec.Command(\"iwlist\", iface, \"scan\")\n    iwlistCmdOut, err := iwlistCmd.Output()\n    if err != nil {\n        fmt.Println(err, \"Error when getting the interface information.\")\n    } else {\n        fmt.Println(string(iwlistCmdOut))\n    }\n</code></pre>\n\n<p>The output is a huge list of information and works in Linux only. As a next stel I have to find a way to extract the info I need which is the ESSID probably with strings.split package/function.</p>\n"}], "owner": {"reputation": 49, "user_id": 6484326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F22Yv.jpg?s=128&g=1", "display_name": "Ulysses Figtree", "link": "https://stackoverflow.com/users/6484326/ulysses-figtree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2269, "favorite_count": 1, "closed_date": 1471237754, "answer_count": 1, "score": 3, "last_activity_date": 1468952791, "creation_date": 1468802595, "question_id": 38427250, "link": "https://stackoverflow.com/questions/38427250/list-of-available-wireless-networks-with-golang-under-linux", "closed_reason": "Not suitable for this site", "title": "List of available wireless networks with golang (under Linux)", "body": "<p>I would like to get a list of the wireless networks available inside a Go program running under Linux OS. It's pretty easy to get this information from a Linux command line with iwlist but I really want to have it done natively in Go. Any ideas of which package should be used? Thank you.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4531, "user_id": 3011570, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/4Ht66.jpg?s=128&g=1", "display_name": "Eric Broda", "link": "https://stackoverflow.com/users/3011570/eric-broda"}, "edited": false, "score": 0, "creation_date": 1468867540, "post_id": 38427427, "comment_id": 64293131, "body": "Thank you for the quick response.  However, I am looking for a method of issuing a single &quot;log&quot; request (log.Info for example) which will log both to the console as well as the file at the same time (again, with each having different formats:  perhaps the console output will be formatted and colourized, and the log file output will be in JSON or other standard format)"}], "tags": [], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "is_accepted": false, "score": 3, "last_activity_date": 1468859329, "last_edit_date": 1468859329, "creation_date": 1468804892, "answer_id": 38427427, "question_id": 38427030, "link": "https://stackoverflow.com/questions/38427030/is-there-a-golang-logger-that-allows-logging-in-different-formats-to-the-console/38427427#38427427", "title": "Is there a GoLang logger that allows logging in different formats to the console as well as a log file", "body": "<p>Below is an example of achieving this with <a href=\"https://github.com/Sirupsen/logrus\" rel=\"nofollow\">Sirupsen/logrus</a></p>\n\n<pre><code>package main\n\nimport (\n  \"github.com/Sirupsen/logrus\"\n  \"os\"\n)\n\n// Create a new instance of the logger. You can have any number of instances.\nvar log1 = logrus.New()\nvar log2 = logrus.New()\n\nfunc main() {\n  // The API for setting attributes is a little different than the package level\n  // exported logger. See Godoc.\n  log1.Out = os.Stderr\n  log1.Formatter = &amp;logrus.TextFormatter{}\n\n  LogOutputFile, err := os.OpenFile(\"out.log\", os.O_RDWR | os.O_CREATE | os.O_APPEND, 0666)\n  if err != nil {\n    logrus.Fatalf(\"error opening file: %v\", err) \n  }  \n\n  log2.Out = LogOutputFile\n  log2.Formatter = &amp;logrus.JSONFormatter{}\n\n  log1.WithFields(logrus.Fields{\n    \"animal\": \"walrus\",\n    \"size\":   10,\n  }).Info(\"A group of walrus emerges from the ocean\")\n\n  log2.WithFields(logrus.Fields{\n    \"animal\": \"walrus\",\n    \"size\":   10,\n  }).Info(\"A group of walrus emerges from the ocean\")\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1470498296, "post_id": 38444516, "comment_id": 64980584, "body": "For sample hooks (other than listed in <code>logrus</code> page) I&#39;ve implemented a hook for <code>lumberjack</code> (helps with rollover logs) here: <a href=\"https://github.com/dc0d/lumberjackhook\" rel=\"nofollow noreferrer\">github.com/dc0d/lumberjackhook</a>"}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": true, "score": 2, "last_activity_date": 1468870021, "creation_date": 1468870021, "answer_id": 38444516, "question_id": 38427030, "link": "https://stackoverflow.com/questions/38427030/is-there-a-golang-logger-that-allows-logging-in-different-formats-to-the-console/38444516#38444516", "title": "Is there a GoLang logger that allows logging in different formats to the console as well as a log file", "body": "<p><a href=\"https://github.com/Sirupsen/logrus\" rel=\"nofollow\">logrus</a> is already mentioned here and it can give you exactly what you need using <a href=\"https://github.com/Sirupsen/logrus#hooks\" rel=\"nofollow\">hooks</a>. Hooks can send the log to different destinations, using different formats. You can find a list of hooks in the documentation like for sending logs to InfluxDB or Logstash. You can even implement your own hook based on your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 7242672, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D-LTm0Ray6U/AAAAAAAAAAI/AAAAAAAAABU/a5rUBluV1pY/photo.jpg?sz=128", "display_name": "Juergen Brendel", "link": "https://stackoverflow.com/users/7242672/juergen-brendel"}, "is_accepted": false, "score": 0, "last_activity_date": 1480895538, "creation_date": 1480895538, "answer_id": 40965168, "question_id": 38427030, "link": "https://stackoverflow.com/questions/38427030/is-there-a-golang-logger-that-allows-logging-in-different-formats-to-the-console/40965168#40965168", "title": "Is there a GoLang logger that allows logging in different formats to the console as well as a log file", "body": "<p>You could use <a href=\"http://github.com/romana/rlog/\" rel=\"nofollow noreferrer\">rlog</a>. We developed this to be a very configurable and light weight logger, without any dependencies aside from the standard Golang library.</p>\n\n<p>By default it just logs to stderr or stdout, but you can also specify a logfile instead or in addition to the normal output, which is exactly what you are asking for.</p>\n\n<p>Currently, it doesn't support the idea of different output formats in that case. Could you please give me an example of the different formats you would want to see? Maybe we can implement it.</p>\n"}], "owner": {"reputation": 4531, "user_id": 3011570, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/4Ht66.jpg?s=128&g=1", "display_name": "Eric Broda", "link": "https://stackoverflow.com/users/3011570/eric-broda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3176, "favorite_count": 1, "closed_date": 1480946634, "accepted_answer_id": 38444516, "answer_count": 3, "score": 6, "last_activity_date": 1480895538, "creation_date": 1468799731, "question_id": 38427030, "link": "https://stackoverflow.com/questions/38427030/is-there-a-golang-logger-that-allows-logging-in-different-formats-to-the-console", "closed_reason": "Not suitable for this site", "title": "Is there a GoLang logger that allows logging in different formats to the console as well as a log file", "body": "<p>I come from a node.js background and am comfortable with a number of loggers (such as winston) that allow configurable formatted output to multiple sources such as the console as well as a log file, where the outputs to each may be formatted differently.  </p>\n\n<p>I am attempting to do something similar with GoLang and have had difficulty finding a logging package that supports this capability.</p>\n\n<p>Is there a GoLang package that I could use to achieve this outcome?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 2, "creation_date": 1468772400, "post_id": 38423308, "comment_id": 64253102, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/25637440/golang-how-to-pad-a-number-with-zeros-when-printing\">Golang: How to pad a number with zeros when printing?</a>"}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1468772481, "post_id": 38423308, "comment_id": 64253127, "body": "See <a href=\"https://play.golang.org/p/lS0DoMLth6\" rel=\"nofollow noreferrer\">play.golang.org/p/lS0DoMLth6</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 0, "last_activity_date": 1468772789, "creation_date": 1468772789, "answer_id": 38423396, "question_id": 38423308, "link": "https://stackoverflow.com/questions/38423308/how-to-convert-int64-to-binary-and-keep-leading-zeros-in-golang/38423396#38423396", "title": "How to convert int64 to binary and keep leading zeros in golang?", "body": "<p>You can try this:</p>\n\n<pre><code>func main() {\n    n := int64(3)\n    s := strconv.FormatInt(n, 2)\n    fmt.Printf(\"%064s\", s)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/23IGYPYaE8\" rel=\"nofollow\">https://play.golang.org/p/23IGYPYaE8</a></p>\n"}, {"tags": [], "owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "is_accepted": true, "score": 6, "last_activity_date": 1468773256, "creation_date": 1468773256, "answer_id": 38423464, "question_id": 38423308, "link": "https://stackoverflow.com/questions/38423308/how-to-convert-int64-to-binary-and-keep-leading-zeros-in-golang/38423464#38423464", "title": "How to convert int64 to binary and keep leading zeros in golang?", "body": "<p>You can format directly as binary with padding:</p>\n\n<pre><code>fmt.Printf(\"%064b\\n\", n)\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/JHCgyPMKDG\" rel=\"noreferrer\">https://play.golang.org/p/JHCgyPMKDG</a></p>\n"}], "owner": {"reputation": 53, "user_id": 1933049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8279d4f8ac73861eb97bd8de321d5b49?s=128&d=identicon&r=PG", "display_name": "user1933049", "link": "https://stackoverflow.com/users/1933049/user1933049"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2262, "favorite_count": 0, "accepted_answer_id": 38423464, "answer_count": 2, "score": 2, "last_activity_date": 1468773256, "creation_date": 1468772218, "question_id": 38423308, "link": "https://stackoverflow.com/questions/38423308/how-to-convert-int64-to-binary-and-keep-leading-zeros-in-golang", "title": "How to convert int64 to binary and keep leading zeros in golang?", "body": "<p>I have created a program which converts int64 to binary:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    n := int64(3)\n    fmt.Println(strconv.FormatInt(n, 2))\n}\n</code></pre>\n\n<p>And it returns this value:</p>\n\n<pre><code>11\n</code></pre>\n\n<p>How can I keep the leading zeros in the answer?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 2055, "user_id": 617941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8add04b20f02dcc48c0ab032062158d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Roosing", "link": "https://stackoverflow.com/users/617941/joey-roosing"}, "edited": false, "score": 0, "creation_date": 1468769571, "post_id": 38422879, "comment_id": 64252147, "body": "You sir, are a hero! I simply had no idea you needed to close the channel. It makes sense now. Thanks for the explanation. Performance of the portscanning is now MUCH better."}], "tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": true, "score": 2, "last_activity_date": 1468769454, "creation_date": 1468769454, "answer_id": 38422879, "question_id": 38422600, "link": "https://stackoverflow.com/questions/38422600/scanning-ports-in-goroutines/38422879#38422879", "title": "Scanning ports in goroutines", "body": "<p>You need to close the channel after <code>wg.Wait()</code>. Otherwise your range for loop gets stuck.</p>\n\n<p>Other than that your code looks fine.</p>\n"}, {"comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 2, "creation_date": 1468779806, "post_id": 38423953, "comment_id": 64255611, "body": "Don&#39;t use the loop variable <code>port</code> directly in the closure. You will hit a bug when goroutine receives the same value."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 1, "creation_date": 1468783822, "post_id": 38423953, "comment_id": 64256811, "body": "Good catch, changed the code. The whole thing is writen in browser, without compiling it, it is just meant to demonstrate the main idea..."}, {"owner": {"reputation": 2055, "user_id": 617941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8add04b20f02dcc48c0ab032062158d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Roosing", "link": "https://stackoverflow.com/users/617941/joey-roosing"}, "edited": false, "score": 0, "creation_date": 1468834722, "post_id": 38423953, "comment_id": 64272135, "body": "@ain Thank you for your great answer. I already accepted Creker&#39;s answer, as it did indeed answer and fix my problem, so apologies for that. But a big thumbs up for your solution. Very clear, and nice improvement overall."}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": false, "score": 2, "last_activity_date": 1468783569, "last_edit_date": 1468783569, "creation_date": 1468776203, "answer_id": 38423953, "question_id": 38422600, "link": "https://stackoverflow.com/questions/38422600/scanning-ports-in-goroutines/38423953#38423953", "title": "Scanning ports in goroutines", "body": "<p>As @creker wrote, you have to close the channel, othervise the loop which reads from it will be infinite loop. However, I do not agree that just adding <code>close(ch)</code> after the <code>wg.Wait()</code> is right way to go - this would mean that the loop which reads the values from the channel wouldn't start until all ports are scanned (all <code>connect()</code> calls return). I'd say you want to start proccessing the results as soon as they are available. For that you have to restructure your code so that the producer and consumer are different goroutines, something like following</p>\n\n<pre><code>var results []*portscan.ScanResult\nch := make(chan *portscan.ScanResult)\n\n// launch the producer goroutine    \ngo func() {\n   var wg sync.WaitGroup\n   wg.Add(len(splitPorts))\n   for _, port := range splitPorts {\n       go func(port int32) {\n          defer wg.Done()\n          ch &lt;- connect(ip, port, req.Timeout)\n       }(port)\n   }\n   wg.Wait()\n   close(ch)\n}()\n\n// consume results\nfor elem := range ch {\n    results = append(results, elem)\n}\n\nfunc connect(ip string, port, timeout int32) *portscan.ScanResult {\n    res := &amp;portscan.ScanResult{\n            Port:   port,\n            IsOpen: false,\n    }\n    conn, err := net.DialTimeout(\"tcp\", fmt.Sprintf(\"%s:%d\", ip, port), time.Duration(timeout)*time.Millisecond)\n\n    if err == nil {\n        conn.Close()\n        res.IsOpen = true\n    }\n    return res\n}\n</code></pre>\n\n<p>Note that now the channel is unbuffered and the <code>connect</code> function doesn't know about the waitgroup or channel, so it is more reusable. You could use buffered channel too, if it turns out that the producers generate data more rapidly than the consumer reads it, but you probaly wouldn't need the buffer to be <code>len(splitPorts)</code> but something smaller.</p>\n\n<p>Another optimisation could be to preallocate the <code>results</code> array as you seem to know the numer of results beforehand (<code>len(splitPorts)</code>) so you do not need to use <code>append</code>.</p>\n"}], "owner": {"reputation": 2055, "user_id": 617941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8add04b20f02dcc48c0ab032062158d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Roosing", "link": "https://stackoverflow.com/users/617941/joey-roosing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 38422879, "answer_count": 2, "score": 1, "last_activity_date": 1468783569, "creation_date": 1468767587, "last_edit_date": 1468768433, "question_id": 38422600, "link": "https://stackoverflow.com/questions/38422600/scanning-ports-in-goroutines", "title": "Scanning ports in goroutines", "body": "<p>I am currently in the proces of learning go. To do that, I am making a relatively simple portscanner.</p>\n\n<p>The issue I am facing is that it takes a considerable amount of time to scan these ports. The behaviour i am having is that, if i scan ports (defined as an array of int32 (protobuf doesnt support int16), NOT using goroutines works, but is quite slow when scanning more then 5 ports as you can imagine, since it is not running in parallel.</p>\n\n<p>To achieve parallelism, I came up with the following bits of code (explanation + issue comes after code):</p>\n\n<pre><code>//entry point for port scanning\nvar results []*portscan.ScanResult\n//len(splitPorts) is the given string (see benchmark below) chopped up in an int32 slice\nch := make(chan *portscan.ScanResult, len(splitPorts))\n\nvar wg sync.WaitGroup\nfor _, port := range splitPorts {\n    connect(ip, port, req.Timeout, ch, &amp;wg)\n}\nwg.Wait()\n\nfor elem := range ch {\n    results = append(results, elem)\n}\n\n// go routine\nfunc connect(ip string, port, timeout int32, ch chan *portscan.ScanResult, wg *sync.WaitGroup) {\n    wg.Add(1)\n    go func() {\n        res := &amp;portscan.ScanResult{\n            Port:   port,\n            IsOpen: false,\n        }\n        conn, err := net.DialTimeout(\"tcp\", fmt.Sprintf(\"%s:%d\", ip, port), time.Duration(timeout)*time.Millisecond)\n\n        if err == nil {\n            conn.Close()\n            res.IsOpen = true\n        }\n        ch &lt;- res\n        wg.Done()\n    }()\n}\n</code></pre>\n\n<p>So protobuf prepared me a struct which looks as follows:</p>\n\n<pre><code>type ScanResult struct {\n    Port   int32 `protobuf:\"varint,1,opt,name=port\" json:\"port,omitempty\"`\n    IsOpen bool  `protobuf:\"varint,2,opt,name=isOpen\" json:\"isOpen,omitempty\"`\n}\n</code></pre>\n\n<p>As seen in the first line of the code snippet, I have defined a slice, to hold all results, the idea is that my application scans ports in parallel and when that is done, send the results to whoever is interested.</p>\n\n<p>However, using this code, the program gets stuck.</p>\n\n<p>I run this benchmark to test its performance:</p>\n\n<pre><code>func BenchmarkPortScan(b *testing.B) {\n  request := &amp;portscan.ScanPortsRequest{\n      Ip:        \"62.129.139.214\",\n      PortRange: \"20,21,22,23\",\n      Timeout:   500,\n  }\n\n  svc := newService()\n\n  for i := 0; i &lt; b.N; i++ {\n      svc.ScanPorts(nil, request)\n  }\n}\n</code></pre>\n\n<p>What is the cause for it to get stuck. Does looking at this code give anything away? </p>\n\n<p>So in short, what I want my end result to be is that each port is scanned in a different go routine, and when they all finished, everything comes together in a resulting slice of ScanResult.</p>\n\n<p>I hope I have been clear and provided enough information for you guys to help me.</p>\n\n<p>Oh, and im especially looking for pointers, and the learning bit, not persee working code samples.</p>\n"}, {"tags": ["google-app-engine", "go", "gae-search"], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 714257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b2zBN.png?s=128&g=1", "display_name": "jens", "link": "https://stackoverflow.com/users/714257/jens"}, "edited": false, "score": 0, "creation_date": 1468845808, "post_id": 38426454, "comment_id": 64279563, "body": "It is updated now, but it took a few days instead of 24 hours. Not sure why. Anyway, thanks for the answer."}], "tags": [], "owner": {"reputation": 690, "user_id": 2093339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bca2e54ba03a52916af5362f83f6e096?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/2093339/alan"}, "is_accepted": true, "score": 0, "last_activity_date": 1468793860, "creation_date": 1468793860, "answer_id": 38426454, "question_id": 38421304, "link": "https://stackoverflow.com/questions/38421304/how-to-delete-a-search-index-on-the-app-engine-using-go/38426454#38426454", "title": "How to delete a search index on the App Engine using Go?", "body": "<p>When you delete documents, the space usage shown on the Dashboard is not updated immediately.  It is recalculated by a nightly batch job.  So it should be updated within 24 hours.</p>\n"}], "owner": {"reputation": 156, "user_id": 714257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b2zBN.png?s=128&g=1", "display_name": "jens", "link": "https://stackoverflow.com/users/714257/jens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 38426454, "answer_count": 1, "score": 0, "last_activity_date": 1468793860, "creation_date": 1468759225, "question_id": 38421304, "link": "https://stackoverflow.com/questions/38421304/how-to-delete-a-search-index-on-the-app-engine-using-go", "title": "How to delete a search index on the App Engine using Go?", "body": "<p>I am wondering what is the best way to delete a search index of the full text search API that is available on the Google App Engine. I have found a few questions on this topic focusing on Python, but none on Go. The general suggestions seems to be to manually delete all documents in the search index and than call <code>index.delete_schema()</code>, see for example[0].</p>\n\n<p>However, for Go there seems to be no function to delete a schema. I have used a task queue to remove every document in an index, but the size of the index shown in the App Engine Dashboard did not decrease.</p>\n\n<p>[0] <a href=\"https://stackoverflow.com/questions/14388251/how-to-delete-or-reset-a-search-index-in-appengine/14390379#14390379\">How to delete or reset a search index in Appengine</a></p>\n"}, {"tags": ["arrays", "json", "go", "youtube", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1468757626, "creation_date": 1468757626, "answer_id": 38421064, "question_id": 38420925, "link": "https://stackoverflow.com/questions/38420925/unmarshalling-json-data-with-nested-arrays-and-objects-into-go-struct/38421064#38421064", "title": "Unmarshalling JSON data with nested arrays and objects into Go struct", "body": "<p>Note that the json data contains numbers for <code>TotalResults</code> and <code>ResultsPerPage</code>. You can try decoding these as follows:</p>\n\n<pre><code>PageInfo      struct {\n    TotalResults   json.Number `json:\"totalResults\"`\n    ResultsPerPage json.Number `json:\"resultsPerPage\"`\n} `json:\"pageInfo\"`\n</code></pre>\n\n<p>Once you have the unmarshalled struct, you can get the number as:</p>\n\n<pre><code>totalResults, _ := youtubeData.PageInfo.TotalResults.Int64()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "is_accepted": false, "score": 5, "last_activity_date": 1468763081, "creation_date": 1468763081, "answer_id": 38421899, "question_id": 38420925, "link": "https://stackoverflow.com/questions/38420925/unmarshalling-json-data-with-nested-arrays-and-objects-into-go-struct/38421899#38421899", "title": "Unmarshalling JSON data with nested arrays and objects into Go struct", "body": "<p>I figured it out that when I use auto generated json to Go from</p>\n\n<p><a href=\"https://mholt.github.io/json-to-go/\" rel=\"noreferrer\">https://mholt.github.io/json-to-go/</a></p>\n\n<p>Now it works perfectly. I will never manually craft it by hand ever again.</p>\n"}, {"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 1, "last_activity_date": 1468820835, "creation_date": 1468820835, "answer_id": 38429357, "question_id": 38420925, "link": "https://stackoverflow.com/questions/38420925/unmarshalling-json-data-with-nested-arrays-and-objects-into-go-struct/38429357#38429357", "title": "Unmarshalling JSON data with nested arrays and objects into Go struct", "body": "<p>Your struct must have fields with the same data types JSON body has, in your JSON body <code>totalResults</code> and <code>resultsPerPage</code> are integers, so:</p>\n\n<pre><code>PageInfo      struct {\n    TotalResults   int `json:\"totalResults\"`\n    ResultsPerPage int `json:\"resultsPerPage\"`\n} `json:\"pageInfo\"`\n</code></pre>\n"}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1474, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1468820835, "creation_date": 1468756603, "question_id": 38420925, "link": "https://stackoverflow.com/questions/38420925/unmarshalling-json-data-with-nested-arrays-and-objects-into-go-struct", "title": "Unmarshalling JSON data with nested arrays and objects into Go struct", "body": "<p>I am unmarshalling Youtube json response into Go struct by using the data received from Youtube API as follows:-</p>\n\n<pre><code>{\n \"kind\": \"youtube#searchListResponse\",\n \"etag\": \"\\\"5g01s4-wS2b4VpScndqCYc5Y-8k/5xHRkUxevhiDF1huCnKw2ybduyo\\\"\",\n \"nextPageToken\": \"CBQQAA\",\n \"regionCode\": \"TH\",\n \"pageInfo\": {\n  \"totalResults\": 36,\n  \"resultsPerPage\": 20\n },\n \"items\": [\n  {\n   \"kind\": \"youtube#searchResult\",\n   \"etag\": \"\\\"5g01s4-wS2b4VpScndqCYc5Y-8k/aMbszoNudZchce3BIjZC_YemugE\\\"\",\n   \"id\": {\n    \"kind\": \"youtube#video\",\n    \"videoId\": \"fvh6CQ7FxZE\"\n   },\n   \"snippet\": {\n    \"publishedAt\": \"2016-07-16T14:42:36.000Z\",\n    \"channelId\": \"UCuX4iswo8acMxDNcbrceRYQ\",\n    \"title\": \"Japan \u0e2d\u0e23\u0e48\u0e2d\u0e22\u0e2a\u0e38\u0e14\u0e46:\u0e01\u0e32\u0e23\u0e1b\u0e23\u0e30\u0e0a\u0e31\u0e19\u0e02\u0e2d\u0e07 2 \u0e2a\u0e32\u0e27\u0e01\u0e31\u0e1a\u0e23\u0e32\u0e40\u0e21\u0e07\u0e14\u0e31\u0e07\u0e08\u0e32\u0e01\u0e42\u0e2d\u0e0b\u0e32\u0e01\u0e49\u0e32#ramen\",\n    \"description\": \"Ramen Kio \u0e23\u0e32\u0e40\u0e21\u0e19\u0e0a\u0e37\u0e48\u0e2d\u0e14\u0e31\u0e07\u0e02\u0e2d\u0e07\u0e42\u0e2d\u0e0b\u0e32\u0e01\u0e49\u0e32\u0e2d\u0e31\u0e14\u0e41\u0e19\u0e48\u0e19\u0e14\u0e49\u0e27\u0e22\u0e40\u0e19\u0e37\u0e49\u0e2d\u0e2b\u0e21\u0e39\u0e0a\u0e32\u0e0a\u0e39\u0e41\u0e1a\u0e1a\u0e40\u0e15\u0e47\u0e21\u0e46\u0e40\u0e2a\u0e49\u0e19\u0e40\u0e2b\u0e19\u0e35\u0e22...\",\n    \"thumbnails\": {\n     \"default\": {\n      \"url\": \"https://i.ytimg.com/vi/fvh6CQ7FxZE/default.jpg\",\n      \"width\": 120,\n      \"height\": 90\n     },\n     \"medium\": {\n      \"url\": \"https://i.ytimg.com/vi/fvh6CQ7FxZE/mqdefault.jpg\",\n      \"width\": 320,\n      \"height\": 180\n     },\n     \"high\": {\n      \"url\": \"https://i.ytimg.com/vi/fvh6CQ7FxZE/hqdefault.jpg\",\n      \"width\": 480,\n      \"height\": 360\n     }\n    },\n    \"channelTitle\": \"Japan aroi sudsud TV\",\n    \"liveBroadcastContent\": \"none\"\n   }\n  }\n ]\n}\n</code></pre>\n\n<p>To do so, I have created a struct for this in Go</p>\n\n<pre><code>type YoutubeData struct {\n    Kind          string `json:\"kind\"`\n    Etag          string `json:\"etag\"`\n    NextPageToken string `json:\"nextPageToken\"`\n    RegionCode    string `json:\"regionCode\"`\n    PageInfo      struct {\n        TotalResults   string `json:\"totalResults\"`\n        ResultsPerPage string `json:\"resultsPerPage\"`\n    } `json:\"pageInfo\"`\n    Items []struct {\n        Kind string `json:\"kind\"`\n        Etag string `json:\"etag\"`\n        Id   struct {\n            Kind    string `json:\"kind\"`\n            VideoId string `json:\"videoId\"`\n        } `json:\"id\"`\n        Snippet struct {\n            PublishedAt string `json:\"publishedAt\"`\n            ChannelId   string `json:\"channelId\"`\n            Title       string `json:\"title\"`\n            Description string `json:\"description\"`\n            Thumbnails  struct {\n                Default struct {\n                    Url    string `json:\"url\"`\n                    Width  string `json:\"width\"`\n                    Height string `json:\"height\"`\n                } `json:\"default\"`\n                Medium struct {\n                    Url    string `json:\"url\"`\n                    Width  string `json:\"width\"`\n                    Height string `json:\"height\"`\n                } `json:\"medium\"`\n                High struct {\n                    Url    string `json:\"url\"`\n                    Width  string `json:\"width\"`\n                    Height string `json:\"height\"`\n                } `json:\"high\"`\n            } `json:\"thumbnails\"`\n            ChannelTitle         string `json:\"channelTitle\"`\n            LiveBroadcastContent string `json:\"liveBroadcastContent\"`\n        } `json:\"snippet\"`\n    } `json:\"items\"`\n}\n</code></pre>\n\n<p>I unmarshaled it by using this method</p>\n\n<pre><code>youtubeData := YoutubeData{}\n\nif json.Unmarshal(b, &amp;youtubeData); err != nil {\n\n} else {\n\n} \n</code></pre>\n\n<p>In which b is the byte data received from Youtube API. I successfully got all data in the byte object as I printed it out to my console, however, once I unmarshaled it and tried to output it on the template by using {{.}}, I received</p>\n\n<pre><code>{youtube#searchListResponse \"5g01s4-wS2b4VpScndqCYc5Y-8k/JwGY0TWwWswjZ9LOvemaF5yxsMo\" CBQQAA TH { } []}\n</code></pre>\n\n<p>All data are unmarshaled except for the data in json object and array which are <em>pageInfo</em> and <em>items</em>. There are simply blank. I believe I exported them all correctly. Are there some additional steps to get the data into slice or struct nested inside another struct in Go when it comes to json unmarshalling?</p>\n"}, {"tags": ["logging", "go"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468846034, "post_id": 38434629, "comment_id": 64279694, "body": "If this is going to be used in a log.Logger, it should be made safe for concurrent access, since the logger itself can be used concurrently."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1468869204, "post_id": 38434629, "comment_id": 64294007, "body": "@JimB can you please explain/share a link to understand/learn better about how to make something <b>safe</b> If I am right this implies the use of <code>sync.mutex</code>?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 0, "last_activity_date": 1468899204, "last_edit_date": 1468899204, "creation_date": 1468838400, "answer_id": 38434629, "question_id": 38420618, "link": "https://stackoverflow.com/questions/38420618/how-to-add-remove-on-demand-writers-to-io-multiwriter/38434629#38434629", "title": "how to add/remove on demand writers to io.MultiWriter?", "body": "<p>you may write your own package and add these two <code>Remove</code>and <code>Append</code> method like this working test sample code(not concurrent):  </p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"os\"\n)\n\nfunc main() {\n    w1, e := os.Create(\"file1.txt\")\n    if e != nil {\n        panic(e)\n    }\n    w2, e := os.Create(\"file2.txt\")\n    if e != nil {\n        panic(e)\n    }\n    mw := MultiWriter(w1, w2)\n    data := []byte(\"Hello \")\n    _, e = mw.Write(data)\n    if e != nil {\n        panic(e)\n    }\n\n    var m *multiWriter = mw.(*multiWriter)\n    m.Remove(w2)\n    w2.Close()\n    w3, e := os.Create(\"file3.txt\")\n    if e != nil {\n        panic(e)\n    }\n    m.Append(w3)\n    data = []byte(\"World \")\n    _, e = mw.Write(data)\n    if e != nil {\n        panic(e)\n    }\n    w3.Close()\n    w1.Close()\n}\nfunc (t *multiWriter) Remove(writers ...io.Writer) {\n    for i := len(t.writers) - 1; i &gt; 0; i-- {\n        for _, v := range writers {\n            if t.writers[i] == v {\n                t.writers = append(t.writers[:i], t.writers[i+1:]...)\n                break\n            }\n        }\n    }\n}\nfunc (t *multiWriter) Append(writers ...io.Writer) {\n    t.writers = append(t.writers, writers...)\n}\n\ntype multiWriter struct {\n    writers []io.Writer\n}\n\nfunc (t *multiWriter) Write(p []byte) (n int, err error) {\n    for _, w := range t.writers {\n        n, err = w.Write(p)\n        if err != nil {\n            return\n        }\n        if n != len(p) {\n            err = io.ErrShortWrite\n            return\n        }\n    }\n    return len(p), nil\n}\n\nvar _ stringWriter = (*multiWriter)(nil)\n\nfunc (t *multiWriter) WriteString(s string) (n int, err error) {\n    var p []byte // lazily initialized if/when needed\n    for _, w := range t.writers {\n        if sw, ok := w.(stringWriter); ok {\n            n, err = sw.WriteString(s)\n        } else {\n            if p == nil {\n                p = []byte(s)\n            }\n            n, err = w.Write(p)\n        }\n        if err != nil {\n            return\n        }\n        if n != len(s) {\n            err = io.ErrShortWrite\n            return\n        }\n    }\n    return len(s), nil\n}\n\n// MultiWriter creates a writer that duplicates its writes to all the\n// provided writers, similar to the Unix tee(1) command.\nfunc MultiWriter(writers ...io.Writer) io.Writer {\n    w := make([]io.Writer, len(writers))\n    copy(w, writers)\n    return &amp;multiWriter{w}\n}\n\n// stringWriter is the interface that wraps the WriteString method.\ntype stringWriter interface {\n    WriteString(s string) (n int, err error)\n}\n</code></pre>\n\n<p>concurrent safe:  </p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"os\"\n    \"sync\"\n)\n\nfunc main() {\n    w1, e := os.Create(\"file1.txt\")\n    if e != nil {\n        panic(e)\n    }\n    w2, e := os.Create(\"file2.txt\")\n    if e != nil {\n        panic(e)\n    }\n    mw := MultiWriter(w1, w2)\n    data := []byte(\"Hello \")\n    _, e = mw.Write(data)\n    if e != nil {\n        panic(e)\n    }\n\n    var m *multiWriter = mw.(*multiWriter)\n    m.Remove(w2)\n    w2.Close()\n    w3, e := os.Create(\"file3.txt\")\n    if e != nil {\n        panic(e)\n    }\n    m.Append(w3)\n    data = []byte(\"World \")\n    _, e = mw.Write(data)\n    if e != nil {\n        panic(e)\n    }\n    w3.Close()\n    w1.Close()\n}\nfunc (t *multiWriter) Remove(writers ...io.Writer) {\n    t.mu.Lock()\n    defer t.mu.Unlock()\n    for i := len(t.writers) - 1; i &gt; 0; i-- {\n        for _, v := range writers {\n            if t.writers[i] == v {\n                t.writers = append(t.writers[:i], t.writers[i+1:]...)\n                break\n            }\n        }\n    }\n}\nfunc (t *multiWriter) Append(writers ...io.Writer) {\n    t.mu.Lock()\n    defer t.mu.Unlock()\n    t.writers = append(t.writers, writers...)\n}\n\ntype multiWriter struct {\n    writers []io.Writer\n    mu      sync.Mutex\n}\n\nfunc (t *multiWriter) Write(p []byte) (n int, err error) {\n    t.mu.Lock()\n    defer t.mu.Unlock()\n    for _, w := range t.writers {\n        n, err = w.Write(p)\n        if err != nil {\n            return\n        }\n        if n != len(p) {\n            err = io.ErrShortWrite\n            return\n        }\n    }\n    return len(p), nil\n}\n\nvar _ stringWriter = (*multiWriter)(nil)\n\nfunc (t *multiWriter) WriteString(s string) (n int, err error) {\n    t.mu.Lock()\n    defer t.mu.Unlock()\n    var p []byte // lazily initialized if/when needed\n    for _, w := range t.writers {\n        if sw, ok := w.(stringWriter); ok {\n            n, err = sw.WriteString(s)\n        } else {\n            if p == nil {\n                p = []byte(s)\n            }\n            n, err = w.Write(p)\n        }\n        if err != nil {\n            return\n        }\n        if n != len(s) {\n            err = io.ErrShortWrite\n            return\n        }\n    }\n    return len(s), nil\n}\n\n// MultiWriter creates a writer that duplicates its writes to all the\n// provided writers, similar to the Unix tee(1) command.\nfunc MultiWriter(writers ...io.Writer) io.Writer {\n    w := make([]io.Writer, len(writers))\n    copy(w, writers)\n    return &amp;multiWriter{writers: w}\n}\n\n// stringWriter is the interface that wraps the WriteString method.\ntype stringWriter interface {\n    WriteString(s string) (n int, err error)\n}\n</code></pre>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1134, "favorite_count": 1, "accepted_answer_id": 38434629, "answer_count": 1, "score": 1, "last_activity_date": 1468899204, "creation_date": 1468754163, "question_id": 38420618, "link": "https://stackoverflow.com/questions/38420618/how-to-add-remove-on-demand-writers-to-io-multiwriter", "title": "how to add/remove on demand writers to io.MultiWriter?", "body": "<p>I am writing logs to a file and to the standard input  of a program using something like:</p>\n\n<pre><code>type myLogger {\n    log  *log.Logger\n}\n\ncmd := exec.Command(\"logger\", \"-t\", \"test\")\nw, _ = cmd.StdinPipe()\n\nmulti := io.MultiWriter(file, w)\n\nmyLog := myLogger{log.New(multi, \"\", log.Ldate|log.Ltime)}\n</code></pre>\n\n<p>But if the command exits, is killed or if I just want to add another <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow\">Writer</a>, how could I append it to the existing <a href=\"https://golang.org/pkg/log/#New\" rel=\"nofollow\">logger</a>?</p>\n\n<p>Currently for every change I create a new <code>multi</code> and overwrite the existing logger:</p>\n\n<pre><code>multi := io.MultiWriter(file, w)\nmyLog.log = log.New(multi, \"\", log.Ldate|log.Ltime)\n</code></pre>\n\n<p>But wondering if there is a better way of doing this and if by creating a new <code>log.New</code>, should I close the previous ones or they are just sharing references of the <code>Writers</code> that I pass to the <code>multi</code> var?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 1, "creation_date": 1468759436, "post_id": 38420602, "comment_id": 64249092, "body": "What is <code>client</code> type above?"}, {"owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 1, "creation_date": 1468760768, "post_id": 38420602, "comment_id": 64249505, "body": "@abhink added definition of client"}], "owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1468760744, "creation_date": 1468754037, "last_edit_date": 1468760744, "question_id": 38420602, "link": "https://stackoverflow.com/questions/38420602/problems-with-dev-appserver-datastore-file", "title": "problems with dev_appserver datastore file", "body": "<p>I have a simple question, I been playing with dev_appserver testing my Go app locally.<br>\nI saved some keys:  </p>\n\n<pre><code>client, err = datastore.NewClient(ctx, utils.ProjectID)\nkey := datastore.NewKey(ctx, KindSpace, \"\", id, nil)\nif _, err := client.Put(ctx, key, value); err != nil {\n    return err\n}\n</code></pre>\n\n<p>However, When connecting to: <code>http://localhost:8000/datastore</code> my datastore is empty.<br>\nI then tried to retrieve the keys from inside my code using:</p>\n\n<pre><code>client, err = datastore.NewClient(ctx, utils.ProjectID)\nentity := new(Space)\nkey := datastore.NewKey(ctx, KindSpace, \"\", id, nil)\nif err := client.Get(ctx, key, entity); err != nil {\n    return nil, err\n}\n</code></pre>\n\n<p>and indeed it returned the keys I saved. Do you have any idea what do I miss? Does it have something to do with the database namespace maybe?  </p>\n\n<p>Is there anyway to read the local data base from the terminal?</p>\n"}, {"tags": ["arrays", "go", "scope"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 0, "last_activity_date": 1468750491, "last_edit_date": 1468750491, "creation_date": 1468750340, "answer_id": 38420129, "question_id": 38420069, "link": "https://stackoverflow.com/questions/38420069/variable-scope-in-golang/38420129#38420129", "title": "variable scope in golang", "body": "<p>It is because you are only declaring and assigning values to <code>number</code>. You are never actually using it anywhere (i.e. referring to the value it holds in any way). In you code, you can safely remove <code>number</code> declaration and <code>number = x[0]</code> and it won't change the program behavior.</p>\n\n<p>The correct implementation however would return the smallest number from the function:</p>\n\n<pre><code>package main\nimport(\n    \"fmt\"\n)\n\nfunc main() {\n    n := samlestNumber()\n    fmt.Println(\"Smallest Number =\", n)\n}\n\nfunc samlestNumber() int { // add a return type\n    x := []int{\n        48,96,86,68,\n        57,82,63,70,\n        37,34,83,27,\n        19,97, 9,17,\n    }\n\n    //x = append(x,6,7)\n    var number int = x[0]\n    for _,element := range x {\n\n        // always compare to smallest number. Even if you don't return\n        // number anymore, you are still accessing the value held by\n        // the number variable. So even making this change alone will\n        // make the compiler error go away \n        if element &lt; number {\n            number = element\n        }\n\n        fmt.Println(\" :::: \",element)\n    }\n    return number // return number\n}\n</code></pre>\n"}], "owner": {"reputation": 1562, "user_id": 4303758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nbL0i.jpg?s=128&g=1", "display_name": "Manjeet Thakur", "link": "https://stackoverflow.com/users/4303758/manjeet-thakur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1468934462, "creation_date": 1468749917, "last_edit_date": 1468934462, "question_id": 38420069, "link": "https://stackoverflow.com/questions/38420069/variable-scope-in-golang", "title": "variable scope in golang", "body": "<p>I am new in Go language and want to learn basic fundamental  here below I paste example. the problem in this example is I cannot access number variable inside for loop. it shows this error  </p>\n\n<blockquote>\n  <p>\" number declared and not use \"</p>\n</blockquote>\n\n<p>. Please help me :(</p>\n\n<pre><code>package main\nimport(\n    \"fmt\"\n)\n\nfunc main() {    \n    samlestNumber()\n}\n\nfunc samlestNumber()  {\n    x := []int{\n        48,96,86,68,\n        57,82,63,70,\n        37,34,83,27,\n        19,97, 9,17,\n    }\n\n    //x = append(x,6,7)\n    var number int = x[0]\n    for _,element := range x {\n\n        if element &lt; x[0] {\n            number = element\n        }    \n        fmt.Println(\" :::: \",element)    \n    }\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1468751867, "post_id": 38419776, "comment_id": 64247211, "body": "For clarification, please use comments."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 0, "last_activity_date": 1468747663, "creation_date": 1468747663, "answer_id": 38419776, "question_id": 38419637, "link": "https://stackoverflow.com/questions/38419637/golang-mgo-how-can-i-store-isodate-by-gmt8-time-zone-in-mongodb/38419776#38419776", "title": "Golang/mgo : How can I store ISODate by GMT+8 Time Zone in mongodb?", "body": "<p><code>time.Now</code> should return local time. Is your system time setup properly? What do you get on running the <code>date</code> command (on linux based system)?</p>\n\n<p>You can try using <code>In</code> method on you <code>time</code> object with a <code>time.Location</code> value:</p>\n\n<pre><code>l, _ := time.LoadLocation(\"Local\") // or the name of your time zone\nt : time.Now()\n\nt := StoreTime {\n    storeTime : t.In(l),\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1468754657, "last_edit_date": 1468754657, "creation_date": 1468751793, "answer_id": 38420319, "question_id": 38419637, "link": "https://stackoverflow.com/questions/38419637/golang-mgo-how-can-i-store-isodate-by-gmt8-time-zone-in-mongodb/38420319#38420319", "title": "Golang/mgo : How can I store ISODate by GMT+8 Time Zone in mongodb?", "body": "<p><strike>You came across an intricacy of mgo.v2/bson, which converts</strike> Since the <a href=\"http://bsonspec.org/spec.html\" rel=\"nofollow\">BSON specification</a> states that all times shall be stored as</p>\n\n<blockquote>\n  <p>UTC milliseconds since the Unix epoch</p>\n</blockquote>\n\n<p><code>mgo.v2/bson</code> converts all time.Time values to UTC. So even when you explicitly set the location info of a time returned by <code>time.Now()</code> or companions, this local time is converted to UTC.</p>\n\n<p>So in order to display time correctly for any given time zone, you should do the following:</p>\n\n<ol>\n<li>When saving a time.Time value, you should use the time as returned by <code>time.Time.In(*time.Location)</code> if the time zone differs from your (the servers) local time.</li>\n<li>When displaying the returned value in UTC, make sure you use <code>time.Time.UTC()</code></li>\n<li>When displaying the returned value in a given local time, make sure you use <code>time.Time.In(*time.Location)</code> again.</li>\n</ol>\n\n<p>To be a more clear on that, please have a look at the example below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\nconst (\n    myLoc = \"Europe/Berlin\"\n    ny    = \"America/New_York\"\n)\n\n// We define those vars here, as you might want to make them\n// package-global\nvar (\n    berlin *time.Location\n    nyc    *time.Location\n)\n\n// StoreTime is just a dummy struct\ntype StoreTime struct {\n    // Unexported fields are not (un-)marshalled by encoding/json\n    // and mgo.v2/bson, so the field name has to be uppercase\n    StoreTime time.Time `bson:\"testTime\"`\n}\n\nfunc main() {\n\n    var (\n        sess *mgo.Session\n        err  error\n    )\n\n    // Connect to MongoDB\n    if sess, err = mgo.Dial(\"localhost:27017\"); err != nil {\n        panic(\"Could not connect to MongoDB: \" + err.Error())\n    }\n    // Make sure the session is closed when main exits for whatever reason\n    defer sess.Close()\n\n    // Clear the collection for demo purposes\n    if err = sess.DB(\"test\").C(\"timezones\").Remove(bson.M{}); err != nil &amp;&amp; err != mgo.ErrNotFound {\n        panic(\"Could not clean test collection: \" + err.Error())\n    }\n\n    // Load the desired TZ by location\n    if berlin, err = time.LoadLocation(myLoc); err != nil {\n        panic(\"Error loading '\" + myLoc + \"' as timezone location: \" + err.Error())\n    }\n\n    // Create a new StoreTime with the local time of the desired timezone.\n    // Note that mgo.v2/bson still converts it to Zulu time, but with the\n    // appropriate offset.\n    st := &amp;StoreTime{StoreTime: time.Now().In(berlin)}\n\n    // Save the document for further reference\n    if err = sess.DB(\"test\").C(\"timezones\").Insert(st); err != nil {\n        panic(\"Error inserting sample document into MongoDB: \" + err.Error())\n    }\n\n    // Load the saved document,...\n    res := &amp;StoreTime{}\n    if err = sess.DB(\"test\").C(\"timezones\").Find(nil).One(&amp;res); err != nil {\n        panic(\"Unable to load just recently stored document: \" + err.Error())\n    }\n\n    // ... and another TZ for displaying,...\n    if nyc, err = time.LoadLocation(ny); err != nil {\n        panic(\"Error loading '\" + ny + \"' as timezone location: \" + err.Error())\n    }\n\n    // ...and display the time from the document in UTC and the local time\n    // of both Berlin and NYC.\n    fmt.Println(res.StoreTime.UTC())\n    // The next two are identical for _me_, as I happen to live in the according TZ.\n    // Unless you do, too, you should have different values\n    fmt.Println(res.StoreTime.In(Berlin))\n    fmt.Println(res.StoreTime)\n    fmt.Println(res.StoreTime.In(nyc))\n}\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 4112599, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-mSx5V2Y2Z8Q/AAAAAAAAAAI/AAAAAAAAABE/z94Y3QQ8KYA/photo.jpg?sz=128", "display_name": "adairjun", "link": "https://stackoverflow.com/users/4112599/adairjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5061, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1468754657, "creation_date": 1468746717, "question_id": 38419637, "link": "https://stackoverflow.com/questions/38419637/golang-mgo-how-can-i-store-isodate-by-gmt8-time-zone-in-mongodb", "title": "Golang/mgo : How can I store ISODate by GMT+8 Time Zone in mongodb?", "body": "<p>If I store ISODate in mongodb,the ISODate is always GMT+0</p>\n\n<pre><code>type StoreTime struct {\n    storeTime time.Time `bson:\"testTime\" json:\"testTime,omitempty\"`\n}\n...\nt := StoreTime {\n    storeTime : time.Now(),\n}\n....\nc.Insert(t)\n</code></pre>\n\n<p>The result is :</p>\n\n<pre><code>{ \n    \"_id\" : ObjectId(\"578b43e5feaa0deb6a94b1d0\"),  \n    \"storeTime\" : ISODate(\"2016-07-17T08:38:25.316+0000\")\n}\n</code></pre>\n\n<p>How can I change the time zone?</p>\n"}, {"tags": ["algorithm", "random", "go"], "comments": [{"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1468734089, "post_id": 38418171, "comment_id": 64243338, "body": "What have you tried so far? As-is, this question is too open-ended for Stack Overflow."}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1468741460, "post_id": 38418781, "comment_id": 64244721, "body": "Also related / useful: <a href=\"http://stackoverflow.com/questions/37934162/output-uuid-in-go-as-a-short-string\">Output UUID in Go as a short string</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 16, "last_activity_date": 1470169372, "last_edit_date": 1495540981, "creation_date": 1468739415, "answer_id": 38418781, "question_id": 38418171, "link": "https://stackoverflow.com/questions/38418171/how-to-generate-unique-random-string-in-a-length-range-using-golang/38418781#38418781", "title": "How to generate unique random string in a length range using Golang?", "body": "<p><strong>How unique is unique?</strong><br>\nif Universally unique, see: <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/Universally_unique_identifier</a><br>\nOut of a total of 128 bits, Type 4 UUIDs have 6 reserved bits (4 for the version and 2 other reserved bits), so randomly generated UUIDs have 122 random bits.   </p>\n\n<p>for UUID see: <a href=\"https://stackoverflow.com/questions/15130321/is-there-a-method-to-generate-a-uuid-with-go-language\">Is there a method to generate a UUID with go language</a>  </p>\n\n<p><strong>How to display it?</strong>  ( <a href=\"https://en.wikipedia.org/wiki/Binary-to-text_encoding\" rel=\"noreferrer\">Binary-to-text encoding</a> )<br>\nA <strong>UUID is simply a 128-bit value</strong>.  if you display it in Hex format it will be <strong>32 character in length</strong>.<br>\nif you want in 10 place, 128/10=12.8 => 13 bit per place so you need 8192 alphabet !</p>\n\n<p>string in Golang encoded in UTF-8 so you may use Unicode alphabet:\nUnicode has enough code points, see: <a href=\"https://stackoverflow.com/questions/5924105/how-many-characters-can-be-mapped-with-unicode\">How many characters can be mapped with Unicode?</a>  </p>\n\n<p><strong>conclusion</strong>:<br>\nif you need Universally unique just use UUIDs.  </p>\n\n<p>and see: <a href=\"https://stackoverflow.com/questions/22892120/how-to-generate-a-random-string-of-a-fixed-length-in-golang\">How to generate a random string of a fixed length in golang?</a>  </p>\n\n<p>or if you need pseudo random string with length 10, you may use this (but not Universally unique):  </p>\n\n<pre><code>package main\n\nimport \"crypto/rand\"\nimport \"fmt\"\n\nfunc main() {\n    n := 5\n    b := make([]byte, n)\n    if _, err := rand.Read(b); err != nil {\n        panic(err)\n    }\n    s := fmt.Sprintf(\"%X\", b)\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>sample output:  </p>\n\n<pre><code>FA8EA2FBCE\n</code></pre>\n\n<p>also see:  <a href=\"https://stackoverflow.com/questions/37934162/output-uuid-in-go-as-a-short-string\">Output UUID in Go as a short string</a></p>\n\n<p>and:  <a href=\"https://stackoverflow.com/questions/15130321/is-there-a-method-to-generate-a-uuid-with-go-language\">Is there a method to generate a UUID with go language</a></p>\n"}], "owner": {"reputation": 297, "user_id": 4637393, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fd5e83c03caaad2804a0cb8b4ee0adf1?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/4637393/leviathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13511, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1470169397, "creation_date": 1468733090, "last_edit_date": 1470169397, "question_id": 38418171, "link": "https://stackoverflow.com/questions/38418171/how-to-generate-unique-random-string-in-a-length-range-using-golang", "title": "How to generate unique random string in a length range using Golang?", "body": "<p>I want to generate unique random string in a length range. For example, I set length is 10. and every time the generated string is unique . </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1468733258, "post_id": 38417297, "comment_id": 64243196, "body": "If this is a performance optimization, I would just <code>for task := range c {...}</code> in the processor(s). The scheduler will make your senders block when the channel buffer fills, allowing time for the processor(s) to run. It tends to work out okay. If there&#39;s another reason you want to control when what runs, you might get better answers by explaining it in a new question."}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1468723264, "creation_date": 1468723264, "answer_id": 38417415, "question_id": 38417297, "link": "https://stackoverflow.com/questions/38417297/how-to-handle-the-buffered-channel-properly-in-golang/38417415#38417415", "title": "How to handle the buffered channel properly in Golang?", "body": "<p>No, select is the only way to do it:</p>\n\n<pre><code>func (t *T) Send(v *Val) {\n    select {\n    case t.ch &lt;- v:\n    default:\n        // handle v directly\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1468724424, "creation_date": 1468724424, "answer_id": 38417503, "question_id": 38417297, "link": "https://stackoverflow.com/questions/38417297/how-to-handle-the-buffered-channel-properly-in-golang/38417503#38417503", "title": "How to handle the buffered channel properly in Golang?", "body": "<p>As was mentioned by @OneOfOne, select is really the only way to check if a channel is full.</p>\n\n<p>If you are using the channel to effect batch processing, you could always create an unbuffered channel and have a goroutine pull items and append to a slice.</p>\n\n<p>When the slice reaches a specific size, process the items.</p>\n\n<p>Here's an example on <a href=\"https://play.golang.org/p/98m3VrJPsO\" rel=\"nofollow\">play</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nconst BATCH_SIZE = 10\n\nfunc batchProcessor(ch &lt;-chan int) {\n    batch := make([]int, 0, BATCH_SIZE)\n    for i := range ch {\n        batch = append(batch, i)\n        if len(batch) == BATCH_SIZE {\n            fmt.Println(\"Process batch:\", batch)\n            time.Sleep(time.Second)\n            batch = batch[:0] // trim back to zero size\n        }\n    }\n    fmt.Println(\"Process last batch:\", batch)\n}\nfunc main() {\n    var wg sync.WaitGroup\n    ch := make(chan int)\n    wg.Add(1)\n    go func() {\n        batchProcessor(ch)\n        wg.Done()\n    }()\n    fmt.Println(\"Submitting tasks\")\n    for i := 0; i &lt; 55; i++ {\n        ch &lt;- i\n    }\n    close(ch)\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 2182, "user_id": 991076, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1a0377f4f9912163fc86713519db487f?s=128&d=identicon&r=PG", "display_name": "seaguest", "link": "https://stackoverflow.com/users/991076/seaguest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1468762038, "creation_date": 1468721638, "last_edit_date": 1495540289, "question_id": 38417297, "link": "https://stackoverflow.com/questions/38417297/how-to-handle-the-buffered-channel-properly-in-golang", "title": "How to handle the buffered channel properly in Golang?", "body": "<p>I have a channel which stores received data, I want to process it when one of following conditions is met:<br>\n1, the channel reaches its capacity.<br>\n2, the timer is fired since last process.</p>\n\n<p>I saw the post\n<a href=\"https://stackoverflow.com/questions/25657207/golang-how-to-know-a-buffered-channel-is-full\">Golang - How to know a buffered channel is full</a></p>\n\n<p><strong>Update:</strong></p>\n\n<p>I inspired from that post and OneOfOne's advice, here is the <a href=\"https://play.golang.org/p/byalcxHAu3\" rel=\"nofollow noreferrer\">play</a> :</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nvar c chan int\nvar timer *time.Timer\n\nconst (\n    capacity     = 5\n    timerDration = 3\n)\n\nfunc main() {\n    c = make(chan int, capacity)\n    timer = time.NewTimer(time.Second * timerDration)\n    go checkTimer()\n    go sendRecords(\"A\")\n    go sendRecords(\"B\")\n    go sendRecords(\"C\")\n\n    time.Sleep(time.Second * 20)\n}\n\nfunc sendRecords(name string) {\n    for i := 0; i &lt; 20; i++ {\n        fmt.Println(name+\" sending record....\", i)\n        sendOneRecord(i)\n        interval := time.Duration(rand.Intn(500))\n        time.Sleep(time.Millisecond * interval)\n    }\n}\n\nfunc sendOneRecord(record int) {\n    select {\n    case c &lt;- record:\n    default:\n        fmt.Println(\"channel is full !!!\")\n        process()\n        c &lt;- record\n        timer.Reset(time.Second * timerDration)\n    }\n}\n\nfunc checkTimer() {\n    for {\n        select {\n        case &lt;-timer.C:\n            fmt.Println(\"3s timer ----------\")\n            process()\n            timer.Reset(time.Second * timerDration)\n        }\n    }\n}\n\nfunc process() {\n    for i := 0; i &lt; capacity; i++ {\n        fmt.Println(\"process......\", &lt;-c)\n    }\n}\n</code></pre>\n\n<p>This seems to work fine, but I have a concern, I want to block the channel writing from other goroutine when process() is called, is the code above capable to do so? Or should I add a mutex at the beginning of the process method?</p>\n\n<p>Any elegant solution?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 8, "last_activity_date": 1468698567, "creation_date": 1468698567, "answer_id": 38414990, "question_id": 38414949, "link": "https://stackoverflow.com/questions/38414949/right-pattern-for-returning-slice-of-structs-from-function-in-golang/38414990#38414990", "title": "Right pattern for returning slice of structs from function in golang", "body": "<p>You just need to return the right type. Right now, you're returning <code>interface{}</code>, so you'd need to use a type assertion to get back to the actual type you want, but you can just change the function signature and return <code>[]SomeStruct</code> (a slice of <code>SomeStruct</code>s):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype SomeStruct struct {\n    Name       string\n    URL        string\n    StatusCode int\n}\n\nfunc main() {\n    something := doSomething()\n    fmt.Println(something)\n\n    for _, thing := range something {\n        fmt.Println(thing.Name)\n    }\n}\n\nfunc doSomething() []SomeStruct {\n    ServicesSlice := make([]SomeStruct, 0, 2)\n    ServicesSlice = append(ServicesSlice, SomeStruct{\"somename1\", \"someurl1\", 200})\n    ServicesSlice = append(ServicesSlice, SomeStruct{\"somename2\", \"someurl2\", 500})\n    return ServicesSlice\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/TdNQTYciTk\" rel=\"noreferrer\">https://play.golang.org/p/TdNQTYciTk</a></p>\n"}], "owner": {"reputation": 138, "user_id": 3458016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcba851bd2fc1974dad1af0cfe920cbe?s=128&d=identicon&r=PG&f=1", "display_name": "lutix", "link": "https://stackoverflow.com/users/3458016/lutix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9548, "favorite_count": 0, "accepted_answer_id": 38414990, "answer_count": 1, "score": 6, "last_activity_date": 1468714143, "creation_date": 1468698198, "last_edit_date": 1468714143, "question_id": 38414949, "link": "https://stackoverflow.com/questions/38414949/right-pattern-for-returning-slice-of-structs-from-function-in-golang", "title": "Right pattern for returning slice of structs from function in golang", "body": "<p>I'm relatively new to go and just trying to figure out what the right pattern is for returning a collection of structs from a function in go.  See the code below, I have been returning a slice of structs which then gets problematic when trying to iterate over it since I have to use an interface type.  See the example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype SomeStruct struct {\n    Name       string\n    URL        string\n    StatusCode int\n}\n\nfunc main() {\n    something := doSomething()\n    fmt.Println(something)\n\n    // iterate over things here but not possible because can't range on interface{}\n    // would like to do something like\n    //for z := range something {\n    //    doStuff(z.Name)\n    //}\n\n}\n\nfunc doSomething() interface{} {\n    ServicesSlice := []interface{}{}\n    ServicesSlice = append(ServicesSlice, SomeStruct{\"somename1\", \"someurl1\", 200})\n    ServicesSlice = append(ServicesSlice, SomeStruct{\"somename2\", \"someurl2\", 500})\n    return ServicesSlice\n}\n</code></pre>\n\n<p>From what I have read, everything seems to use type switch or ValueOf with reflect to get the specific value.  I think I'm just missing something here, as I feel passing data back and forth should be fairly straight forward.</p>\n"}, {"tags": ["sockets", "networking", "go", "ipv6"], "comments": [{"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1468774794, "post_id": 38413095, "comment_id": 64253902, "body": "One thing to note is that IPv6 extension headers are rarely used, and, unfortunately, many ISPs in a path will either block or strip extension headers because they can be used for attacks."}], "answers": [{"comments": [{"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "edited": false, "score": 0, "creation_date": 1468756950, "post_id": 38416264, "comment_id": 64248417, "body": "Thanks for your answer. I already noticed the part in the sources where the header is stripped but didn&#39;t know the reason for it. So i guess it&#39;s just not possible to do with the <code>net</code> package?!"}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "edited": false, "score": 0, "creation_date": 1468758846, "post_id": 38416264, "comment_id": 64248928, "body": "@fl0cke I think the net package is not sufficient here. You might get away with the Linux-specific <a href=\"http://man7.org/linux/man-pages/man7/packet.7.html\" rel=\"nofollow noreferrer\"><code>PF_PACKET</code></a> or BPF (available on a number of Unixes)."}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 3, "last_activity_date": 1468750641, "last_edit_date": 1468750641, "creation_date": 1468708531, "answer_id": 38416264, "question_id": 38413095, "link": "https://stackoverflow.com/questions/38413095/ipv6-packet-header-manipulation/38416264#38416264", "title": "IPv6 packet header manipulation", "body": "<p>Raw sockets with IPv6 are different compared to IPv4. Relevant for your case is <a href=\"https://tools.ietf.org/html/rfc3542\" rel=\"nofollow\">RFC 3542</a>. Note:</p>\n\n<blockquote>\n  <p>Another difference from IPv4 raw sockets is <strong>that complete packets (that is, IPv6 packets with extension headers) cannot be sent or received using the IPv6 raw sockets API.</strong> Instead, ancillary data objects are used to transfer the extension headers and hoplimit information, as described in Section 6.  <strong>Should an application need access to the complete IPv6 packet, some other technique</strong>, such as the datalink interfaces BPF or DLPI, must be used.</p>\n</blockquote>\n\n<hr>\n\n<p>You can find this out on your own. By running (and strace'ing) your program on my box for every packet I get:</p>\n\n<pre><code>recvfrom(3, \"\\x45\\x00\\x00\\x3c\\x6a\\x7d...\n               ^^\n</code></pre>\n\n<p>This means IP version = 4, IHL = 5 (20 bytes).</p>\n\n<p>When I try the same thing with IPv6 (i.e. your original code), I get something different every time:</p>\n\n<pre><code>recvfrom(3, \"\\xc6\\x22\\x00\\x50\\x4d\n</code></pre>\n\n<p>In this case every time the kernel is returning stuff starting directly with TCP (in this case the port is <code>50722</code>, i.e <code>0xC622</code>).</p>\n\n<p>Another interesting part should be noted in the <a href=\"https://golang.org/src/net/iprawsock_posix.go?s=1951:2010#L58\" rel=\"nofollow\">sources</a>:</p>\n\n<pre><code>switch sa := sa.(type) {\ncase *syscall.SockaddrInet4:\n    addr = &amp;IPAddr{IP: sa.Addr[0:]}\n    n = stripIPv4Header(n, b)\ncase *syscall.SockaddrInet6:\n    addr = &amp;IPAddr{IP: sa.Addr[0:], Zone: zoneToString(int(sa.ZoneId))}\n}\n</code></pre>\n\n<p>The header is stripped manually <strong>for IPv4</strong> but not for IPv6: for IPv6 there is nothing to remove.</p>\n\n<hr>\n\n<p>Note, there are mechanisms that will return extra information (but by no means the whole packet). For example the <code>IPV6_RECVPKTINFO</code> socket option will give you access to:</p>\n\n<pre><code>struct in6_pktinfo {\n    struct in6_addr ipi6_addr;    /* src/dst IPv6 address */\n    unsigned int    ipi6_ifindex; /* send/recv interface index */\n};\n</code></pre>\n\n<p>Similar options exist for the routing header option, hop limit etc.</p>\n"}], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 1, "accepted_answer_id": 38416264, "answer_count": 1, "score": 2, "last_activity_date": 1468750657, "creation_date": 1468685941, "last_edit_date": 1468750657, "question_id": 38413095, "link": "https://stackoverflow.com/questions/38413095/ipv6-packet-header-manipulation", "title": "IPv6 packet header manipulation", "body": "<p>I need to inspect and modify the IPv6 extension headers. So I set up a raw socket to listen for all IP packets on the local address.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net\"\n)\n\nfunc main() {\n    c, err := net.ListenIP(\"ip6:tcp\", &amp;net.IPAddr{\n        IP:   net.IPv6loopback,\n        Zone: \"\",\n    })\n    if err != nil {\n        panic(err)\n    }\n\n    buf := make([]byte, 1024)\n    for {\n        numRead, ipaddr, err := c.ReadFromIP(buf)\n        log.Print(numRead, ipaddr, err)\n        log.Printf(\"% X\\n\", buf[:numRead])\n    }\n}\n</code></pre>\n\n<p>I tried all the <code>Read*()</code> methods on the connection but it seems like they just return the payload without the header.\nSo my question is: <strong>How can I access the IPv6 header of a packet?</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 1, "creation_date": 1468691745, "post_id": 38412950, "comment_id": 64235630, "body": "Note that relative imports are discouraged: <a href=\"https://golang.org/cmd/go/#hdr-Relative_import_paths\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-Relative_import_paths</a> They are only meant to be used for simple experiments."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1468857276, "post_id": 38412950, "comment_id": 64287829, "body": "From your provided code I can&#39;t see the import loop. Also replace the relative import with an absolute import and let us know what happens."}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 9, "last_activity_date": 1468686615, "creation_date": 1468686615, "answer_id": 38413204, "question_id": 38412950, "link": "https://stackoverflow.com/questions/38412950/golang-import-cycle-not-allowed/38413204#38413204", "title": "Golang import cycle not allowed", "body": "<p>Yes, Go doesn't allow to have cycled imports. In your example you have 2 packages Config and Controllers. When you build a code, Controllers package requires Config package, then Config requires Controllers and it's endless. You should refactor your code to make Config package separated from Controllers, and only used by it. Also, you can make some common package, imported to Controllers and Config.</p>\n"}, {"tags": [], "owner": {"reputation": 1761, "user_id": 2340159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YaCQq.jpg?s=128&g=1", "display_name": "VithuBati", "link": "https://stackoverflow.com/users/2340159/vithubati"}, "is_accepted": false, "score": 6, "last_activity_date": 1507054462, "creation_date": 1507054462, "answer_id": 46550902, "question_id": 38412950, "link": "https://stackoverflow.com/questions/38412950/golang-import-cycle-not-allowed/46550902#46550902", "title": "Golang import cycle not allowed", "body": "<p>I got the same error. But in my case, I imported the package itself inside the file. so you can check if you did the same mistake. </p>\n"}], "owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23698, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1546757675, "creation_date": 1468684998, "last_edit_date": 1495540736, "question_id": 38412950, "link": "https://stackoverflow.com/questions/38412950/golang-import-cycle-not-allowed", "title": "Golang import cycle not allowed", "body": "<p>I am creating a restful api in GO and every method essentially interacts with the database. The specific statement that I use to open a database connection is</p>\n\n<pre><code>db,err := sql.Open(\"postgres\", \"user=postgres password=password dbname=dbname sslmode=disable\")\n    if err != nil {\n        log.Fatal(err)\n        println(err)\n\n    }\n</code></pre>\n\n<p>It is very simple but the issue is that once I want to change something inside that statement then I have to change it for all other methods that have that statement . I am trying to do a dependency injection or something of that nature so that I can have that statement or value in 1 place and just reference it. I am getting an import cycle not allowed error though like <a href=\"https://stackoverflow.com/questions/28256923/import-cycle-not-allowed\">Import cycle not allowed</a> . This is my project structure</p>\n\n<p><a href=\"https://i.stack.imgur.com/WHvb1.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/WHvb1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What I have done is that in the Config.go I have written this</p>\n\n<pre><code>package Config\n\nconst Connect  = \"user=postgres password=password dbname=dbname sslmode=disable\"\n</code></pre>\n\n<p>Then in the Listings.go I put this</p>\n\n<pre><code>package Controllers\n\nimport (\n    \"net/http\"\n    \"database/sql\"\n\n       \"../Config\"\n\n)\n\nfunc Listing_Expiration(w http.ResponseWriter, r *http.Request)  {\n\n\n        db,err := sql.Open(\"postgres\",Config.Connect)\n\n        if err != nil {\n            log.Fatal(err)\n            println(err)\n\n}\n</code></pre>\n\n<p>notice I have the import <strong>../Config</strong> and the <strong>Config.Connect</strong> but when I compile that I get import cycle not allowed . I have been trying to solve this issue but haven't been able to.</p>\n"}, {"tags": ["http", "go", "url-routing", "go-gin"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 2, "creation_date": 1468671872, "post_id": 38411056, "comment_id": 64230298, "body": "<code>server.GET(&quot;&#47;countries&#47;:code&quot;, GetCountries)</code>"}, {"owner": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1468672903, "post_id": 38411056, "comment_id": 64230571, "body": "*code is optional, :code will make it mandatory, that is not the objective."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1468673649, "post_id": 38411056, "comment_id": 64230813, "body": "Maybe play about with <code>server.RedirectTrailingSlash = false</code>"}, {"owner": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1468674396, "post_id": 38411056, "comment_id": 64231007, "body": "@MartinGallagher i just tried your suggestion, but it doesn&#39;t make any change."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1468676189, "post_id": 38411056, "comment_id": 64231431, "body": "Could be a limitation of Gin; this is my workaround: <a href=\"https://play.golang.org/p/Hmc2HOUQMD\" rel=\"nofollow noreferrer\">play.golang.org/p/Hmc2HOUQMD</a>"}, {"owner": {"reputation": 127, "user_id": 894244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85bbf28320ab67f4a9d88356a8a4ba9?s=128&d=identicon&r=PG", "display_name": "ktsakas", "link": "https://stackoverflow.com/users/894244/ktsakas"}, "edited": false, "score": 0, "creation_date": 1468681952, "post_id": 38411056, "comment_id": 64232894, "body": "It seems to match anything after and including the slash, so if you did &quot;/counties/usa/newyork&quot; it would match &quot;/usa/newyork&quot; keep that in mind if you end up using it."}], "owner": {"reputation": 1053, "user_id": 1870444, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5ebd5fcaa14dec84af11037ffdaa68bc?s=128&d=identicon&r=PG", "display_name": "SamTech", "link": "https://stackoverflow.com/users/1870444/samtech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489451912, "creation_date": 1468670954, "last_edit_date": 1489451912, "question_id": 38411056, "link": "https://stackoverflow.com/questions/38411056/go-gin-framework-gin-context-param-giving-wrong-values", "title": "Go gin-framework gin.Context.Param() giving wrong values", "body": "<p>Here is simple code that i am trying</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    server := gin.Default()\n\n    server.GET(\"/countries/*code\", GetCountries)\n    server.Run()\n}\n\nfunc GetCountries(c *gin.Context) {\n    ccode := c.Param(\"code\")\n    log.Printf(\"Code: %s\", ccode)\n}\n</code></pre>\n\n<p>I have extracted code from url and log it.\nHere is output after running and accessing urls</p>\n\n<pre><code>[GIN-debug] redirecting request 301: /countries --&gt; /countries/\nCode: /\n[GIN] 2016/07/16 - 17:24:59 | 200 |      16.508\ufffd\ufffds | ::1 |   GET     /countries/\nCode: /USA\n[GIN] 2016/07/16 - 17:25:17 | 200 |       12.47\ufffd\ufffds | ::1 |   GET     /countries/USA\n</code></pre>\n\n<p>In output, you can see, it is giving code along with the \"/\". \nIf there is no code in url still it is giving \"/\"</p>\n\n<p>Is it a bug or expected behaviour of gin?\nDo i need to check for \"/\" to know whether code is actually passed or not?</p>\n"}, {"tags": ["string", "algorithm", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": true, "score": 0, "last_activity_date": 1468693596, "last_edit_date": 1495541797, "creation_date": 1468693064, "answer_id": 38414189, "question_id": 38410633, "link": "https://stackoverflow.com/questions/38410633/html-template-parsing-extract-header-after-last-occurence-of-a-pattern-in-golang/38414189#38414189", "title": "HTML Template parsing extract header after last occurence of a pattern in Golang", "body": "<p>That depends on what the html input is. <a href=\"https://stackoverflow.com/a/1733489/1431317\">You may be able to get away with using regexp</a>, but if you're working with arbitrary html, you're going to have to use a full html parser, such as <a href=\"https://godoc.org/golang.org/x/net/html\" rel=\"nofollow noreferrer\">https://godoc.org/golang.org/x/net/html</a>.</p>\n\n<p>For example, using <a href=\"https://github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">goquery</a> (which uses x/net/html):</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"strings\"\n\n        \"github.com/PuerkitoBio/goquery\"\n)\n\nfunc main() {\n        h := `\n&lt;html&gt;\n &lt;body&gt;\n  &lt;a name=\"0\"&gt; text &lt;/a&gt;\n  &lt;a name=\"1\"&gt; abc &lt;/a&gt;\n  &lt;a name=\"2\"&gt; def ghi jkl &lt;/a&gt;\n  &lt;a name=\"3\"&gt; abc &lt;/a&gt;\n  &lt;a name=\"4\"&gt; Some text &lt;/a&gt;\n &lt;/body&gt;\n&lt;/html&gt;`\n\n        pattern := \"abc\"\n\n        doc, err := goquery.NewDocumentFromReader(strings.NewReader(h))\n        if err != nil {\n                panic(err)\n        }\n\n        doc.Find(\"a\").Each(func(i int, s *goquery.Selection) {\n                if strings.TrimSpace(s.Text()) == pattern {\n                        name, ok := s.Attr(\"name\")\n                        if ok {\n                                fmt.Println(name)\n                        }\n                }\n        })\n\n}\n</code></pre>\n\n<p>EDIT: or instead of the <code>doc.Find</code> part you may be able to use a <a href=\"https://api.jquery.com/contains-selector/\" rel=\"nofollow noreferrer\">contains selector</a> depending on your actual input:</p>\n\n<pre><code>// Don't do this if pattern is arbitrary user input\nname, ok := doc.Find(fmt.Sprintf(\"a:contains(%s)\", pattern)).Last().Attr(\"name\")\nif ok {\n        fmt.Println(name)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1143, "user_id": 370213, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/PH4vL.jpg?s=128&g=1", "display_name": "zhengchun", "link": "https://stackoverflow.com/users/370213/zhengchun"}, "is_accepted": false, "score": 0, "last_activity_date": 1477363757, "last_edit_date": 1477363757, "creation_date": 1477360558, "answer_id": 40230185, "question_id": 38410633, "link": "https://stackoverflow.com/questions/38410633/html-template-parsing-extract-header-after-last-occurence-of-a-pattern-in-golang/40230185#40230185", "title": "HTML Template parsing extract header after last occurence of a pattern in Golang", "body": "<p>you can use <a href=\"https://github.com/antchfx/xquery\" rel=\"nofollow\">xquery</a> that using XPath, its can simplify your code.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"github.com/antchfx/xquery/html\"\n    \"golang.org/x/net/html\"\n)\n\nfunc main() {\n    htmlstr := `&lt;html&gt;\n    &lt;body&gt;\n    &lt;a name=\"0\"&gt; text &lt;/a&gt;\n    &lt;a name=\"1\"&gt; abc &lt;/a&gt;\n    &lt;a name=\"2\"&gt; def ghi jkl &lt;/a&gt;\n    &lt;a name=\"3\"&gt; abc &lt;/a&gt;\n    &lt;a name=\"4\"&gt; Some text &lt;/a&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;`\n    root, err := html.Parse(strings.NewReader(htmlstr))\n    if err != nil {\n        panic(err)\n    }\n    node := htmlquery.FindOne(root, \"//a[normalize-space(text())='abc']\")\n    fmt.Println(htmlquery.InnerText(node))\n}\n</code></pre>\n"}], "owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 38414189, "answer_count": 2, "score": 0, "last_activity_date": 1477363757, "creation_date": 1468667799, "last_edit_date": 1468710629, "question_id": 38410633, "link": "https://stackoverflow.com/questions/38410633/html-template-parsing-extract-header-after-last-occurence-of-a-pattern-in-golang", "title": "HTML Template parsing extract header after last occurence of a pattern in Golang", "body": "<p>I have a HTML code as a golang string, out of which I want to extract a particular header, after the last occurence of a pattern. To explain with an example:</p>\n\n<pre><code>    func main() {\n    h := `\n&lt;html&gt;\n &lt;body&gt;\n  &lt;a name=\"0\"&gt; text &lt;/a&gt;\n  &lt;a name=\"1\"&gt; abc &lt;/a&gt;\n  &lt;a name=\"2\"&gt; def ghi jkl &lt;/a&gt;\n  &lt;a name=\"3\"&gt; abc &lt;/a&gt;\n  &lt;a name=\"4\"&gt; Some text &lt;/a&gt;\n &lt;/body&gt;\n&lt;/html&gt;`\n\n    pattern := \"abc\"\n\n    // Now I want &lt;a name=\"3\"&gt; to be printed. I mean, when someone\n    // searches for the pattern abc, the last occurence is the &lt;a&gt;\n    // section with the name \"3\". If the pattern is \"def\" then \"2\"\n    // should be printed, if the pattern is \"text\" then 4 should\n    // be printed\n\n}\n</code></pre>\n\n<p>Any idea how I can do this ? I played around with the templates and the Scanner packages but could not get it working.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6057744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BmyzeKrnqaI/AAAAAAAAAAI/AAAAAAAAABg/82ZOsRvSgIo/photo.jpg?sz=128", "display_name": "Tal", "link": "https://stackoverflow.com/users/6057744/tal"}, "edited": false, "score": 0, "creation_date": 1468651336, "post_id": 38408189, "comment_id": 64225334, "body": "I have tried &quot;Result: *result&quot; , and now i know what&#39;s wrong with my mind...Thanks for you time and answer!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 55, "user_id": 6057744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BmyzeKrnqaI/AAAAAAAAAAI/AAAAAAAAABg/82ZOsRvSgIo/photo.jpg?sz=128", "display_name": "Tal", "link": "https://stackoverflow.com/users/6057744/tal"}, "edited": false, "score": 0, "creation_date": 1468651395, "post_id": 38408189, "comment_id": 64225350, "body": "@Tal yes, <a href=\"https://gist.github.com/josephspurrier/7686b139f29601c3b370\" rel=\"nofollow noreferrer\">gist.github.com/josephspurrier/7686b139f29601c3b370</a> is a good read"}, {"owner": {"reputation": 55, "user_id": 6057744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BmyzeKrnqaI/AAAAAAAAAAI/AAAAAAAAABg/82ZOsRvSgIo/photo.jpg?sz=128", "display_name": "Tal", "link": "https://stackoverflow.com/users/6057744/tal"}, "edited": false, "score": 0, "creation_date": 1468652057, "post_id": 38408189, "comment_id": 64225510, "body": "Wow, these codes exactly seize my need. It has clear mind"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1468711573, "last_edit_date": 1468711573, "creation_date": 1468648054, "answer_id": 38408189, "question_id": 38408113, "link": "https://stackoverflow.com/questions/38408113/how-to-assgin-errorcodeint32-to-a-variableerrorcode-of-a-proto-data/38408189#38408189", "title": "how to assgin ErrorCode(int32) to a variable(*ErrorCode) of a proto data", "body": "<p>As a first test, if  <code>Result(*ErrorCode)</code> expects a pointer as its argument, you could at least give it one:</p>\n\n<pre><code>Result: &amp;result\n        ^      \n        - pointer to result\n</code></pre>\n\n<p>As this \"<a href=\"https://gist.github.com/josephspurrier/7686b139f29601c3b370\" rel=\"nofollow\">Golang - Asterisk and Ampersand Cheatsheet</a>\" (<a href=\"https://github.com/josephspurrier\" rel=\"nofollow\">Joseph Spurrier</a>) summarizes:</p>\n\n<pre><code>p := Person{\"Hillary\", 28}  stores the value\np := &amp;Person{\"Hillary\", 28}     stores the pointer address (reference)\nPrintPerson(p)          passes either the value or pointer address (reference)\nPrintPerson(*p)         passes the value\nPrintPerson(&amp;p)         passes the pointer address (reference)\n</code></pre>\n\n<p>Also \"<a href=\"http://piotrzurek.net/2013/09/20/pointers-in-go.html\" rel=\"nofollow\">Pointers in Go. Short tale of asterisk and ampersand.</a>\" from piotrzurek:</p>\n\n<ul>\n<li><p><code>&amp;</code> in front of variable name is used to retrieve the address of where this variable\u2019s value is stored. That address is what the pointer is going to store.</p></li>\n<li><p><code>*</code> in front of a type name, means that the declared variable will store an address of another variable of that type (not a value of that type).</p></li>\n<li><p><code>*</code> in front of a variable of pointer type is used to retrieve a value stored at given address. In Go speak this is called dereferencing.</p></li>\n</ul>\n\n<p>See <kbd><a href=\"https://play.golang.org/p/kdwhV55cj8\" rel=\"nofollow\">play.golang.org</a></kbd>.</p>\n"}], "owner": {"reputation": 55, "user_id": 6057744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BmyzeKrnqaI/AAAAAAAAAAI/AAAAAAAAABg/82ZOsRvSgIo/photo.jpg?sz=128", "display_name": "Tal", "link": "https://stackoverflow.com/users/6057744/tal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 1, "accepted_answer_id": 38408189, "answer_count": 1, "score": 2, "last_activity_date": 1468711573, "creation_date": 1468647272, "last_edit_date": 1468648119, "question_id": 38408113, "link": "https://stackoverflow.com/questions/38408113/how-to-assgin-errorcodeint32-to-a-variableerrorcode-of-a-proto-data", "title": "how to assgin ErrorCode(int32) to a variable(*ErrorCode) of a proto data", "body": "<p>There are my codes:</p>\n\n<pre><code>file1.go:\ntype ErrorCode Int32\nvar result ErrorCode\n\nfile2.pb.go:\ntype CollectionGC struct {\n    Result           *ErrorCode        `protobuf:\"varint,1,opt,name=result,enum=api.ErrorCode\" json:\"result,omitempty\"`\n    XXX_unrecognized []byte            `json:\"-\"`\n} \nmessageGC := &amp;CollectionGC {\n    Result: result,      // a error occurs\n}\n</code></pre>\n\n<p>That gives:</p>\n\n<pre><code>Invalid assignment from  result(ErrorCode) to Result(*ErrorCode), and fun CollectionGC.SetResult(value int32) is nonexisted in file2.pb.go. \n</code></pre>\n\n<p>How to avoid this error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1468647233, "post_id": 38407389, "comment_id": 64224439, "body": "do <a href=\"https://golang.org/pkg/strconv/#Quote\" rel=\"nofollow noreferrer\">strconv.Quote</a> or QuoteToASCII do what you&#39;re looking for?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1468654103, "last_edit_date": 1495539953, "creation_date": 1468643580, "answer_id": 38407732, "question_id": 38407389, "link": "https://stackoverflow.com/questions/38407389/library-package-in-go-that-handles-string-encoding/38407732#38407732", "title": "library/package in go that handles string encoding?", "body": "<p>No, Not exactly, but if you are looking for URL encoding, You can do all the URL encoding you want with the <code>net/url</code> package:<br>\nsee:  <a href=\"https://stackoverflow.com/questions/13820280/encode-decode-urls\">Encode / decode URLs</a><br>\nand:  <a href=\"https://stackoverflow.com/questions/20921619/is-there-any-example-and-usage-of-url-queryescape-for-golang\">Is there any example and usage of url.QueryEscape ? for golang</a>  </p>\n\n<p>sample code:  </p>\n\n<pre><code>fmt.Println(url.QueryEscape(\"https://stackoverflow.com/questions/tagged/go test\\r \\r\\n\"))\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>http%3A%2F%2Fstackoverflow.com%2Fquestions%2Ftagged%2Fgo+test%0D+%0D%0A\n</code></pre>\n\n<hr>\n\n<p>or write your own:  </p>\n\n<p>in Go string is <code>UTF-8</code> encoded, and is in effect a read-only slice of bytes:<br>\nyou may get bytes like this:  </p>\n\n<pre><code>str := \"UTF-8\"\nbytes := []byte(str)    //   string to slice\nfmt.Println(str, bytes) // UTF8 [85 84 70 45 56]\n</code></pre>\n\n<p>or convert bytes to string like this:  </p>\n\n<pre><code>s := string([]byte{85, 84, 70, 45, 56, 32, 0xc2, 0xb5}) // slice to string\nfmt.Println(s)                                          // UTF-8 \u00b5\n</code></pre>\n\n<p>0xC2 0xB5  is UTF-8 (hex) for Character 'MICRO SIGN' (U+00B5) see: <a href=\"http://www.fileformat.info/info/unicode/char/00b5/index.htm\" rel=\"nofollow noreferrer\">http://www.fileformat.info/info/unicode/char/00b5/index.htm</a>  </p>\n\n<p>also you may get bytes like this:  </p>\n\n<pre><code>for i := 0; i &lt; len(s); i++ {\n    fmt.Printf(\"%d: %d, \", i, s[i])\n    //0: 85, 1: 84, 2: 70, 3: 45, 4: 56, 5: 32, 6: 194, 7: 181,\n}\n</code></pre>\n\n<p>or in compact Hex format:  </p>\n\n<pre><code>fmt.Printf(\"% x\\n\", s) // 55 54 46 2d 38 20 c2 b5\n</code></pre>\n\n<p>and get runes (Unicode codepoints) like this:  </p>\n\n<pre><code>for i, v := range s {\n    fmt.Printf(\"%d: %v, \", i, v)\n    //0: 85, 1: 84, 2: 70, 3: 45, 4: 56, 5: 32, 6: 181, \n}\n</code></pre>\n\n<p>see: <a href=\"https://stackoverflow.com/questions/19310700/what-is-a-rune\">What is a rune?</a>  </p>\n\n<p>and convert rune to string:  </p>\n\n<pre><code>r := rune(181)\nfmt.Printf(\"%#U\\n\", r) // U+00B5 '\u00b5'\nst := \"this is UTF-8: \" + string(r)\nfmt.Println(st) // this is UTF-8: \u00b5\n</code></pre>\n\n<p>convert slice of runes to string:  </p>\n\n<pre><code>rs := []rune{181, 181, 181, 181}\nsr := string(rs)\nfmt.Println(sr) // \u00b5\u00b5\u00b5\u00b5\n</code></pre>\n\n<p>convert string to slice of runes:  </p>\n\n<pre><code>br := []rune(sr)\nfmt.Println(br) //[181 181 181 181]\n</code></pre>\n\n<p>The %q (quoted) verb will escape any non-printable byte sequences in a string so the output is unambiguous:</p>\n\n<pre><code>fmt.Printf(\"%+q \\n\", \"Hello, \u4e16\u754c\") // \"Hello, \\u4e16\\u754c\"\n</code></pre>\n\n<p><code>unicode.IsSpace</code> reports whether the rune is a space character as defined by Unicode's White Space property; in the Latin-1 space this is</p>\n\n<p>'\\t', '\\n', '\\v', '\\f', '\\r', ' ', U+0085 (NEL), U+00A0 (NBSP). \nsample code:  </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"unicode\"\n)\n\nfunc main() {\n    var buf bytes.Buffer\n    s := \"\\u4e16\\u754c \\u0020\\r\\n  \u4e16\u754c\"\n    for _, r := range s {\n        if unicode.IsSpace(r) {\n            buf.WriteString(fmt.Sprintf(\"\\\\u%04x\", r))\n        } else {\n            buf.WriteString(string(r))\n        }\n    }\n    st := buf.String()\n    fmt.Println(st)\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>\u4e16\u754c\\u0020\\u0020\\u000d\\u000a\\u0020\\u0020\u4e16\u754c\n</code></pre>\n\n<p>You can find more functions in the <code>unicode/utf8</code>, <code>unicode</code>, <code>strconv</code> and <code>strings</code> packages:<br>\n<a href=\"https://golang.org/pkg/unicode/utf8/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/unicode/utf8/</a><br>\n<a href=\"https://golang.org/pkg/unicode/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/unicode/</a><br>\n<a href=\"https://golang.org/pkg/strings/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/strings/</a><br>\n<a href=\"https://golang.org/pkg/strconv/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/strconv/</a></p>\n\n<p><a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">https://blog.golang.org/strings</a></p>\n"}], "owner": {"reputation": 113, "user_id": 6406168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28dd9fe5587c7b329b09858e1baf498f?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/6406168/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468654103, "creation_date": 1468639315, "question_id": 38407389, "link": "https://stackoverflow.com/questions/38407389/library-package-in-go-that-handles-string-encoding", "title": "library/package in go that handles string encoding?", "body": "<p>Are there any similar libraries/packages in go that emulate what <code>vis(3)</code> and <code>unvis(3)</code> do for BSD systems? I'm trying to do something that requires   representation of strings that contain special characters like whitespace and such.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 3397525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43854def0fe4142847afc456eb16f327?s=128&d=identicon&r=PG", "display_name": "TheOriginalAlex", "link": "https://stackoverflow.com/users/3397525/theoriginalalex"}, "edited": false, "score": 0, "creation_date": 1468640219, "post_id": 38407429, "comment_id": 64223212, "body": "Thank you!  That is a great solution."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1468639747, "creation_date": 1468639747, "answer_id": 38407429, "question_id": 38406461, "link": "https://stackoverflow.com/questions/38406461/find-struct-fields-recursively/38407429#38407429", "title": "Find struct fields recursively", "body": "<p>Here's one way to do it:</p>\n\n<pre><code>func findField(v interface{}, name string) reflect.Value {\n  // create queue of values to search. Start with the function arg.\n  queue := []reflect.Value{reflect.ValueOf(v)}\n  for len(queue) &gt; 0 {\n    v := queue[0]\n    queue = queue[1:]\n    // dereference pointers\n    for v.Kind() == reflect.Ptr {\n        v = v.Elem()\n    }\n    // ignore if this is not a struct\n    if v.Kind() != reflect.Struct {\n        continue\n    }\n    // iterate through fields looking for match on name\n    t := v.Type()\n    for i := 0; i &lt; v.NumField(); i++ {\n        if t.Field(i).Name == name {\n            // found it!\n            return v.Field(i)\n        }\n        // push field to queue\n        queue = append(queue, v.Field(i))\n    }\n  }\n  return reflect.Value{}\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/THfZm1wzFc\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 138, "user_id": 3397525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43854def0fe4142847afc456eb16f327?s=128&d=identicon&r=PG", "display_name": "TheOriginalAlex", "link": "https://stackoverflow.com/users/3397525/theoriginalalex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 38407429, "answer_count": 1, "score": 0, "last_activity_date": 1468639747, "creation_date": 1468627284, "question_id": 38406461, "link": "https://stackoverflow.com/questions/38406461/find-struct-fields-recursively", "title": "Find struct fields recursively", "body": "<p>If I have a struct like this:</p>\n\n<pre><code>var Foo struct {\n    Bar struct {\n        blah *bool\n    }\n}\n</code></pre>\n\n<p>And I send the struct to a function that takes an interface as a parameter, is there an easy way to use reflection to find the field \"blah\" by name using <code>inVal.FieldByName(\"blah\")</code>?</p>\n"}, {"tags": ["go", "package"], "answers": [{"comments": [{"owner": {"reputation": 1244, "user_id": 6236233, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/tZjOJ.jpg?s=128&g=1", "display_name": "JonDoe297", "link": "https://stackoverflow.com/users/6236233/jondoe297"}, "edited": false, "score": 0, "creation_date": 1468625141, "post_id": 38406248, "comment_id": 64221058, "body": "Thank you. I just found it."}], "tags": [], "owner": {"reputation": 138, "user_id": 3397525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43854def0fe4142847afc456eb16f327?s=128&d=identicon&r=PG", "display_name": "TheOriginalAlex", "link": "https://stackoverflow.com/users/3397525/theoriginalalex"}, "is_accepted": true, "score": 2, "last_activity_date": 1468625081, "creation_date": 1468625081, "answer_id": 38406248, "question_id": 38406195, "link": "https://stackoverflow.com/questions/38406195/after-install-a-golang-package-it-doesnt-work/38406248#38406248", "title": "After install a golang package, it doesn&#39;t work", "body": "<p>You'll need to add $GOPATH/bin to your $PATH.</p>\n"}], "owner": {"reputation": 1244, "user_id": 6236233, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/tZjOJ.jpg?s=128&g=1", "display_name": "JonDoe297", "link": "https://stackoverflow.com/users/6236233/jondoe297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 38406248, "answer_count": 1, "score": 0, "last_activity_date": 1468625087, "creation_date": 1468624510, "question_id": 38406195, "link": "https://stackoverflow.com/questions/38406195/after-install-a-golang-package-it-doesnt-work", "title": "After install a golang package, it doesn&#39;t work", "body": "<p>I'm new on golang. According this <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow\">instructions</a>, to install <code>go-bindata</code>, I should use this command:</p>\n\n<pre><code>$ go get -u github.com/jteeuwen/go-bindata/...\n</code></pre>\n\n<p>I did it. After that, I checked on <code>$GOPATH/src/jteeuwen/go-bindata/</code> and there's a file <code>go-bindata.a</code>. It seems like it was installed, but it doesn't work:</p>\n\n<pre><code>$ go-bindata\n-bash: go-bindata: command not found\n</code></pre>\n\n<p>Please, what am I doing wrong?</p>\n\n<p><strong>EDIT:</strong> I'm using OS X</p>\n"}, {"tags": ["bash", "go", "makefile"], "answers": [{"tags": [], "owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "is_accepted": true, "score": 3, "last_activity_date": 1468623725, "creation_date": 1468623725, "answer_id": 38406104, "question_id": 38406036, "link": "https://stackoverflow.com/questions/38406036/make-rule-in-makefile-always-succeed/38406104#38406104", "title": "Make rule in makefile always succeed", "body": "<p>You can tell make to ignore errors in a recipe by prepending <code>-</code>:</p>\n\n<pre><code>-kill -9 $$(lsof -t bin/* 2&gt;/dev/null) 2&gt;/dev/null\n</code></pre>\n"}], "owner": {"reputation": 2138, "user_id": 600641, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c60af2cd46678a4657058110d6488454?s=128&d=identicon&r=PG", "display_name": "kirugan", "link": "https://stackoverflow.com/users/600641/kirugan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 38406104, "answer_count": 1, "score": 2, "last_activity_date": 1468623725, "creation_date": 1468623149, "question_id": 38406036, "link": "https://stackoverflow.com/questions/38406036/make-rule-in-makefile-always-succeed", "title": "Make rule in makefile always succeed", "body": "<p>Here is my makefile for my golang project:</p>\n\n<pre><code>.PHONY: killall\n\nrun: install\n   ./bin/chunkserver&amp;; ./bin/master&amp;\n\ninstall: clean\n    go install godfs/chunkserver godfs/master\n\nclean: killall\n    rm -f bin/master bin/chunkserver\n\nkillall:\n    kill -9 $$(lsof -t bin/* 2&gt;/dev/null) 2&gt;/dev/null\n</code></pre>\n\n<p>When I run <code>make install</code> it shows this error:</p>\n\n<pre><code>make: *** [killall] Error 2\n</code></pre>\n\n<p>I need return some code to make to indicate that <code>killall</code> rule is always succeed, but I don`t know how.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1468650040, "post_id": 38405771, "comment_id": 64225072, "body": "Both template packages do not offer functionalities to do this."}], "answers": [{"tags": [], "owner": {"reputation": 7065, "user_id": 4275413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/diRiJ.png?s=128&g=1", "display_name": "Jakumi", "link": "https://stackoverflow.com/users/4275413/jakumi"}, "is_accepted": false, "score": 0, "last_activity_date": 1468945735, "creation_date": 1468945735, "answer_id": 38463948, "question_id": 38405771, "link": "https://stackoverflow.com/questions/38405771/how-to-get-list-of-parameters-in-a-template/38463948#38463948", "title": "How to get list of parameters in a template?", "body": "<p>I would assume you could walk through the <a href=\"https://golang.org/pkg/text/template/parse/#Tree\" rel=\"nofollow\">parse.Tree</a> that is inside both html/template.Template as well as text/template.Template. You'd have to check every node in the tree recursively to see if it's a FieldNode or not (and I don't really know, how variables defined within a template - like in a range operator - are handled). If all fields are as simple as in your example, you could probably just plain-text search your template ... ;o)</p>\n"}], "owner": {"reputation": 15751, "user_id": 1345655, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2f01aca0b4d2d9347a6fd0f16f24d084?s=128&d=identicon&r=PG", "display_name": "Kshitiz Sharma", "link": "https://stackoverflow.com/users/1345655/kshitiz-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468945735, "creation_date": 1468621379, "last_edit_date": 1468622233, "question_id": 38405771, "link": "https://stackoverflow.com/questions/38405771/how-to-get-list-of-parameters-in-a-template", "title": "How to get list of parameters in a template?", "body": "<p>Using Templates how can I get list parameters that are defined in a template. For example if I have the template: </p>\n\n<pre><code>t, _ := template.New(\"template_name\").Parse(\"&lt;h1&gt;{{.title}}&lt;/h1&gt;r{{.release}}\")\n</code></pre>\n\n<p>How can I get <code>title</code> and <code>release</code>? I intend to iterate over list of parameters and search them in multiple locations. How this could be done is not clear from the template documentation.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-sqs"], "answers": [{"comments": [{"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1468655205, "post_id": 38405464, "comment_id": 64226239, "body": "How can I create a scenario for partial success and test it?"}, {"owner": {"reputation": 6220, "user_id": 3846053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7994a1f62b40a2bb94ef32205331b01?s=128&d=identicon&r=PG&f=1", "display_name": "Shibashis", "link": "https://stackoverflow.com/users/3846053/shibashis"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1468729672, "post_id": 38405464, "comment_id": 64242616, "body": "Try sending a invalid msg id in the batch delete request."}], "tags": [], "owner": {"reputation": 6220, "user_id": 3846053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7994a1f62b40a2bb94ef32205331b01?s=128&d=identicon&r=PG&f=1", "display_name": "Shibashis", "link": "https://stackoverflow.com/users/3846053/shibashis"}, "is_accepted": true, "score": 1, "last_activity_date": 1468619356, "creation_date": 1468619356, "answer_id": 38405464, "question_id": 38405181, "link": "https://stackoverflow.com/questions/38405181/aws-sdk-sqs-how-identify-messages-that-were-not-deleted-in-batchdeleteoperation/38405464#38405464", "title": "AWS-SDK: SQS How identify messages that were not deleted in BatchDeleteOperation", "body": "<p>In case of partial success when performing batch deletes, the service would return a 200 ok and the response object will have two fields Successful and Failed. </p>\n\n<p>The Failed will have list of \"BatchResultErrorEntry\" type of objects containing the message ids and reason for failures.</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 1747819, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/369ccd1fb7fb6afaa9b76409ea0b2131?s=128&d=identicon&r=PG", "display_name": "user1747819", "link": "https://stackoverflow.com/users/1747819/user1747819"}, "is_accepted": false, "score": 1, "last_activity_date": 1512112524, "last_edit_date": 1512112524, "creation_date": 1512112296, "answer_id": 47588319, "question_id": 38405181, "link": "https://stackoverflow.com/questions/38405181/aws-sdk-sqs-how-identify-messages-that-were-not-deleted-in-batchdeleteoperation/47588319#47588319", "title": "AWS-SDK: SQS How identify messages that were not deleted in BatchDeleteOperation", "body": "<p>You can get a list of all failed messages using the <a href=\"http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/sqs/model/DeleteMessageBatchResult.html#getFailed--\" rel=\"nofollow noreferrer\"><code>DeleteMessageBatchResult.getFailed()</code></a> method call.</p>\n"}], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 38405464, "answer_count": 2, "score": 0, "last_activity_date": 1512112524, "creation_date": 1468617594, "question_id": 38405181, "link": "https://stackoverflow.com/questions/38405181/aws-sdk-sqs-how-identify-messages-that-were-not-deleted-in-batchdeleteoperation", "title": "AWS-SDK: SQS How identify messages that were not deleted in BatchDeleteOperation", "body": "<pre><code>deleteMessagesParams := &amp;sqs.DeleteMessageBatchInput{\n        Entries:  messagesToDelete, // array of type *sqs.DeleteMessageBatchRequestEntry\n        QueueUrl: aws.String(QUEUE_URL),\n}\n\nif resp , err := svc.DeleteMessageBatch(deleteMessagesParams); err != nil {\n    log.Println(\"Batch Delete Failed: \", err.Error())\n}else{\n     log.Println(\"Batch Delete Successful: \", resp)\n}\n</code></pre>\n\n<p>I'm using batch delete in SQS. When the batch deletion operation is successful, resp contains the MessageId's of messages for which deletion is successful.</p>\n\n<p>In-case of error or when some messages are not deleted from the queue, will the err contain MessageId's for which batch Deletion failed??</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 10170, "user_id": 1916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487430ca3c1389e98a3c39c3910de8ef?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/1916/greg"}, "edited": false, "score": 2, "creation_date": 1468653798, "post_id": 38403341, "comment_id": 64225926, "body": "Are you running using the App Engine SDK? (goapp or dev_appserver?) Your code shouldn&#39;t be calling ListenAndServe if so. And if not, then this isn&#39;t an app engine question..."}, {"owner": {"reputation": 781, "user_id": 1951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/404a9144a9a673dc754bdacd56d25f6f?s=128&d=identicon&r=PG", "display_name": "morras", "link": "https://stackoverflow.com/users/1951414/morras"}, "reply_to_user": {"reputation": 10170, "user_id": 1916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487430ca3c1389e98a3c39c3910de8ef?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/1916/greg"}, "edited": false, "score": 0, "creation_date": 1468864729, "post_id": 38403341, "comment_id": 64291809, "body": "Thanks alot Greg you where right, I did not need to ListenAndServe. However once I removed that nothing worked when I accessed via home.mydomain.com/ but that was because I didn&#39;t listen for it, so I added --host 10.0.0.2 to my command and it worked"}], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 1951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/404a9144a9a673dc754bdacd56d25f6f?s=128&d=identicon&r=PG", "display_name": "morras", "link": "https://stackoverflow.com/users/1951414/morras"}, "is_accepted": true, "score": 0, "last_activity_date": 1468908420, "creation_date": 1468908420, "answer_id": 38450700, "question_id": 38403341, "link": "https://stackoverflow.com/questions/38403341/gae-go-only-serves-paths-on-localhost-not-domain/38450700#38450700", "title": "GAE go only serves paths on localhost not domain", "body": "<p>As Greg pointed out, when I was using goapp I did not need to also call ListenAndServe.\nTo get goapp to listen for requests outside of localhost I also had to add --host \"my laptops ip\" to the command.</p>\n"}], "owner": {"reputation": 781, "user_id": 1951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/404a9144a9a673dc754bdacd56d25f6f?s=128&d=identicon&r=PG", "display_name": "morras", "link": "https://stackoverflow.com/users/1951414/morras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 38450700, "answer_count": 1, "score": 2, "last_activity_date": 1468908420, "creation_date": 1468609064, "question_id": 38403341, "link": "https://stackoverflow.com/questions/38403341/gae-go-only-serves-paths-on-localhost-not-domain", "title": "GAE go only serves paths on localhost not domain", "body": "<p>I am messing around with a small go app for google app engine locally using the appengine sdk.</p>\n\n<p>I have a problem where a path different than root can only be served if I try to hit it using localhost, but not a domain name. </p>\n\n<p>My setup is as follows.</p>\n\n<ul>\n<li>home.mydomain.com points to my home ip adress</li>\n<li>My home router forwards incoming tcp and udp on port 80 to my laptop on port 8080</li>\n<li>My laptop is running Windows 10</li>\n<li>My go version is go1.6 windows/amd64</li>\n</ul>\n\n<p>My app.yaml:</p>\n\n<pre><code>application: tasks\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url:  /.*\n  script: _go_app\n</code></pre>\n\n<p>Minimum example code:</p>\n\n<pre><code>func init() {\n    fileHandler := http.FileServer(http.Dir(\"../frontend\"))\n\n    http.HandleFunc(\"/loggedout\", testHandler)\n    http.Handle(\"/\", fileHandler)\n\n    log.Print(http.ListenAndServe(\":8080\", nil))\n}\n\nfunc testHandler(res http.ResponseWriter, req *http.Request){    \n    panic(\"JUST NEED THIS TO WORK\")\n}\n</code></pre>\n\n<p>My symptoms is that if I access localhost:8080/ I get my website, and if I access localhost:8080/loggedout I get the expected panic.<br>\nIf I access home.mydomain.com/ I get my website, however if I access home.mydomain.com/loggedout the connection just hangs, in chromes network tab it is listed as pending indefinitely.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6406168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28dd9fe5587c7b329b09858e1baf498f?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/6406168/steve"}, "edited": false, "score": 0, "creation_date": 1468607428, "post_id": 38402647, "comment_id": 64214059, "body": "Are you saying that these bits are masked? I tried doing something like (Perm() &amp; ModeSticky), but I don&#39;t think this it he right way to go about it ..."}, {"owner": {"reputation": 558, "user_id": 2533697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161457cc8ea09193afd152b532d04233?s=128&d=identicon&r=PG&f=1", "display_name": "CorbinMc", "link": "https://stackoverflow.com/users/2533697/corbinmc"}, "reply_to_user": {"reputation": 113, "user_id": 6406168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28dd9fe5587c7b329b09858e1baf498f?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/6406168/steve"}, "edited": false, "score": 0, "creation_date": 1468609125, "post_id": 38402647, "comment_id": 64214997, "body": "I updated my answer with more specific instructions. Masking <code>Perm()</code> with anything won&#39;t help. The mode bits you&#39;re looking for have already been masked out of the value <code>Perm()</code> returns. You need to go access the variable further back, before the value is masked."}, {"owner": {"reputation": 113, "user_id": 6406168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28dd9fe5587c7b329b09858e1baf498f?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/6406168/steve"}, "edited": false, "score": 0, "creation_date": 1468633703, "post_id": 38402647, "comment_id": 64222398, "body": "Great thanks! I just needed to tweak my implementation a bit."}], "tags": [], "owner": {"reputation": 558, "user_id": 2533697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161457cc8ea09193afd152b532d04233?s=128&d=identicon&r=PG&f=1", "display_name": "CorbinMc", "link": "https://stackoverflow.com/users/2533697/corbinmc"}, "is_accepted": true, "score": 1, "last_activity_date": 1468609483, "last_edit_date": 1468609483, "creation_date": 1468606251, "answer_id": 38402647, "question_id": 38402311, "link": "https://stackoverflow.com/questions/38402311/unable-to-obtain-all-permission-bits/38402647#38402647", "title": "unable to obtain all permission bits", "body": "<p><strong>Short Answer:</strong> The three upper bits ARE special and need to be accessed separately. </p>\n\n<p><strong>Long Answer:</strong> The <a href=\"https://golang.org/pkg/os/#FileMode\" rel=\"nofollow\">documentation</a> explains that the 9 (out of usually 12) least significant bits are considered the standard Unix permissions.</p>\n\n<p>The documentation also defines the behavior of the <code>Perm()</code> function you are calling:</p>\n\n<pre><code>func (m FileMode) Perm() FileMode\n\nPerm returns the Unix permission bits in m.\n</code></pre>\n\n<p>This means that perm is not defined to return any of the additional bits you are looking for.</p>\n\n<p>Furthermore, the <a href=\"https://golang.org/src/os/types.go?s=1044:1064#L20\" rel=\"nofollow\">source code</a> shows that the <code>Perm()</code> function is masking the value returned from <code>FileMode()</code> with <code>0777</code> causing the initial three bits to be disregarded.</p>\n\n<p>The <code>ModeSetuid</code>, <code>ModeSetgid</code>, and <code>ModeSticky</code> bits (4, 2, and 1 respectively) must each be accessed individually as constants of the <code>FileMode</code> type. Do this by performing your own masks. </p>\n\n<p>In order to determine whether the sticky bit is set, for example, do \n     <code>(FileInfo().Mode() &amp; ModeSticky) != 0</code>. The same applies for <code>ModeSetuid</code> and <code>ModSetgid</code>.</p>\n"}], "owner": {"reputation": 113, "user_id": 6406168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28dd9fe5587c7b329b09858e1baf498f?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/6406168/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 38402647, "answer_count": 1, "score": 2, "last_activity_date": 1468639933, "creation_date": 1468604848, "last_edit_date": 1468639933, "question_id": 38402311, "link": "https://stackoverflow.com/questions/38402311/unable-to-obtain-all-permission-bits", "title": "unable to obtain all permission bits", "body": "<p>On my shell, I have a file and I change the permissions of this file with <code>sudo chmod 4755 &lt;file&gt;</code>. Upon calling <code>lstat</code> on this file, I'm seeing correct information about its permissions, specifically that it has 4755 as its permission mode.</p>\n\n<p>In my golang program, is there a reason why I'm not getting the correct permission mode bits? Could it be that I'm just formatting the result I get from FileInfo().Mode().Perm() incorrectly? Could it be that the upper 3 bits are \"special\"?</p>\n\n<p>Thanks for the help!</p>\n"}]