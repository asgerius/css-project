[{"tags": ["go", "interface", "type-conversion"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542867112, "post_id": 53421702, "comment_id": 93723893, "body": "That&#39;s probably not how interfaces are used in Go. I have t oadmit I have no idea what you are trying to do."}, {"owner": {"reputation": 125, "user_id": 6612380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa0045894d0e5a7e44d813c8dece5369?s=128&d=identicon&r=PG&f=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/6612380/matthieu"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542880918, "post_id": 53421702, "comment_id": 93730731, "body": "Ok, first this is not for a serious project, this is just me toying around. My goal here is to see if I can create an API with absolutely zero coupling what so ever using some kind of duck-typing. The user doesn&#39;t know anything about the provider and the provider doesn&#39;t know anything about the user, they are hosted on separated gits, and can&#39;t import from one another. The wiring is done by dependency-injection. The user tells what it needs (interface A2) and the provider what it provide (interface A). And I was hoping that A could be converted to A2 since the interfaces are the same."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 6612380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa0045894d0e5a7e44d813c8dece5369?s=128&d=identicon&r=PG&f=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/6612380/matthieu"}, "edited": false, "score": 0, "creation_date": 1542881212, "post_id": 53422939, "comment_id": 93730933, "body": "The point here is to toy around and see the limit of the language, not about writing idiomatic go. (See my 1st comment on the question.) I was aware of the problems with redefining built-in types and with the slice of interfaces. But this is yet-another case where I can&#39;t implicitly convert from one interface to another..."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 125, "user_id": 6612380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa0045894d0e5a7e44d813c8dece5369?s=128&d=identicon&r=PG&f=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/6612380/matthieu"}, "edited": false, "score": 0, "creation_date": 1542991335, "post_id": 53422939, "comment_id": 93773196, "body": "@Matthieu Yes, this is intentional."}], "tags": [], "owner": {"reputation": 1539, "user_id": 423292, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/682568435d3372e1385b671da7f1f793?s=128&d=identicon&r=PG", "display_name": "David Jones", "link": "https://stackoverflow.com/users/423292/david-jones"}, "is_accepted": false, "score": 2, "last_activity_date": 1542852514, "creation_date": 1542852514, "answer_id": 53422939, "question_id": 53421702, "link": "https://stackoverflow.com/questions/53421702/duck-typing-how-to-implicitly-convert-from-an-interface-to-another-interface-in/53422939#53422939", "title": "Duck typing: How to implicitly convert from an interface to another interface in go", "body": "<p>Go provides type checking as a feature, not a bug.  When you declare B and B2 to be separate types, the compiler respects this distinction and treats them differently.</p>\n\n<p>A familiar example is <code>time.Duration</code>, which is just an <code>int64</code> to count nanoseconds, but you cannot mix and match variables that are <code>int64</code> and <code>time.Duration</code> without an explicit type conversion. <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow noreferrer\">see time.Duration docs</a></p>\n\n<p>Rather than trying to work around Go's type checking feature, you should try to learn how to express your algorithm using idiomatic Go.</p>\n"}], "owner": {"reputation": 125, "user_id": 6612380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa0045894d0e5a7e44d813c8dece5369?s=128&d=identicon&r=PG&f=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/6612380/matthieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542965396, "creation_date": 1542841672, "last_edit_date": 1542965396, "question_id": 53421702, "link": "https://stackoverflow.com/questions/53421702/duck-typing-how-to-implicitly-convert-from-an-interface-to-another-interface-in", "title": "Duck typing: How to implicitly convert from an interface to another interface in go", "body": "<p>I'm new to go and I wish to make two packages with (very) loosely coupled API between a uses and a provider. For this, I wish to use go's ability to implicitly implement interfaces and implicit conversion.</p>\n\n<p>Both the provider and the user have their own defined interfaces (for exemple provider returns a provider.A and user accepts a user.A).\nWith this pattern, I can convert from one type to the other instead of importing the interfaces from another package.</p>\n\n<p>This works fine with simple interfaces, but as soon as a method takes an interfaces as an input, the conversion from one type to the other become impossible. </p>\n\n<p>Why doesn't go allow this kind of conversion? Is there any workaround?</p>\n\n<p>working example:</p>\n\n<pre><code>package main\n\n// Provider\n\ntype A interface{\n    AddString(string)\n}\n\n\ntype a struct{\n    b string\n}\nfunc (a *a) AddString(b string) {\n    a.b = b\n}\nfunc NewA() A {\n    return &amp;a{nil}\n}\n\n\n// User\n\ntype A2 interface{\n    AddString(string)\n}\n\nfunc Main() {\n    var _ A2 = NewA()\n}\n</code></pre>\n\n<p>example that cause problems:</p>\n\n<pre><code>package main\n\n// Provider\n\ntype A interface{\n    AddB(B)\n}\ntype B interface{}\n\n\ntype a struct{\n    b B\n}\nfunc (a *a) AddB(b B) {\n    a.b = b\n}\nfunc NewA() A {\n    return &amp;a{nil}\n}\n\n\n// User\n\ntype A2 interface{\n    AddB(B2)\n}\ntype B2 interface{}\n\nfunc Main() {\n    var _ A2 = NewA() // error..\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "owner": {"reputation": 21, "user_id": 10621142, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2-_8SnHxQnE/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA25wj2EvxI9UVMjIIgoX9KIOOnjg/mo/photo.jpg?sz=128", "display_name": "JJJ HHH", "link": "https://stackoverflow.com/users/10621142/jjj-hhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542839541, "creation_date": 1542839541, "question_id": 53421361, "link": "https://stackoverflow.com/questions/53421361/how-to-use-setpoollimit-to-manage-the-connections", "title": "How to use setPoolLimit to manage the connections?", "body": "<p>I'm building an application by using golang with mongodb atlas which has a max connections. I tried to use \"session.SetPoolLimit(5)\" to ensure that there is no more than 5 connections at the same time. However, it did not work.</p>\n\n<pre><code>var originSession *mgo.Session\nfunc query(wg *sync.WaitGroup)  {\n    mySession := originSession.Copy()\n    var items []interface{}\n    mySession.DB(\"testdb\").C(\"test\").Find(nil).All(&amp;items)\n    time.Sleep(1500)\n    mySession.Close()\n    wg.Done()\n}\nfunc main() {\n    originSession, _ = mgo.Dial(connectString) // connect to server\n    defer originSession.Close()\n    originSession.SetPoolLimit(5)\n    var wg sync.WaitGroup\n    for i:=0; i&lt;50;i++{\n        wg.Add(1)\n          go getInfoBackWithSleep(&amp;wg)\n        }\n    wg.Wait()\n}\n</code></pre>\n\n<p>I used db.serverStatus().connections to check the number of connections.</p>\n\n<p>{ \"current\" : 1, \"available\" : 99, \"totalCreated\" : xxx}</p>\n\n<p>{ \"current\" : 50, \"available\" : 50, \"totalCreated\" : xxx}</p>\n\n<p>{ \"current\" : 1, \"available\" : 99, \"totalCreated\" : xxx}</p>\n\n<p>To my understanding, the setPoolLimit(5) should keep the \"current\" not more than (1+5)=6. But it did not block other sessions that comes behind the first 5 sessions.</p>\n\n<p>However, If I change the limit to 1. (setPoolLimit(1))  It would only let one single connection work at the same time while block others. Seems the pool limit only work if I set it as 1.</p>\n"}, {"tags": ["sql", "postgresql", "go", "timestamp"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1542841652, "post_id": 53421338, "comment_id": 93717787, "body": "It&#39;s the <code>21</code> that&#39;s out of range because postgres timestamps are by default MM-DD-YYYY ... . So just switch 21 with 11 and you&#39;re good to go."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542842051, "post_id": 53421338, "comment_id": 93717917, "body": "... alternatively you can change the datestyle setting with <code>SET datestyle TO dmy;</code> (<a href=\"https://www.postgresql.org/docs/9.4/datatype-datetime.html#DATATYPE-DATETIME-OUTPUT2-TABLE\" rel=\"nofollow noreferrer\">postgresql.org/docs/9.4/&hellip;</a>)"}, {"owner": {"reputation": 1502, "user_id": 7289321, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rsT6dTD4JPc/AAAAAAAAAAI/AAAAAAAAAC4/xvjVuJ-doR8/photo.jpg?sz=128", "display_name": "dwir182", "link": "https://stackoverflow.com/users/7289321/dwir182"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542849661, "post_id": 53421338, "comment_id": 93719749, "body": "@mkopriva please put in proper form not in comment.. :)"}, {"owner": {"reputation": 43, "user_id": 5583655, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2063233f9be519d7595b2496cb7ad850?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/5583655/robert"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542888802, "post_id": 53421338, "comment_id": 93735400, "body": "@mkopriva I did that already before so I tought it was not a problem, BUT it turns out that I have to execute that sql before each write to the db. Wierd but it works now."}], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542856326, "creation_date": 1542856326, "answer_id": 53423337, "question_id": 53421338, "link": "https://stackoverflow.com/questions/53421338/how-to-insert-timestamp-to-postgresql-database/53423337#53423337", "title": "How to insert timestamp to postgreSQL database", "body": "<p>I can see that <code>datetime</code> variable is <code>string</code> type. I don't know why you must convert <code>time.Time</code> to <code>string</code> before exec query.<br>\nIf define <code>date</code> column in <code>readings</code> table is <code>TIMESTAMP</code>, you can exec query like this<br>\n<code>Db.Exec(SqlStatement, currentTime, temp, humi)</code></p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 5583655, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2063233f9be519d7595b2496cb7ad850?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/5583655/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1542888961, "creation_date": 1542888961, "answer_id": 53430828, "question_id": 53421338, "link": "https://stackoverflow.com/questions/53421338/how-to-insert-timestamp-to-postgresql-database/53430828#53430828", "title": "How to insert timestamp to postgreSQL database", "body": "<p>Solved it by adding </p>\n\n<pre><code>SET datestyle TO dmy;\n</code></pre>\n\n<p>Before each</p>\n\n<pre><code>_, err = Db.Exec(SqlStatement, datetime, temp, humi)\n</code></pre>\n\n<p>So now I have two Db.Exec functions in a row, one is sending \"SET datestyle TO dmy\" and the other is this one that is sending actual data.</p>\n\n<p>Wierd.</p>\n"}], "owner": {"reputation": 43, "user_id": 5583655, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2063233f9be519d7595b2496cb7ad850?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/5583655/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2977, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542888961, "creation_date": 1542839400, "last_edit_date": 1542872926, "question_id": 53421338, "link": "https://stackoverflow.com/questions/53421338/how-to-insert-timestamp-to-postgresql-database", "title": "How to insert timestamp to postgreSQL database", "body": "<p>I have a problem inserting timestamp to my psql database using Go.</p>\n\n<p>I form my timestamp with this line:</p>\n\n<pre><code>datetime := currentTime.Format(\"02-01-2006 15:04:05\")\n</code></pre>\n\n<p>My sql query is:</p>\n\n<pre><code>SqlStatement := `\n            INSERT INTO readings (date, temp, humi)\n            VALUES ($1, $2, $3)`\n</code></pre>\n\n<p>And then my call to the psql DB is:</p>\n\n<pre><code>_, err = Db.Exec(SqlStatement, datetime, temp, humi)\n</code></pre>\n\n<p>(As you can see I have some other variables here but they are not causing any problems.)</p>\n\n<p>When I execute my code I get this error:</p>\n\n<blockquote>\n  <p>pq: date/time field value out of range: \"21-11-2018 22:19:59\"</p>\n</blockquote>\n\n<p>Which as I understand it means that the format is not correct.</p>\n\n<p>YET when I input exact same query directly to psql console it successfully adds record(line) to the table.   </p>\n\n<pre><code>INSERT INTO readings (date, temp, humi)  VALUES ('02-01-2006 15:04:05', 20, 30);\n</code></pre>\n\n<p>Side note: This code worked ok before I changed column type from character(20) to timestamp, I even tried incorporating CAST in the SQL but I got the same error.</p>\n"}, {"tags": ["bash", "ubuntu", "go", "opengl"], "comments": [{"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 1, "creation_date": 1542839073, "post_id": 53420975, "comment_id": 93716972, "body": "First try to &#39;echo $DISPLAY&#39; to check if the variable is there, then try &#39;export DISPLAY&#39;, then run your program."}, {"owner": {"reputation": 471, "user_id": 7841421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8156ee9808993682d6e6fcc919af05?s=128&d=identicon&r=PG&f=1", "display_name": "oriont", "link": "https://stackoverflow.com/users/7841421/oriont"}, "reply_to_user": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 1, "creation_date": 1542839472, "post_id": 53420975, "comment_id": 93717103, "body": "When I run &#39;echo $DISPLAY&#39;, a blank line shows up. I tried &#39;export DISPLAY&#39; and ran my program, and I got the same error. After that, I echoed it again and it was still a blank line."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 1, "creation_date": 1542840040, "post_id": 53420975, "comment_id": 93717282, "body": "Are you running as root or using su ? How are you building your program ?"}, {"owner": {"reputation": 471, "user_id": 7841421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8156ee9808993682d6e6fcc919af05?s=128&d=identicon&r=PG&f=1", "display_name": "oriont", "link": "https://stackoverflow.com/users/7841421/oriont"}, "reply_to_user": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 1, "creation_date": 1542840605, "post_id": 53420975, "comment_id": 93717439, "body": "I am using &#39;go run main.go&#39;, with main.go containing all my code. I just tried &#39;sudo go run main.go&#39; with the same result."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 1, "creation_date": 1542841677, "post_id": 53420975, "comment_id": 93717794, "body": "Try go build, then execute the resulting executable"}], "answers": [{"comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1542891226, "post_id": 53422338, "comment_id": 93736720, "body": "You didn&#39;t mention you were using Windows Subsystem for Linux. This is important information. That is a stripped down &quot;Linux&quot; which only supports command line programs, not GUI programs. To run a Linux GUI program, you need to run a full installation of Linux, not just WSL."}], "tags": [], "owner": {"reputation": 471, "user_id": 7841421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8156ee9808993682d6e6fcc919af05?s=128&d=identicon&r=PG&f=1", "display_name": "oriont", "link": "https://stackoverflow.com/users/7841421/oriont"}, "is_accepted": false, "score": -1, "last_activity_date": 1542888749, "last_edit_date": 1542888749, "creation_date": 1542846811, "answer_id": 53422338, "question_id": 53420975, "link": "https://stackoverflow.com/questions/53420975/golang-opengl-error-platformerror-x11-the-display-environment-variable-is-miss/53422338#53422338", "title": "Golang OpenGL Error PlatformError: X11: The DISPLAY environment variable is missing panic: NotInitialized: The GLFW library is not initialized", "body": "<p>My solution is to literally install GoLang and TDM-GCC on windows, and do it through the command prompt INSTEAD OF BASH.</p>\n"}], "owner": {"reputation": 471, "user_id": 7841421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8156ee9808993682d6e6fcc919af05?s=128&d=identicon&r=PG&f=1", "display_name": "oriont", "link": "https://stackoverflow.com/users/7841421/oriont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1041, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543002952, "creation_date": 1542837177, "last_edit_date": 1543002952, "question_id": 53420975, "link": "https://stackoverflow.com/questions/53420975/golang-opengl-error-platformerror-x11-the-display-environment-variable-is-miss", "title": "Golang OpenGL Error PlatformError: X11: The DISPLAY environment variable is missing panic: NotInitialized: The GLFW library is not initialized", "body": "<p>I just cannot seem to get opengl with golang to work. I wanted to try out golang but it has been such a pain to even set up, and now I can't get something I copy pasted off of <a href=\"https://kylewbanks.com/blog/tutorial-opengl-with-golang-part-1-hello-opengl\" rel=\"nofollow noreferrer\">this website</a>. Here is the code I am using: <a href=\"https://pastebin.com/Wzwdc586\" rel=\"nofollow noreferrer\">(from the website)</a>. I did these two commands before running it (using wsl on windows):</p>\n\n<pre><code>go get github.com/go-gl/gl/v4.1-core/gl\ngo get github.com/go-gl/glfw/v3.2/glfw\n</code></pre>\n\n<p>And this is the full error I am getting:</p>\n\n<pre><code>2018/11/21 13:43:33 PlatformError: X11: The DISPLAY environment variable is missing\npanic: NotInitialized: The GLFW library is not initialized\n\ngoroutine 1 [running, locked to thread]:\ngithub.com/go-gl/glfw/v3.2/glfw.acceptError(0x0, 0x0, 0x0, 0x1, 0xc000099ee0)\n        /home/oriont/dev/src/github.com/go-gl/glfw/v3.2/glfw/error.go:173 +0x1d1\ngithub.com/go-gl/glfw/v3.2/glfw.panicError()\n        /home/oriont/dev/src/github.com/go-gl/glfw/v3.2/glfw/error.go:184 +0x32\ngithub.com/go-gl/glfw/v3.2/glfw.WindowHint(0x20003, 0x0)\n        /home/oriont/dev/src/github.com/go-gl/glfw/v3.2/glfw/window.go:235 +0x38\nmain.initGlfw(0x4ded35)\n        /home/oriont/dev/super g/main.go:71 +0x54\nmain.main()\n        /home/oriont/dev/super g/main.go:45 +0x2b\nexit status 2\n</code></pre>\n\n<p>And if you are curious, my go env:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOCACHE=\"/home/oriont/.cache/go-build\"\nGOEXE=\"\"\nGOFLAGS=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/oriont/dev\"\nGOPROXY=\"\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go-1.11\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/lib/go-1.11/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nGOMOD=\"\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build854283259=/tmp/go-build -gno-record-gcc-switches\"\n</code></pre>\n\n<p>Any help would be appreciated, thanks!</p>\n\n<p>EDIT:</p>\n\n<p>Now I am getting a new error, after reinstalling go and removing a failed attempt at sdl2 (from apt-get remove).</p>\n\n<p>(OLD) This is the new error:</p>\n\n<pre><code># _/home/oriont/dev/super_g\n/usr/lib/go-1.11/pkg/tool/linux_amd64/link: running gcc failed: exit status 1\n/usr/bin/ld: cannot find -lXrandr\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I have all of the same code still. Also, I did try to run 'go build' but it just threw the exact same error as 'go run main.go'.</p>\n\n<p>EDIT 2:</p>\n\n<p>I reinstalled go 1.11.2 and installed the libglfw3 and libglfw3-dev packages on sudo apt-get install. Now, I have the same old error.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542833727, "post_id": 53420303, "comment_id": 93714940, "body": "Run different commands on different platforms"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542833812, "post_id": 53420303, "comment_id": 93714977, "body": "@zerkms - can you please provide example on which commands?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1542834947, "post_id": 53420303, "comment_id": 93715474, "body": "seeing as we don&#39;t know if you are on plan9 or windows 98 the guesswork is yours :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1542835103, "post_id": 53420303, "comment_id": 93715548, "body": "@Vorsprung - well,I mean just for win10/darwin latest and linux latest"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1542835381, "post_id": 53420303, "comment_id": 93715657, "body": "@Vorsprung - but any example which can run on win10 and linux will be sufficient for me"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1542836800, "post_id": 53420674, "comment_id": 93716215, "body": "Thanks 1+ , It will be great if you can add to the example or linux or windows (which is more simple to you) the complite  test that i put , this will help to understand this trick better . thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1542836852, "post_id": 53420674, "comment_id": 93716228, "body": "I mean put the test inside your code and which is command to call ...this is what I missing here ..."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1542836418, "last_edit_date": 1542836418, "creation_date": 1542835562, "answer_id": 53420674, "question_id": 53420303, "link": "https://stackoverflow.com/questions/53420303/how-to-test-for-execution-process/53420674#53420674", "title": "How to test for execution process", "body": "<p>Use Go build tags or file names. For example, for Linux and Windows:</p>\n\n<p><code>a_linux_test.go</code> (Linux file name):</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc TestLinuxA(t *testing.T) {\n    t.Log(\"Linux A\")\n}\n</code></pre>\n\n<p><code>l_test.go</code> (Linux build tag):</p>\n\n<pre><code>// +build linux\n\npackage main\n\nimport \"testing\"\n\nfunc TestLinuxL(t *testing.T) {\n    t.Log(\"Linux L\")\n}\n</code></pre>\n\n<p><code>a_windows_test.go</code> (Windows file name):</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc TestWindowsA(t *testing.T) {\n    t.Log(\"Windows A\")\n}\n</code></pre>\n\n<p><code>w_test.go</code> (Windows build tag):</p>\n\n<pre><code>// +build windows\n\npackage main\n\nimport \"testing\"\n\nfunc TestWindowsW(t *testing.T) {\n    t.Log(\"Windows W\")\n}\n</code></pre>\n\n<p>Output (on Linux):</p>\n\n<pre><code>$ go test -v\n=== RUN   TestLinuxA\n--- PASS: TestLinuxA (0.00s)\n    a_linux_test.go:6: Linux A\n=== RUN   TestLinuxL\n--- PASS: TestLinuxL (0.00s)\n    l_test.go:8: Linux L\nPASS\n$ \n</code></pre>\n\n<p>Output (on Windows):</p>\n\n<pre><code>&gt;go test -v\n=== RUN   TestWindowsA\n--- PASS: TestWindowsA (0.00s)\n    a_windows_test.go:6: Windows A\n=== RUN   TestWindowsW\n--- PASS: TestWindowsW (0.00s)\n    w_test.go:8: Windows W\nPASS\n&gt;\n</code></pre>\n\n<hr>\n\n<p>References:</p>\n\n<p><a href=\"https://golang.org/pkg/go/build/\" rel=\"nofollow noreferrer\">Package build</a></p>\n\n<p><a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">Package testing</a></p>\n\n<p><a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">Command go</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 53420674, "answer_count": 1, "score": 1, "last_activity_date": 1542872944, "creation_date": 1542833548, "last_edit_date": 1542872944, "question_id": 53420303, "link": "https://stackoverflow.com/questions/53420303/how-to-test-for-execution-process", "title": "How to test for execution process", "body": "<p>This code is executing commands for binary and return <code>std.out</code> and <code>std.error</code></p>\n\n<pre><code>func exe(bin string, args string, path string) (string, error string) {\n\n    cmd := exec.Command(bin, strings.Split(args, \" \")...)\n    cmd.Dir = path\n    stdoutBuf := &amp;bytes.Buffer{}\n    cmd.Stdout = stdoutBuf\n    stdErrBuf := &amp;bytes.Buffer{}\n    cmd.Stderr = stdErrBuf\n    cmd.Run()\n    return stdoutBuf.String(), stdErrBuf.String()\n}\n</code></pre>\n\n<p>The problem that I don't know how to run a good test for it which will be supported in each system\ne.g. if I try to run \"echo\" command the test run on Darwin and Linux but not on windows. how I should do it?</p>\n\n<pre><code>func Test_execute(t *testing.T) {\n    type args struct {\n        bin  string\n        args string\n        path string\n    }\n    tests := []struct {\n        name       string\n        args       args\n        wantString string\n        wantError  string\n    }{\n        // TODO: Add test cases.\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            gotString, gotError := exe(tt.args.bin, tt.args.args, tt.args.path)\n            if gotString != tt.wantString {\n                t.Errorf(\"exe() gotString = %v, want %v\", gotString, tt.wantString)\n            }\n            if gotError != tt.wantError {\n                t.Errorf(\"exe() gotError = %v, want %v\", gotError, tt.wantError)\n            }\n        })\n    }\n}\n</code></pre>\n\n<p>I've searched on it and found this,\n<a href=\"https://www.joeshaw.org/testing-with-os-exec-and-testmain/\" rel=\"nofollow noreferrer\">https://www.joeshaw.org/testing-with-os-exec-and-testmain/</a>\nBut now sure how to combine the env with my test...</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1542830447, "post_id": 53419447, "comment_id": 93713566, "body": "You can implement <code>(*myT) UnmarshalJSON(b []byte) error</code>, but you still have to decide what <code>color.Color</code> implementation you are going to unmarshal to."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1542830513, "post_id": 53419447, "comment_id": 93713601, "body": "That being said, if you are dealing with RGBA components, I would start using <code>color.RGBA</code> instead of <code>color.Color</code>."}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 6329132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d61b0bc7a965f5d0b43526a86d8fee?s=128&d=identicon&r=PG", "display_name": "Christopher Phillips", "link": "https://stackoverflow.com/users/6329132/christopher-phillips"}, "is_accepted": false, "score": 1, "last_activity_date": 1542831884, "creation_date": 1542831884, "answer_id": 53419969, "question_id": 53419447, "link": "https://stackoverflow.com/questions/53419447/how-to-marshal-and-unmarshal-a-color-palette-to-json-in-go/53419969#53419969", "title": "How to Marshal and Unmarshal a color palette to JSON in Go?", "body": "<p>I would follow Tim's advice and start using color.RGBA, but if you're interested in how to implement custom UnmarshalJSON functions for your custom types I've outline the code below and here: <a href=\"https://play.golang.org/p/8p5a09993GV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8p5a09993GV</a></p>\n\n<p>Basically you use the UnmarshalJSON func as a middle layer to decode to the \"correct\" RGBA type and then do some type conversion fu to get it to become the interface you want on your custom myT type. </p>\n\n<p>Again, it might be easier to use color.RGBA instead of color.Color in the overall implementation, but this is HOW you would convert it if you wanted to.</p>\n\n<p>Here is a good gist that goes into the basics:\n<a href=\"https://gist.github.com/mdwhatcott/8dd2eef0042f7f1c0cd8\" rel=\"nofollow noreferrer\">https://gist.github.com/mdwhatcott/8dd2eef0042f7f1c0cd8</a></p>\n\n<p>A gopher academy blog post that really does some fun stuff:\n<a href=\"https://blog.gopheracademy.com/advent-2016/advanced-encoding-decoding/\" rel=\"nofollow noreferrer\">https://blog.gopheracademy.com/advent-2016/advanced-encoding-decoding/</a></p>\n\n<p>And a good explanation on why a <code>[]struct</code> does not 1/1 match a <code>[]interface</code> it might implement:\n<a href=\"https://stackoverflow.com/questions/12994679/golang-slice-of-struct-slice-of-interface-it-implements\">golang: slice of struct != slice of interface it implements?</a> </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"image/color\"\n    \"image/color/palette\"\n)\n\ntype myT struct {\n    P []color.Color\n}\n\nfunc main() {\n    t := myT{palette.WebSafe}\n    b, err := json.Marshal(t)\n    e(\"json.Marshal\", err)\n    t2 := myT{}\n    err = json.Unmarshal(b, &amp;t2)\n    e(\"json.Unmarshal\", err)\n    fmt.Println(string(b))\n    fmt.Println(string(t2))\n}\n\nfunc e(s string, err error) {\n    if err != nil {\n        fmt.Println(s, err)\n    }\n}\n\nfunc (myt *myT) UnmarshalJSON(b []byte) error {\n    var tempJson struct {\n        P []color.RGBA\n    }\n    // Unmarshal to our temp struct\n    err := json.Unmarshal(b, &amp;tempJson)\n    if err != nil {\n        return err\n    }\n    // convert our new friends O(n) to the interface type\n    newColors := make([]color.Color, len(tempJson.P))\n    for i, v := range tempJson.P {\n        newColors[i] = color.Color(v)\n    }\n    myt.P = newColors\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543420101, "creation_date": 1542829325, "last_edit_date": 1543420101, "question_id": 53419447, "link": "https://stackoverflow.com/questions/53419447/how-to-marshal-and-unmarshal-a-color-palette-to-json-in-go", "title": "How to Marshal and Unmarshal a color palette to JSON in Go?", "body": "<p>I want to store a custom color palette inside a JSON file, but the palette has the type <code>[]color.Color</code> (that is an interface and not a concrete type). When I marshal the palette I get something like this:</p>\n\n<pre><code>[{\"R\":0,\"G\":0,\"B\":0,\"A\":255},{\"R\":0,\"G\":0,\"B\":51,\"A\":255}...]\n</code></pre>\n\n<p>The problem is, when I unmarshal that JSON the type <code>[]color.Color</code> does not work, because Go cannot create a concrete type underneath that interface.</p>\n\n<p>I have simplified my code to following example:</p>\n\n<pre><code>type myT struct {\n    P []color.Color\n}\n\nfunc main() {\n    t := myT{palette.WebSafe}\n    b, err := json.Marshal(t)\n    e(\"json.Marshal\", err)\n    t2 := myT{}\n    err = json.Unmarshal(b, &amp;t2)\n    e(\"json.Unmarshal\", err)\n    fmt.Println(string(b))\n}\n\nfunc e(s string, err error) {\n    if err != nil {\n        fmt.Println(s, err)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/QYIpJ7L1ete\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QYIpJ7L1ete</a></p>\n\n<p>Is there a simple solution or do I have to transform <code>[]color.Color</code> to <code>[]color.RGBA</code>?</p>\n"}, {"tags": ["go", "go-xorm"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542822111, "post_id": 53417403, "comment_id": 93709765, "body": "A <code>boolean</code> in MySQL <i>IS</i> a <code>tinyint</code>. Any particular reason the column was specified as a <code>tinyint</code> instead of a <code>boolean</code>? This could have been avoided by having the database handle it."}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 3, "last_activity_date": 1542823742, "creation_date": 1542823742, "answer_id": 53418167, "question_id": 53417403, "link": "https://stackoverflow.com/questions/53417403/convert-bool-to-tinyint-golang/53418167#53418167", "title": "Convert bool to tinyint golang", "body": "<p>I'm not sure what/if <code>xorm</code> can do about it, but you can just create a type and implement the <code>Valuer</code> and <code>Scanner</code> interfaces for it. Here is an example I did a pull request for using a <code>bit(1)</code> for a <code>bool</code>.</p>\n\n<p><a href=\"https://github.com/jmoiron/sqlx/blob/master/types/types.go#L152\" rel=\"nofollow noreferrer\">https://github.com/jmoiron/sqlx/blob/master/types/types.go#L152</a></p>\n\n<p>For an integer, you would just return the <code>int</code> instead of a <code>[]byte</code> containing the <code>int</code>. Like so:</p>\n\n<pre><code>type IntBool bool\n\n// Value implements the driver.Valuer interface,\n// and turns the IntBool into an integer for MySQL storage.\nfunc (i IntBool) Value() (driver.Value, error) {\n    if i {\n        return 1, nil\n    }\n    return 0, nil\n}\n\n// Scan implements the sql.Scanner interface,\n// and turns the int incoming from MySQL into an IntBool\nfunc (i *IntBool) Scan(src interface{}) error {\n    v, ok := src.(int)\n    if !ok {\n        return errors.New(\"bad int type assertion\")\n    }\n    *i = v == 1\n    return nil\n}\n</code></pre>\n\n<p>Then your struct would just use the new type</p>\n\n<pre><code>type myStruct struct {\n    isDeleted IntBool `xorm:\"'isDeleted' tinyint(3)\"`\n}\n</code></pre>\n\n<p>But, again, is there any particular reason you declared this boolean value as a <code>tinyint</code>? MySQL <strong>has</strong> a boolean type and things would just work.</p>\n"}], "owner": {"reputation": 357, "user_id": 5228669, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8395ddf630d68d3940d0d493c2e79c44?s=128&d=identicon&r=PG&f=1", "display_name": "00robinette", "link": "https://stackoverflow.com/users/5228669/00robinette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3030, "favorite_count": 0, "accepted_answer_id": 53418167, "answer_count": 1, "score": 1, "last_activity_date": 1542823742, "creation_date": 1542820562, "question_id": 53417403, "link": "https://stackoverflow.com/questions/53417403/convert-bool-to-tinyint-golang", "title": "Convert bool to tinyint golang", "body": "<p>I am using the latest version of xorm and want to create a simple go struct as follows:</p>\n\n<pre><code>types myStruct struct {\n    isDeleted bool `xorm:\"'isDeleted' tinyint(3)\"`\n}\n</code></pre>\n\n<p>I know the bool type in go evaluates to true and false, but I need to map it to a mySql database where the values are tinyint(3) and 1 maps to true and 0 to false. In the example above no matter what my post requests look like isDeleted always evaluates to 0. Thanks in advance for any advice on this issue. This <a href=\"https://github.com/go-xorm/xorm/issues/673\" rel=\"nofollow noreferrer\">https://github.com/go-xorm/xorm/issues/673</a> may provide some context. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1542819331, "post_id": 53417003, "comment_id": 93708396, "body": "Exactly as is says, the <code>u</code> declared inside the block is not used (the actual error will tell you the exact line). There&#39;s no magic here, and the error is probably saving you from a bug in your code."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1542819440, "post_id": 53417003, "comment_id": 93708455, "body": "The short variable declaration will create new <code>u</code> and <code>err</code> variables, because <code>u</code> is not declared in the same block. Redeclaration can only happen if the variable was declared in the same block."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1542820867, "post_id": 53417003, "comment_id": 93709201, "body": "Can&#39;t believe nobody used the one sentence that clears everything up: <code>u, err :=</code> is a declare and assign of both <code>u</code> and <code>err</code> inside a block, <i>masking</i> the <code>var u string</code> declared in a higher scope."}], "answers": [{"comments": [{"owner": {"reputation": 28211, "user_id": 846381, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/704042123/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/846381/david"}, "edited": false, "score": 0, "creation_date": 1542877644, "post_id": 53417111, "comment_id": 93728720, "body": "Thanks for the comment. What still seems to escape me a little is how to access the set value of a variable set within a logic block. Take for example a simple - if { u=&quot;bob1&quot;}else{ u = &quot;bob2&quot;} log.Printf(u)"}], "tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 0, "last_activity_date": 1542820420, "last_edit_date": 1542820420, "creation_date": 1542819555, "answer_id": 53417111, "question_id": 53417003, "link": "https://stackoverflow.com/questions/53417003/go-declared-and-not-used-logic/53417111#53417111", "title": "Go declared and not used logic", "body": "<p>Please pay attention that:</p>\n\n<pre><code>u, err := url.Parse(\"http://bing.com/search?q=dotnet\")\n</code></pre>\n\n<p>in this line of code you have block scoped variable <code>u</code> which is differ from those one which declared in line: <code>var u string</code>, hence you have this error.\n<br>Moreover here you have shadowing for variable <code>u</code> from outer block scope which may lead to bugs, see this:</p>\n\n<pre><code>var u string\nu = \"blank\"\n{\n    u, err := url.Parse(\"http://bing.com/search?q=dotnet\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"%#v\", u)\n}\nlog.Printf(\"%#v\", u)\n</code></pre>\n\n<p>Result will be:</p>\n\n<pre><code>2018/11/21 19:12:33 &amp;url.URL{Scheme:\"http\", Opaque:\"\", User:(*url.Userinfo)(nil), Host:\"bing.com\", Path:\"/search\", RawPath:\"\", ForceQuery:false, RawQuery:\"q=dotnet\", Fragment:\"\"}\n2018/11/21 19:12:33 \"blank\"\n</code></pre>\n\n<p>As you can see here you have even different data types, and variable <code>u</code> not changed after this block.</p>\n"}], "owner": {"reputation": 28211, "user_id": 846381, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/704042123/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/846381/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "closed_date": 1542822649, "answer_count": 1, "score": -3, "last_activity_date": 1542822960, "creation_date": 1542819225, "question_id": 53417003, "link": "https://stackoverflow.com/questions/53417003/go-declared-and-not-used-logic", "closed_reason": "Duplicate", "title": "Go declared and not used logic", "body": "<p>Take this incredibly simple example. which shows variable assignment in and out of a block.</p>\n\n<p>On compilation this results in: <code>u declared and not used</code></p>\n\n<pre><code>var u string\n{\n    u, err := url.Parse(\"http://bing.com/search?q=dotnet\")\n    if err != nil {\n        log.Fatal(err)\n    }\n}\nlog.Debug(u)\n</code></pre>\n\n<p>This simulates a logic block during which we might assess several things and set a var to the value we like depending on logic evaluation. How is this possible?</p>\n"}, {"tags": ["go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7650072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5ea407eaaf693fc2b80ee99bb2b4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mou", "link": "https://stackoverflow.com/users/7650072/mou"}, "edited": false, "score": 0, "creation_date": 1542842937, "post_id": 53419689, "comment_id": 93718205, "body": "So basically, the reason why some Websockets fail are unclosed Websockets? Datachan gets data when some data is changed in the database - so it only sends data when it is data. As long as there is an active websocket connection it should be open - in case something changes."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 63, "user_id": 7650072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5ea407eaaf693fc2b80ee99bb2b4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mou", "link": "https://stackoverflow.com/users/7650072/mou"}, "edited": false, "score": 0, "creation_date": 1542853092, "post_id": 53419689, "comment_id": 93720434, "body": "All evidence suggests that the websocket connection was closed because the user navigated away or closed the webpage.  Nothing in the code posted will inform the sender to <code>dataChan</code> that the connection is closed."}, {"owner": {"reputation": 63, "user_id": 7650072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5ea407eaaf693fc2b80ee99bb2b4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mou", "link": "https://stackoverflow.com/users/7650072/mou"}, "edited": false, "score": 0, "creation_date": 1542883985, "post_id": 53419689, "comment_id": 93732632, "body": "I tested your approach above and it seems to work - thank you very much for your help!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1542858765, "last_edit_date": 1542858765, "creation_date": 1542830508, "answer_id": 53419689, "question_id": 53416399, "link": "https://stackoverflow.com/questions/53416399/close-sent-on-server-side-but-client-side-has-still-connection/53419689#53419689", "title": "Close sent on server side but client side has still connection", "body": "<p>The <code>websocket: close sent</code> error indicates that the server sent a close message to the client. Because the application server code does not send the message, the message must have been sent by the connection in response to a close message from the client.  </p>\n\n<p>The close message is returned as an error from the websocket read methods. Because there are no messages logged, the client must have sent the 'going away' close message (the only error not logged).</p>\n\n<p>When the websocket connection returns an error, the reading and writing goroutines close the connection and return. The connection is not left open. </p>\n\n<p>The reading and writing goroutines do not detect that the other has closed the connection until an error is returned from a method call on the connection. The reading goroutine quickly detects the closed connection because it's always reading, but there can be a delay for the writing goroutine. This may be a problem for the application</p>\n\n<p>To get the writing goroutine to exit quickly, signal writing goroutine using a channel. It's possible that <code>dataChan</code> can be used for this purpose, but I don't know for sure because the question does not include information about how the channel is managed.  Assuming that the channel can be used, the reading goroutine should close <code>dataChan</code>.  The writer should detect the closed channel and exit the goroutine:</p>\n\n<pre><code>...\nfor {\n    select {\n    case data, ok := &lt;-datachan:\n        if !ok {\n           // Done writing, return\n           return\n        }\n        ws.SetWriteDeadline(time.Now().Add(writeWait))\n        err := ws.WriteJSON(&amp;data)\n        if err != nil {\n            conf.Log.Debugf(\"Failed to write data to Websocket: %v\", err)\n            return\n        }\n        ...\n</code></pre>\n\n<p>This is the approach used by the <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"nofollow noreferrer\">Gorilla Chat Example</a>.</p>\n\n<p>If <code>dataChan</code> cannot be used, introduce a new channel just for this purpose. Create the channel in the handler and pass the channel to the reading and writing goroutines:</p>\n\n<pre><code> done := make(chan struct{})\n go allUserWebsocketWriter(ws, stop, datachan)\n go PingResponse(ws, stop)\n</code></pre>\n\n<p>Close the channel on return from the reading goroutine:</p>\n\n<pre><code>func PingResponse(ws *websocket.Conn, done chan struct{}) {\n    defer close(done)\n    conf := storage.GetConfig()\n    ...\n</code></pre>\n\n<p>Select on the channel in the writing gorountine:</p>\n\n<pre><code>...\nfor {\n    select {\n    case &lt;-done:\n        return\n    case data := &lt;-datachan:\n        ws.SetWriteDeadline(time.Now().Add(writeWait))\n        err := ws.WriteJSON(&amp;data)\n        ...\n</code></pre>\n\n<p>This causes the writing goroutine to quickly exit after the reading goroutine exits. </p>\n\n<p>This is the approach used by the <a href=\"https://github.com/gorilla/websocket/tree/master/examples/command\" rel=\"nofollow noreferrer\">Gorilla Command Example</a>.</p>\n\n<p>Both of these approaches reduce the likelihood that write on the connection returns the <code>websocket: close sent</code> error, but they do not eliminate the possibility.  The error is expected because the reading goroutine can close the connection just before the writing goroutine writes a message.</p>\n\n<p>In any case, the evidence is that the client is closing the connection.  Unclosed connections are not whatever the issue is.</p>\n"}], "owner": {"reputation": 63, "user_id": 7650072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5ea407eaaf693fc2b80ee99bb2b4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mou", "link": "https://stackoverflow.com/users/7650072/mou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 0, "accepted_answer_id": 53419689, "answer_count": 1, "score": 0, "last_activity_date": 1542872959, "creation_date": 1542817354, "last_edit_date": 1592644375, "question_id": 53416399, "link": "https://stackoverflow.com/questions/53416399/close-sent-on-server-side-but-client-side-has-still-connection", "title": "Close sent on server side but client side has still connection", "body": "<p>I have an application that communicates over an API and a websocket.\nThe websocket is used to publish updated userdata to the client if it is changed in the database - this works perfectly, except for the case that the websocket does not receive any data in some cases. After a few seconds, the websocket starts working again.</p>\n<p>The server log (first, the websocket does not work and starts working again)</p>\n<blockquote>\n<p>msg=&quot;Failed to write data to Websocket: websocket: close sent&quot;</p>\n<p>msg=&quot;Sending Ping Message to Client&quot;</p>\n<p>msg=&quot;Failed to write ping message to Websocket: websocket: close sent&quot;</p>\n<p>msg=&quot;Sending Ping Message to Client&quot;</p>\n<p>msg=&quot;Sending Ping Message to Client&quot;</p>\n<p>msg=&quot;Sending Ping Message to Client&quot;</p>\n<p>msg=&quot;Sending Ping Message to Client&quot;</p>\n</blockquote>\n<p>The client-side code:</p>\n<pre><code>&lt;html&gt;\n&lt;body&gt;\n&lt;p id=&quot;data&quot;&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;script&gt;\nvar ws = new WebSocket(&quot;wss://example.com/ws&quot;);\n\nfunction unloadPage() {\n    toggleLoader();\n    ws.onclose = function () {};\n    ws.close();\n}\n\nws.onopen = function () {\n    ws.send('Ping');\n};\nws.onerror = function (error) {\n    console.log('WebSocket Error ' + error);\n    var d = document.getElementById(&quot;data&quot;);\n    d.innerHTML += &quot;&lt;tr&gt;&lt;td&gt;Failed to connect to Server.&lt;/td&gt;&lt;/tr&gt;&quot;\n};\nws.onmessage = function (e) {\n    console.log(e);\n    var data = e.data;\n    var d = document.getElementById(&quot;data&quot;);\n    var parsedjson = JSON.parse(data);\n    d.innerHTML = &quot;&quot;;\n    for (var i = 0; i &lt; parsedjson.length; i++) {\n        d.innerHTML += parsedjson;\n    }\n};\nws.onclose = function () {\n    console.log(&quot;Websocket has been closed&quot;);\n};\nwindow.addEventListener(&quot;beforeunload&quot;, unloadPage);\n&lt;/script&gt;\n&lt;/html&gt;\n</code></pre>\n<p>The Go Code (routed through gorilla mux):</p>\n<pre><code>var (\n    upgrader = websocket.Upgrader{\n        ReadBufferSize:  1024,\n        WriteBufferSize: 1024,\n        CheckOrigin:     func(r *http.Request) bool { return true },\n    }\n    pingPeriod = (pongPeriod * 9) / 10\n    pongPeriod = 60 * time.Second\n    writeWait  = 10 * time.Second\n)\n\n\nfunc PingResponse(ws *websocket.Conn) {\n    conf := storage.GetConfig()\n    defer ws.Close()\n    ws.SetReadLimit(512)\n    ws.SetReadDeadline(time.Now().Add(pongPeriod))\n    ws.SetPongHandler(func(string) error { ws.SetReadDeadline(time.Now().Add(pongPeriod)); return nil })\n    for {\n        _, _, err := ws.ReadMessage()\n        if err != nil {\n            if websocket.IsUnexpectedCloseError(err, websocket.CloseGoingAway) {\n                conf.Log.Debugf(&quot;Websocket Ping Read Failed: %v&quot;, err)\n            }\n\n            return\n        } else {\n            conf.Log.Debugf(&quot;Received message from Websocket client&quot;)\n        }\n    }\n}\n\nfunc ServeAllUsersWebsocket(datachan chan *[]storage.UserResponse) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        conf := storage.GetConfig()\n        ws, err := upgrader.Upgrade(w, r, nil)\n        if err != nil {\n            conf.Log.Debugf(&quot;Failed to upgrade data to Websocket: %v&quot;, err)\n            return\n        }\n\n        go allUserWebsocketWriter(ws, datachan)\n        go PingResponse(ws)\n    })\n}\n\n\nfunc allUserWebsocketWriter(ws *websocket.Conn, datachan chan *[]storage.UserResponse) {\n    conf := storage.GetConfig()\n    pingticker := time.NewTicker(pingPeriod)\n    defer func() {\n        pingticker.Stop()\n        ws.Close()\n    }()\n\n    userresponse, err := conf.Database.GetAllUsers()\n    if err != nil {\n        conf.Log.Errorf(&quot;Failed to query users from database: %v&quot;, err)\n        return\n    }\n\n    ws.SetWriteDeadline(time.Now().Add(writeWait))\n    err = ws.WriteJSON(&amp;userresponse)\n    if err != nil {\n        conf.Log.Debugf(&quot;Failed to write initial user response: %v&quot;, err)\n        return\n    }\n\n    for {\n        select {\n        case data := &lt;-datachan:\n            ws.SetWriteDeadline(time.Now().Add(writeWait))\n            err := ws.WriteJSON(&amp;data)\n            if err != nil {\n                conf.Log.Debugf(&quot;Failed to write data to Websocket: %v&quot;, err)\n                return\n            }\n        case &lt;-pingticker.C:\n            ws.SetWriteDeadline(time.Now().Add(writeWait))\n            conf.Log.Debugf(&quot;Sending Ping Message to Client&quot;)\n            if err := ws.WriteMessage(websocket.PingMessage, []byte{}); err != nil {\n                conf.Log.Debugf(&quot;Failed to write ping message to Websocket: %v&quot;, err)\n                return\n            }\n        }\n    }\n}\n</code></pre>\n<p>Basically, we are posting the current data to the new Websocket Connection, when it is updated - this does always work. Afterwards, if the database changes, it posts the updated userlist into the channel - the websocket should then post it to the client which updates the list. We are also sending ping messages - which fail (as seen in the log above). The client itself does not log any errors or closes the websocket.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1542822827, "post_id": 53414900, "comment_id": 93710122, "body": "It&#39;s not clear to me what you want to count."}, {"owner": {"reputation": 1499, "user_id": 6487762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoPnL.jpg?s=128&g=1", "display_name": "Archana Sharma", "link": "https://stackoverflow.com/users/6487762/archana-sharma"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1542858186, "post_id": 53414900, "comment_id": 93721474, "body": "I want total_record present inside data"}, {"owner": {"reputation": 1499, "user_id": 6487762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoPnL.jpg?s=128&g=1", "display_name": "Archana Sharma", "link": "https://stackoverflow.com/users/6487762/archana-sharma"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1542858484, "post_id": 53414900, "comment_id": 93721525, "body": "If I am using <code>&quot;count&quot;: bson.M{&quot;$sum&quot;:1}</code> it will return records inside logs, but I want to get total record inside data, which is 3"}], "answers": [{"tags": [], "owner": {"reputation": 1499, "user_id": 6487762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoPnL.jpg?s=128&g=1", "display_name": "Archana Sharma", "link": "https://stackoverflow.com/users/6487762/archana-sharma"}, "is_accepted": true, "score": 1, "last_activity_date": 1542861470, "creation_date": 1542861470, "answer_id": 53423972, "question_id": 53414900, "link": "https://stackoverflow.com/questions/53414900/how-to-count-total-number-of-records-inside-data-using-group-aggregation/53423972#53423972", "title": "How to count total number of records inside data using $group aggregation", "body": "<p>You can use $count aggregation to find total record inside data, <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/count/\" rel=\"nofollow noreferrer\">link</a></p>\n\n<p>To calculate total count of grouped data, you can use $count aggregation after grouping data. Your Query should be like this if you want total count <code>data</code>::</p>\n\n<pre><code>query := []bson.M{\n        {\"$group\": bson.M{\n        \"_id\":  \"$booking_id\",\n        }},\n        {\"$count\" : \"count\"},\n    }\n\n    pipe := getCollection.Pipe(query)\n    err = pipe.AllowDiskUse().One(&amp;result)\n</code></pre>\n\n<p>To calculate records inside each <code>\"logs\"</code> you can use query as follows::</p>\n\n<pre><code>query := []bson.M{\n        {\"$group\": bson.M{\n        \"_id\":  \"$booking_id\",\n        \"logs\": bson.M{ \"$push\": \"$$ROOT\" },\n        \"count\": bson.M{\"$sum\":1},\n        }},\n    }\n\n    pipe := getCollection.Pipe(query)\n    err = pipe.AllowDiskUse().One(&amp;result)\n</code></pre>\n"}], "owner": {"reputation": 1499, "user_id": 6487762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoPnL.jpg?s=128&g=1", "display_name": "Archana Sharma", "link": "https://stackoverflow.com/users/6487762/archana-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 53423972, "answer_count": 1, "score": 0, "last_activity_date": 1542861470, "creation_date": 1542812633, "last_edit_date": 1542859737, "question_id": 53414900, "link": "https://stackoverflow.com/questions/53414900/how-to-count-total-number-of-records-inside-data-using-group-aggregation", "title": "How to count total number of records inside data using $group aggregation", "body": "<p>I am trying to perform a query using golang mgo package to effectively get similar values from a $group aggregation and count the total record value.But I am not able to get total record count for grouped data.\nMy structure is like this:</p>\n\n<pre><code>{\n\n    \"data\": [\n        {\n            \"_id\": 366,\n\n            \"logs\": [\n                {\n                    \"id\": 113,\n                    \"booking_id\": 366,\n                    \"provider_id\": 13,\n                    \"cid\": 11,\n                    \"type\": \"basic\",\n                    \"time\": 1542793756,\n                },\n                {\n                    \"id\": 116,\n                    \"booking_id\": 366,\n                    \"provider_id\": 13,\n                    \"cid\": 0,\n                    \"type\": \"type2\",\n                }\n\n\n            ]\n        },\n        {\n            \"_id\": 362,\n\n            \"logs\": [\n                {\n                    \"id\": 104,\n                    \"booking_id\": 362,\n                    \"provider_id\": 7,\n                    \"cid\": 10,\n                    \"type\": \"basic\",\n                    \"time\": 1542776677,\n                }\n            ]\n        },\n\n        {\n            \"_id\": 370,\n\n            \"logs\": [\n                {\n                    \"id\": 111,\n                    \"booking_id\": 370,\n                    \"provider_id\": 9,\n                    \"cid\": 11,\n                    \"type\": \"basic\",\n                    \"time\": 1542792661,\n                },\n                {\n                    \"id\": 112,\n                    \"booking_id\": 370,\n                    \"provider_id\": 11,\n                    \"cid\": 11,\n                    \"type\": \"basic\",\n                    \"time\": 1542793185,\n                }\n            ]\n       }\n\n    ],\n     \"total_record\": 2\n   }\n</code></pre>\n\n<p>For this I want total record preset inside data::</p>\n\n<pre><code>\"total_record\":3 \n</code></pre>\n\n<p>Query I am using ::</p>\n\n<pre><code>query := []bson.M{\n        {\"$group\": bson.M{\n        \"_id\":  \"$booking_id\",\n        \"logs\": bson.M{ \"$push\": \"$$ROOT\" }\n        \"count\": bson.M{\"$sum\":1},\n        }},\n    }\n\n    pipe := getCollection.Pipe(query)\n    err = pipe.AllowDiskUse().One(&amp;result)\n</code></pre>\n\n<p>I want total count of this result. Log section having data with duplicate bookings with the different \"provider_id\" values but I have grouped all similar booking_id data in single document and show it's count. Is is possible with $group aggregation?</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1542812861, "post_id": 53414728, "comment_id": 93704353, "body": "Far better is avoid null. Empty string is better than pointer."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1542814268, "post_id": 53414728, "comment_id": 93705208, "body": "Your code should work rightfully. It looks the unmarshaling process is not the reverse of the marshaling process. The official MongoDB driver is in <b>alpha</b> phase. Report this at their site and hope they make this work sometime in the future."}, {"owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 0, "creation_date": 1542816386, "post_id": 53414728, "comment_id": 93706538, "body": "Why are you traying to have point to stirng. I think your problem may solve if you use  Result   string"}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "edited": false, "score": 1, "creation_date": 1542817080, "post_id": 53414728, "comment_id": 93706991, "body": "I&#39;m parsing data from another teams mongodb, and I think they do it because the value wasn&#39;t set, instead of it being set but empty. I&#39;ll make a ticket on the mongo driver GitHub. Thanks"}, {"owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 1, "creation_date": 1542822462, "post_id": 53414728, "comment_id": 93709940, "body": "You can try like this <a href=\"https://play.golang.org/p/K6Nlhg3LN5W\" rel=\"nofollow noreferrer\">play.golang.org/p/K6Nlhg3LN5W</a>."}, {"owner": {"reputation": 13757, "user_id": 2126755, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/8QFus.jpg?s=128&g=1", "display_name": "robbmj", "link": "https://stackoverflow.com/users/2126755/robbmj"}, "edited": false, "score": 0, "creation_date": 1545234185, "post_id": 53414728, "comment_id": 94556836, "body": "do you have a link to the ticket?"}], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1043, "favorite_count": 0, "closed_date": 1574417692, "answer_count": 0, "score": 3, "last_activity_date": 1542815513, "creation_date": 1542812048, "last_edit_date": 1542815513, "question_id": 53414728, "link": "https://stackoverflow.com/questions/53414728/cannot-decode-null-into-a-string-type", "closed_reason": "Duplicate", "title": "Cannot decode null into a string type", "body": "<p>I am trying to decode a struct which contains a result field, where the result field is either a null or string value. I'm trying to decode this into a string pointer but I get the error: </p>\n\n<pre><code>type MyStruct struct {\n    Result   *string `json:\"result,omitempty\" bson:\"result\"`\n}\n</code></pre>\n\n<p>The bson/json is something like:</p>\n\n<pre><code>{\"result\" : null}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>{\"result\" : \"somedata\"}\n</code></pre>\n\n<p>Decode with:</p>\n\n<pre><code>var result MyStruct\n\nerr := collection.FindOne(ctx, filter).Decode(&amp;result)\nif err != nil {\n    s.logFile.Fatal(err)\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>cannot decode null into a string type\n</code></pre>\n\n<p>I'm using the official driver: \"github.com/mongodb/mongo-go-driver/mongo\" &amp; \"github.com/mongodb/mongo-go-driver/x/bsonx\"</p>\n"}, {"tags": ["http", "go", "http-proxy"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 2, "creation_date": 1542811795, "post_id": 53414431, "comment_id": 93703665, "body": "I believe you are looking for <a href=\"https://golang.org/pkg/net/http/#Transport\" rel=\"nofollow noreferrer\"><code>http.Transport</code></a>, which can be set on an <code>http.Client</code>."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10684813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a52beef370c9f21f794e5d6b0a96698?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkylo", "link": "https://stackoverflow.com/users/10684813/darkskylo"}, "edited": false, "score": 0, "creation_date": 1542814699, "post_id": 53414691, "comment_id": 93705486, "body": "Seems about right. I just want to see that I unserstand: the http.ProxyUrl function gets the proxy url as a parameter? and after doing that every request I&#39;ll send will go through the proxy server?"}, {"owner": {"reputation": 141, "user_id": 1672533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba5c12e1020f644630a80813a049071?s=128&d=identicon&r=PG", "display_name": "yanzay", "link": "https://stackoverflow.com/users/1672533/yanzay"}, "reply_to_user": {"reputation": 101, "user_id": 10684813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a52beef370c9f21f794e5d6b0a96698?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkylo", "link": "https://stackoverflow.com/users/10684813/darkskylo"}, "edited": false, "score": 0, "creation_date": 1542815636, "post_id": 53414691, "comment_id": 93706076, "body": "@DarkSkylo see example I&#39;ve added"}, {"owner": {"reputation": 101, "user_id": 10684813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a52beef370c9f21f794e5d6b0a96698?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkylo", "link": "https://stackoverflow.com/users/10684813/darkskylo"}, "edited": false, "score": 0, "creation_date": 1542820292, "post_id": 53414691, "comment_id": 93708923, "body": "hey @yanzay, Thank you for all the help, please see the changes I made"}], "tags": [], "owner": {"reputation": 141, "user_id": 1672533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba5c12e1020f644630a80813a049071?s=128&d=identicon&r=PG", "display_name": "yanzay", "link": "https://stackoverflow.com/users/1672533/yanzay"}, "is_accepted": true, "score": 3, "last_activity_date": 1542815545, "last_edit_date": 1542815545, "creation_date": 1542811939, "answer_id": 53414691, "question_id": 53414431, "link": "https://stackoverflow.com/questions/53414431/connect-to-server-through-proxy/53414691#53414691", "title": "Connect to server through proxy", "body": "<p>You can set environment variable <code>HTTP_PROXY</code> for HTTP or <code>HTTPS_PROXY</code> for HTTPS so the default http transport will use it.</p>\n\n<p>Also as an alternative you can create <code>http.Transport</code> by yourself with <code>Proxy</code> field set to <code>http.ProxyURL</code> function call or use you custom implementation.</p>\n\n<p>Example:</p>\n\n<pre><code>proxyURL, _ := url.Parse(\"http://proxy.example.com:port\")\nhttp.DefaultTransport = &amp;http.Transport{\n    Proxy: http.ProxyURL(proxyURL),\n}\n// request using proxy\nresp, _ := http.Get(\"https://google.com\"))\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10684813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a52beef370c9f21f794e5d6b0a96698?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkylo", "link": "https://stackoverflow.com/users/10684813/darkskylo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 0, "accepted_answer_id": 53414691, "answer_count": 1, "score": 0, "last_activity_date": 1542820263, "creation_date": 1542811044, "last_edit_date": 1542820263, "question_id": 53414431, "link": "https://stackoverflow.com/questions/53414431/connect-to-server-through-proxy", "title": "Connect to server through proxy", "body": "<p>I want to connect to a server through proxy server that I have. \nI am searching for something that is similar to Python's HTTPConnection.set_tunnel, is there something like this in golang?</p>\n\n<p>----edit-----</p>\n\n<p>I'm trying to create a connection to a server that allows self signed certificates &amp; transfers through proxy, will this code work properly?</p>\n\n<pre><code>func CreateProxyClient(serverProxy string, sid string, portProxy int) (*Client, error) {\n    http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config{InsecureSkipVerify: true}\n\n    proxyUrl, _ := url.Parse(serverProxy+\":\"+strconv.Itoa(portProxy))\n    tr := &amp;http.Transport{\n        Proxy: http.ProxyURL(proxyUrl),\n    }\n    var netClient = &amp;http.Client{\n        Timeout: time.Second * 10,\n        Transport: tr,\n    }\n    return &amp;Client{netClient, serverProxy, sid}, nil\n}\n</code></pre>\n"}, {"tags": ["go", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542809627, "creation_date": 1542809627, "answer_id": 53414004, "question_id": 53413791, "link": "https://stackoverflow.com/questions/53413791/how-can-i-know-when-two-servers-are-ready-to-get-requests/53414004#53414004", "title": "How can I know when two servers are ready to get requests?", "body": "<p><code>ListenAndServe()</code> will return an error when create server failed. Just handle it to known server start success or not. I can see your coding will only start login server while test server be hanging. Let's try</p>\n\n<pre><code>go func() {\n  log.Fatal(loginServer.ListenAndServe())\n}\nlog.Fatal(testServer.ListenAndServe())\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 684, "user_id": 5306879, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-mHzPJrQNo-g/AAAAAAAAAAI/AAAAAAAAAEw/9q0JlBuWzTM/photo.jpg?sz=128", "display_name": "\u042e\u0440\u0430 \u041f\u0430\u043d\u0430\u0440\u0438\u043d", "link": "https://stackoverflow.com/users/5306879/%d0%ae%d1%80%d0%b0-%d0%9f%d0%b0%d0%bd%d0%b0%d1%80%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1542810132, "post_id": 53414016, "comment_id": 93702740, "body": "Problem not in start, I wanna send request on two that servers and sometimes they not running both"}], "tags": [], "owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1542812840, "last_edit_date": 1542812840, "creation_date": 1542809667, "answer_id": 53414016, "question_id": 53413791, "link": "https://stackoverflow.com/questions/53413791/how-can-i-know-when-two-servers-are-ready-to-get-requests/53414016#53414016", "title": "How can I know when two servers are ready to get requests?", "body": "<p>The program will wait at 1st <code>ListenAndServe()</code> until any error occurred. Because the <code>ListenAndServe()</code> method runs forever. So your second server will never started until the execution goes to the next <code>ListenAndServe()</code>. So use <code>go</code> in front of the 1st server's statement:</p>\n\n<pre><code>router := createServer()\nloginServer := createLoginServerMock()\ngo func() {\n    if err := http.ListenAndServe(\":9333\", loginServer); err != nil {\n        log.Fatal(\"login server err: \", err)\n    }\n}()\nif err := http.ListenAndServe(\":9444\", router); err != nil {\n    log.Fatal(\"test server err: \", err)\n}\n</code></pre>\n\n<p>Then access your <code>loginServer</code> at <a href=\"http://localhost:9333\" rel=\"nofollow noreferrer\">http://localhost:9333</a> and <code>testServer</code> at <a href=\"http://localhost:9444\" rel=\"nofollow noreferrer\">http://localhost:9444</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1542810672, "creation_date": 1542810672, "answer_id": 53414334, "question_id": 53413791, "link": "https://stackoverflow.com/questions/53413791/how-can-i-know-when-two-servers-are-ready-to-get-requests/53414334#53414334", "title": "How can I know when two servers are ready to get requests?", "body": "<p>ListenAndServe has no feedback mechanism to let you know when the server is ready. You have to create the listener yourself and pass it to <a href=\"https://golang.org/pkg/net/http/#Server.Serve\" rel=\"nofollow noreferrer\">Server.Serve</a>:</p>\n\n<pre><code>loginListener, err := net.Listen(\"tcp\", \":9333\")\nif err != nil {\n    // TODO: handle err\n}\n\ntestListener, err := net.Listen(\"tcp\", \":9444\")\nif err != nil {\n    // TODO: handle err\n}\n\n// You may already start sending requests now. They will just wait until\n// the servers call Accept on their respective listener (i.e. shortly after\n// Serve is called).\n\nservLogin := &amp;http.Server{Handler: loginServer}\ntestServer := &amp;http.Server{Handler: router}\n\ngo func() { log.Fatal(servLogin.Serve(loginListener)) }()\ngo func() { log.Fatal(testServer.Serve(testListener)) }()\n</code></pre>\n"}], "owner": {"reputation": 684, "user_id": 5306879, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-mHzPJrQNo-g/AAAAAAAAAAI/AAAAAAAAAEw/9q0JlBuWzTM/photo.jpg?sz=128", "display_name": "\u042e\u0440\u0430 \u041f\u0430\u043d\u0430\u0440\u0438\u043d", "link": "https://stackoverflow.com/users/5306879/%d0%ae%d1%80%d0%b0-%d0%9f%d0%b0%d0%bd%d0%b0%d1%80%d0%b8%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 53414334, "answer_count": 3, "score": 1, "last_activity_date": 1597032117, "creation_date": 1542808920, "last_edit_date": 1597032117, "question_id": 53413791, "link": "https://stackoverflow.com/questions/53413791/how-can-i-know-when-two-servers-are-ready-to-get-requests", "title": "How can I know when two servers are ready to get requests?", "body": "<p>I have two servers</p>\n<pre><code>router := createServer()\nloginServer := createLoginServerMock()\nservLogin := &amp;http.Server{\n    Addr:         &quot;:9333&quot;,\n    Handler:      loginServer,\n}\ntestServer := &amp;http.Server{\n    Addr:         &quot;:9444&quot;,\n    Handler:      router,\n}\nloginServer.ListenAndServe()\ntestServer.ListenAndServe()\n</code></pre>\n<p>And I want to send a request on both of them after they created? How can I detect that?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 463, "user_id": 4279661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MhowX.jpg?s=128&g=1", "display_name": "FMarazzi", "link": "https://stackoverflow.com/users/4279661/fmarazzi"}, "edited": false, "score": 0, "creation_date": 1542809319, "post_id": 53413766, "comment_id": 93702245, "body": "Hello, you just want true or false matches based on the presence or absence of a &quot;/&quot;, or you want to match anything before the &quot;/&quot; anyway, to extract the root URL?"}, {"owner": {"reputation": 17, "user_id": 5411134, "user_type": "registered", "profile_image": "https://graph.facebook.com/509381419230952/picture?type=large", "display_name": "Naval", "link": "https://stackoverflow.com/users/5411134/naval"}, "reply_to_user": {"reputation": 463, "user_id": 4279661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MhowX.jpg?s=128&g=1", "display_name": "FMarazzi", "link": "https://stackoverflow.com/users/4279661/fmarazzi"}, "edited": false, "score": 0, "creation_date": 1542812655, "post_id": 53413766, "comment_id": 93704229, "body": "I want to match anything before the / to only allow domain grabbing of ROOT URL&#39;s. Your question is a little funky with how Go-Colly work but in a essence. Root URL&#39;s and subdomains should be the only thing that I get when println comes up."}], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1542821063, "post_id": 53413969, "comment_id": 93709300, "body": "golang regex&#39;s don&#39;t support flags like <code>gmi</code>, and don&#39;t require delimiters like <code>&#47;</code>. Also this regex is just not going to work because <code>https:&#47;&#47;twitter.com</code> should be accepted as per OP&#39;s question"}, {"owner": {"reputation": 463, "user_id": 4279661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MhowX.jpg?s=128&g=1", "display_name": "FMarazzi", "link": "https://stackoverflow.com/users/4279661/fmarazzi"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1542822161, "post_id": 53413969, "comment_id": 93709786, "body": "Agreed, but he specified &quot;I just don&#39;t want anything after a &quot;/&quot;.&quot;"}], "tags": [], "owner": {"reputation": 463, "user_id": 4279661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MhowX.jpg?s=128&g=1", "display_name": "FMarazzi", "link": "https://stackoverflow.com/users/4279661/fmarazzi"}, "is_accepted": false, "score": 0, "last_activity_date": 1542809508, "creation_date": 1542809508, "answer_id": 53413969, "question_id": 53413766, "link": "https://stackoverflow.com/questions/53413766/regexp-with-differen-tunknown-string-matching/53413969#53413969", "title": "Regexp with differen t(unknown) string matching", "body": "<p>A possible regex is:</p>\n\n<pre><code>/ ^[^\\/\\\\]+$ / gmi\n</code></pre>\n\n<p>Which does not match any time there is a \"\\\" or \"/\" in the text.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 5411134, "user_type": "registered", "profile_image": "https://graph.facebook.com/509381419230952/picture?type=large", "display_name": "Naval", "link": "https://stackoverflow.com/users/5411134/naval"}, "edited": false, "score": 0, "creation_date": 1542812532, "post_id": 53414425, "comment_id": 93704145, "body": "The suggested example didn&#39;t work. Am I looking at colly.URLFilters and colly.Disallow backwards? It should only crawl root and subdomains with the above regex yet it stills traverse beyond that."}], "tags": [], "owner": {"reputation": 189, "user_id": 1304642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNRp5.jpg?s=128&g=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/1304642/jeevan"}, "is_accepted": false, "score": 0, "last_activity_date": 1542811015, "creation_date": 1542811015, "answer_id": 53414425, "question_id": 53413766, "link": "https://stackoverflow.com/questions/53413766/regexp-with-differen-tunknown-string-matching/53414425#53414425", "title": "Regexp with differen t(unknown) string matching", "body": "<p>The bellow regex can match URLs with only domain and subdomain with no path,</p>\n\n<blockquote>\n  <p>r := regexp.MustCompile(\"(https|http)://(.*?)\")</p>\n</blockquote>\n\n<p>To add, <strong>colly.URLFilters</strong> will only crawl URL's matching the pattern. It will also not be creating URL's matching the pattern from the full URL and then do crawling.</p>\n"}], "owner": {"reputation": 17, "user_id": 5411134, "user_type": "registered", "profile_image": "https://graph.facebook.com/509381419230952/picture?type=large", "display_name": "Naval", "link": "https://stackoverflow.com/users/5411134/naval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542815584, "creation_date": 1542808862, "last_edit_date": 1542815584, "question_id": 53413766, "link": "https://stackoverflow.com/questions/53413766/regexp-with-differen-tunknown-string-matching", "title": "Regexp with differen t(unknown) string matching", "body": "<p>I am trying to grab ALL HREF links using the GoColly framework but\nonly allow urls of ANY domain to be Root URL's or SubDomains(NO\npaths). I've commented out my REGEXP. The file extensions doesn't\nmatter. I just don't want anything after a \"/\". I've tried using the\nvariable \"Domain\" and concat to build a \"varied\" regexp. Not even sure\nif that's a thing.</p>\n\n<ol>\n<li>Twitter.Com - TRUE</li>\n<li>hello.authac.com - TRUE </li>\n<li>whole.facebook.com -TRUE </li>\n<li>twiiter.com/dd -FALSE </li>\n<li>hello.authac.com/sd.html FALSE</li>\n<li><p>whole.facebook.com/sdsd/dsd/as.txt FALSE</p>\n\n<pre><code>// Main\npackage main\nimport (\n\"log\"\n\"fmt\"\n\"time\"\n//\"regexp\"\n\"net/http\"\n\"github.com/gocolly/colly\"\n)\n\nvar Target string\nvar Domain string\n\n\nfunc main() {\n//r := regexp.MustCompile(\"(https:\" + Domain + \".com)$\")\n\n\nc := colly.NewCollector(\n    //colly.URLFilters(r),\n\n)\n\n\n\n\n\nc.OnError(func(r *colly.Response, err error) {\n    fmt.Println(r.Request.URL, \"Is Not Reachable\", r.StatusCode) \n})\n\n\n\n// Find and visit all links\nc.OnHTML(\"a\", func(e *colly.HTMLElement) {\n    e.Request.Visit(e.Attr(\"href\"))\n})\n\n\nc.OnRequest(func(r *colly.Request) {\n    Domain := r.URL.String()\n    Target := BannerGrab(Domain)\n    fmt.Println(Target)\n    fmt.Println(\"Dropping By.. \", r.URL)\n    time.Sleep(1000 * time.Millisecond)\n})\n\nc.Visit(\"https://www.twitter.com/\")\n}\n\n//CheckDB if not listed else add\n//RiskDB\n//Email\n\n\nfunc BannerGrab(s string) string {\n\nclient := &amp;http.Client{}\nreq, err := http.NewRequest(\"GET\", s, nil)\n    if err != nil {\n    log.Fatalln(err)\n}\nreq.Header.Set(\"User-Agent\", \"Authac/0.1\")\nresp, _ := client.Do(req)\nserverEntry := resp.Header.Get(\"Server\")\nreturn serverEntry\n\n}\n</code></pre></li>\n</ol>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "edited": false, "score": 0, "creation_date": 1542809982, "post_id": 53413289, "comment_id": 93702646, "body": "Can you show <code>DatePeriod</code> struct and message error?"}, {"owner": {"reputation": 5, "user_id": 10470905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JRHeV4uN55Q/AAAAAAAAAAI/AAAAAAAAADE/QCdNoviqFPs/photo.jpg?sz=128", "display_name": "Devo Avidianto Pratama", "link": "https://stackoverflow.com/users/10470905/devo-avidianto-pratama"}, "reply_to_user": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "edited": false, "score": 0, "creation_date": 1542810432, "post_id": 53413289, "comment_id": 93702901, "body": "@KibGzr I have add tempPayments containts root to node , I&#39;m using library gjson"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1542811354, "post_id": 53413289, "comment_id": 93703417, "body": "&quot;but appear just final index&quot;. I&#39;m not sure what else you expect. You are assigning to datePriodGlobal over and over again (overwriting it in every iteration), and then afterwards print it once. Of course that&#39;s going to print the last value only. You should add your expected output to the question. It&#39;s unclear what you are trying to achieve here."}, {"owner": {"reputation": 2864, "user_id": 1196369, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/16777b8b25858df69e496a07abfab395?s=128&d=identicon&r=PG", "display_name": "mickadoo", "link": "https://stackoverflow.com/users/1196369/mickadoo"}, "edited": false, "score": 0, "creation_date": 1542811474, "post_id": 53413289, "comment_id": 93703472, "body": "Just a bit later, Peter said what I was typing - the line <code>contractsSubmittedGlobal = fmt.Sprintf(&quot;%s&quot;, ContractsSubmitted.String())</code> doesn&#39;t append the string, it just overwrites it each iteration."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10470905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JRHeV4uN55Q/AAAAAAAAAAI/AAAAAAAAADE/QCdNoviqFPs/photo.jpg?sz=128", "display_name": "Devo Avidianto Pratama", "link": "https://stackoverflow.com/users/10470905/devo-avidianto-pratama"}, "edited": false, "score": 0, "creation_date": 1542808847, "post_id": 53413654, "comment_id": 93701959, "body": "still not appear, I try that way too, I &#39;m update my question I have try with .String()"}, {"owner": {"reputation": 46, "user_id": 10545276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IY8nk7WyXDc/AAAAAAAAAAI/AAAAAAAAA-4/IXXK3T-6508/photo.jpg?sz=128", "display_name": "Benny Mac", "link": "https://stackoverflow.com/users/10545276/benny-mac"}, "reply_to_user": {"reputation": 5, "user_id": 10470905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JRHeV4uN55Q/AAAAAAAAAAI/AAAAAAAAADE/QCdNoviqFPs/photo.jpg?sz=128", "display_name": "Devo Avidianto Pratama", "link": "https://stackoverflow.com/users/10470905/devo-avidianto-pratama"}, "edited": false, "score": 0, "creation_date": 1542811093, "post_id": 53413654, "comment_id": 93703253, "body": "I&#39;ve edited my answer to cover your second issue, as well. Hopefully that makes sense."}], "tags": [], "owner": {"reputation": 46, "user_id": 10545276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IY8nk7WyXDc/AAAAAAAAAAI/AAAAAAAAA-4/IXXK3T-6508/photo.jpg?sz=128", "display_name": "Benny Mac", "link": "https://stackoverflow.com/users/10545276/benny-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1542811045, "last_edit_date": 1542811045, "creation_date": 1542808536, "answer_id": 53413654, "question_id": 53413289, "link": "https://stackoverflow.com/questions/53413289/how-to-print-variable-for-in-outside-for-in-golang/53413654#53413654", "title": "How to print variable for, in outside for, in golang?", "body": "<blockquote>\n  <p>\"Cannot use 'DatePeriod' (type Result) as type string in assignment\"</p>\n</blockquote>\n\n<p>So, the variable <code>DatePeriod</code> is a <code>Result</code> type, not a <code>String</code>. You're specifying you want to print a string with <code>%s</code>, but not giving <code>fmt.Sprintf</code> a string, causing that error. The <code>Sprintf</code> is unnecessary if the value given was already a <code>String</code>.</p>\n\n<p>Looking at <a href=\"https://github.com/tidwall/gjson/blob/master/gjson.go\" rel=\"nofollow noreferrer\">gjson.go</a>, the <code>Result</code> type has a <code>String()</code> method, so you'd want instead <code>DatePeriod.String()</code>.</p>\n\n<p>EDIT: </p>\n\n<p>From your latest edit, I think I see your second issue. Your loops replace the <code>...Global</code> string variables each time, so you'll only ever get the last value in the slice you've passed to <code>range</code>. Since your slices are identical in length, you might be better off with something like this:</p>\n\n<pre><code>resultMapPriodTest := gjson.Get(jsonString,tempPayments + \"#.Date\")\nresultContractsSubmittedTest := gjson.Get(jsonString, tempPayments + \"#.ContractsSubmitted\")\n\ndateArray := resultMapPriodTest.Array()[1:13]\ncontractsArray := resultContractsSubmittedTest.Array()[1:13]\nfor i := 0; i&lt;len(dateArray); i++ {\n    d := dateArray[i].String()\n    c := contractsArray[i].String()\n    fmt.Printf(\"%s |        %s              \\t|\", d, c)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 10470905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JRHeV4uN55Q/AAAAAAAAAAI/AAAAAAAAADE/QCdNoviqFPs/photo.jpg?sz=128", "display_name": "Devo Avidianto Pratama", "link": "https://stackoverflow.com/users/10470905/devo-avidianto-pratama"}, "edited": false, "score": 0, "creation_date": 1542859235, "post_id": 53415447, "comment_id": 93721683, "body": "how to loop #.Date , your code problem with #.Date ?"}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "reply_to_user": {"reputation": 5, "user_id": 10470905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JRHeV4uN55Q/AAAAAAAAAAI/AAAAAAAAADE/QCdNoviqFPs/photo.jpg?sz=128", "display_name": "Devo Avidianto Pratama", "link": "https://stackoverflow.com/users/10470905/devo-avidianto-pratama"}, "edited": false, "score": 0, "creation_date": 1542859341, "post_id": 53415447, "comment_id": 93721713, "body": "No, this is actually working. I do not need to use <code>#</code> since <code>PaymentCalendar</code> is already an array."}], "tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": false, "score": 2, "last_activity_date": 1542814341, "creation_date": 1542814341, "answer_id": 53415447, "question_id": 53413289, "link": "https://stackoverflow.com/questions/53413289/how-to-print-variable-for-in-outside-for-in-golang/53415447#53415447", "title": "How to print variable for, in outside for, in golang?", "body": "<p>I will suggest just iterate over the <code>PaymentCalendar</code> as a slice of JSON objects rather than querying each field using the indexes as their pseudo-ids.</p>\n\n<p>Here is a simple demonstration:</p>\n\n<pre><code>func main() {\n\n    jsonString := `\n{\n    \"PaymentCalendarList\": {\n        \"PaymentCalendar\": [\n            {\"ContractSubmitted\": 10,\n             \"Date\": \"2018-01-01T01:01:01\"},\n            {\"ContractSubmitted\": 20,\n             \"Date\": \"2018-01-01T02:02:02\"},\n            {\"ContractSubmitted\": 30,\n             \"Date\": \"2018-01-01T03:03:03\"}\n            {\"ContractSubmitted\": 40,\n             \"Date\": \"2018-01-01T04:04:04\"}\n            {\"ContractSubmitted\": 50,\n             \"Date\": \"2018-01-01T05:05:05\"}\n        ]\n    }\n}`\n\n    result := gjson.Get(jsonString, \"PaymentCalendarList.PaymentCalendar\")\n\n    for _, paymentCal := range result.Array()[0:3] {\n\n        date := paymentCal.Get(\"Date\")\n        contractSubmit := paymentCal.Get(\"ContractSubmitted\")\n\n        fmt.Printf(\"%s | %s\\n\", date, contractSubmit)\n    }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/RIfDwK93tNF\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 5, "user_id": 10470905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JRHeV4uN55Q/AAAAAAAAAAI/AAAAAAAAADE/QCdNoviqFPs/photo.jpg?sz=128", "display_name": "Devo Avidianto Pratama", "link": "https://stackoverflow.com/users/10470905/devo-avidianto-pratama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 53413654, "answer_count": 2, "score": -3, "last_activity_date": 1542815616, "creation_date": 1542807426, "last_edit_date": 1542815616, "question_id": 53413289, "link": "https://stackoverflow.com/questions/53413289/how-to-print-variable-for-in-outside-for-in-golang", "title": "How to print variable for, in outside for, in golang?", "body": "<p>I have problem how to print a variable for, in outside for, in Go?\nI'm using library GJSON <a href=\"https://github.com/tidwall/gjson\" rel=\"nofollow noreferrer\">gjson</a></p>\n\n<p>I have try many way , I just entered the global variable but just appear final index,\nlike:</p>\n\n<pre><code>datePriodGlobal = DatePeriod.String()\n</code></pre>\n\n<p>and </p>\n\n<p>datePriodGlobal = DatePeriod.String()</p>\n\n<p>another way I try but appear just final index too, like below:</p>\n\n<pre><code>tempPayments:= \"Envelope.Body.GetCustomReportResponse.GetCustomReportResult.ContractSummary.PaymentCalendarList.PaymentCalendar.\"\nresultMapPriodTest := gjson.Get(jsonString,tempPayments + \"#.Date\")\n    resultContractsSubmittedTest := gjson.Get(jsonString, tempPayments + \"#.ContractsSubmitted\")\n\n    var datePriodGlobal string\n    for _, DatePeriod := range  resultMapPriodTest.Array()[1:13] {\n        datePriodGlobal = fmt.Sprintf(\"%s\", DatePeriod.String())\n    }\n\n    var contractsSubmittedGlobal string\n    for _, ContractsSubmitted := range resultContractsSubmittedTest.Array()[1:13]{\n        contractsSubmittedGlobal = fmt.Sprintf(\"%s\", ContractsSubmitted.String())\n    }\n    fmt.Printf(\"%s |        %s              \\t|\",datePriodGlobal, contractsSubmittedGlobal)\n\n    }\n</code></pre>\n\n<p>I have json like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zFGDe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zFGDe.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["docker", "go", "github", "openshift", "s2i"], "comments": [{"owner": {"reputation": 54548, "user_id": 128141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70dfb4afd84b106d0855184bf0ae4675?s=128&d=identicon&r=PG", "display_name": "Graham Dumpleton", "link": "https://stackoverflow.com/users/128141/graham-dumpleton"}, "edited": false, "score": 0, "creation_date": 1542829060, "post_id": 53412887, "comment_id": 93712958, "body": "Can you give some background on why you are trying to do this? In being able to understand that, may be able to suggest alternative approaches."}, {"owner": {"reputation": 1, "user_id": 10231125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/849Vf.jpg?s=128&g=1", "display_name": "tathagatk22", "link": "https://stackoverflow.com/users/10231125/tathagatk22"}, "reply_to_user": {"reputation": 54548, "user_id": 128141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70dfb4afd84b106d0855184bf0ae4675?s=128&d=identicon&r=PG", "display_name": "Graham Dumpleton", "link": "https://stackoverflow.com/users/128141/graham-dumpleton"}, "edited": false, "score": 0, "creation_date": 1542859755, "post_id": 53412887, "comment_id": 93721809, "body": "Yeah sure....  Currently i am using s2i executable from golang exec.Command function to build a new image from existing builder image (because I was unable to find any methods defined by openshift/source-to-image) which I think, is not a good a way to use it. So I am thinking of new approaches to use it and I am not sure how to do that."}, {"owner": {"reputation": 54548, "user_id": 128141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70dfb4afd84b106d0855184bf0ae4675?s=128&d=identicon&r=PG", "display_name": "Graham Dumpleton", "link": "https://stackoverflow.com/users/128141/graham-dumpleton"}, "edited": false, "score": 0, "creation_date": 1542863276, "post_id": 53412887, "comment_id": 93722737, "body": "I can infer that much. Was more interested in the bigger picture of how S2I fits into the overall custom build system you seem to have."}, {"owner": {"reputation": 1, "user_id": 10231125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/849Vf.jpg?s=128&g=1", "display_name": "tathagatk22", "link": "https://stackoverflow.com/users/10231125/tathagatk22"}, "reply_to_user": {"reputation": 54548, "user_id": 128141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70dfb4afd84b106d0855184bf0ae4675?s=128&d=identicon&r=PG", "display_name": "Graham Dumpleton", "link": "https://stackoverflow.com/users/128141/graham-dumpleton"}, "edited": false, "score": 0, "creation_date": 1545630528, "post_id": 53412887, "comment_id": 94663632, "body": "Yes, actually I figured out how to use source-to-image library but still my goal is to capture the logs and to show them on web page dynamically, but I am unable to do that."}], "owner": {"reputation": 1, "user_id": 10231125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/849Vf.jpg?s=128&g=1", "display_name": "tathagatk22", "link": "https://stackoverflow.com/users/10231125/tathagatk22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542808959, "creation_date": 1542806127, "last_edit_date": 1542808959, "question_id": 53412887, "link": "https://stackoverflow.com/questions/53412887/how-to-use-openshift-source-to-image-library-instead-of-s2i-binary-or-executable", "title": "How to use openshift source-to-image library instead of s2i binary or executable file", "body": "<p>How to use openshift source-to-image library <a href=\"https://github.com/openshift/source-to-image\" rel=\"nofollow noreferrer\">https://github.com/openshift/source-to-image</a> using go language,instead of s2i executable to build a new image from existing builder images from docker hub.</p>\n\n<p>I need to create a new image by using above library and not using s2i.exe.</p>\n\n<p>I have tried using <a href=\"https://github.com/openshift/source-to-image/blob/master/pkg/build/strategies/dockerfile/dockerfile.go\" rel=\"nofollow noreferrer\">https://github.com/openshift/source-to-image/blob/master/pkg/build/strategies/dockerfile/dockerfile.go</a> Build function but it gives me an error.</p>\n\n<p>Can anyone tell me or atleast guide me how to use this library to create a new image from existing docker hub builder images, by not using s2i executable.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go", "null"], "owner": {"reputation": 1177, "user_id": 4564156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff0db7eb380f134a95557e70d57e582?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsenasm", "link": "https://stackoverflow.com/users/4564156/mohsenasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1542799415, "answer_count": 0, "score": 1, "last_activity_date": 1542800018, "creation_date": 1542799185, "last_edit_date": 1542800018, "question_id": 53410999, "link": "https://stackoverflow.com/questions/53410999/different-result-on-comparing-errors-to-nil", "closed_reason": "Duplicate", "title": "Different result on comparing errors to nil", "body": "<p>I've tried to cast <code>nil</code> (of type <code>*MyError</code>) to error. By comparing the value of cast variable to nil, the result is different. Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype MyError struct {\n    err error\n}\n\nfunc (e *MyError) Error() string {\n    return e.err.Error()\n}\n\nfunc nilErr() *MyError {\n    return nil\n}\n\nfunc main() {\n    e := nilErr()\n    fmt.Println(e) // &lt;nil&gt;\n    fmt.Println(error(e)) // &lt;nil&gt;\n\n    fmt.Printf(\"%#v\\n\", e) // (*main.MyError)(nil)\n    fmt.Printf(\"%#v\\n\", error(e)) // (*main.MyError)(nil)\n\n    fmt.Println(e == error(e)) // true\n\n    fmt.Println(e == nil) // true\n    fmt.Println(error(e) == nil) // false\n}\n</code></pre>\n\n<p>playground: <a href=\"https://play.golang.org/p/Oa1p0zWWUIC\" rel=\"nofollow noreferrer\">try code</a></p>\n\n<p>The strange part is that the comparison of <code>e</code> to <code>error(e)</code> returns <code>true</code> but comparing each of them to <code>nil</code> gives different results.</p>\n\n<p>Is there something wrong with the cast? If yes, How should it be done? </p>\n"}, {"tags": ["bash", "go"], "answers": [{"comments": [{"owner": {"reputation": 256, "user_id": 3727012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/344fd20999b96dd595a7e467a9de7f45?s=128&d=identicon&r=PG&f=1", "display_name": "G-M", "link": "https://stackoverflow.com/users/3727012/g-m"}, "reply_to_user": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 0, "creation_date": 1542804144, "post_id": 53409627, "comment_id": 93699198, "body": "@mgagnon #2 <code>DISPLAY= bash -c java -jar app.jar -config config.json</code>"}], "tags": [], "owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "is_accepted": true, "score": 2, "last_activity_date": 1542794848, "creation_date": 1542794848, "answer_id": 53409627, "question_id": 53409114, "link": "https://stackoverflow.com/questions/53409114/how-to-start-a-program-with-bash-c-redirect-disable-gui-of-that-app/53409627#53409627", "title": "How to start a program with bash -c, redirect / disable GUI of that app", "body": "<p>You have several options:</p>\n\n<ol>\n<li>First, you should check if that application can run without GUI (often called \"headless\" mode)</li>\n<li>You can <a href=\"https://stackoverflow.com/questions/18906350/unset-an-environment-variable-for-a-single-command\">unset</a> <code>DISPLAY</code> variable, so that your app won't find your X11 server - but keep in mind that application might not work without X server</li>\n</ol>\n\n<p>eg.</p>\n\n<pre><code>DISPLAY= bash -c java -jar app.jar -config config.json # note space after '='\n# or\nenv -u DISPLAY bash -c java -jar app.jar -config config.json\n</code></pre>\n\n<ol start=\"3\">\n<li>You could use in-memory virtual X server such as <a href=\"https://www.x.org/releases/X11R7.6/doc/man/man1/Xvfb.1.xhtml\" rel=\"nofollow noreferrer\">xfvb</a> and point your application to display its windows there.</li>\n</ol>\n\n<p>eg.</p>\n\n<pre><code>Xvfb :1 -screen 0 1600x1200x32\nDISPLAY=:1 bash -c java -jar app.jar -config config.json\n</code></pre>\n"}], "owner": {"reputation": 256, "user_id": 3727012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/344fd20999b96dd595a7e467a9de7f45?s=128&d=identicon&r=PG&f=1", "display_name": "G-M", "link": "https://stackoverflow.com/users/3727012/g-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 53409627, "answer_count": 1, "score": 0, "last_activity_date": 1542796730, "creation_date": 1542793224, "last_edit_date": 1542796730, "question_id": 53409114, "link": "https://stackoverflow.com/questions/53409114/how-to-start-a-program-with-bash-c-redirect-disable-gui-of-that-app", "title": "How to start a program with bash -c, redirect / disable GUI of that app", "body": "<p>Currently I'm starting a java application with</p>\n\n<pre><code>bash -c java -jar app.jar -config config.json\n</code></pre>\n\n<p>The app opens a window, displaying some output and closes. The output is also available on stdout, so I don't need (want) the GUI to display. </p>\n\n<p>How can I prevent bash to forward the X output?</p>\n\n<p><strong>Follow up:</strong></p>\n\n<p>I'm running this in a go application, so based on el.pescado's answer, I have implemented this as:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func runcmd(cmd string, workdir string) ([]byte, error) {\n  ex := exec.Command(\"bash\", \"-c\", cmd)\n  ex.Env = []string{\"DISPLAY= \"}\n  ex.Dir = workdir\n  return ex.Output()\n}\n</code></pre>\n"}, {"tags": ["elasticsearch", "go", "insert"], "comments": [{"owner": {"reputation": 7445, "user_id": 1174378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8e5416e29987d91116420dc387e7153?s=128&d=identicon&r=PG", "display_name": "Mihai Todor", "link": "https://stackoverflow.com/users/1174378/mihai-todor"}, "edited": false, "score": 0, "creation_date": 1542793713, "post_id": 53408221, "comment_id": 93693430, "body": "I did a quick search through the code and perhaps you have to call <code>elastic.NewBulkService(e_olivere)</code>. See <a href=\"https://github.com/olivere/elastic/blob/1b9601afdcffadd0d767d346ba85d458591dd3c3/bulk.go#L48\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/olivere/elastic/blob/d677dbe6d6a14f0b4f10dd28e906452f1e1d6d06/bulk_test.go\" rel=\"nofollow noreferrer\">here</a>. Note that I&#39;ve never used these libraries before, so not sure."}, {"owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "reply_to_user": {"reputation": 7445, "user_id": 1174378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8e5416e29987d91116420dc387e7153?s=128&d=identicon&r=PG", "display_name": "Mihai Todor", "link": "https://stackoverflow.com/users/1174378/mihai-todor"}, "edited": false, "score": 1, "creation_date": 1542795685, "post_id": 53408221, "comment_id": 93694551, "body": "Thanks for your answer, it really helps me a lot"}], "owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542790050, "creation_date": 1542790050, "question_id": 53408221, "link": "https://stackoverflow.com/questions/53408221/replacement-for-newbulkindexer-function-in-olivere-package", "title": "Replacement for NewBulkIndexer function in Olivere Package", "body": "<p>When I use elastigo in golang to save data to elasticsearch, I can use the following code </p>\n\n<pre><code>var c_es = elastigo.NewConn()\nvar indexer = c_es.NewBulkIndexer(50)\n</code></pre>\n\n<p>However, when I use olivere, the code is a bit different. If I want to make a connection, then I must use </p>\n\n<pre><code>e_olivere, err = elastic.NewClient(elastic.SetURL(\"my address eg : 122.000.001\"))\n</code></pre>\n\n<p>But I don't know how to find the replacement for NewBulkIndexer(). Does anyone know what the function is? </p>\n\n<p>Thanks </p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 7445, "user_id": 1174378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8e5416e29987d91116420dc387e7153?s=128&d=identicon&r=PG", "display_name": "Mihai Todor", "link": "https://stackoverflow.com/users/1174378/mihai-todor"}, "edited": false, "score": 1, "creation_date": 1542792170, "post_id": 53408034, "comment_id": 93692480, "body": "I&#39;d try to build it locally and then add some logging in the relevant functions. You can also try using something like <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow noreferrer\">github.com/derekparker/delve</a> which has an integration with VSCode (if you prefer a visual debugger), but I haven&#39;t used it and not sure how well it works."}, {"owner": {"reputation": 717, "user_id": 754250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrhRM.jpg?s=128&g=1", "display_name": "HoaPhan", "link": "https://stackoverflow.com/users/754250/hoaphan"}, "reply_to_user": {"reputation": 7445, "user_id": 1174378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8e5416e29987d91116420dc387e7153?s=128&d=identicon&r=PG", "display_name": "Mihai Todor", "link": "https://stackoverflow.com/users/1174378/mihai-todor"}, "edited": false, "score": 0, "creation_date": 1542792352, "post_id": 53408034, "comment_id": 93692600, "body": "Look like you might know <a href=\"https://stackoverflow.com/q/53407108/754250\">stackoverflow.com/q/53407108/754250</a>"}, {"owner": {"reputation": 2947, "user_id": 1928863, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/zaBOb.png?s=128&g=1", "display_name": "Rui", "link": "https://stackoverflow.com/users/1928863/rui"}, "reply_to_user": {"reputation": 7445, "user_id": 1174378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8e5416e29987d91116420dc387e7153?s=128&d=identicon&r=PG", "display_name": "Mihai Todor", "link": "https://stackoverflow.com/users/1174378/mihai-todor"}, "edited": false, "score": 0, "creation_date": 1542809350, "post_id": 53408034, "comment_id": 93702264, "body": "I agree with @MihaiTodor that first source code should be downloaded and then built, find the debugger based on the source code language. For instance, C has debugger gdb, Java has debugger jdb etc. This question is more about methodalogy"}, {"owner": {"reputation": 717, "user_id": 754250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrhRM.jpg?s=128&g=1", "display_name": "HoaPhan", "link": "https://stackoverflow.com/users/754250/hoaphan"}, "edited": false, "score": 0, "creation_date": 1542812095, "post_id": 53408034, "comment_id": 93703862, "body": "Are you able to read my comment above?"}], "owner": {"reputation": 717, "user_id": 754250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrhRM.jpg?s=128&g=1", "display_name": "HoaPhan", "link": "https://stackoverflow.com/users/754250/hoaphan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1542789328, "creation_date": 1542789328, "question_id": 53408034, "link": "https://stackoverflow.com/questions/53408034/is-it-possible-to-debug-docker-client", "title": "Is it possible to debug docker client", "body": "<p>I wonder if it is possible to debug command like <code>docker pull</code> against its source (<a href=\"https://github.com/docker/docker-ce/blob/master/components/cli/vendor/github.com/docker/docker/client/image_create.go\" rel=\"nofollow noreferrer\">https://github.com/docker/docker-ce/blob/master/components/cli/vendor/github.com/docker/docker/client/image_create.go</a> I guess) ?</p>\n"}, {"tags": ["go", "network-programming", "protocols", "protocol-buffers", "network-protocols"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1542788255, "post_id": 53407677, "comment_id": 93690237, "body": "Your code establishes a tcp connection (see the literal <code>&quot;tcp&quot;</code> in net.Dial). So what is the question?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1542788389, "post_id": 53407677, "comment_id": 93690298, "body": "&quot;Protocol Buffers&quot; is essentially the protocol--it even has protocol in the name :)"}, {"owner": {"reputation": 2208, "user_id": 4408364, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/100003785465637/picture?type=large", "display_name": "Prakash Pandey", "link": "https://stackoverflow.com/users/4408364/prakash-pandey"}, "edited": false, "score": 0, "creation_date": 1542788659, "post_id": 53407677, "comment_id": 93690443, "body": "Can we use protocol buffer over http"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542789145, "post_id": 53407677, "comment_id": 93690693, "body": "Yes you can. But why?"}, {"owner": {"reputation": 2208, "user_id": 4408364, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/100003785465637/picture?type=large", "display_name": "Prakash Pandey", "link": "https://stackoverflow.com/users/4408364/prakash-pandey"}, "edited": false, "score": 0, "creation_date": 1542790346, "post_id": 53407677, "comment_id": 93691399, "body": "My webserver has build in caching for http"}, {"owner": {"reputation": 2208, "user_id": 4408364, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/100003785465637/picture?type=large", "display_name": "Prakash Pandey", "link": "https://stackoverflow.com/users/4408364/prakash-pandey"}, "edited": false, "score": 0, "creation_date": 1542790900, "post_id": 53407677, "comment_id": 93691718, "body": "Also could you please guide me how I can use protobuff with http using golang"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1542792550, "post_id": 53407677, "comment_id": 93692710, "body": "I suggest you google &quot;how does protobuf work?&quot; and start from there.    There are worked examples here, <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">github.com/golang/protobuf</a> for instance"}, {"owner": {"reputation": 2208, "user_id": 4408364, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/100003785465637/picture?type=large", "display_name": "Prakash Pandey", "link": "https://stackoverflow.com/users/4408364/prakash-pandey"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1542793582, "post_id": 53407677, "comment_id": 93693344, "body": "Thank you for the link @Vorsprung. I went to the above link but I didn&#39;t found any examples other than the the <code>Marshal</code> and <code>UnMarshal </code> example in <code>README</code> but I found no example how <code>client</code> can send data to <code>server</code> using <code>http</code>"}, {"owner": {"reputation": 2208, "user_id": 4408364, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/100003785465637/picture?type=large", "display_name": "Prakash Pandey", "link": "https://stackoverflow.com/users/4408364/prakash-pandey"}, "edited": false, "score": 0, "creation_date": 1542802372, "post_id": 53407677, "comment_id": 93698281, "body": "This link help me <code>https:&#47;&#47;jacobmartins.com&#47;2016&#47;05&#47;24&#47;practical-golang-using-p&zwnj;&#8203;rotobuffs&#47;</code>.  Thank you all for your help"}], "answers": [{"tags": [], "owner": {"reputation": 2208, "user_id": 4408364, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/100003785465637/picture?type=large", "display_name": "Prakash Pandey", "link": "https://stackoverflow.com/users/4408364/prakash-pandey"}, "is_accepted": true, "score": 2, "last_activity_date": 1542866124, "last_edit_date": 1542866124, "creation_date": 1542802575, "answer_id": 53411849, "question_id": 53407677, "link": "https://stackoverflow.com/questions/53407677/how-to-implement-googles-protocol-buffers-via-http/53411849#53411849", "title": "how to implement google&#39;s protocol buffers via http", "body": "<p>I <strong>successfully implemented</strong> protobuff vai http.</p>\n\n<p><strong>Credits</strong>: <code>https://jacobmartins.com/2016/05/24/practical-golang-using-protobuffs/</code></p>\n\n<p><strong>Sample_Client:</strong> </p>\n\n<pre><code>func getFakeTransaction() *proto.Transaction {\n    transaction := new(proto.Transaction)\n    transaction.ClientId = \"client_1\"\n    transaction.ClientName = \"Europa\"\n\n    items := new(proto.Items)\n    items.ItemId = 1\n    items.ItemName = \"Space suite\"\n    items.ItemValue = 2000\n    transaction.Items = items\n\n    return transaction\n}\n\nfunc sendMessage(transaction *proto.Transaction) {\n    message, err := protoc.Marshal(transaction)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error while marshaling message: %s\", err.Error())\n        os.Exit(1)\n    }\n\n    _, err = http.Post(\"http://localhost:8080\", \"\", bytes.NewBuffer(message))\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error while post request to server: %s\", err.Error())\n        os.Exit(1)\n    }\n    fmt.Printf(\"Sent %d bytes to server\\n\", len(message))\n}\n\nfunc main() {\n    fmt.Println(\"Starting client..\")\n    transaction := getFakeTransaction()\n    for {\n        sendMessage(transaction)\n        // time.Sleep(1 * time.Second)\n    }\n}\n</code></pre>\n\n<p><strong>Sample Server:</strong></p>\n\n<pre><code>func printMessage(t *proto.Transaction) {\n    clientId := t.GetClientId()\n    clientName := t.GetClientName()\n    items := t.GetItems()\n    fmt.Printf(\"ClientId: %s, ClientName: %s, Items: %s\\n\", clientId, clientName, items)\n}\n\nfunc main() {\n    fmt.Println(\"Staring server..\")\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        message, err := ioutil.ReadAll(r.Body)\n        if err != nil {\n            fmt.Fprintf(os.Stderr, \"Error while reading data from client: \", err.Error())\n            return\n        }\n        transaction := new(proto.Transaction)\n        // protoc.Unmarshal(message, &amp;transaction)\n        if err = transaction.XXX_Unmarshal(message); err != nil {\n            fmt.Fprintf(os.Stderr, \"Error while unmarshaling client message: %s\", err.Error())\n            return\n        }\n        printMessage(transaction)\n    })\n    http.ListenAndServe(\":8080\", nil)\n\n}\n</code></pre>\n\n<p><strong>Sample Protofile:</strong></p>\n\n<pre><code>syntax=\"proto3\";\n\npackage proto;\n\nenum Status {\n    SUCCESS = 0;\n    INPROGRESS = 1;\n    FAILED = 2;\n}\n\nmessage Items {\n    int32 itemId = 1;\n    string itemName = 2;\n    int32 itemValue = 3;\n    Status status = 4;\n}\n\nmessage Transaction {\n    string clientId = 1;\n    string clientName = 2;\n    Items items = 3;\n}\n</code></pre>\n"}], "owner": {"reputation": 2208, "user_id": 4408364, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/100003785465637/picture?type=large", "display_name": "Prakash Pandey", "link": "https://stackoverflow.com/users/4408364/prakash-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1894, "favorite_count": 0, "closed_date": 1542880621, "accepted_answer_id": 53411849, "answer_count": 1, "score": -5, "last_activity_date": 1542866124, "creation_date": 1542787813, "last_edit_date": 1542866080, "question_id": 53407677, "link": "https://stackoverflow.com/questions/53407677/how-to-implement-googles-protocol-buffers-via-http", "closed_reason": "Needs details or clarity", "title": "how to implement google&#39;s protocol buffers via http", "body": "<p>I am using <strong>google's protocol buffers</strong> to send data from client to server.</p>\n\n<p><strong>Client and server both are written in Golang.</strong> </p>\n\n<p>I think it uses plain tcp to send data from <code>client</code> to <code>server</code>.</p>\n\n<p><strong>Sample client code:</strong></p>\n\n<pre><code>func getFakeTransaction() *proto.Transaction {\n    transaction := new(proto.Transaction)\n    transaction.ClientId = \"client_1\"\n    transaction.ClientName = \"Europa\"\n\n    items := new(proto.Items)\n    items.ItemId = 1\n    items.ItemName = \"Space suite\"\n    items.ItemValue = 2000\n    transaction.Items = items\n\n    return transaction\n}\n\nfunc readDataFromExternalDatasource() *proto.Transaction {\n    return getFakeTransaction()\n}\n\nfunc sentDataToServer(data []byte) {\n    conn, err := net.Dial(\"tcp\", \"localhost:8080\")\n    defer conn.Close()\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error while dialing server: %s\\n\", err.Error())\n        return\n    }\n    sentBytes, err := conn.Write(data)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error sending bytes to serve: %s\\n\", err.Error())\n        return\n    }\n    fmt.Printf(\"Sent %d bytes\\n\", sentBytes)\n}\n\nfunc main() {\n    fmt.Println(\"Starting client..\")\n    data := readDataFromExternalDatasource()\n    dataInByteArr, err := protoc.Marshal(data)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error while Marshal data: %s\", err.Error())\n    }\n    for {\n        sentDataToServer(dataInByteArr)\n        time.Sleep(1000)\n    }\n}\n</code></pre>\n\n<p><strong>How to send data from client to server via <code>HTTP</code> using protocol buffers in Golang</strong>? </p>\n"}, {"tags": ["go", "proxy", "get", "request"], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 4700856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dvi4T.png?s=128&g=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/4700856/juan"}, "reply_to_user": {"reputation": 1895, "user_id": 605948, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e2fd8602397f2e842f5bd64b2a3269a5?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/605948/matthew"}, "edited": false, "score": 1, "creation_date": 1542827237, "post_id": 53407016, "comment_id": 93712120, "body": "If there are other headers required by the request, such as Content-Type or Accept, you should also add them to the ProxyConnectHeader."}], "tags": [], "owner": {"reputation": 136, "user_id": 4700856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dvi4T.png?s=128&g=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/4700856/juan"}, "is_accepted": true, "score": 12, "last_activity_date": 1542784702, "creation_date": 1542784702, "answer_id": 53407016, "question_id": 53406874, "link": "https://stackoverflow.com/questions/53406874/how-to-use-proxies-with-authentication-in-my-http-requests/53407016#53407016", "title": "How to use proxies with authentication in my HTTP requests?", "body": "<p>If you're following this <a href=\"https://www.admfactory.com/how-to-setup-a-proxy-with-authentication-for-http-client-in-golang/\" rel=\"noreferrer\">authorized proxy tutorial</a>, the additional step you would have to do is to set up the HEADER in the transport.</p>\n\n<pre><code>auth := \"username:password\"\nbasicAuth := \"Basic \" + base64.StdEncoding.EncodeToString([]byte(auth))\ntransport.ProxyConnectHeader = http.Header{}\ntransport.ProxyConnectHeader.Add(\"Proxy-Authorization\", basicAuth)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 0, "last_activity_date": 1542786973, "creation_date": 1542786973, "answer_id": 53407480, "question_id": 53406874, "link": "https://stackoverflow.com/questions/53406874/how-to-use-proxies-with-authentication-in-my-http-requests/53407480#53407480", "title": "How to use proxies with authentication in my HTTP requests?", "body": "<p>to add authorization, you may need to add a header:</p>\n\n<pre><code>auth := \"{user}:{password}\"\nbasicAuth := \"Basic \" + base64.StdEncoding.EncodeToString([]byte(auth))\nrequest.Header.Add(\"Proxy-Authorization\", basicAuth)\n</code></pre>\n"}], "owner": {"reputation": 1895, "user_id": 605948, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e2fd8602397f2e842f5bd64b2a3269a5?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/605948/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2085, "favorite_count": 3, "accepted_answer_id": 53407016, "answer_count": 2, "score": 6, "last_activity_date": 1542835620, "creation_date": 1542784015, "last_edit_date": 1542835620, "question_id": 53406874, "link": "https://stackoverflow.com/questions/53406874/how-to-use-proxies-with-authentication-in-my-http-requests", "title": "How to use proxies with authentication in my HTTP requests?", "body": "<p>I have a proxy IP Address (that also require a username and password). When i try using them to visit webpages, i get \"Proxy Authentication Required\".</p>\n\n<p>I'm found this other Stackoverflow post from 2016, and this Github Issue that was closed, but they don't provide anything useful:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/40676825/proxy-golang-https\">Proxy golang https</a></li>\n<li><a href=\"https://github.com/golang/go/issues/22288\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/22288</a></li>\n</ul>\n\n<p>Any suggestions?</p>\n\n<p><strong>EDIT:</strong>\nSaw this post: <a href=\"https://stackoverflow.com/questions/14661511/setting-up-proxy-for-http-client\">Setting up proxy for HTTP client</a></p>\n\n<p>It's kinda close. However, for some urls I'm able to get a successful response using my proxy, but for certain urls, I get a \"Proxy Authorization Required\".</p>\n"}, {"tags": ["json", "go", "data-binding", "go-echo"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1542776672, "post_id": 53405374, "comment_id": 93686015, "body": "May we know what <code>c</code> is?"}, {"owner": {"reputation": 51, "user_id": 9319777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26a22815bdb60d74afe306b7ab3232f?s=128&d=identicon&r=PG&f=1", "display_name": "gdk", "link": "https://stackoverflow.com/users/9319777/gdk"}, "reply_to_user": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1542778013, "post_id": 53405374, "comment_id": 93686366, "body": "i&#39;m sorry. That &#39;c&#39; is context.( echo framework link &gt; <a href=\"https://echo.labstack.com/guide/request\" rel=\"nofollow noreferrer\">echo.labstack.com/guide/request</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 3254, "user_id": 2927601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d06918d96014e4de287f37dc5ecba1b1?s=128&d=identicon&r=PG", "display_name": "Laily", "link": "https://stackoverflow.com/users/2927601/laily"}, "reply_to_user": {"reputation": 51, "user_id": 9319777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26a22815bdb60d74afe306b7ab3232f?s=128&d=identicon&r=PG&f=1", "display_name": "gdk", "link": "https://stackoverflow.com/users/9319777/gdk"}, "edited": false, "score": 0, "creation_date": 1542872818, "post_id": 53406183, "comment_id": 93726297, "body": "@gdk if you send js data with <code>content-type=application&#47;json</code> ?, you can check is with this way.  1. if data send correct,  ioutil.ReadAll(c.Request().Body), this should be the json data you had sent.  2. you have the correct struct to bind to the json data.  3. use the correct struct tag. Echo bind data by struct tag and content-type, tag json for <code>application&#47;json</code>, tag form for <code>application&#47;x-www-form-urlencoded</code>, tag query for  parameters in url.   There is my test code: <a href=\"https://goplay.space/#A70IHubaQIH\" rel=\"nofollow noreferrer\">goplay.space/#A70IHubaQIH</a>"}, {"owner": {"reputation": 51, "user_id": 9319777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26a22815bdb60d74afe306b7ab3232f?s=128&d=identicon&r=PG&f=1", "display_name": "gdk", "link": "https://stackoverflow.com/users/9319777/gdk"}, "edited": false, "score": 0, "creation_date": 1542876719, "post_id": 53406183, "comment_id": 93728209, "body": "Tank you so much. i changed my ajax code. added code is &#39;application/json&#39;. And end of my question, my mistake was custom struct type&#39;s object other custom struct type. That\u2019s very kind of you!"}], "tags": [], "owner": {"reputation": 3254, "user_id": 2927601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d06918d96014e4de287f37dc5ecba1b1?s=128&d=identicon&r=PG", "display_name": "Laily", "link": "https://stackoverflow.com/users/2927601/laily"}, "is_accepted": false, "score": 0, "last_activity_date": 1542780660, "creation_date": 1542780660, "answer_id": 53406183, "question_id": 53405374, "link": "https://stackoverflow.com/questions/53405374/is-it-possible-to-bind-to-map-object-of-custom-struct-type/53406183#53406183", "title": "Is it possible to bind to map object of custom struct type?", "body": "<p>Maybe you should remove struct tag 'form', when you use 'application/json' send data, 'form' tag is unused.<br>\nThe program is going well when I just add 'json' tag, and if I add 'form' tag, echo uses the 'form' and get an error.</p>\n\n<p>Hope this can help you.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9319777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26a22815bdb60d74afe306b7ab3232f?s=128&d=identicon&r=PG&f=1", "display_name": "gdk", "link": "https://stackoverflow.com/users/9319777/gdk"}, "edited": false, "score": 0, "creation_date": 1542782938, "post_id": 53406224, "comment_id": 93688015, "body": "thank you.  first, i was remove contentType in ajax,  GO tetris.KeyCode &gt; working // printing &#39;key code: 13..&#39; but, tetris.NowBlock &gt; don&#39;t working.. // pringing &#39;map[]&#39;  second, contentType: &quot;application/json&quot; and data: stringify({json..}) GO tetris.KeyCode &gt; don&#39;t working // printing nil but, tetris.NowBlock &gt; don&#39;t working.. // pringing &#39;map[]&#39;"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 51, "user_id": 9319777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26a22815bdb60d74afe306b7ab3232f?s=128&d=identicon&r=PG&f=1", "display_name": "gdk", "link": "https://stackoverflow.com/users/9319777/gdk"}, "edited": false, "score": 0, "creation_date": 1542783004, "post_id": 53406224, "comment_id": 93688042, "body": "if you remove the <code>contentType</code>, the payload will sent with content type <code>application&#47;x-www-form-urlencoded</code>. some array information will be unreadable"}, {"owner": {"reputation": 51, "user_id": 9319777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26a22815bdb60d74afe306b7ab3232f?s=128&d=identicon&r=PG&f=1", "display_name": "gdk", "link": "https://stackoverflow.com/users/9319777/gdk"}, "edited": false, "score": 0, "creation_date": 1542783705, "post_id": 53406224, "comment_id": 93688323, "body": "sorry my comment was incorrect. so i edit my question(please read the end of question)."}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 0, "last_activity_date": 1542780898, "creation_date": 1542780898, "answer_id": 53406224, "question_id": 53405374, "link": "https://stackoverflow.com/questions/53405374/is-it-possible-to-bind-to-map-object-of-custom-struct-type/53406224#53406224", "title": "Is it possible to bind to map object of custom struct type?", "body": "<p>There is no problem in your go code. Why echo <code>.Bind()</code> not able to retrieve the payload sent from AJAX is because the payload is not in JSON format.</p>\n\n<p>On <code>$.ajax</code> you need to <code>JSON.stringify()</code> the data into JSON string format.</p>\n\n<pre><code>JSON.stringify({\n    \"keyCode\" : keyCode\n    , \"ctxWidth\" : ctxWidth\n    , \"ctxHeight\" : ctxHeight\n    , \"nowBlock\" : {\"O\":0}\n})\n</code></pre>\n\n<p>Setting <code>contentType</code> into <code>application/json</code> will not automatically convert payload into JSON string. That's why <code>JSON.stringy()</code> is still required.</p>\n\n<hr>\n\n<p>Full changes:</p>\n\n<pre><code>var payload = JSON.stringify({\n    \"keyCode\": keyCode,\n    \"ctxWidth\": ctxWidth,\n    \"ctxHeight\": ctxHeight,\n    \"nowBlock\": {\n        \"O\": 0\n    }\n})\n\n$.ajax({\n    type: \"POST\",\n    url: \"/game/tetris/api/control\",\n    data: payload,\n    dataType: \"json\",\n    contentType: \"application/json\"\n}).done(function(data) {\n    ......\n});\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9319777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26a22815bdb60d74afe306b7ab3232f?s=128&d=identicon&r=PG&f=1", "display_name": "gdk", "link": "https://stackoverflow.com/users/9319777/gdk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 53406224, "answer_count": 2, "score": 0, "last_activity_date": 1542790059, "creation_date": 1542775277, "last_edit_date": 1542790059, "question_id": 53405374, "link": "https://stackoverflow.com/questions/53405374/is-it-possible-to-bind-to-map-object-of-custom-struct-type", "title": "Is it possible to bind to map object of custom struct type?", "body": "<p>my question is,\nhow to bind(auto binding?) custom structure type in a map object(variable)?</p>\n\n<p>this is my custom struct type</p>\n\n<pre><code>type Tetris struct {\n    ... ...\n    NowBlock           map[string]int     `form:\"nowBlock\" json:\"nowBlock\"`\n    ... ...\n}\n</code></pre>\n\n<p>this is my ajax code</p>\n\n<pre><code> $.ajax({\n     type : \"POST\"\n     , url : \"/game/tetris/api/control\"\n     , data : {\n                \"keyCode\" : keyCode\n                , \"ctxWidth\" : ctxWidth\n                , \"ctxHeight\" : ctxHeight\n                , \"nowBlock\" : {\"O\":0}\n     } // also, i did JSON.stringify, but did not binding..\n     , dataType : \"json\"\n     , contentType : \"application/json\"\n     }).done(function(data){\n           ... ...\n });\n</code></pre>\n\n<p>and then, do not binding 'NowBlock'</p>\n\n<pre><code>tetris := new(Tetris)\nif err := c.Bind(tetris); err != nil {\n    c.Logger().Error(err)\n}\nfmt.Println(tetris.NowBlock)\n</code></pre>\n\n<p>the println result is ,</p>\n\n<pre><code>'map[]' //nil...\n</code></pre>\n\n<p>this is my full question link(<a href=\"https://stackoverflow.com/questions/53333011/golang-how-to-bind-ajax-json-data-to-custom-struct-type\">GOLANG &gt; How to bind ajax json data to custom struct type?</a>)</p>\n\n<p>please help me.</p>\n\n<p><br/><br/>\nps. thank you for answer me.\nI did like the answer.\nBUT, it does not working too.</p>\n\n<p>First, </p>\n\n<pre><code>- No 'contentType : \"application/json\"'\n- don't use JSON.stringify\n\n then, in go side, \n- fmt.println(tetris.KeyCode) // OK\n- fmt.println(tetris.NowBlock) // NOT OK.. 'map[]'\n</code></pre>\n\n<p>Second,</p>\n\n<pre><code>- Use 'contentType : \"application/json\"'\n- Use JSON.stringify\n\nthen, in go side, \n- fmt.println(tetris.KeyCode) // NOT OK.. '' (nil)\n- fmt.println(tetris.NowBlock) // NOT OK.. 'map[]'\n</code></pre>\n\n<p>Third,</p>\n\n<pre><code>i remove the custom struct type Tetris NowBlock object's `form:nowBlock` literal, \nbut is does not working too...\n</code></pre>\n\n<p>why not binding Custom structure type in a map object?</p>\n\n<p><br/><br/><br/>\ni'm so so sorry. i solve this question.\nthe problem that is my go custom struct type have another custom struct type.</p>\n\n<p>like this.</p>\n\n<pre><code>type Tetris struct {\n    Common Common\n\n    NowBlock           map[string]int     `json:\"nowBlock\"`\n}\n\ntype Common struct {\n    CtxWidth  int `json:\"ctxWidth\"`\n    CtxHeight int `json:\"ctxHeight\"`\n\n    KeyCode int `form:\"keyCode\" json:\"keyCode\"`\n}\n</code></pre>\n\n<p>in this case, i did </p>\n\n<pre><code> $.ajax({\n type : \"POST\"\n , url : \"/game/tetris/api/control\"\n , data : {\n            \"keyCode\" : keyCode\n            , \"ctxWidth\" : ctxWidth\n            , \"ctxHeight\" : ctxHeight\n            , \"nowBlock\" : {\"O\":0}\n } // also, i did JSON.stringify, but did not binding..\n , dataType : \"json\"\n , contentType : \"application/json\"\n }).done(function(data){\n       ... ...\n</code></pre>\n\n<p>});</p>\n\n<p>but, this is wrong!\nthe correct is,</p>\n\n<pre><code>$.ajax({\n    type : \"POST\"\n    , url : \"/game/tetris/api/control\"\n    , data : JSON.stringify({\n        \"Common\" : {\n            \"keyCode\" : keyCode\n            , \"ctxWidth\" : ctxWidth\n            , \"ctxHeight\" : ctxHeight\n        }\n        , \"nowBlock\" : {\"O\":0}\n    })\n    , dataType : \"json\"\n    , contentType : \"application/json\"\n}).done(function(data){\n   ... ...\n</code></pre>\n\n<p>in json data, 'Common' struct type's data must have \"Common\" 'Key:value' map...</p>\n\n<p>i'm very glade to your answers and attentions.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1542775367, "post_id": 53405307, "comment_id": 93685678, "body": "<code>go test</code> runs <code>vet</code> automatically; build doesn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1542776180, "last_edit_date": 1542776180, "creation_date": 1542775276, "answer_id": 53405373, "question_id": 53405307, "link": "https://stackoverflow.com/questions/53405307/not-getting-warning-messages-with-go-build/53405373#53405373", "title": "Not getting warning messages with go build", "body": "<p><code>test.go</code>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Printf(\"%s\\n\", 0) // format error\n}\n</code></pre>\n\n<hr>\n\n<p>For example,</p>\n\n<p>Output:</p>\n\n<pre><code>$ go build test.go\n$ ./test\n%!s(int=0)\n$ \n</code></pre>\n\n<p>For help, run <code>go help build</code>.</p>\n\n<hr>\n\n<p>Or,</p>\n\n<p>Output:</p>\n\n<pre><code>$ go run test.go\n%!s(int=0)\n$\n</code></pre>\n\n<p>For help, run <code>go help run</code>.</p>\n\n<hr>\n\n<p>Or,</p>\n\n<p>Output:</p>\n\n<pre><code>$ go vet test.go\n# command-line-arguments\n./test.go:7:2: Printf format %s has arg 0 of wrong type int\n$ \n</code></pre>\n\n<p>For help, run <code>go help vet</code>.</p>\n\n<hr>\n\n<p>Reference <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">Command go</a> </p>\n"}], "owner": {"reputation": 2658, "user_id": 1616210, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/pKBwj.jpg?s=128&g=1", "display_name": "qweruiop", "link": "https://stackoverflow.com/users/1616210/qweruiop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1542776180, "creation_date": 1542774821, "last_edit_date": 1542775130, "question_id": 53405307, "link": "https://stackoverflow.com/questions/53405307/not-getting-warning-messages-with-go-build", "title": "Not getting warning messages with go build", "body": "<pre><code>// test.go\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Printf(\"%s\", 0) // format error\n}\n</code></pre>\n\n<p>With <code>go build test.go</code> I got no warning messages or errors at all. I don't see a warning flag in <code>go help build</code> either. Am I missing something?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10492922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d552b697bcb2220e98ec1b66471f6123?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/10492922/tester"}, "edited": false, "score": 0, "creation_date": 1542794792, "post_id": 53407736, "comment_id": 93694060, "body": "I have another problem , how to print variabel for, in outside for var datePriodGlobal string \tfor _, DatePeriod := range  resultMapPriodTest.Array()[1:13] { \t\tdatePriodGlobal = fmt.Sprintln(&quot;%s&quot;, DatePeriod) \t}  \tvar contractsSubmittedGlobal string \tfor _, ContractsSubmitted := range resultContractsSubmittedTest.Array()[1:13]{ \t\tcontractsSubmittedGlobal =fmt.Sprintln(&quot;%s&quot;, ContractsSubmitted) \t} \tfmt.Printf(&quot;%s | \t\t%s \t\t\t\t\\t|&quot;,datePriodGlobal, contractsSubmittedGlobal)"}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "reply_to_user": {"reputation": 35, "user_id": 10492922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d552b697bcb2220e98ec1b66471f6123?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/10492922/tester"}, "edited": false, "score": 0, "creation_date": 1542795147, "post_id": 53407736, "comment_id": 93694248, "body": "It would be better if you ask another question for that. The comments lacks the proper formatting to read larger amounts of code."}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "reply_to_user": {"reputation": 35, "user_id": 10492922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d552b697bcb2220e98ec1b66471f6123?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/10492922/tester"}, "edited": false, "score": 0, "creation_date": 1542795363, "post_id": 53407736, "comment_id": 93694371, "body": "If this answer already answers your original question and you are satisfied with it, mark it as accepted and post another question."}], "tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 3, "last_activity_date": 1542814423, "last_edit_date": 1542814423, "creation_date": 1542788112, "answer_id": 53407736, "question_id": 53405233, "link": "https://stackoverflow.com/questions/53405233/how-to-loop-over-a-slice-in-gjson/53407736#53407736", "title": "How to loop over a slice in GJSON", "body": "<p><code>Result.Array()</code> converts the current result to a slice of <code>Result</code> (<code>[]Result</code>). Hence, you can just take a slice for your desired range. e.g. <code>resultPriod.Array()[0:12]</code> to get the first 12 elements.</p>\n\n<p>Take this simplified version as an example:</p>\n\n<pre><code>func main() {\n\n    jsonString := `\n{\n    \"PaymentCalendarList\": {\n        \"PaymentCalendar\": [\n            {\"ContractSubmitted\": 10,\n             \"Date\": \"2018-01-01T01:01:01\"},\n            {\"ContractSubmitted\": 20,\n             \"Date\": \"2018-01-01T02:02:02\"},\n            {\"ContractSubmitted\": 30,\n             \"Date\": \"2018-01-01T03:03:03\"}\n            {\"ContractSubmitted\": 40,\n             \"Date\": \"2018-01-01T04:04:04\"}\n            {\"ContractSubmitted\": 50,\n             \"Date\": \"2018-01-01T05:05:05\"}\n        ]\n    }\n}`\n\n    tempPayments := \"PaymentCalendarList.PaymentCalendar.\"\n    resultPeriod := gjson.Get(jsonString, tempPayments+\"#.Date\")\n\n    # Take the first 3 results\n    for _, datePeriod := range resultPeriod.Array()[0:3] {\n        fmt.Println(datePeriod)\n    }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Iqx42_SBpFh\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 35, "user_id": 10492922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d552b697bcb2220e98ec1b66471f6123?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/10492922/tester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 53407736, "answer_count": 1, "score": 2, "last_activity_date": 1542814733, "creation_date": 1542774237, "last_edit_date": 1542814733, "question_id": 53405233, "link": "https://stackoverflow.com/questions/53405233/how-to-loop-over-a-slice-in-gjson", "title": "How to loop over a slice in GJSON", "body": "<p>How to looping range  or regex #[1 - 12] to display based # in Library GJSON <a href=\"https://github.com/tidwall/gjson\" rel=\"nofollow noreferrer\">gjson library</a></p>\n\n<p>example like this, I have picture json in below :</p>\n\n<p><a href=\"https://i.stack.imgur.com/dpmRS.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>and I have try to looping  like below </p>\n\n<pre><code>tempPayments:=\"Envelope.Body.GetCustomReportResponse.GetCustomReportResult.ContractSummary.PaymentCalendarList.PaymentCalendar.\"\nresultPriod1 := gjson.Get(jsonString,tempPayments + \"#.Date\")\nfor _, datePriod := range resultPriod1.Array() {\n    println(datePriod[1].String())\n}\n</code></pre>\n\n<p>how to I can display result between range [1-10]  ,in \"#\" ? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 177, "user_id": 4897517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_sv2TGMexCo/AAAAAAAAAAI/AAAAAAAAABw/ld1uqfffBsA/photo.jpg?sz=128", "display_name": "manemarron", "link": "https://stackoverflow.com/users/4897517/manemarron"}, "edited": false, "score": 1, "creation_date": 1542766049, "post_id": 53404305, "comment_id": 93683654, "body": "In your example, both cases are equally valid as both result in the default value of the <code>Example</code> type. I would prefer using the := syntax since most cases you will not initialize a variable with the default value."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1542767775, "post_id": 53404305, "comment_id": 93684028, "body": "They are identical. It&#39;s a style thing. I use <code>var</code> if I&#39;m not going to initialize the variable and <code>:=</code> if I am going to initialize it (i.e., to something other than the zero value)."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 4897517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_sv2TGMexCo/AAAAAAAAAAI/AAAAAAAAABw/ld1uqfffBsA/photo.jpg?sz=128", "display_name": "manemarron", "link": "https://stackoverflow.com/users/4897517/manemarron"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1542768774, "post_id": 53404332, "comment_id": 93684223, "body": "@ThunderCat You could use it also outside of a for or an if statement, so it is  not necessarily the package scope"}], "tags": [], "owner": {"reputation": 177, "user_id": 4897517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_sv2TGMexCo/AAAAAAAAAAI/AAAAAAAAABw/ld1uqfffBsA/photo.jpg?sz=128", "display_name": "manemarron", "link": "https://stackoverflow.com/users/4897517/manemarron"}, "is_accepted": false, "score": 2, "last_activity_date": 1542765835, "creation_date": 1542765835, "answer_id": 53404332, "question_id": 53404305, "link": "https://stackoverflow.com/questions/53404305/when-to-use-var-or-in-go/53404332#53404332", "title": "When to use var or := in Go?", "body": "<p><code>var</code> is mostly used to define variables in a shared scope. For example,</p>\n\n<pre><code>var something string\n\nfunc init() {\n    something = \"Hello world!\"\n}\n\nfunc main() {\n    fmt.Println(something)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 603, "user_id": 7698574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8a753a44d713f8c8a2be787fa94bc651?s=128&d=identicon&r=PG&f=1", "display_name": "Fidel", "link": "https://stackoverflow.com/users/7698574/fidel"}, "edited": false, "score": 0, "creation_date": 1564754368, "post_id": 53404333, "comment_id": 101145956, "body": "those two have difference behaviour, <code>var</code> help us to specified without initialisation and we can specify many var in the same type but <code>:=</code> is the opposite of it and we could get the defined value on it"}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542766716, "last_edit_date": 1542766716, "creation_date": 1542765840, "answer_id": 53404333, "question_id": 53404305, "link": "https://stackoverflow.com/questions/53404305/when-to-use-var-or-in-go/53404333#53404333", "title": "When to use var or := in Go?", "body": "<p>Have no different in here, just a habit. I often use <code>var e Example</code>.<br>\n<code>:=</code> can not using outside function while <code>var</code> can do it.</p>\n"}, {"comments": [{"owner": {"reputation": 954, "user_id": 4328633, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-g1XYzvszg2I/AAAAAAAAAAI/AAAAAAAAAwM/a0kU3BPnqgA/photo.jpg?sz=128", "display_name": "Daniel Hornik", "link": "https://stackoverflow.com/users/4328633/daniel-hornik"}, "edited": false, "score": 0, "creation_date": 1609628063, "post_id": 53404567, "comment_id": 115882981, "body": "I agree with you, but it&#39;s worth to make a note, you need to pay more attention when using var. Let&#39;s see this simple example: <code>var john *Person fmt.Println(&quot;%s is %d years old&quot;, john.name, john.age)</code> - This will cause runtime error: <a href=\"https://play.golang.org/p/ZJh7qfQaO73\" rel=\"nofollow noreferrer\">play.golang.org/p/ZJh7qfQaO73</a>"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 954, "user_id": 4328633, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-g1XYzvszg2I/AAAAAAAAAAI/AAAAAAAAAwM/a0kU3BPnqgA/photo.jpg?sz=128", "display_name": "Daniel Hornik", "link": "https://stackoverflow.com/users/4328633/daniel-hornik"}, "edited": false, "score": 0, "creation_date": 1609677840, "post_id": 53404567, "comment_id": 115891798, "body": "@DanielHornik it&#39;s because the zero value of any pointer type is <code>nil</code>. and you try to access it&#39;s property (e.g. <code>john.name</code>) meanwhile <code>john</code> value is <code>nil</code>. your case is not actually related with the usage of <code>var</code>"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 16, "last_activity_date": 1582149408, "last_edit_date": 1582149408, "creation_date": 1542767985, "answer_id": 53404567, "question_id": 53404305, "link": "https://stackoverflow.com/questions/53404305/when-to-use-var-or-in-go/53404567#53404567", "title": "When to use var or := in Go?", "body": "<p>Might worth noting:</p>\n\n<p>Use <code>:=</code> when you need to create a variable with a defined value on it.</p>\n\n<pre><code>number := 12\nobj := SomeStruct{name: \"user\"}\nslice := []string{\"a\", \"b\", \"c\"}\nsomeNilPointerData := (*SomeStruct)(nil)\n</code></pre>\n\n<hr>\n\n<p>Use <code>var</code> keyword when you need to define a variable without any initialisation, so the zero value will be used on it.</p>\n\n<pre><code>var a int // zero value of int is 0\nvar mut sync.Mutex\nvar result []map[string]interface{}\n</code></pre>\n\n<hr>\n\n<p>Another advantage of using <code>var</code> keyword, creating multiple variables with same type in single statement.</p>\n\n<pre><code>var result1, result2, result3, result4 []map[string]interface{}\n</code></pre>\n\n<hr>\n\n<p>The <code>var</code> keyword is also useful to store certain literal value in a variable with different data type.</p>\n\n<pre><code>// store string literal value in interface{} variable\nvar anyValue interface{} = \"hello world\"\n\n// store int literal value in float64 variable\nvar otherValue float64 = 12\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3972, "favorite_count": 0, "closed_date": 1542794011, "accepted_answer_id": 53404567, "answer_count": 3, "score": 2, "last_activity_date": 1582149408, "creation_date": 1542765564, "last_edit_date": 1542784618, "question_id": 53404305, "link": "https://stackoverflow.com/questions/53404305/when-to-use-var-or-in-go", "closed_reason": "Duplicate", "title": "When to use var or := in Go?", "body": "<p>Is there any difference between the following two examples?</p>\n\n<pre><code>type Example struct {}\n\nfunc main() {\n  e := Example{}\n}\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>type Example struct {}\n\nfunc main() {\n  var e Example\n}\n</code></pre>\n\n<p>Is there a preferable one?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "module", "go-modules"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542775629, "post_id": 53404155, "comment_id": 93685738, "body": "Nothing in regard to naming packages has changed with the introduction of modules. Your idea of approach 1 is totally wrong and does not work: Packages cannot be &quot;combined&quot;."}, {"owner": {"reputation": 660, "user_id": 7153181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bG1RYMw_evY/AAAAAAAAAAI/AAAAAAAAAAs/-Vwq9bIkSLc/photo.jpg?sz=128", "display_name": "Ryota", "link": "https://stackoverflow.com/users/7153181/ryota"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542789184, "post_id": 53404155, "comment_id": 93690716, "body": "Thanks for the input, but defining a single package with multiple files should be conventional (how there are businessA/B/C to orchestrate <code>package business</code>). Approach A was merely to structure files using extra subdirectory. Does that mean I\u2019m better off putting all files in a single directory and not have subdirectory at all, if I were to achieve something along the line with Approach 1?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1542791415, "post_id": 53404155, "comment_id": 93692022, "body": "You have to read How to Write Go Code. There is one and only one way to write Go code. A package is one folder and may contain one or more source code files. Approach 1 is 100% undoabe in Go. Forget about that now and forever. It is one folder == one package. And there is no opinion or desire to have here."}, {"owner": {"reputation": 660, "user_id": 7153181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bG1RYMw_evY/AAAAAAAAAAI/AAAAAAAAAAs/-Vwq9bIkSLc/photo.jpg?sz=128", "display_name": "Ryota", "link": "https://stackoverflow.com/users/7153181/ryota"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542798382, "post_id": 53404155, "comment_id": 93696173, "body": "Thanks for the clear answer, it seemed as if the Go Module introduced slight flexibility with it, but clearly I was reading it wrong. May I shamelessly ask - would you mind posting it as an answer, so that I can close this question? With the Go Modules in picture, I had difficulty finding the right doc, and this may still be useful for newbies like myself."}, {"owner": {"reputation": 660, "user_id": 7153181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bG1RYMw_evY/AAAAAAAAAAI/AAAAAAAAAAs/-Vwq9bIkSLc/photo.jpg?sz=128", "display_name": "Ryota", "link": "https://stackoverflow.com/users/7153181/ryota"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542927888, "post_id": 53404155, "comment_id": 93751403, "body": "@Volker - I played a bit more and posted an answer with some information along the line with your comment. It may be an over-complication, but I find having a clear answer with some reference helps, if by any chance someone ends up finding this post. Thanks for your input anyways."}], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542953792, "post_id": 53438875, "comment_id": 93755838, "body": "Well, I have to disappoint you. This answer is technically not correct as approach 1 <i>is</i> possible. You see, I lied in my comment above. Nevertheless my advice and your conclusion are 100% valid. There is just one golden way to structure your code layout and build your packages and projects. This is explained in How to Write Go Code and perfectly illustrated by the stdlib and the  rest of the supporting Go repos and everybody should follow this advice and nothing else."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542953984, "post_id": 53438875, "comment_id": 93755902, "body": "But: It is technically not true. Instead of building your code with the <code>go</code> tool one <i>can</i> invoke the compiler and linker manually (or typically through a makefile or some other build tooling) and this allows to combine <i>arbitrary</i> files into one package. Nobody sane does this ever as this break each and every Go tool in the world, but it is possible and it is done."}, {"owner": {"reputation": 660, "user_id": 7153181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bG1RYMw_evY/AAAAAAAAAAI/AAAAAAAAAAs/-Vwq9bIkSLc/photo.jpg?sz=128", "display_name": "Ryota", "link": "https://stackoverflow.com/users/7153181/ryota"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542967163, "post_id": 53438875, "comment_id": 93761714, "body": "Hmm, that is an eyeopening point. As I find Go having golden rules and being opinionated how things <i>should</i> be done, I appreciate how the community can heavily rely on the conventions, more so than other languages IMO. Working around the <code>go</code> tools is probably beyond the scope of the original question, but certainly a valid point."}], "tags": [], "owner": {"reputation": 660, "user_id": 7153181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bG1RYMw_evY/AAAAAAAAAAI/AAAAAAAAAAs/-Vwq9bIkSLc/photo.jpg?sz=128", "display_name": "Ryota", "link": "https://stackoverflow.com/users/7153181/ryota"}, "is_accepted": false, "score": 3, "last_activity_date": 1542927561, "creation_date": 1542927561, "answer_id": 53438875, "question_id": 53404155, "link": "https://stackoverflow.com/questions/53404155/go-modules-naming-convention-of-directories-and-packages/53438875#53438875", "title": "Go Modules - naming convention of directories and packages", "body": "<h2>Approach 2 is correct.</h2>\n\n<p>Being a Go newbie, I had mistakenly thought that Approach 1 was one possible way, as Go does allow having package name different from directory name.</p>\n\n<p>As <a href=\"https://stackoverflow.com/users/1266756/volker\">Volker</a> helped in the comments, Approach 1 is <strong>definitely not possible</strong>.<br>\nYou will get a straight compilation error when trying to combine packages.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zEUJD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zEUJD.png\" alt=\"compilation error\"></a></p>\n\n<p>The introduction of Go Modules does not affect the best practices outlined in existing documents, such as:  </p>\n\n<ul>\n<li><a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a></li>\n<li><a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">Effective Go</a></li>\n</ul>\n\n<p>As a side note, I also came to know that package name should be singular form.  </p>\n\n<ul>\n<li><a href=\"https://rakyll.org/style-packages/\" rel=\"nofollow noreferrer\">Style guideline for Go packages</a></li>\n</ul>\n\n<p>So that would leave me with the following structure along with <strong>Approach 2</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TJLdj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TJLdj.png\" alt=\"structure following the convention\"></a></p>\n"}], "owner": {"reputation": 660, "user_id": 7153181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bG1RYMw_evY/AAAAAAAAAAI/AAAAAAAAAAs/-Vwq9bIkSLc/photo.jpg?sz=128", "display_name": "Ryota", "link": "https://stackoverflow.com/users/7153181/ryota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12175, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1570806101, "creation_date": 1542764434, "last_edit_date": 1570806101, "question_id": 53404155, "link": "https://stackoverflow.com/questions/53404155/go-modules-naming-convention-of-directories-and-packages", "title": "Go Modules - naming convention of directories and packages", "body": "<p>I understand <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\">Go Modules</a> are yet an experimental opt-in feature, and perhaps because of that, I cannot find clear guidance on how to name directories and <code>package</code>s.<br>\nIn these <a href=\"https://blog.golang.org/package-names\" rel=\"noreferrer\">Package names in Go Blog</a> post and <a href=\"https://golang.org/doc/effective_go.html#package-names\" rel=\"noreferrer\">Package name in Effective Go</a>, they talk about that the directory should match the package name - but I wasn't certain if Go Modules would follow the same pattern.</p>\n\n<p>If I want to bundle my business logic in <code>package business</code> with many files, is it reasonable to create subdirectory <code>validators/</code> and keep the same package name <code>package business</code>?</p>\n\n<pre><code>someDir\n\u251c\u2500\u2500 business\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 businessA.go // package business\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 businessB.go // package business\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 businessC.go // package business\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 validators\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 businessValidatorX.go // package business, or validators?\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 businessValidatorY.go // package business, or validators?\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 businessValidatorZ.go // package business, or validators?\n\u251c\u2500\u2500 go.mod   // module example.com\n\u2514\u2500\u2500 main.go\n</code></pre>\n\n<hr>\n\n<h2>Approach 1.</h2>\n\n<p>If I were to go with the same package name:</p>\n\n<pre><code>// main.go\npackage main\n\nimport (\n        \"example.com/business\"\n        \"example.com/business/validators\"\n)\n\n// both imports would be combined to the same `business` package?\nfunc main() {\n        b := business.SomeLogic()\n        business.ValidateX(b) // validator from the same package\n}\n</code></pre>\n\n<p>This looks to be prone to export conflict - but it is simple.</p>\n\n<h2>Approach 2.</h2>\n\n<p>If the <code>validators/</code> path maps to <code>package validators</code>, the consuming code would look like the below instead.</p>\n\n<pre><code>// main.go\npackage main\n\nimport (\n        \"example.com/business\"\n        \"example.com/business/validators\"\n)\n\nfunc main() {\n        b := business.SomeLogic()\n        validators.ValidateX(b) // validator from a separate package\n}\n</code></pre>\n\n<hr>\n\n<p>How should I manage a package consisted of many files? Is the Approach 1. reasonable, although it somewhat contradicts from the blog post and doc above?<br>\nOr should I go with Approach 2., complying with the convention, and add an alias as necessary in <code>main.go</code>?</p>\n"}, {"tags": ["go", "yield"], "comments": [{"owner": {"reputation": 1053, "user_id": 234139, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a0efc2a2935cf5a96fc6e4604ffbdd51?s=128&d=identicon&r=PG", "display_name": "jonr", "link": "https://stackoverflow.com/users/234139/jonr"}, "edited": false, "score": 0, "creation_date": 1542760368, "post_id": 53403593, "comment_id": 93682363, "body": "Seems this was discussed at <a href=\"https://github.com/golang/go/issues/19702\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/19702</a>, and likely will not be fixed."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542762879, "post_id": 53403593, "comment_id": 93682966, "body": "You can implement an iterator design pattern: it wouldn&#39;t be as elegant as <code>yield</code>, but semantically the same <a href=\"https://play.golang.org/p/7zw6iIwcDxH\" rel=\"nofollow noreferrer\">play.golang.org/p/7zw6iIwcDxH</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1542764370, "post_id": 53403593, "comment_id": 93683284, "body": "See <a href=\"https://blog.golang.org/pipelines#TOC_5.\" rel=\"nofollow noreferrer\">Stopping Short</a> in <a href=\"https://blog.golang.org/pipelines#its_not_as_easy_as_it_should_be\" rel=\"nofollow noreferrer\">Go Concurrency Patterns: Pipelines and cancellation</a>."}], "owner": {"reputation": 1053, "user_id": 234139, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a0efc2a2935cf5a96fc6e4604ffbdd51?s=128&d=identicon&r=PG", "display_name": "jonr", "link": "https://stackoverflow.com/users/234139/jonr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542759777, "creation_date": 1542759777, "question_id": 53403593, "link": "https://stackoverflow.com/questions/53403593/return-early-from-range-of-a-channel", "title": "return early from range of a channel", "body": "<p>Is it possible to implement something akin to <code>yield</code> from python in go? That is, I want a producer/consumer paradigm where the consumer can ignore values produced by the producer at any time without manifesting a memory leak.</p>\n\n<p>In python I could have a producer that produces infinite values and the client can consume as many as they wish.</p>\n\n<pre><code>def producer():\n  i = 0\n  while True:\n     yield i\n     i += 1\n\ndef consumer():\n   for i in producer():\n     if i == 2:\n        return\n</code></pre>\n\n<p>The common advice for this is for the producer to return a channel that the client uses in a <code>range</code> expression, and the producer can put its values into the channel. This is fine as long as the client reads all the values in the channel, but if the client breaks control from the <code>range</code> loop early the producer channel will be left hanging forever using up memory.</p>\n\n<pre><code>package main\n\nfunc yield() chan int {\n    out := make(chan int)\n    go func(){\n        out &lt;- 1\n        out &lt;- 2\n        close(out)\n    }()\n    return out\n}\n\nfunc test(){\n    for _ = range yield() {\n        // return\n    }\n}\n\nfunc main(){\n    for {\n        test()\n    }\n}\n</code></pre>\n\n<p>If the <code>return</code> in <code>test</code> is uncommented this code will use memory without bound, because the channel returned by <code>yield</code> has a value that is waiting to be read and apparently neither the channel nor the goroutine can be garbage collected safely.</p>\n\n<p>Some possible solutions (neither of which I like) are</p>\n\n<ol>\n<li><p>Change <code>out</code> in <code>yield</code> to be a buffered channel with exactly the amount of space as values that will be produced. In that case <code>yield</code> could be</p>\n\n<p>func yield() chan int {\n        out := make(chan int, 2)\n        out &lt;- 1\n        out &lt;- 2\n        close(out)\n        return out\n    }</p></li>\n</ol>\n\n<p>But this is suboptimal because I don't know in general how many items <code>yield</code> will produce. This style is similar to just returning an array.</p>\n\n<ol start=\"2\">\n<li>Have the <code>yield</code> method use a timeout for putting values into the channel, and if the timeout is reached then close the channel early. This makes assumptions about the execution time of the client, which seems like a bad idea.</li>\n</ol>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1542759521, "post_id": 53403430, "comment_id": 93682202, "body": "I don&#39;t understand the question, but <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\"><code>fmt.Stringer</code></a> is used by the <code>fmt</code> package for printing values. See also the <a href=\"https://tour.golang.org/methods/17\" rel=\"nofollow noreferrer\">Tour of Go: Stringers</a>."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10672190, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRRj0z-iqws/AAAAAAAAAAI/AAAAAAAAaN0/AEXieqkfJH8/photo.jpg?sz=128", "display_name": "Honord", "link": "https://stackoverflow.com/users/10672190/honord"}, "edited": false, "score": 0, "creation_date": 1542764241, "post_id": 53404104, "comment_id": 93683253, "body": "Thanks for your answer. I understand i.M() will return dddd. I expect script1 return dddd like script2 return ccccc ."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 71, "user_id": 10672190, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRRj0z-iqws/AAAAAAAAAAI/AAAAAAAAaN0/AEXieqkfJH8/photo.jpg?sz=128", "display_name": "Honord", "link": "https://stackoverflow.com/users/10672190/honord"}, "edited": false, "score": 0, "creation_date": 1542768436, "post_id": 53404104, "comment_id": 93684162, "body": "@HenryXie why do you expect that?"}, {"owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "edited": false, "score": 0, "creation_date": 1542772018, "post_id": 53404104, "comment_id": 93684955, "body": "The fmt package (and many others) look for this String() first to print values."}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542764443, "last_edit_date": 1542764443, "creation_date": 1542764059, "answer_id": 53404104, "question_id": 53403430, "link": "https://stackoverflow.com/questions/53403430/why-my-golang-defined-method-not-implemented-implicitily-while-string-does/53404104#53404104", "title": "Why my Golang defined method not implemented implicitily while String() does", "body": "<p>You should call <code>fmt.Println(i.M())</code> ?<br>\nWhy you want <code>fmt</code> call a function while its'n exist?</p>\n\n<p>A <code>Stringer</code> is a type that can describe itself as a string. The <code>fmt</code> package (and many others) look for this interface to print values</p>\n"}, {"tags": [], "owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1542765119, "creation_date": 1542765119, "answer_id": 53404247, "question_id": 53403430, "link": "https://stackoverflow.com/questions/53403430/why-my-golang-defined-method-not-implemented-implicitily-while-string-does/53404247#53404247", "title": "Why my Golang defined method not implemented implicitily while String() does", "body": "<p>Refer: <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/#Stringer</a></p>\n\n<blockquote>\n  <p>Stringer is implemented by any value that has a String method, which\n  defines the \u201cnative\u201d format for that value. The String method is used\n  to print values passed as an operand to any format that accepts a\n  string or to an unformatted printer such as Print.</p>\n</blockquote>\n\n<p>In your case, in script1 you are just printing out the struct. In script2 you are providing what the builder should use when an unformatted print occurs which is a function that prints out \"ccccc\".</p>\n"}], "owner": {"reputation": 71, "user_id": 10672190, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRRj0z-iqws/AAAAAAAAAAI/AAAAAAAAaN0/AEXieqkfJH8/photo.jpg?sz=128", "display_name": "Honord", "link": "https://stackoverflow.com/users/10672190/honord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1542834710, "creation_date": 1542758534, "last_edit_date": 1542834710, "question_id": 53403430, "link": "https://stackoverflow.com/questions/53403430/why-my-golang-defined-method-not-implemented-implicitily-while-string-does", "title": "Why my Golang defined method not implemented implicitily while String() does", "body": "<p>In <a href=\"https://tour.golang.org/methods/11\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/11</a></p>\n\n<p>It states Under the hood, interface values can be thought of as a tuple of a value and a concrete type</p>\n\n<p>I define M as follows </p>\n\n<p><strong>script1</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype I interface {\n    M() string\n}\ntype T struct {\n    S string\n    w string\n}\nfunc (t T) M() string {\n    return \"dddd\"\n}\nfunc main() {\n    var i I\n    i = T{\"Hello\",\"eeee\"}  \n    fmt.Printf(\"(%v, %T)\", i, i)    \n    fmt.Println(i)\n}\n</code></pre>\n\n<p>This prints out <code>({Hello eee}, main.T){Hello eee}</code>\ninterface i has vaule {Hello eee} and type main.T</p>\n\n<p><strong>script2:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype I interface {\n    M() string\n}\ntype T struct {\n    S string\n    w string\n}\nfunc (t T) M() string {\n    return \"dddd\"\n}\nfunc (t T) String() string {\n    return \"ccccc\"\n}\nfunc main() {\n    var i I\n    i = T{\"Hello\",\"eeee\"}\n    fmt.Printf(\"(%v, %T)\", i, i) \n    fmt.Println(i)\n}\n</code></pre>\n\n<p>This prints out <code>(ccccc, main.T)ccccc</code>.</p>\n\n<p>interface i has vaule ccccc and type main.T</p>\n\n<p>Seems when i add String() as Stringer defined by the fmt package in script2. The String() is implemented implicitily,not sure why?</p>\n\n<p>I thought in script2 i would have value \"{Hello eee}\" and type main.T</p>\n"}, {"tags": ["go", "parameters", "channel"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542754758, "post_id": 53402815, "comment_id": 93681012, "body": "<a href=\"https://github.com/golang/go/wiki/CommonMistakes#using-goroutines-on-loop-iterator-variables\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1542754768, "post_id": 53402815, "comment_id": 93681020, "body": "See the FAQ: <a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow noreferrer\">golang.org/doc/faq#closures_and_goroutines</a>"}, {"owner": {"reputation": 157, "user_id": 8095085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264f925eea33f5361466bdf669ec60af?s=128&d=identicon&r=PG&f=1", "display_name": "xiaoxinmiao", "link": "https://stackoverflow.com/users/8095085/xiaoxinmiao"}, "edited": false, "score": 0, "creation_date": 1542755209, "post_id": 53402815, "comment_id": 93681196, "body": "so good,Your answer is exactly what I want.  for _, v := range contents { \t\tgo func(v1 *Dto) { \t\t\tin &lt;- v1 \t\t}(v) \t\tgo Deal(in, out) \t}"}], "owner": {"reputation": 157, "user_id": 8095085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264f925eea33f5361466bdf669ec60af?s=128&d=identicon&r=PG&f=1", "display_name": "xiaoxinmiao", "link": "https://stackoverflow.com/users/8095085/xiaoxinmiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 1, "closed_date": 1542755179, "answer_count": 0, "score": 0, "last_activity_date": 1542755012, "creation_date": 1542754483, "last_edit_date": 1542755012, "question_id": 53402815, "link": "https://stackoverflow.com/questions/53402815/when-i-used-chan-to-pass-the-argument-i-didnt-get-the-expected-result", "closed_reason": "Duplicate", "title": "When I used chan to pass the argument, I didn&#39;t get the expected result", "body": "<p>code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Dto struct {\n    Name string\n    Age  int64\n}\n\nfunc Deal(in &lt;-chan *Dto, out chan&lt;- *Dto) {\n    in1 := &lt;-in\n    newDto := &amp;Dto{\n        Name: in1.Name,\n        Age:  in1.Age,\n    }\n    if in1.Name == \"xiao1\" {\n        newDto.Age += 100\n    }\n    out &lt;- in1\n}\n\nfunc main() {\n    in, out := make(chan *Dto), make(chan *Dto)\n    contents := []*Dto{\n        &amp;Dto{Name: \"xiao\", Age: 18},\n        &amp;Dto{Name: \"xiao1\", Age: 19},\n        &amp;Dto{Name: \"xiao2\", Age: 20},\n        &amp;Dto{Name: \"xiao3\", Age: 21},\n        &amp;Dto{Name: \"xiao4\", Age: 22},\n    }\n    for _, v := range contents {\n        go func() {\n            in &lt;- v\n        }()\n        go Deal(in, out)\n    }\n    count := len(contents)\n    for index := 0; index &lt; count; index++ {\n        fmt.Println(&lt;-out)\n    }\n    close(in)\n    fmt.Println(\"end\")\n    time.Sleep(100 * time.Minute)\n}\n</code></pre>\n\n<p>actual output</p>\n\n<pre><code>    &amp;{xiao4 22}\n    &amp;{xiao4 22}\n    &amp;{xiao4 22}\n    &amp;{xiao4 22}\n    &amp;{xiao4 22}\n</code></pre>\n\n<p>expected output</p>\n\n<pre><code>    &amp;{xiao 18}\n    &amp;{xiao1 119}\n    &amp;{xiao2 20}\n    &amp;{xiao3 21}\n    &amp;{xiao4 22}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542755217, "post_id": 53402640, "comment_id": 93681198, "body": "Are you sure you are running the binary you just built?"}, {"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542755456, "post_id": 53402640, "comment_id": 93681272, "body": "yes, I can change the value of GitRev from &#39;oldvalue&#39; to &#39;oldvalue1&#39; and see that it changes the next time I build the appName.exe binary"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542756774, "post_id": 53402640, "comment_id": 93681593, "body": "I took your code, and: 1) <code>\u279c go build -ldflags=&quot;-X main.GitRev=adaf66c&quot;</code> 2) <code>\u279c .&#47;so-53402640  variable contents:  adaf66c </code> (it&#39;s linux though)"}, {"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542757274, "post_id": 53402640, "comment_id": 93681706, "body": "ya it should work. maybe related to the paths.  I also have a large project with many imports too, but shouldn&#39;t matter."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1542755103, "post_id": 53402733, "comment_id": 93681149, "body": "I&#39;m sure you misunderstand the question"}], "tags": [], "owner": {"reputation": 11, "user_id": 8571374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f94f98d1f3dfad525cd28731b87450d?s=128&d=identicon&r=PG&f=1", "display_name": "cooljoe", "link": "https://stackoverflow.com/users/8571374/cooljoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1542754005, "creation_date": 1542754005, "answer_id": 53402733, "question_id": 53402640, "link": "https://stackoverflow.com/questions/53402640/go-ldflags-set-variable-value-not-working/53402733#53402733", "title": "go ldflags set variable value not working", "body": "<p>I believe you are just declaring a variable and not a flag. Import the flag package and assign it like so.</p>\n\n<pre><code>import \"flag\"\nvar GitRev = flag.String(\"GitRev\", \"oldvalue\", \"what it represents\")\n</code></pre>\n"}], "owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542754005, "creation_date": 1542753442, "question_id": 53402640, "link": "https://stackoverflow.com/questions/53402640/go-ldflags-set-variable-value-not-working", "title": "go ldflags set variable value not working", "body": "<p>I'm trying to use go build to update a variable inside my project:</p>\n\n<p>full project path: </p>\n\n<pre><code>c:\\goprojects\\src\\deployment\\cl\\apps\\appName\n</code></pre>\n\n<p>run from c:\\goprojects\\src</p>\n\n<pre><code> go install -ldflags=\"-X main.GitRev=adaf66c\" deployment\\cl\\apps\\appName\\...\n</code></pre>\n\n<p>In the go project I have:</p>\n\n<pre><code>package main\nvar GitRev = \"oldvalue\"\n\n\nfunc main() {\n    fmt.Println(\"variable contents: \", GitRev)\n}\n</code></pre>\n\n<p>Then from the command line I run:</p>\n\n<pre><code>..\\bin\\appName.exe\n</code></pre>\n\n<p>I'm expecting to see the value: </p>\n\n<pre><code>adaf66c\n</code></pre>\n\n<p>What I get:  variable contents:  </p>\n\n<pre><code>oldvalue\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542754298, "post_id": 53402582, "comment_id": 93680873, "body": "It&#39;s still, as you say, &quot;bruteforce&quot;, but you CAN use a middleware to read it, check the size, then replace it back into the <code>Request.Body</code> using a new  <code>io.ReadCloser</code> because that is all the <code>Body</code> is. <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Request</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542755312, "post_id": 53402924, "comment_id": 93681241, "body": "Brilliant! Almost makes it seem odd that this isn&#39;t a builtin thing already. And here I was trying to figure out how to avoid copies using middleware."}, {"owner": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "edited": false, "score": 0, "creation_date": 1542806046, "post_id": 53402924, "comment_id": 93700223, "body": "This is a smart way of doing it indeed. The only issue (and i failed to mention this in the question) is that i would not know the size of the request when it comes, rather after it is read."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "edited": false, "score": 1, "creation_date": 1543266390, "post_id": 53402924, "comment_id": 93848005, "body": "@Husain Fair. Though it&#39;s impossible in the general case to get the size of the request without reading it first, and with the other answer you&#39;re simply reading the entire request up front and storing it to be reread later."}], "tags": [], "owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "is_accepted": false, "score": 4, "last_activity_date": 1542755037, "creation_date": 1542755037, "answer_id": 53402924, "question_id": 53402582, "link": "https://stackoverflow.com/questions/53402582/content-length-in-golang/53402924#53402924", "title": "Content Length in Golang", "body": "<p>You could write a custom <code>ReadCloser</code> that proxies an existing one and counts bytes as it goes. Something like:</p>\n\n<pre><code>type LengthReader struct {\n    Source io.ReadCloser\n    Length int\n}\n\nfunc (r *LengthReader) Read(b []byte) (int, error) {\n    n, err := r.Source.Read(b)\n    r.Length += n\n    return n, err\n}\n\nfunc (r *LengthReader) Close() error {\n    var buf [32]byte\n    var n int\n    var err error\n    for err == nil {\n        n, err = r.Source.Read(buf[:])\n        r.Length += n\n    }\n    closeerr := r.Source.Close()\n    if err != nil &amp;&amp; err != io.EOF {\n        return err\n    }\n    return closeerr\n}\n</code></pre>\n\n<p>This will count bytes as you read them from the stream, and when closed it will consume and count all remaining unread bytes first. After you're finished with the stream, you can then access the length.</p>\n"}, {"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": true, "score": 4, "last_activity_date": 1542766486, "creation_date": 1542766486, "answer_id": 53404405, "question_id": 53402582, "link": "https://stackoverflow.com/questions/53402582/content-length-in-golang/53404405#53404405", "title": "Content Length in Golang", "body": "<p>Why do you want a middle in here?<br>\nThe simple way is <code>b, err = io.Copy(anyWriterOrMultiwriter, r.Body)</code><br>\n<code>b</code> is total content length of request when <code>err == nil</code><br>\nUse request body as you want. Also <code>b, err = io.Copy(ioutil.Discard, r.Body)</code></p>\n"}, {"tags": [], "owner": {"reputation": 3996, "user_id": 1615594, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VD0n3.jpg?s=128&g=1", "display_name": "tsuz", "link": "https://stackoverflow.com/users/1615594/tsuz"}, "is_accepted": false, "score": 2, "last_activity_date": 1567657146, "last_edit_date": 1592644375, "creation_date": 1562863100, "answer_id": 56993790, "question_id": 53402582, "link": "https://stackoverflow.com/questions/53402582/content-length-in-golang/56993790#56993790", "title": "Content Length in Golang", "body": "<h1>Option 1</h1>\n<p>Use <a href=\"https://golang.org/pkg/io/#TeeReader\" rel=\"nofollow noreferrer\">TeeReader</a> and this is scalable. It splits reader into two and one of them calculates the size using allocated memory. Also, in the first case</p>\n<pre><code>  maxmem := 4096\n  var buf bytes.Buffer\n  // comment this line out if you want to disable gathering metrics\n  resp.Body = io.TeeReader(resp.Body, &amp;buf) \n\n  readsize := func(r io.Reader) int {\n    bytes := make([]byte, maxmem)\n    var size int\n      for {\n        read, err := r.Read(bytes)\n        if err == io.EOF {\n        break\n      }\n      size += read\n    }\n    return size\n  }\n\n  log.Printf(&quot;Size is %d&quot;, readsize(&amp;buf))\n</code></pre>\n<h1>Option 2 unscalable way (original answer)</h1>\n<p>You can just read the body, calculate the size, then unmarshal into struct, so that it becomes:</p>\n<pre><code>    b, _ := ioutil.ReadAll(r.Body)\n\n    size := len(b) // can be nil so check err in your app\n    \n    if err := json.Unmarshal(b, &amp;input); err != nil {\n        s.BadReq(w, errors.New(&quot;error reading body&quot;))\n        return\n    }\n\n</code></pre>\n"}], "owner": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4945, "favorite_count": 1, "accepted_answer_id": 53404405, "answer_count": 3, "score": 4, "last_activity_date": 1567657146, "creation_date": 1542753127, "question_id": 53402582, "link": "https://stackoverflow.com/questions/53402582/content-length-in-golang", "title": "Content Length in Golang", "body": "<p>I couldn't find anything helpful online on this one.</p>\n\n<p>I am writing an REST API, and I want to log the size of the body of the request in bytes for metrics. Go net/http API does not provide that directly. http.Request does have Content-Length field, but that field can be empty or the client might send false data.</p>\n\n<p>Is there a way to get that in the middlware level? The bruteforce method would be to read the full body and check the size. But if I do that in the middleware, the handler will not have access to the body because it would have been read and closed.</p>\n"}, {"tags": ["go", "dep"], "comments": [{"owner": {"reputation": 110, "user_id": 2022145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29e8c58f5659a6d8426a137130d7194?s=128&d=identicon&r=PG", "display_name": "mur762", "link": "https://stackoverflow.com/users/2022145/mur762"}, "edited": false, "score": 0, "creation_date": 1542757967, "post_id": 53401030, "comment_id": 93681856, "body": "Sounds similar to this <a href=\"https://github.com/golang/dep/issues/1747\" rel=\"nofollow noreferrer\">github.com/golang/dep/issues/1747</a> which is an open issue"}], "owner": {"reputation": 1095, "user_id": 2005484, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0214d084f407883353ec96b7f61275b6?s=128&d=identicon&r=PG", "display_name": "Shruti Basu", "link": "https://stackoverflow.com/users/2005484/shruti-basu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 458, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542745744, "creation_date": 1542745744, "question_id": 53401030, "link": "https://stackoverflow.com/questions/53401030/how-to-point-to-local-repo-instead-of-external-repository", "title": "How to point to local repo instead of external repository", "body": "<p>We are using dep ensure fo vendoring the dependencies for our project. Now in you system we can't access the external sites and that's the reason we mirrored the repo to our internal sites.\nThe issue I am facing now is, though the Gopkg.tml file I am specifying the mirror repo as a constraint, dep is always going to external site for downloading the dependencies.</p>\n\n<p>e.g. snippet from my Gopkg.tml file :</p>\n\n<pre><code>    required = [\n        \"github.com/dimiro1/banner\",\n        \"github.com/go-openapi/errors\",\n        \"go.uber.org/zap\"\n]\n[[constraint]]\n  branch = \"master\"\n  name = \"go.uber.org/zap\"\n  source = \"&lt;mirrored location in internal gitlab&gt;\"\n</code></pre>\n\n<p>The error I am hitting while \u2018dep ensure\u2019 is :</p>\n\n<blockquote>\n  <p>The following issues were found in Gopkg.toml:</p>\n  \n  <p>\u2717 unable to deduce repository and source type for \"go.uber.org/zap\":\n  unable to read metadata: unable to fetch raw metadata: failed HTTP\n  request to URL \"<a href=\"http://go.uber.org/zap?go-get=1\" rel=\"nofollow noreferrer\">http://go.uber.org/zap?go-get=1</a>\": Get\n  <a href=\"http://go.uber.org/zap?go-get=1\" rel=\"nofollow noreferrer\">http://go.uber.org/zap?go-get=1</a>: dial tcp 127.0.0.1:80: connect:\n  connection refused</p>\n  \n  <p>ProjectRoot name validation failed</p>\n</blockquote>\n\n<p>Any idea how to solve this issue.</p>\n\n<p>Thanks,\nShruti</p>\n"}, {"tags": ["file", "go", "io", "flush", "goroutine"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1542748541, "post_id": 53401020, "comment_id": 93678526, "body": "I&#39;m not sure where the exact solution lies between Go and the operating system,  but if you watch a graph of disk I/O when you run this, you&#39;ll notice (at least on my Mac with SSD) very little activity, but the graph will spike and the Go test will spit out a bunch of high latency write times. Somewhere along the pipeline from memory to disk, you need to reduce the write buffer size (which may be a bad idea depending on specific application). As to exactly where, I&#39;m not sure, but it&#39;s very possibly in the OS, or disk level. Graph spike: <a href=\"https://imgur.com/a/ATNGSKE\" rel=\"nofollow noreferrer\">imgur.com/a/ATNGSKE</a>"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1542749448, "post_id": 53401020, "comment_id": 93678956, "body": "ok two comments 1) the fact that you can&#39;t produce a MWE shows that it is probably the OS or other programs causing issues 2) if you launch a go routine to do the update what does it matter how long it takes?  nothing is blocked :)"}, {"owner": {"reputation": 1984, "user_id": 769933, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e9b1099e0ded5c6294717b50c899ccc?s=128&d=identicon&r=PG", "display_name": "gggg", "link": "https://stackoverflow.com/users/769933/gggg"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1542750344, "post_id": 53401020, "comment_id": 93679348, "body": "@Vorsprung, the way it&#39;s written now, I do wait on the file writing since the goroutines are mainly for parallelism of processing. If I cant figure out how to resolve the occasional slow <code>Write</code> then I&#39;ll re-write it to shuttle put all the data to be written on a channel and have a file writing routine."}, {"owner": {"reputation": 1984, "user_id": 769933, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e9b1099e0ded5c6294717b50c899ccc?s=128&d=identicon&r=PG", "display_name": "gggg", "link": "https://stackoverflow.com/users/769933/gggg"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1542751294, "post_id": 53401020, "comment_id": 93679790, "body": "@Vorsprung, the way it&#39;s written now, I do wait on the file writing since the goroutines primarily to avoid race conditions related to changing what data is written. I&#39;m thinking about how to restructure it to 1. not wait on write 2. avoid race conditions when write settings change 3. guarantee in order writing while still processing data every 50 ms."}], "owner": {"reputation": 1984, "user_id": 769933, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e9b1099e0ded5c6294717b50c899ccc?s=128&d=identicon&r=PG", "display_name": "gggg", "link": "https://stackoverflow.com/users/769933/gggg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542745679, "creation_date": 1542745679, "question_id": 53401020, "link": "https://stackoverflow.com/questions/53401020/occasional-long-500-ms-write-or-flush-times-in-golang", "title": "occasional long (500+ ms) Write or Flush times in golang", "body": "<p>I have project where we read data from some source, process it, then write some subset and possibly compressed version of that data to disk. We write in many (usually around 200) different files to correspond to different \"channels\" of the data, and often write a few MB/s to disc across these files.</p>\n\n<p>I'm seeing that approximately once every minute or so, a call to <code>Write</code> or to <code>Flush</code> takes a around 500 ms. I'd to reduce that number down to below 50 ms if possible. </p>\n\n<p>I tried to make a minimum working example (MWE) with this odd behvior, but I can't reproduce the long  <code>Write</code> and <code>Flush</code> calls on the machine that has that behavior with our full project. However, on my MacBook Pro laptop, I can cause 50 ms <code>Flush</code> calls which is still 100 times longer than typical. The attempted MWE is below, and it reproduces to way we're writing data nearly exactly. It has some flags at the top for flushing in different parts of the code, I was testing to see if calling <code>Flush</code> in certain locations helped. Any guidance on how to get consistent timings on the <code>Flush</code> and <code>Write</code> calls would be super helpful. Even if the average write time was slower, I just want consistent behavior. </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"os/signal\"\n    \"sync\"\n    \"time\"\n)\n\nconst flushWithinBlock = true\nconst flushAfterBlocks = true\n\ntype Writer struct {\n    FileName      string\n    headerWritten bool\n    writer        *bufio.Writer\n}\n\nfunc (w *Writer) writeHeader() error {\n    file, err := os.Create(w.FileName)\n    if err != nil {\n        return err\n    }\n    w.writer = bufio.NewWriterSize(file, 32768)\n    w.writer.WriteString(\"HEADER\\n\")\n    w.headerWritten = true\n    return nil\n}\n\nfunc (w *Writer) writeRecord(nBytes int) error {\n    data := make([]byte, nBytes)\n    nWritten, err := w.writer.Write(data)\n    if nWritten != nBytes {\n        return fmt.Errorf(\"wrong number of bytes written\")\n    }\n    return err\n}\n\nfunc main() {\n    dirname, err0 := ioutil.TempDir(\"\", \"\")\n    if err0 != nil {\n        panic(err0)\n    }\n    fmt.Println(dirname)\n    recordLength := 500\n    numberOfChannels := 240\n    recordsPerChanPerTick := 5\n    writers := make([]*Writer, numberOfChannels)\n    abortChan := make(chan struct{})\n    for i := range writers {\n        writers[i] = &amp;Writer{FileName: fmt.Sprintf(\"%v/%v.ljh\", dirname, i)}\n    }\n    go func() {\n        signalChan := make(chan os.Signal)\n        signal.Notify(signalChan, os.Interrupt)\n        &lt;-signalChan\n        close(abortChan)\n    }()\n\n    tickDuration := 50 * time.Millisecond\n    ticker := time.NewTicker(tickDuration)\n    z := 0\n    tLast := time.Now()\n    fmt.Printf(\"recordsPerChanPerTick %v, Chans %v, tickDuration %v\\n\", recordsPerChanPerTick, numberOfChannels, tickDuration)\n    fmt.Printf(\"records/second/chan %v, records/second total %v\\n\", float64(recordsPerChanPerTick)/tickDuration.Seconds(), float64(recordsPerChanPerTick*numberOfChannels)/tickDuration.Seconds())\n    fmt.Printf(\"megabytes/second total %v\\n\", float64(recordLength)*float64(recordsPerChanPerTick*numberOfChannels)/tickDuration.Seconds()*1e-6)\n    fmt.Printf(\"flushWithinBlock %v, flushAfterBlocks %v\\n\", flushWithinBlock, flushAfterBlocks)\n    for {\n        // 1. here we would get data from data source\n        z++\n        select {\n        case &lt;-abortChan:\n            fmt.Println(\"clean exit\")\n            return\n        case &lt;-ticker.C:\n            var wg sync.WaitGroup\n            writeDurations := make([]time.Duration, numberOfChannels)\n            flushDurations := make([]time.Duration, numberOfChannels)\n            for i, w := range writers {\n                wg.Add(1)\n                go func(w *Writer, i int) {\n                    tStart := time.Now()\n\n                    defer wg.Done()\n                    for j := 0; j &lt; recordsPerChanPerTick; j++ {\n                        if !w.headerWritten {\n                            err := w.writeHeader()\n                            if err != nil {\n                                panic(fmt.Sprintf(\"failed create file and write header: %v\\n\", err))\n                            }\n                        }\n                        w.writeRecord(recordLength)\n                    }\n                    tWrite := time.Now()\n                    if flushWithinBlock {\n                        w.writer.Flush()\n                    }\n                    writeDurations[i] = tWrite.Sub(tStart)\n                    flushDurations[i] = time.Now().Sub(tWrite)\n                }(w, i)\n            }\n            wg.Wait()\n            for _, w := range writers {\n                if flushAfterBlocks {\n                    w.writer.Flush()\n                }\n            }\n            var writeSum time.Duration\n            var flushSum time.Duration\n            var writeMax time.Duration\n            var flushMax time.Duration\n            for i := range writeDurations {\n                writeSum += writeDurations[i]\n                flushSum += flushDurations[i]\n                if writeDurations[i] &gt; writeMax {\n                    writeMax = writeDurations[i]\n                }\n                if flushDurations[i] &gt; flushMax {\n                    flushMax = flushDurations[i]\n                }\n            }\n            if z%100 == 0 || time.Now().Sub(tLast) &gt; 75*time.Millisecond {\n                fmt.Printf(\"z %v, time.Now().Sub(tLast) %v\\n\", z, time.Now().Sub(tLast))\n                fmt.Printf(\"writeMean %v, flushMean %v, writeMax %v, flushMax %v\\n\", writeSum/time.Duration(numberOfChannels), flushSum/time.Duration(numberOfChannels), writeMax, flushMax)\n            }\n            tLast = time.Now()\n        }\n    }\n\n}\n</code></pre>\n\n<p>Example output on a Ubuntu 16 machine with a spinning hard drive, this is the actual hardware that has 500 ms <code>Write</code> and <code>Flush</code> calls in our full project:</p>\n\n<pre><code>/tmp/296105809\nrecordsPerChanPerTick 5, Chans 240, tickDuration 50ms\nrecords/second/chan 100, records/second total 24000\nmegabytes/second total 12\nflushWithinBlock true, flushAfterBlocks true\nz 1, time.Now().Sub(tLast) 75.96973ms\nwriteMean 14.017745ms, flushMean 7.847\u00b5s, writeMax 24.761147ms, flushMax 420.896\u00b5s\nz 100, time.Now().Sub(tLast) 50.13856ms\nwriteMean 1.71\u00b5s, flushMean 4.213\u00b5s, writeMax 12.271\u00b5s, flushMax 32.133\u00b5s\nz 200, time.Now().Sub(tLast) 50.006063ms\nwriteMean 1.651\u00b5s, flushMean 3.032\u00b5s, writeMax 79.006\u00b5s, flushMax 7.246\u00b5s\nz 300, time.Now().Sub(tLast) 50.151421ms\nwriteMean 1.685\u00b5s, flushMean 4.542\u00b5s, writeMax 10.429\u00b5s, flushMax 14.087\u00b5s\nz 400, time.Now().Sub(tLast) 50.059208ms\n</code></pre>\n\n<p>Example output on a MacBook Pro with an SSD. You can see some much longer <code>Write</code> and <code>Flush</code> calls here, but nothing in the 500 ms range. Note the 30 ms <code>flushMax</code> on line 81 vs more typical 500 us <code>flushMax</code> on line 100.</p>\n\n<pre><code>/var/folders/_0/25kp6h7x25v6vyjv2yjlcnkm000wrm/T/934618054\nrecordsPerChanPerTick 5, Chans 240, tickDuration 50ms\nrecords/second/chan 100, records/second total 24000\nmegabytes/second total 12\nflushWithinBlock true, flushAfterBlocks true\nz 1, time.Now().Sub(tLast) 84.897446ms\nwriteMean 10.265068ms, flushMean 464.53\u00b5s, writeMax 24.752873ms, flushMax 3.528286ms\n... some output removed\n... NOTE, line 81 was printed because it took longer than normal\nz 81, time.Now().Sub(tLast) 75.804358ms\nwriteMean 15.056\u00b5s, flushMean 18.324892ms, writeMax 408.406\u00b5s, flushMax 30.765425ms\nz 100, time.Now().Sub(tLast) 54.753448ms\nwriteMean 3.25\u00b5s, flushMean 84.963\u00b5s, writeMax 74.152\u00b5s, flushMax 499.322\u00b5s\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1553, "user_id": 9818506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcca0f9bb243465345ff084448c35e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Rene Knop", "link": "https://stackoverflow.com/users/9818506/rene-knop"}, "edited": false, "score": 1, "creation_date": 1542743563, "post_id": 53400188, "comment_id": 93676222, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2893004/how-to-allocate-an-array-of-channels\">How to allocate an array of channels</a>"}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 2, "last_activity_date": 1542742228, "creation_date": 1542742228, "answer_id": 53400237, "question_id": 53400188, "link": "https://stackoverflow.com/questions/53400188/how-to-pass-array-of-channels/53400237#53400237", "title": "How to pass array of channels", "body": "<p>The proper type to pass a slice of channels of Book elements is:</p>\n\n<pre><code>[]chan&lt;- Book\n</code></pre>\n\n<p>The code in your original question is for a channel of Book slices.</p>\n"}, {"tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": false, "score": 1, "last_activity_date": 1542743640, "creation_date": 1542743640, "answer_id": 53400583, "question_id": 53400188, "link": "https://stackoverflow.com/questions/53400188/how-to-pass-array-of-channels/53400583#53400583", "title": "How to pass array of channels", "body": "<p><code>chan&lt;- []Book</code> needs to become <code>[]chan&lt;- Book</code>.  <code>[]</code> modifies the type after it in go, so if you want an array of channels, put it before <code>chan</code>.</p>\n\n<pre><code>func Data(channel []chan&lt;- Book) {\n    var data EData\n    data = ReadJSONFile(\"Data.json\")\n\n    go Writer(data.BookStores[0].Central, channel[0])\n    // ...\n}\n</code></pre>\n\n<p>Test: <a href=\"https://play.golang.org/p/sQt3VawvhoI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/sQt3VawvhoI</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10682115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf87573983ee7fde4e2096066d98b9a?s=128&d=identicon&r=PG&f=1", "display_name": "vincente", "link": "https://stackoverflow.com/users/10682115/vincente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1542783692, "creation_date": 1542742042, "last_edit_date": 1542783692, "question_id": 53400188, "link": "https://stackoverflow.com/questions/53400188/how-to-pass-array-of-channels", "title": "How to pass array of channels", "body": "<p>I am trying to pass a array of channels to the method \"     func Data(channel chan&lt;- []Book)\" , however I encouter an error which states ( channel[0] (type chan&lt;- []Book does not support indexing)\") I understand what it means, but isn't there a way to pass an the array ? If so what alternatives do I have</p>\n\n<pre><code>     func Data(channel chan&lt;- []Book) {\n            var data EData\n            data = ReadJSONFile(\"Data.json\")\n\n            go Writer(data.BookStores[0].Central, channel[0]) // at this \n          // place I get \"invalid operation:  channel[0] (type chan&lt;- []Book \n          // does not support indexing)\"\n        }\n</code></pre>\n"}, {"tags": ["pointers", "go"], "answers": [{"tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": false, "score": 2, "last_activity_date": 1542742805, "last_edit_date": 1542742805, "creation_date": 1542742314, "answer_id": 53400263, "question_id": 53400113, "link": "https://stackoverflow.com/questions/53400113/invalid-memory-address-in-golang/53400263#53400263", "title": "invalid memory address in Golang", "body": "<p>Your code does essentially this:</p>\n\n<pre><code>var org *github.Organization\norg.Login = plocalName\n</code></pre>\n\n<p><code>org</code> is a nil pointer, it doesn't point to a value, so <code>org.Login</code> tries to de-reference a nil pointer - hence the error.  So don't declare <code>org</code> as a pointer type.</p>\n\n<p>You also have a lot of unnecessary code dealing with pointers, e.g. </p>\n\n<pre><code>plocalID := &amp;localID\n..\nif plocalID != nil {\n    o.ID = plocalID\n    org.ID = plocalID\n}\n</code></pre>\n\n<p>On that first line you created <code>plocalID</code> and initialized it with <code>&amp;localID</code>. There is no way <code>plocalID</code> can then be a nil pointer, so it doesn't make sense to have the <code>if plocalID != nil {</code> check. You can just get rid of the <code>plocalID</code> and write your code as</p>\n\n<pre><code>o.ID = &amp;localID\norg.ID = &amp;localID\n</code></pre>\n"}], "owner": {"reputation": 770, "user_id": 605023, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8bb7fc811fe6617282d2d47b2ec2e39c?s=128&d=identicon&r=PG", "display_name": "Matty", "link": "https://stackoverflow.com/users/605023/matty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1542742805, "creation_date": 1542741758, "question_id": 53400113, "link": "https://stackoverflow.com/questions/53400113/invalid-memory-address-in-golang", "title": "invalid memory address in Golang", "body": "<p>I have checked several other answers and they gave me some good thoughts on how to troubleshoot this but I still can't figure it out.</p>\n\n<pre><code>    localID := generateGenericID(\"local\") // type int64\n    localName := \"local\" // type string\n\n    // set them to pointers as I need them as type *int64 and *string\n    plocalID := &amp;localID\n    plocalName := &amp;localName\n\n    // create a pointer to a new github org\n    var org *github.Organization\n\n    // create a new general purpose org\n    o := Org{}\n\n    // Check for nil, per several other answers\n    if plocalName != nil {\n        o.Name = plocalName\n        org.Login = plocalName // ERROR\n    }\n\n    if plocalID != nil {\n        o.ID = plocalID\n        org.ID = plocalID\n    }\n\n   fmt.Println(*plocalName) // prints local\n\n\n    hunt.addOrganization(org) // takes a pointer to a github org\n    report.addReportOrganization(&amp;o) // take a pointer to an org\n</code></pre>\n\n<p>The error message I am getting is:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer \n</code></pre>\n\n<p>It points to the line marked <code>ERROR</code>. The error makes no sense due to me checking for nil, so I am wondering if maybe I am some kind of pointer hell due to creating a variable that is a pointer and then assigning pointers to it.</p>\n\n<p>Should I simply create the github org as a normal struct and then pass in <code>&amp;org</code> to the hunt function. I tried that and got past the error but a ton of other code pukes so before I start to chase this down I figured I would ask if that even makes sense of if I am looking in the wrong spot. RTFM with links is always welcome.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1542731901, "post_id": 53397369, "comment_id": 93670273, "body": "convert the ip + CIDR mask to 5 bytes and store them in a uint, then use the resultant number as a map key.   If you want to find which range a particular ip falls in then that would be slightly more complicated"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1542732262, "post_id": 53397369, "comment_id": 93670473, "body": "What is a &quot;very large list&quot;? Are you using a binary search? Are you certain the code is slow because of iterating over the list, or because you&#39;re converting every string to an ip&amp;mask for every comparison?"}, {"owner": {"reputation": 1, "user_id": 8576380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8LtgU.jpg?s=128&g=1", "display_name": "Rapid Code Lab", "link": "https://stackoverflow.com/users/8576380/rapid-code-lab"}, "edited": false, "score": 0, "creation_date": 1542732639, "post_id": 53397369, "comment_id": 93670709, "body": "at this moment in list 200k records, updated first post with code"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1542733095, "post_id": 53397369, "comment_id": 93670987, "body": "You&#39;re parsing every string for every comparison. Wouldn&#39;t it make sense to parse those ahead of time first and see if that is performant enough? (It also might help to show where the bottleneck is from some real benchmarks)"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1542733325, "post_id": 53397369, "comment_id": 93671124, "body": "I think a <a href=\"https://en.m.wikipedia.org/wiki/Trie\" rel=\"nofollow noreferrer\">trie</a> would be a good data structure to use here, since you&#39;re essentially doing a prefix search.  I don&#39;t have a ready-made package to recommend, although <a href=\"https://github.com/derekparker/trie\" rel=\"nofollow noreferrer\">github.com/derekparker/trie</a> looks decent."}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": -1, "last_activity_date": 1542732761, "creation_date": 1542732761, "answer_id": 53397816, "question_id": 53397369, "link": "https://stackoverflow.com/questions/53397369/fastest-way-search-ip-in-large-ip-subnet-list-on-golang/53397816#53397816", "title": "fastest way search ip in large ip/subnet list on golang?", "body": "<p>We solved this problem in our project:</p>\n\n<pre><code>isIPV4inCIDRList(\"35.132.199.128\", []string{\"35.132.199.128/27\"})\n\nfunc isIPV4inCIDRList(ip []byte, list []string) bool {\n    for i := 0; i &lt; 32; i++ {\n        sm := strconv.Itoa(i)\n        m, _ := mask(sm, 4)\n        inv := andIP(ip, []byte(m))\n        if len(inv) == 0 {\n            continue\n        }\n\n        for _, cidr := range list {\n            if cidr == inv.String() + \"/\" + sm {\n                return true\n            }\n        }\n    }\n\n    return false\n}\n\nfunc andIP(ip, mask []byte) net.IP {\n    inv := net.IP{}\n    for i, v := range ip {\n        inv = append(inv, mask[i]&amp;v)\n    }\n    return inv\n}\n\n// Bigger than we need, not too big to worry about overflow\nconst big = 0xFFFFFF\n\n// Decimal to integer.\n// Returns number, characters consumed, success.\nfunc dtoi(s string) (n int, i int, ok bool) {\n    n = 0\n    for i = 0; i &lt; len(s) &amp;&amp; '0' &lt;= s[i] &amp;&amp; s[i] &lt;= '9'; i++ {\n        n = n*10 + int(s[i]-'0')\n        if n &gt;= big {\n            return big, i, false\n        }\n    }\n    if i == 0 {\n        return 0, 0, false\n    }\n    return n, i, true\n}\n\nfunc mask(m string, iplen int) (net.IPMask, error) {\n    n, i, ok := dtoi(m)\n    if !ok || i != len(m) || n &lt; 0 || n &gt; 8*iplen {\n        return nil, &amp;net.ParseError{Type: \"CIDR address\"}\n    }\n    return net.CIDRMask(n, 8*iplen), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8576380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8LtgU.jpg?s=128&g=1", "display_name": "Rapid Code Lab", "link": "https://stackoverflow.com/users/8576380/rapid-code-lab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1542732863, "creation_date": 1542731288, "last_edit_date": 1542732863, "question_id": 53397369, "link": "https://stackoverflow.com/questions/53397369/fastest-way-search-ip-in-large-ip-subnet-list-on-golang", "title": "fastest way search ip in large ip/subnet list on golang?", "body": "<p>please help me solve next task in fastest possible way</p>\n\n<p>i have a large list of ip/subnets like ...</p>\n\n<pre><code>35.132.199.128/27\n8.44.144.248/32\n87.117.185.193\n45.23.45.45\n</code></pre>\n\n<p>etc\nand i'll need to find some ip in that list fastes as possible in go.</p>\n\n<p>when i try use slice of strings and range, it was very slow on large list. </p>\n\n<p>may i use map, like map[string]string, and its look usable but only for ip checking, not for subnet checking. </p>\n\n<p>anyone can help me with solving this task? thanks. </p>\n\n<p>my code</p>\n\n<pre><code>func (app *application) validateIP(ip string) bool {\n\nfor _, item := range app.IPList {\n\n    itemIsIP := net.ParseIP(item)\n\n    if itemIsIP != nil {\n        if ip == itemIsIP.String() {\n            return true\n        }\n        continue\n    }\n\n    _, itemNet, err := net.ParseCIDR(item)\n    if err != nil {\n        log.Printf(\"[ERROR] %+v\", err)\n    }\n\n    checkedIP := net.ParseIP(ip)\n\n    if itemNet.Contains(checkedIP) {\n        return true\n    }\n}\nreturn false\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["go", "dependency-injection", "go-cdk"], "answers": [{"tags": [], "owner": {"reputation": 3575, "user_id": 111866, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e742e21c1b64a037eaa90aea1fdf7874?s=128&d=identicon&r=PG", "display_name": "Ross Light", "link": "https://stackoverflow.com/users/111866/ross-light"}, "is_accepted": false, "score": 3, "last_activity_date": 1547593103, "creation_date": 1547593103, "answer_id": 54208057, "question_id": 53397176, "link": "https://stackoverflow.com/questions/53397176/golang-go-cloud-wire-problem-with-array-as-a-parameter-of-provider/54208057#54208057", "title": "GoLang go-cloud/wire problem with array as a parameter of Provider", "body": "<p>It's hard to see the whole picture of your application from just this small fragment, but it might be better to take in the dependencies of the routers that you're constructing into <code>RouterProvider</code> and just construct them in the function.</p>\n\n<p>However, if you evaulate that and find that to be unsuitable, you still have some options. If you're only worried about the argument list to <code>RouterProvider</code> getting long, then you could use a struct provider:</p>\n\n<pre><code>type routers struct {\n  Info *routers.PhpInfo\n  Root *routers.Root\n  User *routers.User\n}\n\nfunc RouterProvider(r routers) web.AppRouter {\n  return routers.NewRouter([]RouterPath{\n    r.Info,\n    r.Root,\n    r.User,\n  })\n}\n</code></pre>\n\n<p>If this gets really unwieldy, you could use reflection to zip up the fields into a slice:</p>\n\n<pre><code>type routers struct {\n  Info *routers.PhpInfo\n  Root *routers.Root\n  User *routers.User\n}\n\nfunc RouterProvider(r routers) web.AppRouter {\n  value := reflect.ValueOf(r)\n  var paths []RouterPath\n  for i := 0; i &lt; value.NumField(); i++ {\n    if p, ok := value.Field(i).Interface().(RouterPath); ok {\n      paths = append(paths, p)\n    }\n  }\n  return routers.NewRouter(paths)\n}\n</code></pre>\n\n<p>I'd really recommend the first approach though, because it's much more clear to someone reading your code what's going on. Reflection always moves breakages to run-time instead of compile-time.</p>\n"}], "owner": {"reputation": 31, "user_id": 10242935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a0458d6e18388446e496acd18c45d2?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas \u0160enfeld", "link": "https://stackoverflow.com/users/10242935/lukas-%c5%a0enfeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1550251290, "creation_date": 1542730595, "last_edit_date": 1550251290, "question_id": 53397176, "link": "https://stackoverflow.com/questions/53397176/golang-go-cloud-wire-problem-with-array-as-a-parameter-of-provider", "title": "GoLang go-cloud/wire problem with array as a parameter of Provider", "body": "<p>I am having little trouble with correct configuration of wire I have following setup</p>\n\n<p>Router </p>\n\n<pre><code>func NewRouter(routes []RouterPath) AppRouter {\n    r := &amp;appRouter{\n        routes: routes,\n    }\n    return r\n}\n</code></pre>\n\n<p>Router interface</p>\n\n<pre><code>type RouterPath interface {\n    Register(root *mux.Router) (p *mux.Router)\n}\n</code></pre>\n\n<p>and i do have few controllers that implement this interface\ncurrently the best way how i find out how to make wire to solve DI was this</p>\n\n<pre><code>var routersSet = wire.NewSet(\n    routers.NewAuth,\n    routers.NewRoot,\n    routers.NewUser,\n    routers.NewPhpInfo,\n)\n\nfunc RouterProvider(info *routers.PhpInfo, root *routers.Root, user *routers.User) web.AppRouter {\n    routes := []web.RouterPath{\n        info,\n        root,\n        user,\n    }\n    return routers.NewRouter(routes)\n}\n\nfunc Init() Kernel {\n\n    wire.Build(\n        routersSet,\n        RouterProvider,\n        NewKernel,\n    )\n\n    return nil\n}\n</code></pre>\n\n<p>what i have problem with is that i had to make transition layer to NewRouter because it expects array of routes. Which will grow very easily and method definition will be horible to maintain. I would love to see smtg like put wire.ProviderSet into array and use that as a parameter of NewRouter but i could not figure how to do this.</p>\n\n<p>Is there any better approach instead of this ?</p>\n"}, {"tags": ["json", "parsing", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542730106, "post_id": 53396957, "comment_id": 93669374, "body": "Use <code>[]</code> for slice types. E.g. <code>all_data[&quot;results&quot;].([]map[string]interface{})</code>."}, {"owner": {"reputation": 1258, "user_id": 6494282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WtoNR.jpg?s=128&g=1", "display_name": "pcampana", "link": "https://stackoverflow.com/users/6494282/pcampana"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542730745, "post_id": 53396957, "comment_id": 93669688, "body": "So how it should be in this case? I&#39;m trying <code>data_results := all_data[&quot;results&quot;].([]map[string]interface{})</code> but I get the error when I try to do a Println: <code>panic: interface conversion: interface {} is []interface {}, not []map[string]interface {}</code>"}, {"owner": {"reputation": 1258, "user_id": 6494282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WtoNR.jpg?s=128&g=1", "display_name": "pcampana", "link": "https://stackoverflow.com/users/6494282/pcampana"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542731651, "post_id": 53396957, "comment_id": 93670143, "body": "I have found a solution with Struct, but I would like to see how how it could be solved with interfaces."}], "answers": [{"tags": [], "owner": {"reputation": 1258, "user_id": 6494282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WtoNR.jpg?s=128&g=1", "display_name": "pcampana", "link": "https://stackoverflow.com/users/6494282/pcampana"}, "is_accepted": true, "score": -2, "last_activity_date": 1542731573, "creation_date": 1542731573, "answer_id": 53397464, "question_id": 53396957, "link": "https://stackoverflow.com/questions/53396957/can-get-value-of-json-in-go/53397464#53397464", "title": "Can get value of JSON in Go", "body": "<p>I have solved defining an Struct. </p>\n\n<pre><code>package main\n\nimport (\n\"encoding/json\"\n\"fmt\"\n\"io/ioutil\"\n\"os\"\n)\n\n\ntype AutoGenerated struct {\n    Results []struct {\n        StatementID int `json:\"statement_id\"`\n        Series      []struct {\n            Name    string   `json:\"name\"`\n            Columns []string `json:\"columns\"`\n            Values  [][]int  `json:\"values\"`\n        } `json:\"series\"`\n    } `json:\"results\"`\n}\n\nfunc main() {\n    // Open our jsonFile\njsonFile, err := os.Open(\"example.json\")\n// if we os.Open returns an error then handle it\nif err != nil {\n    fmt.Println(err)\n}\nfmt.Println(\"Successfully Opened example.json\")\n// defer the closing of our jsonFile so that we can parse it later on\ndefer jsonFile.Close()\n\n\nbyteValue, _ := ioutil.ReadAll(jsonFile)\nall_data := AutoGenerated{}\njson.Unmarshal([]byte(byteValue), &amp;all_data)\nfmt.Println(all_data.Results[0].Series[0].Values)\n}\n</code></pre>\n\n<p>I have used this <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">web</a> to generate automatically the Struct providing the JSON structure</p>\n"}, {"tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": false, "score": 0, "last_activity_date": 1542732483, "creation_date": 1542732483, "answer_id": 53397734, "question_id": 53396957, "link": "https://stackoverflow.com/questions/53396957/can-get-value-of-json-in-go/53397734#53397734", "title": "Can get value of JSON in Go", "body": "<p>Using interfaces and map</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    byteValue := []byte(`{\"results\":[{\"statement_id\":0,\"series\":[{\"name\":\"cpu/node_utilization\",\"columns\":[\"time\",\"distinct\"],\"values\":[[10,1],[11,3],[13,5]]}]}]}`)\n\n    var all_data map[string][]interface{}\n    json.Unmarshal([]byte(byteValue), &amp;all_data)\n    fmt.Println(\"result:\", all_data[\"results\"])\n\n    for _, r := range all_data[\"results\"] {\n        s := r.(map[string]interface{})\n        fmt.Println(\"series:\", s[\"series\"])\n\n        w := s[\"series\"].([]interface{})\n        for _, x := range w {\n            y := x.(map[string]interface{})\n            fmt.Println(y)\n\n            z := y[\"values\"].([]interface{})\n            fmt.Println(\"values:\", z)\n            for _, v := range z {\n                u := v.([]interface{})\n                fmt.Println(u)\n                for _, i := range u {\n                    val := i.(float64)\n                    fmt.Println(val)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1258, "user_id": 6494282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WtoNR.jpg?s=128&g=1", "display_name": "pcampana", "link": "https://stackoverflow.com/users/6494282/pcampana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 53397464, "answer_count": 2, "score": -1, "last_activity_date": 1542732483, "creation_date": 1542729822, "last_edit_date": 1542729894, "question_id": 53396957, "link": "https://stackoverflow.com/questions/53396957/can-get-value-of-json-in-go", "title": "Can get value of JSON in Go", "body": "<p>I'm new in Go. I'm trying to read a JSON file and get a part of it for then operate with the values obtained. \nMy JSON is in the file example.json: </p>\n\n<pre><code>{\"results\":[{\"statement_id\":0,\"series\":[{\"name\":\"cpu/node_utilization\",\"columns\":[\"time\",\"distinct\"],\"values\":[[10,1],[11,3],[13,5]]}]}]}\n</code></pre>\n\n<p>So what I would like to get is the \"values\" for get the sum of all the elements. In this case: 1+3+5</p>\n\n<p>Here is the code that I have. I'm available to get the results, but then I don't manage to get series.</p>\n\n<p>Here is the code that I have:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\nfunc main() {\n    // Open our jsonFile\n    jsonFile, err := os.Open(\"example.json\")\n    // if we os.Open returns an error then handle it\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(\"Successfully Opened example.json\")\n    // defer the closing of our jsonFile so that we can parse it later on\n    defer jsonFile.Close()\n\n    byteValue, _ := ioutil.ReadAll(jsonFile)\n    var all_data map[string]interface{}\n    json.Unmarshal([]byte(byteValue), &amp;all_data)\n    fmt.Println(all_data[\"results\"])\n}\n</code></pre>\n\n<p>I've tried diferent solutions like \n    <code>all_data[\"results\"].(map[string]interface{})[\"series\"])</code>\nBut the problem is that the map is in an array, and I don't know how to solve it.</p>\n"}, {"tags": ["node.js", "go"], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 1, "last_activity_date": 1542738132, "creation_date": 1542738132, "answer_id": 53399213, "question_id": 53396055, "link": "https://stackoverflow.com/questions/53396055/cant-open-file-when-calling-golang-function-via-node/53399213#53399213", "title": "Can&#39;t open file when calling golang function via Node", "body": "<p>Remember that strings in Go are like slices. They are composed of a pointer to the backing data and the length. This is why in your code, <code>GoString</code> is defined as:</p>\n\n<pre><code>var GoString = Struct({\n    p: \"string\",  // pointer\n    n: \"longlong\" // length\n});\n</code></pre>\n\n<p>I'd recommend you define a function for creating a <code>GoString</code> e.g.</p>\n\n<pre><code>function NewGoString(str) {\n    return new GoString({p: str, n: str.length})\n}\n</code></pre>\n\n<p>Which you can use in your code like:</p>\n\n<pre><code>var simpleRead = ffi.Library(\"./simpleread.so\", {\n    ReadSomething: [\"void\", [GoString]]\n});\n\nsimpleRead.ReadSomething(NewGoString(\"/path/to/your/file\"))\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 4004555, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b23fd6df63606b373566d20709937405?s=128&d=identicon&r=PG&f=1", "display_name": "imeluntuk", "link": "https://stackoverflow.com/users/4004555/imeluntuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 53399213, "answer_count": 1, "score": 1, "last_activity_date": 1542738132, "creation_date": 1542726897, "last_edit_date": 1542727224, "question_id": 53396055, "link": "https://stackoverflow.com/questions/53396055/cant-open-file-when-calling-golang-function-via-node", "title": "Can&#39;t open file when calling golang function via Node", "body": "<p>I followed the tutorial in <a href=\"https://medium.com/learning-the-go-programming-language/calling-go-functions-from-other-languages-4c7d8bcc69bf\" rel=\"nofollow noreferrer\">https://medium.com/learning-the-go-programming-language/calling-go-functions-from-other-languages-4c7d8bcc69bf</a> to make my node app able to call golang function. The provided example works like a charm.<br>\nI do, however, unable it to implement in another scenario. Here I want to open a file by providing only it's absolute path and call the Go's function, but it always told me that it can't find the file due to no such file. I'm trying to run it directly in Go and it works!<br> \nAm I doing it wrong or is it an actual bug/unfinished feature?<br></p>\n\n<p>Here is the golang source that I've built to c-style lib :</p>\n\n<pre><code>package main\n\nimport \"C\"\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {}\n\n//export ReadSomething\nfunc ReadSomething(filePath string) {\n    file, err := os.Open(filePath)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer file.Close()\n\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n        fmt.Println(scanner.Text())\n    }\n\n    if err := scanner.Err(); err != nil {\n        log.Fatal(err)\n    }\n\n}\n</code></pre>\n\n<p>I built it with this command :</p>\n\n<pre><code>go build -buildmode=c-shared -o simpleread.so main.go\n</code></pre>\n\n<p>In case you're wondering what's the header output :</p>\n\n<pre><code>/* Created by \"go tool cgo\" - DO NOT EDIT. */\n\n/* package command-line-arguments */\n\n#line 1 \"cgo-builtin-prolog\"\n\n#include &lt;stddef.h&gt; /* for ptrdiff_t below */\n\n#ifndef GO_CGO_EXPORT_PROLOGUE_H\n#define GO_CGO_EXPORT_PROLOGUE_H\n\ntypedef struct { const char *p; ptrdiff_t n; } _GoString_;\n\n#endif\n\n/* Start of preamble from import \"C\" comments.  */\n/* End of preamble from import \"C\" comments.  */\n\n\n/* Start of boilerplate cgo prologue.  */\n#line 1 \"cgo-gcc-export-header-prolog\"\n\n#ifndef GO_CGO_PROLOGUE_H\n#define GO_CGO_PROLOGUE_H\n\ntypedef signed char GoInt8;\ntypedef unsigned char GoUint8;\ntypedef short GoInt16;\ntypedef unsigned short GoUint16;\ntypedef int GoInt32;\ntypedef unsigned int GoUint32;\ntypedef long long GoInt64;\ntypedef unsigned long long GoUint64;\ntypedef GoInt64 GoInt;\ntypedef GoUint64 GoUint;\ntypedef __SIZE_TYPE__ GoUintptr;\ntypedef float GoFloat32;\ntypedef double GoFloat64;\ntypedef float _Complex GoComplex64;\ntypedef double _Complex GoComplex128;\n\n/*\n  static assertion to make sure the file is being used on architecture\n  at least with matching size of GoInt.\n*/\ntypedef char _check_for_64_bit_pointer_matching_GoInt[sizeof(void*)==64/8 ? 1:-1];\n\ntypedef _GoString_ GoString;\ntypedef void *GoMap;\ntypedef void *GoChan;\ntypedef struct { void *t; void *v; } GoInterface;\ntypedef struct { void *data; GoInt len; GoInt cap; } GoSlice;\n\n#endif\n\n/* End of boilerplate cgo prologue.  */\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n\nextern void ReadSomething(GoString p0);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>And then, below is how I call it via Node. I give the comment on the line where the error generated :</p>\n\n<pre><code>var ref = require(\"ref\")\nvar ffi = require(\"ffi-napi\")\nvar Struct = require(\"ref-struct\")\nvar ArrayType = require(\"ref-array\")\nvar LongArray = ArrayType(ref.types.longlong);\n\n  var GoString = Struct({\n    p: \"string\",\n    n: \"longlong\"\n  });\n\n  var simpleRead = ffi.Library(\"./simpleread.so\", {\n    ReadSomething: [\"void\", [GoString]]\n  });\n\n  // error here, can't open the specified file\n  simpleRead.ReadSomething(\"/home/ivan/Documents/crashsite/node-go-crossfire/simpletext.txt\")\n</code></pre>\n\n<p>I'm running it on Ubuntu 18.04 64bit.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 0, "creation_date": 1542726537, "post_id": 53395772, "comment_id": 93667159, "body": "Is your JSON data format always looks the same or does it change dynamically (number of fields and field name?)"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 0, "creation_date": 1542727179, "post_id": 53395772, "comment_id": 93667552, "body": "@Ehsan.Saradar : Fields name and number of fields will change yes.."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 0, "creation_date": 1542728237, "post_id": 53395772, "comment_id": 93668208, "body": "I do not understand the downvotes.."}, {"owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 0, "creation_date": 1542734040, "post_id": 53395772, "comment_id": 93671494, "body": "At what point you have problem. What you did, what is the error. You didn&#39;t specify any of these"}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1542728944, "post_id": 53396333, "comment_id": 93668659, "body": "Thanks a lot, I missed it"}], "tags": [], "owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "is_accepted": true, "score": 1, "last_activity_date": 1542727798, "creation_date": 1542727798, "answer_id": 53396333, "question_id": 53395772, "link": "https://stackoverflow.com/questions/53395772/infinite-struct-with-json-and-golang/53396333#53396333", "title": "Infinite struct with JSON and Golang", "body": "<p>You need to unmarshal your data into map[string]map[string]string as the following:</p>\n\n<pre><code>jsonData:=\"{\\\"key1\\\":{\\\"col1\\\":\\\"Data11\\\",\\\"col2\\\":\\\"Data12\\\",\\\"col3\\\":\\\"Data13\\\",\\\"col4\\\":\\\"Data14\\\"}, \\\"key2\\\":{\\\"col1\\\":\\\"Data21\\\",\\\"col2\\\":\\\"Data22\\\",\\\"col3\\\":\\\"Data23\\\",\\\"col4\\\":\\\"Data24\\\"}, \\\"key3\\\":{\\\"col1\\\":\\\"Data31\\\",\\\"col2\\\":\\\"Data32\\\",\\\"col3\\\":\\\"Data33\\\",\\\"col4\\\":\\\"Data34\\\"}, \\\"key4\\\":{\\\"col1\\\":\\\"Data41\\\",\\\"col2\\\":\\\"Data42\\\",\\\"col3\\\":\\\"Data43\\\",\\\"col4\\\":\\\"Data44\\\"}, \\\"key5\\\":{\\\"col1\\\":\\\"Data51\\\",\\\"col2\\\":\\\"Data52\\\",\\\"col3\\\":\\\"Data53\\\",\\\"col4\\\":\\\"Data54\\\"}, \\\"key6\\\":{\\\"col1\\\":\\\"Data61\\\",\\\"col2\\\":\\\"Data62\\\",\\\"col3\\\":\\\"Data63\\\",\\\"col4\\\":\\\"Data64\\\"}}\"\n    var jsonObject map[string]map[string]string\n    json.Unmarshal([]byte(jsonData),&amp;jsonObject)\n    for k:=range jsonObject{\n        fmt.Println(k ,\" has \" , len(jsonObject[k]) , \" fields\")\n        for j:=range jsonObject[k]{\n            fmt.Println(j , \"=\",jsonObject[k][j] )\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 53396333, "answer_count": 1, "score": -3, "last_activity_date": 1554292795, "creation_date": 1542725968, "last_edit_date": 1554292795, "question_id": 53395772, "link": "https://stackoverflow.com/questions/53395772/infinite-struct-with-json-and-golang", "title": "Infinite struct with JSON and Golang", "body": "<p>I do not know how to unmarshal this kind of JSON structure with Golang. The key is dynamic, the nested keys and values are also dynamic..</p>\n\n<pre><code>{\"key1\":{\"col1\":\"Data11\",\"col2\":\"Data12\",\"col3\":\"Data13\",\"col4\":\"Data14\"},\n \"key2\":{\"col1\":\"Data21\",\"col2\":\"Data22\",\"col3\":\"Data23\",\"col4\":\"Data24\"},\n \"key3\":{\"col1\":\"Data31\",\"col2\":\"Data32\",\"col3\":\"Data33\",\"col4\":\"Data34\"},\n \"key4\":{\"col1\":\"Data41\",\"col2\":\"Data42\",\"col3\":\"Data43\",\"col4\":\"Data44\"},\n \"key5\":{\"col1\":\"Data51\",\"col2\":\"Data52\",\"col3\":\"Data53\",\"col4\":\"Data54\"},\n \"key6\":{\"col1\":\"Data61\",\"col2\":\"Data62\",\"col3\":\"Data63\",\"col4\":\"Data64\"}}\n</code></pre>\n\n<p>I am stuck.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1542725378, "post_id": 53395380, "comment_id": 93666517, "body": "Plain slices don&#39;t support such functionality. Take a look at <a href=\"https://golang.org/pkg/container/ring/\" rel=\"nofollow noreferrer\">golang.org/pkg/container/ring</a>, maybe it&#39;s what you need."}, {"owner": {"reputation": 138, "user_id": 7183892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7831b84d96fa6df2214a2055f5201f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Santos", "link": "https://stackoverflow.com/users/7183892/marco-santos"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542725544, "post_id": 53395380, "comment_id": 93666604, "body": "I will take a look on that"}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 7183892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7831b84d96fa6df2214a2055f5201f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Santos", "link": "https://stackoverflow.com/users/7183892/marco-santos"}, "edited": false, "score": 0, "creation_date": 1542729740, "post_id": 53395688, "comment_id": 93669165, "body": "This does not work as expected. size var is incrementing no mater the rcvData.Topic which is dynamic"}], "tags": [], "owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1542731965, "last_edit_date": 1542731965, "creation_date": 1542725688, "answer_id": 53395688, "question_id": 53395380, "link": "https://stackoverflow.com/questions/53395380/initialize-map-issues/53395688#53395688", "title": "Initialize map issues", "body": "<p>Use like this:</p>\n\n<pre><code>for {\n    select {\n    case rcvData := &lt;-ch:\n\n        _, exists := mapDataPayload[rcvData.Topic]\n        if !exists {\n            mapDataPayload[rcvData.Topic] = []*dataPayload{}\n        }\n        if len(mapDataPayload[rcvData.Topic]) &lt; 100 {\n            mapDataPayload[rcvData.Topic] = append(\n                mapDataPayload[rcvData.Topic],\n                &amp;dataPayload{Message: rcvData.Message},\n            )\n        } else {\n            mapDataPayload[rcvData.Topic][len(mapDataPayload[rcvData.Topic]) % 100] = &amp;dataPayload{Message: rcvData.Message}\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 138, "user_id": 7183892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7831b84d96fa6df2214a2055f5201f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Santos", "link": "https://stackoverflow.com/users/7183892/marco-santos"}, "edited": false, "score": 0, "creation_date": 1542727573, "post_id": 53395900, "comment_id": 93667819, "body": "I believe that this is what I am looking for, I will try to implement it and check if it is working as intended."}, {"owner": {"reputation": 138, "user_id": 7183892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7831b84d96fa6df2214a2055f5201f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Santos", "link": "https://stackoverflow.com/users/7183892/marco-santos"}, "edited": false, "score": 0, "creation_date": 1542728284, "post_id": 53395900, "comment_id": 93668237, "body": "It worked however I am only able to store integer values on mapDataPayload[&quot;aaa&quot;].Add(i) and I receive []byte which could be any type, could be an integer, string, ..."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 138, "user_id": 7183892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7831b84d96fa6df2214a2055f5201f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Santos", "link": "https://stackoverflow.com/users/7183892/marco-santos"}, "edited": false, "score": 0, "creation_date": 1542728723, "post_id": 53395900, "comment_id": 93668520, "body": "oh ok, you need to replace the <code>Contents []int</code> with <code>Contents []interface{}</code>  I&#39;ve updated the answer"}, {"owner": {"reputation": 138, "user_id": 7183892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7831b84d96fa6df2214a2055f5201f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Santos", "link": "https://stackoverflow.com/users/7183892/marco-santos"}, "edited": false, "score": 0, "creation_date": 1542729163, "post_id": 53395900, "comment_id": 93668802, "body": "For some reason the first position starts 0 (undefined), but when it reaches the end and starts again it is overwritten as expected. Its not a big deal to me starting in the position 1 instead of 0 but I just point it out for someone that find this answer useful."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 138, "user_id": 7183892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7831b84d96fa6df2214a2055f5201f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Santos", "link": "https://stackoverflow.com/users/7183892/marco-santos"}, "edited": false, "score": 0, "creation_date": 1542731188, "post_id": 53395900, "comment_id": 93669925, "body": "yes, that was my fault.  Fixed in code snippet now.  Swap the lines in the func Add so the pointer is incremented after the insertion"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 1, "last_activity_date": 1542731126, "last_edit_date": 1542731126, "creation_date": 1542726352, "answer_id": 53395900, "question_id": 53395380, "link": "https://stackoverflow.com/questions/53395380/initialize-map-issues/53395900#53395900", "title": "Initialize map issues", "body": "<p>You could implement a data structure for a circular buffer like this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Circle struct  {\n   Size int\n   Contents []interface{}\n   Pointer int\n}\n\nfunc (c *Circle) Setup(n int) {\n   (*c).Size=n\n   (*c).Contents=make([]interface{},n)\n}\n\nfunc (c *Circle) Add(value interface{}) {\n   (*c).Contents[(*c).Pointer] = value\n   (*c).Pointer = ((*c).Pointer+1) % (*c).Size\n}\n\n\nfunc main() {\n        mapDataPayload := make(map[string]*Circle)\n        mapDataPayload[\"aaa\"]=&amp;Circle{}\n        mapDataPayload[\"aaa\"].Setup(10)\n    for i:=0; i&lt;9999; i++ {\n      mapDataPayload[\"aaa\"].Add(i)\n    }\n    mapDataPayload[\"aaa\"].Add(\"banana\")\n    fmt.Println(mapDataPayload[\"aaa\"].Contents)\n\n}\n</code></pre>\n\n<p>updated to use interface{} so any type of data can be used</p>\n"}], "owner": {"reputation": 138, "user_id": 7183892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7831b84d96fa6df2214a2055f5201f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Santos", "link": "https://stackoverflow.com/users/7183892/marco-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53395900, "answer_count": 2, "score": -2, "last_activity_date": 1542731965, "creation_date": 1542724629, "last_edit_date": 1542725509, "question_id": 53395380, "link": "https://stackoverflow.com/questions/53395380/initialize-map-issues", "title": "Initialize map issues", "body": "<p>I am developing a project where I need to declare the following:</p>\n\n<pre><code>mapDataPayload := make(map[string][]*dataPayload)\n</code></pre>\n\n<p>If I <strong>append</strong> data to it, it works normally.</p>\n\n<pre><code>mapDataPayload := make(map[string][]*dataPayload)\n\nfor {\n    select {\n    case rcvData := &lt;-ch:\n\n        mapDataPayload[rcvData.Topic] = append(\n            mapDataPayload[rcvData.Topic],\n            &amp;dataPayload{Message: rcvData.Message},\n        )\n    }\n}\n</code></pre>\n\n<p>However, I would like to set a limit in size. With append it grows without stopping. What I would like to achieve is when the limit is reached (Max: 100), it would overwrite the index 0, 1, 2...</p>\n\n<pre><code>mapDataPayload[rcvData.Topic][0]\nmapDataPayload[rcvData.Topic][1]\n</code></pre>\n\n<p>I tried to initialize the following with:</p>\n\n<pre><code>make(map[string][]*dataPayload, 100)\n\nfor {\n    select {\n    case rcvData := &lt;-ch:\n        mapDataPayload[rcvData.Topic][0] = &amp;dataPayload{Message: rcvData.Message}\n    }\n}\n</code></pre>\n\n<p>But if I check the length it would return 0. Replacing append with direct initialization (mapDataPayload[rcvData.Topic][0]) would cause error immediately.</p>\n\n<p>So, what I want to do is populate the map[string][]*dataPayload with a limit, for example this data:</p>\n\n<pre><code>{\n  \"test1\": {\n    \"0\": {\n      \"Message\": \"Heasdllo\"\n    },\n    \"1\": {\n      \"Message\": \"Hel132lo\"\n    },\n    \"2\": {\n      \"Message\": \"Hedsallo\"\n    }\n  },\n  \"testanother\": {\n    \"0\": {\n      \"Message\": \"adsad\"\n    },\n    \"1\": {\n      \"Message\": \"Helwqe2lo\"\n    },\n    \"2\": {\n      \"Message\": \"Hel21321lo\"\n    },\n    \"3\": {\n      \"Message\": \"Hel21321lo\"\n    }\n  }\n}\n</code></pre>\n\n<p>When it reaches the number 100 I want to go back to number 0, 1, 2...</p>\n"}, {"tags": ["go", "kubernetes", "client-go"], "comments": [{"owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "edited": false, "score": 1, "creation_date": 1542723196, "post_id": 53394844, "comment_id": 93665142, "body": "did you check whether or not you service has permission?"}, {"owner": {"reputation": 613, "user_id": 8626871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba1c684c3181597d9009ba99ad5b2ee?s=128&d=identicon&r=PG&f=1", "display_name": "gkgkgkgk", "link": "https://stackoverflow.com/users/8626871/gkgkgkgk"}, "reply_to_user": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "edited": false, "score": 0, "creation_date": 1542723596, "post_id": 53394844, "comment_id": 93665378, "body": "@nightfury1204 Not sure- where do I check that?"}, {"owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "edited": false, "score": 0, "creation_date": 1542724181, "post_id": 53394844, "comment_id": 93665755, "body": "how did you create the client in your golang service?"}, {"owner": {"reputation": 613, "user_id": 8626871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba1c684c3181597d9009ba99ad5b2ee?s=128&d=identicon&r=PG&f=1", "display_name": "gkgkgkgk", "link": "https://stackoverflow.com/users/8626871/gkgkgkgk"}, "reply_to_user": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "edited": false, "score": 0, "creation_date": 1542724283, "post_id": 53394844, "comment_id": 93665816, "body": "@nightfury1204 I used rest.InClusterConfig(config)"}], "answers": [{"tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": true, "score": 2, "last_activity_date": 1542725618, "creation_date": 1542725618, "answer_id": 53395667, "question_id": 53394844, "link": "https://stackoverflow.com/questions/53394844/in-cluster-config-is-unable-to-get-pods-when-deployed-in-a-non-default-namespace/53395667#53395667", "title": "In Cluster Config is unable to get pods when deployed in a non-default namespace", "body": "<p>This issue is permission issue. Since you are using <code>rest.InClusterConfig(config)</code> to create client. That means it using pod's service account as credential. So check whether that service account has the permission to get pods in any namespace.</p>\n\n<blockquote>\n  <p>if service account in the pod is not defined, then it will use <code>default</code> service account.</p>\n</blockquote>\n\n<p>If RBAC is enabled in your cluster, then check the <strong>role binding</strong> in that namespace, to find out whether your service account has the permission. </p>\n\n<pre><code># to see the list of role bindings in 'default' namespace\nkubectl get rolebindings --namespace default\n</code></pre>\n\n<p>To see the specific rolebinding</p>\n\n<pre><code>kubectl get rolebindings ROLE-BINDING-NAME --namespace default -o yaml\n</code></pre>\n\n<p>Also you can create role and role binding to give permission. To know about RBAC role and role binding see here: <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/\" rel=\"nofollow noreferrer\">https://kubernetes.io/docs/reference/access-authn-authz/rbac/</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2453249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f3db395646868cd3bb9af28553df64d?s=128&d=identicon&r=PG", "display_name": "Gazi", "link": "https://stackoverflow.com/users/2453249/gazi"}, "is_accepted": false, "score": 0, "last_activity_date": 1546651289, "creation_date": 1546651289, "answer_id": 54048145, "question_id": 53394844, "link": "https://stackoverflow.com/questions/53394844/in-cluster-config-is-unable-to-get-pods-when-deployed-in-a-non-default-namespace/54048145#54048145", "title": "In Cluster Config is unable to get pods when deployed in a non-default namespace", "body": "<p>Following is what I used on a minikube cluster to give the default service account access to crud ops on common resources. The obvious caveat is that you'd need to be careful on a real cluster.</p>\n\n<pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: crud-role\n  namespace: default\nrules:\n- apiGroups: [\"\", \"apps\", \"batch\"]\n  resources: [ \"deployments\", \"jobs\", pods\", \"replicasets\", services\" ]\n  verbs: [ \"create\", \"get\", \"list\", \"delete\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: crud-role-binding\n  namespace: default\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: crud-role\nsubjects:\n  - kind: ServiceAccount\n    name: default\n    namespace: default\n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 8626871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba1c684c3181597d9009ba99ad5b2ee?s=128&d=identicon&r=PG&f=1", "display_name": "gkgkgkgk", "link": "https://stackoverflow.com/users/8626871/gkgkgkgk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 53395667, "answer_count": 2, "score": 0, "last_activity_date": 1546651289, "creation_date": 1542722889, "question_id": 53394844, "link": "https://stackoverflow.com/questions/53394844/in-cluster-config-is-unable-to-get-pods-when-deployed-in-a-non-default-namespace", "title": "In Cluster Config is unable to get pods when deployed in a non-default namespace", "body": "<p>When I deploy my golang service to any namespace but the <code>default</code> namespace, the service is unable to retrieve pods on any namespace. The same service deployed on the <code>default</code> namespace works perfectly, using the golang client-go api.</p>\n\n<p>Is this a security issue?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["bash", "go", "curl", "line-breaks"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1542719675, "post_id": 53393762, "comment_id": 93662873, "body": "This has nothing to do with Go. It&#39;s how you invoke your handler, via <code>curl</code>, and how you pass arguments to <code>curl</code>. Possible duplicate of <a href=\"https://stackoverflow.com/questions/3872427/how-to-send-line-break-with-curl\">How to send line break with curl?</a>"}, {"owner": {"reputation": 586, "user_id": 669003, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/bdc30d5815be37a2b9869fa8d1ef9bf2?s=128&d=identicon&r=PG", "display_name": "grouser", "link": "https://stackoverflow.com/users/669003/grouser"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1542720076, "post_id": 53393762, "comment_id": 93663141, "body": "You are right. I have used curl -X POST --data $&#39;My\\nName&#39; <a href=\"http://127.0.0.1:8080/\" rel=\"nofollow noreferrer\">127.0.0.1:8080</a>  instead and the line-breaks are created. Many thanks."}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 4, "last_activity_date": 1542722777, "creation_date": 1542722777, "answer_id": 53394798, "question_id": 53393762, "link": "https://stackoverflow.com/questions/53393762/n-scaped-when-writing-to-a-file-in-go/53394798#53394798", "title": "\\n scaped when writing to a file in Go", "body": "<p>\"My\\nName\" does not interpolate <code>\\n</code> to a newline</p>\n\n<pre><code>echo \"My\\nName\"\nMy\\nName\n</code></pre>\n\n<p>However there are ways of doing this in the shell</p>\n\n<pre><code>echo \"$(printf 'My\\nName')\"\nMy\nName\n</code></pre>\n\n<p>Your Go is fine, the curl bash side is not behaving as expected</p>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 1103922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x0lex.jpg?s=128&g=1", "display_name": "crazyh", "link": "https://stackoverflow.com/users/1103922/crazyh"}, "is_accepted": false, "score": 0, "last_activity_date": 1542960979, "creation_date": 1542960979, "answer_id": 53442869, "question_id": 53393762, "link": "https://stackoverflow.com/questions/53393762/n-scaped-when-writing-to-a-file-in-go/53442869#53442869", "title": "\\n scaped when writing to a file in Go", "body": "<p>Use <code>curl -X POST --data $'My\\nName' http://127.0.0.1:8080/</code> instead. $-strings (in Bash) is ANSI-C quoting which supports all C-like escape sequences including \"\\n\".</p>\n"}], "owner": {"reputation": 586, "user_id": 669003, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/bdc30d5815be37a2b9869fa8d1ef9bf2?s=128&d=identicon&r=PG", "display_name": "grouser", "link": "https://stackoverflow.com/users/669003/grouser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542960979, "creation_date": 1542719492, "last_edit_date": 1542722826, "question_id": 53393762, "link": "https://stackoverflow.com/questions/53393762/n-scaped-when-writing-to-a-file-in-go", "title": "\\n scaped when writing to a file in Go", "body": "<p>I have created a webserver that receives POST requests, creates a txt file and prints it using the lp command.</p>\n\n<p>However, those strings coming from a request that contains \"\\n\" are saved into the file with \\n as a text instead of creating a line break.</p>\n\n<p>If I declare a hard-coding string, the line breaks are created.</p>\n\n<p>This is the relevant code:</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    bodyBuffer, _ := ioutil.ReadAll(r.Body)\n    err := ioutil.WriteFile(\"/tmp/print.txt\", bodyBuffer, 0644)\n    //... More code\n}\n</code></pre>\n\n<p>If I run this command:</p>\n\n<pre><code>curl -X POST --data \"My\\nName\" http://127.0.0.1:8080/\n</code></pre>\n\n<p>The text file generated contains: My\\nName instead of two lines.</p>\n"}, {"tags": ["mysql", "sql", "go"], "answers": [{"comments": [{"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1542717285, "post_id": 53391359, "comment_id": 93661444, "body": "thx and it might be that what I ask for is unpossible, but I wanted to react on duplicate-key error from within the sql statement and not only update the row but also copy the old values to a backup table."}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1542718179, "post_id": 53391359, "comment_id": 93661965, "body": "thats why only (3) comes close to be an answer, but violates the standard sql requirement. Obviously DB manipulations has not been planed properly for the standard sql specification, since MySQL and Postgres has different solutions for this common case: ON DUPLICATE KEY and UPSERT"}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1542721828, "post_id": 53391359, "comment_id": 93664301, "body": "ok according to <a href=\"https://stackoverflow.com/questions/3884344/mysql-on-duplicate-key-insert-into-an-audit-or-log-table\" title=\"mysql on duplicate key insert into an audit or log table\">stackoverflow.com/questions/3884344/&hellip;</a> a stored procedure is the only way to achieve this."}], "tags": [], "owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "is_accepted": false, "score": 0, "last_activity_date": 1542711341, "last_edit_date": 1542711341, "creation_date": 1542710991, "answer_id": 53391359, "question_id": 53390487, "link": "https://stackoverflow.com/questions/53390487/atomic-update-and-backup-on-duplicate-key-insert-else-golang-sql-statement/53391359#53391359", "title": "Atomic update and backup ON DUPLICATE KEY insert else - golang sql statement", "body": "<p>This is more a SQL question/answer than Go specific so the possible solutions are SQL based.</p>\n\n<p>Possible solutions:</p>\n\n<p>(1) REPLACE INTO</p>\n\n<pre><code>REPLACE INTO books\n    (id, title, author, year_published)\nVALUES\n    (1, 'Green Eggs and Ham', 'Dr. Seuss', 1960);\n</code></pre>\n\n<p>This would overwrite an existing record. Works on unique constraint(s). Though when a matching record is found it will be deleted and thus it might a not wanted behavior.</p>\n\n<p>(2) INSERT IGNORE</p>\n\n<pre><code>INSERT IGNORE INTO books\n    (id, title, author, year_published)\nVALUES\n    (1, 'Green Eggs and Ham', 'Dr. Seuss', 1960);\n</code></pre>\n\n<p>This would add if the record does not exist. Works on unique constraint(s).</p>\n\n<p>From the handbook:</p>\n\n<blockquote>\n  <p>If you use the IGNORE modifier, errors that occur while executing the\n  INSERT statement are ignored. For example, without IGNORE, a row that\n  duplicates an existing UNIQUE index or PRIMARY KEY value in the table\n  causes a duplicate-key error and the statement is aborted. With\n  IGNORE, the row is discarded and no error occurs. Ignored errors may\n  generate warnings instead, although duplicate-key errors do not.</p>\n</blockquote>\n\n<p>(3) INSERT ... ON DUPLICATE KEY UPDATE</p>\n\n<pre><code>INSERT INTO books\n    (id, title, author, year_published)\nVALUES\n    (1, 'Green Eggs and Ham', 'Dr. Seuss', 1960);\nON DUPLICATE KEY UPDATE\n    title = 'No Green Eggs and Ham';\n</code></pre>\n\n<p>If the insert fails the values from <code>ON DUPLICATE KEY</code> will be used to make an update statement.</p>\n\n<p>To do a backup create a history table ( a table with the same structure but amended with columns to get the change date ) and do a <code>INSERT ... SELECT</code>. To be atomic you would probable need to use transactions with the correct locking strategy - not sure how to get this right for MySQL.</p>\n\n<p>Reference: </p>\n\n<ul>\n<li><a href=\"https://chartio.com/resources/tutorials/how-to-insert-if-row-does-not-exist-upsert-in-mysql/\" rel=\"nofollow noreferrer\">https://chartio.com/resources/tutorials/how-to-insert-if-row-does-not-exist-upsert-in-mysql/</a> for sample</li>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.5/en/insert.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/refman/5.5/en/insert.html</a></li>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.5/en/replace.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/refman/5.5/en/replace.html</a></li>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.5/en/insert-on-duplicate.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/refman/5.5/en/insert-on-duplicate.html</a></li>\n</ul>\n"}], "owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 962, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542711341, "creation_date": 1542708119, "last_edit_date": 1542710099, "question_id": 53390487, "link": "https://stackoverflow.com/questions/53390487/atomic-update-and-backup-on-duplicate-key-insert-else-golang-sql-statement", "title": "Atomic update and backup ON DUPLICATE KEY insert else - golang sql statement", "body": "<p>What is the best way to combine two statements (INSERT or (BACKUP and UPDATE)) and perform them atomically in golang?</p>\n\n<p>I found this similar question:\n<a href=\"https://codereview.stackexchange.com/questions/186909/query-select-and-insert-if-not-exists?newreg=067063956a834327883542c3171a22d4\">https://codereview.stackexchange.com/questions/186909/query-select-and-insert-if-not-exists?newreg=067063956a834327883542c3171a22d4</a></p>\n\n<p>But the Solution does there does not fulfil 2 of the the following requirements:</p>\n\n<ol>\n<li>perform an backup of the value ON DUPLICATE KEY, </li>\n<li>use standard SQL</li>\n<li>not use store procedures but</li>\n<li>remain atomic. </li>\n</ol>\n"}, {"tags": ["json", "go", "marshalling"], "comments": [{"owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "edited": false, "score": 0, "creation_date": 1542707953, "post_id": 53390353, "comment_id": 93656313, "body": "is your <code>key</code> is string?"}, {"owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "reply_to_user": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "edited": false, "score": 0, "creation_date": 1542708014, "post_id": 53390353, "comment_id": 93656346, "body": "its an type interface {}"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1542708140, "post_id": 53390353, "comment_id": 93656421, "body": "Do pass a string to GetBytes(key)?"}, {"owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "edited": false, "score": 0, "creation_date": 1542708246, "post_id": 53390353, "comment_id": 93656484, "body": "My producer is passing me this interface. I cannot pass it as a string."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1542708254, "post_id": 53390353, "comment_id": 93656488, "body": "<i>If</i> <code>json.Marshal</code> inserts <code>` then because they are _needed_, e.g. because </code>key` is a string containing double quotes. You are doing this all wrong. If key is already a JSON document as a string there is no reason to Mardshal it."}], "answers": [{"tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": true, "score": 5, "last_activity_date": 1542709244, "last_edit_date": 1542709244, "creation_date": 1542708510, "answer_id": 53390619, "question_id": 53390353, "link": "https://stackoverflow.com/questions/53390353/removing-escape-characters-after-marshalling/53390619#53390619", "title": "Removing escape characters after Marshalling", "body": "<p>I think you sending string as <code>key</code> in <code>func GetBytes(key interface{}) ([]byte, error)</code>. That's why you are seeing escape characters. </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\n\nfunc f(key interface{}) {\n    json, err := json.Marshal(key)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(json))\n}\n\nfunc main() {\n\n    data := map[string]interface{}{\n        \"A\": 1,\n        \"B\": 2,\n    }\n\n    f(data)\n\n    json, err := json.Marshal(data)\n    if err != nil {\n        log.Fatal(err)\n    }\n    f(string(json))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"A\":1,\"B\":2}\n\"{\\\"A\\\":1,\\\"B\\\":2}\"\n</code></pre>\n\n<p>Go playground link: <a href=\"https://play.golang.org/p/iF1ckvZ9cQC\" rel=\"noreferrer\">https://play.golang.org/p/iF1ckvZ9cQC</a></p>\n\n<p>In that case, You can use <code>Unquote</code> to remove quote and escape character:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"strconv\"\n)\n\n\nfunc f(key interface{}) {\n    json, err := json.Marshal(key)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(json))\n\n    st, err := strconv.Unquote(string(json))\n    fmt.Println(st)\n\n}\n\nfunc main() {\n\n    data := map[string]interface{}{\n        \"A\": 1,\n        \"B\": 2,\n    }\n\n    json, err := json.Marshal(data)\n    if err != nil {\n        log.Fatal(err)\n    }\n    f(string(json))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\"{\\\"A\\\":1,\\\"B\\\":2}\"\n{\"A\":1,\"B\":2}\n</code></pre>\n\n<p>Go playground link: <a href=\"https://play.golang.org/p/aoTEQtJslTs\" rel=\"noreferrer\">https://play.golang.org/p/aoTEQtJslTs</a></p>\n"}], "owner": {"reputation": 915, "user_id": 2845312, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/nbUXW.png?s=128&g=1", "display_name": "d_luffy_de", "link": "https://stackoverflow.com/users/2845312/d-luffy-de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4908, "favorite_count": 0, "accepted_answer_id": 53390619, "answer_count": 1, "score": 0, "last_activity_date": 1542709434, "creation_date": 1542707649, "question_id": 53390353, "link": "https://stackoverflow.com/questions/53390353/removing-escape-characters-after-marshalling", "title": "Removing escape characters after Marshalling", "body": "<p>In the above code I am trying to convert my key to byte array via Marshal. Although I am successful doing it, when I see the Marshalled string, I am seeing <code>\\</code> escape character before my json keys. \nCan you please help me remove that?</p>\n\n<pre><code> func GetBytes(key interface{}) ([]byte, error) {\n\n    b, err := json.Marshal(key)\n    if err != nil {\n            return nil, err\n    }\n\n    log.Println(\"%%%%%%%%%%\")\n    log.Printf(\"%+v\\n\", key)\n    log.Println(\"##########\")\n    log.Println(string(b));\n\n    return b, nil\n}\n</code></pre>\n\n<p><strong>Current Output:</strong></p>\n\n<pre><code>%%%%%%%%%%\n{\"entityId\":5010740929,\"eventTime\":1542706233458}\n##########\n\"{\\\"entityId\\\":5010740929,\\\"eventTime\\\":1542706233458}\"\n</code></pre>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1542705885, "post_id": 53389781, "comment_id": 93655085, "body": "<a href=\"https://godoc.org/github.com/gin-gonic/gin#Engine.Run\" rel=\"nofollow noreferrer\"><code>Engine.Run()</code></a> returns an error, so start by printing that, e.g. <code>log.Printf(&quot;Server stopped, err: %v&quot;, router.Run(&quot;:8080&quot;))</code>"}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 0, "creation_date": 1542709411, "post_id": 53389781, "comment_id": 93657182, "body": "Most likely you have a panic somewhere in a goroutine, not directly in a handler (otherwise gin.Recovery() would have taken care of it). See where you service writes stderr. That&#39;s where a panic would be logged. Where it is depends on how you run the service. If you run it as a script, make sure you redirect stderr somewhere. Upstart usually writes to /var/log/&lt;your-service-name&gt;.err. Don&#39;t remember where systemd writes it. But whatever you use, it should be in your system documentation."}], "owner": {"reputation": 111, "user_id": 3237829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1306e2504e8d37f65732958c1f6a8cc?s=128&d=identicon&r=PG&f=1", "display_name": "John Deep", "link": "https://stackoverflow.com/users/3237829/john-deep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1597032072, "creation_date": 1542705675, "last_edit_date": 1597032072, "question_id": 53389781, "link": "https://stackoverflow.com/questions/53389781/golang-gin-server-is-going-down-without-any-trace", "title": "Golang (gin) server is going down without any trace", "body": "<p>I tried making an API with gin.</p>\n<pre><code>router := gin.Default()\nrouter.GET(&quot;/search&quot;, controllers.Search)\nrouter.POST(&quot;/handshake/&quot;, controllers.Handshake)\nrouter.GET(&quot;/ping&quot;, func(c *gin.Context) {\n    c.JSON(200, gin.H{\n        &quot;message&quot;: &quot;pong&quot;,\n    })\n})\nrouter.Use(gin.Recovery())\nrouter.Run(fmt.Sprintf(&quot;:%d&quot;, 8080))\n</code></pre>\n<p>I am creating the binary on my local machine running ubuntu 18.04 and distributing the binary to ubuntu 16.04 on AWS EC2. the service runs fine and stops suddenly without any trace of error or warning or panic on the log. very difficult to find out what's wrong?</p>\n"}, {"tags": ["go", "maps", "heap-memory"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1542700033, "post_id": 53388332, "comment_id": 93652113, "body": "We don&#39;t know how you use the map, so it&#39;s hard to tell on what / how you could improve your code. One tip you may use is to create a map with capacity provided, if you know how many elements you need to store in it. For that, you may use <code>make(map[string]struct{}, capacity)</code>."}, {"owner": {"reputation": 245, "user_id": 8526089, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e4614326f7e4c828342bd85fc8a7447c?s=128&d=identicon&r=PG&f=1", "display_name": "zaRRoc", "link": "https://stackoverflow.com/users/8526089/zarroc"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1542700783, "post_id": 53388332, "comment_id": 93652462, "body": "added the code implementation of how maps is being constructedv"}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 6, "creation_date": 1542701078, "post_id": 53388332, "comment_id": 93652592, "body": "Is there a reason why a <code>string</code> is used for the keys?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1542701452, "post_id": 53388332, "comment_id": 93652754, "body": "&quot;the size of the map in heap is 100+MB&quot; how did you measure this. Are you sure this number is correct? And why on earth are you storing the ints in their string representations? <b>Don&#39;t</b> <b>do</b> <b>that</b>."}, {"owner": {"reputation": 245, "user_id": 8526089, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e4614326f7e4c828342bd85fc8a7447c?s=128&d=identicon&r=PG&f=1", "display_name": "zaRRoc", "link": "https://stackoverflow.com/users/8526089/zarroc"}, "edited": false, "score": 0, "creation_date": 1542701765, "post_id": 53388332, "comment_id": 93652911, "body": "the groups could be comprised on integers or strings, hence decided to keep a map of strings for the client sdk to use. So, it calls group.IsMember(&lt;string&gt;) , which is O(1) operation for now."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1542701881, "post_id": 53388332, "comment_id": 93652951, "body": "The size of the <code>string</code> representation of an <code>int64</code> may be 4 times bigger than the size of <code>int64</code> itself. If you do need memory optimized solution, don&#39;t convert them to <code>string</code>. If you do need to handle both integers and strings, consider using 2 maps, one with <code>int64</code> keys and one with <code>string</code> keys. And in your example code, you may create the map with capacity, like: <code>out := make(map[int64]void{}, len(v))</code>"}, {"owner": {"reputation": 245, "user_id": 8526089, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e4614326f7e4c828342bd85fc8a7447c?s=128&d=identicon&r=PG&f=1", "display_name": "zaRRoc", "link": "https://stackoverflow.com/users/8526089/zarroc"}, "edited": false, "score": 0, "creation_date": 1542702077, "post_id": 53388332, "comment_id": 93653036, "body": "Used the runtime stats to calculate the heap usage. Found the actual size of the members by adding up the bytes of each member. Members size = 15MB, map size = 108 MB"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1542702408, "post_id": 53388332, "comment_id": 93653194, "body": "As others pointed out, avoid string representations for integers. Use <code>int</code> or, if possible, <code>(u)int32</code>. If the map is still too big, consider a sorted slice and use <a href=\"https://golang.org/pkg/sort/#SearchInts\" rel=\"nofollow noreferrer\">sort.SearchInts</a> (or SearchStrings if you really can&#39;t avoid that) for O(log n) in the worst case."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542706021, "post_id": 53388332, "comment_id": 93655161, "body": "If you want to keep strings and ints in the same map than <i>please</i> use at least an efficient string representation and not base10!! Also: Heap usage is a good indicator of the memory consumption of the whole program but not really suitable to measure the memory usage of a map. Redesign!"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1542742616, "last_edit_date": 1542742616, "creation_date": 1542702613, "answer_id": 53388942, "question_id": 53388332, "link": "https://stackoverflow.com/questions/53388332/memory-efficient-implementation-of-go-map/53388942#53388942", "title": "Memory efficient implementation of go map?", "body": "<p>This is a more memory efficient form of the map:</p>\n\n<pre><code>type void struct{}\n\nfunc ToMap(v []int64) map[int64]void {\n    m := make(map[int64]void, len(v))\n    for _, i := range v {\n        m[i] = void{}\n    }\n    return m\n}\n</code></pre>\n\n<p>Go maps are optimized for integer keys. Optimize the map allocation by giving the exact map size as a hint. </p>\n\n<p>A <code>string</code> has an implicit pointer which would make the garbage collector (gc) follow the pointer every time it scans. </p>\n\n<hr>\n\n<p>Here is a Go benchmark for 2 million pseudorandom integers:</p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"strconv\"\n    \"testing\"\n)\n\ntype void struct{}\n\nfunc ToMap1(v []int64) map[string]void {\n    out := map[string]void{}\n    for _, i := range v {\n        out[strconv.Itoa(int(i))] = void{}\n    }\n    return out\n}\n\nfunc ToMap2(v []int64) map[int64]void {\n    m := make(map[int64]void, len(v))\n    for _, i := range v {\n        m[i] = void{}\n    }\n    return m\n}\n\nvar benchmarkV = func() []int64 {\n    v := make([]int64, 2000000)\n    for i := range v {\n        v[i] = rand.Int63()\n    }\n    return v\n}()\n\nfunc BenchmarkToMap1(b *testing.B) {\n    b.ReportAllocs()\n    b.ResetTimer()\n    for N := 0; N &lt; b.N; N++ {\n        ToMap1(benchmarkV)\n    }\n}\n\nfunc BenchmarkToMap2(b *testing.B) {\n    b.ReportAllocs()\n    b.ResetTimer()\n    for N := 0; N &lt; b.N; N++ {\n        ToMap2(benchmarkV)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test tomap_test.go -bench=.\nBenchmarkToMap1-4     2  973358894 ns/op    235475280 B/op    2076779 allocs/op\nBenchmarkToMap2-4    10  188489170 ns/op     44852584 B/op         23 allocs/op\n$ \n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 8526089, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e4614326f7e4c828342bd85fc8a7447c?s=128&d=identicon&r=PG&f=1", "display_name": "zaRRoc", "link": "https://stackoverflow.com/users/8526089/zarroc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1657, "favorite_count": 2, "accepted_answer_id": 53388942, "answer_count": 1, "score": 0, "last_activity_date": 1542742616, "creation_date": 1542699834, "last_edit_date": 1542700744, "question_id": 53388332, "link": "https://stackoverflow.com/questions/53388332/memory-efficient-implementation-of-go-map", "title": "Memory efficient implementation of go map?", "body": "<p>My use case is to transfer a group of members (integers) over network, so we employ delta encoding and on the receiving end we decode and put the whole list as a map, \n      map[string]struct{} \nfor O(1) complexity for membership check. </p>\n\n<p>The problem I am facing is that the actual size of members is only 15MB for 2 Million integers, but the size of the map in heap is 100+MB. Seems like the actual map implementation of Go is not suitable for large maps. \nSince it is a client side SDK, I do not want to impact the usable memory much, and there can be multiple such groups that need to be kept in memory for long periods of time--around 1 week.</p>\n\n<p>Is there a better alternative DS in Go for this?</p>\n\n<pre><code>type void struct{}\nfunc ToMap(v []int64) map[string]void {\n out := map[string]void{}\n for _, i := range v {\n   out[strconv.Itoa(int(i))] = void{}\n }\n return out\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1562, "user_id": 4303758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nbL0i.jpg?s=128&g=1", "display_name": "Manjeet Thakur", "link": "https://stackoverflow.com/users/4303758/manjeet-thakur"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542703572, "post_id": 53388154, "comment_id": 93653755, "body": "@Volker Well I&#39;m trying to learn a golang and by mistake this error is generated and I see in the error  <code>panic: runtime error: index out of range</code> so then this question comes in my mind"}], "answers": [{"tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 7, "last_activity_date": 1596884582, "last_edit_date": 1596884582, "creation_date": 1542699702, "answer_id": 53388311, "question_id": 53388154, "link": "https://stackoverflow.com/questions/53388154/is-the-main-function-runs-as-a-goroutine/53388311#53388311", "title": "Is the main function runs as a goroutine?", "body": "<p>Yes, the main function runs as a goroutine (the main one).</p>\n<p>According to <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency/1</a></p>\n<blockquote>\n<p>A goroutine is a lightweight thread managed by the Go runtime.\n<code>go f(x, y, z)</code>\nstarts a new goroutine running <code>f(x, y, z)</code> The evaluation of f, x, y, and z happens in the <strong>current goroutine</strong> and the execution of <code>f</code> happens in the new goroutine.<br />\nGoroutines run in the same address space, so access to shared memory must be synchronized. The sync package provides useful primitives, although you won't need them much in Go as there are other primitives.</p>\n</blockquote>\n<p>So according to this official document the <code>main</code> is the <strong>current goroutine</strong>.<br />\nTo be precise (literally) we could address the <code>main</code> as the current goroutine, so simply speaking it is a goroutine. (Note: Literally speaking the <code>main()</code> is a function which could run as a goroutine.)</p>\n<hr />\n<p>Now let's <strong>count</strong> the number of goroutines using <code>runtime.NumGoroutine()</code>:</p>\n<p>As an example let's run 3 goroutines. Try it <a href=\"https://play.golang.org/p/CT3vL4i0cGl\" rel=\"nofollow noreferrer\">online</a>:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;runtime&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    fmt.Println(runtime.NumGoroutine()) // 3\n    time.Sleep(100 * time.Millisecond)\n}\nfunc init() {\n    go main()\n    go main()\n}\n\n</code></pre>\n<hr />\n<p>Here the <strong>current goroutine</strong> runs the <strong>new goroutine</strong>, so here we have <strong>more than one goroutine</strong>, which executes <code>main()</code> again. Try it <a href=\"https://play.golang.org/p/R9TonRYEniB\" rel=\"nofollow noreferrer\">online</a>:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;runtime&quot;\n    &quot;sync/atomic&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    fmt.Println(runtime.NumGoroutine()) // 1 2 3 4\n    if atomic.LoadInt32(&amp;i) &lt;= 0 {\n        return\n    }\n    atomic.AddInt32(&amp;i, -1)\n    go main()\n    time.Sleep(100 * time.Millisecond)\n}\n\nvar i int32 = 3\n</code></pre>\n<p>Output:</p>\n<pre><code>1\n2\n3\n4\n</code></pre>\n<p>Here we have one <code>main</code> goroutine plus 3 user called <code>main</code> goroutines, so total number of goroutines are 4 here.</p>\n<hr />\n<p>Let's calculate factorial using <code>main()</code> (<strong>one goroutine</strong> - no synchronization needed). Try it <a href=\"https://play.golang.org/p/7YK9o_u72bM\" rel=\"nofollow noreferrer\">online</a>:</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc main() {\n    if f &lt;= 0 {\n        fmt.Println(acc)\n        return\n    }\n    acc *= f\n    f--\n    main()\n}\n\nvar f = 5\nvar acc = 1\n\n</code></pre>\n<p>Output:</p>\n<pre><code>120\n</code></pre>\n<p>Note: The codes above are just for clearly showing my viewpoints and is not good for production use (Using global variables should not be the first choice).</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 10, "last_activity_date": 1596782499, "last_edit_date": 1596782499, "creation_date": 1542703594, "answer_id": 53389196, "question_id": 53388154, "link": "https://stackoverflow.com/questions/53388154/is-the-main-function-runs-as-a-goroutine/53389196#53389196", "title": "Is the main function runs as a goroutine?", "body": "<blockquote>\n<p>Is the main function a goroutine?</p>\n</blockquote>\n<p>No.</p>\n<p>The main function is a function.</p>\n<p>In contrast,</p>\n<blockquote>\n<p>A <em>goroutine</em> is a lightweight thread of execution. (<a href=\"https://gobyexample.com/goroutines\" rel=\"nofollow noreferrer\">source</a>).</p>\n</blockquote>\n<p>So goroutines execute functions, but goroutines are not functions, and there is not a 1-to-1 relationship between goroutines and functions.</p>\n<p>However...</p>\n<p>The <code>main()</code> function is executed in the first (and at startup, only) goroutine, <code>goroutine #1</code>.</p>\n<p>But as soon as that function calls another function, then the main goroutine is no longer executing the main function, and is instead executing some other function.</p>\n<p>So it's clear that a goroutine and a function are entirely different entities.</p>\n<p><em>Do not conflate goroutines with functions!!</em></p>\n<p>Functions and goroutines are entirely different concepts.  And thinking of them as the same thing will lead to countless confusion and problems.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 7319740, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CT4GgrEHouY/AAAAAAAAAAI/AAAAAAAAAb0/dwSsR0BeX6A/photo.jpg?sz=128", "display_name": "gede nata", "link": "https://stackoverflow.com/users/7319740/gede-nata"}, "is_accepted": false, "score": 1, "last_activity_date": 1580094796, "creation_date": 1580094796, "answer_id": 59924789, "question_id": 53388154, "link": "https://stackoverflow.com/questions/53388154/is-the-main-function-runs-as-a-goroutine/59924789#59924789", "title": "Is the main function runs as a goroutine?", "body": "<p>Yes. Main func can spawn other goroutines, but \"main\" itself is one groutine.</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"runtime\"\n)\n\nfunc main() {\n        // Goroutine num includes main processing\n        fmt.Println(runtime.NumGoroutine()) // 1\n\n        // Spawn two goroutines\n        go func() {}()\n        go func() {}()\n\n        // Total three goroutines run\n        fmt.Println(runtime.NumGoroutine()) // 3\n}\n</code></pre>\n"}], "owner": {"reputation": 1562, "user_id": 4303758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nbL0i.jpg?s=128&g=1", "display_name": "Manjeet Thakur", "link": "https://stackoverflow.com/users/4303758/manjeet-thakur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1584, "favorite_count": 0, "accepted_answer_id": 53388311, "answer_count": 3, "score": 2, "last_activity_date": 1596884582, "creation_date": 1542698923, "last_edit_date": 1596880231, "question_id": 53388154, "link": "https://stackoverflow.com/questions/53388154/is-the-main-function-runs-as-a-goroutine", "title": "Is the main function runs as a goroutine?", "body": "<p>Is the <code>main()</code> function runs as a goroutine?  For example, I've seen a crash stack trace like the below, which makes me ask:</p>\n<pre><code>goroutine 1 [running]: main.binarySearch(0x0, 0x61, 0x43,\n0xc420043e70, 0x19, 0x19, 0x10)\n     /home/---/go/src/github.com/----/sumnum.go:22 +0x80 main.main()\n     /home/---/go/src/github.com/---/sumnum.go:13 +0xc1 exit status 2\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4562207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c15150f1f8ac8bcf4783048d22331711?s=128&d=identicon&r=PG", "display_name": "SNrS", "link": "https://stackoverflow.com/users/4562207/snrs"}, "edited": false, "score": 0, "creation_date": 1542756316, "post_id": 53389248, "comment_id": 93681465, "body": "Thanks for the response. I don&#39;t find a SubQuery() method on the db connection object. I use this with go."}], "tags": [], "owner": {"reputation": 5906, "user_id": 198825, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aba9dac582a7e4346b1895366200e2f2?s=128&d=identicon&r=PG", "display_name": "noamt", "link": "https://stackoverflow.com/users/198825/noamt"}, "is_accepted": true, "score": 4, "last_activity_date": 1542703786, "creation_date": 1542703786, "answer_id": 53389248, "question_id": 53387947, "link": "https://stackoverflow.com/questions/53387947/gorm-not-in-subquery/53389248#53389248", "title": "GORM &#39;NOT IN&#39; subquery", "body": "<p><a href=\"http://gorm.io/\" rel=\"nofollow noreferrer\">GORM</a> can <a href=\"http://gorm.io/docs/query.html#SubQuery\" rel=\"nofollow noreferrer\">compose</a> queries.</p>\n\n<p>Write a standard query and then call the <code>.SubQuery()</code> method:</p>\n\n<pre><code>sub := db.Table(\"table2\").Select(\"ID\").Where(\"col1 = ?\", 'val1').SubQuery()\n</code></pre>\n\n<p>The you can place it as a parameter in the <code>.Where()</code> method</p>\n\n<pre><code>err := db.Table(\"table1\").Where(\"col2 NOT IN ?\", sub).Find(&amp;table1Type).Error\n//handle the error\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4562207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c15150f1f8ac8bcf4783048d22331711?s=128&d=identicon&r=PG", "display_name": "SNrS", "link": "https://stackoverflow.com/users/4562207/snrs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 0, "accepted_answer_id": 53389248, "answer_count": 1, "score": 1, "last_activity_date": 1544009418, "creation_date": 1542697946, "last_edit_date": 1544009418, "question_id": 53387947, "link": "https://stackoverflow.com/questions/53387947/gorm-not-in-subquery", "title": "GORM &#39;NOT IN&#39; subquery", "body": "<p>I want to execute a subquery like:</p>\n\n<pre><code> SELECT id, col1, col2 FROM table1 WHERE col1='val1' and col2 NOT IN (\n  SELECT ID FROM table2 WHERE col1='val1' and col3 = 'val3')\n</code></pre>\n\n<p>How can I use <a href=\"http://gorm.io/\" rel=\"nofollow noreferrer\">GORM</a> to execute it?</p>\n"}, {"tags": ["node.js", "go", "tcp"], "comments": [{"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 1, "creation_date": 1542697470, "post_id": 53387559, "comment_id": 93651015, "body": "then how does your golang server understands the command is finished ?! its like asking a way to issue a command in terminal without pressing Enter. I think what you want is a websocket like protocol"}, {"owner": {"reputation": 3496, "user_id": 5287072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/n9Qr1.jpg?s=128&g=1", "display_name": "DarckBlezzer", "link": "https://stackoverflow.com/users/5287072/darckblezzer"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1542731242, "post_id": 53387559, "comment_id": 93669950, "body": "@danicheeta then how Client and Server TCP in nodejs works?,  If I execute <code>socket.write(data)</code> without separator(&quot;\\n&quot;) in the server(js), data go to on <code>socket.on(&#39;data&#39;, function)</code> in client side, and  my questions is how can I emulate this with golang?"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1542731880, "post_id": 53387559, "comment_id": 93670259, "body": "it must append <code>\\n</code>  under the hood. I havent checked that out but its logical to me"}], "answers": [{"comments": [{"owner": {"reputation": 3496, "user_id": 5287072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/n9Qr1.jpg?s=128&g=1", "display_name": "DarckBlezzer", "link": "https://stackoverflow.com/users/5287072/darckblezzer"}, "edited": false, "score": 0, "creation_date": 1542730792, "post_id": 53387905, "comment_id": 93669717, "body": "but how a server and client TCP in nodejs know when data ends if there isn&#39;t a &quot;separator byte&quot; in the data that I send?"}], "tags": [], "owner": {"reputation": 1448, "user_id": 7118774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQUzc.jpg?s=128&g=1", "display_name": "Milad Aghamohammadi", "link": "https://stackoverflow.com/users/7118774/milad-aghamohammadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1542697747, "creation_date": 1542697747, "answer_id": 53387905, "question_id": 53387559, "link": "https://stackoverflow.com/questions/53387559/how-tcp-clientgolang-knows-when-data-end-if-tcp-servernodejs-send-data-witho/53387905#53387905", "title": "How TCP Client(golang) knows when data end if TCP Server(nodejs) send data without separator &quot;\\n&quot;", "body": "<p>It's about TCP data transfer, usually in this case you should define a protocol for your data to define how much byte will be send and usually a separator for end of packet. for example </p>\n\n<pre><code>[n-Bytes for data lenght][data][separator bytes]\n</code></pre>\n\n<p>In fact, <code>ReadLine</code> also uses this method but only with separator</p>\n"}], "owner": {"reputation": 3496, "user_id": 5287072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/n9Qr1.jpg?s=128&g=1", "display_name": "DarckBlezzer", "link": "https://stackoverflow.com/users/5287072/darckblezzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542733033, "creation_date": 1542696070, "last_edit_date": 1542733033, "question_id": 53387559, "link": "https://stackoverflow.com/questions/53387559/how-tcp-clientgolang-knows-when-data-end-if-tcp-servernodejs-send-data-witho", "title": "How TCP Client(golang) knows when data end if TCP Server(nodejs) send data without separator &quot;\\n&quot;", "body": "<p><strong>My problem:</strong></p>\n\n<p>I'm trying to read the data sended by TCP server(nodejs)\nbut I can't, the server send the data without breakline \"\\r\\n\" or \"\\n\"</p>\n\n<p>I'm new in Golang but I have been trying a lot of things to get all the data sended by server.</p>\n\n<p><strong>Code from Server.js, this a simple example</strong></p>\n\n<pre><code>var net = require('net');\n\nvar server = net.createServer(function(socket) {\n    console.log(\"New Client\")\n\n    socket.on('data', function(data){\n        console.log(\"data\",data,data.toString())\n        socket.write(\"qweqweqkjwebqkjwhbekqjwbekjqbwkejhqwkjehqkwjehkqjwehkqjwhekjqhwekjhqwe\")\n    })\n    socket.on('error', function(error){\n        console.error(\"Error:\",error)\n    })\n});\n\nserver.listen(4001, '127.0.0.1');\n</code></pre>\n\n<p><strong>My code from golang</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"net\"\n    \"time\"\n)\n\nfunc main() {\n    conn, _ := net.Dial(\"tcp\", \"127.0.0.1:4001\")\n\n    for {\n        fmt.Println(\"Send Text\")\n        fmt.Fprintf(conn, \"Hello\")\n\n        // message, _ := bufio.NewReader(conn).ReadString('\\n')\n        // message, _ := bufio.NewReader(conn).ReadString('\\r')\n        message, _, _ := bufio.NewReader(conn).ReadLine() // how i know when data end if server doesn't send separator like \"\\n\" \"\\r\"\n        fmt.Println(\"Message from server: \" + message)\n\n        time.Sleep(time.Second * 3)\n    }\n}\n</code></pre>\n\n<p><strong>Output from Client Golang:</strong></p>\n\n<pre><code>Send Text\n</code></pre>\n\n<p>And that is all, the client(golang) is waiting for new line</p>\n\n<p><strong>Questions</strong>:</p>\n\n<p>1.- There is a standard size of buffer in net(nodejs) ?<br>\n2.- How I can read the data sended by Server in golang without breakline? (there is no problem client and server in nodejs)<br>\n3.- I need to read byte by byte? and find \\x00 from buffer sended by Server(nodejs) ? (if this is the case how?)<br>\n4.- Server and Client in nodejs works with separator, but when they send data to the other one, in the other side separator is deleted?</p>\n\n<p><strong>I have teste this examples, but no one <code>break</code> the cicle <code>for</code></strong></p>\n\n<pre><code>reader := bufio.NewReader(conn)\n    // for {\n    //  time.Sleep(time.Second * 3)\n    //  // buff := make([]byte, 4)\n    //  test, _ := reader.ReadByte()\n    //  fmt.Printf(\"%q\\n\", test)\n    //  fmt.Printf(\"%x\\n\", test)\n    // }\n\n    // buf := make([]byte, 1)\n    // for {\n    //  n, err := reader.Read(buf)\n    //  fmt.Println(n, err, buf[:n])\n    //  if err == io.EOF {\n    //      break\n    //  }\n    // }\n\n    // buf := make([]byte, 4)\n    // if _, err := io.ReadFull(reader, buf); err != nil {\n    //  log.Fatal(err)\n    // }\n    // fmt.Println(string(buf))\n\n    buf, err := ioutil.ReadAll(reader)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(buf))\n</code></pre>\n"}, {"tags": ["go", "methods", "struct"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1542696148, "post_id": 53387303, "comment_id": 93650507, "body": "You can&#39;t just ignore the difference between value and pointer receivers. This is important. Not all methods mutate the receiver. See <a href=\"https://golang.org/pkg/time/#Time\" rel=\"nofollow noreferrer\">time.Time</a> for a prolific example. It&#39;s also very useful to be able put types and methods in separate files. This enabled easy code generation and architecture specific implementations."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 5, "creation_date": 1542696844, "post_id": 53387303, "comment_id": 93650763, "body": "Any named type can have methods, not just struct types."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542700161, "post_id": 53387303, "comment_id": 93652173, "body": "&quot;This would be more similar to traditional OOP&quot; -- So what? Go isn&#39;t OOP."}], "answers": [{"comments": [{"owner": {"reputation": 4904, "user_id": 1005409, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cc458e828b50a1f9329469ab1e5d98fd?s=128&d=identicon&r=PG", "display_name": "Muppet", "link": "https://stackoverflow.com/users/1005409/muppet"}, "edited": false, "score": 0, "creation_date": 1542733003, "post_id": 53387551, "comment_id": 93670932, "body": "Hi, thanks for your answer. I still don&#39;t understand why having the option to define methods inside the struct def would be bad? In C# for example you can define methods both outside and inside and both arrangements have benefits. C# also has value types and the syntax for defining methods is the same as for reference types. So why only allow the methods outside the struct?"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 4904, "user_id": 1005409, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cc458e828b50a1f9329469ab1e5d98fd?s=128&d=identicon&r=PG", "display_name": "Muppet", "link": "https://stackoverflow.com/users/1005409/muppet"}, "edited": false, "score": 0, "creation_date": 1542739069, "post_id": 53387551, "comment_id": 93674025, "body": "@Muppet: it is not bad! It is just by design. each language has its own pros and cons. There are many languages to learn today and one developer should learn many! to get the job done so the inventors of the google decided to build one new fast and simple one! it is simpler than some languages yet has many details to learn and after 3 years I&#39;m still learning Golang! it never ends! and see this <a href=\"https://flaviocopes.com/golang-is-go-object-oriented/\" rel=\"nofollow noreferrer\">COMPOSITION OVER INHERITANCE</a>. I hope this helps."}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 0, "last_activity_date": 1604554918, "last_edit_date": 1604554918, "creation_date": 1542696015, "answer_id": 53387551, "question_id": 53387303, "link": "https://stackoverflow.com/questions/53387303/whats-the-reason-for-having-methods-outside-the-definition-of-the-struct/53387551#53387551", "title": "What&#39;s the reason for having methods outside the definition of the struct?", "body": "<ol>\n<li>It is <strong>simpler</strong> this way and makes language <strong>consistent</strong>/uniform for struct types and other types like the following example.</li>\n<li>You don't need <code>this</code> or <code>self</code> pointer to use and you name it as you wish, and this makes it even simpler to explain what is <code>p</code> (in your example).</li>\n</ol>\n<p>Also may be this is relevant:<br />\n<a href=\"https://stackoverflow.com/questions/23482068/in-go-is-naming-the-receiver-variable-self-misleading-or-good-practice\">In Go is naming the receiver variable &#39;self&#39; misleading or good practice?</a></p>\n<p>You may define your own types, See <a href=\"https://play.golang.org/p/E84ejjlxuKN\" rel=\"nofollow noreferrer\">this</a> example (There is no <strong>inside</strong> or <strong>struct</strong> here for this <strong>named type</strong>):</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\ntype num int32\n\nfunc (p *num) inc() {\n    *p++\n}\n\nfunc main() {\n    p := num(100)\n    p.inc()\n    fmt.Println(p) // 101\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1542697789, "creation_date": 1542697789, "answer_id": 53387912, "question_id": 53387303, "link": "https://stackoverflow.com/questions/53387303/whats-the-reason-for-having-methods-outside-the-definition-of-the-struct/53387912#53387912", "title": "What&#39;s the reason for having methods outside the definition of the struct?", "body": "<p>In golang, if we need a function associated with a type (say <code>struct</code>), then it must be defined as below (here is for go <code>struct</code>):</p>\n\n<pre><code>type my_type struct {\n    // fields ...\n}\n\nfunc (m my_type) fn_name(fn_parameters) fn_return_type {\n    // do whatever we want\n}\n</code></pre>\n\n<p>It's not something you define in your own way. But the identifier's names can be used as we want.</p>\n"}], "owner": {"reputation": 4904, "user_id": 1005409, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cc458e828b50a1f9329469ab1e5d98fd?s=128&d=identicon&r=PG", "display_name": "Muppet", "link": "https://stackoverflow.com/users/1005409/muppet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53387551, "answer_count": 2, "score": -1, "last_activity_date": 1604554918, "creation_date": 1542694733, "last_edit_date": 1542695260, "question_id": 53387303, "link": "https://stackoverflow.com/questions/53387303/whats-the-reason-for-having-methods-outside-the-definition-of-the-struct", "title": "What&#39;s the reason for having methods outside the definition of the struct?", "body": "<p>Why do we have the methods declared outside the type definition of the struct? E.g.:</p>\n\n<pre><code>type antenna struct {\n    name string\n    length float32\n    girth float32\n    bloodtype string\n}\n\nfunc (p *antenna) extend() {\n    p.length += 10\n}\n</code></pre>\n\n<p>It seems to me that the method could be part of the struct? (Let's ignore for now that structs are supposed to be value types)</p>\n\n<pre><code>type antenna struct {\n    name string\n    length float32\n    girth float32\n    bloodtype string\n\n    func extend() {\n        length += 10\n    }\n}\n</code></pre>\n\n<p>This would be more similar to traditional OOP. I didn't find any good explanations of why it is done the way it is besides \"structs are value-types and classes are reference-types\". I know the difference, but it's not a satisfactory answer to me. In any way the method has to be called like this:</p>\n\n<pre><code>var x = antenna()\nx.extend() \n</code></pre>\n\n<p>So what's the point of separating the the struct and methods? Having them visually grouped together in the code - as in typical OOP languages - seems useful to me?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 11, "user_id": 9538056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfQDV.png?s=128&g=1", "display_name": "xu lin", "link": "https://stackoverflow.com/users/9538056/xu-lin"}, "edited": false, "score": 0, "creation_date": 1542684809, "post_id": 53385804, "comment_id": 93647358, "body": "go is hot in China,but  it often block by the Great Wall ......"}, {"owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 0, "creation_date": 1542685063, "post_id": 53385804, "comment_id": 93647402, "body": "Check if the package exists in golang.google.cn , if it does not you may need a proxy to change your Ip address"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1542696385, "post_id": 53385804, "comment_id": 93650600, "body": "edit /etc/hosts  perhaps?"}, {"owner": {"reputation": 11, "user_id": 9538056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfQDV.png?s=128&g=1", "display_name": "xu lin", "link": "https://stackoverflow.com/users/9538056/xu-lin"}, "edited": false, "score": 0, "creation_date": 1545387949, "post_id": 53385804, "comment_id": 94612635, "body": "just cross the great wall."}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 1, "last_activity_date": 1542710828, "creation_date": 1542710828, "answer_id": 53391311, "question_id": 53385804, "link": "https://stackoverflow.com/questions/53385804/how-can-i-switch-into-golang-google-cn-when-i-use-go-get-to-fetch-some-package/53391311#53391311", "title": "How can I switch into golang.google.cn when I use go get to fetch some package?", "body": "<p>There are few options, one is to change git configuration:</p>\n\n<pre><code>git config --global url.\"https://golang.google.cn\".insteadOf \"https://golang.org\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9538056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfQDV.png?s=128&g=1", "display_name": "xu lin", "link": "https://stackoverflow.com/users/9538056/xu-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542710828, "creation_date": 1542684565, "question_id": 53385804, "link": "https://stackoverflow.com/questions/53385804/how-can-i-switch-into-golang-google-cn-when-i-use-go-get-to-fetch-some-package", "title": "How can I switch into golang.google.cn when I use go get to fetch some package?", "body": "<p>golang.org is blocked in China, but golang.google.cn is accessible. How can I switch into golang.google.cn when I use go get  to fetch some package?</p>\n"}, {"tags": ["bash", "go", "command-line", "ethereum", "go-ethereum"], "comments": [{"owner": {"reputation": 2275, "user_id": 7458927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03baa06e976e374201e74a42e8cc8a4b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Hendren", "link": "https://stackoverflow.com/users/7458927/lucas-hendren"}, "edited": false, "score": 0, "creation_date": 1552929668, "post_id": 53385661, "comment_id": 97188264, "body": "Did you get an answer for this or does the new answer help?"}], "answers": [{"tags": [], "owner": {"reputation": 2275, "user_id": 7458927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03baa06e976e374201e74a42e8cc8a4b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Hendren", "link": "https://stackoverflow.com/users/7458927/lucas-hendren"}, "is_accepted": false, "score": 0, "last_activity_date": 1552318612, "last_edit_date": 1552318612, "creation_date": 1551839672, "answer_id": 55014665, "question_id": 53385661, "link": "https://stackoverflow.com/questions/53385661/istanbul-tools-installation-error-github-com-ethereum-go-ethereum-crypto-bn256/55014665#55014665", "title": "Istanbul-tools installation error: github.com/ethereum/go-ethereum/crypto/bn256/cloudflare.gfpMul: relocation target runtime.support_bmi2 not defined", "body": "<p>I had this exact issue, the issue has to do with your Ethereum/Istanbul Versions.  You either need to make sure everything is upgraded all the way, or downgrade Go.  I downgraded my go version to 1.10.3 and it worked.  </p>\n\n<p>Can you be provide more details on the specific Cloudflare file you are looking for?  There is a folder for Cloudflare within crypto/bn256 (full path is go-ethereum(or project name)/crypto/bn256/cloudflare) in the Main Ethereum project, I would check there for Istanbul.</p>\n"}], "owner": {"reputation": 103, "user_id": 8757299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afde16d596aca895a1878038e104102?s=128&d=identicon&r=PG&f=1", "display_name": "Yanzal", "link": "https://stackoverflow.com/users/8757299/yanzal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552329773, "creation_date": 1542683465, "last_edit_date": 1552329773, "question_id": 53385661, "link": "https://stackoverflow.com/questions/53385661/istanbul-tools-installation-error-github-com-ethereum-go-ethereum-crypto-bn256", "title": "Istanbul-tools installation error: github.com/ethereum/go-ethereum/crypto/bn256/cloudflare.gfpMul: relocation target runtime.support_bmi2 not defined", "body": "<p>I am trying to install Istanbul-tools to run an IBFT ethereum network as shown in this tutorial here <a href=\"https://medium.com/getamis/istanbul-bft-ibft-c2758b7fe6ff\" rel=\"nofollow noreferrer\">https://medium.com/getamis/istanbul-bft-ibft-c2758b7fe6ff</a></p>\n\n<p>I am installing istanbul-tools via their makefile using</p>\n\n<pre><code>go build -v -o ./build/bin/istanbul ./cmd/istanbul\n</code></pre>\n\n<p>After fixing some initial issues, as the code base hasn't been updated in a year, I then received the following error:</p>\n\n<pre><code>github.com/ethereum/go-ethereum/crypto/bn256/cloudflare.gfpMul: relocation target runtime.support_bmi2 not defined\n</code></pre>\n\n<p>I also cannot find the Cloudflare file in any location in the go-ethereum folder. Can someone point me in the right direction? Cheers!</p>\n"}, {"tags": ["go", "networking", "ipv6"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1542683759, "post_id": 53385626, "comment_id": 93647199, "body": "You get all of them. And it probably <i>does not</i> make sense to take one IP address per subnet, but you also haven&#39;t described what you&#39;re thinking about doing."}, {"owner": {"reputation": 46, "user_id": 10039525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a201bdeb94a877c8ac552bfcab945eb3?s=128&d=identicon&r=PG&f=1", "display_name": "bad", "link": "https://stackoverflow.com/users/10039525/bad"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1542684200, "post_id": 53385626, "comment_id": 93647269, "body": "@MichaelHampton Am aware it seems counter intuitive, but hypothetically. Maybe a better question would be: How should I separate the ips into their respective subnets."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 1, "creation_date": 1542684389, "post_id": 53385626, "comment_id": 93647292, "body": "There&#39;s only one way to do that. You should definitely study the basics of IPv6 before you go any farther."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1542697086, "post_id": 53385626, "comment_id": 93650860, "body": "A /56 subnet consists of 2^(128-56) = 2^72 = 4.7e21 addresses. You cannot compute that slice before the sun burns out. To compute the first and last address of the subnet, set the trailing 56 bits of any address within the subnet to zero or one, respectively."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1542697564, "post_id": 53385626, "comment_id": 93651040, "body": "Oops, trailing 72 bits, not 56."}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 10039525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a201bdeb94a877c8ac552bfcab945eb3?s=128&d=identicon&r=PG&f=1", "display_name": "bad", "link": "https://stackoverflow.com/users/10039525/bad"}, "edited": false, "score": 0, "creation_date": 1542743168, "post_id": 53388616, "comment_id": 93675991, "body": "Thank you Peter, I really appreciate the help. This stems from my lack ofo knowledge in ipv6, but how would I transform a subnet into a random ip from within it. Say for example: 2001:db8:0:3::/64, an address from within it might look like: 2001:db8:0:3::xxxx?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 46, "user_id": 10039525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a201bdeb94a877c8ac552bfcab945eb3?s=128&d=identicon&r=PG&f=1", "display_name": "bad", "link": "https://stackoverflow.com/users/10039525/bad"}, "edited": false, "score": 0, "creation_date": 1542790432, "post_id": 53388616, "comment_id": 93691442, "body": "You take 2001:db8:0:3::, leave the top 64 bits as they are, and set the remaining bits to any value you&#39;d like. Note that this is not specific to IPv6; You simply <a href=\"https://en.wikipedia.org/wiki/Subnetwork#Determining_the_network_prefix\" rel=\"nofollow noreferrer\">apply a bitmask</a> to the address (the subnet mask).  The same applies to IPv4. For instance, to pick an address from 192.168.0.0/24, leave the top 24 bits as they are, and set the remaining 8 bits to any value you&#39;d like."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1542701041, "creation_date": 1542701041, "answer_id": 53388616, "question_id": 53385626, "link": "https://stackoverflow.com/questions/53385626/how-to-find-range-prefix-of-ipv6-addresses-that-a-machine-can-use-and-how-to/53388616#53388616", "title": "How to find range (prefix?) of ipv6 addresses that a machine can use, and how to transform a subnet of ipv6 into a slice of ip addresses?", "body": "<p>DNS is not very helpful in determining the local IP addresses, because a DNS entry is not required to make an IP address work, nor is it required to point to (only) the machine that you happen to run your program on.</p>\n\n<p>Instead, inspect the network interfaces and their configuration:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"os\"\n    \"text/tabwriter\"\n)\n\nfunc main() {\n    tw := tabwriter.NewWriter(os.Stdout, 0, 0, 1, ' ', 0)\n\n    ifaces, err := net.Interfaces()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, iface := range ifaces {\n        addrs, err := iface.Addrs()\n        if err != nil {\n            log.Fatal(err)\n        }\n        for _, addr := range addrs {\n            addr, ok := addr.(*net.IPNet)\n            if !ok {\n                // Not an IP interface\n                continue\n            }\n            if addr.IP.To4() != nil {\n                // Skip IPv4 addresses\n                continue\n            }\n\n            fmt.Fprintf(tw, \"%s\\t%s\\t%s\\t%s\\n\", \n                iface.Name, addr.String(), addr.IP, addr.Mask)\n        }\n    }\n    tw.Flush()\n}\n</code></pre>\n\n<p>For my local machine the output is:</p>\n\n<pre><code>lo          ::1/128                      ::1                       ffffffffffffffffffffffffffffffff\nenp2s0      fe80::52e5:49ff:fe3b:107a/64 fe80::52e5:49ff:fe3b:107a ffffffffffffffff0000000000000000\ndocker0     fe80::42:afff:fedb:7389/64   fe80::42:afff:fedb:7389   ffffffffffffffff0000000000000000\ntun0        fe80::f22c:2d3b:a5a0:1b61/64 fe80::f22c:2d3b:a5a0:1b61 ffffffffffffffff0000000000000000\nvethd176f0c fe80::1cc1:65ff:fe39:feff/64 fe80::1cc1:65ff:fe39:feff ffffffffffffffff0000000000000000\n</code></pre>\n\n<p>Note that these addresses are not necessarily reachable from the Internet. This all depends on how the routing of the hoster works. In any kind of cloud setup, you are almost always better off querying the providers APIs.</p>\n\n<hr>\n\n<p>To list all /64 subnets in a particular /56 subnet, you have to leave the 56 upper bits of the subnet address as they are and permute the following 64-56 = 8 bits (which happens to be the eigth byte):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    _, subnet, _ := net.ParseCIDR(\"2001:db8::/56\")\n    fmt.Println(subnet)\n\n    subnet.Mask = net.CIDRMask(64, 128) // change mask to /64\n\n    for i := 0; i &lt;= 0xff; i++ {\n        subnet.IP[7] = byte(i) // permute the 8th byte\n        fmt.Println(\"\\t\", subnet)\n    }\n\n    // Output:\n    // 2001:db8::/56\n    //          2001:db8::/64\n    //          2001:db8:0:1::/64\n    //          2001:db8:0:2::/64\n    //          2001:db8:0:3::/64\n    //          2001:db8:0:4::/64\n    //          2001:db8:0:5::/64\n    //          2001:db8:0:6::/64\n    //          2001:db8:0:7::/64\n    //          2001:db8:0:8::/64\n    // [...]\n}\n</code></pre>\n"}], "owner": {"reputation": 46, "user_id": 10039525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a201bdeb94a877c8ac552bfcab945eb3?s=128&d=identicon&r=PG&f=1", "display_name": "bad", "link": "https://stackoverflow.com/users/10039525/bad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542701107, "creation_date": 1542683140, "last_edit_date": 1542701107, "question_id": 53385626, "link": "https://stackoverflow.com/questions/53385626/how-to-find-range-prefix-of-ipv6-addresses-that-a-machine-can-use-and-how-to", "title": "How to find range (prefix?) of ipv6 addresses that a machine can use, and how to transform a subnet of ipv6 into a slice of ip addresses?", "body": "<p>There are many things I don't understand about ipv6 and networking in general, which is why I need some further clarification on some the answers already posted to other questions. I'll list my questions, what I grasped from other answers, and what I'm still confused about. </p>\n\n<ol>\n<li><p>Say I have a VPS with a /56 ipv6 subnet (256 * residential /64 subnets) allotted to it. How can I programmatically find the range (prefix?) of the ip's I \"own\".\n<a href=\"https://stackoverflow.com/questions/11411486/how-to-get-ipv4-and-ipv6-address-of-local-machine\">How to get IPv4 and IPv6 address of local machine?</a>. This is the answer I saw for this question: and what I think I understand is that I get the DNS hostname for the machine, then look up that same hostname to find the range. I'm wondering two things: How do I do this in Go, and  </p></li>\n<li><p>How do I transfer this range ^ into a slice (array) of ipv6  addresses. For this specific use case: the ideal solution would be to only get <em>one</em> ipv6 address per \\64 subnet, resulting in 256 seperate ips</p></li>\n</ol>\n"}, {"tags": ["json", "go", "marshalling", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542677893, "creation_date": 1542677893, "answer_id": 53385040, "question_id": 53384835, "link": "https://stackoverflow.com/questions/53384835/unmarshal-nested-json-into-flat-struct-in-go/53385040#53385040", "title": "Unmarshal nested JSON into flat struct in Go", "body": "<p>I think you need create an other <code>Address</code> struct.</p>\n\n<pre><code>type Address struct {\n    City     string `json:\"city\"`\n    Province string `json:\"province\"`\n}\n\ntype User struct {\n    ID      string  `json:\"id\"`\n    Name    string  `json:\"name\"`\n    Age     uint    `json:\"age\"`\n    Address Address `json:\"address\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 700, "user_id": 6940117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/us57e.png?s=128&g=1", "display_name": "Slotheroo", "link": "https://stackoverflow.com/users/6940117/slotheroo"}, "is_accepted": false, "score": 0, "last_activity_date": 1542678802, "creation_date": 1542678802, "answer_id": 53385137, "question_id": 53384835, "link": "https://stackoverflow.com/questions/53384835/unmarshal-nested-json-into-flat-struct-in-go/53385137#53385137", "title": "Unmarshal nested JSON into flat struct in Go", "body": "<p>You could make a temporary struct type to dump that data into that matches the format you expect. e.g.</p>\n\n<pre><code>type userData struct {\n    ID          string\n    Name        string\n    Age         uint\n    address     map[string]string\n}\n</code></pre>\n\n<p>Although my favorite thing to do is to just dump all of the json into a map with string keys and json.RawMessage as values. This will allow you to unmarshal all of the json into this map, and then unmarshal each individual field however you would want.</p>\n\n<pre><code>var allData map[string]json.RawMessage\nvar user User{}\n//Assuming we first get our json from a request, otherwise use json.Unmarshal(jsonData, &amp;allData)\nerr := json.NewDecoder(r.Body).Decode(&amp;allData)\nif err != nil {\n    //handle\n}\nerr = json.Unmarshal(allData[\"ID\"], &amp;c.ID)\nif err != nil {\n    //handle\n}\nvar addressMap map[string]string\nerr = json.Unmarshal(allData[\"address\"], addressMap)\nif err != nil {\n    //handle\n}\nc.City = addressMap[\"city\"]\nc.Province = addressMap[\"province\"]\n</code></pre>\n\n<p>I haven't tested any of that code, so it may be error ridden, but it's just meant to convey the idea of converting all of the data into a map of json.RawMessage values and then unmarshalling each property. Normally you'd have a lot more error checking to see if values exist, etc. It's more work, for sure, but it's incredibly flexible and gives you a lot of visibility and power into how the data is handled as opposed to just unmarshalling into a struct and hoping the magic works.</p>\n"}, {"comments": [{"owner": {"reputation": 432, "user_id": 6340231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mHxBsfkZqiQ/AAAAAAAAAAI/AAAAAAAAAtU/ToLwyfBT1HM/photo.jpg?sz=128", "display_name": "Abhay Kumar", "link": "https://stackoverflow.com/users/6340231/abhay-kumar"}, "edited": false, "score": 0, "creation_date": 1542691711, "post_id": 53385846, "comment_id": 93649089, "body": "Here is the Go-playground example what @Ehsan.Saradar explained: <a href=\"https://play.golang.org/p/Bn_zAsF75JV\" rel=\"nofollow noreferrer\">play.golang.org/p/Bn_zAsF75JV</a>"}, {"owner": {"reputation": 1035, "user_id": 8685016, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W693VKuEKv0/AAAAAAAAAAI/AAAAAAAAABM/v4pY2Z8NYB4/photo.jpg?sz=128", "display_name": "robbieperry22", "link": "https://stackoverflow.com/users/8685016/robbieperry22"}, "edited": false, "score": 0, "creation_date": 1542735297, "post_id": 53385846, "comment_id": 93672163, "body": "Thanks for the note. Unfortunately this won&#39;t work for me, as I need to be able to do it for any arbitrary data structure, and only flatten fields defined in the struct as <code>json:&quot;something.something&quot;</code>."}], "tags": [], "owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "is_accepted": false, "score": 2, "last_activity_date": 1542684960, "creation_date": 1542684960, "answer_id": 53385846, "question_id": 53384835, "link": "https://stackoverflow.com/questions/53384835/unmarshal-nested-json-into-flat-struct-in-go/53385846#53385846", "title": "Unmarshal nested JSON into flat struct in Go", "body": "<p>Create userInfo class </p>\n\n<pre><code>type UserInfo struct {\n    ID      string `json:\"ID\"`\n    Name    string `json:\"Name\"`\n    Age     int    `json:\"Age\"`\n    Address struct {\n        City     string `json:\"city\"`\n        Province string `json:\"province\"`\n    } `json:\"address\"`\n}\n</code></pre>\n\n<p>Then unmarshal your json data into a userinfo object</p>\n\n<pre><code>var userInfo UserInfo\n    jsonStr := `{\n    \"ID\": \"1\",\n    \"Name\": \"Keith Baldwin\",\n    \"Age\": 30,\n    \"address\": {\n        \"city\": \"Saskatoon\",\n        \"province\": \"Saskatchewan\"\n    }\n}`\njson.Unmarshal([]byte(jsonStr), &amp;userInfo)\n</code></pre>\n"}], "owner": {"reputation": 1035, "user_id": 8685016, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W693VKuEKv0/AAAAAAAAAAI/AAAAAAAAABM/v4pY2Z8NYB4/photo.jpg?sz=128", "display_name": "robbieperry22", "link": "https://stackoverflow.com/users/8685016/robbieperry22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3256, "favorite_count": 0, "closed_date": 1542693347, "answer_count": 3, "score": 0, "last_activity_date": 1542684960, "creation_date": 1542676227, "question_id": 53384835, "link": "https://stackoverflow.com/questions/53384835/unmarshal-nested-json-into-flat-struct-in-go", "closed_reason": "Duplicate", "title": "Unmarshal nested JSON into flat struct in Go", "body": "<p>Suppose I define a struct as following: </p>\n\n<pre><code>type User struct {\n    ID          string\n    Name        string\n    Age         uint\n    City        string      `json:\"address.city\"`\n    Province    string      `json:\"address.province\"`\n}\n</code></pre>\n\n<p>I am able to take a User struct, and expand out the flattened fiends into a nested JSON structure, with an address object. I'm struggling however to go in the other direction.</p>\n\n<p>How would I take the following JSON:</p>\n\n<pre><code>{\n    \"ID\": \"1\",\n    \"Name\": \"Keith Baldwin\",\n    \"Age\": 30,\n    \"address\": {\n        \"city\": \"Saskatoon\",\n        \"province\": \"Saskatchewan\"\n    }\n}\n</code></pre>\n\n<p>And unmarshal it into the given struct?</p>\n\n<p>Is there something I'm missing, or will I just have to write it from scratch, probably using reflection? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["javascript", "html", "arrays", "angularjs", "go"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 1, "creation_date": 1542673819, "post_id": 53384331, "comment_id": 93645089, "body": "You should check for <code>error</code> value returned from <code>r.ParseForm()</code> and use <code>r.PostFormValue()</code> instead."}, {"owner": {"reputation": 700, "user_id": 6940117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/us57e.png?s=128&g=1", "display_name": "Slotheroo", "link": "https://stackoverflow.com/users/6940117/slotheroo"}, "edited": false, "score": 2, "creation_date": 1542673924, "post_id": 53384331, "comment_id": 93645111, "body": "Also note that r.PostFormValue() would be for a PUT, PATCH, or POST. You&#39;re sending an http GET method, which is not expended to send any data."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1542675775, "post_id": 53384331, "comment_id": 93645470, "body": "How are you sending request data to Go in the first place? The javascript code only send GET request with no data."}], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": true, "score": 1, "last_activity_date": 1542680195, "creation_date": 1542680195, "answer_id": 53385284, "question_id": 53384331, "link": "https://stackoverflow.com/questions/53384331/store-username-in-array-from-login-to-server/53385284#53385284", "title": "Store username in array from login to server", "body": "<p>The first, I can see that you send <code>GET</code> request to server without <code>j_username</code> query param therefore you can not read <code>j_username</code> on server side. </p>\n\n<p>The second, <code>usernameArray</code> is empty slice which is failing while parse <code>j_username</code>. Error <code>index out of range</code> occur when you try to call <code>usernameArray[0]</code>.</p>\n\n<p>You should send <code>GET</code> request with <code>j_username</code> like that <code>/getAuth?j_username=admin</code> and modify code from server.</p>\n\n<pre><code>    usernameArray, hasUsername := r.URL.Query()[\"j_username\"]\n    //This line added for debugging purposes\n    log.Println(\"debug here :\", usernameArray)\n\n    if hasUsername {\n        fmt.Fprintf(w, \"%s\", usernameArray[0])\n        return\n    }\n\n    // Send an error message to client\n    http.Error(w, `missing username`, 500)\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 5988165, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/05aa042ad0f1c6d6de7af447611da1c9?s=128&d=identicon&r=PG&f=1", "display_name": "WitchKing17", "link": "https://stackoverflow.com/users/5988165/witchking17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53385284, "answer_count": 1, "score": 0, "last_activity_date": 1542700313, "creation_date": 1542671773, "last_edit_date": 1542700313, "question_id": 53384331, "link": "https://stackoverflow.com/questions/53384331/store-username-in-array-from-login-to-server", "title": "Store username in array from login to server", "body": "<p>I have a small Go web-server that displays data to users as they login. The problem I'm trying to achieve is to have the web-page only show certain information when a specific user logs in. For example, when admin logs in there would be a list of admin-only items that they can see on the web-page.</p>\n\n<p>The problem I'm having is for some reason my Go code isn't storing the username in the array that I'm calling, so when I pass it over to the JavaScript it is blank. </p>\n\n<p>Here are the 3 main parts of the code that I'm struggling with:</p>\n\n<p><code>main.go</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc authHandler(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    usernameArray, hasUsername := r.PostForm[\"j_username\"]\n\n    //This line added for debugging purposes\n    log.Println(\"username:\", usernameArray[0])\n\n    if hasUsername {\n        fmt.Fprintf(w, \"%s\", usernameArray[0])\n    }\n}\n\nfunc main() {\n    http.HandleFunc(\"/getAuth\", authHandler)\n}\n</code></pre>\n\n<hr>\n\n<p><code>javascript.js</code></p>\n\n<p>Note that this is AngularJS</p>\n\n<pre><code>$scope.init = function() {\n    checkAuthentication();\n};\n\ncheckAuthentication = function() {\n    $http.get(\"/getAuth\").then(\n    function(response) {\n        var username = response.data;\n\n        console.log(username): //Added for debugging purposes\n\n        if (username === \"admin\") {\n            $scope.showAdminOnlyItems = true;\n        }\n    });\n}\n</code></pre>\n\n<hr>\n\n<p><code>main.html</code></p>\n\n<pre><code>&lt;div id=\"admin-only-items\" ng-show=\"showAdminOnlyItems\"&gt;\n    &lt;hr style=\"border:1px solid\"&gt;\n    &lt;p style=\"text-align: center\"&gt;admin only: &lt;/p&gt;\n    &lt;div id=\"adminOnlyButtom\"&gt;\n        &lt;button class=\"button\" data-ng-click=\"doSomething()\"&gt;Do something&lt;/button&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Again, I only want that div to show up when admin logs in, and Go needs to send the username over to the javascript to verify that. By adding the debugging line in Go and starting the server up, I get this:</p>\n\n<pre><code>2018/11/19 16:28:42 http: panic serving 10.240.49.238:59621: runtime error: \nindex out of range\ngoroutine 26 [running]:\nnet/http.(*conn).serve.func1(0xc42009f720)\n        C:/Go/src/net/http/server.go:1726 +0xd0\npanic(0x79f820, 0xe17940)\n        C:/Go/src/runtime/panic.go:502 +0x229\nmain.authHandler(0xc56220, 0xc420135180, 0xc4207a3500)\n        D:/src/main.go:346 +0x1d8\n</code></pre>\n\n<p>So it's clear that the usernameArray is empty, not sure what I did wrong. Can anyone help tell me why the usernameArray is empty in authHandler?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542732136, "post_id": 53384167, "comment_id": 93670405, "body": "Took a second look after your comment to zerkms a few minutes ago. There is more going on here than what it seems. For some reason, even a <code>uint8</code> is not assignable to a <code>Word</code> (and vice versa). <a href=\"https://play.golang.org/p/BrU8mz4ZdUh\" rel=\"nofollow noreferrer\">play.golang.org/p/BrU8mz4ZdUh</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542733715, "post_id": 53384167, "comment_id": 93671330, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22948349/assignability-of-function-parameters-in-golang\">Assignability of function parameters in golang</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542733744, "post_id": 53384167, "comment_id": 93671350, "body": "Discovered the subtlety :)"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542734260, "post_id": 53384167, "comment_id": 93671615, "body": "This seems to go into quite a bit of detail. <a href=\"https://go101.org/article/value-conversions-assignments-and-comparisons.html\" rel=\"nofollow noreferrer\">go101.org/article/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1542670968, "post_id": 53384214, "comment_id": 93644412, "body": "Explained in the spec, but it&#39;s useful to note for this specific instance, cutting out <code>Word</code> and just using <code>[]uint8</code> makes them assignable."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542671506, "post_id": 53384214, "comment_id": 93644579, "body": "My comment (which could have been better) was to illustrate that this is a case of <code>a = b</code> and <code>b = c</code> but with Go assignability of types, that doesn&#39;t mean <code>a = c</code>."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1542672305, "post_id": 53384214, "comment_id": 93644763, "body": "@RayfenWindspear it&#39;s probably even a bit more complicated because of covariance (lack of it)"}, {"owner": {"reputation": 508, "user_id": 1917126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/spNM3.jpg?s=128&g=1", "display_name": "Mart&#237;n Straus", "link": "https://stackoverflow.com/users/1917126/mart%c3%adn-straus"}, "edited": false, "score": 0, "creation_date": 1542730460, "post_id": 53384214, "comment_id": 93669550, "body": "I read the assignability rules before posting, but I can&#39;t figure out why in that specific case <code>[]uint8</code> is not equal to <code>[]Word</code>. Plus, I specifically asked &quot;Why&quot;, not &quot;how to fix&quot;. Thus, your answer isn&#39;t enought."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 508, "user_id": 1917126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/spNM3.jpg?s=128&g=1", "display_name": "Mart&#237;n Straus", "link": "https://stackoverflow.com/users/1917126/mart%c3%adn-straus"}, "edited": false, "score": 0, "creation_date": 1542743369, "post_id": 53384214, "comment_id": 93676096, "body": "@Mart&#237;nStraus I&#39;ve run through the assignability rules for better clarity"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": false, "score": 0, "last_activity_date": 1542743304, "last_edit_date": 1542743304, "creation_date": 1542670809, "answer_id": 53384214, "question_id": 53384167, "link": "https://stackoverflow.com/questions/53384167/assigning-slices-of-equivalent-types-doesnt-work/53384214#53384214", "title": "Assigning slices of equivalent types doesn&#39;t work", "body": "<p>Here are the <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability rules</a></p>\n\n<p>In this particular case none of those is held, so the types are not assignable.</p>\n\n<p>Given you mentioned this answer is not detailed enough - let's run through every assignability rule: (for ease let's use <code>A</code> as a substitute for <code>[]uint8</code> and <code>B</code> as a substitute for <code>[]Word</code>)</p>\n\n<ul>\n<li>x's type is identical to T. --- Nope, <code>A</code> is not identical to <code>B</code></li>\n<li>x's type V and T have identical underlying types and at least one of V or T is not a defined type. --- Nope, both are defined types</li>\n<li>T is an interface type and x implements T. --- None of them is an interface</li>\n<li>x is a bidirectional channel value, T is a channel type, x's type V and T have identical element types, and at least one of V or T is not a defined type. --- None of them is a channel</li>\n<li>x is the predeclared identifier nil and T is a pointer, function, slice, map, channel, or interface type. --- None of them holds <code>nil</code> value</li>\n<li>x is an untyped constant representable by a value of type T. --- Nope, no constants involved</li>\n</ul>\n\n<p>So, as you can see - there is no way <code>A</code> is assignable to <code>B</code>.</p>\n\n<p>If you declare Memory as <code>type Memory []uint8</code> it would work (as <a href=\"https://stackoverflow.com/users/1276480/rayfenwindspear\">@RayfenWindspear</a> mentioned in the comments), I'm sure though the question roots is more \"why\" not \"how to fix\".</p>\n"}], "owner": {"reputation": 508, "user_id": 1917126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/spNM3.jpg?s=128&g=1", "display_name": "Mart&#237;n Straus", "link": "https://stackoverflow.com/users/1917126/mart%c3%adn-straus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1542743304, "creation_date": 1542670410, "last_edit_date": 1542730816, "question_id": 53384167, "link": "https://stackoverflow.com/questions/53384167/assigning-slices-of-equivalent-types-doesnt-work", "title": "Assigning slices of equivalent types doesn&#39;t work", "body": "<p>Why doesn't this work?</p>\n\n<pre><code>package main\n\ntype Word uint8\ntype Memory []Word\n\nfunc main() {\n    bytes := []uint8{}\n    memory := Memory{}\n    bytes = memory\n}\n</code></pre>\n\n<p>The compiler generates this error:</p>\n\n<pre><code>9:9: cannot use memory (type Memory) as type []byte in assignment\n</code></pre>\n\n<p>As I understand it, <code>[]uint8</code> and <code>Memory</code> should be mutually assignable.</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1542666467, "post_id": 53383372, "comment_id": 93643047, "body": "Return the slice at the end of the recursion or pass it and assign by reference. When the recursion ends, you are still left with the original slice header you started with, despited the underlying array actually having the data."}, {"owner": {"reputation": 2787, "user_id": 32424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90a8a20afaebfaab4be2b09cc522ca4f?s=128&d=identicon&r=PG", "display_name": "Marcote", "link": "https://stackoverflow.com/users/32424/marcote"}, "edited": false, "score": 0, "creation_date": 1542666870, "post_id": 53383372, "comment_id": 93643205, "body": "Sorry ppl, not following completely. Anyone willing to update my code? I&#39;ll accept the answer ;)"}], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1542667988, "post_id": 53383656, "comment_id": 93643577, "body": "After all that, I probably should have just marked it as a duplicate of the many slice header copy issues people have posted..."}, {"owner": {"reputation": 2787, "user_id": 32424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90a8a20afaebfaab4be2b09cc522ca4f?s=128&d=identicon&r=PG", "display_name": "Marcote", "link": "https://stackoverflow.com/users/32424/marcote"}, "edited": false, "score": 0, "creation_date": 1542731429, "post_id": 53383656, "comment_id": 93670044, "body": "If it&#39;s a duplicate, why don&#39;t point me to the duplicate question with is answer? It&#39;s somewhat pedantic your behavior specially when I&#39;m learning a new language.  Empathy -1"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2787, "user_id": 32424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90a8a20afaebfaab4be2b09cc522ca4f?s=128&d=identicon&r=PG", "display_name": "Marcote", "link": "https://stackoverflow.com/users/32424/marcote"}, "edited": false, "score": 0, "creation_date": 1542731569, "post_id": 53383656, "comment_id": 93670110, "body": "@Marcote Because the duplicate would only explain what is happening with the slice headers, not what is missing from your recursion. Going over both is more useful to you."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2787, "user_id": 32424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90a8a20afaebfaab4be2b09cc522ca4f?s=128&d=identicon&r=PG", "display_name": "Marcote", "link": "https://stackoverflow.com/users/32424/marcote"}, "edited": false, "score": 0, "creation_date": 1542827511, "post_id": 53383656, "comment_id": 93712239, "body": "@Marcote I hadn&#39;t noticed the term &quot;pedantic&quot; in your comment until I re-read it just now. Not that I disagree, but one thing you&#39;ll find with Go specifically, is that the language itself is minimalistic by design and that the language specification is <i>actually</i> human readable (<a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">golang.org/ref/spec</a>) and the documentation is so superb. As a result of this, you&#39;ll find <i>many</i> Q/A on SO and many of us answering will seem apathetic at times, and many answers simply refer to the spec or documentation. It&#39;s nothing personal, it&#39;s just a quirk with the language, and thus its community."}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 1, "last_activity_date": 1542669984, "last_edit_date": 1542669984, "creation_date": 1542667087, "answer_id": 53383656, "question_id": 53383372, "link": "https://stackoverflow.com/questions/53383372/problem-accumulating-appending-values-in-an-array-using-recursion-with-go/53383656#53383656", "title": "Problem accumulating/appending values in an array using recursion with Go", "body": "<p>The confusion lies in the way a <code>slice</code> is handled in Go. <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Here</a> is the in-depth explanation, but I will abbreviate.</p>\n\n<p>The common misconception is that the <code>slice</code> you pass around is a <em>reference</em> to the <code>slice</code>, which is false. The actual variable you operate on when you handle a slice is known as a <em>slice header</em>. This is a simple <code>struct</code> with a <em>reference</em> to the underlying array under the covers and follows Go's <em>pass by value</em> rules, i.e. it is <em>copied</em> when passed to a function. Thus, if it is not returned, you won't have the updated header.</p>\n\n<p>Returning data from recursion follows a straightforward pattern. Here is a basic example. I'm also including a version that doesn't require a return, but operates on the slice as a reference, which will modify the original. (Note: Passing around slice pointers is generally not considered idiomatic Go)</p>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/v5XeYpH1VlF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/v5XeYpH1VlF</a></p>\n\n<pre><code>// correct way to return from recursion\nfunc addReturn(s []int) []int {\n    if finalCondition(s) {\n        return s\n    }\n    s = append(s, 1)\n    return addReturn(s)\n}\n\n// using a reference\nfunc addReference(s *[]int) {\n    if finalCondition(*s) {\n        return\n    }\n    *s = append(*s, 1)\n    addReference(s)\n}\n\n// whatever terminates the recursion\nfunc finalCondition(s []int) bool {\n    if len(s) &gt;= 10 {\n        return true\n    }\n    return false\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 700, "user_id": 6940117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/us57e.png?s=128&g=1", "display_name": "Slotheroo", "link": "https://stackoverflow.com/users/6940117/slotheroo"}, "is_accepted": true, "score": 1, "last_activity_date": 1542671587, "creation_date": 1542671587, "answer_id": 53384315, "question_id": 53383372, "link": "https://stackoverflow.com/questions/53383372/problem-accumulating-appending-values-in-an-array-using-recursion-with-go/53384315#53384315", "title": "Problem accumulating/appending values in an array using recursion with Go", "body": "<p>I'm guessing that all of your project objects are scoped to the function so they no longer exist when the function ends. I don't think you need your projects to exist before you call innerRequest, so you should probably just have that method return the projects. I think something like this should work...</p>\n\n<pre><code>func innerRequest(client *http.Client, URL string) []*ProjectsResponse {\n\nif URL == \"\" {\n    return nil\n}\n\n//More code...\n\npagingData := getPageInformation(res)\nreturn append([]*ProjectsResponse{&amp;response}, innerRequest(client, pagingData.NextLink)...)\n}\n</code></pre>\n"}], "owner": {"reputation": 2787, "user_id": 32424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90a8a20afaebfaab4be2b09cc522ca4f?s=128&d=identicon&r=PG", "display_name": "Marcote", "link": "https://stackoverflow.com/users/32424/marcote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 53384315, "answer_count": 2, "score": -1, "last_activity_date": 1542671587, "creation_date": 1542665456, "last_edit_date": 1542666505, "question_id": 53383372, "link": "https://stackoverflow.com/questions/53383372/problem-accumulating-appending-values-in-an-array-using-recursion-with-go", "title": "Problem accumulating/appending values in an array using recursion with Go", "body": "<p>First of all, this is my first non-dummy program using Go. Any recommendation will be appreciated.</p>\n\n<p>Code description:</p>\n\n<p>I want to retrieve all the information from an API where the information is being paginated. So I want to iterate through all the pages in order to get all the information.</p>\n\n<p>This is what I did so far:</p>\n\n<p>I have the these two functions:</p>\n\n<pre><code>func request(requestData *RequestData) []*ProjectsResponse {\n\n    client := &amp;http.Client{\n        Timeout: time.Second * 10,\n    }\n\n    projects := []*ProjectsResponse{}\n    innerRequest(client, requestData.URL, projects)\n\n    return projects\n}\n\nfunc innerRequest(client *http.Client, URL string, projects []*ProjectsResponse) {\n\n    if URL == \"\" {\n        return\n    }\n\n    req, err := http.NewRequest(\"GET\", URL, nil)\n    if err != nil {\n        log.Printf(\"Request creation failed with error %s\\n\", err)\n    }\n    req.Header.Add(\"Private-Token\", os.Getenv(\"API_KEY\"))\n\n    res, err := client.Do(req)\n    log.Printf(\"Executing request: %s\", req.URL)\n\n    if err != nil {\n        log.Printf(\"The HTTP request failed with error %s\\n\", err)\n    }\n    data, _ := ioutil.ReadAll(res.Body)\n    var response ProjectsResponse\n    err = json.Unmarshal(data, &amp;response)\n\n    if err != nil {\n        log.Printf(\"Unmarshalling failed with error %s\\n\", err)\n    }\n\n    projects = append(projects, &amp;response)\n    pagingData := getPageInformation(res)\n    innerRequest(client, pagingData.NextLink, projects)\n}\n</code></pre>\n\n<p>Undesired behavior:</p>\n\n<p>The values in the <code>projects []*ProjectsResponse</code> array are being appended on each iteration of the recursion, but when the recursion ends I get an empty array list. So, somehow after the <code>innerRequests</code> ends, in the <code>project</code> variable inside the <code>request</code> method I get nothing.</p>\n\n<p>Hope somebody and spot my mistake.\nThanks in advance. </p>\n"}, {"tags": ["go", "aws-codebuild"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1542704390, "post_id": 53382185, "comment_id": 93654185, "body": "Can you please show how do you import your packages in the code?"}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 0, "creation_date": 1542705991, "post_id": 53382185, "comment_id": 93655141, "body": "Not expert on CodeBuild, but had similar issues with other AWS build system for go. I believe if you just vendor your dependencies into /go/src/company/app/vendor sub-directory, it should solve your issue."}, {"owner": {"reputation": 581, "user_id": 3341148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x77dO.jpg?s=128&g=1", "display_name": "ajl", "link": "https://stackoverflow.com/users/3341148/ajl"}, "edited": false, "score": 0, "creation_date": 1542729913, "post_id": 53382185, "comment_id": 93669266, "body": "Thanks, but if I understand you correctly, our own subpackages are already so vendor&#39;ed, but are not found because the code is actually brought into (to put it in your terms)  /go/src/&lt;some path&gt;/company/app/vendor. So, when go looks in /go/src/app/vendor it is not found."}], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 1874976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390c7c94c1f7b4d99af301a3f6feb6eb?s=128&d=identicon&r=PG", "display_name": "Bryan Cox", "link": "https://stackoverflow.com/users/1874976/bryan-cox"}, "edited": false, "score": 0, "creation_date": 1552350778, "post_id": 53398074, "comment_id": 96967304, "body": "Having the same problem. Is this still the solution you&#39;re using, or did you find something more long-term sustainable?"}, {"owner": {"reputation": 581, "user_id": 3341148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x77dO.jpg?s=128&g=1", "display_name": "ajl", "link": "https://stackoverflow.com/users/3341148/ajl"}, "reply_to_user": {"reputation": 178, "user_id": 1874976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390c7c94c1f7b4d99af301a3f6feb6eb?s=128&d=identicon&r=PG", "display_name": "Bryan Cox", "link": "https://stackoverflow.com/users/1874976/bryan-cox"}, "edited": false, "score": 0, "creation_date": 1552392348, "post_id": 53398074, "comment_id": 96983594, "body": "We are still using this."}, {"owner": {"reputation": 1208, "user_id": 5246655, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153185527849891/picture?type=large", "display_name": "amwill04", "link": "https://stackoverflow.com/users/5246655/amwill04"}, "edited": false, "score": 1, "creation_date": 1564402159, "post_id": 53398074, "comment_id": 101006829, "body": "Just got anyone coming across this answer I needed to put <code>GO111MODULE=on</code> in front of <code>go build</code>. I think this is due to the fact you are running the command inside <code>GOPATH</code> and it therefore turns off modules."}, {"owner": {"reputation": 581, "user_id": 3341148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x77dO.jpg?s=128&g=1", "display_name": "ajl", "link": "https://stackoverflow.com/users/3341148/ajl"}, "edited": false, "score": 0, "creation_date": 1564493638, "post_id": 53398074, "comment_id": 101043848, "body": "Great point! Answer updated to include these bits I omitted. Thanks!"}], "tags": [], "owner": {"reputation": 581, "user_id": 3341148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x77dO.jpg?s=128&g=1", "display_name": "ajl", "link": "https://stackoverflow.com/users/3341148/ajl"}, "is_accepted": true, "score": 3, "last_activity_date": 1564493314, "last_edit_date": 1564493314, "creation_date": 1542733743, "answer_id": 53398074, "question_id": 53382185, "link": "https://stackoverflow.com/questions/53382185/aws-codebuild-fails-for-golang-source-with-sub-packages/53398074#53398074", "title": "AWS CodeBuild fails for golang source with sub-packages", "body": "<p>See <strong>Update</strong> below for a complete answer if you are on golang 1.11 or higher... We no longer use my initial work around.</p>\n\n<p>I was able to get <em>an</em> answer working. I'll post it here in case it is helpful to others, but it relies on observed behavior in AWS CodeBuild to work, so I don't think it is ideal.</p>\n\n<p>In my buildspec.yaml I am able to get the build to work by:</p>\n\n<ol>\n<li>Getting <code>${THEGOPATH}</code> from <code>${GOPATH}</code> by removing the \"/go:\" from the beginning</li>\n<li>Copying all the code to the <code>${THEGOPATH}/src/&lt;app path&gt;</code></li>\n<li>Copying other repositories to <code>${THEGOPATH}/src/&lt;other app path&gt;</code></li>\n<li>Importing external dependencies as normal (in our case, <code>go get ./...</code> or explicit)</li>\n<li>Building and forcing the output name (when launched from CodeBuild it used a different directory name)</li>\n</ol>\n\n<p>The buildspec.yaml looks something like the following:</p>\n\n<pre><code>phases:\n  install:\n    commands:\n      - echo GOPATH - $GOPATH\n      - export THEGOPATH=`echo $GOPATH | cut -c 5-`\n      - echo THEGOPATH = $THEGOPATH\n      - mkdir -p ${THEGOPATH}/src/company/app1\n      - mkdir -p  ${THEGOPATH}/src/company/other_repository_dependency\n      - echo Copy source files to go root\n      - cp -a ${CODEBUILD_SRC_DIR}/. ${THEGOPATH}/src/company/app1/${PACKAGE}\n      - cp -a ${CODEBUILD_SRC_DIR_other_dep}/. ${THEGOPATH}/src/app/other_repository_dependecy/.\n      - ls ${THEGOPATH}/src/\n  build:\n    commands:\n      - echo Build started on `date`\n      - echo Getting packages\n      - go get ./...\n      - echo DOING THE BUILD\n      - go build -ldflags \"&lt;some flags&gt;\" -o \"appname\"\n      - go test ./...\n  post_build:\n    commands:\n      - echo Build completed on `date`\n      - ls -al\n      - pwd\nartifacts:\n  files:\n    - appname\n</code></pre>\n\n<hr>\n\n<p><strong>Update -- Better fix</strong>\nToday we attempted to build with go modules (available since 1.11) see <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">here</a> for an explanation of go modules.</p>\n\n<p>Using go modules we defined the current source module app1 as <code>company-name.com</code> in the go.mod file like this:</p>\n\n<pre><code>module company-name.com/app1\n\ngo 1.12\nrequire (\n   ... *for example*\n   github.com/golang/mock v1.3.1\n   github.com/google/btree v1.0.0 // indirect\n   github.com/google/go-cmp v0.3.0\n   ... *etc*\n</code></pre>\n\n<p>We even reference our external files this way (though you'll need to figure out how to authenticate with your git repository. We used the credential helper built into the buildspec for https authentication). So, our import blocks look something like this now:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>     import ( \n       \"company-name.com/app1/subpackage1\"\n       abbrev \"company-name.com/app1/subpackage2\"\n       \"company-name.com/externalpkg\"  // In another private git repo of ours\n       ... //etc\n     )\n     ... //golang source follows here*\n\n</code></pre>\n\n<p>Finally, we added the following environment variable to the buildspec:</p>\n\n<pre><code>  variables:\n    GO111MODULE: \"on\"\n    git-credential-helper: yes\n</code></pre>\n\n<p>These ensured that modules worked in the path (thanks amwill04 for reminding me of my omission) and allowed the credentials for our Git repository to get setup properly.</p>\n\n<p>In doing this we accomplished everything we needed:</p>\n\n<ol>\n<li>By changing our references to the go module we could easily reference the subpackages as such</li>\n<li>We were able to lock the version of all our dependencies</li>\n<li>By implementing a simple server at company-name.com, we could reference other private modules from our application</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 581, "user_id": 3341148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x77dO.jpg?s=128&g=1", "display_name": "ajl", "link": "https://stackoverflow.com/users/3341148/ajl"}, "edited": false, "score": 0, "creation_date": 1559882214, "post_id": 56486814, "comment_id": 99565398, "body": "Thanks for this. Just today we finally tried go modules, which I believe is a more correct answer (though I believe this works fine). Please see my answer above if you are using 1.11 or later. Also, note that the &quot;/go&quot; directory being the GOPATH is a current observed behavior that AWS has not committed to continuing to use. Parsing the GOPATH environment variable would be more future proof IMHO."}, {"owner": {"reputation": 361, "user_id": 1219208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21edcfa37eec45c3f13586e86fc250cd?s=128&d=identicon&r=PG", "display_name": "Rhys Elsmore", "link": "https://stackoverflow.com/users/1219208/rhys-elsmore"}, "reply_to_user": {"reputation": 581, "user_id": 3341148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x77dO.jpg?s=128&g=1", "display_name": "ajl", "link": "https://stackoverflow.com/users/3341148/ajl"}, "edited": false, "score": 1, "creation_date": 1559971966, "post_id": 56486814, "comment_id": 99595753, "body": "We are also using Go modules - left the answer just in case anyone is pinned to the older versions of Go (like you were in your original answer). I understand that AWS have not committed to it, but it is hardcoded into their Docker images for versions up until now. When using modules, the above answer can also be modified to symlink your codebase outside of the $GOPATH, which is important as Codebuild makes as your source directory the $GOPATH with the new Golang buildspec runtime directives - meaning modules won&#39;t work correctly."}], "tags": [], "owner": {"reputation": 361, "user_id": 1219208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21edcfa37eec45c3f13586e86fc250cd?s=128&d=identicon&r=PG", "display_name": "Rhys Elsmore", "link": "https://stackoverflow.com/users/1219208/rhys-elsmore"}, "is_accepted": false, "score": 1, "last_activity_date": 1576651352, "last_edit_date": 1576651352, "creation_date": 1559869697, "answer_id": 56486814, "question_id": 53382185, "link": "https://stackoverflow.com/questions/53382185/aws-codebuild-fails-for-golang-source-with-sub-packages/56486814#56486814", "title": "AWS CodeBuild fails for golang source with sub-packages", "body": "<p>This is the approach that I took.</p>\n\n<pre><code>version: 0.2\n\nenv:\n  variables:\n    PACKAGE: \"github.com/rhyselsmore/foo\"\n\nphases:\n  install:\n    commands:\n      # AWS Codebuild Go images use /go for the $GOPATH so let's copy our\n      # application source code into that directory structure.\n      - mkdir -p \"/go/src/$(dirname ${PACKAGE})\"\n      - ln -s \"${CODEBUILD_SRC_DIR}\" \"/go/src/${PACKAGE}\"\n      - # Make sure we're in the package directort within our GOPATH\n      - cd \"/go/src/${PACKAGE}\"\n</code></pre>\n\n<p>Now assuming that the PACKAGE variable is the root of your repository that you are building, we can issue go commands. Lets break it down line-by-line.</p>\n\n<pre><code>- mkdir -p \"/go/src/$(dirname ${PACKAGE})\"\n</code></pre>\n\n<p>This creates a new directory within the GOPATH for your package.</p>\n\n<pre><code>- ln -s \"${CODEBUILD_SRC_DIR}\" \"/go/src/${PACKAGE}\"\n</code></pre>\n\n<p>This creates a symbolic link from the root of your CodeBuild project to your Go package.</p>\n\n<pre><code>- cd \"/go/src/${PACKAGE}\"\n</code></pre>\n\n<p>This primes the rest of your Codebuild operations to take place in the CWD of your Go package.</p>\n"}], "owner": {"reputation": 581, "user_id": 3341148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x77dO.jpg?s=128&g=1", "display_name": "ajl", "link": "https://stackoverflow.com/users/3341148/ajl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 1, "accepted_answer_id": 53398074, "answer_count": 2, "score": 1, "last_activity_date": 1576651352, "creation_date": 1542659427, "last_edit_date": 1542729562, "question_id": 53382185, "link": "https://stackoverflow.com/questions/53382185/aws-codebuild-fails-for-golang-source-with-sub-packages", "title": "AWS CodeBuild fails for golang source with sub-packages", "body": "<p>When I attempt to build my golang project using CodeBuild golang image 1.10, it fails, unable to find the subpackages. Some background: </p>\n\n<p>The application is organized as follows:</p>\n\n<pre><code>/go/src/company/app\n/go/src/company/app/sub1\n/go/src/company/app/sub2\netc...\n</code></pre>\n\n<p>This builds fine on my dev machine. However, when pulled by codebuild it is pulled into a different directory (<code>/codebuild/output/srcNNN/src/&lt;some path&gt;</code>) where <code>&lt;some path&gt;</code> varies according to what triggers the build.</p>\n\n<p>I originally got it working by copying the code from where it is pulled to the the golang directory (<code>/codebuild/output/srcNNN</code>), but since the CodeBuild environment variable for the <code>GOPATH</code> directory inserts /go: (<code>/go:/codebuild/output/srcNNN</code>) in the front, I used an observed number of ../../... to copy. However, this is ugly and failed as soon as I triggered the build a different way.</p>\n\n<p>My question is whether there is a good way to get this working? My next idea is to apply string manipulation to the observed path and copy there for (hopefully) more reliability. But that will only work as long as the <code>GOPATH</code> conforms to my assumptions.</p>\n\n<p>Any ideas would be appreciated. </p>\n\n<hr>\n\n<p>Clarification:\nWhen importing packages in the code, external packages are imported as follows:</p>\n\n<pre><code>import (\n    \"context\"\n    ...\n}\n</code></pre>\n\n<p>Subpackages are not explicitly imported, but found when code is deployed as shown above (<code>/go/src/company/app</code>). However, AWS CodeBuild doesn't bring in the code this way.</p>\n"}, {"tags": ["go", "interface", "dependencies", "solid-principles", "dependency-inversion"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1542657316, "post_id": 53381694, "comment_id": 93639200, "body": "It&#39;s fine to duplicate it, but the given code doesn&#39;t need to have either copy because it&#39;s never referenced. Define an interface where it is consumed."}, {"owner": {"reputation": 53, "user_id": 3214407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/918cbb05d11b7c59f71d0bc066a8328f?s=128&d=identicon&r=PG&f=1", "display_name": "despacito2012", "link": "https://stackoverflow.com/users/3214407/despacito2012"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1542699911, "post_id": 53381694, "comment_id": 93652056, "body": "Is there a concrete example of this on standard library / large scale project ?"}, {"owner": {"reputation": 1145, "user_id": 1780211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5337812625d313ee46e12042b0388fd?s=128&d=identicon&r=PG", "display_name": "Mo K", "link": "https://stackoverflow.com/users/1780211/mo-k"}, "edited": false, "score": 0, "creation_date": 1597814586, "post_id": 53381694, "comment_id": 112252581, "body": "Wouldn&#39;t it be difficult to maintain? Like even renaming a method will be N times vs 1 time."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9459192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gzxjwa_li_g/AAAAAAAAAAI/AAAAAAAABKE/tpjbsedeB0o/photo.jpg?sz=128", "display_name": "Evan", "link": "https://stackoverflow.com/users/9459192/evan"}, "is_accepted": false, "score": 0, "last_activity_date": 1542675259, "creation_date": 1542675259, "answer_id": 53384727, "question_id": 53381694, "link": "https://stackoverflow.com/questions/53381694/where-should-we-define-go-interface-in-multiple-consumer-scenario-what-about-i/53384727#53384727", "title": "Where should we define Go interface in multiple Consumer scenario ? What about interface in producer to show generality?", "body": "<p>You could move the <code>DB</code> interface in to a different package, then the <code>worker</code> and <code>listener</code> packages could both use it.</p>\n"}], "owner": {"reputation": 53, "user_id": 3214407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/918cbb05d11b7c59f71d0bc066a8328f?s=128&d=identicon&r=PG&f=1", "display_name": "despacito2012", "link": "https://stackoverflow.com/users/3214407/despacito2012"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1542700093, "creation_date": 1542657124, "last_edit_date": 1542700093, "question_id": 53381694, "link": "https://stackoverflow.com/questions/53381694/where-should-we-define-go-interface-in-multiple-consumer-scenario-what-about-i", "title": "Where should we define Go interface in multiple Consumer scenario ? What about interface in producer to show generality?", "body": "<p>Can someone give me a concrete example to this advise ?</p>\n\n<p><code>https://github.com/golang/go/wiki/CodeReviewComments#interfaces</code></p>\n\n<p>So is this how i follow it ?</p>\n\n<pre><code>package worker\n\ntype interface DB {\n  getAllTable()\n}\n\n\ntype worker struct {\n  db DB\n}\n\nfunc (w worker) doSomething() {\n  w.db.getAllTable() \n}\n</code></pre>\n\n<hr>\n\n<pre><code>package listener\n\ntype interface DB {\n  getAllTable()\n}\n\ntype listener struct {\n  db DB\n}\n\nfunc (l listener) doSomething() {\n  l.db.getAllTable() \n}\n</code></pre>\n\n<hr>\n\n<pre><code>package msql\n\ntype mysql struct {}\n\nfunc (mysql) getAllTable() {\n}\n</code></pre>\n\n<p>Is it alright to duplicate the interfaces in 2 places to satisfy \u2018define consumer where it is consumed\u2019.</p>\n\n<hr>\n\n<p>What about using interface to show generality ? It\u2019s defining interface not where it is consumed</p>\n\n<p>For example hash/crc32 and hash/adler32 implementing hash.Hash32 </p>\n"}, {"tags": ["google-chrome", "session", "web", "go", "browser"], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 8773359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe16d59d9b3e4b39a8a81e0f1106dff8?s=128&d=identicon&r=PG&f=1", "display_name": "Yevgeniy Vasilyev", "link": "https://stackoverflow.com/users/8773359/yevgeniy-vasilyev"}, "is_accepted": false, "score": 0, "last_activity_date": 1542658873, "creation_date": 1542658873, "answer_id": 53382071, "question_id": 53380674, "link": "https://stackoverflow.com/questions/53380674/golang-gorilla-session-not-working-in-chrome-browser-but-works-on-safari-and-fir/53382071#53382071", "title": "Golang Gorilla Session not working in Chrome Browser But works on Safari and Firefox", "body": "<p>I think some proper error handling would help you quickly debug your problem and see just exactly what may be the problem.</p>\n\n<p>In Golang its standard practice to handle the error right after its declared.\nExample: in your get_session method</p>\n\n<pre><code>session, err := store.Get(request, \"session-name\")\nif err != nil {\n   return -1, err\n}\n</code></pre>\n\n<p>The problem in your code is that you arent stopping execution if an error occurs which makes it 10x harder to figure out where something might've went wrong.</p>\n\n<p>Sometimes its even helpful (for debugging) to add small comments that will help you even pinpoint the error more, like:</p>\n\n<pre><code>session, err := store.Get(request, \"session-name\")\nif err != nil {\n   fmt.Println(\"hey an error occurred trying to get the session: \",err.Error())\n   return -1, err\n}\n</code></pre>\n\n<p>I think once you put in some proper error handling you can debug your issue quickly. (And handle every error, dont ignore any)</p>\n"}], "owner": {"reputation": 1, "user_id": 6610740, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Randy Diaz", "link": "https://stackoverflow.com/users/6610740/randy-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542658873, "creation_date": 1542652282, "question_id": 53380674, "link": "https://stackoverflow.com/questions/53380674/golang-gorilla-session-not-working-in-chrome-browser-but-works-on-safari-and-fir", "title": "Golang Gorilla Session not working in Chrome Browser But works on Safari and Firefox", "body": "<p>I am having trouble deploying my golang web app into a live server.</p>\n\n<p>While running this code locally, it was working perfectly fine. </p>\n\n<p>Note that I did the following checks to try to solve this problem:</p>\n\n<ol>\n<li><p>I made sure that my systemd had the environment variable SESSION_KEY.\n( Printed out the os.Getenv(\"SESSION_KEY\") and it returned the key.</p></li>\n<li><p>I tried to check all the returned errors from the below functions.\n( All of the errors are nil; however when I try to get_session after the fact, it returns false for the ok variable and 0 for the uid)</p></li>\n<li><p>I tried working this code on firefox, safari, and chrome. ( Chrome is the only one that does not work. )</p></li>\n</ol>\n\n<p>I only pulled out the code that had to do with \"github.com/gorilla/sessions\" package.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var store = sessions.NewCookieStore([]byte(os.Getenv(\"SESSION_KEY\")))\r\n\r\n\r\nfunc init() {\r\n\r\n\tfmt.Println(store)\r\n\tfmt.Println(\"SESSION KEY BELOW: \", os.Getenv(\"SESSION_KEY\"))\r\n\r\n\tstore.Options = &amp;sessions.Options{\r\n\t    Domain:   \"buckler.solutions\",\r\n\t    Path:     \"/\",\r\n\t    MaxAge:   3600 * 8, // 8 hours\r\n\t    HttpOnly: true,\r\n\t}\r\n}\r\n\r\nfunc get_session(request *http.Request) (int, error) {\r\n\t// META: Gets the session cookie and returns the result.\r\n\r\n\tsession, err := store.Get(request, \"session-name\")\r\n\tfmt.Println(\"ERROR FROM store.Get: \", err)\r\n\tuntyped_uid, untyped_ok := session.Values[\"uid\"]\r\n\tfmt.Println(\"SESSIONUID before cast: \", untyped_uid)\r\n\tuid, ok := untyped_uid.(int)\r\n\tfmt.Println(\"SESSIONUID after cast: \", uid)\r\n\r\n\tif !untyped_ok || !ok {\r\n\t\tfmt.Println(\"GET SESSION ERRORS.\")\r\n\t\tfmt.Println(\"UNTYPED_OK: \", untyped_ok)\r\n\t\tfmt.Println(\"OK: \", ok)\r\n\t\treturn -1, errors.New(\"no session\")\r\n\t} else {\r\n\t\treturn uid, nil\r\n\t}\r\n}\r\n\r\nfunc set_session(response http.ResponseWriter, request *http.Request, uid int) {\r\n\t// META: Sets the session cookie and saves it.\r\n\r\n\tsession, err := store.Get(request, \"session-name\")\r\n\tfmt.Println(\"SESSION in SET SESSION: \", session)\r\n\tfmt.Println(\"SESSION SET ERROR:\", err)\r\n\r\n\tsession.Values[\"uid\"] = uid\r\n\tfmt.Println(\"UID: \", uid)\r\n\r\n\terr = session.Save(request, response)\r\n\tfmt.Println(\"SESSION SAVE ERROR:\", err)\r\n\t\r\n}\r\n\r\nfunc clear_session(response http.ResponseWriter, request *http.Request) {\r\n\t// META: Clears the session so that it won't remember the user.\r\n\r\n\tsession, err := store.Get(request, \"session-name\")\r\n\tfmt.Println(\"ERROR CLEARING SESSION: \", err)\r\n\tsession.Values[\"uid\"] = -1\r\n\tsession.Save(request, response)\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["go", "module", "sqlite"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1542650292, "post_id": 53380175, "comment_id": 93636094, "body": "Try the following: <a href=\"https://github.com/mattn/go-sqlite3/issues/256#issuecomment-232622142\" rel=\"nofollow noreferrer\">github.com/mattn/go-sqlite3/issues/256#issuecomment-23262214&zwnj;&#8203;2</a>"}, {"owner": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1542650572, "post_id": 53380175, "comment_id": 93636250, "body": "Weirdly enough it does not seem to work."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1542650674, "post_id": 53380175, "comment_id": 93636296, "body": "Tangentially, you shouldn&#39;t need to run the <code>go install</code> command, <code>go get</code> natively installs anything it pulls.  The <code>go install</code> call should only be needed if you pulled down the repo via <code>git clone</code> or via <code>go get -d</code> (which tells <code>go get</code> to only download and not install)."}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1542691055, "post_id": 53380175, "comment_id": 93648867, "body": "Can you try adding <code>CGO_LDTHREAD</code> to your environment? i.e. <code>export CGO_LDTHREAD=-lpthread</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 0, "last_activity_date": 1550856774, "creation_date": 1550856774, "answer_id": 54832325, "question_id": 53380175, "link": "https://stackoverflow.com/questions/53380175/go-issue-when-importing-sqlite3-driver/54832325#54832325", "title": "Go issue when importing sqlite3 driver", "body": "<p>I had the same problem when using gobuffalo. The way how to fix this:</p>\n\n<p>Step 1: Go to following page: <a href=\"http://tdm-gcc.tdragon.net/\" rel=\"nofollow noreferrer\">http://tdm-gcc.tdragon.net/</a></p>\n\n<p>Step 2: Download the TDM64 bundle</p>\n\n<p>Step 3: Start the TDM64 bundle and the installer opens</p>\n\n<p>I wrote a blog post about that: <a href=\"https://blog.gobuffalo.io/install-buffalo-on-windows-10-e08b3aa304a3\" rel=\"nofollow noreferrer\">https://blog.gobuffalo.io/install-buffalo-on-windows-10-e08b3aa304a3</a></p>\n"}], "owner": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 54832325, "answer_count": 1, "score": 3, "last_activity_date": 1550856774, "creation_date": 1542649959, "question_id": 53380175, "link": "https://stackoverflow.com/questions/53380175/go-issue-when-importing-sqlite3-driver", "title": "Go issue when importing sqlite3 driver", "body": "<p>So I have been trying to integrate the following sqlite3 driver into my Go project; <a href=\"https://github.com/mattn/go-sqlite3\" rel=\"nofollow noreferrer\">https://github.com/mattn/go-sqlite3</a>, using the commands;</p>\n\n<pre><code>go get github.com/mattn/go-sqlite3 &amp;&amp; go install github.com/mattn/go-sqlite3\n</code></pre>\n\n<p>as instructed in the readme file. Unfortunately with no success whatsoever - after running the commands and trying to import the driver using <code>import(\"github.com/mattn/go-sqlite3\")</code> I am left with two very little specific errors, which I assume are related to the gcc compiler?  </p>\n\n<pre><code># command-line-arguments\n/usr/bin/ld: $WORK/b001/_pkg1_.a(_x009.o): undefined reference to symbol 'pthread_mutexattr_settype@@GLIBC_2.2.5'\n//usr/lib64/libpthread.so.0: error adding symbols: DSO missing from command line\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Here is the output of go env, I have got both sqlite3 and GCC installed;</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOCACHE=\"/home/maciej/.cache/go-build\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/maciej/go\"\nGORACE=\"\"\nGOROOT=\"/usr\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/libexec/gcc/x86_64-redhat-linux/8\"\nGCCGO=\"/usr/bin/gccgo\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build343666347=/tmp/go-build -gno-record-gcc-switches -funwind-tables\"\n\nsqlite3 -version\n3.22.0 2018-01-22 18:45:57\ngcc version 8.2.1 20181105 (Red Hat 8.2.1-5) (GCC)\n</code></pre>\n\n<p>Out of curiosity I tried running exactly the same procedure on Windows 10 using TDM gcc 5.1.0 and it worked flawlessly, I'll be really thankful for any advice regarding my problem, thank you. </p>\n"}, {"tags": ["go", "activemq"], "comments": [{"owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 1, "creation_date": 1542645904, "post_id": 53379120, "comment_id": 93633996, "body": "I hope this would help you: <a href=\"https://godoc.org/qpid.apache.org/electron\" rel=\"nofollow noreferrer\">godoc.org/qpid.apache.org/electron</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16275, "user_id": 8381946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YoUh4.jpg?s=128&g=1", "display_name": "Justin Bertram", "link": "https://stackoverflow.com/users/8381946/justin-bertram"}, "is_accepted": false, "score": 1, "last_activity_date": 1542647583, "creation_date": 1542647583, "answer_id": 53379616, "question_id": 53379120, "link": "https://stackoverflow.com/questions/53379120/connect-active-mq-using-openwire-protocol/53379616#53379616", "title": "Connect active mq using openwire protocol", "body": "<p>Take a look at the <a href=\"http://activemq.apache.org/openwire.html\" rel=\"nofollow noreferrer\">ActiveMQ OpenWire documentation</a>. It has a link to a handful of Java classes which are used to generate C, C#, C++, &amp; Java client code. You could probably use those as examples to create your own files to generate Go client code which can speak OpenWire.</p>\n\n<p>That said, you're probably better served by using the Go AMQP or STOMP clients as ActiveMQ was designed to be used by multiple protocols. </p>\n"}, {"tags": [], "owner": {"reputation": 21277, "user_id": 412763, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6CFGe.jpg?s=128&g=1", "display_name": "Petter Nordlander", "link": "https://stackoverflow.com/users/412763/petter-nordlander"}, "is_accepted": false, "score": -1, "last_activity_date": 1542658322, "creation_date": 1542658322, "answer_id": 53381949, "question_id": 53379120, "link": "https://stackoverflow.com/questions/53379120/connect-active-mq-using-openwire-protocol/53381949#53381949", "title": "Connect active mq using openwire protocol", "body": "<p>AMQP and OpenWire clients can co-exist and is by far the best solution for you, even though you have a Java-stack.</p>\n\n<p>Your second best bet is to write some glue code in Java/C#/C++ that connects an OpenWire AMQ client with something that GO can speak to (like another ActiveMQ using AMQP or STOMP ;-) ).</p>\n\n<p>If you really really really need OpenWire support, the best bet is to try to use the <a href=\"http://activemq.apache.org/cms/index.html\" rel=\"nofollow noreferrer\">C++ client</a> and call it using <a href=\"http://www.swig.org/Doc2.0/Go.html\" rel=\"nofollow noreferrer\">swig</a> or whatnot.</p>\n\n<p>Writing a native OpenWire-client in Go is a major effort and there is no point, except as a \"fun\" task.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9893137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7314df6ebfe830fd339610696dd4a6f6?s=128&d=identicon&r=PG&f=1", "display_name": "Vivlis", "link": "https://stackoverflow.com/users/9893137/vivlis"}, "is_accepted": false, "score": 0, "last_activity_date": 1542974689, "creation_date": 1542974689, "answer_id": 53446412, "question_id": 53379120, "link": "https://stackoverflow.com/questions/53379120/connect-active-mq-using-openwire-protocol/53446412#53446412", "title": "Connect active mq using openwire protocol", "body": "<p>Thank you for answers. I agree with <strong><em>stomp &amp; amqp</em></strong> as sufficient for task and agree that write <strong><em>OpenWire</em></strong> client just for sake of it is not good option. I have to convince our architects now </p>\n"}], "owner": {"reputation": 21, "user_id": 9893137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7314df6ebfe830fd339610696dd4a6f6?s=128&d=identicon&r=PG&f=1", "display_name": "Vivlis", "link": "https://stackoverflow.com/users/9893137/vivlis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1542974689, "creation_date": 1542645681, "last_edit_date": 1542700504, "question_id": 53379120, "link": "https://stackoverflow.com/questions/53379120/connect-active-mq-using-openwire-protocol", "title": "Connect active mq using openwire protocol", "body": "<p>Does anybody has an example how to connect <code>ActiveMQ OpenWire</code> protocol using go please?\nI used <code>stomp &amp; amqp with ActiveMQ</code> for now and both are ok (testing), but our it architect will probably push for OpenWire as almost all our applications are Java based and that is standard for our company. So I would be happy for nay example, suggestions  how to do it and not loose go service only because <code>OpenWire</code> protocol </p>\n\n<p>thanks</p>\n"}, {"tags": ["performance", "go", "synchronization", "mutex"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1542636118, "post_id": 53376237, "comment_id": 93628135, "body": "Where are your Go testing package benchmark results?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1542636345, "post_id": 53376237, "comment_id": 93628267, "body": "<code>test3()</code> has data race (you cannot read <code>b</code> without synchronization). And if you move that check inside the block protected by the mutex, you&#39;re already &quot;doing worse&quot; than <code>Once.Do()</code> which has an &quot;optimized&quot; short path using an atomic load. The &quot;slow&quot; path is most likely only to be encountered once."}, {"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "edited": false, "score": 0, "creation_date": 1542636454, "post_id": 53376237, "comment_id": 93628323, "body": "see test2, it does the check on  b inside the locked section and is still much faster."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1542636499, "post_id": 53376237, "comment_id": 93628352, "body": "As peterSO wrote, we don&#39;t know how you got your test results. Show the testing and benchmarking code. Aim for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "edited": false, "score": 0, "creation_date": 1542636624, "post_id": 53376237, "comment_id": 93628426, "body": "All the code is there. I ran the test loop in the main function while test1, test2, test3 are other functions defined in the same file."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1542637190, "post_id": 53376237, "comment_id": 93628766, "body": "First, use Go&#39;s built-in benchmarking system, it is very thorough and effective. Second, unless you&#39;ve benchmarked a real-world application and found a performance issue, and used profiling to trace that issue to <code>sync.Once</code>, this is a fruitless exercise. It is extremely unlikely that <code>sync.Once</code> will have any meaningful performance impact in any real-world scenario."}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "edited": false, "score": 0, "creation_date": 1542638870, "post_id": 53376578, "comment_id": 93629769, "body": "Thanks, this completely solves my confusion. Also, I didn&#39;t know about the benchmarking capability of the testing package. Will use that from now on."}, {"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "edited": false, "score": 0, "creation_date": 1542640145, "post_id": 53376578, "comment_id": 93630492, "body": "How do I know however, that this runs multiple goroutines simulatneously? I&#39;m not sure it does. Shouldn&#39;t it be: <code>go DoWithOnce()</code> and <code>go DoWithMutex()</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "edited": false, "score": 0, "creation_date": 1542640916, "post_id": 53376578, "comment_id": 93630961, "body": "@Gilrich You shouldn&#39;t use <code>go</code> in benchmarking code, that will render the results almost useless. But there, you shall have parallel results. Check edited answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1542662077, "last_edit_date": 1542662077, "creation_date": 1542637135, "answer_id": 53376578, "question_id": 53376237, "link": "https://stackoverflow.com/questions/53376237/efficiency-measurments-of-gos-once-type/53376578#53376578", "title": "Efficiency measurments of Go&#39;s once Type", "body": "<p>That is not how you're supposed to test code performance. You should use Go's built-in testing framework (<a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\"><code>testing</code></a> package and <code>go test</code> command). See <a href=\"https://stackoverflow.com/questions/41608578/order-of-the-code-and-performance/41608707#41608707\">Order of the code and performance</a> for details.</p>\n\n<p>Let's create the testable code:</p>\n\n<pre><code>func f() {\n    // Code that must only be run once\n}\n\nvar testOnce = &amp;sync.Once{}\n\nfunc DoWithOnce() {\n    testOnce.Do(f)\n}\n\nvar (\n    mu = &amp;sync.Mutex{}\n    b  bool\n)\n\nfunc DoWithMutex() {\n    mu.Lock()\n    if !b {\n        f()\n        b = true\n    }\n    mu.Unlock()\n}\n</code></pre>\n\n<p>Let's write proper testing / benchmarking code using the <code>testing</code> package:</p>\n\n<pre><code>func BenchmarkOnce(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        DoWithOnce()\n    }\n}\n\nfunc BenchmarkMutex(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        DoWithMutex()\n    }\n}\n</code></pre>\n\n<p>We can run the benchmark with the following code:</p>\n\n<pre><code>go test -bench .\n</code></pre>\n\n<p>And here are the benchmarking results:</p>\n\n<pre><code>BenchmarkOnce-4         200000000                6.30 ns/op\nBenchmarkMutex-4        100000000               20.0 ns/op\nPASS\n</code></pre>\n\n<p>As you can see, using <code>sync.Once()</code> was almost 4 times faster than using a <code>sync.Mutex</code>. Why? Because <code>sync.Once()</code> has an \"optimized\", short path that uses only an atomic load to check if the task has been called before, and if so, no mutex is used. The \"slow\" path is likely only used once, on first call to <code>Once.Do()</code>. Although if you'd have many concurrent goroutines attempting to call <code>DoWithOnce()</code>, the slow path might be reached multiple times, but on the long run <code>once.Do()</code> will only need to use an atomic load.</p>\n\n<h3>Parallel testing (from multiple goroutines)</h3>\n\n<p>Yes, the above benchmarking code only uses a single goroutine to test. But using multiple concurrent goroutines will just make the mutex's case worse, as it always have to obtain a mutex to even check if the task is to be called while <code>sync.Once</code> just uses an atomic load.</p>\n\n<p>Nevertheless, let's benchmark it.</p>\n\n<p>Here are the benchmarking code using parallel testing:</p>\n\n<pre><code>func BenchmarkOnceParallel(b *testing.B) {\n    b.RunParallel(func(pb *testing.PB) {\n        for pb.Next() {\n            DoWithOnce()\n        }\n    })\n}\n\nfunc BenchmarkMutexParallel(b *testing.B) {\n    b.RunParallel(func(pb *testing.PB) {\n        for pb.Next() {\n            DoWithMutex()\n        }\n    })\n}\n</code></pre>\n\n<p>I have 4 cores on my machine, so I'm gonna use those 4 cores:</p>\n\n<pre><code>go test -bench Parallel -cpu=4\n</code></pre>\n\n<p><sup>(You may omit the <code>-cpu</code> flag in which case it defaults to <code>GOMAXPROCS</code>\u2013the number of cores available.)</sup></p>\n\n<p>And here are the results:</p>\n\n<pre><code>BenchmarkOnceParallel-4         500000000                3.04 ns/op\nBenchmarkMutexParallel-4        20000000                93.7 ns/op\n</code></pre>\n\n<p>When \"concurrency increases\", the results are starting to become uncomparable in favor of <code>sync.Once</code> (in the above test, it's 30 times faster).</p>\n\n<p>We may further increase the number of goroutines created using <a href=\"https://golang.org/pkg/testing/#B.SetParallelism\" rel=\"nofollow noreferrer\"><code>testing.B.SetPralleism()</code></a>, but I got similar result when I set it to 100 (that means 400 goroutines were used to call the benchmarking code).</p>\n"}], "owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 1, "accepted_answer_id": 53376578, "answer_count": 1, "score": -1, "last_activity_date": 1542662077, "creation_date": 1542635913, "last_edit_date": 1542637103, "question_id": 53376237, "link": "https://stackoverflow.com/questions/53376237/efficiency-measurments-of-gos-once-type", "title": "Efficiency measurments of Go&#39;s once Type", "body": "<p>I have a piece of code that I want to run only once for initialization.\nSo far I was using sync.Mutex combined with an if-clause to test if it has been run already. Later I came across the Once type and its DO() function in the same sync package.</p>\n\n<p>The implementation is the following <a href=\"https://golang.org/src/sync/once.go\" rel=\"nofollow noreferrer\">https://golang.org/src/sync/once.go</a>:</p>\n\n<pre><code>func (o *Once) Do(f func()) {\n    if atomic.LoadUint32(&amp;o.done) == 1 {\n        return\n    }\n    // Slow-path.\n    o.m.Lock()\n    defer o.m.Unlock()\n    if o.done == 0 {\n        defer atomic.StoreUint32(&amp;o.done, 1)\n        f()\n    }\n}\n</code></pre>\n\n<p>Looking at the code, it is basically the same thing I've been using before. A mutex combined with an if-clause. However, the added function calls makes this seem rather inefficient to me. I did some testing and tried varous versions:</p>\n\n<pre><code>func test1() {\n    o.Do(func() {\n        // Do smth\n    })\n    wg.Done()\n}\n\nfunc test2() {\n    m.Lock()\n    if !b {\n        func() {\n            // Do smth\n        }()\n    }\n    b = true\n    m.Unlock()\n    wg.Done()\n}\n\nfunc test3() {\n    if !b {\n        m.Lock()\n        if !b {\n            func() {\n                // Do smth\n            }()\n            b = true\n        }\n        m.Unlock()\n    }\n    wg.Done()\n}\n</code></pre>\n\n<p>I tested all versions by running the following code:</p>\n\n<pre><code>    wg.Add(10000)\n    start = time.Now()\n    for i := 0; i &lt; 10000; i++ {\n        go testX()\n    }\n    wg.Wait()\n    end = time.Now()\n\n    fmt.Printf(\"elapsed: %v\\n\", end.Sub(start).Nanoseconds())\n</code></pre>\n\n<p>with the following resutls:</p>\n\n<pre><code>elapsed: 8002700 //test1\nelapsed: 5961600 //test2\nelapsed: 5646700 //test3\n</code></pre>\n\n<p>Is it even worth using the Once type? It is convenient but performance is even worse than test2 which always serializes all routines.</p>\n\n<p>Also, why are they using an atomic int for their if-clause? Storing happens inside the lock anyway.</p>\n\n<p>Edit: Go playground link: <a href=\"https://play.golang.org/p/qlMxPYop7kS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qlMxPYop7kS</a> NOTICE: this doensn't show the results as time is fixed in the playground.</p>\n"}, {"tags": ["for-loop", "go", "slice"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1542636883, "post_id": 53374915, "comment_id": 93628602, "body": "This is covered in the <a href=\"https://tour.golang.org/moretypes/16\" rel=\"nofollow noreferrer\">Tour of Go</a>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1542648940, "last_edit_date": 1542648940, "creation_date": 1542631504, "answer_id": 53374938, "question_id": 53374915, "link": "https://stackoverflow.com/questions/53374915/how-to-get-rid-of-zero-value-in-a-int-slice-in-go/53374938#53374938", "title": "How to get rid of zero value in a int slice in Go?", "body": "<pre><code>for n := range nums {\n    // ...\n}\n</code></pre>\n\n<p><code>n</code> is not the elements of the <code>nums</code> slice, it is the <strong>index</strong>. So basically you tested and added the indices of the elements to your <code>res</code> result slice.</p>\n\n<p>Instead do this:</p>\n\n<pre><code>for _, n := range nums {\n    // ...\n}\n</code></pre>\n\n<p>With this change, output will be (try it on the <a href=\"https://play.golang.org/p/2CNIX95MmRX\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[2 4 6]\n</code></pre>\n\n<p>This is detailed in <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">Spec: For statements</a>, For statements with range clause:</p>\n\n<blockquote>\n  <p>For each iteration, iteration values are produced as follows if the respective iteration variables are present:</p>\n\n<pre><code>Range expression                          1st value          2nd value\n\narray or slice  a  [n]E, *[n]E, or []E    index    i  int    a[i]       E\nstring          s  string type            index    i  int    see below  rune\nmap             m  map[K]V                key      k  K      m[k]       V\nchannel         c  chan E, &lt;-chan E       element  e  E\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 53374938, "answer_count": 1, "score": 0, "last_activity_date": 1542648940, "creation_date": 1542631410, "last_edit_date": 1542631815, "question_id": 53374915, "link": "https://stackoverflow.com/questions/53374915/how-to-get-rid-of-zero-value-in-a-int-slice-in-go", "title": "How to get rid of zero value in a int slice in Go?", "body": "<p>I am trying to find even numbers in a list of numbers, here is my attempt:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    nums := []int{1, 2, 3, 4, 5, 6, 7}\n    res := []int{}\n    for n := range nums {\n        if n%2 == 0 {\n            res = append(res, n)\n        }\n    }\n    fmt.Println(res)\n}\n</code></pre>\n\n<p>It seems straightforward; however, when I run the program, I got the result</p>\n\n<pre><code>[0 2 4 6]\n</code></pre>\n\n<p>Where does the zero come from? It must be from the empty slice <code>res</code>. How can I get rid of this zero?</p>\n"}, {"tags": ["arrays", "json", "go", "struct", "marshalling"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1542630211, "post_id": 53374464, "comment_id": 93624789, "body": "Marshal this value: <code>[]interface{}{message.Args, message.Kwargs}</code> Is this good enough for you?"}], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 5738705, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vy7ZsZ5EEl0/AAAAAAAAAAI/AAAAAAAAAJg/eAB0kC5hHHs/photo.jpg?sz=128", "display_name": "Mehdi Pourfar", "link": "https://stackoverflow.com/users/5738705/mehdi-pourfar"}, "edited": false, "score": 0, "creation_date": 1542633086, "post_id": 53374613, "comment_id": 93626326, "body": "Thanks a lot for your time and answer. I finally found out that using json interfaces (MarshalJson and UnmarshalJson) is a bit more easier."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1542633086, "last_edit_date": 1542633086, "creation_date": 1542630359, "answer_id": 53374613, "question_id": 53374464, "link": "https://stackoverflow.com/questions/53374464/create-heterogeneous-json-array-in-go/53374613#53374613", "title": "Create heterogeneous json array in go", "body": "<p>What you want in your output is a JSON array holding the <code>Args</code> and <code>Kwargs</code> fields of your <code>message</code> struct value, so you may get what you want by marshaling the following slice value:</p>\n\n<pre><code>[]interface{}{message.Args, message.Kwargs}\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>message := Message{\n    []interface{}{1, 2, 3, 4},\n    map[string]interface{}{\"a\": 2, \"b\": 3},\n}\n\nerr := json.NewEncoder(os.Stdout).\n    Encode([]interface{}{message.Args, message.Kwargs})\n\nfmt.Println(err)\n</code></pre>\n\n<p>Output of the above (try it on the <a href=\"https://play.golang.org/p/iFnVHgjqkvZ\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[[1,2,3,4],{\"a\":2,\"b\":3}]\n&lt;nil&gt;\n</code></pre>\n\n<p>This works for this specific case. If you want a general solution which marshals fields of a struct value like elements of an array, you may create a helper function that \"packs\" fields into a slice:</p>\n\n<pre><code>func getFields(i interface{}) (res []interface{}) {\n    v := reflect.ValueOf(i)\n    if v.Kind() == reflect.Ptr {\n        v = v.Elem()\n    }\n    if v.Kind() != reflect.Struct {\n        return nil\n    }\n\n    for i := 0; i &lt; v.NumField(); i++ {\n        f := v.Field(i)\n        if f.CanInterface() {\n            res = append(res, f.Interface())\n        }\n    }\n    return res\n}\n</code></pre>\n\n<p>The above <code>getFields()</code> accepts struct values and pointers to structs. Example using it:</p>\n\n<pre><code>message := Message{\n    []interface{}{1, 2, 3, 4},\n    map[string]interface{}{\"a\": 2, \"b\": 3},\n}\n\nerr := json.NewEncoder(os.Stdout).Encode(getFields(message))\nfmt.Println(err)\n\nerr = json.NewEncoder(os.Stdout).Encode(getFields(&amp;message))\nfmt.Println(err)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/gDGJGerAMoB\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[[1,2,3,4],{\"a\":2,\"b\":3}]\n&lt;nil&gt;\n[[1,2,3,4],{\"a\":2,\"b\":3}]\n&lt;nil&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 794, "user_id": 1500646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dc08a3decfb01425d436e4b3161b3ff?s=128&d=identicon&r=PG", "display_name": "klvmungai", "link": "https://stackoverflow.com/users/1500646/klvmungai"}, "is_accepted": true, "score": 2, "last_activity_date": 1542641306, "last_edit_date": 1542641306, "creation_date": 1542630899, "answer_id": 53374789, "question_id": 53374464, "link": "https://stackoverflow.com/questions/53374464/create-heterogeneous-json-array-in-go/53374789#53374789", "title": "Create heterogeneous json array in go", "body": "<p>You can add a marshal method to your struct to handle the logic. Something in the lines of </p>\n\n<pre><code>func (m Message) MarshalJSON() ([]byte, error) {\n    data := make([]interface{}, 0)\n    data = append(data, m.Args)\n    data = append(data, m.Kwargs)\n    return json.Marshal(data)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/-n-vGvTFkko\" rel=\"nofollow noreferrer\">Try it on the Playground</a></p>\n"}], "owner": {"reputation": 436, "user_id": 5738705, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vy7ZsZ5EEl0/AAAAAAAAAAI/AAAAAAAAAJg/eAB0kC5hHHs/photo.jpg?sz=128", "display_name": "Mehdi Pourfar", "link": "https://stackoverflow.com/users/5738705/mehdi-pourfar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 53374789, "answer_count": 2, "score": 1, "last_activity_date": 1542641306, "creation_date": 1542629835, "question_id": 53374464, "link": "https://stackoverflow.com/questions/53374464/create-heterogeneous-json-array-in-go", "title": "Create heterogeneous json array in go", "body": "<p>Suppose I have an struct like this in go:</p>\n\n<pre><code>type Message struct {\n    Args   []interface{}\n    Kwargs map[string]interface{}\n}\n\nmessage := Message{                                                                                                                                                                                            \n    []interface{}{1, 2, 3, 4},                                                                                                                                                                                 \n    map[string]interface{}{\"a\": 2, \"b\": 3},                                                                                                                                                                    \n}\n</code></pre>\n\n<p>How should I marshal message to have a JSON like this?</p>\n\n<pre><code>[[1,2,3,4], {\"a\": 2, \"b\":3}]\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1542625304, "post_id": 53373171, "comment_id": 93622295, "body": "there is no way other than using <code>reflect</code> package, but I strongly suggest change your approach"}, {"owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1542625593, "post_id": 53373171, "comment_id": 93622429, "body": "Can I ask why? The PDF package is Gofpdf, to generate a table it basically &#39;draws&#39; individual cells and then stitches them together, meaning you have to get the individual cell width"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 1, "creation_date": 1542626235, "post_id": 53373171, "comment_id": 93622778, "body": "@danicheeta: Why? Reflection is necessary for this problem anyway."}], "answers": [{"comments": [{"owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "edited": false, "score": 0, "creation_date": 1542625610, "post_id": 53373246, "comment_id": 93622442, "body": "Thanks, i&#39;ll try this"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1542626250, "post_id": 53373246, "comment_id": 93622784, "body": "This question is about Go."}], "tags": [], "owner": {"reputation": 366, "user_id": 1482526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e9a74b9f67520aea3a1940065679e7?s=128&d=identicon&r=PG", "display_name": "Shiju", "link": "https://stackoverflow.com/users/1482526/shiju"}, "is_accepted": false, "score": -2, "last_activity_date": 1542636852, "last_edit_date": 1542636852, "creation_date": 1542625447, "answer_id": 53373246, "question_id": 53373171, "link": "https://stackoverflow.com/questions/53373171/how-can-i-count-the-number-of-properties-in-a-struct-or-json-document/53373246#53373246", "title": "How can I count the number of properties in a struct or JSON document?", "body": "<p>The <code>Object.getOwnPropertyNames(object)</code> will return an array of property name for the given object</p>\n"}, {"tags": [], "owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "is_accepted": true, "score": 8, "last_activity_date": 1542626630, "last_edit_date": 1542626630, "creation_date": 1542625948, "answer_id": 53373383, "question_id": 53373171, "link": "https://stackoverflow.com/questions/53373171/how-can-i-count-the-number-of-properties-in-a-struct-or-json-document/53373383#53373383", "title": "How can I count the number of properties in a struct or JSON document?", "body": "<pre><code>reflect.TypeOf(Person{}).NumField()\n</code></pre>\n\n<p>or</p>\n\n<pre><code> len(structs.Map(Person{}))\n</code></pre>\n\n<p>(you need to import \"github.com/fatih/structs\")</p>\n"}], "owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 0, "accepted_answer_id": 53373383, "answer_count": 2, "score": 1, "last_activity_date": 1542636852, "creation_date": 1542625185, "question_id": 53373171, "link": "https://stackoverflow.com/questions/53373171/how-can-i-count-the-number-of-properties-in-a-struct-or-json-document", "title": "How can I count the number of properties in a struct or JSON document?", "body": "<p>I'm making a PDF generator in Go and one of the sections of it will be a table. To create a table I need to state the width of the columns, and this will be done by getting the page width (minus margins) and dividing by the number of columns in the table</p>\n\n<p>The columns in the table are defined in a struct like this:</p>\n\n<pre><code>type Person struct {\n    Name    string `json:\"Name\"`\n    Age     string `json:\"Age\"`\n    Comment string `json:\"Comment\"`\n}\n</code></pre>\n\n<p>And JSON is unmarshalled into it</p>\n\n<p>I don't want to have to hardcode '3' as the column number into my code and want to know how I can programmatically count the properties either in from the JSON or the struct itself</p>\n\n<p>I've spent a few days searching now, and all results focus on people having trouble getting the values, but I want the keys!</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1542623192, "post_id": 53372531, "comment_id": 93621144, "body": "Are you by any chance running <code>go build</code> with a differnet user (e.g. <code>root</code>)? Different users have different environments."}, {"owner": {"reputation": 7313, "user_id": 109960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f6830f73ecf9a6bda6d1fe61f2655cf0?s=128&d=identicon&r=PG", "display_name": "Eric Fortin", "link": "https://stackoverflow.com/users/109960/eric-fortin"}, "edited": false, "score": 0, "creation_date": 1542623880, "post_id": 53372531, "comment_id": 93621523, "body": "Is the package listed as not found one of yours?"}, {"owner": {"reputation": 1, "user_id": 4440528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5049b3736ac56f96ff669a2d35a48d0?s=128&d=identicon&r=PG&f=1", "display_name": "BitterJohnBob", "link": "https://stackoverflow.com/users/4440528/bitterjohnbob"}, "reply_to_user": {"reputation": 7313, "user_id": 109960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f6830f73ecf9a6bda6d1fe61f2655cf0?s=128&d=identicon&r=PG", "display_name": "Eric Fortin", "link": "https://stackoverflow.com/users/109960/eric-fortin"}, "edited": false, "score": 0, "creation_date": 1542624533, "post_id": 53372531, "comment_id": 93621903, "body": "@Eric, no it&#39;s not my own package. @i"}, {"owner": {"reputation": 1, "user_id": 4440528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5049b3736ac56f96ff669a2d35a48d0?s=128&d=identicon&r=PG&f=1", "display_name": "BitterJohnBob", "link": "https://stackoverflow.com/users/4440528/bitterjohnbob"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1542624590, "post_id": 53372531, "comment_id": 93621934, "body": "@icza I&#39;m running build with the same user as far as I can tell"}, {"owner": {"reputation": 7313, "user_id": 109960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f6830f73ecf9a6bda6d1fe61f2655cf0?s=128&d=identicon&r=PG", "display_name": "Eric Fortin", "link": "https://stackoverflow.com/users/109960/eric-fortin"}, "edited": false, "score": 0, "creation_date": 1542624623, "post_id": 53372531, "comment_id": 93621952, "body": "@BitterJohnBob Did you <code>get</code> the package?"}, {"owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 1, "creation_date": 1542624763, "post_id": 53372531, "comment_id": 93622017, "body": "use  <b><i>go get -u github.com/foo/bar</i></b>  in order to download the missing repository."}, {"owner": {"reputation": 1, "user_id": 4440528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5049b3736ac56f96ff669a2d35a48d0?s=128&d=identicon&r=PG&f=1", "display_name": "BitterJohnBob", "link": "https://stackoverflow.com/users/4440528/bitterjohnbob"}, "edited": false, "score": 0, "creation_date": 1542624834, "post_id": 53372531, "comment_id": 93622059, "body": "Actually, since I&#39;m trying to build to /usr/bin/, I am running the build cmd with sudo. I&#39;m guessing this means the command is being run by root?"}, {"owner": {"reputation": 7313, "user_id": 109960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f6830f73ecf9a6bda6d1fe61f2655cf0?s=128&d=identicon&r=PG", "display_name": "Eric Fortin", "link": "https://stackoverflow.com/users/109960/eric-fortin"}, "edited": false, "score": 0, "creation_date": 1542624923, "post_id": 53372531, "comment_id": 93622112, "body": "Yes it is. You should have installed go in <code>&#47;usr&#47;local&#47;bin</code>"}, {"owner": {"reputation": 1, "user_id": 4440528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5049b3736ac56f96ff669a2d35a48d0?s=128&d=identicon&r=PG&f=1", "display_name": "BitterJohnBob", "link": "https://stackoverflow.com/users/4440528/bitterjohnbob"}, "reply_to_user": {"reputation": 7313, "user_id": 109960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f6830f73ecf9a6bda6d1fe61f2655cf0?s=128&d=identicon&r=PG", "display_name": "Eric Fortin", "link": "https://stackoverflow.com/users/109960/eric-fortin"}, "edited": false, "score": 0, "creation_date": 1542625337, "post_id": 53372531, "comment_id": 93622311, "body": "@EricFortin Thank you, that solves it."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1542626126, "post_id": 53372531, "comment_id": 93622716, "body": "Do not use sudo !"}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1542651536, "post_id": 53373457, "comment_id": 93636678, "body": "You can also run it with <code>sudo -E</code>, which retains your existing environment variables for the command.  That said, you are correct, you should not need to run it via <code>sudo</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 4440528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5049b3736ac56f96ff669a2d35a48d0?s=128&d=identicon&r=PG&f=1", "display_name": "BitterJohnBob", "link": "https://stackoverflow.com/users/4440528/bitterjohnbob"}, "is_accepted": true, "score": 0, "last_activity_date": 1542640389, "last_edit_date": 1542640389, "creation_date": 1542626175, "answer_id": 53373457, "question_id": 53372531, "link": "https://stackoverflow.com/questions/53372531/not-using-the-gopath-specified-in-go-env/53373457#53373457", "title": "Not using the $GOPATH specified in &quot;go env&quot;", "body": "<p>Since I was running the the command </p>\n\n<pre><code>$ sudo go build -o /usr/bin/\n</code></pre>\n\n<p>with <code>sudo</code> prefixed, it was running as the <code>root</code> user, causing a different <code>$GOPATH</code> to be used. </p>\n\n<p>As Eric said, I should instead build to <code>/usr/local/bin</code> where <code>sudo</code> can be omitted.</p>\n\n<pre><code>$ go build /usr/local/bin\n</code></pre>\n\n<p>Works!</p>\n"}], "owner": {"reputation": 1, "user_id": 4440528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5049b3736ac56f96ff669a2d35a48d0?s=128&d=identicon&r=PG&f=1", "display_name": "BitterJohnBob", "link": "https://stackoverflow.com/users/4440528/bitterjohnbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 53373457, "answer_count": 1, "score": -2, "last_activity_date": 1542640389, "creation_date": 1542622940, "last_edit_date": 1542625223, "question_id": 53372531, "link": "https://stackoverflow.com/questions/53372531/not-using-the-gopath-specified-in-go-env", "title": "Not using the $GOPATH specified in &quot;go env&quot;", "body": "<p>I've got</p>\n\n<blockquote>\n  <p>export GOPATH=$HOME/Documents/go</p>\n</blockquote>\n\n<p>in my .zshrc.</p>\n\n<p>When trying to build a project with the following:</p>\n\n<blockquote>\n  <p>sudo go build -o /usr/bin/</p>\n</blockquote>\n\n<p>I get a</p>\n\n<pre><code>main.go:5:2: cannot find package \"github.com/foo/bar\" in any of:\n    /usr/local/go/src/github.com/foo/bar (from $GOROOT)\n    /Users/JoahJoah/go/src/github.com/foo/bar (from $GOPATH)\n</code></pre>\n\n<p>I am assuming the \"(from $GOPATH)\" means the path is whatever I've set my $GOPATH variable to. And </p>\n\n<blockquote>\n  <p>go env</p>\n</blockquote>\n\n<p>outputs the following:</p>\n\n<pre><code>GOPATH=\"/Users/Johannes/Documents/go\"\n</code></pre>\n\n<p>The \"Documents\" part of the path seems to be omitted when using go build. </p>\n\n<p>Is build using a GOPATH from somewhere else?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1542621976, "post_id": 53372233, "comment_id": 93620460, "body": "Just because you name a variable or type &quot;...Slice&quot; dosn&#39;t mkae it a slice. Your errSlice is of type ErrSlice which is not a slice but a struct. This struct contains a slice named <code>Errors</code> and you can append to that slice."}, {"owner": {"reputation": 63, "user_id": 7627169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639dcf5756a424ceac3f3c11f1f0b043?s=128&d=identicon&r=PG&f=1", "display_name": "Berimbolo", "link": "https://stackoverflow.com/users/7627169/berimbolo"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542622302, "post_id": 53372233, "comment_id": 93620658, "body": "@Volker Thanks. I tried <code>errorsTest := append(errSlice.Errors, err1)</code> and it appends to the slice inside of errSlice but the json tag is still missing."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1542622643, "post_id": 53372233, "comment_id": 93620838, "body": "I have no idea what the json tag has to do with all this."}, {"owner": {"reputation": 63, "user_id": 7627169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639dcf5756a424ceac3f3c11f1f0b043?s=128&d=identicon&r=PG&f=1", "display_name": "Berimbolo", "link": "https://stackoverflow.com/users/7627169/berimbolo"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542623801, "post_id": 53372233, "comment_id": 93621475, "body": "@Volker, I&#39;m trying to model the example JSON I posted above and the key &quot;errors&quot; has a value of an array of objects."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1542652253, "post_id": 53372824, "comment_id": 93636986, "body": "You&#39;re overcomplicating it a bit.  You can append directly to the <code>Errors</code> slice field without creating a separate variable.  Example (modified a bit so it can run and output properly in the playground): <a href=\"https://play.golang.org/p/qTl80eVHuYJ\" rel=\"nofollow noreferrer\">play.golang.org/p/qTl80eVHuYJ</a>"}], "tags": [], "owner": {"reputation": 63, "user_id": 7627169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639dcf5756a424ceac3f3c11f1f0b043?s=128&d=identicon&r=PG&f=1", "display_name": "Berimbolo", "link": "https://stackoverflow.com/users/7627169/berimbolo"}, "is_accepted": false, "score": 0, "last_activity_date": 1542623962, "creation_date": 1542623962, "answer_id": 53372824, "question_id": 53372233, "link": "https://stackoverflow.com/questions/53372233/append-to-slice-of-struct/53372824#53372824", "title": "Append to slice of struct", "body": "<p>I figured out a way to get the required format but I'm sure there is a cleaner way to implement this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"net/http\"\n)\n\n// Err struct are individual errors\ntype Err struct {\n    Status string `json:\"status\"`\n    Source Source `json:\"source\"`\n    Title  string `json:\"title\"`\n    Detail string `json:\"detail\"`\n}\n\n// Source is a struct for source inside an error\ntype Source struct {\n    Pointer string `json:\"pointer\"`\n}\n\n// JSONErrors stores the json error data\ntype JSONErrors struct {\n    Errors []Err `json:\"errors\"`\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", foo)\n    http.ListenAndServe(\":9001\", nil)\n}\n\nfunc foo(w http.ResponseWriter, r *http.Request) {\n\n    // Create slice of errors\n    errSlice := []Err{}\n\n    // New error\n    err1 := Err{\n        Status: \"422\",\n        Source: Source{\n            Pointer: \"/data/attributes/firstName\",\n        },\n        Title:  \"Invalid Attribute\",\n        Detail: \"First name must contain at least three characters.\",\n    }\n\n    // Append to error slice\n    errSlice = append(errSlice, err1)\n\n    // Assign errSlice to JSONErrors\n    jsonErrRes := JSONErrors{Errors: errSlice}\n\n    // Marshall errSlice\n    jsonErrSlice, _ := json.Marshal(jsonErrRes)\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.WriteHeader(http.StatusUnprocessableEntity)\n    w.Write(jsonErrSlice)\n\n    // Results:\n    // {\n    //  \"errors\": [\n    //      {\n    //          \"status\": \"422\",\n    //          \"source\": {\n    //              \"pointer\": \"/data/attributes/firstName\"\n    //          },\n    //          \"title\": \"Invalid Attribute\",\n    //          \"detail\": \"First name must contain at least three characters.\"\n    //      }\n    //  ]\n    // }\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7627169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639dcf5756a424ceac3f3c11f1f0b043?s=128&d=identicon&r=PG&f=1", "display_name": "Berimbolo", "link": "https://stackoverflow.com/users/7627169/berimbolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542623962, "creation_date": 1542621807, "last_edit_date": 1542621983, "question_id": 53372233, "link": "https://stackoverflow.com/questions/53372233/append-to-slice-of-struct", "title": "Append to slice of struct", "body": "<p>I'm having issues initializing a slice of struct and adding to it.</p>\n\n<p>I'm trying to model the below JSON so I created struct called Error for individual errors and a slice of Errors to hold them. I know I can do <code>errSlice := []Err{}</code> but that won't show the JSON tag.</p>\n\n<pre><code>{\n  \"errors\": [\n    {\n      \"status\": \"422\",\n      \"source\": { \"pointer\": \"/data/attributes/firstName\" },\n      \"title\":  \"Invalid Attribute\",\n      \"detail\": \"First name must contain at least three characters.\"\n    }\n  ]\n}\n</code></pre>\n\n<p>My attempt:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"net/http\"\n)\n\n// ErrSlice is a slice of type Err\ntype ErrSlice struct {\n    Errors []Err `json:\"errors\"`\n}\n\n// Err is an error\ntype Err struct {\n    Status string `json:\"status\"`\n    Source Source `json:\"source\"`\n    Title  string `json:\"title\"`\n    Detail string `json:\"detail\"`\n}\n\n// Source is struct of error source\ntype Source struct {\n    Pointer string `json:\"pointer\"`\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", foo)\n    http.ListenAndServe(\":9001\", nil)\n}\n\nfunc foo(w http.ResponseWriter, r *http.Request) {\n\n    errSlice := ErrSlice{}\n\n    // New error\n    err1 := Err{\n        Status: \"422\",\n        Source: Source{\n            Pointer: \"/data/attributes/firstName\",\n        },\n        Title:  \"Invalid Attribute\",\n        Detail: \"First name must contain at least three characters.\",\n    }\n\n    // Append err1 to errSlice\n    errSlice = append(errSlice, err1) // error: \"first argument to append must be slice\"\n\n    // Marshall errSlice\n    jsonErrSlice, _ := json.Marshal(errSlice)\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.WriteHeader(http.StatusUnprocessableEntity)\n    w.Write(jsonErrSlice)\n}\n</code></pre>\n\n<p>Thanks for your time!</p>\n"}, {"tags": ["git", "go", "github"], "comments": [{"owner": {"reputation": 91157, "user_id": 1755598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S6a50.jpg?s=128&g=1", "display_name": "CodeWizard", "link": "https://stackoverflow.com/users/1755598/codewizard"}, "edited": false, "score": 0, "creation_date": 1542614848, "post_id": 53370392, "comment_id": 93617018, "body": "Are u member of the project? Are u using Docker? proxy?"}, {"owner": {"reputation": 405, "user_id": 5772586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Phgjt.jpg?s=128&g=1", "display_name": "Cain", "link": "https://stackoverflow.com/users/5772586/cain"}, "reply_to_user": {"reputation": 91157, "user_id": 1755598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S6a50.jpg?s=128&g=1", "display_name": "CodeWizard", "link": "https://stackoverflow.com/users/1755598/codewizard"}, "edited": false, "score": 0, "creation_date": 1542616147, "post_id": 53370392, "comment_id": 93617496, "body": "I am not a member of the project. But it is open-source, everyone can download. I am using a proxy."}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1542616215, "post_id": 53370392, "comment_id": 93617533, "body": "are you inside a container or vm ?"}, {"owner": {"reputation": 405, "user_id": 5772586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Phgjt.jpg?s=128&g=1", "display_name": "Cain", "link": "https://stackoverflow.com/users/5772586/cain"}, "edited": false, "score": 0, "creation_date": 1542616253, "post_id": 53370392, "comment_id": 93617551, "body": "I am using Win 10. Not in a container or vm."}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1542618052, "post_id": 53370392, "comment_id": 93618326, "body": "Are you in China or Russia? Could be something like this? <a href=\"https://github.com/northbright/Notes/blob/master/Golang/china/get-golang-packages-on-golang-org-in-china.md\" rel=\"nofollow noreferrer\">github.com/northbright/Notes/blob/master/Golang/china/&hellip;</a>"}, {"owner": {"reputation": 405, "user_id": 5772586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Phgjt.jpg?s=128&g=1", "display_name": "Cain", "link": "https://stackoverflow.com/users/5772586/cain"}, "edited": false, "score": 0, "creation_date": 1542618622, "post_id": 53370392, "comment_id": 93618566, "body": "I&#39;m in China. But I set a proxy for git. So my ip is in USA."}, {"owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 0, "creation_date": 1542625060, "post_id": 53370392, "comment_id": 93622182, "body": "I suppose the Ip range for your country is blocked by the destination web site. use Openvpn or other type of proxies.to change your ip address"}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 5772586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Phgjt.jpg?s=128&g=1", "display_name": "Cain", "link": "https://stackoverflow.com/users/5772586/cain"}, "edited": false, "score": 0, "creation_date": 1542678324, "post_id": 53372277, "comment_id": 93646093, "body": "Thanks, but it doesn&#39;t work for me. I added sslVersion to both http &amp; https."}], "tags": [], "owner": {"reputation": 552, "user_id": 606880, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f0039481cbb27fea7ef2a47764e5335f?s=128&d=identicon&r=PG", "display_name": "viggy", "link": "https://stackoverflow.com/users/606880/viggy"}, "is_accepted": false, "score": 0, "last_activity_date": 1542621924, "creation_date": 1542621924, "answer_id": 53372277, "question_id": 53370392, "link": "https://stackoverflow.com/questions/53370392/remote-error-tls-access-denied-with-go-get/53372277#53372277", "title": "remote error: tls: access denied with go get", "body": "<p>From what I understand, you need to ask git to use a specific version of ssl,</p>\n\n<pre><code>sslVersion = tlsv1.2\n</code></pre>\n\n<p>which handles the tls issue.</p>\n\n<p>The following command should help:</p>\n\n<pre><code>git config --global --add htttp.sslVersion tlsv1.2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 567, "user_id": 1323283, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c9285b037ead94c1bc37cb7bb647a021?s=128&d=identicon&r=PG", "display_name": "tedyyu", "link": "https://stackoverflow.com/users/1323283/tedyyu"}, "edited": false, "score": 0, "creation_date": 1577160256, "post_id": 57551990, "comment_id": 105107881, "body": "Yes, exactly. On windows, use set http_proxy=xxxx and https_proxy=xxx, or set them via system settings dialog. Restarting cmd window is required."}], "tags": [], "owner": {"reputation": 405, "user_id": 5772586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Phgjt.jpg?s=128&g=1", "display_name": "Cain", "link": "https://stackoverflow.com/users/5772586/cain"}, "is_accepted": true, "score": 1, "last_activity_date": 1566198881, "creation_date": 1566198881, "answer_id": 57551990, "question_id": 53370392, "link": "https://stackoverflow.com/questions/53370392/remote-error-tls-access-denied-with-go-get/57551990#57551990", "title": "remote error: tls: access denied with go get", "body": "<p>Fixed by \"export http_proxy=*****\"</p>\n"}], "owner": {"reputation": 405, "user_id": 5772586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Phgjt.jpg?s=128&g=1", "display_name": "Cain", "link": "https://stackoverflow.com/users/5772586/cain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 57551990, "answer_count": 2, "score": 0, "last_activity_date": 1566198881, "creation_date": 1542613956, "last_edit_date": 1542614784, "question_id": 53370392, "link": "https://stackoverflow.com/questions/53370392/remote-error-tls-access-denied-with-go-get", "title": "remote error: tls: access denied with go get", "body": "<p>I cannot use <code>go get</code> to download <code>k8s.io/client-go/...</code>, but I can download others such as <code>github.com/nsf/gocode</code>. </p>\n\n<p>So I think my configuration about git and go are correct.<br>\nI don't know why this happens? </p>\n\n<p>Any ideas how to fix it?</p>\n\n<pre><code>$ git version\ngit version 2.19.1.windows.1\n\n$ go version\ngo version go1.11.2 windows/amd64\n\n$ go env\nset GOARCH=amd64\nset GOBIN=\nset GOCACHE=C:\\Users\\zhongtao\\AppData\\Local\\go-build\nset GOEXE=.exe\nset GOFLAGS=\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=C:\\Users\\zhongtao\\go\nset GOPROXY=\nset GORACE=\nset GOROOT=C:\\Software\\Go\nset GOTMPDIR=\nset GOTOOLDIR=C:\\Software\\Go\\pkg\\tool\\windows_amd64\nset GCCGO=gccgo\nset CC=gcc\nset CXX=g++\nset CGO_ENABLED=1\nset GOMOD=\nset CGO_CFLAGS=-g -O2\nset CGO_CPPFLAGS=\nset CGO_CXXFLAGS=-g -O2\nset CGO_FFLAGS=-g -O2\nset CGO_LDFLAGS=-g -O2\nset PKG_CONFIG=pkg-config\nset GOGCCFLAGS=-m64 -mthreads -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=C:\\Users\\zhongtao\\AppData\\LoTemp\\go-build041230430=/tmp/go-build -gno-record-gcc-switches\n\n$ go get -u -v github.com/nsf/gocode\ngithub.com/nsf/gocode (download)\ngithub.com/nsf/gocode\n\n$ go get -u -v k8s.io/client-go/...\nFetching https://k8s.io/client-go?go-get=1\nhttps fetch failed: Get https://k8s.io/client-go?go-get=1: remote error: tls: access denied\npackage k8s.io/client-go/...: unrecognized import path \"k8s.io/client-go/...\" (https fetch: Get https://k8s.io/client-go?go-get=1: remote r: tls: access denied)\n</code></pre>\n"}, {"tags": ["android", "go", "stack-trace", "crashlytics", "google-fabric"], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 4863390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXU9p.jpg?s=128&g=1", "display_name": "Romain Xie", "link": "https://stackoverflow.com/users/4863390/romain-xie"}, "is_accepted": true, "score": 4, "last_activity_date": 1542982754, "last_edit_date": 1592644375, "creation_date": 1542982754, "answer_id": 53448367, "question_id": 53370341, "link": "https://stackoverflow.com/questions/53370341/how-to-get-the-stack-trace-of-golang-in-the-crashlytics/53448367#53448367", "title": "How to get the Stack-trace of golang in the Crashlytics", "body": "<p>We have been resolved this issue.</p>\n<p>The background:</p>\n<blockquote>\n<p>We build a Android app, it has a JNI writed by go, which is build by gomobile.\nWe use the Fabric Crashlytics to monitor the crash information.\nBut in the Crashlytics, we could not see the full stack trace information which occurred in the JNI.</p>\n</blockquote>\n<p>The Solution is:</p>\n<blockquote>\n<p>At the first, please check your NDK version, it must be <code>r17c</code> or more.</p>\n<p>Add a param <code>--work</code> in the gomobile command, like <code>gomobile bind --work YOUR-SOURCE-CODE-PATH WORK=TEMP-PATH</code>.</p>\n<p>After build successful, move the all of files in the <code>jniLibs</code> to <code>YOUR-PROJECT-PATH/app/obj</code>.</p>\n<p>At the last, do the steps list in Fabric docs.</p>\n</blockquote>\n<p>Hope our experiences can save your time :-)</p>\n"}], "owner": {"reputation": 131, "user_id": 4863390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXU9p.jpg?s=128&g=1", "display_name": "Romain Xie", "link": "https://stackoverflow.com/users/4863390/romain-xie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 53448367, "answer_count": 1, "score": 1, "last_activity_date": 1542982754, "creation_date": 1542613704, "question_id": 53370341, "link": "https://stackoverflow.com/questions/53370341/how-to-get-the-stack-trace-of-golang-in-the-crashlytics", "title": "How to get the Stack-trace of golang in the Crashlytics", "body": "<p>Our's app is a Android app, which has a JNI writed by golang. And we use the Fabric Crashlytics to track carshes. </p>\n\n<p>But, we can not get the Stack-trace information in the Crashlytics, after a crash happened in the JNI. In the Java, We can get it.</p>\n\n<p>In the Object-C for iOS app, we can upload the dSYM file to map the functions. But where can I do it with Golang?</p>\n\n<p>Does the Fabric support it?</p>\n\n<p>Now, in the Crashlytics, we can see below only:</p>\n\n<pre><code>Crashed: Thread\n0  libc.so                        0xf6f4c778 (Missing)\n1  libc.so                        0xf6f26791 (Missing)\n2  libc.so                        0xf6f23933 (Missing)\n3  (Missing)                      0x15c791e6 (Missing)\n4  libgojni.so                    0xdddd910e (Missing)\n5  libc.so                        0xf6f214ee (Missing)\n6  (Missing)                      0x15c791e6 (Missing)\n7  libgojni.so                    0xde00a8de (Missing)\n8  libgojni.so                    0xde00a93e (Missing)\n9  libgojni.so                    0xdddd8ed6 (Missing)\n</code></pre>\n"}, {"tags": ["go", "mux"], "comments": [{"owner": {"reputation": 432, "user_id": 6340231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mHxBsfkZqiQ/AAAAAAAAAAI/AAAAAAAAAtU/ToLwyfBT1HM/photo.jpg?sz=128", "display_name": "Abhay Kumar", "link": "https://stackoverflow.com/users/6340231/abhay-kumar"}, "edited": false, "score": 0, "creation_date": 1542615392, "post_id": 53369360, "comment_id": 93617216, "body": "Convert <code>func</code> name <code>getUserDetails</code> to <code>GetUserDetails</code> in <code>controller.go</code> will do the trick. Because the first letter of exported item from package should be an <b>UPPERCASE UNICODE</b>."}], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": true, "score": 7, "last_activity_date": 1542609225, "creation_date": 1542609225, "answer_id": 53369423, "question_id": 53369360, "link": "https://stackoverflow.com/questions/53369360/how-to-access-another-file-in-go/53369423#53369423", "title": "How to access another file in GO", "body": "<p>to use a function from another package, you need to export it (<code>GetUserDetails</code>)</p>\n\n<p>as said <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"noreferrer\">here</a></p>\n\n<blockquote>\n  <p>An identifier may be exported to permit access to it from another package</p>\n</blockquote>\n\n<pre><code>func GetUserDetails(w http.ResponseWriter, r *http.Request) {\n  fmt.Println(\"here\")\n  message := \"Hello World\"\n  w.Write([]byte(message))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4920, "user_id": 5401681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/852873768142712/picture?type=large", "display_name": "Inconnu", "link": "https://stackoverflow.com/users/5401681/inconnu"}, "is_accepted": false, "score": 2, "last_activity_date": 1542609662, "last_edit_date": 1542609662, "creation_date": 1542609258, "answer_id": 53369437, "question_id": 53369360, "link": "https://stackoverflow.com/questions/53369360/how-to-access-another-file-in-go/53369437#53369437", "title": "How to access another file in GO", "body": "<p>Since the getUserDetails function is in another package it cannot be accessed. Only functions starting with capital letter can be accessed. That's how encapsulation works in Go.</p>\n\n<pre><code>func GetUserDetails(w http.ResponseWriter, r *http.Request) {\n  fmt.Println(\"here\")\n  message := \"Hello World\"\n  w.Write([]byte(message))\n}\n</code></pre>\n\n<p>So in your main:</p>\n\n<pre><code>UserRouter.HandleFunc(\"\", controllers.GetUserDetails).Methods(\"GET\")\n</code></pre>\n\n<p>Language like Java, enCAPSulation in class-based OOP is achieved through private and public class variables / methods.\nIn Go, encapsulation is achieved on a package level.</p>\n\n<p>In other words, in Go, starting with capital letter for any package object (type, variable or function) will allow you to access it from another package.</p>\n"}], "owner": {"reputation": 1197, "user_id": 7425957, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6uUDFuFxTk4/AAAAAAAAAAI/AAAAAAAAA1g/klwimxRbriA/photo.jpg?sz=128", "display_name": "Atishay Jain", "link": "https://stackoverflow.com/users/7425957/atishay-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 53369423, "answer_count": 2, "score": -3, "last_activity_date": 1542610129, "creation_date": 1542608915, "last_edit_date": 1542610129, "question_id": 53369360, "link": "https://stackoverflow.com/questions/53369360/how-to-access-another-file-in-go", "title": "How to access another file in GO", "body": "<p>I'm trying to access a controller from <code>main.go</code> but I'm getting the following error:</p>\n\n<pre><code>./main.go:34:28: cannot refer to unexported name controllers.getUserDetails\n./main.go:34:28: undefined: controllers.getUserDetails\n</code></pre>\n\n<p>here's a snippet of my <code>main.go</code>, I've removed some extra code</p>\n\n<pre><code>package main\n\nimport (\n  \"net/http\"\n  \"os\"\n  \"log\"\n  \"github.com/urfave/negroni\"\n  \"github.com/gorilla/mux\"\n  \"github.com/joho/godotenv\"\n  \"Go-Social/controllers\"\n )\n\n func main() {\n   router := mux.NewRouter()\n   UserRouter := router.PathPrefix(\"/api/user\").Subrouter()\n   UserRouter.HandleFunc(\"\", controllers.getUserDetails).Methods(\"GET\")\n\n   env := os.Getenv(\"GO_ENV\")\n   if \"\" == env {\n    env = \"Development\"\n   }\n\n   // appending middlewares\n   server := negroni.Classic()\n\n   // router handler with negroni\n   server.UseHandler(router)\n\n   // starting server\n   server.Run(\":\" + os.Getenv(env + \"_PORT\"))\n\n }\n</code></pre>\n\n<p>my <code>controller.go</code> file</p>\n\n<pre><code>package controllers\n\nimport (\n  \"net/http\"\n  \"fmt\"\n)\n\nfunc getUserDetails(w http.ResponseWriter, r *http.Request) {\n  fmt.Println(\"here\")\n  message := \"Hello World\"\n  w.Write([]byte(message))\n\n}\n</code></pre>\n\n<p>Please Help I'm new to Go. Thanks in advance.</p>\n"}, {"tags": ["ubuntu", "go", "rsync", "mkdir"], "comments": [{"owner": {"reputation": 3754, "user_id": 6027873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa721a23e4aa11f8d8c4d92f0eee8cc?s=128&d=identicon&r=PG&f=1", "display_name": "hoque", "link": "https://stackoverflow.com/users/6027873/hoque"}, "edited": false, "score": 0, "creation_date": 1542611690, "post_id": 53369009, "comment_id": 93615819, "body": "In ExecuteCommand func replace <code>cmd := exec.Command(&quot;sh&quot;, &quot;-c&quot;,command)</code> with  <code>cm := []string{&quot;-c&quot;} cm = append(cm, strings.Split(command, &quot; &quot;)...)   cmd := exec.Command(&quot;sh&quot;, cm...)</code>"}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "reply_to_user": {"reputation": 3754, "user_id": 6027873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa721a23e4aa11f8d8c4d92f0eee8cc?s=128&d=identicon&r=PG&f=1", "display_name": "hoque", "link": "https://stackoverflow.com/users/6027873/hoque"}, "edited": false, "score": 0, "creation_date": 1542612073, "post_id": 53369009, "comment_id": 93615965, "body": "@hoque the solution you tell I applied it into my code and run but It gives me error of <code>exit status 1: rsync  version 3.1.2  protocol version 31 Copyright (C) 1996-2015 by Andrew Tridgell, Wayne Davison, and others. Web site: http:&#47;&#47;rsync.samba.org&#47;</code>"}, {"owner": {"reputation": 3754, "user_id": 6027873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa721a23e4aa11f8d8c4d92f0eee8cc?s=128&d=identicon&r=PG&f=1", "display_name": "hoque", "link": "https://stackoverflow.com/users/6027873/hoque"}, "edited": false, "score": 0, "creation_date": 1542612486, "post_id": 53369009, "comment_id": 93616115, "body": "Can you ensure your <code>rsync -ave --rsync-path=&#39;mkdir -p &quot; + path + &quot; &amp;&amp; rsync&#39; &quot; + filePath + &quot; ubuntu@&quot; + LocalhostIp + &quot;:&quot; + path</code> command work from your pc? And also it will be easy to me if you give the value of the variable, so that i can check."}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "reply_to_user": {"reputation": 3754, "user_id": 6027873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa721a23e4aa11f8d8c4d92f0eee8cc?s=128&d=identicon&r=PG&f=1", "display_name": "hoque", "link": "https://stackoverflow.com/users/6027873/hoque"}, "edited": false, "score": 0, "creation_date": 1542612808, "post_id": 53369009, "comment_id": 93616229, "body": "@hoque I run this <code>rsync -ave --rsync-path=&quot;mkdir -p &#47;var&#47;www&#47;html&#47;uploads&#47;ironnetwork&#47; &amp;&amp; rsync&quot; &#47;var&#47;www&#47;html&#47;uploads&#47;ironnetwork&#47;1542607804image.</code> command directly in the terminal and it will give me the error <code>sending incremental file list rsync: change_dir &quot;&#47;var&#47;www&#47;html&#47;uploads&#47;ironnetwork&quot; failed: No such file or directory (2) </code> Now Can you solve my problem?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542616167, "post_id": 53370640, "comment_id": 93617507, "body": "As you say @meuh I remove the flag <code>-e</code> and then I run the command then it will give me the error <code>exit status 1: rsync  version 3.1.2  protocol version 31 Copyright (C) 1996-2015 by Andrew Tridgell, Wayne Davison, and others.</code>"}, {"owner": {"reputation": 8543, "user_id": 5008284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvSMy.jpg?s=128&g=1", "display_name": "meuh", "link": "https://stackoverflow.com/users/5008284/meuh"}, "reply_to_user": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542616985, "post_id": 53370640, "comment_id": 93617864, "body": "exit 1 is a syntax error in the arguments. Perhaps your <code>path</code> or <code>filePath</code> strings have characters that are being interpreted by the shell. Try adding <code>-x</code>  in your ExecuteCommand, (<code>cmd := exec.Command(&quot;sh&quot;, &quot;-xc&quot;,command)</code>)  to see what is actually being passed to rsync."}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542617332, "post_id": 53370640, "comment_id": 93618017, "body": "now it will print this <code>exit status 1: + rsync  rsync  version 3.1.2  protocol version 31</code>"}, {"owner": {"reputation": 8543, "user_id": 5008284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvSMy.jpg?s=128&g=1", "display_name": "meuh", "link": "https://stackoverflow.com/users/5008284/meuh"}, "reply_to_user": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542617963, "post_id": 53370640, "comment_id": 93618286, "body": "I don&#39;t know the <i>go</i> language, so I cannot help you with this. You are not getting the entire error message. Perhaps you introduced a typing error when you converted the <code>-ave</code> to <code>-av</code>."}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542618168, "post_id": 53370640, "comment_id": 93618370, "body": "Can you tell me how I run this command successfully on ubuntu terminal? @meuh"}, {"owner": {"reputation": 8543, "user_id": 5008284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvSMy.jpg?s=128&g=1", "display_name": "meuh", "link": "https://stackoverflow.com/users/5008284/meuh"}, "reply_to_user": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542618563, "post_id": 53370640, "comment_id": 93618538, "body": "I presume you should be typing a command like: <code>rsync -av --rsync-path=&quot;mkdir -p &#47;var&#47;www&#47;html&#47;uploads&#47;ironnetwork&#47; &amp;&amp; rsync&quot; &#47;var&#47;www&#47;html&#47;uploads&#47;ironnetwork&#47;1542607804image ubuntu@remotehost:&#47;var&#47;www&#47;html&#47;uploads&#47;ironnetwork&#47;</code>"}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542618736, "post_id": 53370640, "comment_id": 93618634, "body": "it was asking for the password what should I write there?"}, {"owner": {"reputation": 8543, "user_id": 5008284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvSMy.jpg?s=128&g=1", "display_name": "meuh", "link": "https://stackoverflow.com/users/5008284/meuh"}, "reply_to_user": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542620784, "post_id": 53370640, "comment_id": 93619737, "body": "This has gone too far away from the original question. I suggest you look back at what you are trying to achieve, simplify it, and start a new question, referring back to this one if appropriate."}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542620986, "post_id": 53370640, "comment_id": 93619855, "body": "actually I told  you what I gona achieve is that I want to write an image from the live <a href=\"https://loctest.bookingkoala.co.in/uploads/loctest/2018/11/17/1542430701aaa.jpg\" rel=\"nofollow noreferrer\">this</a> image into my desktop using rsync command. Can you help me to do this?"}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1542621425, "post_id": 53370640, "comment_id": 93620136, "body": "see <a href=\"https://stackoverflow.com/questions/53372121/how-to-write-a-image-from-the-live-url-into-local-system-using-rsync\">this</a> question"}], "tags": [], "owner": {"reputation": 8543, "user_id": 5008284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AvSMy.jpg?s=128&g=1", "display_name": "meuh", "link": "https://stackoverflow.com/users/5008284/meuh"}, "is_accepted": false, "score": 0, "last_activity_date": 1542615267, "creation_date": 1542615267, "answer_id": 53370640, "question_id": 53369009, "link": "https://stackoverflow.com/questions/53369009/how-to-solve-the-error-of-the-rsync-error-error-in-ipc-code-code-14-at-pipe-c/53370640#53370640", "title": "How to solve the error of the rsync error: error in IPC code (code 14) at pipe.c(85) [sender=3.1.2]", "body": "<p>You need to remove the <code>-e</code> option, as this is taking the following work (<code>--rsync-path=...</code>) as the replacement for the ssh command. For example, </p>\n\n<pre><code>$ rsync -ave --x_x  /tmp/a abc@localhost:/tmp/y\nrsync: Failed to exec --x_x: No such file or directory (2)\n</code></pre>\n\n<p>Just use <code>-av</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4642, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542615267, "creation_date": 1542606791, "last_edit_date": 1592644375, "question_id": 53369009, "link": "https://stackoverflow.com/questions/53369009/how-to-solve-the-error-of-the-rsync-error-error-in-ipc-code-code-14-at-pipe-c", "title": "How to solve the error of the rsync error: error in IPC code (code 14) at pipe.c(85) [sender=3.1.2]", "body": "<p>I'm using a command of rsync for making a new directory to save the images the command is <code>&quot;rsync -ave --rsync-path='mkdir -p &quot; + path + &quot; &amp;&amp; rsync' &quot; + filePath + &quot; ubuntu@&quot; + LocalhostIp + &quot;:&quot; + path</code> but while running my code this command will gives me the error the error is</p>\n<p>Error:</p>\n<blockquote>\n<p>exit status 14: rsync: Failed to exec --rsync-path=mkdir: No such file or directory (2)</p>\n<p>rsync error: error in IPC code (code 14) at pipe.c(85) [sender=3.1.2]</p>\n<p>rsync: connection unexpectedly closed (0 bytes received so far) [sender]</p>\n<p>rsync error: error in IPC code (code 14) at io.c(235) [sender=3.1.2]</p>\n</blockquote>\n<p><strong>Edit</strong></p>\n<pre><code>func CopyUploadedFileToAppServers(filePath, path string) {\n   ExecuteCommand(&quot;rsync -ave --rsync-path='mkdir -p &quot; + path + &quot; &amp;&amp; rsync' &quot; + filePath + &quot; ubuntu@&quot; + LocalhostIp + &quot;:&quot; + path)\n}\n\nfunc ExecuteCommand(command string) error{\n cmd := exec.Command(&quot;sh&quot;, &quot;-c&quot;,command)\n var out bytes.Buffer\n var stderr bytes.Buffer\n cmd.Stdout = &amp;out\n cmd.Stderr = &amp;stderr\n\n err := cmd.Run()\n\n if err != nil {\n    fmt.Println(fmt.Sprint(err) + &quot;: &quot; + stderr.String())\n    return err\n }\n fmt.Println(&quot;Result: &quot; + out.String())\n return nil\n}\n</code></pre>\n<p>How can I solve this error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 395, "user_id": 7055701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AxXnf.png?s=128&g=1", "display_name": "Shuai Junlan", "link": "https://stackoverflow.com/users/7055701/shuai-junlan"}, "edited": false, "score": 0, "creation_date": 1542705194, "post_id": 53368326, "comment_id": 93654635, "body": "Why do you give me so many down-votes, is it valueless?"}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 7055701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AxXnf.png?s=128&g=1", "display_name": "Shuai Junlan", "link": "https://stackoverflow.com/users/7055701/shuai-junlan"}, "edited": false, "score": 0, "creation_date": 1542604918, "post_id": 53368391, "comment_id": 93613811, "body": "What are the differences between <code>for {}</code> and <code>for true {}</code>?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 395, "user_id": 7055701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AxXnf.png?s=128&g=1", "display_name": "Shuai Junlan", "link": "https://stackoverflow.com/users/7055701/shuai-junlan"}, "edited": false, "score": 0, "creation_date": 1542605889, "post_id": 53368391, "comment_id": 93614063, "body": "@ShuaiJunlan: They are the same."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1542603519, "last_edit_date": 1542603519, "creation_date": 1542602262, "answer_id": 53368391, "question_id": 53368326, "link": "https://stackoverflow.com/questions/53368326/for-true-occurring-missing-return-at-end-of-function/53368391#53368391", "title": "&quot;for true {}&quot; occurring &quot;missing return at end of function&quot;", "body": "<p>As instructed, insert the return.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(getIntJ1())\n    fmt.Println(getIntJ2())\n}\n\nfunc getIntJ1() (j int32) {\n    for {\n        j = 20\n        if j == 21 {\n            continue\n        }\n        return\n    }\n}\n\nfunc getIntJ2() (j int32) {\n    for true {\n        j = 20\n        if j == 21 {\n            continue\n        }\n        return\n    }\n    return\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/QbYQ6NkOMpQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QbYQ6NkOMpQ</a></p>\n\n<p>Output:</p>\n\n<pre><code>20\n20\n</code></pre>\n\n<p>For <code>getIntJ1</code>, <code>for {}</code>, the <code>return</code> is never needed.  For <code>getIntJ2</code>, <code>for condition {}</code>, the <code>return</code> may be needed. The compiler could be smarter when <code>condition</code> is <code>true</code></p>\n\n<p>It's more idiomatic to write <code>for {}</code> rather than <code>for true {}</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1542603947, "creation_date": 1542603947, "answer_id": 53368610, "question_id": 53368326, "link": "https://stackoverflow.com/questions/53368326/for-true-occurring-missing-return-at-end-of-function/53368610#53368610", "title": "&quot;for true {}&quot; occurring &quot;missing return at end of function&quot;", "body": "<p>To prevent functions from running off the end without returning their return value, Go has a concept of a <a href=\"https://golang.org/ref/spec#Terminating_statements\" rel=\"noreferrer\"><em>terminating statement</em></a>. Terminating statements are certain types of statements where it can easily be shown that execution will not continue past that statement. A function with result parameters must end in a terminating statement.</p>\n\n<p>A <code>for</code> with no <code>break</code> and no loop condition counts as a terminating statement, but a <code>for</code> with a loop condition doesn't count, even if that loop condition is always true. (The rules could be expanded to count a <code>for</code> with <code>true</code> as its condition as a terminating statement, but adding too many cases makes the definition more confusing than useful.) Your second <code>getIntJ</code> definition has no terminating statement.</p>\n"}], "owner": {"reputation": 395, "user_id": 7055701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AxXnf.png?s=128&g=1", "display_name": "Shuai Junlan", "link": "https://stackoverflow.com/users/7055701/shuai-junlan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 1, "accepted_answer_id": 53368610, "answer_count": 2, "score": -4, "last_activity_date": 1542615047, "creation_date": 1542601747, "last_edit_date": 1542615047, "question_id": 53368326, "link": "https://stackoverflow.com/questions/53368326/for-true-occurring-missing-return-at-end-of-function", "title": "&quot;for true {}&quot; occurring &quot;missing return at end of function&quot;", "body": "<p>Look at the below two code snippets:<br>\n<strong>code1:</strong></p>\n\n<pre><code>func getIntJ1() (j int32) {\n    for {\n        j = 20\n        return\n    }\n}\n</code></pre>\n\n<p><strong>code2:</strong>  </p>\n\n<pre><code>func getIntJ2() (j int32) {\n    for true {\n        j = 20\n        return\n    }\n}\n</code></pre>\n\n<p>Playground : <a href=\"https://play.golang.org/p/ZnwjZDksZhu\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZnwjZDksZhu</a>  </p>\n\n<p>I think they should print the same value <code>20</code> in the console, but they can't do what I want.<br>\nThe <code>code1</code> could print value <code>20</code> in the console, but the <code>code2</code> occurs compile error: <strong><code>missing return at end of function</code></strong>.  </p>\n\n<p>All of them have an <code>infinite loop</code> in the function, why they display in different result?  </p>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 2178, "user_id": 3858203, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/Os9fr.jpg?s=128&g=1", "display_name": "samadadi", "link": "https://stackoverflow.com/users/3858203/samadadi"}, "edited": false, "score": 0, "creation_date": 1542624991, "post_id": 53368187, "comment_id": 93622151, "body": "Did you init main module &quot;go mod init &lt;module name&gt;&quot;? For better understanding go to this stackoverflow question. <a href=\"https://stackoverflow.com/questions/52328952/how-to-use-a-module-that-is-outside-of-gopath-in-another-module\" title=\"how to use a module that is outside of gopath in another module\">stackoverflow.com/questions/52328952/&hellip;</a>"}, {"owner": {"reputation": 223, "user_id": 5979069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4YMe.jpg?s=128&g=1", "display_name": "Luis.at.code", "link": "https://stackoverflow.com/users/5979069/luis-at-code"}, "reply_to_user": {"reputation": 2178, "user_id": 3858203, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/Os9fr.jpg?s=128&g=1", "display_name": "samadadi", "link": "https://stackoverflow.com/users/3858203/samadadi"}, "edited": false, "score": 0, "creation_date": 1542690384, "post_id": 53368187, "comment_id": 93648670, "body": "sorry for the bad description, my problem is to install cli tools into my $GOPATH/bin directory."}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 0, "creation_date": 1564687802, "post_id": 53368187, "comment_id": 101123447, "body": "See this related <a href=\"https://stackoverflow.com/a/57313319/11210494\">answer</a>, which covers options for Go 1.11, the related functionality added in Go 1.12, and what hopefully will be supported in Go 1.14."}], "answers": [{"comments": [{"owner": {"reputation": 223, "user_id": 5979069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4YMe.jpg?s=128&g=1", "display_name": "Luis.at.code", "link": "https://stackoverflow.com/users/5979069/luis-at-code"}, "edited": false, "score": 0, "creation_date": 1542690598, "post_id": 53368198, "comment_id": 93648732, "body": "the magic doesnt work. i already export GO111MODULE=on. what i want is to install cli tools into my $GOPATH/bin directory with GO111MODULE=on. it made the go get tool behave different after turn on the GO111MODULE."}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542600706, "creation_date": 1542600706, "answer_id": 53368198, "question_id": 53368187, "link": "https://stackoverflow.com/questions/53368187/go-modules-installing-go-tools/53368198#53368198", "title": "go modules installing go tools", "body": "<p>Try this command\n<code>GO111MODULE=on go get -u github.com/go-critic/go-critic/...</code></p>\n"}, {"comments": [{"owner": {"reputation": 3521, "user_id": 1387828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qvRfc.png?s=128&g=1", "display_name": "fuma", "link": "https://stackoverflow.com/users/1387828/fuma"}, "edited": false, "score": 1, "creation_date": 1548938258, "post_id": 53402387, "comment_id": 95729440, "body": "<a href=\"https://github.com/golang/go/wiki/Modules#why-does-installing-a-tool-via-go-get-fail-with-error-cannot-find-main-module\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a> =&gt; GO111MODULE=on  or  GO111MODULE=auto"}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 1, "creation_date": 1564700035, "post_id": 53402387, "comment_id": 101127166, "body": "FWIW, this answer <i>was</i> correct, but is no longer correct. See this  <a href=\"https://stackoverflow.com/a/57317864/11210494\">answer</a> for more details and the answer as of Go 1.12, 1.13, and the likely new option in Go 1.14 for getting a tool without it updating your go.mod. Also, that answer covers what to do if you <i>want</i> to explicitly track a tool as a versioned dependency in your go.mod (e.g., maybe because you want everyone to use the exact same version of a linter or code generator to avoid flapping due to slightly different versions of a tool in use by different people)."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 15, "last_activity_date": 1564824044, "last_edit_date": 1564824044, "creation_date": 1542751963, "answer_id": 53402387, "question_id": 53368187, "link": "https://stackoverflow.com/questions/53368187/go-modules-installing-go-tools/53402387#53402387", "title": "go modules installing go tools", "body": "<p><strong>Edit:</strong> <em>The original answer herein referred specifically to the state of the tooling in Go 1.11.  Since the release of Go 1.12, this is no longer accurate.  Please see <a href=\"https://stackoverflow.com/a/57317864/11210494\">this answer</a>, and the ones it links to, for details of handling this situation in Go 1.12 and later.</em></p>\n\n<p>If the <code>GO111MODULE</code> var is set to <code>on</code>, you have to be inside an initialized go module directory tree in order to use <code>go get</code>, even if you're trying to get a <em>tool</em> rather than a new <em>dependency</em>.  This is a known and heavily debated issue:</p>\n\n<p><a href=\"https://github.com/golang/go/issues/27643\" rel=\"noreferrer\">https://github.com/golang/go/issues/27643</a></p>\n\n<p><a href=\"https://github.com/golang/go/issues/24250\" rel=\"noreferrer\">https://github.com/golang/go/issues/24250</a></p>\n\n<p><a href=\"https://github.com/golang/go/issues/25922\" rel=\"noreferrer\">https://github.com/golang/go/issues/25922</a></p>\n\n<p>The solution, short term, is to run <code>GO111MODULE=off go get &lt;tool&gt;</code>.  This explicitly disables the module support, even if you're in a module package currently, and forces it to only utilize your GOPATH.  </p>\n\n<p>Long-term, figuring out what the best solution is to support tool install via <code>go get</code> (or another command, like <code>go install</code> with a flag) is an ongoing area of discussion with \nlittle in the way of established consensus as of yet.  However, there's a <a href=\"https://go-review.googlesource.com/c/go/+/148517/\" rel=\"noreferrer\">PR open</a> for Go 1.12 that, if accepted, will allow <code>go get</code> to simply work while outside a module, even with <code>GO111MODULE=on</code> set.</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 5, "last_activity_date": 1564734512, "last_edit_date": 1564734512, "creation_date": 1547415650, "answer_id": 54173471, "question_id": 53368187, "link": "https://stackoverflow.com/questions/53368187/go-modules-installing-go-tools/54173471#54173471", "title": "go modules installing go tools", "body": "<p>With <a href=\"https://tip.golang.org/doc/go1.12#modules\" rel=\"nofollow noreferrer\">Go 1.12</a> (February 2019), <code>GO111MODULE=on go get</code> will work.<br>\n(From <a href=\"https://github.com/golang/go/issues/24250\" rel=\"nofollow noreferrer\">issue 24250</a>)</p>\n\n<h2>Modules</h2>\n\n<blockquote>\n  <p>When <code>GO111MODULE</code> is set to <code>on</code>, the <code>go</code> command now supports module-aware operations outside of a module directory, provided that those operations do not need to resolve import paths relative to the current directory or explicitly edit the <code>go.mod</code> file.<br>\n  Commands such as <code>go get</code>, <code>go list</code>, and <code>go mod download</code> behave as if in a module with initially-empty requirements.<br>\n  In this mode, <code>go env GOMOD</code> reports the system's null device (<code>/dev/null</code> or <code>NUL</code>).</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 186, "user_id": 4599129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f2hre.jpg?s=128&g=1", "display_name": "leo", "link": "https://stackoverflow.com/users/4599129/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1559024327, "last_edit_date": 1592644375, "creation_date": 1559024327, "answer_id": 56336072, "question_id": 53368187, "link": "https://stackoverflow.com/questions/53368187/go-modules-installing-go-tools/56336072#56336072", "title": "go modules installing go tools", "body": "<p>Just had the same issue on go1.11.2. Tried to set <code>GO111MODULE=on</code>, but this couldn't fix it.</p>\n<p>My solution:</p>\n<ol>\n<li><p>Upgrade to use go 1.12.5: <a href=\"https://golang.org/doc/install?download=go1.12.5.linux-amd64.tar.gz\" rel=\"nofollow noreferrer\">https://golang.org/doc/install?download=go1.12.5.linux-amd64.tar.gz</a></p>\n<p>This can resolve <code>go: cannot find main module; see 'go help modules'</code> issue.</p>\n</li>\n<li><p>Then I got another issue <code>go: cannot use path@version syntax in GOPATH mode</code>,</p>\n<p>which can be resolved setting env <code>GO111MODULE=on</code></p>\n</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1564743096, "post_id": 57317864, "comment_id": 101140060, "body": "Interesting update, compared to my own (eventually stale) answer. Upvoted."}, {"owner": {"reputation": 3668, "user_id": 367796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/knppv.jpg?s=128&g=1", "display_name": "steinybot", "link": "https://stackoverflow.com/users/367796/steinybot"}, "edited": false, "score": 1, "creation_date": 1573172282, "post_id": 57317864, "comment_id": 103804943, "body": "I&#39;ve just spent the day trying to untangle all the problems caused by the <code>tools.go</code> hack. I would suggest that people do not use it. See <a href=\"https://github.com/golang/go/issues/33926\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/33926</a>"}, {"owner": {"reputation": 4106, "user_id": 3634032, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PDCW3.jpg?s=128&g=1", "display_name": "Sam Herrmann", "link": "https://stackoverflow.com/users/3634032/sam-herrmann"}, "edited": false, "score": 0, "creation_date": 1611716770, "post_id": 57317864, "comment_id": 116538621, "body": "For case 2, if I run <code>go mod download</code> on a freshly cloned project that has a <code>tools.go</code> file, do I then have to manually run <code>go install &lt;tool&gt;</code> for each tool listed in the <code>tools.go</code> file or is there a single <code>go</code> command that installs all tools?"}], "tags": [], "owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "is_accepted": false, "score": 16, "last_activity_date": 1564699470, "creation_date": 1564699470, "answer_id": 57317864, "question_id": 53368187, "link": "https://stackoverflow.com/questions/53368187/go-modules-installing-go-tools/57317864#57317864", "title": "go modules installing go tools", "body": "<p>Several of the other answers here have grown stale at this point.</p>\n\n<p>There are at least two cases to consider:</p>\n\n<h3>Case 1</h3>\n\n<p>You want to install a tool, but you don't want to modify your current <code>go.mod</code> to track that tool as a dependency.</p>\n\n<p>In short, with Go 1.12 or 1.13, the simplest solution is to <code>cd</code> to a directory without a <code>go.mod</code>, such as:</p>\n\n<pre><code>$ cd /tmp\n$ go get github.com/some/tool@v1.0.1\n</code></pre>\n\n<p>Alternatively, <a href=\"https://github.com/myitcv/gobin\" rel=\"noreferrer\">gobin</a> is a module-aware command to install or run binaries that provides additional flexibility, including the ability to install without altering your current module's <code>go.mod</code></p>\n\n<p>See this related <a href=\"https://stackoverflow.com/a/57313319/11210494\">answer</a> for more details, including a solution for Go 1.11, as well as the likely new option in Go 1.14 for getting a tool without it updating your <code>go.mod</code>. </p>\n\n<h3>Case 2</h3>\n\n<p>On the other hand, if you want to explicitly track a tool as a versioned dependency in your <code>go.mod</code>, then see the <a href=\"https://github.com/golang/go/wiki/Modules#how-can-i-track-tool-dependencies-for-a-module\" rel=\"noreferrer\">\"How can I track tool dependencies for a module?\"</a> FAQ on the modules wiki.</p>\n\n<p>In short, you create a <code>tools.go</code> file in a separate package, and set a <code>// +build tools</code> build tag, such as:</p>\n\n<pre><code>// +build tools\n\npackage tools\n\nimport (\n    _ \"golang.org/x/tools/cmd/stringer\"\n)\n</code></pre>\n\n<p>The import statements allow the <code>go</code> command to precisely record the version information for your tools in your module's <code>go.mod</code>, while the <code>// +build tools</code> build constraint prevents your normal builds from actually importing your tools.</p>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 4969349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781442d5439e15c85efb65ce08a22de0?s=128&d=identicon&r=PG&f=1", "display_name": "D4v1dW3bb", "link": "https://stackoverflow.com/users/4969349/d4v1dw3bb"}, "is_accepted": false, "score": 0, "last_activity_date": 1604158287, "creation_date": 1604158287, "answer_id": 64623388, "question_id": 53368187, "link": "https://stackoverflow.com/questions/53368187/go-modules-installing-go-tools/64623388#64623388", "title": "go modules installing go tools", "body": "<p>I had the same problem and it was &quot;almost&quot; solved directly. At first it did not work. This was because the module was already initialized and I had run the &quot;go get...&quot; command before I had set GO111MODULE=on.</p>\n<p>To get it working I removed &quot;go.mod&quot; reinitialized the mod by running &quot;go mod init ...&quot; and re run the necessary &quot;go get ....&quot; commands.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 8445685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CtQ24MJNy2g/AAAAAAAAAAI/AAAAAAAAADU/-oXUIzhh6OU/photo.jpg?sz=128", "display_name": "Burak \u0130brahim &#220;nal", "link": "https://stackoverflow.com/users/8445685/burak-%c4%b0brahim-%c3%9cnal"}, "edited": false, "score": 0, "creation_date": 1615287841, "post_id": 66451030, "comment_id": 117638990, "body": "Thanks a lot.It fixed my problem."}], "tags": [], "owner": {"reputation": 85, "user_id": 11559039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgbXB.jpg?s=128&g=1", "display_name": "Nazmul Haque", "link": "https://stackoverflow.com/users/11559039/nazmul-haque"}, "is_accepted": false, "score": 3, "last_activity_date": 1614747472, "creation_date": 1614747472, "answer_id": 66451030, "question_id": 53368187, "link": "https://stackoverflow.com/questions/53368187/go-modules-installing-go-tools/66451030#66451030", "title": "go modules installing go tools", "body": "<p>I faced the same issue and resolved it by the below command.</p>\n<p>$ go env -w GO111MODULE=auto</p>\n"}], "owner": {"reputation": 223, "user_id": 5979069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4YMe.jpg?s=128&g=1", "display_name": "Luis.at.code", "link": "https://stackoverflow.com/users/5979069/luis-at-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25444, "favorite_count": 13, "accepted_answer_id": 53402387, "answer_count": 7, "score": 22, "last_activity_date": 1614747472, "creation_date": 1542600553, "question_id": 53368187, "link": "https://stackoverflow.com/questions/53368187/go-modules-installing-go-tools", "title": "go modules installing go tools", "body": "<p>I'm using go modules as dependency management, and I'm having problem to install something like this:</p>\n\n<pre><code>go get -u github.com/go-critic/go-critic/...\n</code></pre>\n\n<p>the result from above was:</p>\n\n<pre><code>go: cannot find main module; see 'go help modules'\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 0, "creation_date": 1542600679, "post_id": 53368173, "comment_id": 93612884, "body": "This is probably type assertions."}, {"owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "reply_to_user": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 0, "creation_date": 1542600802, "post_id": 53368173, "comment_id": 93612904, "body": "Thank you for your help, it really saves my time."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 4, "creation_date": 1542603234, "post_id": 53368173, "comment_id": 93613423, "body": "You could save even more time by taking <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">A Tour of Go</a> for a decent introduction to the language."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1542603783, "post_id": 53368173, "comment_id": 93613550, "body": "Duplicate. The 20ths."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1542637653, "post_id": 53368173, "comment_id": 93629023, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24492868/i-do-not-understand-this-syntax\">I do not understand this syntax</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "edited": false, "score": 0, "creation_date": 1542600782, "post_id": 53368196, "comment_id": 93612901, "body": "Thanks for the answer, I really appreciate that."}, {"owner": {"reputation": 1564, "user_id": 7152771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/79oVK.jpg?s=128&g=1", "display_name": "Wanda Ichsanul Isra", "link": "https://stackoverflow.com/users/7152771/wanda-ichsanul-isra"}, "edited": false, "score": 1, "creation_date": 1565116130, "post_id": 53368196, "comment_id": 101248337, "body": "Should change the <code>ok</code> with <code>!ok</code> for better clarity. I can&#39;t edit it cause its only 1 character changes."}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 5, "last_activity_date": 1565142582, "last_edit_date": 1565142582, "creation_date": 1542600677, "answer_id": 53368196, "question_id": 53368173, "link": "https://stackoverflow.com/questions/53368173/item-tweet-in-golang-language-what-does-it-mean/53368196#53368196", "title": "item.(Tweet) in Golang language, What does it mean?", "body": "<p>It's called <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">type assertions</a>.</p>\n\n<blockquote>\n  <p>A type assertion provides access to an <strong>interface</strong> value's underlying concrete value.</p>\n</blockquote>\n\n<p>Example: </p>\n\n<pre><code>var num interface{} = 5\nvar numActual int = num.(int)\n\nfmt.Println(numActual)\n</code></pre>\n\n<p>On code above, <code>num</code> is a variable whom type is <code>interface{}</code>. It can hold any kind of value, but in example above it's storing a numeric int data, <code>5</code>.</p>\n\n<p>To get the underlying concrete value from <code>num</code>, simply add <code>.(type)</code> on the end of the variable.</p>\n\n<pre><code>num.(int)\n</code></pre>\n\n<p>You can check whether an <code>interface{}</code> variable is convertible into certain type or not, by checking the 2nd return value of the statement. Example:</p>\n\n<pre><code>if actual, ok := num.(string); !ok {\n    fmt.Println(\"num is not string\")\n    fmt.Println(\"it's a number data with value is\", actual)\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53368196, "answer_count": 1, "score": -2, "last_activity_date": 1565142582, "creation_date": 1542600448, "last_edit_date": 1542609087, "question_id": 53368173, "link": "https://stackoverflow.com/questions/53368173/item-tweet-in-golang-language-what-does-it-mean", "title": "item.(Tweet) in Golang language, What does it mean?", "body": "<p>I found the following code in Golang language </p>\n\n<pre><code>item.(Tweet)\n</code></pre>\n\n<p>I already know that there is a method for each variable. But I don't know the code above. Does anyone know? </p>\n"}, {"tags": ["go", "https", "client", "http2"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1542602553, "post_id": 53367809, "comment_id": 93613276, "body": "possible similar issue <a href=\"https://github.com/golang/go/issues/14391\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/14391</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1539, "user_id": 423292, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/682568435d3372e1385b671da7f1f793?s=128&d=identicon&r=PG", "display_name": "David Jones", "link": "https://stackoverflow.com/users/423292/david-jones"}, "edited": false, "score": 1, "creation_date": 1542659609, "post_id": 53369584, "comment_id": 93640314, "body": "It would be nice if HTTP/2 was be supported transparently, as some of the documentation suggests, but it seems that once you start adding configuration options, you lost that transparency and need to refer to http2 explicitly."}, {"owner": {"reputation": 637, "user_id": 2501230, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/G2tdp.png?s=128&g=1", "display_name": "Aryan Venkat", "link": "https://stackoverflow.com/users/2501230/aryan-venkat"}, "edited": false, "score": 0, "creation_date": 1574687162, "post_id": 53369584, "comment_id": 104308576, "body": "How do we achieve the same (forcing the client to use http2) in a webserver with Java?"}], "tags": [], "owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "is_accepted": true, "score": 4, "last_activity_date": 1542610044, "creation_date": 1542610044, "answer_id": 53369584, "question_id": 53367809, "link": "https://stackoverflow.com/questions/53367809/how-to-force-client-to-use-http-2-instead-of-falling-back-to-http-1-1/53369584#53369584", "title": "How to force client to use http/2? (instead of falling back to http 1.1)", "body": "<p>First import <code>\"golang.org/x/net/http2\"</code> package. And then change</p>\n\n<pre><code>transport := &amp;http.Transport{TLSClientConfig: tlsConfig}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>transport := &amp;http2.Transport{TLSClientConfig: tlsConfig}\n</code></pre>\n"}], "owner": {"reputation": 1539, "user_id": 423292, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/682568435d3372e1385b671da7f1f793?s=128&d=identicon&r=PG", "display_name": "David Jones", "link": "https://stackoverflow.com/users/423292/david-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2048, "favorite_count": 1, "accepted_answer_id": 53369584, "answer_count": 1, "score": 3, "last_activity_date": 1542615921, "creation_date": 1542597089, "last_edit_date": 1542615921, "question_id": 53367809, "link": "https://stackoverflow.com/questions/53367809/how-to-force-client-to-use-http-2-instead-of-falling-back-to-http-1-1", "title": "How to force client to use http/2? (instead of falling back to http 1.1)", "body": "<p>How can I force a simple Go client to use HTTP/2 and prevent it from falling back to HTTP 1.1 ?</p>\n\n<p>I have a simple HTTP/2 server running on \"localhost\" and it returns details of the request in its reply.  Here is the output using Google Chrome for this URL: <a href=\"https://localhost:40443/bananas\" rel=\"nofollow noreferrer\">https://localhost:40443/bananas</a></p>\n\n<pre><code>I like bananas!\nMethod       = GET\nURL          = /bananas\nProto        = HTTP/2.0\nHost         = localhost:40443\nRequestURI   = /bananas\n</code></pre>\n\n<p>But here is what I get for my Go client code.  You can see it falls back to HTTP 1.1</p>\n\n<pre><code>I like monkeys!\nMethod       = GET\nURL          = /monkeys\nProto        = HTTP/1.1\nHost         = localhost:40443\nRequestURI   = /monkeys\n</code></pre>\n\n<p>Below is the source code of my best attempt to contact the same server using HTTP/2, but it always falls back to HTTP 1.1</p>\n\n<pre><code>// simple http/2 client\n\npackage main\n\nimport (\n    \"crypto/tls\"\n    \"crypto/x509\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nconst (\n    certFile = \"client-cert.pem\"\n    keyFile  = \"client-key.pem\"\n    caFile   = \"server-cert.pem\"\n)\n\nfunc main() {\n    // Load client certificate\n    cert, err := tls.LoadX509KeyPair(certFile, keyFile)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Load CA cert\n    caCert, err := ioutil.ReadFile(caFile)\n    if err != nil {\n        log.Fatal(err)\n    }\n    caCertPool := x509.NewCertPool()\n    caCertPool.AppendCertsFromPEM(caCert)\n\n    // Setup HTTPS client\n    tlsConfig := &amp;tls.Config{\n        Certificates: []tls.Certificate{cert},\n        RootCAs:      caCertPool,\n    }\n    tlsConfig.BuildNameToCertificate()\n    transport := &amp;http.Transport{TLSClientConfig: tlsConfig}\n    client := &amp;http.Client{Transport: transport}\n\n    response, err := client.Get(\"https://localhost:40443/monkeys\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer response.Body.Close()\n\n    // dump response\n    text, err := ioutil.ReadAll(response.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"Body:\\n%s\", text)\n}\n</code></pre>\n\n<p>Any suggestions would be appreciated, including pointers to other working examples that illustrate how to make HTTP/2 client requests in Go.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542595062, "post_id": 53367526, "comment_id": 93611787, "body": "Every request you call the <code>health</code> function, which creates a new closure in <code>GetLine</code>. To untangle put everything in a single file and remove those extra nesting. PS: if you were slightly more successful maintaining the state between requests - your code would still be invalid due to a data race (mutating <code>n++</code>)."}, {"owner": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 0, "creation_date": 1542595408, "post_id": 53367526, "comment_id": 93611871, "body": "As a sidenote, if two users try to do request one after the other, what&#39;s the expectation. Will the first request by second user get the second line ? If not you may need to start use session"}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1542620595, "post_id": 53367631, "comment_id": 93619629, "body": "No need for a global variable - closures with a locally scoped variable could work just fine"}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542595460, "creation_date": 1542595460, "answer_id": 53367631, "question_id": 53367526, "link": "https://stackoverflow.com/questions/53367526/how-to-print-next-line-after-refresh/53367631#53367631", "title": "How to print next line after refresh?", "body": "<p>Because <code>n</code> is local variable, it's will always re-declared with the value is <code>0</code> whenever you call that <code>GetLine()</code> function. May be you need a global variable to save value of last line :D</p>\n"}], "owner": {"reputation": 1, "user_id": 10672436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20f6e789c650e923a1f0f938c60e711?s=128&d=identicon&r=PG&f=1", "display_name": "1qazxsw2", "link": "https://stackoverflow.com/users/10672436/1qazxsw2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542595460, "creation_date": 1542594521, "question_id": 53367526, "link": "https://stackoverflow.com/questions/53367526/how-to-print-next-line-after-refresh", "title": "How to print next line after refresh?", "body": "<p>I want to create a <code>/health</code> that displays each line of a song. I'm trying to display the next line of the song after refresh of the page but my code below doesn't work and I don't know what's missing.</p>\n\n<p><strong>Expectation</strong></p>\n\n<p>It should return different lines from the song after each refresh like this.</p>\n\n<pre><code>\u279c curl http://localhost:8080/health\nIt starts with one thing\n\n\u279c curl http://localhost:8080/health\nI don't know why\n\n\u279c curl http://localhost:8080/health\nIt doesn't even matter how hard you try\n</code></pre>\n\n<p><strong>Reality</strong></p>\n\n<pre><code>\u279c curl http://localhost:8080/health\nIt starts with one thing\n\n\u279c curl http://localhost:8080/health\nIt starts with one thing\n\n\u279c curl http://localhost:8080/health\nIt starts with one thing\n</code></pre>\n\n<p>Here are some lines from <code>main.go</code> and <code>testlib.go</code>.</p>\n\n<p><strong>testlib.go</strong></p>\n\n<pre><code>func GetLine() func() string {\n    n := 0\n    lines := strings.Split(readFile(), \"\\n\")\n    length := len(lines) - 1\n\n    return func() string {\n        nextLine := lines[n]\n\n        if n == length {\n            n = 0\n\n            return nextLine\n        }\n\n        n++\n        return nextLine\n    }\n}\n\nfunc Handler(next http.HandlerFunc) http.HandlerFunc {\n    return func (w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"text/plain; charset=utf-8\")\n        log.Println(r.URL.Path)\n        next.ServeHTTP(w, r)\n    }\n}\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>func health(w http.ResponseWriter, r *http.Request) {\n    line := testlib.GetLine()\n\n    fmt.Fprintln(w, line())\n}\n\nfunc main() {\n    http.Handle(\"/health\", testlib.Handler(health))\n    log.Printf(\"http://127.0.0.1:8080 is now listening.\")\n\n    if err := http.ListenAndServe(\"127.0.0.1:8080\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 71, "user_id": 10672190, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRRj0z-iqws/AAAAAAAAAAI/AAAAAAAAaN0/AEXieqkfJH8/photo.jpg?sz=128", "display_name": "Honord", "link": "https://stackoverflow.com/users/10672190/honord"}, "edited": false, "score": 0, "creation_date": 1542694205, "post_id": 53366810, "comment_id": 93649869, "body": "Sorry for the noise of scripts. I will remove them to make it a bit clean"}], "answers": [{"comments": [{"owner": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "edited": false, "score": 2, "creation_date": 1542592022, "post_id": 53366930, "comment_id": 93611275, "body": "The reader returned from <code>strings.NewReader</code> implements the <code>Seeker</code> interface so you can call <code>s.Seek(0, 0)</code> to start reading at the beginning."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "edited": false, "score": 0, "creation_date": 1542595165, "post_id": 53366930, "comment_id": 93611812, "body": "@JRLambert you&#39;re totally right I&#39;ll update my answer"}, {"owner": {"reputation": 71, "user_id": 10672190, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRRj0z-iqws/AAAAAAAAAAI/AAAAAAAAaN0/AEXieqkfJH8/photo.jpg?sz=128", "display_name": "Honord", "link": "https://stackoverflow.com/users/10672190/honord"}, "edited": false, "score": 0, "creation_date": 1542694265, "post_id": 53366930, "comment_id": 93649891, "body": "Thanks Poy.  Appreciate your answer. I will clean my script to make it a bit clean"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 5, "last_activity_date": 1542595290, "last_edit_date": 1542595290, "creation_date": 1542587996, "answer_id": 53366930, "question_id": 53366810, "link": "https://stackoverflow.com/questions/53366810/different-result-when-run-io-copyos-stdout-r-consecutively-in-golang/53366930#53366930", "title": "Different result when run io.Copy(os.Stdout, &amp;r) consecutively in Golang", "body": "<p>I'm going to prune down the given example to (as there is a bit of noise):</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    s := strings.NewReader(\"testtesttest\")\n    io.Copy(os.Stdout, s) // Will print \"testtesttest\"\n    io.Copy(os.Stdout, s) // Won't print anything\n}\n</code></pre>\n\n<p>The reason the second copy won't output anything is the <code>io.Reader</code> (<code>s</code>) has already been read. Reading from a <code>io.Reader</code> is not idempotent (you can't call it twice to get the same results). <s>It also doesn't have a way to \"reset\" it or anything.</s></p>\n\n<p>As @JRLambert pointed out you have <a href=\"https://golang.org/pkg/strings/#Reader.Seek\" rel=\"nofollow noreferrer\">s.Seek()</a> and <a href=\"https://golang.org/pkg/strings/#Reader.Reset\" rel=\"nofollow noreferrer\">s.Reset()</a> to allow you to start reading again.</p>\n"}, {"tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1542598050, "creation_date": 1542598050, "answer_id": 53367931, "question_id": 53366810, "link": "https://stackoverflow.com/questions/53366810/different-result-when-run-io-copyos-stdout-r-consecutively-in-golang/53367931#53367931", "title": "Different result when run io.Copy(os.Stdout, &amp;r) consecutively in Golang", "body": "<p>Quick addition to all the correct answers (@poy and @JRLambert) provided so far... Use <code>io.TeeReader</code> or <code>io.MultiWriter</code> for times when you would want to use <code>io.Copy</code> more than once. Below are <a href=\"https://gist.github.com/brydavis/a0cd1db30c8b84e8594a81b14dba7174\" rel=\"nofollow noreferrer\">some examples of using each</a>. </p>\n\n<p><br></p>\n\n<p><strong>Using <code>io.TeeReader</code></strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/md5\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"os\"\n)\n\nfunc main() {\n    sourceFile, _ := os.Open(\"source/ebook.pdf\")\n\n    var buf bytes.Buffer\n    tee := io.TeeReader(sourceFile, &amp;buf)\n\n    process := func(sourceReader io.Reader) {\n        targetFile, _ := os.Create(\"target/ebook.pdf\")\n        defer targetFile.Close()\n        if _, err := io.Copy(targetFile, sourceReader); err != nil {\n            fmt.Println(err)\n        }\n    }\n\n    process(tee)\n    fmt.Println(checksum(&amp;buf))\n}\n\nfunc checksum(buf *bytes.Buffer) string {\n    h := md5.New()\n    b, _ := ioutil.ReadAll(buf)\n    if _, err := h.Write(b); err != nil {\n        fmt.Println(err)\n    }\n    return hex.EncodeToString(h.Sum(nil)[:16])\n}\n</code></pre>\n\n<p><br></p>\n\n<p><strong>Using <code>io.MultiWriter</code></strong>  </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/md5\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"os\"\n)\n\nfunc main() {\n    sourceFile, _ := os.Open(\"source/ebook.pdf\")\n\n    process := func(sourceReader io.Reader) {\n        targetFile, _ := os.Create(\"target/ebook.pdf\")\n        defer targetFile.Close()\n\n        var buf1, buf2 bytes.Buffer\n        w := io.MultiWriter(targetFile, &amp;buf1, &amp;buf2)\n\n        if _, err := io.Copy(w, sourceReader); err != nil {\n            fmt.Println(err)\n        }\n\n        fmt.Println(checksum(&amp;buf1))\n        fmt.Println(checksum(&amp;buf2))\n    }\n\n    process(sourceFile)\n\n}\n\nfunc checksum(buf *bytes.Buffer) string {\n    h := md5.New()\n    b, _ := ioutil.ReadAll(buf)\n    if _, err := h.Write(b); err != nil {\n        fmt.Println(err)\n    }\n    return hex.EncodeToString(h.Sum(nil)[:16])\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10672190, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRRj0z-iqws/AAAAAAAAAAI/AAAAAAAAaN0/AEXieqkfJH8/photo.jpg?sz=128", "display_name": "Honord", "link": "https://stackoverflow.com/users/10672190/honord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1542695587, "creation_date": 1542586738, "last_edit_date": 1542695587, "question_id": 53366810, "link": "https://stackoverflow.com/questions/53366810/different-result-when-run-io-copyos-stdout-r-consecutively-in-golang", "title": "Different result when run io.Copy(os.Stdout, &amp;r) consecutively in Golang", "body": "<p>I am playing around Golang. About io.Copy\nI put 2 consecutive io.Copy in the code, but i expect it output twice result(testtesttest). But the 2nd one is nil. Can anyone help explain why? tks</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"os\"\n    \"strings\"\n    \"fmt\"\n\n)\n\ntype testReader struct {\n    w io.Reader\n    str string\n\n}\n\n\nfunc (tt *testReader) Read (b []byte) (n int, err error) {\n\n\n    io.Copy(os.Stdout, tt.w)\n     n, err = tt.w.Read(b)\n     if tt.w !=nil {\n        return 0,io.EOF\n      }\n    return\n}\n\nfunc main() {\n    s := strings.NewReader(\"testtesttest!!!\")\n    r := testReader{s,\"ttthhh\"}\n    fmt.Println(&amp;r)\n    io.Copy(os.Stdout, &amp;r)\n//  s.Seek(0,0)   // solution from Poy's answer\n    io.Copy(os.Stdout, &amp;r)\n\n}\n</code></pre>\n"}, {"tags": ["go", "decoding"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1542589003, "post_id": 53366548, "comment_id": 93610781, "body": "Do you mean an X9.37 (Image Cash Letter) file? This is a binary file format, which contains some fields which are in EBCDIC. You should read its specification and treat it accordingly."}, {"owner": {"reputation": 780, "user_id": 5261088, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8256e8a248d8bcde285d3b97f77e36b0?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyThreeSheds", "link": "https://stackoverflow.com/users/5261088/mickeythreesheds"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1542590804, "post_id": 53366548, "comment_id": 93611083, "body": "yeah, that is what I mean, been working on trying to get it read in so that I can parse it - but I don&#39;t seem to be able to parse the whole file as EBCDIC to ASCII - so that is why I can&#39;t loop over the data..."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1542591861, "post_id": 53366548, "comment_id": 93611253, "body": "Looking at the <a href=\"https://github.com/gdumoulin/goebcdic/blob/master/goebcdic.go\" rel=\"nofollow noreferrer\">source</a> suggests if the source file, testingFile.x937, is binary EBCDIC, you should use &#39;EBCDICtoASCIIofBytes&#39;, no?"}], "owner": {"reputation": 780, "user_id": 5261088, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8256e8a248d8bcde285d3b97f77e36b0?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyThreeSheds", "link": "https://stackoverflow.com/users/5261088/mickeythreesheds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542584351, "creation_date": 1542584351, "question_id": 53366548, "link": "https://stackoverflow.com/questions/53366548/x937-file-decoding-in-golang", "title": "X937 file decoding in golang?", "body": "<p>I am trying to open and parse an x937 file - which I BELIEVE is usually encoded in EBCDIC 0037. </p>\n\n<p>I am using the following library to decode the main bytes of the file : </p>\n\n<pre><code>\"github.com/gdumoulin/goebcdic\"\n</code></pre>\n\n<p>and the code I am using is as follows, for now. </p>\n\n<pre><code>// Bytes in file.\nb, _ := ioutil.ReadFile(\"testingFile.x937\")\nfmt.Println(string(goebcdic.ASCIItoEBCDICofBytes(b)))\n</code></pre>\n\n<p>But if I dump the output of my file, I still don't seem to get anything that matches what I would have thought I would be looking for.</p>\n\n<p>Any ideas on how I can work with this?</p>\n"}, {"tags": ["go", "dependency-management", "go-modules"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1542607577, "post_id": 53365811, "comment_id": 93614556, "body": "Yoe seem to have a replace directive for bitbucket.org/me/awesome only but the problem is with bitbucket.org/me/awesome/subpackageA. Do not think of a package in a folder as a subpackage: It is not. It is a standalone package <i>without</i> <i>any</i> relation to what is in the &quot;parent&quot; folder."}, {"owner": {"reputation": 27292, "user_id": 100208, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e2fda105627061de42901c671680638b?s=128&d=identicon&r=PG&f=1", "display_name": "atp", "link": "https://stackoverflow.com/users/100208/atp"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1542618695, "post_id": 53365811, "comment_id": 93618605, "body": "@Volker thanks, that was the tip that fixed this problem for me (adding other <code>replace</code> lines for subpackages). Do you want to add your comment as an answer?"}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 1, "creation_date": 1564691060, "post_id": 53365811, "comment_id": 101124623, "body": "I don&#39;t quite understand this problem statement. It seems all the packages in question here are all in the same <code>bitbucket.org&#47;me&#47;awesome</code> module, and packages within the same module should find each other automatically without needing a <code>replace</code> directive."}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 0, "creation_date": 1564691352, "post_id": 53365811, "comment_id": 101124714, "body": "(Also, <code>replace</code> directives only operate on <i>modules</i> as the left-side and right-side arguments, and not on subpackages or packages, unless a package is in the root of the module, in which case the package path and module path are the same, but even then the <code>replace</code> directive is really operating at the module level)."}, {"owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "edited": false, "score": 0, "creation_date": 1564691497, "post_id": 53365811, "comment_id": 101124754, "body": "There is a bit more <a href=\"https://stackoverflow.com/a/57314494/11210494\">here</a> on how packages find each other within the same module, and how that relates overall module structure."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 15, "last_activity_date": 1542619723, "creation_date": 1542619723, "answer_id": 53371666, "question_id": 53365811, "link": "https://stackoverflow.com/questions/53365811/using-subpackages-with-go-mod-locally/53371666#53371666", "title": "Using subpackages with go mod locally", "body": "<p>Go has no (real) notion of \"subpackage\". All packages are basically treated equal. This means that a <code>replace bitbucket.org/me/awesome</code> does not influence package <code>bitbucket.org/me/awesome/subpackageA</code> as these are two individual, unrelated packages. The folder layout does not introduce a relation of subpackageA to awsome, or the other way around *).</p>\n\n<p>So you need to add an individual replace directive for subpackageA</p>\n\n<pre><code>replace bitbucket.org/me/awesome/subpackageA =&gt; ./subpackageA\n</code></pre>\n\n<p>*) Nitpicking for absolute correctness: Folder layout does have influence for folders named <code>internal</code> (cannot be imported from other projects), for folders named <code>vendor</code> (which may contain vendored packages) and searching for a <code>go.mod</code> file stops at the repo root.  </p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 1, "last_activity_date": 1609350182, "creation_date": 1609350182, "answer_id": 65511256, "question_id": 53365811, "link": "https://stackoverflow.com/questions/53365811/using-subpackages-with-go-mod-locally/65511256#65511256", "title": "Using subpackages with go mod locally", "body": "<p>For another approach, you can have <code>go.mod</code> like this:</p>\n<pre><code>module awesome\n</code></pre>\n<p>Then call subpackage like this:</p>\n<pre><code>import &quot;awesome/subpackageA&quot;\n</code></pre>\n<p><a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html</a></p>\n"}], "owner": {"reputation": 27292, "user_id": 100208, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e2fda105627061de42901c671680638b?s=128&d=identicon&r=PG&f=1", "display_name": "atp", "link": "https://stackoverflow.com/users/100208/atp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7069, "favorite_count": 3, "accepted_answer_id": 53371666, "answer_count": 2, "score": 12, "last_activity_date": 1609350182, "creation_date": 1542577832, "last_edit_date": 1542583060, "question_id": 53365811, "link": "https://stackoverflow.com/questions/53365811/using-subpackages-with-go-mod-locally", "title": "Using subpackages with go mod locally", "body": "<p>I have a go package located on my filesystem (not in the <code>$GOPATH</code>), called <code>bitbucket.org/me/awesome</code>. </p>\n\n<pre><code>~/awesome&gt; tree\n.\n\u251c\u2500\u2500 main.go\n\u251c\u2500\u2500 go.mod\n\u251c\u2500\u2500 go.sum\n\u251c\u2500\u2500 subpackageA\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n</code></pre>\n\n<p>My <code>go.mod</code> looks like:</p>\n\n<pre><code>module bitbucket.org/me/awesome\n\nrequire (\n       ... # lots of external dependencies\n)\n\nreplace bitbucket.org/me/awesome =&gt; ./\n</code></pre>\n\n<p>In <code>main.go</code> in my top-level directory, I call a subpackage like follows:</p>\n\n<pre><code>import \"bitbucket.org/me/awesome/subpackageA\"\n</code></pre>\n\n<p>which all seems pretty normal. <code>go get</code> works. However, when I clone this entire repository somewhere else (say in a Docker image) and run <code>go get</code> for the first time, I get errors like: </p>\n\n<p><code>package bitbucket.org/me/awesome/subpackageA: https://api.bitbucket.org/2.0/repositories/me/awesome?fields=scm: 403 Forbidden</code>, </p>\n\n<p>which means it's not using the local filesystem version of the packages, even though I told it to with the <a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"noreferrer\"><code>replace</code> directive</a> in the <code>go.mod</code> file. </p>\n\n<p>What am I doing wrong? How do I ensure that subpackages are used from the filesystem instead of attempting to be fetched from the internet?</p>\n"}, {"tags": ["go", "deadlock", "priority-queue", "channels"], "comments": [{"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 1, "creation_date": 1542577756, "post_id": 53365338, "comment_id": 93608129, "body": "Priority Queue is standard data type in CS and does not require concurrency to implement - <a href=\"https://en.wikipedia.org/wiki/Priority_queue#Usual_implementation\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Priority_queue#Usual_implementation</a>"}, {"owner": {"reputation": 7, "user_id": 10671794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2620da1713fa6c688720060658226219?s=128&d=identicon&r=PG&f=1", "display_name": "Kypper", "link": "https://stackoverflow.com/users/10671794/kypper"}, "reply_to_user": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1542578526, "post_id": 53365338, "comment_id": 93608339, "body": "unfortunately, the assignment requires me to implement this using concurrency. But thank you for the input Dimitry :) the majority of the code is provided. The only part of the code i must implement myself is the PriorityQueue function."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10671794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2620da1713fa6c688720060658226219?s=128&d=identicon&r=PG&f=1", "display_name": "Kypper", "link": "https://stackoverflow.com/users/10671794/kypper"}, "edited": false, "score": 0, "creation_date": 1542584660, "post_id": 53366215, "comment_id": 93609795, "body": "Thank you so much for the in depth explanation and the solution you provided poy! as i mentioned before, unfortunately i am not allowed to alter any code other than the code within the priorityQueue function. The variables that i created were numOrder, mesOrder, pri, and a. so other than those 4, and anything within the priorityQueue function cannot be changed."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 7, "user_id": 10671794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2620da1713fa6c688720060658226219?s=128&d=identicon&r=PG&f=1", "display_name": "Kypper", "link": "https://stackoverflow.com/users/10671794/kypper"}, "edited": false, "score": 0, "creation_date": 1542584819, "post_id": 53366215, "comment_id": 93609826, "body": "Fair enough, but that means you must constantly consume from west and not be blocked by east. So Insert the for loop in the function and then when writing to east, do so within a new go routine."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1542584743, "last_edit_date": 1542584743, "creation_date": 1542581365, "answer_id": 53366215, "question_id": 53365338, "link": "https://stackoverflow.com/questions/53365338/priority-queue-in-golang-using-channels/53366215#53366215", "title": "Priority queue in GoLang using channels", "body": "<p>I didn't really look at the priority queue behavior but instead focused ont the deadlock. </p>\n\n<p>So you have a few problems that will give you a deadlock:</p>\n\n<ol>\n<li>You are only reading from <code>west</code> once, however you are writing to it several times. This means that it will block when you write <code>zero</code>. Maybe add a <code>for</code> loop.</li>\n<li><code>go printToScreen()</code> is after all the writes to <code>west</code>. This means that when your go routine reading from <code>west</code> and then writing to <code>east</code> gets to the writing part, it will block because nothing is reading from <code>east</code>.</li>\n<li>Empty select (<code>select{}</code>). While this will block the main go routine, it will do so indefinitely. This will cause a deadlock panic once all the other go routines close out.</li>\n</ol>\n\n<p>I changed your code to this:</p>\n\n<pre><code>package main\n\nimport \"time\"\n\nvar numOrder [20]int\nvar mesOrder []PriorityMessage\nvar pri int\nvar a int\n\ntype PriorityMessage struct {\n    Priority int // between 0 and 9\n    Message  string\n}\n\nfunc priorityQueue(west chan PriorityMessage, east chan string) {\n    for {\n        incomming := &lt;-west\n        if numOrder[incomming.Priority] == 10 {\n            numOrder[incomming.Priority] = incomming.Priority\n        } else {\n            numOrder[incomming.Priority+1] = incomming.Priority\n        }\n        mesOrder = append(mesOrder, incomming)\n        for i := 0; i &lt; len(numOrder); i++ {\n            if numOrder[i] != 10 {\n                pri =\n                    numOrder[i]\n                a = i\n                break\n            }\n        }\n        for i := 0; i &lt; len(mesOrder); i++ {\n            if pri == mesOrder[i].Priority {\n                east &lt;- (mesOrder[i]).Message\n                numOrder[a] = 10\n                mesOrder = append(mesOrder[:i], mesOrder[i+1:]...)\n            }\n        }\n    }\n}\n\nvar west chan PriorityMessage\nvar east chan string\n\nfunc printToScreen() {\n    for {\n        println(&lt;-east)\n    }\n}\n\nfunc main() {\n    for i := 0; i &lt; len(numOrder); i++ {\n        numOrder[i] = 10\n    }\n    go printToScreen()\n    west = make(chan PriorityMessage)\n    east = make(chan string)\n    go priorityQueue(west, east)\n    west &lt;- PriorityMessage{1, \"one\"}\n    west &lt;- PriorityMessage{0, \"zero\"}\n    west &lt;- PriorityMessage{2, \"two\"}\n    west &lt;- PriorityMessage{1, \"another one\"}\n    west &lt;- PriorityMessage{0, \"another zero\"}\n\n    time.Sleep(time.Hour)\n}\n</code></pre>\n\n<p>And go the following results:</p>\n\n<pre><code>one\nzero\ntwo\nanother one\nanother zero\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10671794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2620da1713fa6c688720060658226219?s=128&d=identicon&r=PG&f=1", "display_name": "Kypper", "link": "https://stackoverflow.com/users/10671794/kypper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1616, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1542584743, "creation_date": 1542574356, "last_edit_date": 1542577608, "question_id": 53365338, "link": "https://stackoverflow.com/questions/53365338/priority-queue-in-golang-using-channels", "title": "Priority queue in GoLang using channels", "body": "<p><a href=\"https://i.stack.imgur.com/fX5cj.png\" rel=\"nofollow noreferrer\">Question</a></p>\n\n<p>In the above image is the question I need to provide a solution to. here is the solution I have come up with (must be coded in Go). I am getting the deadlock error:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan send]:\nmain.main()\n    /home/kypriank/Assignment 5/priorityqueue.go:42 +0x1a3\n\ngoroutine 17 [chan send]:\nmain.priorityQueue(0xc420080060, 0xc4200800c0)\n    /home/kypriank/Assignment 5/priorityqueue.go:22 +0x1a2\ncreated by main.main\n    /home/kypriank/Assignment 5/priorityqueue.go:40 +0xe5\nexit status 2\n</code></pre>\n\n<p>Was wondering if somebody could assist me in figuring out where my code is messing up(the main function has some code to test my solution): </p>\n\n<pre><code>package main\n\nvar numOrder [20] int\nvar mesOrder [] PriorityMessage\nvar pri int\nvar a int\n\ntype PriorityMessage struct {\n    Priority int // between 0 and 9\n    Message string\n}\n\nfunc priorityQueue(west chan PriorityMessage, east chan string) {\n    incomming := &lt;-west\n    if numOrder[incomming.Priority] == 10 {\n        numOrder[incomming.Priority] = incomming.Priority\n    }else {numOrder[incomming.Priority+1] = incomming.Priority}\n    mesOrder = append(mesOrder, incomming)\n    for i := 0; i &lt; len(numOrder); i++ {if numOrder[i] != 10 {pri = \nnumOrder[i]; a = i; break}}\n    for i := 0; i &lt; len(mesOrder); i++ {\n        if pri == mesOrder[i].Priority {\n            east &lt;- (mesOrder[i]).Message\n            numOrder[a] = 10\n            mesOrder = append(mesOrder[:i], mesOrder[i+1:]...) \n        }\n    }\n}\n\nvar west chan PriorityMessage\nvar east chan string\n\nfunc printToScreen() {\n    for {println(&lt;- east)}\n}\n\nfunc main() {\n    for i := 0; i &lt; len(numOrder); i++ {numOrder[i] = 10}\n    west = make(chan PriorityMessage)\n    east = make(chan string)\n    go priorityQueue(west, east)\n    west &lt;- PriorityMessage{1, \"one\"}\n    west &lt;- PriorityMessage{0, \"zero\"}\n    west &lt;- PriorityMessage{2, \"two\"}\n    west &lt;- PriorityMessage{1, \"another one\"}\n    west &lt;- PriorityMessage{0, \"another zero\"}\n    go printToScreen()\n    select {} // to allow all messages to be printed\n}\n</code></pre>\n"}, {"tags": ["go", "grpc", "protoc"], "comments": [{"owner": {"reputation": 639, "user_id": 699934, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/QXsfY.jpg?s=128&g=1", "display_name": "Tolsi", "link": "https://stackoverflow.com/users/699934/tolsi"}, "edited": false, "score": 0, "creation_date": 1557757940, "post_id": 53363652, "comment_id": 98862555, "body": "Did you install protoc-gen-go from the homebrew or the official repository?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542577194, "post_id": 53364045, "comment_id": 93607976, "body": "Thanks for your advice."}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542577211, "post_id": 53364045, "comment_id": 93607981, "body": "Obviously, i did"}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542577325, "post_id": 53364045, "comment_id": 93608022, "body": "go get -u github.com/golang/protobuf/protoc-gen-go"}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542577452, "post_id": 53364045, "comment_id": 93608054, "body": "even i did &quot;reinstalling Golang&quot; and clear all files inside &quot;GOPATH&quot;. Then i installed all required files again."}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542577519, "post_id": 53364045, "comment_id": 93608073, "body": "&gt;&gt;protoc --version"}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542577561, "post_id": 53364045, "comment_id": 93608084, "body": "libprotoc 3.6.1"}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542577614, "post_id": 53364045, "comment_id": 93608096, "body": "very strange, i just followed all instruction in grpc-go tutorial"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542580384, "post_id": 53364045, "comment_id": 93608835, "body": "What SHAs do you have both of the previously mentioned repos?"}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542617066, "post_id": 53364045, "comment_id": 93617905, "body": "sorry, i do not understand your question. I am not professional at Ubuntu. What do you mean SHAs ?"}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542617163, "post_id": 53364045, "comment_id": 93617954, "body": "I installed protoc to the local directory, and added the path to .profile"}, {"owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "edited": false, "score": 0, "creation_date": 1542617262, "post_id": 53364045, "comment_id": 93617993, "body": "&gt;&gt; export PATH=$PATH:/home/shan/protoc3/bin"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1542564920, "creation_date": 1542564920, "answer_id": 53364045, "question_id": 53363652, "link": "https://stackoverflow.com/questions/53363652/generated-files-look-different-from-the-example/53364045#53364045", "title": "Generated files look different from the example", "body": "<p>The generated code is dependent on what version of <code>protoc</code>, <code>grpc</code> and <code>protoc-gen-go</code> you have installed.</p>\n\n<p>Please run:</p>\n\n<pre><code>go get -u google.golang.org/grpc\ngo get -u github.com/golang/protobuf/protoc-gen-go\n</code></pre>\n\n<p>The <code>go get -u</code> will force the libraries to update even if you already have an existing version.</p>\n\n<p><strong>NOTE</strong>: The question of what versions of things do I have installed (especially <code>protoc</code>) can plague you with an enterprise/long-running project. I highly recommend using an automation strategy that will generate the files for you and check them into your repo so that you know what version generated your files.</p>\n"}, {"tags": [], "owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "is_accepted": false, "score": 0, "last_activity_date": 1548665060, "creation_date": 1548665060, "answer_id": 54398227, "question_id": 53363652, "link": "https://stackoverflow.com/questions/53363652/generated-files-look-different-from-the-example/54398227#54398227", "title": "Generated files look different from the example", "body": "<p>Try this it will do help:</p>\n\n<pre><code>protoc file.proto --go_out=plugins=grpc:.\n\n</code></pre>\n\n<p>// Note:-</p>\n\n<p>For changing the proto buffer file name use:</p>\n\n<pre><code>option go_package = \"example_newpb\";\npackage example;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10671163, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OzwhyFN5pio/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jsHNcAd75_oRhvtiLIB6xRlNQglQ/mo/photo.jpg?sz=128", "display_name": "umlspec", "link": "https://stackoverflow.com/users/10671163/umlspec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 775, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1606962864, "creation_date": 1542562199, "last_edit_date": 1542615935, "question_id": 53363652, "link": "https://stackoverflow.com/questions/53363652/generated-files-look-different-from-the-example", "title": "Generated files look different from the example", "body": "<p>please help me. The below is given in .../gopath/src/google.golang.org/grpc/examples/helloworld/helloworld/helloworld.proto</p>\n\n<p>==============================================</p>\n\n<pre><code>syntax = \"proto3\";\n\noption java_multiple_files = true;\noption java_package = \"io.grpc.examples.helloworld\";\noption java_outer_classname = \"HelloWorldProto\";\n\npackage helloworld;\n\n// The greeting service definition.\nservice Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n}\n\n// The request message containing the user's name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}\n</code></pre>\n\n<p>======================================================</p>\n\n<p>Then, i compiled to get a Go code </p>\n\n<pre><code>&gt;&gt; protoc  helloworld.proto   --go_out=plugins=:.\n</code></pre>\n\n<p>The generated code is below, but it looks quite different from /gopath/src/google.golang.org/grpc/examples/helloworld/helloworld/helloworld.pb.go</p>\n\n<p>=======</p>\n\n<pre><code>It has these top-level messages:\n    HelloRequest\n    HelloReply\n*/\npackage helloworld\n\nimport proto \"github.com/golang/protobuf/proto\"\n\nimport (\n    context \"golang.org/x/net/context\"\n    grpc \"google.golang.org/grpc\"\n)\n\n// Reference imports to suppress errors if they are not otherwise used.\nvar _ context.Context\nvar _ grpc.ClientConn\n\n// Reference imports to suppress errors if they are not otherwise used.\nvar _ = proto.Marshal\n\n// The request message containing the user's name.\ntype HelloRequest struct {\n    Name string `protobuf:\"bytes,1,opt,name=name\" json:\"name,omitempty\"`\n}\n\nfunc (m *HelloRequest) Reset()         { *m = HelloRequest{} }\nfunc (m *HelloRequest) String() string { return proto.CompactTextString(m) }\nfunc (*HelloRequest) ProtoMessage()    {}\n\n// The response message containing the greetings\ntype HelloReply struct {\n    Message string `protobuf:\"bytes,1,opt,name=message\" json:\"message,omitempty\"`\n}\n\nfunc (m *HelloReply) Reset()         { *m = HelloReply{} }\nfunc (m *HelloReply) String() string { return proto.CompactTextString(m) }\nfunc (*HelloReply) ProtoMessage()    {}\n\nfunc init() {\n}\n\n// Client API for Greeter service\n\ntype GreeterClient interface {\n    // Sends a greeting\n    SayHello(ctx context.Context, in *HelloRequest, opts ...grpc.CallOption) (*HelloReply, error)\n}\n\ntype greeterClient struct {\n    cc *grpc.ClientConn\n}\n\nfunc NewGreeterClient(cc *grpc.ClientConn) GreeterClient {\n    return &amp;greeterClient{cc}\n}\n\nfunc (c *greeterClient) SayHello(ctx context.Context, in *HelloRequest, opts ...grpc.CallOption) (*HelloReply, error) {\n    out := new(HelloReply)\n    err := grpc.Invoke(ctx, \"/helloworld.Greeter/SayHello\", in, out, c.cc, opts...)\n    if err != nil {\n        return nil, err\n    }\n    return out, nil\n}\n\n// Server API for Greeter service\n\ntype GreeterServer interface {\n    // Sends a greeting\n    SayHello(context.Context, *HelloRequest) (*HelloReply, error)\n}\n\nfunc RegisterGreeterServer(s *grpc.Server, srv GreeterServer) {\n    s.RegisterService(&amp;_Greeter_serviceDesc, srv)\n}\n\nfunc _Greeter_SayHello_Handler(srv interface{}, ctx context.Context, codec grpc.Codec, buf []byte) (interface{}, error) {\n    in := new(HelloRequest)\n    if err := codec.Unmarshal(buf, in); err != nil {\n        return nil, err\n    }\n    out, err := srv.(GreeterServer).SayHello(ctx, in)\n    if err != nil {\n        return nil, err\n    }\n    return out, nil\n}\n\nvar _Greeter_serviceDesc = grpc.ServiceDesc{\n    ServiceName: \"helloworld.Greeter\",\n    HandlerType: (*GreeterServer)(nil),\n    Methods: []grpc.MethodDesc{\n        {\n            MethodName: \"SayHello\",\n            Handler:    _Greeter_SayHello_Handler,\n        },\n    },\n    Streams: []grpc.StreamDesc{},\n}\n</code></pre>\n\n<p>=============================================</p>\n\n<p>i attached the file given in /gopath/src/google.golang.org/grpc/examples/helloworld/helloworld/helloworld.pb.go</p>\n\n<p>====================================================</p>\n\n<pre><code>// Code generated by protoc-gen-go. DO NOT EDIT.\n// source: helloworld.proto\n\npackage helloworld\n\nimport proto \"github.com/golang/protobuf/proto\"\nimport fmt \"fmt\"\nimport math \"math\"\n\nimport (\n    context \"golang.org/x/net/context\"\n    grpc \"google.golang.org/grpc\"\n)\n\n// Reference imports to suppress errors if they are not otherwise used.\nvar _ = proto.Marshal\nvar _ = fmt.Errorf\nvar _ = math.Inf\n\n// This is a compile-time assertion to ensure that this generated file\n// is compatible with the proto package it is being compiled against.\n// A compilation error at this line likely means your copy of the\n// proto package needs to be updated.\nconst _ = proto.ProtoPackageIsVersion2 // please upgrade the proto package\n\n// The request message containing the user's name.\ntype HelloRequest struct {\n    Name                 string   `protobuf:\"bytes,1,opt,name=name,proto3\" json:\"name,omitempty\"`\n    XXX_NoUnkeyedLiteral struct{} `json:\"-\"`\n    XXX_unrecognized     []byte   `json:\"-\"`\n    XXX_sizecache        int32    `json:\"-\"`\n}\n\nfunc (m *HelloRequest) Reset()         { *m = HelloRequest{} }\nfunc (m *HelloRequest) String() string { return proto.CompactTextString(m) }\nfunc (*HelloRequest) ProtoMessage()    {}\nfunc (*HelloRequest) Descriptor() ([]byte, []int) {\n    return fileDescriptor_helloworld_71e208cbdc16936b, []int{0}\n}\nfunc (m *HelloRequest) XXX_Unmarshal(b []byte) error {\n    return xxx_messageInfo_HelloRequest.Unmarshal(m, b)\n}\nfunc (m *HelloRequest) XXX_Marshal(b []byte, deterministic bool) ([]byte, error) {\n    return xxx_messageInfo_HelloRequest.Marshal(b, m, deterministic)\n}\nfunc (dst *HelloRequest) XXX_Merge(src proto.Message) {\n    xxx_messageInfo_HelloRequest.Merge(dst, src)\n}\nfunc (m *HelloRequest) XXX_Size() int {\n    return xxx_messageInfo_HelloRequest.Size(m)\n}\nfunc (m *HelloRequest) XXX_DiscardUnknown() {\n    xxx_messageInfo_HelloRequest.DiscardUnknown(m)\n}\n\nvar xxx_messageInfo_HelloRequest proto.InternalMessageInfo\n\nfunc (m *HelloRequest) GetName() string {\n    if m != nil {\n        return m.Name\n    }\n    return \"\"\n}\n\n// The response message containing the greetings\ntype HelloReply struct {\n    Message              string   `protobuf:\"bytes,1,opt,name=message,proto3\" json:\"message,omitempty\"`\n    XXX_NoUnkeyedLiteral struct{} `json:\"-\"`\n    XXX_unrecognized     []byte   `json:\"-\"`\n    XXX_sizecache        int32    `json:\"-\"`\n}\n\nfunc (m *HelloReply) Reset()         { *m = HelloReply{} }\nfunc (m *HelloReply) String() string { return proto.CompactTextString(m) }\nfunc (*HelloReply) ProtoMessage()    {}\nfunc (*HelloReply) Descriptor() ([]byte, []int) {\n    return fileDescriptor_helloworld_71e208cbdc16936b, []int{1}\n}\nfunc (m *HelloReply) XXX_Unmarshal(b []byte) error {\n    return xxx_messageInfo_HelloReply.Unmarshal(m, b)\n}\nfunc (m *HelloReply) XXX_Marshal(b []byte, deterministic bool) ([]byte, error) {\n    return xxx_messageInfo_HelloReply.Marshal(b, m, deterministic)\n}\nfunc (dst *HelloReply) XXX_Merge(src proto.Message) {\n    xxx_messageInfo_HelloReply.Merge(dst, src)\n}\nfunc (m *HelloReply) XXX_Size() int {\n    return xxx_messageInfo_HelloReply.Size(m)\n}\nfunc (m *HelloReply) XXX_DiscardUnknown() {\n    xxx_messageInfo_HelloReply.DiscardUnknown(m)\n}\n\nvar xxx_messageInfo_HelloReply proto.InternalMessageInfo\n\nfunc (m *HelloReply) GetMessage() string {\n    if m != nil {\n        return m.Message\n    }\n    return \"\"\n}\n\nfunc init() {\n    proto.RegisterType((*HelloRequest)(nil), \"helloworld.HelloRequest\")\n    proto.RegisterType((*HelloReply)(nil), \"helloworld.HelloReply\")\n}\n\n// Reference imports to suppress errors if they are not otherwise used.\nvar _ context.Context\nvar _ grpc.ClientConn\n\n// This is a compile-time assertion to ensure that this generated file\n// is compatible with the grpc package it is being compiled against.\nconst _ = grpc.SupportPackageIsVersion4\n\n// GreeterClient is the client API for Greeter service.\n//\n// For semantics around ctx use and closing/ending streaming RPCs, please refer to https://godoc.org/google.golang.org/grpc#ClientConn.NewStream.\ntype GreeterClient interface {\n    // Sends a greeting\n    SayHello(ctx context.Context, in *HelloRequest, opts ...grpc.CallOption) (*HelloReply, error)\n}\n\ntype greeterClient struct {\n    cc *grpc.ClientConn\n}\n\nfunc NewGreeterClient(cc *grpc.ClientConn) GreeterClient {\n    return &amp;greeterClient{cc}\n}\n\nfunc (c *greeterClient) SayHello(ctx context.Context, in *HelloRequest, opts ...grpc.CallOption) (*HelloReply, error) {\n    out := new(HelloReply)\n    err := c.cc.Invoke(ctx, \"/helloworld.Greeter/SayHello\", in, out, opts...)\n    if err != nil {\n        return nil, err\n    }\n    return out, nil\n}\n\n// GreeterServer is the server API for Greeter service.\ntype GreeterServer interface {\n    // Sends a greeting\n    SayHello(context.Context, *HelloRequest) (*HelloReply, error)\n}\n\nfunc RegisterGreeterServer(s *grpc.Server, srv GreeterServer) {\n    s.RegisterService(&amp;_Greeter_serviceDesc, srv)\n}\n\nfunc _Greeter_SayHello_Handler(srv interface{}, ctx context.Context, dec func(interface{}) error, interceptor grpc.UnaryServerInterceptor) (interface{}, error) {\n    in := new(HelloRequest)\n    if err := dec(in); err != nil {\n        return nil, err\n    }\n    if interceptor == nil {\n        return srv.(GreeterServer).SayHello(ctx, in)\n    }\n    info := &amp;grpc.UnaryServerInfo{\n        Server:     srv,\n        FullMethod: \"/helloworld.Greeter/SayHello\",\n    }\n    handler := func(ctx context.Context, req interface{}) (interface{}, error) {\n        return srv.(GreeterServer).SayHello(ctx, req.(*HelloRequest))\n    }\n    return interceptor(ctx, in, info, handler)\n}\n\nvar _Greeter_serviceDesc = grpc.ServiceDesc{\n    ServiceName: \"helloworld.Greeter\",\n    HandlerType: (*GreeterServer)(nil),\n    Methods: []grpc.MethodDesc{\n        {\n            MethodName: \"SayHello\",\n            Handler:    _Greeter_SayHello_Handler,\n        },\n    },\n    Streams:  []grpc.StreamDesc{},\n    Metadata: \"helloworld.proto\",\n}\n\nfunc init() { proto.RegisterFile(\"helloworld.proto\", fileDescriptor_helloworld_71e208cbdc16936b) }\n\nvar fileDescriptor_helloworld_71e208cbdc16936b = []byte{\n    // 175 bytes of a gzipped FileDescriptorProto\n    0x1f, 0x8b, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xff, 0xe2, 0x12, 0xc8, 0x48, 0xcd, 0xc9,\n    0xc9, 0x2f, 0xcf, 0x2f, 0xca, 0x49, 0xd1, 0x2b, 0x28, 0xca, 0x2f, 0xc9, 0x17, 0xe2, 0x42, 0x88,\n    0x28, 0x29, 0x71, 0xf1, 0x78, 0x80, 0x78, 0x41, 0xa9, 0x85, 0xa5, 0xa9, 0xc5, 0x25, 0x42, 0x42,\n    0x5c, 0x2c, 0x79, 0x89, 0xb9, 0xa9, 0x12, 0x8c, 0x0a, 0x8c, 0x1a, 0x9c, 0x41, 0x60, 0xb6, 0x92,\n    0x1a, 0x17, 0x17, 0x54, 0x4d, 0x41, 0x4e, 0xa5, 0x90, 0x04, 0x17, 0x7b, 0x6e, 0x6a, 0x71, 0x71,\n    0x62, 0x3a, 0x4c, 0x11, 0x8c, 0x6b, 0xe4, 0xc9, 0xc5, 0xee, 0x5e, 0x94, 0x9a, 0x5a, 0x92, 0x5a,\n    0x24, 0x64, 0xc7, 0xc5, 0x11, 0x9c, 0x58, 0x09, 0xd6, 0x25, 0x24, 0xa1, 0x87, 0xe4, 0x02, 0x64,\n    0xcb, 0xa4, 0xc4, 0xb0, 0xc8, 0x14, 0xe4, 0x54, 0x2a, 0x31, 0x38, 0x19, 0x70, 0x49, 0x67, 0xe6,\n    0xeb, 0xa5, 0x17, 0x15, 0x24, 0xeb, 0xa5, 0x56, 0x24, 0xe6, 0x16, 0xe4, 0xa4, 0x16, 0x23, 0xa9,\n    0x75, 0xe2, 0x07, 0x2b, 0x0e, 0x07, 0xb1, 0x03, 0x40, 0x5e, 0x0a, 0x60, 0x4c, 0x62, 0x03, 0xfb,\n    0xcd, 0x18, 0x10, 0x00, 0x00, 0xff, 0xff, 0x0f, 0xb7, 0xcd, 0xf2, 0xef, 0x00, 0x00, 0x00,\n}\n</code></pre>\n\n<p>============================================</p>\n\n<p>Please, help me for why I have got different code. I have checked my current version of protoc</p>\n\n<pre><code>&gt;&gt;protoc --version\nlibprotoc 3.6.1\n</code></pre>\n"}, {"tags": ["go", "travis-ci", "travis-ci-cli", "golint"], "answers": [{"comments": [{"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1542566605, "post_id": 53364099, "comment_id": 93605112, "body": "I run <code>gometalinter --install --force</code> and still I dont see errors locally just on travis. any idea? I use <code>v2.0.11</code> of gometalinter"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1542565230, "creation_date": 1542565230, "answer_id": 53364099, "question_id": 53363502, "link": "https://stackoverflow.com/questions/53363502/run-lint-on-golang-repo-in-travis/53364099#53364099", "title": "Run lint on golang repo in travis", "body": "<p><code>gometalinter</code> runs binaries in your path to do its check. I have had problems where my CI would have one set of binaries versions while my local development environment would have different versions.</p>\n\n<p>Try updating all the required binaries on your local machine.</p>\n"}, {"comments": [{"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1542566510, "post_id": 53364114, "comment_id": 93605082, "body": "Thanks I&#39;ve tried it  <code>run gometalinter --install --force</code> and still when I run locally I dont get any error, just when I run it on Travis. what is strange is that I run it with --vendor in travis and also in the config json and still I got the warnings on vendor packages..., any idea, hint what it could be ?"}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "reply_to_user": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1542566910, "post_id": 53364114, "comment_id": 93605191, "body": "check version of <code>errcheck</code> in local env and travis"}], "tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": false, "score": 0, "last_activity_date": 1542565346, "creation_date": 1542565346, "answer_id": 53364114, "question_id": 53363502, "link": "https://stackoverflow.com/questions/53363502/run-lint-on-golang-repo-in-travis/53364114#53364114", "title": "Run lint on golang repo in travis", "body": "<p>Try <code>--vendor</code> flag and check versions of <code>gometalinter</code> and all used linters.</p>\n\n<p>Extract from <a href=\"https://github.com/alecthomas/gometalinter#how-do-i-make-gometalinter-work-with-go-15-vendoring\" rel=\"nofollow noreferrer\">gometalinter documentation</a>:</p>\n\n<blockquote>\n  <p><strong>How do I make gometalinter work with Go 1.5 vendoring?</strong></p>\n  \n  <p>gometalinter has a --vendor flag that just sets\n  GO15VENDOREXPERIMENT=1, however the underlying tools must support it.\n  Ensure that all of the linters are up to date and built with Go 1.5\n  (gometalinter --install --force) then run gometalinter --vendor ..\n  That should be it.</p>\n</blockquote>\n"}], "owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1542565346, "creation_date": 1542561378, "question_id": 53363502, "link": "https://stackoverflow.com/questions/53363502/run-lint-on-golang-repo-in-travis", "title": "Run lint on golang repo in travis", "body": "<p>I run locally on my project the following command</p>\n\n<p><code>gometalinter --config=gometalinter.json ./...</code></p>\n\n<p>at the beginning I got some errors and I was fixed them all!</p>\n\n<p>now I run the same command exaclty in <code>Travis</code> script \nand I got vendor errros like  </p>\n\n<pre><code>vendor/github.com/spf13/viper/flags.go:3:8:warning: error return value not checked (could not import github.com/spf13/pflag (go/build: importGo github.com/spf13/pflag: exit status 1) (errcheck)\nvendor/github.com/spf13/viper/viper.go:42:7:warning: error return value not checked (could not import github.com/pelletier/go-toml (go/build: importGo github.com/pelletier/go-toml: exit status 1) (errcheck)\n</code></pre>\n\n<p>This is the <code>gometalinter.json</code> for the config </p>\n\n<pre><code>{\n  \"vendor\": true,\n  \"Deadline\": \"2m\",\n  \"Sort\": [\n    \"linter\",\n    \"severity\"\n  ],\n  \"DisableAll\": true,\n  \"Enable\": [\n    \"gotypex\",\n    \"vetshadow\",\n    \"errcheck\",\n    \"gocyclo\",\n    \"vet\",\n    \"golint\",\n    \"vetshadow\",\n    \"ineffassign\",\n\n\n  ],\n  \"Cyclo\": 10,\n  \"LineLength\": 120\n}\n</code></pre>\n\n<p>I dont understand why locally I dont get this error (i've the vendor repo) and why it ask for vendor error ? what could be the reason ? </p>\n"}, {"tags": ["go", "module"], "comments": [{"owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 2, "creation_date": 1542561993, "post_id": 53363096, "comment_id": 93603759, "body": "use the following commands in order to download missing packages <b>go get -u -v github.com/getset0/kamona/database</b> and <b>go get -u -v github.com/getset0/kamona/kauth</b>"}], "answers": [{"comments": [{"owner": {"reputation": 1029, "user_id": 1332738, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9c03bce3bfdc90e4a7c21914bc306d30?s=128&d=identicon&r=PG", "display_name": "Victor Oliveira", "link": "https://stackoverflow.com/users/1332738/victor-oliveira"}, "edited": false, "score": 0, "creation_date": 1542565959, "post_id": 53364131, "comment_id": 93604922, "body": "Yeah, I was not pushing my diff to the github, and that was the problem. Thanks for your help"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 3, "last_activity_date": 1542565462, "creation_date": 1542565462, "answer_id": 53364131, "question_id": 53363096, "link": "https://stackoverflow.com/questions/53363096/import-local-modules/53364131#53364131", "title": "Import local modules", "body": "<p>Do you have <code>go.mod</code> files in <code>./kauth</code> and <code>./database</code>?</p>\n\n<p>Normally the <code>go.mod</code> goes at the root of the project (which would be <code>github.com/getset0/kamona</code>). This would also imply you do not need to <code>require</code> <code>github.com/getset0/kamona/kauth</code> or <code>github.com/getset0/kamona/database</code>. </p>\n\n<p>This also implies that you don't need the <code>replace</code> statements.</p>\n"}], "owner": {"reputation": 1029, "user_id": 1332738, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9c03bce3bfdc90e4a7c21914bc306d30?s=128&d=identicon&r=PG", "display_name": "Victor Oliveira", "link": "https://stackoverflow.com/users/1332738/victor-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 1, "closed_date": 1551291686, "answer_count": 1, "score": 2, "last_activity_date": 1542565462, "creation_date": 1542558749, "question_id": 53363096, "link": "https://stackoverflow.com/questions/53363096/import-local-modules", "closed_reason": "Duplicate", "title": "Import local modules", "body": "<p>I am importing local go modules, but I keep getting these error messages: </p>\n\n<p><code>main.go:6:2: unknown import path \"github.com/getset0/kamona/database\": cannot find module providing package github.com/getset0/kamona/database\nclient.go:5:2: unknown import path \"github.com/getset0/kamona/kauth\": cannot find module providing package github.com/getset0/kamona/kauth</code></p>\n\n<p>Those files are located at my project root dir, and my go.mod is as follow: </p>\n\n<pre><code>module github.com/getset0/kamona\n\nrequire (\n    github.com/dgrijalva/jwt-go v3.2.0+incompatible\n    github.com/golang/protobuf v1.2.0\n    github.com/grpc-ecosystem/grpc-gateway v1.5.1\n    github.com/mitchellh/mapstructure v1.1.2\n    golang.org/x/net v0.0.0-20181114220301-adae6a3d119a\n    golang.org/x/vgo v0.0.0-20180912184537-9d567625acf4 // indirect\n    google.golang.org/grpc v1.16.0\n)\n\nreplace github.com/getset0/kamona/kauth =&gt; ./kauth\n\nreplace github.com/getset0/kamona/database =&gt; ./database\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["go", "formatting", "lint"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1542556078, "post_id": 53362649, "comment_id": 93601937, "body": "No need for errors.New, just fmt.Errorf. e.g. <code>return fmt.Errorf(&quot;%s cmd.Std error: %s &quot;, cp[1:], err)</code>. fmt.Errorf returns an <code>error</code>, errors.New takes a <code>string</code> that&#39;s why your code doesn&#39;t compile."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542556152, "post_id": 53362649, "comment_id": 93601959, "body": "@mkopriva - im using package <code>&quot;github.com&#47;pkg&#47;errors&quot;</code> , how should I change it? can you provide it as answer ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1542556262, "post_id": 53362649, "comment_id": 93602004, "body": "In that case use <a href=\"https://godoc.org/github.com/pkg/errors#Errorf\" rel=\"nofollow noreferrer\">godoc.org/github.com/pkg/errors#Errorf</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1542556429, "post_id": 53362649, "comment_id": 93602055, "body": "@mkopriva - please provide it as answer and I close the question :) thank you"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543420226, "post_id": 53362649, "comment_id": 93915391, "body": "The error tells you <i>exactly</i> what to do, and it&#39;s perfectly clear. What is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 4, "last_activity_date": 1542556677, "creation_date": 1542556677, "answer_id": 53362794, "question_id": 53362649, "link": "https://stackoverflow.com/questions/53362649/go-using-error-with-errorf-and-not-sprintf/53362794#53362794", "title": "Go using error with errorf and not sprintf", "body": "<p><code>fmt.Errorf</code> returns an <code>error</code> while <code>errors.New</code> takes a <code>string</code> that's why your code doesn't compile.</p>\n\n<p>You can simply omit the <code>errors.New</code> call or, since you're using the <code>github.com/pkg/errors</code> package, you can use <a href=\"https://godoc.org/github.com/pkg/errors#Errorf\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/pkg/errors#Errorf</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 53362794, "answer_count": 1, "score": -5, "last_activity_date": 1542556677, "creation_date": 1542555875, "question_id": 53362649, "link": "https://stackoverflow.com/questions/53362649/go-using-error-with-errorf-and-not-sprintf", "title": "Go using error with errorf and not sprintf", "body": "<p>Im using <code>gometalinter</code> on my project and for this code </p>\n\n<p><code>errors.New(fmt.Sprintf(\"%s cmd.Std error: %s \", cp[1:], err))</code></p>\n\n<p>im getting error <code>should replace errors.New(fmt.Sprintf(...)) with fmt.Errorf(...) (golint)</code></p>\n\n<p>Any idea how to resolve this ?</p>\n\n<p>I try with <code>errors.New(fmt.Errorf(\"%s cmd.Std error: %s \", cp[1:], err))</code> and I got error cannot use fmtErrorf as type string</p>\n"}, {"tags": ["rest", "api", "http", "go", "curl"], "comments": [{"owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "edited": false, "score": 0, "creation_date": 1542554050, "post_id": 53362236, "comment_id": 93601291, "body": "I think you need print apiUrl for debug this error."}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 1, "creation_date": 1542554122, "post_id": 53362236, "comment_id": 93601311, "body": "Are you just missing the <code>clusters</code> path in your URL? e.g. <code>apiUrl := &quot;https:&#47;&#47;api.qubole.com&#47;api&#47;v1.3&#47;clusters&#47;&quot;+clusterId+&quot;&#47;stat&zwnj;&#8203;e&quot;</code>"}, {"owner": {"reputation": 2172, "user_id": 8600836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VrWy0.jpg?s=128&g=1", "display_name": "sulabh chaturvedi", "link": "https://stackoverflow.com/users/8600836/sulabh-chaturvedi"}, "reply_to_user": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1542554438, "post_id": 53362236, "comment_id": 93601434, "body": "@ssemilla - Thanks for pointing that out, I just corrected it and still getting the error. This time 401 tho. However, not sure why? as the token is same as used with Curl. (an env variable - as you can see) I&#39;ve just edited my question."}, {"owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "edited": false, "score": 1, "creation_date": 1542554791, "post_id": 53362236, "comment_id": 93601557, "body": "why hostname in go code is &quot;api.qubole.com&quot; while in curl command is &quot;us.qubole.com&quot;?"}, {"owner": {"reputation": 2172, "user_id": 8600836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VrWy0.jpg?s=128&g=1", "display_name": "sulabh chaturvedi", "link": "https://stackoverflow.com/users/8600836/sulabh-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1542554951, "post_id": 53362236, "comment_id": 93601604, "body": "Thank you. That, was the error- a stupid one though. That is because, the documentation of API provider states it WRONG (<a href=\"https://docs.qubole.com/en/latest/rest-api/cluster_api/start-terminate-cluster.html\" rel=\"nofollow noreferrer\">docs.qubole.com/en/latest/rest-api/cluster_api/&hellip;</a>) . But, since I login using us.qubole.com, I used that, when I was writing my cURL command"}, {"owner": {"reputation": 2172, "user_id": 8600836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VrWy0.jpg?s=128&g=1", "display_name": "sulabh chaturvedi", "link": "https://stackoverflow.com/users/8600836/sulabh-chaturvedi"}, "reply_to_user": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "edited": false, "score": 0, "creation_date": 1542555073, "post_id": 53362236, "comment_id": 93601639, "body": "@KibGzr Can you please post your answer, I&#39;ll accept it and that, would be the closure."}, {"owner": {"reputation": 2172, "user_id": 8600836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VrWy0.jpg?s=128&g=1", "display_name": "sulabh chaturvedi", "link": "https://stackoverflow.com/users/8600836/sulabh-chaturvedi"}, "edited": false, "score": 0, "creation_date": 1542559368, "post_id": 53362236, "comment_id": 93602950, "body": "Whoever has downvoted the question. Please explain the reason for your downvote as that, would help me ask a better and improved question next time."}], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": false, "score": 1, "last_activity_date": 1542554174, "creation_date": 1542554174, "answer_id": 53362384, "question_id": 53362236, "link": "https://stackoverflow.com/questions/53362236/401-error-when-consuming-an-api-from-go-code-while-curl-works-well/53362384#53362384", "title": "401 Error when consuming an API from Go Code, while cURL Works well", "body": "<p>I'm just guessing here without enough information. I'm assuming <code>clusterId := os.Getenv(\"CLUSTER_ID\")</code> is <code>presto-bi</code>. If that is the case, then you are just missing \"clusters\" in your path.</p>\n\n<pre><code>apiUrl := \"https://api.qubole.com/api/v1.3/clusters/\"+clusterId+\"/state\"\n</code></pre>\n\n<p>Also, shouldn't you use <code>us.qubole.com/api</code> instead of <code>api.qubole.com</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": true, "score": 1, "last_activity_date": 1542555674, "last_edit_date": 1542555674, "creation_date": 1542555340, "answer_id": 53362565, "question_id": 53362236, "link": "https://stackoverflow.com/questions/53362236/401-error-when-consuming-an-api-from-go-code-while-curl-works-well/53362565#53362565", "title": "401 Error when consuming an API from Go Code, while cURL Works well", "body": "<p>Need check api hostname at golang and curl again. Thanks!</p>\n\n<p>The error is because, the documentation of API provider states the host WRONG (<a href=\"https://docs.qubole.com/en/latest/rest-api/cluster_api/start-terminate-cluster.html\" rel=\"nofollow noreferrer\">API Documentation</a>) . But, since the portal login is us.qubole.com (<a href=\"https://us.qubole.com/home\" rel=\"nofollow noreferrer\">PORTAL Login URL</a>), cURL command was written considering that in mind.</p>\n"}], "owner": {"reputation": 2172, "user_id": 8600836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VrWy0.jpg?s=128&g=1", "display_name": "sulabh chaturvedi", "link": "https://stackoverflow.com/users/8600836/sulabh-chaturvedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 53362565, "answer_count": 2, "score": -2, "last_activity_date": 1542555674, "creation_date": 1542553109, "last_edit_date": 1542554359, "question_id": 53362236, "link": "https://stackoverflow.com/questions/53362236/401-error-when-consuming-an-api-from-go-code-while-curl-works-well", "title": "401 Error when consuming an API from Go Code, while cURL Works well", "body": "<p>I've written a simple go code that, sends a GET request to an API and in response I receive a 401 error. However when I use cURL, I receive the desired response. I also get expected response using <a href=\"https://apitester.com\" rel=\"nofollow noreferrer\">API Tester</a>. So, I believe, there has to be something wrong with my code and that, I'm unable to find out.</p>\n\n<p>Below is my Go code, that, responds with 401 Error</p>\n\n<pre><code>func main() {\n    clusterId := os.Getenv(\"CLUSTER_ID\")\n    apiUrl := \"https://api.qubole.com/api/v1.3/clusters/\"+clusterId+\"/state\"\n    auth_token := os.Getenv(\"X_AUTH_TOKEN\")\n    fmt.Println(\"URL - \",apiUrl)\n    req, err := http.NewRequest(\"GET\", apiUrl, nil)\n    if(err != nil){\n        fmt.Println(\"ERROR in getting rest response\",err)\n    }\n    req.Header.Set(\"X-Auth-Token\", auth_token)\n    req.Header.Set(\"Content-Type\", \"application/json\")\n    req.Header.Set(\"Accept\", \"application/json\")\n\n    res, err := http.DefaultClient.Do(req)\n    if(err != nil){\n       fmt.Println(\"Error: No response received\", err)\n    }\n    defer res.Body.Close()\n    //print raw response body for debugging purposes\n    body, _ := ioutil.ReadAll(res.Body)\n    fmt.Println(string(body))\n}\n</code></pre>\n\n<p>Extract of Response/Error I get, is as follows:</p>\n\n<pre><code>URL -  https://api.qubole.com/api/v1.3/clusters/presto-bi/state\n{\"error\":{\"error_code\":401,\"error_message\":\"Invalid Token\"}}\n</code></pre>\n\n<p>Now, Following is the cURL command that, returns me the desired response</p>\n\n<pre><code>curl -X GET -H \"X-AUTH-TOKEN:$X_AUTH_TOKEN\" -H \"Content-Type: application/json\" -H \"Accept: application/json\" \"https://us.qubole.com/api/v1.3/clusters/presto-bi/state\"\n</code></pre>\n\n<p>below is the stdout I receive, which is as expected: <code>{\"state\":\"DOWN\"}%</code></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "reply_to_user": {"reputation": 2343, "user_id": 4532065, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/477b5c1ec36a72979cde174ad9902d9f?s=128&d=identicon&r=PG&f=1", "display_name": "sinusGob", "link": "https://stackoverflow.com/users/4532065/sinusgob"}, "edited": false, "score": 0, "creation_date": 1542553242, "post_id": 53362206, "comment_id": 93601074, "body": "I believe that&#39;s microseconds, and that is already given by the <code>.999999</code>. You can further go to nanoseconds if you need the extra precision e.g. <code>15:04:05.999999999</code>"}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "reply_to_user": {"reputation": 2343, "user_id": 4532065, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/477b5c1ec36a72979cde174ad9902d9f?s=128&d=identicon&r=PG&f=1", "display_name": "sinusGob", "link": "https://stackoverflow.com/users/4532065/sinusgob"}, "edited": false, "score": 0, "creation_date": 1542553758, "post_id": 53362206, "comment_id": 93601214, "body": "You can use <code>Time.Nanosecond()</code> to derive the microseconds e.g. <code>float64(time.Now().Nanosecond()) &#47; 1000</code>"}], "tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 2, "last_activity_date": 1542552930, "creation_date": 1542552930, "answer_id": 53362206, "question_id": 53362145, "link": "https://stackoverflow.com/questions/53362145/how-do-i-print-the-time-to-this-format-234422-184320/53362206#53362206", "title": "How do i print the time to this format 23:44:22.184320", "body": "<p>Use this instead:</p>\n\n<pre><code>time.Now().Format(\"15:04:05.999999\")\n</code></pre>\n\n<p>Note that the time layout for the <code>time</code> package is:</p>\n\n<pre><code>Mon Jan 2 15:04:05 MST 2006\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"nofollow noreferrer\">time package</a></p>\n"}], "owner": {"reputation": 2343, "user_id": 4532065, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/477b5c1ec36a72979cde174ad9902d9f?s=128&d=identicon&r=PG&f=1", "display_name": "sinusGob", "link": "https://stackoverflow.com/users/4532065/sinusgob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 53362206, "answer_count": 1, "score": -3, "last_activity_date": 1542552930, "creation_date": 1542552610, "question_id": 53362145, "link": "https://stackoverflow.com/questions/53362145/how-do-i-print-the-time-to-this-format-234422-184320", "title": "How do i print the time to this format 23:44:22.184320", "body": "<p>How do i print the time to this format?</p>\n\n<pre><code>23:44:22.184320\n</code></pre>\n\n<p>What I have tried is</p>\n\n<pre><code>func main() {\n   // Which will print to the current time\n   fmt.Println(time.Now())\n\n   // How do I convert to\n   // 23:44:22.184320\n}\n</code></pre>\n\n<p>I have checked this link but I couldn't figure out how to do so <a href=\"https://gobyexample.com/time-formatting-parsing\" rel=\"nofollow noreferrer\">https://gobyexample.com/time-formatting-parsing</a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1542592113, "post_id": 53362116, "comment_id": 93611300, "body": "Possibly prevented by <a href=\"http://gorm.io/docs/migration.html\" rel=\"nofollow noreferrer\">not changing existing columns</a>: <i>WARNING: AutoMigrate will ONLY create tables, missing columns and missing indexes, and WON\u2019T change existing column\u2019s type or delete unused columns to protect your data.</i>"}, {"owner": {"reputation": 4231, "user_id": 1343321, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/20d625be6a7f95fd700dd975e4167848?s=128&d=identicon&r=PG", "display_name": "Depado", "link": "https://stackoverflow.com/users/1343321/depado"}, "edited": false, "score": 0, "creation_date": 1543308651, "post_id": 53362116, "comment_id": 93861045, "body": "Mark&#39;s comment is right. Consider using something like <a href=\"https://github.com/go-gormigrate/gormigrate\" rel=\"nofollow noreferrer\">gormigrate</a> to have more control on your migrations."}], "owner": {"reputation": 17, "user_id": 4552167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34b43d34bcfa9c71389da914e6bf69b5?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/4552167/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542552430, "creation_date": 1542552430, "question_id": 53362116, "link": "https://stackoverflow.com/questions/53362116/automigrate-is-not-updating-constraints-mysql", "title": "AutoMigrate is not updating Constraints - MySQL", "body": "<p>AutoMigrate is not adding constraint <strong>UNIQUE</strong> for an existing column and that column doesn't have any duplicates.</p>\n\n<p>Note. nothing shown using Debug mode.</p>\n\n<p>any idea?</p>\n"}, {"tags": ["go", "types"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 7, "creation_date": 1542546451, "post_id": 53361099, "comment_id": 93598984, "body": "The first is a named struct type. The second is a named slice type whose elements are anonymous structs with the given fields."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8498981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0uyfJ.png?s=128&g=1", "display_name": "Murat", "link": "https://stackoverflow.com/users/8498981/murat"}, "edited": false, "score": 0, "creation_date": 1542549117, "post_id": 53361415, "comment_id": 93599750, "body": "Thanks for the clarification. I figured it out now."}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 1, "last_activity_date": 1542547925, "creation_date": 1542547925, "answer_id": 53361415, "question_id": 53361099, "link": "https://stackoverflow.com/questions/53361099/difference-between-type-foo-struct-and-type-foo-struct/53361415#53361415", "title": "Difference between `type foo struct` and `type foo []struct`", "body": "<pre><code>type foo1 struct {\n    Name string `json:\"name\"`\n}\n\ntype foo2 []struct {\n    Name string `json:\"name\"`\n}\n</code></pre>\n\n<p>Simple understand as</p>\n\n<pre><code>type foo2 []foo1 \n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8498981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0uyfJ.png?s=128&g=1", "display_name": "Murat", "link": "https://stackoverflow.com/users/8498981/murat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543769650, "creation_date": 1542545771, "last_edit_date": 1543769650, "question_id": 53361099, "link": "https://stackoverflow.com/questions/53361099/difference-between-type-foo-struct-and-type-foo-struct", "title": "Difference between `type foo struct` and `type foo []struct`", "body": "<p>What is the main difference between these structs?</p>\n\n<pre><code>type foo struct {\n    Name string `json:\"name\"`\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type foo []struct {\n    Name string `json:\"name\"`\n}\n</code></pre>\n"}, {"tags": ["go", "grpc", "go-micro"], "comments": [{"owner": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1542570281, "post_id": 53360973, "comment_id": 93606072, "body": "As a rule (and to prevent people trying to help), you have to post the relevant code here. Can you update the question and add the relevant code?"}, {"owner": {"reputation": 3, "user_id": 6638494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15cd47e9d0ed868382f3de1ffb3bda0e?s=128&d=identicon&r=PG&f=1", "display_name": "wade", "link": "https://stackoverflow.com/users/6638494/wade"}, "reply_to_user": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1542594386, "post_id": 53360973, "comment_id": 93611657, "body": "ok, no problem. sorry my bad"}], "owner": {"reputation": 3, "user_id": 6638494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15cd47e9d0ed868382f3de1ffb3bda0e?s=128&d=identicon&r=PG&f=1", "display_name": "wade", "link": "https://stackoverflow.com/users/6638494/wade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 714, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1542594855, "creation_date": 1542544797, "last_edit_date": 1542594855, "question_id": 53360973, "link": "https://stackoverflow.com/questions/53360973/why-client-always-received-transport-received-the-unexpected-content-type-fro", "title": "Why client always received &quot;transport: received the unexpected content-type&quot; from localhost GO wrote GRPC service", "body": "<p>I have just cloned the example code from <a href=\"https://github.com/micro/go-grpc\" rel=\"nofollow noreferrer\">micro/go-grpc</a> and tried to build a grpc server in localhost.</p>\n\n<pre><code>proto file \n\nsyntax = \"proto3\";\n\npackage go.micro.srv.greeter;\n\nservice Say {\n    rpc Hello(Request) returns (Response) {}\n}\n\nmessage Request {\n    string name = 1;\n}\n\nmessage Response {\n    string msg = 1;\n}\n</code></pre>\n\n<p>server/main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"log\"\n\n    \"github.com/micro/go-micro\"\n    \"github.com/micro/go-grpc\"\n    hello \"github.com/micro/go-grpc/examples/greeter/server/proto/hello\"\n)\n\ntype Say struct{}\n\nfunc (s *Say) Hello(ctx context.Context, req *hello.Request, rsp \n*hello.Response) error {\n    log.Print(\"Received Say.Hello request\")\n    rsp.Msg = \"Hello \" + req.Name\n    return nil\n}\n\nfunc main() {\n    service := grpc.NewService(\n        micro.Name(\"go.micro.srv.greeter\"),\n    )\n\n// optionally setup command line usage\nservice.Init()\n\n// Register Handlers\nhello.RegisterSayHandler(service.Server(), new(Say))\n\n// Run server\nif err := service.Run(); err != nil {\n    log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>client/main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n\n    \"github.com/micro/cli\"\n    \"github.com/micro/go-grpc\"\n    hello \"github.com/micro/go-grpc/examples/greeter/server/proto/hello\"\n    \"github.com/micro/go-micro\"\n)\n\nvar (\n    // service to call\n    serviceName string\n)\n\nfunc main() {\n    service := grpc.NewService()\n\n    service.Init(\n        micro.Flags(cli.StringFlag{\n            Name:        \"service_name\",\n            Value:       \"go.micro.srv.greeter\",\n            Destination: &amp;serviceName,\n        }),\n    )\n\n    cl := hello.NewSayService(serviceName, service.Client())\n\n    rsp, err := cl.Hello(context.TODO(), &amp;hello.Request{\n        Name: \"John\",\n    })\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    fmt.Println(rsp.Msg)\n}\n</code></pre>\n\n<p><strong>My OS is MacOsX, go version is 1.11.1</strong>.</p>\n\n<p>When i run the server side example code, everything looks fine:</p>\n\n<pre><code>$ go run ./main.go --server_address:localhost:9999\n2018/11/18 20:08:05 Listening on 127.0.0.1:9999\n2018/11/18 20:08:05 Broker Listening on [::]:62739\n2018/11/18 20:08:05 Registering node: go.micro.srv.greeter-9b2818b0-eb2a-11e8-bfef-720008acb800\n</code></pre>\n\n<p>But if I run the client side example code, always received:</p>\n\n<pre><code>{\"id\":\"\",\"code\":0,\"detail\":\"transport: received the unexpected content-type \"text/plain\"\",\"status\":\"\"}\n</code></pre>\n\n<p>I tried to remove the <code>--server_address</code> and still the same. I tried to add the <code>mdns</code> registry, not working either. I tried to use <code>$ micro health go.micro.srv.greeter</code>, it returned the same result.</p>\n\n<p>Wonder whats wrong with my setup?</p>\n"}, {"tags": ["amazon-web-services", "docker", "go", "auth0"], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 1990524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1b7da006e44f2492030e9ad17d15d23?s=128&d=identicon&r=PG", "display_name": "jjuser19jj", "link": "https://stackoverflow.com/users/1990524/jjuser19jj"}, "edited": false, "score": 0, "creation_date": 1542554836, "post_id": 53361767, "comment_id": 93601575, "body": "Thanks for the comment, I tried to generate a self signed certificate, but I guess that results in a unknown authority, since I still get the same error. Where can I get the correct certificate from ?"}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "reply_to_user": {"reputation": 1303, "user_id": 1990524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1b7da006e44f2492030e9ad17d15d23?s=128&d=identicon&r=PG", "display_name": "jjuser19jj", "link": "https://stackoverflow.com/users/1990524/jjuser19jj"}, "edited": false, "score": 0, "creation_date": 1542556766, "post_id": 53361767, "comment_id": 93602152, "body": "You need to buy it or use service like letsencrypt."}], "tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": false, "score": 0, "last_activity_date": 1542549978, "creation_date": 1542549978, "answer_id": 53361767, "question_id": 53360456, "link": "https://stackoverflow.com/questions/53360456/auth0-does-not-work-from-inside-docker-container-elastic-beanstalk/53361767#53361767", "title": "Auth0 Does not work from inside Docker container + Elastic beanstalk", "body": "<p>Check docker image you use for hosting your application. It should include registration for root certificate.</p>\n\n<p>You can find some image that includes that certificate or add them dynamicaly as described in this blog post - <a href=\"https://blog.codeship.com/building-minimal-docker-containers-for-go-applications/\" rel=\"nofollow noreferrer\">https://blog.codeship.com/building-minimal-docker-containers-for-go-applications/</a> </p>\n"}], "owner": {"reputation": 1303, "user_id": 1990524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1b7da006e44f2492030e9ad17d15d23?s=128&d=identicon&r=PG", "display_name": "jjuser19jj", "link": "https://stackoverflow.com/users/1990524/jjuser19jj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542549978, "creation_date": 1542541201, "question_id": 53360456, "link": "https://stackoverflow.com/questions/53360456/auth0-does-not-work-from-inside-docker-container-elastic-beanstalk", "title": "Auth0 Does not work from inside Docker container + Elastic beanstalk", "body": "<p>I have developed a golang application using Auth0 for user authentication, I have also developed a frontend app. On my local machine everything works fine. Now I want to deploy the app via docker on AWS elastic beanstalk. \nI build my docker image and run it, but Auth0 does not work anymore. I get the following error when I want to validate the authtoken send by a user:</p>\n\n<pre><code>Token is not valid  &lt;nil&gt;\nToken err: Get https://xxx.eu.auth0.com/.well-known/jwks.json: x509: certificate signed by unknown authority\n</code></pre>\n\n<p>This happens running the docker image on my local machine as well as on elastic beanstalk. However, if I just run go run main.go, everything works fine.\nAny ideas why ? Thanks for your help :)</p>\n"}, {"tags": ["datetime", "go", "time", "tuples", "slice"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1542549611, "post_id": 53360290, "comment_id": 93599925, "body": "I would suggest you put which part of your code you are having trouble from."}, {"owner": {"reputation": 126, "user_id": 8922082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d6cf7d14918426b7f8bb2eb1956b35?s=128&d=identicon&r=PG", "display_name": "hearot", "link": "https://stackoverflow.com/users/8922082/hearot"}, "reply_to_user": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1542554576, "post_id": 53360290, "comment_id": 93601483, "body": "@ssemilla You&#39;re right. I&#39;ll do next time!"}], "answers": [{"tags": [], "owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "is_accepted": true, "score": 1, "last_activity_date": 1542549338, "creation_date": 1542549338, "answer_id": 53361660, "question_id": 53360290, "link": "https://stackoverflow.com/questions/53360290/how-to-get-a-slice-of-tuples-hour-minute/53361660#53361660", "title": "How to get a slice of tuples (hour, minute)", "body": "<p>Here is a minimal code that demonstrates this, I did not put any data validation.</p>\n\n<pre><code>func periods(minutes, start, startBreak, stopBreak, stop *tuple.Tuple) (out []tuple.Tuple) {\n\n    // next() moves current to the next minute interval\n    i := 0\n    curr := tuple.NewTupleFromItems(start.Get(0), minutes.Get(0))\n    next := func() {\n        i = (i + 1) % minutes.Len()\n        curr.Set(1, minutes.Get(i))\n        if i == 0 {\n            curr.Set(0, curr.Get(0).(int)+1)\n        }\n    }\n\n    for ; curr.Le(stop); next() {\n        if (curr.Ge(start) &amp;&amp; curr.Le(startBreak)) || (curr.Ge(stopBreak) &amp;&amp; curr.Le(stop)) {\n            out = append(out, *curr.Copy())\n        }\n    }\n\n    return out\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/zSEut6KUziX\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 126, "user_id": 8922082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d6cf7d14918426b7f8bb2eb1956b35?s=128&d=identicon&r=PG", "display_name": "hearot", "link": "https://stackoverflow.com/users/8922082/hearot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 53361660, "answer_count": 1, "score": -2, "last_activity_date": 1542615955, "creation_date": 1542540166, "last_edit_date": 1542615955, "question_id": 53360290, "link": "https://stackoverflow.com/questions/53360290/how-to-get-a-slice-of-tuples-hour-minute", "title": "How to get a slice of tuples (hour, minute)", "body": "<p>I've got a problem that I couldn't resolve. I'm using <a href=\"https://github.com/kmanley/golang-tuple\" rel=\"nofollow noreferrer\">https://github.com/kmanley/golang-tuple</a> to create tuples.</p>\n\n<p>I've got a list of minutes:</p>\n\n<pre><code>minutes := int{0, 30} // Minutes are 0 and 30\n</code></pre>\n\n<p>And a four parameters: <code>start</code>, <code>startBreak</code>, <code>stop</code>, <code>stopBreak</code>:</p>\n\n<pre><code>start := tuple.NewTupleFromItems(9, 30) // It represents \"9:30\"\nstartBreak := tuple.NewTupleFromItems(12, 0) // It represents \"12:00\"\nstop := tuple.NewTupleFromItems(21, 0) // It represents \"21:00\"\nstopBreak := tuple.NewTupleFromItems(14, 30) // It represents \"14:30\"\n</code></pre>\n\n<p>I want to get a slice of tuples <code>(hour, minutes)</code> using all the minutes in the <code>minutes</code> slice and they must not be included in the range <code>startBreak-stopBreak</code> (it can be equal to <code>startBreak</code> or <code>stopBreak</code>, so the range will become <code>12:30, 13:00, 13:30, 14:00</code>) and <code>stop-start</code> (it can be equal to <code>start</code> and <code>stop</code>, so the range will become <code>21:30, 22:00, 22:30, ..., 8:30, 9:00</code>). </p>\n\n<p>For example, using those four parameters, the final result will be:</p>\n\n<pre><code>9:30, 10:00, 10:30, 11:00, 11:30, 12:00, 14:30, 15:00, 15:30, 16:00, 16:30, 17:00, 17:30, 18:00, 18:30, 19:00, 19:30, 20:00, 20:30, 21:00\n</code></pre>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542615975, "post_id": 53360256, "comment_id": 93617431, "body": "Please ask one question per post."}], "answers": [{"comments": [{"owner": {"reputation": 484, "user_id": 3508399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2Gvmg.jpg?s=128&g=1", "display_name": "Julia", "link": "https://stackoverflow.com/users/3508399/julia"}, "edited": false, "score": 1, "creation_date": 1542660466, "post_id": 53362364, "comment_id": 93640669, "body": "Thank You very much! Your answer is absolutely clear and helpful!"}], "tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": true, "score": 6, "last_activity_date": 1542554027, "creation_date": 1542554027, "answer_id": 53362364, "question_id": 53360256, "link": "https://stackoverflow.com/questions/53360256/how-to-implement-stub-in-golang-and-what-difference-between-stub-and-mock/53362364#53362364", "title": "How to implement stub in Golang? And what difference between stub and mock?", "body": "<p>Intention of mocks and stubs in GO is the same as different programming languages:</p>\n\n<ul>\n<li><strong>stub</strong> is replacement for some dependency in your code that will be used during test execution. It is typically built for one particular test and unlikely can be reused for another because it has hardcoded expectations and assumptions.</li>\n<li><strong>mock</strong> takes stubs to next level. It adds means for configuration, so you can set up different expectations for different tests. That makes mocks more complicated, but reusable for different tests.</li>\n</ul>\n\n<p>Let's check how that works on example:</p>\n\n<p>In our case, we have http handler that internally makes http calls to another web service. To test handler we want to isolate handler code from dependency we do not control (external web service). We can do that by either using <code>stub</code> or <code>mock</code>.</p>\n\n<p>Our handler code is the same for <code>stub</code> and <code>mock</code>. We should inject <code>http.Client</code> dependency to be be able to isolate it in unit test:</p>\n\n<pre><code>func New(client http.Client) http.Handler {\n    return &amp;handler{\n        client: client,\n    }\n}\n\ntype handler struct {\n    client http.Client\n}\n\nfunc (h handler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    ...\n    // work with external web service that cannot be executed in unit test\n    resp, err := h.client.Get(\"http://example.com\")\n    ...\n}\n</code></pre>\n\n<p>Our replacement for run-time <code>http.Client</code> is straight-forward in <code>stub</code>:</p>\n\n<pre><code>func TestHandlerStub(t *testing.T) {\n    mux := http.NewServeMux()\n    mux.Handle(\"/\", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // here you can put assertions for request\n\n        // generate response\n        w.WriteHeader(http.StatusOK)\n    }))\n    server := httptest.NewServer(mux)\n\n    r, _ := http.NewRequest(http.MethodGet, \"https://some.com\", nil)\n    w := httptest.NewRecorder()\n    sut := New(server.Client())\n    sut.ServeHTTP(w, r)\n    //assert handler response\n}\n</code></pre>\n\n<p>Mock story is more complicated. I am skipping code for mock implementation but this is how its interface may look like:</p>\n\n<pre><code>type Mock interface {\n    AddExpectation(path string, handler http.HandlerFunc)\n    Build() *http.Client\n}\n</code></pre>\n\n<p>This is code for test using Mock:</p>\n\n<pre><code>func TestHandlerMock(t *testing.T) {\n    mock := NewMock()\n    mock.AddExpectation(\"/\", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // here you can put assertions for request\n\n        // generate response\n        w.WriteHeader(http.StatusOK)\n    }))\n\n    r, _ := http.NewRequest(http.MethodGet, \"https://some.com\", nil)\n    w := httptest.NewRecorder()\n    sut := New(mock.Build())\n    sut.ServeHTTP(w, r)\n    //assert handler response\n}\n</code></pre>\n\n<p>For this simple sample it adds no much value. But think about more complicated cases. You can build much cleaner tests code and cover more cases with less lines.</p>\n\n<p>This is how tests setup may look like if we have to call 2 services and evolved our mock a little bit:</p>\n\n<pre><code>mock.AddExpectation(\"/first\", firstSuccesfullHandler).AddExpectation(\"/second\", secondSuccesfullHandler)\nmock.AddExpectation(\"/first\", firstReturnErrorHandler).AddExpectation(\"/second\", secondShouldNotBeCalled)\nmock.AddExpectation(\"/first\", firstReturnBusy).AddExpectation(\"/first\", firstSuccesfullHandler)AddExpectation(\"/second\", secondSuccesfullHandler)\n</code></pre>\n\n<p>You can imagine how many times you have to copy-paste handler logic in tests if we do not have our tiny mock helper. That copy-pasted code makes our tests fridgile.</p>\n\n<p>But building your own mocks is not the only options. You can rely on existing mocking packages like <a href=\"https://github.com/DATA-DOG/go-sqlmock\" rel=\"noreferrer\">DATA-DOG/go-sqlmock</a> that mocks SQL.</p>\n"}], "owner": {"reputation": 484, "user_id": 3508399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2Gvmg.jpg?s=128&g=1", "display_name": "Julia", "link": "https://stackoverflow.com/users/3508399/julia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5377, "favorite_count": 1, "closed_date": 1542615961, "accepted_answer_id": 53362364, "answer_count": 1, "score": 2, "last_activity_date": 1542554027, "creation_date": 1542539942, "question_id": 53360256, "link": "https://stackoverflow.com/questions/53360256/how-to-implement-stub-in-golang-and-what-difference-between-stub-and-mock", "closed_reason": "Needs details or clarity", "title": "How to implement stub in Golang? And what difference between stub and mock?", "body": "<p>I am using mocks in unit testing in Golang. But how to get the difference between stub and mock in the implementation code in Golang?</p>\n"}, {"tags": ["if-statement", "go", "range"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1542539889, "post_id": 53360085, "comment_id": 93597237, "body": "Change <code>{if .Img }}</code> to <code>{{if .Img }}</code>."}, {"owner": {"reputation": 593, "user_id": 7390885, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ddd5e4e7377bfc8a1ac97f0755a2dfc2?s=128&d=identicon&r=PG&f=1", "display_name": "tomole", "link": "https://stackoverflow.com/users/7390885/tomole"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1542540085, "post_id": 53360085, "comment_id": 93597295, "body": "wow. Thank you. That was stupid!"}], "owner": {"reputation": 593, "user_id": 7390885, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ddd5e4e7377bfc8a1ac97f0755a2dfc2?s=128&d=identicon&r=PG&f=1", "display_name": "tomole", "link": "https://stackoverflow.com/users/7390885/tomole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542538566, "creation_date": 1542538566, "question_id": 53360085, "link": "https://stackoverflow.com/questions/53360085/nested-if-statement-inside-range-in-template-html", "title": "Nested if statement inside range in template html", "body": "<p>I need a nested <code>if-statement</code> inside a <code>range</code> in a <code>golang</code> <code>\"html/template\"</code>.</p>\n\n<p>Bookmarks.html</p>\n\n<pre><code>{{define \"bookmarks\"}}\n&lt;div class=\"bookmarks\"&gt;\n    {{range .}}\n    &lt;div class=\"bookmark\"&gt;\n        &lt;div class=\"image\"&gt;\n            &lt;a target=\"_blank\" rel=\"noopener noreferrer\" href=\"{{.Url}}\"&gt;\n                {if .Img }}\n                &lt;img src=\"/bookmark/get/image?name={{ .Img }}\"/&gt;\n                {{else}}\n                &lt;img src=\"../static/images/placeholder.jpg\"/&gt;\n                {{end}}\n            &lt;/a&gt;\n        &lt;/div&gt;\n    {{end}}\n&lt;/div&gt;\n{{end}}\n</code></pre>\n\n<p><code>go run</code> ends up in:</p>\n\n<blockquote>\n  <p>panic: template: bookmarks.html:26: unexpected {{end}}</p>\n</blockquote>\n"}, {"tags": ["json", "go", "request"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1542531936, "post_id": 53359013, "comment_id": 93595493, "body": "In your case, you should re-factor to not read the body twice. It would be far more efficient (especially if you have large bodies), to validate the decoded data <i>after</i> you have decoded it, rather than decoding twice."}, {"owner": {"reputation": 309, "user_id": 7352863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c717ab10f283d2a60787988eb1e4f03b?s=128&d=identicon&r=PG&f=1", "display_name": "sohamdodia", "link": "https://stackoverflow.com/users/7352863/sohamdodia"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542534213, "post_id": 53359013, "comment_id": 93595992, "body": "@Flimzy Can you please explain how can I refactor the code? I have another approach as well in which I can copy data of one struct into another. How can I do that?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542615104, "post_id": 53359013, "comment_id": 93617122, "body": "In general:  Don&#39;t have a separate &#39;ValidationModel&#39;--instead, validate the <code>UserModel</code>."}], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 446465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5468f8ae76cf49147676e1cb217940?s=128&d=identicon&r=PG", "display_name": "iwind", "link": "https://stackoverflow.com/users/446465/iwind"}, "edited": false, "score": 3, "creation_date": 1556070478, "post_id": 53359192, "comment_id": 98308593, "body": "It&#39;s not a good idea to use ioutil.ReadAll when r.Body is very large, such as 1G Bytes."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 459, "user_id": 446465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5468f8ae76cf49147676e1cb217940?s=128&d=identicon&r=PG", "display_name": "iwind", "link": "https://stackoverflow.com/users/446465/iwind"}, "edited": false, "score": 0, "creation_date": 1597969127, "post_id": 53359192, "comment_id": 112313130, "body": "This is true, however you can protect yourself with a <a href=\"https://golang.org/pkg/io/#LimitedReader\" rel=\"nofollow noreferrer\">golang.org/pkg/io/#LimitedReader</a>"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 11, "last_activity_date": 1542530738, "creation_date": 1542530738, "answer_id": 53359192, "question_id": 53359013, "link": "https://stackoverflow.com/questions/53359013/read-request-body-two-times-in-golang/53359192#53359192", "title": "Read request body two times in Golang", "body": "<p>Storing the data can be easily done with <a href=\"https://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"noreferrer\">ioutil.ReadAll()</a>:</p>\n\n<pre><code>data, err := ioutil.ReadAll(r.Body)\n</code></pre>\n\n<p>If you need the <code>data</code> back as a <code>io.Reader</code> (which is how the <code>r.Body</code> is), then you can use <a href=\"https://golang.org/pkg/bytes/#NewReader\" rel=\"noreferrer\">bytes.NewReader()</a>:</p>\n\n<pre><code>reader := bytes.NewReader(data)\n</code></pre>\n\n<p>And ACTUALLY, <code>r.Body</code> is a <code>io.ReadCloser</code>, so if you need that you can use <a href=\"https://golang.org/pkg/io/ioutil/#NopCloser\" rel=\"noreferrer\">ioutil.NopCloser()</a> in conjunction with <a href=\"https://golang.org/pkg/bytes/#NewReader\" rel=\"noreferrer\">bytes.NewReader()</a>:</p>\n\n<pre><code>reader := ioutil.NopCloser(bytes.NewReader(data))\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 7352863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c717ab10f283d2a60787988eb1e4f03b?s=128&d=identicon&r=PG&f=1", "display_name": "sohamdodia", "link": "https://stackoverflow.com/users/7352863/sohamdodia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4438, "favorite_count": 1, "closed_date": 1542558400, "accepted_answer_id": 53359192, "answer_count": 1, "score": 3, "last_activity_date": 1542530738, "creation_date": 1542528814, "question_id": 53359013, "link": "https://stackoverflow.com/questions/53359013/read-request-body-two-times-in-golang", "closed_reason": "Duplicate", "title": "Read request body two times in Golang", "body": "<pre><code>type ValidationModel struct {\n    Name     string `json:\"name\" valid:\"alpha,required~Name is required\"`\n    Email    string `json:\"email\" valid:\"email~Enter a valid email.,required~Email is required.\"`\n    Password string `json:\"password\" valid:\"required~Password is required\"`\n}\n\nvalidationModel := ValidationModel{}\n\njson.NewDecoder(r.Body).Decode(&amp;validationModel)\n\n_, err := govalidator.ValidateStruct(validationModel)\n</code></pre>\n\n<p>First I am validating the request body using govalidator.</p>\n\n<pre><code>type UserModel struct {\n    ID           bson.ObjectId `json:\"_id\" bson:\"_id\"`\n    Name         string        `json:\"name\" bson:\"name\"`\n    Email        string        `json:\"email\" bson:\"email\"`\n    Password     string        `json:\"password,omitempty\" bson:\"-\"`\n    PasswordHash string        `json:\"-\" bson:\"passwordHash\"`\n    Salt         string        `json:\"-\" bson:\"salt\"`\n    Token        string        `json:\"token,omitempty\" bson:\"-\"`\n}\n\n\nuser := models.UserModel{}\njson.NewDecoder(r.Body).Decode(&amp;user)\n\nfmt.Println(user)\n</code></pre>\n\n<p>And after validating the request, again I am decoding the request body into user struct, but the request body has been read once using validationModel, so when I try to again decode it into user, it is not giving me any values.</p>\n\n<p>I can think of two solutions here:</p>\n\n<ol>\n<li><p>Store request body in one separate variable, and use that variable two times.</p></li>\n<li><p>Copy validationModel values in user.</p></li>\n</ol>\n\n<p>But I don't have any idea about to implement these approaches and which approach is best to follow. Or is there any other solution which can be implemented?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542530913, "post_id": 53359006, "comment_id": 93595279, "body": "What are you trying to accomplish? Why not just use <code>net&#47;http</code>?"}, {"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542530989, "post_id": 53359006, "comment_id": 93595299, "body": "I am using net/http... the handler function is delegating the work to goroutine which has data"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542531192, "post_id": 53359006, "comment_id": 93595339, "body": "&quot;Is this pattern the right way of doing this?&quot; -- the right way of doing what? You still haven&#39;t explained your goal. Why go to all this effort to seemingly undermine the standard library, and make your code less efficient?"}, {"owner": {"reputation": 135, "user_id": 5793538, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/edae7012e51b17db765a6aa25855b520?s=128&d=identicon&r=PG&f=1", "display_name": "Shank", "link": "https://stackoverflow.com/users/5793538/shank"}, "edited": false, "score": 1, "creation_date": 1542531344, "post_id": 53359006, "comment_id": 93595374, "body": "The handler function doesnt have enough state to handle request..It delegates it to another goroutine which has the required data procured from some other place. is that what you are trying to achieve?"}, {"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "reply_to_user": {"reputation": 135, "user_id": 5793538, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/edae7012e51b17db765a6aa25855b520?s=128&d=identicon&r=PG&f=1", "display_name": "Shank", "link": "https://stackoverflow.com/users/5793538/shank"}, "edited": false, "score": 0, "creation_date": 1542531467, "post_id": 53359006, "comment_id": 93595404, "body": "@Shank Yes exactly"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542531625, "post_id": 53359006, "comment_id": 93595431, "body": "There&#39;s no reason to use a goroutine, if the goal is context propagation."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1542531703, "post_id": 53359006, "comment_id": 93595450, "body": "This question looks pretty obviously like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a> to me. Until the actual <i>goal</i> is stated, I don&#39;t think any proper answer will be possible."}], "answers": [{"comments": [{"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1542532893, "post_id": 53359376, "comment_id": 93595714, "body": "Doesn&#39;t the channel guarantee thread safety? The channel is being read by 1 single goroutine and hence at any point of time, it would service a single request."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1542533131, "post_id": 53359376, "comment_id": 93595769, "body": "Yes it can. However my point is that the pattern of having the handler take on thread safety is not great decoupling of concerns. If later you decide the channels are non-performant, you would want the ability to refactor without having to rewrite every single part."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 1, "last_activity_date": 1542533960, "last_edit_date": 1542533960, "creation_date": 1542532598, "answer_id": 53359376, "question_id": 53359006, "link": "https://stackoverflow.com/questions/53359006/pattern-for-handling-http-requests-via-channels/53359376#53359376", "title": "Pattern for handling HTTP requests via channels", "body": "<blockquote>\n  <p>Is this pattern the right way of doing this?</p>\n</blockquote>\n\n<p>Assuming you are trying to manage where state in a single go routine, I would say <strong>no</strong>. I think it would be better to have some form of a state manager that is responsible for thread safety. Therefore the handler should take in something that can manage the state and simply expose a few methods to the handler.</p>\n\n<pre><code>type State interface{\n  Load() (string, error)\n  Save(something string) error\n}\n</code></pre>\n\n<p>Decoupling the code will pay off for you later on. It will also allow unit tests for both the handler and the State that can be focused and readable.</p>\n"}], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542533960, "creation_date": 1542528774, "last_edit_date": 1542530871, "question_id": 53359006, "link": "https://stackoverflow.com/questions/53359006/pattern-for-handling-http-requests-via-channels", "title": "Pattern for handling HTTP requests via channels", "body": "<p>I am writing a web application where I have a long running goroutine.\nI want to delegate all HTTP requests to this goroutine via channels.\nThe pattern that I have come across is:</p>\n\n<pre><code>// Internal long running goroutine\nfor{\n  select{\n  case e := &lt;-event: //web request\n    req := e.req\n    // do something\n    ....\n    select {\n    case &lt;-ctx.Done():\n       //log  \n    default: \n      e.replyTo &lt;- result\n    }\n  }\n}\n\n// Web handler\nhttp.HandleFunc(\"/bar\", func(w http.ResponseWriter, r *http.Request) {\n  //decode request etc\n  ...\n\n  replyTo := make(chan interface{}, 1)\n  ctx, cancel := context.WithCancel(context.BackGround())\n  event &lt;- Event{req: req, ctx: ctx, replyTo: replyTo}\n  select{\n  case &lt;-time.After(time.Second):\n     cancel()\n     //return 500\n  case r := &lt;-replyTo:\n    // return some response\n  }\n})\n</code></pre>\n\n<p>I do see that there is one single go-routine at the end, so parallelism is lost but I am okay with it.</p>\n\n<p>Is this pattern the right way of doing this?\nWhat other approaches can be suggested?</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1542530975, "post_id": 53358457, "comment_id": 93595295, "body": "&quot;various errors&quot; isn&#39;t very useful. What <i>specific</i> error do you get, and with what <i>specific</i> code?"}], "answers": [{"comments": [{"owner": {"reputation": 700, "user_id": 6940117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/us57e.png?s=128&g=1", "display_name": "Slotheroo", "link": "https://stackoverflow.com/users/6940117/slotheroo"}, "edited": false, "score": 0, "creation_date": 1542528280, "post_id": 53358483, "comment_id": 93594822, "body": "i.e. If you&#39;re only returning one variable, it does not need to be inside parentheses (but can be). If you&#39;re returning 2 or more then they do."}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "reply_to_user": {"reputation": 700, "user_id": 6940117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/us57e.png?s=128&g=1", "display_name": "Slotheroo", "link": "https://stackoverflow.com/users/6940117/slotheroo"}, "edited": false, "score": 0, "creation_date": 1542531434, "post_id": 53358483, "comment_id": 93595394, "body": "yeah, <code>Result = Parameters | Type .</code> is what you meant, the second part of or"}], "tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 2, "last_activity_date": 1542522922, "creation_date": 1542522922, "answer_id": 53358483, "question_id": 53358457, "link": "https://stackoverflow.com/questions/53358457/can-you-return-some-or-all-of-multiple-values-as-pointers-from-a-function/53358483#53358483", "title": "Can you return some or all of multiple values as pointers from a function?", "body": "<p>as said <a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow noreferrer\">here</a> in golang spec, you are wrong in <a href=\"https://golang.org/ref/spec#ParameterList\" rel=\"nofollow noreferrer\">this</a> part so:</p>\n\n<pre><code>func A (s string) (*string, int) {\n    //stuff\n}\n</code></pre>\n\n<p>is the compilable code</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 5429087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9ecb7dc26f59a3f2f4b0d0fa3324729?s=128&d=identicon&r=PG&f=1", "display_name": "user5429087", "link": "https://stackoverflow.com/users/5429087/user5429087"}, "edited": false, "score": 0, "creation_date": 1542574002, "post_id": 53358696, "comment_id": 93607085, "body": "Hm, interesting about the strings but I would like to look at this more generically. Let&#39;s just for the sake of argument take the integer b and suppose I wanted to pass/return it by pointer (pointless most probably from an efficiency point of view but this is just an exercise) in this two variable return. Would I just put an asterisk after the &quot;int&quot; and the &quot;d&quot; and an ampersand after the b? This was the type of thing that worked with one return variable but was failing me on two return variables but maybe that had something to do with the type of variable at the time."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 0, "last_activity_date": 1542580182, "last_edit_date": 1542580182, "creation_date": 1542525402, "answer_id": 53358696, "question_id": 53358457, "link": "https://stackoverflow.com/questions/53358457/can-you-return-some-or-all-of-multiple-values-as-pointers-from-a-function/53358696#53358696", "title": "Can you return some or all of multiple values as pointers from a function?", "body": "<p>You can return multiple variables from a function:</p>\n\n<pre><code>func A (s string) (string, int) {\n  a := \"hello world\"\n  b := 99\n\n  return a, b\n}\n\nc, d := A(\"Hi there.\")\n</code></pre>\n\n<p>One thing I would like to point out is that in Go, strings aren't pointers. In languages like C, you get used to thinking about a <code>string</code> as a <code>char*</code>, however in Go, a <code>string</code> is treated as a primitive much like you would an <code>int</code>.</p>\n\n<p>This seems to trip people from time to time, however it is actually quite nice as you don't have to worry about pointers with strings.</p>\n\n<p>If you find yourself in a situation where you want to return a <code>nil</code> string (which you can't do because it's not a pointer), then you would return an empty string (<code>\"\"</code>).</p>\n\n<p><strong>Pointers</strong>: If you really want to do pointers...</p>\n\n<pre><code>func A (s string) (*string, int) {\n  a := \"hello world\"\n  b := 99\n\n  // NOTE: you have to have a variable hold the string.\n  // return a, &amp;\"hello world\" // &lt;- Invalid\n  return a, &amp;b\n}\n\n// 'd' is of type *string\nc, d := A(\"Hi there.\")\n\nvar sPtr *string = d\nvar s string = *d // Use the * to dereference the pointer\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 5429087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9ecb7dc26f59a3f2f4b0d0fa3324729?s=128&d=identicon&r=PG&f=1", "display_name": "user5429087", "link": "https://stackoverflow.com/users/5429087/user5429087"}, "is_accepted": false, "score": 0, "last_activity_date": 1542689595, "creation_date": 1542689595, "answer_id": 53386441, "question_id": 53358457, "link": "https://stackoverflow.com/questions/53358457/can-you-return-some-or-all-of-multiple-values-as-pointers-from-a-function/53386441#53386441", "title": "Can you return some or all of multiple values as pointers from a function?", "body": "<p>@poy: I took your code and put in the playground and managed to get it working. I'm not sure what the issue was with why it wasn't working for me but there was probably something else going on. Anyway, with a little massaging this did work:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc A (s *string) (*string, int) {\n  b := 99\n\n  return s, b\n}\n\nfunc main() {\n    r := \"Hi there.\"\n    var s *string = &amp;r\n\n    c, d := A(s)\n    fmt.Println(*c, d)\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 5429087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9ecb7dc26f59a3f2f4b0d0fa3324729?s=128&d=identicon&r=PG&f=1", "display_name": "user5429087", "link": "https://stackoverflow.com/users/5429087/user5429087"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 53358696, "answer_count": 3, "score": -3, "last_activity_date": 1542689595, "creation_date": 1542522583, "last_edit_date": 1542530932, "question_id": 53358457, "link": "https://stackoverflow.com/questions/53358457/can-you-return-some-or-all-of-multiple-values-as-pointers-from-a-function", "title": "Can you return some or all of multiple values as pointers from a function?", "body": "<p>Working with Go I was getting various errors trying to return a string as pointer while returning another value as well. Something like this (pls. excuse for this not being running code, I just wrote it to give a sense of what I want to do since I don't know how to exactly make it work):</p>\n\n<pre><code>func A (s string) *string, int {\n\n  // Stuff\n  return &amp;a, b\n}\n*c, d := A(\"Hi there.\")\n</code></pre>\n\n<p>When I try various combinations to say, return the string (var. <code>a</code>) as a pointer I get various errors. It's easy and there's dozens of examples with a single variable returned but I'm not sure if it's possible with multiple return values.</p>\n\n<p>Sorry if this seems like a very basic question, I'm still wrapping my mind around Go.</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 2, "creation_date": 1542520620, "post_id": 53358217, "comment_id": 93593764, "body": "In Go, you could use the <code>golang.org&#47;x&#47;net&#47;html</code> parser for that, but as asked, this question is very broad. You&#39;re tagging three different languages, for starters."}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1542523116, "post_id": 53358217, "comment_id": 93594092, "body": "golang doesnt have for scraping in its stdlib, you can use 3rd parties like gocolly"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10669369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b7d93c3240f2a0e9cb36624592ae6?s=128&d=identicon&r=PG&f=1", "display_name": "tombol", "link": "https://stackoverflow.com/users/10669369/tombol"}, "edited": false, "score": 0, "creation_date": 1542549184, "post_id": 53358749, "comment_id": 93599771, "body": "Hi, it&#39;s working but I still can&#39;t get content inside comment :D     &lt;!--    &lt;td valign=&quot;top&quot; align=&quot;center&quot;&gt;-6.2245&lt;/td&gt;    &lt;td valign=&quot;top&quot; align=&quot;center&quot;&gt;107.0827&lt;/td&gt;    --&gt; thanks anyway"}, {"owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "reply_to_user": {"reputation": 3, "user_id": 10669369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b7d93c3240f2a0e9cb36624592ae6?s=128&d=identicon&r=PG&f=1", "display_name": "tombol", "link": "https://stackoverflow.com/users/10669369/tombol"}, "edited": false, "score": 0, "creation_date": 1542550035, "post_id": 53358749, "comment_id": 93600055, "body": "Unfortunately, there is no CSS selector for html comments. Trick is html = strings.Replace(html, &quot;&lt;!--&quot;, &quot;&quot;, -1)"}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": true, "score": 0, "last_activity_date": 1542525993, "creation_date": 1542525993, "answer_id": 53358749, "question_id": 53358217, "link": "https://stackoverflow.com/questions/53358217/scrape-web-content-with-golang/53358749#53358749", "title": "scrape web content with golang", "body": "<p><a href=\"https://godoc.org/github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">goquery</a> is great lib for parsing html content.</p>\n\n<pre><code>    html := `\n      &lt;table&gt;&lt;tbody id=\"the-list\"&gt;\n         &lt;tr&gt;\n            &lt;td valign=\"top\" align=\"right\"&gt;1.&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;BEKASI&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;Tambun&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;Selatan&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;01.4.13.16.06.000013&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;Jalan&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;PERUM BEKASI GRIYA ASRI&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;1.500 m&lt;sup&gt;2&lt;/sup&gt;&lt;/td&gt;\n            &lt;td valign=\"top\" align=\"center\"&gt;Kantor&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;400 m&lt;sup&gt;2&lt;/sup&gt;&lt;/td&gt;\n            &lt;td valign=\"top\" align=\"center\"&gt;1998&lt;/td&gt;            \n            &lt;td valign=\"top\" align=\"center\"&gt;&gt; 200&lt;/td&gt;\n\n            &lt;!--\n            &lt;td valign=\"top\" align=\"center\"&gt;-6.2245&lt;/td&gt;\n            &lt;td valign=\"top\" align=\"center\"&gt;107.0827&lt;/td&gt;\n            --&gt;\n\n            &lt;td valign=\"top\" align=\"right\"&gt;3&lt;/td&gt;\n            &lt;td valign=\"top\" align=\"right\"&gt;7&lt;/td&gt;\n            &lt;td valign=\"top\" align=\"right\"&gt;2&lt;/td&gt;\n            &lt;td valign=\"top\" align=\"right\"&gt;150&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;08888123&lt;/td&gt;\n            &lt;td valign=\"top\"&gt;-&lt;/td&gt;\n\n        &lt;/tr&gt;\n   &lt;/tbody&gt;&lt;/table&gt;\n`\n    doc, _ := goquery.NewDocumentFromReader(strings.NewReader(html))\n    sel := doc.Find(\"#the-list td\")\n    for i := range sel.Nodes{\n        n := sel.Eq(i)\n        fmt.Println(n.Text())\n    }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10669369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4b7d93c3240f2a0e9cb36624592ae6?s=128&d=identicon&r=PG&f=1", "display_name": "tombol", "link": "https://stackoverflow.com/users/10669369/tombol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 53358749, "answer_count": 1, "score": 0, "last_activity_date": 1542530447, "creation_date": 1542519493, "last_edit_date": 1542530447, "question_id": 53358217, "link": "https://stackoverflow.com/questions/53358217/scrape-web-content-with-golang", "title": "scrape web content with golang", "body": "<p>I am a beginner in programming languages \u200b\u200band I am learning scrape. Is it possible to get data in comments like this? </p>\n\n<pre><code>&lt;tbody id=\"the-list\"&gt;\n&lt;tr&gt;\n    &lt;td valign=\"top\" align=\"right\"&gt;1.&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;BEKASI&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;Tambun&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;Selatan&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;01.4.13.16.06.000013&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;Jalan&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;PERUM BEKASI GRIYA ASRI&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;1.500 m&lt;sup&gt;2&lt;/sup&gt;&lt;/td&gt;\n    &lt;td valign=\"top\" align=\"center\"&gt;Kantor&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;400 m&lt;sup&gt;2&lt;/sup&gt;&lt;/td&gt;\n    &lt;td valign=\"top\" align=\"center\"&gt;1998&lt;/td&gt;            \n    &lt;td valign=\"top\" align=\"center\"&gt;&gt; 200&lt;/td&gt;\n\n    &lt;!--\n    &lt;td valign=\"top\" align=\"center\"&gt;-6.2245&lt;/td&gt;\n    &lt;td valign=\"top\" align=\"center\"&gt;107.0827&lt;/td&gt;\n    --&gt;\n\n    &lt;td valign=\"top\" align=\"right\"&gt;3&lt;/td&gt;\n    &lt;td valign=\"top\" align=\"right\"&gt;7&lt;/td&gt;\n    &lt;td valign=\"top\" align=\"right\"&gt;2&lt;/td&gt;\n    &lt;td valign=\"top\" align=\"right\"&gt;150&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;08888123&lt;/td&gt;\n    &lt;td valign=\"top\"&gt;-&lt;/td&gt;\n\n&lt;/tr&gt;\n</code></pre>\n\n<p>I hope the results can be like this</p>\n\n<pre><code>1.;BEKASI;Tambun;Selatan;01.4.13.16.06.000013;Jalan;PERUM BEKASI GRIYA ASRI;1.500 m;Kantor;400 m;1998;200;-6.2245;107.0827;3;7;2;150;08888123;-\n</code></pre>\n"}]