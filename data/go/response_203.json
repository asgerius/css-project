[{"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543480858, "post_id": 53529886, "comment_id": 93937303, "body": "What about that example is &quot;binary&quot;? It looks like completely normal ASCII text."}, {"owner": {"reputation": 8350, "user_id": 772000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0e951e108fe3c1243260497ca9cb4dc?s=128&d=identicon&r=PG", "display_name": "Ale\u0161", "link": "https://stackoverflow.com/users/772000/ale%c5%a1"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543507423, "post_id": 53529886, "comment_id": 93952926, "body": "My bad, not sure what is the term to refer to this kind of field type. It is a multiline string?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543516838, "post_id": 53529886, "comment_id": 93957763, "body": "Yes, I would call it a multi-line string."}], "answers": [{"comments": [{"owner": {"reputation": 8350, "user_id": 772000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0e951e108fe3c1243260497ca9cb4dc?s=128&d=identicon&r=PG", "display_name": "Ale\u0161", "link": "https://stackoverflow.com/users/772000/ale%c5%a1"}, "edited": false, "score": 0, "creation_date": 1543520352, "post_id": 53537408, "comment_id": 93959318, "body": "Thanks for clarification. I have updated my question. I need to decode/encode the &quot;multi-line string&quot; fields."}], "tags": [], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1543523868, "last_edit_date": 1543523868, "creation_date": 1543488924, "answer_id": 53537408, "question_id": 53529886, "link": "https://stackoverflow.com/questions/53529886/decode-encode-multi-line-string-fields-from-yaml-using-golang/53537408#53537408", "title": "Decode/Encode multi-line string fields from YAML using golang", "body": "<p>You would parse a multi-line string the same way as a normal string:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/yaml.v2\"\n    \"log\"\n)\n\nvar yamlString = `\nData:\n  Foo: |\n    enemies=aliens\n    lives=3\n    enemies.cheat=true\n    enemies.cheat.level=noGoodRotten`\n\ntype data struct {\n    Data map[string]string `yaml:\"Data\"`\n}\n\nfunc main() {\n    t := data{}\n\n    err := yaml.Unmarshal([]byte(yamlString), &amp;t)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n\n    if foo, ok := t.Data[\"Foo\"]; ok {\n        fmt.Printf(\"--- t:\\n%v\\n\\n\", foo)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8350, "user_id": 772000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0e951e108fe3c1243260497ca9cb4dc?s=128&d=identicon&r=PG", "display_name": "Ale\u0161", "link": "https://stackoverflow.com/users/772000/ale%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 2, "accepted_answer_id": 53537408, "answer_count": 1, "score": 0, "last_activity_date": 1543523868, "creation_date": 1543449267, "last_edit_date": 1543520289, "question_id": 53529886, "link": "https://stackoverflow.com/questions/53529886/decode-encode-multi-line-string-fields-from-yaml-using-golang", "title": "Decode/Encode multi-line string fields from YAML using golang", "body": "<p>YAML files can contain fields with \"multi-line string\" data. Example below:</p>\n\n<pre><code>Data:\n  Foo: |\n    enemies=aliens\n    lives=3\n    enemies.cheat=true\n    enemies.cheat.level=noGoodRotten\n</code></pre>\n\n<p>How can I properly encode and decode these in Golang and what should be the type of the <code>Data</code> field, <code>map[string][]byte</code>?</p>\n\n<p>I tried:</p>\n\n<pre><code>import (\n    yamlv2 \"gopkg.in/yaml.v2\"\n)\n\ntype data struct {\n  Data map[string][]byte\n}\n\nfunc decode(bytes []byte) (*data, error) {\n  d := &amp;data{}\n\n  err := yamlv2.Unmarshal(bytes, d)\n  if err != nil {\n    return nil, err\n  }\n  return d, nil\n}\n</code></pre>\n\n<p>Also see in <a href=\"https://play.golang.org/p/F2AQkwBpQKv\" rel=\"nofollow noreferrer\">Playground</a>.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 10027, "user_id": 1647559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ab1e142a46861a6e6653ef30bcd9ea88?s=128&d=identicon&r=PG", "display_name": "Kuan", "link": "https://stackoverflow.com/users/1647559/kuan"}, "edited": false, "score": 0, "creation_date": 1543443884, "post_id": 53528832, "comment_id": 93926793, "body": "Thanks for the solution"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1543443712, "last_edit_date": 1543443712, "creation_date": 1543442778, "answer_id": 53528832, "question_id": 53528766, "link": "https://stackoverflow.com/questions/53528766/try-to-understand-how-to-build-an-array-from-int-params/53528832#53528832", "title": "Try to understand how to build an array from int params", "body": "<p>There are no constant values. For example,</p>\n\n<pre><code>package main\n\nimport \"golang.org/x/tour/pic\"\n\nfunc Pic(dx, dy int) [][]uint8 {\n    p := make([][]uint8, dy)\n    for x := range p {\n        p[x] = make([]uint8, dx)\n        for y := range p[x] {\n            p[x][y] = uint8(x * y)\n        }\n    }\n    return p\n}\n\nfunc main() {\n    pic.Show(Pic)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/JQwGhfBth0o\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JQwGhfBth0o</a></p>\n"}, {"comments": [{"owner": {"reputation": 10027, "user_id": 1647559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ab1e142a46861a6e6653ef30bcd9ea88?s=128&d=identicon&r=PG", "display_name": "Kuan", "link": "https://stackoverflow.com/users/1647559/kuan"}, "edited": false, "score": 0, "creation_date": 1543443895, "post_id": 53528867, "comment_id": 93926800, "body": "Thanks for the explanation and solution"}], "tags": [], "owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "is_accepted": true, "score": 2, "last_activity_date": 1543443797, "last_edit_date": 1543443797, "creation_date": 1543443003, "answer_id": 53528867, "question_id": 53528766, "link": "https://stackoverflow.com/questions/53528766/try-to-understand-how-to-build-an-array-from-int-params/53528867#53528867", "title": "Try to understand how to build an array from int params", "body": "<p><strong>The Error</strong></p>\n\n<p>The error comes from trying to define a constant from a variable. In Go, constants must be defined as literals or expressions built from other constants. Your <code>x</code> and <code>y</code> are defined differently depending on the input of the <code>Pic</code> function. In general, constants are defined at compile time.</p>\n\n<p>For example the following are fine in Go:</p>\n\n<pre><code>const w = 100\nconst x = 200\nconst y = w + x\nconst z = x + y + 300\n</code></pre>\n\n<p>But the following is not:</p>\n\n<pre><code>var x = 100\nconst y = x + 10\n</code></pre>\n\n<p>and this second example is essentially what is happening in your code since <code>dx</code> and <code>dy</code> vary depending on the input to the <code>Pic</code> function.</p>\n\n<p>If you're coming from JavaScript, which also has the <code>const</code> keyword, this might seem like strange behavior. In JavaScript a constant is basically just a variable that can't be changed after it is declared. In Go, a constant is more constant than in JS.</p>\n\n<p>Check out this post for more on constants in Go: <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">https://blog.golang.org/constants</a></p>\n\n<p><strong>Creating the Array</strong></p>\n\n<p>Array sizes have similar constraints to constant values in Go. In this example, if you try to set the Array's size equal to <code>dx</code> or <code>dy</code>, you will get the error:</p>\n\n<blockquote>\n  <p>non-constant array bound dx</p>\n</blockquote>\n\n<p>Thus you will have to use a Slice in this example. The simplest way would be to define your Slice with length <code>dy</code> like:</p>\n\n<pre><code>pic := make([][]uint8, dy)\n</code></pre>\n"}], "owner": {"reputation": 10027, "user_id": 1647559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ab1e142a46861a6e6653ef30bcd9ea88?s=128&d=identicon&r=PG", "display_name": "Kuan", "link": "https://stackoverflow.com/users/1647559/kuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 53528867, "answer_count": 2, "score": 1, "last_activity_date": 1543443797, "creation_date": 1543442453, "last_edit_date": 1543443357, "question_id": 53528766, "link": "https://stackoverflow.com/questions/53528766/try-to-understand-how-to-build-an-array-from-int-params", "title": "Try to understand how to build an array from int params", "body": "<p>All:</p>\n\n<p>When I try to follow golang's Tour of Go:</p>\n\n<p><a href=\"https://tour.golang.org/moretypes/18\" rel=\"nofollow noreferrer\">Exercise: Slices</a></p>\n\n<p>My code is like this:</p>\n\n<pre><code>package main\n\nimport \"golang.org/x/tour/pic\"\n\nfunc Pic(dx, dy int) [][]uint8 {\n    const x = dx\n    const y = dy\n    pic := [y][x]uint8{};\n\n    for r:=range pic {\n        row := pic[r]\n        for c := range row {\n            row[c] = uint8(c*r) \n        }\n    }\n\n    return pic[:]\n}\n\nfunc main() {\n    pic.Show(Pic)\n}\n</code></pre>\n\n<p>And I got error like:</p>\n\n<pre><code>prog.go:6:8: const initializer dx is not a constant\nprog.go:7:8: const initializer dy is not a constant\n</code></pre>\n\n<p>I am pretty new to Go, <strong>I wonder what this error means, and if I want to build an array first(other than using make() to build slice), how can I pass the length of array?</strong></p>\n"}, {"tags": ["go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 1, "last_activity_date": 1543441546, "creation_date": 1543441546, "answer_id": 53528602, "question_id": 53528573, "link": "https://stackoverflow.com/questions/53528573/reusing-structs-in-another-struct-in-golang/53528602#53528602", "title": "reusing structs in another struct in golang", "body": "<p>Just use one struct - DataWithItems and sometimes leave items blank</p>\n"}, {"comments": [{"owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "edited": false, "score": 0, "creation_date": 1543441967, "post_id": 53528657, "comment_id": 93926072, "body": "You can also reference the fields of <code>Data</code> in <code>DataWithItems</code> directly as long as there are no name conflicts. For example <code>d.Name</code> works."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "edited": false, "score": 0, "creation_date": 1543442129, "post_id": 53528657, "comment_id": 93926141, "body": "@HenryWoody Very true! I can never tell which I prefer for readability."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 2, "last_activity_date": 1543441815, "creation_date": 1543441815, "answer_id": 53528657, "question_id": 53528573, "link": "https://stackoverflow.com/questions/53528573/reusing-structs-in-another-struct-in-golang/53528657#53528657", "title": "reusing structs in another struct in golang", "body": "<p>You can \"embed\" the one struct into the other:</p>\n\n<pre><code>type Items string\n\ntype Data struct {\n    Name        string\n    Description string\n    HasMore     bool\n}\n\ntype DataWithItems struct {\n    Data // Notice that this is just the type name\n    Items []Items\n}\n\nfunc main() {\n    d := DataWithItems{}\n    d.Data.Name = \"some-name\"\n    d.Data.Description = \"some-description\"\n    d.Data.HasMore = true\n    d.Items = []Items{\"some-item-1\", \"some-item-2\"}\n\n    result, err := json.Marshal(d)\n    if err != nil {\n        panic(err)\n    }\n\n    println(string(result))\n}\n</code></pre>\n\n<p>this prints</p>\n\n<pre><code>{\"Name\":\"some-name\",\"Description\":\"some-description\",\"HasMore\":true,\"Items\":[\"some-item-1\",\"some-item-2\"]}\n</code></pre>\n"}], "owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 779, "favorite_count": 0, "accepted_answer_id": 53528657, "answer_count": 2, "score": 0, "last_activity_date": 1543441815, "creation_date": 1543441393, "question_id": 53528573, "link": "https://stackoverflow.com/questions/53528573/reusing-structs-in-another-struct-in-golang", "title": "reusing structs in another struct in golang", "body": "<p>I have two structs in golang as below </p>\n\n<pre><code>type Data struct {\n    Name          string\n    Description   string\n    HasMore   bool\n}\n\ntype DataWithItems struct {\n    Name          string\n    Description   string\n    HasMore      bool\n    Items    []Items\n}\n</code></pre>\n\n<p>At most <code>DataWithItems</code> struct can be rewritten as </p>\n\n<pre><code> type DataWithItems struct {\n        Info Data\n        Items []Items\n    }\n</code></pre>\n\n<p>But the above make it difficult when decoding a json object into <code>DataWithItems</code>. I know this can be solved with inheritance in other programming languages but <code>Is there a way I can solve this in Go?</code></p>\n"}, {"tags": ["docker", "go", "google-container-registry", "docker-in-docker"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9505597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccb1561aaee2af6f7a19cb48963378b?s=128&d=identicon&r=PG&f=1", "display_name": "KcinnaY", "link": "https://stackoverflow.com/users/9505597/kcinnay"}, "edited": false, "score": 0, "creation_date": 1543659294, "post_id": 53566398, "comment_id": 94004347, "body": "I am aware of go-containerregistry, but it is not able to delete images yet according to one of its developers."}, {"owner": {"reputation": 201, "user_id": 8808630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDs8zCEmt5A/AAAAAAAAAAI/AAAAAAAAA98/HiIy1dOyF9k/photo.jpg?sz=128", "display_name": "Philippe Deslauriers", "link": "https://stackoverflow.com/users/8808630/philippe-deslauriers"}, "reply_to_user": {"reputation": 63, "user_id": 9505597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccb1561aaee2af6f7a19cb48963378b?s=128&d=identicon&r=PG&f=1", "display_name": "KcinnaY", "link": "https://stackoverflow.com/users/9505597/kcinnay"}, "edited": false, "score": 0, "creation_date": 1543774500, "post_id": 53566398, "comment_id": 94029729, "body": "I&#39;m not very familiar with the library, but I believe it does support deletes. Deletion code: <a href=\"https://github.com/google/go-containerregistry/blob/master/pkg/v1/remote/delete.go\" rel=\"nofollow noreferrer\">github.com/google/go-containerregistry/blob/master/pkg/v1/&hellip;</a>  Example usage: <a href=\"https://github.com/google/go-containerregistry/blob/master/pkg/crane/delete.go\" rel=\"nofollow noreferrer\">github.com/google/go-containerregistry/blob/master/pkg/crane&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 63, "user_id": 9505597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccb1561aaee2af6f7a19cb48963378b?s=128&d=identicon&r=PG&f=1", "display_name": "KcinnaY", "link": "https://stackoverflow.com/users/9505597/kcinnay"}, "edited": false, "score": 0, "creation_date": 1544192272, "post_id": 53566398, "comment_id": 94199972, "body": "You are right, you are able to delete using crane with the NewCmdDelete command (<a href=\"https://github.com/google/go-containerregistry/blob/master/pkg/crane/delete.go\" rel=\"nofollow noreferrer\">github.com/google/go-containerregistry/blob/master/pkg/cran&zwnj;&#8203;e/&hellip;</a>). It removes a reference from the image.  First you have to remove all the tags then you have to do another delete command using the @sha256 of the image. Now there is no reference left and it will delete the image."}], "tags": [], "owner": {"reputation": 201, "user_id": 8808630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bDs8zCEmt5A/AAAAAAAAAAI/AAAAAAAAA98/HiIy1dOyF9k/photo.jpg?sz=128", "display_name": "Philippe Deslauriers", "link": "https://stackoverflow.com/users/8808630/philippe-deslauriers"}, "is_accepted": true, "score": 0, "last_activity_date": 1543621478, "creation_date": 1543621478, "answer_id": 53566398, "question_id": 53528416, "link": "https://stackoverflow.com/questions/53528416/docker-golang-client-within-docker-container/53566398#53566398", "title": "Docker golang client within docker container", "body": "<p>As a potential alternate, you could explore the google/go-containerregistry library: <a href=\"https://github.com/google/go-containerregistry\" rel=\"nofollow noreferrer\">https://github.com/google/go-containerregistry</a></p>\n\n<p>It looks like you're trying to implement some sort of garbage collection tool. If so, you could also look here for an example of how to use the library: <a href=\"https://github.com/google/go-containerregistry/pull/300\" rel=\"nofollow noreferrer\">https://github.com/google/go-containerregistry/pull/300</a></p>\n"}], "owner": {"reputation": 63, "user_id": 9505597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccb1561aaee2af6f7a19cb48963378b?s=128&d=identicon&r=PG&f=1", "display_name": "KcinnaY", "link": "https://stackoverflow.com/users/9505597/kcinnay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 0, "accepted_answer_id": 53566398, "answer_count": 1, "score": 0, "last_activity_date": 1543698751, "creation_date": 1543440616, "last_edit_date": 1543698751, "question_id": 53528416, "link": "https://stackoverflow.com/questions/53528416/docker-golang-client-within-docker-container", "title": "Docker golang client within docker container", "body": "<p>I am trying to use the <a href=\"https://godoc.org/github.com/docker/docker/client\" rel=\"nofollow noreferrer\">docker go client</a> to connect to the google container registry to list and delete images. My golang application also exists in a docker container.</p>\n\n<p>This is the dockerfile for my golang application:</p>\n\n<pre><code>FROM docker:latest\n\nUSER root\n\nRUN apk add --update openssl\n\nADD ./data /app/data\nADD ./data/docker /app/data/docker\nADD mygolangapp /app\n\nRUN chmod -R a+rwx ./app/data/docker/generate_docker_cert.sh\nRUN sh ./app/data/docker/generate_docker_cert.sh\n\nENV GOOGLE_APPLICATION_CREDENTIALS ./app/data/myserviceaccount.json\nENV DOCKER_CONFIG ./app/data/docker\nENV DOCKER_CERT_PATH .\nENV DOCKER_HOST ????????\n\nENTRYPOINT [\"/app/mygolangapp\"]\n</code></pre>\n\n<p>This is the generate_docker_cert.sh file \n(<a href=\"https://gist.github.com/bradrydzewski/a6090115b3fecfc25280\" rel=\"nofollow noreferrer\">https://gist.github.com/bradrydzewski/a6090115b3fecfc25280</a>)</p>\n\n<p>This is my golang code to create the docker go client and list containers.</p>\n\n<pre><code>jsonBytes, err := ioutil.ReadFile(os.Getenv(\"GOOGLE_APPLICATION_CREDENTIALS\"))\nif err != nil {\n    panic(err)\n}\n\ndockercli, err := client.NewEnvClient()\nif err != nil {\n    panic(err)\n}\n\ndockercli.RegistryLogin(context.Background(), types.AuthConfig{\n    Username:      \"_json_key\",\n    Password:      string(jsonBytes),\n    ServerAddress: \"https://eu.gcr.io\",\n})\n\ncontainers, err := dockercli.ContainerList(context.Background(), types.ContainerListOptions{})\nif err != nil {\n    panic(err)\n}\n\nfor _, container := range containers {\n    fmt.Printf(\"%s %s\\n\", container.ID[:10], container.Image)\n}\n</code></pre>\n\n<p>Currently I am getting this error:</p>\n\n<pre><code>error during connect: Get https://%2Fvar%2Frun%2Fdocker.sock/v1.25/containers/json?limit=0: dial tcp: lookup /var/run/docker.sock: no such host\n</code></pre>\n\n<p>So I added docker.sock as a volume in my docker-compose, but it is not working? </p>\n\n<pre><code>mygolangapp:\n  build: ./mygolangapp\n  volumes:\n    - /var/run/docker.sock:/var/run/docker.sock\n</code></pre>\n\n<p>My question is: How can I use the docker golang client within a golang application for google container registry. What am I doing wrong or missing here? What should DOCKER_HOST be? </p>\n\n<p>Thank you for any help. Any other approach is more than welcome!</p>\n"}, {"tags": ["ssl", "go", "pem", "pkcs#7"], "answers": [{"tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": true, "score": 3, "last_activity_date": 1543450798, "creation_date": 1543450798, "answer_id": 53530077, "question_id": 53527693, "link": "https://stackoverflow.com/questions/53527693/how-to-convert-pem-certificate-chain-to-pkcs7-in-native-go/53530077#53530077", "title": "How to convert PEM certificate chain to PKCS7 in native Go?", "body": "<p>First of all, just to be clear, both the input and output you are requesting are in PEM format. The input is a sequence of PEM-encoded X509 certificates, and the output you request is a PEM-encoded PKCS#7 degenerate \"certs only\" structure. OpenSSL can output the raw ASN.1 DER for the PKCS#7 structure if you give it the <code>-outform DER</code> option, but it will PEM-encode its output by default.</p>\n\n<p>There are a number of Go packages out there that can build this kind of PKCS#7 structure. The following example uses <a href=\"https://godoc.org/github.com/fullsailor/pkcs7\" rel=\"nofollow noreferrer\">this one</a>.</p>\n\n<p>If you have your input in a PEM-encoded string, and you want your output to be a PEM-encoded string, then the basic steps are:</p>\n\n<ol>\n<li>Extract each PEM-block from your input, decode it, and collect its raw bytes.</li>\n<li>Create a PKCS7 structure from those bytes.</li>\n<li>PEM-encode that structure to an array of bytes.</li>\n<li>Convert that array of bytes to a string.</li>\n</ol>\n\n<p>Here's a simple example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/pem\"\n    \"fmt\"\n    \"log\"\n\n    \"github.com/fullsailor/pkcs7\"\n)\n\nvar certChain = `-----BEGIN CERTIFICATE-----\nMIIEKjCCAhKgAwIBAgIQVUzJj/mbV3n8PS0CHQTfzzANBgkqhkiG9w0BAQsFADBk\nMQswCQYDVQQGEwJVUzEWMBQGA1UECBMNTmV3IEhhbXBzaGlyZTETMBEGA1UEBxMK\nUG9ydHNtb3V0aDEoMCYGA1UEAxMfU2ltcGxlQ0EgTm9uLVB1YmxpYyBUZXN0IElz\nc3VlcjAeFw0xODExMjgyMzMwNDVaFw0xOTAyMjYyMzMwNDVaMBUxEzARBgNVBAMT\nCkphbmUgU21pdGgwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC3iiYS\n42eqJOJfF81MekU0w+8UTQgL9D9fh0BYAljgvKx1jvlg6l2CX1OPfNMxOWjDo7DB\nICRrPKxq/FH/tsPumzNWLp6Fsu559MgzkudzRHDVdCF0pa/qujeJeiDLXs7mtekc\nrKW6SyrKceknSoPCAwnWr/CEBL09pG3lef7vUMfmkuSMW+L7upHpL/sHyqnyoAnh\n9b7IeeQ832rg7b7VOX6zmDcCr6qndhXt6L/neidFbX736wH+fF+iKyTw7XJNflqT\nYvifUvnI9rGriDZdAPVa1/a94tKHbFzil/2UEDzNo61mcucbcHqhUL4Iezpi/s5I\niyXqM9oMoMQKPSAlAgMBAAGjJzAlMAsGA1UdDwQEAwIDqDAWBgNVHSUBAf8EDDAK\nBggrBgEFBQcDAjANBgkqhkiG9w0BAQsFAAOCAgEAXe8ipocWVv+Bc78ci6QjAb6N\n1DN0n9X7Ai6nvekDP1hqvNUhqKmKhV8pEL7GapyH7Rz3shYJyLEwlV0zUgS3/Uvv\n38Ae5xl2uQLl4eoMz4T9NXewZyRmeSyfwz1za93wKGKz6IhoYRepI4EwaPjYowok\nnNrocMRFuZHeUysSdLNXtgxKvtRYFI63rjNikJNM7C8mKOzeVobdegZipALxonDb\nFcVUhikyu6YkT3Rc5X/oW5I2LfCl9v8mhjbuIPmLsZJyTcDBK81AFIX8g7Iavb8L\nbuRBIgSTShQISPrunnxbcQg3YimdNCn0n5llDmUP3jxWqiuvEZ7pSAUU6aVY7x8B\nfAq9utHTz63FqVCLyl8us/oYZmeYpxpw5HSFhqwujKzJhvO1raaoU+3zsybrsxAy\ntzgm05WucSoMTjhOBZFr8OVQxKnMHwgNudwsxuXqqFhUBV5JLkhxWIZxUoH3fhgz\n9b2yH0pf/Vgurglfk/onMYR33B0grAT6/NW294oUOKCP9jdwNPQr+eRgoDU6hZ/P\nUZMfr+dhVpIHPouSKCrkNXKLrBLFZsg8UiyMXiNB27OBK+mWCH8gUv5EPjW1PUCV\n338v19sruqtHRRs7ZnWYMMxGeWosJ4eK/ysTjCespenOeC1HBVEnHQE+H/JvN7Pc\nGN3nlK0GRJl5j3y6nmw=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIEKzCCAhOgAwIBAgIRAKju/EHi+Hw4PQZENuj9F1AwDQYJKoZIhvcNAQELBQAw\nZDELMAkGA1UEBhMCVVMxFjAUBgNVBAgTDU5ldyBIYW1wc2hpcmUxEzARBgNVBAcT\nClBvcnRzbW91dGgxKDAmBgNVBAMTH1NpbXBsZUNBIE5vbi1QdWJsaWMgVGVzdCBJ\nc3N1ZXIwHhcNMTgxMTI4MjMzMTQ2WhcNMTkwMjI2MjMzMTQ2WjAVMRMwEQYDVQQD\nEwpGcmVkIEpvbmVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt4om\nEuNnqiTiXxfNTHpFNMPvFE0IC/Q/X4dAWAJY4LysdY75YOpdgl9Tj3zTMTlow6Ow\nwSAkazysavxR/7bD7pszVi6ehbLuefTIM5Lnc0Rw1XQhdKWv6ro3iXogy17O5rXp\nHKyluksqynHpJ0qDwgMJ1q/whAS9PaRt5Xn+71DH5pLkjFvi+7qR6S/7B8qp8qAJ\n4fW+yHnkPN9q4O2+1Tl+s5g3Aq+qp3YV7ei/53onRW1+9+sB/nxfoisk8O1yTX5a\nk2L4n1L5yPaxq4g2XQD1Wtf2veLSh2xc4pf9lBA8zaOtZnLnG3B6oVC+CHs6Yv7O\nSIsl6jPaDKDECj0gJQIDAQABoycwJTALBgNVHQ8EBAMCA6gwFgYDVR0lAQH/BAww\nCgYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggIBAImzRaStB2tb0tCs0x9d0NTy\nZ8Q3Fkexvt816xfBGiRS1AtetnV59sJKJvPe9qRoKQDRk7Q+/HO80Iu1o7dWfp7S\nh29g9a1uhIVCY1ijr8cW8La9H/OF2KxgGX8TOldrftUl60sA3riJ7lQYOW0NkU+o\nwrRsIlMCLhP8NZYjKn2Wf066JtV6Z4Be2CgVpaXkuTIE3h4BOv0kG9OsMvuRMqZw\nn7z6EqhduSujwHevB2dIZgixacnE5v5hnpZm1ujzlgbAAZWh7uFthktXL5fBbkW7\nheoOv320GOTvqkGVVlc4Pac5kR+P6JWfCDETfIVvtyTtfei5tDm606rBa3BHtiRu\nkO4m63fnYziUzRXrF/bDcAzVx5jHQWugpxeI5UcaF6e5psOvhlP6O0sIeN6ThY/I\nf+zZN6kf8eZ0OYk+61fVPbbpkF05AFhKkduIRfywUy5+iXrPK4iuQxhM/kRCO0H3\nrxXcDlc+9Ol1JiJNNF2lV8+U1APsPFK0gnrxoYLFyRsejCiV8/D67v8oEk0gfiMm\n/uZUhC2jYJ05lfK7aGV72Cf82g46zAuNAiH4zwvmxvC/2tcqcaYFyK15D1dQGqOg\nz3LR6viX/ncO72ywQWgjRc5hdR5vLinIEXTRlNKm4EW+AoLY3x+Erhmq69EEnGMr\n4/GUXRuNB7Is+lFM3JYE\n-----END CERTIFICATE-----`\n\nfunc main() {\n\n    // Decode each PEM block in the input and append the ASN.1\n    // DER bytes for each certificate therein to the data slice.\n\n    input := []byte(certChain)\n    data := []byte{}\n\n    for len(input) &gt; 0 {\n        var block *pem.Block\n        block, input = pem.Decode(input)\n        data = append(data, block.Bytes...)\n    }\n\n    // Build a PKCS#7 degenerate \"certs only\" structure from\n    // that ASN.1 certificates data.\n\n    var err error\n    data, err = pkcs7.DegenerateCertificate(data)\n    if err != nil {\n        log.Fatalf(\"couldn't create degenerate PKCS7 object: %v\", err)\n    }\n\n    // Convert the PKCS#7 structure to a PEM-encoded string.\n\n    pemString := string(pem.EncodeToMemory(&amp;pem.Block{\n        Type:  \"PKCS7\",\n        Bytes: data,\n    }))\n\n    // Print the string, or do whatever you want with it.\n\n    fmt.Printf(\"%s\", pemString)\n}\n</code></pre>\n\n<p>and to show it gives the same output as your OpenSSL command:</p>\n\n<pre><code>paul@mac:certstop7$ cat certs.pem\n-----BEGIN CERTIFICATE-----\nMIIEKjCCAhKgAwIBAgIQVUzJj/mbV3n8PS0CHQTfzzANBgkqhkiG9w0BAQsFADBk\nMQswCQYDVQQGEwJVUzEWMBQGA1UECBMNTmV3IEhhbXBzaGlyZTETMBEGA1UEBxMK\nUG9ydHNtb3V0aDEoMCYGA1UEAxMfU2ltcGxlQ0EgTm9uLVB1YmxpYyBUZXN0IElz\nc3VlcjAeFw0xODExMjgyMzMwNDVaFw0xOTAyMjYyMzMwNDVaMBUxEzARBgNVBAMT\nCkphbmUgU21pdGgwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC3iiYS\n42eqJOJfF81MekU0w+8UTQgL9D9fh0BYAljgvKx1jvlg6l2CX1OPfNMxOWjDo7DB\nICRrPKxq/FH/tsPumzNWLp6Fsu559MgzkudzRHDVdCF0pa/qujeJeiDLXs7mtekc\nrKW6SyrKceknSoPCAwnWr/CEBL09pG3lef7vUMfmkuSMW+L7upHpL/sHyqnyoAnh\n9b7IeeQ832rg7b7VOX6zmDcCr6qndhXt6L/neidFbX736wH+fF+iKyTw7XJNflqT\nYvifUvnI9rGriDZdAPVa1/a94tKHbFzil/2UEDzNo61mcucbcHqhUL4Iezpi/s5I\niyXqM9oMoMQKPSAlAgMBAAGjJzAlMAsGA1UdDwQEAwIDqDAWBgNVHSUBAf8EDDAK\nBggrBgEFBQcDAjANBgkqhkiG9w0BAQsFAAOCAgEAXe8ipocWVv+Bc78ci6QjAb6N\n1DN0n9X7Ai6nvekDP1hqvNUhqKmKhV8pEL7GapyH7Rz3shYJyLEwlV0zUgS3/Uvv\n38Ae5xl2uQLl4eoMz4T9NXewZyRmeSyfwz1za93wKGKz6IhoYRepI4EwaPjYowok\nnNrocMRFuZHeUysSdLNXtgxKvtRYFI63rjNikJNM7C8mKOzeVobdegZipALxonDb\nFcVUhikyu6YkT3Rc5X/oW5I2LfCl9v8mhjbuIPmLsZJyTcDBK81AFIX8g7Iavb8L\nbuRBIgSTShQISPrunnxbcQg3YimdNCn0n5llDmUP3jxWqiuvEZ7pSAUU6aVY7x8B\nfAq9utHTz63FqVCLyl8us/oYZmeYpxpw5HSFhqwujKzJhvO1raaoU+3zsybrsxAy\ntzgm05WucSoMTjhOBZFr8OVQxKnMHwgNudwsxuXqqFhUBV5JLkhxWIZxUoH3fhgz\n9b2yH0pf/Vgurglfk/onMYR33B0grAT6/NW294oUOKCP9jdwNPQr+eRgoDU6hZ/P\nUZMfr+dhVpIHPouSKCrkNXKLrBLFZsg8UiyMXiNB27OBK+mWCH8gUv5EPjW1PUCV\n338v19sruqtHRRs7ZnWYMMxGeWosJ4eK/ysTjCespenOeC1HBVEnHQE+H/JvN7Pc\nGN3nlK0GRJl5j3y6nmw=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIEKzCCAhOgAwIBAgIRAKju/EHi+Hw4PQZENuj9F1AwDQYJKoZIhvcNAQELBQAw\nZDELMAkGA1UEBhMCVVMxFjAUBgNVBAgTDU5ldyBIYW1wc2hpcmUxEzARBgNVBAcT\nClBvcnRzbW91dGgxKDAmBgNVBAMTH1NpbXBsZUNBIE5vbi1QdWJsaWMgVGVzdCBJ\nc3N1ZXIwHhcNMTgxMTI4MjMzMTQ2WhcNMTkwMjI2MjMzMTQ2WjAVMRMwEQYDVQQD\nEwpGcmVkIEpvbmVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt4om\nEuNnqiTiXxfNTHpFNMPvFE0IC/Q/X4dAWAJY4LysdY75YOpdgl9Tj3zTMTlow6Ow\nwSAkazysavxR/7bD7pszVi6ehbLuefTIM5Lnc0Rw1XQhdKWv6ro3iXogy17O5rXp\nHKyluksqynHpJ0qDwgMJ1q/whAS9PaRt5Xn+71DH5pLkjFvi+7qR6S/7B8qp8qAJ\n4fW+yHnkPN9q4O2+1Tl+s5g3Aq+qp3YV7ei/53onRW1+9+sB/nxfoisk8O1yTX5a\nk2L4n1L5yPaxq4g2XQD1Wtf2veLSh2xc4pf9lBA8zaOtZnLnG3B6oVC+CHs6Yv7O\nSIsl6jPaDKDECj0gJQIDAQABoycwJTALBgNVHQ8EBAMCA6gwFgYDVR0lAQH/BAww\nCgYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggIBAImzRaStB2tb0tCs0x9d0NTy\nZ8Q3Fkexvt816xfBGiRS1AtetnV59sJKJvPe9qRoKQDRk7Q+/HO80Iu1o7dWfp7S\nh29g9a1uhIVCY1ijr8cW8La9H/OF2KxgGX8TOldrftUl60sA3riJ7lQYOW0NkU+o\nwrRsIlMCLhP8NZYjKn2Wf066JtV6Z4Be2CgVpaXkuTIE3h4BOv0kG9OsMvuRMqZw\nn7z6EqhduSujwHevB2dIZgixacnE5v5hnpZm1ujzlgbAAZWh7uFthktXL5fBbkW7\nheoOv320GOTvqkGVVlc4Pac5kR+P6JWfCDETfIVvtyTtfei5tDm606rBa3BHtiRu\nkO4m63fnYziUzRXrF/bDcAzVx5jHQWugpxeI5UcaF6e5psOvhlP6O0sIeN6ThY/I\nf+zZN6kf8eZ0OYk+61fVPbbpkF05AFhKkduIRfywUy5+iXrPK4iuQxhM/kRCO0H3\nrxXcDlc+9Ol1JiJNNF2lV8+U1APsPFK0gnrxoYLFyRsejCiV8/D67v8oEk0gfiMm\n/uZUhC2jYJ05lfK7aGV72Cf82g46zAuNAiH4zwvmxvC/2tcqcaYFyK15D1dQGqOg\nz3LR6viX/ncO72ywQWgjRc5hdR5vLinIEXTRlNKm4EW+AoLY3x+Erhmq69EEnGMr\n4/GUXRuNB7Is+lFM3JYE\n-----END CERTIFICATE-----\npaul@mac:certstop7$ openssl crl2pkcs7 -nocrl -certfile certs.pem &gt; openssl_p7.pem\npaul@mac:certstop7$ ./certstop7 &gt; generated_p7.pem\npaul@mac:certstop7$ diff generated_p7.pem openssl_p7.pem\npaul@mac:certstop7$ \n</code></pre>\n"}], "owner": {"reputation": 1539, "user_id": 423292, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/682568435d3372e1385b671da7f1f793?s=128&d=identicon&r=PG", "display_name": "David Jones", "link": "https://stackoverflow.com/users/423292/david-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "accepted_answer_id": 53530077, "answer_count": 1, "score": 0, "last_activity_date": 1543450798, "creation_date": 1543437419, "question_id": 53527693, "link": "https://stackoverflow.com/questions/53527693/how-to-convert-pem-certificate-chain-to-pkcs7-in-native-go", "title": "How to convert PEM certificate chain to PKCS7 in native Go?", "body": "<p>I am looking for any practical method for converting a <strong>PEM</strong>-encoded x509 certificate chain into <strong>PKCS7</strong> format in the Go language.</p>\n\n<p>This openssl command line illustrates what I am trying to achieve in native Go.</p>\n\n<pre><code>openssl crl2pkcs7 -nocrl -certfile certificate-chain.pem &gt; pkcs7.pem\n</code></pre>\n\n<p>I am able to run the openssl command line from within a Go program using the <code>exec</code> package, but I am looking for an efficient solution in Go.</p>\n\n<p>The input file contains a sequence of certificates in PEM format, starting with -----BEGIN CERTIFICATE-----\\n and <code>base64</code> encoded data.  The desired output needs to be in PKCS7 format, starting with -----BEGIN PKCS7-----.</p>\n\n<p>I am looking for an efficient solution, because I am not actually reading and writing files, but handling lots of certificates as strings in memory.</p>\n\n<p>Any suggestions appreciated.</p>\n"}, {"tags": ["go", "mux"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1543435404, "post_id": 53527145, "comment_id": 93923287, "body": "Why would you need middleware without a handler? I think you are confusing the terms, and it sounds like you want this to be a handler itself instead of middleware."}, {"owner": {"reputation": 5118, "user_id": 2585090, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/516c012aa706c22637287cd9287877f1?s=128&d=identicon&r=PG&f=1", "display_name": "Complexity", "link": "https://stackoverflow.com/users/2585090/complexity"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1543435626, "post_id": 53527145, "comment_id": 93923393, "body": "That seems a good comment :-) If you set that as an answer I can accept it."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1543439875, "post_id": 53527145, "comment_id": 93925232, "body": "Can you describe what <code>dynamicRouteMiddleware</code> is meant to do [rather than the abstract example] - ?  If you haven&#39;t added a route to your <code>*mux.Router</code>, nothing will match, and middleware isn&#39;t called without a match."}], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 1, "last_activity_date": 1543904107, "last_edit_date": 1543904107, "creation_date": 1543444713, "answer_id": 53529168, "question_id": 53527145, "link": "https://stackoverflow.com/questions/53527145/mux-middleware-without-handler/53529168#53529168", "title": "Mux middleware without handler", "body": "<p>It's called \"middleware\" because it's supposed to put your <code>Handler</code> in the \"middle\". It receives the input before your <code>Handler</code>, and receives the output of your <code>Handler</code>. </p>\n\n<p>Inherently, to have your middleware work, you are required to have at least one Handler. Preferably you may just use this functionality that you need in the Handler rather than middleware.</p>\n"}, {"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 1, "last_activity_date": 1543450812, "last_edit_date": 1543450812, "creation_date": 1543449688, "answer_id": 53529954, "question_id": 53527145, "link": "https://stackoverflow.com/questions/53527145/mux-middleware-without-handler/53529954#53529954", "title": "Mux middleware without handler", "body": "<p>On the middleware, you need call the <code>next</code> handler so all incoming requests will proceed to the destination route.</p>\n\n<pre><code>func dynamicRouteMiddleware(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        fmt.Println(\"Error\")\n        next.ServeHTTP(w, r) // &lt;------- this one\n    })\n}\n</code></pre>\n\n<p>You can register any routes as you want, but in the very end make sure the <code>r</code> object used as handler of <code>/</code> route.</p>\n\n<pre><code>r.HandleFunc(\"/test\", func(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"test\"))\n})\n\nr.HandleFunc(\"/test/12\", func(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"test 12\"))\n})\n\nr.HandleFunc(\"/about-us\", func(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"about us\"))\n})\n\nhttp.Handle(\"/\", r)\nhttp.ListenAndServe(\":8080\", nil)\n</code></pre>\n\n<p>When  you access <code>/test</code>, <code>/test/12</code>, or <code>/about-us</code>; the <code>Error</code> will still be printed.</p>\n\n<p>Previously it's not printed because you don't proceed to the next handler. The code <code>next.ServeHTTP(w, r)</code> is mandatory in your case.</p>\n"}], "owner": {"reputation": 5118, "user_id": 2585090, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/516c012aa706c22637287cd9287877f1?s=128&d=identicon&r=PG&f=1", "display_name": "Complexity", "link": "https://stackoverflow.com/users/2585090/complexity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 53529168, "answer_count": 2, "score": 0, "last_activity_date": 1543904107, "creation_date": 1543434950, "question_id": 53527145, "link": "https://stackoverflow.com/questions/53527145/mux-middleware-without-handler", "title": "Mux middleware without handler", "body": "<p>I'm building an application using the Micro Service Architecture.\nOn the gateway, I do want to route requests to the correct endpoints.</p>\n\n<p>But, the endpoint are now known at runtime and needs to be configured in the DB.</p>\n\n<p>Below if the code to get the router.</p>\n\n<pre><code>func getRouter() *mux.Router {\n    r := mux.NewRouter()\n\n    r.Use(dynamicRouteMiddleware)\n\n    return r\n}\n</code></pre>\n\n<p>The middleware itself is this:</p>\n\n<pre><code>func dynamicRouteMiddleware(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        fmt.Println(\"Error\")\n    })\n}\n</code></pre>\n\n<p>However, the \"Error\" is never printed.\nIt's only printed when I put a handler for '/'</p>\n\n<p>How can I create middleware without handlers?</p>\n"}, {"tags": ["shell", "go", "jenkins", "groovy"], "answers": [{"comments": [{"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1543484543, "post_id": 53535218, "comment_id": 93939494, "body": "Thanks, but still the commands (pre-process) will be called twice , I want to reduce the time if possible"}, {"owner": {"reputation": 46, "user_id": 10718009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7492100741614b0d3d39fc75caf00fe4?s=128&d=identicon&r=PG&f=1", "display_name": "lichensky", "link": "https://stackoverflow.com/users/10718009/lichensky"}, "reply_to_user": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1543487103, "post_id": 53535218, "comment_id": 93941077, "body": "Do you mean <code>setupPipelineEnvironment</code> step? I don&#39;t know the exact logic, but you could call it on beggining of your pipeline (before the parallel step)."}], "tags": [], "owner": {"reputation": 46, "user_id": 10718009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7492100741614b0d3d39fc75caf00fe4?s=128&d=identicon&r=PG&f=1", "display_name": "lichensky", "link": "https://stackoverflow.com/users/10718009/lichensky"}, "is_accepted": true, "score": 1, "last_activity_date": 1543490724, "last_edit_date": 1543490724, "creation_date": 1543482202, "answer_id": 53535218, "question_id": 53526996, "link": "https://stackoverflow.com/questions/53526996/how-to-re-use-pre-process-jenkins-groovy-in-each-test/53535218#53535218", "title": "How to re-use pre process jenkins/groovy in each test", "body": "<p>You can use function and pass Go arguments:</p>\n\n<pre><code>try {\n    parallel(\n        'Run Tests': {\n            node {\n                checkout scm\n                runTestsInDocker('test -v ./...')\n            }\n        },\n        'Lint': {\n            node {\n                checkout scm\n                runTestsInDocker('lint')\n            }\n        }\n    )\n}\n\n\ndef runTestsInDocker(goArgs) {\n    def dockerImage = 'docker.company:50001/crt/deg:0.1.3-09'\n    setupPipelineEnvironment script: this, \n    measureDuration(script: this, measurementName: 'build') {\n        executeDocker(dockerImage: dockerImage,  dockerWorkspace: '/go/src') {\n            sh \"\"\"\n            mkdir -p /go/src/github.com/ftr/myGoProj\n            cp -R $WORKSPACE/* /go/src/github.com/ftr/MyGoProj\n            cd  /go/src/github.com/ftr/MyGoProj\n            go ${goArgs}                        \n            \"\"\"\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>If some actions can be separated out of <code>runTestsInDocker</code> they probably should be.</p>\n\n<p>For example <code>setupPipelineEnvironment</code> step. I don't know exact logic but maybe it can be run once before running test.</p>\n\n<pre><code>node {\n    stage('setup') {\n        setupPipelineEnvironment script: this\n    }\n    stage ('Tests') {\n        parallel(\n            'Run Tests': {\n                node {\n                    checkout scm\n                    runTestsInDocker('test -v ./...')\n                }\n            },\n            'Lint': {\n                node {\n                    checkout scm\n                    runTestsInDocker('lint')\n                }\n            }\n        )\n    }\n}\n\n\ndef runTestsInDocker(goArgs) {\n    def dockerImage = 'docker.company:50001/crt/deg:0.1.3-09'\n    measureDuration(script: this, measurementName: 'build') {\n        executeDocker(dockerImage: dockerImage,  dockerWorkspace: '/go/src') {\n            sh \"\"\"\n            mkdir -p /go/src/github.com/ftr/myGoProj\n            cp -R $WORKSPACE/* /go/src/github.com/ftr/MyGoProj\n            cd  /go/src/github.com/ftr/MyGoProj\n            go ${goArgs}                        \n            \"\"\"\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Note</strong></p>\n\n<p>If you are running parallel on remote agents you must remember that setup performed on master may be not aviailable on remote slave.</p>\n"}], "owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "accepted_answer_id": 53535218, "answer_count": 1, "score": 3, "last_activity_date": 1543490724, "creation_date": 1543434315, "last_edit_date": 1543477739, "question_id": 53526996, "link": "https://stackoverflow.com/questions/53526996/how-to-re-use-pre-process-jenkins-groovy-in-each-test", "title": "How to re-use pre process jenkins/groovy in each test", "body": "<p>Im using the following code to run our voter , currently I\u2019ve one target which is called <code>Run Tests</code> \nWhich use exactly the same steps as the <strong>last (lint)</strong> , currently I duplicate it which I think is not a good solution ,\nIs there is nice way to avoid this duplication and done it only once as per-requisite process ?</p>\n\n<p>I need all the steps until the <code>cd</code> to the project</p>\n\n<p>The only difference is one target I run</p>\n\n<pre><code>go test ...\n</code></pre>\n\n<p>and the second </p>\n\n<pre><code>go lint \n</code></pre>\n\n<p>All steps before are equal </p>\n\n<pre><code>#!/usr/bin/env groovy\n\n    try {\n        parallel(\n                'Run Tests': {\n                    node {\n\n                        //\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014Here we start\n                        checkout scm\n                        def dockerImage = 'docker.company:50001/crt/deg:0.1.3-09\u2019\n                        setupPipelineEnvironment script: this, \n                        measureDuration(script: this, measurementName: 'build') {\n                            executeDocker(dockerImage: dockerImage,  dockerWorkspace: '/go/src') {\n                                sh \"\"\"\n                                mkdir -p /go/src/github.com/ftr/myGoProj\n                                cp -R $WORKSPACE/* /go/src/github.com/ftr/MyGoProj\n                                cd  /go/src/github.com/ftr/MyGoProj\n                        //\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014Here we finish and TEST\n                                go test -v ./...                           \n                                \"\"\"\n                            }\n                        }\n                    }\n                },\n                \u2018Lint\u2019: {\n               node {\n                        //\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014Here we start\n                        checkout scm\n                        def dockerImage = 'docker.company:50001/crt/deg:0.1.3-09\u2019\n                        setupPipelineEnvironment script: this, \n                        measureDuration(script: this, measurementName: 'build') {\n                            executeDocker(dockerImage: dockerImage,  dockerWorkspace: '/go/src') {\n                                sh \"\"\"\n                                mkdir -p /go/src/github.com/ftr/myGoProj\n                                cp -R $WORKSPACE/* /go/src/github.com/ftr/MyGoProj\n                                cd  /go/src/github.com/ftr/MyGoProj\n                        //\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014Here we finish and LINT\n                               go lint\n                              \"\"\"\n\n                }\n                }\n        )\n    }\n\n        }\n    }\n</code></pre>\n"}, {"tags": ["multithreading", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543433106, "post_id": 53526515, "comment_id": 93922212, "body": "It&#39;s hard to say how many you should expect without an example, but all C calls are blocking and on a different stack, so they must happen in a different thread."}, {"owner": {"reputation": 339, "user_id": 2798117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/595500215/picture?type=large", "display_name": "Thor", "link": "https://stackoverflow.com/users/2798117/thor"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543435133, "post_id": 53526515, "comment_id": 93923169, "body": "Added link to source. Do you mean that calls to C.float and C.uchar are blocking as well or calls to my own C functions? I am not calling any custom C functions from my go code"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543435508, "post_id": 53526515, "comment_id": 93923340, "body": "No, <code>C.float</code> and <code>C.uchar</code> are types, not callable functions. You said the convolution is happening in a <code>c-archive included in a C binary.</code>, so I assumed you were calling into that with cgo, though you&#39;re correct that your example here has no cgo calls. I would start by removing the <code>LockOSThread</code> calls (you can&#39;t use thread-local storage in Go, so there&#39;s no reason to call it), then check any other locations where you might be making cgo calls."}, {"owner": {"reputation": 339, "user_id": 2798117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/595500215/picture?type=large", "display_name": "Thor", "link": "https://stackoverflow.com/users/2798117/thor"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543436420, "post_id": 53526515, "comment_id": 93923748, "body": "Thank you for the feedback. I Updated description to make that clear that no c functions are called from the go code. By removing the LockOSThread, fewer threads are created (7 instead of 11) but the execution is slower by a few seconds (from 190 seconds without locking down to 180 seconds with locking). Going to try to reduce casting with C.float/C.uchar as much as possible."}], "owner": {"reputation": 339, "user_id": 2798117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/595500215/picture?type=large", "display_name": "Thor", "link": "https://stackoverflow.com/users/2798117/thor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 489, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1543436131, "creation_date": 1543432287, "last_edit_date": 1543436131, "question_id": 53526515, "link": "https://stackoverflow.com/questions/53526515/goroutines-cgo-unexplained-os-thread-spawns-when-using-goroutines", "title": "Goroutines (cgo): unexplained OS thread spawns when using goroutines", "body": "<p>I am using go to parallelize 2d convolutions where the convolution (implemented in go) is happening in a c-archive included in a C binary (where the go code is called). No calls are made from the go code to any c function</p>\n\n<p>Before spawning goroutines, all matrixes are loaded into memory by the c code and all goroutines access it through the shared memory.</p>\n\n<p>I use the GOMAXPROCS-1 to decide how many go routines to spawn and each routine is assigned a ID. The goroutines are assigned rows of the matrix based on their ID in a striped fashion. The go routines are locked to a OS thread when spawned and release the thread once finished.</p>\n\n<p>e.g. \nif GOMAXPROCS is set to 4, goroutine 0 takes row 0, 4, 8, 12 etc and goroutine 1 takes row 1, 5, 9, 13 and so on.</p>\n\n<p>My issue is that when GOMAXPROCS is set to 4, go spawns <strong>11 OS threads</strong></p>\n\n<p>htop and atop:\n<a href=\"https://i.stack.imgur.com/84Gch.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/84Gch.png\" alt=\"enter image description here\"></a></p>\n\n<p>My understanding is that these OS threads are spawned because the scheduler is trying to make sure that there are always threads available that are not blocked.</p>\n\n<p>There is no I/O or system calls happening after the goroutines have been spawned so I don't understand why the scheduler is creating all these processes or what is blocking the threads.</p>\n\n<p>The number of threads being spawned is slowing down the execution when executing with GOMAXPROCS >=20 on a machine with 40 cores</p>\n\n<p>Why is the scheduler spawning all these threads?\nHow can I debug where/how the routines are being blocked?</p>\n\n<p><a href=\"https://github.com/Sigurthorb/OpenMPvsGoroutines-Convolutions/blob/master/ConvolutionLibrary/go/main.go\" rel=\"nofollow noreferrer\">Source code</a></p>\n"}, {"tags": ["ruby-on-rails", "go", "jwt"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1543426429, "post_id": 53524983, "comment_id": 93919056, "body": "yes it is compatible"}], "answers": [{"tags": [], "owner": {"reputation": 130, "user_id": 4198317, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rc0Ik1yNrzA/AAAAAAAAAAI/AAAAAAAACIE/eIlf5bdUeIQ/photo.jpg?sz=128", "display_name": "St&#233;phane Jeandeaux", "link": "https://stackoverflow.com/users/4198317/st%c3%a9phane-jeandeaux"}, "is_accepted": false, "score": 1, "last_activity_date": 1543427631, "creation_date": 1543427631, "answer_id": 53525372, "question_id": 53524983, "link": "https://stackoverflow.com/questions/53524983/would-a-jwt-token-be-cross-compatible-between-frameworks/53525372#53525372", "title": "Would a JWT token be cross compatible between frameworks?", "body": "<p>You should be able to decode your token if the framework respects the <a href=\"https://tools.ietf.org/html/rfc7519\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc7519</a>.</p>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1543427631, "creation_date": 1543425939, "last_edit_date": 1543426968, "question_id": 53524983, "link": "https://stackoverflow.com/questions/53524983/would-a-jwt-token-be-cross-compatible-between-frameworks", "title": "Would a JWT token be cross compatible between frameworks?", "body": "<p>If I have a JWT token generated by a ruby-on-rails application, would it be possible to decrypt that token in another framework/language like go?</p>\n\n<p>This is assuming the JWT token is using the same algorithm and secret key etc.</p>\n"}, {"tags": ["go", "govendor", "go-modules", "go-packages"], "answers": [{"tags": [], "owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "is_accepted": true, "score": 1, "last_activity_date": 1543447085, "last_edit_date": 1543447085, "creation_date": 1543439499, "answer_id": 53528149, "question_id": 53524943, "link": "https://stackoverflow.com/questions/53524943/how-to-check-in-packages-when-using-go-modules/53528149#53528149", "title": "How to check-in packages when using Go modules?", "body": "<p>Go modules provide a <code>go mod vendor</code> command that will create a vendor directory in your package root, same as glide or govendor or dep do.</p>\n"}], "owner": {"reputation": 305, "user_id": 385105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2faea5e563569b97672f6642c04a3e54?s=128&d=identicon&r=PG", "display_name": "green-i", "link": "https://stackoverflow.com/users/385105/green-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53528149, "answer_count": 1, "score": 1, "last_activity_date": 1543447085, "creation_date": 1543425777, "question_id": 53524943, "link": "https://stackoverflow.com/questions/53524943/how-to-check-in-packages-when-using-go-modules", "title": "How to check-in packages when using Go modules?", "body": "<p>We currently are using <code>govendor</code> to manage packages in our <code>go</code> repository. Since we are using a lot of packages, we have decided to check-in the packages sources code into <code>vendor</code> folder, so that:</p>\n\n<ul>\n<li>Saving time downloading all packages every time the repository needs to be built in build machines.</li>\n<li>Avoiding the possibility of one package becoming unavailable online (being deleted, network issues, etc...)</li>\n</ul>\n\n<p>I am interested to use the <code>modules</code> notion introduced in <code>v1.11</code>. However I can't seem to find a similar approach of check-ing in the packages instead of having to download all the packages.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1543413721, "post_id": 53521120, "comment_id": 93911020, "body": "What error would you expect? There&#39;s nothing invalid there."}, {"owner": {"reputation": 3868, "user_id": 2295484, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BAohf.png?s=128&g=1", "display_name": "Krishnadas PC", "link": "https://stackoverflow.com/users/2295484/krishnadas-pc"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543413799, "post_id": 53521120, "comment_id": 93911070, "body": "If it is not generating build file means is it failing? I&#39;m new to go actually."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 5, "creation_date": 1543414200, "post_id": 53521120, "comment_id": 93911347, "body": "It&#39;s compiling the package, just not to an executable (since the package isn&#39;t called &#39;main&#39;). That&#39;s what it should do."}], "answers": [{"comments": [{"owner": {"reputation": 3868, "user_id": 2295484, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BAohf.png?s=128&g=1", "display_name": "Krishnadas PC", "link": "https://stackoverflow.com/users/2295484/krishnadas-pc"}, "edited": false, "score": 0, "creation_date": 1543414089, "post_id": 53521208, "comment_id": 93911257, "body": "I meant it failed to generate the build file. Not a syntax error in the code. I will go through the link."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3868, "user_id": 2295484, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BAohf.png?s=128&g=1", "display_name": "Krishnadas PC", "link": "https://stackoverflow.com/users/2295484/krishnadas-pc"}, "edited": false, "score": 2, "creation_date": 1543414307, "post_id": 53521208, "comment_id": 93911413, "body": "@KrishnadasPC <code>go build</code> shouldn&#39;t generate anything for non-main packages. So it works as expected."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1543413720, "creation_date": 1543413720, "answer_id": 53521208, "question_id": 53521120, "link": "https://stackoverflow.com/questions/53521120/incorrect-package-name-not-throwing-error-on-build/53521208#53521208", "title": "Incorrect package name not throwing error on build", "body": "<p>A package name <code>test</code> is not incorrect, it is valid according to <a href=\"https://golang.org/ref/spec#Package_clause\" rel=\"nofollow noreferrer\">Spec: Package clause:</a></p>\n\n<pre><code>PackageClause  = \"package\" PackageName .\nPackageName    = identifier .\n</code></pre>\n\n<p><code>test</code> is a valid Go identifier.</p>\n\n<p>As to what does <code>go build main.go</code> do?</p>\n\n<p>Generally you list packages to <code>go build</code>, but you may also list <code>.go</code> source files, just as in your example.</p>\n\n<p>Quoting from <code>go help build</code>:</p>\n\n<blockquote>\n  <p>If the arguments to build are a list of .go files, build treats them as a list of source files specifying a single package.</p>\n</blockquote>\n\n<p>So <code>go build</code> simply built your <code>test</code> package, consisting of a single <code>main.go</code> source file. It is not an error to add a <code>main()</code> function to a package that is not <code>main</code>.</p>\n\n<p>As to why \"nothing\" happens: <code>go build</code> generates no output if everything is ok, and it outputs error if something is not right. <code>go build</code> applied on a non-<code>main</code> package just \"checks\" if the package can be built, but it discards the result. Please check <a href=\"https://stackoverflow.com/questions/30612611/what-does-go-build-build/30612612#30612612\">What does go build build?</a></p>\n"}], "owner": {"reputation": 3868, "user_id": 2295484, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BAohf.png?s=128&g=1", "display_name": "Krishnadas PC", "link": "https://stackoverflow.com/users/2295484/krishnadas-pc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543413720, "creation_date": 1543413434, "last_edit_date": 1543413679, "question_id": 53521120, "link": "https://stackoverflow.com/questions/53521120/incorrect-package-name-not-throwing-error-on-build", "title": "Incorrect package name not throwing error on build", "body": "<p>Considering the sample hello world with the wrong package name with the file named as <code>main.go</code></p>\n\n<pre><code>package test\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"hello world\")\n}\n</code></pre>\n\n<p>on <code>go build main.go</code> the build doesn't work (doesn't generate the executable) because of the incorrect package name. But why no error is thrown?</p>\n"}, {"tags": ["go", "vue.js", "nuxt.js"], "answers": [{"comments": [{"owner": {"reputation": 2343, "user_id": 4532065, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/477b5c1ec36a72979cde174ad9902d9f?s=128&d=identicon&r=PG&f=1", "display_name": "sinusGob", "link": "https://stackoverflow.com/users/4532065/sinusgob"}, "edited": false, "score": 0, "creation_date": 1543413264, "post_id": 53520932, "comment_id": 93910741, "body": "can you show a basic example. I know its a lot but i really need to understand since no one have ever shown any examples before"}, {"owner": {"reputation": 14517, "user_id": 239354, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e77a08f46144e1af3354f980911a94c9?s=128&d=identicon&r=PG", "display_name": "Aldarund", "link": "https://stackoverflow.com/users/239354/aldarund"}, "reply_to_user": {"reputation": 2343, "user_id": 4532065, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/477b5c1ec36a72979cde174ad9902d9f?s=128&d=identicon&r=PG&f=1", "display_name": "sinusGob", "link": "https://stackoverflow.com/users/4532065/sinusgob"}, "edited": false, "score": 1, "creation_date": 1543416066, "post_id": 53520932, "comment_id": 93912523, "body": "@sinusGob i dont really understand example for what u want. You have normal nuxt setup and normal golang server. Two different servers."}], "tags": [], "owner": {"reputation": 14517, "user_id": 239354, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e77a08f46144e1af3354f980911a94c9?s=128&d=identicon&r=PG", "display_name": "Aldarund", "link": "https://stackoverflow.com/users/239354/aldarund"}, "is_accepted": false, "score": 5, "last_activity_date": 1543412896, "creation_date": 1543412896, "answer_id": 53520932, "question_id": 53520891, "link": "https://stackoverflow.com/questions/53520891/how-do-i-use-golang-and-nuxt/53520932#53520932", "title": "How do I use golang and nuxt?", "body": "<p>You should just separate them. One server is for your backend api in golang. Other server is node server for nuxt ssr. Then you can use nginx to route requests to desired server based on path or anything.  And everything will work</p>\n"}], "owner": {"reputation": 2343, "user_id": 4532065, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/477b5c1ec36a72979cde174ad9902d9f?s=128&d=identicon&r=PG&f=1", "display_name": "sinusGob", "link": "https://stackoverflow.com/users/4532065/sinusgob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1974, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1543412896, "creation_date": 1543412734, "question_id": 53520891, "link": "https://stackoverflow.com/questions/53520891/how-do-i-use-golang-and-nuxt", "title": "How do I use golang and nuxt?", "body": "<p>I want to use Golang as the server and Nuxt as the frontend, I googled it around but couldn't find any examples.</p>\n\n<p>Code for express/node.js that i found out in the nuxt + express. Link is below</p>\n\n<pre><code>const express = require('express')\n\n// Create express instnace\nconst app = express()\n\n// Require API routes\nconst users = require('./routes/users')\n\n// Import API Routes\napp.use(users)\n\n// Export the server middleware\nmodule.exports = {\n  path: '/api',\n  handler: app\n}\n</code></pre>\n\n<p>I can just create golang server api and deploy it as a microservice but will I lose the SSR power of nuxt? as in will google still crawl my web pages if i use a separate server as opposed to monolithic version of nuxt + node.js</p>\n\n<p>link: <a href=\"https://github.com/nuxt-community/express-template\" rel=\"nofollow noreferrer\">https://github.com/nuxt-community/express-template</a></p>\n\n<p>Regards</p>\n"}, {"tags": ["go", "couchbase", "gocb"], "answers": [{"tags": [], "owner": {"reputation": 754, "user_id": 497677, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b903e474a608780f86aed033c61bf9e?s=128&d=identicon&r=PG", "display_name": "chvck", "link": "https://stackoverflow.com/users/497677/chvck"}, "is_accepted": true, "score": 3, "last_activity_date": 1543516944, "creation_date": 1543516944, "answer_id": 53545622, "question_id": 53519688, "link": "https://stackoverflow.com/questions/53519688/couchbase-gocb-bulk-operation-delivers-partially-empty-results/53545622#53545622", "title": "Couchbase gocb bulk operation delivers partially empty results", "body": "<p>It's worth checking the error value for each of the operations that you are performing. You can do this by doing <code>op.Err</code> so, for example, that'd be</p>\n\n<pre><code>    for i := 0; i &lt; len(items); i++ {\n    fmt.Println(items[i].(*gocb.GetOp).Key, items[i].(*gocb.GetOp).Value.(*Doc).Item, items[i].(*gocb.GetOp).Err)\n}\n</code></pre>\n\n<p>I expect that what you'll see is that you're hitting <code>queue overflowed</code> errors which happens the gocb dispatcher queue becomes full, it defaults to a max size of 2048 items. The solution is usually to perform the work in smaller batches so as not to overload gocb. There is a similar issue with an example on <a href=\"https://forums.couchbase.com/t/bulk-upsert-data-into-couchbase/17354/2\" rel=\"nofollow noreferrer\">https://forums.couchbase.com/t/bulk-upsert-data-into-couchbase/17354/2</a></p>\n"}], "owner": {"reputation": 97, "user_id": 5586999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d6ede0f59d47a14f8ab7659e08972c?s=128&d=identicon&r=PG&f=1", "display_name": "user208383", "link": "https://stackoverflow.com/users/5586999/user208383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 53545622, "answer_count": 1, "score": 1, "last_activity_date": 1543516944, "creation_date": 1543408721, "question_id": 53519688, "link": "https://stackoverflow.com/questions/53519688/couchbase-gocb-bulk-operation-delivers-partially-empty-results", "title": "Couchbase gocb bulk operation delivers partially empty results", "body": "<p>In our go code using gocb we're querying a view that returns 32k ids. We then perform a bulk query (see code below) like explained in a <a href=\"https://blog.couchbase.com/bulk-operations-using-couchbase-and-golang/\" rel=\"nofollow noreferrer\">CouchBase blog post</a>. However, we only get partial results. We can see that <code>ruleset, _ := items[i].(*gocb.GetOp).Value.(*RuleSet)</code>only returns a value for the first 2048 ids. Then the ids 2049 - 11322 do not contain a value and so on. Our result looks like so:</p>\n\n<pre><code>Line 1 Key: 12345678901234567890123456789012, Value: map[0.0.0.0/0:map[jsona:valueofjsona]]\n...\nLine 2018 Key: 12345678901234567890123456712345, Value: map[0.0.0.0/0:map[jsona:valueofjsona]]\nLine 2019 Key: 12345678901234567890123456712345, Value: map[]\n...\nLine 11323 Key: 12345678901234567890123456712347, Value: map[jsonb:valueofjsonb]]\n</code></pre>\n\n<p>(The above lines are simplified, the keys don't match actual data, nor does the value.) </p>\n\n<p>A huge portion of the requested data is not actually returned:</p>\n\n<pre><code>CB# grep '\\[\\]' result.out |wc -l\n27042\nCB# wc -l result.out\n31988 rdmp.out\n</code></pre>\n\n<p>Does <code>bucket.do</code> return before it has completed processing all queries? We looked at the API code and could not find an explanation.</p>\n\n<p>Any idea how to solve this?</p>\n\n<pre><code>type RuleSet struct {\n    Rules map[string]interface{} \"json:\\\"rules,\\\"\"\n}\n\nfunc DiffViaBulkQuery() {\n  var items []gocb.BulkOp\n  var row interface{}\n  var cnt int = 0\n  bucket := cbase.MyBucket()\n\n// [...]\n// add 600k entries to itemsget in a loop like \n// itemsGet = append(itemsGet, &amp;gocb.GetOp{Key: key + \"_\" + strconv.Itoa(i), Value: &amp;Doc{}})\n\n\n// Perform the bulk operation to Get all documents\n  err = bucket.Do(itemsGet)\n  if err != nil {\n    fmt.Println(\"ERRROR PERFORMING BULK GET:\", err)\n  }\n\n// Print the output\n  for i := 0; i &lt; len(itemsGet); i++ {\n    fmt.Println(itemsGet[i].(*gocb.GetOp).Key, itemsGet[i].(*gocb.GetOp).Value.(*Doc).Item)\n  }\n</code></pre>\n\n<p>Thx in advance,\nTorsten</p>\n"}, {"tags": ["go", "amazon-dynamodb"], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 5337589, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a79c975f65bc970fffd72a64d243e061?s=128&d=identicon&r=PG&f=1", "display_name": "Kittovski", "link": "https://stackoverflow.com/users/5337589/kittovski"}, "edited": false, "score": 0, "creation_date": 1543416985, "post_id": 53521747, "comment_id": 93913127, "body": "Thanks Ian - how would I set up a condition to make that decision?"}], "tags": [], "owner": {"reputation": 141, "user_id": 10612458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f047654f92aef9976b1d57b347713ec?s=128&d=identicon&r=PG&f=1", "display_name": "IanMeyers - AWS", "link": "https://stackoverflow.com/users/10612458/ianmeyers-aws"}, "is_accepted": true, "score": 0, "last_activity_date": 1543415407, "creation_date": 1543415407, "answer_id": 53521747, "question_id": 53519085, "link": "https://stackoverflow.com/questions/53519085/go-dynamodb-expression-add-cant-add-to-list/53521747#53521747", "title": "Go DynamoDB Expression Add can&#39;t add to list", "body": "<p>Can you try to use Set to add a new list, and Add to add elements to an existing list?</p>\n"}], "owner": {"reputation": 165, "user_id": 5337589, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a79c975f65bc970fffd72a64d243e061?s=128&d=identicon&r=PG&f=1", "display_name": "Kittovski", "link": "https://stackoverflow.com/users/5337589/kittovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53521747, "answer_count": 1, "score": 0, "last_activity_date": 1543415407, "creation_date": 1543406658, "question_id": 53519085, "link": "https://stackoverflow.com/questions/53519085/go-dynamodb-expression-add-cant-add-to-list", "title": "Go DynamoDB Expression Add can&#39;t add to list", "body": "<p>I want to add an int to a list in DynamoDB. This works:</p>\n\n<p><code>update := expression.Set(\n        expression.Name(\"signers\"),\n        expression.Name(\"signers\").ListAppend(expression.Value([]int{theInt})),\n    )\nexpr, err := expression.NewBuilder().WithUpdate(update).Build()</code></p>\n\n<p>But only if there is a value already in the list. I want to create the list if it doesn't exist. I tried:</p>\n\n<p><code>.Add(\n        expression.Name(\"signers\"),\n        expression.Value(theInt),</code></p>\n\n<p>and</p>\n\n<p><code>.Add(\n        expression.Name(\"signers\"),\n        expression.Value([]int{theInt}),</code></p>\n\n<p>Which both return:</p>\n\n<p><code>ValidationException: Invalid UpdateExpression: Incorrect operand type for operator or function; operator: ADD, operand type:LIST</code></p>\n\n<p>How do I set the type of theInt to a list?</p>\n\n<p>I must be missing something obvious</p>\n"}, {"tags": ["arrays", "mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 1562, "user_id": 4303758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nbL0i.jpg?s=128&g=1", "display_name": "Manjeet Thakur", "link": "https://stackoverflow.com/users/4303758/manjeet-thakur"}, "edited": false, "score": 0, "creation_date": 1543406381, "post_id": 53518911, "comment_id": 93906471, "body": "have you tested the mongo query on any tool?"}, {"owner": {"reputation": 80, "user_id": 4134858, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JhtR0.jpg?s=128&g=1", "display_name": "Pixdigit", "link": "https://stackoverflow.com/users/4134858/pixdigit"}, "reply_to_user": {"reputation": 1562, "user_id": 4303758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nbL0i.jpg?s=128&g=1", "display_name": "Manjeet Thakur", "link": "https://stackoverflow.com/users/4303758/manjeet-thakur"}, "edited": false, "score": 0, "creation_date": 1543406902, "post_id": 53518911, "comment_id": 93906794, "body": "I also tried the nosqlclient interface but since it does exactly the same thing it also failed. Well more technically: it succeeded but didnt do the thing I hoped it did."}, {"owner": {"reputation": 561, "user_id": 3564720, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KiSNg.jpg?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/3564720/max"}, "edited": false, "score": 0, "creation_date": 1543423260, "post_id": 53518911, "comment_id": 93917293, "body": "You could try to replace <code>arbitraryJson</code> with <code>bson.M</code>"}, {"owner": {"reputation": 80, "user_id": 4134858, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JhtR0.jpg?s=128&g=1", "display_name": "Pixdigit", "link": "https://stackoverflow.com/users/4134858/pixdigit"}, "edited": false, "score": 0, "creation_date": 1543433627, "post_id": 53518911, "comment_id": 93922465, "body": "Already tried. It not a fault of the data type."}], "owner": {"reputation": 80, "user_id": 4134858, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JhtR0.jpg?s=128&g=1", "display_name": "Pixdigit", "link": "https://stackoverflow.com/users/4134858/pixdigit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543407125, "creation_date": 1543406132, "last_edit_date": 1543407125, "question_id": 53518911, "link": "https://stackoverflow.com/questions/53518911/mongodb-query-an-array-within-an-array-within-an-array", "title": "mongodb query an array within an array within an array", "body": "<p>I have a collection of users. Each of those have an array of bookmarks. Each bookmark has an array of categories it belongs to. Leading to a structure like this:</p>\n\n<pre><code>[\n    {name: \"Bob\",\n     bookmarks: [\n         {url: \"http://duckduckgo.com\",\n          categories: [\n              \"Search\",\n              \"Ducks\",\n          ],\n         },\n     ],\n    },\n]\n</code></pre>\n\n<p>Now given a name and a url and a category name. I want to delete said category of the respective bookmark. But my problem is that all attempts return the whole user or delete the whole bookmark and not just the category.</p>\n\n<p>This is my best attempt using the mgo driver so far:</p>\n\n<pre><code>type arbitraryJson map[string]interface{}\nuser := \"Bob\"\nbookmarkURL := url.Parse(\"http://duckduckgo.com\")\ntagName := \"Search\"\n\nerr = userDB.Update(\n    arbitraryJson{\n        \"name\":          user,\n        \"bookmarks.url\": bookmarkURL.String(),\n    },\n    arbitraryJson{\n        \"$pull\": arbitraryJson{\n            \"bookmarks.categories\": tagName,\n        },\n    },\n)\n</code></pre>\n\n<p>Which translates (I think) to the mongo query:</p>\n\n<pre><code>db.users.updateOne(\n   { name: \"Bob\",\n     bookmarks.url: \"http://duckduckgo.com\" }\n   {\n     $pull: { bookmarks.categories: \"search\" }\n   }\n)\n</code></pre>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 1, "creation_date": 1543398685, "post_id": 53516405, "comment_id": 93901952, "body": "The simplest way to run a golang web app in a container would be to start from the official golang image found here: <a href=\"https://hub.docker.com/_/golang/\" rel=\"nofollow noreferrer\">hub.docker.com/_/golang/</a> and follow the instructions of the &quot;Start a Go instance in your app&quot; section."}, {"owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "edited": false, "score": 0, "creation_date": 1543403380, "post_id": 53516405, "comment_id": 93904745, "body": "You could try accessing the port of the localhost from within the Docker Container. <a href=\"https://stackoverflow.com/questions/24319662/from-inside-of-a-docker-container-how-do-i-connect-to-the-localhost-of-the-mach\">as pointed out here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "edited": false, "score": 0, "creation_date": 1543460859, "post_id": 53518338, "comment_id": 93930704, "body": "why three expose? the first one is the port on which my web app is  running?"}], "tags": [], "owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "is_accepted": false, "score": 1, "last_activity_date": 1543404247, "creation_date": 1543404247, "answer_id": 53518338, "question_id": 53516405, "link": "https://stackoverflow.com/questions/53516405/how-to-run-golang-web-app-on-a-docker-container/53518338#53518338", "title": "How to run golang web app on a Docker container", "body": "<p>I guess you are not exposing the Docker Port outside the container.\nThat's why you are not able to see any output rather than just being specific to GO Program.\nTry adding the below lines to your docker compose File</p>\n\n<pre><code>EXPOSE 80(whichever port you want it to be)\nEXPOSE 443\nEXPOSE 3306\n</code></pre>\n\n<p>This will make the container be accessed from outside</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "edited": false, "score": 0, "creation_date": 1544428220, "post_id": 53518392, "comment_id": 94257571, "body": "what is CMD command, should I do CMD[&quot;main.go&quot;] ? and I&#39;m confused with the WORKDIR, what directory you should choose? thanks"}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "reply_to_user": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "edited": false, "score": 0, "creation_date": 1544436697, "post_id": 53518392, "comment_id": 94261588, "body": "CMD tells what will be executed when you start container. You don&#39;t need to run main.go, you need to build it first (RUN go build -o main .), and then /app/main will be your executable path. WORKDIR just means what is the pwd of your container."}, {"owner": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "edited": false, "score": 0, "creation_date": 1544498955, "post_id": 53518392, "comment_id": 94287816, "body": "How do you make docker file ignore a package, cause mine is always trying to get a package that is actually just a folder that I imported to my golang code, If I use RUN go get github.com/folderName I will still get the error because it&#39;s not on github but just a folder. Thanks"}, {"owner": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "edited": false, "score": 0, "creation_date": 1544499945, "post_id": 53518392, "comment_id": 94288008, "body": "&quot;cannot find package github.com/rn1hd/todo/models&quot;. But on my code i just imported that folder cause it contains some of my .go files, thanks"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1543404421, "creation_date": 1543404421, "answer_id": 53518392, "question_id": 53516405, "link": "https://stackoverflow.com/questions/53516405/how-to-run-golang-web-app-on-a-docker-container/53518392#53518392", "title": "How to run golang web app on a Docker container", "body": "<ol>\n<li>You don't need Nginx to run a server in Go</li>\n<li>It's better to build a binary in Dockerfile</li>\n</ol>\n\n<p>Here is how your Dockerfile may look like:</p>\n\n<pre><code>FROM golang:latest \nRUN mkdir /app \nADD . /app/ \nWORKDIR /app \nRUN go build -o main .\nEXPOSE 8000\nCMD [\"/app/main\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "edited": false, "score": 0, "creation_date": 1543824684, "post_id": 53521314, "comment_id": 94042586, "body": "is your web app running on it&#39;s own or inside the container? cause my container exited immediately after running it, but the web app is up cause of the command //go build; projectName. So I guess my web app is running on it&#39;s own and not inside the container"}, {"owner": {"reputation": 1782, "user_id": 7247053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NoDc0.jpg?s=128&g=1", "display_name": "Truong Dang", "link": "https://stackoverflow.com/users/7247053/truong-dang"}, "reply_to_user": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "edited": false, "score": 0, "creation_date": 1543825255, "post_id": 53521314, "comment_id": 94042783, "body": "My web app run inside container. You container stop immediately my your set entry point for it. Can you show your dockerfile now ?"}, {"owner": {"reputation": 1782, "user_id": 7247053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NoDc0.jpg?s=128&g=1", "display_name": "Truong Dang", "link": "https://stackoverflow.com/users/7247053/truong-dang"}, "reply_to_user": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "edited": false, "score": 0, "creation_date": 1543830374, "post_id": 53521314, "comment_id": 94045189, "body": "<code>docker ps -a</code> then copy your docker container name id which exited. Then check container logs details <code>docker logs --details your_container_name</code> may helpfull"}], "tags": [], "owner": {"reputation": 1782, "user_id": 7247053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NoDc0.jpg?s=128&g=1", "display_name": "Truong Dang", "link": "https://stackoverflow.com/users/7247053/truong-dang"}, "is_accepted": false, "score": 1, "last_activity_date": 1543414016, "creation_date": 1543414016, "answer_id": 53521314, "question_id": 53516405, "link": "https://stackoverflow.com/questions/53516405/how-to-run-golang-web-app-on-a-docker-container/53521314#53521314", "title": "How to run golang web app on a Docker container", "body": "<p>Here is what i did for my GOlang web app use <code>Gin-gonic</code> framework -\nmy Dockerfile:</p>\n\n<pre><code>FROM golang:latest\n# Author\nMAINTAINER dangminhtruong\n# Create working folder\nRUN mkdir /app\nCOPY . /app\nRUN apt -y update &amp;&amp; apt -y install git\nRUN go get github.com/go-sql-driver/mysql\nRUN go get github.com/gosimple/slug\nRUN go get github.com/gin-gonic/gin\nRUN go get gopkg.in/russross/blackfriday.v2\nRUN go get github.com/gin-gonic/contrib/sessions\nWORKDIR /app \n</code></pre>\n\n<p>Then build docker image</p>\n\n<p><code>docker build -t web-app:latest .</code></p>\n\n<p>Finally, start my web-app</p>\n\n<p><code>docker run -it -p 80:8080 -d web-app:latest go run main.go //My webapp start at 8080 port</code></p>\n\n<p>Hope this helpfull</p>\n"}], "owner": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2245, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1543826893, "creation_date": 1543398135, "last_edit_date": 1543826893, "question_id": 53516405, "link": "https://stackoverflow.com/questions/53516405/how-to-run-golang-web-app-on-a-docker-container", "title": "How to run golang web app on a Docker container", "body": "<p>I have a web app that uses go language as it's back end. When I run my website I just do <code>go build; ./projectName</code> then it will run on local server port 8000. How do I run this web app on a container? I can run sample images like nginx on a container, but how do I create my own images for my projects. I created a Dockerfile inside my project folder with the following codes: </p>\n\n<pre><code>FROM nginx:latest\n\nWORKDIR static/html/\n\nCOPY . /usr/src/app\n</code></pre>\n\n<p>Then made an image using the Dockerfile, but when I run it on a container and go to localhost:myPort/static/html/page.html it says 404 page not found. My other question is, does docker can only run static pages on a container? cause my site can receive and send data. Thanks</p>\n\n<p><a href=\"https://i.stack.imgur.com/WAJJv.png\" rel=\"nofollow noreferrer\">this is my docker file</a> (./todo is my project name and folder name)</p>\n\n<p><a href=\"https://i.stack.imgur.com/LoP0W.png\" rel=\"nofollow noreferrer\">this is my terminal</a> ( as you can see the the container exits emmediately)</p>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543399389, "post_id": 53516358, "comment_id": 93902386, "body": "It look like you never ran <code>go mod init mycompany</code> in $GOPATH/src/mycompany, therefore there is no module yet. // The comment about dotless paths you quoted is by bcmills, one of the Go maintainers (or author, even?). You can take that as authorative. // Modules are not &quot;all-or-nothing&quot;. You can depend on non-modules just fine."}, {"owner": {"reputation": 373, "user_id": 5558137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6jqW.jpg?s=128&g=1", "display_name": "diagprov", "link": "https://stackoverflow.com/users/5558137/diagprov"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543400637, "post_id": 53516358, "comment_id": 93903140, "body": "@Peter I left that out of my question, but I did (otherwise it wouldn&#39;t build as a module, no?). I&#39;ll edit that into the question. So if this is true my question becomes: if I can depend on non-modules, why doesn&#39;t it work? :P"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543408789, "post_id": 53516358, "comment_id": 93907914, "body": "Ah, I see now. You have to add a <a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"nofollow noreferrer\">replace statement</a> in mycompany/myprogram to make this work."}, {"owner": {"reputation": 373, "user_id": 5558137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6jqW.jpg?s=128&g=1", "display_name": "diagprov", "link": "https://stackoverflow.com/users/5558137/diagprov"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543411243, "post_id": 53516358, "comment_id": 93909395, "body": "@Peter this sounds like exactly what I need. I added <code>replace mycompany&#47;mylib =&gt; ..&#47;mylib&#47;</code> to my example, didn&#39;t work. So, domain name issue. So I renamed all <code>mycompany</code> references to <code>mycompany.com</code>... and now the build (of the example in my Q) hangs until the internet times out and then gives me the usual <code>build mycompany.com&#47;myprogram: cannot find module for path mycompany.com&#47;mylib</code> :("}, {"owner": {"reputation": 373, "user_id": 5558137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6jqW.jpg?s=128&g=1", "display_name": "diagprov", "link": "https://stackoverflow.com/users/5558137/diagprov"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543415122, "post_id": 53516358, "comment_id": 93911973, "body": "So I guess we need to combine the two approaches; build from private but remote repositories with url-like imports and then we can replace locally to speed up dev."}, {"owner": {"reputation": 91, "user_id": 1212359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e873c355980d8819e5fcabcc0172dee3?s=128&d=identicon&r=PG", "display_name": "Tarun Tyagi", "link": "https://stackoverflow.com/users/1212359/tarun-tyagi"}, "edited": false, "score": 0, "creation_date": 1570224284, "post_id": 53516358, "comment_id": 102858850, "body": "@diagprov I am in the same boat and get this error. Were you able to find any solution to your problem?"}, {"owner": {"reputation": 373, "user_id": 5558137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6jqW.jpg?s=128&g=1", "display_name": "diagprov", "link": "https://stackoverflow.com/users/5558137/diagprov"}, "reply_to_user": {"reputation": 91, "user_id": 1212359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e873c355980d8819e5fcabcc0172dee3?s=128&d=identicon&r=PG", "display_name": "Tarun Tyagi", "link": "https://stackoverflow.com/users/1212359/tarun-tyagi"}, "edited": false, "score": 0, "creation_date": 1570315452, "post_id": 53516358, "comment_id": 102875914, "body": "@TarunTyagi not that was satisfying with gitlab. We could only use top level repositories (gitlab.com/org/repo) and not gitlab.com/org/subproj/repo) because of some crazy gitlab feature. We also had to configure ssh instead of https because there&#39;s no token support on gitlab.  We&#39;ve since migrated to github, thankfully."}, {"owner": {"reputation": 373, "user_id": 5558137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6jqW.jpg?s=128&g=1", "display_name": "diagprov", "link": "https://stackoverflow.com/users/5558137/diagprov"}, "edited": false, "score": 0, "creation_date": 1570315557, "post_id": 53516358, "comment_id": 102875930, "body": "Go vanity urls is something I am also investigating right now as a way to provide the required redirection. It still requires the remote end to support the go modules protocol to discover the correct repo format, and some kind of token support for http auth, but it can at least allow you to redirect go.yourcompany.com/repo -&gt; gitlab.com/org/subproj/repo.git (.git required because gitlab doesn&#39;t provide support in subprojects for go modules)."}], "answers": [{"comments": [{"owner": {"reputation": 373, "user_id": 5558137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6jqW.jpg?s=128&g=1", "display_name": "diagprov", "link": "https://stackoverflow.com/users/5558137/diagprov"}, "edited": false, "score": 2, "creation_date": 1543425423, "post_id": 53518444, "comment_id": 93918512, "body": "Thanks. We use gitlab, but a similar workaround exists for this as well and we&#39;ll be using it for sure."}, {"owner": {"reputation": 841, "user_id": 4400812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V6TEr.jpg?s=128&g=1", "display_name": "Marco Dufal", "link": "https://stackoverflow.com/users/4400812/marco-dufal"}, "edited": false, "score": 1, "creation_date": 1595588757, "post_id": 53518444, "comment_id": 111534099, "body": "This is no longer sufficient, you need to also populate <a href=\"https://tip.golang.org/cmd/go/#hdr-Module_configuration_for_non_public_modules\" rel=\"nofollow noreferrer\"><code>GOPRIVATE</code></a> now."}, {"owner": {"reputation": 841, "user_id": 4400812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V6TEr.jpg?s=128&g=1", "display_name": "Marco Dufal", "link": "https://stackoverflow.com/users/4400812/marco-dufal"}, "edited": false, "score": 0, "creation_date": 1595933670, "post_id": 53518444, "comment_id": 111638780, "body": "What to do if your are working with a private BitBucket repository?"}, {"owner": {"reputation": 198, "user_id": 1109065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b8f0969fef9e859da59ac70c0732b3?s=128&d=identicon&r=PG", "display_name": "MichaelWang", "link": "https://stackoverflow.com/users/1109065/michaelwang"}, "edited": false, "score": 0, "creation_date": 1615957693, "post_id": 53518444, "comment_id": 117850122, "body": "I did not set GOPRIVATE and this heps me."}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 23, "last_activity_date": 1555508860, "last_edit_date": 1555508860, "creation_date": 1543404581, "answer_id": 53518444, "question_id": 53516358, "link": "https://stackoverflow.com/questions/53516358/go-modules-private-repos-and-gopath/53518444#53518444", "title": "Go modules, private repos and gopath", "body": "<p>I use a workaround with <code>GITHUB_TOKEN</code> to solve this.</p>\n\n<ol>\n<li>Generate <code>GITHUB_TOKEN</code> here <a href=\"https://github.com/settings/tokens\" rel=\"noreferrer\">https://github.com/settings/tokens</a></li>\n<li><code>export GITHUB_TOKEN=xxx</code></li>\n<li><code>git config --global url.\"https://${GITHUB_TOKEN}:x-oauth-basic@github.com/mycompany\".insteadOf \"https://github.com/mycompany\"</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "edited": false, "score": 0, "creation_date": 1562598587, "post_id": 56299683, "comment_id": 100415945, "body": "Is there a way to use <code>http</code> instead of <code>https</code>. We have a legacy <code>git</code> server behind a firewall where everything is <code>http</code> and the change above does not work when invoking the <code>go</code> command (which is trying to fetch the repo via <code>https</code> on port 443)"}, {"owner": {"reputation": 5038, "user_id": 436754, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/40s9Q.jpg?s=128&g=1", "display_name": "Pawe\u0142 Szczur", "link": "https://stackoverflow.com/users/436754/pawe%c5%82-szczur"}, "edited": false, "score": 0, "creation_date": 1565610127, "post_id": 56299683, "comment_id": 101394345, "body": "This is a common solution, but it fails with <code>https:&#47;&#47;repos.example.com&#47;my-library?go-get=1</code> request made by go tool before reaching cloning phase."}, {"owner": {"reputation": 841, "user_id": 4400812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V6TEr.jpg?s=128&g=1", "display_name": "Marco Dufal", "link": "https://stackoverflow.com/users/4400812/marco-dufal"}, "edited": false, "score": 0, "creation_date": 1595943761, "post_id": 56299683, "comment_id": 111644382, "body": "You should be more specific and state that your answer, where it mentions BitBucket, is purposely for BitBucket server not BitBucket cloud. Luckily you mention the <a href=\"https://confluence.atlassian.com/bitbucketserver/permanently-authenticating-with-git-repositories-776639846.html#PermanentlyauthenticatingwithGitrepositories-Usingthe.netrcfile\" rel=\"nofollow noreferrer\"><code>.netrc</code> solution</a> in your article and this happens to work in go @1.13 onwards by also specifying the <code>GOPRIVATE</code>](<a href=\"https://golang.org/doc/go1.13#modules\" rel=\"nofollow noreferrer\">golang.org/doc/go1.13#modules</a>) environment variable."}], "tags": [], "owner": {"reputation": 109, "user_id": 6520477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed45ba651e77ab287e42c11756abab80?s=128&d=identicon&r=PG", "display_name": "timjonesdev", "link": "https://stackoverflow.com/users/6520477/timjonesdev"}, "is_accepted": false, "score": 7, "last_activity_date": 1558733073, "creation_date": 1558733073, "answer_id": 56299683, "question_id": 53516358, "link": "https://stackoverflow.com/questions/53516358/go-modules-private-repos-and-gopath/56299683#56299683", "title": "Go modules, private repos and gopath", "body": "<p>I wrote up a solution for this on Medium: <a href=\"https://medium.com/cloud-native-the-gathering/go-modules-with-private-git-repositories-dfe795068db4\" rel=\"noreferrer\">Go Modules with Private Git Repositories</a>.</p>\n\n<p>The way we handle it is basically the same as the answer above from <a href=\"https://stackoverflow.com/a/53518444/6520477\">Alex Pliutau</a>, and the blog goes into some more detail with examples for how to set up your git config with tokens from GitHub/GitLab/BitBucket.</p>\n\n<p>The relevant bit for GitLab:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>git config --global \\\n  url.\"https://oauth2:${personal_access_token}@privategitlab.com\".insteadOf \\\n  \"https://privategitlab.com\"\n\n#or \n\ngit config --global \\\n  url.\"https://${user}:${personal_access_token}@privategitlab.com\".insteadOf \\\n  \"https://privategitlab.com\"\n</code></pre>\n\n<p>I hope it's helpful.</p>\n"}, {"comments": [{"owner": {"reputation": 1511, "user_id": 1505851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9297d1bf85645c48d8429dae21f48b19?s=128&d=identicon&r=PG", "display_name": "lmika", "link": "https://stackoverflow.com/users/1505851/lmika"}, "edited": false, "score": 3, "creation_date": 1587247859, "post_id": 59640699, "comment_id": 108437987, "body": "You can use <code>go env -w GOPRIVATE</code> for private Github repositories as well: <code>go env -w GOPRIVATE=github.com&#47;username&#47;*</code>"}], "tags": [], "owner": {"reputation": 1276, "user_id": 1235354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yoAyU.jpg?s=128&g=1", "display_name": "utkusonmez", "link": "https://stackoverflow.com/users/1235354/utkusonmez"}, "is_accepted": false, "score": 10, "last_activity_date": 1578465920, "creation_date": 1578465920, "answer_id": 59640699, "question_id": 53516358, "link": "https://stackoverflow.com/questions/53516358/go-modules-private-repos-and-gopath/59640699#59640699", "title": "Go modules, private repos and gopath", "body": "<p>I use ls-remote git command to help resolve private repo tags and go get after it. </p>\n\n<pre><code>$ go env GO111MODULE=on\n$ go env GOPRIVATE=yourprivaterepo.com\n$ git ls-remote -q https://yourprivaterepo.com/yourproject.git\n$ go get\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 5558137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6jqW.jpg?s=128&g=1", "display_name": "diagprov", "link": "https://stackoverflow.com/users/5558137/diagprov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27380, "favorite_count": 4, "answer_count": 3, "score": 21, "last_activity_date": 1578465920, "creation_date": 1543397978, "last_edit_date": 1568105080, "question_id": 53516358, "link": "https://stackoverflow.com/questions/53516358/go-modules-private-repos-and-gopath", "title": "Go modules, private repos and gopath", "body": "<p>We are converting our internal codebase from the <code>dep</code> dependency manager to go modules (<code>vgo</code> or built in with go1.11.2). Imagine we have code like this:</p>\n\n<p><em>$GOPATH/src/mycompany/myprogram/main.go:</em></p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        lib \"mycompany/mylib\" )\n\nfunc main() {\n        fmt.Println(\"2+3=\", lib.add(2, 3)) \n}\n</code></pre>\n\n<p><em>$GOPATH/src/mycompany/myprogram/go.mod:</em></p>\n\n<pre><code>module mycompany/myprogram\n</code></pre>\n\n<p>(it doesn't have any dependencies; our real-world code does).</p>\n\n<p><em>$GOPATH/src/mycompany/mylib/lib.go:</em></p>\n\n<pre><code>package mylib\n\nfunc Add(x int, y int) int {\n        return x + y\n}\n</code></pre>\n\n<p>I didn't module-ize this code; it doesn't seem to matter whether I do or don't.</p>\n\n<p>These are trivial examples but our internal code follows a similar structure as this worked historically.</p>\n\n<p>Since these directories are on the Gopath, <code>export GO111MODULE=auto</code> still builds as before and this works fine (modules not used because we are on the gopath). However, when I set <code>export GO111MODULE=on</code> I immediately get the error:</p>\n\n<pre><code>build mycompany/myprogram: cannot find module for path mycompany/mylib\n</code></pre>\n\n<p>So I did some research and I would like to validate my understanding. First let me say our old approach worked, but I am more interested in changing to use go modules as it appears to be where the go project itself is headed. So.</p>\n\n<ol>\n<li><p>It seems the intention of the golang authors was that \"dotless\" paths belong to the standard repository only; that is there should be a binding between domain name and project. We don't use go get on our internal project, unsurprisingly. <a href=\"https://github.com/golang/go/issues/27503#issuecomment-418859602\" rel=\"noreferrer\">Here is the source</a> specifically:</p>\n\n<blockquote>\n  <p>Dotless paths in general are reserved for the standard library; go get has (to my knowledge) never worked with them, but go get is also the main entry point for working with versioned modules.</p>\n</blockquote>\n\n<p>Can anyone with more knowledge of golang than me confirm this?</p></li>\n<li><p><strong>My key assumption</strong> is that once go decides to use modules, <strong>all</strong> dependencies must be modules and the gopath becomes somewhat irrelevant, except as a cache (for downloaded modules). Is this correct?</p></li>\n<li><p>If this is true, we need to use a private gitlab (in our case) repository on the path. <a href=\"https://github.com/golang/go/issues/26134\" rel=\"noreferrer\">There's an open issue on handling this that I'm aware of</a> so we can implement this if necessary. I'm more interested in the consequences, specifically for iterating in the private repositories. Previously we could develop these libraries locally before committing any changes; now it seems we have a choice:</p>\n\n<ol>\n<li>Accept this remote dependency and iterate. I was hoping to avoid needing to push and pull remotely like this. There are workarounds to needing an internet connection if strictly necessary.</li>\n<li>Merge everything into one big git repository.</li>\n</ol></li>\n</ol>\n\n<p>If it matters, I'm using <code>go version go1.11.2 linux/amd64</code> and my colleagues are using <code>darwin/amd64</code>. If it helps, my golang is exactly as installed by Fedora's repositories.</p>\n\n<p>So, <code>tl;dr</code>, my question is: are go modules all-or-nothing, in that any dependency must be resolved using the module system (go get, it seems) and the gopath has become redundant? Or is there something about my setup that might trigger this to fail? Is there some way to indicate a dependency should be resolved explicitly from the gopath?</p>\n\n<p><strong>Updates since asking the question</strong>:</p>\n\n<ol>\n<li>I can move <code>myprogram</code> out of the gopath. The same issue occurs (<code>mylib</code> has been left in the gopath).</li>\n<li>I can run, or not run, <code>go mod init mycompany/mylib</code> in the mylib directory; it makes no difference at all.</li>\n<li>I came across <a href=\"https://research.swtch.com/vgo-module\" rel=\"noreferrer\">Russ Cox's blog post on vgo</a>. My concerns about offline development that I tried not to dive into too far are resolved by <code>$GOPROXY</code>.</li>\n</ol>\n"}, {"tags": ["arrays", "list", "go", "arraylist", "struct"], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 2, "last_activity_date": 1543398869, "last_edit_date": 1543398869, "creation_date": 1543396634, "answer_id": 53515916, "question_id": 53515833, "link": "https://stackoverflow.com/questions/53515833/how-to-store-values-in-struct-using-a-for-loop-in-golang/53515916#53515916", "title": "How to store values in struct using a for loop in golang", "body": "<p>This is a valid and working version of your code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype saveDetails struct {\n    ID         string\n    Grade      string\n    Regular    string\n    OpeningKey string\n}\n\nfunc main() {\n    var tagsList []saveDetails\n    results := []saveDetails{saveDetails{ID: \"1000000001\", Grade: \"A\", Regular: \"Regular\", OpeningKey: \"JOBOp123\"}, saveDetails{ID: \"1000000001\", Grade: \"A\", Regular: \"Regular\", OpeningKey: \"JOBOp123\"}}\n\n    for _, details := range results {\n        tagsList = append(tagsList, saveDetails{\n            ID: details.ID, Grade: details.Grade, Regular: details.Regular, OpeningKey: details.OpeningKey,\n        })\n    }\n    fmt.Println(\"saveDetails :\", tagsList)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/vVQGPTnph6z\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vVQGPTnph6z</a></p>\n"}, {"tags": [], "owner": {"reputation": 777, "user_id": 4809932, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/83a7z.png?s=128&g=1", "display_name": "bajro", "link": "https://stackoverflow.com/users/4809932/bajro"}, "is_accepted": false, "score": 1, "last_activity_date": 1543397725, "last_edit_date": 1543397725, "creation_date": 1543397158, "answer_id": 53516085, "question_id": 53515833, "link": "https://stackoverflow.com/questions/53515833/how-to-store-values-in-struct-using-a-for-loop-in-golang/53516085#53516085", "title": "How to store values in struct using a for loop in golang", "body": "<p>Here is a working solution to your problem. Note that your <code>results</code> array was not correctly declared. Below you can find a working solution where the <code>tagsList</code> is not of type <code>array</code> but uses a slice that is initialized with the <code>make()</code> function. I would suggest using slices, as arrays are value types and therefore always copied when passed around or set under new variables. Slices are just references (i.e. a pointer) to underlying arrays and have various advantages in terms of performance if the array gets bigger as time passes.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype saveDetails struct {\n    ID         string\n    Grade      string\n    Regular    string\n    OpeningKey string\n}\n\nfunc main() {\n    tagsList := make([]saveDetails, 0) // 0 is the initial size of the slice\n    results := []saveDetails{{\"1000000001\", \"A\", \"Regular\", \"JOBOp123\"}, {\"1000000002\", \"B\", \"Regular\", \"JOBOp234\"}, {\"1000000003\", \"C\", \"Regular\", \"JOBOp456\"}}\n\n    for _, details := range results {\n        tagsList = append(tagsList, saveDetails{ID: details.ID, Grade: details.Grade, Regular: details.Regular, OpeningKey: details.OpeningKey})\n    }\n    fmt.Println(\"saveDetails :\", tagsList)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Josvx49tNf6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Josvx49tNf6</a></p>\n"}], "owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3483, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1543398869, "creation_date": 1543396356, "question_id": 53515833, "link": "https://stackoverflow.com/questions/53515833/how-to-store-values-in-struct-using-a-for-loop-in-golang", "title": "How to store values in struct using a for loop in golang", "body": "<p>I want to store values in a struct. I have multiple set of datas and while iterating those set of data, I have to store those sets into struct. \nI should also have the previous stored data along with the currently stored.</p>\n\n<p>Please find the code i am using</p>\n\n<pre><code>    package main\n    import (\n      \"fmt\"\n    )\n\n    type saveDetails struct {\n      ID string\n      Grade string\n      Regular string\n      OpeningKey string\n    }\n\n    func main() {\n       tagsList := []saveDetails {}\n       results = [{ {1000000001 A Regular JOBOp123}} { {1000000002 B Regular JOBOp234}} { {1000000003 C  Regular JOBOp456}}]\n\n       for _, details := range results {\n          tagsList = append(tagsList, saveDetails {ID: details.ID, Grade:details.Grade, Regular:details.Regular, OpeningKey:details.OpeningKey})\n       }\n       fmt.Println(\"saveDetails :\",tagsList )\n     }\n</code></pre>\n\n<p>Please help me in resolving this issue. I am new to this array and structs in golang. I am not sure whether i could use the append function. It could be very much helpful if i get an working code.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1543395913, "post_id": 53515335, "comment_id": 93900235, "body": "No you cannot. Sorry."}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1543396140, "post_id": 53515335, "comment_id": 93900359, "body": "You can use: <code>v := reflect.ValueOf(a) m := v.MethodByName(&quot;B&quot;)</code> But to get A type from B is impossible, but from you example you can just access a by doing <code>reflect.ValueOf(a)</code>"}, {"owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 0, "creation_date": 1543396312, "post_id": 53515335, "comment_id": 93900482, "body": "ah I only have access to &quot;b&quot;. still learning.. maybe it&#39;s impossible. thanks for replies."}], "answers": [{"tags": [], "owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "is_accepted": false, "score": 3, "last_activity_date": 1543397350, "creation_date": 1543397350, "answer_id": 53516161, "question_id": 53515335, "link": "https://stackoverflow.com/questions/53515335/get-receiver-type-and-method-name-from-just-a-reference-of-function-in-go/53516161#53516161", "title": "Get Receiver Type and Method name from just a reference of function in Go", "body": "<p>This will do the work. </p>\n\n<pre><code>fmt.Println(runtime.FuncForPC(m.Pointer()).Name())\n</code></pre>\n\n<p>Credits to this <a href=\"http://www.alangpierce.com/blog/2016/03/17/adventures-in-go-accessing-unexported-functions/\" rel=\"nofollow noreferrer\">awesome article</a>,</p>\n"}], "owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543397892, "creation_date": 1543394608, "last_edit_date": 1543397892, "question_id": 53515335, "link": "https://stackoverflow.com/questions/53515335/get-receiver-type-and-method-name-from-just-a-reference-of-function-in-go", "title": "Get Receiver Type and Method name from just a reference of function in Go", "body": "<p>Given a code setup like this,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"runtime/debug\"\n)\n\ntype A struct{}\n\nfunc (o *A) B() error {\n    debug.PrintStack()\n    return nil\n}\n\nfunc main() {\n    a := &amp;A{}\n    b := a.B\n\n    // Note that if run b(), it can print the stack and show the info \n    // \"(*A).B-fm\" and \"(*A).B\"\n\n    m := reflect.ValueOf(b)\n    fmt.Println(m.Type().String())\n}\n</code></pre>\n\n<p>Is it possible to get the information of <strong>b</strong>'s receiver type A and B as a method? How if possible? </p>\n\n<p>Note that <strong>b</strong> is value of method B of type A.</p>\n\n<p>(Possible use scenario, generating a constant unique API ID based on only a reference like b, by forming a string like <strong>(*A).B</strong>. It's used to build a debug tool without a need to change existing code.)</p>\n\n<p>update:</p>\n"}, {"tags": ["docker", "go", "amazon-redshift", "alpine"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543394360, "post_id": 53515162, "comment_id": 93899359, "body": "You are not checking the error from sql.Open before proceeding to Ping the database. What is it?"}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543394978, "post_id": 53515162, "comment_id": 93899725, "body": "@Peter I shifted that error to be handled before the ping, and it does seem to be the <code>log.Panic(err)</code> within the ping that&#39;s causing the fatal."}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1543404643, "post_id": 53515162, "comment_id": 93905465, "body": "Can you please share your connection string?"}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1543404698, "creation_date": 1543404698, "answer_id": 53518472, "question_id": 53515162, "link": "https://stackoverflow.com/questions/53515162/ssl-error-connecting-to-redshift-from-a-go-api/53518472#53518472", "title": "SSL error connecting to Redshift from a Go api", "body": "<p>You can establish DB connection without SSL encryption, like that:</p>\n\n<pre><code>db, err := sql.Open(\"postgres\", \"user=test password=test dbname=test sslmode=disable\") \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "is_accepted": false, "score": 0, "last_activity_date": 1543405441, "creation_date": 1543405441, "answer_id": 53518684, "question_id": 53515162, "link": "https://stackoverflow.com/questions/53515162/ssl-error-connecting-to-redshift-from-a-go-api/53518684#53518684", "title": "SSL error connecting to Redshift from a Go api", "body": "<p>I figured this out, the connection string we were using had <code>ssl=true</code> which worked for a library in nodejs, but in Go it should be <code>sslmode=require</code>. I did a check for this, and a string replace. </p>\n"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543405441, "creation_date": 1543393938, "last_edit_date": 1543396286, "question_id": 53515162, "link": "https://stackoverflow.com/questions/53515162/ssl-error-connecting-to-redshift-from-a-go-api", "title": "SSL error connecting to Redshift from a Go api", "body": "<p>I have the following go code:</p>\n\n<pre><code>func NewConnection(connectionString string) (*sql.DB, error) {\n    db, err := sql.Open(\"postgres\", connectionString)\n    if err := db.Ping(); err != nil {\n        log.Panic(err)\n    }\n    return db, err\n}\n</code></pre>\n\n<p>And the following Dockerfile:</p>\n\n<pre><code># Build env\nFROM golang:alpine AS build\n\nARG stage\n\nRUN apk update &amp;&amp; apk upgrade &amp;&amp; \\\n  apk add --no-cache bash git openssh build-base &amp;&amp; \\\n  go get -u golang.org/x/vgo\n\nADD . /src\nWORKDIR /src\n\nRUN vgo mod init &amp;&amp; vgo install ./...&amp;&amp; vgo build -o service\n\n# Runtime env\nFROM alpine\n\nARG stage\n\nRUN apk update &amp;&amp; apk add --no-cache ca-certificates openssl openssl-dev\nWORKDIR /app\n\nCOPY --from=build /src/${stage}-env.yml /app/\nCOPY --from=build /src/service /app/\n\nENV CONFIG_PATH=.\n\nENTRYPOINT ./service\n</code></pre>\n\n<p>My NewConnection function retrieves a Redshift connection string from a queue, along with some data. Which all works locally when I test against a postgres container. However, when I deploy my service, I get the following error:</p>\n\n<pre><code>panic: pq: parameter \"ssl\" cannot be changed after server start\n</code></pre>\n\n<p>My connection contains <code>?ssl=true</code> and it should be SSL, we're connecting from a Fargate service in AWS, to AWS Redshift etc. So I think the issue could be related to missing ssl dependencies in my Alpine container, or missing certs or something along those lines.</p>\n"}, {"tags": ["go", "ssh"], "answers": [{"tags": [], "owner": {"reputation": 14, "user_id": 5103403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-leQ-gEbOjiA/AAAAAAAAAAI/AAAAAAAAABA/bXM0pkqdE_M/photo.jpg?sz=128", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/5103403/nicholas"}, "is_accepted": true, "score": 0, "last_activity_date": 1543393420, "creation_date": 1543393420, "answer_id": 53515013, "question_id": 53514133, "link": "https://stackoverflow.com/questions/53514133/can-not-get-stderr-from-ssh/53515013#53515013", "title": "can not get stderr from ssh", "body": "<p>try like this</p>\n\n<pre><code>session, err := sshClient.NewSession()\nif err != nil {\n    panic(err.Error())\n}\n\ndefer session.Close()\ndata, err := session.CombinedOutput(\"ls2\")\nif err != nil {\n    if v, ok := err.(*ssh.ExitError); ok {\n        fmt.Println(v.Msg())\n    }\n}\nfmt.Println(string(data))\n</code></pre>\n\n<p>and will output <code>command not found: ls2</code> </p>\n\n<p>you can see the issues at here <a href=\"https://github.com/golang/go/issues/14251\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/14251</a></p>\n"}], "owner": {"reputation": 23, "user_id": 7247290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a26845b04f006cea35fe72862bc64e?s=128&d=identicon&r=PG&f=1", "display_name": "Hailei Hu", "link": "https://stackoverflow.com/users/7247290/hailei-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 53515013, "answer_count": 1, "score": 0, "last_activity_date": 1543422740, "creation_date": 1543389761, "last_edit_date": 1543422740, "question_id": 53514133, "link": "https://stackoverflow.com/questions/53514133/can-not-get-stderr-from-ssh", "title": "can not get stderr from ssh", "body": "<p>I am trying to get the error info when running a command from ssh. Here is the example:</p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/crypto/ssh\"\n    \"net\"\n)\n\nfunc main() {\n    config := &amp;ssh.ClientConfig{\n        User: \"xx\",\n        Auth: []ssh.AuthMethod{\n            ssh.Password(\"xxx\"),\n        },\n\n        HostKeyCallback: func(hostname string, remote net.Addr, key ssh.PublicKey) error {\n            return nil\n        },\n    }\n\n    sshClient, err := ssh.Dial(\"tcp\", \"x.x.x.x:22\", config)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    session, err := sshClient.NewSession()\n    if err != nil {\n        panic(err.Error())\n    }\n\n    data, err := session.CombinedOutput(\"ls2\")\n    if err != nil {\n        // This prints : error = Process exited with status 127\n        // Pos1\n        print(\"error = \" + err.Error())\n        return\n    }\n\n    // Pos2\n    content := string(data)\n    println(content)\n}\n</code></pre>\n\n<p>I test a wrong command: ls2, and I want to get the actual error info \"-bash: ls2: command not found\" at Pos2. But this test program failed at Pos1, and print \"error = Process exited with status 127\", which is not what I want, because I need the actual info.</p>\n"}, {"tags": ["string", "go", "rune"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1543383777, "last_edit_date": 1543383777, "creation_date": 1543382737, "answer_id": 53512677, "question_id": 53512540, "link": "https://stackoverflow.com/questions/53512540/convert-go-rune-to-string/53512677#53512677", "title": "Convert Go rune to string", "body": "<p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n\n<p><a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">String literals</a> </p>\n\n<p><a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\">Rune literals</a></p>\n\n<hr>\n\n<p>Use <code>string</code> raw literal back quotes, not <code>rune</code> literal single quotes. </p>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    s := `{\"selector:\"{\"Status\":\"open\"}\"}`\n    fmt.Printf(\"type %T: %s\", s, s)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/lGARb35VHTv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/lGARb35VHTv</a></p>\n\n<p>Output:</p>\n\n<pre><code>type string: {\"selector:\"{\"Status\":\"open\"}\"}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 6624408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688f923d54df2c3075c28dd68fac4164?s=128&d=identicon&r=PG&f=1", "display_name": "Harshitha C", "link": "https://stackoverflow.com/users/6624408/harshitha-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 3, "accepted_answer_id": 53512677, "answer_count": 1, "score": 0, "last_activity_date": 1543383777, "creation_date": 1543381832, "last_edit_date": 1543383569, "question_id": 53512540, "link": "https://stackoverflow.com/questions/53512540/convert-go-rune-to-string", "title": "Convert Go rune to string", "body": "<p>I am trying to convert <code>s := '{\"selector:\"{\"Status\":\"open\"}\"}'</code> to type <code>string</code>, as I need to pass this as an argument to a query using <code>GetQueryResult()</code>.</p>\n\n<p>I have tried <code>UnescapeString</code>, it only accepts string as argument:</p>\n\n<pre><code>fmt.Println(\"args \" ,html.UnescapeString(s)\n</code></pre>\n\n<p>but <code>s</code> is a Go <code>rune</code>.</p>\n"}, {"tags": ["google-app-engine", "go", "go-modules"], "answers": [{"comments": [{"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "reply_to_user": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "edited": false, "score": 0, "creation_date": 1543928943, "post_id": 53521597, "comment_id": 94088084, "body": "@junpayment How did you start the deployment that hit errors? With &#39;gcloud app deploy&#39;? If so, try setting those credentials before running &#39;gcloud app deploy&#39;."}], "tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": false, "score": 1, "last_activity_date": 1543414904, "creation_date": 1543414904, "answer_id": 53521597, "question_id": 53512443, "link": "https://stackoverflow.com/questions/53512443/how-to-import-private-repositories-on-gae-se-go-1-11-with-go-modules/53521597#53521597", "title": "How to import private repositories on GAE SE Go 1.11, with go modules?", "body": "<p>Send github credentials to go get:</p>\n\n<pre><code>git config credential.helper '!f() { sleep 1; echo \"username=${GIT_USER}\\npassword=${GIT_PASSWORD}\"; }; f'\n\nexport GIT_USER=github_user\nexport GIT_PASSWORD=github_password_or_token\n\ngo get github.com/foo/libpackage\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 2400477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b9b8b78e6c512179cef4c57e57d1873?s=128&d=identicon&r=PG", "display_name": "junpayment", "link": "https://stackoverflow.com/users/2400477/junpayment"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1543414904, "creation_date": 1543381308, "question_id": 53512443, "link": "https://stackoverflow.com/questions/53512443/how-to-import-private-repositories-on-gae-se-go-1-11-with-go-modules", "title": "How to import private repositories on GAE SE Go 1.11, with go modules?", "body": "<p>I have a go library package repository on github as a private repository.</p>\n\n<p>And I wrote a project like below that import the library package above.</p>\n\n<pre><code>package main\n\nimport \"github.com/foo/libpackage\"\n\nfunc main() {\n  :\n}\n</code></pre>\n\n<p>This is a directory hierarchy.</p>\n\n<pre><code>path/to/project\n  |- main.go\n  |- go.mod\n  `- go.sum\n</code></pre>\n\n<p>When deploying I got a error that cannot </p>\n\n<pre><code>go: github.com/foo/libpackage@v0.0.0-20181127123728-008fddddc190: git fetch -f origin refs/heads/*:refs/heads/* refs/tags/*:refs/tags/* in /go/pkg/mod/cache/vcs/25a80f32a1edc8de002fe3d4532abdf933bba77505314d051e4b644faa9cabf6: exit status 128:\n        fatal: could not read Username for 'https://github.com': terminal prompts disabled\n</code></pre>\n\n<p>It seems to get failed when go mod download.\nI think it cause GAE does not be permitted to access a private repository(This is convincing)</p>\n\n<p>Next I tried to run <code>go mod vendor</code> to download repositories into the vendor directory.</p>\n\n<pre><code>path/to/project\n  |- vendor/...\n  |- main.go\n  |- go.mod\n  `- go.sum\n</code></pre>\n\n<p>But I got a same error.</p>\n\n<p>help!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 0, "creation_date": 1543381115, "post_id": 53512341, "comment_id": 93894065, "body": "Yes, it should be in your <code>$GOPATH&#47;src</code> directory"}, {"owner": {"reputation": 16352, "user_id": 3788, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/cad0436b3e7120f39e4d0fda8c90b89f?s=128&d=identicon&r=PG", "display_name": "poundifdef", "link": "https://stackoverflow.com/users/3788/poundifdef"}, "reply_to_user": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 0, "creation_date": 1543381303, "post_id": 53512341, "comment_id": 93894122, "body": "It isn&#39;t, though!  poundifdef@rclone-dev:~$ pwd /home/poundifdef poundifdef@rclone-dev:~$ find ./ | grep ncw | grep cmd poundifdef@rclone-dev:~$"}, {"owner": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 1, "creation_date": 1543381503, "post_id": 53512341, "comment_id": 93894174, "body": "What is your <code>$GOPATH</code> ?"}, {"owner": {"reputation": 16352, "user_id": 3788, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/cad0436b3e7120f39e4d0fda8c90b89f?s=128&d=identicon&r=PG", "display_name": "poundifdef", "link": "https://stackoverflow.com/users/3788/poundifdef"}, "reply_to_user": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 0, "creation_date": 1543381539, "post_id": 53512341, "comment_id": 93894184, "body": "It is not defined. I just have the go binary in <code>&#47;home&#47;poundifdef&#47;go&#47;bin&#47;go</code>"}, {"owner": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 1, "creation_date": 1543382036, "post_id": 53512341, "comment_id": 93894324, "body": "What does <code>go env</code> show ?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543387968, "post_id": 53512341, "comment_id": 93896420, "body": "Please read How to Write Go Code and <i>stick</i> <i>to</i> <i>it</i>. There is no need to complicate things just because it can be made complicated."}], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1543394490, "post_id": 53514444, "comment_id": 93899445, "body": "Your answer is missing Go modules and builds outside of GOPATH."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543408543, "post_id": 53514444, "comment_id": 93907748, "body": "yes i have not added those two as i have not yet switch to go module, so i don t know the details well enough. For build outside gopath, in my understanding its the same as go mod"}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1543390960, "creation_date": 1543390960, "answer_id": 53514444, "question_id": 53512341, "link": "https://stackoverflow.com/questions/53512341/how-do-go-package-paths-work-when-the-directory-is-different/53514444#53514444", "title": "How do go package paths work when the directory is different?", "body": "<p>Golang has an internal mechanism to resolve import path.</p>\n\n<p>This mechanism relies on the existence of several variables on your computer, GOROOT, GOPATH and for old releases GO15VENDOREXPERIMENT.</p>\n\n<p>When the compiler meet a package path, it performs a look up with those paths</p>\n\n<ul>\n<li>GOROOT/src/[import path]</li>\n<li>GOPATH/src/[import path]</li>\n<li>cwd/vendor/[import path]</li>\n</ul>\n\n<p>The longest path wins and is selected for further processing.</p>\n\n<p>GOROOT is the path to the stdlib.\nGOPATH is the path to your local workspace.</p>\n\n<p>For all the details <a href=\"https://go.googlesource.com/proposal/+/master/design/25719-go15vendor.md\" rel=\"nofollow noreferrer\">https://go.googlesource.com/proposal/+/master/design/25719-go15vendor.md</a></p>\n\n<p>This all depends on the setup of your computer, so carefully check <code>go env</code> output.</p>\n"}, {"comments": [{"owner": {"reputation": 16352, "user_id": 3788, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/cad0436b3e7120f39e4d0fda8c90b89f?s=128&d=identicon&r=PG", "display_name": "poundifdef", "link": "https://stackoverflow.com/users/3788/poundifdef"}, "edited": false, "score": 0, "creation_date": 1543458041, "post_id": 53515571, "comment_id": 93930145, "body": "Ah, okay, this all makes a ton of sense. Also, now I know that the <code>GO111MODULE=on</code> env variable will enable this too. Thank you so much!"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1543395479, "creation_date": 1543395479, "answer_id": 53515571, "question_id": 53512341, "link": "https://stackoverflow.com/questions/53512341/how-do-go-package-paths-work-when-the-directory-is-different/53515571#53515571", "title": "How do go package paths work when the directory is different?", "body": "<p>github.com/ncw/rclone is a <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">module</a>, because it has a <a href=\"https://github.com/ncw/rclone/blob/master/go.mod\" rel=\"nofollow noreferrer\">file named <code>go.mod</code></a> at the repository root. Since you have <code>$GOPATH</code> unset, the experimental module feature is enabled. </p>\n\n<p>Where modules are placed in your filesystem is irrelevant. when constructing import paths, all directory names in the module are appended to the module name. The module name is defined in the first line of <code>go.mod</code>, here \"github.com/ncw/rclone\". So the package in <code>./cmd</code> has the import path <code>github.com/ncw/rclone/cmd</code>.</p>\n\n<p>Commands such as <code>go build</code>, <code>go install</code>, <code>go test</code>, etc. download all other required packages automatically  to <code>$HOME/go/pkg/mod</code>, unless the <code>-mod=vendor</code> flag is specified, in which case the sources in <code>vendor</code> are used.</p>\n"}], "owner": {"reputation": 16352, "user_id": 3788, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/cad0436b3e7120f39e4d0fda8c90b89f?s=128&d=identicon&r=PG", "display_name": "poundifdef", "link": "https://stackoverflow.com/users/3788/poundifdef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 53515571, "answer_count": 2, "score": 0, "last_activity_date": 1543395479, "creation_date": 1543380517, "question_id": 53512341, "link": "https://stackoverflow.com/questions/53512341/how-do-go-package-paths-work-when-the-directory-is-different", "title": "How do go package paths work when the directory is different?", "body": "<p>I am doing some light hacking on the <a href=\"https://github.com/ncw/rclone\" rel=\"nofollow noreferrer\">rclone</a> project, and I'm somewhat new to go. I have cloned the repository in my home directory, <code>/home/poundifdef/rclone</code>.</p>\n\n<p>When I look at the file, <code>rclone.go</code>, in the top-level directory, I see the following import statement:</p>\n\n<pre><code>package main\n\nimport (\n  _ \"github.com/ncw/rclone/backend/all\"\n    \"github.com/ncw/rclone/cmd\"\n  _ \"github.com/ncw/rclone/cmd/all\"\n)\n</code></pre>\n\n<p>My question is this: nowhere in this code, as far as I can tell, do we specify that the <code>github.com/ncs/rclone/*</code> packages are supposed to refer to the local versions of these directories. Nowhere in my filesystem have I used a directory called <code>github.com/ncw</code>. And yet, running <code>go run rclone.go</code> is able to execute this code.</p>\n\n<p>Where is the path <code>github.com/ncw/rclone</code> being mapped to my local directory, given these packages, as named, do not exist?</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543417783, "post_id": 53511478, "comment_id": 93913631, "body": "It&#39;s always unsafe, as indicated by the use of the <code>unsafe</code> package, but you still need to use it to convert types from C. You have the <code>bufferSize</code> value right there though, so what do you mean that you can&#39;t specify it?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543421927, "post_id": 53511478, "comment_id": 93916527, "body": "I don&#39;t know if you built this on Linux or other Unix-like, but naming your function <code>read</code> is going to conflict with the system C library. Yours will take priority but other code that wants to <code>read</code> things will likely call your function. With the wrong arguments. Chaos and destruction will ensue."}, {"owner": {"reputation": 113, "user_id": 10714700, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D79wNT8uyCw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j-x5f7L6Mf0H8dzmBj6ICUts0hMg/mo/photo.jpg?sz=128", "display_name": "Junghoon Jang", "link": "https://stackoverflow.com/users/10714700/junghoon-jang"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543459297, "post_id": 53511478, "comment_id": 93930374, "body": "@ZanLynx I&#39;m working on MAC, so it is Unix. But the code above is just a sample, I didn&#39;t consider about that. The name of the function in real code is not &#39;read&#39;. Thank you for your comment."}, {"owner": {"reputation": 113, "user_id": 10714700, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D79wNT8uyCw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j-x5f7L6Mf0H8dzmBj6ICUts0hMg/mo/photo.jpg?sz=128", "display_name": "Junghoon Jang", "link": "https://stackoverflow.com/users/10714700/junghoon-jang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543459533, "post_id": 53511478, "comment_id": 93930430, "body": "@JimB I mean I cannot specify the size of buffer when I do <code>n, _ := f.Read(buff)</code>. Usually, in C code, we can put the size of buffer as a parameter in the read functions."}], "answers": [{"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543421763, "post_id": 53522987, "comment_id": 93916432, "body": "So just to clarify: You are casting the <code>buffer</code> pointer into a Go pointer to a byte array of size <code>1 &lt;&lt; 30</code> (big but not the maximum, just a convenient shift size, and a constant) and then creating a slice of that imaginary buffer."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543422642, "post_id": 53522987, "comment_id": 93916931, "body": "@ZanLynx: Exactly. &quot;The length is part of the [Go] array&#39;s type; it must evaluate to a non-negative [compile-time] constant representable by a value of type int.&quot;: <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">Array types, The Go Programming Language Specification</a>. So we need some trickery. Array length constant <code>1 &lt;&lt; 30</code> is a simple way of describing a very large Go <code>byte</code> array that is handled by 32-bit <code>int</code> implementations."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1543423467, "last_edit_date": 1543423467, "creation_date": 1543419233, "answer_id": 53522987, "question_id": 53511478, "link": "https://stackoverflow.com/questions/53511478/is-it-safe-to-convert-c-uint8-t-to-uint8/53522987#53522987", "title": "Is it safe to convert *C.uint8_t to []uint8?", "body": "<p>Your code is wrong. </p>\n\n<p>A Go slice is implemented as a Go <code>struct</code>:</p>\n\n<pre><code>type slice struct {\n    array unsafe.Pointer\n    len   int\n    cap   int\n}\n</code></pre>\n\n<p>Your values for <code>slice.len</code> and <code>slice.cap</code> are undefined.</p>\n\n<hr>\n\n<blockquote>\n  <p>Questions seeking debugging help (\"why isn't this code working?\") must\n  include the desired behavior, a specific problem or error and the\n  shortest code necessary to reproduce it in the question itself.</p>\n</blockquote>\n\n<p>Your code fragments don't compile and are incomplete.</p>\n\n<hr>\n\n<p><code>buf</code> is a Go <code>byte</code> slice to satisfy <code>io.Reader</code>.</p>\n\n<pre><code>type Reader interface {\n    Read(p []byte) (n int, err error)\n}\n\nbuffer *C.uint8_t\nbufferSize C.int\n\nbuf := (*[1 &lt;&lt; 30]byte)(unsafe.Pointer(buffer))[:bufferSize:bufferSize]\nn, err := f.Read(buf)\n</code></pre>\n\n<hr>\n\n<p>Here is my solution in reproducible form.</p>\n\n<p><code>main.c</code>:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define BUFFER_SIZE 16384\n\nint read_go(uint8_t* buffer, int bufferSize);\n\nvoid read_buf() {\n    uint8_t* buffer = (uint8_t*)malloc(BUFFER_SIZE+1);\n    buffer[BUFFER_SIZE]='\\0';\n    int n = read_go(buffer, BUFFER_SIZE);\n    if (n &lt; 0) {\n        printf(\"read_go: error: %d\\n\", n);\n        n = 0;\n    }\n    if (n &gt; BUFFER_SIZE) {\n        n = BUFFER_SIZE;\n    }\n    buffer[n] = '\\0';\n\n    // do something with buffer\n    int width = n;\n    printf(\"%d\\n\", width);\n    if (width &gt; 16) {\n        width = 16;\n    }\n    for (int i = 0; i &lt; width; i++)     {\n        printf(\"%02X\", buffer[i]);\n    }\n    printf(\"\\n\");\n    for (int i = 0; i &lt; width; i++)     {\n        printf(\"%-2c\", buffer[i]);\n    }\n    printf(\"\\n\");\n\n    free(buffer);\n}\n\nint main(int argc, char *argv[]) {\n    read_buf();\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p><code>read.go</code>:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdint.h&gt;\n*/\nimport \"C\"\n\nimport (\n    \"os\"\n    \"unsafe\"\n)\n\n//export read_go\nfunc read_go(buffer *C.uint8_t, bufferSize C.int) C.int {\n    f, err := os.Open(\"filename\")\n    if err != nil {\n        return C.int(-1)\n    }\n    defer f.Close()\n\n    buf := (*[1 &lt;&lt; 30]byte)(unsafe.Pointer(buffer))[:bufferSize:bufferSize]\n    n, err := f.Read(buf)\n    if err != nil {\n        return C.int(-1)\n    }\n    return C.int(n)\n}\n\nfunc main() {}\n</code></pre>\n\n<p>Output (Linux):</p>\n\n<pre><code>$ cat filename\nfiledata 01234567890\n$ export LD_LIBRARY_PATH=./:$LD_LIBRARY_PATH\n$ go build -a -o libread.so -buildmode=c-shared read.go\n$ gcc main.c libread.so -o read &amp;&amp; ./read\n21\n66696C65646174612030313233343536\nf i l e d a t a   0 1 2 3 4 5 6 \n$ \n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10714700, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D79wNT8uyCw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j-x5f7L6Mf0H8dzmBj6ICUts0hMg/mo/photo.jpg?sz=128", "display_name": "Junghoon Jang", "link": "https://stackoverflow.com/users/10714700/junghoon-jang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 1, "accepted_answer_id": 53522987, "answer_count": 1, "score": 4, "last_activity_date": 1543459774, "creation_date": 1543374192, "last_edit_date": 1543459774, "question_id": 53511478, "link": "https://stackoverflow.com/questions/53511478/is-it-safe-to-convert-c-uint8-t-to-uint8", "title": "Is it safe to convert *C.uint8_t to []uint8?", "body": "<p>I'm trying to pass uint8_t array from C code to Go, then read some bytes from file and store them into this array in Go code.</p>\n\n<p>Sample code is here.</p>\n\n<p>main.c :</p>\n\n<pre><code>#define BUFFER_SIZE 16384\n\nint read_go(uint8_t* buffer, int bufferSize);\n\nvoid read_buf() {\n     uint8_t* buffer = (uint8_t*)malloc(BUFFER_SIZE);\n     read_go(buffer, BUFFER_SIZE)\n\n     // do something with buffer\n\n     free(buffer)\n}\n</code></pre>\n\n<p>read.go :</p>\n\n<pre><code> /*\n #include \"main.c\"\n\n extern int read_go(uint8_t* buffer, int bufferSize);\n */\n import \"C\"\n\n //export read_go\n func read_go(buffer *C.uint8_t, bufferSize C.int) C.int {\n      f, _ := os.Open(\"filename\")\n      defer f.close()\n\n      buff := *(*[]uint8)(unsafe.Pointer(&amp;buffer))\n      n, _ := f.Read(buff)\n\n      return C.int(n)\n }\n</code></pre>\n\n<p>It works well, but I'm worrying about segmentation fault. Because I cannot specify the buffer size at Read function unlike fread function of C.</p>\n\n<p>I know that Read function reads bytes from file as much as len(buff). But I cannot guarantee that len(buff) is the same as bufferSize.</p>\n\n<p>Is it safe to convert *C.uint8_t to []uint8?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8143, "user_id": 1004369, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b7e385af406a6422cea353066baf068a?s=128&d=identicon&r=PG", "display_name": "r.sendecky", "link": "https://stackoverflow.com/users/1004369/r-sendecky"}, "edited": false, "score": 0, "creation_date": 1543374994, "post_id": 53511232, "comment_id": 93892573, "body": "Why do we need to do this <code>bvx[:cap(bvx)]</code> on the original slice? <code>bvx = bvx[:binary.PutUvarint(bvx, uint64(x))]</code> works just as well..."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 8143, "user_id": 1004369, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b7e385af406a6422cea353066baf068a?s=128&d=identicon&r=PG", "display_name": "r.sendecky", "link": "https://stackoverflow.com/users/1004369/r-sendecky"}, "edited": false, "score": 0, "creation_date": 1543385036, "post_id": 53511232, "comment_id": 93895249, "body": "@r.sendecky: Because my code works all of the time and your code only works some of the time. For example, your code panics, mine doesn&#39;t: <a href=\"https://play.golang.org/p/sx1k7hA6OqN\" rel=\"nofollow noreferrer\">play.golang.org/p/sx1k7hA6OqN</a>"}, {"owner": {"reputation": 8143, "user_id": 1004369, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b7e385af406a6422cea353066baf068a?s=128&d=identicon&r=PG", "display_name": "r.sendecky", "link": "https://stackoverflow.com/users/1004369/r-sendecky"}, "edited": false, "score": 0, "creation_date": 1543389385, "post_id": 53511232, "comment_id": 93897050, "body": "I understand that your code works I am just trying to understand why we need the <code>cap()</code> there. &quot;Because my code works and yours does not&quot; is not really an answer. I mark it as resolved anyway. But I still would like to know why if it is not difficult to explain..."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1543385247, "last_edit_date": 1543385247, "creation_date": 1543372199, "answer_id": 53511232, "question_id": 53510935, "link": "https://stackoverflow.com/questions/53510935/go-binary-encoding-variant-vs-fixed-slice-length/53511232#53511232", "title": "Go binary encoding variant vs fixed slice length", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow noreferrer\">Package binary</a></p>\n\n<pre><code>import \"encoding/binary\"\n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/encoding/binary/#PutUvarint\" rel=\"nofollow noreferrer\">func PutUvarint</a></p>\n\n<pre><code>func PutUvarint(buf []byte, x uint64) int\n</code></pre>\n  \n  <p>PutUvarint encodes a uint64 into buf and returns the number of bytes\n  written. If the buffer is too small, PutUvarint will panic.</p>\n</blockquote>\n\n<hr>\n\n<p>Fix your code:</p>\n\n<pre><code>bvx := make([]byte, binary.MaxVarintLen64)\nbvy := make([]byte, binary.MaxVarintLen64)\nbvx = bvx[:binary.PutUvarint(bvx[:cap(bvx)], uint64(x))]\nbvy = bvy[:binary.PutUvarint(bvy[:cap(bvy)], uint64(y))]\n</code></pre>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    x := 16\n    y := 106547\n\n    fmt.Println(x)\n    fmt.Println(y)\n\n    // Variant\n    bvx := make([]byte, binary.MaxVarintLen64)\n    bvy := make([]byte, binary.MaxVarintLen64)\n\n    bvx = bvx[:binary.PutUvarint(bvx[:cap(bvx)], uint64(x))]\n    bvy = bvy[:binary.PutUvarint(bvy[:cap(bvy)], uint64(y))]\n\n    fmt.Println(\"Variant bytes written x: \", len(bvx))\n    fmt.Println(\"Variant bytes written y: \", len(bvy))\n\n    fmt.Println(bvx)\n    fmt.Println(bvy)\n\n    fmt.Println(\"bvx length: \", len(bvx))\n    fmt.Println(\"bvy length: \", len(bvy))\n\n    // Fixed\n    bfx := make([]byte, 8)\n    bfy := make([]byte, 8)\n\n    binary.LittleEndian.PutUint64(bfx, uint64(x))\n    binary.LittleEndian.PutUint64(bfy, uint64(y))\n\n    fmt.Println(bfx)\n    fmt.Println(bfy)\n\n    fmt.Println(\"bfx length: \", len(bfx))\n    fmt.Println(\"bfy length: \", len(bfy))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/XN46KafMY23\" rel=\"nofollow noreferrer\">https://play.golang.org/p/XN46KafMY23</a></p>\n\n<p>Output:</p>\n\n<pre><code>16\n106547\nVariant bytes written x:  1\nVariant bytes written y:  3\n[16]\n[179 192 6]\nbvx length:  1\nbvy length:  3\n[16 0 0 0 0 0 0 0]\n[51 160 1 0 0 0 0 0]\nbfx length:  8\nbfy length:  8\n</code></pre>\n"}], "owner": {"reputation": 8143, "user_id": 1004369, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b7e385af406a6422cea353066baf068a?s=128&d=identicon&r=PG", "display_name": "r.sendecky", "link": "https://stackoverflow.com/users/1004369/r-sendecky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 1, "accepted_answer_id": 53511232, "answer_count": 1, "score": 2, "last_activity_date": 1543389165, "creation_date": 1543370002, "question_id": 53510935, "link": "https://stackoverflow.com/questions/53510935/go-binary-encoding-variant-vs-fixed-slice-length", "title": "Go binary encoding variant vs fixed slice length", "body": "<p>I need to encode integer keys as byte slices for a KV database.\nI want to make the encoding smaller and cut the zero padding.\nI thought the variant encoding from the binary package would be the way to go.</p>\n\n<p>But in both cases, variant and fixed, the byte slice length is the same.\nJust different bits arrangement since first bit is used as a flag.\nI assumed the variant encoding would cut the \"extra fat\". No.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    x := 16\n    y := 106547\n\n    fmt.Println(x)\n    fmt.Println(y)\n\n    // Variant\n    bvx := make([]byte, 8)\n    bvy := make([]byte, 8)\n\n    xbts := binary.PutUvarint(bvx, uint64(x))\n    ybts := binary.PutUvarint(bvy, uint64(y))\n\n    fmt.Println(\"Variant bytes written x: \", xbts)\n    fmt.Println(\"Variant bytes written y: \", ybts)\n\n    fmt.Println(bvx)\n    fmt.Println(bvy)\n\n    fmt.Println(\"bvx length: \", len(bvx))\n    fmt.Println(\"bvy length: \", len(bvy))\n\n    // Fixed\n    bfx := make([]byte, 8)\n    bfy := make([]byte, 8)\n\n    binary.LittleEndian.PutUint64(bfx, uint64(x))\n    binary.LittleEndian.PutUint64(bfy, uint64(y))\n\n    fmt.Println(bfx)\n    fmt.Println(bfy)\n\n    fmt.Println(\"bfx length: \", len(bfx))\n    fmt.Println(\"bfy length: \", len(bfy))\n\n}\n</code></pre>\n\n<p>My question is. Do I have to splice the byte slice manually with variant encoding to get rid of the extra bytes?\nSince put <code>PutUvariant</code> returns the number of bytes written, I can just splice the byte slice.</p>\n\n<p>Is this the right way to do it?\nIf not, what is the correct way to make the slices smaller?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 1176, "user_id": 1206899, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3211652c3304de4fbc2559549b151fcc?s=128&d=identicon&r=PG", "display_name": "user1206899", "link": "https://stackoverflow.com/users/1206899/user1206899"}, "edited": false, "score": 0, "creation_date": 1543370166, "post_id": 53510923, "comment_id": 93891568, "body": "But I can&#39;t if they are buffered?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1543370426, "last_edit_date": 1543370426, "creation_date": 1543369968, "answer_id": 53510923, "question_id": 53510858, "link": "https://stackoverflow.com/questions/53510858/can-i-rely-on-the-order-of-select-wake-ups-based-on-sending-order/53510923#53510923", "title": "Can I rely on the order of select wake ups based on sending order?", "body": "<p>Yes, you can rely on the order because channel <code>a</code> is unbuffered.</p>\n\n<p>Communication on an unbuffered channel succeeds only when the sender and receiver are ready.  The sender does not execute past the statement <code>a &lt;- x</code> until the value was received. It follows from this that the values are received in send order.</p>\n\n<p>The order is not guaranteed if channel <code>a</code> is buffered. The receiver might not execute until both values are sent. When the receiver does execute after the values are sent, there's no guarantee on which branch of the select will execute first.</p>\n"}], "owner": {"reputation": 1176, "user_id": 1206899, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3211652c3304de4fbc2559549b151fcc?s=128&d=identicon&r=PG", "display_name": "user1206899", "link": "https://stackoverflow.com/users/1206899/user1206899"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 53510923, "answer_count": 1, "score": 0, "last_activity_date": 1543370426, "creation_date": 1543369553, "last_edit_date": 1543369989, "question_id": 53510858, "link": "https://stackoverflow.com/questions/53510858/can-i-rely-on-the-order-of-select-wake-ups-based-on-sending-order", "title": "Can I rely on the order of select wake ups based on sending order?", "body": "<p>Imagine a code pattern like the following:</p>\n\n<pre><code>var a chan T = make(chan T)\nvar b chan Q = make(chan Q)\n\n//consumer goroutine\nfor {\n   select {\n   case &lt;-a:\n       //...\n   case &lt;-b:\n       //...\n   }\n}\n\n//producer goroutine\n...\na &lt;- x\nb &lt;- y\n...\n</code></pre>\n\n<p>Is it guaranteed that we can always retrieve x from case: &lt;-a BEFORE y from case :&lt;-b provided that there is only one producer?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1543368309, "creation_date": 1543368309, "answer_id": 53510714, "question_id": 53510564, "link": "https://stackoverflow.com/questions/53510564/how-to-pass-string-as-parameter-to-golang-pointer-receiver-function/53510714#53510714", "title": "How to pass string as parameter to Golang pointer receiver function?", "body": "<p>You can not print <code>changeAuthor</code> while it return nothing.</p>\n\n<pre><code>book.changeAuthor(\"arulnathan\")\nfmt.Println(book.author)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 543, "user_id": 1929013, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11f5a7ee410a95d7fca8faf6dd7398f4?s=128&d=identicon&r=PG", "display_name": "cannot_mutably_borrow", "link": "https://stackoverflow.com/users/1929013/cannot-mutably-borrow"}, "is_accepted": false, "score": 3, "last_activity_date": 1543372969, "creation_date": 1543372969, "answer_id": 53511326, "question_id": 53510564, "link": "https://stackoverflow.com/questions/53510564/how-to-pass-string-as-parameter-to-golang-pointer-receiver-function/53511326#53511326", "title": "How to pass string as parameter to Golang pointer receiver function?", "body": "<pre><code>func (b *book) changeAuthor(author string) {\n   b.author = author\n}\n</code></pre>\n\n<p><code>changeAuthor</code> does not have a return type. You cannot use <code>Println</code> or any other function/method which expects a parameter in your case.</p>\n\n<p>To solve this, first you can change your author as <code>book.changeAuthor(\"arulnathan\")</code> and the print <code>book.author</code>.</p>\n"}], "owner": {"reputation": 412, "user_id": 2928040, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VTGvn.png?s=128&g=1", "display_name": "Arockia", "link": "https://stackoverflow.com/users/2928040/arockia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1338, "favorite_count": 0, "closed_date": 1543422564, "answer_count": 2, "score": -3, "last_activity_date": 1543388672, "creation_date": 1543366978, "last_edit_date": 1543388672, "question_id": 53510564, "link": "https://stackoverflow.com/questions/53510564/how-to-pass-string-as-parameter-to-golang-pointer-receiver-function", "closed_reason": "Duplicate", "title": "How to pass string as parameter to Golang pointer receiver function?", "body": "<p>I am trying one simple Go struct with value and pointer receiver functions. I am not able to pass one string as an argument to pointer receiver function to modify the struct data. Can anyone please help on this?</p>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n)\n\ntype book struct {\n    author   string\n    name     string\n    category string\n    price    int16\n}\n\nfunc (b book) greet() string {\n    return \"Welcome \" + b.author\n}\n\nfunc (b *book) changeAuthor(author string) {\n   b.author = author\n}\n\nfunc main() {\n    book := book{author: \"Arockia\",\n        name:     \"Python shortcuts\",\n        category: \"IT\",\n        price:    1500}\n    fmt.Println(book.author)\n    fmt.Println(book.greet())\n    fmt.Println(book.changeAuthor(\"arulnathan\"))\n    fmt.Println(book.author)\n}\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>.\\struct_sample.go:29:31: book.changeAuthor(string(\"arulnathan\")) used as value</p>\n</blockquote>\n"}, {"tags": ["go", "dns"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543397424, "post_id": 53510367, "comment_id": 93901139, "body": "There is a proxy that you have (or want) to tunnel through to reach the internet, but you can&#39;t resolve the proxy&#39;s name without also tunneling DNS through it? This sounds like chicken-egg to me."}, {"owner": {"reputation": 1915, "user_id": 1902896, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0839a5f542caa87bf9283ea25997006a?s=128&d=identicon&r=PG", "display_name": "wheeler", "link": "https://stackoverflow.com/users/1902896/wheeler"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543411586, "post_id": 53510367, "comment_id": 93909598, "body": "This isn&#39;t for resolving the proxy&#39;s name, this is for resolving names of things that aren&#39;t on our network."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543414403, "post_id": 53510367, "comment_id": 93911483, "body": "The proxy does that though. If I proxy a request for stackoverflow.com, my host never resolves that name. It just sends <code>CONNECT https:&#47;&#47;stackoverflow.com&#47; HTTP&#47;1.1</code> to the proxy."}, {"owner": {"reputation": 1915, "user_id": 1902896, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0839a5f542caa87bf9283ea25997006a?s=128&d=identicon&r=PG", "display_name": "wheeler", "link": "https://stackoverflow.com/users/1902896/wheeler"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543422031, "post_id": 53510367, "comment_id": 93916591, "body": "I know the proxy does that, this is part of a multi-application suite that makes a non-transparent proxy, transparent. As such, i need to do some sort of DNS resolution of addresses that are not on our network."}], "owner": {"reputation": 1915, "user_id": 1902896, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0839a5f542caa87bf9283ea25997006a?s=128&d=identicon&r=PG", "display_name": "wheeler", "link": "https://stackoverflow.com/users/1902896/wheeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543365216, "creation_date": 1543365216, "question_id": 53510367, "link": "https://stackoverflow.com/questions/53510367/set-dial-function-of-dialer", "title": "Set Dial function of Dialer", "body": "<p>I am trying to get DNS requests to tunnel through my company's proxy by using the HTTP CONNECT method. </p>\n\n<p>The <a href=\"https://github.com/miekg/dns\" rel=\"nofollow noreferrer\">library</a> I am using to make the DNS requests supports setting a custom <code>net.Dialer</code> on an instance of <a href=\"https://github.com/miekg/dns/blob/master/client.go#L30-L45\" rel=\"nofollow noreferrer\"><code>dns.Client</code></a>. I found <a href=\"https://github.com/mwitkow/go-http-dialer\" rel=\"nofollow noreferrer\">another library</a> that claims to act as a drop-in replacement for <code>net.Dialer</code> that supports initiating TCP connections through a proxy using the HTTP CONNECT method. </p>\n\n<p>However, I can't figure out how to get this to work with these two libraries.</p>\n\n<p>I have tried setting the <code>Dialer</code> field of <code>dns.Client</code>, but it complains about incompatible types:</p>\n\n<pre><code>client := &amp;dns.Client{\n    Net:     \"tcp\",\n    Timeout: time.Duration(forwarder.Timeout) * time.Second,\n}\n\nif forwarder.Proxy != nil {\n    client.Dialer = http_dialer.New(forwarder.Proxy, http_dialer.WithDialer(client.Dialer))\n} \n</code></pre>\n\n<p>Yields:</p>\n\n<pre><code>cannot use http_dialer.New(forwarder.Proxy, http_dialer.WithDialer(client.Dialer)) (type *http_dialer.HttpTunnel) as type *net.Dialer in assignment\n</code></pre>\n\n<p>So I tried casting it:</p>\n\n<pre><code>client := &amp;dns.Client{\n    Net:     \"tcp\",\n    Timeout: time.Duration(forwarder.Timeout) * time.Second,\n}\n\nif forwarder.Proxy != nil {\n    client.Dialer = net.Dialer(*http_dialer.New(forwarder.Proxy, http_dialer.WithDialer(client.Dialer)))\n}\n</code></pre>\n\n<p>But that yields:</p>\n\n<pre><code>cannot convert *http_dialer.New(forwarder.Proxy, http_dialer.WithDialer(client.Dialer)) (type http_dialer.HttpTunnel) to type net.Dialer\n</code></pre>\n\n<p>Finally, I tried setting the <code>Dial</code> function of <code>dns.Client.Dialer</code> to the <code>Dial</code> function in the <code>http_dialer.HttpTunnel</code> returned by <code>http_dialer#New</code>:</p>\n\n<pre><code>client := &amp;dns.Client{\n    Net:     \"tcp\",\n    Timeout: time.Duration(forwarder.Timeout) * time.Second,\n}\n\n\nif forwarder.Proxy != nil {\n    client.Dialer.Dial = http_dialer.New(forwarder.Proxy, http_dialer.WithDialer(client.Dialer)).Dial\n}\n</code></pre>\n\n<p>But that yielded:</p>\n\n<pre><code>cannot assign to client.Dialer.Dial\n</code></pre>\n\n<p>So I how do I set the <code>Dialer</code> of my DNS client?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1543367514, "post_id": 53510337, "comment_id": 93890980, "body": "The same way like any other function - invoke it."}, {"owner": {"reputation": 29, "user_id": 9868976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f303aa9f9c5d5149ca0f98415fef5d28?s=128&d=identicon&r=PG&f=1", "display_name": "DTT", "link": "https://stackoverflow.com/users/9868976/dtt"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543392118, "post_id": 53510337, "comment_id": 93898313, "body": "Sorry, I did mean unit test. Basically I would like to use <code>httptest.Server</code> in the <code>Server</code>struct but this is not possible. Is there a workaround?"}, {"owner": {"reputation": 1201, "user_id": 5097493, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/95b290a191545edb4077adfaab317f1a?s=128&d=identicon&r=PG&f=1", "display_name": "RuNpiXelruN", "link": "https://stackoverflow.com/users/5097493/runpixelrun"}, "edited": false, "score": 0, "creation_date": 1543821509, "post_id": 53510337, "comment_id": 94041362, "body": "Hi @DTT, have you figured out a way yet? I&#39;m happy to explain if you need some help still"}, {"owner": {"reputation": 29, "user_id": 9868976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f303aa9f9c5d5149ca0f98415fef5d28?s=128&d=identicon&r=PG&f=1", "display_name": "DTT", "link": "https://stackoverflow.com/users/9868976/dtt"}, "edited": false, "score": 0, "creation_date": 1543920124, "post_id": 53510337, "comment_id": 94083208, "body": "Thanks RuNpiXelruN for asking. Yes I was able to test my handler using  <code>httptest.NewRequest</code> and <code>httptest.NewRecorder</code>. But would be happy to know if the handler can be tested also with <code>httptest.Server</code>"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 9868976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f303aa9f9c5d5149ca0f98415fef5d28?s=128&d=identicon&r=PG&f=1", "display_name": "DTT", "link": "https://stackoverflow.com/users/9868976/dtt"}, "is_accepted": false, "score": 0, "last_activity_date": 1543920794, "creation_date": 1543920794, "answer_id": 53611311, "question_id": 53510337, "link": "https://stackoverflow.com/questions/53510337/how-can-i-unit-test-http-handler-embedded-in-a-struct/53611311#53611311", "title": "How can I unit test http handler embedded in a struct?", "body": "<p>The handler above </p>\n\n<pre><code>func (s *Server) methodHandler(w http.ResponseWriter, req *Request, reqParams Params) {\n.....\n}\n</code></pre>\n\n<p>can be tested by following these steps</p>\n\n<pre><code>handler := http.HandlerFunc(s.methodHandler)\n\nreq := httptest.NewRequest(...) \n\nw := httptest.NewRecorder()\n\nhandler(w, req)\n\nresp := w.Result()\n\nassert.Equal(t, expected, resp) \n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9868976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f303aa9f9c5d5149ca0f98415fef5d28?s=128&d=identicon&r=PG&f=1", "display_name": "DTT", "link": "https://stackoverflow.com/users/9868976/dtt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543920794, "creation_date": 1543365003, "last_edit_date": 1543391713, "question_id": 53510337, "link": "https://stackoverflow.com/questions/53510337/how-can-i-unit-test-http-handler-embedded-in-a-struct", "title": "How can I unit test http handler embedded in a struct?", "body": "<p>I have the following struct </p>\n\n<pre><code>type Server struct {\n        *http.Server\n        chain      core.Blockchainer\n        coreServer *network.Server\n    }\n</code></pre>\n\n<p>with its corresponding <code>handler</code></p>\n\n<pre><code>func (s *Server) methodHandler(w http.ResponseWriter, req *Request, reqParams Params) {\n.....\n}\n</code></pre>\n\n<p>How can I unit test my <code>handler</code>?</p>\n"}, {"tags": ["go", "google-cloud-platform"], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 3165014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3EXu.png?s=128&g=1", "display_name": "sox with Monica", "link": "https://stackoverflow.com/users/3165014/sox-with-monica"}, "edited": false, "score": 0, "creation_date": 1616600541, "post_id": 60402593, "comment_id": 118054738, "body": "&quot;your pkg is separated&quot;: What does &quot;separated&quot; mean?"}], "tags": [], "owner": {"reputation": 179, "user_id": 9180822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ff9c6e3467360f788da07ec2de7392?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed M", "link": "https://stackoverflow.com/users/9180822/hamed-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1616772789, "last_edit_date": 1616772789, "creation_date": 1582662218, "answer_id": 60402593, "question_id": 53509843, "link": "https://stackoverflow.com/questions/53509843/why-do-build-constraints-exclude-all-go-files-in-users-rpurusho-go-src-google/60402593#60402593", "title": "Why do build constraints exclude all Go files in &#39;/Users/rpurusho/go/src/google.golang.org/api/compute/v1&#39;?", "body": "<p>There are some reasons why that can occur for you:</p>\n<ol>\n<li>simply your library is empty or your download process has been interrupted</li>\n<li>Maybe your pkg is separated</li>\n<li>Can be the compiler problem which u can find out <a href=\"https://github.com/golang/go/issues/24068\" rel=\"nofollow noreferrer\">here</a></li>\n</ol>\n"}], "owner": {"reputation": 468, "user_id": 6105932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AIY7t.jpg?s=128&g=1", "display_name": "Rajkumar Purushothaman", "link": "https://stackoverflow.com/users/6105932/rajkumar-purushothaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2026, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1616772789, "creation_date": 1543361453, "last_edit_date": 1543388743, "question_id": 53509843, "link": "https://stackoverflow.com/questions/53509843/why-do-build-constraints-exclude-all-go-files-in-users-rpurusho-go-src-google", "title": "Why do build constraints exclude all Go files in &#39;/Users/rpurusho/go/src/google.golang.org/api/compute/v1&#39;?", "body": "<p>I am trying to write a program in Go and I see the above error when I try to import a library from google.golang.org/api/compute/v1</p>\n\n<p>Given below is the code snippet..</p>\n\n<pre><code>package main\n\nimport (\n\n    \"log\"\n    \"fmt\"\n    \"context\"\n\n    \"cloud.google.com/go/storage\"\n    \"google.golang.org/api/iterator\"\n    \"google.golang.org/api/option\"\n\n    _ \"google.golang.org/api/compute/v1\"\n\n)\n</code></pre>\n\n<p>Does anyone know what this issue might be?</p>\n"}, {"tags": ["pointers", "go", "receiver"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1543355297, "post_id": 53508511, "comment_id": 93887244, "body": "&quot;Value receiver&quot; means <code>add</code> receives <i>a copy of the contents</i> of r, not a pointer to r. Internal to <code>add</code>, <code>r.a</code> is replaced with an updated slice value that points to different memory that includes the new <code>2</code>, but nothing changes in <code>main</code>&#39;s copy of <code>r</code>. When slice operations like this <i>do</i> work, like when <code>Read</code> saves data into a byte slice, it&#39;s because the two copies of a slice already pointed to the same memory, and the slice-modifying operation just changed that already-shared memory. This introduction to how slices work might help: <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1543355501, "post_id": 53508511, "comment_id": 93887311, "body": "For other related reading, Russ Cox wrote <a href=\"https://research.swtch.com/godata\" rel=\"nofollow noreferrer\">a post about how slices work</a> you may find helpful and I answered <a href=\"https://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values/23551970\">a question about pointers and values</a>."}, {"owner": {"reputation": 11, "user_id": 7152770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eb6af8786d056d5dfdafa9258bb383?s=128&d=identicon&r=PG&f=1", "display_name": "zhuang", "link": "https://stackoverflow.com/users/7152770/zhuang"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1543359788, "post_id": 53508511, "comment_id": 93889020, "body": "@twotwotwo Thanks very much. This introduction of slice is really awesome <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a>. The concept of sliceHeader makes things clear."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1543360849, "post_id": 53508511, "comment_id": 93889326, "body": "Great, glad I could help!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7152770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eb6af8786d056d5dfdafa9258bb383?s=128&d=identicon&r=PG&f=1", "display_name": "zhuang", "link": "https://stackoverflow.com/users/7152770/zhuang"}, "edited": false, "score": 0, "creation_date": 1543355873, "post_id": 53508737, "comment_id": 93887480, "body": "Thanks for the detailed answer. My key point is that why an update to <code>b</code> (which is a map) can be reflected in the output, while an update to <code>a</code> (which is a slice) is ignored. I think <code>r.b</code> is a pointer to the underlying map data, and <code>r.a</code> is also a pointer to the underlying slice data. Please correct me."}, {"owner": {"reputation": 777, "user_id": 4809932, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/83a7z.png?s=128&g=1", "display_name": "bajro", "link": "https://stackoverflow.com/users/4809932/bajro"}, "reply_to_user": {"reputation": 11, "user_id": 7152770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eb6af8786d056d5dfdafa9258bb383?s=128&d=identicon&r=PG&f=1", "display_name": "zhuang", "link": "https://stackoverflow.com/users/7152770/zhuang"}, "edited": false, "score": 0, "creation_date": 1543356992, "post_id": 53508737, "comment_id": 93887958, "body": "According to the golang language specification, a value receiver method operates on a copy of the original struct. In your case, the <code>add()</code> method copies your struct <code>r</code>, appends <code>2</code> to <code>r.a</code> and also adds <code>2</code> to the key <code>2</code> in the map of <code>r.b</code>. The key here is, that the reference (i.e. pointer) of the initialized map is copied to the newly created struct as your <code>add()</code> method is a value receiver. So at the end, after calling <code>add()</code> on <code>r</code>, it creates a new struct (by copying the old one) but copies the reference of the initialized map with it. Therefore, your code behaves like that."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "reply_to_user": {"reputation": 11, "user_id": 7152770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eb6af8786d056d5dfdafa9258bb383?s=128&d=identicon&r=PG&f=1", "display_name": "zhuang", "link": "https://stackoverflow.com/users/7152770/zhuang"}, "edited": false, "score": 0, "creation_date": 1543357429, "post_id": 53508737, "comment_id": 93888119, "body": "@zhuang you are right that a slice is a reference type like a map but append to a slice can create a new slice with a different underlying array. This is so that slices can be contiguous in memory. Inserting into a map does not create a new map."}, {"owner": {"reputation": 777, "user_id": 4809932, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/83a7z.png?s=128&g=1", "display_name": "bajro", "link": "https://stackoverflow.com/users/4809932/bajro"}, "edited": false, "score": 0, "creation_date": 1543357466, "post_id": 53508737, "comment_id": 93888137, "body": "I have edited my answer to give an example on how to do it with a pointer receiver and also with a value receiver. Personally I would go for the pointer receiver as it just modifies the original struct but does not copy it."}, {"owner": {"reputation": 11, "user_id": 7152770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eb6af8786d056d5dfdafa9258bb383?s=128&d=identicon&r=PG&f=1", "display_name": "zhuang", "link": "https://stackoverflow.com/users/7152770/zhuang"}, "reply_to_user": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1543361247, "post_id": 53508737, "comment_id": 93889442, "body": "@Bajro @Chris Drew Thanks very much. I think I understand what has happened right now. In function <code>add()</code>, as your gays said, <code>r</code> is indeed a copy of struct <code>R</code> defined in the <code>main()</code> function. <code>r.a</code> is a copy of the sliceHeader, looking like this, <code>sliceHeader{Length: 0, Capacity: 10, ZerothElement: &amp;iBuffer[0]}</code>."}, {"owner": {"reputation": 11, "user_id": 7152770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eb6af8786d056d5dfdafa9258bb383?s=128&d=identicon&r=PG&f=1", "display_name": "zhuang", "link": "https://stackoverflow.com/users/7152770/zhuang"}, "edited": false, "score": 0, "creation_date": 1543361253, "post_id": 53508737, "comment_id": 93889445, "body": "So when we do <code>r.a[0] = 1</code>, the change will be reflected in the origin one because they share the same underlying array and the <code>r.a</code> in the <code>main()</code> function also points to the value in location 0. When we do <code>r.a = append(r.a, 2)</code>, r.a becomes a new sliceHeader. The underlying array may changes at the same time. But nothing happens to the original r.a in <code>main()</code> function, because the sliceHeader of r.a in <code>main()</code> function stays just the same."}, {"owner": {"reputation": 777, "user_id": 4809932, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/83a7z.png?s=128&g=1", "display_name": "bajro", "link": "https://stackoverflow.com/users/4809932/bajro"}, "reply_to_user": {"reputation": 11, "user_id": 7152770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eb6af8786d056d5dfdafa9258bb383?s=128&d=identicon&r=PG&f=1", "display_name": "zhuang", "link": "https://stackoverflow.com/users/7152770/zhuang"}, "edited": false, "score": 0, "creation_date": 1543393310, "post_id": 53508737, "comment_id": 93898833, "body": "@zhuang Yes exactly thats the point. When using slices, and in this case with the <code>append()</code> method, you are just passing the header (i.e. sliceHeader) and it just points to the new slice of the original slice. So the underlying slice is still there, but the newly created slice with <code>append()</code> is pointing to a new header of the slice. Here is another link to a blog post explaining slices very well <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}], "tags": [], "owner": {"reputation": 777, "user_id": 4809932, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/83a7z.png?s=128&g=1", "display_name": "bajro", "link": "https://stackoverflow.com/users/4809932/bajro"}, "is_accepted": true, "score": 1, "last_activity_date": 1543394429, "last_edit_date": 1543394429, "creation_date": 1543355480, "answer_id": 53508737, "question_id": 53508511, "link": "https://stackoverflow.com/questions/53508511/value-receiver-of-struct/53508737#53508737", "title": "Value receiver of struct", "body": "<p>A short excerpt from the Tour of Go states that:</p>\n\n<blockquote>\n  <p>Methods with pointer receivers can modify the value to which the\n  receiver points [...]. Since methods often need to modify their\n  receiver, pointer receivers are more common than value receivers.</p>\n</blockquote>\n\n<p><strong>Why is <code>r.b</code> shown correctly while <code>r.a</code> is not modified at all?</strong></p>\n\n<p>As already stated in my answer below, your <code>add()</code> method is a value receiver. Therefore, it will take your initialized struct (i.e. <code>r</code>), copy it and then modify it accordingly. Because you have initialized a new map under <code>r.b</code> in your <code>main()</code> function, here only the reference to this map is copied but not the whole map. Therefore, the manipulation on the map works but not on the slice <code>r.a</code>. But why does <code>r.a</code> not change at all? That's because <code>append()</code>, which is located in the <code>add()</code> method, stores a new slice header under your <code>a</code> property, and is pointing to a different section of the underlying array. At the end, your value receiver method <code>add()</code> made a copy of <code>r</code>, set a new slice header under the property <code>a</code>, and never changed the original struct <code>r</code>, that has been defined in the <code>main()</code> function as it was copied through the value receiver method <code>add()</code>.</p>\n\n<p>In your case the <code>add()</code> method is a so called value receiver method that cannot do any manipulation on your defined struct <code>r</code> located in the <code>main()</code> function directly, but copies it and does the manipulation afterwards. Therefore, you need to turn your <code>add()</code> method into a pointer receiver method just like this:</p>\n\n<pre><code>func (r *R) add()  {\n    r.a = append(r.a, 2)\n    r.b[2] = 2\n}\n</code></pre>\n\n<p>Now the method is taking the actual reference of your struct <code>r</code>, that is initiated in the <code>main()</code> function, and modifies it accordingly.</p>\n\n<p><strong>How could it work without changing your <code>add()</code> method to a pointer receiver?</strong> </p>\n\n<p>You simply would have to return the copied struct in your <code>add()</code> method like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var r R\n    r.b = make(map[int]int)\n    fmt.Println(r.add()) // outputs {[2] map[2:2]}\n}\n\ntype R struct {\n    a []int\n    b map[int]int\n}\n\nfunc (r R) add() R {\n    r.a = append(r.a, 2)\n    r.b[2] = 2\n    return r\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7152770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74eb6af8786d056d5dfdafa9258bb383?s=128&d=identicon&r=PG&f=1", "display_name": "zhuang", "link": "https://stackoverflow.com/users/7152770/zhuang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 53508737, "answer_count": 1, "score": 0, "last_activity_date": 1581766711, "creation_date": 1543354450, "last_edit_date": 1581766711, "question_id": 53508511, "link": "https://stackoverflow.com/questions/53508511/value-receiver-of-struct", "title": "Value receiver of struct", "body": "<p>Can someone explain to me why the output of r.a is empty as I have added a value of 2 into the list?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var r R\n    r.b = make(map[int]int)\n\n    r.add()\n    fmt.Println(r) // outputs {[] map[2:2]}\n}\n\ntype R struct {\n    a []int\n    b map[int]int\n}\n\nfunc (r R) add()  {\n    r.a = append(r.a, 2)\n    r.b[2] = 2\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543352290, "post_id": 53507935, "comment_id": 93885898, "body": "for extra credit, can you show an example of doing that with the fs tree in the OP? You also get extra credit points for upvoting the OP lulz."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1543465269, "post_id": 53507935, "comment_id": 93931575, "body": "This is still the best answer to the question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "edited": false, "score": 0, "creation_date": 1543467421, "post_id": 53507935, "comment_id": 93932079, "body": "@Kaveh Shahbazian any idea how to install the bundle tool? Can&#39;t find the installation instructions from the docs. I wish it were <code>go bundle</code> instead of <code>bundle</code>..."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1543508670, "post_id": 53507935, "comment_id": 93953615, "body": "From the instructions on its page (<a href=\"https://github.com/golang/tools\" rel=\"nofollow noreferrer\">github.com/golang/tools</a>): <code>go get -u golang.org&#47;x&#47;tools&#47;...</code>."}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": true, "score": 0, "last_activity_date": 1543351846, "creation_date": 1543351846, "answer_id": 53507935, "question_id": 53507848, "link": "https://stackoverflow.com/questions/53507848/package-golang-directory-tree-into-a-single-file/53507935#53507935", "title": "Package golang directory tree into a single file", "body": "<p>There is a tool by Google Go team that does that: <a href=\"https://godoc.org/golang.org/x/tools/cmd/bundle\" rel=\"nofollow noreferrer\">bundle</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5047085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53507935, "answer_count": 1, "score": 0, "last_activity_date": 1543351846, "creation_date": 1543351458, "question_id": 53507848, "link": "https://stackoverflow.com/questions/53507848/package-golang-directory-tree-into-a-single-file", "title": "Package golang directory tree into a single file", "body": "<p>Using Golang, if we have a folder tree like this:</p>\n\n<pre><code>foo/\n  bar/\n   baz/\n     baz.go\n   jazz/\n     jazz.go\n</code></pre>\n\n<p>is there a way to package this folder into a single file for consumption by other go programs, but keep the namespacing, etc?</p>\n"}, {"tags": ["bash", "shell", "go", "groovy"], "comments": [{"owner": {"reputation": 31754, "user_id": 2194470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=128&d=identicon&r=PG", "display_name": "Szymon Stepniak", "link": "https://stackoverflow.com/users/2194470/szymon-stepniak"}, "edited": false, "score": 1, "creation_date": 1543351561, "post_id": 53507773, "comment_id": 93885521, "body": "And what is the error you get?"}], "answers": [{"comments": [{"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1543486040, "post_id": 53512175, "comment_id": 93940378, "body": "ahh,so this is the problem , you mean that if I run it in <code>&quot;&quot;</code> it will save the context ? it should be like <code>&amp;&amp;</code> command ?"}, {"owner": {"reputation": 16548, "user_id": 54506, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/coddh.png?s=128&g=1", "display_name": "Jayan", "link": "https://stackoverflow.com/users/54506/jayan"}, "reply_to_user": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1543579175, "post_id": 53512175, "comment_id": 93979551, "body": "each sh becomes a fresh script . For commands that are related using triple quote is fine."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1543579615, "post_id": 53512175, "comment_id": 93979780, "body": "There is other option except triple quote?"}, {"owner": {"reputation": 16548, "user_id": 54506, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/coddh.png?s=128&g=1", "display_name": "Jayan", "link": "https://stackoverflow.com/users/54506/jayan"}, "reply_to_user": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1543661098, "post_id": 53512175, "comment_id": 94004730, "body": "What is wrong with triple quotes ?  You may write your logic in any language and then call from sh."}], "tags": [], "owner": {"reputation": 16548, "user_id": 54506, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/coddh.png?s=128&g=1", "display_name": "Jayan", "link": "https://stackoverflow.com/users/54506/jayan"}, "is_accepted": false, "score": 1, "last_activity_date": 1543379523, "creation_date": 1543379523, "answer_id": 53512175, "question_id": 53507773, "link": "https://stackoverflow.com/questions/53507773/using-script-in-jenkins-run-in-diffrent-phase/53512175#53512175", "title": "Using script in jenkins run in diffrent phase", "body": "<p>Each \"sh\" is unique invocation.  Environment is not shared.</p>\n\n<p>Following will run under <strong><em>two</em></strong> different shells.  change of directory will not be reflected to \"go test\" line</p>\n\n<pre><code> sh   \"cd  /go/src/git.company/mfr/go-proj\"\n sh   \"go test -v ./...\"\n</code></pre>\n"}], "owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543379523, "creation_date": 1543351186, "question_id": 53507773, "link": "https://stackoverflow.com/questions/53507773/using-script-in-jenkins-run-in-diffrent-phase", "title": "Using script in jenkins run in diffrent phase", "body": "<p>I run the following script which works</p>\n\n<pre><code> sh \"\"\"\n    mkdir -p /go/src/git.company/mfr/go-proj\n    cp -R $WORKSPACE/* /go/src/git.company/mfr/go-proj\n    cd  /go/src/git.company/mfr/go-proj\n    go test -v ./...\n \"\"\"\n</code></pre>\n\n<p>but when I run it like this I got erorr , why ? </p>\n\n<pre><code> sh   \"mkdir -p /go/src/git.company/mfr/go-proj\"\n sh   \"cp -R $WORKSPACE/* /go/src/git.company/mfr/go-proj\"\n sh   \"cd  /go/src/git.company/mfr/go-proj\"\n sh   \"go test -v ./...\"\n</code></pre>\n\n<p>any idea why ?</p>\n\n<p>The file starts with <code>#!/usr/bin/env groovy</code> </p>\n"}, {"tags": ["postgresql", "go", "pq"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1543351601, "post_id": 53507760, "comment_id": 93885540, "body": "Can you show the contents of your queries? the insertQuery/selectQuery strings? I&#39;m asking because you would get this error if your insertQuery doens&#39;t have a returning clause, ie. there&#39;s nothing to scan."}, {"owner": {"reputation": 838, "user_id": 9134487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VPebZ.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/9134487/tushar"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543352084, "post_id": 53507760, "comment_id": 93885792, "body": "Updated the question"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1543352133, "post_id": 53507760, "comment_id": 93885823, "body": "Well your insert query doesn&#39;t return anything, so calling Scan(&amp;lastInsertedID) is always gonna get you that error."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543352174, "post_id": 53507760, "comment_id": 93885837, "body": "Here&#39;s what you need <a href=\"https://www.postgresql.org/docs/9.5/dml-returning.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/9.5/dml-returning.html</a>"}, {"owner": {"reputation": 838, "user_id": 9134487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VPebZ.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/9134487/tushar"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1543352187, "post_id": 53507760, "comment_id": 93885845, "body": "Great, got it. Thanks mate. I think I just need to add &quot;returning id&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 7, "last_activity_date": 1543389029, "creation_date": 1543389029, "answer_id": 53513968, "question_id": 53507760, "link": "https://stackoverflow.com/questions/53507760/why-am-i-getting-errnorowssql-no-rows-in-result-set-after-inserting-into-po/53513968#53513968", "title": "Why am I getting ErrNoRows(&quot;sql: no rows in result set&quot;) after inserting into postgres, even when insert was actually successful?", "body": "<p>You've effectively asked two questions, so I'll answer both:</p>\n\n<ol>\n<li><p>Why <strong>ErrNoRows</strong> even when your insert is successful?</p>\n\n<p>This is expected behavior, because by default an INSERT returns no rows. Your \"error\" isn't actually problematic.  If you want an INSERT to return rows, you must use a 'RETURNING' clause at the end.</p>\n\n<p>The fact that the \"No rows in result set\" state is communicated by way of an error may be the reason for your confusion. But this should only be considered an error <em>if you expected rows</em>.</p></li>\n<li><p>Also <strong>lastInsertID</strong> always remains 0.</p>\n\n<p>This is also expected behavior. As <a href=\"https://godoc.org/github.com/lib/pq#hdr-Queries\" rel=\"noreferrer\">documented</a>:</p>\n\n<blockquote>\n  <p>pq does not support the LastInsertId() method of the Result type in database/sql. To return the identifier of an INSERT (or UPDATE or DELETE), use the Postgres RETURNING clause with a standard Query or QueryRow call:</p>\n</blockquote></li>\n</ol>\n"}], "owner": {"reputation": 838, "user_id": 9134487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VPebZ.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/9134487/tushar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6474, "favorite_count": 0, "accepted_answer_id": 53513968, "answer_count": 1, "score": 3, "last_activity_date": 1543389029, "creation_date": 1543351144, "last_edit_date": 1543352060, "question_id": 53507760, "link": "https://stackoverflow.com/questions/53507760/why-am-i-getting-errnorowssql-no-rows-in-result-set-after-inserting-into-po", "title": "Why am I getting ErrNoRows(&quot;sql: no rows in result set&quot;) after inserting into postgres, even when insert was actually successful?", "body": "<p>I am working with golang-postgres:</p>\n\n<pre><code>\"database/sql\"\n_ \"github.com/lib/pq\"\n</code></pre>\n\n<p><strong>What I am doing:</strong></p>\n\n<p>I run a select query.\nIf I don't get any entry on selecting, I go ahead and insert one.\nElse, update, or something else...</p>\n\n<p><strong>The problem is</strong>, every time insert returns <strong>ErrNoRows(\"sql: no rows in result set\")</strong> , even when I can see in database that INSERT was successful, and row was added.</p>\n\n<p>Also <strong>lastInsertID</strong> always remains 0, while if I check in DB, it has an actual value(say, 131)</p>\n\n<p>It seems as if the error near <em>comment 2</em> below in the code, is cached somewhere, and shows up again.</p>\n\n<pre><code>// 1. Select first\nsQueryStmt, sPrepErr := db.Prepare(selectQuery)\n    if sPrepErr != nil {\n        glog.V(3).Infof(\"selectQuery prepare failed. err: %v\", sPrepErr)\n        return sPrepErr\n    }\n\n    queryErr := sQueryStmt.QueryRow(today, itemID).Scan(&amp;a, &amp;b, &amp;c, &amp;d, &amp;e, &amp;f, &amp;g, &amp;h, &amp;i, &amp;j)\n    if queryErr != nil {\n\n// 2. Getting ErrNoRows here is expected, for the first entry\n        if queryErr == sql.ErrNoRows {\n            glog.V(3).Infof(\"selectQuery returned no results. err: %v\", queryErr)\n\n            var lastInsertID int\n            iQueryStmt, iPrepErr := db.Prepare(insertQuery)\n            if iPrepErr != nil {\n                glog.V(3).Infof(\"insertQuery prepare failed. err: %v\", iPrepErr)\n                return iPrepErr\n            }\n            insertErr := iQueryStmt.QueryRow(today, today, today, taskID).Scan(&amp;lastInsertID)\n            if insertErr != nil {\n                // 3. Somehow, even after row is correctly being created, I am getting insertErr as \"sql: no rows in result set\" here\n                glog.V(3).Infof(\"insertQuery failed. err: %v\", insertErr)\n            } else {\n// control never comes to this part.\n                glog.V(3).Infof(\"insertQuery Successful. lastInsertID: %v\", lastInsertID)\n            }\n        } else {\n            glog.V(3).Infof(\"Couldn't run query on Postgres database. err: %v\", queryErr)\n            return queryErr\n        }\n}\n</code></pre>\n\n<p>Debugging inside <strong>database/sql</strong>, shows that it is returning this error in below code block:</p>\n\n<pre><code>    if !r.rows.Next() {\n        if err := r.rows.Err(); err != nil {\n            return err\n        }\n        return ErrNoRows\n    }\n</code></pre>\n\n<p>But every time, if I check in DB, the <strong>data is always already inserted</strong>.</p>\n\n<p><strong>Edit:</strong></p>\n\n<pre><code>selectQuery = `select task_id, creation_date, times_x_ran,\n                        a_count, b_count, c_count, d_count, e_count \n                        from reports where creation_date = $1 and task_id = $2`\n\ninsertQuery = `insert into reports \n                (creation_date, creation_time, last_modified, task_id, times_x_ran, times_y_ran, a, b, c, d, e, x_errors, y_errors) \n                    values \n                    ($1, $2, $3, $4,\n                    1, 0, \n                    0, 0, 0, 0, 0, \n                    '', '' )`\n</code></pre>\n"}, {"tags": ["go", "design-patterns"], "comments": [{"owner": {"reputation": 167, "user_id": 7471182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b641fcfe096e3206125cd374ab7e481a?s=128&d=identicon&r=PG&f=1", "display_name": "marhaupe", "link": "https://stackoverflow.com/users/7471182/marhaupe"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1543350837, "post_id": 53507489, "comment_id": 93885214, "body": "Ah you&#39;re right, that doesn&#39;t really make sense. That should not make any difference though, right?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543352250, "post_id": 53507489, "comment_id": 93885876, "body": "The idiomatic solution is: Redesign."}, {"owner": {"reputation": 167, "user_id": 7471182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b641fcfe096e3206125cd374ab7e481a?s=128&d=identicon&r=PG&f=1", "display_name": "marhaupe", "link": "https://stackoverflow.com/users/7471182/marhaupe"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1543384529, "post_id": 53507489, "comment_id": 93895077, "body": "Yeah my question implies that I already know that. How would you approach that if you already suggest it? @Volker"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 7471182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b641fcfe096e3206125cd374ab7e481a?s=128&d=identicon&r=PG&f=1", "display_name": "marhaupe", "link": "https://stackoverflow.com/users/7471182/marhaupe"}, "edited": false, "score": 0, "creation_date": 1543384226, "post_id": 53508070, "comment_id": 93894963, "body": "It&#39;s important that Canvas needs to know about it&#39;s children&#39;s color in this case. I should have made that a bit more clearer, sorry. You couldn&#39;t have known. If that wouldn&#39;t be that case your solution would fit perfectly. Thanks for taking your time! In that case, would you approach it the same way @Rob Napier did?"}], "tags": [], "owner": {"reputation": 178, "user_id": 5396095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IDb1FSLNLzk/AAAAAAAAAAI/AAAAAAAAAC0/yy90p8_VuMM/photo.jpg?sz=128", "display_name": "Mohammad Nasirifar", "link": "https://stackoverflow.com/users/5396095/mohammad-nasirifar"}, "is_accepted": false, "score": 1, "last_activity_date": 1543352433, "creation_date": 1543352433, "answer_id": 53508070, "question_id": 53507489, "link": "https://stackoverflow.com/questions/53507489/what-is-the-most-idiomatic-way-to-mimic-inheritance-in-go-in-this-specific-case/53508070#53508070", "title": "What is the most idiomatic way to mimic inheritance in Go in this specific case?", "body": "<p>The key observation here is if you need a particular functionality, make it explicit. Also don't do other objects' job on behalf of them.</p>\n\n<p>Also note that <code>String()</code> must return a string, not write to <code>stdout</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"strings\"\n)\n\ntype AreaCalculator interface {\n    fmt.Stringer\n    Area() int\n}\n\ntype Rectangle struct {\n    color  string\n    width  int\n    height int\n}\n\nfunc (r *Rectangle) Area() int {\n    return r.width * r.height\n}\n\nfunc (r *Rectangle) String() string {\n    return fmt.Sprintf(\"I'm a rectangle %d\", r.width)\n}\n\ntype Circle struct {\n    color    string\n    diameter int\n}\n\nfunc (c *Circle) Area() int {\n    area := math.Round(float64(c.diameter*c.diameter) * math.Pi / float64(4))\n    return int(area)\n}\n\nfunc (c *Circle) String() string {\n    return fmt.Sprintf(\"I'm a circle: %d\", c.diameter)\n}\n\ntype Canvas struct {\n    children []AreaCalculator\n}\n\nfunc (c *Canvas) String() string {\n    lines := make([]string, 0)\n    for _, child := range c.children {\n        lines = append(lines, child.String())\n    }\n    return strings.Join(lines, \"\\n\")\n}\n\nfunc main() {\n    circle := &amp;Circle{color: \"red\", diameter: 2}\n    rect := &amp;Rectangle{color: \"blue\", width: 3, height: 4}\n\n    canvas := &amp;Canvas{\n        children: []AreaCalculator{circle, rect},\n    }\n\n    fmt.Println(canvas.String())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 7471182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b641fcfe096e3206125cd374ab7e481a?s=128&d=identicon&r=PG&f=1", "display_name": "marhaupe", "link": "https://stackoverflow.com/users/7471182/marhaupe"}, "edited": false, "score": 1, "creation_date": 1543383689, "post_id": 53508254, "comment_id": 93894760, "body": "Oh this seems a bit similar to the one option I desribed so I wasn&#39;t thinking that wrong. I just might have get used to this way of thinking. Seeing your answer definetely helps much. Thank you for taking your time, I really appreciate that!"}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 3, "last_activity_date": 1543353764, "last_edit_date": 1543353764, "creation_date": 1543353382, "answer_id": 53508254, "question_id": 53507489, "link": "https://stackoverflow.com/questions/53507489/what-is-the-most-idiomatic-way-to-mimic-inheritance-in-go-in-this-specific-case/53508254#53508254", "title": "What is the most idiomatic way to mimic inheritance in Go in this specific case?", "body": "<p>An important starting point is that you should not mimic inheritance in Go. Go does not have inheritance. It has interfaces and it has embedding. They didn't forget to include inheritance; <a href=\"https://stackoverflow.com/questions/32188653/golang-and-inheritance\">it's intentionally not part of the language</a>. Go encourages composition instead.</p>\n\n<p>Your <code>Canvas</code> needs more than a <code>AreaCalculator</code>. It needs something that provides a color. You need to express that. For example, you might do this:</p>\n\n<pre><code>type DrawableShape interface {\n  AreaCalculator\n  Color() string\n}\n</code></pre>\n\n<p>And then you would implement <code>Color()</code> for <code>Rectangle</code> and <code>Circle</code>.</p>\n\n<pre><code>func (r Rectangle) Color() string {\n  return r.color\n}\n\nfunc (c Circle) Color() string {\n  return c.color\n}\n</code></pre>\n\n<p>And <code>children</code> would be <code>[]DrawableShape</code>:</p>\n\n<pre><code>children []DrawableShape\n</code></pre>\n\n<p>That would leave something like <a href=\"https://play.golang.org/p/6eeOXsECjwW\" rel=\"nofollow noreferrer\">this</a> (building off of Mohammad Nasirifar's code).</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"strings\"\n)\n\ntype AreaCalculator interface {\n    Area() int\n}\n\ntype DrawableShape interface {\n  AreaCalculator\n  Color() string\n}\n\ntype Rectangle struct {\n    color  string\n    width  int\n    height int\n}\n\nfunc (r Rectangle) Area() int {\n    return r.width * r.height\n}\n\nfunc (r Rectangle) Color() string {\n  return r.color\n}\n\ntype Circle struct {\n    color    string\n    diameter int\n}\n\nfunc (c Circle) Area() int {\n    area := math.Round(float64(c.diameter*c.diameter) * math.Pi / float64(4))\n    return int(area)\n}\n\nfunc (c Circle) Color() string {\n  return c.color\n}\n\ntype Canvas struct {\n    children []DrawableShape\n}\n\nfunc (c Canvas) String() string {\n    lines := make([]string, 0)\n    for _, child := range c.children {\n        lines = append(lines, fmt.Sprintf(\"Area of child with color %s %d\", child.Color(), child.Area()))\n    }\n    return strings.Join(lines, \"\\n\")\n}\n\nfunc main() {\n    circle := &amp;Circle{color: \"red\", diameter: 2}\n    rect := &amp;Rectangle{color: \"blue\", width: 3, height: 4}\n\n    canvas := &amp;Canvas{\n        children: []DrawableShape{circle, rect},\n    }\n\n    fmt.Println(canvas.String())\n}\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 7471182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b641fcfe096e3206125cd374ab7e481a?s=128&d=identicon&r=PG&f=1", "display_name": "marhaupe", "link": "https://stackoverflow.com/users/7471182/marhaupe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 53508254, "answer_count": 2, "score": -2, "last_activity_date": 1543353764, "creation_date": 1543349975, "last_edit_date": 1543351226, "question_id": 53507489, "link": "https://stackoverflow.com/questions/53507489/what-is-the-most-idiomatic-way-to-mimic-inheritance-in-go-in-this-specific-case", "title": "What is the most idiomatic way to mimic inheritance in Go in this specific case?", "body": "<p>I've been thinking alot about this particular problem I'm having an how I'm supposed to solve it the cleanest way. </p>\n\n<p>Imagine an application looking like this:</p>\n\n<pre><code>type AreaCalculator interface {\n  Area() int\n}\n\ntype Rectangle struct {\n    color  string\n    width  int\n    height int\n}\n\ntype (r *Rectangle) Area() int {\n   return r.width * r.height\n}\n\ntype Circle struct {\n    color    string\n    diameter int\n}\n\ntype (c *Circle) Area() int {\n   return r.diameter / 2 * r.diameter / 2 * \u03c0\n}\n\ntype Canvas struct {\n    children []AreaCalculator\n}\n\nfunc (c *Canvas) String() {\n    for child := range c.children {\n        fmt.Println(\"Area of child with color \", child.color, \" \", child.Area())\n    }\n}\n</code></pre>\n\n<p>This example obviously would not compile because while the String() method of Canvas can call c.Area(), it can't access c.color since there's no way to make sure that a struct implementing AreaCalculator has that property. </p>\n\n<p>One solutions I could think of was to do it like this:</p>\n\n<pre><code>type AreaCalculator interface {\n  Area() int\n  Color() string\n}\n\ntype Rectangle struct {\n    color  string\n    width  int\n    height int\n}\n\ntype (r *Rectangle) Color() string {\n   return r.color\n}\n\ntype (r *Rectangle) Area() int {\n   return r.width * r.height\n}\n\ntype Circle struct {\n    color    string\n    diameter int\n}\n\ntype (c *Circle) Area() int {\n   return r.diameter / 2 * r.diameter / 2 * \u03c0\n}\ntype (c *Circle) Color() string {\n   return c.color\n}\n\ntype Canvas struct {\n    children []AreaCalculator\n}\n\nfunc (c *Canvas) String() {\n    for child := range c.children {\n        fmt.Println(\"Area of child with color \", child.Color(), \" \", child.Area())\n    }\n}\n</code></pre>\n\n<p>The other way would be to try something like this:</p>\n\n<pre><code>type Shape struct {\n    Area func() int \n    color string\n    diameter int\n    width int\n    height int\n}\n\nfunc NewCircle() Shape {\n    // Shape initialisation to represent a Circle. Setting Area func here\n}\n\n\nfunc NewRectangle() Shape {\n    // Shape initialisation to represent a Rectangle. Setting Area func here\n}\n\ntype Canvas struct {\n    children []Shape\n}\n\nfunc (c *Canvas) String() {\n    for child := range c.children {\n        fmt.Println(\"Area of child with color\", child.color, \" \", child.Area())\n    }\n}\n</code></pre>\n\n<p>None of these options seem clean to me. I'm sure there's a way cleaner solution I can't think of. </p>\n"}, {"tags": ["arrays", "loops", "go"], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 1, "last_activity_date": 1543350673, "creation_date": 1543350673, "answer_id": 53507660, "question_id": 53507260, "link": "https://stackoverflow.com/questions/53507260/how-to-increment-all-elements-in-an-array-or-slice-in-golang/53507660#53507660", "title": "How to increment all elements in an array or slice in golang", "body": "<p>While working with slices you will find that you will gravitate towards <code>for</code> loops. Go doesn't have extra functions for slices that you might find with other languages.</p>\n\n<pre><code>for i := range slice {\n  slice[i]++\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 10179262, "user_type": "registered", "profile_image": "https://graph.facebook.com/1930501930333951/picture?type=large", "display_name": "Sridhar Natuva", "link": "https://stackoverflow.com/users/10179262/sridhar-natuva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 53507660, "answer_count": 1, "score": -3, "last_activity_date": 1543350673, "creation_date": 1543348902, "question_id": 53507260, "link": "https://stackoverflow.com/questions/53507260/how-to-increment-all-elements-in-an-array-or-slice-in-golang", "title": "How to increment all elements in an array or slice in golang", "body": "<p>Below code increments only ith element of that slice. Is there something inbuild that i can increment all elements with 1. Please suggest.</p>\n\n<pre><code>for i:= 0; i&lt; k ;i++{\n    if(slice[i] &lt; K){\n        slice[i] = slice[i] + 1\n    }\n}\n</code></pre>\n"}, {"tags": ["string", "go", "rune"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1543346406, "post_id": 53506374, "comment_id": 93883111, "body": "Yes there is a better way. You should parse the version into all the parts every part will be an integer. Then you can increment the part you need. At the end you just create a new string."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1543346884, "last_edit_date": 1543346884, "creation_date": 1543346232, "answer_id": 53506666, "question_id": 53506374, "link": "https://stackoverflow.com/questions/53506374/golang-increcementing-numbers-in-strings-using-runes/53506666#53506666", "title": "Golang Increcementing numbers in strings (using runes)", "body": "<p>Your intention is to increment the number represented by the last rune, so you should do that: parse out that number, increment it as a number, and \"re-encode\" it into string.</p>\n\n<p>You can't operate on a single rune, as once the number reaches <code>10</code>, it can only be represented using 2 runes. Another issue is if the last number is <code>19</code>, incrementing it needs to alter the previous rune (and not adding a new rune).</p>\n\n<p>Parsing the numbers and re-encoding though is much easier than one might think.</p>\n\n<p>You can take advantage of the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package's <a href=\"https://golang.org/pkg/fmt/#Sscanf\" rel=\"nofollow noreferrer\"><code>fmt.Sscanf()</code></a> and <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf()</code></a> functions. Parsing and re-encoding is just a single function call.</p>\n\n<p>Let's wrap this functionality into a function:</p>\n\n<pre><code>const format = \"version-%d.%d.%d-%d\"\n\nfunc incLast(s string) (string, error) {\n    var a, b, c, d int\n    if _, err := fmt.Sscanf(s, format, &amp;a, &amp;b, &amp;c, &amp;d); err != nil {\n        return \"\", err\n    }\n\n    d++\n    return fmt.Sprintf(format, a, b, c, d), nil\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>s := \"version-1.1.0-8\"\n\nfor i := 0; i &lt; 13; i++ {\n    var err error\n    if s, err = incLast(s); err != nil {\n        panic(err)\n    }\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/UMmveYry4HQ\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>version-1.1.0-9\nversion-1.1.0-10\nversion-1.1.0-11\nversion-1.1.0-12\nversion-1.1.0-13\nversion-1.1.0-14\nversion-1.1.0-15\nversion-1.1.0-16\nversion-1.1.0-17\nversion-1.1.0-18\nversion-1.1.0-19\nversion-1.1.0-20\nversion-1.1.0-21\n</code></pre>\n\n<p>Another option would be to just parse and re-encode the last part, and not the complete version text. This is how it would look like:</p>\n\n<pre><code>func incLast2(s string) (string, error) {\n    i := strings.LastIndexByte(s, '-')\n    if i &lt; 0 {\n        return \"\", fmt.Errorf(\"invalid input\")\n    }\n\n    d, err := strconv.Atoi(s[i+1:])\n    if err != nil {\n        return \"\", err\n    }\n\n    d++\n    return s[:i+1] + strconv.Itoa(d), nil\n}\n</code></pre>\n\n<p>Testing and output is the same. Try this one on the <a href=\"https://play.golang.org/p/GwpTLzLRZDh\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 884, "user_id": 2977080, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1ece87d32bf381fc7990522c5e8986c2?s=128&d=identicon&r=PG", "display_name": "octain", "link": "https://stackoverflow.com/users/2977080/octain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "accepted_answer_id": 53506666, "answer_count": 1, "score": -1, "last_activity_date": 1543346884, "creation_date": 1543344953, "question_id": 53506374, "link": "https://stackoverflow.com/questions/53506374/golang-increcementing-numbers-in-strings-using-runes", "title": "Golang Increcementing numbers in strings (using runes)", "body": "<p>I have a string mixed with characters and numerals, but i want to increment the last character which happens to be a number, here is what i have, it works, but once i reach 10 rune goes to black since 10 decimal is zero, is there a better way to do this?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n)\n\nfunc main() {\nstr := \"version-1.1.0-8\"\nrStr := []rune(str)\n\n\nlast := rStr[len(rStr)-1]\nrStr[len(rStr)-1] = last + 1\n\n\n}\n</code></pre>\n\n<p>So this works for str := \"version-1.1.0-8\" = version-1.1.0-9\nstr := version-1.1.0-9 = version-1.1.0- </p>\n\n<p>I understand why it is happening, but I dont know how to fix it</p>\n"}, {"tags": ["go", "time", "strptime"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543348375, "post_id": 53506229, "comment_id": 93884038, "body": "So: What is the question? Just remove stuff you do not want to parse."}, {"owner": {"reputation": 309, "user_id": 4163515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/093f195605f7ec78bf58f4ebe6ac8ebe?s=128&d=identicon&r=PG&f=1", "display_name": "WXMan", "link": "https://stackoverflow.com/users/4163515/wxman"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543350488, "post_id": 53506229, "comment_id": 93885054, "body": "Sorry - I&#39;ll edit the post to elaborate a bit more.  But the question was <code>Is there any way to use time.Parse and indicate a number in the formatting string should not be considered as part of the time?</code>.  Unfortunately stripping the suffix won&#39;t work for me, as I need a flexible function that takes an arbitrary formatting string and datetime string and returns the time.Time object."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1543363536, "post_id": 53506229, "comment_id": 93890062, "body": "@WXMan: Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer. Asking for an arbitrary formatting string and an arbitrary datetime string to return a time.Time is unreasonable."}, {"owner": {"reputation": 309, "user_id": 4163515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/093f195605f7ec78bf58f4ebe6ac8ebe?s=128&d=identicon&r=PG&f=1", "display_name": "WXMan", "link": "https://stackoverflow.com/users/4163515/wxman"}, "edited": false, "score": 0, "creation_date": 1543410650, "post_id": 53506229, "comment_id": 93909035, "body": "I&#39;m porting code from Python to Go, and solving this problem in python is very straight-forward with strptime.  I honestly do not think it is an unreasonable question to ask <i>if it&#39;s possible</i> to do the equivalent in Go when there are non-time numbers contained in the datetime string.  If the answer is no, then I&#39;m happy with that and will move on.  I&#39;ll update the post to more directly ask this question."}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 4163515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/093f195605f7ec78bf58f4ebe6ac8ebe?s=128&d=identicon&r=PG&f=1", "display_name": "WXMan", "link": "https://stackoverflow.com/users/4163515/wxman"}, "edited": false, "score": 0, "creation_date": 1543350701, "post_id": 53507317, "comment_id": 93885149, "body": "This does answer the question as originally proposed.  But I realized I left out an important point; I need a flexible function that takes an arbitrary formatting string and datetime string and returns the time.Time object.  So stripping won&#39;t work if we don&#39;t necessarily know what the incoming format looks like."}], "tags": [], "owner": {"reputation": 9, "user_id": 9044295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PF8r0.png?s=128&g=1", "display_name": "cheznic", "link": "https://stackoverflow.com/users/9044295/cheznic"}, "is_accepted": false, "score": 1, "last_activity_date": 1543349157, "creation_date": 1543349157, "answer_id": 53507317, "question_id": 53506229, "link": "https://stackoverflow.com/questions/53506229/golang-time-parse-formatting-with-non-time-number/53507317#53507317", "title": "Golang time.Parse() Formatting with Non-Time Number", "body": "<p>I suspect this is obvious but here it goes...</p>\n\n<p>just strip it:</p>\n\n<pre><code>func removeSuffix(s string) (string, error) {\n    i := strings.LastIndexByte(s, '_')\n\n    if i &lt; 0 {\n         return \"\", fmt.Errorf(\"invalid input\")\n    }\n\n    runes := []rune(s)\n\n    result := runes[0:i]\n\n    return string(result), nil\n}\n</code></pre>\n\n<p>Here's the go playground\n<a href=\"https://play.golang.org/p/JbHt4Png-eT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JbHt4Png-eT</a></p>\n"}], "owner": {"reputation": 309, "user_id": 4163515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/093f195605f7ec78bf58f4ebe6ac8ebe?s=128&d=identicon&r=PG&f=1", "display_name": "WXMan", "link": "https://stackoverflow.com/users/4163515/wxman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1543412013, "creation_date": 1543344353, "last_edit_date": 1543412013, "question_id": 53506229, "link": "https://stackoverflow.com/questions/53506229/golang-time-parse-formatting-with-non-time-number", "title": "Golang time.Parse() Formatting with Non-Time Number", "body": "<p>I am porting code from python and have a function that takes a formatting string and equivalent datetime string and creates a datetime object:</p>\n\n<pre><code>import datetime\ndef retrieve_object(file_name, fmt_string):\n    datetime = datetime.strptime(file_name, fmt_string)\n    // Do additional datetime calculations here\n</code></pre>\n\n<p>I tried creating the equivalent function in Go:</p>\n\n<pre><code>import(\n    \"time\"\n)\n\nfunc retrieve_object(file_name string, fmt_string string) {\n    time_out, _ := time.Parse(fmt_string, file_name)  \n    // Do additional time.Time calculations here\n</code></pre>\n\n<p>This parses the time.Time correctly in this case:</p>\n\n<pre><code>file_name := \"KICT20170307_000422\" \nfmt_string := \"KICT20060102_150405\"\n// returns 2017-03-07 00:04:22 +0000 UTC\n</code></pre>\n\n<p>But fails to correctly parse in this case:</p>\n\n<pre><code>file_name := \"KICT20170307_000422_V06.nc\" \nfmt_string := \"KICT20060102_150405_V06.nc\"\n// returns 2006-03-07 00:04:22 +0000 UTC\n</code></pre>\n\n<p>I suspect this is due to the additional non-date number (\"06\") in the datetime string.  Is it possible to create a function that can create a time.Time object given an arbitrary formatting string and datetime string representation using the built-in time.Parse function?  If not, are there any third-party solutions that could work?</p>\n"}, {"tags": ["web", "go", "heroku"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user751651"}, "edited": false, "score": 1, "creation_date": 1543381396, "post_id": 53506169, "comment_id": 93894145, "body": "Do you hava a Procfile? This is Heroku demo Go App <a href=\"https://github.com/heroku/go-getting-started\" rel=\"nofollow noreferrer\">github.com/heroku/go-getting-started</a>"}, {"owner": {"reputation": 7795, "user_id": 70613, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3d24f5a7acad9a9263fb1b8eae946ca6?s=128&d=identicon&r=PG", "display_name": "Matt Sherman", "link": "https://stackoverflow.com/users/70613/matt-sherman"}, "edited": false, "score": 1, "creation_date": 1543384371, "post_id": 53506169, "comment_id": 93895021, "body": "In the Home func, it appears you are ignoring the error retuned by ParseFiles call, as well as the Execute call. Try logging those."}, {"owner": {"reputation": 3025, "user_id": 4660602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iYRGR.jpg?s=128&g=1", "display_name": "Geoherna", "link": "https://stackoverflow.com/users/4660602/geoherna"}, "edited": false, "score": 1, "creation_date": 1543391192, "post_id": 53506169, "comment_id": 93897892, "body": "What port are you connecting your app to? Heroku was giving me a very similar but misleading error message because of a port permissions error that was causing my STAGING server app to crash quickly. Running <code>sudo setcap CAP_NET_BIND_SERVICE=+eip &#47;path&#47;to&#47;binary</code> fixed it for me. Not sure this is what\u2019s happening with you, but my error message was similar and this was my solution. Also, this probably isn\u2019t a good permanent / production solution."}, {"owner": {"reputation": 645, "user_id": 695156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/90e478591937482d1045181ad957a6b2?s=128&d=identicon&r=PG", "display_name": "Intelwalk", "link": "https://stackoverflow.com/users/695156/intelwalk"}, "edited": false, "score": 0, "creation_date": 1543413182, "post_id": 53506169, "comment_id": 93910697, "body": "@HarrisonBrock  I added my procfile contents"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 9044295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PF8r0.png?s=128&g=1", "display_name": "cheznic", "link": "https://stackoverflow.com/users/9044295/cheznic"}, "is_accepted": false, "score": 0, "last_activity_date": 1543350045, "creation_date": 1543350045, "answer_id": 53507511, "question_id": 53506169, "link": "https://stackoverflow.com/questions/53506169/heroku-go-webapp-crashing/53507511#53507511", "title": "Heroku Go Webapp Crashing", "body": "<p>I'm not sure what your encountering but this issue can cause a difference between your local and Heroku runtimes.</p>\n\n<p><a href=\"https://help.heroku.com/PPBPA231/how-do-i-use-the-port-environment-variable-in-container-based-apps\" rel=\"nofollow noreferrer\">https://help.heroku.com/PPBPA231/how-do-i-use-the-port-environment-variable-in-container-based-apps</a></p>\n"}, {"tags": [], "owner": {"reputation": 645, "user_id": 695156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/90e478591937482d1045181ad957a6b2?s=128&d=identicon&r=PG", "display_name": "Intelwalk", "link": "https://stackoverflow.com/users/695156/intelwalk"}, "is_accepted": true, "score": 0, "last_activity_date": 1544128033, "creation_date": 1544128033, "answer_id": 53659176, "question_id": 53506169, "link": "https://stackoverflow.com/questions/53506169/heroku-go-webapp-crashing/53659176#53659176", "title": "Heroku Go Webapp Crashing", "body": "<p>I was able to get this to work by rebuilding my project small steps at a time.  So it may have been a godeps issue. </p>\n\n<p>Thank you all for your helpful insight!</p>\n\n<p><a href=\"https://serene-lake-65180.herokuapp.com/\" rel=\"nofollow noreferrer\">https://serene-lake-65180.herokuapp.com/</a></p>\n"}], "owner": {"reputation": 645, "user_id": 695156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/90e478591937482d1045181ad957a6b2?s=128&d=identicon&r=PG", "display_name": "Intelwalk", "link": "https://stackoverflow.com/users/695156/intelwalk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 53659176, "answer_count": 2, "score": -1, "last_activity_date": 1544128033, "creation_date": 1543344089, "last_edit_date": 1543413158, "question_id": 53506169, "link": "https://stackoverflow.com/questions/53506169/heroku-go-webapp-crashing", "title": "Heroku Go Webapp Crashing", "body": "<p>I have a web app I've written in Go and I can get it to work perfectly on my localhost machine.  The issue occurs after I upload it to Heroku.  This is also my first Heroku app as well.  I have no problem pushing it up to heroku but I get the following errors when I try to run it.</p>\n\n<pre><code>2018-11-27T18:00:45.614798+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=boiling-eyrie-61189.herokuapp.com request_id=7ff8feb8-bc03-4aff-a0ce-42474fcf35e9 fwd=\"65.183.104.130\" dyno= connect= service= status=503 bytes= protocol=https\n2018-11-27T18:00:45.811042+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=boiling-eyrie-61189.herokuapp.com request_id=5fe9555a-e8df-4f09-be37-be8bd4e66af6 fwd=\"65.183.104.130\" dyno= connect= service= status=503 bytes= protocol=https\n</code></pre>\n\n<p>Here is my code that I have published to heroku.  Thanks for any insights you could give!</p>\n\n<p>App.go</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"html/template\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"strconv\"\n    \"time\"\n\n    \"github.com/julienschmidt/httprouter\"\n)\n\ntype Results struct {\n    Results []Result `json:\"results\"`\n}\n\ntype Result struct {\n    Name    string  `json:\"name\"`\n    Rating  float64 `json:\"rating\"`\n    Icon    string  `json:\"icon\"`\n    Address string  `json:\"vicinity\"`\n}\n\ntype Data struct {\n    Name    string\n    Rating  string\n    Icon    string\n    Address string\n}\n\ntype HP struct {\n    Title string\n}\n\nfunc Home(w http.ResponseWriter, r *http.Request, _ httprouter.Params) {\n    t, _ := template.ParseFiles(\"./public/templates/home.html\")\n    p := HP{Title: \"Eat The Shoals\"}\n    t.Execute(w, p)\n}\n\nfunc Search(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n    var url string\n\n    switch ps.ByName(\"name\") {\n    //cases taken out due to privacy issues\n    }\n\n    resultClient := http.Client{\n        Timeout: time.Second * 2,\n    }\n\n    req, err := http.NewRequest(http.MethodGet, url, nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    req.Header.Set(\"User-Agent\", \"eattheshoals\")\n\n    res, getErr := resultClient.Do(req)\n    if getErr != nil {\n        log.Fatal(getErr)\n    }\n\n    byteValue, _ := ioutil.ReadAll(res.Body)\n    //if readErr != nil {\n    //  log.Fatal(readErr)\n    //}\n\n    var results Results\n\n    jsonErr := json.Unmarshal(byteValue, &amp;results)\n    if jsonErr != nil {\n        log.Fatal(jsonErr)\n    }\n\n    values := make([]Data, len(results.Results), len(results.Results))\n\n    for i := 0; i &lt; len(results.Results); i++ {\n\n        values[i].Name = results.Results[i].Name\n        values[i].Rating = strconv.FormatFloat(results.Results[i].Rating, 'f', 1, 64)\n        values[i].Icon = results.Results[i].Icon\n        values[i].Address = results.Results[i].Address\n\n        //fmt.Println(\"Name: \" + results.Results[i].Name)\n        //fmt.Println(\"Rating: \" + strconv.FormatFloat(results.Results[i].Rating, 'f', 1, 64))\n        //fmt.Println(\"Icon: \" + results.Results[i].Icon)\n        //fmt.Println(\"Address : \" + results.Results[i].Address)\n    }\n    t, _ := template.ParseFiles(\"./public/templates/search.html\")\n    t.Execute(w, values)\n\n}\n\nvar homeTemplate *template.Template\n\nfunc determineListenAddress() (string, error) {\n    port := os.Getenv(\"PORT\")\n    if port == \"\" {\n        return \"\", fmt.Errorf(\"$PORT not set\")\n    }\n    return \":\" + port, nil\n}\n\nfunc main() {\n\n    //addr, err := determineListenAddress()\n    //if err != nil {\n    //  log.Fatal(err)\n    //}\n\n    router := httprouter.New()\n    router.GET(\"/search/:name\", Search)\n    router.GET(\"/\", Home)\n\n    port := os.Getenv(\"PORT\")\n    //log.Fatal(http.ListenAndServe(\":8080\", router))\n    //log.Printf(\"Listening on %s...\\n\", addr)\n    if err := http.ListenAndServe(\":\"+port, nil); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Procfile</p>\n\n<pre><code>web: app\n</code></pre>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1543342742, "post_id": 53505395, "comment_id": 93881261, "body": "Have you asked the package authors to provide the package in Go module and version form?"}, {"owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1543348009, "post_id": 53505395, "comment_id": 93883859, "body": "Not yet. I&#39;m hoping a mixed model is somehow possible so that package authors can migrate in their own time..otherwise we are bound by every single one of our direct and indirect dependencies as I currently understand it?"}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 0, "creation_date": 1543517835, "post_id": 53505395, "comment_id": 93958200, "body": "It IS a go module, with latest tag v2.0.0. Just import &quot;github.com/gbrlsnchs/jwt/v2&quot; (you just call it by <code>jwt</code>) in their github they have an example. Or I didn&#39;t understand your question..."}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "is_accepted": false, "score": 1, "last_activity_date": 1566239477, "creation_date": 1566239477, "answer_id": 57562173, "question_id": 53505395, "link": "https://stackoverflow.com/questions/53505395/how-to-reference-v2-0-0-of-a-go-package-that-doesnt-adhere-to-the-major-sub-fol/57562173#57562173", "title": "How to reference v2.0.0 of a Go package that doesn&#39;t adhere to the major sub folder convention as a module", "body": "<p><code>github.com/gbrlsnchs/jwt</code> at <code>v2.0.0</code> has a <code>go.mod</code> file that indicates that its canonical import path is <a href=\"https://github.com/gbrlsnchs/jwt/blob/808efa0714baff8c25cc65ef8681966740beb9f9/go.mod#L1\" rel=\"nofollow noreferrer\"><code>github.com/gbrlsnchs/jwt/v2</code></a>.</p>\n\n<p>Update your <code>import</code> statements to use that path \u2014 which should also work in GOPATH mode in Go 1.9.7, 1.10.3, 1.11.0, and above using \u201c<a href=\"http://golang.org/wiki/Modules#how-are-v2-modules-treated-in-a-build-if-modules-support-is-not-enabled-how-does-minimal-module-compatibility-work-in-197-1103-and-111\" rel=\"nofollow noreferrer\">minimal module compatibility</a>\u201d \u2014 and you should be good to go.</p>\n"}], "owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566239477, "creation_date": 1543341070, "question_id": 53505395, "link": "https://stackoverflow.com/questions/53505395/how-to-reference-v2-0-0-of-a-go-package-that-doesnt-adhere-to-the-major-sub-fol", "title": "How to reference v2.0.0 of a Go package that doesn&#39;t adhere to the major sub folder convention as a module", "body": "<p>We are running a spike to determine how or indeed if we can migrate our stack to Go modules.  We depend on v2.0.0 <a href=\"https://github.com/gbrlsnchs/jwt\" rel=\"nofollow noreferrer\">https://github.com/gbrlsnchs/jwt</a> but it is neither converted to a module itself nor does it adhere to the Go convention of putting major versions under sub-folders.</p>\n\n<p>What are our options here when it come to converting our internal package to a module that has this dependency?</p>\n"}, {"tags": ["json", "go", "marshalling", "unmarshalling"], "comments": [{"owner": {"reputation": 3090, "user_id": 1255656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ae7b898ac8bef50e80a02fb1aaf0b3?s=128&d=identicon&r=PG", "display_name": "azertiti", "link": "https://stackoverflow.com/users/1255656/azertiti"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543403019, "post_id": 53504992, "comment_id": 93904546, "body": "Thanks, I believe if what I&#39;m trying to do is not possible then it&#39;s a duplicated as you suggested. I will look into that solution as it seems to accomplish my initial goal, just in a different way."}, {"owner": {"reputation": 3090, "user_id": 1255656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ae7b898ac8bef50e80a02fb1aaf0b3?s=128&d=identicon&r=PG", "display_name": "azertiti", "link": "https://stackoverflow.com/users/1255656/azertiti"}, "edited": false, "score": 0, "creation_date": 1543858510, "post_id": 53504992, "comment_id": 94060295, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11126793/json-and-dealing-with-unexported-fields\">JSON and dealing with unexported fields</a>"}, {"owner": {"reputation": 3090, "user_id": 1255656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ae7b898ac8bef50e80a02fb1aaf0b3?s=128&d=identicon&r=PG", "display_name": "azertiti", "link": "https://stackoverflow.com/users/1255656/azertiti"}, "edited": false, "score": 0, "creation_date": 1543858572, "post_id": 53504992, "comment_id": 94060316, "body": "I think my initial approach was incorrect and impossible to work. The correct one is from <a href=\"https://stackoverflow.com/questions/11126793/json-and-dealing-with-unexported-fields\" title=\"json and dealing with unexported fields\">stackoverflow.com/questions/11126793/&hellip;</a> I voted to close it as duplicated."}], "answers": [{"comments": [{"owner": {"reputation": 3090, "user_id": 1255656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ae7b898ac8bef50e80a02fb1aaf0b3?s=128&d=identicon&r=PG", "display_name": "azertiti", "link": "https://stackoverflow.com/users/1255656/azertiti"}, "edited": false, "score": 0, "creation_date": 1543353262, "post_id": 53505371, "comment_id": 93886344, "body": "That will work as long as we are in the same package. &quot;value&quot; is not exported and my goal is not to allow changes to the map from outside the package. Having an exported interface is best idea I had for this so far but I haven&#39;t found a solution to make marshaling/unmarshaling work."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1543340937, "creation_date": 1543340937, "answer_id": 53505371, "question_id": 53504992, "link": "https://stackoverflow.com/questions/53504992/json-marshalling-with-type-not-exported/53505371#53505371", "title": "JSON marshalling with type not exported", "body": "<p>You need to give <code>json.Unmarshal()</code> a pointer to a concrete type. So change (from your linked playground):</p>\n\n<pre><code>unm := New()\n</code></pre>\n\n<p>to</p>\n\n<pre><code>unm := New().(value)\n</code></pre>\n"}], "owner": {"reputation": 3090, "user_id": 1255656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ae7b898ac8bef50e80a02fb1aaf0b3?s=128&d=identicon&r=PG", "display_name": "azertiti", "link": "https://stackoverflow.com/users/1255656/azertiti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 727, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543389336, "creation_date": 1543339408, "last_edit_date": 1543389336, "question_id": 53504992, "link": "https://stackoverflow.com/questions/53504992/json-marshalling-with-type-not-exported", "title": "JSON marshalling with type not exported", "body": "<p>I'm want to use a custom type which is not exported and define an interface to use it. The custom type will implement the interface and everything works fine except for unmarshaling from JSON.</p>\n\n<p>I created an example to explain it better:  </p>\n\n<pre><code>type (\n    Value interface {\n        Set(k, v string)\n    }\n\n    value map[string]string\n)\n\nfunc New() Value {\n    return value{}\n}\n\nfunc (val value) Set(k, v string) {\n    val[k] = v\n}\n</code></pre>\n\n<p>This approach will not provide direct access to the map and force the usage of New() function to create objects of type \"Value\".</p>\n\n<p>When trying to unmarshal in an object created with New() I'm getting the error:</p>\n\n<pre><code>Failed to unmarshal value json: cannot unmarshal object into Go value of type main.Value\n</code></pre>\n\n<p>That can be fixed by making New() return \"value\" instead of \"Value\" but will still be a problem when trying to unmarshal an object like:</p>\n\n<pre><code>Storage struct {\n        Val Value `json:\"val\"`\n}\n</code></pre>\n\n<p>Any suggestions? Implementing Unmarshaler doesn't help in this case. I create a go snippet with this example: <a href=\"https://play.golang.org/p/IEalgBCsTVR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IEalgBCsTVR</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543340430, "post_id": 53504913, "comment_id": 93879969, "body": "Unmarshal already takes an interface, all you need is to wrap the request+unmarshal logic into a func that takes an interface{} and then you can pass it values of concrete types."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543340782, "post_id": 53504913, "comment_id": 93880160, "body": "... here&#39;s an example of what i meant <a href=\"https://play.golang.com/p/8xQeQYOU_Af\" rel=\"nofollow noreferrer\">play.golang.com/p/8xQeQYOU_Af</a>"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543340786, "post_id": 53504913, "comment_id": 93880163, "body": "@mkopriva Good idea, but that won&#39;t solve my problem. The same thing would occur: after unmarshaling, the <code>model.List</code> will be a slice of whatever came in the response in the form of maps (representing the JSON objects), as opposed to it being a slice of whatever seed struct I gave the <code>model.List</code>. Does that make sense?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543340966, "post_id": 53504913, "comment_id": 93880258, "body": "Btw. your second example doesn&#39;t work because you didn&#39;t &quot;seed&quot; the list field with []interface{}... you seeded it with []Human. You should type assert the field&#39;s value to the type you used to seed the field with."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543341039, "post_id": 53504913, "comment_id": 93880289, "body": "Well, a <code>[]Human{}</code> will conform to a <code>interface{}</code> type. <code>interface{}</code> will take anything. And since <code>Human</code> is a <code>CanTalk</code>, in theory my <code>list[i].(CanTalk)</code> should work. But it doesn&#39;t, and I suspect that&#39;s because the <code>json.Unmarshal</code> is ignoring the seed I give it. <code>list[i]</code> ends up being a <code>map[string]interface{}</code> or something like that, instead of a <code>Human</code>/<code>CanTalk</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1543341288, "post_id": 53504913, "comment_id": 93880422, "body": "My bad, I completely missed that the List&#39;s element type is also an interface."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543341877, "post_id": 53504913, "comment_id": 93880762, "body": "<a href=\"https://play.golang.com/p/D9KT4bsTOlc\" rel=\"nofollow noreferrer\">play.golang.com/p/D9KT4bsTOlc</a> The problem seems to be that you&#39;re passing a pointer to the <code>interface{}</code> type instead of a pointer to the <code>[]Human</code> type."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1543341998, "post_id": 53504913, "comment_id": 93880850, "body": "@mkopriva Beautiful, thank you sir. Feel free to create an answer I can accept."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543342699, "post_id": 53504913, "comment_id": 93881239, "body": "@mkopriva Actually, your examples <i>does</i> solve the unmarshal problem (now it unmarshals into the proper seed type), however, it does not solve the problem of the casting within loops. That is still unresolved. I need to cast into <code>[]interface{}</code>, not a <code>*[]Human</code>, because remember this logic is meant to be generic and used for many different concrete types. Appreciated solution regardless cause it brings me one step further. I think reflection is necessary for the last piece."}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543341399, "creation_date": 1543339124, "last_edit_date": 1543341399, "question_id": 53504913, "link": "https://stackoverflow.com/questions/53504913/use-a-seed-for-json-unmarshal-into-a-slice-struct", "title": "Use a seed for json.Unmarshal into a slice struct", "body": "<p>I have an interesting problem.</p>\n\n<p>I want to make a request to an endpoint that gives me an array of objects back in an HTTP response. </p>\n\n<p>I then want to unmarshal that response into a slice struct. Easy enough.</p>\n\n<p>This code works:</p>\n\n<pre><code>type Human struct {}\nfunc (h Human) Talk() {}\n\ntype CanTalk interface{\n    Talk()\n}\n\ntype Model struct {\n    List []CanTalk\n}\n\nfunc main() {\n    model := Model{}\n\n    data, err := makeRequestToEndpoint()\n    if err != nil {\n        // ...\n    }\n\n    err = json.Unmarshal(data, &amp;model.List)\n    if err != nil {\n        // ...\n    }\n\n    for _, human := range model.List {\n        human.Talk()\n    }\n}\n</code></pre>\n\n<p>But here's the catch: I want to do this generically. </p>\n\n<p>I don't want to write this same logic for every single type in my system (since they're all in separate files), so I opted to use an <code>interface{}</code> as opposed to <code>[]CanTalk</code>, so that I could abstract the unmarshal and logic below it to a utility function. The <code>interface{}</code> is then seeded with a concrete type for json.Unmarshal.</p>\n\n<p>Even though this compiles and runs, it <em>does not</em> work:</p>\n\n<pre><code>type Human struct {}\nfunc (h Human) Talk() {}\n\ntype CanTalk interface{\n    Talk()\n}\n\ntype Model struct {\n    List interface{} // Using interface{} here instead of []CanTalk\n}\n\nfunc main() {\n    model := Model{List:[]Human{}} // Seeding the list with the specified type to unmarshal into\n\n    data, err := makeRequestToEndpoint()\n    if err != nil {\n        // ...\n    }\n\n    err = json.Unmarshal(data, &amp;model.List)\n    if err != nil {\n        // ...\n    }\n\n    if list, ok := model.List.([]interface{}); ok {\n        for i := range list {\n            // This line is never reached, because \"ok == false\"\n            if human, ok := list[i].(CanTalk); ok {\n                // Never reached\n                human.Talk()\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>As you can see, the unmarshal does not pick up on the seed that I gave to <code>model.List</code>. The output of <code>model.List</code> after unmarshaling is still in the format of the HTTP response payload (a <code>map[string]interface{}</code> or something like that), not the type of the seed, hence the failure to cast into a <code>CanTalk</code> type.</p>\n\n<p>Is this even possible, or would the only way to achieve this (short of real generics) be to repeat the unmarshal logic for each separate type in my system?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543339097, "post_id": 53504683, "comment_id": 93879266, "body": "Are you just asking how to check what the type of <code>cw</code> is? Assuming you have a limited number of combinations, just switch over all the possibilities."}, {"owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543339428, "post_id": 53504683, "comment_id": 93879435, "body": "@JimB I fail to see how, switching on <code>w.(type)</code> only gives me the latest type"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543339877, "post_id": 53504683, "comment_id": 93879669, "body": "If you don&#39;t know all the possible types, then there&#39;s nothing you can do except call interface methods, and you can always assert against any method set you want. How does a type switch not give you what you need? What extra method are you interested in?"}, {"owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543340251, "post_id": 53504683, "comment_id": 93879887, "body": "Probably what I&#39;m trying to do is awkward: I&#39;ve added a method to one of the writer (say <code>MyResponseWriter.setStuff</code>) so that I can store extra data in the ResponseWriter, that is later accessed by middlewares. What I ultimately want is to pass data from the handler up to the middleware."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543340645, "post_id": 53504683, "comment_id": 93880091, "body": "It&#39;s awkward but not difficult. Just type-assert each level until you get to the type (or interface) you want."}, {"owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543341147, "post_id": 53504683, "comment_id": 93880345, "body": "But that assumes that I know in advance the type hierarchy right? In this specific example the hierarchy is obvious, but in reality, I may have extra wrapping. A case I have is sometimes those writer are wrapped by the http.TimeoutHandler for instance."}], "answers": [{"comments": [{"owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "edited": false, "score": 0, "creation_date": 1543339682, "post_id": 53504871, "comment_id": 93879551, "body": "thanks, in my case I may not necessarily know what are all the underlying types :/"}, {"owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "edited": false, "score": 0, "creation_date": 1543340516, "post_id": 53504871, "comment_id": 93880016, "body": "The type switch can give me the underlying type (<code>MyOtherResponseWriter </code>) but here I want to access <code>MyResponseWriter</code>&#39;s method. Looks like I&#39;d need interfaces instead."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1543338969, "creation_date": 1543338969, "answer_id": 53504871, "question_id": 53504683, "link": "https://stackoverflow.com/questions/53504683/type-assertion-over-object-composed-several-times/53504871#53504871", "title": "Type assertion over object composed several times", "body": "<p>Depending on what type of logic you are looking for you could do something like:</p>\n\n<pre><code>var rw http.ResponseWriter = &amp;MyResponseWriter{\n  ResponseWriter: &amp;MyOtherResponseWriter{}\n}\ncw := rw.(*MyResponseWriter).ResponseWriter.(*MyOtherResponseWriter)\n</code></pre>\n\n<p>Notice that the code always has to \"know\" which type of <code>ResponseWriter</code> it has.</p>\n"}, {"comments": [{"owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "edited": false, "score": 0, "creation_date": 1543341563, "post_id": 53505440, "comment_id": 93880571, "body": "Is it possible to access <code>MyResponseWriter</code> methods in this specific case? That&#39;s what I&#39;d want but probably as you said I&#39;d need an interface for <code>MyResponseWriter</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "edited": false, "score": 0, "creation_date": 1543341673, "post_id": 53505440, "comment_id": 93880639, "body": "@Sylvain: Of course, you have a concrete <code>*MyResponseWriter</code> within the type switch, and you could also assert to whatever method set you want. You could return whatever type you want as well, this was just an example of using a common pre-defined interface."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1543341202, "creation_date": 1543341202, "answer_id": 53505440, "question_id": 53504683, "link": "https://stackoverflow.com/questions/53504683/type-assertion-over-object-composed-several-times/53505440#53505440", "title": "Type assertion over object composed several times", "body": "<p>If you're looking for an arbitrary method, on a field nested an arbitrary number of levels deep within your own types, you need to assert each level's type to get the candidate field. </p>\n\n<p>For example, if you wanted to determine if you have an <code>http.Flusher</code> using the types shown above, you could use a function like so:</p>\n\n<pre><code>func getFlusher(rw http.ResponseWriter) (http.Flusher, bool) {\n    switch t := rw.(type) {\n    case http.Flusher:\n        return t, true\n    case *MyResponseWriter:\n        return getFlusher(t.ResponseWriter)\n    case *MyOtherResponseWriter:\n        return getFlusher(t.ResponseWriter)\n    default:\n        return nil, false\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Li80bUzYTft\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Li80bUzYTft</a></p>\n"}], "owner": {"reputation": 2982, "user_id": 101969, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/48654d1f98a490b18d91d85945d65a93?s=128&d=identicon&r=PG", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/101969/sylvain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1543341202, "creation_date": 1543338298, "question_id": 53504683, "link": "https://stackoverflow.com/questions/53504683/type-assertion-over-object-composed-several-times", "title": "Type assertion over object composed several times", "body": "<p>Is it possible to do type assertion over any of the sub type of an object composed several times?</p>\n\n<p>Example, say I have the following objects:</p>\n\n<pre><code>type MyResponseWriter struct {\n    http.ResponseWriter\n    // ...\n}\n\ntype MyOtherResponseWriter struct {\n    http.ResponseWriter\n    // ...\n}\n</code></pre>\n\n<p>I might end up with something like this:</p>\n\n<pre><code>rw := &amp;MyOtherResponseWriter{ResponseWriter: &amp;MyResponseWriter{ResponseWriter: w}}\n</code></pre>\n\n<p>Now if I have a <code>w http.ResponseWriter</code>, is it possible to 'cast' it to either a <code>MyOtherResponseWriter</code> or a <code>MyResponseWriter</code> ?</p>\n\n<pre><code>cw.(*MyResponseWriter) // panic: interface conversion: http.ResponseWriter is *MyOtherResponseWriter, not *MyResponseWriter\n</code></pre>\n\n<p>FWIW, my actual use case is that in a <code>http.Handler</code> I'm dealing with a <code>http.ResponseWriter</code> that's been wrapped several times and I fail to access the extra method that interests me, and the reason I want to do this is to allow a middleware to access data written by the handler.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["algorithm", "go", "recursion", "channel", "goroutine"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1543338116, "post_id": 53504603, "comment_id": 93878706, "body": "Why would you want to post a result / completed job on the same channel? If you do so, other workers may pick that up (what would they do with it? whatever would that be, the original worker that completed it could also do that without the resend / receive overhead). For recommendation, check out: <a href=\"https://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go/38172204#38172204\">Is this an idiomatic worker thread pool in Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10712817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pOCElcYyz9k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt6eFc8wEpCidqzf_C37e7qJQlPg/mo/photo.jpg?sz=128", "display_name": "Jesse Lurie", "link": "https://stackoverflow.com/users/10712817/jesse-lurie"}, "edited": false, "score": 0, "creation_date": 1543338983, "post_id": 53504722, "comment_id": 93879211, "body": "Thank you for the response. I am solving a problem that should use recursion but that would cause memory issues. So I decided to try and implement a worker pool to continuously receive work from a channel, do the work, then pass that value back to the same channel it is receiving, and if one worker finds the value then I would like for them all to gracefully exit. I am having issues trying to figure out the best way to define this pattern without dealing with deadlock issues. would really appreciate some direction thank you in advanced"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 11, "user_id": 10712817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pOCElcYyz9k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt6eFc8wEpCidqzf_C37e7qJQlPg/mo/photo.jpg?sz=128", "display_name": "Jesse Lurie", "link": "https://stackoverflow.com/users/10712817/jesse-lurie"}, "edited": false, "score": 0, "creation_date": 1543339210, "post_id": 53504722, "comment_id": 93879312, "body": "Are you using a buffered channel?"}, {"owner": {"reputation": 11, "user_id": 10712817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pOCElcYyz9k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt6eFc8wEpCidqzf_C37e7qJQlPg/mo/photo.jpg?sz=128", "display_name": "Jesse Lurie", "link": "https://stackoverflow.com/users/10712817/jesse-lurie"}, "edited": false, "score": 0, "creation_date": 1543339843, "post_id": 53504722, "comment_id": 93879655, "body": "I am currently experimenting with both. and have had better results with a buffered channel."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 11, "user_id": 10712817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pOCElcYyz9k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt6eFc8wEpCidqzf_C37e7qJQlPg/mo/photo.jpg?sz=128", "display_name": "Jesse Lurie", "link": "https://stackoverflow.com/users/10712817/jesse-lurie"}, "edited": false, "score": 0, "creation_date": 1543339884, "post_id": 53504722, "comment_id": 93879671, "body": "Buffered channels will likely work better for you given the fact that the same go routine is reading a writing"}, {"owner": {"reputation": 11, "user_id": 10712817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pOCElcYyz9k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt6eFc8wEpCidqzf_C37e7qJQlPg/mo/photo.jpg?sz=128", "display_name": "Jesse Lurie", "link": "https://stackoverflow.com/users/10712817/jesse-lurie"}, "edited": false, "score": 0, "creation_date": 1543343567, "post_id": 53504722, "comment_id": 93881704, "body": "thank you! any suggestions on how to handle gracefully ending the go routines once the result is found ?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 11, "user_id": 10712817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pOCElcYyz9k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt6eFc8wEpCidqzf_C37e7qJQlPg/mo/photo.jpg?sz=128", "display_name": "Jesse Lurie", "link": "https://stackoverflow.com/users/10712817/jesse-lurie"}, "edited": false, "score": 0, "creation_date": 1543344252, "post_id": 53504722, "comment_id": 93882046, "body": "I would use a shared context. Consume from the channel via a select where you read from the channel in one case and read from the Done() channel of the context on the other. Once you find the answer cancel the context. This will instruct all the other go-routines (who are also reading from the context) to bail."}, {"owner": {"reputation": 11, "user_id": 10712817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pOCElcYyz9k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt6eFc8wEpCidqzf_C37e7qJQlPg/mo/photo.jpg?sz=128", "display_name": "Jesse Lurie", "link": "https://stackoverflow.com/users/10712817/jesse-lurie"}, "edited": false, "score": 0, "creation_date": 1543347465, "post_id": 53504722, "comment_id": 93883588, "body": "Thank you I will try to implement this. I Appreciate your time and responses"}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1543338428, "creation_date": 1543338428, "answer_id": 53504722, "question_id": 53504603, "link": "https://stackoverflow.com/questions/53504603/worker-pool-that-reads-and-writes-to-same-channel-go/53504722#53504722", "title": "Worker pool that reads and writes to same channel go", "body": "<p>There is no reason why something can't (from Go's perspective) write back to a channel after reading it:</p>\n\n<pre><code>func Foo(c chan int) {\n  x := &lt;-c\n  // do something to x\n  c &lt;- x\n}\n</code></pre>\n\n<p>This is weird though... And honestly would not recommend it. Normally I have seen a system composed of several channels with data being passed down and not entering cycles. Think trees instead of graphs.</p>\n"}], "owner": {"reputation": 11, "user_id": 10712817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pOCElcYyz9k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt6eFc8wEpCidqzf_C37e7qJQlPg/mo/photo.jpg?sz=128", "display_name": "Jesse Lurie", "link": "https://stackoverflow.com/users/10712817/jesse-lurie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543338428, "creation_date": 1543337955, "question_id": 53504603, "link": "https://stackoverflow.com/questions/53504603/worker-pool-that-reads-and-writes-to-same-channel-go", "title": "Worker pool that reads and writes to same channel go", "body": "<p>I need your help. Currently i'm trying to create a worker pool that reads continuous jobs from a channel and then produces the result to the same channel it is reading from to then do work and produce the result to the same channel. you get the idea sorta like recursion. Is there any way to make this possible?\nI would really your appreciate advice on design patterns to implement this solution using go routines as a worker pool and channels to read in jobs and then from the same worker pool write the result of that job to the same channel to keep working. Thank you. </p>\n"}, {"tags": ["ssl", "go", "dns"], "answers": [{"tags": [], "owner": {"reputation": 1309, "user_id": 7613702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyAB4.png?s=128&g=1", "display_name": "pale bone", "link": "https://stackoverflow.com/users/7613702/pale-bone"}, "is_accepted": true, "score": 0, "last_activity_date": 1543424350, "last_edit_date": 1543424350, "creation_date": 1543335617, "answer_id": 53503924, "question_id": 53503901, "link": "https://stackoverflow.com/questions/53503901/using-autocert-for-multiple-subdomains-and-ip-addresses-via-dns/53503924#53503924", "title": "Using autocert for multiple subdomains and ip addresses via DNS", "body": "<p>Add both domains to the cert manager white list:</p>\n\n<pre><code>certManager := autocert.Manager{\n            Prompt:     autocert.AcceptTOS,\n            HostPolicy: autocert.HostWhitelist(\"domain.me\", \"filesharing.domain.me\"), //Your domain here\n            Cache:      autocert.DirCache(\"certs\"),             //Folder for storing certificates\n        }\n</code></pre>\n\n<p>and add two A records to the DNS:\n<a href=\"https://i.stack.imgur.com/ERGY3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ERGY3.png\" alt=\"dns setup\"></a></p>\n"}], "owner": {"reputation": 1309, "user_id": 7613702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyAB4.png?s=128&g=1", "display_name": "pale bone", "link": "https://stackoverflow.com/users/7613702/pale-bone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 53503924, "answer_count": 1, "score": 0, "last_activity_date": 1543424350, "creation_date": 1543335524, "last_edit_date": 1543424269, "question_id": 53503901, "link": "https://stackoverflow.com/questions/53503901/using-autocert-for-multiple-subdomains-and-ip-addresses-via-dns", "title": "Using autocert for multiple subdomains and ip addresses via DNS", "body": "<p>I have two separate servers using the same domain name with separate prefixes, one doing some app stuff and one doing filesharing. Using the <code>autocert</code> package how can I just configure the cert manager to produce a certificate that I can use on both servers?</p>\n"}, {"tags": ["go", "synchronization"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 7, "creation_date": 1543329719, "post_id": 53502089, "comment_id": 93873441, "body": "What is a &quot;perfect singleton&quot;?  Most people consider singletons to be an anti-pattern, so kind of the opposite of perfect. Is there a problem you&#39;re trying to solve?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1543329795, "post_id": 53502089, "comment_id": 93873484, "body": "I&#39;m not sure I understand what the goal is here. How is this better than simply initializing <code>instance</code>, like <code>var instance = &amp;singleton{}</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1543332642, "post_id": 53502089, "comment_id": 93875240, "body": "Package initialization (including evaluation of expressions and the assignment in variable declarations) happens safely, in a single goroutine, before that variable can be accessed. As JimB pointed out, there is no need for that code kung-fu unless your real initialization is more complex and you only want to execute that on-demand."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543332980, "post_id": 53502089, "comment_id": 93875439, "body": "Even if you require more complex initialization, using atomics to <code>flush instance to all CPUs</code> doesn&#39;t make sense. You need synchronization, which <code>sync.Once</code> provides."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1543338219, "post_id": 53502089, "comment_id": 93878769, "body": "I think this isn&#39;t as crazy as some people may think. Each CPU has a cache and lockless algorithms normally have to be worried about what a cache on a CPU may have. That being said, its not necessary here. But I don&#39;t think its great to say it doesn&#39;t make sense."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1543342372, "post_id": 53502089, "comment_id": 93881058, "body": "@poy: this isn&#39;t a &quot;lockless algorithm&quot;, nor can atomics be used to ensure what each thread views with a simple store because they don&#39;t provide synchronization points in the memory model. Just writing something atomically (even if it guarantees cache coherence) doesn&#39;t mean the thread waited around for that to happen.  Now you could safely loop over a Load, or CompareAndSwap to block while waiting for the value to be written, but then you&#39;ve just re-implemented a Mutex for discernible reason."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543342528, "post_id": 53502089, "comment_id": 93881143, "body": "@JimB I agree with all your points. Thats why I said &quot;its not necessary here&quot; for this not being a lockless algorithm. Lockless algorithms have to employ various strategies for polling memory to wait for things to have changed. I would rather put this sort of information out here though instead of saying memory syncing between CPUs isn&#39;t a thing (because it certainly can be)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1543342829, "post_id": 53502089, "comment_id": 93881310, "body": "@poy: sorry, I hadn&#39;t read your answer yet, thanks for clarifying. I was referring specifically to the described use case, as like you said, atomics and memory coherence are real issues, they&#39;re just not relevant here."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543708293, "post_id": 53502089, "comment_id": 94016470, "body": "as far as know, atomic.Store(write barrier) only store data to store buffer of CPU and flush to L1 cache asynchronously and then send a invalid message to other CPUs. atomic.Load(read barrier) will block read until consum all invalid message from invalidate queue. So, that is why atomic.Store and atomic.Load should be used together. in the implementation of once.Do, it only flush store buffer to L1 cache and send invalid message to other CPUs, so might be i need&#39;t to use atomic.StorePointer(&amp;instance,&amp;singleton{}), but ` return atomic.LoadPointer(&amp;instance)` is necessary."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543410868, "post_id": 53504651, "comment_id": 93909170, "body": "i think Once.Do is only guarantee execute function f one time. and atomic.StoreUint32(&amp;o.done, 1) is only memory barrier for o.done. it doesn&#39;t ensure instance is global visible"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543412127, "post_id": 53504651, "comment_id": 93909949, "body": "Once uses locks though which will force each CPU to refresh it&#39;s cache."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543413253, "post_id": 53504651, "comment_id": 93910736, "body": "if locks will force each CPU to refresh its cache, why need <code>atomic.StoreUint32(&amp;o.done, 1)</code> ?  just need <code>o.done=1</code>"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543413365, "post_id": 53504651, "comment_id": 93910802, "body": "Well you don&#39;t need to use both. Atomics are more of a &quot;hardware&quot; lock and are an alternative to locks. They are used in lockless algorithms, which honestly is quite hard to get right."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543413744, "post_id": 53504651, "comment_id": 93911039, "body": "once.Do use both, you can check it.  So, i don&#39;t think so."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543421874, "post_id": 53504651, "comment_id": 93916495, "body": "Once uses an atomic to try and &quot;skip&quot; the mutex. A mutex is more expensive as it can block and wait for the lock to become available. An atomic will take a fixed number of clock cycles because it doesn&#39;t block. So really it is an optimization the library did for you."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543449129, "post_id": 53504651, "comment_id": 93928249, "body": "Once :  <code>defer atomic.StoreUint32(&amp;o.done, 1)</code> is extra? As you said, it should be changed to <code>o.done=1</code> because locker will ensure cache coherence."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543449300, "post_id": 53504651, "comment_id": 93928292, "body": "Correct. If you only take what they called the slow path then you don&#39;t require the atomics because you are never accessing the memory outside of the mutex."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543450939, "post_id": 53504651, "comment_id": 93928624, "body": "So, in <a href=\"https://golang.org/src/sync/once.go\" rel=\"nofollow noreferrer\">golang.org/src/sync/once.go</a> :  <code>defer atomic.StoreUint32(&amp;o.done, 1)</code> should be changed to <code>o.done=1</code> ??? So, go author wrote no sense code"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543453850, "post_id": 53504651, "comment_id": 93929273, "body": "No. I said they have an optimization with the fast path"}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543493695, "post_id": 53504651, "comment_id": 93944774, "body": "sorry, i still don&#39;t understand. the 40 line of source (<a href=\"https://golang.org/src/sync/once.go\" rel=\"nofollow noreferrer\">golang.org/src/sync/once.go</a>), they have used lock,but 43 line of source, they also used atomic. i don&#39;t know where it&#39;s optimization as you said"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543506312, "post_id": 53504651, "comment_id": 93952229, "body": "So before they enter the lock they read from an integer via atomics. If that value is set, they bail and never enter the lock. If it is not set they enter the lock and eventually set the integer. Now they have to use atomics because if a different go routine calls the function, it will read that integer. To do that safely they use atomics. So to safely read that memory outside of a lock, both the read and write (even though the write happens to be within a lock) have to be via atomics."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543531245, "post_id": 53504651, "comment_id": 93963951, "body": "i known this condition <code>if atomic.LoadUint32(&amp;o.done) == 1</code> is in order to reduce the frequency of lock.Lock().  but you have said <code>defer o.m.Unlock()</code> will ensure cache coherence, and <code>defer atomic.StoreUint32(&amp;o.done, 1)</code> also will ensure cache coherence, so, <code>defer atomic.StoreUint32(&amp;o.done, 1)</code> is extra because <code>defer o.m.Unlock()</code> will be called after set 1 to o.done."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543531646, "post_id": 53504651, "comment_id": 93964085, "body": "Well not quite. So the <code>Unlock()</code> will only serve you if when you read from the memory you have first called <code>Lock()</code>. This means that when you load memory, the CPU and compiler have been instructed based on the locking that they must ensure the memory is up to date. Just calling <code>Unlock()</code> on its own will not ensure this. Atomics and locks have different strategies on how they instruct the compiler and hardware to handle memory."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543532722, "post_id": 53504651, "comment_id": 93964445, "body": "so, in my second snippet, <code>atomic.StorePointer(&amp;instance, &amp;singleton{})</code> and <code>atomic.LoadPointer(&amp;instance)</code> are usefull, because it ensure all CPUs update their caches."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543532957, "post_id": 53504651, "comment_id": 93964492, "body": "No I don&#39;t believe so. The Once ensures that the only place that <code>instance</code> is being modified is always going to happen before it being read. Therefore any read after the first will always have the latest memory (as it was only changed the one time) and the CPUs&#39; cache will have been updated via either the fast or slow path of the Once."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543533962, "post_id": 53504651, "comment_id": 93964739, "body": "you said &quot;CPU&#39;s cache will have been updated in Once function&quot;, and only lock.Lock() ensure memory is up to date, but <code>atomic.StorePointer(&amp;instance,&amp;singleton{})</code> is in behind of it. and if <code>defer atomic.StoreUint32(&amp;o.done, 1)</code> is usefull , why is <code>atomic.StorePointer(&amp;instance,&amp;singleton{})</code> useless?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543534246, "post_id": 53504651, "comment_id": 93964821, "body": "Because you get the once fast path for free. Their code already ensures the happens before state for you and therefore you don&#39;t have to worry."}, {"owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543587378, "post_id": 53504651, "comment_id": 93983890, "body": "as far as know, atomic.Store(write barrier) only store data to store buffer of CPU and flush to L1 cache asynchronously and then send a invalid message to other CPUs.  atomic.Load(read barrier) will block read until consum all invalid message from invalidate queue. So, that is why atomic.Store and atomic.Load should be used together.  in the implementation of once.Do, it only flush store buffer to L1 cache and send invalid message to other CPUs, so might be i need&#39;t to use <code>atomic.StorePointer(&amp;instance,&amp;singleton{})</code>, but ` return atomic.LoadPointer(&amp;instance)` is necessary."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "edited": false, "score": 0, "creation_date": 1543591045, "post_id": 53504651, "comment_id": 93986016, "body": "I&#39;m not sure about that, however at the very least I think the race detector will be unhappy"}, {"owner": {"reputation": 137, "user_id": 4985915, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-UYzwi3fQxNg/AAAAAAAAAAI/AAAAAAAAABg/HviOe15j6UQ/photo.jpg?sz=128", "display_name": "gaurav arora", "link": "https://stackoverflow.com/users/4985915/gaurav-arora"}, "edited": false, "score": 0, "creation_date": 1595239562, "post_id": 53504651, "comment_id": 111395416, "body": "how to free resources on application close? like if its a database singleton and I want to free the connection, how to write destructor function?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 137, "user_id": 4985915, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-UYzwi3fQxNg/AAAAAAAAAAI/AAAAAAAAABg/HviOe15j6UQ/photo.jpg?sz=128", "display_name": "gaurav arora", "link": "https://stackoverflow.com/users/4985915/gaurav-arora"}, "edited": false, "score": 0, "creation_date": 1597969042, "post_id": 53504651, "comment_id": 112313109, "body": "@gauravarora There isn&#39;t a homerun answer here. Typically this is where people use context.Context. When the context is cancelled, the resource is cleaned up. But even then there are some issues with this. If the main go routine exits for example, you may not have time to finish cleaning up. Therefore you need something like a WaitGroup to block the main go routine."}, {"owner": {"reputation": 137, "user_id": 4985915, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-UYzwi3fQxNg/AAAAAAAAAAI/AAAAAAAAABg/HviOe15j6UQ/photo.jpg?sz=128", "display_name": "gaurav arora", "link": "https://stackoverflow.com/users/4985915/gaurav-arora"}, "edited": false, "score": 0, "creation_date": 1598092677, "post_id": 53504651, "comment_id": 112349154, "body": "can you provide an example code for this? near about for production sanity? I am not able to figure out this snippet with full confidence for golang. @poy I understand its not a homerun, but just asking about golang tools and kit. Context documentation and tryout examples are still difficult for me to understand with the current official documentation and test cases given by golang-community."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 2, "last_activity_date": 1543338145, "creation_date": 1543338145, "answer_id": 53504651, "question_id": 53502089, "link": "https://stackoverflow.com/questions/53502089/perfect-singleton-via-using-sync-once/53504651#53504651", "title": "&quot;Perfect singleton&quot; via using sync.Once?", "body": "<p>Lets break down your question to two pieces:</p>\n\n<ol>\n<li>Singletons</li>\n<li>Atomics and the Go memory model</li>\n</ol>\n\n<h2>Singletons</h2>\n\n<p>Go has package level variables. These are instantiated before anything has the chance to get moving, therefore if you good with these things being created as soon as the package is used, you get a singleton for free.</p>\n\n<pre><code>package somepack\n\nvar(\n  connection = createConn()\n)\n\nfunc Connection() SomeConnection {\n  return connection\n}\n</code></pre>\n\n<p><code>connection</code> will be created once and therefore <code>Connection()</code> will return the same instance of it safely.</p>\n\n<p>Sometimes developers reach for a singleton when they want \"lazy\" instantiation. This is a good idea if the resource is expensive to create and not always needed. This is where <code>sync.Once</code> is useful.</p>\n\n<pre><code>var (\n  connection SomeConnection // Not instantiated\n  connectionOnce sync.Once\n)\n\nfunc Connection() SomeConnection {\n  connectionOnce.Do(func(){\n    connection = createConn()\n  })\n\n  return connection\n}\n</code></pre>\n\n<p>Notice I'm not doing anything special with the assignment (e.g., <code>atomic.Store()</code>). This is because <code>sync.Once</code> takes care of all the locking required for this to be safe.</p>\n\n<h2>Atomics and the Go memory model</h2>\n\n<p>A good resource to start with is the published docs for this: <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">The Go Memory Model</a></p>\n\n<p>Your concern of \"flushing\" to the different CPUs is valid (despite some of the comments) because each CPU has its own cache with its own state. C++ (among other languages like Rust) developers tend to care about this because they get to. Go developers don't get to care AS much because Go only has \"happens before\". Rust in fact has some nice <a href=\"https://doc.rust-lang.org/std/sync/atomic/enum.Ordering.html\" rel=\"nofollow noreferrer\">docs</a> on it.</p>\n\n<p>That being said, you normally don't need to worry about it. A mutex (and <code>sync.Once</code>) will force the state of the memory on each CPU to be what you would expect.</p>\n"}], "owner": {"reputation": 27, "user_id": 10322698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fabcfbd6b950b994d5a2c960446fa48e?s=128&d=identicon&r=PG&f=1", "display_name": "flying010101", "link": "https://stackoverflow.com/users/10322698/flying010101"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1348, "favorite_count": 0, "closed_date": 1543344214, "accepted_answer_id": 53504651, "answer_count": 1, "score": -4, "last_activity_date": 1543364758, "creation_date": 1543329506, "last_edit_date": 1543364758, "question_id": 53502089, "link": "https://stackoverflow.com/questions/53502089/perfect-singleton-via-using-sync-once", "closed_reason": "Needs details or clarity", "title": "&quot;Perfect singleton&quot; via using sync.Once?", "body": "<p>i am confusing that, is below snippet perfect?</p>\n\n<pre><code>import \"sync\"\nimport \"sync/atomic\"\n\nvar initialized uint32\nvar instance *singleton\n\nvar instance *singleton\nvar once sync.Once\n\nfunc GetInstance() *singleton {\n    once.Do(func() {\n        instance = &amp;singleton{}\n    })\n    return instance\n}\n</code></pre>\n\n<p><code>atomic.StoreUint32(&amp;initialized, 1)</code> will flush instance to all CPUs?\ni think i need add an atomic store and load for instance, like below snippet</p>\n\n<pre><code>var instance *singleton\nvar once sync.Once\n\nfunc GetInstance() *singleton {\n    once.Do(func() {\n        atomic.StorePointer(&amp;instance, &amp;singleton{})\n    })\n    return atomic.LoadPointer(&amp;instance)\n}\n</code></pre>\n\n<p>i think Once.Do is only guarantee execute function f one time.\nand <code>atomic.StoreUint32(&amp;o.done, 1)</code> is only memory barrier for o.done. \nit doesn't ensure <code>instance</code> is global visible</p>\n\n<pre><code>func (o *Once) Do(f func()) {\n    if atomic.LoadUint32(&amp;o.done) == 1 {\n        return\n    }\n    // Slow-path.\n    o.m.Lock()\n    defer o.m.Unlock()\n    if o.done == 0 {\n        defer atomic.StoreUint32(&amp;o.done, 1)\n        f()\n    }\n}\n</code></pre>\n"}, {"tags": ["string", "go", "string-formatting", "qsqlquery"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 11, "last_activity_date": 1543328058, "last_edit_date": 1543328058, "creation_date": 1543327716, "answer_id": 53501554, "question_id": 53501486, "link": "https://stackoverflow.com/questions/53501486/format-a-string-the-contains-golang/53501554#53501554", "title": "format a string the contains &#39;%&#39; golang", "body": "<p>As documented in the <a href=\"https://golang.org/pkg/fmt/#hdr-Printing\" rel=\"noreferrer\"><code>fmt</code></a> package, a literal <code>%</code> can be represented by <code>%%</code> in a printf format string:</p>\n\n<pre><code>query := fmt.Sprintf(\"SELECT name FROM sessions WHERE name ILIKE '%s.%%'\", orgName)\n</code></pre>\n\n<p>But be aware, you should <strong><em>NEVER, EVER</em></strong> build your SQL queries this way!  You are potentially opening yourself for <a href=\"https://en.wikipedia.org/wiki/SQL_injection\" rel=\"noreferrer\">SQL injection</a> attacks.  Instead, you should pass parameterized arguments:</p>\n\n<pre><code>query := \"SELECT name FROM sessions WHERE name ILIKE ?\"\nrows, err := db.Query(query, orgName + \".%\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1717, "user_id": 1034924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecedc78563223e4f7742bbfc66992905?s=128&d=identicon&r=PG", "display_name": "nzajt", "link": "https://stackoverflow.com/users/1034924/nzajt"}, "is_accepted": false, "score": 1, "last_activity_date": 1543327819, "creation_date": 1543327819, "answer_id": 53501582, "question_id": 53501486, "link": "https://stackoverflow.com/questions/53501486/format-a-string-the-contains-golang/53501582#53501582", "title": "format a string the contains &#39;%&#39; golang", "body": "<p>In go it is just <code>fmt.Printf(\"%s is how you write a %%\", \"This\")</code></p>\n\n<p><a href=\"https://play.golang.org/p/RIJKRADYzCk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RIJKRADYzCk</a></p>\n"}], "owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 0, "closed_date": 1561718597, "accepted_answer_id": 53501554, "answer_count": 2, "score": -1, "last_activity_date": 1543328058, "creation_date": 1543327511, "last_edit_date": 1543327861, "question_id": 53501486, "link": "https://stackoverflow.com/questions/53501486/format-a-string-the-contains-golang", "closed_reason": "Duplicate", "title": "format a string the contains &#39;%&#39; golang", "body": "<p>I have an SQL query that looks like this:<br></p>\n\n<pre><code>SELECT name FROM sessions WHERE name ILIKE 'org_name.%';\n</code></pre>\n\n<p>but I'm actually interested in replacing 'org_name' with format string (%s).<br>\nI was trying to do something like this:<br></p>\n\n<pre><code>query := fmt.Sprintf(\"SELECT name FROM sessions WHERE name ILIKE '%s.%'\", \"org_name2\")\n</code></pre>\n\n<p>but go seems to not like it, since writing %' isn't valid as format string.\n<br>\nI know I can solve it with do it in that way:</p>\n\n<pre><code>orgName := \"org_name2\"\ncondition := fmt.Sprintf(\"%s\", orgName) + \".%\"\nquery := fmt.Sprintf(\"SELECT name FROM sessions WHERE name ILIKE '%s'\", condition)\n</code></pre>\n\n<p><br>but, I'd rather not, since the variable here is solely the org_name.\n<br>Is there a solution for this?\n<br>Thanks!</p>\n"}, {"tags": ["database", "go", "psql"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8213883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9a63b87c2e0fe464e611048fa6c977?s=128&d=identicon&r=PG&f=1", "display_name": "Chandan Kumar", "link": "https://stackoverflow.com/users/8213883/chandan-kumar"}, "edited": false, "score": 0, "creation_date": 1543332713, "post_id": 53502822, "comment_id": 93875285, "body": "When i&#39;m trying to print jobsdata using (log.Infof(&quot;---&gt;&quot;, jobsdata)) , i get this  <code>INFO[0004] ---&gt;%!(EXTRA handler.Jobs=[{36884 success aws-cluster} {36885 success openebs-aws-deploy} {36903 failed app-upgrade-deployment}])</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 13, "user_id": 8213883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9a63b87c2e0fe464e611048fa6c977?s=128&d=identicon&r=PG&f=1", "display_name": "Chandan Kumar", "link": "https://stackoverflow.com/users/8213883/chandan-kumar"}, "edited": false, "score": 0, "creation_date": 1543332866, "post_id": 53502822, "comment_id": 93875372, "body": "Okay. I&#39;m not sure how that&#39;s relevant? Is there a point you&#39;re trying to make?"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 0, "last_activity_date": 1543333165, "last_edit_date": 1543333165, "creation_date": 1543332154, "answer_id": 53502822, "question_id": 53501313, "link": "https://stackoverflow.com/questions/53501313/how-to-insert-json-data-to-postgresql/53502822#53502822", "title": "How to insert JSON data to PostgreSQL", "body": "<p>As the error indicates, you're trying to bind the sixth value from an unsupported data type, <code>handler.Jobs</code>.  You haven't told us what this type is, but from the error, it's clear that it does not implement the <a href=\"https://golang.org/pkg/database/sql/driver/#Valuer\" rel=\"nofollow noreferrer\"><code>driver.Valuer</code></a> interface, so it won't work, because it has no way of knowing how to represent that value to the database.</p>\n\n<p>You'll need to implement that interface, by adding a <code>Value()</code> method to the <code>handler.Jobs</code> type, or use a different data type.</p>\n"}, {"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": -1, "last_activity_date": 1543334281, "creation_date": 1543334281, "answer_id": 53503505, "question_id": 53501313, "link": "https://stackoverflow.com/questions/53501313/how-to-insert-json-data-to-postgresql/53503505#53503505", "title": "How to insert JSON data to PostgreSQL", "body": "<p>sqlx has a type <a href=\"https://godoc.org/github.com/jmoiron/sqlx/types#JSONText\" rel=\"nofollow noreferrer\">JSONText</a> in <a href=\"https://github.com/jmoiron/sqlx/blob/master/types/types.go\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx/types</a> that will do what you need.</p>\n\n<p><a href=\"https://gist.github.com/rrafal/09534862e05cd98e4eb9b17dd5fcc1fc\" rel=\"nofollow noreferrer\">Example</a></p>\n"}], "owner": {"reputation": 13, "user_id": 8213883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9a63b87c2e0fe464e611048fa6c977?s=128&d=identicon&r=PG&f=1", "display_name": "Chandan Kumar", "link": "https://stackoverflow.com/users/8213883/chandan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1237, "favorite_count": 0, "accepted_answer_id": 53502822, "answer_count": 2, "score": -1, "last_activity_date": 1543334281, "creation_date": 1543326929, "last_edit_date": 1543333397, "question_id": 53501313, "link": "https://stackoverflow.com/questions/53501313/how-to-insert-json-data-to-postgresql", "title": "How to insert JSON data to PostgreSQL", "body": "<p>I have the json field like blow which I want to store in database    </p>\n\n<pre><code>{\n      id:          1\n      name:        \"test entity 1\"\n      description: \"a test entity for some guy's blog\"\n      status: \"passed\"\n      web_url: \"http://localhost:3000\"\n      jobs: [{\n         id:        \"1\"\n         name:      \"test1\"\n         status:    \"passed\"\n        },\n        {\n         id:        \"2\"\n         name:      \"test2\"\n         status:    \"passed\"\n        },\n        {\n         id:        \"3\"\n         name:      \"test3\"\n         status:    \"failed\"\n       }]\n    }\n</code></pre>\n\n<p>I proceed with one way like for creating table uses:</p>\n\n<pre><code>CREATE TABLE test3 (id INT PRIMARY KEY, name VARCHAR, description VARCHAR, status VARCHAR, web_url VARCHAR, jobs JSON[]);\n</code></pre>\n\n<p>and for Inserting data uses:</p>\n\n<pre><code>sqlStatement := `\n            INSERT INTO jobs (id, name, description, status, web_url, jobs)\n            VALUES ($1, $2, $3, $4, $5, $6)\n            ON CONFLICT (id) DO UPDATE\n            SET status = $4\n            RETURNING id`\n        id := 0\n        err = database.Db.QueryRow(sqlStatement, y[i].ID, y[i].Name, y[i].Description, y[i].Status, y[i].WebURL, jobsdata).Scan(&amp;id)\n        if err != nil {\n            panic(err)\n        }\n</code></pre>\n\n<p>But won't work, need help!!</p>\n\n<p>Getting errors:</p>\n\n<pre><code>panic: sql: converting argument $6 type: unsupported type handler.Jobs, a slice of struct\n</code></pre>\n\n<p>What i want:</p>\n\n<pre><code>postgres=# SELECT * FROM test3;\nid |    name       |             description           | status  |       web_url          |                           jobs                           \n------+------------------------------------------+--------+---------+----------------------------------------------------------+----------------------------------------------------------\n 1 | test entity 1 | a test entity for some guy's blog | passed | https://localhost:3000 | {id: \"1\",name: \"test1\", status: \"passed\"},{id: \"2\",name: \"test2\", status: \"passed\"},{id: \"3\",name: \"test3\", status: \"failed\"}\n</code></pre>\n"}, {"tags": ["go", "gcc", "gccgo"], "owner": {"reputation": 31, "user_id": 10711879, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jDK-WGQmihM/AAAAAAAAAAI/AAAAAAAAA4Y/Ha2HGVFw258/photo.jpg?sz=128", "display_name": "Anjie", "link": "https://stackoverflow.com/users/10711879/anjie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1543336306, "creation_date": 1543326472, "last_edit_date": 1543336306, "question_id": 53501174, "link": "https://stackoverflow.com/questions/53501174/how-to-import-value-in-gccgo-to-perform-something-like-go-linker-ldflags-x-does", "title": "How to import value in GCCGO to perform something like go linker ldflags -X does in GC compiler", "body": "<p>Now, I have the bash code which can import the version value to the go source code in compiling time using the linker which is in the go tool. This code can run normally with GC. </p>\n\n<blockquote>\n  <p>go build -ldflags \"-X something:something\" main.go</p>\n</blockquote>\n\n<p>But I am testing my code in the machine whose architecture only supports gccgo instead of gc, and gccgo does not support -ldflags which is a linker tool in gc. Though gccgo has flag options which is -gccgoflags, I didn't see the linking flag I need.</p>\n\n<p>I want to know whether there are any relative flags in gccgo or are there any alternative way to insert the value into source code?</p>\n\n<p>I don't want to hard code this feature with bash.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1543332268, "post_id": 53500200, "comment_id": 93875041, "body": "Can you please show a package structure?"}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1543332366, "creation_date": 1543332366, "answer_id": 53502889, "question_id": 53500200, "link": "https://stackoverflow.com/questions/53500200/golang-gin-load-html-timeout/53502889#53502889", "title": "golang gin load html timeout", "body": "<p>If your index.html file is located in views/index/index.html, you should use this wildcard. Also try to use <code>./</code>.</p>\n\n<pre><code>r.LoadHTMLGlob(\"./views/*\")\nr.GET(\"/\", func(g *gin.Context) {\n  g.HTML(http.StatusOK, \"index/index.html\", gin.H{\n    \"title\":\"test\",\n  }\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 10688849, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B5samaixAUk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-irMEE6KZkLO_ARuHXwPJxsOruPag/mo/photo.jpg?sz=128", "display_name": "Jonni", "link": "https://stackoverflow.com/users/10688849/jonni"}, "is_accepted": false, "score": 0, "last_activity_date": 1544001604, "creation_date": 1544001604, "answer_id": 53628869, "question_id": 53500200, "link": "https://stackoverflow.com/questions/53500200/golang-gin-load-html-timeout/53628869#53628869", "title": "golang gin load html timeout", "body": "<p>This problem dose not seem to be caused by template load,could you show your package info or show more code?</p>\n\n<p>There is my package:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>views\n-|index\n-|-|index.html\nmain.go\n</code></pre>\n\n\n\n<p>main.go:\n</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n    \"net/http\"\n)\n\nfunc main(){\n    router := gin.Default()\n    //define template dir\n    router.LoadHTMLGlob(\"views/**/*\")\n    // handel router\n    router.GET(\"/\",func(c *gin.Context){\n        c.HTML(http.StatusOK,\"index/index.html\",gin.H{\n            \"title\":\"test\",\n        })\n    })\n\n    router.Run(\":8080\")\n}\n</code></pre>\n\n\n\n<p>views/index/index.html:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>{{define \"index/index.html\"}}\n    asdds\n{{end}}\n</code></pre>\n\n\n\n<p>The demo can run normally.I found that only one difference is that if you use subdir in LoadHTMLGlob, I should define the template in html look like that\uff1a</p>\n\n<pre><code>{{define \"index/index.html\"}}{{end}}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10711561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b992a92d825278aa069b9dbdac84c6aa?s=128&d=identicon&r=PG&f=1", "display_name": "WC.LIU", "link": "https://stackoverflow.com/users/10711561/wc-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1322, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1597030751, "creation_date": 1543323212, "last_edit_date": 1597030751, "question_id": 53500200, "link": "https://stackoverflow.com/questions/53500200/golang-gin-load-html-timeout", "title": "golang gin load html timeout", "body": "<p>Gin always reports errors when loading index.html</p>\n\n<pre><code>r := gin.New()\nr.Use(gin.Logger())\nr.Use(gin.Recovery())\nr.LoadHTMLGlob(\"views/**/*\")\nr.GET(\"/\", func(g *gin.Context) {\n    g.HTML(http.StatusOK, \"index/index.html\", gin.H{\n        \"title\":\"test\",\n    })\n</code></pre>\n\n<hr>\n\n<pre><code>2018/11/27 20:23:46 [Recovery] 2018/11/27 - 20:23:46 panic recovered:\nGET / HTTP/1.1\nHost: localhost:8080\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nAccept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q=0.9,en;q=0.8\nCache-Control: max-age=0\nConnection: keep-alive\nCookie: pix_k=admin; pix_v=L5lsdrVKJmpAa21DGibdbA%3D%3D\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36\n\n\nwrite tcp [::1]:8080-&gt;[::1]:55738: i/o timeout\nC:/Go/src/runtime/panic.go:505 (0x4300c7)\n    gopanic: reflectcall(nil, unsafe.Pointer(d.fn), deferArgs(d), uint32(d.siz), uint32(d.siz))\nG:/gowork/src/github.com/gin-gonic/gin/context.go:725 (0xae81de)\n    (*Context).Render: panic(err)\nG:/gowork/src/github.com/gin-gonic/gin/context.go:734 (0xae82a6)\n    (*Context).HTML: c.Render(code, instance)\nG:/gowork/src/ihaveadream/routers/routers.go:18 (0xaffa91)\n    InitRouter.func1: g.HTML(http.StatusOK, \"index/index.html\", gin.H{\nG:/gowork/src/github.com/gin-gonic/gin/context.go:108 (0xae3952)\n    (*Context).Next: c.handlers[c.index](c)\nG:/gowork/src/github.com/gin-gonic/gin/recovery.go:52 (0xafca97)\n    RecoveryWithWriter.func1: c.Next()\nG:/gowork/src/github.com/gin-gonic/gin/context.go:108 (0xae3952)\n    (*Context).Next: c.handlers[c.index](c)\nG:/gowork/src/github.com/gin-gonic/gin/logger.go:84 (0xafb889)\n    LoggerWithWriter.func1: c.Next()\nG:/gowork/src/github.com/gin-gonic/gin/context.go:108 (0xae3952)\n    (*Context).Next: c.handlers[c.index](c)\nG:/gowork/src/github.com/gin-gonic/gin/gin.go:362 (0xaee92c)\n    (*Engine).handleHTTPRequest: c.Next()\nG:/gowork/src/github.com/gin-gonic/gin/gin.go:328 (0xaee403)\n    (*Engine).ServeHTTP: engine.handleHTTPRequest(c)\nC:/Go/src/net/http/server.go:2694 (0x7643ca)\n    serverHandler.ServeHTTP: handler.ServeHTTP(rw, req)\nC:/Go/src/net/http/server.go:1830 (0x75f118)\n    (*conn).serve: serverHandler{c.server}.ServeHTTP(w, w.req)\nC:/Go/src/runtime/asm_amd64.s:2361 (0x45bcb0)\n    goexit: BYTE    $0x90   // NOP\n\n\n2018/11/27 20:23:46 [Recovery] 2018/11/27 - 20:23:46 panic recovered:\nGET / HTTP/1.1\nHost: localhost:8080\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nAccept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q=0.9,en;q=0.8\nCache-Control: max-age=0\nConnection: keep-alive\nCookie: pix_k=admin; pix_v=L5lsdrVKJmpAa21DGibdbA%3D%3D\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36\n\n\nwrite tcp [::1]:8080-&gt;[::1]:55736: i/o timeout\nC:/Go/src/runtime/panic.go:505 (0x4300c7)\n    gopanic: reflectcall(nil, unsafe.Pointer(d.fn), deferArgs(d), uint32(d.siz), uint32(d.siz))\nG:/gowork/src/github.com/gin-gonic/gin/context.go:725 (0xae81de)\n    (*Context).Render: panic(err)\nG:/gowork/src/github.com/gin-gonic/gin/context.go:734 (0xae82a6)\n    (*Context).HTML: c.Render(code, instance)\nG:/gowork/src/ihaveadream/routers/routers.go:18 (0xaffa91)\n    InitRouter.func1: g.HTML(http.StatusOK, \"index/index.html\", gin.H{\nG:/gowork/src/github.com/gin-gonic/gin/context.go:108 (0xae3952)\n    (*Context).Next: c.handlers[c.index](c)\nG:/gowork/src/github.com/gin-gonic/gin/recovery.go:52 (0xafca97)\n    RecoveryWithWriter.func1: c.Next()\nG:/gowork/src/github.com/gin-gonic/gin/context.go:108 (0xae3952)\n    (*Context).Next: c.handlers[c.index](c)\nG:/gowork/src/github.com/gin-gonic/gin/logger.go:84 (0xafb889)\n    LoggerWithWriter.func1: c.Next()\nG:/gowork/src/github.com/gin-gonic/gin/context.go:108 (0xae3952)\n    (*Context).Next: c.handlers[c.index](c)\nG:/gowork/src/github.com/gin-gonic/gin/gin.go:362 (0xaee92c)\n    (*Engine).handleHTTPRequest: c.Next()\nG:/gowork/src/github.com/gin-gonic/gin/gin.go:328 (0xaee403)\n    (*Engine).ServeHTTP: engine.handleHTTPRequest(c)\nC:/Go/src/net/http/server.go:2694 (0x7643ca)\n    serverHandler.ServeHTTP: handler.ServeHTTP(rw, req)\nC:/Go/src/net/http/server.go:1830 (0x75f118)\n    (*conn).serve: serverHandler{c.server}.ServeHTTP(w, w.req)\nC:/Go/src/runtime/asm_amd64.s:2361 (0x45bcb0)\n    goexit: BYTE    $0x90   // NOP\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543326556, "post_id": 53499797, "comment_id": 93871487, "body": "The construct <code>slice[:]</code> isn\u2019t ever used in real code, but I\u2019ve seen a number of new users try to do this. Where are you finding documentation which led you to using it at all?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543326901, "post_id": 53499797, "comment_id": 93871722, "body": "@JimB Basically it&#39;s only ever useful if applied on arrays."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543327267, "post_id": 53499797, "comment_id": 93871956, "body": "@icza: yes, of course it&#39;s needed with arrays, and I figured it might be users cargo-culting the pattern with slices. I just was curious if there was some source that demonstrated this with slices in the first place, since it seems to come up more often than I&#39;d expect."}, {"owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 0, "creation_date": 1543327506, "post_id": 53499797, "comment_id": 93872106, "body": "@Stefano-Sambruna But you are using the right way to see the address. There is other way to safely copy the slice."}, {"owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543330835, "post_id": 53499797, "comment_id": 93874159, "body": "@icza you have just show how to check the size and cap of slices. But that does not ensure that whether the slices are same or not. Their address should be checked."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 0, "creation_date": 1543331558, "post_id": 53499797, "comment_id": 93874574, "body": "@ShudiptaSharma Yes, that&#39;s correct, but copying and slicing a slice like that will always point to the same backing array as verified by the asker. My answer mainly focuses on the points missed by the asker."}, {"owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543338501, "post_id": 53499797, "comment_id": 93878941, "body": "@icza Yes, I know that. But in this case, there are ways to copy a slice into another one without pointing to the source slice."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 2, "creation_date": 1543338666, "post_id": 53499797, "comment_id": 93879046, "body": "@ShudiptaSharma Yes, obviously, but this question isn&#39;t about that. As in the title, it asks if the 2 operations are the same."}, {"owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 0, "creation_date": 1543338861, "post_id": 53499797, "comment_id": 93879163, "body": "But on the first line of question description the OP said, &quot;What I want to do is to copy a slice into another one&quot;. That&#39;s why I&#39;m concern about that and &#39;ve posted an answer."}, {"owner": {"reputation": 607, "user_id": 6783371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eQwnc.jpg?s=128&g=1", "display_name": "Stefano Sambruna", "link": "https://stackoverflow.com/users/6783371/stefano-sambruna"}, "reply_to_user": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 0, "creation_date": 1543341193, "post_id": 53499797, "comment_id": 93880370, "body": "@ShudiptaSharma What do you mean?"}, {"owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 0, "creation_date": 1543341357, "post_id": 53499797, "comment_id": 93880459, "body": "I happened when I was talking with icza, then suddenly he stopped talking. instead of you were talking with me about the exactly same topic that i and icza were talking."}, {"owner": {"reputation": 607, "user_id": 6783371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eQwnc.jpg?s=128&g=1", "display_name": "Stefano Sambruna", "link": "https://stackoverflow.com/users/6783371/stefano-sambruna"}, "reply_to_user": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "edited": false, "score": 0, "creation_date": 1543341418, "post_id": 53499797, "comment_id": 93880489, "body": "@ShudiptaSharma man, seriously, is it all good at home?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1543322990, "last_edit_date": 1543322990, "creation_date": 1543322630, "answer_id": 53500011, "question_id": 53499797, "link": "https://stackoverflow.com/questions/53499797/is-slice2-slice1-equal-to-slice2-slice1-in-golang/53500011#53500011", "title": "Is slice2 := slice1 equal to slice2 := slice1[:] in GoLang?", "body": "<p>The result is the same.</p>\n\n<p>One thing you didn't check is the capacity, another property of slices. So let's check that one too:</p>\n\n<pre><code>s := make([]int, 2, 4)\ns2 := s\ns3 := s[:]\n\nfmt.Println(len(s), cap(s))\nfmt.Println(len(s2), cap(s2))\nfmt.Println(len(s3), cap(s3))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/uHMTEHyjssB\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2 4\n2 4\n2 4\n</code></pre>\n\n<p>Basically the <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"noreferrer\">slice expression</a> <code>s[:]</code> means to slice the slice, and use 0 as the lower index, and <code>len(s)</code> as the upper, and <code>cap(s)</code> as the capacity. So the result will be a slice identical to <code>s</code>.</p>\n\n<p>For readability, just copy the slice header: <code>s2 := s</code>.</p>\n\n<p>Also note that if <code>s</code> would be <code>nil</code>, both copying it and slicing it will also result in <code>nil</code> slices:</p>\n\n<pre><code>var s []int\ns2 := s\ns3 := s[:]\n\nfmt.Println(len(s), cap(s), s == nil)\nfmt.Println(len(s2), cap(s2), s2 == nil)\nfmt.Println(len(s3), cap(s3), s3 == nil)\n</code></pre>\n\n<p>Output of the above is (try it on the <a href=\"https://play.golang.org/p/lDjoDkFN4dN\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>0 0 true\n0 0 true\n0 0 true\n</code></pre>\n\n<p>So there is absolutely no difference in the result. A compiler implementation may or may not mimic the <code>s2 := s</code> statement when you write <code>s2 := s[:]</code>, so the latter <em>may</em> be slower. But again, there is no reason not to simply copy it.</p>\n"}], "owner": {"reputation": 607, "user_id": 6783371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eQwnc.jpg?s=128&g=1", "display_name": "Stefano Sambruna", "link": "https://stackoverflow.com/users/6783371/stefano-sambruna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53500011, "answer_count": 1, "score": 3, "last_activity_date": 1543341750, "creation_date": 1543321965, "last_edit_date": 1543341750, "question_id": 53499797, "link": "https://stackoverflow.com/questions/53499797/is-slice2-slice1-equal-to-slice2-slice1-in-golang", "title": "Is slice2 := slice1 equal to slice2 := slice1[:] in GoLang?", "body": "<p>Do the two following lines of code do the same thing in GoLang? What I want to do is to copy a slice into another one:</p>\n\n<pre><code>slice1 := make([]int, 5)\nslice2 := slice1 #line1\nslice2 := slice1[:] #line2\n</code></pre>\n\n<p>I run this code to test the behaviour, but apparently they both work int the same way:</p>\n\n<pre><code>func main() {\n    s1 := make([]int, 5, 5)\n    s1[2] = 33\n    fmt.Printf(\"s1: %v: address of slice %p\\n\", s1, &amp;s1)\n    s2 := s1[:]\n    s2[1] = 5\n    fmt.Printf(\"s2: %v: address of slice %p\\n\", s2, &amp;s2)\n    s3 := s1\n    s3[0] = 23\n    fmt.Printf(\"s3: %v: address of slice %p\\n\",s3, &amp;s3)\n    fmt.Printf(\"s2: %v: address of slice %p\\n\", s2, &amp;s2)\n    fmt.Printf(\"s1: %v: address of slice %p\\n\", s1, &amp;s1)\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>s1: [0 0 33 0 0]: address of slice 0x40c0e0\ns2: [0 5 33 0 0]: address of slice 0x40c100\ns3: [23 5 33 0 0]: address of slice 0x40c120\ns2: [23 5 33 0 0]: address of slice 0x40c100\ns1: [23 5 33 0 0]: address of slice 0x40c0e0\n</code></pre>\n\n<p>So the memory addresses of the slices (s1, s2, s3) are different  but the pointers to the arrays contained into them, point to the same memory address. </p>\n\n<p>I'm wondering if there is something that changes between this two ways, or if there is a sort of convention that says what's better to use.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1543320704, "post_id": 53498988, "comment_id": 93867924, "body": "<a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">tour.golang.org/methods/15</a> . Redo the whole Tour."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543322081, "post_id": 53498988, "comment_id": 93868751, "body": "Why are you ignoring the value returned by <code>context.WithValue</code>?"}, {"owner": {"reputation": 15, "user_id": 10706029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saoOm.jpg?s=128&g=1", "display_name": "Nitin Soni", "link": "https://stackoverflow.com/users/10706029/nitin-soni"}, "edited": false, "score": 0, "creation_date": 1543327133, "post_id": 53498988, "comment_id": 93871872, "body": "@Fimzy, It is a sample code snippet. :)"}], "answers": [{"tags": [], "owner": {"reputation": 1720, "user_id": 6205738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a08adf9353636c19dc5a4e45df11d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Saty", "link": "https://stackoverflow.com/users/6205738/saty"}, "is_accepted": false, "score": 2, "last_activity_date": 1543320241, "creation_date": 1543320241, "answer_id": 53499282, "question_id": 53498988, "link": "https://stackoverflow.com/questions/53498988/how-does-context-valuekey-interface-interface-work/53499282#53499282", "title": "How does Context.Value(key interface{}) interface{} work?", "body": "<p><code>ctx.Value(\"myKey\")</code> returns an interface. So <code>.(*myStruct)</code> does a type assertion to convert it to the type <code>*myStruct</code>. So the <code>value</code> on the left hand side is of type <code>*myStruct</code> and you can access its fields e.g. <code>value.ID</code>. </p>\n\n<p>A version of your example can be seen here: <a href=\"https://play.golang.org/p/Eg0v3vuSi6y\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Eg0v3vuSi6y</a></p>\n"}], "owner": {"reputation": 15, "user_id": 10706029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saoOm.jpg?s=128&g=1", "display_name": "Nitin Soni", "link": "https://stackoverflow.com/users/10706029/nitin-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1229, "favorite_count": 0, "closed_date": 1543327984, "answer_count": 1, "score": -1, "last_activity_date": 1543333658, "creation_date": 1543319277, "last_edit_date": 1543322046, "question_id": 53498988, "link": "https://stackoverflow.com/questions/53498988/how-does-context-valuekey-interface-interface-work", "closed_reason": "Duplicate", "title": "How does Context.Value(key interface{}) interface{} work?", "body": "<p>Please see the below code</p>\n\n<pre><code>import (\n    ...\n    \"context\"\n    ...\n)\n\ntype myStruct struct {\n    ID  string\n    Sig string\n}\n\nmySig := myStruct{\n    ID:  \"12345678\",\n    Sig: \"Secret_Signature_Token\",\n}\n\n// Setting a Value associated with a Key in Context\n_ := context.WithValue(ctx, \"myKey\", &amp;mySig)           -- 1\n\n//Getting the same value\nvalue, ok := ctx.Value(\"myKey\").(*myStruct)            -- 2\n</code></pre>\n\n<p>Now, my question is: what is the use/meaning of <code>.(*myStruct)</code> in the above expression number 2\nCould someone please explain the statement number 2 step by step.</p>\n"}, {"tags": ["node.js", "go", "interface", "callback", "implements"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543314745, "post_id": 53497599, "comment_id": 93864523, "body": "Your Go code is invalid, and won&#39;t even compile. But more directly related to your question: Please explain your end goal. What exactly are you trying to accomplish? You probably can&#39;t do it the same way you would in Node, but you can probably do it somehow. Focus on the problem you&#39;re trying to solve, not your imagined solution."}, {"owner": {"reputation": 21, "user_id": 7041778, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/586781201508909/picture?type=large", "display_name": "Kim Ericko", "link": "https://stackoverflow.com/users/7041778/kim-ericko"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543315653, "post_id": 53497599, "comment_id": 93865090, "body": "Thank for commenting. I want to overwrite func DoSomething of canDoSomething that AStruct implements in file b.go. I know my code cann&#39;t compile and run but i think everyone can understand what i want to do"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543318357, "post_id": 53497599, "comment_id": 93866558, "body": "How does a callback relate to wanting to overwrite a method?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543318576, "post_id": 53497599, "comment_id": 93866683, "body": "The term &quot;overwrite&quot; looks like a translation artifact to me. There is no overwriting going on in the NodeJS code either. It looks like the intended meaning is &quot;assign&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1543317182, "creation_date": 1543317182, "answer_id": 53498409, "question_id": 53497599, "link": "https://stackoverflow.com/questions/53497599/implementing-interface-from-different-package-callback-from-other-module/53498409#53498409", "title": "Implementing interface from different package (callback from other module)", "body": "<blockquote>\n  <p>Can I overwrite logic for interface functions in file B.go?</p>\n</blockquote>\n\n<p>No, interfaces in Go (and other languages) do not have any logic or implementation.</p>\n\n<p>To implement an interface in Go, we just need to implement all the methods in the interface.</p>\n\n<p>How you may do A and B types implement same interface with different logic:</p>\n\n<pre><code>type Doer interface {\n    Do(string)\n}\n\ntype A struct {\n    name string\n}\nfunc (a *A) Do(name string){\n    a.name = name;\n    // do one thing\n}\n\ntype B struct {\n    name string\n}\nfunc (b *B) Do(name string){\n    b.name = name;\n    // do another thing\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7041778, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/586781201508909/picture?type=large", "display_name": "Kim Ericko", "link": "https://stackoverflow.com/users/7041778/kim-ericko"}, "edited": false, "score": 0, "creation_date": 1543371038, "post_id": 53498723, "comment_id": 93891775, "body": "<b>Thank you so much</b>"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1543318341, "creation_date": 1543318341, "answer_id": 53498723, "question_id": 53497599, "link": "https://stackoverflow.com/questions/53497599/implementing-interface-from-different-package-callback-from-other-module/53498723#53498723", "title": "Implementing interface from different package (callback from other module)", "body": "<p>Functions are first class values in Go, just like they are in JavaScript. You don't need an interface here (unless there is some other goal that you are not stating):</p>\n\n<pre><code>type A struct {\n    name string\n    callback func()\n}\n\nfunc (a *A) DoSomeThingWithName(name string){\n    a.name = name;\n    a.callback()\n}\n\nfunc main() {\n    a := &amp;A{\n        callback: func() { /* ... */ },\n    }\n\n    a.DoSomeThingWithName(\"KimKim\")\n}\n</code></pre>\n\n<p>Since all types can have methods, all types (including function types) can implement interfaces. So if you really want to you can let A depend on an interface and define a function type for providing implementations on-the-fly:</p>\n\n<pre><code>type Doer interface {\n    Do()\n}\n\n// DoerFunc is a function type that turns any func() into a Doer.\ntype DoerFunc func()\n\n// Do implements Doer\nfunc (f DoerFunc) Do() { f() }\n\ntype A struct {\n    name     string\n    callback Doer\n}\n\nfunc (a *A) DoSomeThingWithName(name string) {\n    a.name = name\n    a.callback.Do()\n}\n\nfunc main() {\n    a := &amp;A{\n        callback: DoerFunc(func() { /* ... */ }),\n    }\n\n    a.DoSomeThingWithName(\"KimKim\")\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7041778, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/586781201508909/picture?type=large", "display_name": "Kim Ericko", "link": "https://stackoverflow.com/users/7041778/kim-ericko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 53498723, "answer_count": 2, "score": -1, "last_activity_date": 1543318341, "creation_date": 1543314484, "last_edit_date": 1543314678, "question_id": 53497599, "link": "https://stackoverflow.com/questions/53497599/implementing-interface-from-different-package-callback-from-other-module", "title": "Implementing interface from different package (callback from other module)", "body": "<p>In NodeJS, I can declare a callback in one place and use it in one place to avoid breaking the structure of the project.</p>\n\n<p>A.js</p>\n\n<pre><code>module.exports = class A(){\n    constructor(name, callback){\n        this.name = name;\n        this.callback = callback;\n    }\n    doSomeThingWithName(name){\n        this.name = name;\n        if(this.callback){\n            this.callback();\n        }\n    }\n}\n</code></pre>\n\n<p>B.js</p>\n\n<pre><code>const A = require(./A);\nnewA = new A(\"KimKim\", ()=&gt; console.log(\"Say Oyeah!\"));\n</code></pre>\n\n<p>In Go, I also want to do the same thing like this with interface and implement.</p>\n\n<p>A.go</p>\n\n<pre><code>type canDoSomething interface {\n    DoSomething()\n}\ntype AStruct struct {\n    name string\n    callback canDoSomething\n}\nfunc (a *AStruct) DoSomeThingWithName(name string){\n    a.name = name;\n    a.callback.DoSomething()\n}\n</code></pre>\n\n<p>B.go</p>\n\n<pre><code>import (A);\nnewA = A{}\nnewA.DoSomeThingWithName(\"KimKim\");\n</code></pre>\n\n<p>Can I overwrite logic for interface functions in file B.go? How could I do to make them equivalent to NodeJS's style?</p>\n\n<p>I try</p>\n\n<pre><code>import (A);\nnewA = A{}\n\n// I want\n//newA.callback.DoSomething = func(){}...\n// or\n// func (a *AStruct) DoSomething(){}...\n// :/\nnewA.DoSomeThingWithName(\"KimKim\");\n</code></pre>\n"}, {"tags": ["postgresql", "go", "timestamp"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1543313033, "post_id": 53496746, "comment_id": 93863558, "body": "Are you sure you&#39;re connecting to the same database in both your Go program an psql? Did you change the search_path in the Go program so it&#39;s querying the certs table in a different schema? Do you have permission to read the columns? What happens if you mention them explicitly (<code>SELECT uuid, ...</code> instead of <code>SELECT *</code>)?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543313841, "post_id": 53496746, "comment_id": 93863985, "body": "It really looks like your table is missing those columns. I concur with Peter: Ensure that the database you&#39;re connecting to actually has those columns on that table."}, {"owner": {"reputation": 609, "user_id": 2002790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6768d52fa30111dbfa56ce06cb497c69?s=128&d=identicon&r=PG", "display_name": "amrx", "link": "https://stackoverflow.com/users/2002790/amrx"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1543334194, "post_id": 53496746, "comment_id": 93876320, "body": "@Peter, not possible. I verified them. I made a small change in the same codebase to delete the table and the table was deleted when checked through <code>psql</code> . If the go app connected to some other database then one connected with psql, the cert table would not have been dropped."}, {"owner": {"reputation": 68, "user_id": 1838539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94a74af69a77a36de933614556eba315?s=128&d=identicon&r=PG", "display_name": "Pavel Tsvetkov", "link": "https://stackoverflow.com/users/1838539/pavel-tsvetkov"}, "edited": false, "score": 0, "creation_date": 1566529285, "post_id": 53496746, "comment_id": 101693708, "body": "Can you get what you want by plain sql query? Can you change Select stirng from * to uuid, serialnumber, validtill, validfrom?"}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1543318559, "post_id": 53498499, "comment_id": 93866675, "body": "This does not relate to the question. Null fields will still show up in the result--as <code>nil</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543323873, "post_id": 53498499, "comment_id": 93869771, "body": "Maybe, but that doesn&#39;t make this an answer to the question."}, {"owner": {"reputation": 609, "user_id": 2002790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6768d52fa30111dbfa56ce06cb497c69?s=128&d=identicon&r=PG", "display_name": "amrx", "link": "https://stackoverflow.com/users/2002790/amrx"}, "edited": false, "score": 0, "creation_date": 1543334306, "post_id": 53498499, "comment_id": 93876396, "body": "@AlexPliutau, I changed the schema to so that columns are no longer nullable but the issue persists."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 609, "user_id": 2002790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6768d52fa30111dbfa56ce06cb497c69?s=128&d=identicon&r=PG", "display_name": "amrx", "link": "https://stackoverflow.com/users/2002790/amrx"}, "edited": false, "score": 0, "creation_date": 1543334607, "post_id": 53498499, "comment_id": 93876579, "body": "@amrx: To be clear, there is no reason to change the schema to be non-nullable. This is completely unrelated to your situation."}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "reply_to_user": {"reputation": 609, "user_id": 2002790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6768d52fa30111dbfa56ce06cb497c69?s=128&d=identicon&r=PG", "display_name": "amrx", "link": "https://stackoverflow.com/users/2002790/amrx"}, "edited": false, "score": 0, "creation_date": 1543334933, "post_id": 53498499, "comment_id": 93876780, "body": "@amrx you should also define local variables for scan (var ...) inside <code>res.Next</code> block."}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": -2, "last_activity_date": 1543334998, "last_edit_date": 1543334998, "creation_date": 1543317522, "answer_id": 53498499, "question_id": 53496746, "link": "https://stackoverflow.com/questions/53496746/timestamp-columns-missing-with-postgres/53498499#53498499", "title": "Timestamp columns missing with postgres", "body": "<p>There is a specific way of working with nullable fields in Go. You should use nullable types like <code>sql.NullString</code> or <code>sql.NullInt64</code>, etc. Otherwise you will get Scan errors.</p>\n\n<p>Also you should define vars for Scan inside <code>res.Next</code> block.</p>\n\n<p>This article explains in details how to use it - <a href=\"https://pliutau.com/working-with-db-nulls/\" rel=\"nofollow noreferrer\">https://pliutau.com/working-with-db-nulls/</a></p>\n"}], "owner": {"reputation": 609, "user_id": 2002790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6768d52fa30111dbfa56ce06cb497c69?s=128&d=identicon&r=PG", "display_name": "amrx", "link": "https://stackoverflow.com/users/2002790/amrx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1566529285, "creation_date": 1543311809, "last_edit_date": 1566480163, "question_id": 53496746, "link": "https://stackoverflow.com/questions/53496746/timestamp-columns-missing-with-postgres", "title": "Timestamp columns missing with postgres", "body": "<p>I have a Postgres table called <code>certs</code> with 4 columns.</p>\n\n<pre><code>enter code here\n\\d certs\n                        Table \"public.certs\"\nColumn       |            Type             | Collation | Nullable | Default\n-------------+-----------------------------+-----------+----------+---------\nuuid         | character varying(255)      |           | not null |\nserialnumber | bigint                      |           |          |\nvalidtill    | timestamp without time zone |           |          |\nvalidfrom    | timestamp without time zone |           |          |\nIndexes:\n\"certs_pkey\" PRIMARY KEY, btree (uuid)\n</code></pre>\n\n<p>As you can see the last 2 columns are of type <code>timestamp</code>. Now I try to read all the rows in the columns in the following way</p>\n\n<pre><code>res, err := sql.DB.Query(\"SELECT * from certs;\")\nif err == nil{\n    log.Fatal(err)\n}\nfmt.Println(res.Columns())\ndefer res.Close()\nvar id string\nvar serialNumber int64\nvar validFrom time.Time\nvar validTill time.Time\nfmt.Println(res.ColumnTypes())\nfor res.Next() {\n    err := res.Scan(&amp;id, &amp;serialNumber, &amp;validFrom, &amp;validTill)\n    fmt.Println(res.Columns())\n    if err != nil {\n        log.Errorf(\"error %v\", err)\n    } else {\n        cs.Certs[id] = serialNumber\n    }\n</code></pre>\n\n<p>Basically I am trying to decode values retrieved.</p>\n\n<p>I get the following error </p>\n\n<pre><code> error sql: expected 2 destination arguments in Scan, not 4\n</code></pre>\n\n<p>Also the print <code>res.columns()</code> prints this</p>\n\n<pre><code>[uuid serialnumber] &lt;nil&gt;\n</code></pre>\n\n<p>As you can see there is error and also the <code>columns</code> printed don't show <code>validtill</code> and <code>validfrom</code>. Independent checking of database using <code>psql</code> does indeed verifies that there are <code>validtill</code> and <code>validfrom</code> columns with data in them.</p>\n\n<p>What am I missing here? Why the error?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 5, "last_activity_date": 1543313744, "last_edit_date": 1592644375, "creation_date": 1543307948, "answer_id": 53495625, "question_id": 53495532, "link": "https://stackoverflow.com/questions/53495532/string-function-in-syscall-errno/53495625#53495625", "title": "String function in syscall.Errno", "body": "<p>The answer is found in the <code>fmt</code> documentation <a href=\"https://golang.org/pkg/fmt/#hdr-Printing\" rel=\"nofollow noreferrer\">here</a>:</p>\n<blockquote>\n<p>If the format (which is implicitly %v for Println etc.) is valid for a string (%s %q %v %x %X), the following two rules apply:</p>\n<ol start=\"4\">\n<li><p>If an operand implements the error interface, the Error method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</li>\n<li><p>If an operand implements method String() string, that method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</li>\n</ol>\n</blockquote>\n<p>So actually, for any value that supports both, the <code>String()</code> method is never called at all, since the <code>error</code> interface takes precidence over the <code>Stringer</code> interface.  You can test this with a program like <a href=\"https://play.golang.org/p/EbZpJN_iJVS\" rel=\"nofollow noreferrer\">this one</a>:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\ntype foo string\n\nfunc (f foo) String() string {\n    return &quot;string&quot;\n}\n\nfunc (f foo) Error() string {\n    return &quot;error&quot;\n}\n\nfunc main() {\n    fmt.Println(foo(&quot;&quot;))\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>error\n</code></pre>\n"}], "owner": {"reputation": 2779, "user_id": 957130, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/05be4f754d3836ad621740c90ee10bfb?s=128&d=identicon&r=PG", "display_name": "Marcin Pietraszek", "link": "https://stackoverflow.com/users/957130/marcin-pietraszek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 53495625, "answer_count": 1, "score": 0, "last_activity_date": 1606362152, "creation_date": 1543307528, "last_edit_date": 1543307759, "question_id": 53495532, "link": "https://stackoverflow.com/questions/53495532/string-function-in-syscall-errno", "title": "String function in syscall.Errno", "body": "<p>Reading through the 7.8 section of \"The Go Programming Language\" I spotted following code:</p>\n\n<pre><code>var err error = syscall.Errno(2)\nfmt.Println(err.Error()) // \"no such file or directory\"\nfmt.Println(err)         // \"no such file or directory\"\n</code></pre>\n\n<p>I understand the first and second line. <code>error</code> interface is saitisfied by <code>syscall.Errno</code>, thus <code>Error()</code> function returning <code>string</code> is available.</p>\n\n<p>I don't understand third one. Going through <code>syscall</code>'s <a href=\"https://golang.org/src/syscall/syscall_unix.go?s=2735:2753#L104\" rel=\"nofollow noreferrer\">sources</a> I can't find any place where <code>syscall.Errno</code> satisfies <code>stringer</code> interface - <code>String()</code> function is not defined.</p>\n\n<p>Why third one prints string representation of <code>sysscall.Errno</code>?</p>\n"}, {"tags": ["go", "curl", "generator", "hootsuite"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543300267, "post_id": 53493614, "comment_id": 93857401, "body": "You seem to know what the problem is (the request body is nil). What have you done to try to fix it?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543301238, "post_id": 53493614, "comment_id": 93857787, "body": "see <a href=\"https://golang.org/src/net/http/transfer.go\" rel=\"nofollow noreferrer\">golang.org/src/net/http/transfer.go</a> for a working example of a go file transfer program"}, {"owner": {"reputation": 11, "user_id": 6521035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2160d2bbef24691c5a9334f694b3e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Backbone93", "link": "https://stackoverflow.com/users/6521035/backbone93"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543303495, "post_id": 53493614, "comment_id": 93858755, "body": "@Flimzy thanks for remind me, i&#39;ve updated my question, please take a look"}, {"owner": {"reputation": 11, "user_id": 6521035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2160d2bbef24691c5a9334f694b3e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Backbone93", "link": "https://stackoverflow.com/users/6521035/backbone93"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543303522, "post_id": 53493614, "comment_id": 93858765, "body": "@Vorsprung thank you for suggestion, i will take a look for that link."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543306620, "post_id": 53493614, "comment_id": 93860057, "body": "Thanks for the update."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543306665, "post_id": 53493614, "comment_id": 93860075, "body": "My suggestion: Remove the &#39;Content-Length&#39; header. It may be that the content is sent using chunked transfer encoding, which would conflict with a content-length header."}, {"owner": {"reputation": 11, "user_id": 6521035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2160d2bbef24691c5a9334f694b3e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Backbone93", "link": "https://stackoverflow.com/users/6521035/backbone93"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543307322, "post_id": 53493614, "comment_id": 93860386, "body": "@Flimzy i tried, but it return same response as i declared in the question"}], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1543314480, "creation_date": 1543314480, "answer_id": 53497598, "question_id": 53493614, "link": "https://stackoverflow.com/questions/53493614/how-to-duplicate-a-curl-command-with-file-as-body/53497598#53497598", "title": "How to duplicate a cURL command with file as body", "body": "<p>You must using <code>multipart</code> to upload content of image.</p>\n\n<pre><code>f, err := os.Open(\"./Users/ikmal/Downloads/catcute.jpg\")\nif err != nil{\n    log.Fatal(err)\n}\ndefer f.Close()\n\nvar buf = new(bytes.Buffer)\nwriter := multipart.NewWriter(buf)\n\npart, _ := writer.CreateFormFile(\"image\", \"dont care about name\")\nio.Copy(part, f)\n\nwriter.Close()\n\nreq, _ := http.NewRequest(\"POST\", \"https://hootsuite-video.s3.amazonaws.com/production/18395606_a9245dd7-73d6-4392-af4a-1cd9bf359cfb.jpg?AWSAccessKeyId=AKIAIM7ASX2JTE3ZFAAA&amp;Expires=1543304067&amp;Signature=n9sZkQ%2BF1DGuiYHqixrrvmoxIXQ%3D\", buf)\nreq.Header.Set(\"Content-Type\", writer.FormDataContentType())\n\nclient := &amp;http.Client{}\nres, _ := client.Do(req)\ndefer res.Body.Close()\nb, _ := ioutil.ReadAll(res.Body)\nfmt.Println(string(b))\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6521035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2160d2bbef24691c5a9334f694b3e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Backbone93", "link": "https://stackoverflow.com/users/6521035/backbone93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1543314480, "creation_date": 1543298471, "last_edit_date": 1543306615, "question_id": 53493614, "link": "https://stackoverflow.com/questions/53493614/how-to-duplicate-a-curl-command-with-file-as-body", "title": "How to duplicate a cURL command with file as body", "body": "<p>is there anyone can help me to converting this cURL command to Go?</p>\n\n<pre><code>curl -X PUT -H 'Content-Type: image/jpg' \\\n     -H \"Content-Length: 132093\" \\\n     -T \"/Users/ikmal/Downloads/catcute.jpg\" \\\n     \"https://hootsuite-video.s3.amazonaws.com/production/18395606_a9245dd7-73d6-4392-af4a-1cd9bf359cfb.jpg?AWSAccessKeyId=AKIAIM7ASX2JTE3ZFAAA&amp;Expires=1543304067&amp;Signature=n9sZkQ%2BF1DGuiYHqixrrvmoxIXQ%3D\"\n</code></pre>\n\n<p>I already try generator like:</p>\n\n<p><strong>1. <a href=\"https://mholt.github.io/curl-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/curl-to-go/</a></strong></p>\n\n<p>it created Go code like this:</p>\n\n<pre><code>// Generated by curl-to-Go: https://mholt.github.io/curl-to-go\n\nreq, err := http.NewRequest(\"PUT\", \"https://hootsuite-video.s3.amazonaws.com/production/18395606_a9245dd7-73d6-4392-af4a-1cd9bf359cfb.jpg?AWSAccessKeyId=AKIAIM7ASX2JTE3ZFAAA&amp;Expires=1543304067&amp;Signature=n9sZkQ%2BF1DGuiYHqixrrvmoxIXQ%3D\", nil)\nif err != nil {\n    // handle err\n}\nreq.Header.Set(\"Content-Type\", \"image/jpg\")\nreq.Header.Set(\"Content-Length\", \"132093\")\n\nresp, err := http.DefaultClient.Do(req)\nif err != nil {\n    // handle err\n}\ndefer resp.Body.Close()\n</code></pre>\n\n<p><strong>2. <a href=\"https://curl.trillworks.com/\" rel=\"nofollow noreferrer\">https://curl.trillworks.com/</a></strong></p>\n\n<p>it created Go code like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    client := &amp;http.Client{}\n    req, err := http.NewRequest(\"PUT\", \"https://hootsuite-video.s3.amazonaws.com/production/18395606_a9245dd7-73d6-4392-af4a-1cd9bf359cfb.jpg?AWSAccessKeyId=AKIAIM7ASX2JTE3ZFAAA&amp;Expires=1543304067&amp;Signature=n9sZkQ%2BF1DGuiYHqixrrvmoxIXQ%3D\", nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.Header.Set(\"Content-Type\", \"image/jpg\")\n    req.Header.Set(\"Content-Length\", \"132093\")\n    resp, err := client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n    bodyText, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%s\\n\", bodyText)\n}\n</code></pre>\n\n<p>But neither gives me proper code because when I run those on project, it returning some error, because it doesn't generate this part:</p>\n\n<pre><code>-T \"/Users/ikmal/Downloads/catcute.jpg\"\n</code></pre>\n\n<p>and generate it as \"nil\" instead.</p>\n\n<p><strong>UPDATE :</strong></p>\n\n<p>What I have done for this problem is adding this code:</p>\n\n<pre><code>file, err := os.Open(\"/Users/ikmal/Downloads/catcute.jpg\")\nif err != nil {\n    panic(err)\n}\ndefer file.Close()\n</code></pre>\n\n<p>so I put the variable \"file\" into body request, here is my final code:</p>\n\n<pre><code>func main(){\n    file, err := os.Open(\"/Users/ikmal/Downloads/catcute.jpg\")\n    if err != nil {\n        panic(err)\n    }\n    defer file.Close()\n\n    client := &amp;http.Client{}\n    req, err := http.NewRequest(\"PUT\", \"https://hootsuite-video.s3.amazonaws.com/production/18395606_a9245dd7-73d6-4392-af4a-1cd9bf359cfb.jpg?AWSAccessKeyId=AKIAIM7ASX2JTE3ZFAAA&amp;Expires=1543304067&amp;Signature=n9sZkQ%2BF1DGuiYHqixrrvmoxIXQ%3D\", file)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.Header.Set(\"Content-Type\", \"image/jpg\")\n    req.Header.Set(\"Content-Length\", \"132093\")\n    resp, err := client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n    bodyText, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%s\\n\", bodyText)\n}\n</code></pre>\n\n<p>then when I build and run this program, it returning response like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Error&gt;\n   &lt;Code&gt;NotImplemented&lt;/Code&gt;\n   &lt;Message&gt;A header you provided implies functionality that is not implemented&lt;/Message&gt;\n   &lt;Header&gt;Transfer-Encoding&lt;/Header&gt;\n   &lt;RequestId&gt;FBD2CEAF71EA4DEA&lt;/RequestId&gt;\n   &lt;HostId&gt;K6hDrHIJr5YtoIBn2d64bfuLBgs6F17gKQV9jrTJ31X987A5gshhqtnKDs3lW2uSliBJwk1pri4=&lt;/HostId&gt;\n&lt;/Error&gt;\n</code></pre>\n\n<p>It seems the error came from headers problem, but I'm sure I type the header correctly. Is there something wrong that I missed?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543300338, "post_id": 53493554, "comment_id": 93857433, "body": "What have you tried? Include your code. What problem are you facing?"}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543300640, "post_id": 53493554, "comment_id": 93857546, "body": "@Flimzy sir I perform the above written query in mongo shell and it will give me full records but I want to get the records on the bases of order and parent. for example record first having <code>_id:1, parent:0, order:1</code> then it will show at the top and record second having <code>_id:2, parent:0, order:2</code> it will show on second, in third record it will having <code>_id:3, parent:2, order:1</code> then it will show just behind the record second because its parent is <code>_id:2</code> on order first. like that. Understand?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543300731, "post_id": 53493554, "comment_id": 93857588, "body": "Is your question how to bind data, then, or how to formulate the proper mongo query? These are unrelated questions. In either case, please update your question with your query and/or relevant code."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 9044295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PF8r0.png?s=128&g=1", "display_name": "cheznic", "link": "https://stackoverflow.com/users/9044295/cheznic"}, "is_accepted": false, "score": 0, "last_activity_date": 1543346804, "last_edit_date": 1543346804, "creation_date": 1543346489, "answer_id": 53506715, "question_id": 53493554, "link": "https://stackoverflow.com/questions/53493554/how-to-formulate-the-proper-mongo-query-to-get-the-records-in-proper-format/53506715#53506715", "title": "how to formulate the proper mongo query to get the records in proper format", "body": "<p>I hope I understand your question.  </p>\n\n<p>I think you're trying to do the following.</p>\n\n<ul>\n<li>get some data from mongo (you seem to have that covered)</li>\n<li>get it into go for further processing</li>\n<li>sort it by parent and order</li>\n</ul>\n\n<p>When you say \"binding data\" you might mean unmarshal to a data structure.  For that you'll need a struct to support your data.  Here's a suggestion auto generated from <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">JSON-to-Go</a>:</p>\n\n<pre><code>type Obj struct {\nID          int    `json:\"_id\"`\nName        string `json:\"name\"`\nSlug        string `json:\"slug\"`\nParent      int    `json:\"parent\"`\nDescription string `json:\"description\"`\nOrder       int    `json:\"order\"`\nTaxonomy    string `json:\"taxonomy\"`\n} \n</code></pre>\n\n<p>You might want to rename the struct something better than 'Obj'.</p>\n\n<p>To unmarshal get the JSON and set it to a string, <code>s</code> for example.</p>\n\n<p>create an array to contain your objects</p>\n\n<pre><code>var obj []Obj\n</code></pre>\n\n<p>and do something like: </p>\n\n<pre><code>err := json.Unmarshal([]byte(s), &amp;obj)\n</code></pre>\n\n<p>after that you can sort it how you like.</p>\n\n<p>Here's a link to the Go docs for sorting.\n<a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/sort/</a></p>\n"}], "owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543346804, "creation_date": 1543298157, "last_edit_date": 1543300919, "question_id": 53493554, "link": "https://stackoverflow.com/questions/53493554/how-to-formulate-the-proper-mongo-query-to-get-the-records-in-proper-format", "title": "how to formulate the proper mongo query to get the records in proper format", "body": "<p>Here I want to make a query which binds the data according to the <code>parent</code>. I'm receiving the objects below:</p>\n\n<pre><code>{\n  \"_id\" : 1,\n  \"name\" : \"home\",\n  \"slug\" : \"home\",\n  \"parent\" : 0,\n  \"description\" : \"this will direct you on home page\",\n  \"order\" : 1,\n  \"taxonomy\" : \"nav_bar\"\n}\n{\n  \"_id\" : 2,\n  \"name\" : \"Links\",\n  \"slug\" : \"links\",\n  \"parent\" : 0,\n  \"description\" : \"this will direct you on home page\",\n  \"order\" : 2,\n  \"taxonomy\" : \"nav_bar\"\n}\n{\n  \"_id\" : 3,\n  \"name\" : \"Link1\",\n  \"slug\" : \"link1\",\n  \"parent\" : 2,\n  \"description\" : \"this will direct you on home page\",\n  \"order\" : 1,\n  \"taxonomy\" : \"nav_bar\"\n}\n{\n  \"_id\" : 4,\n  \"name\" : \"Link2\",\n  \"slug\" : \"link2\",\n  \"parent\" : 2,\n  \"description\" : \"this will direct you on home page\",\n  \"order\" : 2,\n  \"taxonomy\" : \"nav-bar\"\n}\n{\n  \"_id\" : 5,\n  \"name\" : \"extra Link\",\n  \"slug\" : \"extra-link\",\n  \"parent\" : 0,\n  \"description\" : \"this will direct you on home page\",\n  \"order\" : 3,\n  \"taxonomy\" : \"nav-bar\"\n}\n{\n  \"_id\" : 6,\n  \"name\" : \"extra Link1\",\n  \"slug\" : \"extra-link1\",\n  \"parent\" : 5,\n  \"description\" : \"this will direct you on home page\",\n  \"order\" : 1,\n  \"taxonomy\" : \"nav-bar\"\n}\n{\n  \"_id\" : 7,\n  \"name\" : \"extra Link2\",\n  \"slug\" : \"extra-link2\",\n  \"parent\" : 5,\n  \"description\" : \"this will direct you on home page\",\n  \"order\" : 2,\n  \"taxonomy\" : \"nav-bar\"\n}\n</code></pre>\n\n<p>How will I retrieve this data using golang according to the <code>parent</code> field and the <code>order</code> field that they are in sorted order and also follow the child parent hierarchy. For now I'm simply retrieving all the data by using <code>db.CollectionName.find().pretty()</code>. But now I have to order this by order field and also with parent child hierarchy.</p>\n\n<p>I have tried below query in mongodb shell:-</p>\n\n<pre><code>db.CollectionName.find().pretty()\n</code></pre>\n\n<p>it will show me the full data. But I need for example record first having <code>_id:1, parent:0, order:1</code> then it will show at the top and record second having <code>_id:2, parent:0, order:2</code> it will show on second, in third record it will having <code>_id:3, parent:2, order:1</code> then it will show just behind the record second because its parent is <code>_id:2</code> on order first.</p>\n"}, {"tags": ["go", "benchmarking"], "comments": [{"owner": {"reputation": 1312, "user_id": 4082431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21eaa3ed4674e22d54aee1cb77108291?s=128&d=identicon&r=PG", "display_name": "mstruebing", "link": "https://stackoverflow.com/users/4082431/mstruebing"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543300482, "post_id": 53493340, "comment_id": 93857488, "body": "It is executable but it executes the benchmark as if I&#39;m in that directory. So my program scans for files/directories in the current working directory and it only finds the two files (<code>main.go</code> and <code>main_test.go</code>) in <code>.&#47;cmd&#47;&lt;my-project&gt;&#47;</code> and not all files inside the project root."}], "answers": [{"comments": [{"owner": {"reputation": 1312, "user_id": 4082431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21eaa3ed4674e22d54aee1cb77108291?s=128&d=identicon&r=PG", "display_name": "mstruebing", "link": "https://stackoverflow.com/users/4082431/mstruebing"}, "edited": false, "score": 0, "creation_date": 1543304454, "post_id": 53494393, "comment_id": 93859125, "body": "Thank you, it is working but it is running only one time, not <code>n</code> times. So, it is like running the binary after compiling.  My func looks like this:  <code>for n := 0; n &lt; b.N; n++ { main() }</code> (not a single line in actual code of course)"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1312, "user_id": 4082431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21eaa3ed4674e22d54aee1cb77108291?s=128&d=identicon&r=PG", "display_name": "mstruebing", "link": "https://stackoverflow.com/users/4082431/mstruebing"}, "edited": false, "score": 0, "creation_date": 1543326831, "post_id": 53494393, "comment_id": 93871675, "body": "Can you post more code? Sounds like something is setup funny"}, {"owner": {"reputation": 1312, "user_id": 4082431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21eaa3ed4674e22d54aee1cb77108291?s=128&d=identicon&r=PG", "display_name": "mstruebing", "link": "https://stackoverflow.com/users/4082431/mstruebing"}, "edited": false, "score": 0, "creation_date": 1543531971, "post_id": 53494393, "comment_id": 93964190, "body": "Sorry I&#39;m confused, I did something wrong. It is working like you said."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 1312, "user_id": 4082431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21eaa3ed4674e22d54aee1cb77108291?s=128&d=identicon&r=PG", "display_name": "mstruebing", "link": "https://stackoverflow.com/users/4082431/mstruebing"}, "edited": false, "score": 0, "creation_date": 1543531997, "post_id": 53494393, "comment_id": 93964209, "body": "Ah, glad to hear it."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 5, "last_activity_date": 1543302425, "creation_date": 1543302425, "answer_id": 53494393, "question_id": 53493340, "link": "https://stackoverflow.com/questions/53493340/running-benchmarks-of-subfolders-from-the-project-root/53494393#53494393", "title": "Running benchmarks of subfolders from the project root", "body": "<p>So to run the benchmarks:</p>\n\n<pre><code>go test -bench=. ./cmd/&lt;my-project&gt;\n</code></pre>\n\n<p>However, you are wanting to control the working directory, so really you want to run it from somewhere else. What you are looking for is the <code>-c</code> flag. It will create a binary instead of running the tests. You can then run the binary (and therefore your tests and benchmarks) where you want.</p>\n\n<pre><code>go test -c ./cmd/my_proj\nmy_proj.test -test.bench=.\n</code></pre>\n\n<p><strong>NOTE</strong>: Flags are prefixed with <code>test.</code> when you compile the tests.</p>\n"}], "owner": {"reputation": 1312, "user_id": 4082431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21eaa3ed4674e22d54aee1cb77108291?s=128&d=identicon&r=PG", "display_name": "mstruebing", "link": "https://stackoverflow.com/users/4082431/mstruebing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 1, "accepted_answer_id": 53494393, "answer_count": 1, "score": 2, "last_activity_date": 1543302446, "creation_date": 1543296885, "last_edit_date": 1543301956, "question_id": 53493340, "link": "https://stackoverflow.com/questions/53493340/running-benchmarks-of-subfolders-from-the-project-root", "title": "Running benchmarks of subfolders from the project root", "body": "<p>I have a project with a binary which entrypoint is located in <code>./cmd/&lt;my-project&gt;/main.go</code>.\nI've added a benchmark in <code>./cmd/&lt;my-project&gt;/main_test.go</code>.</p>\n\n<p>Now I want to execute this benchmark from the repository root.\nI've tried to execute something like <code>go test -bench=./cmd/&lt;my-project&gt;/main</code> in various alternations (like for example <code>go test -bench=./cmd/&lt;my-project&gt;/main_test.go</code> or <code>go test -bench=./cmd/&lt;my-project&gt;</code>) but I couldn't get it to work.</p>\n\n<p>The error I always get is:</p>\n\n<p><code>can't load package: package github.com/&lt;username&gt;/&lt;my-project&gt;: no Go files in /home/&lt;user&gt;/go/src/github.com/&lt;username&gt;/&lt;my-project&gt;</code> </p>\n\n<p>and it's true, I have no <code>*.go</code> files in my project root.</p>\n\n<p>All I came up with is changing into the directory first and run the benchmark with `go test -bench=.</p>\n\n<p>However, as my program depends on the current working directory and the result is heavily depending on that it would be great to be able to execute it in another directory than the <code>cmd/&lt;my-project&gt;</code> one. (If this is good or not isn't part of the question :))</p>\n\n<p><strong>Update after the first comment:</strong></p>\n\n<p>I get it to run with <code>go test -bench=. /cmd/&lt;my-project&gt;</code> but the benchmark get's executed as if it would be run in the <code>./cmd/&lt;my-project&gt;</code> directory.\nI've noticed similiar behaviour in 'normal tests' - but that wasn't a problem for me at any time.</p>\n\n<p>So, my program does scan the current directory for files directories depending on the current working directory, this results in only two files found (<code>main.go</code> and <code>main_test.go</code>) where the benchmark isn't really helpful.</p>\n"}, {"tags": ["go", "logging"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543296437, "post_id": 53493216, "comment_id": 93856127, "body": "No. You have to explicitly pass it into any package you want it to be usable (either direct or indirect)."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543300439, "post_id": 53493216, "comment_id": 93857473, "body": "Yes, you can use a global logger (or any other global variable), but you shouldn&#39;t. In any case, what have you tried?  Show your code. What problem did you encounter?"}, {"owner": {"reputation": 1, "user_id": 5201305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa87f84a42ec3c1ea45023d4ee26faa9?s=128&d=identicon&r=PG&f=1", "display_name": "Deo", "link": "https://stackoverflow.com/users/5201305/deo"}, "edited": false, "score": 0, "creation_date": 1543453605, "post_id": 53493216, "comment_id": 93929231, "body": "I want to use logger in main package at other packages."}, {"owner": {"reputation": 1, "user_id": 5201305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa87f84a42ec3c1ea45023d4ee26faa9?s=128&d=identicon&r=PG&f=1", "display_name": "Deo", "link": "https://stackoverflow.com/users/5201305/deo"}, "edited": false, "score": 0, "creation_date": 1543453946, "post_id": 53493216, "comment_id": 93929289, "body": "I fount solution. <a href=\"https://stackoverflow.com/questions/28375034/referencing-package-main-in-a-subpackage\" title=\"referencing package main in a subpackage\">stackoverflow.com/questions/28375034/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": 0, "last_activity_date": 1543302652, "creation_date": 1543302652, "answer_id": 53494445, "question_id": 53493216, "link": "https://stackoverflow.com/questions/53493216/how-to-use-main-package-logger-at-extra-package-in-golang/53494445#53494445", "title": "How to use main package logger at extra package in golang?", "body": "<p>Packages can have global variables:</p>\n\n<pre><code>package somepackage\n\nimport \"log\"\n\nvar (\n  Log *log.Logger = log.New(os.Stderr, \"\", log.LstdFlags)\n)\n</code></pre>\n\n<p>Notice that I capitalized <code>Log</code>. This means it is <code>exported</code> (think <code>public</code> in other languages). </p>\n\n<p>In general though, using globals is discouraged. I would recommend thinking of a different pattern.</p>\n"}], "owner": {"reputation": 1, "user_id": 5201305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa87f84a42ec3c1ea45023d4ee26faa9?s=128&d=identicon&r=PG&f=1", "display_name": "Deo", "link": "https://stackoverflow.com/users/5201305/deo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1543302652, "creation_date": 1543296124, "question_id": 53493216, "link": "https://stackoverflow.com/questions/53493216/how-to-use-main-package-logger-at-extra-package-in-golang", "title": "How to use main package logger at extra package in golang?", "body": "<p>I want to make global logger.</p>\n\n<p>Can I make global logger? (To access every pacakges)</p>\n"}, {"tags": ["javascript", "html", "go", "raspberry-pi"], "comments": [{"owner": {"reputation": 7845, "user_id": 5734311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7iVq7.jpg?s=128&g=1", "display_name": "Chris G", "link": "https://stackoverflow.com/users/5734311/chris-g"}, "edited": false, "score": 0, "creation_date": 1543281295, "post_id": 53491371, "comment_id": 93852912, "body": "You&#39;re supposed to change the HTML on the page based on <code>data</code>. For instance like this: <code>if (data.lanup) document.getElementById(&quot;lanstate&quot;).style.color = &quot;green&quot;;</code> The exact code depends on the format of the server&#39;s reply, and how you&#39;re displaying the state of each interface."}, {"owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "reply_to_user": {"reputation": 7845, "user_id": 5734311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7iVq7.jpg?s=128&g=1", "display_name": "Chris G", "link": "https://stackoverflow.com/users/5734311/chris-g"}, "edited": false, "score": 0, "creation_date": 1543284628, "post_id": 53491371, "comment_id": 93853516, "body": "Hi, I understand about finding something in the DOM and changing it - once I can extract the data.  Not sure what form the data will come back to me in?  But firstly, how to make that call to ajax please?  Do I put that code in the javascript function called from the button&#39;s onclick event?"}, {"owner": {"reputation": 7845, "user_id": 5734311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7iVq7.jpg?s=128&g=1", "display_name": "Chris G", "link": "https://stackoverflow.com/users/5734311/chris-g"}, "edited": false, "score": 0, "creation_date": 1543285137, "post_id": 53491371, "comment_id": 93853639, "body": "Yes, exactly. Ideally, the GO server sends back JSON. Something like <code>{ &quot;lanup&quot;: true, &quot;wifiup&quot;: true, &quot;threegup&quot;: true }</code>. As for <code>$.ajax</code>, that&#39;s <a href=\"http://jquery.com/\" rel=\"nofollow noreferrer\">jQuery</a>. It also has a simpler way: <code>$.getJSON</code>, but you can also use the native <code>fetch()</code>, that way you don&#39;t have to include jQuery in your project."}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "edited": false, "score": 0, "creation_date": 1543293458, "post_id": 53491371, "comment_id": 93855363, "body": "you can simply use Ajax to do the same with ease."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543300645, "post_id": 53491371, "comment_id": 93857550, "body": "Why not run all tests at the same time, then you only wait 3 seconds, instead of 10-15."}, {"owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543359519, "post_id": 53491371, "comment_id": 93888937, "body": "@Flimzy, yes I had thought of this. But the project leader has asked for them to be able to be tested separately."}, {"owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "reply_to_user": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "edited": false, "score": 0, "creation_date": 1543359568, "post_id": 53491371, "comment_id": 93888953, "body": "@ASHWINRAJEEV Yessssss, this is what I&#39;m asking how to do!  Can you give me an answer showing how to do this?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543388167, "post_id": 53491371, "comment_id": 93896518, "body": "@davo36: Of course, they should be testable separately. But you can still run them simultaneously. These are not the least bit mutually exclusive."}, {"owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543515881, "post_id": 53491371, "comment_id": 93957293, "body": "@Flimzy Yes, I see what you mean."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "edited": false, "score": 0, "creation_date": 1543284489, "post_id": 53491455, "comment_id": 93853492, "body": "Hi, OK, can I ask why the url is a json file?  I&#39;d need to have my Go function fill in that json file right? But how does that happen? I also don&#39;t really understand how to make that ajax call.  Is it in the javascript function called by the button&#39;s onclick event?"}, {"owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "edited": false, "score": 0, "creation_date": 1543284840, "post_id": 53491455, "comment_id": 93853563, "body": "Actually I just re-read your answer, I understand a bit more.  With the lanStatus function, can I just pop that $.ajax bit into it somewhere?"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "edited": false, "score": 0, "creation_date": 1543288068, "post_id": 53491455, "comment_id": 93854250, "body": "You need to have your goserver serve an http api.  Javascript (ajax) is going to communicate with that http api."}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "edited": false, "score": 0, "creation_date": 1543288153, "post_id": 53491455, "comment_id": 93854263, "body": "<a href=\"https://www.reddit.com/r/golang/comments/2tmllh/sending_an_ajax_request_to_go_web_server/\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/2tmllh/&hellip;</a> good bones to get you started"}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": true, "score": 1, "last_activity_date": 1543281678, "creation_date": 1543281678, "answer_id": 53491455, "question_id": 53491371, "link": "https://stackoverflow.com/questions/53491371/calling-golang-from-html/53491455#53491455", "title": "Calling Golang from HTML", "body": "<p>So couple different concepts here.</p>\n\n<p>Render: On the initial request to your html that generates the <code>Test</code> button.  Your go server will render that html 1 time and return it to your browser.  It does not re-request dynamically unless you wire some stuff up to make the web page change. </p>\n\n<p>Client: So when someone clicks your button, the function <code>getLANStatus</code> will be ran.  You will want that function to do a few things</p>\n\n<ol>\n<li><p>Through ajax, communicate with your go server through an api that will return the status of your connections as a json object. Something like</p>\n\n<p>{\n  \"3g\": \"up\",\n  \"lan\": \"down\",\n  \"wifi\": \"up\"\n}</p></li>\n<li><p>Second, in the <code>done</code> part of your ajax, you will manipulate something in the DOM in order to convey that the status of the interfaces is what it is.  You could do that by finding the element, then changing the text to what is returned by the object.</p></li>\n</ol>\n\n<p>As a simple first step, you can <code>alert</code> the payload in the function that would look like this</p>\n\n<pre><code>$.ajax({\n  url: \"http://YOUR_GO_SERVER_IP_OR_DNS:PORT/interfaces_status.json\"\n}).done(function (data) {\n  alert(data);\n  console.log(data);\n  debugger;\n});\n</code></pre>\n\n<p>Then if you request that with the console open in chrome, you will be able to directly play with the returned <code>data</code> so that you know what all it reponds to.</p>\n"}], "owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1579, "favorite_count": 0, "accepted_answer_id": 53491455, "answer_count": 1, "score": 1, "last_activity_date": 1543281678, "creation_date": 1543280799, "question_id": 53491371, "link": "https://stackoverflow.com/questions/53491371/calling-golang-from-html", "title": "Calling Golang from HTML", "body": "<p>I'm helping with an open source project.  It's a small Go webserver running on a device containing a Raspberry Pi.  I want to be able to have a user click a button on an html screen, which calls a routine in Go, which returns 2 values, a boolean and a string.</p>\n\n<p>What we are wanting to do is see which network interfaces are up on the raspberry pi e.g. is the lan connection up?</p>\n\n<p>To do this I really need to ping a site from each interface.  This takes a few seconds for each of 3 interfaces: Lan, WiFi, and 3G.</p>\n\n<p>I can do this when the page is requested and fill in an html template as the page loads, but it means waiting maybe 10 to 15 secs for the page to load, so it seems like something is broken.</p>\n\n<p>So I want to be able to list each of the 3 interfaces on the page and have the user click 'test' which then calls a routine in the underlying Go webserver.  </p>\n\n<p>I then need to be able to display the results from the call in a couple of text areas for each interface.</p>\n\n<p>What I have tried:</p>\n\n<p>I have tried registering a Go function (in this case IsLANConnectionUp) using funcmap from the net/html package and calling it from the html template from a JavaScript function, like this:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>  &lt;button onclick = \"getLANStatus()\" class=\"btn btn-primary\"&gt;Test&lt;/button&gt;\r\n \r\n  &lt;script&gt;\r\n    function getLANStatus() {\r\n        var status = document.getElementById('status');\r\n        {{ if IsLANConnectionUp }}\r\n          status.innerHTML = \"Lan is up!\"\r\n        {{ else }}\r\n          status.innerHTML = \"Lan is down!\"\r\n        {{ end }}\r\n    }\r\n  &lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>But having the template code inside the javascript code doesn't seem to work.  Also, I'd like the text output from the ping command (which my Go function getLANStatus and I don't know how to extract that data from the function call.  The documentation says only one value can be returned.</p>\n\n<p>Searching on StackOverflow I see this: <a href=\"https://stackoverflow.com/questions/29353509/calling-golang-functions-from-within-javascript-code\">calling Golang functions from within javascript code</a></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>$.ajax({\r\n  url: \"http://www.example.com/signup\",\r\n  data: {username: \"whatever\"} //If the request needs any data \r\n}).done(function (data) {\r\n  // Do whatever with returned data\r\n});</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>But it says things like \"// Do whatever with the returned data\"  I'm new to web programming and so don't know how to use that code.  If this is the way to go, could someone please expand on this a little?</p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["regex", "string", "go"], "comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 1, "creation_date": 1543270033, "post_id": 53489470, "comment_id": 93849613, "body": "Why wouldn&#39;t this work: <code>(?i:.*Error.*http|.*http.*error)</code> ?"}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543306446, "post_id": 53489470, "comment_id": 93859977, "body": "I am sorry, I did confusion. The non functioning character is &quot;|&quot;. However, if possible, is better to avoid also the &quot;/&quot; as I am not sure if it works. So your proposed string unfortunately does not work."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543337988, "post_id": 53489470, "comment_id": 93878633, "body": "Are you able to run more than one test?"}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543342964, "post_id": 53489470, "comment_id": 93881394, "body": "I could do it but then it became time consuming when the number of words to search increase. I tought about this as backup solution but I would like to avoid it, if possible."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543348289, "post_id": 53489470, "comment_id": 93884001, "body": "Then I think the real answer is to figure out how to use <code>|</code> in your REs. Why doesn&#39;t it work?"}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543349258, "post_id": 53489470, "comment_id": 93884479, "body": "It is a telegram not made by me and the developer told me that the strings with the symbol &quot;|&quot; do not work properly. Is there any workaround to the use of such symbol (as well as the symbol &quot;/&quot; if possible) expect the one to make multiple strings inverting the words?"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543351416, "post_id": 53489470, "comment_id": 93885451, "body": "Which telegram exactly? Apparently in Go you can use <code>%r</code> to switch to another delimiter, e.g. <code>%r|s&#47;s|</code>. Generally backslash <code>\\</code> escapes special characters, so possibly <code>`(?:http.*error\\|error.*http)`</code> would work (raw string literal in backquotes), if you are passing in a string that is wrapped in a <code>|</code> delimited regex literal later."}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543352956, "post_id": 53489470, "comment_id": 93886204, "body": "I am sorry I did a typo. I wanted to say a telegram bot (I wrote not instead of bot). Bot&#39;s name is @junction_bot"}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543532523, "post_id": 53489470, "comment_id": 93964375, "body": "@NetMage I did not hear from you since a while, are you thinking to an alternative string?"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543538283, "post_id": 53489470, "comment_id": 93965776, "body": "I don&#39;t think there is one. You need to figure out how to escape <code>|</code> to work."}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543562669, "post_id": 53489470, "comment_id": 93971596, "body": "@NetMage can you make a string without the symbol &quot;/&quot; where there is no need to repeat the words in all the orders that I want to look at? I am referring to this: (?i:.*Error.*http|.*http.*error) it became difficult to make a string like this when you have several words as you would have to write down all combinations of words."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543601626, "post_id": 53489470, "comment_id": 93991231, "body": "Not with a Regular Expression."}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543611179, "post_id": 53489470, "comment_id": 93995304, "body": "@Netmage So I have a different question, can you make a string that works with golang flavor and single line regex flag? feel free to use whetever character and or symbol you think is necessary but please, make it in a way that if I have to search 4 words, I do not have to enter manually, into the string, one by one all combinations of the words I want to track (for istance word1 word2 word3 word4, then word2 word1 word3 word4, etc until I cover all combinations I am interested). This, together with flavor and regex flag are the only limitations. Hope you can make it work somehow in this way."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543611513, "post_id": 53489470, "comment_id": 93995408, "body": "Answer is still not with a Regular Expression in Go - the RE engine isn&#39;t sufficient."}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543615337, "post_id": 53489470, "comment_id": 93996842, "body": "@NetMage so what flavor and regex flag you recommend for a working string? and what string? thank you"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543616179, "post_id": 53489470, "comment_id": 93997126, "body": "Using C#, this pattern <code>(?is)(?=.*http)(?=.*error)</code> only matches if both words exist in the string in any order with any case."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543616521, "post_id": 53489470, "comment_id": 93997230, "body": "Of course, a lot of other languages (e.g. Perl) support lookahead as well."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "edited": false, "score": 0, "creation_date": 1543306495, "post_id": 53493160, "comment_id": 93860002, "body": "I am sorry, I did confusion. The non functioning character is &quot;|&quot;. However, if possible, is better to avoid also the &quot;/&quot; as I am not sure if it works. So your proposed string unfortunately does not work."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543337617, "post_id": 53493160, "comment_id": 93878407, "body": "This doesn&#39;t work as it matches strings with only one word, either <code>http</code> or <code>error</code>. Trying taking out <code>https</code> from the test string."}, {"owner": {"reputation": 71, "user_id": 3212079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6hXZ.jpg?s=128&g=1", "display_name": "Roshan Rush", "link": "https://stackoverflow.com/users/3212079/roshan-rush"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543385291, "post_id": 53493160, "comment_id": 93895335, "body": "@NetMage The question as I understood it was to find any word of a list of words in a string regardless of the order and regardless of prefix or suffix. This does exactly that. You can test it in the golang playground by commenting out either of the keywords and it will still return true."}, {"owner": {"reputation": 71, "user_id": 3212079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6hXZ.jpg?s=128&g=1", "display_name": "Roshan Rush", "link": "https://stackoverflow.com/users/3212079/roshan-rush"}, "reply_to_user": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "edited": false, "score": 0, "creation_date": 1543386559, "post_id": 53493160, "comment_id": 93895833, "body": "@Radeon89 I edited my answer to make it work without <code>|</code>"}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "edited": false, "score": 1, "creation_date": 1543388966, "post_id": 53493160, "comment_id": 93896870, "body": "The string have to search for ALL words and provide matches when all words are found, this irrespective of their order. Hope this clarify any doubt and my apologies if initially I have not been clear enough."}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "edited": false, "score": 0, "creation_date": 1543389931, "post_id": 53493160, "comment_id": 93897295, "body": "@Roshan Rush I tested the updated string (?i:(error)?(http)?) but I got matches also if just one of the two words is present. As I said in my last message above of few minutes ago, I would like to get matches only when all words of my interest are present. Thank you so much"}, {"owner": {"reputation": 71, "user_id": 3212079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6hXZ.jpg?s=128&g=1", "display_name": "Roshan Rush", "link": "https://stackoverflow.com/users/3212079/roshan-rush"}, "reply_to_user": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "edited": false, "score": 0, "creation_date": 1543484870, "post_id": 53493160, "comment_id": 93939685, "body": "@Radeon89 I guess I missunderstood your question and I thought you wanted to match any of the words regardless of the order. The solution is really simple, just change the <code>?</code> with <code>{1,}</code>. I&#39;ll post another edit to my answer"}, {"owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "edited": false, "score": 0, "creation_date": 1543495602, "post_id": 53493160, "comment_id": 93945873, "body": "@Roshan Rush It seems that even this new string does not work, please check it here on regex101: <a href=\"https://regex101.com/r/2BHV4z/2/\" rel=\"nofollow noreferrer\">regex101.com/r/2BHV4z/2</a> it says no match. I copied and pasted the string so I am sure I did not make a typo. Let me know. Thank you"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1543538370, "post_id": 53493160, "comment_id": 93965798, "body": "Using <code>{1,}</code> (which is just a long way of saying <code>+</code>) won&#39;t work because it fixes the order of the words."}], "tags": [], "owner": {"reputation": 71, "user_id": 3212079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6hXZ.jpg?s=128&g=1", "display_name": "Roshan Rush", "link": "https://stackoverflow.com/users/3212079/roshan-rush"}, "is_accepted": false, "score": 0, "last_activity_date": 1543484995, "last_edit_date": 1543484995, "creation_date": 1543295701, "answer_id": 53493160, "question_id": 53489470, "link": "https://stackoverflow.com/questions/53489470/regex-to-match-string-containing-two-or-more-words-in-any-order-and-case-not-s/53493160#53493160", "title": "Regex to match string containing two (or more) words in any order and case not sensitive", "body": "<p>This should do what you want:</p>\n\n<pre><code>(?i:(http)|(error))\n</code></pre>\n\n<p>You can replace <code>http</code> and <code>error</code> with any other keywords that you are searching for.</p>\n\n<p>To do that in Golang:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n    \"strings\"\n)\n\nfunc main() {\n    keywords := []string{\n        \"error\",\n        \"http\",\n    }\n    p := \"(?i:(\" + strings.Join(keywords, \")|(\") + \"))\"\n    text := `\n    Gran Turismo Sport\n\nShipment Error\n\nAttempt\nhttps://\n`\n    re := regexp.MustCompile(p)\n    fmt.Println(re.MatchString(text))\n}\n</code></pre>\n\n<p>You can test that in Golang Playground:</p>\n\n<p><a href=\"https://play.golang.org/p/XOhNVBCh8Pt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/XOhNVBCh8Pt</a></p>\n\n<p>EDIT:</p>\n\n<p>Based on the new limitation of not being able to use the <code>|</code> char, I would suggest that you search using this:</p>\n\n<p><code>(?i:(error)?(http)?)\n</code></p>\n\n<p>This will always return true (or a list of empty strings in find all) but the good thing is you can filter out all the empty strings and you will end up with the result that you want.</p>\n\n<p>This is a an example of this working in Golang Playground:</p>\n\n<p><a href=\"https://play.golang.org/p/miVC0hdLtQc\" rel=\"nofollow noreferrer\">https://play.golang.org/p/miVC0hdLtQc</a></p>\n\n<p>EDIT 2:\nIn case you want to make sure ALL the keywords are in the text change the <code>?</code> in regex with <code>{1,}</code>. Also you don't need the loop any more.</p>\n\n<p><code>(?i:(error){1,}(http){1,})\n</code></p>\n\n<p>This is an an example working in Golang Playground</p>\n\n<p><a href=\"https://play.golang.org/p/f9eFcvObDsA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/f9eFcvObDsA</a></p>\n"}], "owner": {"reputation": 17, "user_id": 10708454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9280de5efaed3591f0c68e24275757d8?s=128&d=identicon&r=PG&f=1", "display_name": "Radeon89", "link": "https://stackoverflow.com/users/10708454/radeon89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543666073, "creation_date": 1543268343, "last_edit_date": 1543666073, "question_id": 53489470, "link": "https://stackoverflow.com/questions/53489470/regex-to-match-string-containing-two-or-more-words-in-any-order-and-case-not-s", "title": "Regex to match string containing two (or more) words in any order and case not sensitive", "body": "<p>Hope you guys can help me. </p>\n\n<p>I need to make a string that alerts me when the following conditions are met:</p>\n\n<ol>\n<li>Two (or more) words are identified in a message</li>\n<li>It does not have to look just at the \"whole\" words but also at that ones that contain the text I am searching. For istance, I search for \"error\", it has to be alert me also when it founds \"error<strong>s</strong>\" or \"errorless\".</li>\n<li>It should not to be case sensitive</li>\n<li>It has to look at word1 and word2 but also viceversa, in others words it has to look at them irrespective of their order</li>\n</ol>\n\n<p>I have played a while with regex101 but I have not been able to reach all conditions (condition # 4 is still missing).</p>\n\n<p>You can find at the following link what I have been able to make:\n<a href=\"https://regex101.com/r/Z4cE9A/5\" rel=\"nofollow noreferrer\">https://regex101.com/r/Z4cE9A/5</a></p>\n\n<p>Please note that I need matches with the following expressions characteristics:</p>\n\n<p>Flavor: golang    /    Flag: single line</p>\n\n<p><strong>Important note</strong>: I cannot use the character \"|\" as it does not work properly on the system where I am going to use this string.</p>\n\n<p>Any help would be more than appreciated. Thanks in advance for your support.</p>\n\n<p>EDIT: I did confusion. The non functioning character is \"|\". However if possible is better to avoid also the \"/\" as I am not sure if it works. If you want we can provide me with two strings, one without the symbol \"/\" and one without, in case it does not work.</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 228, "user_id": 8567993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMUkS.jpg?s=128&g=1", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/8567993/mehdi"}, "is_accepted": false, "score": 0, "last_activity_date": 1543270942, "creation_date": 1543270942, "answer_id": 53490017, "question_id": 53489209, "link": "https://stackoverflow.com/questions/53489209/foreign-key-in-gorm/53490017#53490017", "title": "Foreign key in gorm", "body": "<p>MongoId is a <strong>uint data type, not int</strong>.</p>\n\n<p>in another way you can use an int field in Mongo model as : </p>\n\n<pre><code>type Mongo struct {\ngorm.Model\nMs int // for example\n....\n}\n</code></pre>\n\n<p>and then in MicroService model :</p>\n\n<pre><code>type MicroService struct {\ngorm.Model\nUrl        string\nPort       string\nVersion    string\nName       string\nEtat       string\nMongoDb    Mongo `gorm:\"foreignkey:MongoId;association_foreignkey:Ms\"`\nMongoId int\nEnv     string\n}\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1593, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544009328, "creation_date": 1543267047, "last_edit_date": 1544009328, "question_id": 53489209, "link": "https://stackoverflow.com/questions/53489209/foreign-key-in-gorm", "title": "Foreign key in gorm", "body": "<p>here is my code : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n)\n\ntype Mongo struct {\n    gorm.Model\n    Url      string\n    Login    string\n    Password string\n    Env     string\n    Base string\n    Port string\n}\n\n\n\ntype MicroService struct {\n    gorm.Model\n    Url        string\n    Port       string\n    Version    string\n    Name       string\n    Etat       string\n    MongoDb    Mongo `gorm:\"foreignkey:MongoId\"`\n    MongoId int\n    Env     string\n}\n\n\n\nfunc initDb() {\n\n    var mongoDb Mongo\n    result := db.Find(&amp;mongoDb, \"env = ?\", \"Prod\").RecordNotFound()\n    fmt.Println(\"not found create mongodb\")\n    fmt.Println(result)\n    if result == true {\n        mongoDb = Mongo{}\n        // \"mongodb://heroku_4n1snp42:f42hkq6n3qfv48uelms7vrclta@:23930/heroku_4n1snp42\"\n        mongoDb.Url = \"mlab.com\"\n        mongoDb.Login = \"toto\"\n        mongoDb.Password = \"titi\"\n        mongoDb.Base = \"tata\"\n        mongoDb.Port = \"23930\"\n        mongoDb.Env = \"Prod\"\n        db.Create(&amp;mongoDb)\n\n    }\n    var microService MicroService\n    result = db.Find(&amp;microService, \"name = ? and env = ?\", \"constructProduct\",\"Prod\").RecordNotFound()\n    fmt.Println(\"not found create construct Product Micro\")\n    fmt.Println(result)\n    if result == true {\n        microService = MicroService{}\n        microService.Name  = \"totobis\"\n        microService.Port = \"8307\"\n        microService.Env = \"Prod\"\n        var mongoDbConstructProduct Mongo\n        result = db.Find(&amp;mongoDbConstructProduct , \"env = ?\", \"Prod\").RecordNotFound()\n        fmt.Println(mongoDbConstructProduct)\n        microService.MongoDb = mongoDbConstructProduct\n        db.Create(&amp;microService)\n        fmt.Println(\"constructProduct microservice created\")\n    }\n\n}\n\nvar db *gorm.DB\nvar loggued bool\n\n\n\n\n\nfunc main() {\n    var err error\n    loggued = false\n    db, err = gorm.Open(\"sqlite3\", \"configuration.sqlite3?cache=shared&amp;mode=rwc\")\n    db.AutoMigrate(&amp;MicroService{})\n    db.AutoMigrate(&amp;Mongo{})\n\n    initDb()\n    var microService MicroService\n    db.Find(&amp;microService, \"name = ?\", \"totobis\").RecordNotFound()\n    if err != nil {\n        panic(\"failed to connect database\")\n    }\n    defer db.Close()\n    fmt.Println(microService)\n\n}\n</code></pre>\n\n<p>But i don't understand why when i print the object after query it , the mongodb of MicroService is empty.</p>\n\n<p>When i print the field mongodb in the creation it's ok :</p>\n\n<blockquote>\n  <p>{{1 2018-11-26 22:08:16.436503737 +0100 +0100 2018-11-26\n  22:08:16.504275897 +0100 +0100 } mlab.com toto titi Prod tata\n  23930}</p>\n</blockquote>\n\n<p>But when i try to recreate a microservice object the mongo field is empty : </p>\n\n<blockquote>\n  <p>{{2 2018-11-26 22:09:15.73203579 +0100 +0100 2018-11-26\n  22:09:15.73203579 +0100 +0100 }  8307  totobis  {{0 0001-01-01\n  00:00:00 +0000 UTC 0001-01-01 00:00:00 +0000 UTC }      } 1 Prod}</p>\n</blockquote>\n\n<p>How can I do to get the good microservice struct with the mongo struct I've associated?</p>\n"}, {"tags": ["go", "apache-kafka", "kafka-producer-api", "confluent-platform"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 12305921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QPMJI.jpg?s=128&g=1", "display_name": "iDream", "link": "https://stackoverflow.com/users/12305921/idream"}, "is_accepted": false, "score": 0, "last_activity_date": 1615857356, "creation_date": 1615857356, "answer_id": 66647815, "question_id": 53488624, "link": "https://stackoverflow.com/questions/53488624/go-kafka-producechannel-fills-up-and-hangs/66647815#66647815", "title": "Go Kafka `ProduceChannel()` Fills Up and Hangs", "body": "<p>I have the similar problem as you.And I found an article that might explain the cause of the problem.</p>\n<p><strong>When there is no message in the blocked topic, after a certain period of time, you will timeout error as below.</strong></p>\n<pre><code>%5|1598190018.518|REQTMOUT|rdkafka#consumer-1| [thrd:sasl_ssl://abcd....confluent.cloud:xxxx/2]: sasl_ssl://abcd....confluent.cloud:xxxx/2: Timed out FetchRequest in flight (after 359947ms, timeout #0)\n%4|1598190018.840|REQTMOUT|rdkafka#consumer-1| [thrd:sasl_ssl://abcd.confluent.cloud:xxxx/2]: sasl_ssl://abcd.xxxxx.confluent.cloud:xxxx/2: Timed out 1 in-flight, 0 retry-queued, 0 out-queue, 0 partially-sent requests\n</code></pre>\n<p>The link of Article: <a href=\"https://www.thecodebuzz.com/apache-kafka-net-client-producer-consumer-csharp-confluent-examples-ii/\" rel=\"nofollow noreferrer\">https://www.thecodebuzz.com/apache-kafka-net-client-producer-consumer-csharp-confluent-examples-ii/</a></p>\n<p>I hope that it can do some help to you.</p>\n"}], "owner": {"reputation": 12790, "user_id": 1767106, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0065eca502a4a798607e38cefc1ca2ed?s=128&d=identicon&r=PG", "display_name": "clay", "link": "https://stackoverflow.com/users/1767106/clay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 597, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1615857356, "creation_date": 1543264396, "question_id": 53488624, "link": "https://stackoverflow.com/questions/53488624/go-kafka-producechannel-fills-up-and-hangs", "title": "Go Kafka `ProduceChannel()` Fills Up and Hangs", "body": "<p>I have a server-side app written in Go producing Kafka events. It runs perfectly for days, producing ~1.6k msg/sec, and then hits a sporadic problem, where all Kafka message sending stops, and the server app needs to be manually restarted for Kafka messages to resume sending.</p>\n\n<p>I've included a screenshot of the metric graphs when the incident started.  To annotate what I see happening:</p>\n\n<ul>\n<li><p>For seven days, the app runs perfectly. For every message queued, there is a delivery event notification sent to <code>kafkaProducer.Events()</code>. You can see that num queued = num delivered.</p></li>\n<li><p>10:39: The issue starts. The delivery notification count quickly drops to zero. Kafka messages keep getting queued, but the callbacks stop.</p></li>\n<li><p>10:52: <code>kafkaProducer.ProduceChannel()</code> is filled up, and attempts to queue new messsages into the go channel block the goroutine. At this point the app will never send another Kafka message again until it is manually restarted.</p></li>\n<li><p>17:55: I manually restarted the application. kafka message queue/delivery resumes. kafka_produce_attempts drops back to zero.</p></li>\n</ul>\n\n<p>The one and only place my Go code sends Kafka messages is here:</p>\n\n<pre><code>    recordChannelGauge.Inc()\n    kafkaProducer.ProduceChannel() &lt;- &amp;msg\n    recordChannelGauge.Dec()\n</code></pre>\n\n<p>In the metric screenshot, note that <code>recordChannelGauge</code> normally stays at zero because sending the message to the Kafka <code>ProduceChannel()</code> doesn't block and each <code>Inc()</code> is immediately followed by a matching <code>Dec()</code> However, when the <code>ProduceChannel()</code> is filled up, the goroutine blocks and <code>recordChannelGauge</code> stays at 1 and will never unblock until the app is manually restarted.</p>\n\n<p>FYI, my environment details:</p>\n\n<ul>\n<li>Go server binary built with golang 1.10.x</li>\n<li>Latest version of <code>github.com/confluentinc/confluent-kafka-go/kafka</code>. This library doesn't use versions, it's using the latest git commit, which as of this writing is 2 months old, so I'm sure I'm using that latest version.</li>\n<li>Server OS Ubuntu 16.04.5</li>\n<li>librdkafka1 version librdka0.11.6~1confluent5.0.1-</li>\n</ul>\n\n<p>I suspect this is due to some internal problem in the confluentinc go client, where it doesn't handle some error scenario appropriately.</p>\n\n<p>Also, I see no relevant log output around the time of the problem. I do see sporadic Kafka broker disconnected and time out errors in the logs before the problem happened that don't seem to be serious. These log messages happened every few hours or so for days without serious consequence.</p>\n\n<pre><code>Nov 26 06:52:04 01 appserver.linux[6550]: %4|1543215124.447|REQTMOUT|rdkafka#producer-1| [thrd:kafka-broker-3:9092/bootstrap]: kafka-broker-3:9092/bootstrap: Timed out 0 in-flight, 1 retry-queued, 0 out-queue, 0 partially-sent requests\nNov 26 06:52:10 01 appserver.linux[6550]: %4|1543215130.448|REQTMOUT|rdkafka#producer-1| [thrd:kafka-broker-3:9092/bootstrap]: kafka-broker-3:9092/bootstrap: Timed out 0 in-flight, 1 retry-queued, 0 out-queue, 0 partially-sent requests\nNov 26 08:46:57 01 appserver.linux[6550]: 2018/11/26 08:46:57 Ignored event: kafka-broker-2:9092/bootstrap: Disconnected (after 600000ms in state UP)\nNov 26 08:47:02 01 appserver.linux[6550]: %4|1543222022.803|REQTMOUT|rdkafka#producer-1| [thrd:kafka-broker-2:9092/bootstrap]: kafka-broker-2:9092/bootstrap: Timed out 0 in-flight, 1 retry-queued, 0 out-queue, 0 partially-sent requests\nNov 26 08:47:09 01 appserver.linux[6550]: %4|1543222029.807|REQTMOUT|rdkafka#producer-1| [thrd:kafka-broker-2:9092/bootstrap]: kafka-broker-2:9092/bootstrap: Timed out 0 in-flight, 1 retry-queued, 0 out-queue, 0 partially-sent requests\n</code></pre>\n\n<h2>Zoomed in to problem occurrence</h2>\n\n<p><a href=\"https://i.stack.imgur.com/CVH6z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CVH6z.png\" alt=\"Zoomed in to problem occurrence\"></a></p>\n\n<h2>Zoomed out to show before and after</h2>\n\n<p><a href=\"https://i.stack.imgur.com/pj3ni.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pj3ni.png\" alt=\"Zoomed out to show before and after\"></a></p>\n"}, {"tags": ["sorting", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 4, "last_activity_date": 1543264424, "creation_date": 1543264424, "answer_id": 53488631, "question_id": 53488536, "link": "https://stackoverflow.com/questions/53488536/sort-slice-on-number-of-occurrences-of-a-value/53488631#53488631", "title": "Sort slice on number of occurrences of a value", "body": "<p>Iterate over the slice, populate a map of occurrences, then sort the slice based on the number of occurrences:</p>\n\n<pre><code>supplierCounts := make(map[int]int)\nfor _, msg := range messages {\n    supplierCounts[msg.SupplierID]++\n}\n\nsort.Slice(messages, func(i, j int) bool {\n    return supplierCounts[messages[i].SupplierID] &lt; supplierCounts[messages[j].SupplierID]\n})\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/YMWPP2JBC2P\" rel=\"nofollow noreferrer\">https://play.golang.org/p/YMWPP2JBC2P</a></p>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 53488631, "answer_count": 1, "score": 0, "last_activity_date": 1543264424, "creation_date": 1543264017, "question_id": 53488536, "link": "https://stackoverflow.com/questions/53488536/sort-slice-on-number-of-occurrences-of-a-value", "title": "Sort slice on number of occurrences of a value", "body": "<p>Please see <a href=\"https://play.golang.org/p/z07rcoSe8nk\" rel=\"nofollow noreferrer\">this playground</a>. I have a slice with some data. Now I want to sort this slice, but not on a value inside one of the values, but I want to sort it on the number of occurrences of one of the values.</p>\n\n<p>Unfortunately I don't have a clue how to fix this. Can someone please point me to the right direction?</p>\n\n<p>I know I can do this:</p>\n\n<pre><code>sort.Slice(messages, func(i, j int) bool {\n    return messages[i].SupplierID &lt; messages[j].SupplierID\n})\n</code></pre>\n\n<p>This will sort the slice, but it will start with the \"higest\" supplierID. but what I want is to sort on the number of occurrences: the ones with the lease number of supplierIDs first.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1543258677, "post_id": 53487371, "comment_id": 93844481, "body": "See also <a href=\"https://news.ycombinator.com/item?id=9522973\" rel=\"nofollow noreferrer\">news.ycombinator.com/item?id=9522973</a>"}, {"owner": {"reputation": 3360, "user_id": 329463, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cc84f018e9d2d814cd7c1feffb6d624a?s=128&d=identicon&r=PG", "display_name": "vearutop", "link": "https://stackoverflow.com/users/329463/vearutop"}, "edited": false, "score": 0, "creation_date": 1543938254, "post_id": 53487371, "comment_id": 94093754, "body": "<a href=\"https://golang.org/pkg/cmd/go/#hdr-Import_path_checking\" rel=\"nofollow noreferrer\">golang.org/pkg/cmd/go/#hdr-Import_path_checking</a> import path checking comment"}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "reply_to_user": {"reputation": 3360, "user_id": 329463, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cc84f018e9d2d814cd7c1feffb6d624a?s=128&d=identicon&r=PG", "display_name": "vearutop", "link": "https://stackoverflow.com/users/329463/vearutop"}, "edited": false, "score": 0, "creation_date": 1543938354, "post_id": 53487371, "comment_id": 94093807, "body": "@vearutop good spot I should probably make this a community wiki"}, {"owner": {"reputation": 3360, "user_id": 329463, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cc84f018e9d2d814cd7c1feffb6d624a?s=128&d=identicon&r=PG", "display_name": "vearutop", "link": "https://stackoverflow.com/users/329463/vearutop"}, "edited": false, "score": 0, "creation_date": 1543938445, "post_id": 53487371, "comment_id": 94093847, "body": "<a href=\"https://github.com/golangci/golangci-lint#false-positives\" rel=\"nofollow noreferrer\">github.com/golangci/golangci-lint#false-positives</a> ignore lint false positive (3rd party)"}], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 1288818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CfkE.jpg?s=128&g=1", "display_name": "Oleg Butuzov", "link": "https://stackoverflow.com/users/1288818/oleg-butuzov"}, "is_accepted": false, "score": 1, "last_activity_date": 1543259549, "creation_date": 1543259549, "answer_id": 53487587, "question_id": 53487371, "link": "https://stackoverflow.com/questions/53487371/what-are-the-uses-of-semantic-comments-in-go/53487587#53487587", "title": "what are the uses of semantic comments in Go?", "body": "<p><a href=\"https://blog.golang.org/examples\" rel=\"nofollow noreferrer\">Examples</a> - Allow to test function for <code>example</code> output.</p>\n\n<p>Copy/Paste from link above. </p>\n\n<pre><code>package stringutil_test\n\nimport (\n    \"fmt\"\n\n    \"github.com/golang/example/stringutil\"\n)\n\nfunc ExampleReverse() {\n    fmt.Println(stringutil.Reverse(\"hello\"))\n    // Output: olleh\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "is_accepted": true, "score": 2, "last_activity_date": 1543938609, "last_edit_date": 1543938609, "creation_date": 1543458314, "answer_id": 53530943, "question_id": 53487371, "link": "https://stackoverflow.com/questions/53487371/what-are-the-uses-of-semantic-comments-in-go/53530943#53530943", "title": "what are the uses of semantic comments in Go?", "body": "<p>As noted <a href=\"http://news.ycombinator.com/item?id=9522973\" rel=\"nofollow noreferrer\">comments are directives in go</a> not just comments.</p>\n\n<p>There is at the time of writing no definitive list. \nThis as logged as an <a href=\"https://github.com/golang/go/issues/28532\" rel=\"nofollow noreferrer\">golang issue 28532</a>.</p>\n\n<p>Therefore I propose using this answer to make one.</p>\n\n<p>Uses in the go core language and tools themselves:</p>\n\n<ul>\n<li><a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">go:generate</a> can be used for code generation.</li>\n<li><a href=\"https://blog.golang.org/godoc-documenting-go-code\" rel=\"nofollow noreferrer\">godoc</a> uses the function name to indicate comments it should interpret</li>\n<li><a href=\"https://blog.golang.org/examples\" rel=\"nofollow noreferrer\">Examples</a> - document the expected output of a test (thanks @Butuzov)</li>\n<li><a href=\"https://golang.org/pkg/go/build/\" rel=\"nofollow noreferrer\">build</a> constraints (starting with '<em>// +build</em>')</li>\n<li><a href=\"https://golang.org/pkg/cmd/go/#hdr-Import_path_checking\" rel=\"nofollow noreferrer\">Import comments</a> e.g. '<em>package math // import \"path\"</em>'</li>\n</ul>\n\n<p>Notable uses in third party packages</p>\n\n<ul>\n<li><a href=\"https://github.com/Parquery/gocontracts\" rel=\"nofollow noreferrer\">gocontracts</a> - specify preconditions as comments</li>\n<li><a href=\"https://github.com/go-swagger\" rel=\"nofollow noreferrer\">go-swagger</a> - document a ReST API using swagger</li>\n<li><a href=\"https://github.com/golangci/golangci-lint#false-positives\" rel=\"nofollow noreferrer\">golangci</a> e.g. //nolint[:linter1,linter2,...]</li>\n</ul>\n\n<p>How can they avoid conflicting with each other?</p>\n\n<p>If you are developing a tool that really needs to treat comments as attributes and wish to avoid conflict with other similar uses prefix your comments with a namespace like \"<em>{mytool}</em>: \"</p>\n\n<p>There are some conscious attempts at namespacing.\nMagic comments built into go use the \"go: \" prefix as in \"go:generate\"\n(except where they don't)</p>\n\n<p>go-swagger uses \"swagger: \"</p>\n\n<p>However you still need to approach this with caution and check the list here or any other source you can find.</p>\n\n<p>Also consider whether comments are the best <a href=\"https://github.com/Parquery/gocontracts/issues/22\" rel=\"nofollow noreferrer\">or only</a> approach rather than using functions instead.\nCompare for instance (<a href=\"https://github.com/Parquery/gocontracts\" rel=\"nofollow noreferrer\">gocontracts</a>):</p>\n\n<pre><code>// SomeFunc ensures:\n//  * !strings.HasSuffix(result, \"smth\")\nfunc SomeFunc(x int) (result string) {\n    // ...\n}\n</code></pre>\n\n<p>with (<a href=\"https://godoc.org/github.com/lpabon/godbc\" rel=\"nofollow noreferrer\">godbc</a>)</p>\n\n<pre><code>func SomeFunc(x int) (result string) {\n    godbc.Require(strings.HasSuffix(result,\"smth\");\n}\n</code></pre>\n"}], "owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 1, "accepted_answer_id": 53530943, "answer_count": 2, "score": 2, "last_activity_date": 1543938609, "creation_date": 1543258580, "last_edit_date": 1543312780, "question_id": 53487371, "link": "https://stackoverflow.com/questions/53487371/what-are-the-uses-of-semantic-comments-in-go", "title": "what are the uses of semantic comments in Go?", "body": "<p>By analogy with <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go\">this question</a> about tags I note that there are several uses of comments in go beyond pure commentary.</p>\n\n<p>Examples:</p>\n\n<ul>\n<li><a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">go:generate</a> can be used for code generation.</li>\n<li><a href=\"https://blog.golang.org/godoc-documenting-go-code\" rel=\"nofollow noreferrer\">godoc</a> uses the function name to indicate comments it should interpret</li>\n<li><a href=\"https://golang.org/pkg/go/build/\" rel=\"nofollow noreferrer\">build</a> constraints</li>\n</ul>\n\n<p>Are there any others I've missed? </p>\n\n<p>Is there a definitive list somewhere?</p>\n\n<p>Some third party packages like <a href=\"https://github.com/Parquery/gocontracts\" rel=\"nofollow noreferrer\">gocontracts</a> and <a href=\"https://github.com/go-swagger\" rel=\"nofollow noreferrer\">go-swagger</a> use them as well. How can they avoid conflicting with each other?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 0, "creation_date": 1543258664, "post_id": 53487163, "comment_id": 93844474, "body": "That&#39;s a little too opinionated a question; you&#39;re returned an error, handle it however you want! Generally this type of error is something that you want to know about, but not something that you want to break the code flow, so you&#39;d increment a metric or write a log line. Like Seaskyways&#39; answer says, you can write this logic in a closure, or wrap it up into a helper function."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1543260584, "post_id": 53487163, "comment_id": 93845307, "body": "IMO I think it should fail spectacularly in the function instead of returning error to the main routine."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1543319184, "post_id": 53487356, "comment_id": 93867030, "body": "Alirus, note that nothing forces you to use an anonymous function as suggested here: it&#39;s perfectly fine to have a utility function and arrange for it to be executed in a deferred call \u2014 <a href=\"https://play.golang.org/p/VKg3a-4xFaJ\" rel=\"nofollow noreferrer\">an example</a>. OTOH, an anonymous function usually makes it easy to access the encosing function&#39;s return variables, if needed. Still, using this feature is of dubious utility as it may hamper understanding of the control flow; see the answer provided by @PeterSO."}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 9, "last_activity_date": 1561530436, "last_edit_date": 1561530436, "creation_date": 1543258516, "answer_id": 53487356, "question_id": 53487163, "link": "https://stackoverflow.com/questions/53487163/how-to-gently-defer-execution-of-a-function-that-might-return-an-error/53487356#53487356", "title": "How to gently defer execution of a function that might return an error?", "body": "<p>Using <code>defer</code> with a <code>func() {}()</code> like so.</p>\n\n<pre><code>var r *SomeResource\nvar err error\nif r, err = Open(/* parameters */); err != nil {\n    return nil, err\n}\ndefer func() {\n    if err = r.Close(); err != nil {\n        fmt.Printf(\"ERROR: %v\", err)\n    }\n}()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "is_accepted": false, "score": -1, "last_activity_date": 1543259906, "creation_date": 1543259906, "answer_id": 53487669, "question_id": 53487163, "link": "https://stackoverflow.com/questions/53487163/how-to-gently-defer-execution-of-a-function-that-might-return-an-error/53487669#53487669", "title": "How to gently defer execution of a function that might return an error?", "body": "<p>We can handle this in ways like:</p>\n\n<p><strong>way-1:</strong></p>\n\n<pre><code>func myFn() error {\n    var err error\n    if r, err = Open(/* parameters */); err != nil {\n        return nil, err\n    }\n    defer func() {\n        if cErr = r.Close(); cErr != nil {\n            err = cErr\n        }\n    }()\n    return err\n}\n</code></pre>\n\n<p><strong>way-2:</strong></p>\n\n<pre><code>func myFn() error {\n    var err error\n    if r, err = Open(/* parameters */); err != nil {\n        return nil, err\n    }\n    defer func() {\n        if cErr = r.Close(); cErr != nil {\n            // we can log the error\n            // or\n            // whatever we want to do\n        }\n    }()\n    return err\n}\n</code></pre>\n\n<p>I have also find a nice blog on this topic, i mean handling error when defer func returns an error. Check here <a href=\"https://blog.learngoprogramming.com/5-gotchas-of-defer-in-go-golang-part-iii-36a1ab3d6ef1\" rel=\"nofollow noreferrer\">https://blog.learngoprogramming.com/5-gotchas-of-defer-in-go-golang-part-iii-36a1ab3d6ef1</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1543266602, "post_id": 53487728, "comment_id": 93848103, "body": "<code>if e != nil {</code> this check inside defer is probably redundant"}, {"owner": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543270381, "post_id": 53487728, "comment_id": 93849747, "body": "In addition to what @zerkms noted, which is supposedly right, AFAIK with <i>named</i> return parameters, specifying <code>return</code> arguments explicitly, is also redundant. So, one can simply write <code>return</code> instead of <code>return name, err</code> in this example."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "edited": false, "score": 0, "creation_date": 1543270903, "post_id": 53487728, "comment_id": 93849958, "body": "@Alirus: Just because you can do something doesn&#39;t make it good practice. From the codereview guidelines: &quot;be explicit with your return values. &quot; Readability is paramount."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543271430, "post_id": 53487728, "comment_id": 93850157, "body": "@peterSO it probably a language issue (I&#39;m presumably a native speaker). My point is that if that check is removed - nothing would change."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543272089, "post_id": 53487728, "comment_id": 93850419, "body": "err, I&#39;m presumably <b>NOT</b> a native speaker"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543318528, "post_id": 53487728, "comment_id": 93866658, "body": "@zerkms, the check implements the &#171;Don&#39;t overwrite earlier errors&#187; bit from the Peter&#39;s answer. That is, if <code>Close()</code> returns an error but the function already generated an error, we do not stomp over that original error \u2014 which, supposedly, is a more important one. Of course, the behaviour should be judged on a case-by-case basis\u2014for instance, a failure to <code>Close()</code> a file opened for writing might indeed represent a grave error. Hence one might take several routes at solving it: 1) log the error hinting at where it happened and the fact it wasn&#39;t handled; \u2026"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543318829, "post_id": 53487728, "comment_id": 93866830, "body": "@zerkms, \u20262) create a value of a custom type accumulating several errors into one, and return it; 3) panic \u2014 indicating a &quot;double fault&quot; condition. This freedom is one of the strong sides of the Go&#39;s approach to error handling, which is often overlooked by newcomers (and &quot;professional blog posters&quot;) ;-)"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1543348640, "post_id": 53487728, "comment_id": 93884157, "body": "@kostix you would not overwrite the original error if you simply remove the <code>if e != nil {</code> and the corresponding closing brace <a href=\"https://pastebin.com/FzVL4JT7\" rel=\"nofollow noreferrer\">pastebin.com/FzVL4JT7</a> - this code is identical isn&#39;t it. My point is that - that very condition does not check anything useful"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1543412263, "post_id": 53487728, "comment_id": 93910052, "body": "@zerkms, yes you&#39;re correct. This &quot;reads backwards&quot; a bit but is nonetheless valid, I stand corrected."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1543266323, "last_edit_date": 1543266323, "creation_date": 1543260214, "answer_id": 53487728, "question_id": 53487163, "link": "https://stackoverflow.com/questions/53487163/how-to-gently-defer-execution-of-a-function-that-might-return-an-error/53487728#53487728", "title": "How to gently defer execution of a function that might return an error?", "body": "<p>Fail gracefully with an error. Report the first error. Don't overwrite earlier errors. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc demo() (name string, err error) {\n    filename := `test.file`\n    f, err := os.Open(filename)\n    if err != nil {\n        return \"\", err\n    }\n    defer func() {\n        e := f.Close()\n        if e != nil {\n            if err == nil {\n                err = e\n            }\n        }\n    }()\n\n    // do someting with the file\n    name = f.Name()\n    fi, err := f.Stat()\n    if err != nil {\n        return name, err\n    }\n    if fi.Size() == 0 {\n        err = fmt.Errorf(\"%s: empty file\", filename)\n        return name, err\n    }\n\n    return name, err\n}\n\nfunc main() {\n    name, err := demo()\n    fmt.Println(name, err)\n}\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 1, "accepted_answer_id": 53487356, "answer_count": 3, "score": 3, "last_activity_date": 1561530436, "creation_date": 1543257641, "question_id": 53487163, "link": "https://stackoverflow.com/questions/53487163/how-to-gently-defer-execution-of-a-function-that-might-return-an-error", "title": "How to gently defer execution of a function that might return an error?", "body": "<p>Most cleanup functions, especially those related to the IO operations, return an <code>error</code>, and normally we'd prefer to <code>defer</code> their execution in case if we'd not forget to call them when we're done with acquired resources. For example, at some point in the code we might write something like this:</p>\n\n<pre><code>var r *SomeResource\nvar err error\nif r, err = Open(/* parameters */); err != nil {\n    return nil, err\n}\ndefer r.Close() // This might return an error\n</code></pre>\n\n<p>It seems that if <code>Close</code> function returns an error, it'll be ignored. How can we gently process the returned <code>error</code> from such a function?</p>\n"}, {"tags": ["http", "dictionary", "go", "httpresponse"], "answers": [{"tags": [], "owner": {"reputation": 3451, "user_id": 7016115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e53D0.jpg?s=128&g=1", "display_name": "Shudipta Sharma", "link": "https://stackoverflow.com/users/7016115/shudipta-sharma"}, "is_accepted": false, "score": 2, "last_activity_date": 1543257289, "creation_date": 1543257289, "answer_id": 53487102, "question_id": 53486878, "link": "https://stackoverflow.com/questions/53486878/convert-http-json-body-response-to-map-in-go/53487102#53487102", "title": "Convert HTTP JSON body response to map in Go", "body": "<p>The <code>*http.Response.Body</code> is of type <code>io.ReadCloser</code>. And you are not using right method to read the body data and to convert it into <code>[]byte</code>. Try to use this:</p>\n\n<pre><code>resp, errResp := ioutil.ReadAll(httpResponse.Body)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": true, "score": 5, "last_activity_date": 1543257633, "creation_date": 1543257633, "answer_id": 53487160, "question_id": 53486878, "link": "https://stackoverflow.com/questions/53486878/convert-http-json-body-response-to-map-in-go/53487160#53487160", "title": "Convert HTTP JSON body response to map in Go", "body": "<p><code>http.Response.Body</code> is <code>io.ReadCloser</code>. So use this:</p>\n\n<pre><code>err := json.NewDecoder(httpResponse.Body).Decode(&amp;data)\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10684813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a52beef370c9f21f794e5d6b0a96698?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkylo", "link": "https://stackoverflow.com/users/10684813/darkskylo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4056, "favorite_count": 0, "accepted_answer_id": 53487160, "answer_count": 2, "score": 6, "last_activity_date": 1588602758, "creation_date": 1543256244, "last_edit_date": 1588602758, "question_id": 53486878, "link": "https://stackoverflow.com/questions/53486878/convert-http-json-body-response-to-map-in-go", "title": "Convert HTTP JSON body response to map in Go", "body": "<p>I am trying to convert HTTP JSON body response to <code>map[string]interface{}</code> in Go.</p>\n\n<p>This is the code I wrote: </p>\n\n<pre><code>func fromHTTPResponse(httpResponse *http.Response, errMsg string )(APIResponse, error){\n    temp, _ := strconv.Atoi(httpResponse.Status)\n\n    var data map[string]interface{}\n    resp, errResp := json.Marshal(httpResponse.Body)\n    defer httpResponse.Body.Close()\n    if errResp != nil {\n        return APIResponse{}, errResp\n    }\n\n    err := json.Unmarshal(resp, &amp;data)\n    if err != nil {\n        return APIResponse{}, err\n    }\n\n    return APIResponse{httpResponse.Status, data, (temp == OK_RESPONE_CODE), errMsg, map[string]interface{}{} }, nil\n}\n</code></pre>\n\n<p>I successfully connect to the server. The response's body contains JSON data. After running the code, data points to <code>nil</code>, why is that?</p>\n"}, {"tags": ["database", "go", "go-gorm", "mux"], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": false, "score": 2, "last_activity_date": 1543264143, "creation_date": 1543264143, "answer_id": 53488568, "question_id": 53486156, "link": "https://stackoverflow.com/questions/53486156/best-practice-to-pass-gorm-db-instance-in-a-custom-handler-in-go-http/53488568#53488568", "title": "Best Practice to pass *gorm.db instance in a custom handler in go http", "body": "<p>According to Gorm documentation :</p>\n\n<blockquote>\n  <p>All Chain Methods will clone and create a new DB object (shares one\n  connection pool), GORM is safe for concurrent use by multiple\n  goroutines.</p>\n</blockquote>\n\n<p>Gorm creates clones when it needs to automatically, there is no need to handle this manually. For more information check this page in the documentation: <a href=\"http://gorm.io/docs/method_chaining.html\" rel=\"nofollow noreferrer\">http://gorm.io/docs/method_chaining.html</a></p>\n"}], "owner": {"reputation": 21, "user_id": 8243768, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R1xJuosu4nM/AAAAAAAAAAI/AAAAAAAADNQ/1l8cjMJgHPU/photo.jpg?sz=128", "display_name": "ABEL KURUVILLA", "link": "https://stackoverflow.com/users/8243768/abel-kuruvilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544009342, "creation_date": 1543253055, "last_edit_date": 1544009342, "question_id": 53486156, "link": "https://stackoverflow.com/questions/53486156/best-practice-to-pass-gorm-db-instance-in-a-custom-handler-in-go-http", "title": "Best Practice to pass *gorm.db instance in a custom handler in go http", "body": "<p>I am creating a custom web handler to handle my routes in an web application.</p>\n\n<p>The handler is</p>\n\n<pre><code>type CustomHandler struct{\nDb *gorm.DB\n}\n</code></pre>\n\n<p>Then a receiver function:</p>\n\n<pre><code>func (h CustomHandler) Index() http.Handler {\n   return http.handlerFunc(w http.ResponseWriter,r *http.Request){\n   //Some code\n   //use h.Db.Find() ,etc.\n})\n</code></pre>\n\n<p>I am passing this to my router as</p>\n\n<pre><code>//In package \ncustomHandler := &amp;CustomHandler{*gormInstance} //I've already got the instance\nrouter.Handle(\"/someroute\", customHandler.index() )\n</code></pre>\n\n<p>But a problem with this is gorm.DB instance, being a pointer will mutate once it pass through a route during one request.\nDo I have to generate different copies of the initial gorm instance? If so, How can I pass them through each routes on each requests?</p>\n"}, {"tags": ["go", "amazon-dynamodb"], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": true, "score": 2, "last_activity_date": 1543247141, "creation_date": 1543247141, "answer_id": 53484642, "question_id": 53484469, "link": "https://stackoverflow.com/questions/53484469/golang-updating-dynamodb/53484642#53484642", "title": "GoLang Updating DynamoDB", "body": "<p>You should define what <code>:a</code> and <code>:s</code> are:</p>\n\n<pre><code>type TransactionUpdate struct {\n    Approved bool `json:\":a\"`\n    Signer   int  `json:\":s\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 5337589, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a79c975f65bc970fffd72a64d243e061?s=128&d=identicon&r=PG&f=1", "display_name": "Kittovski", "link": "https://stackoverflow.com/users/5337589/kittovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1946, "favorite_count": 0, "accepted_answer_id": 53484642, "answer_count": 1, "score": 2, "last_activity_date": 1543247141, "creation_date": 1543246511, "question_id": 53484469, "link": "https://stackoverflow.com/questions/53484469/golang-updating-dynamodb", "title": "GoLang Updating DynamoDB", "body": "<p>When I attempt to update DynamoDB using the code below I get\n<code>ValidationException: ExpressionAttributeValues contains invalid key: Syntax error; key: \"approved\"</code></p>\n\n<p>I can't see why it is invalid</p>\n\n<pre><code>type TransactionUpdate struct {\n    Approved bool `json:\"approved\"`\n    Signer   int  `json:\"signer\"`\n}\n\nvar TXkey Transaction\nTXkey.TxID = sr.TxID\nkey, err := dynamodbattribute.MarshalMap(TXkey)\n\nupdateData, err := dynamodbattribute.MarshalMap(TransactionUpdate{\n    Approved: true,\n    Signer:   1,\n})\n\nupdateString := \"set approved=:a add signers :s\"\n\ninput := &amp;dynamodb.UpdateItemInput{\n    Key:                       key,\n    TableName:                 aws.String(\"Transactions\"),\n    UpdateExpression:          aws.String(updateString),\n    ExpressionAttributeValues: updateData,\n    ReturnValues:              aws.String(\"ALL_NEW\"),\n}\n\nresult, err := svc.UpdateItem(input)\n\ndynamodbattribute.UnmarshalMap(result.Attributes, &amp;tx)\n</code></pre>\n\n<p>Any help much appreciated</p>\n"}, {"tags": ["python", "go", "go-gin"], "comments": [{"owner": {"reputation": 303, "user_id": 5333616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PGUDA8SH-yA/AAAAAAAAAAI/AAAAAAAAACI/3lqTNI5j8jA/photo.jpg?sz=128", "display_name": "Maxim Panfilov", "link": "https://stackoverflow.com/users/5333616/maxim-panfilov"}, "edited": false, "score": 1, "creation_date": 1543246397, "post_id": 53484171, "comment_id": 93838398, "body": "May be you use a nginx or some proxy with authentication/authorization? Your code on python and Go are correct. <code>print(os.environ(&quot;HTTP_PROXY&quot;))</code>"}, {"owner": {"reputation": 553, "user_id": 5594002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zz8CD.jpg?s=128&g=1", "display_name": "Ehsan.Saradar", "link": "https://stackoverflow.com/users/5594002/ehsan-saradar"}, "edited": false, "score": 1, "creation_date": 1543246625, "post_id": 53484171, "comment_id": 93838527, "body": "I checked both your python and go code and there was no problem. check your firewall and network proxy.Also try using postman to check your api"}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 0, "creation_date": 1543246836, "post_id": 53484489, "comment_id": 93838632, "body": "it was a proxy problem."}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": true, "score": 1, "last_activity_date": 1543246587, "creation_date": 1543246587, "answer_id": 53484489, "question_id": 53484171, "link": "https://stackoverflow.com/questions/53484171/how-to-communicate-between-gin-and-python/53484489#53484489", "title": "How to communicate between gin and Python", "body": "<p>Your <code>go</code> and <code>python</code> code is valid. I check in my side don't have any error occur. \nTry setup <code>GET</code> router and check it with browser. </p>\n\n<pre><code>r.GET(\"/ping\", func(c *gin.Context) {\n    c.String(http.StatusOK, \"OK\")\n})\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 53484489, "answer_count": 1, "score": -2, "last_activity_date": 1597438898, "creation_date": 1543245513, "last_edit_date": 1597438898, "question_id": 53484171, "link": "https://stackoverflow.com/questions/53484171/how-to-communicate-between-gin-and-python", "title": "How to communicate between gin and Python", "body": "<p>Here is my Go gin code:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n\n    &quot;github.com/gin-gonic/gin&quot;\n)\n\ntype Data struct {\n    Test string `json:&quot;test&quot;`\n}\n\nfunc getData(c *gin.Context) {\n    var data Data\n    err := c.BindJSON(&amp;data)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(data)\n    c.JSON(200, gin.H{\n        &quot;message&quot;: &quot;pong&quot;,\n    })\n}\n\nfunc main() {\n    r := gin.Default()\n    r.POST(&quot;/test&quot;, getData)\n    r.Run() // listen and serve on 0.0.0.0:8080\n}\n</code></pre>\n<p>and my python code:</p>\n<pre><code>import requests\nr = requests.post(&quot;http://127.0.0.1:8080/test&quot;,json={&quot;test&quot;:&quot;ok&quot;})\nprint(r)\n</code></pre>\n<p>But when I execute my Python script I have a 403 error:</p>\n<pre><code>&lt;Response [403]&gt;\n</code></pre>\n<p>The panic (err) display nothing.</p>\n<p>Any idea why I get this error?</p>\n"}, {"tags": ["go", "struct", "mutex", "deadlock", "embedding"], "comments": [{"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1543271518, "post_id": 53483328, "comment_id": 93850190, "body": "Just for interest sake this is an implementation of counting recursive locks: <a href=\"http://github.com/jwells131313/goethe\" rel=\"nofollow noreferrer\">github.com/jwells131313/goethe</a>"}], "answers": [{"comments": [{"owner": {"reputation": 800, "user_id": 8208981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9eeb707bfd44f3aac336e6da2a2954b7?s=128&d=identicon&r=PG&f=1", "display_name": "vonaka", "link": "https://stackoverflow.com/users/8208981/vonaka"}, "edited": false, "score": 0, "creation_date": 1543244177, "post_id": 53483415, "comment_id": 93837139, "body": "Yep, thanks. In fact, I just didn&#39;t knew that it&#39;s possible to access anonymous field by the name of its type. The part of the spec describing this would be enough."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 800, "user_id": 8208981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9eeb707bfd44f3aac336e6da2a2954b7?s=128&d=identicon&r=PG&f=1", "display_name": "vonaka", "link": "https://stackoverflow.com/users/8208981/vonaka"}, "edited": false, "score": 2, "creation_date": 1543244344, "post_id": 53483415, "comment_id": 93837231, "body": "@vonaka That is in <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">Spec: Struct types:</a> <i>&quot;A field declared with a type but no explicit field name is called an embedded field. An embedded field must be specified as a type name <code>T</code> or as a pointer to a non-interface type name <code>*T</code>, and <code>T</code> itself may not be a pointer type. <b>The unqualified type name acts as the field name.</b>&quot;</i>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1543248474, "last_edit_date": 1592644375, "creation_date": 1543243006, "answer_id": 53483415, "question_id": 53483328, "link": "https://stackoverflow.com/questions/53483328/deadlock-with-anonymous-mutex-and-struct/53483415#53483415", "title": "Deadlock with anonymous mutex and struct", "body": "<p>The reason for the deadlock is because your code will call the <code>Lock()</code> method of the same mutex twice, which is a blocking operation.</p>\n<p>The explanation lies in <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">Spec: Selectors:</a></p>\n<blockquote>\n<p>The following rules apply to selectors:</p>\n<ol>\n<li>For a value <code>x</code> of type <code>T</code> or <code>*T</code> where <code>T</code> is not a pointer or interface type, <code>x.f</code> denotes the field or method at the <strong>shallowest</strong> depth in <code>T</code> where there is such an <code>f</code>. If there is not exactly <a href=\"https://golang.org/ref/spec#Uniqueness_of_identifiers\" rel=\"nofollow noreferrer\">one <code>f</code></a> with shallowest depth, the selector expression is illegal.</li>\n</ol>\n</blockquote>\n<p>What does this mean?</p>\n<p>In <code>B</code>, you embed both a <code>sync.Mutex</code> and a value of <code>A</code>, and <code>A</code> also embeds a <code>sync.Mutex</code>.</p>\n<p>When you write <code>B.Mutex</code>, that could refer to the directly embedded <code>B.Mutex</code> field (the unqualified type name acts as the field name), and <em>could</em> also refer to <code>B.A.Mutex</code> (because the <code>A</code> field is embedded in <code>B</code>), but according to the quoted rule above, it will denote the field / method at the <em>shallowest</em> depth which is <code>B.Mutex</code>.</p>\n<p>Similarly, <code>b.Lock()</code> could refer to <code>B.Mutex.Lock()</code> and could refer to <code>B.A.Mutex.Lock()</code>. But again according to the quoted rule, it will denote the field / method at the <em>shallowest</em> depth, which is <code>B.Mutex.Lock()</code>.</p>\n<p>So this code:</p>\n<pre><code>b.Lock()\nb.Mutex.Lock()\n</code></pre>\n<p>Will call the <code>Lock()</code> method of the same <code>Mutex</code> twice, which is the embedded <code>B.Mutex</code> field of the <code>B</code> struct. The 2nd call will block, as the mutex is already locked.</p>\n<p>When you rename <code>A.Mutex</code> to e.g. <code>A.Mutexx</code>, and then you write:</p>\n<pre><code>b.Lock()\nb.Mutexx.Lock()\n</code></pre>\n<p>The first <code>b.Lock()</code> call refers to <code>B.Mutex.Lock()</code>, and the second <code>b.Mutexx.Lock()</code> call refers to <code>B.A.Mutexx.Lock()</code> call, so they lock 2 different, distinct mutexes; they are independent, so the 2nd lock will not block (its mutex is not yet locked).</p>\n"}], "owner": {"reputation": 800, "user_id": 8208981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9eeb707bfd44f3aac336e6da2a2954b7?s=128&d=identicon&r=PG&f=1", "display_name": "vonaka", "link": "https://stackoverflow.com/users/8208981/vonaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 53483415, "answer_count": 1, "score": -1, "last_activity_date": 1543248474, "creation_date": 1543242743, "last_edit_date": 1543243625, "question_id": 53483328, "link": "https://stackoverflow.com/questions/53483328/deadlock-with-anonymous-mutex-and-struct", "title": "Deadlock with anonymous mutex and struct", "body": "<p>Let's say I have these two structs:</p>\n\n<pre><code>type A struct {\n    Mutex sync.Mutex\n    i int\n}\n\ntype B struct {\n    A\n    sync.Mutex\n}\n</code></pre>\n\n<p>Now, when I try to lock <code>B</code> and then <code>A</code> I got a deadlock:</p>\n\n<pre><code>var b B\nb.Lock()\nb.Mutex.Lock()\nb.Mutex.Unlock()\nb.Unlock()\n</code></pre>\n\n<p>I figured out that this is related with the name of the mutex of the struct <code>A</code>, for example, there is no deadlock if I name it <code>Mutexx</code> and not <code>Mutex</code>. But I don't know why it matters. Can anyone, please, explain this behavior?</p>\n\n<p><a href=\"https://play.golang.org/p/UVi_WLWeGmi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/UVi_WLWeGmi</a></p>\n"}, {"tags": ["multithreading", "go", "syntax", "parallel-processing", "goroutine"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1543240158, "post_id": 53482500, "comment_id": 93834670, "body": "Your second version will work, but there&#39;s no reason to use <code>wg.Add(2)</code> instead of just <code>wg.Add(1)</code>, then eliminate the <code>wg.Done()</code> in main(). The main reason for the first version, IMO, would be readability. It&#39;s more clear what you&#39;re doing in the first version."}, {"owner": {"reputation": 137, "user_id": 10485416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gs1iVHY4do0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXQTSNnkyySA4dnV_FXzxtHOWNJBg/mo/photo.jpg?sz=128", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10485416/dylan"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543240374, "post_id": 53482500, "comment_id": 93834823, "body": "@Flimzy Oh thank you ! I didn&#39;t thought of that. But theoretically the second option would be faster right ? if let&#39;s say, the code is called thousands of times"}, {"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 1, "creation_date": 1543240384, "post_id": 53482500, "comment_id": 93834831, "body": "Both will work, but I will prefer whatever is more readable and that is really dependent on what <code>doSomething()</code> is. At first glance, the first option is easier to grasp since the nesting levels are the same. Moreover, unless proven by your tests that one more goroutine is causing you slow runtimes, then prefer simplicity. Note that goroutines should be cheap. Goroutines are far cheaper than OS threads."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1543240625, "post_id": 53482500, "comment_id": 93834992, "body": "@Dylan: The best way to know which is faster is to benchmark both versions.  In theory, the second might be imperceivably faster. But premature optimization is the root of all evil. Please, please, please, optimize for your developer&#39;s time, not for your CPU&#39;s time, until you have a reason to do otherwise."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1543240621, "last_edit_date": 1543240621, "creation_date": 1543240249, "answer_id": 53482565, "question_id": 53482500, "link": "https://stackoverflow.com/questions/53482500/what-is-the-preferred-syntax-to-run-code-in-parallel-with-goroutine/53482565#53482565", "title": "What is the preferred syntax to run code in parallel with goroutine?", "body": "<p>Both are correct. The first form is cleaner and scales well if you intend to extend your code later, e.g. if you later decide you want to launch not 2 but 3 or 4 or N goroutines, the code will not change in structure, you just add the additional goroutines.</p>\n\n<p>Another reason why the first form is \"popular\" is because often after launching the \"worker\" goroutines there are more things to do which may be executed on this goroutine (before <code>wg.Done()</code> is called).</p>\n\n<p>The 2nd form on the other hand is more efficient, as it only launches one additional goroutine. Goroutines are lightweight, cheap, but they are not \"free\". This may be improved further by using the <code>WaitGroup</code> to only \"track\" the launched goroutine, obviously the \"main\" that calls <code>wg.Wait()</code> does not need to wait for itself explicitly. And if only 1 goroutine remains, you may use other synchronization means instead of <code>WaitGroup</code> (e.g. a channel).</p>\n\n<p>So basically if performance is critial, use the 2nd approach.</p>\n"}], "owner": {"reputation": 137, "user_id": 10485416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gs1iVHY4do0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXQTSNnkyySA4dnV_FXzxtHOWNJBg/mo/photo.jpg?sz=128", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10485416/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53482565, "answer_count": 1, "score": 0, "last_activity_date": 1543240621, "creation_date": 1543240012, "last_edit_date": 1543240060, "question_id": 53482500, "link": "https://stackoverflow.com/questions/53482500/what-is-the-preferred-syntax-to-run-code-in-parallel-with-goroutine", "title": "What is the preferred syntax to run code in parallel with goroutine?", "body": "<p>Let's say I need to call a function twice. The usual way to do it would be:</p>\n\n<pre><code>func main() {\n    var wg sync.WaitGroup\n    wg.Add(2)\n\n    go func() {\n        doSomething(A)          \n        wg.Done()\n    }()\n\n    go func() {\n        doSomething(B)\n        wg.Done()\n    }()\n    wg.Wait()\n}\n</code></pre>\n\n<p>But what about writing it like this ?</p>\n\n<pre><code>func main() {\n    var wg sync.WaitGroup\n    wg.Add(2)\n\n    go func() {\n        doSomething(A)          \n        wg.Done()\n    }()\n\n    doSomething(B)\n    wg.Done()\n    wg.Wait()\n}\n</code></pre>\n\n<p>We spare ourselves the creation of one goroutines, while making use of the main goroutine. But I've never seen it written like that in any tutorial. Is it wrong to do this? I've done tests and the output are just as I though the same.</p>\n"}, {"tags": ["go", "channels"], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 0, "last_activity_date": 1543239469, "creation_date": 1543239469, "answer_id": 53482341, "question_id": 53482089, "link": "https://stackoverflow.com/questions/53482089/always-getting-deadlock-with-channels/53482341#53482341", "title": "Always getting deadlock with channels", "body": "<p>The Sender generates (I think 28 messages) . Roughly half the first 20 of these go to one of gp1 and gp2.  Printer and Printer2 then unload the messages</p>\n\n<p>Trouble is, the way that Receiver splits the messages depends on if the number received is odd or even.  But you aren't controlling for this.  If one of the Printers has less than 10 items in it's queue it will hang</p>\n\n<p>That's one potential problem</p>\n"}, {"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 0, "last_activity_date": 1543248321, "creation_date": 1543248321, "answer_id": 53484951, "question_id": 53482089, "link": "https://stackoverflow.com/questions/53482089/always-getting-deadlock-with-channels/53484951#53484951", "title": "Always getting deadlock with channels", "body": "<p>Your core problem is that everything in this is \"dead reckoning\": they expect to see a fixed number of messages, but this doesn't necessarily match up with reality.  You should set up the channels so that they get closed once all of their data gets produced.</p>\n\n<p>This probably means setting up an intermediate function to manage the sending:</p>\n\n<pre><code>func Sender(from, to int, c chan&lt;- int) {\n    for i := from; i &lt; to; i++ {\n        c &lt;- i\n    }\n}\n\nfunc SendEverything(c chan&lt;- int) {\n    var wg sync.WaitGroup\n    wg.Add(2)\n    go func() {\n        defer wg.Done()\n        Sender(0, 20, c)\n    }()\n    go func() {\n        defer wg.Done()\n        Sender(11, 20, c)\n    }()\n    wg.Wait()\n    close(c)\n}\n</code></pre>\n\n<p>Make the dispatcher function work on everything in the channel:</p>\n\n<pre><code>func Receive(c &lt;-chan int, odds, evens chan&lt;- int) {\n    for n := range c {\n        if n%2 == 0 {\n            evens &lt;- n\n        } else {\n            odds &lt;- n\n        }\n    }\n    close(odds)\n    close(evens)\n}\n</code></pre>\n\n<p>And then you can share a single print function:</p>\n\n<pre><code>func Printer(prefix string, c &lt;-chan int) {\n    for n := range c {\n        fmt.Printf(\"%s: %d\\n\", prefix, n)\n    }\n}\n</code></pre>\n\n<p>Finally, you have a main function that stitches it all together:</p>\n\n<pre><code>func main() {\n    var wg sync.WaitGroup\n    inputs := make(chan int)\n    odds := make(chan int)\n    evens := make(chan int)\n\n    wg.Add(4)\n    go func() {\n        defer wg.Done()\n        SendEverything(inputs)\n    }()\n    go func() {\n        defer wg.Done()\n        Receive(inputs, odds, evens)\n    }()\n    go func() {\n        defer wg.Done()\n        Printer(\"odd number\", odds)\n    }()\n    go func() {\n        defer wg.Done()\n        Printer(\"even number\", evens)\n    }()\n    wg.Wait()\n}\n</code></pre>\n\n<p>The complete example is at <a href=\"https://play.golang.org/p/qTUqlt-uaWH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qTUqlt-uaWH</a>.</p>\n\n<p>Note that I've completely refrained from using any global variables, and either things have a hopefully self-explanatory very short name (<code>i</code> and <code>n</code> are simple integers, <code>c</code> is a channel) or are complete words (<code>odds</code>, <code>evens</code>).  I've tended to keep <code>sync.WaitGroup</code> objects local to where they're created.  Since everything is passed as parameters, I don't need two copies of the same function to act on different global variables, and if I chose to write test code for this, I could create my own local channels.</p>\n"}], "owner": {"reputation": 29, "user_id": 4859191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7f681fab707f85eb56a1bad1ebadab?s=128&d=identicon&r=PG&f=1", "display_name": "fleagez", "link": "https://stackoverflow.com/users/4859191/fleagez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53482341, "answer_count": 2, "score": -1, "last_activity_date": 1543248321, "creation_date": 1543238591, "last_edit_date": 1543238640, "question_id": 53482089, "link": "https://stackoverflow.com/questions/53482089/always-getting-deadlock-with-channels", "title": "Always getting deadlock with channels", "body": "<p>I'm learning to work with Go channels, and I'm always getting deadlocks. What might be wrong with this code? Printer randomly stops working when array sizes are unequal; I guess it would help to somehow notify printer that receiver stopped working. Any ideas how to fix it? My code is pasted below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nvar wg = sync.WaitGroup{}\nvar wgs = sync.WaitGroup{}\nvar sg = make(chan int, 50)\nvar gp1 = make(chan int, 50)\nvar gp2 = make(chan int, 50)\n\nfunc main(){\n    wgs.Add(2)\n    go Sender(0)\n    go Sender(11)\n\n    wg.Add(3)\n    go Receiver()\n\n    go Printer()\n    go Printer2()\n\n    wg.Wait()\n}\n\nfunc Sender(start int){\n    defer wgs.Done()\n    for i := start; i &lt; 20; i++ {\n        sg &lt;- i\n    }\n}\n\nfunc Receiver(){\n    defer wg.Done()\n    for i := 0; i &lt; 20; i++{\n        nr := &lt;- sg\n        if nr % 2 == 0{\n            gp1 &lt;- nr\n        } else{\n            gp2 &lt;- nr\n        }\n    }\n}\n\nfunc Printer(){\n    defer wg.Done()\n    var m [10]int\n\n    for i := 0; i &lt; 10; i++ {\n        m[i] = &lt;- gp1\n    }\n\n    wgs.Wait()\n    fmt.Println(m)\n}\n\nfunc Printer2(){\n    defer wg.Done()\n    var m [10]int\n\n    for i := 0; i &lt; 10; i++ {\n        m[i] = &lt;- gp2\n    }\n\n    wgs.Wait()\n\n    fmt.Println(m)\n}\n// Better to use this one\n// func Receiver(senderChannel &lt;-chan int, printerChannel1 chan&lt;- int, printerChannel2 chan&lt;- int, wg *sync.WaitGroup) {\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1543235170, "post_id": 53481035, "comment_id": 93831729, "body": "Yes. Why are you doubting it? Because it&#39;s &quot;bigger&quot; than the other pointers? You print it using decimal radix, while the rest is using hexadecimal. To print it using hexa, use <code>%x</code> verb, or <code>%p</code> (which will also add a <code>0x</code> prefix)."}, {"owner": {"reputation": 51, "user_id": 7440678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd543f3f005c6e814d9725e62535b0b3?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/7440678/michael"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1543244851, "post_id": 53481035, "comment_id": 93837515, "body": "@icza yes.you get my point ."}], "answers": [{"tags": [], "owner": {"reputation": 552, "user_id": 606880, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f0039481cbb27fea7ef2a47764e5335f?s=128&d=identicon&r=PG", "display_name": "viggy", "link": "https://stackoverflow.com/users/606880/viggy"}, "is_accepted": false, "score": -1, "last_activity_date": 1543235149, "creation_date": 1543235149, "answer_id": 53481098, "question_id": 53481035, "link": "https://stackoverflow.com/questions/53481035/how-can-i-get-the-address-of-a-pointer/53481098#53481098", "title": "How can I get the address of a pointer\uff1f", "body": "<p>No, you need to print the address like %x like you did in the previous print statements. I guess, thats what confused you as the address was being read as an int.</p>\n\n<p>Working code here, <a href=\"https://play.golang.org/p/v0UXMQ3fCkd\" rel=\"nofollow noreferrer\">https://play.golang.org/p/v0UXMQ3fCkd</a></p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1543237371, "creation_date": 1543237371, "answer_id": 53481734, "question_id": 53481035, "link": "https://stackoverflow.com/questions/53481035/how-can-i-get-the-address-of-a-pointer/53481734#53481734", "title": "How can I get the address of a pointer\uff1f", "body": "<blockquote>\n  <p>my question is : is 842350510120 correct address of ip?</p>\n</blockquote>\n\n<p>Nobody can answer this. It depends on your computer and might even change on every run of the program.</p>\n\n<p>If you are asking whether <code>fmt.Printf(\"%d\", &amp;ip)</code> prints the address of ip: Yes.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 7440678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd543f3f005c6e814d9725e62535b0b3?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/7440678/michael"}, "edited": false, "score": 0, "creation_date": 1543245669, "post_id": 53482333, "comment_id": 93837961, "body": "tank u.I just drunk\uff0cu get what i want to ask. thanku"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1543239742, "last_edit_date": 1543239742, "creation_date": 1543239427, "answer_id": 53482333, "question_id": 53481035, "link": "https://stackoverflow.com/questions/53481035/how-can-i-get-the-address-of-a-pointer/53482333#53482333", "title": "How can I get the address of a pointer\uff1f", "body": "<p>If you print addresses in a consistent base (hexadecimal), you will see the expected result. In the current versions of the Go gc compiler, the variables <code>i</code> and <code>pi</code> are allocated on the heap.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var i int = 20\n    var pi *int = &amp;i\n    fmt.Printf(\"%x the address of i\\n\", &amp;i)\n    fmt.Printf(\"%x the address of pi\\n\", &amp;pi)\n    fmt.Printf(\"%x the address that pi stored\\n\", pi)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>c00008e010 the address of i\nc000090018 the address of pi\nc00008e010 the address that pi stored\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7440678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd543f3f005c6e814d9725e62535b0b3?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/7440678/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 53482333, "answer_count": 3, "score": -1, "last_activity_date": 1543239742, "creation_date": 1543234897, "last_edit_date": 1543235863, "question_id": 53481035, "link": "https://stackoverflow.com/questions/53481035/how-can-i-get-the-address-of-a-pointer", "title": "How can I get the address of a pointer\uff1f", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n   var a int= 20   \n   var ip *int    \n\n   ip = &amp;a \n\n   fmt.Printf(\"a address: %x\\n\", &amp;a  )\n\n   fmt.Printf(\" the adrress that ip stored: %x\\n\", ip )\n   /*I try to get the address of variable ip */\n   fmt.Printf(\" the address of ip: %d\\n\", &amp;ip )\n\n}\n</code></pre>\n\n<blockquote>\n  <p>go run a.go</p>\n</blockquote>\n\n<p>result:</p>\n\n<p>a address: c420016078\nthe adrress that ip stored: c420016078 \n the address of ip: 842350510120</p>\n\n<p>my question is : is 842350510120 correct address of ip?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1543245282, "post_id": 53480845, "comment_id": 93837743, "body": "How do you measure a time spent for copy? Please add time.Since in your program and measure what is taking the most time."}, {"owner": {"reputation": 1210, "user_id": 273455, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/92d25bc668af6c5cf336931f1627ba87?s=128&d=identicon&r=PG", "display_name": "GLeBaTi", "link": "https://stackoverflow.com/users/273455/glebati"}, "reply_to_user": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1543304526, "post_id": 53480845, "comment_id": 93859150, "body": "@AlexPliutau i was add profile output snippet to post"}], "answers": [{"tags": [], "owner": {"reputation": 1210, "user_id": 273455, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/92d25bc668af6c5cf336931f1627ba87?s=128&d=identicon&r=PG", "display_name": "GLeBaTi", "link": "https://stackoverflow.com/users/273455/glebati"}, "is_accepted": true, "score": 0, "last_activity_date": 1543396177, "creation_date": 1543396177, "answer_id": 53515774, "question_id": 53480845, "link": "https://stackoverflow.com/questions/53480845/copy-command-slow-from-go/53515774#53515774", "title": "COPY command slow from go", "body": "<p>This is pg driver bug: <a href=\"https://github.com/lib/pq/pull/784\" rel=\"nofollow noreferrer\">https://github.com/lib/pq/pull/784</a></p>\n\n<p>I was replace <code>github.com/lib/pq</code> to <code>github.com/jackc/pgx/stdlib</code> and set this server configuration in <code>postgresql.conf</code>:</p>\n\n<pre><code>autovacuum_vacuum_scale_factor = 0.0  \nautovacuum_vacuum_threshold = 5000\nautovacuum_analyze_scale_factor = 0.0  \nautovacuum_analyze_threshold = 5000  \nsynchronous_commit = off\nwal_level = 'minimal'\narchive_mode = off\nmax_wal_senders = 0\n</code></pre>\n\n<p><strong>And this increase insert speed by 60%</strong></p>\n\n<p>Additional information</p>\n\n<ol>\n<li>use <code>PREPARE</code> with <code>INSERT</code> or <code>COPY</code></li>\n<li><code>Stmt</code> must be closed <strong>after</strong> transaction</li>\n<li>pgx <code>COPY</code> is only supported through the native(no stdlib) interface. You can\nuse <code>AcquireConn</code> and <code>ReleaseConn</code> to get a <code>*pgx.Conn</code> from the\ndatabase/sql pool.</li>\n</ol>\n\n<p>My sample for inserting many rows:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>func InsertParamValueBlocks(params []model.ParamValueBlock) error {\r\n\tvar dbWrk db.Worker\r\n\tvar stmt *sql.Stmt\r\n\tvar err error\r\n\tresult := dbWrk.DoInTransaction(sql.LevelDefault, func() error {\r\n\t\tstmt, err = dbWrk.Context.Prepare(`INSERT INTO \"ParamValueBlock\" (\"ParameterId\", \"DeviceId\", \"CompressedData\", \"StartDate\", \"UncompressedDataBits\")VALUES ($1, $2, $3, $4, $5);`)\r\n\t\tif err != nil {\r\n\t\t\treturn err\r\n\t\t}\r\n\r\n\t\tfor _, param := range params {\r\n\t\t\t_, err := stmt.Exec(\r\n\t\t\t\tparam.ParameterID,\r\n\t\t\t\tparam.DeviceID,\r\n\t\t\t\tparam.CompressedData,\r\n\t\t\t\tparam.StartDate,\r\n\t\t\t\tparam.UncompressedDataBits)\r\n\t\t\tif err != nil {\r\n\t\t\t\treturn err\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn nil\r\n\t})\r\n\t//stmt close after transaction\r\n\terr = stmt.Close()\r\n\tif err != nil {\r\n\t\treturn err\r\n\t}\r\n\treturn result\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 1210, "user_id": 273455, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/92d25bc668af6c5cf336931f1627ba87?s=128&d=identicon&r=PG", "display_name": "GLeBaTi", "link": "https://stackoverflow.com/users/273455/glebati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 53515774, "answer_count": 1, "score": 0, "last_activity_date": 1543396177, "creation_date": 1543234202, "last_edit_date": 1543304476, "question_id": 53480845, "link": "https://stackoverflow.com/questions/53480845/copy-command-slow-from-go", "title": "COPY command slow from go", "body": "<ul>\n<li>HDD,</li>\n<li>Default postgresql config file</li>\n<li>No other connections.</li>\n</ul>\n\n<p>I have a table:</p>\n\n<pre><code>CREATE TABLE \"public\".\"ParamValueBlock\" (\n  \"ParameterId\" int2 NOT NULL,\n  \"DeviceId\" int2 NOT NULL,\n  \"CompressedData\" bytea,\n  \"StartDate\" int4 NOT NULL,\n  \"UncompressedDataBits\" int4 NOT NULL\n)\n</code></pre>\n\n<p>This is my code for batch copy to database:</p>\n\n<pre><code>connectionString := fmt.Sprintf(\"host=%s port=%d user=%s \"+\n        \"password=%s dbname=%s sslmode=disable\",\n        host, port, user, password, dbname)\ndb, err := sql.Open(\"postgres\", connectionString)\nif err != nil {\n    return err\n}\ndefer db.Close()\n\ntx, err := db.BeginTx(context.Background(), &amp;sql.TxOptions{Isolation: sql.LevelReadCommitted, ReadOnly: false})\nif err != nil {\n    return err\n}\n\nstmt, err := tx.Prepare(`COPY \"ParamValueBlock\" (\"ParameterId\", \"DeviceId\", \"CompressedData\", \"StartDate\", \"UncompressedDataBits\") FROM STDIN;`)\nif err != nil {\n    return err\n}\n\nfor _, item := range items{\n    _, err := stmt.Exec(\n        int16(item.paramID),\n        1,\n        item.dataBuffer,\n        item.secondsSince2015,\n        int32(item.uncompressedBitsSize))\n    if err != nil {\n        tx.Rollback()\n        return err\n    }\n}\n\nerr = stmt.Close()\nif err != nil {\n    tx.Rollback()\n    return err\n}\n\nerr = tx.Commit()\nif err != nil {\n    return err\n}\nreturn nil\n</code></pre>\n\n<p>I am writing 1000 items (1 item = 28KB) and this is 7 seconds. </p>\n\n<p>Why so slow and how can i optimize this?</p>\n\n<p>If do it is from file:</p>\n\n<pre><code>COPY \"ParamValueBlock\" FROM 'C:\\Temp\\x.txt' (FORMAT text);\n</code></pre>\n\n<p>time is 0.7 seconds</p>\n\n<p>Profile cpu: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>      flat  flat%   sum%        cum   cum%\r\n     1.82s 31.06% 31.06%      1.83s 31.23%  runtime.cgocall\r\n     0.35s  5.97% 37.03%      0.36s  6.14%  ...pq.appendEscapedText\r\n     0.30s  5.12% 42.15%      0.76s 12.97%  fmt.(*fmt).fmtInteger\r\n     0.30s  5.12% 47.27%      1.53s 26.11%  fmt.(*pp).doPrintf\r\n     0.14s  2.39% 67.92%      2.98s 50.85%  fmt.Sprintf\r\n     0.11s  1.88% 76.11%      0.97s 16.55%  fmt.(*pp).printArg\r\n     0.10s  1.71% 77.82%      0.19s  3.24%  fmt.(*buffer).Write (inline)\r\n     0.09s  1.54% 79.35%      0.85s 14.51%  fmt.(*pp).fmtInteger\r\n     0.09s  1.54% 80.89%      3.26s 55.63%  github.com/lib/pq.encodeBytea\r\n     0.01s  0.17% 94.37%      5.20s 88.74%  github.com/lib/pq.(*copyin).Exec</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1543234091, "post_id": 53480788, "comment_id": 93831154, "body": "Interpreted string literals use quotes, not apostrophes: <code>&quot;Recette&quot;</code> instead of <code>&#39;Recette&#39;</code>. Or backtick when you use raw string literal <code>`Recette`</code>. Apostrophes are used in rune literals."}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "edited": false, "score": 1, "creation_date": 1543234256, "post_id": 53480788, "comment_id": 93831249, "body": "use double quotes instead of single like <code>&quot;Recette&quot;</code> instead of <code>&#39;Recette&#39;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": true, "score": 4, "last_activity_date": 1543234197, "creation_date": 1543234197, "answer_id": 53480843, "question_id": 53480788, "link": "https://stackoverflow.com/questions/53480788/how-to-switch-case-with-string/53480843#53480843", "title": "How to switch case with string", "body": "<p>Your New function must looks like:</p>\n\n<pre><code>func New(value string) Etat {\n    switch value {\n    case \"Recette\", \"Production\":\n        return Etat{Value :value}\n    default:\n        panic(\"unrecognized value\")\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 228, "user_id": 8567993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMUkS.jpg?s=128&g=1", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/8567993/mehdi"}, "is_accepted": false, "score": 3, "last_activity_date": 1543234282, "creation_date": 1543234282, "answer_id": 53480873, "question_id": 53480788, "link": "https://stackoverflow.com/questions/53480788/how-to-switch-case-with-string/53480873#53480873", "title": "How to switch case with string", "body": "<p>use double quotes instead of single quote in case expresion</p>\n\n<pre><code>case \"Recette\":\n\ninstead of\n\ncase 'Recette':\n</code></pre>\n\n<p>by the way, better to change your function name from New() to something else</p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 0, "closed_date": 1543237238, "accepted_answer_id": 53480843, "answer_count": 2, "score": 0, "last_activity_date": 1543236271, "creation_date": 1543234040, "last_edit_date": 1543236271, "question_id": 53480788, "link": "https://stackoverflow.com/questions/53480788/how-to-switch-case-with-string", "closed_reason": "Not suitable for this site", "title": "How to switch case with string", "body": "<p>Here is my code: </p>\n\n<pre><code>type Etat struct {\n    gorm.Model\n    Value string `form:\"value\"`\n}\n\nfunc New(value string) Etat {\n    switch value {\n    case 'Recette':\n        return Etat{Value :value}\n    case 'Production':\n        return Etat{Value :value}\n    default:\n        panic(\"unrecognized value\")\n    }\n\n}\n</code></pre>\n\n<p>And here is the error that I got : </p>\n\n<pre><code>.\\MicroConf.go:23:2: invalid case '\\u0000' in switch on value (mismatched types rune and string)\n.\\MicroConf.go:23:7: invalid character literal (more than one character)\n.\\MicroConf.go:25:2: invalid case '\\u0000' in switch on value (mismatched types rune and string)\n.\\MicroConf.go:25:2: duplicate case '\\u0000' (value 0) in switch\n    previous case at .\\MicroConf.go:23:7\n.\\MicroConf.go:25:7: invalid character literal (more than one character)\n</code></pre>\n\n<p>I truly don't understand how it's not working. I'm trying to follow this <a href=\"https://github.com/golang/go/wiki/Switch\" rel=\"nofollow noreferrer\">tutorial</a></p>\n"}, {"tags": ["regex", "string", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543231381, "post_id": 53479885, "comment_id": 93829802, "body": "If your request is for an existing implementation, that is off-topic, as resource requests are not allowed here.  If your question is how to improve or fix your current code, you need to be more specific: What problems are you facing? What help do you need?"}, {"owner": {"reputation": 7206, "user_id": 5741643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27485d5a049481e18d6aeb3f18480447?s=128&d=identicon&r=PG&f=1", "display_name": "Poul Bak", "link": "https://stackoverflow.com/users/5741643/poul-bak"}, "edited": false, "score": 1, "creation_date": 1543231452, "post_id": 53479885, "comment_id": 93829835, "body": "Show examples of input and expected output and what fails."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543231513, "post_id": 53479885, "comment_id": 93829875, "body": "Also note that &quot;is&quot; is not an article, it&#39;s a verb."}], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 2, "last_activity_date": 1543232241, "last_edit_date": 1543232241, "creation_date": 1543231708, "answer_id": 53480140, "question_id": 53479885, "link": "https://stackoverflow.com/questions/53479885/remove-all-articles-and-other-strings-from-a-string-using-go/53480140#53480140", "title": "Remove all articles and other strings from a string using Go?", "body": "<p>You can use <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow noreferrer\"><code>strings.Split</code></a> and <a href=\"https://golang.org/pkg/strings/#Join\" rel=\"nofollow noreferrer\"><code>strings.Join</code></a> plus a loop for filtering and then building it together again:</p>\n\n<pre><code>removalString := \"This is a string\"\nstringToRemove := []string{\"a\", \"an\", \"the\", \"is\"}\nfilteredStrings := make([]string, 0)\nfor _, w := range strings.Split(removalString, \" \") {\n    shouldAppend := true\n    lowered := strings.ToLower(w)\n    for _, w2 := range stringToRemove {\n        if lowered == w2 {\n            shouldAppend = false\n            break\n        }\n    }\n    if shouldAppend {\n        filteredStrings = append(filteredStrings, lowered)\n    }\n}\nresultString := strings.Join(filteredStrings, \"-\")\nfmt.Printf(resultString)\n</code></pre>\n\n<p>Outpus:</p>\n\n<pre><code>this-string\nProgram exited.\n</code></pre>\n\n<p>Here you have the <a href=\"https://play.golang.org/p/Tle3Yc11-zM\" rel=\"nofollow noreferrer\">live example</a></p>\n"}, {"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 1, "last_activity_date": 1543232924, "creation_date": 1543232924, "answer_id": 53480470, "question_id": 53479885, "link": "https://stackoverflow.com/questions/53479885/remove-all-articles-and-other-strings-from-a-string-using-go/53480470#53480470", "title": "Remove all articles and other strings from a string using Go?", "body": "<p>My version just using regexp</p>\n\n<p>Construct a regexp of the form '\\ba\\b|\\ban\\b|\\bthe\\b|\\bis\\b|' which will find\nthe words in the list that have \"word boundaries\" on both sides - so \"This\" is not matched</p>\n\n<p>Second regexp reduces any spaces to dashes and makes multiple spaces a single dash</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    removalString := \"This is a strange string\"\n    stringToRemove := []string{\"a\", \"an\", \"the\", \"is\"}\n\n    var reg bytes.Buffer\n    for _, x := range stringToRemove {\n        reg.WriteString(`\\b`) // word boundary\n        reg.WriteString(x)\n        reg.WriteString(`\\b`)\n        reg.WriteString(`|`) // alternation operator\n    }\n    regx := regexp.MustCompile(reg.String())\n    slug := regx.ReplaceAllString(removalString, \"\")\n    regx2 := regexp.MustCompile(` +`)\n    slug = regx2.ReplaceAllString(slug, \"-\")\n\n    fmt.Println(slug)\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 10493731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24a7b83c1e4fcffbea7e0c4266ecefa?s=128&d=identicon&r=PG&f=1", "display_name": "puneet55667788", "link": "https://stackoverflow.com/users/10493731/puneet55667788"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1543235296, "creation_date": 1543230749, "last_edit_date": 1543231864, "question_id": 53479885, "link": "https://stackoverflow.com/questions/53479885/remove-all-articles-and-other-strings-from-a-string-using-go", "title": "Remove all articles and other strings from a string using Go?", "body": "<p>Is there any method in Go or having regular expression that it will remove only the articles used in the string?</p>\n\n<p>I have tried below code that will do it but it will also remove other words from the string I'm showing the code below:</p>\n\n<pre><code> removalString := \"This is a string\"\n stringToRemove := []string{\"a\", \"an\", \"the\", \"is\"}\n for _, wordToRemove := range stringToRemove {\n     removalString = strings.Replace(removalString, wordToRemove, \"\", -1)\n }\n space := regexp.MustCompile(`\\s+`)\n trimedExtraSpaces := space.ReplaceAllString(removalString, \" \")\n spacesCovertedtoDashes := strings.Replace(trimedExtraSpaces, \" \", \"-\", -1)\n slug := strings.ToLower(spacesCovertedtoDashes)\n fmt.Println(slug)\n</code></pre>\n\n<p><strong>Edited</strong></p>\n\n<p><a href=\"https://play.golang.org/p/f1uvuWW40TT\" rel=\"nofollow noreferrer\">Play link</a></p>\n\n<p>In this It will remove the <code>is</code> which is used in the <code>this</code>.</p>\n\n<p>The Expected output is <code>this-string</code></p>\n"}, {"tags": ["docker", "go"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 10, "last_activity_date": 1543230366, "creation_date": 1543230366, "answer_id": 53479792, "question_id": 53479572, "link": "https://stackoverflow.com/questions/53479572/how-to-disable-cgo-for-running-tests/53479792#53479792", "title": "How to disable CGO for running tests", "body": "<p>You've disabled CGO for your build, but you're not disabling CGO for your tests, which you must do:</p>\n\n<pre><code>CGO_ENABLED=0 GOOS=linux go test -v ./...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4445419"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5040, "favorite_count": 1, "accepted_answer_id": 53479792, "answer_count": 1, "score": 5, "last_activity_date": 1543230478, "creation_date": 1543229621, "last_edit_date": 1543230478, "question_id": 53479572, "link": "https://stackoverflow.com/questions/53479572/how-to-disable-cgo-for-running-tests", "title": "How to disable CGO for running tests", "body": "<p>I use Docker to add my project to it, now I want to run some test on it and I got errors that the test failed</p>\n\n<p>Any idea what I miss here?</p>\n\n<pre><code># build stage\nFROM golang:1.11.1-alpine3.8 AS builder\n\nRUN apk add --update --no-cache make \\\n    git\n\nADD https://github.com/golang/dep/releases/download/v0.5.0/dep-linux-amd64 /usr/bin/dep\nRUN chmod +x /usr/bin/dep\n\nRUN mkdir -p $GOPATH/src/github.company/user/go-application\nWORKDIR  $GOPATH/src/github.company/user/go-application\nCOPY Gopkg.toml Gopkg.lock ./\nRUN dep ensure --vendor-only\nCOPY . ./\n</code></pre>\n\n<p>Now I build the docker which finish successfully and now I want to run tests on it.</p>\n\n<p>I did docker run <code>docker run -it goapp</code> which run successfully </p>\n\n<p>And now I use command <code>go test -v ./...</code> and I got error </p>\n\n<pre><code># runtime/cgo\nexec: \"gcc\": executable file not found in $PATH\nFAIL    github.company/user/go-application [build failed]\nFAIL    github.company/user/go-application/integration [build failed]\n</code></pre>\n\n<p>Any idea how to resolve this ?</p>\n\n<p>I try another step in docker file like following which doesnt helps</p>\n\n<pre><code>RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix nocgo -o /go-application .\n</code></pre>\n"}, {"tags": ["go", "build", "dependencies", "dependency-management", "dep"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543227859, "post_id": 53478961, "comment_id": 93827983, "body": "Are you importing those testing dependencies only in your *_test.go files? If so, those files aren&#39;t included in go-build&#39;s output, neither are the deps imported in those files."}, {"owner": {"reputation": 705, "user_id": 637794, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b7cb728a98ea17d32a6b12d2affebd13?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/637794/sammy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543313032, "post_id": 53478961, "comment_id": 93863557, "body": "@mkopriva thanks for your answer. could you please show some source for this info?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1543313182, "post_id": 53478961, "comment_id": 93863640, "body": "<a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-Compile_packages_and_dependencies</a> <i>&quot; When compiling packages, build ignores files that end in &#39;_test.go&#39;. &quot;</i>"}, {"owner": {"reputation": 705, "user_id": 637794, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b7cb728a98ea17d32a6b12d2affebd13?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/637794/sammy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545131405, "post_id": 53478961, "comment_id": 94511712, "body": "@mkopriva thanks a lot for the info. If I am importing the dependency A in _test.go file, and the dependency B is imported only in A, would B included in go-build or not? Technically, B is not imported only in _test.go file.  How can I even verify this myself?"}], "owner": {"reputation": 705, "user_id": 637794, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b7cb728a98ea17d32a6b12d2affebd13?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/637794/sammy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543227464, "creation_date": 1543227464, "question_id": 53478961, "link": "https://stackoverflow.com/questions/53478961/different-dependencies-for-different-environments-with-dep", "title": "Different dependencies for different environments with dep", "body": "<p>How can I ensure that I use different dependencies depending on the environment/build? For example, I do not want to include some dependencies required for the testing environment in my production build?</p>\n"}, {"tags": ["go", "db2"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5233181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iNWF1E4K1Ow/AAAAAAAAAAI/AAAAAAAAA7g/-ZUvvErmM1g/photo.jpg?sz=128", "display_name": "Shashi", "link": "https://stackoverflow.com/users/5233181/shashi"}, "edited": false, "score": 0, "creation_date": 1543251675, "post_id": 53479980, "comment_id": 93841330, "body": "Thanks mao for the response, i tried with these changes. however there is some conflict between  package import and my mail class import so i had to remove phiggins import &quot;bitbucket.org/phiggins/db2cli&quot; from my class. After that getting this issue if you know          sql: unknown driver &quot;db2-cli&quot; (forgotten import?)"}, {"owner": {"reputation": 8474, "user_id": 8290634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23c338d78a579b717f1cb6e9f16fb1b?s=128&d=identicon&r=PG&f=1", "display_name": "mao", "link": "https://stackoverflow.com/users/8290634/mao"}, "reply_to_user": {"reputation": 23, "user_id": 5233181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iNWF1E4K1Ow/AAAAAAAAAAI/AAAAAAAAA7g/-ZUvvErmM1g/photo.jpg?sz=128", "display_name": "Shashi", "link": "https://stackoverflow.com/users/5233181/shashi"}, "edited": false, "score": 0, "creation_date": 1543252002, "post_id": 53479980, "comment_id": 93841474, "body": "Too vague. Edit your question to fully describe your environment (versions of all components), and exactly what steps you took, and whether you proved the Db2 client was working correctly before you try go with phiggins db2cli, and whether you used <i>exactly</i> the sample program given by phiggins."}, {"owner": {"reputation": 23, "user_id": 5233181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iNWF1E4K1Ow/AAAAAAAAAAI/AAAAAAAAA7g/-ZUvvErmM1g/photo.jpg?sz=128", "display_name": "Shashi", "link": "https://stackoverflow.com/users/5233181/shashi"}, "edited": false, "score": 0, "creation_date": 1543311552, "post_id": 53479980, "comment_id": 93862637, "body": "I could connect to my local db2 instance after redoing above configuration. For remote connection i am getting license issue, but that is not related to this. Thanks a lot mao."}, {"owner": {"reputation": 8474, "user_id": 8290634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23c338d78a579b717f1cb6e9f16fb1b?s=128&d=identicon&r=PG&f=1", "display_name": "mao", "link": "https://stackoverflow.com/users/8290634/mao"}, "reply_to_user": {"reputation": 23, "user_id": 5233181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iNWF1E4K1Ow/AAAAAAAAAAI/AAAAAAAAA7g/-ZUvvErmM1g/photo.jpg?sz=128", "display_name": "Shashi", "link": "https://stackoverflow.com/users/5233181/shashi"}, "edited": false, "score": 0, "creation_date": 1543314160, "post_id": 53479980, "comment_id": 93864162, "body": "Well done. Mark the answer as correct if it helped you. If the remote database runs on Z/OS or i-Series you will need to add the relevant licence file to your Db2 client."}], "tags": [], "owner": {"reputation": 8474, "user_id": 8290634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23c338d78a579b717f1cb6e9f16fb1b?s=128&d=identicon&r=PG&f=1", "display_name": "mao", "link": "https://stackoverflow.com/users/8290634/mao"}, "is_accepted": true, "score": 0, "last_activity_date": 1543232043, "last_edit_date": 1543232043, "creation_date": 1543231110, "answer_id": 53479980, "question_id": 53478613, "link": "https://stackoverflow.com/questions/53478613/connection-with-db2-server-using-golang-using-windows/53479980#53479980", "title": "connection with db2 server using golang using windows", "body": "<p>The following steps let me connect to Db2 from golang on Windows7 pro x64. \nYour mileage may vary. </p>\n\n<p>I Used a recent \"Db2 Runtime Client\" package for Windows x64 downloadable from IBM website (in my case that was version 11.1.3.3b) and the filename I downloaded was <code>v11.1.3fp3b_ntx64_rtcl.exe</code></p>\n\n<p>This is installed locally at location <code>\"c:\\Program Files\\IBM\\sqllib\"</code> location (default).</p>\n\n<p>I have already a working gcc installed on Windows7 for other projects (it may be from minGW).</p>\n\n<p>I verified in a db2cmd.exe window that I can successfully connect via the CLP (which uses CLI) to the database of interest, using a specific port number and specific credentials. This way I know that the Db2-client is installed properly, and the Db2-server is running, the database is available, and credentials and port are all OK.</p>\n\n<p>Running as local administrator, Installed go for Windows from msi file downloaded from golang.org/dl to default location <code>c:\\go</code>.</p>\n\n<p>Downloaded  <code>phiggins-db2cli-*.zip</code> from <a href=\"https://bitbucket.org/phiggins/db2cli\" rel=\"nofollow noreferrer\">https://bitbucket.org/phiggins/db2cli</a></p>\n\n<p>Created local directory: <code>mkdir %userprofile%\\go\\src\\bitbucket.org\\phiggins\\db2cli</code></p>\n\n<p>Unzipped contents of the phiggins-db2cli-*.zip into <code>%userprofile%\\go\\src\\bitbucket.org\\phiggins\\db2cli</code></p>\n\n<p>In a db2cmd.exe window running as Adminstrator:</p>\n\n<pre><code>cd %userprofile%\\go\\src\\bitbucket.org\\phiggins\\db2cli\n</code></pre>\n\n<p>Created a batch file <code>buildgo.bat</code> with the following contents:</p>\n\n<pre><code>set DB2HOME=\"C:\\program files\\ibm\\sqllib\"\n\nset CGO_LDFLAGS=-L\"C:\\Program Files\\IBM\\sqllib\\lib\"\n\nset CGO_CFLAGS=-I\"C:\\Program Files\\IBM\\sqllib\\include\"\n\ngo build .\n</code></pre>\n\n<p>In a db2cmd window running as administrator, ran the batchfile, it completed without errors or messages with errorlevel 0.</p>\n\n<p>In the same db2cmd window, created a file containing the sample program shown at <a href=\"https://bitbucket.org/phiggins/db2cli\" rel=\"nofollow noreferrer\">https://bitbucket.org/phiggins/db2cli</a></p>\n\n<p>The file I created was called <code>testgo.go</code></p>\n\n<p>I then execute the sample program:</p>\n\n<pre><code>go run testgo.co -conn DATABASE=sample;HOSTNAME=whatever;PORT=60000;UID=whatever;PWD=whatever;\n</code></pre>\n\n<p>--> successfully get the result set on screen</p>\n"}], "owner": {"reputation": 23, "user_id": 5233181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iNWF1E4K1Ow/AAAAAAAAAAI/AAAAAAAAA7g/-ZUvvErmM1g/photo.jpg?sz=128", "display_name": "Shashi", "link": "https://stackoverflow.com/users/5233181/shashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 53479980, "answer_count": 1, "score": 0, "last_activity_date": 1543232043, "creation_date": 1543226282, "last_edit_date": 1543231694, "question_id": 53478613, "link": "https://stackoverflow.com/questions/53478613/connection-with-db2-server-using-golang-using-windows", "title": "connection with db2 server using golang using windows", "body": "<p>I'm trying to make connection to a Db2 database using golang. I'm using <a href=\"https://bitbucket.org/phiggins/db2cli\" rel=\"nofollow noreferrer\">package</a> to make connection and using the Db2 client called <code>v10.1fp6_ntx64_odbc_cli</code>. </p>\n\n<p>However when I see the instruction on phiggins package it suggest to rebuild package after providing few environment variables</p>\n\n<pre><code>#!/bin/bash\n\n DB2HOME=$HOME/sqllib\n export CGO_LDFLAGS=-L$DB2HOME/lib\n export CGO_CFLAGS=-I$DB2HOME/include\n\n go build .\n</code></pre>\n\n<p>I'm new to golang and not sure how to perform this on Windows. I tried doing it using setting up environment variable but does not work. getting error </p>\n\n<blockquote>\n  <p>panic: Failed to load db2cli64.dll: The specified module could not be found.\n  goroutine 1 [running]:\n      syscall.(*LazyProc).mustFind(0xc000060270)\n       C:/Go/src/syscall/dll_windows.go:280 +0x5f\n      syscall.(*LazyProc).Addr(0xc000060270, 0x64)\n       C:/Go/src/syscall/dll_windows.go:287 +0x32\n      bitbucket.org/phiggins/db2cli/api.SQLAllocHandle(0x4f0001, 0x0, 0xc000071ef8, 0xc000071f00)<br>\n       C:/Users/myuser/go/src/bitbucket.org/phiggins/db2cli/api/zapi_windows.go:44 +0x34\n         bitbucket.org/phiggins/db2cli.initDriver(0x0, 0x0)\n       C:/Users/myuser/go/src/bitbucket.org/phiggins/db2cli/driver.go:26 +0x57\n               bitbucket.org/phiggins/db2cli.init.0()\n       C:/Users/myuser/go/src/bitbucket.org/phiggins/db2cli/driver.go:52 +0x29\n         exit status 2</p>\n</blockquote>\n\n<p>Please help me to solve this , Looking to connect to a Db2 database using golang.</p>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543227115, "post_id": 53478517, "comment_id": 93827521, "body": "it&#39;s not clear what you are asking.  There are six stats at zero and it is a perfectly reasonable result to get back from the query shown.  What is the problem you need to understand?"}, {"owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543228223, "post_id": 53478517, "comment_id": 93828165, "body": "The data is not inserted into elastic search, if there are some data inserted, then the result shouldn&#39;t be zero. I am not sure what the error is."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543231312, "post_id": 53478517, "comment_id": 93829766, "body": "You don&#39;t show your code for the data insertion but you are saying that&#39;s where the error is.  So it&#39;s impossible for anyone else to say what the problem might be with it ...."}], "owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543225998, "creation_date": 1543225998, "question_id": 53478517, "link": "https://stackoverflow.com/questions/53478517/no-data-inserted-into-elasticsearch-with-olivere-golang", "title": "No Data Inserted Into ElasticSearch with Olivere Golang", "body": "<p>I have changed my code so that it uses olivere package when inserting data into elastic search. This is the code </p>\n\n<pre><code> // Get a snapshot of stats (always blank if not enabled--see above)\n                    stats := p.Stats()\n\n                    fmt.Printf(\"Number of times flush has been invoked: %d\\n\", stats.Flushed)\n                    fmt.Printf(\"Number of times workers committed reqs: %d\\n\", stats.Committed)\n                    fmt.Printf(\"Number of requests indexed            : %d\\n\", stats.Indexed)\n                    fmt.Printf(\"Number of requests reported as created: %d\\n\", stats.Created)\n                    fmt.Printf(\"Number of requests reported as updated: %d\\n\", stats.Updated)\n                    fmt.Printf(\"Number of requests reported as success: %d\\n\", stats.Succeeded)\n                    fmt.Printf(\"Number of requests reported as failed : %d\\n\", stats.Failed)\n</code></pre>\n\n<p>This is the log that I got </p>\n\n<pre><code>Number of times flush has been invoked: 1\nNumber of times workers committed reqs: 0\nNumber of requests indexed            : 0\nNumber of requests reported as created: 0\nNumber of requests reported as updated: 0\nNumber of requests reported as success: 0\nNumber of requests reported as failed : 0\n</code></pre>\n\n<p>I don't know why the result is 0. I am not sure how to find where the error is. Does anyone know how to find the error? </p>\n"}, {"tags": ["string", "go", "replace"], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 0, "last_activity_date": 1543225980, "creation_date": 1543225980, "answer_id": 53478511, "question_id": 53478413, "link": "https://stackoverflow.com/questions/53478413/why-the-string-replace-is-not-working-in-golang/53478511#53478511", "title": "Why the string.Replace is not working in golang", "body": "<p>this is what youre looking for:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"strings\"\n)\n\nfunc main() {\n  strValue := \"This is a string\"\n  stringRemove := []string{\"a\", \"an\"}\n  removalString := strValue\n  for _, wordToRemove := range stringRemove {\n      removalString = strings.Replace(removalString, wordToRemove, \"\", -1)\n  }\n  fmt.Println(removalString)\n  result := strings.Replace(strValue, \" \", \"\", -1)\n  result1 := strings.ToLower(result)\n  fmt.Println(result1)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1543226463, "post_id": 53478516, "comment_id": 93827140, "body": "if I&#39;m changing the line this <code>result := strings.Replace(removalString, &quot; &quot;, &quot;-&quot;, -1)</code> then i will include three dashes but I need one dash if there is lot of space. How will I got that. see :- <a href=\"https://play.golang.org/p/ySECjiZ7Iek\" rel=\"nofollow noreferrer\">play.golang.org/p/ySECjiZ7Iek</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1543227975, "post_id": 53478516, "comment_id": 93828052, "body": "@user10665991 You may replace <code>&quot;--&quot;</code> with <code>&quot;-&quot;</code>, repeatedly until there is no change (replace). Or you may use regexp for that."}, {"owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "edited": false, "score": 0, "creation_date": 1543229136, "post_id": 53478516, "comment_id": 93828629, "body": "will you tell me the regular expression? I give it lot of time to solve this :("}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1543226396, "last_edit_date": 1543226396, "creation_date": 1543225997, "answer_id": 53478516, "question_id": 53478413, "link": "https://stackoverflow.com/questions/53478413/why-the-string-replace-is-not-working-in-golang/53478516#53478516", "title": "Why the string.Replace is not working in golang", "body": "<p>You always apply the replace operation on the original string <code>strValue</code>, so after the loop only the last removable word will be removed (which is not even contained in your example). You should store the result of <code>strings.Replace()</code> (you do that), and use this in the next iteration:   </p>\n\n<pre><code>removalString := strValue\nfor _, wordToRemove := range stringRemove {\n    removalString = strings.Replace(removalString, wordToRemove, \"\", -1)\n}\n</code></pre>\n\n<p>And also use this in your last replacement:</p>\n\n<pre><code>result := strings.Replace(removalString, \" \", \"\", -1)\nresult1 := strings.ToLower(result)\n</code></pre>\n\n<p>Then output will be (try it on the <a href=\"https://play.golang.org/p/jkL6GVRjqQK\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>This is  string\nthisisstring\n</code></pre>\n\n<p>Also note that to remove spaces, you can add that to the list of removable words, and you don't need to always create new variables, you can reuse existing ones.</p>\n\n<p>This will also perform the same transformation:</p>\n\n<pre><code>s := \"This is a string\"\nwords := []string{\"a\", \"an\", \" \"}\n\nfor _, word := range words {\n    s = strings.Replace(s, word, \"\", -1)\n}\n\ns = strings.ToLower(s)\nfmt.Println(s)\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/ZAMwZqgsaVe\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1543227898, "creation_date": 1543227898, "answer_id": 53479078, "question_id": 53478413, "link": "https://stackoverflow.com/questions/53478413/why-the-string-replace-is-not-working-in-golang/53479078#53479078", "title": "Why the string.Replace is not working in golang", "body": "<p><code>removalString</code> will be set new value each loop. So <code>fmt.Println(removalString)</code> will show the result of last loop.</p>\n\n<pre><code>var removalString string\nfor _, wordToRemove := range stringRemove {\n    removalString = strings.Replace(strValue, wordToRemove, \"\", -1)\n}\nfmt.Println(removalString)\n</code></pre>\n\n<p>You may do like this</p>\n\n<pre><code>strValue := \"This is a string\"\nstringRemove := []string{\"a\", \"an\"}\nfor _, wordToRemove := range stringRemove {\n    strValue = strings.Replace(strValue, wordToRemove, \"\", -1)\n}\nfmt.Println(strValue)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10665991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871bd63c680ef4b2509171fa5493f274?s=128&d=identicon&r=PG&f=1", "display_name": "user10665991", "link": "https://stackoverflow.com/users/10665991/user10665991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1363, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1543227898, "creation_date": 1543225654, "last_edit_date": 1543226170, "question_id": 53478413, "link": "https://stackoverflow.com/questions/53478413/why-the-string-replace-is-not-working-in-golang", "title": "Why the string.Replace is not working in golang", "body": "<p>I'm making a program to remove the letters from a string if they exsists. But the expected result will not come. The Program I have tried is below:-</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"strings\"\n)\n\nfunc main() {\n  strValue := \"This is a string\"\n  stringRemove := []string{\"a\", \"an\"}\n  var removalString string\n  for _, wordToRemove := range stringRemove {\n      removalString = strings.Replace(strValue, wordToRemove, \"\", -1)\n  }\n  fmt.Println(removalString)\n  result := strings.Replace(strValue, \" \", \"\", -1)\n  result1 := strings.ToLower(result)\n  fmt.Println(result1)\n}\n</code></pre>\n\n<p>Output:-</p>\n\n<pre><code>This is a string\nthisisastring\n</code></pre>\n\n<p>If I use the  line <code>fmt.Println(removalString)</code> in the for loop then it will print the result:- </p>\n\n<p>output:- </p>\n\n<pre><code>This is  string\nThis is a string\nThis is a string\nthisisastring\n</code></pre>\n\n<p>Expected output:-</p>\n\n<pre><code>thisisstring\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EhNFVyObcxt\" rel=\"nofollow noreferrer\">kheedn li link</a></p>\n"}, {"tags": ["list", "go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1543226337, "post_id": 53478342, "comment_id": 93827064, "body": "A container/list might or might not have advantages as opposed to a slice. For <i>most</i> use cases a slice is fine and the better option. container/list might not be used often (same with container/heap) but it was used in earlier versions of Go, it is included to provide a linkes list implementation and it stays there for compatibility reasons and because it might be the right choice. Never believe someone who tell you to literally to &quot;never&quot; do something. It al depends. Always."}, {"owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543239390, "post_id": 53478342, "comment_id": 93834176, "body": "Yes,It is clearly based on requirements.duly noted :)"}], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "edited": false, "score": 0, "creation_date": 1543239546, "post_id": 53481533, "comment_id": 93834271, "body": "In other programming languages,like java, 90% you would choose<code>Arraylist</code> is or at python you would prefer <code>list</code>. That&#39;s why , I wonder ,why not at go?"}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "reply_to_user": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "edited": false, "score": 0, "creation_date": 1543239603, "post_id": 53481533, "comment_id": 93834308, "body": "@SiddhantaRath exactly, and it provides similar functionality to slices"}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": false, "score": 1, "last_activity_date": 1543236710, "creation_date": 1543236710, "answer_id": 53481533, "question_id": 53478342, "link": "https://stackoverflow.com/questions/53478342/when-to-choose-container-list-over-slice-at-go/53481533#53481533", "title": "when to choose container/list over slice at go", "body": "<p><code>list.List</code> is an implementation of a <a href=\"https://en.wikipedia.org/wiki/Doubly_linked_list\" rel=\"nofollow noreferrer\">Doubly Linked list</a>. Slices are an abstraction over arrays. Slices provide feature-ful arrays that include growing arrays without copying of data, taking \"slices\" of a slice without reallocation or copying.<br>\nIt all comes down to the use case. Linked-list is by its nature a growing list of items that does not require copying of data whatsoever. Linked-list is perfect for growing data that has to be traversed in one direction. Arrays/Slices are perfect if the data has to be accessed arbitrarily (from any index without a cursor), or data has to be added and removed from the middle dynamically.  </p>\n\n<p>This is a general answer. Bottom-line, 90% of the time you won't <strong>need</strong> <code>list.List</code>. Slices suffice.  </p>\n"}], "owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "closed_date": 1543247979, "answer_count": 1, "score": 0, "last_activity_date": 1543236710, "creation_date": 1543225407, "last_edit_date": 1543225730, "question_id": 53478342, "link": "https://stackoverflow.com/questions/53478342/when-to-choose-container-list-over-slice-at-go", "closed_reason": "Opinion-based", "title": "when to choose container/list over slice at go", "body": "<p>I have not faced any problem, which can't be solved by slice.</p>\n\n<p>As per the list implementation, Any insertion to list end-up creating a new element struct which wraps the value to <code>interface{}</code>\nRange is also not supported for iteration of list.\nI found some article which says never use <code>list.List</code> at production.</p>\n\n<p>Just wondering, why is it there at go source package\n[<a href=\"https://golang.org/pkg/container/list/]\" rel=\"nofollow noreferrer\">https://golang.org/pkg/container/list/]</a></p>\n\n<p>Anybody here, used list at production and gained some advantages?</p>\n"}, {"tags": ["http", "go", "https", "proxy"], "comments": [{"owner": {"reputation": 552, "user_id": 606880, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f0039481cbb27fea7ef2a47764e5335f?s=128&d=identicon&r=PG", "display_name": "viggy", "link": "https://stackoverflow.com/users/606880/viggy"}, "edited": false, "score": 1, "creation_date": 1543220746, "post_id": 53476333, "comment_id": 93824287, "body": "You could probably try it yourself and let us know what is the issue you faced or error your received on execution of the code. This way it will be easier to check on the code as otherwise we will have write a sample code ourselves with some proxy server to test your code."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1543232730, "creation_date": 1543232730, "answer_id": 53480407, "question_id": 53476333, "link": "https://stackoverflow.com/questions/53476333/how-to-use-a-self-signed-certificate-through-proxy-server-client/53480407#53480407", "title": "How to use a self-signed certificate through proxy server client", "body": "<p>\"Is there a problem\"? Only if you consider blindly trusting the certificate a problem (that's why it's called <em>Insecure</em>SkipVerify).</p>\n\n<p>The better option is to configure the client to trust the specific certificate that the server is using, so you get MITM protection in addition to encryption.</p>\n\n<p>To do this, get a copy of the server's certificate via a trusted channel (e.g. copy it from the server's filesystem), then add it to the client's CA pool (this will also trust all certificates signed by the server's cert, if applicable).</p>\n\n<p>Here is an example for <a href=\"https://github.com/golang/go/blob/master/src/net/http/internal/testcert.go\" rel=\"nofollow noreferrer\">the test certificate in net/http</a>, which is used by <a href=\"https://golang.org/pkg/net/http/httptest/#NewTLSServer\" rel=\"nofollow noreferrer\">httptest.NewTLSServer</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"crypto/x509\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n)\n\n// cert is used by httptest.NewTLSServer.\n//\n// In a real application you're going to want to load the certificate from\n// disk, rather than hard-coding it. Otherwise you have to recompile the program\n// when the certificate is updated.\nvar cert = []byte(`-----BEGIN CERTIFICATE-----\nMIICEzCCAXygAwIBAgIQMIMChMLGrR+QvmQvpwAU6zANBgkqhkiG9w0BAQsFADAS\nMRAwDgYDVQQKEwdBY21lIENvMCAXDTcwMDEwMTAwMDAwMFoYDzIwODQwMTI5MTYw\nMDAwWjASMRAwDgYDVQQKEwdBY21lIENvMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCB\niQKBgQDuLnQAI3mDgey3VBzWnB2L39JUU4txjeVE6myuDqkM/uGlfjb9SjY1bIw4\niA5sBBZzHi3z0h1YV8QPuxEbi4nW91IJm2gsvvZhIrCHS3l6afab4pZBl2+XsDul\nrKBxKKtD1rGxlG4LjncdabFn9gvLZad2bSysqz/qTAUStTvqJQIDAQABo2gwZjAO\nBgNVHQ8BAf8EBAMCAqQwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDwYDVR0TAQH/BAUw\nAwEB/zAuBgNVHREEJzAlggtleGFtcGxlLmNvbYcEfwAAAYcQAAAAAAAAAAAAAAAA\nAAAAATANBgkqhkiG9w0BAQsFAAOBgQCEcetwO59EWk7WiJsG4x8SY+UIAA+flUI9\ntyC4lNhbcF2Idq9greZwbYCqTTTr2XiRNSMLCOjKyI7ukPoPjo16ocHj+P3vZGfs\nh1fIw3cSS2OolhloGw/XM6RWPWtPAlGykKLciQrBru5NAPvCMsb/I1DAceTiotQM\nfblo6RBxUQ==\n-----END CERTIFICATE-----`)\n\nfunc main() {\n    pool, err := x509.SystemCertPool()\n    if err != nil {\n        log.Fatal(err)\n    }\n    if !pool.AppendCertsFromPEM(cert) {\n        log.Fatal(\"Cannot append self-signed cert to CA pool\")\n    }\n\n    c := &amp;http.Client{\n        Transport: &amp;http.Transport{\n            TLSClientConfig: &amp;tls.Config{\n                RootCAs: pool,\n            },\n        },\n    }\n\n    s := httptest.NewTLSServer(nil)\n    res, err := c.Get(s.URL)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(res.Status)\n}\n</code></pre>\n\n<p>Try it on the playground: <a href=\"https://play.golang.org/p/HsI2RyOd5qd\" rel=\"nofollow noreferrer\">https://play.golang.org/p/HsI2RyOd5qd</a></p>\n"}], "owner": {"reputation": 101, "user_id": 10684813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a52beef370c9f21f794e5d6b0a96698?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkylo", "link": "https://stackoverflow.com/users/10684813/darkskylo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543232730, "creation_date": 1543216829, "last_edit_date": 1543225366, "question_id": 53476333, "link": "https://stackoverflow.com/questions/53476333/how-to-use-a-self-signed-certificate-through-proxy-server-client", "title": "How to use a self-signed certificate through proxy server client", "body": "<p>I am trying to create an HTTP client that can send self-signed HTTP requests through a proxy server.</p>\n\n<p>I tried this code but I am not sure if there is a problem here, will the following code work?</p>\n\n<pre><code>func CreateProxyClient(serverProxy string, sid string, portProxy int) (*Client, error) {\n    http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config{InsecureSkipVerify: true}\n\n    proxyUrl, _ := url.Parse(serverProxy+\":\"+strconv.Itoa(portProxy))\n    tr := &amp;http.Transport{\n        Proxy: http.ProxyURL(proxyUrl),\n    }\n    var netClient = &amp;http.Client{\n        Timeout: time.Second * 10,\n        Transport: tr,\n    }\n    return &amp;Client{netClient, serverProxy, sid}, nil\n}\n</code></pre>\n"}, {"tags": ["xml", "validation", "go", "xml-parsing"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543237674, "post_id": 53476012, "comment_id": 93833091, "body": "Please include all relevant error messages. If you don&#39;t receive an error, what output do you expect, and what do you see instead?"}], "answers": [{"comments": [{"owner": {"reputation": 1278, "user_id": 5269850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba47a45cb900337650d9adb725b3b14c?s=128&d=identicon&r=PG&f=1", "display_name": "EB2127", "link": "https://stackoverflow.com/users/5269850/eb2127"}, "edited": false, "score": 2, "creation_date": 1599243610, "post_id": 53476130, "comment_id": 112724928, "body": "I think there&#39;s an error in the function <code>IsValidXML()</code> above; it should be <code>==</code>"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1614660457, "post_id": 53476130, "comment_id": 117446060, "body": "Note that this is at most a check that the document is &quot;well formed&quot; XML.  Validation generally refers to the process of checking whether the document conforms to a schema."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "reply_to_user": {"reputation": 1278, "user_id": 5269850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba47a45cb900337650d9adb725b3b14c?s=128&d=identicon&r=PG&f=1", "display_name": "EB2127", "link": "https://stackoverflow.com/users/5269850/eb2127"}, "edited": false, "score": 0, "creation_date": 1614694047, "post_id": 53476130, "comment_id": 117458890, "body": "@EB2127 true, i have a problem with conditions ngl lol"}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": false, "score": 2, "last_activity_date": 1614694076, "last_edit_date": 1614694076, "creation_date": 1543215817, "answer_id": 53476130, "question_id": 53476012, "link": "https://stackoverflow.com/questions/53476012/how-to-validate-a-xml/53476130#53476130", "title": "How to validate a XML", "body": "<p>Your code doesn't validate XML syntax. Your code reads a file regardless of what it does. Easiest way to validate XML is with the <code>xml</code> package.</p>\n<pre><code>func IsValidXML(data []byte) bool {\n    return xml.Unmarshal(data, new(interface{})) == nil\n}\n</code></pre>\n<p>So regarding your code, it should become like so :</p>\n<pre><code>func ParseXml(xml_path string) {\n    xmlFile, err := os.Open(xml_path)\n    if err != nil {\n        panic(err)\n    } \n    // defer the closing of our xmlFile so that we can parse it later on\n    defer xmlFile.Close()\n    // read our opened xmlFile1 as a byte array. here I am checking if the file is valid or not\n    byteValue, err := ioutil.ReadAll(xmlFile)\n    if err != nil {\n        panic(fmt.Sprintf(&quot;%s file reading failed \\n&quot;,xml_path))\n    }\n\n    if !IsValidXML(byteValue) {\n        panic(&quot;Invalid XML has been input&quot;)\n    }\n}\n</code></pre>\n<p>For documentation of <code>xml.Unmarshal</code>, visit <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/xml/#Unmarshal</a></p>\n"}, {"tags": [], "owner": {"reputation": 903, "user_id": 228753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d05a76c3a395e4969e72236b7d1d929f?s=128&d=identicon&r=PG", "display_name": "GodsBoss", "link": "https://stackoverflow.com/users/228753/godsboss"}, "is_accepted": false, "score": 2, "last_activity_date": 1594619577, "creation_date": 1594619577, "answer_id": 62869933, "question_id": 53476012, "link": "https://stackoverflow.com/questions/53476012/how-to-validate-a-xml/62869933#62869933", "title": "How to validate a XML", "body": "<p>Sadly, you cannot just use <code>xml.Unmarshal</code>, because this stops parsing after the first element has been closed. Example:</p>\n<pre><code>func IsValid(s string) bool {\n    return xml.Unmarshal([]byte(s), new(interface{})) == nil\n}\n\nfunc main() {\n    // Prints &quot;true&quot;.\n    fmt.Println(IsValid(&quot;&lt;foo&gt;&lt;/foo&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;))\n}\n</code></pre>\n<p>You can, however, repeatedly decode elements until a non-io.EOF error occurs:</p>\n<pre><code>func IsValid(input string) bool {\n    decoder := xml.NewDecoder(strings.NewReader(input))\n    for {\n        err := decoder.Decode(new(interface{}))\n        if err != nil {\n            return err == io.EOF\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 7072729, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/9be68688b8d69616340b5958278fd359?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek", "link": "https://stackoverflow.com/users/7072729/vivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1523, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1614694076, "creation_date": 1543215190, "last_edit_date": 1543220237, "question_id": 53476012, "link": "https://stackoverflow.com/questions/53476012/how-to-validate-a-xml", "title": "How to validate a XML", "body": "<p>I am new to Go and I am trying to validate XML, but I am not able to do it. Below is what I have tried but it's not working. Is there any way to do it.</p>\n\n<pre><code>func ParseXml(xml_path string) {\n    xmlFile, err := os.Open(xml_path)\n    if err != nil {\n        panic(err)\n    } \n    // defer the closing of our xmlFile so that we can parse it later on\n    defer xmlFile.Close()\n    // read our opened xmlFile1 as a byte array. here I am checking if the file is valid or not\n    byteValue, err := ioutil.ReadAll(xmlFile)\n    if err != nil {\n        panic(fmt.Sprintf(\"%s file reading failed \\n\",xml_path))\n    } \n}\n</code></pre>\n\n<p>Although I am passing an invalid XML file, but I am not getting panic after </p>\n\n<pre><code>    byteValue, err := ioutil.ReadAll(xmlFile)\n</code></pre>\n"}, {"tags": ["debugging", "go", "memory-leaks", "server", "fasthttp"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543196237, "post_id": 53473638, "comment_id": 93817888, "body": "Describe the workload.  Are you using a testing tool, hitting from a web browser or something else?  To be clear, are you saying that running this program crashed Windows?"}, {"owner": {"reputation": 35, "user_id": 3690259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3CijC.jpg?s=128&g=1", "display_name": "abgr", "link": "https://stackoverflow.com/users/3690259/abgr"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543196538, "post_id": 53473638, "comment_id": 93817937, "body": "no i just use the insomnia for testing and opera browser but i request several times. and yes when i try to serve a big file for downloading my windows hangs cause of full memory"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543197771, "post_id": 53473638, "comment_id": 93818172, "body": "The code in the question does not serve big files.  Please post your actual code."}, {"owner": {"reputation": 35, "user_id": 3690259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3CijC.jpg?s=128&g=1", "display_name": "abgr", "link": "https://stackoverflow.com/users/3690259/abgr"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1543201746, "post_id": 53473638, "comment_id": 93818978, "body": "i can&#39;t put my code but the leaking reason of this code is the answer of why my code is leaking too and so my code is like the http serveContent"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1543211564, "post_id": 53473638, "comment_id": 93820959, "body": "The code in the question does not leak. Please update the question with <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1543214338, "post_id": 53473638, "comment_id": 93821798, "body": "You say that when using the Hello-world example &quot;Go does release it.&quot;  Do you mean &quot;Go does not release it&quot;?"}, {"owner": {"reputation": 35, "user_id": 3690259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3CijC.jpg?s=128&g=1", "display_name": "abgr", "link": "https://stackoverflow.com/users/3690259/abgr"}, "edited": false, "score": 0, "creation_date": 1543236449, "post_id": 53473638, "comment_id": 93832416, "body": "yes I edited that."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3690259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3CijC.jpg?s=128&g=1", "display_name": "abgr", "link": "https://stackoverflow.com/users/3690259/abgr"}, "edited": false, "score": 0, "creation_date": 1543630540, "post_id": 53542325, "comment_id": 94000049, "body": "so why its memory is growing up? can it be a bug in Go 1.11 ?"}], "tags": [], "owner": {"reputation": 1604, "user_id": 3351097, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yInN3.jpg?s=128&g=1", "display_name": "Maxian Nicu", "link": "https://stackoverflow.com/users/3351097/maxian-nicu"}, "is_accepted": false, "score": 0, "last_activity_date": 1543505168, "creation_date": 1543505168, "answer_id": 53542325, "question_id": 53473638, "link": "https://stackoverflow.com/questions/53473638/memory-leak-in-go-http-server-and-fasthttp/53542325#53542325", "title": "Memory leak in go http server and fasthttp", "body": "<p>According to <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">Go http.Request documentation</a></p>\n\n<pre><code>// The Server will close the request body. The ServeHTTP\n// Handler does not need to.\n</code></pre>\n\n<p>So you should remove the <code>r.Body.Close()</code> call, as it is not needed.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 3690259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3CijC.jpg?s=128&g=1", "display_name": "abgr", "link": "https://stackoverflow.com/users/3690259/abgr"}, "is_accepted": true, "score": 0, "last_activity_date": 1611755224, "creation_date": 1611755224, "answer_id": 65920475, "question_id": 53473638, "link": "https://stackoverflow.com/questions/53473638/memory-leak-in-go-http-server-and-fasthttp/65920475#65920475", "title": "Memory leak in go http server and fasthttp", "body": "<p>this was not cause of library and not a bug.\nit\u2019s cause of GC behavior. its not a memory leak.\nstudy more about how Go\u2019s GC works to understand and don\u2019t worry at all.</p>\n"}], "owner": {"reputation": 35, "user_id": 3690259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3CijC.jpg?s=128&g=1", "display_name": "abgr", "link": "https://stackoverflow.com/users/3690259/abgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 0, "accepted_answer_id": 65920475, "answer_count": 2, "score": -2, "last_activity_date": 1611755224, "creation_date": 1543194960, "last_edit_date": 1543236214, "question_id": 53473638, "link": "https://stackoverflow.com/questions/53473638/memory-leak-in-go-http-server-and-fasthttp", "title": "Memory leak in go http server and fasthttp", "body": "<p>My code was a simple fasthttp server like its github examples\nbut that had an unknown memory leak.\nThen I tried to find it and cleared my codes and it had that problem again.</p>\n\n<p>Then I ran just the official example and even that had memory leak (meaning that I watch the memory usage on windows process manager and its used memory grows up in loads and go does not release even after a while until my windows crashed).</p>\n\n<p>Then I used the std net/http by a very simple hello world server and I had that problem again. My memory usage grows by every request and Go does not release it.</p>\n\n<p>My version is  go 1.11.2 windows/amd64</p>\n\n<p>and this is my code that have this problem:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"strings\"\n)\n\nfunc sayHello(w http.ResponseWriter, r *http.Request) {\n    message := r.URL.Path\n    message = strings.TrimPrefix(message, \"/\")\n    message = \"Hello \" + message\n    w.Write([]byte(message))\n    r.Body.Close()\n}\nfunc main() {\n    http.HandleFunc(\"/\", sayHello)\n    if err := http.ListenAndServe(\":8080\", nil); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "import", "importerror"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1543213788, "last_edit_date": 1543213788, "creation_date": 1543193350, "answer_id": 53473499, "question_id": 53473392, "link": "https://stackoverflow.com/questions/53473392/unrecognized-import-path-syscall-js/53473499#53473499", "title": "unrecognized import path &quot;syscall/js&quot;", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/go1.11\" rel=\"nofollow noreferrer\">Go 1.11 Release Notes (August 2018)</a> </p>\n  \n  <p><a href=\"https://golang.org/doc/go1.11#wasm\" rel=\"nofollow noreferrer\">WebAssembly</a></p>\n  \n  <p>Go programs can call into JavaScript using the new experimental\n  <code>syscall/js</code> package.</p>\n</blockquote>\n\n<hr>\n\n<p><code>syscall/js</code> was first introduced in Go1.11 (August 2018). Your output from the command <code>go version</code> is <code>go1.6.2 l</code>, an ancient (February 2016) and obsolete version.</p>\n\n<hr>\n\n<p>After downloading a binary release of Go1.11 or later suitable for your system from <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">Go Downloads</a>, please follow the <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">installation instructions</a>, including the instructions for <a href=\"https://golang.org/doc/install#uninstall\" rel=\"nofollow noreferrer\">Uninstalling Go</a> for your current version of Go.</p>\n"}, {"tags": [], "owner": {"reputation": 1463, "user_id": 2409554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkOrY.jpg?s=128&g=1", "display_name": "Philippe Matray", "link": "https://stackoverflow.com/users/2409554/philippe-matray"}, "is_accepted": false, "score": 1, "last_activity_date": 1551741608, "last_edit_date": 1592644375, "creation_date": 1551741608, "answer_id": 54993107, "question_id": 53473392, "link": "https://stackoverflow.com/questions/53473392/unrecognized-import-path-syscall-js/54993107#54993107", "title": "unrecognized import path &quot;syscall/js&quot;", "body": "<p>There are some breaking changes in <strong>Go1.12</strong> in <strong>syscall/js</strong></p>\n<blockquote>\n<p>The <code>Callback</code> type and <code>NewCallback</code> function have been renamed; they are now called <code>Func</code> and <code>FuncOf</code>, respectively. This is a breaking change, but WebAssembly support is still experimental and not yet subject to the Go 1 compatibility promise. Any code using the old names will need to be updated.</p>\n<p>If a type implements the new Wrapper interface, <code>ValueOf</code> will use it to return the JavaScript value for that type.</p>\n<p>The meaning of the zero <code>Value</code> has changed. It now represents the JavaScript undefined value instead of the number zero. This is a breaking change, but WebAssembly support is still experimental and not yet subject to the Go 1 compatibility promise. Any code relying on the zero Value to mean the number zero will need to be updated.</p>\n<p>The new <code>Value.Truthy</code> method reports the JavaScript &quot;truthiness&quot; of a given value.</p>\n</blockquote>\n<hr />\n<p>Here is a link to an example that uses React, Node and Go to get a clearer understanding.</p>\n<p><a href=\"https://github.com/phmatray/webassembly-demo\" rel=\"nofollow noreferrer\">https://github.com/phmatray/webassembly-demo</a></p>\n"}], "owner": {"reputation": 21, "user_id": 10703893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7553ca50ea20fddd1b767c32a7a9610b?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/10703893/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1402, "favorite_count": 1, "accepted_answer_id": 53473499, "answer_count": 2, "score": 1, "last_activity_date": 1551741608, "creation_date": 1543192064, "last_edit_date": 1543214043, "question_id": 53473392, "link": "https://stackoverflow.com/questions/53473392/unrecognized-import-path-syscall-js", "title": "unrecognized import path &quot;syscall/js&quot;", "body": "<p>I am trying to use webassembly but I can't run this</p>\n\n<pre><code>import (\n    \"syscall/js\"\n)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>GOARCH=wasm GOOS=js go get -u github.com/siongui/godom/wasm\n</code></pre>\n\n<p>to install wasm</p>\n\n<p>It throws me an error</p>\n\n<pre><code>cannot find package \"syscall/js\" in any of:\n</code></pre>\n\n<p>I am using go version go1.6.2 linux</p>\n"}, {"tags": ["variables", "go"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "edited": false, "score": 0, "creation_date": 1543209021, "post_id": 53473646, "comment_id": 93820419, "body": "Thanks for the answer, I didn&#39;t realize that it is still possible to declare variable using var without using data type."}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 3, "last_activity_date": 1543195155, "creation_date": 1543195155, "answer_id": 53473646, "question_id": 53473350, "link": "https://stackoverflow.com/questions/53473350/how-to-declare-twp-variables-outside-of-a-function/53473646#53473646", "title": "How to declare twp variables outside of a function", "body": "<p>Try this way</p>\n\n<pre><code>var elastic, err  = elastic.NewClient(elastic.SetURL(\"http:145.00.000.01:9600\"))\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10661518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58583209fdfa41f3bb07909abbabe9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Honddoe ", "link": "https://stackoverflow.com/users/10661518/honddoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1543213997, "creation_date": 1543191608, "last_edit_date": 1543213997, "question_id": 53473350, "link": "https://stackoverflow.com/questions/53473350/how-to-declare-twp-variables-outside-of-a-function", "title": "How to declare twp variables outside of a function", "body": "<p>Suppose I want to declare two variables outside of a function in golang, I tried to use the following code </p>\n\n<pre><code>var (\n    elastic *Client, err error =                \n    elastic.NewClient(elastic.SetURL(\"http:145.00.000.01:9600\"))\n)\n</code></pre>\n\n<p>I got an error saying \"unexpected coma, expecting semicolon, new line or ) \"</p>\n\n<p>Does anyone know how to fix this?</p>\n"}, {"tags": ["go", "struct", "yaml"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1543196299, "post_id": 53473344, "comment_id": 93817900, "body": "See <a href=\"https://github.com/go-yaml/yaml\" rel=\"nofollow noreferrer\">example of nested yaml struct</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6775639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUK5OEDOQ4g/AAAAAAAAAAI/AAAAAAAAAOY/Tfxt2YIswpE/photo.jpg?sz=128", "display_name": "Tim Brammer", "link": "https://stackoverflow.com/users/6775639/tim-brammer"}, "edited": false, "score": 0, "creation_date": 1543267798, "post_id": 53473809, "comment_id": 93848615, "body": "KibGzr, thank you for the succinct answer. My issue now is: how to I include the application name. What I end up with this implemtation is a static &quot;appName&quot;(literal) with nested version and checksum values. My main experience with YAML comes from Ansible, and I&#39;m looking for something similar to the second code block shown here: <a href=\"https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html\" rel=\"nofollow noreferrer\">docs.ansible.com/ansible/latest/reference_appendices/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1543196931, "creation_date": 1543196931, "answer_id": 53473809, "question_id": 53473344, "link": "https://stackoverflow.com/questions/53473344/trouble-unmarshaling-yaml-structure/53473809#53473809", "title": "Trouble unmarshaling YAML structure", "body": "<p>You can define Application struct as</p>\n\n<pre><code>type AppVersion struct {\n    Version  string `yaml:\"version\"`\n    Checksum int    `yaml:\"md5_checksum\"`\n}\n\ntype Application struct {\n    Name AppVersion `yaml:\"appName\"`\n}\n</code></pre>\n\n<p>Then call <code>AppVersion</code> as</p>\n\n<pre><code>yamlData := Application{Name: AppVersion{Version: \"1.2.3.4\", Checksum: 34235234123}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6775639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUK5OEDOQ4g/AAAAAAAAAAI/AAAAAAAAAOY/Tfxt2YIswpE/photo.jpg?sz=128", "display_name": "Tim Brammer", "link": "https://stackoverflow.com/users/6775639/tim-brammer"}, "is_accepted": true, "score": 0, "last_activity_date": 1543271183, "creation_date": 1543271183, "answer_id": 53490053, "question_id": 53473344, "link": "https://stackoverflow.com/questions/53473344/trouble-unmarshaling-yaml-structure/53490053#53490053", "title": "Trouble unmarshaling YAML structure", "body": "<p>I've solved my own problem with help from KibGzr.</p>\n\n<p>No structs necessary just for the marshaling steps.</p>\n\n<pre><code>yamlData := map[string]map[string]string{\n    appName: map[string]string{\"version\": appVersion, \"md5_checksum\": checksumString},\n}\n</code></pre>\n\n<p>I've created a nested map rather than a struct. This allows me just initialize the map when I've collected all my values rather than trying to work around struct field names. My output is now:</p>\n\n<pre><code>appName:\n  md5_checksum: checksumString\n  version: appVersion\n</code></pre>\n\n<p>Thanks for all the help!</p>\n"}], "owner": {"reputation": 11, "user_id": 6775639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUK5OEDOQ4g/AAAAAAAAAAI/AAAAAAAAAOY/Tfxt2YIswpE/photo.jpg?sz=128", "display_name": "Tim Brammer", "link": "https://stackoverflow.com/users/6775639/tim-brammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 53490053, "answer_count": 2, "score": 0, "last_activity_date": 1543271183, "creation_date": 1543191560, "last_edit_date": 1543213946, "question_id": 53473344, "link": "https://stackoverflow.com/questions/53473344/trouble-unmarshaling-yaml-structure", "title": "Trouble unmarshaling YAML structure", "body": "<p>I have what I think is a very straightforward YAML structure I'm attempting to write to and read from a file. </p>\n\n<pre><code>appName:\n   version: 1.2.3.4\n   md5_checksum: 987654321\n</code></pre>\n\n<p>And I'm really struggling to understand nested structs and how they relate to yaml marshaling. </p>\n\n<p>At this point I have the following:</p>\n\n<pre><code>type Application struct {\n    Name     string `yaml:\"application\"`\n    Version  string `yaml:\"version\"`\n    Checksum int    `yaml:\"md5_checksum\"`\n}\n\nyamlData := Application{\"MyProgram\", \"1.2.3.4\", 34235234123}\ny, err := yaml.Marshal(yamlData)\nif err != nil {\n    log.Fatal(\"Yaml marshal failed\")\n}\n\nerr = ioutil.WriteFile(\"applications.yaml\", y, 0644)\nif err != nil {\n    log.Fatal(\"File write failed\")\n}\n</code></pre>\n\n<p>This gets me close, but the file reads as follows:</p>\n\n<pre><code>application: MyProgram\nversion: 1.2.3.4\nmd5_checksum: 34235234123\n</code></pre>\n\n<p>That looks nice, but this file will be populated by many applications. I've tried a few types of nested structs, but I get hung up on how to supply values to them when finally building them.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "edited": false, "score": 1, "creation_date": 1543226480, "post_id": 53473910, "comment_id": 93827154, "body": "Yes, I saw that, but why should I exclude a dependency? In which circumstances?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": -1, "last_activity_date": 1543197919, "creation_date": 1543197919, "answer_id": 53473910, "question_id": 53473290, "link": "https://stackoverflow.com/questions/53473290/how-the-exclude-directive-works-in-the-go-mod-file/53473910#53473910", "title": "How the exclude directive works in the go.mod file?", "body": "<p>Read the whole <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">Modules</a> document. Further down in the document from your quote,</p>\n\n<blockquote>\n  <p>... the top-level module in the build can exclude specific versions of\n  dependencies or replace other modules with different code. See the\n  full proposal for <a href=\"https://github.com/golang/proposal/blob/master/design/24301-versioned-go.md\" rel=\"nofollow noreferrer\">more details and rationale</a>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "edited": false, "score": 0, "creation_date": 1557247580, "post_id": 53824026, "comment_id": 98697894, "body": "&quot;By excluding the broken version&quot;. In the example <code>go.mod</code> file, you exclude <code>v0.9.1</code>. Per this statement, did you mean to exclude <code>v1.1</code>, or am I still misunderstanding the purpose of the <code>exclude</code> directive?"}, {"owner": {"reputation": 63890, "user_id": 151312, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a8b345ddcfc5401f578c850442f1e1b?s=128&d=identicon&r=PG", "display_name": "coolaj86", "link": "https://stackoverflow.com/users/151312/coolaj86"}, "reply_to_user": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "edited": false, "score": 0, "creation_date": 1574204824, "post_id": 53824026, "comment_id": 104146868, "body": "@CosmicOssifrage v0.9.1 is a PROPER semver git tag, but the code is broken. v1.1 has the WORKING code, but the git tag is not parsable as semver."}], "tags": [], "owner": {"reputation": 63890, "user_id": 151312, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a8b345ddcfc5401f578c850442f1e1b?s=128&d=identicon&r=PG", "display_name": "coolaj86", "link": "https://stackoverflow.com/users/151312/coolaj86"}, "is_accepted": true, "score": 10, "last_activity_date": 1574204895, "last_edit_date": 1574204895, "creation_date": 1545086444, "answer_id": 53824026, "question_id": 53473290, "link": "https://stackoverflow.com/questions/53473290/how-the-exclude-directive-works-in-the-go-mod-file/53824026#53824026", "title": "How the exclude directive works in the go.mod file?", "body": "<p>Here's a semi-hypothetical hypothetical example:</p>\n\n<h1>go.mod</h1>\n\n<pre><code>module github.com/example/project\n\nrequire (\n    github.com/SermoDigital/jose v0.0.0-20180104203859-803625baeddc\n    github.com/google/uuid v1.1.0\n)\n\nexclude github.com/SermoDigital/jose v0.9.1\n\nreplace github.com/google/uuid v1.1.0 =&gt; git.coolaj86.com/coolaj86/uuid.go v1.1.1\n</code></pre>\n\n<h1>exclude</h1>\n\n<p>In the case of the <code>github.com/SermoDigital/jose</code> package, it has a proper git tag for <code>v0.9.1</code>, but the current version is <code>v1.1</code>, which is <strong>NOT</strong> a proper git tag (missing the \"patch\" version).</p>\n\n<p>By excluding the properly-versioned (but not working) code it causes go mod to fetch from <code>master</code> instead (which is not properly versioned, but has the working code).</p>\n\n<h1>replace</h1>\n\n<p>Likewise (and truly hypothetical), if I have a patch to <code>github.com/google/uuid</code>, I can create a fork and use <code>replace</code> to get my own version while I wait for the upstream version to accept my patch (or not).</p>\n"}], "owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7784, "favorite_count": 6, "accepted_answer_id": 53824026, "answer_count": 2, "score": 9, "last_activity_date": 1574204895, "creation_date": 1543191046, "question_id": 53473290, "link": "https://stackoverflow.com/questions/53473290/how-the-exclude-directive-works-in-the-go-mod-file", "title": "How the exclude directive works in the go.mod file?", "body": "<p>The new Go version 1.11 introduced the modules concept which is awesome.</p>\n\n<p>In the <a href=\"https://github.com/golang/go/wiki/Modules#gomod\" rel=\"noreferrer\">documentation</a> it says there are four directives that can be used in a <code>go.mod</code> file: <code>module</code>, <code>require</code>, <code>exclude</code>, <code>replace</code>.</p>\n\n<p>It also explains that:</p>\n\n<blockquote>\n  <p>exclude and replace directives only operate on the current (\u201cmain\u201d)\n  module. exclude and replace directives in modules other than the main\n  module are ignored when building the main module. The replace and\n  exclude statements therefore allow the main module complete control\n  over its own build, without also being subject to complete control by\n  dependencies.</p>\n</blockquote>\n\n<p>But I still don't understand how the <code>exclude</code> directive works.</p>\n\n<p>Can someone explain to me how the <code>exclude</code> directive works and if possible give an example of when to use it?</p>\n"}, {"tags": ["linux", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1543186071, "creation_date": 1543186071, "answer_id": 53472774, "question_id": 53472725, "link": "https://stackoverflow.com/questions/53472725/cant-go-get-offline-tutorial/53472774#53472774", "title": "Can&#39;t `go get` offline tutorial", "body": "<p>Syntax of <code>go get</code> is (run <code>go help get</code> to see):</p>\n\n<pre><code>usage: go get [-d] [-f] [-t] [-u] [-v] [-fix] [-insecure] [build flags] [packages]\n</code></pre>\n\n<p>Everything you list at the end are all packages to get. So you should simply run:</p>\n\n<pre><code>go get golang.org/x/tour\n</code></pre>\n\n<p>Note: there is no need to pass an additional <code>tour</code> parameter. This is what the error message tells you: the <code>tour</code> package is not recognized.</p>\n\n<p>The above command will get the <code>golang.org/x/tour</code> and install it into your <code>$GOPATH/bin</code>, so you can simply run it after the above command like:</p>\n\n<pre><code>$GOPATH/bin/tour\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1455950, "user_type": "registered", "profile_image": "https://graph.facebook.com/1281446992/picture?type=large", "display_name": "sonu80z", "link": "https://stackoverflow.com/users/1455950/sonu80z"}, "is_accepted": false, "score": 0, "last_activity_date": 1549702909, "creation_date": 1549702909, "answer_id": 54604772, "question_id": 53472725, "link": "https://stackoverflow.com/questions/53472725/cant-go-get-offline-tutorial/54604772#54604772", "title": "Can&#39;t `go get` offline tutorial", "body": "<p>After \ngo get golang.org/x/tour</p>\n\n<p>Run go build</p>\n\n<p>This will generate executable which on run start local tour at <a href=\"http://127.0.0.1:3999/\" rel=\"nofollow noreferrer\">http://127.0.0.1:3999/</a></p>\n"}, {"tags": [], "owner": {"reputation": 1111, "user_id": 1131607, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xLKUc.jpg?s=128&g=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/1131607/arun"}, "is_accepted": false, "score": 0, "last_activity_date": 1590244607, "creation_date": 1590244607, "answer_id": 61973658, "question_id": 53472725, "link": "https://stackoverflow.com/questions/53472725/cant-go-get-offline-tutorial/61973658#61973658", "title": "Can&#39;t `go get` offline tutorial", "body": "<p>For me simply running the <code>tour</code>command worked fine , command-line output as follows !</p>\n\n<pre><code>C:\\Users\\ilife\\go\\src\\golang.org\\x\\tour&gt;tour\n2020/05/23 20:04:39 Serving content from C:\\Users\\ilife\\go\\src\\golang.org\\x\\tour\n2020/05/23 20:04:39 A browser window should open. If not, please visit http://127.0.0.1:3999\n2020/05/23 20:04:46 accepting connection from: 127.0.0.1:52660 \n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 4900948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1808668cadbdce89e392b100ce5338?s=128&d=identicon&r=PG&f=1", "display_name": "Fingers", "link": "https://stackoverflow.com/users/4900948/fingers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1582, "favorite_count": 0, "accepted_answer_id": 53472774, "answer_count": 3, "score": 2, "last_activity_date": 1590244607, "creation_date": 1543185544, "last_edit_date": 1543213847, "question_id": 53472725, "link": "https://stackoverflow.com/questions/53472725/cant-go-get-offline-tutorial", "title": "Can&#39;t `go get` offline tutorial", "body": "<p>I am trying to run the command <code>go get golang.org/x/tour tour</code> but I am getting the error message <code>\"package tour: unrecognized import path \"tour\" (import path does not begin with hostname)\"</code>.  I also do not get the binary in my bin folder that is mentioned.</p>\n\n<p>Things I have attempted to resolve the issue:</p>\n\n<ul>\n<li>Read the documentation at <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html</a> and\n<a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">https://golang.org/doc/install</a>.</li>\n<li>Verify workspace folders exist as specified in documentation (my\nworkspace is <code>/home/USERNAME/go</code>, and inside that I have created 2\nfolders <code>src</code> and <code>bin</code>).</li>\n<li>changed command from <code>go get golang.org/x/tour tour</code> to <code>go get\ngolang.org/x/tour /home/USERNAME/go</code> (still get a simillar import path error message)</li>\n<li>verified that my go path is set correctly and go is installed using\ndefaults, my go path in <code>/etc/profile</code> is <code>/usr/local/go/bin</code></li>\n<li><p>since the command did create a directory called <code>golang.org</code>, I navigated to <code>/home/USERNAME/go/src/golang.org/x/tour</code> and ran <code>go build tour.go</code>.  I got the errors:</p>\n\n<pre><code># command-line-arguments\n./tour.go:62:4: undefined: socketAddr\n./tour.go:126:28: undefined: prepContent\n</code></pre></li>\n<li><p>read the README.md in the golang.org/x/tour folder</p></li>\n<li><p>change bin permissions to 755</p></li>\n</ul>\n"}, {"tags": ["go", "gomega"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543178901, "post_id": 53471750, "comment_id": 93814218, "body": "A typical path would be to write a function that took a <code>*mega.Node</code> and returned a list of path names in and underneath that directory.  When it saw an item where <code>i.GetType() == mega.FOLDER</code>, it would call itself."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1543185397, "post_id": 53471750, "comment_id": 93815871, "body": "For ideas, see <code>filepath.Walk</code>: <a href=\"https://golang.org/pkg/path/filepath/#Walk\" rel=\"nofollow noreferrer\">golang.org/pkg/path/filepath/#Walk</a>"}], "owner": {"reputation": 61, "user_id": 9158679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbbe78bae5ef2ba65b8f7dd4672204e1?s=128&d=identicon&r=PG&f=1", "display_name": "Sansch", "link": "https://stackoverflow.com/users/9158679/sansch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543213813, "creation_date": 1543178550, "last_edit_date": 1543213813, "question_id": 53471750, "link": "https://stackoverflow.com/questions/53471750/how-to-list-files-recursively-with-go-mega", "title": "How to list files recursively with go-mega", "body": "<p>I'm using a third party library to connect to the mega.nz api and can't figure out a good algorithm to list all files in every directory.</p>\n\n<p>GetChildren could be called on \"i\" again. But if I do it this way i would just get the files which are on the root directory.</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"github.com/t3rm1n4l/go-mega\"\n    \"path\"\n)\n\nfunc returnFileNames (mc *mega.Mega) []string {\n    var files []string\n\n    // Get children of\n    a, _ := mc.FS.GetChildren(mc.FS.GetRoot())\n\n    for _, i := range a {\n        if i.GetType() != 1 { // NodeType is not a Directory\n            files = append(files, path.Join(\"root\", i.GetName()))\n        } else {\n            // ???\n        }\n    }\n\n    return files\n}\n</code></pre>\n"}, {"tags": ["docker", "go", "docker-compose", "docker-swarm", "docker-api"], "answers": [{"tags": [], "owner": {"reputation": 37029, "user_id": 358328, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d56c3972b607b39dc840acef5fca07d0?s=128&d=identicon&r=PG", "display_name": "Uku Loskit", "link": "https://stackoverflow.com/users/358328/uku-loskit"}, "is_accepted": true, "score": 2, "last_activity_date": 1543173050, "creation_date": 1543173050, "answer_id": 53470951, "question_id": 53470871, "link": "https://stackoverflow.com/questions/53470871/docker-sdk-for-golang-cant-connect-to-daemon-inside-overlay-network/53470951#53470951", "title": "Docker SDK for Golang can&#39;t connect to daemon inside overlay network", "body": "<p>Your app is trying to access the Docker socket, but this is not accessible by default in the container. </p>\n\n<p>You can mount it as a volume from the host:\n<code>-v /var/run/docker.sock:/var/run/docker.sock</code></p>\n"}], "owner": {"reputation": 65, "user_id": 2530449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c464ea1515f2891d72a96910902ac28?s=128&d=identicon&r=PG", "display_name": "JamesIsSoPro", "link": "https://stackoverflow.com/users/2530449/jamesissopro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 53470951, "answer_count": 1, "score": 2, "last_activity_date": 1543173050, "creation_date": 1543172503, "question_id": 53470871, "link": "https://stackoverflow.com/questions/53470871/docker-sdk-for-golang-cant-connect-to-daemon-inside-overlay-network", "title": "Docker SDK for Golang can&#39;t connect to daemon inside overlay network", "body": "<p>I have a docker swarm, and a container inside of an overlay network on that swarm. The container has an app written in golang that interacts with the Docker API by creating a container and starting it. When I run my golang app on the host machine, everything runs perfect and it creates and runs the container without issue. However when I put the app into the container and run it in my overlay network, it no longer can reach the API. </p>\n\n<p>I'm assuming this has something to do with networking, but the idea of my project is that there are multiple services, each with their own networks, that can create, launch, and remove containers they see fit. NOT running the SDK in an app outside of the overlay networks unfortunately is not an option at this time.</p>\n\n<p>Error: <code>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</code></p>\n"}, {"tags": ["go", "enums"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543173562, "post_id": 53470766, "comment_id": 93812594, "body": "You cannot. Go has no const non-consts. You must either use variables or redesign."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1543175935, "post_id": 53470766, "comment_id": 93813344, "body": "You might like this pattern: <a href=\"https://blog.learngoprogramming.com/golang-const-type-enums-iota-bc4befd096d3\" rel=\"nofollow noreferrer\">blog.learngoprogramming.com/&hellip;</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1543178497, "post_id": 53470766, "comment_id": 93814105, "body": "See <a href=\"https://stackoverflow.com/questions/37385007/golang-creating-a-constant-type-and-restricting-the-types-values/37386119#37386119\">Golang: Creating a Constant Type and Restricting the Type&#39;s Values</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 3, "last_activity_date": 1543175000, "creation_date": 1543175000, "answer_id": 53471203, "question_id": 53470766, "link": "https://stackoverflow.com/questions/53470766/enums-of-structs-in-go/53471203#53471203", "title": "Enums of structs in GO", "body": "<p>Go does not support enums. You should either define your enumerated fields as <code>var</code>s or to ensure immutability, maybe use functions that return a constant result.<br>\nFor example:</p>\n\n<pre><code>type myStruct { ID int }\n\nfunc EnumValue1() myStruct { \n    return myStruct { 1 } \n}\n\nfunc EnumValue2() myStruct { \n    return myStruct { 2 } \n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10250973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1daba713951b297320699a8f45c851c?s=128&d=identicon&r=PG", "display_name": "Liftu", "link": "https://stackoverflow.com/users/10250973/liftu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4398, "favorite_count": 0, "accepted_answer_id": 53471203, "answer_count": 1, "score": 1, "last_activity_date": 1543181348, "creation_date": 1543171888, "last_edit_date": 1543181348, "question_id": 53470766, "link": "https://stackoverflow.com/questions/53470766/enums-of-structs-in-go", "title": "Enums of structs in GO", "body": "<p>I would like to enumerate the planets in my Go program.\nEach planet includes a common name (ex: \"Venus\") and a distance from the sun in Astronomical Unit (ex: 0.722)</p>\n\n<p>So I wrote this code :</p>\n\n<pre><code>type planet struct {\n    commonName string\n    distanceFromTheSunInAU float64\n}\n\nconst(\n    venus planet = planet{\"Venus\", 0.387}      // This is line 11\n    mercury planet = planet{\"Mercury\", 0.722}\n    earth planet = planet{\"Eath\", 1.0}\n    mars planet = planet{\"Mars\", 1.52}\n    ...\n)\n</code></pre>\n\n<p>But Go didn't let me compile this, and gave me this error :</p>\n\n<pre><code># command-line-arguments\n./Planets.go:11: const initializer planet literal is not a constant\n./Planets.go:12: const initializer planet literal is not a constant\n./Planets.go:13: const initializer planet literal is not a constant\n./Planets.go:14: const initializer planet literal is not a constant\n</code></pre>\n\n<p>Do you have any idea of how I could do?\nThanks</p>\n"}, {"tags": ["php", "go", "encryption", "aes"], "comments": [{"owner": {"reputation": 6510, "user_id": 2196561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac22ef3edb7836c3af11f5511f7942f8?s=128&d=identicon&r=PG", "display_name": "Ebbe M. Pedersen", "link": "https://stackoverflow.com/users/2196561/ebbe-m-pedersen"}, "edited": false, "score": 2, "creation_date": 1543170306, "post_id": 53469884, "comment_id": 93811651, "body": "The output of openssl_encrypt(..) in your php is already in base64 .. you don&#39;t need to base64 encode it again .."}], "answers": [{"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 0, "last_activity_date": 1543228523, "creation_date": 1543228523, "answer_id": 53479251, "question_id": 53469884, "link": "https://stackoverflow.com/questions/53469884/bad-blocksize-error-in-decrypting-aes-256-cbc-ciphertext-encrypted-by-openssl-en/53479251#53479251", "title": "bad blocksize error in decrypting AES-256-CBC ciphertext encrypted by openssl_encrypt in PHP", "body": "<p>I see a few issues with your code:</p>\n\n<ul>\n<li><p>The PHP <a href=\"http://php.net/manual/en/function.hash.php\" rel=\"nofollow noreferrer\"><code>hash()</code></a> function returns hex-encoded strings by default. You need to pass <code>TRUE</code> as the third argument to enable \"raw\" mode.</p></li>\n<li><p>Similarly no need to <code>hex.EncodeToString</code> in the Go version.</p></li>\n<li><p>The PHP <a href=\"http://php.net/manual/en/function.openssl-encrypt.php\" rel=\"nofollow noreferrer\"><code>openssl_encrypt()</code></a> and <a href=\"http://php.net/manual/en/function.openssl-decrypt.php\" rel=\"nofollow noreferrer\"><code>openssl_decrypt()</code></a> functions work with Base64-encoded strings by default. So no need to <code>base64_decode</code>.</p></li>\n</ul>\n\n<p>Here are the fixed versions:</p>\n\n<p>PHP:</p>\n\n<pre><code>&lt;?php\nclass MBM_Encrypt_Decrypt {\n    const ENCRYPT_METHOD = 'AES-256-CBC'; // type of encryption\n    const SECRET_KEY = '13GsJd6076v69^f4(fdB'; // secret key\n    const SECRET_IV = 'fg3Dk54f4340fKF2JTC9'; // secret iv\n\n    public function encrypt($string) {\n        return $this-&gt;encrypt_decrypt('encrypt', $string);\n    }\n\n    public function decrypt($string) {\n        return $this-&gt;encrypt_decrypt('decrypt', $string);\n    }\n    private function encrypt_decrypt($action, $string)\n    {\n        $key = hash('sha256', self::SECRET_KEY, true);\n        $iv = substr(hash('sha256', self::SECRET_IV, true), 0, 16);\n        if ($action == 'encrypt') {\n            $output = openssl_encrypt($string, self::ENCRYPT_METHOD, $key, 0, $iv);\n        } else if ($action == 'decrypt') {\n            $output = openssl_decrypt($string, self::ENCRYPT_METHOD, $key, 0, $iv);\n        }\n        $output = (!empty($output)) ? $output : false;\n        return $output;\n    }\n}\n\n\n$class_encrypt = new MBM_Encrypt_Decrypt();\n\n$plain_txt = \"xyz@abc.com\";\necho 'Plain Text: ' . $plain_txt . PHP_EOL;\n\n$encrypted_txt = $class_encrypt-&gt;encrypt($plain_txt);\necho 'Ciphertext: ' . $encrypted_txt . PHP_EOL;\n\n$decrypted_txt = $class_encrypt-&gt;decrypt($encrypted_txt);\necho 'Decrypted Text: ' . $decrypted_txt . PHP_EOL;\n\nif ($plain_txt === $decrypted_txt) echo 'SUCCESS' . PHP_EOL;\nelse echo 'FAILED' . PHP_EOL;\n\necho PHP_EOL . 'Length of Plain Text: ' . strlen($plain_txt);\necho PHP_EOL . 'Length of Encrypted Text: ' . strlen($encrypted_txt). PHP_EOL;\n</code></pre>\n\n<p>Go:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"crypto/sha256\"\n    \"encoding/base64\"\n    \"encoding/hex\"\n    \"fmt\"\n)\n\nvar (\n    IV  = []byte(\"fg3Dk54f4340fKF2JTC9\")\n    KEY = []byte(\"13GsJd6076v69^f4(fdB\")\n)\n\nfunc main() {\n\n    h := sha256.New()\n    h.Write(KEY)\n    KEY = h.Sum(nil)\n\n    h.Reset()\n    h.Write(IV)\n    IV = h.Sum(nil)[:16]\n\n   fmt.Println(\"Key\", hex.EncodeToString(KEY))\n   fmt.Println(\"IV\", hex.EncodeToString(IV))\n\n   // This ciphertext was generated by the PHP module\n   de := \"rDAnykzTorR5/SgpdD7slA==\"\n   q, err := decrypt(KEY, IV, de)\n\n   fmt.Println(string(q), err)\n}\n\n// Returns slice of the original data without padding.\nfunc pkcs7Unpad(data []byte, blocklen int) ([]byte, error) {\n    if blocklen &lt;= 0 {\n        return nil, fmt.Errorf(\"invalid blocklen %d\", blocklen)\n    }\n    if len(data)%blocklen != 0 || len(data) == 0 {\n        return nil, fmt.Errorf(\"invalid data len %d\", len(data))\n    }\n    padlen := int(data[len(data)-1])\n    if padlen &gt; blocklen || padlen == 0 {\n        return nil, fmt.Errorf(\"invalid padding\")\n    }\n   // check padding\n   pad := data[len(data)-padlen:]\n   for i := 0; i &lt; padlen; i++ {\n        if pad[i] != byte(padlen) {\n            return nil, fmt.Errorf(\"invalid padding\")\n        }\n   }\n\n   return data[:len(data)-padlen], nil\n}\n\nfunc decrypt(key []byte, iv []byte, encrypted string) ([]byte, error) {\n    data, err := base64.StdEncoding.DecodeString(encrypted)\n    if err != nil {\n        return nil, err\n    }\n\n    if len(data) == 0 || len(data)%aes.BlockSize != 0 {\n        return nil, fmt.Errorf(\"bad blocksize(%v), aes.BlockSize = %v\\n\", len(data), aes.BlockSize)\n    }\n    c, err := aes.NewCipher(key)\n    if err != nil {\n        return nil, err\n    }\n    cbc := cipher.NewCBCDecrypter(c, iv)\n    cbc.CryptBlocks(data, data)\n    out, err := pkcs7Unpad(data, aes.BlockSize)\n    if err != nil {\n        return out, err\n    }\n    return out, nil\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ php test.php\nPlain Text: xyz@abc.com\nCiphertext: rDAnykzTorR5/SgpdD7slA==\nDecrypted Text: xyz@abc.com\nSUCCESS\n\nLength of Plain Text: 11\nLength of Encrypted Text: 24\n\n$ go test\nKey 45ede7f4300fcc407d734020f12c8176463e7d493aa0395cdfa32e31ff914b0a\nIV 9f79430dfdd761b3ed128bc38bfeadc5\nxyz@abc.com &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543228523, "creation_date": 1543165967, "last_edit_date": 1543170714, "question_id": 53469884, "link": "https://stackoverflow.com/questions/53469884/bad-blocksize-error-in-decrypting-aes-256-cbc-ciphertext-encrypted-by-openssl-en", "title": "bad blocksize error in decrypting AES-256-CBC ciphertext encrypted by openssl_encrypt in PHP", "body": "<p>I have a PHP module that encrypts emails with <code>aes-256-cbc</code> using <code>openssl_encrypt</code>. </p>\n\n<p>The ciphertexts generated by this module can be decrypted by this module as well.</p>\n\n<p>But if I try to decrypt them with an implementation of aes-256-cbc in Go with the same IV and Key, I get a bad blocksize error. The block size is supposed to be in multiples of 16 but the ciphertext generated by PHP is not in multiples of 16.</p>\n\n<p>Here is the code</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"crypto/sha256\"\n    \"encoding/base64\"\n    \"encoding/hex\"\n    \"fmt\"\n)\n\nvar (\n    IV  = []byte(\"fg3Dk54f4340fKF2JTC9\")\n    KEY = []byte(\"13GsJd6076v69^f4(fdB\")\n)\n\nfunc main() {\n\n    h := sha256.New()\n    h.Write(KEY)\n    KEY = []byte(hex.EncodeToString(h.Sum(nil))[:32])\n\n    h.Reset()\n    h.Write(IV)\n    IV = []byte(hex.EncodeToString(h.Sum(nil))[:16])\n\n   fmt.Println(\"Key\", string(KEY))\n   fmt.Println(\"IV\", string(IV))\n\n   // This ciphertext was generated by the PHP module\n   de := \"ZHRodkpCK3R5QXlCMnh3MFdudDh3Zz09\"\n\n   q, err := decrypt(KEY, IV, []byte(de))\n\n   fmt.Println(string(q), err)\n}\n\n// Returns slice of the original data without padding.\nfunc pkcs7Unpad(data []byte, blocklen int) ([]byte, error) {\n    if blocklen &lt;= 0 {\n        return nil, fmt.Errorf(\"invalid blocklen %d\", blocklen)\n    }\n    if len(data)%blocklen != 0 || len(data) == 0 {\n        return nil, fmt.Errorf(\"invalid data len %d\", len(data))\n    }\n    padlen := int(data[len(data)-1])\n    if padlen &gt; blocklen || padlen == 0 {\n        return nil, fmt.Errorf(\"invalid padding\")\n    }\n   // check padding\n   pad := data[len(data)-padlen:]\n   for i := 0; i &lt; padlen; i++ {\n        if pad[i] != byte(padlen) {\n            return nil, fmt.Errorf(\"invalid padding\")\n        }\n   }\n\n   return data[:len(data)-padlen], nil\n}\n\nfunc decrypt(key, iv, data []byte) ([]byte, error) {\n    var err error\n    data, err = base64.StdEncoding.DecodeString(string(data))\n    if err != nil {\n        return nil, err\n    }\n\n    if len(data) == 0 || len(data)%aes.BlockSize != 0 {\n        return nil, fmt.Errorf(\"bad blocksize(%v), aes.BlockSize = %v\\n\", len(data), aes.BlockSize)\n    }\n    c, err := aes.NewCipher(key)\n    if err != nil {\n        return nil, err\n    }\n    cbc := cipher.NewCBCDecrypter(c, iv)\n    cbc.CryptBlocks(data[aes.BlockSize:], data[aes.BlockSize:])\n    out, err := pkcs7Unpad(data[aes.BlockSize:], aes.BlockSize)\n    if err != nil {\n        return out, err\n    }\n    return out, nil\n}\n</code></pre>\n\n<p>I have tried different things like using <code>OPENSSL_RAW_DATA</code> and <code>OPENSSL_ZERO_PADDING</code> in PHP module but absolutely nothing has worked. </p>\n\n<p>The ciphertext used in above program was generated with <code>options</code> field in <code>openssl_encrypt</code> set to 0. </p>\n\n<p>My speculation is, PHP doesn't pads input before encrypting them which generates ciphertexts that are not multiples of 16.</p>\n\n<p>PHP implementation</p>\n\n<pre><code>&lt;?php\nclass MBM_Encrypt_Decrypt {\n    const ENCRYPT_METHOD = 'AES-256-CBC'; // type of encryption\n    const SECRET_KEY = '13GsJd6076v69^f4(fdB'; // secret key\n    const SECRET_IV = 'fg3Dk54f4340fKF2JTC9'; // secret iv\n\n    public function encrypt($string) {\n        return $this-&gt;encrypt_decrypt('encrypt', $string);\n    }\n\n    public function decrypt($string) {\n        return $this-&gt;encrypt_decrypt('decrypt', $string);\n    }\n    private function encrypt_decrypt($action, $string)\n    {\n        $key = hash('sha256', self::SECRET_KEY);\n        $iv = substr(hash('sha256', self::SECRET_IV), 0, 16);\n        if ($action == 'encrypt') {\n            $output = openssl_encrypt($string, self::ENCRYPT_METHOD, $key, 0, $iv);\n        } else if ($action == 'decrypt') {\n            $output = openssl_decrypt(base64_decode($string), self::ENCRYPT_METHOD, $key, 0, $iv);\n        }\n        $output = (!empty($output)) ? $output : false;\n        return $output;\n    }\n}\n\n\n\n$class_encrypt = new MBM_Encrypt_Decrypt();\n\n$plain_txt = \"xyz@abc.com\";\necho 'Plain Text: ' . $plain_txt . PHP_EOL;\n\n$decrypted_txt = $class_encrypt-&gt;decrypt(\"ZHRodkpCK3R5QXlCMnh3MFdudDh3Zz09\");\necho 'Decrypted Text: ' . $decrypted_txt . PHP_EOL;\n\nif ($plain_txt === $decrypted_txt) echo 'SUCCESS' . PHP_EOL;\nelse echo 'FAILED' . PHP_EOL;\n\necho PHP_EOL . 'Length of Plain Text: ' . strlen($plain_txt);\necho PHP_EOL . 'Length of Encrypted Text: ' . strlen($encrypted_txt). PHP_EOL;\n</code></pre>\n"}, {"tags": ["algorithm", "go", "refactoring", "structure"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1543165437, "post_id": 53469493, "comment_id": 93810177, "body": "I have to admit I do not understand what you are trying to do and where the problem is."}, {"owner": {"reputation": 11, "user_id": 7618197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb46d181740ca44e0074f37b54b4e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michel", "link": "https://stackoverflow.com/users/7618197/michel"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1543166209, "post_id": 53469493, "comment_id": 93810388, "body": "I&#39;m refactoring a project and in a much practical way, I am trying to find out the best solution to handle this pattern of a general handler creating child structures, their data being shared in some ways that make it complicated to have a clear schema. But I realized the problem is much broader than juste my tiny project and it can be generalized to what I wrote here. What are the unclear points for you?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543170772, "post_id": 53469493, "comment_id": 93811774, "body": "What kind of app is this? Is this a web app? I&#39;ve never seen this &quot;pattern&quot; before, so I can&#39;t really provide suggestions without more context."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1543177608, "post_id": 53469493, "comment_id": 93813824, "body": "would making all the Handler/Sender/Receiver complying with a common interface definition let them share &quot;common data&quot; in the way you want?"}], "owner": {"reputation": 11, "user_id": 7618197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb46d181740ca44e0074f37b54b4e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michel", "link": "https://stackoverflow.com/users/7618197/michel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543166296, "creation_date": 1543163124, "last_edit_date": 1543166296, "question_id": 53469493, "link": "https://stackoverflow.com/questions/53469493/sharing-info-between-structures-in-golang", "title": "Sharing info between structures in golang", "body": "<p>I have a general handler that contains the data it needs to do all it has to do.</p>\n\n<pre><code>type Handler struct {\n    info HandlerInfo\n}\n</code></pre>\n\n<p>Then the sender struct, which equally has its own information.</p>\n\n<pre><code>type Sender struct {\n    info SenderInfo\n}\n</code></pre>\n\n<p>Finally, there's a receiver, that also has its own information.</p>\n\n<pre><code>type Receiver struct {\n    info ReceiverInfo\n}\n</code></pre>\n\n<p>The handler generates communicating pairs along the execution of the program. I don't wanna give examples of the type of communication that occurs between the different structures I have defined since I want my example to be the broadest possible.</p>\n\n<pre><code>func (h Handler) Do() {\n    for /* something happens */ {\n        sender := Sender{}\n        receiver := Receiver{}\n    }\n    sender.DoSomething()\n    if sender.ShouldSend() {\n        receiver.Receive()\n    }\n}\n</code></pre>\n\n<p>Everything looks quite simple up to here but I'm facing two issues :</p>\n\n<p><b>\n1) How to handle the data being shared by Sender and Receiver without redundancy?</p>\n\n<p>2) How to handle the data that's used by Handler but that Sender and Receiver also need to use?\n</b></p>\n\n<hr>\n\n<h1>\n1) How to handle the data being shared by Sender and Receiver without redundancy?\n</h1>\n\n<p>One might say it's only necessary to fill both structures step by step with what they're going to need</p>\n\n<p>But it makes things too much redundant IMO:</p>\n\n<pre><code>func DoSomethingAndFill() {\n    data1 := generateSomeData1()\n    recv.Receive1(data1)\n    sender.Send1(data1)\n    data2 := generateSomeData2()\n    recv.Receive2(data2)\n    sender.Send2(data2)\n}\n</code></pre>\n\n<p>I told myself I could (litterally) share a base structure containing the data that needs to be shared :</p>\n\n<pre><code>type MetaData struct {\n    Data1 Data\n    Data2 Data\n}\n\ntype Sender struct {\n    *MetaData\n    info SenderInfo\n}\n\ntype Receiver struct {\n    *MetaData\n    info ReceiverInfo\n}\n</code></pre>\n\n<p>And when initializing I only needed to put the same pointer?</p>\n\n<pre><code>func init() {\n    md := MetaData{}\n    recv, send := Receiver{&amp;md}, Sender{&amp;md}\n}\n</code></pre>\n\n<p>But this forces me to do two things :</p>\n\n<ul>\n<li><p>On one hand if I want to make things clean and make a package for Receiver and another one for Sender, I have to make all fields of MetaData exported, which, while not being dramatically bad, is not ideal.</p></li>\n<li><p>On the other hand, I'm forced to make the code a little more confusing since when filling the structure I have to juggle between what goes into Sender, Receiver and MetaData.</p></li>\n</ul>\n\n<hr>\n\n<h1>\n2) How to handle the data that's used by Handler but that Sender and Receiver also need to use?\n</h1>\n\n<p>This first thing that came to my mind was to make a sort of backward link to the parent structure :</p>\n\n<pre><code>type Handler struct {\n    Info HandlerInfo\n}\n\ntype Sender struct {\n    handler Handler\n    info SenderInfo\n}\n\ntype Receiver struct {\n    handler Handler\n    info ReceiverInfo\n}\n\nfunc (h Handler) MakeRecvAndSend() {\n    recv, send := Receiver{\n        handler: h,\n    }, Sender{\n        handler: h,\n    }\n}\n</code></pre>\n\n<p>And at first sight it seems quite good, but again, if Sender and Receiver are in different packages, and since circular imports are not permitted in Golang, it is not possible.</p>\n\n<p>Another solution I thought of would be to copy the relevant information piece by piece:</p>\n\n<pre><code>type Handler struct {\n    info1 HandlerInfo\n    info2 HandlerInfo\n}\n\ntype Sender struct {\n    handlerInfo HandlerInfo\n    info SenderInfo\n}\n\ntype Receiver struct {\n    handlerInfo HanlderInfo\n    info ReceiverInfo\n}\n\nfunc (h Handler) MakeRecvAndSend() {\n    recv, send := Receiver{\n        handlerInfo: h.info1,\n    }, Sender{\n        handler: h.info2,\n    }\n}\n</code></pre>\n\n<p>But this is reaaaally verbose, and according to the way I generate senders and receivers I'm afraid this is going to impact runtime speed / memory.</p>\n\n<p>If you already ran into such issues, I'd like your feedback and the way you solved this. I'm also interesting in any theoretical thought you might want to share!</p>\n\n<p>Thx!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543159336, "post_id": 53468842, "comment_id": 93808355, "body": "How exactly did you install it?"}, {"owner": {"reputation": 157, "user_id": 10612612, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w4m3q9aA7yM/AAAAAAAAAAI/AAAAAAAAAkk/d49sHP6CQEc/photo.jpg?sz=128", "display_name": "Aryamaan Goswamy", "link": "https://stackoverflow.com/users/10612612/aryamaan-goswamy"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1543161366, "post_id": 53468842, "comment_id": 93808970, "body": "golang.org/dl the msi file i think"}], "answers": [{"comments": [{"owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "reply_to_user": {"reputation": 157, "user_id": 10612612, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w4m3q9aA7yM/AAAAAAAAAAI/AAAAAAAAAkk/d49sHP6CQEc/photo.jpg?sz=128", "display_name": "Aryamaan Goswamy", "link": "https://stackoverflow.com/users/10612612/aryamaan-goswamy"}, "edited": false, "score": 0, "creation_date": 1543159626, "post_id": 53468875, "comment_id": 93808438, "body": "@AryamaanGoswamy You should watch this tutorial <a href=\"https://www.youtube.com/watch?v=_b-9kcq-xmA\" rel=\"nofollow noreferrer\">youtube.com/watch?v=_b-9kcq-xmA</a>"}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 2, "last_activity_date": 1543159254, "last_edit_date": 1543159254, "creation_date": 1543158817, "answer_id": 53468875, "question_id": 53468842, "link": "https://stackoverflow.com/questions/53468842/error-while-executing-go-file-not-recognized-even-when-go-is-installed/53468875#53468875", "title": "Error while executing .go file. Not recognized even when go is installed", "body": "<p>You should put the directory where you installed Go (default <code>c:\\Go\\bin</code>)  in your <code>PATH</code> environment variable.</p>\n"}], "owner": {"reputation": 157, "user_id": 10612612, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w4m3q9aA7yM/AAAAAAAAAAI/AAAAAAAAAkk/d49sHP6CQEc/photo.jpg?sz=128", "display_name": "Aryamaan Goswamy", "link": "https://stackoverflow.com/users/10612612/aryamaan-goswamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1588329644, "creation_date": 1543158602, "last_edit_date": 1588329644, "question_id": 53468842, "link": "https://stackoverflow.com/questions/53468842/error-while-executing-go-file-not-recognized-even-when-go-is-installed", "title": "Error while executing .go file. Not recognized even when go is installed", "body": "<p>When I type go run file.go in command line, it says go is not recognized as an internal or external command, operable program or batch file. I have Go installed.</p>\n\n<p>Edit: sorry that was a weird question</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "edited": false, "score": 0, "creation_date": 1543157007, "post_id": 53468617, "comment_id": 93807679, "body": "Yes, I already tried robotgo, that is super nice. Except one thing, it doesn&#39;t deal with click and release, only release :("}], "tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 0, "last_activity_date": 1543156886, "creation_date": 1543156886, "answer_id": 53468617, "question_id": 53468559, "link": "https://stackoverflow.com/questions/53468559/how-to-get-onmousedown-event-in-go/53468617#53468617", "title": "How to get onMouseDown event in go", "body": "<p>Try with <a href=\"https://github.com/go-vgo/robotgo\" rel=\"nofollow noreferrer\">robotgo</a> - Golang Desktop Automation</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"github.com/go-vgo/robotgo\"\n)\n\nfunc main() {\n\n // mouse events: mleft, mright, wheelDown, wheelUp, wheelLeft, wheelRight.\n  mleft := robotgo.AddEvent(\"mleft\")\n  if mleft == 0 {\n    fmt.Println(\"you press... \", \"mouse left button\")\n  }\n} \n</code></pre>\n"}], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1543188647, "creation_date": 1543156516, "last_edit_date": 1543188647, "question_id": 53468559, "link": "https://stackoverflow.com/questions/53468559/how-to-get-onmousedown-event-in-go", "title": "How to get onMouseDown event in go", "body": "<p>Is there a simple way to get the mouse events, like when the left button is clicked, and when it is released in <code>Go</code> ?</p>\n\n<p>And also is it possible to get that information even is the mouse is not hover the window's program ?</p>\n\n<p>I'd like to draw a square over the screen, between the beginning and the release of the click, to capture that part of the screen.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "go-cobra"], "answers": [{"comments": [{"owner": {"reputation": 956, "user_id": 6402561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1aa8dd9d8c878efcce8226aab763c0d7?s=128&d=identicon&r=PG&f=1", "display_name": "a person", "link": "https://stackoverflow.com/users/6402561/a-person"}, "edited": false, "score": 0, "creation_date": 1543187993, "post_id": 53469247, "comment_id": 93816417, "body": "Thanks!  Unfortunately when I try to do something like this - <code>go run *.go rest -env DEV</code> I get the following for the value of env:  <code>Env:  nv</code> .   What am I doing wrong?  thank you"}], "tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": true, "score": 1, "last_activity_date": 1543161556, "creation_date": 1543161556, "answer_id": 53469247, "question_id": 53468224, "link": "https://stackoverflow.com/questions/53468224/how-to-have-each-cobra-command-parse-its-own-flags-getting-initialization-loop/53469247#53469247", "title": "how to have each cobra command parse its own flags? getting initialization loop (expected, but how to avoid?)", "body": "<p>Each sub command can have their own flags. You can do this as following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"github.com/spf13/cobra\"\n)\n\nvar rootCmd = &amp;cobra.Command{\n    Use: \"app\",\n}\n\nfunc NewCmdRest() *cobra.Command {\n    var env string\n    var restCmd = &amp;cobra.Command{\n        Use: \"rest\",\n        Run: func(cmd *cobra.Command, args []string) {\n            fmt.Println(\"rest:\", env)\n        },\n    }\n\n    restCmd.Flags().StringVarP(&amp;env, \"env\", \"e\", \"\", \"environment\")\n    return restCmd\n}\n\nfunc NewCmdEvent() *cobra.Command {\n    var env string\n    var eventCmd = &amp;cobra.Command{\n        Use: \"event\",\n        Run: func(cmd *cobra.Command, args []string) {\n            fmt.Println(\"event:\", env)\n        },\n    }\n\n    eventCmd.Flags().StringVarP(&amp;env, \"env\", \"e\", \"\", \"environment\")\n    return eventCmd\n}\n\nfunc init() {\n    rootCmd.AddCommand(NewCmdRest())\n    rootCmd.AddCommand(NewCmdEvent())\n}\n\nfunc main() {\n    if err := rootCmd.Execute(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 956, "user_id": 6402561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1aa8dd9d8c878efcce8226aab763c0d7?s=128&d=identicon&r=PG&f=1", "display_name": "a person", "link": "https://stackoverflow.com/users/6402561/a-person"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 53469247, "answer_count": 1, "score": 0, "last_activity_date": 1543161556, "creation_date": 1543154320, "question_id": 53468224, "link": "https://stackoverflow.com/questions/53468224/how-to-have-each-cobra-command-parse-its-own-flags-getting-initialization-loop", "title": "how to have each cobra command parse its own flags? getting initialization loop (expected, but how to avoid?)", "body": "<p>I'm following the guide on <a href=\"https://github.com/spf13/cobra#flags\" rel=\"nofollow noreferrer\">https://github.com/spf13/cobra#flags</a>, but I'm confused by some of the content there.</p>\n\n<p>I have a few services (rest api, email service, events) and I'm trying to do something like this:  </p>\n\n<p><code>go run *.go rest -env DEV -p 3000</code></p>\n\n<p><code>go run *.go events -env DEV -p 3001</code></p>\n\n<p>I'm following the github page, so I have defined my rootCmd and restCmd as such:</p>\n\n<pre><code>var rootCmd = &amp;cobra.Command{\n    Use: \"myappname\",\n}\n\nvar restCmd = &amp;cobra.Command{\n    Use:   \"rest\",\n    Short: \"REST API\",\n    Long:  \"REST API\",\n    Run:   runRest,\n}\n</code></pre>\n\n<p>And in the <code>runRest</code> method, should I be doing something like </p>\n\n<pre><code>var env string\nrestCmd.Flags().StringVarP(&amp;env, \"env\", \"env\", \"\", \"environment\")\n</code></pre>\n\n<p>Please let me know.</p>\n\n<p>Thanks</p>\n"}]