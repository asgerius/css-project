[{"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 155, "user_id": 399609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff41db2e109fe68260799d8160e1ed8?s=128&d=identicon&r=PG", "display_name": "GVdP", "link": "https://stackoverflow.com/users/399609/gvdp"}, "edited": false, "score": 4, "creation_date": 1485381891, "post_id": 41862323, "comment_id": 70908762, "body": "In your code, func (m1 Map) NewFragment operates on a value and not a pointer. If you change that to func (m1 *Map) NewFragment() etc etc, the two Println will both return true. I&#39;m not sure how you expect the program to work otherwise."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1485381994, "post_id": 41862323, "comment_id": 70908814, "body": "Use <code>==</code>. If the pointers point to the same variable, they have the same address. From the spec: <code>Pointer values are comparable. Two pointer values are equal if they point to the same variable or if both have value nil.</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": true, "score": 6, "last_activity_date": 1485397182, "creation_date": 1485397182, "answer_id": 41864974, "question_id": 41862323, "link": "https://stackoverflow.com/questions/41862323/why-are-these-golang-pointers-not-equal/41864974#41864974", "title": "Why are these golang pointers not equal?", "body": "<p>As JimB answered, you can use <code>==</code> to compare pointers. The reason this program behaves that way is because when you call the <code>NewFragment</code> method, a copy is made of the receiver. In this case, that means the line <code>f.Map = &amp;m1</code> is taking the address of the <em>copy</em>, not the original object. Therefore, the pointers are different (<code>f.Map != &amp;m</code>), and the values are the same (<code>*f.Map == m</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 4, "last_activity_date": 1485433335, "last_edit_date": 1485433335, "creation_date": 1485427388, "answer_id": 41871693, "question_id": 41862323, "link": "https://stackoverflow.com/questions/41862323/why-are-these-golang-pointers-not-equal/41871693#41871693", "title": "Why are these golang pointers not equal?", "body": "<h3>Pointers comparison</h3>\n\n<blockquote>\n  <p>The equality operators == and != apply to operands that are comparable.\n  Pointer values are comparable. Two pointer values are equal if they point to the same variable or if both have value nil.</p>\n</blockquote>\n\n<p>This is a valid code:</p>\n\n<pre><code>func main() {\n    s := struct{}{}\n    p1 := &amp;s\n    p2 := &amp;s\n    fmt.Println(p1 == p2)\n    fmt.Printf(\"%p, %p\", p1, p2)\n}\n</code></pre>\n\n<h3>Pointer receivers</h3>\n\n<p>Your code has a significant mistake which actually caused the behavior you described. Method could be declared with <em>value receiver</em> <code>func (s SomeObj) DoSomething(){}</code> and with <em>pointer receiver</em> <code>func (s *SomeObj) DoSomething(){}</code>. If a method declared with value receiver (like you did) you will obtain a copy of the object but if you declare a method with pointer receiver (like you should do) you will obtain a pointer to the object itself.</p>\n\n<p>Your code lacks only one asterisk:</p>\n\n<pre><code>type Map struct{}\ntype Fragment struct {\n    Map *Map\n}\n\nfunc (m1 *Map) NewFragment() (f Fragment) { // Note, this is a pointer receiver\n    f.Map = m1\n    return\n}\n\nvar m Map = Map{}\n\nfunc main() {\n    f := m.NewFragment()\n    fmt.Println(f.Map == &amp;m) // true\n    fmt.Println(*f.Map == m) // true\n    fmt.Printf(\"%p, %p\", f.Map, &amp;m)\n}\n</code></pre>\n\n<h3>Conclusion</h3>\n\n<p>Pointer comparison is check whether it is the same pointer (identity). So if you look closer at your code you will see that your code and my example located above have the same meaning.</p>\n\n<p>Playgounds:</p>\n\n<p><a href=\"https://play.golang.org/p/GgTOEgvWA9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/GgTOEgvWA9</a></p>\n\n<p><a href=\"https://play.golang.org/p/kFxpu-8TDT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/kFxpu-8TDT</a></p>\n"}], "owner": {"reputation": 3223, "user_id": 702912, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9e25ee94fc81a18d3207befd8aa7837?s=128&d=identicon&r=PG", "display_name": "Charles Holbrow", "link": "https://stackoverflow.com/users/702912/charles-holbrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1794, "favorite_count": 0, "accepted_answer_id": 41864974, "answer_count": 2, "score": 0, "last_activity_date": 1516814205, "creation_date": 1485381140, "last_edit_date": 1516814205, "question_id": 41862323, "link": "https://stackoverflow.com/questions/41862323/why-are-these-golang-pointers-not-equal", "title": "Why are these golang pointers not equal?", "body": "<p>In the example below I check the equality of two pointers</p>\n\n<ul>\n<li>The pointers are pointing to the same address</li>\n<li>They are not the same pointer</li>\n</ul>\n\n<p>How do I check if two pointers are pointing to the same address? I <strong>do not</strong> want to check if the contents of both pointers are equal.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Map struct {}\ntype Fragment struct {\n    Map *Map\n}\n\nfunc (m1 Map) NewFragment() (f Fragment) {\n    f.Map = &amp;m1\n    return\n}\n\n\nvar m Map = Map {}\n\nfunc main() {\n    f := m.NewFragment()\n    fmt.Println(f.Map == &amp;m) // false\n    fmt.Println(*f.Map == m) // true\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/YXwaRqYUUj\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1485381033, "post_id": 41861918, "comment_id": 70908349, "body": "have you tried it with some &quot;pure&quot; calculations and not just printing?"}, {"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1485381255, "post_id": 41861918, "comment_id": 70908449, "body": "not sure I understand how to do it."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1485381809, "post_id": 41861918, "comment_id": 70908730, "body": "well, it doesn&#39;t matter. I tried it myself and it&#39;s indeed not working, contrary to the documentation."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1485387124, "last_edit_date": 1592644375, "creation_date": 1485387124, "answer_id": 41863621, "question_id": 41861918, "link": "https://stackoverflow.com/questions/41861918/using-testing-benchmark-does-not-produce-any-output/41863621#41863621", "title": "Using testing.Benchmark does not produce any output", "body": "<p>I think you are doing everything right. Doc of <a href=\"https://golang.org/pkg/testing/#Benchmark\" rel=\"nofollow noreferrer\"><code>testing.Benchmark()</code></a> says:</p>\n<blockquote>\n<p>Benchmark benchmarks a single function. Useful for creating custom benchmarks that do not use the &quot;go test&quot; command.</p>\n<p>If f calls Run, the result will be an estimate of running all its subbenchmarks that don't call Run in sequence in a single benchmark.</p>\n</blockquote>\n<p>Looking into the implementation (Go 1.7.4):</p>\n<pre><code>func Benchmark(f func(b *B)) BenchmarkResult {\n    b := &amp;B{\n        common: common{\n            signal: make(chan bool),\n            w:      discard{},\n        },\n        benchFunc: f,\n        benchTime: *benchTime,\n    }\n    if !b.run1() {\n        return BenchmarkResult{}\n    }\n    return b.run()\n}\n</code></pre>\n<p>This line:</p>\n<pre><code>    if !b.run1() {\n        return BenchmarkResult{}\n    }\n</code></pre>\n<p><code>b.run1()</code> is supposed to run your passed function once, and detect if it has sub-benchmarks. Yours has. It returns a <code>bool</code> whether more runs are needed. Inside <code>run1()</code>:</p>\n<pre><code>if b.hasSub || b.finished {\n    // ...\n    return true\n}\n</code></pre>\n<p>It properly tells it has sub-benchmark, and <code>Benchmark()</code> \u2013with noble simplicity\u2013 just returns an empty <code>BenchmarkResult</code>:</p>\n<pre><code>    if !b.run1() {\n        return BenchmarkResult{}\n    }\n</code></pre>\n<p>I do believe that either this is a bug (or rather &quot;incomplete&quot; feature), or doc is incorrect. I suggest to file an issue here: <a href=\"https://github.com/golang/go/issues\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues</a></p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1485430075, "post_id": 41871952, "comment_id": 70926514, "body": "&#39;<code>Benchmark</code> benchmarks a single function. Useful for creating custom benchmarks that do not use the &quot;go test&quot; command.&#39;"}, {"owner": {"reputation": 131, "user_id": 2687264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4114e403f9a3e9812b4e7179ad4d7003?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Fendrich", "link": "https://stackoverflow.com/users/2687264/peter-fendrich"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485437286, "post_id": 41871952, "comment_id": 70930565, "body": "I&#39;m sorry if I was unclear. To run the code exactly as it was written he need to use run -bench=. I&#39;ll edit my original answer with how to restructure it a bit to make it test a single function."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1485442234, "post_id": 41871952, "comment_id": 70934025, "body": "@PeterFendrich Yes, not using sub-benchmarks works. But according to the docs, what the asker tried should also work (most likely he has many more sub-benchmark which are not included in the question for brevity), and that is what this question is about."}, {"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "edited": false, "score": 0, "creation_date": 1485529005, "post_id": 41871952, "comment_id": 70975756, "body": "Yes, not using subs works, but that&#39;s not what I&#39;m looking for."}], "tags": [], "owner": {"reputation": 131, "user_id": 2687264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4114e403f9a3e9812b4e7179ad4d7003?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Fendrich", "link": "https://stackoverflow.com/users/2687264/peter-fendrich"}, "is_accepted": false, "score": 1, "last_activity_date": 1485438069, "last_edit_date": 1485438069, "creation_date": 1485428151, "answer_id": 41871952, "question_id": 41861918, "link": "https://stackoverflow.com/questions/41861918/using-testing-benchmark-does-not-produce-any-output/41871952#41871952", "title": "Using testing.Benchmark does not produce any output", "body": "<p>Eddited the answer to clarify:</p>\n\n<p>My guess is that you are using go run to run the test. That will not produce any result. In order to run the code exatly as it is written you need to use<br>\ngo test -bench=.  and I think it should work.\nThe file must be named test_xxx.go   where xxx is whatever you want.</p>\n\n<p>If you restucture you code a litle bit it can be run as a single function benchmark:</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc main() {\n    myTest()\n}\n\nfunc myTest() {\n    fn := func(b *testing.B) {\n        for n := 0; n &lt; b.N; n++ {\n            println(\"ok\")\n        }\n    }\n    result := testing.Benchmark(fn)\n\n    println(result.String())\n}\n</code></pre>\n"}], "owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "accepted_answer_id": 41863621, "answer_count": 2, "score": 3, "last_activity_date": 1485438069, "creation_date": 1485379443, "last_edit_date": 1485379754, "question_id": 41861918, "link": "https://stackoverflow.com/questions/41861918/using-testing-benchmark-does-not-produce-any-output", "title": "Using testing.Benchmark does not produce any output", "body": "<p>I'm using <code>testing.Benchmark</code> to manually run a couple benchmarks but the result object is always empty.</p>\n\n<p>Am I missing something here?</p>\n\n<p>Here's an example:</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc main() {\n\n    result := testing.Benchmark(func(parentB *testing.B) {\n        parentB.Run(\"example\", func(b *testing.B) {\n            for n := 0; n &lt; b.N; n++ {\n                println(\"ok\")\n            }\n        })\n    })\n\n    println(result.String())\n\n}\n</code></pre>\n\n<p>This will print <code>ok</code> a couple times and then <code>0          0 ns/op</code> but the benchmark clearly did run something.</p>\n"}, {"tags": ["mysql", "go", "goroutine"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485418136, "post_id": 41860227, "comment_id": 70920217, "body": "<code>connection reset by peer</code> suggests mysql server is closing a tcp connection the go client is trying to read from. Please add versions of mysql &amp; go. Can you post code that will reproduce the issue? How many requests are sent? How many concurrent requests? Does the error happen after some period of time or immediately?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485598964, "post_id": 41860227, "comment_id": 70998921, "body": "Seems like higher number of connections is hitting some resource limit. Is the code checking every possible error in all cases? For example, <code>tx := db.Begin()</code> can throw an error and if not handled, can lead to read/write errors. Also in the code, when panicking, the Tx is not rolled back so the underlying connection will be left open. It&#39;s unusual to panic &amp; recover like that, just rollback and return instead. <code>tx.Exec(batchSQL).GetErrors()</code> is odd - what driver is used? Could <a href=\"https://github.com/go-sql-driver/mysql#load-data-local-infile-support\" rel=\"nofollow noreferrer\">LOAD DATA</a> be used instead?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485599212, "post_id": 41860227, "comment_id": 70998975, "body": "How long does the process usually take to insert all 2m records?"}, {"owner": {"reputation": 721, "user_id": 2108258, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7b01fe08a510994b22f4c9d976d66bda?s=128&d=identicon&r=PG", "display_name": "user2108258", "link": "https://stackoverflow.com/users/2108258/user2108258"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485782032, "post_id": 41860227, "comment_id": 71053876, "body": "I edited the code to rebuild the csv then used LOAD Data query in mariadb console. It took ~35 minutes. Thank you for the LOAD DATA link as It says that connection losses can be affected by max-allowed-packet limits. The limit on my server was the default 16MB. I Increased the limit 10 150MB. I was then able to raise the number of open connections to 50 without errors. The memory usage exceeds 1GB though which I will tackle next with some profiling."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485817192, "post_id": 41860227, "comment_id": 71074254, "body": "More than about 5 connections may be slow if inserting to one table on one disk, because the connections all compete for the same resource. Fewer connections means less contention, so try reducing the number of goroutines to 5. The max-allowed-packet permits the size of a single insert statement, various sizes of inserted data may explain why error was sporadic. Alternative to increasing max-allowed-packet is reducing insert batch count. Also, consider turning off auto commit is off before bulk inserts."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485817354, "post_id": 41860227, "comment_id": 71074319, "body": "Alternative to bulk sql string is a prepared statement with multiple values, see <a href=\"http://stackoverflow.com/questions/21108084/golang-mysql-insert-multiple-data-at-once\">here</a>."}], "owner": {"reputation": 721, "user_id": 2108258, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7b01fe08a510994b22f4c9d976d66bda?s=128&d=identicon&r=PG", "display_name": "user2108258", "link": "https://stackoverflow.com/users/2108258/user2108258"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2419, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1485448583, "creation_date": 1485373176, "last_edit_date": 1485448583, "question_id": 41860227, "link": "https://stackoverflow.com/questions/41860227/goroutines-and-mysql-max-connections", "title": "Goroutines and Mysql max connections", "body": "<p>When I run functions in parallel that make use of mysql driver(Gorm), I find that when I set the following:\n     db.DB().SetMaxOpenConns(30)\n     db.DB().SetMaxIdleConns(10)</p>\n\n<p>I get a clean output without any panics/error messages.</p>\n\n<p>My database server variable for max_connection is set 100. I find if I SetMaxOpenConns to 50 or above I start to receive </p>\n\n<pre><code>[mysql] 2017/01/25 14:26:09 packets.go:33: read tcp 127.0.0.1:60614-&gt;127.0.0.1:3306: read: connection reset by peer\n[mysql] 2017/01/25 14:26:09 packets.go:130: write tcp 127.0.0.1:60614-&gt;127.0.0.1:3306: write: broken pipe\n</code></pre>\n\n<p>If I just print the error and not panic then the errors eventually go away and the script finishes processing. </p>\n\n<p>I'm having a tough time understanding how to manipulate these values. The Max Open connWhy when the open connections rate is lower that the script seems to have no problem connecting/reading but a higher max below the server limit is problematic.</p>\n\n<p>MariaDB Version: 10.1.21\nGo version: 1.7.4\nThere are 2.1m records in the csv file that I'm parsing.\nI'm batching 2000 records into each insert string</p>\n\n<p>Here is a portion of the main code</p>\n\n<pre><code>func main(){\n    //Setup and Connect to database \n    //Set variables\n    //Read CSV File\n    dbConnect()\n    defer db.Close()\n    db.DB().SetMaxOpenConns(30)\n    db.DB().SetMaxIdleConns(10)\n    db.DB().SetConnMaxLifetime(time.Second * 14400)\n    filehandle, err := os.Open(physicianCSV)\n    checkErr(err)\n    defer filehandle.Close()\n\n    reader := csv.NewReader(filehandle)\n    _, err = reader.Read()\n    checkErr(err)\n\n    for i := 0; i &lt;= readLimit; i++ {\n        record, err := reader.Read()\n        if err != nil {\n            if err == io.EOF {\n                break\n            }\n            panic(err)\n        }\n        physician = convertCSVRecordToPhysician(record)\n        //..Do stuff with physician, edit struct properties\n\n        physicians = append(physicians, physician)\n\n        if math.Mod(float64(i), float64(bulkAmount)) == 0 &amp;&amp; i != 0 {\n            fmt.Println(i, \"Records: From \", i-bulkAmount, \"to\", i)\n            wg.Add(1)\n            sliceOfPhys := make([]Physician, bulkAmount)\n            copy(sliceOfPhys, physicians)\n            go bulkSavePhysicians(sliceOfPhys)\n            physicians = physicians[:0]\n\n        }\n    }\n\n    fmt.Println(readLimit, \"records inserted\")\n    wg.Wait()\n}\n\nfunc bulkSavePhysicians(_physicians []Physician) {\n    defer func() {\n        if x := recover(); x != nil {\n            fmt.Println(x)\n        }\n    }()\n    defer wg.Done()\n\n    sqlStringArray := buildSQLStatements(_physicians)\n    batchSQL := fmt.Sprintf(\"insert into physicians values %s ;\", strings.Join(sqlStringArray, \",\"))\n    tx := db.Begin()\n    errors := tx.Exec(batchSQL).GetErrors()\n    if len(errors) &gt; 0 {\n        panic(errors)\n    }\n    tx.Commit()\n}\n\nfunc buildSQLStatements(_physicians []Physician) []string {\n\n    var valueStr string\n    var valueArr []string\n    for _, phys := range _physicians {\n\n        valueStr = fmt.Sprintf(`( \"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\" )`, phys.NPI,\n            phys.PACID,\n            phys.ProfessionalEnrollmentID,\n            strings.Replace(phys.LastName, \"'\", \"\\\\'\", -1),\n            phys.FirstName,\n            phys.MiddleName,\n            phys.Suffix,\n            phys.Gender,\n            phys.Credential,\n            strings.Replace(phys.MedicalSchoolName, \"'\", \"\\\\'\", -1),\n            phys.GraduationYear,\n            phys.PrimarySpecialty,\n            phys.SecondarySpecialty1,\n            phys.SecondarySpecialty2,\n            phys.SecondarySpecialty3,\n            phys.SecondarySpecialty4,\n            phys.AllSecondarySpecialties,\n            strings.Replace(phys.OrganizationLegalName, \"'\", \"\\\\'\", -1),\n            phys.GroupPracticePACID,\n            phys.NumberOfGroupPracticeMembers,\n            strings.Replace(phys.Line1StreetAddress, \"'\", \"\\\\'\", -1),\n            phys.Line2StreetAddress,\n            phys.MarkerOfAddressLine2Suppression,\n            phys.City,\n            phys.State,\n            phys.ZipCode,\n            phys.PhoneNumber,\n            phys.HospitalAffiliationCCN1,\n            phys.HospitalAffiliationLBN1,\n            phys.HospitalAffiliationCCN2,\n            phys.HospitalAffiliationLBN2,\n            phys.HospitalAffiliationCCN3,\n            phys.HospitalAffiliationLBN3,\n            phys.HospitalAffiliationCCN4,\n            phys.HospitalAffiliationLBN4,\n            phys.HospitalAffiliationCCN5,\n            phys.HospitalAffiliationLBN5,\n            phys.ProfessionalAcceptsMedicareAssignment,\n            phys.ReportedQualityMeasures,\n            phys.UsedElectronicHealthRecords,\n            phys.ParticipatedInTheMedicareMaintenance,\n            phys.CommittedToHeartHealth,\n            phys.SpecialtyID)\n\n        valueArr = append(valueArr, valueStr)\n    }\n    return valueArr\n}\n</code></pre>\n"}, {"tags": ["go", "deadlock", "channel", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 7, "creation_date": 1485373024, "post_id": 41860130, "comment_id": 70904092, "body": "an unbuffered channel doesn&#39;t contain any elements, it&#39;s unbuffered."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485373091, "post_id": 41860130, "comment_id": 70904132, "body": "@JimB I am in a situation where I am blocking infinitely on a channel,  I want to debug this to see if there is anything at all in the channel because from stepping through code, it does appear that elements have been sent to the channel, how would you recommend i do this?"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485373145, "post_id": 41860130, "comment_id": 70904176, "body": "@JimB But when you take values out of a channel, you can get the exact number of values that were put in before blocking forever, so there must be some values stored internally right?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1485373258, "post_id": 41860130, "comment_id": 70904243, "body": "An unbuffered channel is synchronous, you can only send when there is a receiver. The channel doesn&#39;t store (buffer) anything. You&#39;re blocking because you&#39;re trying to send 2 values, but only receiving 1."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485373338, "post_id": 41860130, "comment_id": 70904287, "body": "@JimB Ah ok I think I understand, is there a way to create a channel with a dynamically sized buffer?  So the channel becomes somewhat like a threadsafe queue?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485373387, "post_id": 41860130, "comment_id": 70904308, "body": "No, you have to define the size of the channel buffer when you create it."}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1485406850, "post_id": 41860130, "comment_id": 70916665, "body": "You cannot dynamically alter the size of an existing channel, but you can dynamically create new channels in such a way as to present an effectively unbounded queue. In other words, you be unbounded horizontally instead of vertically."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1485411109, "post_id": 41860130, "comment_id": 70917764, "body": "@JoelCornett Essentially you mean a linked list of channels? But then that would also have to be synchronized, for example when adding a new horizontal partition to the channel right?  What is the Go way of going about doing this?  should I just look into the &quot;sync&quot; package?"}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1485412633, "post_id": 41860130, "comment_id": 70918161, "body": "here ya go. I must warn you though, this may have a bug in it. <a href=\"https://play.golang.org/p/hSDCeJ90D-\" rel=\"nofollow noreferrer\">play.golang.org/p/hSDCeJ90D-</a>"}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1485413473, "post_id": 41860130, "comment_id": 70918448, "body": "This one is slightly better, but I think we are getting off topic from your original question, no? <a href=\"https://play.golang.org/p/eQ_JgHbKtL\" rel=\"nofollow noreferrer\">play.golang.org/p/eQ_JgHbKtL</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 1, "creation_date": 1485541870, "post_id": 41860130, "comment_id": 70983697, "body": "@JoelCornett: that is a bad idea. Not only have you added a race condition on the slice of channels, prevented the ability to select on multiple channels concurrently, and lost the ability to stop the range by closing the channel, but your receive loop defaults into a busy loop which uses 100% CPU and eventually will block the scheduler."}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485542591, "post_id": 41860130, "comment_id": 70984055, "body": "@JimB I&#39;m not arguing with you about any of those. Out of curiosity though, what&#39;s the problem with having a race condition on the slice?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1485545210, "post_id": 41860130, "comment_id": 70985351, "body": "@JoelCornett: it&#39;s a data race. Best case your program crashes, but anything could happen, including retruning invalid results or other memory corruption."}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485545498, "post_id": 41860130, "comment_id": 70985471, "body": "@JimB maybe I&#39;m making some invalid assumptions, but channels are reference types, as are slices. The worst case I see is that the append generates a new backing array and copies the channel references into it, causing that iteration of the ouput goroutine to potentially &#39;miss&#39; some buffer channels. Effectively, there are only reads happening in the race cases (unless the assignment to ub.buffer is nonatomic)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1485545738, "post_id": 41860130, "comment_id": 70985580, "body": "@JoelCornett, there are no benign data races, and any Go program that contains data races has undefined behavior. Always check your programs with the race detector. Also see <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">software.intel.com/en-us/blogs/2013/01/06/&hellip;</a>"}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485546020, "post_id": 41860130, "comment_id": 70985709, "body": "@JimB I was working under the assumption that assignments to struct fields (and variable assignments in general are atomic). Are you telling me that that is incorrect?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 2, "creation_date": 1485549659, "post_id": 41860130, "comment_id": 70987508, "body": "@JoelCornett: your assumptions are incorrect, the only atomic operations are through the sync/atomic package. This isn&#39;t the place for this conversation -- Start by carefully reading the go memory model document, and the article I linked."}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485617554, "post_id": 41860130, "comment_id": 71004177, "body": "@JimB point taken. Also, interesting reading."}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 3, "last_activity_date": 1485380982, "creation_date": 1485380982, "answer_id": 41862277, "question_id": 41860130, "link": "https://stackoverflow.com/questions/41860130/how-to-get-the-number-of-elements-in-an-unbuffered-channel/41862277#41862277", "title": "How to get the number of elements in an unbuffered channel", "body": "<p>Go runtime has a deadlock detector that you just came across. The detector is giving you all information you need to solve the problem. You don't need to analyze the channel length.</p>\n\n<p>Let's look at the output of your program</p>\n\n<pre><code>value\nfatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan receive]:\nmain.main()\n    /home/grzesiek/test.go:16 +0x17e\n\ngoroutine 5 [chan send]:\nmain.main.func1(0xc42001a0c0, 0xc42001a120)\n    /home/grzesiek/test.go:10 +0x99\ncreated by main.main\n    /home/grzesiek/test.go:13 +0x9c\nexit status 2\n</code></pre>\n\n<p>It is saying that all goroutines are asleep (blocked) and no progress is possible. The blocked goroutines are listed altogether with the blocking operation and line that caused the blockage.</p>\n\n<p>Goroutine 1 (main) is trying to read from channel <code>done_channel</code> in line 16.</p>\n\n<p>Goroutine 5 (created in line 13 by the function call operator <code>()</code>) is trying to write to channel <code>channel</code> in line 10. It will never go further as there is no goroutine on the other side of the chanel. Therefore it will never write to <code>done_channel</code>.</p>\n\n<p>The program is blocked because no goroutine can go further and main goroutine is also blocked.</p>\n\n<p>Please be aware that the Go program ends when main goroutine ends, so this dead lock would not occur if you would not try to read from <code>done_channel</code>.</p>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1489531266, "creation_date": 1485372855, "question_id": 41860130, "link": "https://stackoverflow.com/questions/41860130/how-to-get-the-number-of-elements-in-an-unbuffered-channel", "title": "How to get the number of elements in an unbuffered channel", "body": "<p>I am in a situation where my program is deadlocking and I want to debug this and tell how many elements are in an unbuffered channel, is there any way to do this in Go?  The following code does not output a 2 as I would expect (further it deadlocks, which is also something I cannot find a reason for)</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    channel := make(chan string)\n    done_channel := make(chan bool)\n    go func() {\n        channel &lt;- \"value\"\n        channel &lt;- \"value\"\n        fmt.Println(len(channel))\n        done_channel &lt;- true\n    }()\n    variable := &lt;- channel\n    fmt.Println(variable)\n    ok := &lt;- done_channel\n    fmt.Println(ok)\n}\n</code></pre>\n"}, {"tags": ["go", "time", "influxdb"], "comments": [{"owner": {"reputation": 155, "user_id": 399609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff41db2e109fe68260799d8160e1ed8?s=128&d=identicon&r=PG", "display_name": "GVdP", "link": "https://stackoverflow.com/users/399609/gvdp"}, "edited": false, "score": 1, "creation_date": 1485382293, "post_id": 41859100, "comment_id": 70908946, "body": "You might want to calculate t - 3600s in Go and use that value in your query. Date/time in InfluxDB has its own format, surrounded by single quotes. See: <a href=\"http://stackoverflow.com/questions/38299252/query-influxdb-for-a-date\" title=\"query influxdb for a date\">stackoverflow.com/questions/38299252/query-influxdb-for-a-da&zwnj;&#8203;te</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4044, "user_id": 2322488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924e749f5c463f19625e51dad78a6b78?s=128&d=identicon&r=PG", "display_name": "Michael Desa", "link": "https://stackoverflow.com/users/2322488/michael-desa"}, "is_accepted": false, "score": 1, "last_activity_date": 1486135489, "creation_date": 1486135489, "answer_id": 42027573, "question_id": 41859100, "link": "https://stackoverflow.com/questions/41859100/how-to-parse-current-time-to-influxdb-go-client/42027573#42027573", "title": "How to parse current time to InfluxDB Go client?", "body": "<p>Date strings must be single quoted. Using</p>\n\n<pre><code>t := time.Now().Format(time.RFC3339)\nq = fmt.Sprintf(\"SELECT * FROM %s WHERE time &gt; '%s' - 3600s\", Measurement, t)\n</code></pre>\n\n<p>Should solve your issue.</p>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486135489, "creation_date": 1485369475, "question_id": 41859100, "link": "https://stackoverflow.com/questions/41859100/how-to-parse-current-time-to-influxdb-go-client", "title": "How to parse current time to InfluxDB Go client?", "body": "<p>I am using below Go client (\"github.com/influxdata/influxdb/client/v2\") to query InfluDB and it is working fine</p>\n\n<pre><code>q = fmt.Sprintf(\"SELECT * FROM %s WHERE time &gt; now() - 3600s\", Measurement)\n</code></pre>\n\n<p>but I want to use Go time variable instead of InfluxDB <strong>now()</strong></p>\n\n<pre><code>t := time.Now().Format(time.RFC3339)\nq = fmt.Sprintf(\"SELECT * FROM %s WHERE time &gt; %s - 3600s\", Measurement, t)\n</code></pre>\n\n<p>but getting <strong>error parsing query: found -01, expected ; at line 1, char 101</strong></p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1485369165, "post_id": 41858635, "comment_id": 70901884, "body": "always, check, errors."}], "answers": [{"tags": [], "owner": {"reputation": 6122, "user_id": 1714762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e27901840ca85707727f5ed339ad31f?s=128&d=identicon&r=PG", "display_name": "Jean-Bernard Jansen", "link": "https://stackoverflow.com/users/1714762/jean-bernard-jansen"}, "is_accepted": true, "score": 5, "last_activity_date": 1485368382, "creation_date": 1485368382, "answer_id": 41858792, "question_id": 41858635, "link": "https://stackoverflow.com/questions/41858635/segmentation-violation-with-golang-channels/41858792#41858792", "title": "Segmentation violation with golang channels", "body": "<p>You do not check for any error when calling the api. Thus the error when trying to close a response that never arrived.</p>\n\n<p>This code does not panic:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    requests := 10000\n    ch := make(chan string, requests)\n    for i := 1; i &lt;= requests; i++ {\n        go func(iter int) {\n            fmt.Println(iter)\n            resp, err := http.Get(\"http://localhost:8080/api/project\")\n            if (err == nil) {\n              resp.Body.Close()\n            }\n            ch &lt;- fmt.Sprint(iter)\n        }(i)\n    }\n    for i := 1; i &lt;= requests; i++ {\n        fmt.Println(&lt;-ch)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 648, "user_id": 9323388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef802072695bf44b64d63a6805c7901?s=128&d=identicon&r=PG&f=1", "display_name": "Margach Chris", "link": "https://stackoverflow.com/users/9323388/margach-chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1611910018, "creation_date": 1611910018, "answer_id": 65951303, "question_id": 41858635, "link": "https://stackoverflow.com/questions/41858635/segmentation-violation-with-golang-channels/65951303#65951303", "title": "Segmentation violation with golang channels", "body": "<p>The general cause of this error is when you try to reference an object that does not exist or has not yet been created.</p>\n<p>In the code above, if you try to call <code>resp.Body.Close()</code> when <code>body</code> does not exist, that becomes a nil pointer reference and hence the error.</p>\n"}], "owner": {"reputation": 1247, "user_id": 302045, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3140211222dc32540a827fd75661bd84?s=128&d=identicon&r=PG", "display_name": "Tim Ferrell", "link": "https://stackoverflow.com/users/302045/tim-ferrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5924, "favorite_count": 0, "accepted_answer_id": 41858792, "answer_count": 2, "score": 1, "last_activity_date": 1611910018, "creation_date": 1485367817, "question_id": 41858635, "link": "https://stackoverflow.com/questions/41858635/segmentation-violation-with-golang-channels", "title": "Segmentation violation with golang channels", "body": "<p>The below code opens 10,000 go routines, which make HTTP calls, get the response, close the response, and write to a channel with an ID. </p>\n\n<p>In the second for loop, it prints out from that buffered channel the ID of the previous go routine.</p>\n\n<p>This causes a segmentation violation, and I can't figure out why.</p>\n\n<p>Panic:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x40 pc=0x2293]\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    requests := 10000\n    ch := make(chan string, requests)\n    for i := 1; i &lt;= requests; i++ {\n        go func(iter int) {\n            fmt.Println(iter)\n            resp, _ := http.Get(\"http://localhost:8080/api/project\")\n            resp.Body.Close()\n            ch &lt;- fmt.Sprint(\"%i\", iter)\n        }(i)\n    }\n    for i := 1; i &lt;= requests; i++ {\n        fmt.Println(&lt;-ch)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "network-programming"], "answers": [{"comments": [{"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1485369773, "post_id": 41859132, "comment_id": 70902230, "body": "Thanks, I think that makes sense so will give that a go.  Did you mean both of them to be Len(buffer)-1 ?"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 1, "creation_date": 1485369836, "post_id": 41859132, "comment_id": 70902284, "body": "Excuse me it&#39;s a typo"}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1485417601, "post_id": 41859132, "comment_id": 70919972, "body": "Great thanks. Worked really well.  In the end I went for <code>if ((tempBuffer[length-3] != endDelimiter) &amp;&amp; (tempBuffer[length-2] == endDelimiter)) &amp;&amp; (tempBuffer[length-1] == startDelimiter){</code> so that it would make sure it was at the end of a packet"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1485369883, "last_edit_date": 1485369883, "creation_date": 1485369560, "answer_id": 41859132, "question_id": 41856794, "link": "https://stackoverflow.com/questions/41856794/optimising-network-code/41859132#41859132", "title": "Optimising network code", "body": "<p>Looks like you call <code>popPacketFromBuffer()</code> each time every single byte received from connection. However <code>popPacketFromBuffer()</code> copy hole buffer and inspect for delimeters every byte each tyme. Maybe this is overwhelming. For me you don't need loop</p>\n\n<pre><code>for i := 0; i &lt; length-1; i++ {\n        if tempBuffer[i] == endDelimiter {\n            if tempBuffer[i+1] == endDelimiter {\n                i++\n            } else {\n                // We found a single delimiter, so consider this the end of a packet\n                endOfPacket = i - 2\n                break\n            }\n        }\n    }\n</code></pre>\n\n<p>in <code>popPacketFromBuffer()</code> Maybe instead of loop just testing last two bytes</p>\n\n<pre><code>if (buffer[len(buffer)-2] == endDelimiter) &amp;&amp; (buffer[len(buffer)-1] != endDelimiter){\n    //It's a packet\n}\n</code></pre>\n\n<p>would be enough for purpose.</p>\n"}], "owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 41859132, "answer_count": 1, "score": 1, "last_activity_date": 1485369883, "creation_date": 1485361955, "question_id": 41856794, "link": "https://stackoverflow.com/questions/41856794/optimising-network-code", "title": "Optimising network code", "body": "<p>I have a Go server that takes input from a number of TCP clients that stream in data.  The format is a custom format and the end delimiter could appear within the byte stream so it uses bytes stuffing to get around this issue.</p>\n\n<p>I am looking for hotspots in my code and this throws up a HUGE one and I'm sure it could be made more efficient but I'm not quite sure how at the moment given the provided Go functions.</p>\n\n<p>The code is below and pprof shows the hotspot to be <code>popPacketFromBuffer</code> command.  This looks at the current buffer, after each byte has been received and looks for the endDelimiter on it's own.  If there is 2 of them in a row then it is within the packet itself.</p>\n\n<p>I did look at using <code>ReadBytes()</code> instead of <code>ReadByte()</code> but it looks like I need to specify a delimiter and I'm fearful that this will cut off a packet mid stream?  And also in any case would this be more efficient than what I am doing anyway?</p>\n\n<p>Within the <code>popPacketFromBuffer</code> function it is the for loop that is the hotspot.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>// Read client data from channel\nfunc (c *Client) listen() {\n\n    reader := bufio.NewReader(c.conn)\n\n    clientBuffer := new(bytes.Buffer)\n\n    for {\n        c.conn.SetDeadline(time.Now().Add(c.timeoutDuration))\n\n        byte, err := reader.ReadByte()\n\n        if err != nil {\n            c.conn.Close()\n            c.server.onClientConnectionClosed(c, err)\n            return\n        }\n\n        wrErr := clientBuffer.WriteByte(byte)\n        if wrErr != nil {\n            log.Println(\"Write Error:\", wrErr)\n        }\n\n        packet := popPacketFromBuffer(clientBuffer)\n        if packet != nil {\n            c.receiveMutex.Lock()\n            packetSize := uint64(len(packet))\n            c.bytesReceived += packetSize\n            c.receiveMutex.Unlock()\n\n            packetBuffer := bytes.NewBuffer(packet)\n\n            b, err := uncompress(packetBuffer.Bytes())\n            if err != nil {\n                log.Println(\"Unzip Error:\", err)\n            } else {\n                c.server.onNewMessage(c, b)\n            }\n        }\n\n    }\n}\n\nfunc popPacketFromBuffer(buffer *bytes.Buffer) []byte {\n\n    bufferLength := buffer.Len()\n\n    if bufferLength &gt;= 125000 { // 1MB in bytes is roughly this\n        log.Println(\"Buffer is too large \", bufferLength)\n        buffer.Reset()\n        return nil\n    }\n\n    tempBuffer := buffer.Bytes()\n    length := len(tempBuffer)\n\n    // Return on zero length buffer submission\n    if length == 0 {\n        return nil\n    }\n\n    endOfPacket := -1\n\n    // Determine the endOfPacket position by looking for an instance of our delimiter\n    for i := 0; i &lt; length-1; i++ {\n        if tempBuffer[i] == endDelimiter {\n            if tempBuffer[i+1] == endDelimiter {\n                i++\n            } else {\n                // We found a single delimiter, so consider this the end of a packet\n                endOfPacket = i - 2\n                break\n            }\n        }\n    }\n\n    if endOfPacket != -1 {\n        // Grab the contents of the provided packet\n        extractedPacket := buffer.Bytes()\n\n        // Extract the last byte as we were super greedy with the read operation to check for stuffing\n        carryByte := extractedPacket[len(extractedPacket)-1]\n\n        // Clear the main buffer now we have extracted a packet from it\n        buffer.Reset()\n\n        // Add the carryByte over to our new buffer\n        buffer.WriteByte(carryByte)\n\n        // Ensure packet begins with a valid startDelimiter\n        if extractedPacket[0] != startDelimiter {\n            log.Println(\"Popped a packet without a valid start delimiter\")\n            return nil\n        }\n\n        // Remove the start and end caps\n        slice := extractedPacket[1 : len(extractedPacket)-2]\n\n        return deStuffPacket(slice)\n    }\n\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go", "callback", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 1536511, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b44e01cf35cc139893955876f02559db?s=128&d=identicon&r=PG", "display_name": "Daniel Ruhman", "link": "https://stackoverflow.com/users/1536511/daniel-ruhman"}, "is_accepted": true, "score": 2, "last_activity_date": 1485941329, "creation_date": 1485941329, "answer_id": 41976169, "question_id": 41856287, "link": "https://stackoverflow.com/questions/41856287/gomobile-bind-delegate-callback-behaviour/41976169#41976169", "title": "Gomobile bind delegate/callback behaviour", "body": "<p>Turns out it is possible!</p>\n\n<p>Here is the Go Code:</p>\n\n<pre><code>type NetworkingClient struct {}\n\nfunc CreateNetworkingClient() *NetworkingClient {\n    return &amp;NetworkingClient {}\n}\n\ntype Callback interface {\n    SendResult(json string)\n}\n\nfunc (client NetworkingClient) RequestJson (countryCode string, callback Callback) {\n    go func () {\n    safeCountryCode := url.QueryEscape(countryCode)\n    url := fmt.Sprintf(\"someApi/%s\", safeCountryCode)\n\n    req, err := http.NewRequest(\"GET\", url, nil)\n    if err != nil {\n        //Handle error\n    }\n\n    httpClient := &amp;http.Client{}\n\n    resp, err := httpClient.Do(req)\n    if err != nil {\n        //Handle error\n    }\n\n    defer resp.Body.Close()\n      b, err := ioutil.ReadAll(resp.Body)\n      callback.SendResult(string(b))\n        }()\n  }\n</code></pre>\n\n<p>Which is implemented as follow in Objetive-C:</p>\n\n<pre><code>- (void)start {\n\n    ...\n\n    EndpointNetworkingClient* client = EndpointCreateNetworkingClient();\n    [client requestJson:countryCode callback:self];\n}\n\n//Receives the json string from Go.\n- (void)sendResult:(NSString*)json{\n    NSData *data = [json dataUsingEncoding:NSUTF8StringEncoding];\n    id jsonDictionary = [NSJSONSerialization JSONObjectWithData:data options:0 error:nil];\n    [self handleResponse:jsonDictionary];\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 1536511, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b44e01cf35cc139893955876f02559db?s=128&d=identicon&r=PG", "display_name": "Daniel Ruhman", "link": "https://stackoverflow.com/users/1536511/daniel-ruhman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 1, "accepted_answer_id": 41976169, "answer_count": 1, "score": 0, "last_activity_date": 1485941329, "creation_date": 1485360489, "last_edit_date": 1485361874, "question_id": 41856287, "link": "https://stackoverflow.com/questions/41856287/gomobile-bind-delegate-callback-behaviour", "title": "Gomobile bind delegate/callback behaviour", "body": "<p>Anyone know if it is possible, using gomobile bind, to implement some sort of delegate behaviour when exporting to iOS?</p>\n\n<p>i.e. i have a go library that handles network requests for an iOS app, and i need it to be done asynchronously so that it doesn't hang the app. </p>\n\n<p>Solutions would be to either send a objc completion block (which i don't think will work, since i have found no way to send objc code back into the go function) or implement some sort of delegate so that the app can know when the request has finished. I have tried everything I could think of... Any ideas? Thanks!</p>\n"}, {"tags": ["templates", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1485362796, "last_edit_date": 1495542258, "creation_date": 1485360693, "answer_id": 41856364, "question_id": 41856021, "link": "https://stackoverflow.com/questions/41856021/how-to-parse-multiple-strings-into-a-template-with-go/41856364#41856364", "title": "How to parse multiple strings into a template with Go?", "body": "<p>You may create a new, empty template using <a href=\"https://golang.org/pkg/html/template/#New\" rel=\"nofollow noreferrer\"><code>template.New()</code></a> <em>function</em>. Then you may use the <a href=\"https://golang.org/pkg/html/template/#Template.New\" rel=\"nofollow noreferrer\"><code>Template.New()</code></a> <em>method</em> to create a new, empty, <em>associated</em> template. And you may parse \"into\" this using the <a href=\"https://golang.org/pkg/html/template/#Template.Parse\" rel=\"nofollow noreferrer\"><code>Template.Parse()</code></a> method.</p>\n\n<p>Here's how it could look like:</p>\n\n<pre><code>func parseTemplates(templs ...string) (t *template.Template, err error) {\n    t = template.New(\"_all\")\n\n    for i, templ := range templs {\n        if _, err = t.New(fmt.Sprint(\"_\", i)).Parse(templ); err != nil {\n            return\n        }\n    }\n\n    return\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>t, err := parseTemplates(\n    `{{define \"one\"}}I'm #1.{{end}}`,\n    `{{define \"two\"}}I'm #2, including #1: {{template \"one\" .}}{{end}}`,\n)\nif err != nil {\n    panic(err)\n}\n\nif err = t.ExecuteTemplate(os.Stdout, \"two\", nil); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/8GYU1kh6CK\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>I'm #2, including #1: I'm #1.\n</code></pre>\n\n<p>Also see related question: <a href=\"https://stackoverflow.com/questions/41176355/go-template-name/41187671#41187671\">Go template name</a></p>\n\n<h2>Note</h2>\n\n<p>While we could call the <a href=\"https://golang.org/pkg/html/template/#Template.Parse\" rel=\"nofollow noreferrer\"><code>Template.Parse()</code></a> method on a single template multiple times, and it would parse multiple <em>named</em> templates properly, it is still advisable to acquire a new <a href=\"https://golang.org/pkg/html/template/#Template\" rel=\"nofollow noreferrer\"><code>template.Template</code></a> for each by calling <code>Template.New()</code>. Because if the template texts have content <em>outside</em> of named templates, they will be overwritten and only the last would be retained. For example: <code>abc {{define \"one\"}}no 1{{end}}</code>. The static text <code>\"abc\"</code> would be lost by a subsequent <code>Template.Parse()</code> call.</p>\n\n<p>This is also noted in the doc of <code>Template.Parse()</code>:</p>\n\n<blockquote>\n  <p>(In multiple calls to Parse with the same receiver template, only one call can contain text other than space, comments, and template definitions.)</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485362913, "post_id": 41856481, "comment_id": 70897933, "body": "While this may be used to parse multiple <i>named</i> templates, without acquiring a new <code>template.Template</code> for each by calling <code>Template.New()</code>, if the template texts have content <i>outside</i> of named templates, they will be overwritten and only the last will be retained. Example: <code>abc {{define &quot;one&quot;}}no 1{{end}}</code>. The static text <code>&quot;abc&quot;</code> would be lost by a subsequent <code>Parse()</code>. See my answer for details."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485363639, "post_id": 41856481, "comment_id": 70898447, "body": "@icza Yes, your answer is more exact and detailed for sure. I only show the way it can be done."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1485361014, "creation_date": 1485361014, "answer_id": 41856481, "question_id": 41856021, "link": "https://stackoverflow.com/questions/41856021/how-to-parse-multiple-strings-into-a-template-with-go/41856481#41856481", "title": "How to parse multiple strings into a template with Go?", "body": "<p>Maybe</p>\n\n<pre><code>for _, templ := range ListOfPagesTemplates{\n    YourBaseTemplate.Parse(templ)\n}\n</code></pre>\n\n<p>err check absent for simplicity of reading</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2024, "favorite_count": 1, "accepted_answer_id": 41856364, "answer_count": 2, "score": 3, "last_activity_date": 1557312092, "creation_date": 1485359737, "last_edit_date": 1557312092, "question_id": 41856021, "link": "https://stackoverflow.com/questions/41856021/how-to-parse-multiple-strings-into-a-template-with-go", "title": "How to parse multiple strings into a template with Go?", "body": "<p>Is there a simple way like <code>template.ParseFiles(\"base.html\", \"home.html\")</code> but for strings to build a template from a set of strings?</p>\n\n<p>I have a base template and a list of pages templates (all as strings) that I want to build on top of base template.</p>\n\n<p>I figured out how to merge them, but I my solution is quite verbose and doesn't look elegant enough, even though working.</p>\n"}, {"tags": ["r", "go", "rserve"], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 2801352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0aa9a384321091d9503d7fd3ce566?s=128&d=identicon&r=PG&f=1", "display_name": "user2801352", "link": "https://stackoverflow.com/users/2801352/user2801352"}, "is_accepted": true, "score": 0, "last_activity_date": 1538049639, "creation_date": 1538049639, "answer_id": 52536540, "question_id": 41855820, "link": "https://stackoverflow.com/questions/41855820/executing-r-scripts-from-golang-using-rserve-and-roger/52536540#52536540", "title": "executing R scripts from golang using Rserve and Roger", "body": "<p>Change:</p>\n\n<pre><code>jsonx, err := rClient.Eval(\"parse(as.character(\" + param + \",\" + param2 \"))\")\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>jsonx, err := rClient.Eval(\"parse(as.character(\" + param + \"),as.character(\" + param2 + \"))\")\n</code></pre>\n\n<p>For anyone like myself getting into R and integrating with Go, it can be a bit daunting. So I hope this helps someone.</p>\n"}], "owner": {"reputation": 25, "user_id": 5952063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa00991540a633542e189813bf26539?s=128&d=identicon&r=PG&f=1", "display_name": "Harris", "link": "https://stackoverflow.com/users/5952063/harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 52536540, "answer_count": 1, "score": 1, "last_activity_date": 1538049639, "creation_date": 1485359209, "last_edit_date": 1485361208, "question_id": 41855820, "link": "https://stackoverflow.com/questions/41855820/executing-r-scripts-from-golang-using-rserve-and-roger", "title": "executing R scripts from golang using Rserve and Roger", "body": "<p>how can i execute a function from a R script via Rserve from golang using Roger...</p>\n\n<p>If a function requires no arguments or just one argument, it works fine..\nThe problem comes when the function take two arguments. </p>\n\n<p>Golang</p>\n\n<pre><code>//using backticks works fine too\nparam := \"'hello'\"\nparam2 := \"'World'\"\njsonx, err := rClient.Eval(\"parse(as.character(\" + param + \",\" + param2 \"))\")\nif err != nil {\n    s := fmt.Sprintf(\"%s %s\", \"Error occured : \", err.Error())\n    log.Println(s)\n    return\n}\n</code></pre>\n\n<p>R script </p>\n\n<pre><code>//simple\nparse &lt;- function(xx, nx) {\n    print(xx)\n    print(nx) \n    return(nx)\n}\n</code></pre>\n\n<p>the first parameter is assigned hello but the second give an error that no default is set from the Rserve side..\nHow can i call a function that requires two or more parameters from golang</p>\n"}, {"tags": ["json", "go", "active-directory", "ldap", "httphandler"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1485355946, "post_id": 41854398, "comment_id": 70892934, "body": "This doesn&#39;t make sense for a couple reasons. The <code>ldapConn</code> function will get called before your handler, so those variables won&#39;t be set. This also doesn&#39;t try to take into account what happens with concurrent calls to the handler. Just declare the variables and call the auth function in the handler. You also don&#39;t have an http server, so nothing could call your handler, and your program just exits."}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485356177, "post_id": 41854398, "comment_id": 70893087, "body": "I&#39;m just listening on Localhost.  When I curl local host with a json my handler is picking it up just fine.  I don&#39;t seem to be able to call any functions inside the handler.  When I try a simple fmt.PrintLn I get nothing in the console."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485356343, "post_id": 41854398, "comment_id": 70893208, "body": "sorry, I missed the ListenAndServe, so you have an http server, so you never get to the <code>ldapConn</code> call because you&#39;re blocking there. function calls work exactly the same in a handler as anywhere else, you&#39;ll have to show an example of what&#39;s not working for you."}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485356895, "post_id": 41854398, "comment_id": 70893578, "body": "I seriously just got it to start allowing fmt.Println() inside of the handler.  Grrrr....  ok.  I am going to move my function calls to LDAP inside of the handler and try that now."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485357023, "post_id": 41854398, "comment_id": 70893672, "body": "Make sure you move the associated variable declarations inside the handler as well to avoid the race conditions."}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485357465, "post_id": 41854398, "comment_id": 70893985, "body": "It worked.  Thanks for your help.  Now I need to figure out how to use those variables to authenticate to AD and return the user&#39;s groups."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485356973, "post_id": 41854926, "comment_id": 70893629, "body": "All http handlers are inherently concurrent. You cannot access global variables without synchronization from within an http handler."}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485383999, "post_id": 41854926, "comment_id": 70909761, "body": "@JimB sorry I have edited my answer since it was really late for me so I dont have much time to edit it. yeah it was a mistake"}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1485384549, "last_edit_date": 1495541340, "creation_date": 1485356840, "answer_id": 41854926, "question_id": 41854398, "link": "https://stackoverflow.com/questions/41854398/in-golang-how-do-i-get-the-handlefunc-function-to-parse-a-json-into-variables/41854926#41854926", "title": "In GoLang How do I get the HandleFunc() function to parse a json into variables accesible outside of the function", "body": "<blockquote>\n  <p>How do I get the HandleFunc() function to parse a json into variables\n  accesible outside of the function?</p>\n</blockquote>\n\n<p>from your question I don't think you can return the json value here. Instead you could pass the struct to a function and call them inside it.\nfor example : </p>\n\n<pre><code>//Handle Http request and parse json\n     http.HandleFunc(\"/\", func(w http.ResponseWriter, request *http.Request) {\n            var m Message\n\n            if request.Body == nil {\n            http.Error(w, \"Please send a request body\", 400)                \n            return\n            }\n\n            err := json.NewDecoder(request.Body).Decode(&amp;m)\n            if err != nil {\n                http.Error(w, err.Error(), 400)\n                return\n            }\n            // Not sure what to do here\n            // pass the variable to your function\n            uname = m.User\n            pwd = m.Password\n\n            // passed your struct to a function here and do your logic there.\n            yourFunction(m)\n        })\n</code></pre>\n\n<p>and you can write <code>yourFunction(m Message)</code> in another package or the same package as you define your handler. for example writing <code>yourFunction()</code> would be : </p>\n\n<pre><code>func yourFunction(m Message){\n   // do your logic here\n}\n</code></pre>\n\n<p>if function is in another package </p>\n\n<pre><code>//call your package where your struct is defined.\nfunc yourFunction(m main.Message){\n   // do your logic here\n}\n</code></pre>\n\n<p>as <a href=\"https://stackoverflow.com/users/32880/jimb\">JimB</a> said. You're calling your <code>ldapConn</code> after <code>ListenAndServe</code> those lines would never be executed since it is blocked.</p>\n\n<p>and if you like to print your app is started or failed. I think this code will help you : </p>\n\n<pre><code>    log.Println(\"App started on port = \", port)\n    err := http.ListenAndServe(\":\"+port, nil)\n    if err != nil {\n        log.Panic(\"App Failed to start on = \", port, \" Error : \", err.Error())\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": true, "score": 1, "last_activity_date": 1485423774, "creation_date": 1485423774, "answer_id": 41870596, "question_id": 41854398, "link": "https://stackoverflow.com/questions/41854398/in-golang-how-do-i-get-the-handlefunc-function-to-parse-a-json-into-variables/41870596#41870596", "title": "In GoLang How do I get the HandleFunc() function to parse a json into variables accesible outside of the function", "body": "<p>You can't access the variables not because Go namespaces not allow it but because <code>ListenAndServe</code> is blocking and <code>ldapConn</code> could be called only if the server is stopped.</p>\n\n<pre><code> log.Fatal(http.ListenAndServe(\":\" + SERVICE_PORT, nil))\n // Blocked until the server is listening and serving.\n\n connected := ldapConn(LDAP_SERVER_DOMAIN, uname, pwd)\n</code></pre>\n\n<p>A more correct approach is to call <code>ldapConn</code> inside <code>http.HandleFunc</code> callback.</p>\n\n<pre><code> http.HandleFunc(\"/\", func(w http.ResponseWriter, request *http.Request) {\n        var m Message\n\n        if request.Body == nil {\n            http.Error(w, \"Please send a request body\", 400)                \n            return\n        }\n\n        err := json.NewDecoder(request.Body).Decode(&amp;m)\n        if err != nil {\n            http.Error(w, err.Error(), 400)\n            return\n        }\n\n        connected := ldapConn(LDAP_SERVER_DOMAIN, m.User, m.Password)\n        if connected == true {\n            fmt.Println(\"Connected is\", connected)\n        }\n })\n\n log.Fatal(http.ListenAndServe(\":\" + SERVICE_PORT, nil))\n</code></pre>\n"}], "owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1712, "favorite_count": 0, "accepted_answer_id": 41870596, "answer_count": 2, "score": -2, "last_activity_date": 1485423774, "creation_date": 1485355365, "question_id": 41854398, "link": "https://stackoverflow.com/questions/41854398/in-golang-how-do-i-get-the-handlefunc-function-to-parse-a-json-into-variables", "title": "In GoLang How do I get the HandleFunc() function to parse a json into variables accesible outside of the function", "body": "<p>I am trying to create a service using golang that will listen on a port for a post request containing json and would like to parse out the username and password fields of the json and save those as variables to be used outside of the function to authenticate to Active Directory.\nI am using the HandleFunc() fucntion, but cannot ficure out how to access the variables outside of the function.  I tried creating a return, but it wouldn't build.  How do I properly create the variables and then use them outside of the function?</p>\n\n<pre><code> package main\n\n import (\n         \"gopkg.in/ldap.v2\"\n         \"fmt\"\n         \"net/http\"\n         \"os\"\n         \"encoding/json\"\n         \"log\"\n         \"crypto/tls\"\n         \"html\"\n\n )\n\n type Message struct {\n     User string \n     Password string \n }\n\n func main() {\n     const SERVICE_PORT = \"8080\"\n\n\n     var uname string\n     var pwd string\n\n     LDAP_SERVER_DOMAIN := os.Getenv(\"LDAP_DOM\")\n     if LDAP_SERVER_DOMAIN == \"\" {\n        LDAP_SERVER_DOMAIN = \"192.168.10.0\" \n     }\n\n\n     //Handle Http request and parse json\n     http.HandleFunc(\"/\", func(w http.ResponseWriter, request *http.Request) {\n            var m Message\n\n            if request.Body == nil {\n            http.Error(w, \"Please send a request body\", 400)                \n            return\n            }\n\n            err := json.NewDecoder(request.Body).Decode(&amp;m)\n            if err != nil {\n                http.Error(w, err.Error(), 400)\n                return\n            }\n            // Not sure what to do here\n            uname = m.User\n            pwd = m.Password\n        })\n\n     log.Fatal(http.ListenAndServe(\":\" + SERVICE_PORT, nil))\n\n     connected := ldapConn(LDAP_SERVER_DOMAIN, uname, pwd)\n\n     if connected == true {\n        fmt.Println(\"Connected is\", connected)\n     }\n\n\n }\n\n\n// Connects to the ldap server and returns true if successful\n func ldapConn(dom, user, pass string) bool {\n    // For testing go insecure\n    tlsConfig := &amp;tls.Config{InsecureSkipVerify: true}\n\n    conn, err := ldap.DialTLS(\"tcp\", dom, tlsConfig)\n    if err != nil {\n        // error in connection\n        log.Println(\"ldap.DialTLS ERROR:\", err)\n\n        //debug\n        fmt.Println(\"Error\", err)\n\n        return false\n    }\n    defer conn.Close()\n    err = conn.Bind(user, pass)\n    if err != nil {\n        // error in ldap bind\n        log.Println(err)\n\n        //debug\n        log.Println(\"conn.Bind ERROR:\", err)\n\n        return false\n    }\n    return true\n}\n</code></pre>\n"}, {"tags": ["go", "hyperledger-fabric"], "comments": [{"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "edited": false, "score": 0, "creation_date": 1485350408, "post_id": 41852596, "comment_id": 70888942, "body": "Please provide more information ( code )."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485350530, "post_id": 41852596, "comment_id": 70889026, "body": "if <code>SimpleChaincode</code>  is a custom struct implement ` Init(shim.ChaincodeStubInterface) ([]byte, error)` function"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7461812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a76cc77f34d602c2ab9f4b9b1e2c6?s=128&d=identicon&r=PG&f=1", "display_name": "VrushaliMphatek", "link": "https://stackoverflow.com/users/7461812/vrushalimphatek"}, "edited": false, "score": 0, "creation_date": 1488262144, "post_id": 42101551, "comment_id": 72141018, "body": "Thank you DazWilkin. I will check my Fabric version and try again."}], "tags": [], "owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1486508043, "creation_date": 1486508043, "answer_id": 42101551, "question_id": 41852596, "link": "https://stackoverflow.com/questions/41852596/error-in-go-compilation-cannot-use-newsimplechaincode/42101551#42101551", "title": "Error in Go Compilation : cannot use new(SimpleChaincode)", "body": "<p>I think this guidance from the hyperledger folks should help:</p>\n\n<p><a href=\"https://github.com/IBM-Blockchain/learn-chaincode/blob/master/docs/setup.md#hyperledger-fabric\" rel=\"nofollow noreferrer\">https://github.com/IBM-Blockchain/learn-chaincode/blob/master/docs/setup.md#hyperledger-fabric</a></p>\n\n<p>The issue is that there are mutually incompatible releases of hyperledger.</p>\n\n<p>I think (!) for Bluemix, you will need v0.5</p>\n"}], "owner": {"reputation": 1, "user_id": 7461812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a76cc77f34d602c2ab9f4b9b1e2c6?s=128&d=identicon&r=PG&f=1", "display_name": "VrushaliMphatek", "link": "https://stackoverflow.com/users/7461812/vrushalimphatek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1486508043, "creation_date": 1485350148, "last_edit_date": 1485350457, "question_id": 41852596, "link": "https://stackoverflow.com/questions/41852596/error-in-go-compilation-cannot-use-newsimplechaincode", "title": "Error in Go Compilation : cannot use new(SimpleChaincode)", "body": "<p>While compiling an application of the 'DemoChainCode' from IBM Bluemix docs I'm continously getting this error :                                      </p>\n\n<p><code>.\\Asgn5.go:28: cannot use new(SimpleChaincode) (type *SimpleChaincode) as type s him.Chaincode in argument to shim.Start:\n  *SimpleChaincode does not implement shim.Chaincode (wrong type for Initmethod)\n  have Init(shim.ChaincodeStubInterface, string, []string) ([]byte, error)\n  want Init(shim.ChaincodeStubInterface) ([]byte, error)</code></p>\n\n<p>What could be going wrong here?</p>\n"}, {"tags": ["python", "python-3.x", "go", "escaping", "jinja2"], "answers": [{"tags": [], "owner": {"reputation": 538898, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1485351331, "creation_date": 1485351331, "answer_id": 41853018, "question_id": 41852574, "link": "https://stackoverflow.com/questions/41852574/escaping-double-quotes-while-rendering-in-jinja2/41853018#41853018", "title": "Escaping double quotes while rendering in Jinja2", "body": "<p>This is due to Jinja2 autoescaping. As described in <a href=\"http://flask.pocoo.org/docs/0.12/templating/#controlling-autoescaping\" rel=\"nofollow noreferrer\">the documentation</a>, the recommended way to avoid this is to wrap the text in a <code>Markup</code> object.</p>\n"}, {"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 21, "last_activity_date": 1485354236, "creation_date": 1485354236, "answer_id": 41854018, "question_id": 41852574, "link": "https://stackoverflow.com/questions/41852574/escaping-double-quotes-while-rendering-in-jinja2/41854018#41854018", "title": "Escaping double quotes while rendering in Jinja2", "body": "<p>The alternative way to do this would have been</p>\n\n<pre><code>e.({{ function|safe }})\n</code></pre>\n\n<p>which prevents auto-escaping.</p>\n"}], "owner": {"reputation": 113, "user_id": 7257420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1S6Bf.jpg?s=128&g=1", "display_name": "Cris Motinha", "link": "https://stackoverflow.com/users/7257420/cris-motinha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16733, "favorite_count": 3, "accepted_answer_id": 41854018, "answer_count": 2, "score": 11, "last_activity_date": 1485354236, "creation_date": 1485350075, "last_edit_date": 1485351237, "question_id": 41852574, "link": "https://stackoverflow.com/questions/41852574/escaping-double-quotes-while-rendering-in-jinja2", "title": "Escaping double quotes while rendering in Jinja2", "body": "<p>I'm using Jinja2 to create Golang code using Python3. I need to pass some parameters in quotes to a function in my final code, but Jinja2 isn't escaping double quotes.\nMy python code is something like:</p>\n\n<pre><code>list_s = ['a', 'b']\nstring = '\\\"' + '\", \"'.join(list_s) + '\\\"'\nfinal_string = 'Function(' + string + ')'\nprint(final_string)\n\ntemplate.render({'function': final_string})\n</code></pre>\n\n<p>My template is:</p>\n\n<pre><code>e.({{function}})\n</code></pre>\n\n<p>What I'm getting in the console (the print in the python code):</p>\n\n<pre><code>Function(\"a\", \"b\")\n</code></pre>\n\n<p>What I wanted in my final code in Go:</p>\n\n<pre><code>e.(Function(\"a\", \"b\"))\n</code></pre>\n\n<p>What I'm actually getting in my final code:</p>\n\n<pre><code>e.(Function(&amp;#34;a&amp;#34;, &amp;#34;b&amp;#34;))\n</code></pre>\n\n<p>I've already tried:</p>\n\n<pre><code>'`\\\"`' , '`\"`', \"'\\\"'\", \"\\\\\\\"\", \"\\N{Quotation Mark}\"\n</code></pre>\n\n<p>And none of them worked as I wanted. Any ideas?</p>\n\n<p>Thank you :))</p>\n\n<p><strong>\"Solved\":</strong></p>\n\n<p>I changed from double quotes to `, so my python code now is:</p>\n\n<pre><code>string = '`' + '`, `'.join(list_s) + '`'\n</code></pre>\n\n<p>And my final Go code is:</p>\n\n<pre><code>e.(Function(`a`, `b`))\n</code></pre>\n\n<p>And this works on Go. It isn't the best solution but it is working...</p>\n"}, {"tags": ["dictionary", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1485347773, "last_edit_date": 1485347773, "creation_date": 1485347410, "answer_id": 41851720, "question_id": 41851566, "link": "https://stackoverflow.com/questions/41851566/practical-way-to-set-and-sequentially-increment-a-value-inside-a-map/41851720#41851720", "title": "practical way to set and sequentially increment a value inside a map?", "body": "<p>You're only incrementing the <code>breadTotal</code> local variable, and not the value in the <code>store</code> map. It should be:</p>\n\n<pre><code>store[\"bread\"] = breadTotal + num\n</code></pre>\n\n<p>Also you can simply do:</p>\n\n<pre><code>store[\"bread\"] += num\n</code></pre>\n\n<p>Also since indexing a map returns the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">zero value</a> of the value type for keys which are not yet in the map (zero value for <code>int</code> is <code>0</code> \u2013 properly telling no bread yet), that <code>if</code> is completely unnecessary. You can simply do:</p>\n\n<pre><code>func breadArrived(num int) {\n    store[\"bread\"] += num\n    fmt.Printf(\"%v\\n\", store)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/LQzrbSZudH\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[bread:1]\nmap[bread:3]\nmap[bread:6]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 376, "user_id": 899843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2156758e4d22a4dc2a4df09d51931e8e?s=128&d=identicon&r=PG", "display_name": "Josh Lubawy", "link": "https://stackoverflow.com/users/899843/josh-lubawy"}, "is_accepted": false, "score": 3, "last_activity_date": 1485347667, "creation_date": 1485347667, "answer_id": 41851803, "question_id": 41851566, "link": "https://stackoverflow.com/questions/41851566/practical-way-to-set-and-sequentially-increment-a-value-inside-a-map/41851803#41851803", "title": "practical way to set and sequentially increment a value inside a map?", "body": "<p>The <code>breadTotal</code> variable is only a copy of the <code>map</code> integer value, you need to reference it as <code>store[\"bread\"] += num</code> to increment the <code>map</code> integer value.</p>\n\n<p><a href=\"https://play.golang.org/p/LQzrbSZudH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LQzrbSZudH</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar store = map[string]int{}\n\nfunc breadArrived(num int) {\n    store[\"bread\"] += num\n    fmt.Printf(\"%v\\n\", store)\n}\n\nfunc main() {\n    breadArrived(1)\n    breadArrived(2)\n    breadArrived(3)\n}\n</code></pre>\n\n<p>By the way, the first incrementing of the <code>map</code> integer works because go initializes everything to a default value, in the case of integers the default value is <code>0</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 10260, "user_id": 7939871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1199ba5dde05e4083823a058c5ac6bed?s=128&d=identicon&r=PG", "display_name": "L&#233;a Gris", "link": "https://stackoverflow.com/users/7939871/l%c3%a9a-gris"}, "edited": false, "score": 0, "creation_date": 1566837673, "post_id": 57661535, "comment_id": 101772579, "body": "A bit of explanation alongside your code would be welcome."}], "tags": [], "owner": {"reputation": 101, "user_id": 7461978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YT8tp.jpg?s=128&g=1", "display_name": "Arseny", "link": "https://stackoverflow.com/users/7461978/arseny"}, "is_accepted": false, "score": 1, "last_activity_date": 1566839670, "last_edit_date": 1566839670, "creation_date": 1566836351, "answer_id": 57661535, "question_id": 41851566, "link": "https://stackoverflow.com/questions/41851566/practical-way-to-set-and-sequentially-increment-a-value-inside-a-map/57661535#57661535", "title": "practical way to set and sequentially increment a value inside a map?", "body": "<p>Simple increment like C\\C++ style:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar store = map[string]int{}\n\nfunc main() {\n    store[\"some_key\"] = 0\n    if _, found:= store[\"some_key\"]; found{\n        fmt.Println(store[\"some_key\"])\n        store[\"some_key\"]++\n        fmt.Println(store[\"some_key\"])\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nyM7GFI1-GW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/nyM7GFI1-GW</a></p>\n"}], "owner": {"reputation": 2534, "user_id": 898099, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fde4e02f49a0c28e3a287e86aec38af3?s=128&d=identicon&r=PG", "display_name": "Aleksandr Makov", "link": "https://stackoverflow.com/users/898099/aleksandr-makov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7830, "favorite_count": 1, "accepted_answer_id": 41851720, "answer_count": 3, "score": 4, "last_activity_date": 1575669514, "creation_date": 1485346980, "last_edit_date": 1575669514, "question_id": 41851566, "link": "https://stackoverflow.com/questions/41851566/practical-way-to-set-and-sequentially-increment-a-value-inside-a-map", "title": "practical way to set and sequentially increment a value inside a map?", "body": "<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar store = map[string]int{}\n\nfunc breadArrived(num int) {\n    if breadTotal, ok := store[\"bread\"]; ok {\n        breadTotal += num\n    } else {\n        store[\"bread\"] = num\n    }\n    fmt.Printf(\"%v\\n\", store)\n}\n\nfunc main() {\n    breadArrived(1)\n    breadArrived(2)\n    breadArrived(3)\n}\n</code></pre>\n\n<p>Code above ignores the <code>+=</code> operator, so <code>store[\"bread\"]</code> always equals to <code>1</code>. I assume I'm missing something like \"passing by reference\" here. Also, is there any more convenient way of doing this?</p>\n"}, {"tags": ["go", "time", "timer"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 3, "last_activity_date": 1485345119, "creation_date": 1485345119, "answer_id": 41850944, "question_id": 41850612, "link": "https://stackoverflow.com/questions/41850612/how-timers-work-in-golang/41850944#41850944", "title": "How timers work in Golang", "body": "<p>It's because of for loop. Each circle of loop RightHandSide of <code>case &lt;-time.After(3 * time.Second):</code> in <code>select</code> statement evaluated and give you fresh timer. For example this way things should work</p>\n\n<pre><code>stop := time.After(3 * time.Second)\nfor {\n    select {\n        case &lt;-stop:\n            fmt.Println(\"EXIT: 3 seconds\")\n            return\n        case &lt;-time.After(1 * time.Second):\n            fmt.Println(i, \"second\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7265, "user_id": 3457177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bae2e85ed6794ece744ee124d9ac7842?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/3457177/vitalii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1059, "favorite_count": 0, "closed_date": 1485346007, "accepted_answer_id": 41850944, "answer_count": 1, "score": 0, "last_activity_date": 1485345119, "creation_date": 1485344129, "last_edit_date": 1485344903, "question_id": 41850612, "link": "https://stackoverflow.com/questions/41850612/how-timers-work-in-golang", "closed_reason": "Duplicate", "title": "How timers work in Golang", "body": "<p>I'm trying to undersand channels in Go. There is a simple code </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(1)\n\n    go func() {\n        defer wg.Done()\n\n        i := 0\n\n        for {\n            select {\n            case &lt;-time.After(3 * time.Second):\n                fmt.Println(\"EXIT: 3 seconds\")\n                return\n            case &lt;-time.After(1 * time.Second):\n                fmt.Println(i, \"second\")\n        }\n        i++\n    }\n}()\n\nwg.Wait()\n}\n</code></pre>\n\n<p>I expect console result like this</p>\n\n<pre><code>0 second\n1 second\n2 second\nEXIT: 3 seconds\n</code></pre>\n\n<p>But actually it is like this </p>\n\n<pre><code>0 second\n1 second\n2 second\n3 second\n4 second\n5 second\n6 second\n...\n</code></pre>\n\n<p>What am I missing with this timer and how can I fix a problem?</p>\n"}, {"tags": ["mysql", "database", "go", "microservices"], "comments": [{"owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "edited": false, "score": 1, "creation_date": 1485344478, "post_id": 41850142, "comment_id": 70885223, "body": "I am a bit confused what your definition of &#39;microservice&#39; is. When you say &#39;microservice&#39; do you mean a single instance of an application?"}, {"owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "edited": false, "score": 0, "creation_date": 1485344518, "post_id": 41850142, "comment_id": 70885244, "body": "Where are you typing <code>service migrate</code>? How is this done?"}, {"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "reply_to_user": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "edited": false, "score": 0, "creation_date": 1485349025, "post_id": 41850142, "comment_id": 70888001, "body": "@HenryTK I extend it."}], "answers": [{"comments": [{"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 0, "creation_date": 1485523909, "post_id": 41855411, "comment_id": 70972176, "body": "<i>&quot;it can migrate the schema in the code which gorm allows&quot;</i> Can you tell me about more please? Thank you."}], "tags": [], "owner": {"reputation": 1181, "user_id": 818341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f45a2e41581efd75e909a55943eb91?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/818341/arash"}, "is_accepted": false, "score": 2, "last_activity_date": 1485358164, "creation_date": 1485358164, "answer_id": 41855411, "question_id": 41850142, "link": "https://stackoverflow.com/questions/41850142/microservices-centralized-database-model/41855411#41855411", "title": "Microservices centralized database model", "body": "<p>If I understand your question correctly it seems to me that there may be multiple ways to achieve this. </p>\n\n<p>One solution is to have a schema version somewhere in the database that your microservices periodically check. When your database schema changes you can increase the schema version. As a result of this if a service notices that the database schema version is higher than the current schema version of the service it can migrate the schema in the code which <code>gorm</code> allows.</p>\n\n<p>Other options could depend on how you run your microservices. For example if you run them using some orchestration platform (e.g. Kubernetes) you could put the migration code somewhere to run when your service initializes. Then once you update the schema you can force a rolling refresh of your containers which would in turn trigger the migration.</p>\n"}, {"comments": [{"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 0, "creation_date": 1485523839, "post_id": 41865083, "comment_id": 70972123, "body": "I think about the 1. solution and using gRPC, but in this case I don&#39;t have solution for message queue-s what the Kafka providing. Can you write a little bit more details about 3. solution? I don&#39;t understand fully how it have to work. For example I have 3 microservices where each microservice using the same database models. Thank you."}], "tags": [], "owner": {"reputation": 364, "user_id": 1031042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8baa6c262dea5e806976c32c669ac01?s=128&d=identicon&r=PG", "display_name": "kwh", "link": "https://stackoverflow.com/users/1031042/kwh"}, "is_accepted": true, "score": 3, "last_activity_date": 1485398175, "creation_date": 1485398175, "answer_id": 41865083, "question_id": 41850142, "link": "https://stackoverflow.com/questions/41850142/microservices-centralized-database-model/41865083#41865083", "title": "Microservices centralized database model", "body": "<p>If I'm understanding your question correctly, you're trying to still use one MySQL instance but with many microservices.</p>\n\n<p>There are a couple of ways to make an SQL system work:</p>\n\n<ol>\n<li><p>You could create a microservice-type that handles data inserts/reads from the database and take advantage of <a href=\"https://en.wikipedia.org/wiki/Connection_pool\" rel=\"nofollow noreferrer\">connection pooling</a>. And have the rest of your services do all their data read/writes through these services. This will definitely add a bit of extra latency to all your writes/reads and likely be problematic at scale.</p></li>\n<li><p>You could attempt to look for a multi-master SQL solution (e.g. <a href=\"https://www.citusdata.com/\" rel=\"nofollow noreferrer\">CitusDB</a>) that scales easily and you can use a central schema for your database and just make sure to handle edge cases for data insertion (de-deuping etc.)</p></li>\n<li><p>You can use data-streaming architectures like <a href=\"https://kafka.apache.org/\" rel=\"nofollow noreferrer\">Kafka</a> or <a href=\"https://aws.amazon.com/kinesis/\" rel=\"nofollow noreferrer\">AWS Kinesis</a> to transfer your data to your microservices and make sure they only deal with data through these streams. This way, you can de-couple your database from your data.</p></li>\n</ol>\n\n<p>The best way to approach it in my opinion is #3. This way, you won't have to think about your storage at the computation layer of your microservice architecture.</p>\n\n<p>Not sure what service you're using for your microservices, but <a href=\"https://stdlib.com\" rel=\"nofollow noreferrer\">StdLib</a> forces a few conversions (e.g. around only transferring data through HTTP) that helps folks wrap their head around it all. AWS Lambda also works very well with Kinesis as a source to launch the function which could help with the #3 approach.</p>\n\n<p>Disclaimer: I'm the founder of <a href=\"https://stdlib.com\" rel=\"nofollow noreferrer\">StdLib</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 7053435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4c9d506a9a6211f9f544226a23e392?s=128&d=identicon&r=PG&f=1", "display_name": "Eric McWhorter", "link": "https://stackoverflow.com/users/7053435/eric-mcwhorter"}, "is_accepted": false, "score": 4, "last_activity_date": 1563980841, "creation_date": 1563980841, "answer_id": 57186041, "question_id": 41850142, "link": "https://stackoverflow.com/questions/41850142/microservices-centralized-database-model/57186041#57186041", "title": "Microservices centralized database model", "body": "<p>Depending on your use cases, <a href=\"https://dev.mysql.com/downloads/cluster/\" rel=\"nofollow noreferrer\">MySQL Cluster</a> might be an option.  <a href=\"https://forums.mysql.com/read.php?25,248914\" rel=\"nofollow noreferrer\">Two phase commits</a> used by MySQL Cluster make frequent writes impractical, but if write performance isn't a big issue then I would expect MySQL Cluster would work out better than connection pooling or queuing hacks.  Certainly worth considering.</p>\n"}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2489, "favorite_count": 1, "accepted_answer_id": 41865083, "answer_count": 3, "score": 4, "last_activity_date": 1594475074, "creation_date": 1485342830, "last_edit_date": 1594475074, "question_id": 41850142, "link": "https://stackoverflow.com/questions/41850142/microservices-centralized-database-model", "title": "Microservices centralized database model", "body": "<p>Currently we have some <a href=\"https://en.wikipedia.org/wiki/Microservices\" rel=\"nofollow noreferrer\">microservice</a>, they have their own database model and migration what provided by GORM Golang package. We have a big old MySQL database which is against the microservices laws, but we can't replace it. Im afraid when the microservices numbers start to growing, we will be lost in the many database model. When I add a new column in a microservice I just type <code>service migrate</code> to the terminal (because there is a cli for run and migrate commands), and it is refresh the database.</p>\n<p>What is the best practice to manage it. For example I have 1000 microservice, noone will type the <code>service migrate</code> when someone refresh the models. I thinking about a centralized database service, where we just add a new column and it will store all the models with all migration. The only problem, how will the services get to know about database model changes. This is how we store for example a user in a service:</p>\n<pre><code>type User struct {\n    ID        uint           `gorm:&quot;column:id;not null&quot; sql:&quot;AUTO_INCREMENT&quot;`\n    Name      string         `gorm:&quot;column:name;not null&quot; sql:&quot;type:varchar(100)&quot;`\n    Username  sql.NullString `gorm:&quot;column:username;not null&quot; sql:&quot;type:varchar(255)&quot;`\n}\n\nfunc (u *User) TableName() string {\n    return &quot;users&quot;\n}\n</code></pre>\n"}, {"tags": ["go", "web-applications"], "comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1485338252, "post_id": 41847444, "comment_id": 70881029, "body": "If you have just one process of your app then it is fine otherwise you may need to figure out a way such that all the processes get to know that product was updated as this will only be done by one of the process."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1485346072, "last_edit_date": 1485346072, "creation_date": 1485335992, "answer_id": 41847674, "question_id": 41847444, "link": "https://stackoverflow.com/questions/41847444/should-i-keep-cached-data-in-memory-for-a-webapp/41847674#41847674", "title": "Should I keep cached data in memory for a webapp?", "body": "<p>If:</p>\n\n<ul>\n<li>you need the stats frequently (number of products in each category)<br>\nand / or acquiring the stats takes relatively long time / load</li>\n<li>and product update is \"infrequent\" (compared to how frequently you need the stats)</li>\n</ul>\n\n<p>then yes, it is worth keeping it in memory. Every time a product is updated, you may invalidate the cached data and let it calculated again deferred (when it is needed) or calculate the new stats right away, after the update.</p>\n\n<p>Things to keep in mind:</p>\n\n<ul>\n<li>access to these stats should be synchronized as web requests are served on multiple goroutines</li>\n<li>if you have multiple server instances, these stats might become inaccurate; in this case you do need a central cache like Redis</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "is_accepted": false, "score": 0, "last_activity_date": 1485336625, "creation_date": 1485336625, "answer_id": 41847907, "question_id": 41847444, "link": "https://stackoverflow.com/questions/41847444/should-i-keep-cached-data-in-memory-for-a-webapp/41847907#41847907", "title": "Should I keep cached data in memory for a webapp?", "body": "<blockquote>\n  <p>Is it a correct and common way to optimize the app?</p>\n</blockquote>\n\n<p>I believe it is more common to use this approach for simple queries which do not yield high amounts of data. Complex queries, or anything which is fetched per user session is better off in a shared cache. As @icza mentioned, having multiple server instances should make you re-think whether your solution is optimal.</p>\n\n<blockquote>\n  <p>Will it add speed to the app in real world?</p>\n</blockquote>\n\n<p>In your case, yes, a little bit.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485346072, "creation_date": 1485335391, "question_id": 41847444, "link": "https://stackoverflow.com/questions/41847444/should-i-keep-cached-data-in-memory-for-a-webapp", "title": "Should I keep cached data in memory for a webapp?", "body": "<p>I have a database where products are kept.</p>\n\n<p>There is also a list of categories. </p>\n\n<p>Each product belongs to a category.</p>\n\n<p>When a list of products updates, I run a function <code>updateProductsCategories()</code> that queries database, calculates a number of products in each category and returns a list like this:</p>\n\n<pre><code>Food:    20\nDrinks:  74\nJackets: 15 \n</code></pre>\n\n<p>I use this list in a web page sidebar to show categories as links with amount of products in it.</p>\n\n<p>My assumption is that I should run <code>updateProductsCategories()</code> as it is when products change, though not call it each time a page loads, but put its result in an in-memory object and get data from it to show on the page.</p>\n\n<p>That way I will not make unnecessary db queries every time I show the page, but will use cached data and will have it always up-to-date as it's refreshed when products change.</p>\n\n<p>As the object is not large, I don't think I need any additional solutions like Redis now.</p>\n\n<p>Is it a correct and common way to optimize the app? Will it add speed to the app in real world?</p>\n"}, {"tags": ["go", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 2945940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bbd95bb0d1468cd30e4f0edc1c47790?s=128&d=identicon&r=PG&f=1", "display_name": "Kaizhe Huang", "link": "https://stackoverflow.com/users/2945940/kaizhe-huang"}, "is_accepted": true, "score": 5, "last_activity_date": 1485334645, "creation_date": 1485334645, "answer_id": 41847211, "question_id": 41847117, "link": "https://stackoverflow.com/questions/41847117/gomobile-no-exported-names-in-the-package/41847211#41847211", "title": "Gomobile no exported names in the package", "body": "<p>Function <code>requestEndpoint</code> should be changed to <code>RequestEndpoint</code>. The capitalized function is considered as exported within the package.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7018467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/595f76d6f30ba3ad644e064719aa2e47?s=128&d=identicon&r=PG&f=1", "display_name": "minh tri tran", "link": "https://stackoverflow.com/users/7018467/minh-tri-tran"}, "is_accepted": false, "score": 0, "last_activity_date": 1586703135, "creation_date": 1586703135, "answer_id": 61173335, "question_id": 41847117, "link": "https://stackoverflow.com/questions/41847117/gomobile-no-exported-names-in-the-package/61173335#61173335", "title": "Gomobile no exported names in the package", "body": "<p>You should try</p>\n\n<p>$ gomobile bind -target=ios</p>\n\n<p>$ grep request ./Request.framework/*</p>\n"}], "owner": {"reputation": 113, "user_id": 1536511, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b44e01cf35cc139893955876f02559db?s=128&d=identicon&r=PG", "display_name": "Daniel Ruhman", "link": "https://stackoverflow.com/users/1536511/daniel-ruhman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1475, "favorite_count": 0, "accepted_answer_id": 41847211, "answer_count": 2, "score": 2, "last_activity_date": 1586703135, "creation_date": 1485334364, "question_id": 41847117, "link": "https://stackoverflow.com/questions/41847117/gomobile-no-exported-names-in-the-package", "title": "Gomobile no exported names in the package", "body": "<p>I am trying to bind the following code with gomobile to export it as a framework for iOS. I have done this before successfully but for some reason the following code, when I run the bind command gives me the error gomobile: no exported names in the package . The code works when ran as a go script.</p>\n\n<pre><code>   package request\n\nimport (\n    \"net/url\"\n    \"fmt\"\n)\n\nfunc requestEndpoint(number string) string {\n\n    safeNumber := url.QueryEscape(number)\n  url := fmt.Sprintf(\"http://apilayer.net/api/validate?access_key=690a581e85900555754fd7bfa70808b2&amp;number=%s&amp;country_code=&amp;format=1\", safeNumber)\n\n\n   return url\n\n  }\n</code></pre>\n\n<p>Any ideas?\nThanks!</p>\n"}, {"tags": ["go", "base64", "decode"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1485329226, "creation_date": 1485329226, "answer_id": 41845723, "question_id": 41845629, "link": "https://stackoverflow.com/questions/41845629/how-to-url-safe-decode-base64-in-go-encoded-in-perl/41845723#41845723", "title": "How to URL Safe decode Base64 in Go, encoded in Perl?", "body": "<p>Use the <a href=\"https://godoc.org/encoding/base64#RawURLEncoding\" rel=\"noreferrer\">RawURLEncoding</a> when there's no padding:</p>\n\n<pre><code>_, err := b64.RawURLEncoding.DecodeString(str)\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 1737991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e80336e9b7bea4d4de3047f541760ac?s=128&d=identicon&r=PG", "display_name": "Demiurg", "link": "https://stackoverflow.com/users/1737991/demiurg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3888, "favorite_count": 0, "accepted_answer_id": 41845723, "answer_count": 1, "score": 2, "last_activity_date": 1485329226, "creation_date": 1485328861, "question_id": 41845629, "link": "https://stackoverflow.com/questions/41845629/how-to-url-safe-decode-base64-in-go-encoded-in-perl", "title": "How to URL Safe decode Base64 in Go, encoded in Perl?", "body": "<p>I have an URL Safe encoded string (produced by Perl), that I need to decode in Go.\nHere are two programs, in Perl and in Go - Perl works fine, but Go rises error.\nI can't understand it.\nPlease help!</p>\n\n<p>=== Perl code - works fine</p>\n\n<pre><code>#!/usr/bin/env perl\nuse common::sense;\nuse MIME::Base64::URLSafe;\n\nmy $str = 'Oi6cQzmolrUhkgHsNehtj9p_OsasB_6CIeygK0owoxTsXCtVWyQi-7DXxIJiaV-kSc6PGNC6uNz5V0A9QOGCaeCy6PolQY2Lt_v4JM42VEbsuML8guHfMO0ydvbXVcCR-yLfkz5CO0f-P1hVqxJBD8qPvk1t1DRzqmHP41DSfIm_WzlhtITnd_Wjt6E3CFS78HL3XjJlM-QBW9Z_GZgic8y7TlOWFzCRUf2Q-EZschrDi9l81E93XBNKe8knInL_uFN_oK_ob7fjnkGJO54RNn3coVsrzuIoNa6AI6oWLfsaJ5NyQYor5P0';\n\nsay urlsafe_b64decode($str);\n</code></pre>\n\n<p>=== Go code - rises error</p>\n\n<pre><code>package main\n\nimport (\n    b64 \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n    str := \"Oi6cQzmolrUhkgHsNehtj9p_OsasB_6CIeygK0owoxTsXCtVWyQi-7DXxIJiaV-kSc6PGNC6uNz5V0A9QOGCaeCy6PolQY2Lt_v4JM42VEbsuML8guHfMO0ydvbXVcCR-yLfkz5CO0f-P1hVqxJBD8qPvk1t1DRzqmHP41DSfIm_WzlhtITnd_Wjt6E3CFS78HL3XjJlM-QBW9Z_GZgic8y7TlOWFzCRUf2Q-EZschrDi9l81E93XBNKe8knInL_uFN_oK_ob7fjnkGJO54RNn3coVsrzuIoNa6AI6oWLfsaJ5NyQYor5P0\"\n\n    fmt.Println(\"source B64:\", str)\n    _, err := b64.URLEncoding.DecodeString(str)\n\n    if err != nil {\n        fmt.Println(\"error b64:\", err)\n    }\n}\n</code></pre>\n\n<p>=== END</p>\n\n<p>As decode returns truncated result it is impossible to use it in next step.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1485331593, "post_id": 41844710, "comment_id": 70876754, "body": "A workaround depends on what you want to achieve in the end, replace or extract text. You may most probably use <a href=\"https://regex101.com/r/sk3cwV/2\" rel=\"nofollow noreferrer\"><code>(^|[^{])(\\[\\w+\\])([^}]|$)</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1485325912, "creation_date": 1485325912, "answer_id": 41844901, "question_id": 41844710, "link": "https://stackoverflow.com/questions/41844710/go-regex-negative-look-ahead-alternative/41844901#41844901", "title": "Go regex, Negative Look Ahead alternative", "body": "<p>There is no alternative expression for this. Using plain <code>(?:[^{]|^)(...)(?:[^}]|$)</code> to capture the intended match and assert the previous and next characters are not braces will kind-of work: you will need to work with the first capture group instead of with the full match, and it will fail when there is only a single character between two matches (e.g. <code>[foo]_[bar]</code>). The best way, really, is to use <code>FindAllStringSubmatchIndex</code> and manually check the previous and next characters to make sure they are not braces outside of regexp.</p>\n"}], "owner": {"reputation": 1563, "user_id": 1539932, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd6df7fa24163910d5803f3a6e63aa09?s=128&d=identicon&r=PG", "display_name": "hemc4", "link": "https://stackoverflow.com/users/1539932/hemc4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2334, "favorite_count": 0, "accepted_answer_id": 41844901, "answer_count": 1, "score": 0, "last_activity_date": 1485325912, "creation_date": 1485324992, "question_id": 41844710, "link": "https://stackoverflow.com/questions/41844710/go-regex-negative-look-ahead-alternative", "title": "Go regex, Negative Look Ahead alternative", "body": "<p>I am trying to implement the regex <code>(?&lt;!\\\\{)\\\\[[a-zA-Z0-9_]+\\\\](?!\\\\})</code> with go regex. </p>\n\n<p>Match value will be like <code>[ua]</code> and <code>[ua_enc]</code> and unmatched should be <code>{[ua]}</code> and <code>{[ua_enc]}</code></p>\n\n<p>As Negative lookahead is not supported in Go, what may be the alternative expression for this?</p>\n"}, {"tags": ["http", "go", "get", "shopify"], "comments": [{"owner": {"reputation": 2348, "user_id": 4287624, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/KW2iJ.jpg?s=128&g=1", "display_name": "HymnZzy", "link": "https://stackoverflow.com/users/4287624/hymnzzy"}, "edited": false, "score": 0, "creation_date": 1485321026, "post_id": 41843536, "comment_id": 70872196, "body": "try <code>http.Get(&quot;http:&#47;&#47;oneness287-2.myshopify.com&#47;cart&#47;add&#47;2974179&zwnj;&#8203;7961?quantity=1&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1485351699, "post_id": 41844605, "comment_id": 70889829, "body": "Thanks. It makes sense now"}], "tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": true, "score": 2, "last_activity_date": 1485324584, "creation_date": 1485324584, "answer_id": 41844605, "question_id": 41843536, "link": "https://stackoverflow.com/questions/41843536/shopify-add-items-to-cart-using-get-request-working-on-browser-but-not-working-w/41844605#41844605", "title": "Shopify add items to cart using get request working on browser but not working with a golang script", "body": "<p>When you make the request from go code the server creates a new session (basically new cookie) whereas the browser request have its own session, hence the request are not operating on the same cart. If you really want to do this then in the go code you will have to send all the cookies that you have in browser for this particular domain.</p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 41844605, "answer_count": 1, "score": 0, "last_activity_date": 1485324584, "creation_date": 1485319409, "question_id": 41843536, "link": "https://stackoverflow.com/questions/41843536/shopify-add-items-to-cart-using-get-request-working-on-browser-but-not-working-w", "title": "Shopify add items to cart using get request working on browser but not working with a golang script", "body": "<p>I wanted to automate the process of adding items to cart on shopify stores. For example, at <code>http://www.oneness287.com</code> . If you wish to buy <a href=\"https://www.oneness287.com/collections/all/products/jeremy-scott-flames-adidas-slides\" rel=\"nofollow noreferrer\">these</a> size 7.5 , going to <code>http://oneness287-2.myshopify.com/cart/29741797961:1</code> automatically adds the product to my cart and redirects me to the checkout page.</p>\n\n<p>But when I do </p>\n\n<pre><code>http.Get(\"http://oneness287-2.myshopify.com/cart/29741797961:1\")\n</code></pre>\n\n<p>from my golang code, and then check my cart. The cart is still empty. What is different in this case? In the first case I am making the request from the browser, in the second my script is making the request. How do I fix it?</p>\n"}, {"tags": ["arrays", "go", "struct"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 3, "creation_date": 1485320494, "post_id": 41843351, "comment_id": 70872032, "body": "There&#39;s nothing wrong with the way you&#39;re calling <code>append</code> (although there&#39;s no reason to make <code>c</code> a pointer and dereference it in the <code>append</code>). The problem is likely elsewhere in your code. I&#39;m confused about what type <code>args</code> could be so that you can assign elements of  it to both <code>string</code> and <code>int</code> fields."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 1, "creation_date": 1485324548, "post_id": 41843351, "comment_id": 70873541, "body": "You code looks good.Can you please share little bit more of your code.The part of code shared is perfect"}, {"owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 0, "creation_date": 1485360405, "post_id": 41843351, "comment_id": 70896182, "body": "You code appears fine, maybe it is how you are outputting the structure. I can see multiple contact infos when i use your class: <a href=\"https://play.golang.org/p/RFnqe3n_fu\" rel=\"nofollow noreferrer\">play.golang.org/p/RFnqe3n_fu</a>"}], "answers": [{"comments": [{"owner": {"reputation": 578, "user_id": 2618033, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000332706842/picture?type=large", "display_name": "Ben Keil", "link": "https://stackoverflow.com/users/2618033/ben-keil"}, "edited": false, "score": 0, "creation_date": 1526917495, "post_id": 41862573, "comment_id": 87917639, "body": "how can I achieve this if I want?"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 0, "last_activity_date": 1485382123, "creation_date": 1485382123, "answer_id": 41862573, "question_id": 41843351, "link": "https://stackoverflow.com/questions/41843351/append-to-array-of-struct-inside-a-struct/41862573#41862573", "title": "Append to array of struct inside a struct", "body": "<p>The observed behaviour is possible when you are passing object by value into a function or method. The modifications inside those functions will not be visible outside.</p>\n\n<p>See the code below</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype X struct{\n    Y []string\n}\n\nfunc modify(x X) {\n    x.Y = append(x.Y, \"modify\")\n}\n\nfunc (x X) change() {\n    x.Y = append(x.Y, \"modify\")\n}\n\nfunc main() {\n    x := X{}\n    modify(x)\n    x.change()\n    fmt.Printf(\"%+v\\n\", x)\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7424515, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XGwT0JQXTlI/AAAAAAAAAAI/AAAAAAAACjY/H6OlQ-1dwYU/photo.jpg?sz=128", "display_name": "Aditi", "link": "https://stackoverflow.com/users/7424515/aditi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 826, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485382123, "creation_date": 1485318177, "last_edit_date": 1485359687, "question_id": 41843351, "link": "https://stackoverflow.com/questions/41843351/append-to-array-of-struct-inside-a-struct", "title": "Append to array of struct inside a struct", "body": "<pre><code>type Customer struct{\n    UID string     \n    Name string \n    Contact []ContactInfo\n}\ntype ContactInfo struct {\n    Number int\n}\n</code></pre>\n\n<p>There can be multiple customers and each customer can have multiple contact numbers.\nI was using the following approach to append the Contact array of struct for a particular user as follows.</p>\n\n<pre><code>customer := &amp;Customer{}\ncustomer.UID = args[0]\ncustomer.Name = args[1]\nc:= &amp;ContactInfo{}\nc.Number = args[2]\ncustomer.Contact= append(customer.Contact, *c)\n</code></pre>\n\n<p>But this approach isn't working as I only get the latest Contact and not the array of Contact in output.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8863, "user_id": 592235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b07992c174ed5b627e20a32ab9c43ef5?s=128&d=identicon&r=PG", "display_name": "Mike Vella", "link": "https://stackoverflow.com/users/592235/mike-vella"}, "is_accepted": false, "score": 1, "last_activity_date": 1485298935, "creation_date": 1485298935, "answer_id": 41840528, "question_id": 41840066, "link": "https://stackoverflow.com/questions/41840066/strange-pow-implementation-in-golang/41840528#41840528", "title": "Strange pow implementation in golang", "body": "<p>The answer is in the inline documentation for the function, in the case case <code>y &gt; 0</code> then the function output is as follows:</p>\n\n<pre><code>Pow(\u00b10, y) = \u00b10 for y an odd integer &gt; 0\nPow(\u00b10, y) = +0 for finite y &gt; 0 and not an odd integer \n</code></pre>\n\n<p>so the function will only return <code>0</code> <code>(+0)</code> like you say in the case that <code>x=0</code></p>\n"}, {"tags": [], "owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "is_accepted": true, "score": 4, "last_activity_date": 1485306848, "last_edit_date": 1492087555, "creation_date": 1485298951, "answer_id": 41840533, "question_id": 41840066, "link": "https://stackoverflow.com/questions/41840066/strange-pow-implementation-in-golang/41840533#41840533", "title": "Strange pow implementation in golang", "body": "<p>there are two types of zero's, <code>+0</code> and <code>-0</code>. return value of <code>Pow(-0,1)</code> should be <code>-0</code> not <code>+0</code></p>\n\n<p>to create <code>-0</code> in golang, use <code>math.Copysign</code>.</p>\n\n<pre><code>x := math.Copysign(0, -1)\nif x == 0 {\n    fmt.Println(\"x is zero\")\n}\nfmt.Println(\"x ** 3 is\", math.Pow(x, 3))\n</code></pre>\n\n<p>the output of above code is</p>\n\n<pre><code>x is zero\nx ** 3 is -0\n</code></pre>\n\n<p>you can check it in <a href=\"https://play.golang.org/p/8wuZ0EUSgD\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n\n<p>why we have to distinguish <code>+0</code> and <code>-0</code>, see:\n<a href=\"https://softwareengineering.stackexchange.com/questions/280648/why-is-negative-zero-important\">https://softwareengineering.stackexchange.com/questions/280648/why-is-negative-zero-important</a></p>\n"}], "owner": {"reputation": 19680, "user_id": 562222, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jgGXb.jpg?s=128&g=1", "display_name": "qed", "link": "https://stackoverflow.com/users/562222/qed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 1, "accepted_answer_id": 41840533, "answer_count": 2, "score": 4, "last_activity_date": 1485306848, "creation_date": 1485296618, "question_id": 41840066, "link": "https://stackoverflow.com/questions/41840066/strange-pow-implementation-in-golang", "title": "Strange pow implementation in golang", "body": "<p>I just came across <a href=\"https://golang.org/src/math/pow.go\" rel=\"nofollow noreferrer\">the Pow implementation in golang</a>:</p>\n\n<pre><code>func Pow(x, y float64) float64 {\n    // ...\n    case x == 0:\n        switch {\n        case y &lt; 0:\n            if isOddInt(y) {\n                return Copysign(Inf(1), x)\n            }\n            return Inf(1)\n        case y &gt; 0:\n            if isOddInt(y) {\n                return x\n            }\n            return 0\n        }\n    //...\n}\n</code></pre>\n\n<p>Isn't the <code>case y &gt; 0</code> part over complicated? I would just return 0.  Or did I miss something?</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "edited": false, "score": 0, "creation_date": 1485294088, "post_id": 41839443, "comment_id": 70864223, "body": "This is a <a href=\"https://github.com/stanley-cheung/Protobuf-PHP/\" rel=\"nofollow noreferrer\">large library</a> written in PHP while <code>json_encode</code> is written in C++ and has been used by millions and optimized since first added. <code>json_encode</code> will be many times faster than any kind of PHP-based packing-system."}, {"owner": {"reputation": 59, "user_id": 7369139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9efe4d1f468e15af0aeb1f3e721ba37?s=128&d=identicon&r=PG&f=1", "display_name": "mhsc", "link": "https://stackoverflow.com/users/7369139/mhsc"}, "reply_to_user": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "edited": false, "score": 0, "creation_date": 1485294406, "post_id": 41839443, "comment_id": 70864337, "body": "Thanks, that was my guess and it makes a lot of sense. Weighing up the pros and cons of Protobufs is more complicated, because in the end PHP wont be the only client.  From your experience is there any faster way of transmitting in this exact use case than JSON?"}, {"owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "edited": false, "score": 0, "creation_date": 1485308615, "post_id": 41839443, "comment_id": 70869134, "body": "BSON is more compact and used by several database engines. Though it&#39;s just Binary JSON so doesn&#39;t support schemas like Protobufs."}, {"owner": {"reputation": 4055, "user_id": 2598037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWCTo.jpg?s=128&g=1", "display_name": "Carl Mastrangelo", "link": "https://stackoverflow.com/users/2598037/carl-mastrangelo"}, "edited": false, "score": 1, "creation_date": 1485309027, "post_id": 41839443, "comment_id": 70869256, "body": "How are you benchmarking?  Getting accurate, believable benchmark results is notoriously difficult."}, {"owner": {"reputation": 6715, "user_id": 70945, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4ef069c6258d4b4d35c4b3b39425376b?s=128&d=identicon&r=PG&f=1", "display_name": "weismat", "link": "https://stackoverflow.com/users/70945/weismat"}, "edited": false, "score": 0, "creation_date": 1485334469, "post_id": 41839443, "comment_id": 70878495, "body": "What are you exactly comparing? If you will just look at one call, then JSON with raw tcp will be faster than Grpc/Protobuf with http2 as additional overhead.  Grpc will shine and most likely outperform JSON when looking at streaming and many messages/calls."}, {"owner": {"reputation": 59, "user_id": 7369139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9efe4d1f468e15af0aeb1f3e721ba37?s=128&d=identicon&r=PG&f=1", "display_name": "mhsc", "link": "https://stackoverflow.com/users/7369139/mhsc"}, "edited": false, "score": 0, "creation_date": 1485338414, "post_id": 41839443, "comment_id": 70881147, "body": "My benchmark used php&#39;s microtime to calculate the difference in time at the end of a sequence of calls and the time before. I tried for 1, 10, 100, 1000, 10,000, and 100,000 calls. CURL with JSON decode (a C++ extension as explained above) was always faster than Protobuf/gRPC. I fiddled around a lot to try to find a way to make Protobufs faster, even once, thinking my benchmark was simply unreliable. But at no point could I get it to go faster or even comparable."}, {"owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 0, "creation_date": 1485353425, "post_id": 41839443, "comment_id": 70891106, "body": "This makes sense especially if your applications are hosted on a network with good throughput. Protobuf performs compression, which is great at reducing throughput but at the cost of CPU cycles. JSON should take up more bandwidth, but less CPU cycles to deserialize than Protobuf. So as long as the network is unburdened, JSON <i>should</i> beat Protobuf  in speed."}, {"owner": {"reputation": 1, "user_id": 7537372, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a872d207b1c7c15b203c5df80759577d?s=128&d=identicon&r=PG", "display_name": "TeBoring", "link": "https://stackoverflow.com/users/7537372/teboring"}, "edited": false, "score": 0, "creation_date": 1486598088, "post_id": 41839443, "comment_id": 71425479, "body": "Protobuf supports php c exntension: <a href=\"https://pecl.php.net/package/protobuf\" rel=\"nofollow noreferrer\">pecl.php.net/package/protobuf</a>"}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 183984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b55b8fc5e5ed89901f08bca7d0053cfc?s=128&d=identicon&r=PG", "display_name": "Brent Shaffer", "link": "https://stackoverflow.com/users/183984/brent-shaffer"}, "is_accepted": false, "score": 3, "last_activity_date": 1497315748, "creation_date": 1497315748, "answer_id": 44510838, "question_id": 41839443, "link": "https://stackoverflow.com/questions/41839443/json-is-way-faster-than-protobuf-grpc-for-me-with-go-as-the-server-and-php-as-t/44510838#44510838", "title": "JSON is way faster than Protobuf/gRPC for me, with Go as the server and PHP as the client", "body": "<p>The native PHP implementation of <code>protobuf</code>, which you install with <code>composer require google/protobuf</code> is <em>much slower</em> than the <a href=\"https://pecl.php.net/package/protobuf\" rel=\"nofollow noreferrer\">protobuf C extension</a>. To get any real performance out of gRPC you need to install the protobuf C extension:</p>\n\n<pre><code>pecl install protobuf\n</code></pre>\n\n<p>and enable it in <code>php.ini</code></p>\n\n<pre><code>extension=protobuf.so\n</code></pre>\n\n<p>This does all the serialization/deserialization in C rather than in PHP, which going to be many times faster than the PHP version.</p>\n"}], "owner": {"reputation": 59, "user_id": 7369139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9efe4d1f468e15af0aeb1f3e721ba37?s=128&d=identicon&r=PG&f=1", "display_name": "mhsc", "link": "https://stackoverflow.com/users/7369139/mhsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1900, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1497315748, "creation_date": 1485293912, "question_id": 41839443, "link": "https://stackoverflow.com/questions/41839443/json-is-way-faster-than-protobuf-grpc-for-me-with-go-as-the-server-and-php-as-t", "title": "JSON is way faster than Protobuf/gRPC for me, with Go as the server and PHP as the client", "body": "<p>Perhaps I've somewhat missed the point of Protobufs, but I spent some time to implement it because I was hoping to gain raw speed compared to my current JSON setup.</p>\n\n<p>My use case is like this: a large, complicated PHP application (not a website), in production and being used heavily. We're now trying to split our application into smaller parts, written in a suitable language for each problem. The first service I have split out does processing and transformations on strings, very domain specific and not very interesting. Involves lots of regex's, custom parsing etc.</p>\n\n<p>I implemented my domain logic in Go, which works beautifully and was very easy to pick up. I attached my logic to a simple JSON API, using Go-Kit. Is a very simple transformation, json encoding simply to something like {\"v\":\"some string usually 10-100 chars\"}.</p>\n\n<p>The performance was worse than native PHP which I consider quite acceptable considering the overhead of JSON and the addition of transmitting over a network layer.</p>\n\n<p>However, what really surprised me is that Protobuf has not only been no faster than JSON, but actually slower by 30-50%.</p>\n\n<p>My .proto:</p>\n\n<pre><code>syntax = \"proto3\";\n\npackage pb;\n\noption optimize_for = SPEED;\n\nservice StringStuff {\n  rpc DoStringStuff (StringReq) returns (StringRes) {}\n}\n\nmessage StringReq {\n  string in = 1;\n}\n\nmessage StringRes {\n  string out = 1;\n}\n</code></pre>\n\n<p>I used <a href=\"https://github.com/stanley-cheung/Protobuf-PHP\" rel=\"nofollow noreferrer\">https://github.com/stanley-cheung/Protobuf-PHP</a> and the generated proto php code. My php client code is like this:</p>\n\n<pre><code>$client = new StringClient('localhost:50051', [\n'credentials' =&gt; \\Grpc\\ChannelCredentials::createInsecure()]);\n\n$string = new StringReq();\n$string-&gt;setIn(\"some string...\");\nlist($reply, $status) = $client-&gt;DoStringStuff($string)-&gt;wait();\n</code></pre>\n\n<p>It works but to my surprise it is a lot slower than JSON.</p>\n\n<p>My only guess: is it possible the php implementation of Protobufs is so much slower than json_decode that currently PHP makes a very poor client for Protobuf?</p>\n\n<p>Or is it normal for small, simple uses like transmitting a single string that JSON should out perform Protobuf?</p>\n\n<p>Thank you for any and all thoughts.</p>\n"}, {"tags": ["go", "unicode"], "answers": [{"comments": [{"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1485295606, "post_id": 41839267, "comment_id": 70864877, "body": "I do keep the hash, but I need to recalculate the hashes as form of validation that the data was not tampered with. I am aware of the vendors pattern, but I still would like to move forward, I just want to be able to call old version for old data. Maybe I am asking for too much."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1485470917, "post_id": 41839267, "comment_id": 70951128, "body": "@icze. Yes, I need the code that originally computed the normal form. And this is kind of my question - what could be a strategy for having that. Obviously staying forever on the same version will make sure that I do have the same result for this particular goal. But this is a small chunk of all I need to consider, moving forward is so often forced from other factors, that I believe I cannot afford that."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1485470928, "post_id": 41839267, "comment_id": 70951136, "body": "Why I need normalization is a very valid point. I am debating this with myself too. Since the project I am working is having so many aspects - the normalization in place will guarantee that semantically the same object will always produce the same hash (at least for the same version of the software). Not having such guarantee may or may not create limitations in other areas of the system that I would prefer to explore the options I have to ensure 1-1 before I disregard the potential risk of complications in other areas."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1485335269, "last_edit_date": 1495540896, "creation_date": 1485293131, "answer_id": 41839267, "question_id": 41839003, "link": "https://stackoverflow.com/questions/41839003/go-lang-version-able-string-normalization/41839267#41839267", "title": "go lang version-able string normalization", "body": "<p>Can't you just store the hash for the texts? That way you don't even have to normalize and calculate them when you need them.</p>\n\n<p>If you can't or don't want to: you don't have to use the latest version of the normalization package. You can pick the current latest version (or any commit you choose), and put it in a vendor folder. And so you can use this \"fixed\" version years later too. For vendoring details, see <a href=\"https://stackoverflow.com/questions/34775722/package-version-management-in-go-1-5/34775947#34775947\">Package version management in Go 1.5</a>.</p>\n\n<p>Just think about it: if the <a href=\"https://godoc.org/golang.org/x/text/unicode/norm\" rel=\"nofollow noreferrer\"><code>norm</code></a> package is changed (e.g. a bug is fixed) and produces a different output (normalized text), how else would you be able to get the \"old\" output without having the code that produces the old output? Only by having the old version of the <code>norm</code> package.</p>\n\n<p>On the other hand, you said you need to calculate the hash to verify that the data was not tampered. If so, I don't see the purpose of normalization. You can just hash the text without normalization, if the original text is changed (e.g. it was \"edited\", but it wasn't really changed, just re-saved in normalized form), that can be taken as \"tampered\".</p>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485335269, "creation_date": 1485292010, "question_id": 41839003, "link": "https://stackoverflow.com/questions/41839003/go-lang-version-able-string-normalization", "title": "go lang version-able string normalization", "body": "<p>I am working on a project where some strings are hashed. To make sure that I always get the right result I would like to normalize them before I hash them. ... and there is the Unicode norm package for that. So far so good. </p>\n\n<p>I do not want to store the normalized form, already have the data stored in its raw from - that I assume the customer likes it. I would like years later if I am asked to calculate the hash to the same string I to get the same result. Now if the standard improves or there was a bug that was fixed using the latest version of the library will allow for a different result. I do not care if the previous result was not perfect - I just want the same one.</p>\n\n<p>My question is: what might be a good way to enforce consistency - avoiding my own implementation.</p>\n"}, {"tags": ["json", "function", "go", "handler", "httplistener"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1485283880, "post_id": 41836655, "comment_id": 70858702, "body": "Your code snippet doesn&#39;t make any sense; why is there a <code>defer res.Body.Close()</code> call &quot;in the middle on nowhere&quot;?"}, {"owner": {"reputation": 14308, "user_id": 73632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b701f0d9043b1ad0ad2029399eb1a896?s=128&d=identicon&r=PG", "display_name": "Jordan Lewis", "link": "https://stackoverflow.com/users/73632/jordan-lewis"}, "edited": false, "score": 0, "creation_date": 1485283882, "post_id": 41836655, "comment_id": 70858704, "body": "This error indicates that there is another process or thread listening on the port already. Do you perhaps have another program on your computer serving to port <code>8080</code>?"}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1485285403, "post_id": 41836655, "comment_id": 70859579, "body": "@TimCooper I&#39;m not sure where it is supposed to go?  Any suggestions?"}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "reply_to_user": {"reputation": 14308, "user_id": 73632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b701f0d9043b1ad0ad2029399eb1a896?s=128&d=identicon&r=PG", "display_name": "Jordan Lewis", "link": "https://stackoverflow.com/users/73632/jordan-lewis"}, "edited": false, "score": 0, "creation_date": 1485285475, "post_id": 41836655, "comment_id": 70859627, "body": "@JordanLewis I ran  netstat -nc TCP | find &quot;8080&quot;   and got nothing back"}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "edited": false, "score": 0, "creation_date": 1485290160, "post_id": 41836655, "comment_id": 70862227, "body": "I figured it out.  The Handler continues to run as a process on Windows until you either shut down Eclipse, or kill the process.  After you do this, you can run the handler without error.  How can I get the handler to stop in the code for testing purposes?"}], "answers": [{"comments": [{"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "edited": false, "score": 0, "creation_date": 1485286154, "post_id": 41837230, "comment_id": 70860011, "body": "I cannot find much difference.  I see that you added the main function and the struct, which I have.  I was only showing the Handler fucntion and log, not the whole of my code."}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "edited": false, "score": 0, "creation_date": 1485286259, "post_id": 41837230, "comment_id": 70860080, "body": "Understood. I completed the code so that I can run it and verify that it works - that information might make for a better question."}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "edited": false, "score": 0, "creation_date": 1485286995, "post_id": 41837230, "comment_id": 70860546, "body": "OK, thanks.  Please let me know if you are getting the error."}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "edited": false, "score": 0, "creation_date": 1485291554, "post_id": 41837230, "comment_id": 70863003, "body": "I am not getting the error, as indicated in comments above you must have a process hanging onto that port."}], "tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": false, "score": 1, "last_activity_date": 1485285744, "creation_date": 1485285744, "answer_id": 41837230, "question_id": 41836655, "link": "https://stackoverflow.com/questions/41836655/how-do-i-get-golangs-http-handlefunc-to-work-without-error/41837230#41837230", "title": "How do I get GoLang&#39;s http.HandleFunc() to work without error?", "body": "<p>I've remedied several of the problems with your code and made best guesses around missing information. Here is sample working code that will accept a message that has \"name\" and \"text\" fields:</p>\n\n<pre><code>package main\n\nimport (\n  \"encoding/json\"\n  \"fmt\"\n  \"html\"\n  \"log\"\n  \"net/http\"\n)\n\ntype Message struct {\n  Name string `json:\"name\"`\n  Text string `json:\"text\"`\n}\n\nfunc main() {\n  http.HandleFunc(\"/\", func(w http.ResponseWriter, request *http.Request) {\n    fmt.Fprintf(w, \"Hello, %q\", html.EscapeString(request.URL.Path))\n\n    var m Message\n\n    if request.Body == nil {\n      http.Error(w, \"Please send a request body\", 400)\n      return\n    }\n\n    err := json.NewDecoder(request.Body).Decode(&amp;m)\n    if err != nil {\n      http.Error(w, err.Error(), 400)\n      return\n    }\n\n    log.Println(m)\n  })\n\n  log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n"}], "owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1742, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485286700, "creation_date": 1485283591, "last_edit_date": 1485286700, "question_id": 41836655, "link": "https://stackoverflow.com/questions/41836655/how-do-i-get-golangs-http-handlefunc-to-work-without-error", "title": "How do I get GoLang&#39;s http.HandleFunc() to work without error?", "body": "<p>I am trying to create a GoLang http.HandleFunc() that will listen for post requests and parse a json file.  The Handler seems to fail as it starts and returns an error: </p>\n\n<blockquote>\n  <p>2017/01/24 13:35:08 listen tcp :8080: bind: Only one usage of each\n  socket address (protocol/network address/port) is normally permitted.</p>\n</blockquote>\n\n<p>I am assuming that it is throwing a fatal error.</p>\n\n<p>Below is my function:</p>\n\n<pre><code> http.HandleFunc(\"/\", func(w http.ResponseWriter, request *http.Request) {\n\n        //debug\n        fmt.Fprintf(w, \"Hello, %q\", html.EscapeString(request.URL.Path))\n\n        var m Message\n\n        if request.Body == nil {\n            http.Error(w, \"Please send a request body\", 400)                \n            return\n        }\n\n        err := json.NewDecoder(request.Body).Decode(&amp;m)\n        if err != nil {\n            http.Error(w, err.Error(), 400)\n            return\n        }\n })\n log.Fatal(http.ListenAndServe(\":8080\", nil))\n</code></pre>\n\n<p>How can I get this Handler to work and not get the error?</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1485288685, "post_id": 41836581, "comment_id": 70861480, "body": "It should as is in nomad code."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485294371, "post_id": 41836581, "comment_id": 70864327, "body": "That&#39;s a package level variable, it&#39;s only incremented and not being &quot;reset&quot; between individual tests. Are you sure you&#39;re properly shutting down the server?"}, {"owner": {"reputation": 1670, "user_id": 811008, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5f9c1a97dc5daf7a7590bd38933d3229?s=128&d=identicon&r=PG", "display_name": "Halil Kaskavalci", "link": "https://stackoverflow.com/users/811008/halil-kaskavalci"}, "edited": false, "score": 0, "creation_date": 1485419403, "post_id": 41836581, "comment_id": 70920837, "body": "Server is shut down by <code>defer TestServer.Stop()</code> at each test. See: <a href=\"https://github.com/hashicorp/nomad/blob/master/testutil/server.go#L213\" rel=\"nofollow noreferrer\">github.com/hashicorp/nomad/blob/master/testutil/server.go#L2&zwnj;&#8203;13</a> . Even though they are in different package, it seems go test is running these in different environments thus value is not being preserved."}], "owner": {"reputation": 1670, "user_id": 811008, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5f9c1a97dc5daf7a7590bd38933d3229?s=128&d=identicon&r=PG", "display_name": "Halil Kaskavalci", "link": "https://stackoverflow.com/users/811008/halil-kaskavalci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485420014, "creation_date": 1485283394, "last_edit_date": 1485420014, "question_id": 41836581, "link": "https://stackoverflow.com/questions/41836581/declaring-static-variable-for-go-unit-tests", "title": "Declaring &#39;static&#39; variable for Go unit tests", "body": "<p>I have couple of packages and their unit tests. Each unit test opens a port and listens on it. Sequential running those tests result in <code>port in use</code> errors.</p>\n\n<p>What I need is something similar to <code>static</code> variable in C++. One counter variable which will <strong>preserve</strong> its value in each unit test call. I will open subsequent ports for each unit test.</p>\n\n<p>I'm doing this for opening subsequent ports for Nomad. They already use it in their codebase (<a href=\"https://github.com/hashicorp/nomad/blob/master/testutil/server.go#L30\" rel=\"nofollow noreferrer\">https://github.com/hashicorp/nomad/blob/master/testutil/server.go#L30</a>) however offset is not preserved at each unit test.</p>\n\n<p>Here is sample code to reproduce the issue:</p>\n\n<p>A.go</p>\n\n<pre><code>package a\n\nvar Offset uint64\n</code></pre>\n\n<p>A_test.go</p>\n\n<pre><code>package a\n\nimport \"testing\"\n\nfunc TestVar(t *testing.T) {\n    Offset = Offset + 1\n    t.Log(Offset)\n}\n</code></pre>\n\n<p>B_test.go</p>\n\n<pre><code>package b\n\nimport (\n    \"testing\"\n\n    \"github.com/test/test/a\"\n)\n\nfunc TestVar(t *testing.T) {\n    a.Offset = a.Offset + 1\n    t.Log(a.Offset)\n}\n</code></pre>\n\n<p>Run tests:</p>\n\n<pre><code>$ go test -v ./...\n=== RUN   TestVar\n--- PASS: TestVar (0.00s)\n        A_test.go:7: 1\nPASS\nok      github.com/test/test/a  0.005s\n=== RUN   TestVar\n--- PASS: TestVar (0.00s)\n        B_test.go:11: 1\nPASS\nok      github.com/test/test/b  0.007s\n</code></pre>\n"}, {"tags": ["go", "struct", "unmarshalling"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1485291395, "post_id": 41836256, "comment_id": 70862907, "body": "You are trying to fight against the type system. Don&#39;t do that. You&#39;ll shout your own foot. Redesign."}, {"owner": {"reputation": 89, "user_id": 1134824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee759fc5fce50de95de6f7c370ec36ee?s=128&d=identicon&r=PG", "display_name": "kwakhed", "link": "https://stackoverflow.com/users/1134824/kwakhed"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1485297623, "post_id": 41836256, "comment_id": 70865765, "body": "Would be the best way to do this? I&#39;m Unmarshalling the json and i need to extract the value by a string which i&#39;m spitting (e.g. <code>Property2.Sub2Property3.SubSub2Property1</code>). So there&#39;s no good way to do this?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1485333991, "post_id": 41836256, "comment_id": 70878203, "body": "Unsure if I understand the problem but take a look at github.com/nytlabs/gojsonexplode . Would this fit your purpose? The package has a few rough edges/errors but I do have patches for them."}, {"owner": {"reputation": 89, "user_id": 1134824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee759fc5fce50de95de6f7c370ec36ee?s=128&d=identicon&r=PG", "display_name": "kwakhed", "link": "https://stackoverflow.com/users/1134824/kwakhed"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1485381152, "post_id": 41836256, "comment_id": 70908406, "body": "Thank for your reply, I ended up going with a package called jsonq here: <a href=\"https://github.com/jmoiron/jsonq\" rel=\"nofollow noreferrer\">github.com/jmoiron/jsonq</a>. Works pretty well for what I need"}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1485287420, "creation_date": 1485287420, "answer_id": 41837725, "question_id": 41836256, "link": "https://stackoverflow.com/questions/41836256/how-to-get-a-value-from-a-nested-struct-in-golang/41837725#41837725", "title": "How to get a value from a nested Struct in Golang", "body": "<p>You can with <em>reflect</em></p>\n\n<pre><code>func FieldBySlice(strct interface{}, fields []string) interface{} {\n    val := reflect.ValueOf(strct)\n    for _, field := range fields {\n        val = val.FieldByName(field)\n    }\n    return val.Interface()\n}\n</code></pre>\n\n<p>This code works, but you will use it only if very much necessary. It's ugly and not recommended. Try to think different, Go is not scripting, dynamic  language</p>\n"}], "owner": {"reputation": 89, "user_id": 1134824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee759fc5fce50de95de6f7c370ec36ee?s=128&d=identicon&r=PG", "display_name": "kwakhed", "link": "https://stackoverflow.com/users/1134824/kwakhed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 910, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485287420, "creation_date": 1485282312, "question_id": 41836256, "link": "https://stackoverflow.com/questions/41836256/how-to-get-a-value-from-a-nested-struct-in-golang", "title": "How to get a value from a nested Struct in Golang", "body": "<p>Very new to statically typed languages, so I have this complex struct I'm Unmarshalling</p>\n\n<pre><code>type MyStruc1 struct {\n    Property1 uint16 `json:property1`\n    Property2 struct {\n        Sub2Property1 string `json:sub2property1`\n        Sub2Property2 uint16 `json:sub2property2`\n        Sub2Property3 struct {\n            SubSub2Property1 string `json:subsub2property1`\n            SubSub2Property2 string `json:subsub2property1`\n        } `json:sub2property3`\n    } `json:property2`\n    Property3 struct {\n        Sub3Property1 string `json:sub3property1`\n        Sub3Property2 uint16 `json:sub3property2`\n        Sub3Property3 struct {\n            SubSub3Property1 string `json:subsub3property1`\n            SubSub3Property2 string `json:subsub3property1`\n        } `json:sub3peroperty3`\n    } `json:property3`\n    Property4 string `json:property4`\n}\n</code></pre>\n\n<p>How do i write a function or struct method to accept any one of these arrays and return the value from MyStruct1? Is this possible?</p>\n\n<pre><code>strArray1 := []string{\"Property2\", \"Sub2Property3\", \"SubSub2Property1\"}\n\nstrArray2 := []string{\"Property3\", \"Sub3Property1\"}\n\nstrArray3 := []string{\"Property4\"}\n\nstrArray4 := []string{\"Property1\"}\n</code></pre>\n\n<p>Thank you ahead of time with any replies</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "edited": false, "score": 0, "creation_date": 1485287683, "post_id": 41833802, "comment_id": 70860953, "body": "You import with a <code>get</code> and upload with a <code>put</code>. If it is import, you need to change the <code>put</code> to <code>get</code>."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485324733, "post_id": 41833802, "comment_id": 70873633, "body": "consider as an alternative this <a href=\"https://godoc.org/github.com/pkg/sftp\" rel=\"nofollow noreferrer\">sftp package</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7463915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0775e412fdc66bdbc47cad620d9661ed?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/7463915/mathieu"}, "is_accepted": true, "score": 1, "last_activity_date": 1485337828, "creation_date": 1485337828, "answer_id": 41848307, "question_id": 41833802, "link": "https://stackoverflow.com/questions/41833802/using-sftp-input-via-golang-os-exec/41848307#41848307", "title": "Using sftp &lt;&lt; INPUT via golang os/exec", "body": "<p>I finally found the solution.</p>\n\n<pre><code>cmd = exec.Command(\"sftp\", \"login@sftp.com\")\ncmd.Stdin = strings.NewReader(`cd some/path\nput file.gz\nquit`)\ncmd.Stderr = &amp;stderr\nerr = cmd.Start()\nif err != nil {\n    fmt.Println(stderr.String())\n    fmt.Println(err)\n    os.Exit(1)\n}\nerr = cmd.Wait()\n</code></pre>\n\n<p>I set the commands I need to do once I'm in the STFP by setting <code>cmd.Stdin</code></p>\n\n<p><code>cmd.Start()</code> and <code>cmd.Wait()</code> starts the command and stops when the whole command is done.</p>\n"}], "owner": {"reputation": 11, "user_id": 7463915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0775e412fdc66bdbc47cad620d9661ed?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/7463915/mathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 41848307, "answer_count": 1, "score": 0, "last_activity_date": 1485337828, "creation_date": 1485276574, "last_edit_date": 1485337399, "question_id": 41833802, "link": "https://stackoverflow.com/questions/41833802/using-sftp-input-via-golang-os-exec", "title": "Using sftp &lt;&lt; INPUT via golang os/exec", "body": "<p>What I want to do is exporting a file from my server via SFTP, in golang.</p>\n\n<p>Here is the troubling code</p>\n\n<pre><code>cmd = exec.Command(\"sftp\", \"login@sftp.com\", `INPUT\n    cd /some/path\n    put file.gz\n    quit\n    INPUT`)\ncmd.Stderr = &amp;stderr\nerr = cmd.Run()\nif err != nil {\n    fmt.Println(stderr.String())\n    os.Exit(1)\n}\nfmt.Println(\"done\")\n</code></pre>\n\n<p>It gets to <code>done</code> but doesn't import <code>file.gz</code>. </p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 2221, "user_id": 3732965, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a4c0748c973ace112d7875df7e938b8a?s=128&d=identicon&r=PG", "display_name": "Digital Alchemist", "link": "https://stackoverflow.com/users/3732965/digital-alchemist"}, "edited": false, "score": 0, "creation_date": 1485276937, "post_id": 41833068, "comment_id": 70854483, "body": "i do not see any record for <code>588774c85ba19c1e35bdfef9</code>, correct me if i am wrong"}, {"owner": {"reputation": 2221, "user_id": 3732965, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a4c0748c973ace112d7875df7e938b8a?s=128&d=identicon&r=PG", "display_name": "Digital Alchemist", "link": "https://stackoverflow.com/users/3732965/digital-alchemist"}, "edited": false, "score": 0, "creation_date": 1485277211, "post_id": 41833068, "comment_id": 70854673, "body": "when filtering array elements, its good to use <code>$elemMatch</code> or <code>bson.M{&quot;$elemMatch&quot;: bson.M{&quot;apps&quot;: &#39;588774c85ba19c1e35bdfef9&#39;}</code>"}, {"owner": {"reputation": 862, "user_id": 4780378, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/952ea857b33c627ee944e6e34871d211?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndroid", "link": "https://stackoverflow.com/users/4780378/devandroid"}, "reply_to_user": {"reputation": 2221, "user_id": 3732965, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a4c0748c973ace112d7875df7e938b8a?s=128&d=identicon&r=PG", "display_name": "Digital Alchemist", "link": "https://stackoverflow.com/users/3732965/digital-alchemist"}, "edited": false, "score": 0, "creation_date": 1485278905, "post_id": 41833068, "comment_id": 70855721, "body": "Thank you for your answer. It&#39;s a mistake sorry I edited"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7356297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cd0b1ba0864b66c54e93d17714a6d0?s=128&d=identicon&r=PG&f=1", "display_name": "Ring Xu", "link": "https://stackoverflow.com/users/7356297/ring-xu"}, "is_accepted": false, "score": 0, "last_activity_date": 1515051729, "creation_date": 1515051729, "answer_id": 48090763, "question_id": 41833068, "link": "https://stackoverflow.com/questions/41833068/remove-element-from-nested-array-golang-mongodb/48090763#48090763", "title": "Remove element from nested array golang mongodb", "body": "<p>maybe you need to specify the field name in apps object just like</p>\n\n<p>update := bson.M{\"$pull\": bson.M{\"apps\": bson.M{\"_id\":bson.ObjectIdHex(\"585a61405ba19c3eb2016a17\")}}}</p>\n"}], "owner": {"reputation": 862, "user_id": 4780378, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/952ea857b33c627ee944e6e34871d211?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndroid", "link": "https://stackoverflow.com/users/4780378/devandroid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515051729, "creation_date": 1485274560, "last_edit_date": 1485278949, "question_id": 41833068, "link": "https://stackoverflow.com/questions/41833068/remove-element-from-nested-array-golang-mongodb", "title": "Remove element from nested array golang mongodb", "body": "<p>I have this on my mongo database :</p>\n\n<pre><code>{\n\"_id\" : ObjectId(\"585a60b45ba19c3eb2016a16\"),\n\"userid\" : ObjectId(\"585a60715ba19c3eb2016a14\"),\n\"apps\" : [\n    {\n        \"name\" : \"Apptest\",\n        \"packagename\" : \"com.test.ezfez\",\n        \"iconurl\" : \"an_url\",\n        \"visited\" : 0,\n        \"category\" : \"category\",\n        \"_id\" : ObjectId(\"585a61405ba19c3eb2016a17\")\n    },\n    {\n        \"name\" : \"test\",\n        \"packagename\" : \"test.packagename\",\n        \"iconurl\" : \"url\",\n        \"visited\" : 0,\n        \"category\" : \"\",\n        \"_id\" : ObjectId(\"588755025ba19c6f870282d7\")\n    }, ...\n</code></pre>\n\n<p>I want to remove on element from this array. I'm using golang and mgo.v2 driver and here is my code :</p>\n\n<pre><code>selector := bson.M{\"userid\": bson.ObjectIdHex(\"585a60715ba19c3eb2016a14\")}\n    update := bson.M{\"$pull\": bson.M{\"apps\": bson.ObjectIdHex(\"585a61405ba19c3eb2016a17\")}}\n    if err := uc.session.DB(\"API\").C(\"aioapps\").Update(selector, update); err != nil {\n        fmt.Println(err)\n        SendError(w, \"Remove\", \"Error on delete app\")\n    } else {\n        SendSuccess(w, \"Remove\", \"Success\")\n    }\n</code></pre>\n\n<p>It goes on Success but does not delete the item when I check on mongodb.\nCan soemeone tell me what I'm doing wrong ?\nThank you</p>\n"}, {"tags": ["unit-testing", "go", "binary", "byte"], "comments": [{"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1485274503, "post_id": 41832913, "comment_id": 70852766, "body": "Slices share an underlying array, have you tried writing to buf[2:],buf[4:] etc. ?"}, {"owner": {"reputation": 5, "user_id": 7463554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zSGjF.jpg?s=128&g=1", "display_name": "Canadian Gopher", "link": "https://stackoverflow.com/users/7463554/canadian-gopher"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1485274756, "post_id": 41832913, "comment_id": 70852958, "body": "@FranckJeannin, I tried a lot of things... I&#39;ll try it just now."}, {"owner": {"reputation": 5, "user_id": 7463554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zSGjF.jpg?s=128&g=1", "display_name": "Canadian Gopher", "link": "https://stackoverflow.com/users/7463554/canadian-gopher"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1485275144, "post_id": 41832913, "comment_id": 70853236, "body": "@FranckJeannin, well you are right! I found out my mistake. I thought that I should pass indexes regarding to bits not bytes, so did <code>buf[32:]</code> not <code>buf[4:]</code>. Thank you! Please put your comment as an answer I&#39;ll accept it ;)"}], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": true, "score": 0, "last_activity_date": 1485275302, "creation_date": 1485275302, "answer_id": 41833364, "question_id": 41832913, "link": "https://stackoverflow.com/questions/41832913/write-an-array-of-uint32-to-a-slice-of-bytes-and-obtain-it-back/41833364#41833364", "title": "Write an array of uint32 to a slice of bytes and obtain it back", "body": "<p>Slices share an underlying array, you can write (PutUint32) to buf[4:], buf[8:] etc.</p>\n"}], "owner": {"reputation": 5, "user_id": 7463554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zSGjF.jpg?s=128&g=1", "display_name": "Canadian Gopher", "link": "https://stackoverflow.com/users/7463554/canadian-gopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 41833364, "answer_count": 1, "score": 0, "last_activity_date": 1485275302, "creation_date": 1485274154, "last_edit_date": 1485274594, "question_id": 41832913, "link": "https://stackoverflow.com/questions/41832913/write-an-array-of-uint32-to-a-slice-of-bytes-and-obtain-it-back", "title": "Write an array of uint32 to a slice of bytes and obtain it back", "body": "<p>I'm trying to create a mock for a <code>os.File</code> or to be more specific <code>io.Reader</code>. I want to emulate reading of 128 bits of concrete data without actual reading.</p>\n\n<p>With a single <code>uint32</code> there is no problems.</p>\n\n<p>Mock:</p>\n\n<pre><code>func (f *FileMock) Read(buf []byte) (n int, err error) {\n    binary.BigEndian.PutUint32(buf, uint32(2052))\n    return len(buf), nil\n}       \n</code></pre>\n\n<p>Tested method (simplified):</p>\n\n<pre><code>b := make([]byte, 128)                                                      \nmeta_data := make([]uint32, 4)                                                                                                                                 \n_, err = s.Read(b)                                                                          \nif err != nil {                                                                             \n    // Handle error         \n}                                                                                                                                                                                       \nbinary.Read(bytes.NewBuffer(b), binary.BigEndian, &amp;meta_data)                                                                                                                               \nlog.Print(meta_data) // Output [2052 0 0 0]\n</code></pre>\n\n<p>But when I need to mock reading of a <code>uint32</code> slice <code>PutUint32</code> is not helpful because it writes to a slice from beginning (overrites previously wrtten data). I tried a bunch of combinations of <code>bytes</code>and <code>binary</code> tools but had no luck every time I can't get the data back from bytes. There is my last attempt (it is not the only):</p>\n\n<pre><code>func (f *FileMock) Read(b []byte) (n int, err error) {\n    buf := bytes.NewBuffer(make([]byte, len(b)))\n    err = binary.Write(buf, binary.BigEndian, [4]uint32{2051, 123, 28, 28})\n    buf.Read(b)\n    return len(b), nil\n}\n</code></pre>\n\n<p>With the same tested method as described above I'm obtaining an empty slice <code>[0, 0, 0, 0]</code>. <strong>Please note, this is a mock for <code>os.File.Read</code> method so I can't create a new slice of bytes instead of it I need to write my data to an existing slice.</strong></p>\n\n<p>At first I'm wondering how to solve the issue. Also I want to know why there is just <code>[0, 0, 0, 0]</code>?</p>\n\n<p>Grateful for answers!</p>\n"}, {"tags": ["jquery", "json", "ajax", "go"], "answers": [{"tags": [], "owner": {"reputation": 1847, "user_id": 391464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XdRz.png?s=128&g=1", "display_name": "yee", "link": "https://stackoverflow.com/users/391464/yee"}, "is_accepted": false, "score": 0, "last_activity_date": 1485272793, "creation_date": 1485272793, "answer_id": 41832393, "question_id": 41831375, "link": "https://stackoverflow.com/questions/41831375/go-how-to-receive-json-data-which-ajax-type-is-delete-using-gin/41832393#41832393", "title": "Go - How to receive json data which ajax type is DELETE using gin", "body": "<p>You may try <code>BindJson</code> method of <code>gin.Context</code>.</p>\n\n<pre><code>var json SomeJsonStruct\nif c.BindJSON(&amp;json) == nil {\n    //...\n}\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 6824811, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1686954718290010/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6824811/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485272793, "creation_date": 1485269937, "question_id": 41831375, "link": "https://stackoverflow.com/questions/41831375/go-how-to-receive-json-data-which-ajax-type-is-delete-using-gin", "title": "Go - How to receive json data which ajax type is DELETE using gin", "body": "<p>I'm making web application. But I conflict big problem. In back-end, I made function for DELETE.</p>\n\n<p>Here is DELETE function : </p>\n\n<pre><code>router.DELETE(\"/rsv/delete\", func(c *gin.Context) {\n    //how to receive json data?\n})\n</code></pre>\n\n<p>And I send json data by Ajax.</p>\n\n<p>Here is Ajax function : </p>\n\n<pre><code>$.ajax({\n    url: \"/rsv/delete\",\n    type: \"DELETE\",\n    data: parse_delete,\n    contentType: \"application/json\",\n    success: function(result) {\n        if (result) {\n            alert(\"\uc0ad\uc81c\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4!\");\n            location.href = \"/member_index\";\n        }\n\n        else {\n            alert(\"Error\");\n        }\n    }\n})\n</code></pre>\n\n<p>Please Help me.</p>\n"}, {"tags": ["windows", "go", "operating-system"], "comments": [{"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 1, "creation_date": 1485264784, "post_id": 41829461, "comment_id": 70845808, "body": "<a href=\"https://github.com/kardianos/service/blob/master/service_windows.go\" rel=\"nofollow noreferrer\">This example has a good skeleton</a> of what your service should be implementing."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1485264858, "post_id": 41829461, "comment_id": 70845869, "body": "<a href=\"https://stackoverflow.com/posts/41829461/edit\">Edit</a> your question, and include the code in the question."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1485266796, "post_id": 41829461, "comment_id": 70847261, "body": "<i>&quot;I want to know Why Windows Service showed that error.&quot;</i> - Because a Windows <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms685141.aspx\" rel=\"nofollow noreferrer\">Service</a> is required to implement a certain <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms685967.aspx\" rel=\"nofollow noreferrer\">interface</a>. You aren&#39;t, and the service control manager fails to talk to your service."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1485268177, "post_id": 41829461, "comment_id": 70848216, "body": "You should read MS&#39;s documentation on services. In particular, <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms685984(v=vs.85).aspx\" rel=\"nofollow noreferrer\">how to implement ServiceMain</a>. You probably aren&#39;t reporting to the SCM that the service has entered a SERVICE_RUNNING state. It&#39;s also probably that you haven&#39;t <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms685477(v=vs.85).aspx\" rel=\"nofollow noreferrer\">implemented the service entry point</a> and called <code>StartServiceCtrlDispatcher()</code>"}, {"owner": {"reputation": 31, "user_id": 6298626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tkW1a.jpg?s=128&g=1", "display_name": "Vignesh", "link": "https://stackoverflow.com/users/6298626/vignesh"}, "reply_to_user": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1485323039, "post_id": 41829461, "comment_id": 70872937, "body": "Thanks @LynnCrumbling"}], "owner": {"reputation": 31, "user_id": 6298626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tkW1a.jpg?s=128&g=1", "display_name": "Vignesh", "link": "https://stackoverflow.com/users/6298626/vignesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485265094, "creation_date": 1485264495, "last_edit_date": 1485265094, "question_id": 41829461, "link": "https://stackoverflow.com/questions/41829461/why-windows-service-panel-still-waiting-even-though-the-process-is-started-succe", "title": "Why Windows Service Panel still waiting even though the process is started successfully?", "body": "<p>I wrote a simple application in golang which prints some messages in log file.\nI created a service with windows \"sc create myapp binpath='path'\".\nWhen I start the service It was created and messages were printed in log file.but windows tells \"The process not responded\".\nI want know what happens when we start a service and What the application should respond to windows service manager?</p>\n\n<pre><code>func main() {\n_, err := os.Stat(\"C:/test.txt\")\nif err != nil {\n    f, _ = os.Create(\"C:/test.txt\")\n} else {\n    f, _ = os.Open(\"C:/test.txt\")\n}\nlog.SetOutput(f)\nlog.Println(\"Hello World!\")\n}\n</code></pre>\n"}, {"tags": ["go", "firebase"], "comments": [{"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1485259749, "post_id": 41827792, "comment_id": 70842514, "body": "You are missing the SOF format with all your questions so far."}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1553747575, "last_edit_date": 1553747575, "creation_date": 1485324409, "answer_id": 41844568, "question_id": 41827792, "link": "https://stackoverflow.com/questions/41827792/how-to-read-a-specific-record-from-firebase-database-using-golang/41844568#41844568", "title": "how to read a specific record from firebase database using golang?", "body": "<p>I got answer</p>\n\n<pre><code>func (m *User) RetrieveFromDBId(ctx context.Context,key string)(bool) {\n\n       dB, err := GetFirebaseClient(ctx,\"\")\n       value := User{}\n       err = db.Child(\"/User/\"+key).Value(&amp;value)\n           if err != nil {\n              log.Fatal(err)\n              return false\n            }\n     log.Println( value)\n     return true\n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1553747575, "creation_date": 1485259437, "last_edit_date": 1485269855, "question_id": 41827792, "link": "https://stackoverflow.com/questions/41827792/how-to-read-a-specific-record-from-firebase-database-using-golang", "title": "how to read a specific record from firebase database using golang?", "body": "<p>Database structure:</p>\n\n<p><strong>user</strong> json:</p>\n\n<pre><code>{  \n    \"-KbF1E26gjZCjPnfcOmi\" : {\n        \"DateOfCreation\" : 1485253960222,\n        \"EmailId\" : \"abc@gmail.com\",\n        \"FirstName\" : \"abcd\",\n        \"LastName\" : \"z z\",\n        \"Status\" : \"active\",\n        \"UserType\" : \"admin\"\n    }\n}\n</code></pre>\n\n<p>How to retrieve whole data corresponding to this \n<strong>key(-KbF1E26gjZCjPnfcOmi)</strong></p>\n\n<p>I have tried this code, but it is not working.</p>\n\n<pre><code>func (m *User) RetrieveFromDBId(ctx context.Context,key string)(bool) {\n    dB, err := GetFirebaseClient(ctx,\"\")\n    var s []string\n    err = dB.Child(\"User\").Child(key).Value(s)\n    if err != nil {\n        log.Fatal(err)\n        return false\n    }\n    log.Println( s)\n    return true\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "roles", "amazon-sqs", "amazon-iam"], "answers": [{"comments": [{"owner": {"reputation": 3391, "user_id": 461112, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/332d4c4a09f271a4a921ce52cbba0ae0?s=128&d=identicon&r=PG", "display_name": "user461112", "link": "https://stackoverflow.com/users/461112/user461112"}, "edited": false, "score": 0, "creation_date": 1485257263, "post_id": 41826956, "comment_id": 70840895, "body": "Unfortunately - that link doesn&#39;t consist of roleARN or queue ARN."}], "tags": [], "owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "is_accepted": false, "score": 1, "last_activity_date": 1485256952, "creation_date": 1485256952, "answer_id": 41826956, "question_id": 41826679, "link": "https://stackoverflow.com/questions/41826679/fetching-message-with-aws-sdk-go-rolearn-queuearn-sqs/41826956#41826956", "title": "Fetching message with aws-sdk-go / roleARN / queueARN (sqs)", "body": "<p>I think this is a good starting point.</p>\n\n<p><a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/sqs/examples_test.go\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/blob/master/service/sqs/examples_test.go</a></p>\n"}], "owner": {"reputation": 3391, "user_id": 461112, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/332d4c4a09f271a4a921ce52cbba0ae0?s=128&d=identicon&r=PG", "display_name": "user461112", "link": "https://stackoverflow.com/users/461112/user461112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485256952, "creation_date": 1485256121, "question_id": 41826679, "link": "https://stackoverflow.com/questions/41826679/fetching-message-with-aws-sdk-go-rolearn-queuearn-sqs", "title": "Fetching message with aws-sdk-go / roleARN / queueARN (sqs)", "body": "<p>I have a sqs queue created (which has the queueARN). I also have an IAM role created(which provides the roleARN and has access permissions to the queueARN). I'm trying to fetch messages from the queue using this role, but I'm unable to find a sample go code to do this operation.</p>\n\n<p>Any hints?</p>\n"}, {"tags": ["rest", "go", "reflection", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485269151, "post_id": 41826421, "comment_id": 70848897, "body": "It&#39;s only 5 libraries, just link them at compile time. I don&#39;t understand what reflection has to do with this though. What are you reflecting on?"}, {"owner": {"reputation": 567, "user_id": 1309509, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d5fb0cbcd08f82f3d177405bb1ec9c5f?s=128&d=identicon&r=PG", "display_name": "Kaarthik", "link": "https://stackoverflow.com/users/1309509/kaarthik"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485269384, "post_id": 41826421, "comment_id": 70849081, "body": "@JimB Thanks for your comment. I would know which function to call ,based on the JSON request I get. The JSON I get would contain the function name I have to invoke. Hence based on a string I would have to invoke the function in the library. This is where I potentially want to use reflection. But I have no clear picture of how to do this."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485293942, "post_id": 41826421, "comment_id": 70864154, "body": "You read the request and call the appropriate function you want to call. There&#39;s nothing to reflect on in the situation that you describe. If you don&#39;t want to register the function names, you would have to dlopen and dlsym the symbol, but that&#39;s a much different problem than using reflection in Go."}, {"owner": {"reputation": 567, "user_id": 1309509, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d5fb0cbcd08f82f3d177405bb1ec9c5f?s=128&d=identicon&r=PG", "display_name": "Kaarthik", "link": "https://stackoverflow.com/users/1309509/kaarthik"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485295751, "post_id": 41826421, "comment_id": 70864954, "body": "The method names are not predefined and I don&#39;t have a list of all functions in a library. So basically I will have to call a function based on a string and I can&#39;t have a switch case or an if condition since I don&#39;t know the function names before hand. Hence I wanted to invoke a function using reflection with the string I get."}, {"owner": {"reputation": 2269, "user_id": 1794002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63211e8bd9155deed45b05dd9d249ce?s=128&d=identicon&r=PG", "display_name": "Anssi", "link": "https://stackoverflow.com/users/1794002/anssi"}, "edited": false, "score": 0, "creation_date": 1502028036, "post_id": 41826421, "comment_id": 78025475, "body": "I think you could implement Go plugin for each library and export Go functions from plugin which maps to C library functions. then use plugin lookup to test if there is corresponding method."}], "owner": {"reputation": 567, "user_id": 1309509, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d5fb0cbcd08f82f3d177405bb1ec9c5f?s=128&d=identicon&r=PG", "display_name": "Kaarthik", "link": "https://stackoverflow.com/users/1309509/kaarthik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485259211, "creation_date": 1485255513, "last_edit_date": 1485259211, "question_id": 41826421, "link": "https://stackoverflow.com/questions/41826421/reflection-and-cgo", "title": "Reflection and CGo", "body": "<p>I am new to Go and had a question regarding cgo. Here is my question. </p>\n\n<p>I have around 5 C libraries. I am developing a RESTful service which needs to call functions in these libraries dynamically based  on the parameters the user send me.  </p>\n\n<p>Is there a way I can dynamically load the C libraries at runtime using reflection or Should I be loading all the libraries at once? If so can I call functions in these libraries using reflection ? Because I just get the name of the function and the parameters to be passed as a JSON object from the client</p>\n"}, {"tags": ["post", "go"], "answers": [{"comments": [{"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1485267253, "post_id": 41827329, "comment_id": 70847584, "body": "I really dont see what you did different. Please elaborate"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1485267600, "post_id": 41827329, "comment_id": 70847834, "body": "Is x now of type URL ? Did that make the difference?"}, {"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "reply_to_user": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1485317828, "post_id": 41827329, "comment_id": 70871290, "body": "@Krash, What is the value of <code>x</code> in your example?"}, {"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "reply_to_user": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1485321066, "post_id": 41827329, "comment_id": 70872210, "body": "Do not use <code>&#47;</code> after URL. as you are adding <code>&#47;</code> in front of uri"}, {"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "reply_to_user": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1485321147, "post_id": 41827329, "comment_id": 70872237, "body": "Also check whether they support <code>http</code>"}], "tags": [], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "is_accepted": false, "score": 0, "last_activity_date": 1485258043, "creation_date": 1485258043, "answer_id": 41827329, "question_id": 41825614, "link": "https://stackoverflow.com/questions/41825614/how-to-add-a-product-to-cartpost-form-using-golang/41827329#41827329", "title": "How to add a product to cart(post form) using golang?", "body": "<p>Add <code>URI</code> with base <code>URL</code></p>\n\n<pre><code>x := \"https://www.oneness287.com\"\nresp, err := http.PostForm(x+\"/cart/add\",url.Values{\"id\":{\"29709681417\"}})\n</code></pre>\n\n<p>It returns <code>200 OK</code></p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485258043, "creation_date": 1485253304, "question_id": 41825614, "link": "https://stackoverflow.com/questions/41825614/how-to-add-a-product-to-cartpost-form-using-golang", "title": "How to add a product to cart(post form) using golang?", "body": "<p>I am on this site <a href=\"https://www.oneness287.com/collections/all/products/adidas-equipment-support-adv-4\" rel=\"nofollow noreferrer\">https://www.oneness287.com/collections/all/products/adidas-equipment-support-adv-4</a> and I wish to add the product to my cart.</p>\n\n<p>What I think should work is(x= url of the site)</p>\n\n<pre><code>resp,err := http.PostForm(x+\"/cart/add\",url.Values{\"id\":{\"29709681417\"}})\n</code></pre>\n\n<p>because the form action = \"/cart/add\" and the input type for size has the name id.</p>\n\n<p>but the response body after this is </p>\n\n<pre><code>&amp;{404 Not Found 404 HTTP/1.1 1 1 map[Date:[Tue, 24 Jan 2017 10:15:39 GMT] X-Dc:[ash,chi2] Content-Type:[text/html; charset=utf-8] Vary:[Accept-Encoding] X-Shardid:[8] X-Permitted-Cross-Domain-Policies:[none] X-Xss-Protection:[1; mode=block; report=/xss-report?source%5Baction%5D=not_found&amp;source%5Bapp%5D=Shopify&amp;source%5Bcontroller%5D=storefront_section%2Fshop&amp;source%5Bsection%5D=storefront&amp;source%5Buuid%5D=66d12b35-aa92-4dea-8add-8fdf04609371] X-Request-Id:[66d12b35-aa92-4dea-8add-8fdf04609371] Connection:[keep-alive] X-Shopid:[1875180] Content-Language:[en] Cache-Control:[no-cache, no-store] Set-Cookie:[customer_sig=; path=/; expires=Sat, 24 Jan 2037 10:15:39 -0000; HttpOnly _session_id=a26d201e2649179d094c504c0edef003; path=/; HttpOnly cart_sig=; path=/; expires=Tue, 07 Feb 2017 10:15:39 -0000; HttpOnly] X-Content-Type-Options:[nosniff] X-Download-Options:[noopen] Server:[nginx]] 0xc042201060 -1 [chunked] false true map[] 0xc0420ae1e0 &lt;nil&gt;}\n</code></pre>\n\n<p>What is the correct way to do this?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485248657, "post_id": 41823908, "comment_id": 70835239, "body": "Thanks, will try it!  With golang it&#39;s go /path/to/google_appengine/appcfg.py --no_cookies update myapp? or can I just use: goapp --no_cookies deploy myapp"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485248754, "post_id": 41823908, "comment_id": 70835304, "body": "Flag provided but not defined?"}], "tags": [], "owner": {"reputation": 484, "user_id": 3477269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66d0a0e4d220c293111ec985b86ebfc?s=128&d=identicon&r=PG&f=1", "display_name": "Bravin Balasubramaniam", "link": "https://stackoverflow.com/users/3477269/bravin-balasubramaniam"}, "is_accepted": true, "score": 2, "last_activity_date": 1485248345, "creation_date": 1485248345, "answer_id": 41823908, "question_id": 41823426, "link": "https://stackoverflow.com/questions/41823426/how-do-i-change-what-account-i-use-for-deployment-to-gae/41823908#41823908", "title": "How do I change what account I use for deployment to GAE?", "body": "<p>Use the --no_cookies flag, e.g.:</p>\n\n<pre><code>python2.7 /path/to/google_appengine/appcfg.py --no_cookies update myapp\n</code></pre>\n\n<blockquote>\n  <p>--no_cookies</p>\n</blockquote>\n\n<p>Do not store the administrator sign-in credentials as a cookie; prompt for a password every time.\nThis flag will bring up a prompt for your email address as well.</p>\n"}], "owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 41823908, "answer_count": 1, "score": 0, "last_activity_date": 1485251559, "creation_date": 1485246785, "last_edit_date": 1495541805, "question_id": 41823426, "link": "https://stackoverflow.com/questions/41823426/how-do-i-change-what-account-i-use-for-deployment-to-gae", "title": "How do I change what account I use for deployment to GAE?", "body": "<p>Im having a problem where I used one account to deploy to GAE through terminal and GAE SDK, i.e goapp deploy. Not at a later point I need to deploy to another account but I dont understand how to change this in terminal? How do I trigger a new login to happen?</p>\n\n<p>I read this question: <a href=\"https://stackoverflow.com/questions/24049181/how-to-switch-google-app-engine-account-to-deploy-applications\">How to switch google app engine account to deploy applications?</a> but I dont get it to work either. I write the <code>--email=bla@gmail.com</code> flag but get the error message:</p>\n\n<pre><code>flag provided but not defined: -email\n</code></pre>\n\n<p>Am I using the <code>--email</code> flag wrong or maybe wrong parameters?</p>\n"}, {"tags": ["go", "firebase", "firebase-realtime-database"], "comments": [{"owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "edited": false, "score": 0, "creation_date": 1485239884, "post_id": 41821290, "comment_id": 70830749, "body": "What Firebase client are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 7255142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/svdMc.jpg?s=128&g=1", "display_name": "Sarath Sankara Kurup", "link": "https://stackoverflow.com/users/7255142/sarath-sankara-kurup"}, "is_accepted": true, "score": 2, "last_activity_date": 1485241578, "creation_date": 1485241578, "answer_id": 41822026, "question_id": 41821290, "link": "https://stackoverflow.com/questions/41821290/how-to-delete-a-key-from-firebase-using-golang/41822026#41822026", "title": "How to delete a key from Firebase using golang?", "body": "<p>try changing the remove function like this</p>\n\n<pre><code>dB.Child(\"/Contacts/\"+key).Remove()\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7255155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a13359a48bec2ca85c91b70490b5a1?s=128&d=identicon&r=PG&f=1", "display_name": "Aswathy Ashok", "link": "https://stackoverflow.com/users/7255155/aswathy-ashok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 41822026, "answer_count": 1, "score": 0, "last_activity_date": 1485241578, "creation_date": 1485238750, "last_edit_date": 1485238888, "question_id": 41821290, "link": "https://stackoverflow.com/questions/41821290/how-to-delete-a-key-from-firebase-using-golang", "title": "How to delete a key from Firebase using golang?", "body": "<p>this is my Firebase structure.</p>\n\n<pre><code>Contacts\n\n{\n  \"-Kav_cy_EFZnu5vNWP2g\" :\n\n {\n\n    \"Address\" : \"dfsswrfdssddsd\",\n    \"CurrentDate\" : 1484910921411,\n    \"Email\" : \"a@fg.hh\",\n    \"Name\" : \"abc\",\n    \"PhoneNumber\" : \"53465465765677\",\n    \"State\" : \"fdsf\",\n    \"Status\" : \"Completed\",\n    \"Zipcode\" : \"43434\"\n  },\n\n\n  \"-Kb9ghONh670tUOkOG3N\" :\n\n {\n\n\n    \"Address\" : \"jfhjhfjfj\",\n    \"CurrentDate\" : 1485164432603,\n    \"Email\" : \"fg@gmail.com\",\n    \"Name\" : \"dcf\",\n    \"PhoneNumber\" : \"9897878787\",\n    \"State\" : \"fdsf\",\n    \"Status\" : \"Completed\",\n    \"Zipcode\" : \"56546\"\n\n\n  }\n}\n</code></pre>\n\n<p>i want to delete data corresponding to the key(<code>-Kav_cy_EFZnu5vNWP2g</code>). I have tried below code, but it's not working:</p>\n\n<p>model</p>\n\n<pre><code>func (m *User) DeleteFromDB(ctx context.Context,key string)(bool)  {\n\n\n    dB, err := GetFirebaseClient(ctx,\"\")\n    if err!=nil{\n        log.Println(\"Connection error:\",err)\n    }\n    err = dB.Child(key).remove();\n    if err!=nil{\n        log.Println(\"Deletion error:\",err)\n        return false\n    }\n return true\n\n\n}\n</code></pre>\n\n<p>in <code>DeleteFromDB()</code>, I have the key.</p>\n"}, {"tags": ["http", "post", "go", "progress-bar", "httprequest"], "comments": [{"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 1, "creation_date": 1485248081, "post_id": 41821193, "comment_id": 70834856, "body": "Your code is incomplete. Please, provide <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 5395008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d636c51ace5efa439beec10188ed03?s=128&d=identicon&r=PG&f=1", "display_name": "D. Smith", "link": "https://stackoverflow.com/users/5395008/d-smith"}, "edited": false, "score": 0, "creation_date": 1485275274, "post_id": 41824598, "comment_id": 70853339, "body": "Thanks! I didn&#39;t want to/can&#39;t use multipart-form upload though. I did get it worked out though."}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": false, "score": 1, "last_activity_date": 1485250373, "creation_date": 1485250373, "answer_id": 41824598, "question_id": 41821193, "link": "https://stackoverflow.com/questions/41821193/why-is-my-upload-progress-bar-finishing-before-the-transfer-completes/41824598#41824598", "title": "Why is my upload progress bar finishing before the transfer completes?", "body": "<p>As I wrote in the comment, your question doesn't contain all required information, but here is the sample app that posts the file as <code>multipart-form</code> to the remote server with the progress bar:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/cheggaaa/pb\"\n    \"os\"\n    \"time\"\n    \"bytes\"\n    \"mime/multipart\"\n    \"io\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    body := &amp;bytes.Buffer{}\n    bodyWriter := multipart.NewWriter(body)\n\n    fw, _ := bodyWriter.CreateFormFile(\"file\", \"filename.jpg\")\n    fh, _ := os.Open(\"filename.jpg\")\n\n    io.Copy(fw, fh)\n    bodyWriter.Close()\n\n    bar := pb.New(body.Len()).SetUnits(pb.U_BYTES).SetRefreshRate(time.Millisecond * 10)\n    bar.ShowSpeed = true\n    bar.Start()\n\n    reader := bar.NewProxyReader(body)\n\n    resp, _ := http.Post(\"http://domain.com\", bodyWriter.FormDataContentType(), reader)\n    defer resp.Body.Close()\n\n    response, _ := ioutil.ReadAll(resp.Body)\n    print(string(response))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 5395008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d636c51ace5efa439beec10188ed03?s=128&d=identicon&r=PG&f=1", "display_name": "D. Smith", "link": "https://stackoverflow.com/users/5395008/d-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1485275330, "creation_date": 1485275330, "answer_id": 41833379, "question_id": 41821193, "link": "https://stackoverflow.com/questions/41821193/why-is-my-upload-progress-bar-finishing-before-the-transfer-completes/41833379#41833379", "title": "Why is my upload progress bar finishing before the transfer completes?", "body": "<p>Got it, turns out another package was causing issues with the HTTP Request. The code below works perfectly. </p>\n\n<pre><code>package main\n\nimport(\n    pb \"gopkg.in/cheggaaa/pb.v1\"\n    \"fmt\"\n    \"os\"\n    \"log\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    path := \"/Users/me/testfile.txt\"\n    file, e := os.Open(path)\n    if e != nil {\n        log.Fatal(\"File Error\")\n    }\n    defer file.Close()\n    fi, e := file.Stat()\n    if e != nil {\n      log.Fatal(\"File Stat Error\")\n    }\n\n    bar := pb.New(int(fi.Size()))\n    bar.Start()\n\n    client := &amp;http.Client{}\n    req, e := http.NewRequest(\"POST\", \"http://posttestserver.com/post.php\", bar.NewProxyReader(file))\n    if e != nil {\n      log.Fatal(\"Request Error\")\n    }\n    resp, e := client.Do(req)\n    if e != nil {\n      log.Fatal(\"Response Error\")\n    }\n    bar.Finish()\n    respBody, e := ioutil.ReadAll(resp.Body)\n    fmt.Println(string(respBody))\n\n    return\n}\n</code></pre>\n\n<p>Thanks to <a href=\"http://posttestserver.com\" rel=\"nofollow noreferrer\">http://posttestserver.com</a> for giving me somewhere to easily troubleshoot!</p>\n"}], "owner": {"reputation": 26, "user_id": 5395008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d636c51ace5efa439beec10188ed03?s=128&d=identicon&r=PG&f=1", "display_name": "D. Smith", "link": "https://stackoverflow.com/users/5395008/d-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485275330, "creation_date": 1485238317, "last_edit_date": 1495542255, "question_id": 41821193, "link": "https://stackoverflow.com/questions/41821193/why-is-my-upload-progress-bar-finishing-before-the-transfer-completes", "title": "Why is my upload progress bar finishing before the transfer completes?", "body": "<p>I'm sending a POST request to an API, and using a third-party library (<a href=\"https://github.com/cheggaaa/pb\" rel=\"nofollow noreferrer\">https://github.com/cheggaaa/pb</a>), but my upload progress bar is going to done before the file transfer actually completes. </p>\n\n<pre><code>package main\n\nimport(\n    pb \"gopkg.in/cheggaaa/pb.v1\"\n    \"net/http\"\n)\n\nfunc main() {\n    file, e := os.Open(path)\n    if e != nil {\n        log.Fatal()\n    }\n    defer file.Close()\n\n    bar := pb.New(int(fi.Size()))\n    bar.Start()\n\n\n    req, err := http.NewRequest(\"POST\", url, body)\n\n    resp, err := client.Do(req)\n\n    bar.Finish()\n\n    return\n}\n</code></pre>\n\n<p>It starts at </p>\n\n<pre><code>12.64 MB / 12.64 MB [======================] 100.00% 12.59 MB/s 0s\n</code></pre>\n\n<p>And at completion goes to:</p>\n\n<pre><code>12.64 MB / 12.64 MB [======================] 100.00% 626.67 KB/s 20s\n</code></pre>\n\n<p>Is this because the HTTP Req handler is reading the file into memory and incrementing the progress bar? What am I missing? </p>\n\n<p>I checked out this post, (<a href=\"https://stackoverflow.com/questions/26050380/go-tracking-post-request-progress?rq=1\">Go: Tracking POST request progress</a>), but I don't see how that is different from the library I'm using. I've previously tried using <code>io.Copy</code> to a buffer with the progress bar reader reading from that, but as soon as the Request is sent it does the same thing. </p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485238958, "post_id": 41821088, "comment_id": 70830369, "body": "could you paste the code in play. BTW, you check for err on <code>ReadAll</code> and <code>Unmarshal</code>"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485239271, "post_id": 41821088, "comment_id": 70830495, "body": "I have added it. play doesnt allow http requests though."}, {"owner": {"reputation": 19854, "user_id": 249630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b354fcaee552e9d6367cf7b69c1282e0?s=128&d=identicon&r=PG", "display_name": "lucapette", "link": "https://stackoverflow.com/users/249630/lucapette"}, "edited": false, "score": 0, "creation_date": 1485239709, "post_id": 41821088, "comment_id": 70830668, "body": "It works for me. I see you edited your question and in the original question the code had a <code>log.Fatal(err)</code> without the if that checks if the error is actually there. As soon as I changed that it worked fine. So your code works :)"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "edited": false, "score": 0, "creation_date": 1485239871, "post_id": 41821088, "comment_id": 70830744, "body": "It doesnt print anything for me. Can you show me the output you get? I dont get any output at all"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 19854, "user_id": 249630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b354fcaee552e9d6367cf7b69c1282e0?s=128&d=identicon&r=PG", "display_name": "lucapette", "link": "https://stackoverflow.com/users/249630/lucapette"}, "edited": false, "score": 0, "creation_date": 1485244186, "post_id": 41821088, "comment_id": 70832775, "body": "@lucapette which version of go are you using <code>go version</code>"}], "answers": [{"tags": [], "owner": {"reputation": 376, "user_id": 899843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2156758e4d22a4dc2a4df09d51931e8e?s=128&d=identicon&r=PG", "display_name": "Josh Lubawy", "link": "https://stackoverflow.com/users/899843/josh-lubawy"}, "is_accepted": true, "score": 3, "last_activity_date": 1485332028, "last_edit_date": 1485332028, "creation_date": 1485241908, "answer_id": 41822118, "question_id": 41821088, "link": "https://stackoverflow.com/questions/41821088/how-to-unmarshal-xml-data-from-online-xml-file/41822118#41822118", "title": "How to unmarshal xml data from online xml file", "body": "<p>Please try the following code which works for me (note: you could also use <code>ioutil.ReadAll</code> and <code>xml.Unmarshal</code> as you had before, instead of <code>xml.Decode</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\n// &lt;urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:image=\"http://www.google.com/schemas/sitemap-image/1.1\"&gt;\n//    &lt;url&gt;\n//        &lt;loc&gt;\n//            https://www.notre-shop.com/products/test-product-releasing-soon-2\n//        &lt;/loc&gt;\n//        &lt;lastmod&gt;2017-01-17T08:04:44Z&lt;/lastmod&gt;\n//        &lt;changefreq&gt;daily&lt;/changefreq&gt;\n//        &lt;image:image&gt;\n//            &lt;image:loc&gt;\n//                https://cdn.shopify.com/s/files/1/0624/0605/products/NOTRE-CHICAGO-QK9C9548_fde37b05-495e-47b0-8dd1-b053c9ed3545.jpg?v=1481853712\n//            &lt;/image:loc&gt;\n//            &lt;image:title&gt;Test Product Releasing Soon 2&lt;/image:title&gt;\n//        &lt;/image:image&gt;\n//    &lt;/url&gt;\n// &lt;/urlset&gt;\ntype URLSet struct {\n    XMLName string `xml:\"urlset\"`\n\n    URLs []URL `xml:\"url\"`\n}\n\ntype URL struct {\n    Loc   string `xml:\"loc\"`\n    Image Image  `xml:\"image\"`\n}\n\ntype Image struct {\n    Title string `xml:\"title\"`\n}\n\nfunc main() {\n    resp, err := http.Get(\"https://www.notre-shop.com/sitemap_products_1.xml\")\n    if err != nil {\n        log.Fatalln(err) // log.Fatal always exits the program, need to check err != nil first\n    }\n    defer resp.Body.Close()\n\n    var urlSet URLSet\n    if err = xml.NewDecoder(resp.Body).Decode(&amp;urlSet); err != nil {\n        log.Fatalln(err)\n    }\n\n    for _, url := range urlSet.URLs {\n        fmt.Println(url.Loc, url.Image.Title)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "edited": false, "score": 0, "creation_date": 1485261449, "post_id": 41822862, "comment_id": 70843546, "body": "@dmportella In play http get wont work.It is a security consideration.You may copy paste t and try"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 0, "last_activity_date": 1485253610, "last_edit_date": 1485253610, "creation_date": 1485244720, "answer_id": 41822862, "question_id": 41821088, "link": "https://stackoverflow.com/questions/41821088/how-to-unmarshal-xml-data-from-online-xml-file/41822862#41822862", "title": "How to unmarshal xml data from online xml file", "body": "<p>This is what the XML Specification says</p>\n\n<blockquote>\n<pre><code> The Namespaces in XML Recommendation [XML Names] assigns a meaning \n to names containing colon characters. Therefore, authors should not \n use the colon in XML names except for namespace purposes, but XML \n processors must accept the colon as a name character.\n</code></pre>\n</blockquote>\n\n<p>This is the XML Namespace Recommendation says</p>\n\n<blockquote>\n  <p>The XML Namespaces Recommendation expresses universal names in an\n  indirect way that is compatible with XML 1.0. In effect the XML\n  Namespaces Recommendation defines a mapping from an XML 1.0 tree where\n  element type names and attribute names are local names into a tree\n  where element type names and attribute names can be universal names.\n  The mapping is based on the idea of a prefix. If an element type name\n  or attribute name contains a colon, then the mapping treats the part\n  of the name before the colon as a prefix, and the part of the name\n  after the colon as the local name. A prefix foo refers to the URI\n  specified in the value of the xmlns:foo attribute.</p>\n</blockquote>\n\n<p>You may not use name with colon(:) to get the inner elements rather you can avoid the pefix ,here is your code re-written</p>\n\n<p>And for performance/memory considerations since you are getting a <code>io.Reader</code> you may use <code>xml.Decoder</code> instead of xml.Unmarshal.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nvar Product struct {\n    Locs []string `xml:\"url&gt;loc\"`\n    Name []Image  `xml:\"url&gt;image\"`\n}\n\ntype Image struct {\n    Title string `xml:\"title\"`\n}\n\nfunc main() {\n    res, err := http.Get(\"https://www.notre-shop.com/sitemap_products_1.xml\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer res.Body.Close()\n    decoder := xml.NewDecoder(res.Body)\n    err = decoder.Decode(&amp;Product)\n    if err != nil {\n        log.Fatal(err)\n    }\n    for x, _ := range Product.Name {\n        fmt.Println(Product.Name[x].Title, Product.Locs[x])\n    }\n}\n</code></pre>\n\n<p>Here is play link <a href=\"https://play.golang.org/p/SNqyB3ZyH-\" rel=\"nofollow noreferrer\">play</a></p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 922, "favorite_count": 0, "accepted_answer_id": 41822118, "answer_count": 2, "score": 2, "last_activity_date": 1485332028, "creation_date": 1485237937, "last_edit_date": 1485239839, "question_id": 41821088, "link": "https://stackoverflow.com/questions/41821088/how-to-unmarshal-xml-data-from-online-xml-file", "title": "How to unmarshal xml data from online xml file", "body": "<p>I have an xml file on suppose <a href=\"https://www.notre-shop.com/sitemap_products_1.xml\" rel=\"nofollow noreferrer\">https://www.notre-shop.com/sitemap_products_1.xml</a> and I want to unmarshal this xml in my go code so I did this</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nvar Product struct {\n    Locs []string `xml:\"url&gt;loc\"`\n    Name []string `xml:\"url&gt;image:title\"`\n}\n\nfunc main() {\n    res, err := http.Get(\"https://www.notre-shop.com/sitemap_products_1.xml\")\n    if err!=nil{\n        log.Fatal(err)\n    }\n\n    data, err := ioutil.ReadAll(res.Body)\n    if err!=nil{\n        log.Fatal(err)\n    }\n    defer res.Body.Close()\n\n    err = xml.Unmarshal(data, &amp;Product)\n    if err!=nil{\n        log.Fatal(err)\n    }\n    for x, _ := range Product.Name {\n        fmt.Println(Product.Name[x], Product.Locs[x])\n    }\n}\n</code></pre>\n\n<p>But this doesn't print anything. What am I doing wrong?</p>\n\n<p>Here is the complete code <a href=\"https://play.golang.org/p/pZ6j4-lSEz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pZ6j4-lSEz</a> on play.</p>\n"}, {"tags": ["ssl", "go", "compilation"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1485240497, "post_id": 41820908, "comment_id": 70831022, "body": "This is not a question about Go and not really suitable for SO. Of course you have to recompile after changing the source."}, {"owner": {"reputation": 2359, "user_id": 6197439, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/692e93967f23c403a2eb62c0cf99bb53?s=128&d=identicon&r=PG&f=1", "display_name": "sdbbs", "link": "https://stackoverflow.com/users/6197439/sdbbs"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1485244466, "post_id": 41820908, "comment_id": 70832911, "body": "Thank you @Volker - and I&#39;m really sorry for wasting your time. What would you suggest is a better fit for this question? I&#39;ll tag it immediately so it is moved to another forum. Btw - of course I have to recompile, that much I know - but using what command, is what I&#39;m asking?"}], "answers": [{"comments": [{"owner": {"reputation": 2359, "user_id": 6197439, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/692e93967f23c403a2eb62c0cf99bb53?s=128&d=identicon&r=PG&f=1", "display_name": "sdbbs", "link": "https://stackoverflow.com/users/6197439/sdbbs"}, "edited": false, "score": 0, "creation_date": 1485244649, "post_id": 41822264, "comment_id": 70833000, "body": "Thanks, @JoshLubawy - I would have thought the build command is <code>go build</code> or something, didn&#39;t quite expect <code>go install</code>. Could you maybe expand on where this <code>install</code> installs to - is it  <code>~&#47;go&#47;bin&#47;</code>; or is there some sort of settings file that could be in the git project dir?"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 1, "creation_date": 1485326158, "post_id": 41822264, "comment_id": 70874239, "body": "<code>go install</code> does <code>go build</code> and puts the resulting binary in $GOPATH/bin (the same place that <code>go get</code> puts it)"}], "tags": [], "owner": {"reputation": 376, "user_id": 899843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2156758e4d22a4dc2a4df09d51931e8e?s=128&d=identicon&r=PG", "display_name": "Josh Lubawy", "link": "https://stackoverflow.com/users/899843/josh-lubawy"}, "is_accepted": true, "score": 2, "last_activity_date": 1485242409, "creation_date": 1485242409, "answer_id": 41822264, "question_id": 41820908, "link": "https://stackoverflow.com/questions/41820908/golang-skip-ssl-x509-verification-and-build-package/41822264#41822264", "title": "Golang - skip SSL / x509 verification and build package?", "body": "<p>After updating the source as you did (in <code>$GOPATH/src</code>) you can try re-compiling using the following command:</p>\n\n<pre><code>go install github.com/mvdan/fdroidcl/cmd/fdroidcl\n</code></pre>\n"}], "owner": {"reputation": 2359, "user_id": 6197439, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/692e93967f23c403a2eb62c0cf99bb53?s=128&d=identicon&r=PG&f=1", "display_name": "sdbbs", "link": "https://stackoverflow.com/users/6197439/sdbbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2733, "favorite_count": 0, "accepted_answer_id": 41822264, "answer_count": 1, "score": 1, "last_activity_date": 1485242409, "creation_date": 1485237127, "last_edit_date": 1495540897, "question_id": 41820908, "link": "https://stackoverflow.com/questions/41820908/golang-skip-ssl-x509-verification-and-build-package", "title": "Golang - skip SSL / x509 verification and build package?", "body": "<p>I know nothing about the Go language, I'd just like to use this app on Ubuntu 14:</p>\n\n<ul>\n<li><a href=\"https://github.com/mvdan/fdroidcl\" rel=\"nofollow noreferrer\">https://github.com/mvdan/fdroidcl</a></li>\n</ul>\n\n<p>Before doing anything, I had to <a href=\"https://stackoverflow.com/questions/21001387/how-do-i-set-the-gopath-environment-variable-on-ubuntu-what-file-must-i-edit/21012349#21012349\">set the GOPATH environment variable in my ~/.bashrc</a>. Then the README says this program is installed with:</p>\n\n<pre><code>go get -u github.com/mvdan/fdroidcl/cmd/fdroidcl\n</code></pre>\n\n<p>This passes fine, and an executable is found. In fact, these are the files found in home, where <code>GOPATH</code> is <code>~/go</code>:</p>\n\n<pre><code>$ find ~ -name 'fdroidcl*' 2&gt;/dev/null \n/home/myusername/.cache/fdroidcl\n/home/myusername/.config/fdroidcl\n/home/myusername/go/pkg/gccgo_linux_386/github.com/mvdan/fdroidcl\n/home/myusername/go/src/github.com/mvdan/fdroidcl\n/home/myusername/go/src/github.com/mvdan/fdroidcl/cmd/fdroidcl\n/home/myusername/go/bin/fdroidcl\n</code></pre>\n\n<p>Nice, but now when I start the initial command:</p>\n\n<pre><code>$ fdroidcl updateDownloading https://f-droid.org/repo/index.jar... \nupdate: could not update index: Get https://f-droid.org/repo/index.jar: x509: certificate signed by unknown authority (possibly because of \"x509: cannot verify signature: algorithm unimplemented\" while trying to verify candidate authority certificate \"COMODO RSA Certification Authority\")\n</code></pre>\n\n<p>This is most likely a failure due to self-signed certificate. A quick fix would be to use <code>http://</code> instead of <code>https://</code> (in case of <code>f-droid.org</code> it is currently possible), so I tried changing <code>~/go/src/github.com/mvdan/fdroidcl/cmd/fdroidcl/main.go</code>:</p>\n\n<pre><code>var config = userConfig{\n        Repos: []repo{\n                {\n                        ID:      \"f-droid\",\n                        //URL:     \"https://f-droid.org/repo\",\n                        URL:     \"http://f-droid.org/repo\",\n                        Enabled: true,\n                },\n                {\n                        ID:      \"f-droid-archive\",\n                        //URL:     \"https://f-droid.org/archive\",\n                        URL:     \"http://f-droid.org/archive\",\n                        Enabled: false,\n                },\n        },\n}\n</code></pre>\n\n<p>... but the command is actually binary:</p>\n\n<pre><code>$ file $(which fdroidcl)\n~/go/bin/fdroidcl: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=cd1dc87b54f9023983511ef46fda15a4d88dcb2d, not stripped\n</code></pre>\n\n<p>... which means I'd have to somehow re-build this application from source in order to get those changes in - how would I do that?</p>\n\n<p>Furthermore, there may be other apps with self-signed https certificates that would break, so I'd much rather skip SSL / X509 verification. It seems that, as <a href=\"https://stackoverflow.com/questions/12122159/golang-how-to-do-a-https-request-with-bad-certificate\">golang: How to do a https request with bad certificate?</a> points out, that one should do in code:</p>\n\n<pre><code>tr := http.DefaultTransport.(*http.Transport)\ntr.TLSClientConfig.InsecureSkipVerify = true\n</code></pre>\n\n<p>... which again requires hacking/recompiling the source code - but isn't there some sort of a environment variable to help that, like <a href=\"https://stackoverflow.com/questions/11621768/how-can-i-make-git-accept-a-self-signed-certificate/19363404#19363404\"><code>GIT_SSL_NO_VERIFY</code> for <code>git</code></a>?</p>\n"}, {"tags": ["go", "blockchain", "hyperledger"], "answers": [{"tags": [], "owner": {"reputation": 328, "user_id": 1180486, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f26fbe431081f07754618d5b6c6f94c2?s=128&d=identicon&r=PG&f=1", "display_name": "aybekbuka", "link": "https://stackoverflow.com/users/1180486/aybekbuka"}, "is_accepted": false, "score": 0, "last_activity_date": 1491206665, "creation_date": 1491206665, "answer_id": 43179490, "question_id": 41819912, "link": "https://stackoverflow.com/questions/41819912/how-to-update-data-of-a-struct-and-save-it-in-chaincode/43179490#43179490", "title": "how to update data of a struct and save it in chaincode?", "body": "<p>You need to provide a variable where the JSON package can put the decoded data.For example this will hold a map of strings to arbitrary data types:</p>\n\n<pre><code>map[string]interface{}\n\nbyt := []byte(`{\"num\":6.13,\"strs\":[\"a\",\"b\"]}`)\nif err := json.Unmarshal(byt, &amp;dat); err != nil {\n    panic(err)\n}\nfmt.Println(dat)\n</code></pre>\n\n<p>the result is  :</p>\n\n<pre><code>map[num:6.13 strs:[a b]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1938, "user_id": 8205919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa64e238ce0ea70db6f924b050f4faa?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Enyeart", "link": "https://stackoverflow.com/users/8205919/dave-enyeart"}, "is_accepted": false, "score": 1, "last_activity_date": 1501184598, "creation_date": 1501184598, "answer_id": 45359712, "question_id": 41819912, "link": "https://stackoverflow.com/questions/41819912/how-to-update-data-of-a-struct-and-save-it-in-chaincode/45359712#45359712", "title": "how to update data of a struct and save it in chaincode?", "body": "<p>There is a good example of marshaling and unmarshaling structs to/from JSON in the Fabric chaincode examples.  It demonstrates how to read JSON data from the chain, update certain fields of the struct, and then re-save the JSON data to the chain.  See the transferMarble function in the example at:</p>\n\n<p><a href=\"https://github.com/hyperledger/fabric/blob/release/examples/chaincode/go/marbles02/marbles_chaincode.go\" rel=\"nofollow noreferrer\">https://github.com/hyperledger/fabric/blob/release/examples/chaincode/go/marbles02/marbles_chaincode.go</a></p>\n"}], "owner": {"reputation": 23, "user_id": 7424515, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XGwT0JQXTlI/AAAAAAAAAAI/AAAAAAAACjY/H6OlQ-1dwYU/photo.jpg?sz=128", "display_name": "Aditi", "link": "https://stackoverflow.com/users/7424515/aditi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501184598, "creation_date": 1485231391, "question_id": 41819912, "link": "https://stackoverflow.com/questions/41819912/how-to-update-data-of-a-struct-and-save-it-in-chaincode", "title": "how to update data of a struct and save it in chaincode?", "body": "<p>The following is an excerpt of the chaincode where I have created a customer struct that saves basic info. I wish to write an update function that first fetches the details of the customer with the UID(args[0]) and then appends/updates the Country as per the second arguement of the function update and finally saves the updated data.\nWhat am I doing wrong?  Also I would like to know the concept of Marshal and Unmarshal.</p>\n\n<pre><code>type Customer struct {\n  UID     string\n  Name    string\n  Address struct {\n    StreetNo string\n    Country  string\n  }\n}\nfunc (t *SimpleChaincode) update(stub shim.ChaincodeStubInterface, args []string) ([]byte, error) {\n\n\nif len(args) != 2 {\n    return nil, errors.New(\"Incorrect number of arguments. Expecting name of the key to query\")\n}\n  //args[0] to get the UID of customer whose details to be updated\n  //args[1] data that needs to be updated \n\ndata,err:= stub.GetState(ars[0])\nif err != nil {\n     return nil, err\n}\njson.Unmarshal(data, &amp;uid)\n//append\ndata.Country= append(data.Country,args[1])\nfmt.Printf(\"Risk Fag set for UID %s\",data)\n\nraw, err := json.Marshal(data)\n  if err != nil {\n     return nil, err\n  }\n\n  stub.PutState(data.UID, raw)\n\nreturn nil,nil\n\n}\n</code></pre>\n"}, {"tags": ["oop", "inheritance", "go", "composition"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1485259978, "post_id": 41820789, "comment_id": 70842656, "body": "While the quotation is correct, I don&#39;t fully agree with it. See my reasoning in my answer."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1485260053, "post_id": 41820789, "comment_id": 70842706, "body": "@icza I know. I was in a rush this morning, writing this answer. I knew you would be around anyway, and I have upvoted your answer."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1485236539, "creation_date": 1485236539, "answer_id": 41820789, "question_id": 41819033, "link": "https://stackoverflow.com/questions/41819033/does-fragile-base-class-issue-exist-in-go/41820789#41820789", "title": "Does fragile base class issue exist in Go?", "body": "<p>The <a href=\"https://en.wikipedia.org/wiki/Fragile_base_class\" rel=\"nofollow noreferrer\">Fragile base class</a> problem is when a seemingly safe modifications to a base class, when inherited by the derived classes, may cause the derived classes to malfunction.</p>\n\n<p>As mentioned <a href=\"https://code.tutsplus.com/tutorials/lets-go-object-oriented-programming-in-golang--cms-26540\" rel=\"nofollow noreferrer\">in this tutorial</a>:</p>\n\n<blockquote>\n  <p>For all intents and purposes, composition by e<a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">mbedding an anonymous type</a> is equivalent to implementation inheritance. An embedded struct is just as fragile as a base class. </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "edited": false, "score": 1, "creation_date": 1485482163, "post_id": 41827686, "comment_id": 70954319, "body": "Excellent explanation. +1 for the examples."}, {"owner": {"reputation": 3483, "user_id": 2668666, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3QEDd.jpg?s=128&g=1", "display_name": "jmrah", "link": "https://stackoverflow.com/users/2668666/jmrah"}, "edited": false, "score": 0, "creation_date": 1573612945, "post_id": 41827686, "comment_id": 103935188, "body": "+1 for pointing out virtual methods as one of the root causes.  In fact, I wonder if virtual methods are <i>thee</i> root cause of the Fragile Base Class problem.  If you were not allowed to override a method with implementation, would the problem even exist?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1485484092, "last_edit_date": 1485484092, "creation_date": 1485259111, "answer_id": 41827686, "question_id": 41819033, "link": "https://stackoverflow.com/questions/41819033/does-fragile-base-class-issue-exist-in-go/41827686#41827686", "title": "Does fragile base class issue exist in Go?", "body": "<p>As VonC wrote, but I'd like to point out something.</p>\n\n<p>The <a href=\"https://en.wikipedia.org/wiki/Fragile_base_class\" rel=\"nofollow noreferrer\">fragile base class</a> problem is often blamed on <a href=\"https://en.wikipedia.org/wiki/Virtual_function\" rel=\"nofollow noreferrer\">virtual methods</a> (<em>dynamic dispatch of methods</em> \u2013 this means if methods can be overridden, the actual implementation that has to be called in case of such an overridden method can only be decided at runtime).</p>\n\n<p>Why is this a problem? You have a class, you add some methods to it, and if <code>MethodA()</code> calls <code>MethodB()</code>, you can't have any guarantee that the <code>MethodB()</code> you wrote will be called and not some other method of a subclass that overrides your <code>MethodB()</code>.</p>\n\n<p>In Go there is <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">embedding</a>, but there is no <a href=\"https://en.wikipedia.org/wiki/Polymorphism_(computer_science)\" rel=\"nofollow noreferrer\">polymorphism</a>. If you embed a type in a struct, all the methods of the embedded type get <em>promoted</em> and will be in the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> of the wrapper struct type. But you can't \"override\" the promoted methods. Sure, you can add your own method with the same name, and calling a method by that name on the wrapper struct will invoke your method, but if this method is called from the embedded type, that will not be dispatched to your method, it will still call the \"original\" method that was defined to the embedded type.</p>\n\n<p>So because of this, I'd say the fragile base class problem is only present in a quite mitigated form in Go.</p>\n\n<h2>Example</h2>\n\n<h3>Demonstrating the problem in Java</h3>\n\n<p>Let's see an example. First in Java, because Java \"suffers\" from this kind of problem. Let's create a simple <code>Counter</code> class and a <code>MyCounter</code> subclass:</p>\n\n<pre><code>class Counter {\n    int value;\n\n    void inc() {\n        value++;\n    }\n\n    void incBy(int n) {\n        value += n;\n    }\n}\n\nclass MyCounter extends Counter {\n    void inc() {\n        incBy(1);\n    }\n}\n</code></pre>\n\n<p>Instantiating and using <code>MyCounter</code>:</p>\n\n<pre><code>MyCounter m = new MyCounter();\nm.inc();\nSystem.out.println(m.value);\nm.incBy(2);\nSystem.out.println(m.value);\n</code></pre>\n\n<p>The output is as expected:</p>\n\n<pre><code>1\n3\n</code></pre>\n\n<p>So far so good. Now if the base class, <code>Counter.incBy()</code> would be changed to this:</p>\n\n<pre><code>void incBy(int n) {\n    for (; n &gt; 0; n--) {\n        inc();\n    }\n}\n</code></pre>\n\n<p>The base class <code>Counter</code> still remains flawless and operational. But the <code>MyCounter</code> becomes malfunctioning: <code>MyCounter.inc()</code> calls <code>Counter.incBy()</code>, which calls <code>inc()</code> but due to dynamic dispatch, it will call <code>MyCounter.inc()</code>... yes... endless loop. Stack overflow error.</p>\n\n<h3>Demonstrating the <em>lack</em> of the problem in Go</h3>\n\n<p>Now let's see the same example, this time written in Go:</p>\n\n<pre><code>type Counter struct {\n    value int\n}\n\nfunc (c *Counter) Inc() {\n    c.value++\n}\n\nfunc (c *Counter) IncBy(n int) {\n    c.value += n\n}\n\ntype MyCounter struct {\n    Counter\n}\n\nfunc (m *MyCounter) Inc() {\n    m.IncBy(1)\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>m := &amp;MyCounter{}\nm.Inc()\nfmt.Println(m.value)\nm.IncBy(2)\nfmt.Println(m.value)\n</code></pre>\n\n<p>Output is as expected (try it on the <a href=\"https://play.golang.org/p/zKqIa9DrOG\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>1\n3\n</code></pre>\n\n<p>Now let's change <code>Counter.Inc()</code>  the same way we did in the Java example:</p>\n\n<pre><code>func (c *Counter) IncBy(n int) {\n    for ; n &gt; 0; n-- {\n        c.Inc()\n    }\n}\n</code></pre>\n\n<p>It runs perfectly, the output is the same. Try it on the <a href=\"https://play.golang.org/p/FnI7aMdS69\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>What happens here is that <code>MyCounter.Inc()</code> will call <code>Counter.IncBy()</code> which will call <code>Inc()</code>, but this <code>Inc()</code> will be <code>Counter.Inc()</code>, so no endless loop here. <code>Counter</code> doesn't even know about <code>MyCounter</code>, it does not have any reference to the embedder <code>MyCounter</code> value.</p>\n"}], "owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 2, "accepted_answer_id": 41827686, "answer_count": 2, "score": 6, "last_activity_date": 1485484092, "creation_date": 1485224880, "last_edit_date": 1485236720, "question_id": 41819033, "link": "https://stackoverflow.com/questions/41819033/does-fragile-base-class-issue-exist-in-go", "title": "Does fragile base class issue exist in Go?", "body": "<p>Despite using composition over inheritance?</p>\n\n<p>If so, is there any solution for it at the language level?</p>\n"}, {"tags": ["opengl", "go", "glow"], "comments": [{"owner": {"reputation": 2706, "user_id": 1515948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/565b63153ac530dcaf302d77e8a7127a?s=128&d=identicon&r=PG&f=1", "display_name": "thokra", "link": "https://stackoverflow.com/users/1515948/thokra"}, "edited": false, "score": 0, "creation_date": 1485250433, "post_id": 41819032, "comment_id": 70836342, "body": "I&#39;m not familiar with go, but I&#39;m sure that <code>glfwInit</code> does NOT create a context and does also NOT make a context current. Either you&#39;re not giving us the whole picture, or you&#39;re simply missing some important code. Unless you&#39;re using some means to create a window-less context (supposedly works on X based platforms and OpenGL ES using EGL), you will have to create a window using <a href=\"http://www.glfw.org/docs/latest/window_guide.html\" rel=\"nofollow noreferrer\">glfwCreateWindow</a>. Afterwards you&#39;ll have to make the context that is simultaneously created current with <code>glfwMakeContextCurrent</code>. THEN you call <code>gl.Init</code>."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 2706, "user_id": 1515948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/565b63153ac530dcaf302d77e8a7127a?s=128&d=identicon&r=PG&f=1", "display_name": "thokra", "link": "https://stackoverflow.com/users/1515948/thokra"}, "edited": false, "score": 0, "creation_date": 1485268543, "post_id": 41819032, "comment_id": 70848465, "body": "@thokra: Just for sake of completenes: It&#39;s perfectly possible to create a windowless context with windows GDI using a PBuffer. But doing so is quite a convoluted process; which is probably part of the reason, that it&#39;s not widely known."}, {"owner": {"reputation": 2706, "user_id": 1515948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/565b63153ac530dcaf302d77e8a7127a?s=128&d=identicon&r=PG&f=1", "display_name": "thokra", "link": "https://stackoverflow.com/users/1515948/thokra"}, "reply_to_user": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 0, "creation_date": 1485271840, "post_id": 41819032, "comment_id": 70850791, "body": "@datenwolf: thanks for the input! :) off topic, but do you by any chance have some concrete example for that at hand? just curious how you would go about that."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 2706, "user_id": 1515948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/565b63153ac530dcaf302d77e8a7127a?s=128&d=identicon&r=PG&f=1", "display_name": "thokra", "link": "https://stackoverflow.com/users/1515948/thokra"}, "edited": false, "score": 0, "creation_date": 1485281491, "post_id": 41819032, "comment_id": 70857439, "body": "@thokra: Indeed I have. This Gist at Github (<a href=\"https://gist.github.com/datenwolf/b107499683f5cbe9d347e0061be22351\" rel=\"nofollow noreferrer\">gist.github.com/datenwolf/b107499683f5cbe9d347e0061be22351</a>) is part of a hack I had to implement recently to support a CUDA worker thread updating data in a shared context of a Qt application. IMHO the OpenGL abstractions of Qt are too tight. Don&#39;t ask about what problem the <code>secondary_hglrc</code> pointer parameter solves (let&#39;s just say, that if you don&#39;t have it around you can crash the NVidia drivers)."}], "owner": {"reputation": 3591, "user_id": 4107956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LjlBF.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4107956/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 799, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1485224877, "creation_date": 1485224877, "question_id": 41819032, "link": "https://stackoverflow.com/questions/41819032/segfault-on-glcreateshader", "title": "SegFault on glCreateShader", "body": "<p>I'm using Go, the line causing the segfault is:</p>\n\n<pre><code>shader := gl.CreateShader(shaderType)\n</code></pre>\n\n<p>I'm basing my code on <a href=\"https://github.com/go-gl/examples/tree/master/gl41core-cube\" rel=\"nofollow noreferrer\">this example from go-gl repo</a>, which was working, so <code>gl</code> seems to be fine.</p>\n\n<p>Most of my googling pointed to C++ questions to which the answer was to enable <code>glewExperimental</code>, but the Go bindings for OpenGL were generated with <a href=\"https://github.com/go-gl/glow\" rel=\"nofollow noreferrer\"><code>GLOW</code></a>, which apparently circumvents <code>GLEW</code>.</p>\n\n<p>I am initializing my glfw contetxt:</p>\n\n<pre><code>if err := glfw.Init(); err != nil {\n    log.Fatalln(\"failed to initialize glfw:\", err)\n}\n</code></pre>\n\n<p>and the <code>gl</code> library:</p>\n\n<pre><code>// Initialize Glow\nif err := gl.Init(); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Is there anything I'm missing?  Are there any principles I can use to track this down, i.e. \"glCreateShader() Segfaults when XYZ occurs\"?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 28965, "user_id": 2344584, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dcecdcb0f6089de0a693c97c05cdb4ca?s=128&d=identicon&r=PG", "display_name": "Stefano Sanfilippo", "link": "https://stackoverflow.com/users/2344584/stefano-sanfilippo"}, "is_accepted": true, "score": 2, "last_activity_date": 1517612036, "last_edit_date": 1517612036, "creation_date": 1485223516, "answer_id": 41818851, "question_id": 41818599, "link": "https://stackoverflow.com/questions/41818599/what-is-the-default-goroutine/41818851#41818851", "title": "What is the default goroutine?", "body": "<p>It's the main goroutine, encapsulating the main thread of execution. You might for instance observe that by printing goroutine stack traces in your example program:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"runtime\"\n    \"runtime/pprof\"\n)\n\nfunc main() {\n    r := runtime.NumGoroutine()\n    log.Println(\"Num of goroutines: \", r)\n    pprof.Lookup(\"goroutine\").WriteTo(os.Stdout, 1)\n}\n</code></pre>\n\n<p>Which produces the following:</p>\n\n<pre><code>2009/11/10 23:00:00 Num of goroutines:  1\ngoroutine profile: total 1\n1 @ 0xa22a0 0xa1fc0 0x9d640 0x20180 0x5a0a0 0x98e81\n#   0xa229f runtime/pprof.writeRuntimeProfile+0xdf  /usr/local/go/src/runtime/pprof/pprof.go:614\n#   0xa1fbf runtime/pprof.writeGoroutine+0x9f   /usr/local/go/src/runtime/pprof/pprof.go:576\n#   0x9d63f runtime/pprof.(*Profile).WriteTo+0xff   /usr/local/go/src/runtime/pprof/pprof.go:298\n#   0x2017f main.main+0x17f             /tmp/sandbox832735226/main.go:13\n#   0x5a09f runtime.main+0x39f          /usr/local/go/src/runtime/proc.go:183\n</code></pre>\n\n<p>Notice that <code>runtime.main</code> at the bottom of the trace.</p>\n\n<p>A program with two goroutines alive when the traces are dumped:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"runtime\"\n    \"runtime/pprof\"\n)\n\nfunc main() {\n    c := make(chan int)\n    go func() { &lt;-c }()\n    r := runtime.NumGoroutine()\n    log.Println(\"Num of goroutines: \", r)\n    pprof.Lookup(\"goroutine\").WriteTo(os.Stdout, 1)\n}\n</code></pre>\n\n<p>Will produce something along the lines of:</p>\n\n<pre><code>2009/11/10 23:00:00 Num of goroutines:  2\ngoroutine profile: total 2\n1 @ 0x20220 0x98f61\n#   0x20220 main.main.func1+0x0 /tmp/sandbox584983760/main.go:12\n\n1 @ 0xa2380 0xa20a0 0x9d720 0x201e0 0x5a180 0x98f61\n#   0xa237f runtime/pprof.writeRuntimeProfile+0xdf  /usr/local/go/src/runtime/pprof/pprof.go:614\n#   0xa209f runtime/pprof.writeGoroutine+0x9f   /usr/local/go/src/runtime/pprof/pprof.go:576\n#   0x9d71f runtime/pprof.(*Profile).WriteTo+0xff   /usr/local/go/src/runtime/pprof/pprof.go:298\n#   0x201df main.main+0x1df             /tmp/sandbox584983760/main.go:15\n#   0x5a17f runtime.main+0x39f          /usr/local/go/src/runtime/proc.go:183\n</code></pre>\n"}], "owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 41818851, "answer_count": 1, "score": 1, "last_activity_date": 1517612036, "creation_date": 1485221451, "question_id": 41818599, "link": "https://stackoverflow.com/questions/41818599/what-is-the-default-goroutine", "title": "What is the default goroutine?", "body": "<p>The following code prints <code>2009/11/10 23:00:00 Num of goroutines:  1</code>. Is there a way to know which go routine it is?</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"runtime\"\n)\n\nfunc main() {\n    r := runtime.NumGoroutine()\n    log.Println(\"Num of goroutines: \", r)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pFOG6EQEYb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pFOG6EQEYb</a></p>\n"}, {"tags": ["string", "windows", "mongodb", "go", "intellij-idea"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1485248293, "last_edit_date": 1485248293, "creation_date": 1485221021, "answer_id": 41818529, "question_id": 41818044, "link": "https://stackoverflow.com/questions/41818044/debug-inspector-showing-strange-characters/41818529#41818529", "title": "Debug Inspector showing strange characters?", "body": "<p>No error here. <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#ObjectId\" rel=\"nofollow noreferrer\"><code>bson.ObjectId</code></a> has an underlying type of <code>string</code>:</p>\n\n<pre><code>type ObjectId string\n</code></pre>\n\n<p>But it is used to store 12 \"arbitrary\" bytes (\"arbitrary\" means it is not meant to be interpreted by runes, and it's not a valid UTF-8 encoded sequence). It is usually displayed using the hex representation of its bytes, for humans.</p>\n\n<p>Debuggers don't take that convenience. They see it's a <code>string</code>, so they attempt to display it as a <code>string</code> (even though it's not meant to). This is not a Windows-only thing, the Atom editor with the delve debugger does the same on Linux too. Nothing to worry about.</p>\n\n<p>If you print an <code>ObjectId</code>, it's usually the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package's \"thing\" to use its <code>String()</code> method to acquire the <code>string</code> value to be displayed. Debuggers do not necessarily do that.</p>\n"}], "owner": {"reputation": 3851, "user_id": 84762, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/03f58429e8709df581bedd42f576f649?s=128&d=identicon&r=PG", "display_name": "KOGI", "link": "https://stackoverflow.com/users/84762/kogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 41818529, "answer_count": 1, "score": 1, "last_activity_date": 1537191667, "creation_date": 1485217487, "last_edit_date": 1537191667, "question_id": 41818044, "link": "https://stackoverflow.com/questions/41818044/debug-inspector-showing-strange-characters", "title": "Debug Inspector showing strange characters?", "body": "<p>I'm just getting into Go for the first time and finally got things running on my Win10 machine. Finally got breakpoints working inside of IntelliJ IDEA, and I'm seeing stuff like this in my debugger window. Those messes of unicode chars should actually be a 24-char HEX id that's coming from MongoDB.</p>\n\n<p>My best guess is that this is a problem with <strong>mgo</strong> not properly unmarshalling <code>ObjectId</code> objects, but this doesn't seem to be a problem for any of the devs running linux or macOS, so maybe it's just a Windows thing?</p>\n\n<p>Any input would be appreciated!</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lx9i7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lx9i7.png\" alt=\"obfuscated screenshot\"></a></p>\n"}, {"tags": ["go", "godoc"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1485215101, "creation_date": 1485215101, "answer_id": 41817682, "question_id": 41817569, "link": "https://stackoverflow.com/questions/41817569/create-godoc-url-with-different-link-text/41817682#41817682", "title": "Create godoc URL with different link text", "body": "<p>Godoc.org linkifies text like \"RFC 1234\" to the online RFC <a href=\"https://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow noreferrer\">(example here</a>). </p>\n\n<p>With that exception, the godoc tool and godoc.org do not provide a way to use text different from the URL.</p>\n"}], "owner": {"reputation": 397892, "user_id": 95592, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/utY5u.jpg?s=128&g=1", "display_name": "Matthew Rankin", "link": "https://stackoverflow.com/users/95592/matthew-rankin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1485215101, "creation_date": 1485214339, "question_id": 41817569, "link": "https://stackoverflow.com/questions/41817569/create-godoc-url-with-different-link-text", "title": "Create godoc URL with different link text", "body": "<p>According to the <a href=\"https://blog.golang.org/godoc-documenting-go-code\" rel=\"nofollow noreferrer\">\"Godoc: documenting Go code\"</a> blog post:</p>\n\n<blockquote>\n  <p>URLs will be converted to HTML links; no special markup is necessary.</p>\n</blockquote>\n\n<p>However, is there a way to create an HTML link with different link text than the URL?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "edited": false, "score": 1, "creation_date": 1485219536, "post_id": 41815909, "comment_id": 70824784, "body": "Most of the answers involve interfaces, which don&#39;t support indexing, so accessing the elements contained in array values of JSON keys won&#39;t be as straight-forward as marshaling to a struct."}], "answers": [{"comments": [{"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 1, "creation_date": 1567589944, "post_id": 41816043, "comment_id": 102004725, "body": "Doesn&#39;t work: At first, <code>map</code> doesn&#39;t accept as a variable, so I changed it to <code>map_</code>. However, in the last line this error appeared: <code>invalid operation: map_[&quot;data&quot;] (type *map[string]interface {} does not support indexing)</code>"}], "tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1485207395, "last_edit_date": 1485207395, "creation_date": 1485207090, "answer_id": 41816043, "question_id": 41815909, "link": "https://stackoverflow.com/questions/41815909/is-there-a-way-to-extract-json-from-an-http-response-without-having-to-build-str/41816043#41816043", "title": "Is there a way to extract JSON from an http response without having to build structs?", "body": "<p>You can as well unmarshal it into a map[string]interface{}</p>\n\n<pre><code>body, err := ioutil.ReadAll(resp.Body)\nmap := &amp;map[string]interface{}{}\njson.Unmarshal(body, map)\ndesiredValue := map[\"desiredKey\"]\n</code></pre>\n\n<p>The received json must have an object as the most outer element. The map can also contain lists or nested maps, depending on the json.</p>\n"}, {"tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": false, "score": 4, "last_activity_date": 1575481520, "last_edit_date": 1575481520, "creation_date": 1485207337, "answer_id": 41816105, "question_id": 41815909, "link": "https://stackoverflow.com/questions/41815909/is-there-a-way-to-extract-json-from-an-http-response-without-having-to-build-str/41816105#41816105", "title": "Is there a way to extract JSON from an http response without having to build structs?", "body": "<p>The json.Unmarshal method will unmarshal to a struct that does not contain all the fields in the original JSON object. In other words, you can cherry-pick your fields. Here is an example where FirstName and LastName are cherry-picked and MiddleName is ignored from the json string:</p>\n\n<pre><code>package main\n\nimport (\n  \"encoding/json\"\n  \"fmt\"\n)\n\ntype Person struct {\n  FirstName string `json:\"first_name\"`\n  LastName  string `json:\"last_name\"`\n}\n\nfunc main() {\n  jsonString := []byte(\"{\\\"first_name\\\": \\\"John\\\", \\\"last_name\\\": \\\"Doe\\\", \\\"middle_name\\\": \\\"Anderson\\\"}\")\n\n  var person Person\n  if err := json.Unmarshal(jsonString, &amp;person); err != nil {\n    panic(err)\n  }\n\n  fmt.Println(person)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "edited": false, "score": 1, "creation_date": 1485218876, "post_id": 41818196, "comment_id": 70824602, "body": "Link to get actual response object <a href=\"http://stackoverflow.com/questions/38807903/how-do-i-handle-plain-text-http-get-response-in-golang\" title=\"how do i handle plain text http get response in golang\">stackoverflow.com/questions/38807903/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "is_accepted": true, "score": 26, "last_activity_date": 1529322581, "last_edit_date": 1529322581, "creation_date": 1485218599, "answer_id": 41818196, "question_id": 41815909, "link": "https://stackoverflow.com/questions/41815909/is-there-a-way-to-extract-json-from-an-http-response-without-having-to-build-str/41818196#41818196", "title": "Is there a way to extract JSON from an http response without having to build structs?", "body": "<h2>Golang: fetch JSON from an HTTP response without using structs as helpers</h2>\n\n<p>This is a typical scenario we come across. This is achieved by <code>json.Unmarshal</code>. </p>\n\n<p>Here is a simple json</p>\n\n<pre><code>{\"textfield\":\"I'm a text.\",\"num\":1234,\"list\":[1,2,3]}\n</code></pre>\n\n<p>which is serialized to send across the network and unmarshaled at Golang end.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\nfunc main() {\n    // replace this by fetching actual response body\n    responseBody := `{\"textfield\":\"I'm a text.\",\"num\":1234,\"list\":[1,2,3]}`\n    var data map[string]interface{}\n    err := json.Unmarshal([]byte(responseBody), &amp;data)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(data[\"list\"])\n    fmt.Println(data[\"textfield\"])\n}\n</code></pre>\n\n<p>Hope this was helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1618090892, "creation_date": 1618090892, "answer_id": 67039511, "question_id": 41815909, "link": "https://stackoverflow.com/questions/41815909/is-there-a-way-to-extract-json-from-an-http-response-without-having-to-build-str/67039511#67039511", "title": "Is there a way to extract JSON from an http response without having to build structs?", "body": "<p>The other answers here are misleading, as they dont show you what happens if you\ntry to go deeper in the Map. This example works fine enough:</p>\n<pre><code>package main\n\nimport (\n   &quot;encoding/json&quot;\n   &quot;fmt&quot;\n   &quot;net/http&quot;\n)\n\nfunc main() {\n   r, e := http.Get(&quot;https://github.com/manifest.json&quot;)\n   if e != nil {\n      panic(e)\n   }\n   body := map[string]interface{}{}\n   json.NewDecoder(r.Body).Decode(&amp;body)\n   /*\n   [map[\n      id:com.github.android\n      platform:play\n      url:https://play.google.com/store/apps/details?id=com.github.android\n   ]]\n   */\n   fmt.Println(body[&quot;related_applications&quot;])\n}\n</code></pre>\n<p>but if you try to go one level deeper, it fails:</p>\n<pre><code>/*\ninvalid operation: body[&quot;related_applications&quot;][0] (type interface {} does not\nsupport indexing)\n*/\nfmt.Println(body[&quot;related_applications&quot;][0])\n</code></pre>\n<p>Instead, you would need to assert type at each level of depth:</p>\n<pre><code>/*\nmap[\n   id:com.github.android\n   platform:play\n   url:https://play.google.com/store/apps/details?id=com.github.android\n]\n*/\nfmt.Println(body[&quot;related_applications&quot;].([]interface{})[0])\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16376, "favorite_count": 11, "accepted_answer_id": 41818196, "answer_count": 4, "score": 22, "last_activity_date": 1618090892, "creation_date": 1485206646, "question_id": 41815909, "link": "https://stackoverflow.com/questions/41815909/is-there-a-way-to-extract-json-from-an-http-response-without-having-to-build-str", "title": "Is there a way to extract JSON from an http response without having to build structs?", "body": "<p>All of the ways I'm seeing involve building structs and unmarshalling the data into the struct. But what if I'm getting JSON responses with hundreds of fields? I don't want to have to create 100 field structs just to be able to get to the data I want. Coming from a Java background there are easy ways to simply get the http response as a string and then pass the JSON string into a JSON object that allows for easy traversal. It's very painless. Is there anything like this in Go?</p>\n\n<p>Java example in pseudo code:</p>\n\n\n\n<pre><code>String json = httpResponse.getBody();\nJsonObject object = new JsonObject(json); \nobject.get(\"desiredKey\");\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485207999, "post_id": 41815886, "comment_id": 70820668, "body": "You can&#39;t compile code that assigned the wrong number of return values, so I&#39;m not sure what you&#39;re suggestion is. Errors aren&#39;t conditions that &quot;should never happen&quot;, errors are returned and handled all the time, even under normal conditions."}], "answers": [{"tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 2, "last_activity_date": 1485208021, "last_edit_date": 1485208021, "creation_date": 1485207648, "answer_id": 41816171, "question_id": 41815886, "link": "https://stackoverflow.com/questions/41815886/changing-behavior-based-on-number-of-return-arguments-like-type-assertions/41816171#41816171", "title": "Changing behavior based on number of return arguments like type assertions", "body": "<p>Sadly they cannot be used in normal functions. As far as i know only type assertions, map value access and range allow it.</p>\n\n<p>Usually when you want to have a function with one and optional a second error argument you name them like</p>\n\n<pre><code>func DoSomething() (string, error) {...} // i will return an error\nfunc MustDoSomething() string {...}  // i will panic\n</code></pre>\n\n<p>An example would be <a href=\"https://golang.org/pkg/regexp/#MustCompile\" rel=\"nofollow noreferrer\">https://golang.org/pkg/regexp/#MustCompile</a></p>\n"}, {"tags": [], "owner": {"reputation": 3533, "user_id": 10278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904fd802987f5f63162639b0ac9de136?s=128&d=identicon&r=PG", "display_name": "pestophagous", "link": "https://stackoverflow.com/users/10278/pestophagous"}, "is_accepted": false, "score": 1, "last_activity_date": 1566268188, "last_edit_date": 1566268188, "creation_date": 1566185417, "answer_id": 57550160, "question_id": 41815886, "link": "https://stackoverflow.com/questions/41815886/changing-behavior-based-on-number-of-return-arguments-like-type-assertions/57550160#57550160", "title": "Changing behavior based on number of return arguments like type assertions", "body": "<p>This answer: <a href=\"https://stackoverflow.com/a/41816171/10278\">https://stackoverflow.com/a/41816171/10278</a> by @christian provides the best practical advice for how to emulate the \"overloaded-on-result-count\" pattern.</p>\n\n<p>My aim is to address another part of the question\u2014this part: \"But when I tried to find out how that could be done, I found nothing\".</p>\n\n<p>The following explains how it is done for Go type assertions.</p>\n\n<hr>\n\n<p>Invocations of type assertions in Go behave <em>as though they are overloaded based on number of results</em>.</p>\n\n<p>Yet, Go <a href=\"https://golang.org/doc/faq#overloading\" rel=\"nofollow noreferrer\">does not support overloading</a> of methods and operators.</p>\n\n<p>Looking at Go's implementation, here is the reason type assertions appear to be overloaded based on number of results:</p>\n\n<ul>\n<li>The Go <strong>compiler</strong> provides special handling that is peculiar to these <strong>built-in</strong> operations.</li>\n</ul>\n\n<p>This special dispatching occurs for the built-in concept of type assertions because the compiler is carving out special logic that is <strong><em>not</em></strong> available to non-built-in code.</p>\n\n<p>The Go compiler and runtime are written in Go.  That made it (somewhat) easy for me to discover that the compiler is the key to explaining this behavior.</p>\n\n<p>Take a look at this part of the compiler:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/blob/8d86ef2/src/cmd/compile/internal/gc/ssa.go#L4782\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/8d86ef2/src/cmd/compile/internal/gc/ssa.go#L4782</a></li>\n</ul>\n\n<p>The code comment already reveals a lot:</p>\n\n<pre><code>// dottype generates SSA for a type assertion node.\n// commaok indicates whether to panic or return a bool.\n// If commaok is false, resok will be nil.\n</code></pre>\n\n<p>We can go further by using a debugger to step through some type assertion code.</p>\n\n<p>Take <a href=\"https://play.golang.org/p/k5COwwguTiJ\" rel=\"nofollow noreferrer\">this playground snippet</a> for example.  Specifically, these lines:</p>\n\n<pre><code>object_as_closer_hardstop     := thing.(io.Closer) // will panic!!\nobject_as_closer,      ok     := thing.(io.Closer)\n</code></pre>\n\n<p>(If you <a href=\"https://golang.org/doc/install/source\" rel=\"nofollow noreferrer\">build Go from source</a>, then) if you use a debugger to step into the first type assertion, you will end up at the following code in the Go runtime:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/blob/8d86ef2/src/runtime/iface.go#L438\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/8d86ef2/src/runtime/iface.go#L438</a></li>\n</ul>\n\n<p>If you step into the second one, you end up at:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/blob/8d86ef2/src/runtime/iface.go#L454\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/8d86ef2/src/runtime/iface.go#L454</a></li>\n</ul>\n\n<p>On line 438, you see <code>func assertI2I</code> (with a single return value).  A bit lower, on line 454, you see <code>assertI2I2</code>.  Note that these two functions have nearly identical names, but not quite!  </p>\n\n<p>The second function has a trailing <code>2</code> at the end of its name.  That function also has <em>two returned results</em>.</p>\n\n<p>As we expect:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/blob/8d86ef2/src/runtime/iface.go#L438\" rel=\"nofollow noreferrer\">assertI2I</a> can panic, but</li>\n<li><a href=\"https://github.com/golang/go/blob/8d86ef2/src/runtime/iface.go#L454\" rel=\"nofollow noreferrer\">assertI2I2</a> cannot.</li>\n</ul>\n\n<p>(Look at the function bodies in <code>iface.go</code> and note which contains <code>panic</code>.)</p>\n\n<p><code>assertI2I</code> and <code>assertI2I2</code> abide by the overloading rules we expect. If they were to differ only by number of results, then those of us who compile Go from source would be unable to compile the Go runtime, due to a compiler error such as \"assertI2I redeclared\".</p>\n\n<p>Users of the language are generally not aware of these builtin runtime functions, so on the surface, both lines of code seem to call the same function:</p>\n\n<pre><code>object_as_closer_hardstop     := thing.(io.Closer) // will panic!!\nobject_as_closer,      ok     := thing.(io.Closer)\n</code></pre>\n\n<p>However, at compile time the compiler branches based on whether it found the case \"commaok\":</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/blob/8d86ef2/src/cmd/compile/internal/gc/ssa.go#L4871\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/8d86ef2/src/cmd/compile/internal/gc/ssa.go#L4871</a></li>\n</ul>\n\n<p>Our own end-user code does not get to modify Go's lexing/parsing/AST-walking in order to dispatch different flavors of our functions based on \"commaok\".</p>\n\n<p>For better or for worse, that is why user-written code cannot leverage this pattern.</p>\n"}], "owner": {"reputation": 4565, "user_id": 1968462, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ef24851a32cb6519312916524da2586?s=128&d=identicon&r=PG", "display_name": "Kat", "link": "https://stackoverflow.com/users/1968462/kat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1566268188, "creation_date": 1485206570, "question_id": 41815886, "link": "https://stackoverflow.com/questions/41815886/changing-behavior-based-on-number-of-return-arguments-like-type-assertions", "title": "Changing behavior based on number of return arguments like type assertions", "body": "<p>I've been learning Go and one thing that stood out as particularly interesting to me is the way that the behavior of type assertions changes based on how many return values are being captured:</p>\n\n<pre><code>var i interface{} = \"hello\"\n\nval, ok := i.(int) // All good\nfmt.Println(val, ok)\n\nval = i.(int) // Panics\nfmt.Println(val)\n</code></pre>\n\n<p>This feels like a pattern that can be very useful for user defined functions. The user either has to explicitly get the \"ok\" second return value or use an underscore to ignore it. In either case, they're making it clear that they're aware that the function can fail. Whereas if they just get one return value, it could silently fail. Hence, it seems reasonable to panic or similar if the user isn't checking for an error (which would be reasonable if the error should \"never\" happen). I assume that's the logic behind the language developers in making type assertions work this way.</p>\n\n<p>But when I tried to find out how that could be done, I found nothing. I'm aware that type assertions aren't an actual function. And many languages with multiple return values can't check how many return values are actually being used (MATLAB is the only one I'm aware of), but then again, most of those don't use behavior like the type assertions demonstrate.</p>\n\n<p>So, is it possible and if so, how? If not, is there a particular reason that this behavior was excluded despite it being possible with the built in type assertions?</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1485191781, "last_edit_date": 1485191781, "creation_date": 1485190796, "answer_id": 41811651, "question_id": 41811563, "link": "https://stackoverflow.com/questions/41811563/do-i-have-to-free-structs-created-with-cgo/41811651#41811651", "title": "Do I have to free structs created with Cgo?", "body": "<p>No. You only call <code>free</code> on something that was allocated via the C <code>*alloc</code> functions. The <code>C.CString</code> and <code>C.CBytes</code> functions are documented as doing so internally, and requiring the use of <code>C.free</code>.</p>\n\n<p>In this case even though <code>data</code> is of type <code>C.MyStruct_t</code> it is allocated in Go, and therefor will be handled by the Go garbage collector. </p>\n"}], "owner": {"reputation": 812, "user_id": 632689, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/684756f13f562481b9e3006770ef01e2?s=128&d=identicon&r=PG", "display_name": "anselm", "link": "https://stackoverflow.com/users/632689/anselm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "accepted_answer_id": 41811651, "answer_count": 1, "score": 1, "last_activity_date": 1485191781, "creation_date": 1485190500, "question_id": 41811563, "link": "https://stackoverflow.com/questions/41811563/do-i-have-to-free-structs-created-with-cgo", "title": "Do I have to free structs created with Cgo?", "body": "<p>I create C structs in my Go code, like this:</p>\n\n<pre><code>var data C.MyStruct_t\n</code></pre>\n\n<p>Do I have to free them manually at some point, like I do when I use CString? With CString I often do something like:</p>\n\n<pre><code>ctitle := C.String(title)\ndefer C.free(unsafe.Pointer(&amp;ctitle))\nC.my_func(&amp;ctitle)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1485189017, "post_id": 41810927, "comment_id": 70810176, "body": "Iris is <i>definitely not</i> the most popular Go framework. You can search for many articles documenting the behavior of the &quot;sole&quot; developer."}, {"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485189253, "post_id": 41810927, "comment_id": 70810310, "body": "@JimB could you link me to some please? I just jumped in so any advice is welcome"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1485189656, "post_id": 41810927, "comment_id": 70810603, "body": "<a href=\"http://www.florinpatan.ro/2016/10/why-you-should-not-use-iris-for-your-go.html\" rel=\"nofollow noreferrer\">florinpatan.ro/2016/10/&hellip;</a>. Beside the behavior of the author, IMHO simply having a project that routinely rewrites the history of the master branch makes it a non-starter for anything serious."}, {"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485190181, "post_id": 41810927, "comment_id": 70810957, "body": "@JimB well that looks shitty. I&#39;ll stick on iris for the start just to get the basics of Go. Can you recommend any other frameworks to go with? A powerful template renderer is very important (looping through data, including dynamic partial templates)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485190463, "post_id": 41810927, "comment_id": 70811148, "body": "I usually don&#39;t like full frameworks for Go, and only pull in individual components as needed. There&#39;s a decent list here that may help: <a href=\"https://github.com/avelino/awesome-go#web-frameworks\" rel=\"nofollow noreferrer\">github.com/avelino/awesome-go#web-frameworks</a>"}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485201445, "post_id": 41810927, "comment_id": 70817201, "body": "@JimB, this might not be the best place for this conversation but could you expand a bit more on why you do not like full frameworks for Go?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485202400, "post_id": 41810927, "comment_id": 70817682, "body": "disclaimer, I don&#39;t do a lot of web development; but I usually find complete frameworks aren&#39;t needed, the std lib is very complete, and you can piece together smaller external packages when you do need their functionality. For example, you&#39;re probably using one of the <a href=\"https://github.com/avelino/awesome-go#template-engines\" rel=\"nofollow noreferrer\">template packages here</a> in iris, which you could just import yourself if you don&#39;t want to use &quot;html/template&quot;. Decreasing the number of external dependencies you have can also make long-term support of your codebase easier."}], "answers": [{"comments": [{"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1485189496, "post_id": 41811118, "comment_id": 70810479, "body": "See my update. Could you provide some basic code example on importing function to be used as a <code>HandlerFunc</code> ?"}, {"owner": {"reputation": 964, "user_id": 4104496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nvkZ6.jpg?s=128&g=1", "display_name": "Shashi Bhushan", "link": "https://stackoverflow.com/users/4104496/shashi-bhushan"}, "reply_to_user": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1485197568, "post_id": 41811118, "comment_id": 70815146, "body": "I wrote a small sample based on your folder structure <a href=\"https://drive.google.com/file/d/0B1ZJ-CiBKRTBcTRBZUt1dW5zVm8/view?usp=sharing\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 964, "user_id": 4104496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nvkZ6.jpg?s=128&g=1", "display_name": "Shashi Bhushan", "link": "https://stackoverflow.com/users/4104496/shashi-bhushan"}, "is_accepted": false, "score": 0, "last_activity_date": 1485189189, "creation_date": 1485189189, "answer_id": 41811118, "question_id": 41810927, "link": "https://stackoverflow.com/questions/41810927/group-routers-into-external-files-in-iris-party/41811118#41811118", "title": "Group routers into external files in Iris, Party", "body": "<p>If you are planning to keep routes in separate file then you have two options </p>\n\n<ol>\n<li>Both main.go and api_routes.go MUST be in same package, probably in\nyour case it should be \"package main\" </li>\n<li>If you are keeping api_routes.go in separate package then you have to import that package in main.go.</li>\n</ol>\n"}], "owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485189456, "creation_date": 1485188564, "last_edit_date": 1485189456, "question_id": 41810927, "link": "https://stackoverflow.com/questions/41810927/group-routers-into-external-files-in-iris-party", "title": "Group routers into external files in Iris, Party", "body": "<p>I am learning Golang and decided to try out Iris as it is currently the most popular framework, just out of curiosity.</p>\n\n<p>How do I group routes into external files?</p>\n\n<p>main.go</p>\n\n<pre><code>// See apiRoutes here\napiRouter := iris.Party(\"/api\", apiRoutes)\n</code></pre>\n\n<p>api_routes.go</p>\n\n<pre><code>func apiRoutes() {\n\n    iris.Get(\"/blog\", ...)\n\n    iris.Get(\"/news\", ...)\n}\n</code></pre>\n\n<p>So a call to <code>/api/blog</code> would be processed within <code>api_routes.go</code> inside the <code>iris.Get(\"/blog\")</code> function.</p>\n\n<p>Update: My current project structure is like so. I would also like to continuously nest my routes:</p>\n\n<pre><code>|- Routes\n    |- api_routes.go\n    |- blog\n    |- blog_routes.go\n        |- posts\n            blog_posts_routes.go\n        |- categories\n            blog_categories_routes.go\n|- main.go\n</code></pre>\n"}, {"tags": ["file", "go", "permissions", "userid"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3519816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94805fb3d3bd48e239ec0d15aac00680?s=128&d=identicon&r=PG", "display_name": "Matt Bruzek", "link": "https://stackoverflow.com/users/3519816/matt-bruzek"}, "edited": false, "score": 1, "creation_date": 1485197557, "post_id": 41811645, "comment_id": 70815137, "body": "I saw <code>ModeSetuid  &#47;&#47; u: setuid</code> and <code>ModeSetgid  &#47;&#47; g: setgid</code> in the FileMode documentation and I was wondering if there was a way to mask the uid and gid in the resulting FileMode int."}, {"owner": {"reputation": 11022, "user_id": 317916, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21dda5ab7f19b2cf21502358eb0410e1?s=128&d=identicon&r=PG", "display_name": "cbednarski", "link": "https://stackoverflow.com/users/317916/cbednarski"}, "reply_to_user": {"reputation": 151, "user_id": 3519816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94805fb3d3bd48e239ec0d15aac00680?s=128&d=identicon&r=PG", "display_name": "Matt Bruzek", "link": "https://stackoverflow.com/users/3519816/matt-bruzek"}, "edited": false, "score": 0, "creation_date": 1559538257, "post_id": 41811645, "comment_id": 99437769, "body": "@MattBruzek Be careful, those mode bits mean something else: <a href=\"https://docs.oracle.com/cd/E19683-01/816-4883/secfile-69/index.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19683-01/816-4883/secfile-69/index.html</a>"}], "tags": [], "owner": {"reputation": 964, "user_id": 4104496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nvkZ6.jpg?s=128&g=1", "display_name": "Shashi Bhushan", "link": "https://stackoverflow.com/users/4104496/shashi-bhushan"}, "is_accepted": true, "score": 1, "last_activity_date": 1485190774, "creation_date": 1485190774, "answer_id": 41811645, "question_id": 41810404, "link": "https://stackoverflow.com/questions/41810404/how-to-set-gid-and-uid-in-os-filemode-in-golang/41811645#41811645", "title": "How to set gid and uid in os.FileMode in golang?", "body": "<p>Not sure what do you mean by one step, I use following method to set uid &amp; gid</p>\n\n<p>func Chown(path string, uid int, gid int)</p>\n\n<p><a href=\"https://golang.org/pkg/syscall/#Chown\" rel=\"nofollow noreferrer\">https://golang.org/pkg/syscall/#Chown</a></p>\n"}], "owner": {"reputation": 151, "user_id": 3519816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94805fb3d3bd48e239ec0d15aac00680?s=128&d=identicon&r=PG", "display_name": "Matt Bruzek", "link": "https://stackoverflow.com/users/3519816/matt-bruzek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 0, "accepted_answer_id": 41811645, "answer_count": 1, "score": 0, "last_activity_date": 1510004242, "creation_date": 1485186946, "last_edit_date": 1510004242, "question_id": 41810404, "link": "https://stackoverflow.com/questions/41810404/how-to-set-gid-and-uid-in-os-filemode-in-golang", "title": "How to set gid and uid in os.FileMode in golang?", "body": "<p>I want to set the uid and gid on files that are created by our golang application. It looks like the right place is use the <a href=\"https://golang.org/pkg/os/#FileMode\" rel=\"nofollow noreferrer\">os.FileMode</a>. I am looking for an example of setting the permissions and uid and gid all in one step.</p>\n\n<p>Setting the permissions looks pretty straightforward:</p>\n\n<pre><code>os.FileMode(hdr.Mode&amp;0777)\n</code></pre>\n\n<p>But I am not sure how to also set the uid/gid on FileMode.</p>\n"}, {"tags": ["go", "distributed"], "comments": [{"owner": {"reputation": 5133, "user_id": 154762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d07d8564c1726ca28a6b99e560f0ec7?s=128&d=identicon&r=PG", "display_name": "solarc", "link": "https://stackoverflow.com/users/154762/solarc"}, "edited": false, "score": 1, "creation_date": 1485187666, "post_id": 41810397, "comment_id": 70809228, "body": "You could use a queue like RabbitMQ. Google also released a project called <a href=\"http://www.grpc.io/docs/guides/\" rel=\"nofollow noreferrer\">gRPC</a> which you might like."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1485188263, "post_id": 41810397, "comment_id": 70809635, "body": "<a href=\"https://golang.org/pkg/net/rpc/\" rel=\"nofollow noreferrer\">&quot;net/rpc&quot;</a>, <a href=\"https://golang.org/pkg/net/rpc/jsonrpc/\" rel=\"nofollow noreferrer\">&quot;net/rpc/jsonrpc&quot;</a>, <a href=\"http://www.grpc.io/docs/guides/\" rel=\"nofollow noreferrer\">gRPC</a>, plain HTTP, asynchronously via message queue, take your pick."}, {"owner": {"reputation": 330, "user_id": 2996610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f3a59b1d471be646c0e835c2c8b5f756?s=128&d=identicon&r=PG&f=1", "display_name": "cheks", "link": "https://stackoverflow.com/users/2996610/cheks"}, "edited": false, "score": 0, "creation_date": 1485242658, "post_id": 41810397, "comment_id": 70832089, "body": "You can create simple api for speaking between your apps."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 817344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VqAif.jpg?s=128&g=1", "display_name": "hypersolid", "link": "https://stackoverflow.com/users/817344/hypersolid"}, "is_accepted": false, "score": 1, "last_activity_date": 1485787897, "creation_date": 1485787897, "answer_id": 41938805, "question_id": 41810397, "link": "https://stackoverflow.com/questions/41810397/how-to-connect-distributed-go-apps/41938805#41938805", "title": "How to connect distributed Go apps?", "body": "<p><strong>net/rpc</strong> - out of the box &amp; fast </p>\n\n<p><strong>gRPC</strong> - fast and universal (imo the way to go) </p>\n\n<p><strong>net/rpc/jsonrpc</strong> - good when you need human readable messages or want to integrate \ngo with client side js code</p>\n\n<p><strong>plain HTTP</strong> - overkill for communication between go programs, you'll have to plan routes and data encoding yourself, which is unnecessary effort</p>\n\n<p><strong>message queue</strong> - a bit slower approach, but you can benefit from advanced routing and persistence which they provide</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1485787897, "creation_date": 1485186922, "question_id": 41810397, "link": "https://stackoverflow.com/questions/41810397/how-to-connect-distributed-go-apps", "title": "How to connect distributed Go apps?", "body": "<p>I have two go apps running on different machines.\nI want them to communicate with each other in a native fast manner.</p>\n\n<p>How do I do it better? I worked with Erlang and find very handy the way it's implemented there.</p>\n\n<p>What are preferred ways to communicate between Go apps?</p>\n"}, {"tags": ["go", "tcp"], "comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1485188454, "post_id": 41810188, "comment_id": 70809783, "body": "Nevermind on the last question, I figured it out. <code>binary.LittleEndian.PutUint16(packet[2:], uint16(len(packet)))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1485187806, "post_id": 41810612, "comment_id": 70809329, "body": "This could work but it still doesn&#39;t really address the issue of inserting into an offset. Thanks."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1485188024, "post_id": 41810612, "comment_id": 70809492, "body": "@majidarif: Tis inserts at the offset 0, which you could change as needed. You can&#39;t <code>Write</code> to an offset, because a bytes.buffer doesn&#39;t have a seek method. The only way to &quot;write&quot; to a offset, is to take the buffered slice and write to that index specifically."}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1485188256, "post_id": 41810612, "comment_id": 70809630, "body": "I see. If that&#39;s the case, this is my only option. I updated my question. Can you check?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1485188468, "last_edit_date": 1485188468, "creation_date": 1485187546, "answer_id": 41810612, "question_id": 41810188, "link": "https://stackoverflow.com/questions/41810188/write-at-specific-offset-of-bytes-buffer/41810612#41810612", "title": "Write at specific offset of bytes.Buffer", "body": "<p>You can write the length directly to the slice after you have assembled the packet. You will also want to specify the length prefix size so that it is identical across platforms. </p>\n\n<pre><code>func CreatePacket(data []byte) []byte {\n    // leave 4 bytes at the start for the ID and length\n    b := bytes.NewBuffer(make([]byte, 4))\n\n    binary.Write(b, binary.LittleEndian, data)\n    packet := b.Bytes()\n\n    // insert the ID and prefix\n    binary.LittleEndian.PutUint16(packet, uint16(0xF3))\n    binary.LittleEndian.PutUint16(packet[2:], uint16(len(packet)))\n    return packet\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/35IX1c18a4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/35IX1c18a4</a></p>\n"}], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1869, "favorite_count": 0, "accepted_answer_id": 41810612, "answer_count": 1, "score": 1, "last_activity_date": 1485188468, "creation_date": 1485186264, "last_edit_date": 1485188254, "question_id": 41810188, "link": "https://stackoverflow.com/questions/41810188/write-at-specific-offset-of-bytes-buffer", "title": "Write at specific offset of bytes.Buffer", "body": "<p>I'm trying to write a game server and need to create the packet I'll be sending back to the client. I am writing all the data into a <code>bytes.Buffer</code> then I want to prefix the total size of the packet before getting the bytes and sending it to the client.</p>\n\n<p>I was thinking of something like this:</p>\n\n<pre><code>// is it bad to call `var b bytes.Buffer` every time I create a packet?\nfunc CreatePacket() []byte {\n  var b bytes.Buffer\n\n  // size\n  binary.Write(b, binary.LittleEndian, 0) // insert at end\n\n  // body (variable number of writes)\n  binary.Write(b, binary.LittleEndian, data)\n\n  // update the size at offset 0\n  binary.Write(b, binary.LittleEndian, b.Len())\n\n  return b.Bytes()\n}\n</code></pre>\n\n<p>But I can't find any method to seek or modify the offset.</p>\n\n<hr>\n\n<p>This doesn't work, why?</p>\n\n<pre><code>var packet = b.Bytes()\n\n// the size is really at offset 2. offset 0 is an ID.\nbinary.LittleEndian.PutUint16(packet, uint16(0xF3))\nbinary.LittleEndian.PutUint16(packet, uint16(len(packet)))\n</code></pre>\n"}, {"tags": ["bash", "curl", "go", "signature", "coinbase-api"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485194603, "post_id": 41809503, "comment_id": 70813484, "body": "Use time.Now().Unix(), or better, use a <a href=\"https://developers.coinbase.com/docs/wallet/client-libraries\" rel=\"nofollow noreferrer\">library</a>"}, {"owner": {"reputation": 173, "user_id": 3641692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0rbRy.png?s=128&g=1", "display_name": "zio", "link": "https://stackoverflow.com/users/3641692/zio"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1485201262, "post_id": 41809503, "comment_id": 70817101, "body": "@Mark the mentioned golang library is outdated and still uses v1"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 3641692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0rbRy.png?s=128&g=1", "display_name": "zio", "link": "https://stackoverflow.com/users/3641692/zio"}, "is_accepted": true, "score": 1, "last_activity_date": 1485201155, "creation_date": 1485201155, "answer_id": 41814472, "question_id": 41809503, "link": "https://stackoverflow.com/questions/41809503/coinbase-com-invalid-signature/41814472#41814472", "title": "Coinbase.com invalid signature", "body": "<p>For bash/curl the issue was the hmac tool I used with <code>echo</code>. Following worked for me with curl requests:</p>\n\n<pre><code>SIG=$(echo -n \"${TIMESTAMP}GET/v2/accounts\" | openssl dgst -sha256 -hmac \"$COINBASE_SECRET\" |cut -d' ' -f2);\n</code></pre>\n\n<p>In respect of golang I compared the hash sums and came to the conclusion that something is fishy with the current library I am using.</p>\n\n<p>I wrote a library on my own (<a href=\"https://github.com/Zauberstuhl/go-coinbase\" rel=\"nofollow noreferrer\">https://github.com/Zauberstuhl/go-coinbase</a>) and now it works like a charm.\nI am doing the same like above except I am using <code>Sprintf</code> for the final encoding but that should be the same.</p>\n\n<p>Thanks anyway!</p>\n"}], "owner": {"reputation": 173, "user_id": 3641692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0rbRy.png?s=128&g=1", "display_name": "zio", "link": "https://stackoverflow.com/users/3641692/zio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 41814472, "answer_count": 1, "score": 0, "last_activity_date": 1485779400, "creation_date": 1485184226, "question_id": 41809503, "link": "https://stackoverflow.com/questions/41809503/coinbase-com-invalid-signature", "title": "Coinbase.com invalid signature", "body": "<p>I searched the other posts since I am not the only person with signature issues. I tried it with couple of languages and I always have the same problem.</p>\n\n<p>What am I doing wrong with the API authentication with coinbase.com:</p>\n\n<pre><code># normally I fetch the timestamp from https://api.coinbase.com/v2/time\nTIMESTAMP=$(date +%s)\nSIG=$(echo -n \"${TIMESTAMP}GET/v2/accounts\" | hmac256 --stdkey $COINBASE_SECRET)\n\ncurl https://api.coinbase.com/v2/accounts \\\n  --header \"CB-ACCESS-KEY: $COINBASE_KEY\" \\\n  --header \"CB-ACCESS-SIGN: $SIG\" \\\n  --header \"CB-ACCESS-TIMESTAMP: $TIMESTAMP\" \\\n  --header \"CB-VERSION: 2016-03-08\"\n</code></pre>\n\n<p>In go I am trying to do something like:</p>\n\n<pre><code>nonce := strconv.FormatInt(int64(time.Data.Epoch), 10)\nmessage := nonce + req.Method + endpoint // endpoint \"/v2/accounts\"\nreq.Header.Set(\"CB-ACCESS-KEY\", a.Key)\nh := hmac.New(sha256.New, []byte(a.Secret))\nh.Write([]byte(message))\n\nsignature := hex.EncodeToString(h.Sum(nil))\n\nreq.Header.Set(\"CB-ACCESS-SIGN\", signature)\nreq.Header.Set(\"CB-ACCESS-TIMESTAMP\", nonce)\nreq.Header.Set(\"CB-VERSION\", \"2016-03-08\")\n</code></pre>\n\n<p>Also it seams that the sandbox is no longer supported since <code>api.sandbox.coinbase.com</code> is unavailable?!</p>\n\n<p>Kind regards</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485182392, "post_id": 41808761, "comment_id": 70805724, "body": "To run things concurrently, you start them in a separate goroutine -- what exactly are you asking here?"}, {"owner": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485183372, "post_id": 41808761, "comment_id": 70806369, "body": "I can start them in a separate go routine. How can I run few different ones and collect their results for my webservice which runs in the same process? I am asking for best practices"}], "answers": [{"comments": [{"owner": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "edited": false, "score": 0, "creation_date": 1485184942, "post_id": 41809573, "comment_id": 70807373, "body": "this helps a lot. I am trying to find some design pattern for this sort of problem. Would like to keep it as compact as possible. want to avoid databases and intermediate files."}], "tags": [], "owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "is_accepted": false, "score": 0, "last_activity_date": 1485184459, "creation_date": 1485184459, "answer_id": 41809573, "question_id": 41808761, "link": "https://stackoverflow.com/questions/41808761/channels-running-in-the-background-and-collecting-data/41809573#41809573", "title": "channels running in the background and collecting data", "body": "<p>You should first find some lib or write some kind of utility that allow you to run continuosly a task, that actually your code is not doing.</p>\n\n<p>For example: <a href=\"https://github.com/jasonlvhit/gocron\" rel=\"nofollow noreferrer\">https://github.com/jasonlvhit/gocron</a></p>\n\n<p>This is just an example, I do not know if this lib is fine or not.</p>\n\n<p>Then you should choose the interface between your task and your web service.</p>\n\n<p>You could run all in one, and use channels, one per task to comunicating with the go routines.</p>\n\n<p>Or you can write text files with the data that your go rountines write and your web service read and process.</p>\n\n<p>There are several other methods or solutions, this are just the easiest I could think about right now.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485184459, "creation_date": 1485182020, "question_id": 41808761, "link": "https://stackoverflow.com/questions/41808761/channels-running-in-the-background-and-collecting-data", "title": "channels running in the background and collecting data", "body": "<p>I am trying to run few functions periodically AND in the background because I am also serving a webservice.</p>\n\n<pre><code>import (\"strings\")\nfunc run (cmd string, c chan []byte) {\n    parts := strings.Fields(cmd)\n    head := parts[0]\n    parts = parts[1:len(parts)]\n\n    out, err := exec.Command(head, parts...).Output()\n        if err !=nil {\n            log.Fatal(err)\n        }\n    c &lt;-out\n}\n\nfunc main() {\n      c:=make(chan []byte)\n      go run (\"date\",c)\n      output :=string(&lt;-c)\n}\n</code></pre>\n\n<p>I would like to run commands such as \"date\", \"uptime\", \"ps\" every few seconds and in the background The web service (net/http) will be running in the foreground outputing the results of these functions. </p>\n\n<p>What is the best way to achieve this?</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1485172622, "post_id": 41804843, "comment_id": 70799101, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28958192/whats-wrong-with-this-golang-code/28958240#28958240\">What&#39;s wrong with this golang code?</a>; and <a href=\"http://stackoverflow.com/questions/28307783/goroutine-does-not-execute-if-time-sleep-included/28307829#28307829\">Goroutine does not execute if time.Sleep included</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": true, "score": 2, "last_activity_date": 1485170864, "last_edit_date": 1485170864, "creation_date": 1485169931, "answer_id": 41804994, "question_id": 41804843, "link": "https://stackoverflow.com/questions/41804843/golang-concurrency-and-blocking-with-a-single-channel-explanation-needed/41804994#41804994", "title": "Golang concurrency and blocking with a single channel, explanation needed", "body": "<p>In Go, the program exits as soon as the main function returns regardless of whether other goroutines are still running or not. If you want to make sure the main function does not exit prematurely, you need some synchronization mechanism. <a href=\"https://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/\" rel=\"nofollow noreferrer\">https://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/</a>\n<br>You don\u2019t absolutely have to use synchronization primitives, you could also do it with channels only, arguably a more idiomatic way to do it.</p>\n"}], "owner": {"reputation": 197, "user_id": 3395865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb907f9e29efed2878247c074bd3a53?s=128&d=identicon&r=PG", "display_name": "Alex Rudakov", "link": "https://stackoverflow.com/users/3395865/alex-rudakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 41804994, "answer_count": 1, "score": 0, "last_activity_date": 1485170864, "creation_date": 1485169444, "question_id": 41804843, "link": "https://stackoverflow.com/questions/41804843/golang-concurrency-and-blocking-with-a-single-channel-explanation-needed", "title": "Golang concurrency and blocking with a single channel, explanation needed", "body": "<p>I'm playing around with the code presented on <a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency/5</a>. My idea was that I could simplify the code by getting rid of the quit channel and still keep the correct program behavior - just for learning purposes.</p>\n\n<p>Here is the code I've got (simplified it even more for better readability):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc sendNumbers(c chan int) {  \n    for i := 0; i &lt; 2; i++ {\n        c &lt;- i\n    }\n}\n\nfunc main() {\n    c := make(chan int)\n    go func() {\n        for i := 0; i &lt; 2; i++ {\n            fmt.Println(&lt;-c)\n        }\n    }()\n    time.Sleep(0 * time.Second)\n    sendNumbers(c)\n}\n</code></pre>\n\n<p>In this code, the go routine I spawn should be able to receive 2 numbers before it returns. The sendNumbers() function I call next sends exactly 2 numbers to the channel c.</p>\n\n<p>So, the expected output of the program is 2 lines: 0 and 1. However, what I'm getting when I run the code on the page, is just a single line containing 0.</p>\n\n<p>Note the </p>\n\n<pre><code>time.Sleep(0 * time.Second) \n</code></pre>\n\n<p>though that I deliberately added before calling sendNumbers(c). If I change it to</p>\n\n<pre><code>time.Sleep(1 * time.Second) \n</code></pre>\n\n<p>The output becomes as expected:</p>\n\n<pre><code>0\n1\n</code></pre>\n\n<p>So, I'm confused with what happens. Can someone explain what is going on? Shouldn't both sends and receives block regardless of how much time is passed before I call sendNumbers()?</p>\n"}, {"tags": ["go", "blockchain", "hyperledger", "hyperledger-fabric"], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 1, "last_activity_date": 1485170125, "creation_date": 1485170125, "answer_id": 41805056, "question_id": 41803562, "link": "https://stackoverflow.com/questions/41803562/chaincode-function-to-display-struct-values/41805056#41805056", "title": "Chaincode function to display struct values", "body": "<p>I didn't know about Hyperledger until now, but after a look at the github documentation, I get you would use <code>stub.PutState</code> to store your customer information, then later use <code>stub.GetState</code> to get it back.</p>\n\n<p>As both methods request a byte slice, my guess would be something along these lines:</p>\n\n<pre><code>func (t *SimpleChaincode) setDetails(stub shim.ChaincodeStubInterface, args []string) ([]byte, error) {\n\n    if len(args) &lt; 3 {\n        return nil, errors.New(\"insert Into Table failed. Must include 3 column values\")\n    }\n\n    customer := &amp;Customer{}\n    customer.UID = args[0]\n    customer.Name = args[1]\n    customer.Address.Country = args[2]\n\n    raw, err := json.Marshal(customer)\n    if err != nil {\n        return nil, err\n    }\n\n    err := stub.PuState(customer.UID, raw)\n    if err != nil {\n        return nil, err\n    }\n\n    return nil, nil\n}\n\nfunc (t *SimpleChaincode) getDetails(stub shim.ChaincodeStubInterface, args []string) ([]byte, error) {\n\n    if len(args) != 1 {\n        return nil, errors.New(\"Incorrect number of arguments. Expecting name of the key to query\")\n    }\n\n    return stub.GetState(args[0])\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7424515, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XGwT0JQXTlI/AAAAAAAAAAI/AAAAAAAACjY/H6OlQ-1dwYU/photo.jpg?sz=128", "display_name": "Aditi", "link": "https://stackoverflow.com/users/7424515/aditi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 0, "accepted_answer_id": 41805056, "answer_count": 1, "score": 0, "last_activity_date": 1485170125, "creation_date": 1485165640, "last_edit_date": 1485169643, "question_id": 41803562, "link": "https://stackoverflow.com/questions/41803562/chaincode-function-to-display-struct-values", "title": "Chaincode function to display struct values", "body": "<p>I'm trying to write a simple chaincode that uses a structure to store customer details. I have one setDetails func that works fine. I wish to write another getDetails func that takes UID as arguement and prints the details of the customer with that UID. Need Help!</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"github.com/hyperledger/fabric/core/chaincode/shim\"\n)\n\ntype Customer struct {\n    UID     string\n    Name    string\n    Address struct {\n        StreetNo string\n        Country  string\n    }\n}\n\ntype SimpleChaincode struct {\n}\n\nfunc (t *SimpleChaincode) Init(stub shim.ChaincodeStubInterface) ([]byte, error) {\n    fmt.Printf(\"initialization done!!!\")\n    fmt.Printf(\"initialization done!!!\")\n\n    return nil, nil\n}\n\nfunc (t *SimpleChaincode) setDetails(stub shim.ChaincodeStubInterface, args []string) ([]byte, error) {\n\n    if len(args) &lt; 3 {\n        return nil, errors.New(\"insert Into Table failed. Must include 3 column values\")\n    }\n\n    customer := &amp;Customer{}\n    customer.UID = args[0]\n    customer.Name = args[1]\n    customer.Address.Country = args[2]\n\n    return nil, nil\n}\n\nfunc (t *SimpleChaincode) getDetails(stub shim.ChaincodeStubInterface, args []string) ([]byte, error) {\n\n    //wish to print all details of an particular customer corresponding to the UID\n    return nil, nil\n}\nfunc (t *SimpleChaincode) Invoke(stub shim.ChaincodeStubInterface) ([]byte, error) {\n    function, args := stub.GetFunctionAndParameters()\n    fmt.Printf(\"Inside Invoke %s\", function)\n    if function == \"setDetails\" {\n        return t.setDetails(stub, args)\n\n    } else if function == \"getDetails\" {\n        return t.getDetails(stub, args)\n    }\n\n    return nil, errors.New(\"Invalid invoke function name. Expecting  \\\"query\\\"\")\n}\n\nfunc main() {\n    err := shim.Start(new(SimpleChaincode))\n    if err != nil {\n        fmt.Printf(\"Error starting Simple chaincode: %s\", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1485166539, "post_id": 41802835, "comment_id": 70795240, "body": "If you have a general need to do batches of concurrent work and control throttling the number of concurrent &quot;threads&quot;, you could use (or copy) the <code>code.cloudfoundry.org&#47;workpool</code> package like so: <a href=\"https://play.golang.org/p/XKbT67vP6i\" rel=\"nofollow noreferrer\">play.golang.org/p/XKbT67vP6i</a> (note this won&#39;t actually run in the playground because it imports an external package)."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485179181, "post_id": 41803226, "comment_id": 70803521, "body": "I like this one, good idea to split the data between the workers to make them independent but you are still copying the data. An improvement is to only send the two indexes (start and stop) in the channel and then you get access to data in read only (thread-safe). An other improvement is to dedicate slice between the workers at the begining. No channel anymore, but you could have a goroutine which has no more work when another as still a lot of work to do, but should be ok on average. Last point, not sure race condition could occurs on a boolean in such an use case (in my first run)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485179506, "post_id": 41803226, "comment_id": 70803736, "body": "@S&#233;b First, data is not copied. <code>[]My</code> is a <i>slice</i> not an array. If slice vs array is not clear, check out blog post <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a>. 2nd, a slice is little bigger than just sending the indices (see <a href=\"https://golang.org/pkg/reflect/#SliceHeader\" rel=\"nofollow noreferrer\"><code>reflect.SliceHeader</code></a>, it&#39;s just a pointer and 2 <code>int</code> numbers). 3rd, data race does occur. Don&#39;t guess, run it with the <code>-race</code> option to see."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485180154, "post_id": 41803226, "comment_id": 70804202, "body": "@S&#233;b And about &quot;unharmful&quot; data race, read <a href=\"http://stackoverflow.com/questions/41406501/is-it-safe-to-read-a-function-pointer-concurrently-without-a-lock/41407827#41407827\">Is it safe to read a function pointer concurrently without a lock?</a>"}, {"owner": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485197300, "post_id": 41803226, "comment_id": 70814979, "body": "Ok, I read your link, and I&#39;m convinced about data race on boolean. More important (and I run some test), there is no really overhead to use sync/atomic. Ok for the information about slice, I wasn&#39;t aware about it, really intersting. So your solution is really good. At last, I didn&#39;t know about ranging a channel. So Three important facts learn, thanks."}, {"owner": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485252794, "post_id": 41803226, "comment_id": 70837932, "body": "I made more tests, this solutions is actually the most efficient, even for a small treatment (counting a kind of char in a short sentence), this is the fastest."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1485166853, "last_edit_date": 1485166853, "creation_date": 1485164704, "answer_id": 41803226, "question_id": 41802835, "link": "https://stackoverflow.com/questions/41802835/how-to-make-parallel-generic-go-treatment/41803226#41803226", "title": "How to make parallel generic go treatment?", "body": "<p>First, your solution has data race. You're reading and modifying the <code>stopped</code> variable from multiple goroutines.</p>\n\n<p>An easy solution could be to divide the index range of the passed slice, and have multiple goroutines process the different index ranges. This is how it could look like:</p>\n\n<pre><code>func process(ms []My) {\n    workers := 5\n    count := len(ms) / workers\n    if count*workers &lt; len(ms) {\n        count++\n    }\n\n    wg := &amp;sync.WaitGroup{}\n    for idx := 0; idx &lt; len(ms); {\n        wg.Add(1)\n        idx2 := idx + count\n        if idx2 &gt; len(ms) {\n            idx2 = len(ms)\n        }\n        ms2 := ms[idx:idx2]\n        idx = idx2\n        go func() {\n            defer wg.Done()\n            for i := range ms2 {\n                handle(&amp;ms2[i])\n            }\n        }()\n    }\n    wg.Wait()\n}\n\nfunc handle(m *My) {}\n</code></pre>\n\n<p>For the number of worker goroutines you could use <code>runtime.GOMAXPROCS()</code>, as if processing the entries does not involve IO operations (or waiting for something outside of the goroutine), no need to have the Go runtime manage more goroutines than those that can run actively:</p>\n\n<pre><code>workers := runtime.GOMAXPROCS(0)\n</code></pre>\n\n<p>Note that although this solution does not involve sending entries through a channel, if one (some) goroutine finishes earlier, CPU utilization might drop at the end (when less goroutines have work to do).</p>\n\n<p>The advantage of the producer-consumer model is that all worker goroutines will work equally till the end. But yes, the communication overhead might not be negligible. Whether one is better than the other depends on the amount of work that needs to be done on each entry.</p>\n\n<p>An improved version could mix the 2: you could send smaller slices, smaller index ranges over a channel, e.g. batches of 100 entries. This could reduce the idle time compared to the first solution, and could also reduce the communication overhead as entries are sent over the channel individually, so the values sent is only one hundredth of the total number.</p>\n\n<p>This is an example implementation of this improved, mixed version:</p>\n\n<pre><code>func process(ms []My) {\n    workers := runtime.GOMAXPROCS(0)\n    // 100 jobs per worker average:\n    count := len(ms) / workers / 100\n    if count &lt; 1 {\n        count = 1\n    }\n\n    ch := make(chan []My, workers*2) // Buffer size scales with # of workers\n\n    wg := &amp;sync.WaitGroup{}\n\n    // Start workers\n    wg.Add(workers)\n    for i := 0; i &lt; workers; i++ {\n        go func() {\n            defer wg.Done()\n            for ms2 := range ch {\n                for j := range ms2 {\n                    handle(&amp;ms2[j])\n                }\n            }\n        }()\n    }\n\n    // Send jobs:\n    for idx := 0; idx &lt; len(ms); {\n        idx2 := idx + count\n        if idx2 &gt; len(ms) {\n            idx2 = len(ms)\n        }\n        ch &lt;- ms[idx:idx2]\n        idx = idx2\n    }\n\n    // Jobs sent, close channel:\n    close(ch)\n\n    // Wait workers to finish processing all jobs:\n    wg.Wait()\n}\n</code></pre>\n\n<p>Note that there is no <code>stopping</code> variable to signal completion. Instead we used a <code>for range</code> on a channel in each goroutine, as this ranges over the channel until the channel is closed, and it's safe for concurrent use. Once the channel is closed <em>and</em> the goroutines processed all jobs sent on the channel, they terminate, and so does the overall processing algorithm (and not earlier \u2013 meaning all jobs will be processed).</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485178200, "post_id": 41803356, "comment_id": 70802814, "body": "You are creating as many goroutines as the number of elements in the input list, I think you are going to hurt a bottleneck in performance this way in my experience."}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "reply_to_user": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485186729, "post_id": 41803356, "comment_id": 70808541, "body": "It depends on how big the input is, how long/predicable \u2018process\u2019 is, how many cores you have, etc. You know the 3 rules of performance optimization: measure, measure, measure."}, {"owner": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485194336, "post_id": 41803356, "comment_id": 70813342, "body": "You&#39;re right, but it&#39;s really measurements which tell me to reuse threads instead of creating, I already test that into a problem a few weeks ago."}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 0, "last_activity_date": 1485166367, "last_edit_date": 1485166367, "creation_date": 1485165035, "answer_id": 41803356, "question_id": 41802835, "link": "https://stackoverflow.com/questions/41802835/how-to-make-parallel-generic-go-treatment/41803356#41803356", "title": "How to make parallel generic go treatment?", "body": "<p>I would not mix channels and synchronization primitives. Use of channels exclusively is idiomatic Go. Bear in mind that Go routines are not threads, there are much lighter with low overhead. Launching one million of them is not a big deal.<br>If the order of the result does not matter, I would do something like this:</p>\n\n<pre><code>func parallelRun(input []WhateverInputType) []WhateverOutputType {\n    out := make(chan WhateverOutputType, len(input))\n    for _, item := range input {\n        go func(i WhateverInputType) {\n            out &lt;- process(i)\n        }(item)\n    }\n\n    res := make([]WhateverOutputType, len(input))\n    for i := 0; i &lt; len(input); i++ {\n        res[i] = &lt;-out\n    }\n\n    return res\n}\n\nfunc process(input WhateverInputType) WhateverOutputType {\n    time.Sleep(50 * time.Millisecond)\n    return WhateverOutputType{}\n}\n</code></pre>\n\n<p>Assuming \u2018process\u2019 takes much longer than collecting the result, I would even use a blocking channel <code>out := make(chan WhateverOutputType)</code><br>Please note that passing arrays as parameters is not ideal (there are copied) but I tried to keep the spirit of your original code.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "edited": false, "score": 0, "creation_date": 1485197353, "post_id": 41812661, "comment_id": 70815017, "body": "Ok after all the readings, ok only if entries is not modified during the run, otherwise a data race could occur"}], "tags": [], "owner": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "is_accepted": false, "score": 0, "last_activity_date": 1485194259, "creation_date": 1485194259, "answer_id": 41812661, "question_id": 41802835, "link": "https://stackoverflow.com/questions/41802835/how-to-make-parallel-generic-go-treatment/41812661#41812661", "title": "How to make parallel generic go treatment?", "body": "<p>After searching I get the following with no copy of data using a shared index:</p>\n\n<pre><code>func myrunMT(entries []WhatEverType) int {\n    lastone := int32(len(entries)-1)\n    current := int32(0)\n    var wg sync.WaitGroup\n    threads := 5\n    //start threads\n    wg.Add(threads)\n    for i := 0; i &lt; threads; i++ {\n        go func() {\n            for {\n                idx := atomic.AddInt32(&amp;current, 1)-1\n                if Loadint32(&amp;current) &gt; Loadint32(&amp;lastone) {\n                    break\n                } \n                dotreatment(entries[idx])\n            }\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 7413485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f24f233bad486f321b2f668905126?s=128&d=identicon&r=PG&f=1", "display_name": "S&#233;b", "link": "https://stackoverflow.com/users/7413485/s%c3%a9b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1485194259, "creation_date": 1485163443, "question_id": 41802835, "link": "https://stackoverflow.com/questions/41802835/how-to-make-parallel-generic-go-treatment", "title": "How to make parallel generic go treatment?", "body": "<p>I have the following function:</p>\n\n<pre><code>func myrun(entries []WhatEverType) {\n    for i := range entries {\n        dotreatment(entries[i])\n    } \n}\n</code></pre>\n\n<p>I want to make parallel calls to dotreatment, I tried the following:</p>\n\n<pre><code>    func myrunMT(entries []WhatEverType) {\n        var wg sync.WaitGroup\n        stopped := false\n        threads := 5 //number of threads could be argument\n        com := make(chan WhatEverType, 100) //size of chan could be argument\n        wg.Add(threads)\n        for i := 0; i &lt; threads; i++ {\n            go func() {\n                for !stopped || len(com) {\n                    select {\n                        case entry := &lt;-com:\n                            dotreatment(entry) //lock if necessary\n                        case time.After(100*time.Millisecond):\n                    }\n                }\n                wg.Done()\n            }()\n        }\n        for _, entry := range entries {\n            com &lt;- entry\n        }\n        stopped = true\n        wg.Wait()\n    }\n</code></pre>\n\n<p></p>\n\n<p>Is there any better way to do it? Especially I would like to avoid sending all the entries through a chan and only use a shared index between the go routines.</p>\n"}, {"tags": ["json", "go", "twitter"], "comments": [{"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1599544533, "post_id": 41798046, "comment_id": 112797451, "body": "The JSON mentioned in the question is extremely small. When we say large JSON we assume that the size of the JSON is in GBsor at least a few thousand MBs"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5888605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87351b6344dd48c47d6fc525975d2e8d?s=128&d=identicon&r=PG&f=1", "display_name": "junior jasin", "link": "https://stackoverflow.com/users/5888605/junior-jasin"}, "edited": false, "score": 0, "creation_date": 1485186140, "post_id": 41798319, "comment_id": 70808204, "body": "thank you very much, this works fine and forgive me for such a silly question."}], "tags": [], "owner": {"reputation": 737, "user_id": 6275844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f7071f7e0149f02e945420a120a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan 0", "link": "https://stackoverflow.com/users/6275844/dan-0"}, "is_accepted": true, "score": 3, "last_activity_date": 1485137393, "creation_date": 1485137393, "answer_id": 41798319, "question_id": 41798046, "link": "https://stackoverflow.com/questions/41798046/how-to-parse-huge-json-in-golang/41798319#41798319", "title": "How to parse huge json in Golang", "body": "<p>In this case you are not unmarshalling a single JSON object, but an array of JSON objects which is why you're having an issue parsing the API response. The error your seeing this is telling you the actual type of <code>f</code>. The other example worked because it is a single JSON object, which can be mapped as a <code>map[string]interface{}</code> Take a look at this:</p>\n\n<pre><code>var f []interface{}\nerr := json.Unmarshal(str, &amp;f)\nif err != nil {\n    fmt.Println(err)\n    return\n}\n\nfor _, v := range f {\n    z := v.(map[string]interface{})\n    for k2, v2 := range z {\n        fmt.Println(\"Key:\", k2, \"Value:\", v2)\n    }\n}\n</code></pre>\n\n<p><code>f</code> should be of type <code>[]interface{}</code> an array of interfaces. Depending on how you plan on parsing the API response, you can do something like I'm doing in the for loop to present each key, value pair.</p>\n"}], "owner": {"reputation": 21, "user_id": 5888605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87351b6344dd48c47d6fc525975d2e8d?s=128&d=identicon&r=PG&f=1", "display_name": "junior jasin", "link": "https://stackoverflow.com/users/5888605/junior-jasin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2298, "favorite_count": 0, "accepted_answer_id": 41798319, "answer_count": 1, "score": 0, "last_activity_date": 1485138644, "creation_date": 1485134849, "last_edit_date": 1485138644, "question_id": 41798046, "link": "https://stackoverflow.com/questions/41798046/how-to-parse-huge-json-in-golang", "title": "How to parse huge json in Golang", "body": "<p>I'm new to Golang and I am trying to parse large json like the ones you get from an API which have lots of data. The <a href=\"https://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">documentation</a> explains how to do this with any json:</p>\n\n<pre><code>b := []byte(`{\"Name\":\"Wednesday\",\"Age\":6,\"Parents\":[\"Gomez\",\"Morticia\"]}`)\nvar f interface{}\nerr := json.Unmarshal(b, &amp;f)\nm := f.(map[string]interface{})\n</code></pre>\n\n<p>This works fine, but when I use a json that I get from the Twitter API, like the one at the end of the reference on the <a href=\"https://dev.twitter.com/rest/reference/get/favorites/list\" rel=\"nofollow noreferrer\">Twitter dev site</a> I get this error: </p>\n\n<blockquote>\n  <p>interface conversion: interface {} is []interface {}, not map[string]interface {}</p>\n</blockquote>\n\n<p>I know that there are similar questions but I couldn't find the answer. Can someone recommend me the better way to solve this?</p>\n\n<p>My go version go1.6.2 linux/amd64.</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3605221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03fcc1ba4a3b3e0230137efa7f72be11?s=128&d=identicon&r=PG&f=1", "display_name": "l4c", "link": "https://stackoverflow.com/users/3605221/l4c"}, "edited": false, "score": 0, "creation_date": 1485170708, "post_id": 41802177, "comment_id": 70797937, "body": "Thank you for the answer icza, this solved the problem perfectly."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1485161553, "last_edit_date": 1485161553, "creation_date": 1485161173, "answer_id": 41802177, "question_id": 41797976, "link": "https://stackoverflow.com/questions/41797976/insert-data-in-mongodb-using-mgo/41802177#41802177", "title": "Insert data in MongoDB using mgo", "body": "<p>First, you seem to want the results sorted by <code>Endpoint</code>. If you don't specify any sort order when querying, you can have no guarantee of any specific order. So query them like this:</p>\n\n<pre><code>err := collection.Find(nil).Sort(\"endpoint\").All(&amp;results)\n</code></pre>\n\n<p>Next, what you want is not the JSON representation of the results. To get the format you want, use the following loop:</p>\n\n<pre><code>w.Write([]byte{'{'})\nfor i, slow := range results {\n    if i &gt; 0 {\n        w.Write([]byte{','})\n    }\n    w.Write([]byte(fmt.Sprintf(\"\\n\\t\\\"%s\\\":\\\"%v\\\"\", slow.Endpoint, slow.Time)))\n}\nw.Write([]byte(\"\\n}\"))\n</code></pre>\n\n<p>Output is as you expect it (try it on the <a href=\"https://play.golang.org/p/8NN0-ZO6tW\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\n    \"/api/endpoint1\":\"0.8s\",\n    \"/api/endpoint2\":\"0.7s\"\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3605221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03fcc1ba4a3b3e0230137efa7f72be11?s=128&d=identicon&r=PG&f=1", "display_name": "l4c", "link": "https://stackoverflow.com/users/3605221/l4c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 41802177, "answer_count": 1, "score": 1, "last_activity_date": 1485161553, "creation_date": 1485134244, "question_id": 41797976, "link": "https://stackoverflow.com/questions/41797976/insert-data-in-mongodb-using-mgo", "title": "Insert data in MongoDB using mgo", "body": "<p>I'm trying to insert some data in MongoDB using mgo but the outcome is not what I wanted.</p>\n\n<p><strong>My struct</strong></p>\n\n<pre><code>    type Slow struct {\n    Endpoint string\n    Time     string\n    }\n</code></pre>\n\n<p><strong>My insert statement</strong></p>\n\n<pre><code>err := collection.Insert(&amp;Slow{endpoint, e}) \nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p><strong>How I'm trying to print it</strong></p>\n\n<pre><code>    var results []Slow\n\n    err := collection.Find(nil).All(&amp;results)\n    if err != nil {\n        panic(err)\n    }   \n    s, _ := json.MarshalIndent(results, \"  \", \"  \")\n    w.Write(s)\n</code></pre>\n\n<p><strong>My output (Marshaled JSON)</strong></p>\n\n<pre><code>   [{\n       \"Endpoint\": \"/api/endpoint1\",\n       \"Time\": \"0.8s\"\n    },\n    {\n       \"Endpoint\": \"/api/endpoint2\",\n       \"Time\": \"0.7s\"\n    }]\n</code></pre>\n\n<p><strong>What I wanted</strong></p>\n\n<pre><code>    {\n      \"/api/endpoint1\":\"0.8s\",\n      \"/api/endpoint2\":\"0.7s\"\n    }\n    //No brackets\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "pass-by-reference"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1485125550, "post_id": 41796979, "comment_id": 70782364, "body": "You are passing a pointer, but you don&#39;t need one to modify an element in a slice: <a href=\"https://play.golang.org/p/vVSIhkcUUb\" rel=\"nofollow noreferrer\">play.golang.org/p/vVSIhkcUUb</a>"}], "answers": [{"tags": [], "owner": {"reputation": 477, "user_id": 2837627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc1305a2799a4577f0970042c67d639?s=128&d=identicon&r=PG&f=1", "display_name": "hbagdi", "link": "https://stackoverflow.com/users/2837627/hbagdi"}, "is_accepted": true, "score": 1, "last_activity_date": 1500849968, "last_edit_date": 1500849968, "creation_date": 1485125613, "answer_id": 41797067, "question_id": 41796979, "link": "https://stackoverflow.com/questions/41796979/how-to-pass-by-reference-so-i-can-modify-it-in-the-calling-function/41797067#41797067", "title": "How to pass by reference so I can modify it in the calling function?", "body": "<p>Dereferencing a pointer has higher precedence.<br>\nHere is a code that works: <a href=\"https://play.golang.org/p/9Bcw_9Uvwl\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9Bcw_9Uvwl</a>   </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc process(names *[]string) {\n    fmt.Println(\"Pre process\", *names)\n    (*names)[1] = \"modified\"\n}\n\nfunc main() {\n    names := []string{\"leto\", \"paul\", \"teg\"}\n    process(&amp;names)\n    fmt.Println(\"Post process\", names)\n}\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 41797067, "answer_count": 1, "score": -1, "last_activity_date": 1500849968, "creation_date": 1485125120, "question_id": 41796979, "link": "https://stackoverflow.com/questions/41796979/how-to-pass-by-reference-so-i-can-modify-it-in-the-calling-function", "title": "How to pass by reference so I can modify it in the calling function?", "body": "<p>How can I pass something to a function such that it is modifiable and can be seen in the calling stack ? ( in other words how to pass a pointer or a reference ? )</p>\n\n<pre><code>package main\n\nimport (\n    \"os/exec\"\n    \"fmt\"\n)\n\nfunc process(names *[]string) {\n    fmt.Print(\"Pre process\", names)\n    names[1] = \"modified\"\n}\n\nfunc main() {    \n    names := []string{\"leto\", \"paul\", \"teg\"}\n    process(&amp;names)\n\n    fmt.Print(\"Post process\", names)\n}\n\nError:\ninvalid operation: names[0] (type *[]string does not support indexing)\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 1531, "user_id": 976035, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/913e70d8b28f4ea2bd30a735e23d25b2?s=128&d=identicon&r=PG", "display_name": "Finks", "link": "https://stackoverflow.com/users/976035/finks"}, "edited": false, "score": 0, "creation_date": 1485352526, "post_id": 41809679, "comment_id": 70890449, "body": "Will this work when calling another API? My problem is that the *http.Reader is being closed early."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1531, "user_id": 976035, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/913e70d8b28f4ea2bd30a735e23d25b2?s=128&d=identicon&r=PG", "display_name": "Finks", "link": "https://stackoverflow.com/users/976035/finks"}, "edited": false, "score": 0, "creation_date": 1485356869, "post_id": 41809679, "comment_id": 70893555, "body": "All appengine APIs can be called from a delayed function. The goroutine in the question only uses the request to create a context. The delayed function package automatically creates the context."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1531, "user_id": 976035, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/913e70d8b28f4ea2bd30a735e23d25b2?s=128&d=identicon&r=PG", "display_name": "Finks", "link": "https://stackoverflow.com/users/976035/finks"}, "edited": false, "score": 0, "creation_date": 1485396091, "post_id": 41809679, "comment_id": 70913245, "body": "@Finks See updated answer. It&#39;s basically a copy/paste of your code into the delay func example."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1485395974, "last_edit_date": 1485395974, "creation_date": 1485184810, "answer_id": 41809679, "question_id": 41796830, "link": "https://stackoverflow.com/questions/41796830/how-to-send-external-http-request-in-google-app-engine/41809679#41809679", "title": "How to send external HTTP request in google app engine", "body": "<p>Use the <a href=\"https://cloud.google.com/appengine/docs/go/taskqueue/delay\" rel=\"nofollow noreferrer\">delay</a> package to execute functions outside the scope of a request. </p>\n\n<p>You can also use the lower-level <a href=\"https://cloud.google.com/appengine/docs/go/taskqueue/reference\" rel=\"nofollow noreferrer\">taskqueue</a> package. The delay package is layer above the taskqueue package.</p>\n\n<p>Declare package level variable with the delay function:</p>\n\n<pre><code>var laterFunc(\"dr\", func(ctx context.Context, url string) {\n  response := &amp;SlashResponse{ResponseType: \"in_channel\", Text: twit.TweetTCL(r)}\n  b, _ := json.Marshal(response)\n\n  // send request to slack using given response_url\n  client := urlfetch.Client(ctx)\n  req, _ := http.NewRequest(\"POST\", url, bytes.NewBuffer(b))\n  req.Header.Add(\"Content-Type\", \"application/json\")\n  resp, err := client.Do(req)\n  defer resp.Body.Close()\n\n  if err != nil {\n    log.Println(err)\n  } else {\n    log.Println(\"success\")\n  }\n})\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>laterfunc.Call(appengine.NewContext(r), responseURL)\n</code></pre>\n"}], "owner": {"reputation": 1531, "user_id": 976035, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/913e70d8b28f4ea2bd30a735e23d25b2?s=128&d=identicon&r=PG", "display_name": "Finks", "link": "https://stackoverflow.com/users/976035/finks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 602, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485395974, "creation_date": 1485124060, "question_id": 41796830, "link": "https://stackoverflow.com/questions/41796830/how-to-send-external-http-request-in-google-app-engine", "title": "How to send external HTTP request in google app engine", "body": "<p>I have a problem on issuing HTTP requests in appengine since it does not support <code>http.Client</code>. I'm creating a slackbot and want to create a delayed response. The logic is once I received slack's POST request, I'm going to respond successfully and spin a goroutine calling an external API and after I finish with it, create a new request to slack.</p>\n\n<p>Seems easy enough, but the problem I encountered is when using appengine's <code>urlfetch</code> and <code>NewContext</code>, because <code>NewContext</code> takes in an *http.Request as an argument but since I'm responding immediately to the first slack request, the response Body closes before I can use it to issue the response to an external API. Is there an alternative?</p>\n\n<p>code:</p>\n\n<pre><code>func Twit(w http.ResponseWriter, r *http.Request) {\n    defaultResponse := &amp;SlashResponse{ResponseType: \"ephemeral\", Text: \"success\"}\n\n    // prepare to make a slack delayed response\n    responseURL := r.FormValue(\"response_url\")\n    go sendDelayResponse(responseURL, r)\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.WriteHeader(200)\n    json.NewEncoder(w).Encode(defaultResponse)\n}\n\nfunc sendDelayResponse(url string, r *http.Request) {\n    response := &amp;SlashResponse{ResponseType: \"in_channel\", Text: twit.TweetTCL(r)}\n    b, _ := json.Marshal(response)\n\n    // send request to slack using given response_url\n    ctx := appengine.NewContext(r)\n    client := urlfetch.Client(ctx)\n    req, _ := http.NewRequest(\"POST\", url, bytes.NewBuffer(b))\n    req.Header.Add(\"Content-Type\", \"application/json\")\n    resp, err := client.Do(req)\n    defer resp.Body.Close()\n\n    if err != nil {\n        log.Println(err)\n    } else {\n        log.Println(\"success\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "interface"], "answers": [{"tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": false, "score": 15, "last_activity_date": 1485155870, "last_edit_date": 1485155870, "creation_date": 1485123166, "answer_id": 41796725, "question_id": 41796655, "link": "https://stackoverflow.com/questions/41796655/how-to-resolve-ambiguous-selector-in-go/41796725#41796725", "title": "How to resolve ambiguous selector in Go", "body": "<p>You can use</p>\n\n<pre><code>p.Type1.A1\n</code></pre>\n\n<p>if <code>Type2</code> too has the same field <code>A1</code></p>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4747, "favorite_count": 4, "answer_count": 1, "score": 7, "last_activity_date": 1485155906, "creation_date": 1485122664, "last_edit_date": 1485155906, "question_id": 41796655, "link": "https://stackoverflow.com/questions/41796655/how-to-resolve-ambiguous-selector-in-go", "title": "How to resolve ambiguous selector in Go", "body": "<p>I define two struct types Type1 and Type2</p>\n\n<pre><code>type Type1 struct {\nA1,B1,C1 string\n}\ntype Type2 struct {\nA1,B1 string\n}\n</code></pre>\n\n<p>to embed them in struct type Supertype</p>\n\n<pre><code>type Supertype struct {\n    Type1\n    Type2\n}\n</code></pre>\n\n<p>then define interface Sender with method Send in order to use for both Type1 and Type2</p>\n\n<pre><code>type Sender interface {\n    Send() \n}\n</code></pre>\n\n<p>Finally I define func where I want to refer Type1 and Type2 fields</p>\n\n<pre><code>func (p Supertype) Send() {\n..\np.A1 = \"foo\"\n..\n\n}\n</code></pre>\n\n<p>of course getting <strong>'ambiguous selector p.A1'</strong> error. How to use method Send for both struct types Type1 and Type2 ? There is similar question <em>How can two different types implement the same method in golang using interfaces?</em> but I don't think it applies in my case</p>\n"}, {"tags": ["go", "type-conversion"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485116079, "post_id": 41795589, "comment_id": 70779434, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31981592/assign-struct-with-another-struct\">Assign struct with another struct</a>."}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485116890, "post_id": 41795589, "comment_id": 70779713, "body": "not a duplicate now, cannot assign type1 with type2"}, {"owner": {"reputation": 27429, "user_id": 497208, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f53ec83b7a4a74ef31eabd1d86b716e0?s=128&d=identicon&r=PG", "display_name": "Jakub M.", "link": "https://stackoverflow.com/users/497208/jakub-m"}, "edited": false, "score": 1, "creation_date": 1485118048, "post_id": 41795589, "comment_id": 70780075, "body": "According to my lame understanding of go type system, p is <i>type1</i>, period. How the compiler would know what type is <i>p</i> after the <i>if</i> condition? The best you can do is to assign the fields."}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1485118229, "post_id": 41795589, "comment_id": 70780129, "body": "what you are saying makes sense..didn&#39;t think about it"}, {"owner": {"reputation": 27429, "user_id": 497208, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f53ec83b7a4a74ef31eabd1d86b716e0?s=128&d=identicon&r=PG", "display_name": "Jakub M.", "link": "https://stackoverflow.com/users/497208/jakub-m"}, "edited": false, "score": 0, "creation_date": 1485118504, "post_id": 41795589, "comment_id": 70780219, "body": "I convert it to an actual answer then."}], "answers": [{"tags": [], "owner": {"reputation": 27429, "user_id": 497208, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f53ec83b7a4a74ef31eabd1d86b716e0?s=128&d=identicon&r=PG", "display_name": "Jakub M.", "link": "https://stackoverflow.com/users/497208/jakub-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1485118526, "creation_date": 1485118526, "answer_id": 41796049, "question_id": 41795589, "link": "https://stackoverflow.com/questions/41795589/change-struct-type-in-go/41796049#41796049", "title": "change struct type in Go", "body": "<p>Not possible.</p>\n\n<p>According to my lame understanding of go type system, <em>p</em> is <em>type1</em>, period. How the compiler would know what type is <em>p</em> after the <em>if</em> condition? The best you can do is to assign the fields.</p>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "accepted_answer_id": 41796049, "answer_count": 1, "score": -1, "last_activity_date": 1485118526, "creation_date": 1485115613, "last_edit_date": 1485116823, "question_id": 41795589, "link": "https://stackoverflow.com/questions/41795589/change-struct-type-in-go", "title": "change struct type in Go", "body": "<p>I have two struct types</p>\n\n<pre><code>type type1 struct {\na1,b1,c1 string\n}\ntype type2 struct {\na2,b2 string\n}\n</code></pre>\n\n<p>and want to change type of variable p if  the condition is true. How I am supposed to do it in Go ? Below does not work. And I think the question <strong>'Golang : Is conversion between different struct types possible?'</strong> does not address this case because I am getting error <em>\"cannot convert p .. cannot use type2 as type1 in assignment ...too many values in struct initializer\"</em></p>\n\n<pre><code>var p type1\n\n    if &lt;condition&gt; {\n        p = type2(p)\n        p = type2{\"1\",\"2\"}\n    } \n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 7471377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KQzmZ.jpg?s=128&g=1", "display_name": "Michael Pettigrew", "link": "https://stackoverflow.com/users/7471377/michael-pettigrew"}, "is_accepted": true, "score": 0, "last_activity_date": 1485498854, "creation_date": 1485498854, "answer_id": 41888155, "question_id": 41794004, "link": "https://stackoverflow.com/questions/41794004/golang-save-file-from-url-to-gcs-bucket-in-appengine/41888155#41888155", "title": "Golang Save File from URL to GCS Bucket in AppEngine", "body": "<p>It seems like you are looking for a <a href=\"https://golang.org/pkg/bufio/#NewWriter\" rel=\"nofollow noreferrer\">Writer</a> and a <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow noreferrer\">bytes.Buffer</a>:</p>\n\n<pre><code>var buff bytes.Buffer\nwriter := NewWriter(buff)\nn, err := io.Copy(writer, response.Body)\n</code></pre>\n"}], "owner": {"reputation": 156, "user_id": 3078563, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/702655233884ee4d50de28632f321880?s=128&d=identicon&r=PG&f=1", "display_name": "dster77", "link": "https://stackoverflow.com/users/3078563/dster77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 41888155, "answer_count": 1, "score": 1, "last_activity_date": 1485498854, "creation_date": 1485106213, "last_edit_date": 1495542259, "question_id": 41794004, "link": "https://stackoverflow.com/questions/41794004/golang-save-file-from-url-to-gcs-bucket-in-appengine", "title": "Golang Save File from URL to GCS Bucket in AppEngine", "body": "<p>I'm trying to <a href=\"https://stackoverflow.com/questions/22417283/save-an-image-from-url-to-file\">get a image file from URL</a> and save it to GCS storage using the documentation <a href=\"https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/app-engine-cloud-storage-sample#writing_a_file_to_cloud_storage\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I can't figure out how to create the file from <code>response.Body</code> to GSC given my AppEngine environment... I can't create using os.Create and reference a file path in this environment, right?</p>\n\n<ul>\n<li>Looking for tips on passing the <code>response.Body</code> to the <code>wc.Write()</code> method while deployed in AppEngine.</li>\n</ul>\n\n<p>Code to get file:</p>\n\n<pre><code>func main() {\n    url := \"http://i.imgur.com/m1UIjW1.jpg\"\n    // don't worry about errors\n    response, e := http.Get(url)\n    if e != nil {\n        log.Fatal(e)\n    }\n\n    defer response.Body.Close()\n\n    //open a file for writing\n    file, err := os.Create(\"/tmp/asdf.jpg\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    // Use io.Copy to just dump the response body to the file. This supports huge files\n    _, err = io.Copy(file, response.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    file.Close()\n    fmt.Println(\"Success!\")\n} \n</code></pre>\n\n<p>Save a local file to GCS</p>\n\n<pre><code>func (d *demo) createFile(fileName string) {\n        fmt.Fprintf(d.w, \"Creating file /%v/%v\\n\", d.bucketName, fileName)\n\n        wc := d.bucket.Object(fileName).NewWriter(d.ctx)\n        wc.ContentType = \"text/plain\"\n        wc.Metadata = map[string]string{\n                \"x-goog-meta-foo\": \"foo\",\n                \"x-goog-meta-bar\": \"bar\",\n        }\n        d.cleanUp = append(d.cleanUp, fileName)\n\n        if _, err := wc.Write([]byte(\"abcde\\n\")); err != nil {\n                d.errorf(\"createFile: unable to write data to bucket %q, file %q: %v\", d.bucketName, fileName, err)\n                return\n        }\n        if _, err := wc.Write([]byte(strings.Repeat(\"f\", 1024*4) + \"\\n\")); err != nil {\n                d.errorf(\"createFile: unable to write data to bucket %q, file %q: %v\", d.bucketName, fileName, err)\n                return\n        }\n        if err := wc.Close(); err != nil {\n                d.errorf(\"createFile: unable to close bucket %q, file %q: %v\", d.bucketName, fileName, err)\n                return\n        }\n}\n</code></pre>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 30998, "user_id": 2686899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StqEe.jpg?s=128&g=1", "display_name": "Kenton Varda", "link": "https://stackoverflow.com/users/2686899/kenton-varda"}, "edited": false, "score": 0, "creation_date": 1485157398, "post_id": 41792591, "comment_id": 70790464, "body": "The <code>descriptor.proto</code> import is necessary when declaring custom options -- it&#39;s not just for C++ code generation. I don&#39;t know anything about Go, though."}], "answers": [{"tags": [], "owner": {"reputation": 19032, "user_id": 153865, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9fa6f7a31b3eff530dd627927011ddf7?s=128&d=identicon&r=PG", "display_name": "Hassan Syed", "link": "https://stackoverflow.com/users/153865/hassan-syed"}, "is_accepted": true, "score": 1, "last_activity_date": 1485173459, "creation_date": 1485173459, "answer_id": 41806072, "question_id": 41792591, "link": "https://stackoverflow.com/questions/41792591/proto3-go-with-custom-extensions-resulting-in-imports-to-package-google-pro/41806072#41806072", "title": "proto3 -&gt; go with custom extensions resulting in imports to package (&quot;google/protobuf&quot;) in go code", "body": "<p>Poor mans solution. Not ideal, directing it to the relevant go import works:</p>\n\n<pre><code>sed -i '' -e 's/import google_protobuf \\\"google\\/protobuf\\\"/import google_protobuf \\\"github.com\\/golang\\/protobuf\\/protoc-gen-go\\/descriptor\\\"/g' pkg/domain/proto/extensions/*.pb.go\n</code></pre>\n"}], "owner": {"reputation": 19032, "user_id": 153865, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9fa6f7a31b3eff530dd627927011ddf7?s=128&d=identicon&r=PG", "display_name": "Hassan Syed", "link": "https://stackoverflow.com/users/153865/hassan-syed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 1, "accepted_answer_id": 41806072, "answer_count": 1, "score": 2, "last_activity_date": 1485173459, "creation_date": 1485098124, "last_edit_date": 1485101923, "question_id": 41792591, "link": "https://stackoverflow.com/questions/41792591/proto3-go-with-custom-extensions-resulting-in-imports-to-package-google-pro", "title": "proto3 -&gt; go with custom extensions resulting in imports to package (&quot;google/protobuf&quot;) in go code", "body": "<p>I am prototyping a meta model on top of proto3. To generate domain specific   boilerplate as the go proto3 extension syntax is ridiculously expressive. My domain proto files depend on <code>meta.proto</code> which contain the extensions.</p>\n\n<p>I can compile the these to go. When including the <code>meta.proto</code> file the generated go ends up with the following include block: </p>\n\n<pre><code>import proto \"github.com/golang/protobuf/proto\"\nimport fmt \"fmt\"\nimport math \"math\"\nimport google_protobuf \"google/protobuf\" &lt;--- this import does not exist !!\n</code></pre>\n\n<p>My extension file has the following structure(<a href=\"https://developers.google.com/protocol-buffers/docs/proto#customoptions\" rel=\"nofollow noreferrer\">based off this</a>): </p>\n\n<pre><code>syntax = \"proto2\";\npackage \"...\";\n\noption go_package = \"...\"; \n\nimport \"google/protobuf/descriptor.proto\"; &lt;--- this causes the import\n\n// message MyExtensionClass ...\n// message MyExtensionField ...\n\nextend google.protobuf.MessageOptions {\n    optional MyExtensionClass class = 50000;\n}\n\nextend google.protobuf.FieldOptions {\n    optional MyExtensionField field = 50001;\n}\n</code></pre>\n\n<p>I know the solution is likely very simple, the <code>google/protobuf</code> include is meant for C++ generation.</p>\n\n<hr>\n\n<p>In my workspace the included package should be <code>\"github.com/golang/protobuf/protoc-gen-go/descriptor\"</code></p>\n"}, {"tags": ["go", "bit-shift"], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "is_accepted": false, "score": 0, "last_activity_date": 1485089692, "creation_date": 1485089692, "answer_id": 41791123, "question_id": 41790574, "link": "https://stackoverflow.com/questions/41790574/bitmask-multiple-values-in-int64/41791123#41791123", "title": "Bitmask multiple values in int64", "body": "<p>Seemed to have figured it out:</p>\n\n<pre><code>const CacheSubjectACL = 1\nvar userrightID int64 = 8\nvar userID int64 = 2\nstoreKey := CacheSubjectACL + (userrightID &lt;&lt; 8) + (userID &lt;&lt; 36)\n\nfmt.Println(\"storeKey: \", storeKey)\nfmt.Println(\"Range   : \", storeKey&amp;0xff)\nfmt.Println(\"ID1     : \", storeKey&amp;0xfffffff00&gt;&gt;8)\nfmt.Println(\"ID2     : \", storeKey&amp;0x1ffffff000000000&gt;&gt;36)\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code> storeKey:  137438955521\n Range   :  1\n ID1     :  8\n ID2     :  2\n</code></pre>\n\n<p><code>storeKey</code> builds the <code>int64</code> masked. And the masking with a new shift the other way around fishes the old values out of the <code>int64</code> again.</p>\n\n<p>Because <code>storeKey&amp;0x1ffffff000000000&gt;&gt;36</code> runs to the end anyway, <code>storeKey&gt;&gt;36</code> will suffice too as there are no bits on the further left.</p>\n"}, {"comments": [{"owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "edited": false, "score": 0, "creation_date": 1485098314, "post_id": 41791389, "comment_id": 70773472, "body": "Wow thanks so much for that detailed explanation! My own answer results in <code>~175ns&#47;op</code>. Your <code>fmt.Sprint</code> solution was <code>~360ns&#47;op</code>, but the <code>AppendInt</code> is far superior! Only <code>~89ns&#47;op</code> wow! For example one of my rights check query now is <code>710787ns&#47;op</code> per page-load. Now it&#39;s only <code>89ns&#47;op</code>, which is 7986 times faster! This is far superior over using previous Redis/Memcache solution layers. Manual caching ftw :D"}, {"owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "edited": false, "score": 0, "creation_date": 1485098518, "post_id": 41791389, "comment_id": 70773549, "body": "As for the space inside the mapped areas. I was aware of that as you stated. Both 28-bit areas have room for ID&#39;s up to <code>268.435.456</code>. Luckily that will never happen for my data in total counts (if it would I probably never have to work again :P). I have a tidy cleanup script that cleans most PRIMARY KEYs weekly and pushes back the AUTO_INCREMENT, so I&#39;m not worried on ever reaching that on most normal tables :) Also space for <code>256</code> subjects seems more than enough for even bigger systems."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1485094158, "last_edit_date": 1485094158, "creation_date": 1485091220, "answer_id": 41791389, "question_id": 41790574, "link": "https://stackoverflow.com/questions/41790574/bitmask-multiple-values-in-int64/41791389#41791389", "title": "Bitmask multiple values in int64", "body": "<h2>Packing numbers to an <code>int64</code></h2>\n\n<p>If we can make sure the numbers we want to pack are not negative and they fit into the bit range we're reserving for them, then yes, this is a safe and efficient way to pack them.</p>\n\n<p>An <code>int64</code> has 64 bits, that's how many we can assign to the parts we want to pack into it. Often the sign bit is not used to avoid confusion, or an unsigned version <code>uint64</code> is used.</p>\n\n<p>For example, if we reserve 8 bits for <code>subject</code>, that leaves 64-8=56 bits for the rest, 28 bits for each ID.</p>\n\n<pre><code>                   | ID2         | ID1         |SUB|\nEncoded key bits:  |f f f f f f f|f f f f f f f|f f|\n</code></pre>\n\n<p>Note that when encoding, it's recommended to also use a bitmask with bitwise AND to make sure the numbers we pack do not overlap (arguable, because if the components are bigger, we're screwed anyway...).</p>\n\n<p>Also note that if we're also using the sign bit (63<sup>th</sup>), we have to apply masking after the bitshift when decoding, as shifting right \"brings in\" the sign bit and not 0 (sign bit is 1 in case of negative numbers).</p>\n\n<p>Since we used 28 bits for both ID1 and ID2, we can use the same mask for both IDs:</p>\n\n<p>Use these short utility functions which get the job done:</p>\n\n<pre><code>const (\n    maskSubj = 0xff\n    maskId   = 0xfffffff\n)\n\nfunc encode(subj, id1, id2 int64) int64 {\n    return subj&amp;maskSubj | (id1&amp;maskId)&lt;&lt;8 | (id2&amp;maskId)&lt;&lt;36\n}\n\nfunc decode(key int64) (sub, id1, id2 int64) {\n    return key &amp; maskSubj, (key &gt;&gt; 8) &amp; maskId, (key &gt;&gt; 36) &amp; maskId\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>key := encode(0x01, 0x02, 0x04)\nfmt.Printf(\"%016x\\n\", key)\nfmt.Println(decode(key))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/A-3R_SUDOA\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>0000004000000201\n1 2 4\n</code></pre>\n\n<h2>Sticking to <code>string</code></h2>\n\n<p>Originally you explored packing into an <code>int64</code> because <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf()</code></a> was slow. Note that <code>Sprintf()</code> uses a format <code>string</code>, and it takes time to parse the format string and format the arguments according to the \"rules\" laid out in the format string.</p>\n\n<p>But in your case we don't need this. We can simply get what you originally wanted like this:</p>\n\n<pre><code>id2, id1, subj := 0x04, 0x02, 0x01\nkey := fmt.Sprint(id2, \"_\", id1, \"_\", subj)\nfmt.Println(key)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>4_2_1\n</code></pre>\n\n<p>This one will be significantly faster as it doesn't have to process a format string, it will just concatenate the arguments.</p>\n\n<p>We can even do better; if none of 2 arguments being next to each other are <code>string</code> values, a space is automatically inserted, so it's really enough to just list the numbers:</p>\n\n<pre><code>key = fmt.Sprint(id2, id1, subj)\nfmt.Println(key)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>4 2 1\n</code></pre>\n\n<p>Try these on the <a href=\"https://play.golang.org/p/tev1Y3AWVk\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<h3>Utilizing <code>fmt.AppendInt()</code></h3>\n\n<p>We can improve it further by using <a href=\"https://golang.org/pkg/strconv/#AppendInt\" rel=\"nofollow noreferrer\"><code>fmt.AppendInt()</code></a>. This function appends the textual representation of an integer to a byte slice. We can use base 16 so we'll have more compact representation, and also because the algorithm to convert a number to base 16 is faster than to base 10:</p>\n\n<pre><code>func encode(subj, id1, id2 int64) string {\n    b := make([]byte, 0, 20)\n\n    b = strconv.AppendInt(b, id2, 16)\n    b = append(b, '_')\n    b = strconv.AppendInt(b, id1, 16)\n    b = append(b, '_')\n    b = strconv.AppendInt(b, subj, 16)\n\n    return string(b)\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>id2, id1, subj := int64(0x04), int64(0x02), int64(0x01)\nkey := encode(subj, id1, id2)\nfmt.Println(key)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/9oIm-GVsyN\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>4_2_1\n</code></pre>\n"}], "owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "accepted_answer_id": 41791389, "answer_count": 2, "score": 2, "last_activity_date": 1485094158, "creation_date": 1485086164, "last_edit_date": 1485086546, "question_id": 41790574, "link": "https://stackoverflow.com/questions/41790574/bitmask-multiple-values-in-int64", "title": "Bitmask multiple values in int64", "body": "<p>I'm using <a href=\"https://github.com/coocood/freecache\" rel=\"nofollow noreferrer\">https://github.com/coocood/freecache</a> to cache database results, but currently I need to dump bigger chunks on every delete, which costs multiple microseconds extra compared to targeted deletion. <code>fmt.Sprintf(\"%d_%d_%d\")</code> for a pattern like <code>#SUBJECT_#ID1_#ID2</code> also costs multiple microseconds. Even tho that doesn't sound like much, in the current ratio of the cache's response time that a multitude slower than it currently is.</p>\n\n<p>I was thinking of using the library's <code>SetInt</code>/<code>GetInt</code> which works with <code>int64</code> keys instead of strings.</p>\n\n<p>So let's say I'm storing in a <code>#SUBJECT_#ID1_#ID2</code> pattern. The <strong>Subject</strong> is a table or query-segment-range in my code (e.a. everything concern ACL or Productfiltering).</p>\n\n<p>Let's take an example of <code>Userright.id</code> is <code>#ID1</code> and <code>User.id</code> is <code>#ID2</code> and <strong>Subject</strong> <code>ACL</code>. I would build it as something like this:</p>\n\n<pre><code>// const CACHE_SUBJECT_ACL = 0x1\n// var userrightID int64 = 0x1\n// var userID int64 = 0x1\nvar storeKey int64 = 0x1000000101\n\nfmt.Println(\"Range: \", storeKey&amp;0xff)\nfmt.Println(\"ID1  : \", storeKey&amp;0xfffffff00-0xff)\nfmt.Println(\"ID2  : \", storeKey&amp;0x1fffffff00000000-0xfffffffff)\n</code></pre>\n\n<p>How can I compile the <code>CACHE_SUBJECT_ACL</code>/<code>userrightID</code>/<code>userID</code> into the <code>storeKey</code>?</p>\n\n<p>I know I can call <code>userrightID</code> <code>0x100000001</code>, but it's a dynamic value so I'm not sure what's the best way to compile this without causing more overhead than formatting the string as a key.</p>\n\n<p>The idea is that in a later state when I need to flush the cache I can call a small range of <code>int64</code> calls instead of just dumping a whole partition (of maybe thousands of entries).</p>\n\n<p>I was thinking of adding them to each other with bit shifting, like <code>userID&lt;&lt;8</code>, but I'm not sure if that's the safe route.</p>\n\n<p>If I failed to supply enough information, please ask.</p>\n"}, {"tags": ["sql", "go", "many-to-many", "go-gorm"], "comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485082741, "post_id": 41789498, "comment_id": 70768938, "body": "Please make your playground workable and leave a comments near to a part you need to fix. Now it is full of errors."}, {"owner": {"reputation": 95, "user_id": 2627873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b5b248cd9ba8e1dbb320e7a2e2d849?s=128&d=identicon&r=PG", "display_name": "gmolveau", "link": "https://stackoverflow.com/users/2627873/gmolveau"}, "reply_to_user": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485082944, "post_id": 41789498, "comment_id": 70769002, "body": "The playground can&#39;t work because of the external imports. I updated the link. It is now functional if you run it on your computer. I added a comment where I needed help."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485087486, "post_id": 41789498, "comment_id": 70770207, "body": "hmmm... looks like Go-GORM has no back reference support. So you should switch a models and declare reference in <code>Tag</code>."}, {"owner": {"reputation": 95, "user_id": 2627873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b5b248cd9ba8e1dbb320e7a2e2d849?s=128&d=identicon&r=PG", "display_name": "gmolveau", "link": "https://stackoverflow.com/users/2627873/gmolveau"}, "reply_to_user": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485087642, "post_id": 41789498, "comment_id": 70770253, "body": "Thank you for your answer ! So you think there&#39;s no way to put the same Association in both models ?"}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 2627873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b5b248cd9ba8e1dbb320e7a2e2d849?s=128&d=identicon&r=PG", "display_name": "gmolveau", "link": "https://stackoverflow.com/users/2627873/gmolveau"}, "is_accepted": false, "score": 1, "last_activity_date": 1571987963, "last_edit_date": 1571987963, "creation_date": 1485088354, "answer_id": 41790923, "question_id": 41789498, "link": "https://stackoverflow.com/questions/41789498/golang-gorm-many-to-many-back-reference/41790923#41790923", "title": "golang gorm many to many back reference", "body": "<p>So I found how to add back-reference.<br>\nI created two files in the same package containing the models, and added  Associations with the same join-table for the <code>many2many</code>.</p>\n\n<p><code>tag.go</code> :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Tag struct {\n    ID   uint   `gorm:\"primary_key\" json:\"id,omitempty\"`\n    Name string `gorm:\"not null;unique\" json:\"name,omitempty\"`\n    Gifs []Gif  `gorm:\"many2many:gif_tags;\" json:\"gifs,omitempty\"`\n}\n</code></pre>\n\n<p>and <code>gif.go</code> :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Gif struct {\n    ID   uint   `gorm:\"primary_key\" json:\"id,omitempty\"`\n    Url  string `gorm:\"not null;unique\" json:\"url,omitempty\"`\n    Tags []Tag  `gorm:\"many2many:gif_tags;\" json:\"tags,omitempty\"`\n}\n</code></pre>\n\n<p>They need to be in separate files.</p>\n\n<p>Now I can access easily all the gifs matching a Tag and vice-versa.</p>\n"}], "owner": {"reputation": 95, "user_id": 2627873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b5b248cd9ba8e1dbb320e7a2e2d849?s=128&d=identicon&r=PG", "display_name": "gmolveau", "link": "https://stackoverflow.com/users/2627873/gmolveau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571987963, "creation_date": 1485078730, "last_edit_date": 1485088719, "question_id": 41789498, "link": "https://stackoverflow.com/questions/41789498/golang-gorm-many-to-many-back-reference", "title": "golang gorm many to many back reference", "body": "<p>I have this models, many-to-many, and I'd like to get all the Gifs that matches a list of Tags.</p>\n\n<pre><code>type Tag struct {\n    ID      uint    `gorm:\"primary_key\" json:\"id,omitempty\"`\n    Name    string  `gorm:\"not null;unique\" json:\"name,omitempty\"`\n}\ntype Gif struct {\n    ID      uint    `gorm:\"primary_key\" json:\"id,omitempty\"`\n    Url     string `gorm:\"not null;unique\" json:\"url,omitempty\"`\n    Tags    []Tag `gorm:\"many2many:gif_tags;\" json:\"tags,omitempty\"`\n}\n</code></pre>\n\n<p>I prepared a playground <a href=\"https://play.golang.org/p/xlwlCPmkNv\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>If I have an array of Tags containing <code>tag1</code> and <code>tag2</code>, I'd like to get <code>gif1</code> and <code>gif2</code> in <code>&amp;gifs</code>.  </p>\n\n<p>I read the documentation many times and found only the opposite of my question, i.e. fetching the tags for a given gif.</p>\n\n<p>Do I need to change my models?<br>\nIs it possible to set up two Associations fields in a many-to-many relation?</p>\n"}, {"tags": ["go", "docker", "docker-api"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 4256748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac027c2b12eb957c1eb0813bc6f4bd7d?s=128&d=identicon&r=PG&f=1", "display_name": "ZacSketches", "link": "https://stackoverflow.com/users/4256748/zacsketches"}, "edited": false, "score": 0, "creation_date": 1587556435, "post_id": 45362546, "comment_id": 108556027, "body": "I&#39;m getting an error trying to construct the config object with the nat.PortSet.  This code <code>config := &amp;container.Config{ \t\tImage: &quot;nginx&quot;, \t\tExposedPorts: nat.PortSet{ \t\t\tnat.Port(&quot;80:tcp&quot;): struct{}{}, \t\t}, \t}</code> throws the error <code>cannot use (nat.PortSet literal) (value of type nat.PortSet) as nat.PortSet value in struct literal</code>"}], "tags": [], "owner": {"reputation": 436, "user_id": 6727740, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lKIM5ESjTc8/AAAAAAAAAAI/AAAAAAAAABE/8SQ8wvNVzAQ/photo.jpg?sz=128", "display_name": "Tom Mertz", "link": "https://stackoverflow.com/users/6727740/tom-mertz"}, "is_accepted": true, "score": 22, "last_activity_date": 1501197830, "creation_date": 1501197830, "answer_id": 45362546, "question_id": 41789083, "link": "https://stackoverflow.com/questions/41789083/set-portbindings-config-for-containercreate-function-in-golang-sdk-for-docker-ap/45362546#45362546", "title": "Set PortBindings config for ContainerCreate function in golang sdk for docker api", "body": "<p>The Docker Client Go SDK might have changed a bit since Jan, but I just got this working so I'll document what I did here.</p>\n\n<p>If you need a port exposed, which would look like <code>4140/tcp</code> under PORTS on <code>docker ps</code> then you can do the following:</p>\n\n<pre><code>config := &amp;container.Config{\n    Image: \"nginx\",\n    ExposedPorts: nat.PortSet{\n        \"4140/tcp\": struct{}{},\n    },\n}\n\nhostConfig := &amp;container.HostConfig{}\n\nctx := context.Background()\ncontainerResp, err := Docker.ContainerCreate(ctx, config, hostConfig, nil, \"\")\nif err != nil {\n    panic(err)\n}\n\nif err := Docker.ContainerStart(ctx, containerResp.ID, types.ContainerStartOptions{}); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>If you'd like to bind that port to the host on 0.0.0.0, which would look like <code>0.0.0.0:4140-&gt;4140/tcp</code> under PORTS on <code>docker ps</code> you need to add in the port bindings to the hostConfig:</p>\n\n<pre><code>config := &amp;container.Config{\n    Image: \"nginx\",\n    ExposedPorts: nat.PortSet{\n        \"4140/tcp\": struct{}{},\n    },\n}\n\nhostConfig := &amp;container.HostConfig{\n    PortBindings: nat.PortMap{\n        \"4140/tcp\": []nat.PortBinding{\n            {\n                HostIP: \"0.0.0.0\",\n                HostPort: \"4140\",\n            },\n        },\n    },\n}\n\nctx := context.Background()\ncontainerResp, err := Docker.ContainerCreate(ctx, config, hostConfig, nil, \"\")\nif err != nil {\n    panic(err)\n}\n\nif err := Docker.ContainerStart(ctx, containerResp.ID, types.ContainerStartOptions{}); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Hopefully this'll save somebody some time :)</p>\n"}, {"comments": [{"owner": {"reputation": 1127, "user_id": 1489327, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c741c8f5d84be59b1a6f7bde57b77306?s=128&d=identicon&r=PG", "display_name": "Michael Galaxy", "link": "https://stackoverflow.com/users/1489327/michael-galaxy"}, "edited": false, "score": 1, "creation_date": 1551723091, "post_id": 46125482, "comment_id": 96735851, "body": "Tip: If you still prefer/need the randomly-assigned &quot;HostPort&quot;-side feature that docker does, just omit the <code>HostPort</code> key and docker will randomly-assign a number."}], "tags": [], "owner": {"reputation": 191, "user_id": 2738974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de9f09d38dca2c47065d5276236aa2a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tamil", "link": "https://stackoverflow.com/users/2738974/tamil"}, "is_accepted": false, "score": 5, "last_activity_date": 1504911200, "creation_date": 1504911200, "answer_id": 46125482, "question_id": 41789083, "link": "https://stackoverflow.com/questions/41789083/set-portbindings-config-for-containercreate-function-in-golang-sdk-for-docker-ap/46125482#46125482", "title": "Set PortBindings config for ContainerCreate function in golang sdk for docker api", "body": "<pre><code>containerCfg := &amp;container.Config {\n    Image: haproxyImage,\n    Tty: true,\n    OpenStdin: true,\n    AttachStdout: true,\n    AttachStderr: true,\n    ExposedPorts: nat.PortSet{\n        nat.Port(\"443/tcp\"): {},\n        nat.Port(\"10001/tcp\"): {},\n    },\n}\n\nhostConfig := &amp;container.HostConfig{\n    Binds: []string{\n        \"/var/run/docker.sock:/var/run/docker.sock\",\n    },\n    PortBindings: nat.PortMap{\n        nat.Port(\"443/tcp\"): []nat.PortBinding{{HostIP: \"0.0.0.0\", HostPort: \"443\"}},\n        nat.Port(\"10001/tcp\"): []nat.PortBinding{{HostIP: \"0.0.0.0\", HostPort: \"10001\"}},\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4917053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4c27b7efedfa6bf6c1dd32d7e373e86?s=128&d=identicon&r=PG&f=1", "display_name": "Adit", "link": "https://stackoverflow.com/users/4917053/adit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4580, "favorite_count": 2, "accepted_answer_id": 45362546, "answer_count": 2, "score": 8, "last_activity_date": 1504911200, "creation_date": 1485075470, "question_id": 41789083, "link": "https://stackoverflow.com/questions/41789083/set-portbindings-config-for-containercreate-function-in-golang-sdk-for-docker-ap", "title": "Set PortBindings config for ContainerCreate function in golang sdk for docker api", "body": "<p>Basically i need to something like this </p>\n\n<pre><code>docker run -p something:something --name xxxx imagename\n</code></pre>\n\n<p>in golang sdk (this one <a href=\"https://docs.docker.com/engine/api/sdks/\" rel=\"noreferrer\">https://docs.docker.com/engine/api/sdks/</a>) for docker api, my current code looks like this</p>\n\n<pre><code>exposedPorts, portBindings, _ := nat.ParsePortSpecs([]string{\n    \"127.0.0.1:8080:2368\",\n})\n// Running the ghost container\ncreatedBody, err := dockerClient.ContainerCreate(context.Background(),\n    &amp;container.Config{\n        Image:        \"ghost:latest\",\n        ExposedPorts: exposedPorts,// it supposed to be nat.PortSet\n    },\n    &amp;container.HostConfig{\n        PortBindings: portBindings,// it supposed to be nat.PortMap\n    },\n    &amp;network.NetworkingConfig{},\n    containerName)\n</code></pre>\n\n<p>I'm using this <a href=\"https://github.com/docker/go-connections/blob/master/nat/nat.go#L126\" rel=\"noreferrer\">https://github.com/docker/go-connections/blob/master/nat/nat.go#L126</a> ParsePortSpecs function which return (map[Port]struct{}, map[Port][]PortBinding, error) but fail since the container.Config.ExposedPorts is nat.PortSet (it's actually map[Port]struct{} tho) and containter.HostConfig.PortBindins is nat.PortMap </p>\n\n<p>I'm not sure if i want to use this client <a href=\"https://github.com/fsouza/go-dockerclient\" rel=\"noreferrer\">https://github.com/fsouza/go-dockerclient</a> since my current version of docker API is 1.25 and it doesn't support API version above 1.23 </p>\n"}, {"tags": ["postgresql", "go", "gorp"], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 5058334, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/50691672a346c927d7fc823cfa74ea81?s=128&d=identicon&r=PG&f=1", "display_name": "tushar", "link": "https://stackoverflow.com/users/5058334/tushar"}, "edited": false, "score": 0, "creation_date": 1485090370, "post_id": 41791132, "comment_id": 70771045, "body": "i tried that already and here&#39;s the error i get      sql: Scan error on column index 3: unsupported Scan, storing     driver.Value type []uint8 into type *[]main.PhoneNumber"}, {"owner": {"reputation": 1183, "user_id": 4333038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snYAQ.jpg?s=128&g=1", "display_name": "Crist&#243;v&#227;o Trevisan", "link": "https://stackoverflow.com/users/4333038/crist%c3%b3v%c3%a3o-trevisan"}, "edited": false, "score": 0, "creation_date": 1598623506, "post_id": 41791132, "comment_id": 112527948, "body": "Solution does not work, <code>unsupported Scan, storing driver.Value type []uint8 into type *[]main.PhoneNumber</code>"}], "tags": [], "owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "is_accepted": false, "score": -2, "last_activity_date": 1485089740, "creation_date": 1485089740, "answer_id": 41791132, "question_id": 41788790, "link": "https://stackoverflow.com/questions/41788790/querying-postgres-composite-types-from-golang/41791132#41791132", "title": "Querying Postgres composite types from golang", "body": "<p>your type declaration is wrong, try this for example:</p>\n\n<pre><code>type Phone struct {\n   Number string\n   Type   PhoneType\n}\n\ntype Person struct {\n  Id            int\n  Name          string\n  Email         string\n  PhoneNumber   []Phone     \n}\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 5058334, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/50691672a346c927d7fc823cfa74ea81?s=128&d=identicon&r=PG&f=1", "display_name": "tushar", "link": "https://stackoverflow.com/users/5058334/tushar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 818, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1485091614, "creation_date": 1485073312, "last_edit_date": 1485091614, "question_id": 41788790, "link": "https://stackoverflow.com/questions/41788790/querying-postgres-composite-types-from-golang", "title": "Querying Postgres composite types from golang", "body": "<p>So I am using go-gorp to query postgres and I can't seem to query the composite type inside my table is giving an error. All I want is appropriately nested JSON response. My postgres schema is:</p>\n\n<pre><code>CREATE TYPE PhoneType AS ENUM ('MOBILE', 'HOME', 'WORK');\n\nCREATE TYPE PhoneNumber AS (\n  \"Number\" VARCHAR,\n  \"Type\" PhoneType\n);\n\nCREATE TABLE Person (\n  \"Id\" SERIAL PRIMARY KEY NOT NULL,\n  \"Name\" VARCHAR NOT NULL,\n  \"Email\" VARCHAR,\n  \"Number\" PhoneNumber[]\n);\n</code></pre>\n\n<p>Correspondingly in golang, I have</p>\n\n<pre><code>const (\n  MOBILE PhoneType = iota\n  HOME\n  WORK\n)\n\ntype PhoneNumber struct {\n  Number string\n  Type   PhoneType\n}\n\ntype Person struct {\n  Id          int\n  Name        string\n  Email       string\n  PhoneNumber        // not sure how to get array of phone numbers here\n}\n</code></pre>\n\n<p>And to query, I am using go-gorp as follows:</p>\n\n<pre><code>dbmap := &amp;gorp.DbMap{Db: db, Dialect: gorp.PostgresDialect{}}\nvar data []Person\n_, err := dbmap.Select(&amp;data, \"SELECT * FROM Person\")\n</code></pre>\n\n<p>the result I get has the format</p>\n\n<pre><code>{\n  \"Id\":\n  \"Name\":\n  \"Email\"\n  \"Number\": \"{\\\"(..., ...)\\\"}\"\n  \"Type\": 0\n}\n</code></pre>\n\n<p>what I'm expecting is:</p>\n\n<pre><code>{\n  \"Id\":\n  \"Name\":\n  \"Email\":\n  \"PhoneNumber\": [{\n    \"Number\":\n    \"Type\":\n  }]\n}\n</code></pre>\n\n<p>How can I change this nested composite type to the type friendly to my declaration in go?</p>\n\n<p>EDIT: Looks like postres arrays and composite types become strings in go. How can I redesign the schema to achieve similar result?</p>\n"}, {"tags": ["string", "go", "type-conversion", "strconv"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 90, "last_activity_date": 1485062910, "last_edit_date": 1495541807, "creation_date": 1485062586, "answer_id": 41787650, "question_id": 41787620, "link": "https://stackoverflow.com/questions/41787620/how-to-convert-uint64-to-string/41787650#41787650", "title": "How to convert uint64 to string", "body": "<p><a href=\"https://golang.org/pkg/strconv/#Itoa\" rel=\"noreferrer\"><code>strconv.Itoa()</code></a> expects a value of type <code>int</code>, so you have to give it that:</p>\n\n<pre><code>log.Println(\"The amount is: \" + strconv.Itoa(int(charge.Amount)))\n</code></pre>\n\n<p>But know that this may lose precision if <code>int</code> is 32-bit (while <code>uint64</code> is 64), also sign-ness is different. <a href=\"https://golang.org/pkg/strconv/#FormatUint\" rel=\"noreferrer\"><code>strconv.FormatUint()</code></a> would be better as that expects a value of type <code>uint64</code>:</p>\n\n<pre><code>log.Println(\"The amount is: \" + strconv.FormatUint(charge.Amount, 10))\n</code></pre>\n\n<p>For more options, see this answer: <a href=\"https://stackoverflow.com/questions/11123865/golang-format-a-string-without-printing/31742265#31742265\">Golang: format a string without printing?</a></p>\n\n<p>If your purpose is to just print the value, you don't need to convert it, neither to <code>int</code> nor to <code>string</code>, use one of these:</p>\n\n<pre><code>log.Println(\"The amount is:\", charge.Amount)\nlog.Printf(\"The amount is: %d\\n\", charge.Amount)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": false, "score": 2, "last_activity_date": 1485062587, "creation_date": 1485062587, "answer_id": 41787651, "question_id": 41787620, "link": "https://stackoverflow.com/questions/41787620/how-to-convert-uint64-to-string/41787651#41787651", "title": "How to convert uint64 to string", "body": "<p><a href=\"https://golang.org/pkg/log/#Printf\" rel=\"nofollow noreferrer\">log.Printf</a></p>\n\n<pre><code>log.Printf(\"The amount is: %d\\n\", charge.Amount)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5146, "user_id": 851835, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/20bf44ece0e0db121f9a44812b113e03?s=128&d=identicon&r=PG", "display_name": "updogliu", "link": "https://stackoverflow.com/users/851835/updogliu"}, "edited": false, "score": 10, "creation_date": 1521574277, "post_id": 41804941, "comment_id": 85786904, "body": "why not just <code>fmt.Sprint(charge.Amount)</code>?"}], "tags": [], "owner": {"reputation": 131, "user_id": 2687264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4114e403f9a3e9812b4e7179ad4d7003?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Fendrich", "link": "https://stackoverflow.com/users/2687264/peter-fendrich"}, "is_accepted": false, "score": 8, "last_activity_date": 1485169777, "creation_date": 1485169777, "answer_id": 41804941, "question_id": 41787620, "link": "https://stackoverflow.com/questions/41787620/how-to-convert-uint64-to-string/41804941#41804941", "title": "How to convert uint64 to string", "body": "<p>If you actually want to keep it in a string you can use one of Sprint functions. For instance:</p>\n\n<pre><code>myString := fmt.Sprintf(\"%v\", charge.Amount)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 6052673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt2NH.jpg?s=128&g=1", "display_name": "lingwei64", "link": "https://stackoverflow.com/users/6052673/lingwei64"}, "is_accepted": false, "score": 44, "last_activity_date": 1510151817, "last_edit_date": 1510151817, "creation_date": 1510147669, "answer_id": 47180974, "question_id": 41787620, "link": "https://stackoverflow.com/questions/41787620/how-to-convert-uint64-to-string/47180974#47180974", "title": "How to convert uint64 to string", "body": "<p>if you want to convert <code>int64</code> to <code>string</code>, you can use :</p>\n\n<pre><code>strconv.FormatInt(time.Now().Unix(), 10)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>strconv.FormatUint\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1506, "user_id": 8689709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd57855e7bff23fbca35abc8ddc0073?s=128&d=identicon&r=PG", "display_name": "Bill Zelenko", "link": "https://stackoverflow.com/users/8689709/bill-zelenko"}, "is_accepted": false, "score": -1, "last_activity_date": 1551103766, "creation_date": 1551103766, "answer_id": 54868051, "question_id": 41787620, "link": "https://stackoverflow.com/questions/41787620/how-to-convert-uint64-to-string/54868051#54868051", "title": "How to convert uint64 to string", "body": "<p>If you came here looking on how to covert string to uint64, this is how its done:\n</p>\n\n<pre><code>newNumber, err := strconv.ParseUint(\"100\", 10, 64)\n</code></pre>\n"}], "owner": {"reputation": 10432, "user_id": 3973137, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7HdsS.jpg?s=128&g=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3973137/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59671, "favorite_count": 10, "accepted_answer_id": 41787650, "answer_count": 5, "score": 59, "last_activity_date": 1594634498, "creation_date": 1485062319, "last_edit_date": 1582491365, "question_id": 41787620, "link": "https://stackoverflow.com/questions/41787620/how-to-convert-uint64-to-string", "title": "How to convert uint64 to string", "body": "<p>I am trying to print a <code>string</code> with a <code>uint64</code> but no combination of <code>strconv</code> methods that I use is working.</p>\n\n<pre><code>log.Println(\"The amount is: \" + strconv.Itoa((charge.Amount)))\n</code></pre>\n\n<p>Gives me:</p>\n\n<p><code>cannot use charge.Amount (type uint64) as type int in argument to strconv.Itoa</code></p>\n\n<p>How can I print this <code>string</code>?</p>\n"}, {"tags": ["json", "go", "stripe-payments", "marshalling", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 10432, "user_id": 3973137, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7HdsS.jpg?s=128&g=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3973137/anthony"}, "edited": false, "score": 0, "creation_date": 1485059732, "post_id": 41787361, "comment_id": 70764385, "body": "What I&#39;m trying to accomplish is to print this struct with nice JSON into the console. I&#39;m coming from the JS world and I want to see a nicely printed &#39;object&#39; in the console. I am printing it currently via `\tlog.Printf(&quot;%+v\\n\\n&quot;, charge)` but it kind of looks like crap. I was under the impression that I could use the UnmarshalJson to format properly/&#39;pretty print&#39; the struct as JSON"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 10432, "user_id": 3973137, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7HdsS.jpg?s=128&g=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3973137/anthony"}, "edited": false, "score": 0, "creation_date": 1485059981, "post_id": 41787361, "comment_id": 70764422, "body": "@AnthonyMayfield <code>UnmarshalJSON()</code> parses a JSON text. If you want to print it as JSON, you need <code>json.Marshal()</code>. See edited answer."}, {"owner": {"reputation": 10432, "user_id": 3973137, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7HdsS.jpg?s=128&g=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3973137/anthony"}, "edited": false, "score": 0, "creation_date": 1485060029, "post_id": 41787361, "comment_id": 70764428, "body": "Whoops looks like I had it backwards. Perfect thanks a ton!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1485075755, "last_edit_date": 1485075755, "creation_date": 1485059512, "answer_id": 41787361, "question_id": 41787301, "link": "https://stackoverflow.com/questions/41787301/unmarshal-data-in-go-using-stripe-library/41787361#41787361", "title": "Unmarshal data in Go using stripe library", "body": "<h3>JSON to <code>Charge</code></h3>\n\n<p><code>Charge.UnmarshalJSON()</code> expects a byte slice (<code>[]byte</code>). <code>Charge</code> is a struct type, you can't convert a value of it (nor a pointer to it) to <code>[]byte</code>. That's what the error message tells you.</p>\n\n<p>The byte slice that is expected by the <code>UnmarshalJSON()</code> method is a JSON text describing a <code>Charge</code>, or looking into the implementation of <code>UnmarshalJSON()</code>, it also accepts a single JSON text being the <code>Charge</code> ID.</p>\n\n<p>So this should work:</p>\n\n<pre><code>var charge, err = sc.Charges.Get(id, nil)\n\nif err != nil {\n    log.Fatal(err)\n}\n\nerr := charge.UnmarshalJSON([]byte(`\"123\"`))\n</code></pre>\n\n<p>Or a <code>Charge</code> struct represented in JSON (incomplete):</p>\n\n<pre><code>var charge, err = sc.Charges.Get(id, nil)\n\nif err != nil {\n    log.Fatal(err)\n}\n\ns := `{\"id\":\"123\",\"amount\":2000,\"description\":\"testing\"}`\nerr := charge.UnmarshalJSON([]byte(s))\n\nfmt.Printf(\"%+v\", thing)\n</code></pre>\n\n<p>Output should contain these fields properly set from the JSON text, amongst other fields having their zero values:</p>\n\n<pre><code>{Amount:2000 Desc:testing ID:123}\n</code></pre>\n\n<h3><code>Charge</code> to JSON</h3>\n\n<p>To print a nicely formatted JSON representation of a <code>Charge</code> value, use <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\"><code>json.Marshal()</code></a>:</p>\n\n<pre><code>out, err := json.Marshal(c)\nif err != nil {\n    panic(err) // handle error\n}\nfmt.Println(string(out))\n</code></pre>\n\n<p>Or use <a href=\"https://golang.org/pkg/encoding/json/#MarshalIndent\" rel=\"nofollow noreferrer\"><code>json.MarshalIndent()</code></a>:</p>\n\n<pre><code>out, err := json.MarshalIndent(c, \"\", \"  \")\nif err != nil {\n    panic(err) // handle error\n}\nfmt.Println(string(out))\n</code></pre>\n\n<p>Example output (stripped):</p>\n\n<pre><code>{\n  \"amount\": 2000,\n  \"description\": \"testing\",\n  \"id\": \"123\",\n}\n</code></pre>\n"}], "owner": {"reputation": 10432, "user_id": 3973137, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7HdsS.jpg?s=128&g=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3973137/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 41787361, "answer_count": 1, "score": 1, "last_activity_date": 1485075755, "creation_date": 1485058767, "last_edit_date": 1485060293, "question_id": 41787301, "link": "https://stackoverflow.com/questions/41787301/unmarshal-data-in-go-using-stripe-library", "title": "Unmarshal data in Go using stripe library", "body": "<p>Just started hacking with Go.</p>\n\n<p>I'm trying to use the Stripe library. There is a type <code>Charge</code> which I am trying to use their custom <code>UnmarshalJSON</code> call, but no argument I pass seems to work. What's going on here?</p>\n\n<pre><code>var charge, err = sc.Charges.Get(id, nil)\n\nif err != nil {\n    log.Fatal(err)\n}\n\nthing := charge.UnmarshalJSON([]byte(charge))\n</code></pre>\n\n<p>Here's the function: <a href=\"https://github.com/stripe/stripe-go/blob/master/charge.go#L162\" rel=\"nofollow noreferrer\">https://github.com/stripe/stripe-go/blob/master/charge.go#L162</a></p>\n\n<p>I receive:\n<code>./hello.go:48: cannot convert charge (type *stripe.Charge) to type []byte</code></p>\n\n<p>Haven't found an argument to pass that will satisfy this function yet. Any help appreciated thanks.</p>\n"}, {"tags": ["postgresql", "go", "docker"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485057412, "post_id": 41787162, "comment_id": 70763996, "body": "If it were not able to <code>Open</code> it should have failed and error returned on <code>Open</code>,"}, {"owner": {"reputation": 1819, "user_id": 4379891, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/00537a374fd78cbd4f92745dbb2ee0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4379891/kevin"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485057759, "post_id": 41787162, "comment_id": 70764056, "body": "ah, the error I got is during the query, <code>x509: cannot validate certificate for 192.168.99.100 because it doesn&#39;t contain any IP SANs</code>"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1485057995, "post_id": 41787162, "comment_id": 70764100, "body": "sql.Open doesn&#39;t check if there&#39;s a valid connection, use <a href=\"https://golang.org/pkg/database/sql/#DB.Ping\" rel=\"nofollow noreferrer\">sql.Ping</a>"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485058795, "post_id": 41787162, "comment_id": 70764230, "body": "just try setting <code>disable</code> sslmode for development phase"}], "answers": [{"tags": [], "owner": {"reputation": 2750, "user_id": 8645590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21294be3adc65e1d68b7de3199d5a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Vikram Hosakote", "link": "https://stackoverflow.com/users/8645590/vikram-hosakote"}, "is_accepted": false, "score": 0, "last_activity_date": 1549909530, "creation_date": 1549909530, "answer_id": 54636829, "question_id": 41787162, "link": "https://stackoverflow.com/questions/41787162/can-not-connect-from-golang-to-docker-postgres-container/54636829#54636829", "title": "Can not connect from golang to docker postgres container", "body": "<p>I saw the same error when using mysql client in golang:</p>\n\n<pre><code>Failed to connect to database:  x509: cannot validate certificate for 10.111.202.229 because it doesn't contain any IP SANs\n</code></pre>\n\n<p>The solution in <a href=\"https://stackoverflow.com/a/54636760/8645590\">https://stackoverflow.com/a/54636760/8645590</a> worked for me.</p>\n"}], "owner": {"reputation": 1819, "user_id": 4379891, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/00537a374fd78cbd4f92745dbb2ee0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4379891/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 717, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1549909530, "creation_date": 1485057299, "question_id": 41787162, "link": "https://stackoverflow.com/questions/41787162/can-not-connect-from-golang-to-docker-postgres-container", "title": "Can not connect from golang to docker postgres container", "body": "<p>I spin up the docker container for postgres</p>\n\n<p><code>docker run -i -t -v=\":/var/lib/postgresql\" -p 5432:5432 my_image/postgresql:9.3</code></p>\n\n<p>And verify that it is reachable from host using </p>\n\n<p><code>psql -h my_docker_ip -p 5432 -U pguser -W pgdb // passowrd: pguser</code> </p>\n\n<p>Now I want to connect to the container <code>postgres</code> using <code>go</code> in my host machine.</p>\n\n<pre><code>import (\n    \"database/sql\"\n    _ \"github.com/lib/pq\"\n    \"fmt\"\n)\n\nfunc main() {\n    db, err := sql.Open(\"postgres\", \"user=pguser password='pguser' host=192.168.99.100 port=5432 sslmode=verify-full\")\n\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    rows, err := db.Query(\"SELECT * FROM test\")\n    fmt.Println(rows)\n\n}\n</code></pre>\n\n<p>While there were no error on initializing the db instance reference, the test query itself print out </p>\n\n<pre><code>&lt;nil&gt;\n</code></pre>\n\n<p>This should not happen because I created table <code>test</code> and multiple rows in table <code>test</code> prior to running the go code.</p>\n\n<p>Can someone tell me what I am doing wrong?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["http", "go"], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 2, "last_activity_date": 1485053412, "creation_date": 1485053412, "answer_id": 41786819, "question_id": 41786677, "link": "https://stackoverflow.com/questions/41786677/gocustom-server-to-handle-request-with-specific-path/41786819#41786819", "title": "[go]Custom Server to handle request with specific path", "body": "<p>If you want to use different URL paths, you have to create some <code>mux</code>, you can create one, use the default mux provided by go or use a third party mux like <code>gorilla</code>.</p>\n\n<p>The following code is made using the standart <code>http</code> library provided.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func myHandler(w http.ResponseWriter, req *http.Request){\n    io.WriteString(w, \"hello, world!\\n\")\n}\n\nfunc main() {\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/todo/something\", func(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"Response\"))\n    })\n\n    s := &amp;http.Server{\n        Addr:           \":8080\",\n        Handler:        mux,\n        ReadTimeout:    10 * time.Second,\n        WriteTimeout:   10 * time.Second,\n        MaxHeaderBytes: 1 &lt;&lt; 20,\n    }\n    s.ListenAndServe()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2248, "user_id": 2114557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Lgbfy.jpg?s=128&g=1", "display_name": "Zuko", "link": "https://stackoverflow.com/users/2114557/zuko"}, "is_accepted": false, "score": 0, "last_activity_date": 1600601636, "last_edit_date": 1600601636, "creation_date": 1600601242, "answer_id": 63978476, "question_id": 41786677, "link": "https://stackoverflow.com/questions/41786677/gocustom-server-to-handle-request-with-specific-path/63978476#63978476", "title": "[go]Custom Server to handle request with specific path", "body": "<p>Just to add on, though not recommended but a good starting point is to experiment with the DefaultServeMux that also comes with the std lib. The DefaultServeMux is used when you don't supply a mux to the http server.</p>\n<pre><code> func myHandler(w http.ResponseWriter, r *http.Request){\n     io.WriteString(w, &quot;hello, world!\\n&quot;)\n }\n\n func main(){\n     // you can register multiple handlers \n     // as long as it implements the http.Handler interface\n\n     http.HandleFunc(&quot;/todo/something&quot;, myHandler)\n     http.HandleFunc(&quot;/todo/thingTwo&quot;, func(w http.ResponseWriter, r *http.Request){\n\n         something := strings.TrimPrefix(r.URL.Path, &quot;/todo/&quot;)\n         fmt.Fprintf(w, &quot;We received %s&quot;, something)\n     })\n\n     http.ListenAndServe(&quot;:5000&quot;, nil) //Will use the default ServerMux in place of nil\n }\n</code></pre>\n<p>The idea here is that you can use the default server Mux for testing, create your own Mux like @Motakjuq showed you using the http.NewServeMux() and assign to your server or you can use a thirdparty router lib like <a href=\"https://github.com/go-chi/chi\" rel=\"nofollow noreferrer\">go-chi</a>, <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"nofollow noreferrer\">httprouter</a> or simply take your pick from a nice collection <a href=\"https://github.com/avelino/awesome-go#routers\" rel=\"nofollow noreferrer\">here</a> or simply review the <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">stdlib</a></p>\n"}], "owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 1, "accepted_answer_id": 41786819, "answer_count": 2, "score": 1, "last_activity_date": 1600601636, "creation_date": 1485051593, "last_edit_date": 1495541805, "question_id": 41786677, "link": "https://stackoverflow.com/questions/41786677/gocustom-server-to-handle-request-with-specific-path", "title": "[go]Custom Server to handle request with specific path", "body": "<p>I want to make a api which handles the request which have the path such as \n<code>http:\\\\localhost:8080\\todo\\something</code> but I need to do using custom server.</p>\n\n<p>Here is the piece of code I have written.</p>\n\n<pre><code>package main\n\nimport (\n        \"net/http\"\n        \"fmt\"\n        \"io\"\n        \"time\"\n    )\n\n\nfunc myHandler(w http.ResponseWriter, req *http.Request){\n    io.WriteString(w, \"hello, world!\\n\")\n}\n\n\nfunc main() {\n\n    //Custom http server\n    s := &amp;http.Server{\n        Addr:           \":8080\",\n        Handler:        http.HandlerFunc(myHandler),\n        ReadTimeout:    10 * time.Second,\n        WriteTimeout:   10 * time.Second,\n        MaxHeaderBytes: 1 &lt;&lt; 20,\n    }\n\n    err := s.ListenAndServe()\n    if err != nil {\n        fmt.Printf(\"Server failed: \", err.Error())\n    }\n}\n</code></pre>\n\n<p>inspired by this <a href=\"https://stackoverflow.com/questions/25583028/how-to-write-a-simple-custom-http-server-in-go\">post</a></p>\n\n<p>My handler accepts all the request such <code>http:localhost:8080\\abc</code>, <code>http:localhost:8080\\abc</code> etc\nHow to give path in custom server so that it handles request only that matches the path.</p>\n"}, {"tags": ["variables", "go", "initialization"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1485053698, "post_id": 41786653, "comment_id": 70763465, "body": "It compiles for me. Can you post a minimal example (i.e., a whole file) that exhibits the problem?"}, {"owner": {"reputation": 595, "user_id": 943833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IKM0l.jpg?s=128&g=1", "display_name": "roganartu", "link": "https://stackoverflow.com/users/943833/roganartu"}, "edited": false, "score": 0, "creation_date": 1485055245, "post_id": 41786653, "comment_id": 70763697, "body": "<a href=\"https://play.golang.org\" rel=\"nofollow noreferrer\">Go Playground</a> provides a nice sandbox for creating such examples. eg: Here is a working example of what you have described <a href=\"https://play.golang.org/p/u6Vbm90SLP\" rel=\"nofollow noreferrer\">play.golang.org/p/u6Vbm90SLP</a>"}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "edited": false, "score": 0, "creation_date": 1485225334, "post_id": 41787520, "comment_id": 70826264, "body": "Yes, I&#39;m using Intellij with the go-idea plugin. That might explain why others can run the code and not get errors. I&#39;m trying to figure how to post my complete sample to the go playground as someone else requested (or alternatively, add my code to my original post)."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "edited": false, "score": 0, "creation_date": 1485238514, "post_id": 41787520, "comment_id": 70830189, "body": "Are you using the same version of intellij go plugin where the issue is fixed.? You can check my answer for the link."}, {"owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "edited": false, "score": 0, "creation_date": 1485267489, "post_id": 41787520, "comment_id": 70847752, "body": "The plugin version is 0.13.1924"}], "tags": [], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1485061225, "creation_date": 1485061225, "answer_id": 41787520, "question_id": 41786653, "link": "https://stackoverflow.com/questions/41786653/golang-initializing-project-variable/41787520#41787520", "title": "golang -- Initializing Project Variable", "body": "<p>Where are you getting this error? If this is in Intellij with go-idea plugin. Then this has been recently fixed as you can see <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/2267\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "edited": false, "score": 0, "creation_date": 1485267553, "post_id": 41787984, "comment_id": 70847792, "body": "@Andy Schweig I&#39;ve updated my original post with the complete application where the problem is occurring, along with an explanation. I didn&#39;t explain my problem very well. I experience the error when I use yellow = color.RGBA{0xff, 0xff,  0x00, 0xff}"}], "tags": [], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "is_accepted": false, "score": 0, "last_activity_date": 1485066395, "creation_date": 1485066395, "answer_id": 41787984, "question_id": 41786653, "link": "https://stackoverflow.com/questions/41786653/golang-initializing-project-variable/41787984#41787984", "title": "golang -- Initializing Project Variable", "body": "<p><strong>Just tried your question out with the following code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"image/color\"\n)\n\nvar yellow color.RGBA\n\nfunc main() {\n    fmt.Println(yellow)\n    setColors()\n    fmt.Println(yellow)\n}\n\nfunc setColors() {\n    yellow = color.RGBA{R: 0xff, G: 0xff, B: 0x00, A: 0xff}\n}\n</code></pre>\n\n<p><strong>With the output:</strong></p>\n\n<pre><code>{0 0 0 0}\n{255 255 0 255}\n</code></pre>\n\n<p>It seems to be working for me, I'm not sure if I wrote my code differently to yours.</p>\n"}], "owner": {"reputation": 293, "user_id": 3997991, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4acd506b7267eade68ce2a18028b1771?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Murphy", "link": "https://stackoverflow.com/users/3997991/steve-murphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485267453, "creation_date": 1485051429, "last_edit_date": 1485267453, "question_id": 41786653, "link": "https://stackoverflow.com/questions/41786653/golang-initializing-project-variable", "title": "golang -- Initializing Project Variable", "body": "<p>I am a golang beginner and I have a package level variable:</p>\n\n<pre><code>var yellow color.RGBA\n</code></pre>\n\n<p>I want to initialize it in a function so I do this (no compiler warnings):</p>\n\n<pre><code>func setColors() {\n    yellow = color.RGBA{R: 0xff, G: 0xff, B: 0x00, A: 0xff}\n}\n</code></pre>\n\n<p>If I do this in my function, I get a \"Unnamed field initialization\" compiler warning:</p>\n\n<pre><code>yellow = color.RGBA{0xff, 0xff, 0x00, 0xff}\n</code></pre>\n\n<p>But my project-level variable allows me to do both of these:</p>\n\n<pre><code>var yellow = color.RGBA{0xff, 0xff, 0x00, 0xff}\nvar yellow = color.RGBA{R: 0xff, G: 0xff, B: 0x00, A: 0xff}\n</code></pre>\n\n<p>Why can I omit the field names (R, G, B, A) in the project-level initialization but not in the function?</p>\n\n<p><strong>24-Jan Update -- Complete Code Example</strong></p>\n\n<p>This is where my variable initialization problem is happening. </p>\n\n<p>This application displays a dynamic lissajous figure in a web browser. \nThe lissajous line color is yellow.</p>\n\n<p>You need to start the app with a command line parameter <strong>web</strong>\nAfter starting the app, open a browser and point it to <a href=\"http://localhost:8000/\" rel=\"nofollow noreferrer\">http://localhost:8000/</a></p>\n\n<p>Line <strong>reference #3</strong> (func setColors(), end of code sample) is supposed to set the yellow variable (<strong>line reference #2</strong>). Line reference #3 is where I get the \"Unnamed field initialization\" compiler warning.</p>\n\n<p>When I run the app as is <strong>from within Intellij</strong>, var yellow does not get set and the lissajous figure does not get drawn correctly in the browser. </p>\n\n<p>However if I use line <strong>reference #4</strong> instead of <strong>#3</strong>, the application works fine.</p>\n\n<p><strong>Line reference #1</strong> works fine, but I need to know why <strong>reference #3</strong> is not working.</p>\n\n<pre><code>// Copyright \u00a9 2016 Alan A. A. Donovan &amp; Brian W. Kernighan.\n// License: https://creativecommons.org/licenses/by-nc-sa/4.0/\n\n// Run with \"web\" command-line argument for web server.\n// See page 13.\n\n// Lissajous generates GIF animations of random Lissajous figures.\n\npackage main\n\nimport (\n    \"image\"\n    \"image/color\"\n    \"image/gif\"\n    \"io\"\n    \"math\"\n    \"math/rand\"\n    \"os\"\n    \"time\"\n    \"net/http\"\n    \"log\"\n    \"fmt\"\n    \"reflect\"\n    \"strconv\"\n)\n\n\nvar palette = []color.Color{color.Black, yellow }\nvar red color.RGBA= color.RGBA{0xff, 0x00, 0x00, 0xff}\nvar green color.RGBA = color.RGBA{0x00, 0xff, 0x00, 0xff}\n\n// Line reference #1\n//var yellow = color.RGBA{R: 0xff, G: 0xff, B: 0x00, A: 0xff}\n\n// Line reference #2\nvar yellow color.RGBA\n\nvar blue color.RGBA = color.RGBA{0x00, 0x00, 0xff, 0xff}\n\nconst (\n\n    whiteIndex = 0 // first color in palette\n    yellowIndex = 1 // next color in palette\n)\n\nfunc main() {\n    // The sequence of images is deterministic unless we seed\n    // the pseudo-random number generator using the current time.\n    // Thanks to Randall McPherson for pointing out the omission.\n    rand.Seed(time.Now().UTC().UnixNano())\n    setColors()\n    if len(os.Args) &gt; 1 &amp;&amp; os.Args[1] == \"web\" {\n        handler := func(w http.ResponseWriter, r *http.Request) {\n            lissajous(w, r)\n        }\n        http.HandleFunc(\"/\", handler)\n        log.Fatal(http.ListenAndServe(\"localhost:8000\", nil))\n        return\n    }\n    lissajous(os.Stdout, nil)\n}\n\nfunc lissajous(out io.Writer,  r *http.Request) {\n    const (\n        //cycles  = 5     // number of complete x oscillator revolutions\n        res     = 0.001 // angular resolution\n        //size    = 100   // image canvas covers [-size..+size]\n        //nframes = 64    // number of animation frames\n        //delay   = 8     // delay between frames in 10ms units\n    )\n    // Get query parameters\n    cycles  := getQueryParameterFloat(\"cycles\", r, 5)\n    size := getQueryParameterInteger(\"size\", r, 100)\n    sizeFloat := float64(size)\n    nframes := getQueryParameterInteger(\"nframes\", r, 64)\n    delay := getQueryParameterInteger(\"delay\", r, 8)\n\n    fmt.Println(\"cycles type:\", reflect.TypeOf(cycles))\n    freq := rand.Float64() * 3.0 // relative frequency of y oscillator\n    anim := gif.GIF{LoopCount: nframes}\n    phase := 0.0 // phase difference\n    for i := 0; i &lt; nframes; i++ {\n        rect := image.Rect(0, 0, 2*size+1, 2*size+1)\n        img := image.NewPaletted(rect, palette)\n        for t := 0.0; t &lt; cycles*2*math.Pi; t += res {\n            x := math.Sin(t)\n            y := math.Sin(t*freq + phase)\n            img.SetColorIndex(size+int(x*sizeFloat+0.5), size+int(y*sizeFloat+0.5),\n                yellowIndex)\n        }\n        phase += 0.1\n        anim.Delay = append(anim.Delay, delay)\n        anim.Image = append(anim.Image, img)\n    }\n    gif.EncodeAll(out, &amp;anim) // NOTE: ignoring encoding errors\n}\n\n// getQueryParameter returns the value of a parameter in the query string.\n// If an error occurs, the function returns the default value passed in.\nfunc getQueryParameterFloat(name string,  r *http.Request, defaultVal float64) float64 {\n\n\n    v := r.URL.Query().Get(name)\n\n    v2, err := strconv.ParseFloat(v, 64)\n    if err != nil {\n        return defaultVal\n    } else {\n        return v2\n    }\n}\n\nfunc getQueryParameterInteger(name string, r *http.Request, defaultVal int) int {\n    v := r.URL.Query().Get(name)\n\n    v2, err := strconv.Atoi(v)\n    if err != nil {\n        return defaultVal\n    } else {\n        return v2\n    }\n}\n\n\nfunc setColors() {\n    // Line reference #3 When I use this, the application does not function correctly\n    yellow = color.RGBA{0xff, 0xff, 0x00, 0xff}        \n\n    // Line refernce #4 When I use this, the application **does** function correctly.\n    //yellow = color.RGBA{R: 0xff, G: 0xff, B: 0x00, A: 0xff}\n\n}\n</code></pre>\n"}, {"tags": ["go", "utf-8", "encode"], "answers": [{"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1485044442, "creation_date": 1485044442, "answer_id": 41786017, "question_id": 41785381, "link": "https://stackoverflow.com/questions/41785381/how-to-encode-gob-in-utf-8-in-golang/41786017#41786017", "title": "How to encode gob in UTF-8 in golang ?", "body": "<p>When you call <code>Encode(msg)</code>, you are not sending UTF-8 plain text.</p>\n\n<p>To send plain text:</p>\n\n<pre><code>conn.Write([]byte(msg)) // suppose msg is string\n</code></pre>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 41786017, "answer_count": 1, "score": -1, "last_activity_date": 1485044442, "creation_date": 1485038940, "question_id": 41785381, "link": "https://stackoverflow.com/questions/41785381/how-to-encode-gob-in-utf-8-in-golang", "title": "How to encode gob in UTF-8 in golang ?", "body": "<p>I am using <strong>gob.NewEncoder</strong> to encode string message <em>msg</em> but need to do it in utf-8. </p>\n\n<p>err= gob.NewEncoder(conn).Encode(msg)</p>\n\n<p>I am getting warning in Ruby receiver (Logstash) saying that <em>Received an event that has a different character encoding than you configured ...:expected_charset=>\"UTF-8\"</em></p>\n"}, {"tags": ["go", "time"], "answers": [{"tags": [], "owner": {"reputation": 27429, "user_id": 497208, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f53ec83b7a4a74ef31eabd1d86b716e0?s=128&d=identicon&r=PG", "display_name": "Jakub M.", "link": "https://stackoverflow.com/users/497208/jakub-m"}, "is_accepted": false, "score": 7, "last_activity_date": 1485035413, "creation_date": 1485035413, "answer_id": 41784931, "question_id": 41784825, "link": "https://stackoverflow.com/questions/41784825/how-to-add-1-sec-to-the-date-in-golang/41784931#41784931", "title": "How to add 1 sec to the date in golang?", "body": "<pre><code>func (t Time) Add(d Duration) Time\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/time/#Time.Add\">https://golang.org/pkg/time/#Time.Add</a></p>\n"}, {"tags": [], "owner": {"reputation": 5133, "user_id": 154762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d07d8564c1726ca28a6b99e560f0ec7?s=128&d=identicon&r=PG", "display_name": "solarc", "link": "https://stackoverflow.com/users/154762/solarc"}, "is_accepted": true, "score": 3, "last_activity_date": 1485035961, "creation_date": 1485035961, "answer_id": 41785015, "question_id": 41784825, "link": "https://stackoverflow.com/questions/41784825/how-to-add-1-sec-to-the-date-in-golang/41785015#41785015", "title": "How to add 1 sec to the date in golang?", "body": "<p>You are asigning a <code>string</code> to <code>t</code> (the result of calling <code>Format</code>) instead of a <code>Time</code> (the result of calling <code>Now</code>). Here's an working example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t := time.Now()\n    fmt.Println(t.Format(time.RFC3339))\n\n    t = t.Add(time.Second)\n    fmt.Println(t.Format(time.RFC3339))\n}\n\n// prints\n// 2017-01-21T16:51:31-05:00\n// 2017-01-21T16:51:32-05:00\n</code></pre>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7584, "favorite_count": 0, "accepted_answer_id": 41785015, "answer_count": 2, "score": 1, "last_activity_date": 1485035961, "creation_date": 1485034779, "question_id": 41784825, "link": "https://stackoverflow.com/questions/41784825/how-to-add-1-sec-to-the-date-in-golang", "title": "How to add 1 sec to the date in golang?", "body": "<p>How to add 1 sec to the date in golang ? I have: </p>\n\n<pre><code>t := time.Now().Format(\"2006/02/01 03:04:05\")\n</code></pre>\n\n<p>and want something like below but so far getting <em>mismatched types string and time.Duration</em> error</p>\n\n<pre><code>t1, t2, t3 = t + 1*time.Second, t+3*time.Second, t+2*time.Second\n</code></pre>\n"}, {"tags": ["go", "concurrency", "slice", "channel", "worker"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 1, "last_activity_date": 1485037843, "last_edit_date": 1485037843, "creation_date": 1485037467, "answer_id": 41785189, "question_id": 41784439, "link": "https://stackoverflow.com/questions/41784439/go-concurrent-worker-routines-using-slice-type-input-and-output-channels/41785189#41785189", "title": "Go concurrent worker routines using slice type input and output channels", "body": "<p>The difference is that in variant 1, you're sending a different slice every time, whereas in variant 2, you're sending the same slice every time (the one created above the <code>for</code> loops). Without creating a new slice, you're just setting the elements of the same slice to different values, so the goroutines see whatever values happen to be in the slice when they look at it. In variant 2, <code>main</code> will always see <code>[3 3 3 3]</code> because that's the final value after you've gone through the loop 4 times. The value of a slice object contains a reference to the underlying elements, not the elements themselves. There's a good explanation of slices <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7451192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d9c77e71d657b08f4717ea7980d06d?s=128&d=identicon&r=PG&f=1", "display_name": "cl1pp0", "link": "https://stackoverflow.com/users/7451192/cl1pp0"}, "is_accepted": false, "score": 0, "last_activity_date": 1485092323, "creation_date": 1485092323, "answer_id": 41791574, "question_id": 41784439, "link": "https://stackoverflow.com/questions/41784439/go-concurrent-worker-routines-using-slice-type-input-and-output-channels/41791574#41791574", "title": "Go concurrent worker routines using slice type input and output channels", "body": "<p>Thanks a lot for your explanation, now I see where the problem is. I added some debug code to output the pointer addresses and the result is (with slighty reformatted output):</p>\n\n<p>Variant 1:</p>\n\n<pre><code>main 0 x=[0 0 0 0] &amp;x=0x1830e180 &amp;x[0]=0x1830e1e0\nmain 1 x=[1 1 1 1] &amp;x=0x1830e180 &amp;x[0]=0x1830e230\nmain 2 x=[2 2 2 2] &amp;x=0x1830e180 &amp;x[0]=0x1830e270\nmain 3 x=[3 3 3 3] &amp;x=0x1830e180 &amp;x[0]=0x1830e2a0\n    worker 3 x=[3 3 3 3] &amp;x=0x1830e1d0 &amp;x[0]=0x1830e2a0\n    worker 3 y=[3 3 3 3] &amp;y=0x1830e2e0 &amp;y[0]=0x1830e2a0\n        main 0 y=[3 3 3 3] &amp;y=0x1830e2d0 &amp;y[0]=0x1830e2a0\n    worker 0 x=[0 0 0 0] &amp;x=0x1830e1a0 &amp;x[0]=0x1830e1e0\n    worker 0 y=[0 0 0 0] &amp;y=0x1830e370 &amp;y[0]=0x1830e1e0\n        main 1 y=[0 0 0 0] &amp;y=0x1830e360 &amp;y[0]=0x1830e1e0\n    worker 1 x=[1 1 1 1] &amp;x=0x1830e1b0 &amp;x[0]=0x1830e230\n    worker 1 y=[1 1 1 1] &amp;y=0x1830e400 &amp;y[0]=0x1830e230\n        main 2 y=[1 1 1 1] &amp;y=0x1830e3f0 &amp;y[0]=0x1830e230\n    worker 2 x=[2 2 2 2] &amp;x=0x1830e1c0 &amp;x[0]=0x1830e270\n    worker 2 y=[2 2 2 2] &amp;y=0x1830e480 &amp;y[0]=0x1830e270\n        main 3 y=[2 2 2 2] &amp;y=0x1830e470 &amp;y[0]=0x1830e270\n</code></pre>\n\n<p>Variant 2:</p>\n\n<pre><code>main 0 x=[0 0 0 0] &amp;x=0x1830e180 &amp;x[0]=0x1830e190\nmain 1 x=[1 1 1 1] &amp;x=0x1830e180 &amp;x[0]=0x1830e190\nmain 2 x=[2 2 2 2] &amp;x=0x1830e180 &amp;x[0]=0x1830e190\nmain 3 x=[3 3 3 3] &amp;x=0x1830e180 &amp;x[0]=0x1830e190\n    worker 3 x=[3 3 3 3] &amp;x=0x1830e1d0 &amp;x[0]=0x1830e190\n    worker 3 y=[3 3 3 3] &amp;y=0x1830e2a0 &amp;y[0]=0x1830e190\n        main 0 y=[3 3 3 3] &amp;y=0x1830e290 &amp;y[0]=0x1830e190\n    worker 0 x=[3 3 3 3] &amp;x=0x1830e1a0 &amp;x[0]=0x1830e190\n    worker 0 y=[3 3 3 3] &amp;y=0x1830e330 &amp;y[0]=0x1830e190\n        main 1 y=[3 3 3 3] &amp;y=0x1830e320 &amp;y[0]=0x1830e190\n    worker 1 x=[3 3 3 3] &amp;x=0x1830e1b0 &amp;x[0]=0x1830e190\n    worker 1 y=[3 3 3 3] &amp;y=0x1830e3c0 &amp;y[0]=0x1830e190\n        main 2 y=[3 3 3 3] &amp;y=0x1830e3b0 &amp;y[0]=0x1830e190\n    worker 2 x=[3 3 3 3] &amp;x=0x1830e1c0 &amp;x[0]=0x1830e190\n    worker 2 y=[3 3 3 3] &amp;y=0x1830e440 &amp;y[0]=0x1830e190\n        main 3 y=[3 3 3 3] &amp;y=0x1830e430 &amp;y[0]=0x1830e190\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7451192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d9c77e71d657b08f4717ea7980d06d?s=128&d=identicon&r=PG&f=1", "display_name": "cl1pp0", "link": "https://stackoverflow.com/users/7451192/cl1pp0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485092323, "creation_date": 1485032357, "question_id": 41784439, "link": "https://stackoverflow.com/questions/41784439/go-concurrent-worker-routines-using-slice-type-input-and-output-channels", "title": "Go concurrent worker routines using slice type input and output channels", "body": "<p>I am relatively new to the Go language. Even though I don't hope so, I maybe bother you with a silly question. My apologies upfront, just in case...</p>\n\n<p>Here's my example: I defined a worker() function which is called from main() as a set of concurrent Go routines. Input and output data is provided via an input and an output channel both of slice type []int. In one case everything works as expected, in the other case the result is faulty. See the comments in the code and the program output below the code.</p>\n\n<p>Honestly, I don't see the actual difference between both code variants. What did I miss here? Thank you for any advice!</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"runtime\"\n\nfunc worker(x_ch &lt;-chan []int, y_ch chan&lt;- []int, wid int) {\n\n    for x := range x_ch {\n        y := x\n        fmt.Println(\"   worker\", wid, \"x:\", x)\n        fmt.Println(\"   worker\", wid, \"y:\", y)\n        y_ch &lt;- y\n    }\n}\n\nfunc main() {\n\n    n_workers := runtime.NumCPU()\n    n_len := 4\n    n_jobs := 4\n    x := make([]int, n_len)\n    x_ch := make(chan []int, 10)\n    y_ch := make(chan []int, 10)\n\n    for j := 0; j &lt; n_workers; j++ { go worker(x_ch, y_ch, j) }\n\n    for k := 0; k &lt; n_jobs; k++ {\n\n//      variant 1: works!\n        x = []int{k, k, k, k}\n\n//      variant 2: doesn't work!\n//      for i := range x { x[i] = k }\n\n        fmt.Println(\"main x:\", k, x)\n        x_ch &lt;- x\n    }\n\n    close(x_ch)\n\n    for i := 0; i &lt; n_jobs; i++ {\n        z := &lt;- y_ch\n        fmt.Println(\"       main y:\", i, z)\n    }\n}\n</code></pre>\n\n<p>Correct output (variant 1):</p>\n\n<pre><code>main x: 0 [0 0 0 0]\nmain x: 1 [1 1 1 1]\nmain x: 2 [2 2 2 2]\nmain x: 3 [3 3 3 3]\n   worker 3 x: [3 3 3 3]\n   worker 3 y: [3 3 3 3]\n   worker 2 x: [2 2 2 2]\n   worker 2 y: [2 2 2 2]\n   worker 1 x: [0 0 0 0]\n   worker 1 y: [0 0 0 0]\n   worker 0 x: [1 1 1 1]\n   worker 0 y: [1 1 1 1]\n       main y: 0 [3 3 3 3]\n       main y: 1 [2 2 2 2]\n       main y: 2 [0 0 0 0]\n       main y: 3 [1 1 1 1]\n</code></pre>\n\n<p>Wrong output (variant 2):</p>\n\n<pre><code>main x: 0 [0 0 0 0]\nmain x: 1 [1 1 1 1]\nmain x: 2 [2 2 2 2]\nmain x: 3 [3 3 3 3]\n   worker 3 x: [3 3 3 3]\n   worker 3 y: [3 3 3 3]\n       main y: 0 [3 3 3 3]\n   worker 0 x: [2 2 2 2]\n   worker 0 y: [3 3 3 3]\n       main y: 1 [3 3 3 3]\n   worker 1 x: [1 1 1 1]\n   worker 1 y: [3 3 3 3]\n       main y: 2 [3 3 3 3]\n   worker 2 x: [3 3 3 3]\n   worker 2 y: [3 3 3 3]\n       main y: 3 [3 3 3 3]\n</code></pre>\n"}, {"tags": ["go", "concurrency", "parallel-processing"], "comments": [{"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1485025134, "post_id": 41783180, "comment_id": 70756591, "body": "Do you have multiple processor cores many of which are idle? If not, then on cache line considerations alone, a sequential search is likely to be faster."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1485027978, "creation_date": 1485027978, "answer_id": 41783737, "question_id": 41783180, "link": "https://stackoverflow.com/questions/41783180/how-to-search-a-huge-slice-of-mapsstringstring-concurrently/41783737#41783737", "title": "How to search a huge slice of maps[string]string concurrently", "body": "<p>This looks like just a simple typo. The problem is that you divide your original big slice into 5 pieces (<code>countOfSlices</code>), and you properly launch 5 goroutines to search each part:</p>\n\n<pre><code>for i := 0; i &lt; countOfSlices; i++ {\n    // Fragments of the array passed on to the search method\n    go func() { c &lt;- Search(data[(part*i):(part*(i+1))], term) }()\n\n}\n</code></pre>\n\n<p>This means you should expect <strong>5</strong> results, but you don't. You expect 4000-1 results:</p>\n\n<pre><code>for i := 0; i &lt; part-1; i++ {\n    select {\n    case records := &lt;-c:\n        result = append(result, records...)\n    case &lt;-timeout:\n        fmt.Println(\"timed out!\")\n        return result\n    }\n}\n</code></pre>\n\n<p>Obviously if you only launched 5 goroutines, each of which delivers 1 single result, you can only expect as many (5). And since your loop waits a lot more (which will never come), it times out as expected.</p>\n\n<p>Change the condition to this:</p>\n\n<pre><code>for i := 0; i &lt; countOfSlices; i++ {\n    // ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 0, "last_activity_date": 1485035459, "creation_date": 1485035459, "answer_id": 41784941, "question_id": 41783180, "link": "https://stackoverflow.com/questions/41783180/how-to-search-a-huge-slice-of-mapsstringstring-concurrently/41784941#41784941", "title": "How to search a huge slice of maps[string]string concurrently", "body": "<p>There are two problems - as icza notes you never finish the select as you need to use countOfSlices, and then also your call to Search will not get the data you want as you need to allocate that before calling the go func(), so allocate the slice outside and pass it in. </p>\n\n<p>You might find it still isn't faster though to do this particular work in parallel with such simple data (perhaps with more complex data on a machine with lots of cores it would be worthwhile)? </p>\n\n<p>Be sure when testing that you try swapping the order of your test runs - you might be surprised by the results! Also perhaps try the benchmarking tools available in the testing package which runs your code lots of times for you and averages the results, this might help you get a better idea of whether the fanout speeds things up.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1485086787, "creation_date": 1485086787, "answer_id": 41790684, "question_id": 41783180, "link": "https://stackoverflow.com/questions/41783180/how-to-search-a-huge-slice-of-mapsstringstring-concurrently/41790684#41790684", "title": "How to search a huge slice of maps[string]string concurrently", "body": "<p>Concurrency is not parallelism. Go is massively concurrent language, not parallel. Even using multicore machine you will pay for data exchange between CPUs when accessing your shared slice in computation threads. You can take advantage of concurrency searching just first match for example. Or doing something with results(say print them, or write to some Writer, or sort) <em>while</em> continue to search.</p>\n\n<pre><code>func Search(data []map[string]string, term string, ch chan map[string]string) {\n    for _, v := range data {\n        if v[\"key\"] == term {\n            ch &lt;- v\n        }\n    }\n}\nfunc main(){\n...\n    go search(datapart1, term, ch)\n    go search(datapart2, term, ch)\n    go search(datapart3, term, ch)\n...\n    for vv := range ch{\n        fmt.Println(vv) //do something with match concurrently\n    }\n...\n}\n</code></pre>\n\n<p>The recommended way to search huge slice would be to keep it sorted, or make binary tree. There are no magic.</p>\n"}], "owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 41783737, "answer_count": 3, "score": 1, "last_activity_date": 1485086787, "creation_date": 1485024776, "question_id": 41783180, "link": "https://stackoverflow.com/questions/41783180/how-to-search-a-huge-slice-of-mapsstringstring-concurrently", "title": "How to search a huge slice of maps[string]string concurrently", "body": "<p>I need to search a huge <code>slice</code> of <code>maps[string]string</code>. My thought was that this is a good chance for go's channel and go routines. </p>\n\n<p>The Plan was to divide the slice in parts and send search them in parallel.\nBut I was kind of shocked that my parallel version timed out while the search of the whole slice did the trick.</p>\n\n<p>I am not sure what I am doing wrong. Down below is my code which I used to test the concept. The real code would involve more complexity</p>\n\n<pre><code>//Search for a giving term\n//This function gets the data passed which will need to be search\n//and the search term and it will return the matched maps\n// the data is pretty simply the map contains { key: andSomeText }\nfunc Search(data []map[string]string, term string) []map[string]string {\n\n    set := []map[string]string{}\n\n    for _, v := range data {\n        if v[\"key\"] == term {\n\n            set = append(set, v)\n        }\n\n    }\n    return set\n\n}\n</code></pre>\n\n<p>So this works pretty well to search the slice of maps for a given SearchTerm.</p>\n\n<p>Now I thought if my slice would have like 20K entries, I would like to do the search in parallel</p>\n\n<pre><code>// All searches all records concurrently\n// Has the same function signature as the the search function\n// but the main task is to fan out the slice in 5 parts and search\n// in parallel\nfunc All(data []map[string]string, term string) []map[string]string {\n    countOfSlices := 5\n\n    part := len(data) / countOfSlices\n\n    fmt.Printf(\"Size of the data:%v\\n\", len(data))\n    fmt.Printf(\"Fragemnt Size:%v\\n\", part)\n\n    timeout := time.After(60000 * time.Millisecond)\n\n    c := make(chan []map[string]string)\n\n    for i := 0; i &lt; countOfSlices; i++ {\n        // Fragments of the array passed on to the search method\n        go func() { c &lt;- Search(data[(part*i):(part*(i+1))], term) }()\n\n    }\n\n    result := []map[string]string{}\n\n    for i := 0; i &lt; part-1; i++ {\n        select {\n        case records := &lt;-c:\n            result = append(result, records...)\n        case &lt;-timeout:\n            fmt.Println(\"timed out!\")\n            return result\n        }\n    }\n    return result\n}\n</code></pre>\n\n<p>Here are my tests:</p>\n\n<p>I have a function to generate my test data and 2 tests.</p>\n\n<pre><code>func GenerateTestData(search string) ([]map[string]string, int) {\n    rand.Seed(time.Now().UTC().UnixNano())\n    strin := []string{\"String One\", \"This\", \"String Two\", \"String Three\", \"String Four\", \"String Five\"}\n    var matchCount int\n    numOfRecords := 20000\n    set := []map[string]string{}\n    for i := 0; i &lt; numOfRecords; i++ {\n        p := rand.Intn(len(strin))\n        s := strin[p]\n        if s == search {\n            matchCount++\n        }\n        set = append(set, map[string]string{\"key\": s})\n    }\n    return set, matchCount\n}\n</code></pre>\n\n<p>The 2 tests: The first just traverses the slice and the second searches in parallel</p>\n\n<pre><code>func TestSearchItem(t *testing.T) {\n\n    tests := []struct {\n        InSearchTerm string\n        Fn           func(data []map[string]string, term string) []map[string]string\n    }{\n        {\n            InSearchTerm: \"This\",\n            Fn:           Search,\n        },\n        {InSearchTerm: \"This\",\n            Fn: All,\n        },\n    }\n\n    for i, test := range tests {\n\n        startTime := time.Now()\n        data, expectedMatchCount := GenerateTestData(test.InSearchTerm)\n        result := test.Fn(data, test.InSearchTerm)\n\n        fmt.Printf(\"Test: [%v]:\\nTime: %v \\n\\n\", i+1, time.Since(startTime))\n        assert.Equal(t, len(result), expectedMatchCount, \"expected: %v to be: %v\", len(result), expectedMatchCount)\n\n    }\n}\n</code></pre>\n\n<p>It would be great if someone could explain me why my parallel code is so slow? What is wrong with the code and what I am missing here as well as what the recommended way would be to search huge slices in memory 50K+.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": true, "score": 4, "last_activity_date": 1485024626, "creation_date": 1485024626, "answer_id": 41783156, "question_id": 41783108, "link": "https://stackoverflow.com/questions/41783108/checking-user-input-string/41783156#41783156", "title": "Checking user input string", "body": "<p>This is because <code>reader.ReadString</code> returns all the text including the delimiter, so the string returned will be <code>1\\n</code> not just <code>1</code>. From <a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">the documentation</a> (my emphasis):</p>\n\n<blockquote>\n<pre><code>func (*Reader) ReadString\n\nfunc (b *Reader) ReadString(delim byte) (string, error)\n</code></pre>\n  \n  <p><code>ReadString</code> reads until the first occurrence of <code>delim</code> in the input, returning a string containing the data <strong>up to and including the delimiter</strong>. If <code>ReadString</code> encounters an error before finding a delimiter, it returns the data read before the error and the error itself (often <code>io.EOF</code>). ReadString returns <code>err != nil</code> if and only if the returned data does not end in <code>delim</code>. For simple uses, a <code>Scanner</code> may be more convenient.</p>\n</blockquote>\n\n<p>Perhaps you want to do</p>\n\n<pre><code>return strings.TrimSpace(text)\n</code></pre>\n\n<p>at the end of <code>prompt()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 178, "user_id": 4958081, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/7ZLDY.png?s=128&g=1", "display_name": "secavfr", "link": "https://stackoverflow.com/users/4958081/secavfr"}, "is_accepted": false, "score": 0, "last_activity_date": 1485026121, "creation_date": 1485026121, "answer_id": 41783415, "question_id": 41783108, "link": "https://stackoverflow.com/questions/41783108/checking-user-input-string/41783415#41783415", "title": "Checking user input string", "body": "<p>Thank you !\nHere's the \"prompt()\" code which returns the correct input :</p>\n\n<pre><code>func prompt(toprint string) string{\n    if(toprint == \"\"){\n        toprint = \"Enter text :\";\n    }\n    reader := bufio.NewReader(os.Stdin);\n    fmt.Println(toprint);\n    text, _ := reader.ReadString('\\n');\n    return text[0:len(text)-2];\n}\n</code></pre>\n"}], "owner": {"reputation": 178, "user_id": 4958081, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/7ZLDY.png?s=128&g=1", "display_name": "secavfr", "link": "https://stackoverflow.com/users/4958081/secavfr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 41783156, "answer_count": 2, "score": 0, "last_activity_date": 1485026121, "creation_date": 1485024352, "question_id": 41783108, "link": "https://stackoverflow.com/questions/41783108/checking-user-input-string", "title": "Checking user input string", "body": "<p>I am new in GoLang and I am encountering a problem with this condition:\nEven if the input of the user is \"1\", it doesn't enter in the if statement.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"math\"\n    \"strings\"\n)\n\nfunc prompt(toprint string) string{\n    if(toprint == \"\"){\n        toprint = \"Enter text :\";\n    }\n    reader := bufio.NewReader(os.Stdin);\n    fmt.Println(toprint);\n    text, _ := reader.ReadString('\\n');\n    return text;\n}\n\nfunc main() {\n    choice := prompt(\"Please enter '1'\");\n\n    if(strings.Compare(\"1\",choice)==0||choice==\"1\"){\n        // D'ONT ENTER HERE EVEN WHEN choice==\"1\"\n    }else{\n        // Always go here\n    }\n}\n</code></pre>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["go", "deadlock", "channel", "goroutine"], "comments": [{"owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485018596, "post_id": 41782133, "comment_id": 70754354, "body": "Link to above code is <a href=\"https://play.golang.org/p/3YL2eoTVn1\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485019691, "post_id": 41782273, "comment_id": 70754743, "body": "Thanks @abligh for the reply but it seems like there is some typo or i misunderstood your answer. Point#2 : write to channel k happens in go routine 3 Also goroutine 3 will never execute as per you?"}, {"owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485020177, "post_id": 41782273, "comment_id": 70754922, "body": "And understand the buffer size concept you mention but i wrongly said size 1 instead of 0, I read that <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">here</a>. Thanks for correcting me."}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485021801, "post_id": 41782273, "comment_id": 70755498, "body": "@sheikhsabeer I&#39;ve fixed deadlock explanation"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485022038, "post_id": 41782273, "comment_id": 70755587, "body": "@sheikhsabeer nothing in that link I can see suggests <code>make</code> on a channel without an argument makes a buffered channel with buffer size 1. <code>make</code> without an argument makes an unbuffered channel. The difference is explained at the bottom of <a href=\"https://www.golang-book.com/books/intro/10\" rel=\"nofollow noreferrer\">golang-book.com/books/intro/10</a> and more formally at <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Channel_types</a> - I will edit the answer to include this."}, {"owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485023259, "post_id": 41782273, "comment_id": 70755966, "body": "thanks again for the reply Couple of question to the updated explanation : Point#3 : if goroutine 3 writes to the channel then output should have log <code>k done</code> and goroutine 2 is only reading channel <code>k</code> not writing to it."}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485023453, "post_id": 41782273, "comment_id": 70756028, "body": "@sheikhsabeer no need to thank - just upvote and (if this ends up the best answer) accept the answer with the &#39;tick&#39;."}, {"owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485023546, "post_id": 41782273, "comment_id": 70756063, "body": "I am not saying that making channel without args make channel of size 1. In case of unbuffered channel this should work chan &lt;- val &lt;-chan but not  &lt;-chan chan &lt;-val"}], "tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": true, "score": 3, "last_activity_date": 1485022118, "last_edit_date": 1485022118, "creation_date": 1485019300, "answer_id": 41782273, "question_id": 41782133, "link": "https://stackoverflow.com/questions/41782133/write-to-channel-blocked-forever/41782273#41782273", "title": "Write to channel blocked forever", "body": "<p>You have a deadlock.</p>\n\n<ul>\n<li>goroutine 1 writes to <code>s</code> then quits</li>\n<li>goroutine 2 reads from <code>s</code>, and writes to <code>c</code></li>\n<li>goroutine 3 reads from <code>c</code>, and writes to <code>k</code>, and this blocks because nothing is reading from <code>k</code>, because goroutine 2 is blocked in the write to <code>k</code> above.</li>\n<li>goroutine 2 writes to <code>c</code> again which blocks as goroutine 3 is still trying to write to <code>k</code> and thus is not reading from <code>c</code></li>\n</ul>\n\n<p>Contrary to what you say, you don't have a buffer size of 1. You have a buffer size of zero (i.e. an unbuffered channel), so a write will block until something reads. This is probably the source of your misunderstanding. Per the <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"nofollow noreferrer\">language specification</a>:</p>\n\n<blockquote>\n  <p>A new, initialized channel value can be made using the built-in function <code>make</code>, which takes the channel type and an optional capacity as arguments:</p>\n\n<pre><code>make(chan int, 100)\n</code></pre>\n  \n  <p>The capacity, in number of elements, sets the size of the buffer in the channel. If the capacity is zero or absent, the channel is unbuffered and communication succeeds only when both a sender and receiver are ready. Otherwise, the channel is buffered and communication succeeds without blocking if the buffer is not full (sends) or not empty (receives). A nil channel is never ready for communication.</p>\n</blockquote>\n"}], "owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "accepted_answer_id": 41782273, "answer_count": 1, "score": 2, "last_activity_date": 1485051098, "creation_date": 1485018522, "last_edit_date": 1485051098, "question_id": 41782133, "link": "https://stackoverflow.com/questions/41782133/write-to-channel-blocked-forever", "title": "Write to channel blocked forever", "body": "<p>I am stuck in a strange situation where the write operation to the channel never happens.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    c := make(chan int)\n    s := make(chan bool)\n    k := make(chan bool)\n    fmt.Println(\"start\")\n    go func() {\n    fmt.Println(\"routine 1\")\n        s &lt;- true\n    }()\n    go func() {\n    fmt.Println(\"routine 2\")\n        for {\n            select {\n            case  &lt;-s :\n                for i := 0; i &lt; 3; i++ {\n                    fmt.Println(\"before\")\n                    c &lt;- i\n                    fmt.Println(\"after\")\n                }       \n            case &lt;- k :\n                fmt.Println(\"k ready\")\n                break\n            }\n        }\n    }()\n\n    go func() {\n        fmt.Println(\"routine 3\")\n        for {\n            select {\n                case x := &lt;- c :\n                fmt.Println(\"x=\", x)\n                k &lt;- true\n                fmt.Println(\"k done\")\n\n            }\n        }\n    }()\n\n    time.Sleep(1000 * time.Millisecond)\n}\n</code></pre>\n\n<p>And here is the output:</p>\n\n<pre><code>start\nroutine 1\nroutine 2\nbefore\nroutine 3\nx= 0\nafter\nbefore\n</code></pre>\n\n<p>I wonder why the write to the channel k blocks, but the log statement <code>fmt.Println(\"k ready\")</code> is never printed.</p>\n\n<p>Here is what I think :</p>\n\n<ul>\n<li>go routine 1 writes true to channel s </li>\n<li>go routine 2 writes 0 to\nchannel c and waits because buffer size is 0, it will not be able to\nwrite '1' to it unless someone reads channel c </li>\n<li>go routine 3 comes into the picture, reads channel c (now go routine 2\ncan write to c once go routine 2 resumes) prints the value of x. <strong>NOW IT SHOULD BE ABLE TO WRITE TO CHANNEL K but that is not happening</strong></li>\n</ul>\n\n<p>According to me it should be able to write to channel k then case 2 of goroutine should execute and print \"k ready\"</p>\n\n<p>Can anyone explain me why write to the channel blocked?\nAs a fix I know I can increase the buffer size of channel c and everything will get printed but I am not interested in fixing this, instead I want to understand this scenario.</p>\n\n<p>A nice <a href=\"https://www.goinggo.net/page/3.html\" rel=\"nofollow noreferrer\">blog</a> to understand the above case.</p>\n"}, {"tags": ["sockets", "go", "network-programming", "unix-socket"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1485028272, "post_id": 41782004, "comment_id": 70757584, "body": "I&#39;m not sure if this is the issue, but there is one difference between those two methods: <code>echo</code> sends a newline and your Go program doesn&#39;t."}, {"owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1485029930, "post_id": 41782004, "comment_id": 70758115, "body": "@AndySchweig Yep that was it!"}], "answers": [{"comments": [{"owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "edited": false, "score": 1, "creation_date": 1485033336, "post_id": 41784069, "comment_id": 70759127, "body": "Also, check the bytes written <code>b, err = c.Write(...</code> to make sure that the whole string was sent."}], "tags": [], "owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "is_accepted": true, "score": 1, "last_activity_date": 1485031703, "last_edit_date": 1485031703, "creation_date": 1485030192, "answer_id": 41784069, "question_id": 41782004, "link": "https://stackoverflow.com/questions/41782004/send-json-to-a-unix-socket-with-golang/41784069#41784069", "title": "Send JSON to a unix socket with golang", "body": "<p>Thanks to @AndySchweig in the comments above, I needed a new line after my JSON.</p>\n\n<p>The fixed line:</p>\n\n<pre><code>  _, err = c.Write([]byte(`{\"command\":[\"quit\"]}` + \"\\n\"))\n</code></pre>\n\n<p>The full block of fixed code:</p>\n\n<pre><code>func main() {                                     \n  c, err := net.Dial(\"unix\", \"/tmp/mpvsocket\")    \n  if err != nil {                                 \n    panic(err)                                    \n  }                                               \n  defer c.Close()                                 \n\n  _, err = c.Write([]byte(`{\"command\":[\"quit\"]}` + \"\\n\"))\n  if err != nil {                                 \n    log.Fatal(\"write error:\", err)                \n  }                                               \n}                                     \n</code></pre>\n"}], "owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2023, "favorite_count": 0, "accepted_answer_id": 41784069, "answer_count": 1, "score": 2, "last_activity_date": 1485031703, "creation_date": 1485017705, "question_id": 41782004, "link": "https://stackoverflow.com/questions/41782004/send-json-to-a-unix-socket-with-golang", "title": "Send JSON to a unix socket with golang", "body": "<p>I'm trying to write a golang program to control <code>mpv</code> via issuing commands to a unix socket running at <code>/tmp/mpvsocket</code>.</p>\n\n<p>This is what I've tried so far:</p>\n\n<pre><code>func main() {                                     \n  c, err := net.Dial(\"unix\", \"/tmp/mpvsocket\")    \n  if err != nil {                                 \n    panic(err)                                    \n  }                                               \n  defer c.Close()                                 \n\n  _, err = c.Write([]byte(`{\"command\":[\"quit\"]}`))\n  if err != nil {                                 \n    log.Fatal(\"write error:\", err)                \n  }                                               \n}                                                 \n</code></pre>\n\n<p>This should cause mpv to quit but nothing happens.</p>\n\n<p>This command can be issued via the command line to get the expected results:</p>\n\n<pre><code>echo '{ \"command\": [\"quit\"] }' | socat - /tmp/mpvsocket\n</code></pre>\n\n<p>It uses <code>socat</code> to send the JSON to the socket. How can I send this to the socket using Golang?</p>\n"}, {"tags": ["performance", "file", "go"], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 2, "last_activity_date": 1485022406, "creation_date": 1485022406, "answer_id": 41782757, "question_id": 41781840, "link": "https://stackoverflow.com/questions/41781840/go-seekwrite-vs-writeat-performance/41782757#41782757", "title": "Go: Seek+Write vs WriteAt performance", "body": "<p><code>seek()</code>+<code>read()</code> and <code>seek()</code> + <code>write()</code> are both a pair of sys-calls while <code>pread()</code> and <code>pwrite()</code> are single sys-calls. Less sys-calls - more efficiency.</p>\n\n<p>You can definitly go for the <code>WriteAt</code></p>\n"}], "owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1485022406, "creation_date": 1485016868, "question_id": 41781840, "link": "https://stackoverflow.com/questions/41781840/go-seekwrite-vs-writeat-performance", "title": "Go: Seek+Write vs WriteAt performance", "body": "<p>I've just started to study <code>Go</code>'s filesystem operations. It seems like there are at least two ways to perform random file writes:</p>\n\n<pre><code>// 1. First set the offset, then write data \nf.Seek(offset, whence)\nf.Write(data)\n\n// 2. Write by offset in one step\nf.WriteAt(data, offset)\n</code></pre>\n\n<p>All of three functions (<code>Seek</code>, <code>Write</code>, <code>WriteAt</code>) are implemented with the use of different syscalls: on Unix systems <code>Write</code> is implemented via <a href=\"https://golang.org/src/os/file_unix.go#L249\" rel=\"nofollow noreferrer\"><code>syscall.Write</code></a> and <code>WriteAt</code> has <a href=\"https://golang.org/src/os/file_unix.go#L275\" rel=\"nofollow noreferrer\"><code>syscall.Pwrite</code></a> inside. </p>\n\n<p>Since <code>Seek+Write</code> perform two syscalls, whereas <code>WriteAt</code> requires only one syscall, should the second method be preferred for the sake of better performance?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 1248, "user_id": 2298377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ji8D8.jpg?s=128&g=1", "display_name": "John Hua", "link": "https://stackoverflow.com/users/2298377/john-hua"}, "is_accepted": true, "score": 1, "last_activity_date": 1485013010, "creation_date": 1485013010, "answer_id": 41781182, "question_id": 41781052, "link": "https://stackoverflow.com/questions/41781052/how-to-determine-the-type-of-json-object-in-go/41781182#41781182", "title": "How to determine the type of json object in go", "body": "<p>Checkout the definition of json.Unmarshal:</p>\n\n<pre><code>func Unmarshal(data []byte, v interface{}) error\n</code></pre>\n\n<p>So at least you can obtain the underlying type by using reflect.</p>\n\n<pre><code>var v interface{}\njson.Unmarshal([]byte(JSON_STR), &amp;v)\nfmt.Println(reflect.TypeOf(v), reflect.ValueOf(v))\n</code></pre>\n\n<p>And <code>switch</code> definitely is a better practice. I suppose below snippet</p>\n\n<pre><code>switch result := v.(type) {\ncase map[string]interface{}:\n    fmt.Println(\"dict:\", result)\ncase []interface{}:\n    fmt.Println(\"list:\", result)\ndefault:\n    fmt.Println(\"value:\", result)\n}\n</code></pre>\n\n<p>can basically meet your requirement.</p>\n"}], "owner": {"reputation": 13, "user_id": 7449475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/673b6ddf9e1291a6e444d896ce7fe515?s=128&d=identicon&r=PG&f=1", "display_name": "mcdermwarwcri", "link": "https://stackoverflow.com/users/7449475/mcdermwarwcri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1639, "favorite_count": 0, "accepted_answer_id": 41781182, "answer_count": 1, "score": 1, "last_activity_date": 1485024568, "creation_date": 1485012253, "last_edit_date": 1485024568, "question_id": 41781052, "link": "https://stackoverflow.com/questions/41781052/how-to-determine-the-type-of-json-object-in-go", "title": "How to determine the type of json object in go", "body": "<p>In <a href=\"https://gobyexample.com/json\" rel=\"nofollow noreferrer\">gobyexample.com/json</a>, a few examples show how to decode <code>json</code> string into typed objects or dictionary objects, which are declared as <code>map[string]interface{}</code>. But it assumes the result is always a dictionary. </p>\n\n<p>So my question is how to determine the type of <code>json</code> object and what is the best practice to handle that?</p>\n"}, {"tags": ["eclipse", "go", "breakpoints", "eclipse-neon", "goclipse"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485011510, "post_id": 41780854, "comment_id": 70751993, "body": "Some possible reasons/tips: maybe you&#39;re in a different perspective (e.g Go perspective at work and Java perspective at home), or you opened the Go file with a different editor type (e.g. Go editor vs Java editor), you don&#39;t have the necessary tools configured in Eclipse (e.g. Go debugger)."}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485011703, "post_id": 41780854, "comment_id": 70752060, "body": "I have the Go perspective up on both, Both were started via new Go Project and using go files.  GDB is used for debugging both."}, {"owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "edited": false, "score": 0, "creation_date": 1485197879, "post_id": 41780854, "comment_id": 70815313, "body": "Is the Go editor open on both situations? Is the file part of an Eclipse project, or is somehow an external file?"}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "edited": false, "score": 0, "creation_date": 1485283639, "post_id": 41780854, "comment_id": 70858586, "body": "Yes, the go editor is open on both and the file is part of an Eclipse project."}], "answers": [{"tags": [], "owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "is_accepted": false, "score": 0, "last_activity_date": 1486371578, "creation_date": 1486371578, "answer_id": 42063803, "question_id": 41780854, "link": "https://stackoverflow.com/questions/41780854/how-do-i-make-a-breakpoint-in-eclipse-neon-using-goclipse/42063803#42063803", "title": "How do I make a breakpoint in Eclipse Neon using GoClipse?", "body": "<p>Did you double click on the editor column? Or opened the context menu there? Just a single-click won't work.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XS6o2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XS6o2.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486371578, "creation_date": 1485010989, "question_id": 41780854, "link": "https://stackoverflow.com/questions/41780854/how-do-i-make-a-breakpoint-in-eclipse-neon-using-goclipse", "title": "How do I make a breakpoint in Eclipse Neon using GoClipse?", "body": "<p>I have a GoClipse project in Eclipse Neon that I am attempting to debug.  On my work computer I am able to create a new breakpoint by clicking on the left side of the code window, but on my home computer this is not working.  Is there somthing that I do not have enabled on my home computer?\nHow do I make a breakpoint in Eclipse Neon using GoClipse?</p>\n"}, {"tags": ["string", "for-loop", "go", "unicode", "utf-8"], "answers": [{"comments": [{"owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "edited": false, "score": 0, "creation_date": 1485004580, "post_id": 41779238, "comment_id": 70749919, "body": "That blog post was very useful and I recommend anyone with a similar query to read it. I think my confusion was thinking <code>range</code> performed some implicit conversion to a slice of runes, when actually it does not. Thank you."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1485006039, "last_edit_date": 1495540376, "creation_date": 1485001050, "answer_id": 41779238, "question_id": 41779147, "link": "https://stackoverflow.com/questions/41779147/what-determines-the-position-of-a-character-when-looping-through-utf-8-strings/41779238#41779238", "title": "What determines the position of a character when looping through UTF-8 strings?", "body": "<p><code>string</code> values in Go are stored as read only byte slices (<code>[]byte</code>), where the bytes are the UTF-8 encoded bytes of the (<code>rune</code>s of the) <code>string</code>. <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">UTF-8</a> is a variable-length encoding, different Unicode code points may be encoded using different number of bytes. For example values in the range <code>0..127</code> are encoded as a single byte (whose value is the unicode codepoint itself), but values greater than 127 use more than 1 byte. The <a href=\"https://golang.org/pkg/unicode/utf8/\" rel=\"nofollow noreferrer\"><code>unicode/utf8</code></a> package contains UTF-8 related utility functions and constants, for example <code>utf8.UTFMax</code> reports the maximum number of bytes a valid Unicode codepoint may \"occupy\" in UTF-8 encoding (which is 4).</p>\n\n<p>One thing to note here: <em>not</em> all possible byte sequences are <em>valid</em> UTF-8 sequences. A <code>string</code> may be <em>any</em> byte sequence, even those that are invalid UTF-8 sequences. For example the <code>string</code> value <code>\"\\xff\"</code> represents an invalid UTF-8 byte sequence, for details, see <a href=\"https://stackoverflow.com/questions/30731687/how-do-i-represent-an-optional-string-in-go/30741287#30741287\">How do I represent an Optional String in Go?</a></p>\n\n<p>The <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\"><code>for range</code></a> construct \u2013when applied on a <code>string</code> value\u2013 iterates over the runes of the <code>string</code>:</p>\n\n<blockquote>\n  <p>For a string value, the \"range\" clause iterates over the Unicode code points in the string starting at byte index 0. On successive iterations, the index value will be the index of the first byte of successive UTF-8-encoded code points in the string, and the second value, of type <code>rune</code>, will be the value of the corresponding code point. <strong>If the iteration encounters an invalid UTF-8 sequence, the second value will be <code>0xFFFD</code>, the Unicode replacement character, and the next iteration will advance a single byte in the string.</strong></p>\n</blockquote>\n\n<p>The <code>for range</code> construct may produce 1 or 2 iteration values. When using 2, like in your example:</p>\n\n<pre><code>for pos, char := range \"\u65e5\u672c\\x80\u8a9e\" {\n    fmt.Printf(\"Character %#U, at position: %d\\n\", char, pos)\n}\n</code></pre>\n\n<p>For each iteration, <code>pos</code> will be byte index of the rune / character, and <code>char</code> will be the rune of the <code>string</code>. As you can see in the quote above, if the <code>string</code> is an invalid UTF-8 byte sequence, when an invalid UTF-8 sequence is encountered, <code>char</code> will be <code>0xFFFD</code> (the Unicode replacement character), and the <code>for range</code> construct (the iteration) will advance a <strong>singe byte only</strong>.</p>\n\n<p><strong>To sum it up:</strong> The position is always the byte index of the <code>rune</code> of the current iteration (or more specifically: the byte index of the first byte of the UTF-8 encoded sequence of the <code>rune</code> of the current iteration), but if invalid UTF-8 sequence is encountered, the position (index) will only be incremented by 1 in the next iteration.</p>\n\n<p>A must-read blog post if you want to know more about the topic:</p>\n\n<p><a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">The Go Blog: Strings, bytes, runes and characters in Go</a></p>\n"}, {"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1485002472, "last_edit_date": 1485002472, "creation_date": 1485002003, "answer_id": 41779394, "question_id": 41779147, "link": "https://stackoverflow.com/questions/41779147/what-determines-the-position-of-a-character-when-looping-through-utf-8-strings/41779394#41779394", "title": "What determines the position of a character when looping through UTF-8 strings?", "body": "<p><code>rune</code> is code point. Code point is just integer. You can even use <code>int64</code> to store it if you want to. (But Unicode only has 1,114,112 code points so <code>int32</code> should be the right choice. No wonder <code>rune</code> is alias of int32 in Golang.)</p>\n\n<p>Different encoding schemes encode code points in different ways. E.g. CJK character is usually encoded to 3 bytes in UTF-8, and to 2 bytes in UTF-16. </p>\n\n<p>String literal in Golang is UTF-8.</p>\n"}], "owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 41779238, "answer_count": 2, "score": 2, "last_activity_date": 1485006039, "creation_date": 1485000471, "last_edit_date": 1485003286, "question_id": 41779147, "link": "https://stackoverflow.com/questions/41779147/what-determines-the-position-of-a-character-when-looping-through-utf-8-strings", "title": "What determines the position of a character when looping through UTF-8 strings?", "body": "<p>I am reading the section on <code>for</code> statements in the <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">Effective Go documentation</a> and came across this example:</p>\n\n<pre><code>for pos, char := range \"\u65e5\u672c\\x80\u8a9e\" {\n    fmt.Printf(\"Character %#U, at position: %d\\n\", char, pos)\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Character U+65E5 '\u65e5', at position: 0\nCharacter U+672C '\u672c', at position: 3\nCharacter U+FFFD '\ufffd', at position: 6\nCharacter U+8A9E '\u8a9e', at position: 7\n</code></pre>\n\n<p>What I don't understand is why the positions are 0, 3, 6, and 7. This tells me the first and second character is 3 bytes long and the 'replacement rune' (U+FFFD) is 1 byte long, which I accept and understand. However, I thought <code>rune</code> was of <code>int32</code> type and therefore would be 4 bytes each, not three.</p>\n\n<p>Why are the positions in a range different to the total amount of memory each value should be consuming?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 1571, "user_id": 1587118, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cBN8s.jpg?s=128&g=1", "display_name": "SRC", "link": "https://stackoverflow.com/users/1587118/src"}, "is_accepted": true, "score": 0, "last_activity_date": 1485018925, "creation_date": 1485018925, "answer_id": 41782190, "question_id": 41778758, "link": "https://stackoverflow.com/questions/41778758/can-not-get-data-by-objectid-from-mongodb-using-mgo/41782190#41782190", "title": "Can not get data by ObjectId from MongoDB using mgo", "body": "<p>You can try this</p>\n\n<pre><code>c.FindId(bson.M{\"_id\": bson.ObjectIdHex(\"56bdd27ecfa93bfe3d35047d\")})\n</code></pre>\n\n<p>may be it will solve your problem</p>\n"}], "owner": {"reputation": 13, "user_id": 5545180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nt1ea03z6YI/AAAAAAAAAAI/AAAAAAAAABE/26--Jh2kjT8/photo.jpg?sz=128", "display_name": "factor X", "link": "https://stackoverflow.com/users/5545180/factor-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 41782190, "answer_count": 1, "score": 1, "last_activity_date": 1485018925, "creation_date": 1484997962, "last_edit_date": 1485005521, "question_id": 41778758, "link": "https://stackoverflow.com/questions/41778758/can-not-get-data-by-objectid-from-mongodb-using-mgo", "title": "Can not get data by ObjectId from MongoDB using mgo", "body": "<p>I have a <code>PersonalAccount</code> type as</p>\n\n<pre><code>type PersonalAccount struct {\n        ID        bson.ObjectId   `json:\"id\" bson:\"_id,omitempty\"`\n}\n</code></pre>\n\n<p>then I get a marshaled <code>PersonalAccount</code> through an HTTP request, and the data is unmarshaled successfully and when I check the ID type.\nIt is a <code>bson.ObjecID</code></p>\n\n<p>The problem is when I try the code below:</p>\n\n<pre><code>var m PersonalAccount = unmarshaledAccount\nmgo.DB(\"dbname\").C(\"colname\").FindId(m.ID)\n</code></pre>\n\n<p>It returns an error that says it is not found.</p>\n\n<p>I have also tried:</p>\n\n<pre><code>var m PersonalAccount = unmarshaledAccount\nmgo.DB(\"dbname\").C(\"colname\").Find(bson.M{\"_id\": m.ID})\n</code></pre>\n\n<p>but with no luck.</p>\n"}, {"tags": ["git", "go", "hook"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1484988775, "last_edit_date": 1495540897, "creation_date": 1484988775, "answer_id": 41777420, "question_id": 41777068, "link": "https://stackoverflow.com/questions/41777068/how-to-properly-get-return-code-of-go-build/41777420#41777420", "title": "How to properly get return code of go build?", "body": "<p>Any <code>pre-commit</code> hook will be executed by a git bash (even on Windows), so you can script it through a regular bash script.</p>\n\n<p>See <a href=\"https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks\" rel=\"nofollow noreferrer\">Git Hooks</a></p>\n\n<blockquote>\n  <p>Exiting non-zero from this hook aborts the commit, although you can bypass it with <code>git commit --no-verify</code>. </p>\n</blockquote>\n\n<pre><code>#!/bin/bash\nset -e\ngo build\n</code></pre>\n\n<p>(from \"<a href=\"https://stackoverflow.com/a/5195826/6309\">Checking Bash exit status of several commands efficiently</a>\")<br>\nThat way, you can chain multiple commands (like <a href=\"https://golang.org/cmd/vet/\" rel=\"nofollow noreferrer\"><code>go vet</code></a>, other <a href=\"https://www.timeferret.com/lint\" rel=\"nofollow noreferrer\">go linters</a>). If any of them fail, the <code>pre-commit</code> hook will prevent the commit.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "accepted_answer_id": 41777420, "answer_count": 1, "score": 0, "last_activity_date": 1484989257, "creation_date": 1484985692, "question_id": 41777068, "link": "https://stackoverflow.com/questions/41777068/how-to-properly-get-return-code-of-go-build", "title": "How to properly get return code of go build?", "body": "<p>I want to add <code>go build</code> into a precommit hook so that not to ship unbuildable code.</p>\n\n<p>If the build succeeds, I want to continue commit, otherwise fail and reject commit.</p>\n\n<p>How do I do it properly?</p>\n"}, {"tags": ["xml", "go", "marshalling", "unmarshalling"], "comments": [{"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1484994769, "post_id": 41776930, "comment_id": 70747156, "body": "<a href=\"https://github.com/golang/go/issues/9519\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/9519</a>"}], "answers": [{"tags": [], "owner": {"reputation": 446, "user_id": 2428640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cdaaaa61e5541b98a01bbdfbdcff09?s=128&d=identicon&r=PG", "display_name": "Pascal de Kloe", "link": "https://stackoverflow.com/users/2428640/pascal-de-kloe"}, "is_accepted": false, "score": 0, "last_activity_date": 1485223485, "creation_date": 1485223485, "answer_id": 41818844, "question_id": 41776930, "link": "https://stackoverflow.com/questions/41776930/how-to-keep-the-namespace-url-of-a-tag-when-marshaling-xml-in-go/41818844#41818844", "title": "How to keep the namespace url of a tag when Marshaling XML in Go", "body": "<p>Root.XmlNS isn't unmarshalled.</p>\n\n<p><code>\"The prefix xmlns is used only to declare namespace bindings and is by definition bound to the namespace name http://www.w3.org/2000/xmlns/.\"</code>\n<a href=\"https://www.w3.org/TR/REC-xml-names/\" rel=\"nofollow noreferrer\">https://www.w3.org/TR/REC-xml-names/</a></p>\n\n<p>According to both the XML specification and the Go unmarshaling rules <code>xml:\"http://www.w3.org/2000/xmlns/ urn,attr\"</code> should work yet it doesn't. I don't think the maintainers will like the marshalling complexity that follows.</p>\n\n<p>You probably want to do the following.</p>\n\n<pre><code>    type Root struct {\n        XMLName      xml.Name     `xml:\"root\"`\n        Copyright    Copyright    `xml:\"http://test.example.com copyright\"`\n    }\n</code></pre>\n"}], "owner": {"reputation": 9266, "user_id": 1465640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b64a91edcfaad3c6290039008deea285?s=128&d=identicon&r=PG", "display_name": "Pylinux", "link": "https://stackoverflow.com/users/1465640/pylinux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 384, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485223485, "creation_date": 1484984517, "question_id": 41776930, "link": "https://stackoverflow.com/questions/41776930/how-to-keep-the-namespace-url-of-a-tag-when-marshaling-xml-in-go", "title": "How to keep the namespace url of a tag when Marshaling XML in Go", "body": "<p>When I unmarshal and marshal this XML the URL for the namespace disappear:</p>\n\n<pre><code>&lt;root xmlns:urn=\"http://test.example.com\"&gt;\n    &lt;urn:copyright&gt;tekst&lt;/urn:copyright&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>&lt;root xmlns:urn=\"\"&gt;\n    &lt;urn:copyright&gt;&lt;/urn:copyright&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>The code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\ntype Root struct {\n    XMLName      xml.Name     `xml:\"root\"`\n    XmlNS        string       `xml:\"xmlns:urn,attr\"`\n    Copyright    Copyright    `xml:\"urn:copyright,omitempty\"`\n}\n\ntype Copyright struct {\n    Text string `xml:\",chardata\"`\n}\n\nfunc main() {\n    root := Root{}\n\n    x := `&lt;root xmlns:urn=\"http://test.example.com\"&gt;\n               &lt;urn:copyright&gt;text&lt;/urn:copyright&gt;\n          &lt;/root&gt;`\n    _ = xml.Unmarshal([]byte(x), &amp;root)\n    b, _ := xml.MarshalIndent(root, \"\", \"    \")\n    fmt.Println(string(b))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/1jSURtWuZO\" rel=\"nofollow noreferrer\">https://play.golang.org/p/1jSURtWuZO</a></p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1485016777, "post_id": 41775106, "comment_id": 70753695, "body": "definetelly your FeatureConfig.Options tend to be <code>map[string][]string</code>. What is the trouble using such a type here?"}], "answers": [{"tags": [], "owner": {"reputation": 750, "user_id": 2809739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymnxe.jpg?s=128&g=1", "display_name": "Sachin Nambiar Nalavattanon", "link": "https://stackoverflow.com/users/2809739/sachin-nambiar-nalavattanon"}, "is_accepted": false, "score": -1, "last_activity_date": 1485244644, "creation_date": 1485244644, "answer_id": 41822845, "question_id": 41775106, "link": "https://stackoverflow.com/questions/41775106/unmarshal-yaml-into-unknown-struct/41822845#41822845", "title": "Unmarshal YAML into unknown struct", "body": "<p>You could make your config of type <code>map[string]interface{}</code> and let the developer using your library decode <code>interface{}</code> into required struct.<br>\nExample: <a href=\"https://play.golang.org/p/RVqKP09KR8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RVqKP09KR8</a></p>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 6784278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r1N4w.jpg?s=128&g=1", "display_name": "greg.carter", "link": "https://stackoverflow.com/users/6784278/greg-carter"}, "is_accepted": false, "score": 0, "last_activity_date": 1560800105, "last_edit_date": 1560800105, "creation_date": 1560788070, "answer_id": 56635202, "question_id": 41775106, "link": "https://stackoverflow.com/questions/41775106/unmarshal-yaml-into-unknown-struct/56635202#56635202", "title": "Unmarshal YAML into unknown struct", "body": "<p>I think in general what you are asking is how to unmarshal YAML when you don't know the structure which will be produced, yes? If so, what I've done is use <a href=\"https://github.com/ghodss/yaml\" rel=\"nofollow noreferrer\">ghodss/yaml</a> to convert YAML to JSON, then use the standard <code>encoding/json</code> to unmarshal. This gets you a <code>struct</code> with everything in the YAML doc, but you have to \"type switch\" your way through it, and key names, of course, may not be known a prioir.</p>\n\n<p>Here's an example: <a href=\"https://play.golang.org/p/8mcuot-lw0y\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8mcuot-lw0y</a></p>\n"}], "owner": {"reputation": 799, "user_id": 3424868, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcf80fb1346a0df9496355febe08ef3b?s=128&d=identicon&r=PG", "display_name": "Weston", "link": "https://stackoverflow.com/users/3424868/weston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1882, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1560800105, "creation_date": 1484964980, "question_id": 41775106, "link": "https://stackoverflow.com/questions/41775106/unmarshal-yaml-into-unknown-struct", "title": "Unmarshal YAML into unknown struct", "body": "<p>Sorry for the confusing title, I'm having trouble wording this question. So lets say I have a YAML config file like this</p>\n\n<pre><code>animals:\n  -\n    type: whale\n    options:\n      color: blue\n      name: Mr. Whale\n    features:\n       -\n         type: musician\n         options:\n           instruments:\n             - Guitar\n             - Violin\n</code></pre>\n\n<p>Very contrived example, but it's directly analogous to what I'm really working with.</p>\n\n<p>So now I have some structs to marshal this config into</p>\n\n<pre><code>type Config struct {\n  AnimalConfigs []*AnimalConfig `yaml:\"animals\"`\n}\n\ntype AnimalConfig struct{\n  Type string\n  Options map[string]string // ????\n  Features []*FeatureConfig\n}\n\ntype FeatureConfig struct{\n  Type string\n  Options ????\n}\n</code></pre>\n\n<p>So the problem here is that the animal types (whale, etc..), and features (musician, etc...) are not determined ahead of time, they can be added on as separate modules and can each have their own configurations. So say someone is using this library and wants to add their own animal. I do not know what this animal is, what it's options will be, and what it's features will be. I also don't know the structure of the feature's. All I know is that it will have a <code>type</code> property, and an <code>options</code> property. I would like the developer to be able to add custom animals and features, and my library can just do something like <code>YourAnimal.Create(yourConfig)</code>. </p>\n\n<p>I'm using the go-yaml library. As you can see in the AnimalConfig struct, my initial idea was to have the <code>options</code> and <code>features</code> just be <code>map[string]string</code>, and then let the custom module unmarshal that string into their own struct, but that wouldn't work for example with the <code>musician</code> feature because <code>instruments</code> is a list, not a string. Thanks!</p>\n"}, {"tags": ["html", "http", "go", "static"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 3728271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80517d46357349c3ae38c64860d11a08?s=128&d=identicon&r=PG", "display_name": "Alec Holmes", "link": "https://stackoverflow.com/users/3728271/alec-holmes"}, "edited": false, "score": 0, "creation_date": 1484968791, "post_id": 41775246, "comment_id": 70742004, "body": "That is so weird lol. Just tested and it worked like a charm! Thanks for the help!"}], "tags": [], "owner": {"reputation": 905, "user_id": 3781709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4fa60c6b287ee4f006d6c4e320daf5?s=128&d=identicon&r=PG", "display_name": "Pradip Patil", "link": "https://stackoverflow.com/users/3781709/pradip-patil"}, "is_accepted": true, "score": 1, "last_activity_date": 1484966917, "creation_date": 1484966917, "answer_id": 41775246, "question_id": 41774588, "link": "https://stackoverflow.com/questions/41774588/calling-http-fileserver-in-an-http-handlerfunc/41775246#41775246", "title": "Calling http.FileServer in an http.HandlerFunc", "body": "<p>It works if you use <code>mux.Router</code>'s <code>Path</code> method</p>\n\n<blockquote>\n<pre><code>r.Methods(route.Method).Name(route.Name).Handler(handler)\nr.Path(route.Pattern)\n</code></pre>\n</blockquote>\n\n<p>instead of <code>mux.Route</code>'s <code>Path</code> method (strikethrough'd below)</p>\n\n<blockquote>\n  <p>r.Methods(route.Method)<s>.Path(route.Pattern)</s>.Name(route.Name).Handler(handler)</p>\n</blockquote>\n\n<p>I am not much familiar with <code>gorilla/mux</code> so couldn't find exact reason behind this.</p>\n"}], "owner": {"reputation": 19, "user_id": 3728271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80517d46357349c3ae38c64860d11a08?s=128&d=identicon&r=PG", "display_name": "Alec Holmes", "link": "https://stackoverflow.com/users/3728271/alec-holmes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41775246, "answer_count": 1, "score": 0, "last_activity_date": 1484966917, "creation_date": 1484959497, "question_id": 41774588, "link": "https://stackoverflow.com/questions/41774588/calling-http-fileserver-in-an-http-handlerfunc", "title": "Calling http.FileServer in an http.HandlerFunc", "body": "<p>so I've had some trouble with this lately... Here is my code:</p>\n\n<p><a href=\"https://gist.github.com/anonymous/af1e6d922ce22597099521a4b2cfa16f\" rel=\"nofollow noreferrer\">https://gist.github.com/anonymous/af1e6d922ce22597099521a4b2cfa16f</a></p>\n\n<p>My problem: I'm trying to serve up some HTML files from a folder: <code>./docs/html</code>. My folder structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 docs\n\u2502   \u2514\u2500\u2500 html\n\u2502       \u251c\u2500\u2500 index.html\n\u2502       \u2514\u2500\u2500 rest.html\n\u2514\u2500\u2500 main.go\n</code></pre>\n\n<p>You'll notice in the gist I am calling the <code>ServeHTTP</code> method on the <code>http.HandlerFunc</code> ServeDocs, which is then going through a router (<code>mux.Router</code>). The problem I'm having is for some reason the only file being served up at <code>localhost:8080/</code> is <code>index.html</code>, and when I navigate to <code>localhost:8080/rest.html</code> I get a 404. </p>\n\n<p>The really odd part is that when I remove all the router code and do something like the following:</p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"./docs/html\"))\nhttp.Handle(\"/\", fs)\n\nlog.Println(\"Listening...\")\nhttp.ListenAndServe(\":3000\", nil)\n</code></pre>\n\n<p>Everything works as it should. Anybody know what's going on? I've spent hours trying to figure this out and I've finally given up.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1484943420, "post_id": 41771442, "comment_id": 70734786, "body": "yes, you&#39;re stripping the exif rotation tag."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 8747724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a08e42a4859be0b939f9cb570d39426b?s=128&d=identicon&r=PG&f=1", "display_name": "Johan terryn", "link": "https://stackoverflow.com/users/8747724/johan-terryn"}, "is_accepted": false, "score": 3, "last_activity_date": 1507572266, "creation_date": 1507572266, "answer_id": 46652470, "question_id": 41771442, "link": "https://stackoverflow.com/questions/41771442/golang-some-images-are-rotating-on-image-upload/46652470#46652470", "title": "Golang some images are rotating on image upload", "body": "<p>The image is not being rotated in the process, the original image was shown in some image view software in  rotated mode depending on the image orientation tag (val x00112) in the Exif part of the file. When you strip the Exif part, as image package does, you lose that information and the image is shown in standard camera orientation format (landscape).</p>\n"}, {"tags": [], "owner": {"reputation": 1025, "user_id": 6219895, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/6lGIm.jpg?s=128&g=1", "display_name": "Adear", "link": "https://stackoverflow.com/users/6219895/adear"}, "is_accepted": false, "score": 0, "last_activity_date": 1593004023, "creation_date": 1593004023, "answer_id": 62555781, "question_id": 41771442, "link": "https://stackoverflow.com/questions/41771442/golang-some-images-are-rotating-on-image-upload/62555781#62555781", "title": "Golang some images are rotating on image upload", "body": "<p>Old question but i thought i would add some extra information here to help anyone who is confused about what Exif is.</p>\n<p>When an image is uploaded from a phone it stays in the orientation that it was taken in. However meta data is then added to that image under the key <code>Orientation</code> to tell you which way the image was taken. Phone libaries can then use this to show you the image the correct way around and so can you. It can be a number between 0 - 8. The only orientation numbers you will need to worry about is 3 (rotate 180), 6 (rotate 270) and 8 (rotate 90).</p>\n<p>To get a hold of the meta information on an image you can use something like <a href=\"https://github.com/rwcarlsen/goexif/exif\" rel=\"nofollow noreferrer\">github.com/rwcarlsen/goexif/exif</a>. Here is a snippet on how you can then get the rotation from that.</p>\n<pre><code>x, err := exif.Decode(openedFileExif)\nvar rotation float64 = 0\n\n    if err == nil  {\n        orientationRaw, err := x.Get(&quot;Orientation&quot;)\n\n        if err == nil {\n            orientation := orientationRaw.String()\n\n            if orientation == &quot;3&quot; {\n                rotation = 180\n            } else if orientation == &quot;6&quot; {\n                rotation = 270\n            } else if orientation == &quot;8&quot; {\n                rotation = 90\n            }\n        }\n\n    }\n</code></pre>\n<p>Now that you have the rotation required you just need to rotate the image by that amount and you will have your normally oriented picture.</p>\n<p>You can use something like <a href=\"https://github.com/disintegration/imaging\" rel=\"nofollow noreferrer\">github.com/disintegration/imaging</a> for that. uploadedImage needs to be golang image.Image</p>\n<pre><code>if rotation != 0 {\n            uploadedImage = imaging.Rotate(uploadedImage, rotation, color.Gray{})\n        }\n</code></pre>\n"}], "owner": {"reputation": 1195, "user_id": 1949387, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/07aecc3a985b916b35133da1d5b5634c?s=128&d=identicon&r=PG", "display_name": "user1949387", "link": "https://stackoverflow.com/users/1949387/user1949387"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593004023, "creation_date": 1484942458, "question_id": 41771442, "link": "https://stackoverflow.com/questions/41771442/golang-some-images-are-rotating-on-image-upload", "title": "Golang some images are rotating on image upload", "body": "<p>I am facing a rather weird problem, I am using Golang as a backend restful API and I upload images and resize them with Go . I have an app for I-phone that I am testing and if I upload an image using my real device the image gets saved in my s3 account sideways. For some reason resizing my image is rotating it, however if I upload the image from my Xcode IDE then the image gets saved correctly without rotation . I am thinking that maybe something is getting stripped however I have no idea what that could, my code is this</p>\n\n<pre><code>func UploadStreamImage(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    var buff bytes.Buffer\n    var result string\n\n    wg := sync.WaitGroup{}\n       print(\"Exoler-Streams\")\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n\n\n        sess, _ := 's3 credentials'\n\n        svc := s3.New(sess)\n\n        file, handler, err := r.FormFile(\"file\")\n        if err != nil {\n            fmt.Println(\"Error Uploading Image\")\n            return\n        }\n        defer file.Close()\n        // resize image\n        img,err := imaging.Decode(file)\n        if err != nil {\n            print(\"Imaging Open error\")\n        }\n        new_image := imaging.Resize(img, 300, 300, imaging.Lanczos)\n        var buf bytes.Buffer\n\n\n        err = imaging.Encode(&amp;buf,new_image, imaging.JPEG)\n        if err != nil {\n            log.Println(err)\n            return\n        }\n\n        // end resize\n\n        r := bytes.NewReader(buf.Bytes())\n\n\n\n\n\n        read_file,err := ioutil.ReadAll(r)\n        if err != nil {\n            fmt.Println(\"Error Reading file\")\n               }\n    // s3 specific code\n        }\n</code></pre>\n\n<p>The library I am using is this <a href=\"https://github.com/disintegration/imaging\" rel=\"nofollow noreferrer\">https://github.com/disintegration/imaging</a> and I am just thinking that something is being stripped when uploading the image from my real device thus it is messing up the rotation . The code on the front-end is all the same for my real device and Xcode .</p>\n"}, {"tags": ["mysql", "sql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1484934060, "post_id": 41769220, "comment_id": 70730249, "body": "Did you mean <code>gorm:&quot;auto&quot;</code> or am I reading the wrong documentation?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1484934253, "post_id": 41769220, "comment_id": 70730350, "body": "<a href=\"https://godoc.org/github.com/astaxie/beego/orm\" rel=\"nofollow noreferrer\">It looks like you&#39;re being dishonest about using GORM</a>. Still, I think my answer applies."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1484934269, "post_id": 41769220, "comment_id": 70730356, "body": "They are called <i>tags</i>, and they allow you to attach any meta-information to the fields, in this case will be used by some ORM implementation (e.g. <code>gorm</code> package). See <a href=\"http://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">What are the use(s) for tags in Go?</a>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1484934507, "post_id": 41769220, "comment_id": 70730482, "body": "@icza: Should be an answer"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1486656270, "post_id": 41769220, "comment_id": 71448965, "body": "So, did you get your answer?"}, {"owner": {"reputation": 41, "user_id": 5830091, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207505752715516/picture?type=large", "display_name": "Facksqwud ", "link": "https://stackoverflow.com/users/5830091/facksqwud"}, "edited": false, "score": 0, "creation_date": 1486737131, "post_id": 41769220, "comment_id": 71488546, "body": "Yup, great answers thank you"}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 1, "last_activity_date": 1484934400, "last_edit_date": 1484934400, "creation_date": 1484933982, "answer_id": 41769425, "question_id": 41769220, "link": "https://stackoverflow.com/questions/41769220/i-dont-understand-what-those-field-mean-in-a-structure-for-database-what-it/41769425#41769425", "title": "I dont understand what those &#39;&#39; field mean in a structure for database, what it is the purpose of", "body": "<p><sup>First of all, it appears that you are not using GORM but <a href=\"https://godoc.org/github.com/astaxie/beego/orm\" rel=\"nofollow noreferrer\">something else</a>. I will assume that herein.</sup></p>\n\n<blockquote>\n  <p>does it changes something ?</p>\n</blockquote>\n\n<p>Yes. These are tags that add extra attributes to the field in question.</p>\n\n<p>For example, <code>\"auto\"</code> makes the field auto-increment, and <code>\"size(100)\"</code>&hellip; well, I think you can probably guess if you apply a little brainpower!</p>\n\n<blockquote>\n  <p>why there is not a structure like this ?</p>\n</blockquote>\n\n<p>There is!</p>\n\n<p>The following alternative structure is perfectly valid, just not what the author of your code intended:</p>\n\n<pre><code>type Result struct {\n    Name string\n    Age  int\n}\n</code></pre>\n\n<p>Consult <a href=\"https://beego.me/docs/mvc/model/models.md\" rel=\"nofollow noreferrer\">the documentation</a> to discover what tags you can use. You'll have to read more than just the first few paragraphs of the package description to find out how the technology works!</p>\n\n<p><sub><strong>Disclaimer:</strong> Never used Go or this library in my life. The above comes from a quick Google and glance at the manual.</sub></p>\n"}], "owner": {"reputation": 41, "user_id": 5830091, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207505752715516/picture?type=large", "display_name": "Facksqwud ", "link": "https://stackoverflow.com/users/5830091/facksqwud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527756916, "creation_date": 1484933169, "last_edit_date": 1527756916, "question_id": 41769220, "link": "https://stackoverflow.com/questions/41769220/i-dont-understand-what-those-field-mean-in-a-structure-for-database-what-it", "title": "I dont understand what those &#39;&#39; field mean in a structure for database, what it is the purpose of", "body": "<pre><code>type User struct {\n  Id   int    `orm:\"auto\"`\n  Name string `orm:\"size(100)\"`\n}\n</code></pre>\n\n<p>what the purpose of 'orm:\"auto\"' and 'orm:\"size(100)\"'.</p>\n\n<p>i mean i know those field corresponds to the limits that i have set in my database, but why they are here in the code ? why there is not a structure like this ?</p>\n\n<pre><code>type User struct {\n  Id   int    \n  Name string \n}\n</code></pre>\n\n<p>does it changes something ? i dont understand. thanks for reading and helping me.</p>\n"}, {"tags": ["pointers", "go", "go-interface"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1484932535, "post_id": 41768993, "comment_id": 70729499, "body": "<code>Sequence</code> is a reference type so the <code>Swap</code> function will swap the slice&#39;s underlying values. A good article on slices can be seen here: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1484936321, "post_id": 41768993, "comment_id": 70731373, "body": "You&#39;re not modifying <code>s</code>. You&#39;re modifying <code>s[i]</code> and <code>s[j]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 528, "user_id": 2457720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fca42ac224f3468f2d4da883c8d4a6b?s=128&d=identicon&r=PG", "display_name": "phouse512", "link": "https://stackoverflow.com/users/2457720/phouse512"}, "edited": false, "score": 0, "creation_date": 1484969074, "post_id": 41769761, "comment_id": 70742048, "body": "this makes a lot of sense, I didn&#39;t understand that slices were always references to arrays. so if this is a special case, are there any other types in Go that are similar?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 528, "user_id": 2457720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fca42ac224f3468f2d4da883c8d4a6b?s=128&d=identicon&r=PG", "display_name": "phouse512", "link": "https://stackoverflow.com/users/2457720/phouse512"}, "edited": false, "score": 2, "creation_date": 1484974119, "post_id": 41769761, "comment_id": 70742882, "body": "Maps behave in a similar way. If you pass a map to a function and the function makes a change to the map, the caller will see that change. Channels are also in this group (reference types), but it&#39;s probably a little more obvious that if you pass a channel to a function, both the function and the caller have a reference to the same channel."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 3, "last_activity_date": 1484935276, "creation_date": 1484935276, "answer_id": 41769761, "question_id": 41768993, "link": "https://stackoverflow.com/questions/41768993/pointer-receiver-vs-value-receiver/41769761#41769761", "title": "pointer receiver vs value receiver", "body": "<p>To expand a bit on @squiguy's comment, the value of a slice object is itself a reference to an underlying array, including a pointer to the element in the array at which the slice begins, the length of the slice, and the slice's capacity (the number of elements in the underlying array from the beginning of the slice to the end of the array). When you pass a slice to a function, it is the above information that is passed by value, so the slice within the function still refers to the same underlying array. This is how <code>Swap</code> is able to swap elements in the slice even though the slice itself is passed by value.</p>\n"}], "owner": {"reputation": 528, "user_id": 2457720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fca42ac224f3468f2d4da883c8d4a6b?s=128&d=identicon&r=PG", "display_name": "phouse512", "link": "https://stackoverflow.com/users/2457720/phouse512"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 41769761, "answer_count": 1, "score": 1, "last_activity_date": 1560166356, "creation_date": 1484932319, "last_edit_date": 1560166356, "question_id": 41768993, "link": "https://stackoverflow.com/questions/41768993/pointer-receiver-vs-value-receiver", "title": "pointer receiver vs value receiver", "body": "<p><strong>Situation:</strong></p>\n\n<p>I've learned about <strong><em>pointer receivers</em></strong> and <strong><em>value receivers</em></strong>. From what I understand: if you want to modify the object itself, you need to use a pointer receiver. I was reading more about interfaces in the <a href=\"https://golang.org/doc/effective_go.html#interfaces\" rel=\"nofollow noreferrer\">go documentation</a> and found this chunk of code:</p>\n\n<pre><code>type Sequence []int\n\n// Methods required by sort.Interface.\nfunc (s Sequence) Len() int {\n    return len(s)\n}\nfunc (s Sequence) Less(i, j int) bool {\n    return s[i] &lt; s[j]\n}\nfunc (s Sequence) Swap(i, j int) {\n    s[i], s[j] = s[j], s[i]\n}\n</code></pre>\n\n<ul>\n<li><p>The <code>Less</code> and <code>Len</code> methods are using <em>value receivers</em> and this makes sense, because they are returning data and not modifying the <code>Sequence</code> state. </p></li>\n<li><p>But in the <code>Swap</code> example, I am curious why it is still using a <em>value receiver</em> when it looks like it is trying to modify its state. </p></li>\n</ul>\n\n<p><strong>Question:</strong></p>\n\n<p>Is this a mistake, or is my understanding of value/pointer receivers flawed in some way?</p>\n"}, {"tags": ["pointers", "dictionary", "go", "set"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484928163, "post_id": 41767691, "comment_id": 70726899, "body": "What do you mean by pointers to struct{}. Areyou trying to implement Set"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1484928223, "post_id": 41767691, "comment_id": 70726934, "body": "You can use a pointer as a map key. I don&#39;t know what it would mean to &quot;optimize pointer addresses out&quot;."}, {"owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484928494, "post_id": 41767691, "comment_id": 70727102, "body": "@JimB I suspect that go runtime may change pointer address values for some kind of optimization. Is it absolutely impossible?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1484928916, "post_id": 41767691, "comment_id": 70727344, "body": "@VitalyIsaev: Why do you suspect that? Pointer values are a fundamental part of the language, and if there ever is an optimization that requires moving pointers (which isn&#39;t expected to happen), it will need to be done transparently to the user. Pointers are used as map keys throughout the std library, just search for <code>map[*</code>."}], "owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1503405344, "creation_date": 1484927897, "last_edit_date": 1503405344, "question_id": 41767691, "link": "https://stackoverflow.com/questions/41767691/go-pointer-as-map-key-type", "title": "Go: pointer as map key type", "body": "<p>I'm looking for a proper way to implement a set of pointers to <code>struct</code>. The obvious method is the of use built-in <code>map</code>: </p>\n\n<pre><code>map[*SomeStructure]struct{}\n</code></pre>\n\n<p>But does Go memory model guarantees that it's safe to use pointers as <code>map</code> key type? \nIsn't it possible for runtime to optimize pointer addresses out (may be) due to address space defragmentation?</p>\n"}, {"tags": ["go", "crash", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484925149, "post_id": 41766763, "comment_id": 70724888, "body": "The program ends when main returns."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484925430, "post_id": 41766763, "comment_id": 70725081, "body": "It is not crashing it is the default behaviour . you need to wait for completion of routine if you want it to execute complete;y"}], "owner": {"reputation": 721, "user_id": 2108258, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7b01fe08a510994b22f4c9d976d66bda?s=128&d=identicon&r=PG", "display_name": "user2108258", "link": "https://stackoverflow.com/users/2108258/user2108258"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "closed_date": 1484925412, "answer_count": 0, "score": 0, "last_activity_date": 1484925044, "creation_date": 1484925044, "question_id": 41766763, "link": "https://stackoverflow.com/questions/41766763/goroutine-crashes-silently", "closed_reason": "Duplicate", "title": "Goroutine crashes silently", "body": "<p>I'm having some issues with a script of mine that dies silently once I try to make an existing function a goroutine. It seems if there is only a go routine in the main function then it doesn't run. Why is that?</p>\n\n<p>After some fooling around I tried to reproduce the issue.</p>\n\n<p>Heres a simple case from tour of </p>\n\n<p><a href=\"https://play.golang.org/p/78MQ90pp5L\" rel=\"nofollow noreferrer\">https://play.golang.org/p/78MQ90pp5L</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 5; i++ {\n        time.Sleep(100 * time.Millisecond)\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    go say(\"world\")\n    say(\"hello\")\n}\n</code></pre>\n\n<p>If I comment say(\"hello\") the program exits prematurely.\nCan someone explain why?</p>\n"}, {"tags": ["macos", "go", "static-linking", "gccgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484922987, "post_id": 41765665, "comment_id": 70723485, "body": "As far as I know, gccgo isn&#39;t supported on darwin. Why do you need gccgo?"}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484926851, "post_id": 41765665, "comment_id": 70726066, "body": "I want to compile statically with QT as part of the binary. Apparently to do that you have to set the compiler to gccgo. First I statically compiled Qt and then tried something like: <code>CGO_ENABLED=1 go build -a --ldflags &#39;-extldflags &quot;-static -L&#47;Users&#47;alex&#47;Qt&#47;5.7.0_static_osx&#47;lib&quot;&#39;</code> but that gives: <code>clang: error: ld: library not found for -lcrt0.o</code>. When i add <code>-compiler gccgo</code> I get <code>fork&#47;exec : no such file or directory</code> which apparently means gccgo is not installed"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484927195, "post_id": 41765665, "comment_id": 70726305, "body": "You don&#39;t need gccgo to do static linking, and it&#39;s probably easier not to use it. You do however need to properly list all the libraries to link in the ldflags. It&#39;s usually easier to do this in the cgo comments in your source rather than use <code>-ldflags -extldflags...</code>"}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484927249, "post_id": 41765665, "comment_id": 70726352, "body": "Do you know of an example of this. Its my first time static linking, any resource would be appreciated?"}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484927587, "post_id": 41765665, "comment_id": 70726556, "body": "I tried: <code>CGO_ENABLED=0 go build -a -installsuffix cgo</code> with <code>&#47;&#47; #cgo LDFLAGS: -L&#47;Users&#47;alex&#47;Qt&#47;5.7.0_static_osx&#47;lib -lgb</code> at the top of <code>main.go</code> and I get: <code>undefined: qml.Object</code>, <code>undefined: qml.Window</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484928276, "post_id": 41765665, "comment_id": 70726963, "body": "You&#39;re using cgo, you can&#39;t set <code>CGO_ENABLED=0</code>"}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484928497, "post_id": 41765665, "comment_id": 70727104, "body": "Hmmm, the problem is <code>panic: runtime error: cgo argument has Go pointer to Go pointer</code> - for the qml libraries cgo must be disabled? <code>CGO_ENABLED=1 go build -a -installsuffix cgo</code> <code>&#47;&#47; #cgo LDFLAGS: -static -L&#47;Users&#47;alex&#47;Qt&#47;5.7.0_static_osx&#47;lib -lgb</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484929298, "post_id": 41765665, "comment_id": 70727609, "body": "If you disable cgo, you can&#39;t link to the qml libraries. That error is because you&#39;re code or qml is dong something incorrect in cgo. A quick glance over at the repo looks like it may not be maintained any longer, not sure if this is a package you want to depend on."}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484929559, "post_id": 41765665, "comment_id": 70727788, "body": "Sounds like its a problem then. I wonder if there is a new qml library for go. I&#39;ll try and find one. Thanks"}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484934164, "post_id": 41765665, "comment_id": 70730296, "body": "For anyone looking at this I have had luck with: github.com/SjB/qml and checking out the <code>go1.6-port</code> branch. Then import the above. JimB, so the above now runs with the forked library, it also builds but <code>otool -L</code> says the libraries are still dynamically linked, how do I tell it to link them in statically?"}], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1783, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484921667, "creation_date": 1484921667, "question_id": 41765665, "link": "https://stackoverflow.com/questions/41765665/osx-golang-static-compile-and-installing-gccgo", "title": "OSX Golang static compile, and installing gccgo", "body": "<p>To outline my end goal. I want to compile a go application, statically linking to QT5. I have statically compiled QT5. Now I need to compile my Go program.</p>\n\n<p>As I understand it to do this, I have to use gccgo rather than the gc compiler. Fine.</p>\n\n<p>So first I have to install the gccgo compiler, which is gcc with the <code>go</code> language enabled in config.</p>\n\n<p>I have followed this: <a href=\"https://golang.org/doc/install/gccgo\" rel=\"nofollow noreferrer\">https://golang.org/doc/install/gccgo</a></p>\n\n<p>and this seperately: <a href=\"https://solarianprogrammer.com/2016/05/10/compiling-gcc-6-mac-os-x/\" rel=\"nofollow noreferrer\">https://solarianprogrammer.com/2016/05/10/compiling-gcc-6-mac-os-x/</a> </p>\n\n<p>to see if I could use a newer version of GCC. However in both cases I receive:</p>\n\n<pre><code>checking for isl 0.16, 0.15, or deprecated 0.14... yes\nchecking for isl 0.16 or 0.15... yes\nconfigure: error:\nThe following requested languages could not be built: go\nSupported languages are: c,c,c++,fortran,jit,lto,objc,obj-c++\n</code></pre>\n\n<p>when I run <code>configure</code> before <code>make</code> and <code>make install</code></p>\n\n<p>So apparently GCC doesn't know about Go even though the Go documentation says this is how to do it?</p>\n\n<p>Anyone got any reliable source for doing this?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484920311, "post_id": 41765198, "comment_id": 70721720, "body": "Get a stack trace when the deadlock happens and see where each goroutine is blocked."}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484920351, "post_id": 41765198, "comment_id": 70721750, "body": "I tried that but there is 300 or so goroutines and couldn&#39;t make out where the block was!"}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484921105, "post_id": 41765198, "comment_id": 70722262, "body": "Would any pprof commands help here at all?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484921305, "post_id": 41765198, "comment_id": 70722399, "body": "If you&#39;re in the <code>inboundFromTCP</code> case, and the corresponding <code>processPackets</code> shuts down, it&#39;s not removed from the map and therefor you get a deadlock. This smells of over-using channels, but I don&#39;t have a clear picture of the problem so I&#39;m not sure which direction to send you."}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484921363, "post_id": 41765198, "comment_id": 70722446, "body": "Ok thanks, I was pointed down this route from a single shared map that was consuming a ton of CPU and this does work (albeit that issue!)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484921636, "post_id": 41765198, "comment_id": 70722636, "body": "A shared map with a mutex is a very common, and there&#39;s no reason to avoid something that simple for a nest of goroutines and channels. Hiding that single point of contention behind more layers of complexity obviously doesn&#39;t solve the problem."}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484921712, "post_id": 41765198, "comment_id": 70722678, "body": "That is what I started with however, and the CPU was much higher with wait times on the locks around 1 second. <a href=\"http://stackoverflow.com/questions/41748628/large-number-of-transient-objects-avoiding-contention/41749224?noredirect=1#comment70692534_41749224\" title=\"large number of transient objects avoiding contention\">stackoverflow.com/questions/41748628/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484922186, "post_id": 41765198, "comment_id": 70722978, "body": "You still have that same single point of contention here, you just traded a mutex for channels, which means that you can achieve the same with the mutex and/or a happy balance of the two. Start with a struct to contain the map and mutex, and add methods which take the lock only as needed, which makes map access easier to reason about compared to the global variables."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1484958121, "post_id": 41765198, "comment_id": 70740237, "body": "Don&#39;t listen to channel haters. Yes, a channel is a lock, just like a mutex. But a channel architecture can work <i>really well</i>. Once you get the bugs out as you see."}], "answers": [{"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1484958204, "post_id": 41774344, "comment_id": 70740253, "body": "No, that <code>channel, ok</code> is getting a stored channel out of the map. If it does not exist then <code>ok</code> is false and the code creates a channel and sets it in the map."}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1484958427, "post_id": 41774344, "comment_id": 70740316, "body": "Thanks for the explanation, Zan!"}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1484994006, "post_id": 41774344, "comment_id": 70746955, "body": "I hope people stop downvoting my answer. The person asking the question also asked for a second set of eyes. I knew my answer had a good chance of being wrong but sometimes just contributing helps others to look at a problem in a different way or consider things they hadn&#39;t thought of before. This seems to have been the case with Zan Lynx as his answer seems to indicate that he started thinking about there being a possible problem with channel &lt;- msg being unbuffered based on my answer. At the very least, my answer seems to have prompted another answer and induced more activity on this topic."}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1484994187, "post_id": 41774344, "comment_id": 70747011, "body": "My comment above should definitely in no way be construed as me trying to take credit for Zan&#39;s answer.  He obviously is much more knowledgeable in this area than I am and I&#39;m grateful for the explanation he provided to me.  I&#39;m just saying, sometimes even wrong answers help lead to the right one just because they focus on an area that wasn&#39;t being previously considered and I don&#39;t think that should be punished."}], "tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": false, "score": -2, "last_activity_date": 1484957503, "creation_date": 1484957503, "answer_id": 41774344, "question_id": 41765198, "link": "https://stackoverflow.com/questions/41765198/deadlock-with-buffered-channel/41774344#41774344", "title": "Deadlock with buffered channel", "body": "<p>I'm new to Go but in this code here</p>\n\n<pre><code>case msg := &lt;-inboundFromTCP:\n        log.Println(\"Got packet\", msg.Avr)\n        channel, ok := channelMap[msg.Avr]\n        if !ok {\n            packetChan := make(chan *trackingPacket_v1)\n\n            channelMap[msg.Avr] = packetChan\n            go processPackets(packetChan, shutdownChan, msg.Avr)\n            packetChan &lt;- msg\n            continue\n        }\n        channel &lt;- msg\n</code></pre>\n\n<p>Aren't you putting something in channel (unbuffered?) here</p>\n\n<pre><code>channel, ok := channelMap[msg.Avr]\n</code></pre>\n\n<p>So wouldn't you need to empty out that channel before you can add the msg here?</p>\n\n<pre><code>channel &lt;- msg\n</code></pre>\n\n<p>Like I said, I'm new to Go so I hope I'm not being goofy.  :)</p>\n"}, {"comments": [{"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1485010019, "post_id": 41774538, "comment_id": 70751608, "body": "I just put a working standalone example up at <a href=\"https://play.golang.org/p/88zT7hBLeD\" rel=\"nofollow noreferrer\">play.golang.org/p/88zT7hBLeD</a>, am hoping this might help get to the bottom of it!  Thanks!"}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 2, "last_activity_date": 1484959523, "last_edit_date": 1484959523, "creation_date": 1484959051, "answer_id": 41774538, "question_id": 41765198, "link": "https://stackoverflow.com/questions/41765198/deadlock-with-buffered-channel/41774538#41774538", "title": "Deadlock with buffered channel", "body": "<p>I'm guessing that your problem is getting stuck doing this <code>channel &lt;- msg</code> at the same time as the other goroutine is doing <code>shutdown &lt;- id</code>.</p>\n\n<p>Since neither the <code>channel</code> nor the <code>shutdown</code> channels are buffered, they block waiting for a receiver. And they can deadlock waiting for the other side to become available.</p>\n\n<p>There are a couple of ways to fix it. You could declare both of those channels with a buffer of 1.</p>\n\n<p>Or instead of signalling by sending a shutdown message, you could do what Google's context package does and send a shutdown signal by closing the shutdown channel. Look at <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/context/</a> especially <code>WithCancel</code>, <code>WithDeadline</code> and the <code>Done</code> functions.</p>\n\n<p>You might be able to use context to remove your own shutdown channel and timeout code.</p>\n\n<p>And JimB has a point about shutting down the goroutine while it might still be receiving on the channel. What you should do is send the shutdown message (or close, or cancel the context) and continue to process messages until your <code>ch</code> channel is closed (detect that with <code>case msg, ok := &lt;-ch:</code>), which would happen after the shutdown is received by the sender.</p>\n\n<p>That way you get all of the messages that were incoming until the shutdown actually happened, and should avoid a second deadlock.</p>\n"}], "owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 41774538, "answer_count": 2, "score": 0, "last_activity_date": 1485009979, "creation_date": 1484920130, "last_edit_date": 1495540430, "question_id": 41765198, "link": "https://stackoverflow.com/questions/41765198/deadlock-with-buffered-channel", "title": "Deadlock with buffered channel", "body": "<p>I have some code that is a job dispatcher and is collating a large amount of data from lots of TCP sockets.  This code is a result of an approach to <a href=\"https://stackoverflow.com/questions/41748628/large-number-of-transient-objects-avoiding-contention/41749224?noredirect=1#comment70692534_41749224\">Large number of transient objects - avoiding contention</a> and it largely works with CPU usage down a huge amount and locking not an issue now either.</p>\n\n<p>From time to time my application locks up and the \"Channel length\" log is the only thing that keeps repeating as data is still coming in from my sockets.  However the count remains at 5000 and no downstream processing is taking place.</p>\n\n<p>I <em>think</em> the issue might be a race condition and the line it is possibly getting hung up on is <code>channel &lt;- msg</code> within the <code>select</code> of the <code>jobDispatcher</code>.  Trouble is I can't work out how to verify this.</p>\n\n<p>I suspect that as select can take items at random the goroutine is returning and the shutdownChan doesn't have a chance to process.  Then data hits inboundFromTCP and it blocks!</p>\n\n<p>Someone might spot something really obviously wrong here. And offer a solution hopefully!?  </p>\n\n<pre><code>var MessageQueue = make(chan *trackingPacket_v1, 5000)\n\nfunc init() {\n    go jobDispatcher(MessageQueue)\n}\n\nfunc addMessage(trackingPacket *trackingPacket_v1) {\n    // Send the packet to the buffered queue!\n    log.Println(\"Channel length:\", len(MessageQueue))\n    MessageQueue &lt;- trackingPacket\n}\n\nfunc jobDispatcher(inboundFromTCP chan *trackingPacket_v1) {\n    var channelMap = make(map[string]chan *trackingPacket_v1)\n\n    // Channel that listens for the strings that want to exit\n    shutdownChan := make(chan string)\n\n    for {\n        select {\n        case msg := &lt;-inboundFromTCP:\n            log.Println(\"Got packet\", msg.Avr)\n            channel, ok := channelMap[msg.Avr]\n            if !ok {\n                packetChan := make(chan *trackingPacket_v1)\n\n                channelMap[msg.Avr] = packetChan\n                go processPackets(packetChan, shutdownChan, msg.Avr)\n                packetChan &lt;- msg\n                continue\n            }\n            channel &lt;- msg\n        case shutdownString := &lt;-shutdownChan:\n            log.Println(\"Shutting down:\", shutdownString)\n            channel, ok := channelMap[shutdownString]\n            if ok {\n                delete(channelMap, shutdownString)\n                close(channel)\n            }\n        }\n    }\n}\n\nfunc processPackets(ch chan *trackingPacket_v1, shutdown chan string, id string) {\n    var messages = []*trackingPacket_v1{}\n\n    tickChan := time.NewTicker(time.Second * 1)\n    defer tickChan.Stop()\n\n    hasCheckedData := false\n\n    for {\n        select {\n        case msg := &lt;-ch:\n            log.Println(\"Got a messages for\", id)\n            messages = append(messages, msg)\n            hasCheckedData = false\n        case &lt;-tickChan.C:\n\n            messages = cullChanMessages(messages)\n            if len(messages) == 0 {\n                messages = nil\n                shutdown &lt;- id\n                return\n            }\n\n            // No point running checking when packets have not changed!!\n            if hasCheckedData == false {\n                processMLATCandidatesFromChan(messages)\n                hasCheckedData = true\n            }\n        case &lt;-time.After(time.Duration(time.Second * 60)):\n            log.Println(\"This channel has been around for 60 seconds which is too much, kill it\")\n            messages = nil\n            shutdown &lt;- id\n            return\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Update 01/20/16</strong></p>\n\n<p>I tried to rework with the <code>channelMap</code> as a global with some mutex locking but it ended up deadlocking still.</p>\n\n<hr>\n\n<p>Slightly tweaked the code, still locks but I don't see how this one does!!\n<a href=\"https://play.golang.org/p/PGpISU4XBJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/PGpISU4XBJ</a></p>\n\n<hr>\n\n<p><strong>Update 01/21/17</strong>\nAfter some recommendations I put this into a standalone working example so people can see.  <a href=\"https://play.golang.org/p/88zT7hBLeD\" rel=\"nofollow noreferrer\">https://play.golang.org/p/88zT7hBLeD</a></p>\n\n<p>It is a long running process so will need running locally on a machine as the playground kills it.  Hopefully this will help get to the bottom of it!</p>\n"}]