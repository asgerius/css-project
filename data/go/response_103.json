[{"tags": ["pointers", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "edited": false, "score": 0, "creation_date": 1482970093, "post_id": 41371361, "comment_id": 69944713, "body": "Yes. This is it. Thx, I did not think  that is necessary to use type assertion to this simply operation"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1482973387, "last_edit_date": 1482973387, "creation_date": 1482969343, "answer_id": 41371361, "question_id": 41371060, "link": "https://stackoverflow.com/questions/41371060/how-to-pass-integer-as-pointer-using-interface-to-function/41371361#41371361", "title": "How to pass integer as pointer using interface{} to function", "body": "<p>If you want to observe the change outside of the <code>someChange()</code> function (in the <code>test</code> variable), you must modify the <em>pointed</em> value (assign a new value to it). You're not doing that, you just assign a new value to the <code>i</code> parameter (which is a local variable inside <code>someChange()</code>).</p>\n\n<p>You may obtain the <code>*int</code> pointer from the <code>i</code> interface variable using <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>, and then you can assign a new value to the pointed value.</p>\n\n<p>Example:</p>\n\n<pre><code>func someChange(i interface{}) error {\n    newFunnyValue := 42\n    if p, ok := i.(*int); ok {\n        *p = newFunnyValue\n        return nil //change gone ok, so nil\n    }\n    return errors.New(\"Not *int\")\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>var test int\nsomeChange(&amp;test)\nlog.Printf(\"after function: %d\", test)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/ZCpkMYc57p\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:00 after function: 42\n</code></pre>\n\n<p>Note that wrapping the <code>int</code> value or the <code>*int</code> pointer in a struct is unnecessary and it wouldn't make a difference if you're not assigning a new value to the pointed object.</p>\n"}, {"tags": [], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "is_accepted": false, "score": 1, "last_activity_date": 1482971156, "creation_date": 1482971156, "answer_id": 41371608, "question_id": 41371060, "link": "https://stackoverflow.com/questions/41371060/how-to-pass-integer-as-pointer-using-interface-to-function/41371608#41371608", "title": "How to pass integer as pointer using interface{} to function", "body": "<p><code>i</code> is still of type <code>interface{}</code> within the <code>func someChange()</code>. You have to cast it during the assignment:</p>\n\n<pre><code>*i.(*int) = 42\n</code></pre>\n"}], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1225, "favorite_count": 0, "accepted_answer_id": 41371361, "answer_count": 2, "score": 2, "last_activity_date": 1482973387, "creation_date": 1482967129, "last_edit_date": 1482969842, "question_id": 41371060, "link": "https://stackoverflow.com/questions/41371060/how-to-pass-integer-as-pointer-using-interface-to-function", "title": "How to pass integer as pointer using interface{} to function", "body": "<p>I thought this is a simple thing to do, but I was wrong. I can't pass <code>integer</code> as pointer to function using <code>interface{}</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>var test int\nsomeChange(&amp;test)\nfmt.Printf(\"after function: %d\", test)\n\nfunc someChange(i interface{}) error{\n    newFunnyValue := 42\n    i = newFunnyValue\n    fmt.Printf(\"hello from someChange now value test is: %d\" , i)\n    return nil //change gone ok, so nil\n}\n</code></pre>\n\n<p>And result:</p>\n\n<pre><code> hello from someChange now value test is: 42 \n after function: 0\n</code></pre>\n\n<p>I read that <code>interface{}</code> is similar to <code>void*</code> so above code should work but it's not, why? I want to add that if I pass some object which is a struct, everything works good.</p>\n\n<p>Do I have to wrap <code>int</code> in some struct?</p>\n\n<p>Edit: </p>\n\n<p><a href=\"https://play.golang.org/p/rg1vabug0P\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rg1vabug0P</a></p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 1, "creation_date": 1482960384, "post_id": 41369804, "comment_id": 69941466, "body": "Slices are not fixed length in Go. This is the best article I have ever seen on slices: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1482960644, "post_id": 41369804, "comment_id": 69941578, "body": "On variable declaration style, I use the short form when initializing a variable to a certain value, but the long form when just declaring a variable which will be set later (or when declaring a package variable (i.e., outside of any block), which can only be done with <code>var</code>)."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483013107, "post_id": 41369804, "comment_id": 69960431, "body": "@seeker there are three answers already check and if any of them help accept the answer other wise comment here as to what is missing"}], "answers": [{"tags": [], "owner": {"reputation": 391, "user_id": 3417424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d24e88f34a0b011d6372be3f78b924?s=128&d=identicon&r=PG", "display_name": "Kare Nuorteva", "link": "https://stackoverflow.com/users/3417424/kare-nuorteva"}, "is_accepted": false, "score": 1, "last_activity_date": 1482961186, "creation_date": 1482961186, "answer_id": 41370095, "question_id": 41369804, "link": "https://stackoverflow.com/questions/41369804/how-to-create-unfixed-length-slice-in-go/41370095#41370095", "title": "How to create unfixed length slice in Go", "body": "<p>1) Create a slice with:</p>\n\n<pre><code>list := make([]int, 0)\n</code></pre>\n\n<p>Append to a slice with:</p>\n\n<pre><code>list = append(list, i)\n</code></pre>\n\n<p>2) I think there is no single answer to your second question. It depends on how and where the variable is used.</p>\n"}, {"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483013135, "post_id": 41371823, "comment_id": 69960449, "body": "@seeker check this and if this helps you , accept the anwer"}, {"owner": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "edited": false, "score": 0, "creation_date": 1483026064, "post_id": 41371823, "comment_id": 69967605, "body": "It&#39;s also important to point out that, if you already know the length of the slice you want to create, you should specify that value instead of zero in the call to <code>make([]int, 150)</code>. This is more efficient for the compiler, which has to create a new backing array every time you append beyond the bounds of the backing array. By specifying the length in the <code>make</code> call (150 in this case), your slice will contain all zero&#39;d values for every index up to 150. You can then assign new values like: <code>list[4] = 123</code> instead of calling <code>append</code>"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "edited": false, "score": 0, "creation_date": 1483030572, "post_id": 41371823, "comment_id": 69970019, "body": "@daltonclaybrook absolutely , here i was trying to give a sample so that  he  may start using slices"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 2, "last_activity_date": 1482973131, "creation_date": 1482973131, "answer_id": 41371823, "question_id": 41369804, "link": "https://stackoverflow.com/questions/41369804/how-to-create-unfixed-length-slice-in-go/41371823#41371823", "title": "How to create unfixed length slice in Go", "body": "<p>In Go arrays have their place, but they're a bit inflexible, so you don't see them too often in Go code. Slices, though, are everywhere . They build on arrays to provide great power and convenience.</p>\n\n<p>Slice is not of fixed length. It is flexible .</p>\n\n<p>You may declare an empty slice as following</p>\n\n<pre><code>list := make([]int, 0)\nlist := []int{}\nvar list []int\n</code></pre>\n\n<p>Here is how you may right the above function in go </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\n\nfunc main() {\n        var list []int\n        for i:=0;i&lt;10000;i++ {\n            if i %5 == 0 &amp;&amp; i % 3 == 0 {\n                list = append(list, i)\n            }\n        } \n        for _, val := range list {\n            fmt.Println(val)\n        }\n}\n</code></pre>\n\n<p>Here is the play link <a href=\"https://play.golang.org/p/gE7Gw54q_b\" rel=\"nofollow noreferrer\">play</a></p>\n"}, {"tags": [], "owner": {"reputation": 287, "user_id": 7315901, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6bd8ea5e6e6148618ca4e817956b2258?s=128&d=identicon&r=PG&f=1", "display_name": "Kiochan", "link": "https://stackoverflow.com/users/7315901/kiochan"}, "is_accepted": false, "score": 0, "last_activity_date": 1482975738, "creation_date": 1482975738, "answer_id": 41372088, "question_id": 41369804, "link": "https://stackoverflow.com/questions/41369804/how-to-create-unfixed-length-slice-in-go/41372088#41372088", "title": "How to create unfixed length slice in Go", "body": "<p>For 2)\nI used \":=\" for I want get same type with another variable, and use other \nlike\n    var foo int = 3 // I want a int variable\n    bar := foo // I want bar same type with foo</p>\n"}], "owner": {"reputation": 21, "user_id": 6447033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b7579e8b6a4702ed08412e5ad3df7f9?s=128&d=identicon&r=PG&f=1", "display_name": "seeker", "link": "https://stackoverflow.com/users/6447033/seeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 41371823, "answer_count": 3, "score": 1, "last_activity_date": 1482975738, "creation_date": 1482959674, "question_id": 41369804, "link": "https://stackoverflow.com/questions/41369804/how-to-create-unfixed-length-slice-in-go", "title": "How to create unfixed length slice in Go", "body": "<p>I'm new in Go and I have 2 questions:</p>\n\n<p>1 Let's say we have simple for loop written in C#: </p>\n\n<pre><code>static void Main(string[] args)\n    {\n        List&lt;int&gt; list = new List&lt;int&gt;();\n        for (int i = 1; i &lt; 10000; i++)\n        {\n            if (i % 5 == 0 &amp;&amp; i % 3 == 0)\n            {\n                list.Add(i);\n            }\n        }\n        foreach (int prime in list)\n        {\n            System.Console.WriteLine(prime);\n        }\n        Console.ReadKey();\n    }\n</code></pre>\n\n<p>If I wanted to do the same in Go I'll have to use slices. But how to do that? </p>\n\n<ol start=\"2\">\n<li>Which of variable declaration form is more often used:\nshort form (s:= 3) \nor \nlong (var s int = 3)?</li>\n</ol>\n"}, {"tags": ["go", "io"], "answers": [{"tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": true, "score": 3, "last_activity_date": 1482956617, "creation_date": 1482956617, "answer_id": 41369186, "question_id": 41369106, "link": "https://stackoverflow.com/questions/41369106/replacing-a-line-within-a-file-with-golang/41369186#41369186", "title": "Replacing a line within a file with Golang", "body": "<p>The Reader is not controller by the <code>file.Seek</code>.  You have declared the reader as: <code>reader := bufio.NewReader(file)</code> and then you read one line at a time <code>bytes, _, _ := reader.ReadLine()</code>  however the <code>file.Seek</code> does not change the position that the reader is reading.</p>\n\n<p>Suggest you read about the <a href=\"https://golang.org/pkg/io/#ReadSeeker\" rel=\"nofollow noreferrer\">ReadSeeker</a> in the docs and switch over to using that.  Also there is an example using the <a href=\"https://golang.org/pkg/io/#example_SectionReader_Seek\" rel=\"nofollow noreferrer\">SectionReader</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "is_accepted": false, "score": 1, "last_activity_date": 1596134513, "creation_date": 1596134513, "answer_id": 63179416, "question_id": 41369106, "link": "https://stackoverflow.com/questions/41369106/replacing-a-line-within-a-file-with-golang/63179416#63179416", "title": "Replacing a line within a file with Golang", "body": "<p>Aside from the incorrect seek usage, the difficulty is that the line you're replacing isn't the same length as the replacement. The standard approach is to create a new (temporary) file with the modifications. Assuming that is successful, replace the original file with the new one.</p>\n<pre><code>package main\n\nimport (\n    &quot;bufio&quot;\n    &quot;io&quot;\n    &quot;io/ioutil&quot;\n    &quot;log&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n\n    // file we're modifying\n    name := &quot;text.txt&quot;\n\n    // open original file\n    f, err := os.Open(name)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer f.Close()\n\n    // create temp file\n    tmp, err := ioutil.TempFile(&quot;&quot;, &quot;replace-*&quot;)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer tmp.Close()\n\n    // replace while copying from f to tmp\n    if err := replace(f, tmp); err != nil {\n        log.Fatal(err)\n    }\n\n    // make sure the tmp file was successfully written to\n    if err := tmp.Close(); err != nil {\n        log.Fatal(err)\n    }\n\n    // close the file we're reading from\n    if err := f.Close(); err != nil {\n        log.Fatal(err)\n    }\n\n    // overwrite the original file with the temp file\n    if err := os.Rename(tmp.Name(), name); err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc replace(r io.Reader, w io.Writer) error {\n    // use scanner to read line by line\n    sc := bufio.NewScanner(r)\n    for sc.Scan() {\n        line := sc.Text()\n        if line == &quot;two&quot; {\n            line = &quot;This is a test.&quot;\n        }\n        if _, err := io.WriteString(w, line+&quot;\\n&quot;); err != nil {\n            return err\n        }\n    }\n    return sc.Err()\n}\n</code></pre>\n<p>For more complex replacements, I've implemented a package which can replace regular expression matches. <a href=\"https://github.com/icholy/replace\" rel=\"nofollow noreferrer\">https://github.com/icholy/replace</a></p>\n<pre><code>import (\n    &quot;io&quot;\n    &quot;regexp&quot;\n\n    &quot;github.com/icholy/replace&quot;\n    &quot;golang.org/x/text/transform&quot;\n)\n\nfunc replace2(r io.Reader, w io.Writer) error {\n    // compile multi-line regular expression\n    re := regexp.MustCompile(`(?m)^two$`)\n\n    // create replace transformer\n    tr := replace.RegexpString(re, &quot;This is a test.&quot;)\n\n    // copy while transforming\n    _, err := io.Copy(w, transform.NewReader(r, tr))\n    return err\n}\n</code></pre>\n"}], "owner": {"reputation": 676, "user_id": 4324409, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Wc6bT.png?s=128&g=1", "display_name": "pklndnst", "link": "https://stackoverflow.com/users/4324409/pklndnst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3144, "favorite_count": 0, "accepted_answer_id": 41369186, "answer_count": 2, "score": 4, "last_activity_date": 1596134513, "creation_date": 1482956183, "question_id": 41369106, "link": "https://stackoverflow.com/questions/41369106/replacing-a-line-within-a-file-with-golang", "title": "Replacing a line within a file with Golang", "body": "<p>I'm new to Golang, starting out with some examples. Currently, what I'm trying to do is reading a file line by line and replace it with another string in case it meets a certain condition.\nThe file is use for testing purposes contains four lines:</p>\n\n<pre><code>one\ntwo\nthree\nfour\n</code></pre>\n\n<p>The code working on that file looks like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code> func main() {\n\n     file, err := os.OpenFile(\"test.txt\", os.O_RDWR, 0666)\n\n     if err != nil {\n       panic(err)\n     }\n\n     reader := bufio.NewReader(file)\n\n      for {\n\n         fmt.Print(\"Try to read ...\\n\")\n\n         pos,_ := file.Seek(0, 1)\n         log.Printf(\"Position in file is: %d\", pos)\n         bytes, _, _ := reader.ReadLine()\n\n         if (len(bytes) == 0) {\n            break\n         }\n\n         lineString := string(bytes)\n\n         if(lineString == \"two\") {\n             file.Seek(int64(-(len(lineString))), 1)\n             file.WriteString(\"This is a test.\")\n         }\n\n         fmt.Printf(lineString + \"\\n\")\n   }\n\n    file.Close()\n }\n</code></pre>\n\n<p>As you can see in the code snippet, I want to replace the string \"two\" with \"This is a test\" as soon as this string is read from the file.\nIn order to get the current position within the file I use Go's <em>Seek</em> method. \nHowever, what happens is that always the last line gets replaced by <em>This is a test</em>, making the file looking like this:</p>\n\n<pre><code>one\ntwo\nthree\nThis is a test\n</code></pre>\n\n<p>Examining the output of the print statement which writes the current file position to the terminal, I get that kind of output after <strong>the first line has been read</strong>:</p>\n\n<pre><code>2016/12/28 21:10:31 Try to read ...\n2016/12/28 21:10:31 Position in file is: 19\n</code></pre>\n\n<p>So after the first read, the position cursor already points to the end of my file, which explains why the new string gets appended to the end. Does anyone understand what is happening here or rather what is causing that behavior?</p>\n"}, {"tags": ["json", "go", "dynamic", "unmarshalling"], "comments": [{"owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 0, "creation_date": 1482950606, "post_id": 41367609, "comment_id": 69937360, "body": "What are you going to do with that data if you don&#39;t know what to expect them to be ? What do you need<code>fields</code> for ?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1527413041, "post_id": 41367609, "comment_id": 88112389, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18412126/golang-parse-a-json-with-dynamic-key\">Golang parse a json with DYNAMIC key</a>"}], "answers": [{"tags": [], "owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "is_accepted": true, "score": 7, "last_activity_date": 1483398459, "last_edit_date": 1483398459, "creation_date": 1482950790, "answer_id": 41367967, "question_id": 41367609, "link": "https://stackoverflow.com/questions/41367609/how-to-unmarshal-dynamic-json-objects-with-golang/41367967#41367967", "title": "How to unmarshal dynamic json objects with Golang", "body": "<p>If the data in <code>\"fields\"</code> is always going to be a flat-dict then you can use <code>map[string]string</code> as type for the <code>Fields</code>.</p>\n\n<hr>\n\n<p>For arbitrary data specify <code>Fields</code> as a <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"noreferrer\"><code>RawMessage</code></a> type and parse it later on based on its content. Example from docs: <a href=\"https://play.golang.org/p/IR1_O87SHv\" rel=\"noreferrer\">https://play.golang.org/p/IR1_O87SHv</a></p>\n\n<p>If the fields are way too unpredictable then you can keep this field as is(<code>[]byte</code>) or if there are fields that are always going to common then you can parse those and leave the rest(but this would result in loss of data present in other fields).</p>\n"}], "owner": {"reputation": 1064, "user_id": 3281507, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zD3kX.png?s=128&g=1", "display_name": "rafaelmorais", "link": "https://stackoverflow.com/users/3281507/rafaelmorais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2809, "favorite_count": 1, "accepted_answer_id": 41367967, "answer_count": 1, "score": 4, "last_activity_date": 1483398459, "creation_date": 1482949191, "question_id": 41367609, "link": "https://stackoverflow.com/questions/41367609/how-to-unmarshal-dynamic-json-objects-with-golang", "title": "How to unmarshal dynamic json objects with Golang", "body": "<p>let me start by telling that I'm pretty recent in the Go world.</p>\n\n<p>What I'm trying to do is to read the json I get from a JSON API (I don't control). Everything is working fine, I can show the received ID and Tags too. But the fields field is a little bit different, because its a dynamic array. </p>\n\n<p>I can receive from the api this:</p>\n\n<pre><code>{\n    \"id\":\"M7DHM98AD2-32E3223F\",\n    \"tags\": [\n        {\n            \"id\":\"9M23X2Z0\",\n            \"name\":\"History\"\n        },\n        {\n            \"id\":\"123123123\",\n            \"name\":\"Theory\"\n        }\n    ],\n    \"fields\": {\n        \"title\":\"Title of the item\",\n        \"description\":\"Description of the item\"\n    }\n}\n</code></pre>\n\n<p>Or instead of <code>title</code> and <code>description</code> I could receive only <code>description</code>, or receive another random object like <code>long_title</code>. The objects return may differ completly and can be an infinite possibility of objects. But it always returns objects with a key and a string content like in the example.</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>type Item struct {\n    ID string `json:\"id\"`\n    Tags []Tag `json:\"tags\"`\n    //Fields []Field `json:\"fields\"`\n}\n\n// Tag data from the call\ntype Tag struct {\n    ID string `json:\"id\"`\n    Name string `json:\"name\"`\n}\n\n// AllEntries gets all entries from the session\nfunc AllEntries() {\n    resp, _ := client.Get(APIURL)\n    body, _ := ioutil.ReadAll(resp.Body)\n\n    item := new(Item)\n    _ = json.Unmarshal(body, &amp;item)\n\n    fmt.Println(i, \"-&gt;\", item.ID)\n}\n</code></pre>\n\n<p>So the Item.Fields is dynamic, there is no way to predict what will be the key names, and therefore as far I can tell, there is no way to create a struct for it. But again, I'm pretty newbie with Go, could someone give me any tips? Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1482947736, "post_id": 41367225, "comment_id": 69935959, "body": "Method <code>ParseForm</code> returns an error value. Is it <code>nil</code>? If not what is it?"}, {"owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "reply_to_user": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1482948977, "post_id": 41367225, "comment_id": 69936585, "body": "No error is returned, it comes up as &lt;nil&gt;"}, {"owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "reply_to_user": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1482949467, "post_id": 41367225, "comment_id": 69936823, "body": "I just figured it out!  I was setting the ID value of the textbox, but not the &#39;name&#39; value.  Once I set that, I was able to parse the form!  No wonder it was returning empty strings!!!"}], "answers": [{"tags": [], "owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "is_accepted": false, "score": 1, "last_activity_date": 1482949574, "creation_date": 1482949574, "answer_id": 41367694, "question_id": 41367225, "link": "https://stackoverflow.com/questions/41367225/form-value-empty-after-post/41367694#41367694", "title": "Form value empty after post", "body": "<p>I just figured out the answer by looking at another website's source code.  In case anyone has a similar problem, I fixed it by adding a 'name' value to each of the textboxes that I wanted to parse in Go.  For example, the Slim code above would become this:</p>\n\n<p>form action=/login method=post</p>\n\n<pre><code>br\n| Name:\nbr\ninput#username type=text name=username\n\nbr\n| Password:\nbr\ninput#password type=password name=password\n\nbr\ninput type=submit\na href=/login Cancel\n</code></pre>\n"}], "owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482949574, "creation_date": 1482947478, "question_id": 41367225, "link": "https://stackoverflow.com/questions/41367225/form-value-empty-after-post", "title": "Form value empty after post", "body": "<p>I am having trouble reading a value from an HTML form in Go, which should be straight forward.  For some reason, the value 'user' in my Auth_login handler is always empty, even after I fill out the form below and press the 'submit' button.</p>\n\n<p>Handler that is called when the /login url is called by an HTTP post method:</p>\n\n<pre><code>func Auth_login(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    user := r.PostFormValue(\"username\")\n    // Other actions here\n}\n</code></pre>\n\n<p>Related form (in Slim format):</p>\n\n<pre><code>  form action=/login method=post\n\n    br\n    | Name:\n    br\n    input#username type=text\n\n    br\n    | Password:\n    br\n    input#password type=password\n\n    br\n    input type=submit\n    a href=/login Cancel\n</code></pre>\n\n<p>Am I doing something wrong when trying to read the html form field?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1482945131, "post_id": 41366470, "comment_id": 69934756, "body": "ahhh got it, I created an if statement to return if there&#39;s an error, and printed the error now to see &quot;open test.txt: no such file or directory&quot; confirming that loadPage() can&#39;t find the file. I played with where the file is saved and where I start the server from, and it now loads. Thanks!"}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "reply_to_user": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1482945245, "post_id": 41366470, "comment_id": 69934810, "body": "@jj1111 you&#39;re welcome. You should accept my answer if you are satisfied with it."}], "tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 0, "last_activity_date": 1482944542, "last_edit_date": 1482944542, "creation_date": 1482944233, "answer_id": 41366470, "question_id": 41366347, "link": "https://stackoverflow.com/questions/41366347/go-loadpage-issue-invalid-memory-address-or-nil-pointer-dereference/41366470#41366470", "title": "go loadPage issue: invalid memory address or nil pointer dereference", "body": "<p>You are not checking the error returned by loadPage() in viewHandler() so if loadPage() can't load the file and returns nil with an error, viewHandler() tries to use that nil to obtain the page title and body and that's what causing the panic.</p>\n\n<p>It works fine if loadPage() can read the file, though.</p>\n"}], "owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 41366470, "answer_count": 1, "score": 0, "last_activity_date": 1482944542, "creation_date": 1482943768, "question_id": 41366347, "link": "https://stackoverflow.com/questions/41366347/go-loadpage-issue-invalid-memory-address-or-nil-pointer-dereference", "title": "go loadPage issue: invalid memory address or nil pointer dereference", "body": "<p>I'm following the golang.org tutorial on building a wiki page (<a href=\"https://golang.org/doc/articles/wiki/#tmp_4\" rel=\"nofollow noreferrer\">https://golang.org/doc/articles/wiki/#tmp_4</a>) and everything runs fine until I've gotten the above error message during step \"Using net/http to serve wiki pages\". I've got a text.txt file in src/github.com/user/gowiki/test.txt but loadPage(title) doesn't seem to be accessing the test.txt file. Any help is greatly appreciated.  Thanks!</p>\n\n<pre><code>   package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\ntype Page struct {\n    Title string\n    Body  []byte\n}\n\nfunc (p *Page) save() error {\n    filename := p.Title + \".txt\"\n    return ioutil.WriteFile(filename, p.Body, 0600)\n}\n\nfunc loadPage(title string) (*Page, error) {\n    filename := title + \".txt\"\n    body, err := ioutil.ReadFile(filename)\n    if err != nil {\n        return nil, err\n    }\n    return &amp;Page{Title: title, Body: body}, nil\n}\n\nfunc viewHandler(w http.ResponseWriter, r *http.Request) {\n    title := r.URL.Path[len(\"/view/\"):]\n    p, _ := loadPage(title)\n    fmt.Fprintf(w, \"&lt;h1&gt;%s&lt;/h1&gt;&lt;div&gt;%s&lt;/div&gt;\", p.Title, p.Body)\n}\n\nfunc main() {\n    http.HandleFunc(\"/view/\", viewHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}, {"tags": ["go", "syntax"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 5, "creation_date": 1482942495, "post_id": 41366020, "comment_id": 69933434, "body": "<a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Method_declarations</a>"}, {"owner": {"reputation": 901, "user_id": 3615752, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95f412691055035fad3a563e8b162dc4?s=128&d=identicon&r=PG&f=1", "display_name": "kamal", "link": "https://stackoverflow.com/users/3615752/kamal"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1483030288, "post_id": 41366020, "comment_id": 69969870, "body": "I don&#39;t understand the reason people downvote question, Is it not allowed to ask question on this platform? I am new to this, and could not find any help. So asked on SO."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 7349471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc84067cd9c6f7a240dbcf4059de6320?s=128&d=identicon&r=PG&f=1", "display_name": "Markas \u010cerniauskas", "link": "https://stackoverflow.com/users/7349471/markas-%c4%8cerniauskas"}, "is_accepted": true, "score": 2, "last_activity_date": 1482944250, "creation_date": 1482944250, "answer_id": 41366479, "question_id": 41366020, "link": "https://stackoverflow.com/questions/41366020/explain-the-syntax-for-function-declaration/41366479#41366479", "title": "Explain the syntax for function declaration", "body": "<p>It is called a receiver.</p>\n\n<p>Basically if a function has something before it's name (the receiver) it is now called a method. It's a good way to take structs as arguments.</p>\n\n<p>I would recommend going over <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/1</a> for more information.</p>\n\n<p><a href=\"https://gobyexample.com/methods\" rel=\"nofollow noreferrer\">https://gobyexample.com/methods</a> is also sweet</p>\n"}], "owner": {"reputation": 901, "user_id": 3615752, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95f412691055035fad3a563e8b162dc4?s=128&d=identicon&r=PG&f=1", "display_name": "kamal", "link": "https://stackoverflow.com/users/3615752/kamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 41366479, "answer_count": 1, "score": -2, "last_activity_date": 1482944250, "creation_date": 1482942413, "last_edit_date": 1482943380, "question_id": 41366020, "link": "https://stackoverflow.com/questions/41366020/explain-the-syntax-for-function-declaration", "title": "Explain the syntax for function declaration", "body": "<p>Please explain the below syntax, I found this below snippet from godoc. I understand <code>Cookie</code> is function name and <code>name</code> is its argument and return type are <code>(*Cookie, error)</code>, the part I could not understand is <code>(r *Request)</code>, What exactly this part signifies. By the way I am from OOP background.</p>\n\n<pre><code>func (r *Request) Cookie(name string) (*Cookie, error)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 2, "last_activity_date": 1482941282, "creation_date": 1482941282, "answer_id": 41365711, "question_id": 41365443, "link": "https://stackoverflow.com/questions/41365443/binary-write-byte-ordering-not-working-for-byte/41365711#41365711", "title": "binary.Write() byte ordering not working for []byte", "body": "<p>Only integer types get swapped by byte ordering.</p>\n\n<p>When it's a slice of bytes, the binary package wouldn't really know what to swap.  </p>\n\n<p>For example, how would it know what to do if you passed 1k of data?</p>\n\n<p>Treat it as int16, int32 or int64?  </p>\n\n<p>Or would you expect it to just reverse the whole slice?</p>\n"}, {"tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": false, "score": 2, "last_activity_date": 1482941416, "creation_date": 1482941416, "answer_id": 41365759, "question_id": 41365443, "link": "https://stackoverflow.com/questions/41365443/binary-write-byte-ordering-not-working-for-byte/41365759#41365759", "title": "binary.Write() byte ordering not working for []byte", "body": "<p>Because there is nothing to order by. A byte is 8 bits, so you can go (unsigned) from 0 to 255. ie. <code>uint16</code> you have 2 bytes, so you can order them differently.</p>\n\n<p><a href=\"https://golang.org/pkg/encoding/binary/#ByteOrder\" rel=\"nofollow noreferrer\"><code>ByteOrder</code></a> is not even defined for <code>int8</code>. You can check the <a href=\"https://golang.org/src/encoding/binary/binary.go?s=7232:7296#L240\" rel=\"nofollow noreferrer\">source code</a> to see that <code>binary.Write</code> simply not uses the passed order when types are <code>uint8</code> or <code>int8</code>. (A <code>byte</code> is an alias to <code>uint8</code>)</p>\n"}], "owner": {"reputation": 1, "user_id": 4916644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c784e5a779f70544150e34b61295b3b5?s=128&d=identicon&r=PG&f=1", "display_name": "TY2", "link": "https://stackoverflow.com/users/4916644/ty2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1482941416, "creation_date": 1482940292, "question_id": 41365443, "link": "https://stackoverflow.com/questions/41365443/binary-write-byte-ordering-not-working-for-byte", "title": "binary.Write() byte ordering not working for []byte", "body": "<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n    \"bytes\"\n)\n\nfunc main(){\n    b := new(bytes.Buffer)\n    c := new(bytes.Buffer)\n    binary.Write(b, binary.LittleEndian, []byte{0, 1})\n    binary.Write(b, binary.BigEndian, []byte{0, 1})\n    binary.Write(c, binary.LittleEndian, uint16(256))\n    binary.Write(c, binary.BigEndian, uint16(256))\n    fmt.Println(b.Bytes()) // [0 1 0 1]\n    fmt.Println(c.Bytes()) // [0 1 1 0]\n}\n</code></pre>\n\n<p>It is very interesting, why <code>binary.Write()</code> byte ordering is working for <code>uint8, uint16, uint64</code>..etc, but <code>[]byte</code>?</p>\n\n<p>If <code>[]byte</code> need to be ordered by <code>binary.LittleEndian</code> and write to <code>bytes.Buffer</code>, it needs to be reversed first? Is there any effective ways to solve this problem?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "ide", "jetbrains-ide", "goland"], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 2102540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w7FYx.png?s=128&g=1", "display_name": "KelvZhan", "link": "https://stackoverflow.com/users/2102540/kelvzhan"}, "edited": false, "score": 12, "creation_date": 1486857451, "post_id": 41368787, "comment_id": 71528017, "body": "After finding this solution via Google, I had no luck because I kept trying to type <code>client</code> under <i>Package</i> to compile all files under <code>~&#47;go&#47;src&#47;reponame&#47;src&#47;client</code>. Turns out that my <i>Package</i> should instead say <code>reponame&#47;src&#47;client</code> for it to work."}], "tags": [], "owner": {"reputation": 439, "user_id": 4771487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b53R3.png?s=128&g=1", "display_name": "Roman", "link": "https://stackoverflow.com/users/4771487/roman"}, "is_accepted": true, "score": 19, "last_activity_date": 1482954642, "creation_date": 1482954642, "answer_id": 41368787, "question_id": 41365400, "link": "https://stackoverflow.com/questions/41365400/how-to-run-the-whole-project-in-goland/41368787#41368787", "title": "How to run the whole project in GoLand?", "body": "<p>To run the whole project you have to go <em>Run</em> -> <em>Edit Configuration</em>, set <em>Run Kind</em> to <em>Package</em> and type in field <em>Package</em> your project directory name.</p>\n"}], "owner": {"reputation": 439, "user_id": 4771487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b53R3.png?s=128&g=1", "display_name": "Roman", "link": "https://stackoverflow.com/users/4771487/roman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14023, "favorite_count": 1, "accepted_answer_id": 41368787, "answer_count": 1, "score": 9, "last_activity_date": 1536830449, "creation_date": 1482940159, "last_edit_date": 1536830449, "question_id": 41365400, "link": "https://stackoverflow.com/questions/41365400/how-to-run-the-whole-project-in-goland", "title": "How to run the whole project in GoLand?", "body": "<p>I have a small project with several .go files. When I run main.go only this compiles but nothing else, so my application crushes. I understand that I have to change settings in Run -> Edit Configurations, but don't know what to do exactly. IDE also doesn\u2019t see terminal pre-compiled package, so \"Package\" option instead of \"File\" doesn't work.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 2, "creation_date": 1482930638, "post_id": 41361929, "comment_id": 69926797, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10781516/how-to-pipe-several-commands-in-go\">How to pipe several commands in Go?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1482928414, "creation_date": 1482928414, "answer_id": 41362263, "question_id": 41361929, "link": "https://stackoverflow.com/questions/41361929/go-pipe-3-or-more-commands-with-os-exec/41362263#41362263", "title": "Go - Pipe 3 or more commands with os.exec()?", "body": "<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    c1 := exec.Command(\"ls\")\n    c2 := exec.Command(\"grep\", \"-i\", \"o\")\n    c3 := exec.Command(\"wc\", \"-l\")\n    c2.Stdin, _ = c1.StdoutPipe()\n    c3.Stdin, _ = c2.StdoutPipe()\n    c3.Stdout = os.Stdout\n    _ = c3.Start()\n    _ = c2.Start()\n    _ = c1.Run()\n    _ = c2.Wait()\n    _ = c3.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1596, "favorite_count": 0, "accepted_answer_id": 41362263, "answer_count": 1, "score": 2, "last_activity_date": 1521636137, "creation_date": 1482927204, "last_edit_date": 1521636137, "question_id": 41361929, "link": "https://stackoverflow.com/questions/41361929/go-pipe-3-or-more-commands-with-os-exec", "title": "Go - Pipe 3 or more commands with os.exec()?", "body": "<p>How can I pipe 3+ commands together in Go (for example ls | grep | wc)? I've tried to modify this code that is for piping 2 commands, but can't figure out the correct way.,</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    c1 := exec.Command(\"ls\")\n    c2 := exec.Command(\"wc\", \"-l\")\n    c2.Stdin, _ = c1.StdoutPipe()\n    c2.Stdout = os.Stdout\n    _ = c2.Start()\n    _ = c1.Run()\n    _ = c2.Wait()\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/10953142/3761308\">https://stackoverflow.com/a/10953142/3761308</a></p>\n"}, {"tags": ["go", "uuid", "md5-file"], "comments": [{"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1482924442, "post_id": 41361070, "comment_id": 69923312, "body": "Can you show some code and what you have tried already?"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1482926084, "post_id": 41361070, "comment_id": 69924254, "body": "Can you be clear on what exactly do you mean . Are you asking how to accept command line arguements in golang ?"}, {"owner": {"reputation": 1, "user_id": 7013578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMfYV.jpg?s=128&g=1", "display_name": "Shriram Katneshwarkar", "link": "https://stackoverflow.com/users/7013578/shriram-katneshwarkar"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1482928848, "post_id": 41361070, "comment_id": 69925839, "body": "Yes @Sarathsp how to acept command line arguments in golang"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1482931085, "post_id": 41361070, "comment_id": 69927043, "body": "@ShriramKatneshwarkar I have answered how to accept command line arguements in golang"}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1482931247, "post_id": 41361070, "comment_id": 69927127, "body": "@ShriramKatneshwarkar what exactly are you trying to write to multiple files? What do you want to read from command line arguments?"}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1551597592, "post_id": 41361070, "comment_id": 96693273, "body": "The code looks messy. Please run <code>gofmt</code> on it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7013578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMfYV.jpg?s=128&g=1", "display_name": "Shriram Katneshwarkar", "link": "https://stackoverflow.com/users/7013578/shriram-katneshwarkar"}, "edited": false, "score": 0, "creation_date": 1482930089, "post_id": 41362532, "comment_id": 69926483, "body": "Thanks @Sarathsp this clears the idea how to use command line argument but how it will be helpful to generate multiple file.?"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 1, "user_id": 7013578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMfYV.jpg?s=128&g=1", "display_name": "Shriram Katneshwarkar", "link": "https://stackoverflow.com/users/7013578/shriram-katneshwarkar"}, "edited": false, "score": 0, "creation_date": 1482930372, "post_id": 41362532, "comment_id": 69926647, "body": "I am not clear about multiple file ? Now you can run the script for any files and get md5 sum of the file. Is it not what you need ? If not what exactly do you need ?"}, {"owner": {"reputation": 1, "user_id": 7013578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMfYV.jpg?s=128&g=1", "display_name": "Shriram Katneshwarkar", "link": "https://stackoverflow.com/users/7013578/shriram-katneshwarkar"}, "edited": false, "score": 0, "creation_date": 1482931573, "post_id": 41362532, "comment_id": 69927315, "body": "actually when run my script it will create one file and in that it will generate md5 and uuid, and now I&#39;ve to generate multiple files to generate multiple md5 and uuid. Means when I give command line argument as e.g. 5 then is should create 5 files with all different md5 and uuid."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 1, "user_id": 7013578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMfYV.jpg?s=128&g=1", "display_name": "Shriram Katneshwarkar", "link": "https://stackoverflow.com/users/7013578/shriram-katneshwarkar"}, "edited": false, "score": 0, "creation_date": 1482931895, "post_id": 41362532, "comment_id": 69927464, "body": "@ShriramKatneshwarkar  All what you need to change would be copy all your code from the <code>main</code> as given in the question to a new function that accept a file name . In the main you will have a for loop that loops n times as the arguement and you may create <code>UUID</code> there and pass it to the function which whill now create files with file name as the uuid and will conatain your desired data"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 1, "user_id": 7013578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMfYV.jpg?s=128&g=1", "display_name": "Shriram Katneshwarkar", "link": "https://stackoverflow.com/users/7013578/shriram-katneshwarkar"}, "edited": false, "score": 0, "creation_date": 1482932600, "post_id": 41362532, "comment_id": 69927868, "body": "@ShriramKatneshwarkar updated  the answer with your code updated for your needs. Please accept the answer if this helped you"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 1, "user_id": 7013578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMfYV.jpg?s=128&g=1", "display_name": "Shriram Katneshwarkar", "link": "https://stackoverflow.com/users/7013578/shriram-katneshwarkar"}, "edited": false, "score": 0, "creation_date": 1482934659, "post_id": 41362532, "comment_id": 69929071, "body": "@ShriramKatneshwarkar good to know, please upvote the answer if it helped you :D"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 0, "last_activity_date": 1482932565, "last_edit_date": 1482932565, "creation_date": 1482929512, "answer_id": 41362532, "question_id": 41361070, "link": "https://stackoverflow.com/questions/41361070/how-to-generate-multiple-uuid-and-md5-files-in-golang/41362532#41362532", "title": "how to generate multiple uuid and md5 files in golang", "body": "<p>You can use <code>os.Args</code> to accept command line arguements</p>\n\n<p><code>os.Args</code> provides access to raw command-line arguments. Note that the first value in this slice is the path to the program, and <code>os.Args[1:]</code> holds the arguments to the program.</p>\n\n<p>Your program will look like this, have a look at <code>createFile</code> and  <code>getNumberOfFiles</code> functions and the <code>main</code></p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"crypto/rand\"\n    \"errors\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n    \"strconv\"\n    \"text/template\"\n)\n\ntype Data struct {\n    Uuid string\n    Md5  string\n}\n\nfunc createFile(uuid string) {\n    md5 := Getmd5(uuid)\n    fmt.Printf(\"Checksum:   %s\\n\", md5)\n    fillData := Data{uuid, md5}\n    file, err := os.Create(uuid + \".txt\")\n    if err != nil {\n        return\n    }\n    defer file.Close()\n\n    templ, err := template.ParseFiles(\"template.html\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n    err = templ.Execute(file, fillData)\n    if err != nil {\n        log.Fatalln(err)\n    }\n}\n\nfunc getNumberOfFiles() (num int, err error) {\n    if len(os.Args) == 1 {\n        return 0, errors.New(\"Not enough arguements\")\n    }\n    if num, err = strconv.Atoi(os.Args[1]); err != nil {\n        return\n    }\n    return num, nil\n}\n\nfunc main() {\n    numberOfFiles, err := getNumberOfFiles()\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    fmt.Printf(\"Creating %d files\", numberOfFiles)\n    for i := 0; i &lt; numberOfFiles; i++ {\n        uuid, err := newUUID()\n        if err != nil {\n            fmt.Printf(\"error: %v\\n\", err)\n        }\n        createFile(uuid)\n    }\n}\n\n// newUUID generates a random UUID according to RFC 4122\nfunc newUUID() (string, error) {\n    uuid := make([]byte, 16)\n    n, err := io.ReadFull(rand.Reader, uuid)\n    if n != len(uuid) || err != nil {\n        return \"\", err\n    }\n    // variant bits\n    uuid[8] = uuid[8]&amp;^0xc0 | 0x80\n    // version 4 (pseudo-random)\n    uuid[6] = uuid[6]&amp;^0xf0 | 0x40\n    return fmt.Sprintf(\"%x-%x-%x-%x-%x\", uuid[0:4], uuid[4:6], uuid[6:8], uuid[8:10], uuid[10:]), nil\n}\n\nfunc Getmd5(uuid string) string {\n    data := []byte(uuid)\n    //md5_buffer := fmt.Sprintf(\"%x\", md5.Sum(data))\n    md5_buffer := md5.Sum(data)\n    return fmt.Sprintf(\"{0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x};\\n\", md5_buffer[0:1],\n        md5_buffer[1:2], md5_buffer[2:3], md5_buffer[3:4], md5_buffer[4:5], md5_buffer[5:6], md5_buffer[6:7], md5_buffer[7:8],\n        md5_buffer[8:9], md5_buffer[9:10], md5_buffer[10:11], md5_buffer[11:12], md5_buffer[12:13], md5_buffer[13:14], md5_buffer[14:15],\n        md5_buffer[15:16])\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7013578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aMfYV.jpg?s=128&g=1", "display_name": "Shriram Katneshwarkar", "link": "https://stackoverflow.com/users/7013578/shriram-katneshwarkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 0, "accepted_answer_id": 41362532, "answer_count": 1, "score": 0, "last_activity_date": 1482932565, "creation_date": 1482924285, "last_edit_date": 1482924906, "question_id": 41361070, "link": "https://stackoverflow.com/questions/41361070/how-to-generate-multiple-uuid-and-md5-files-in-golang", "title": "how to generate multiple uuid and md5 files in golang", "body": "<p>Hi I've generated Md5 and uuid in golang but now I want generate it for multiple files using command line arguments, so what exactly I've to do. This is how I've generated my md5 and uuid:</p>\n\n<pre><code>package main\n\nimport (\n        \"crypto/rand\"\n        \"crypto/md5\"\n        \"fmt\"\n        \"io\"\n        \"os\"\n        \"log\"\n        \"text/template\"\n       )\n\ntype Data struct {\n    Uuid string\n    Md5  string\n}\n\nfunc main() {\n\n    uuid, err := newUUID()\n        if err != nil {\n            fmt.Printf(\"error: %v\\n\", err)\n        }\n\n    fmt.Printf(\"UUID:   %s\\n\", uuid)\n\n        md5 := Getmd5(uuid)\n\n        fmt.Printf(\"Checksum:   %s\\n\",md5)\n\n        fillData := Data{uuid, md5}\n    file, err := os.Create(\"text.txt\")\n            if err != nil {\n                return\n            }\n            defer file.Close()\n\n    templ, err := template.ParseFiles(\"template.html\")\n        if err !=nil{\n            log.Fatalln(err)\n        }\n    err = templ.Execute(file,fillData)\n        if err != nil{\n            log.Fatalln(err)\n        }\n}\n\n// newUUID generates a random UUID according to RFC 4122\nfunc newUUID() (string, error) {\nuuid := make([]byte, 16)\n          n, err := io.ReadFull(rand.Reader, uuid)\n          if n != len(uuid) || err != nil {\n              return \"\", err\n          }\n      // variant bits\n      uuid[8] = uuid[8]&amp;^0xc0 | 0x80\n          // version 4 (pseudo-random)\n          uuid[6] = uuid[6]&amp;^0xf0 | 0x40\n          return fmt.Sprintf(\"%x-%x-%x-%x-%x\", uuid[0:4], uuid[4:6], uuid[6:8], uuid[8:10], uuid[10:]), nil\n}\n\nfunc Getmd5(uuid string) (string) {\ndata := []byte(uuid)\n          //md5_buffer := fmt.Sprintf(\"%x\", md5.Sum(data))\n          md5_buffer := md5.Sum(data)\n          return fmt.Sprintf(\"{0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x};\\n\",md5_buffer[0:1],\n                  md5_buffer[1:2],md5_buffer[2:3],md5_buffer[3:4],md5_buffer[4:5],md5_buffer[5:6],md5_buffer[6:7],md5_buffer[7:8],\n                  md5_buffer[8:9],md5_buffer[9:10],md5_buffer[10:11],md5_buffer[11:12],md5_buffer[12:13],md5_buffer[13:14],md5_buffer[14:15],\n                  md5_buffer[15:16])\n\n}\n</code></pre>\n\n<p>Can anyone help me out?</p>\n"}, {"tags": ["go", "heap", "revel", "pprof"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7349082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dca2873897baa89ab731f63e77d606f?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/7349082/victor"}, "edited": false, "score": 0, "creation_date": 1482976733, "post_id": 41360357, "comment_id": 69946101, "body": "Thanks for your reply. But as I use the revel framework, so the main function will be auto-generated. So I cannot add any codes in the main file. And I can user <a href=\"http://sit:9000/debug/pprof/heap?debug=1\" rel=\"nofollow noreferrer\">sit:9000/debug/pprof/heap?debug=1</a> to see the general information. I just cannot use the command to see deeper information."}], "tags": [], "owner": {"reputation": 410, "user_id": 3338740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHA9F.jpg?s=128&g=1", "display_name": "ellimist", "link": "https://stackoverflow.com/users/3338740/ellimist"}, "is_accepted": false, "score": 1, "last_activity_date": 1482921885, "creation_date": 1482921885, "answer_id": 41360357, "question_id": 41359022, "link": "https://stackoverflow.com/questions/41359022/go-pprof-got-error-unrecognized-profile-format/41360357#41360357", "title": "Go pprof: Got Error unrecognized profile format", "body": "<p>It's most likely because your debug profile is empty.\nYou need to specify how often to profile the app using <code>SetBlockProfileRate</code></p>\n\n<p><a href=\"https://golang.org/pkg/runtime/#SetBlockProfileRate\" rel=\"nofollow noreferrer\">https://golang.org/pkg/runtime/#SetBlockProfileRate</a></p>\n\n<p>Just import the <code>runtime</code> package in your <code>main</code> file and call the <code>runtime.SetBlockProfileRate</code> function.</p>\n\n<p>Alternatively, you can use this package, which handles it for you, with some defaults: <a href=\"https://github.com/pkg/profile\" rel=\"nofollow noreferrer\">https://github.com/pkg/profile</a></p>\n"}], "owner": {"reputation": 31, "user_id": 7349082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dca2873897baa89ab731f63e77d606f?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/7349082/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4076, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1482921885, "creation_date": 1482917107, "question_id": 41359022, "link": "https://stackoverflow.com/questions/41359022/go-pprof-got-error-unrecognized-profile-format", "title": "Go pprof: Got Error unrecognized profile format", "body": "<p>I'm developing a web program with Go revel framework(my go version is 1.6.2). And I got issues with the memory usage. The memory occupied by revel is increasing almost hundreds of MB every day. So I want to tune the program. Then I learn to use the go pprof and use the revel pprof as said in github.com/revel/modules/tree/master/pprof. But while I'm trying to get the memory profile with following command </p>\n\n<blockquote>\n  <p>go tool pprof <a href=\"http://sit:9000/debug/pprof/heap\" rel=\"nofollow noreferrer\">http://sit:9000/debug/pprof/heap</a>.</p>\n</blockquote>\n\n<p>It got error unrecognized profile format. You can see as following snapshot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bQKfa.png\" rel=\"nofollow noreferrer\">enter image description here</a>\nI've struggled on this issue for hours. Any help is appreciated! Thank you in advance!</p>\n"}, {"tags": ["sql", "go", "orm", "go-gorm"], "comments": [{"owner": {"reputation": 1041, "user_id": 7730968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kCdXw.png?s=128&g=1", "display_name": "kenfire", "link": "https://stackoverflow.com/users/7730968/kenfire"}, "edited": false, "score": 0, "creation_date": 1510906787, "post_id": 41358756, "comment_id": 81643965, "body": "Would be nice to have the data type structure"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 1957744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0xwq.jpg?s=128&g=1", "display_name": "Sefa", "link": "https://stackoverflow.com/users/1957744/sefa"}, "is_accepted": false, "score": 4, "last_activity_date": 1514912245, "creation_date": 1514912245, "answer_id": 48064898, "question_id": 41358756, "link": "https://stackoverflow.com/questions/41358756/how-to-execute-nested-query-in-golang-gorm/48064898#48064898", "title": "How to execute nested query in golang gorm", "body": "<p>You can do this by building up your query. Check out this example:</p>\n\n<pre><code>func FindProspects(categories *string, cities *string, hasEmail *bool, hasContactperson *bool, limit int64, offset int64) []*gModels.Prospect {\n    var prospects []*gModels.Prospect\n\n    query := env.DB().Table(\"prospects\").Select(\"prospects.id, prospects.name\")\n\n    if categories != nil {\n        query = query.Joins(\"JOIN prospect_categories ON prospect_categories.prospect_id = prospects.id\").Where(\"prospect_categories.category_name IN (?)\", strings.Split(*categories, \",\"))\n    }\n\n    if cities != nil {\n        query = query.Where(\"prospects.city IN (?)\", strings.Split(*cities, \",\"))\n    }\n\n    if hasEmail != nil &amp;&amp; *hasEmail == true {\n        query = query.Where(\"prospects.id IN (SELECT emails.prospect_id FROM emails WHERE emails.prospect_id = prospects.id)\")\n    }\n\n    if hasContactperson != nil &amp;&amp; *hasContactperson == true {\n        query = query.Where(\"prospects.id IN (SELECT contact_people.prospect_id FROM contact_people WHERE contact_people.prospect_id = prospects.id)\")\n    }\n\n    query = query.Order(\"prospects.name ASC\")\n\n    query.Limit(int(limit)).Offset(int(offset)).Find(&amp;prospects)\n\n    return prospects\n}\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 358, "user_id": 1853171, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/oxsRS.jpg?s=128&g=1", "display_name": "Mehran Akhavan", "link": "https://stackoverflow.com/users/1853171/mehran-akhavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2365, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1514912245, "creation_date": 1482916212, "question_id": 41358756, "link": "https://stackoverflow.com/questions/41358756/how-to-execute-nested-query-in-golang-gorm", "title": "How to execute nested query in golang gorm", "body": "<p>I want to execute a query like below in golang gorm:</p>\n\n<pre><code>select * from MY_TABLE where MY_FIELD in (select max(MY_FIELD) as MY_FIELD from MY_TABLE group by ANOTHER_FIELD)\n</code></pre>\n\n<p>Is there a way besides raw query in gorm?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "is_accepted": false, "score": 0, "last_activity_date": 1482913118, "creation_date": 1482913118, "answer_id": 41358029, "question_id": 41357993, "link": "https://stackoverflow.com/questions/41357993/how-to-mark-errors-accurate-to-line-with-golang/41358029#41358029", "title": "How to mark errors accurate to line with golang", "body": "<p>If you're using the <code>log</code> package, you can instruct the <code>logger</code> to <a href=\"https://golang.org/pkg/log/#pkg-constants\" rel=\"nofollow noreferrer\">prefix the entries with various information</a>.</p>\n\n<pre><code>log.SetFlags(log.Lshortfile)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 0, "creation_date": 1482915838, "post_id": 41358438, "comment_id": 69918701, "body": "Here silimar to Log you can create a NewError function that appends the location to error string using <code>Caller</code>"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 1, "creation_date": 1482916797, "post_id": 41358438, "comment_id": 69919243, "body": "updated the answer, check the <code>NewError</code>  function and the play link. This is the maximum one can do using the go libraries provided . The error interface only needs <code>Error</code> function to be defined so you can not find the location where error happened for external libraries unless they incorporate these details with error"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 5, "last_activity_date": 1525585352, "last_edit_date": 1525585352, "creation_date": 1482914995, "answer_id": 41358438, "question_id": 41357993, "link": "https://stackoverflow.com/questions/41357993/how-to-mark-errors-accurate-to-line-with-golang/41358438#41358438", "title": "How to mark errors accurate to line with golang", "body": "<p>See <a href=\"https://godoc.org/runtime#Caller\" rel=\"nofollow noreferrer\">runtime.Caller</a> which will give you all the details you need. </p>\n\n<p>Your custom <code>NewError</code> function may look like this:</p>\n\n<pre><code>func NewError(message string) error {\n    _, file, line, _ := runtime.Caller(1)\n    return fmt.Errorf(\"[%s][%d] : %s\" , file, line, message)\n}\n</code></pre>\n\n<p>Here is play link for a sample <a href=\"https://play.golang.org/p/XknlvmMqDF\" rel=\"nofollow noreferrer\">play</a></p>\n"}], "owner": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 0, "accepted_answer_id": 41358438, "answer_count": 2, "score": -3, "last_activity_date": 1525585352, "creation_date": 1482912939, "last_edit_date": 1495540409, "question_id": 41357993, "link": "https://stackoverflow.com/questions/41357993/how-to-mark-errors-accurate-to-line-with-golang", "title": "How to mark errors accurate to line with golang", "body": "<p>I have seem this answer and use @OneOfOne answers.\n<a href=\"https://stackoverflow.com/questions/24809287/how-do-you-get-a-golang-program-to-print-the-line-number-of-the-error-it-just-ca\">How do you get a Golang program to print the line number of the error it just called?</a></p>\n\n<p>But there is some questions.</p>\n\n<pre><code>func FancyHandleError(err error) (b bool) {\n    if err != nil {\n        pc, fn, line, _ := runtime.Caller(1)\n        log.Printf(\"[error] in %s[%s:%d] %v\", runtime.FuncForPC(pc).Name(), fn, line, err)\n        b = true\n    }\n    return\n}\n\nfunc main(){\n    FancyHandleError\uff08funcA())\n}\n\nfunc funcA()error{\n    err := funcB()\n    return err\n}\n\nfunc funcB()error{\n    err := funcC()\n    return err\n}\n\nfunc funcC()error{\n    err := errors.New(\"deep errors!!\") //I want to get the location in here!!!!!!!!!!!!!!!!!!!!!!\n    return err\n}\n</code></pre>\n\n<p>It will print \"<strong>[error] in main.main[/root/temp/error.go:23]</strong>\"\nThat is in function main's line number.</p>\n\n<p>But how to locate the error's line number in function C()?</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "edited": false, "score": 1, "creation_date": 1482912897, "post_id": 41357948, "comment_id": 69917385, "body": "with or without  line#22, same result"}, {"owner": {"reputation": 19, "user_id": 7348040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaa1ae16f259c9323a7d1d7306ac198?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7348040/jonathan"}, "reply_to_user": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "edited": false, "score": 0, "creation_date": 1482916473, "post_id": 41357948, "comment_id": 69919056, "body": "sorry, i&#39;ve update the code"}, {"owner": {"reputation": 19, "user_id": 7348040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaa1ae16f259c9323a7d1d7306ac198?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7348040/jonathan"}, "reply_to_user": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "edited": false, "score": 1, "creation_date": 1482916566, "post_id": 41357948, "comment_id": 69919108, "body": "add  ``` a1.echo() b1.echo() ``` the result is not the same"}, {"owner": {"reputation": 373, "user_id": 1924721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ba12cccb8e7b9f1da05f7226a25521d2?s=128&d=identicon&r=PG", "display_name": "neclepsio", "link": "https://stackoverflow.com/users/1924721/neclepsio"}, "edited": false, "score": 0, "creation_date": 1483095134, "post_id": 41357948, "comment_id": 69991687, "body": "I would post on <a href=\"https://groups.google.com/forum/#!forum/golang-nuts\" rel=\"nofollow noreferrer\">go-nuts</a>. In my opinion, there&#39;s something happening while optimizing."}, {"owner": {"reputation": 19, "user_id": 7348040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaa1ae16f259c9323a7d1d7306ac198?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7348040/jonathan"}, "reply_to_user": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "edited": false, "score": 0, "creation_date": 1483292963, "post_id": 41357948, "comment_id": 70039844, "body": "@sounder do you have any idea after I update this code?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7348040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaa1ae16f259c9323a7d1d7306ac198?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7348040/jonathan"}, "edited": false, "score": 1, "creation_date": 1482998678, "post_id": 41365910, "comment_id": 69952560, "body": "Thanks for the explanation.  Another question that I don&#39;t understand is why the fmt.Println() would change the result of the if statement?"}], "tags": [], "owner": {"reputation": 21, "user_id": 7144276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OvRBwsRWMDU/AAAAAAAAAAI/AAAAAAAAAAo/MAML6dRav_s/photo.jpg?sz=128", "display_name": "Sam Jackson", "link": "https://stackoverflow.com/users/7144276/sam-jackson"}, "is_accepted": false, "score": 0, "last_activity_date": 1482941990, "last_edit_date": 1495542259, "creation_date": 1482941990, "answer_id": 41365910, "question_id": 41357948, "link": "https://stackoverflow.com/questions/41357948/what-golang-compiler-will-do-when-fmt-println/41365910#41365910", "title": "What golang compiler will do when fmt.Println()", "body": "<p>This is expected behavior. For background, <code>==</code> is an operator which compares the <em>value</em> of two objects. This is known as object equality. Comparing their pointer value, or their identity, is different. See the top answer on <a href=\"https://stackoverflow.com/questions/9643205/how-do-i-compare-two-functions-for-pointer-equality-in-the-latest-go-weekly\">this similar post</a>.</p>\n\n<p>When you ask <code>a1 == b1</code>, you receive <code>false</code> because <code>a1</code> is an instance of the <code>a</code> struct, whereas <code>b1</code> is an instance of the <code>b</code> struct. Therefore, even though they implement the same interface, they are <em>not</em> <code>==</code> to each other. Consider your <code>a</code> struct and <code>b</code> struct where they had additional and different methods implemented in both (so <code>a</code> has an additional method <code>foo()</code> and <code>b</code> has an additional method <code>bar()</code>). Although <code>a</code> and <code>b</code> would implement the same interface, they would not be the same, nor would you expect or want them to be.</p>\n\n<p>When you ask if <code>a1 == a2</code>, you receive true because <code>a1</code> and <code>a2</code> are just separate instances of the same struct. Referencing the post I linked above, <code>a1</code> and <code>a2</code> are <em>equal</em>, but do not share the same identity.</p>\n\n<p>Finally, when you ask if <code>a1 == a1</code>, you are asking if the same instance of the same object is equal to itself, which of course is true. In this case, <code>a1</code> shares both equality and identity with <code>a1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 7102681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6cc241c531ff5ad849b2f718ba7513?s=128&d=identicon&r=PG&f=1", "display_name": "Kale B", "link": "https://stackoverflow.com/users/7102681/kale-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1483702829, "last_edit_date": 1483702829, "creation_date": 1483702178, "answer_id": 41504751, "question_id": 41357948, "link": "https://stackoverflow.com/questions/41357948/what-golang-compiler-will-do-when-fmt-println/41504751#41504751", "title": "What golang compiler will do when fmt.Println()", "body": "<p>This appears to be a more complicated example of <a href=\"https://github.com/golang/go/issues/8938\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/8938</a>.</p>\n\n<p>The relevant parts of the Go spec are <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Comparison_operators</a></p>\n\n<blockquote>\n  <p>Pointers to distinct zero-size variables may or may not be equal.</p>\n</blockquote>\n\n<p>and <a href=\"https://golang.org/ref/spec#Size_and_alignment_guarantees\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Size_and_alignment_guarantees</a></p>\n\n<blockquote>\n  <p>Two distinct zero-size variables may have the same address in memory.</p>\n</blockquote>\n\n<p>Based on the title of the issue linked above (<code>cmd/compile: optimisations change the behaviour of *struct{}</code>), the difference is due to compiler optimizations.</p>\n"}, {"tags": [], "owner": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "is_accepted": false, "score": 0, "last_activity_date": 1486092299, "creation_date": 1486092299, "answer_id": 42016230, "question_id": 41357948, "link": "https://stackoverflow.com/questions/41357948/what-golang-compiler-will-do-when-fmt-println/42016230#42016230", "title": "What golang compiler will do when fmt.Println()", "body": "<p>You should use <code>reflect.DeepEqual</code> to compare struct, slice and map.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype a struct{}\n\nfunc main() {\n    a1 := &amp;a{}\n    a2 := &amp;a{}\n\n    fmt.Printf(\"%p\\n\", a1)\n\n    if a1 == a2 {\n        fmt.Println(\"same\")\n    } else {\n        fmt.Println(\"not same\")\n    }\n\n}\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>0x196a9c\nnot same\n</code></pre>\n\n<p>Using <code>reflect.DeepEqual</code> as below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype a struct{}\n\nfunc main() {\n    a1 := &amp;a{}\n    a2 := &amp;a{}\n\n    fmt.Printf(\"%p\\n\", a1)\n\n    if a1 == a2 {\n        fmt.Println(\"same\")\n    } else {\n        fmt.Println(\"not same\")\n    }\n\n    fmt.Println(reflect.DeepEqual(a1, a2))\n}\n</code></pre>\n\n<p>The Result is:</p>\n\n<pre><code>0x196a9c\nsame\ntrue\n</code></pre>\n\n<p>Just golang compiler optimization i guess.</p>\n"}], "owner": {"reputation": 19, "user_id": 7348040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaa1ae16f259c9323a7d1d7306ac198?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7348040/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1486092299, "creation_date": 1482912671, "last_edit_date": 1482998763, "question_id": 41357948, "link": "https://stackoverflow.com/questions/41357948/what-golang-compiler-will-do-when-fmt-println", "title": "What golang compiler will do when fmt.Println()", "body": "<p>I'm trying to understand how to check if two objects are the same when they implement the same interface.</p>\n\n<p>Here is the example code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype shout interface {\n    echo()\n}\n\ntype a struct {}\nfunc (*a) echo () {\n    fmt.Println(\"a\")\n}\n\ntype b struct {}\nfunc (*b) echo () {\n    fmt.Println(\"b\")\n}\n\nfunc compare(a, b shout) {\n    //fmt.Println(&amp;a, &amp;b)\n    if a == b {\n        fmt.Println(\"same\")\n    } else {\n        fmt.Println(\"not same\")\n    }\n}\n\nfunc main() {\n    a1 := &amp;a{}\n    b1 := &amp;b{}\n    a2 := &amp;a{}\n    a1.echo()\n    b1.echo()\n    compare(a1, b1)\n    compare(a1, a2)\n    compare(a1, a1) \n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/qo9XnbthMw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qo9XnbthMw</a></p>\n\n<p>The result is:</p>\n\n<pre><code>not same\nnot same\nsame\n</code></pre>\n\n<p>a1 and a2 are not the same</p>\n\n<p>But if uncomment the line#22</p>\n\n<pre><code>fmt.Println(&amp;a, &amp;b)\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>0x1040a120 0x1040a128\nnot same\n0x1040a140 0x1040a148\nsame\n0x1040a158 0x1040a160\nsame\n</code></pre>\n\n<p>Does anyone can figure out what happened here?\nDoes the Golang compiler optimize something?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1482907877, "post_id": 41356356, "comment_id": 69915246, "body": "You&#39;re not closing the <code>result</code> channel anywhere. Close it before the <code>for</code> loop starts. Also, why not just put a <code>defer wg.Done()</code> at the beginning of your <code>getUrl</code> function instead of hacking a -1 at the end of it?"}], "answers": [{"tags": [], "owner": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "is_accepted": false, "score": 0, "last_activity_date": 1482907222, "last_edit_date": 1482907222, "creation_date": 1482906650, "answer_id": 41356549, "question_id": 41356356, "link": "https://stackoverflow.com/questions/41356356/why-sync-waitgroup-cant-finish/41356549#41356549", "title": "why `sync.WaitGroup` can&#39;t finish?", "body": "<p>Your for loop never stop. When all the <code>getUrl</code> finish, it continues to wait on <code>result</code>. Try this:</p>\n\n<pre><code>wg.Wait()\n\nclose(result)\n\nfor link := range result {\n    fmt.Println(link)\n}\nlog.Println(\"Done!\")\n</code></pre>\n\n<p>If you want to print the result, you could do like:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/md5\"\n    \"encoding/hex\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"runtime\"\n    \"sync\"\n)\n\ntype Data struct {\n    Link string `json:\"url\"`\n}\ntype Result struct {\n    Code uint32\n    Msg  string `json:\"msg\"`\n    Data Data   `json:\"data\"`\n}\n\nconst (\n    URL     = \"http://qiye.wxsdc.ediankai.com/api/v1/suppliers/1/staff/1/box/get\"\n    SIGNKEY = \"i5OqMrNXVyOJ5GEMYoEtRHqN1P9ghk6I\"\n    DATA_ID = \"2965612126\"\n    EQU_ID  = \"1482806063\"\n)\n\nfunc getMD5Hash(text string) string {\n    hasher := md5.New()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n\nfunc getUrl(payload []byte, wg *sync.WaitGroup, result chan string) {\n    defer func(){\nwg.Done()\n}();\n\n    req, err := http.NewRequest(\"POST\", URL, bytes.NewBuffer(payload))\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\nreturn\n    }\n    defer resp.Body.Close()\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return\n    }\n    var res Result\n    json.Unmarshal(body, &amp;res)\n    log.Println(res.Data.Link)\n    result &lt;- res.Data.Link\n}\n\nfunc monitor(wg *sync.WaitGroup, cs chan string) {\n    wg.Wait()\n    close(cs)\n}\nfunc printResult(result &lt;-chan string, done chan&lt;- bool) {\n    for i := range result {\n        fmt.Println(i)\n    }\n\n    done &lt;- true\n}\n\nfunc main() {\n    parameterStr := fmt.Sprintf(\"%vdata_id%vequ_id%v%v\", SIGNKEY, DATA_ID, EQU_ID, SIGNKEY)\n    log.Println(parameterStr)\n    sign := getMD5Hash(parameterStr)\n    log.Println(sign)\n    var payload map[string]string = make(map[string]string)\n    payload[\"equ_id\"] = EQU_ID\n    payload[\"data_id\"] = DATA_ID\n    payload[\"sign\"] = sign\n\n    payloadJson, err := json.Marshal(payload)\n    if err != nil {\n        log.Fatalln(\"convet paylod failed!\")\n    }\n    log.Println(string(payloadJson))\n\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    var wg sync.WaitGroup\n    result := make(chan string)\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go getUrl(payloadJson, &amp;wg, result)\n    }\n\n    go monitor(&amp;wg, result)\n\n    done := make(chan bool, 1)\n    go printResult(result, done)\n    &lt;-done\n    log.Println(\"Done!\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 1, "last_activity_date": 1482908333, "creation_date": 1482908333, "answer_id": 41356924, "question_id": 41356356, "link": "https://stackoverflow.com/questions/41356356/why-sync-waitgroup-cant-finish/41356924#41356924", "title": "why `sync.WaitGroup` can&#39;t finish?", "body": "<p>You need to close the result channel so the for loop which reads from it is interrupted when its finished. For that you could rewrite the last part as:</p>\n\n<pre><code>var wg sync.WaitGroup\nresult := make(chan string)\ngo func() {\n    for link := range result {\n        fmt.Println(link)\n    }\n}()\nfor i := 0; i &lt; 10; i++ {\n    wg.Add(1)\n    go getUrl(payloadJson, &amp;wg, result)\n}\nwg.Wait()\nclose(result)\n</code></pre>\n"}], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 41356924, "answer_count": 2, "score": 0, "last_activity_date": 1482908333, "creation_date": 1482905570, "last_edit_date": 1482905755, "question_id": 41356356, "link": "https://stackoverflow.com/questions/41356356/why-sync-waitgroup-cant-finish", "title": "why `sync.WaitGroup` can&#39;t finish?", "body": "<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"crypto/md5\"\n    \"encoding/hex\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"runtime\"\n    \"sync\"\n)\n\ntype Data struct {\n    Link string `json:\"url\"`\n}\ntype Result struct {\n    Code uint32\n    Msg  string `json:\"msg\"`\n    Data Data   `json:\"data\"`\n}\n\nconst (\n    URL     = \"http://qiye.wxsdc.ediankai.com/api/v1/suppliers/1/staff/1/box/get\"\n    SIGNKEY = \"i5OqMrNXVyOJ5GEMYoEtRHqN1P9ghk6I\"\n    DATA_ID = \"2965612126\"\n    EQU_ID  = \"1482806063\"\n)\n\nfunc getMD5Hash(text string) string {\n    hasher := md5.New()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n\nfunc getUrl(payload []byte, wg *sync.WaitGroup, result chan string) {\n    req, err := http.NewRequest(\"POST\", URL, bytes.NewBuffer(payload))\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\n        panic(err)\n    }\n    defer resp.Body.Close()\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        panic(err)\n    }\n    var res Result\n    json.Unmarshal(body, &amp;res)\n    log.Println(res.Data.Link)\n    result &lt;- res.Data.Link\n    wg.Add(-1)\n}\nfunc main() {\n    parameterStr := fmt.Sprintf(\"%vdata_id%vequ_id%v%v\", SIGNKEY, DATA_ID, EQU_ID, SIGNKEY)\n    log.Println(parameterStr)\n    sign := getMD5Hash(parameterStr)\n    log.Println(sign)\n    var payload map[string]string = make(map[string]string)\n    payload[\"equ_id\"] = EQU_ID\n    payload[\"data_id\"] = DATA_ID\n    payload[\"sign\"] = sign\n\n    payloadJson, err := json.Marshal(payload)\n    if err != nil {\n        log.Fatalln(\"convet paylod failed!\")\n    }\n    log.Println(string(payloadJson))\n\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    var wg sync.WaitGroup\n    result := make(chan string)\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go getUrl(payloadJson, &amp;wg, result)\n    }\n    wg.Wait()\n    for link := range result {\n        fmt.Println(link)\n    }\n    log.Println(\"Done!\")\n}\n</code></pre>\n\n<p>But:</p>\n\n<pre><code>for link := range result {\n    fmt.Println(link)\n}\nlog.Println(\"Done!\")\n</code></pre>\n\n<p>can't be executed, what's the reason?</p>\n"}, {"tags": ["session", "cookies", "go", "go-gin"], "comments": [{"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1482905537, "post_id": 41356220, "comment_id": 69914301, "body": "How are you testing this? Are you using your web browser or some automated test? Which URL are you using to test it?"}, {"owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "reply_to_user": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1482906753, "post_id": 41356220, "comment_id": 69914788, "body": "i use web browser, And the url i test is &quot;myexample.com&quot;. Thanks for reply"}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1482908500, "post_id": 41356220, "comment_id": 69915483, "body": "Can you post the first handler code?"}, {"owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "reply_to_user": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1482908904, "post_id": 41356220, "comment_id": 69915629, "body": "<a href=\"https://play.golang.org/p/yUQzMEOC84\" rel=\"nofollow noreferrer\">play.golang.org/p/yUQzMEOC84</a> @PabloLalloni"}], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489407115, "creation_date": 1482904827, "last_edit_date": 1489407115, "question_id": 41356220, "link": "https://stackoverflow.com/questions/41356220/how-to-set-domain-for-cookie-golang-with-contrib-sessions-package-gin-gonic", "title": "How To set domain for cookie golang with &quot;contrib/sessions&quot; package, gin gonic", "body": "<p>Please help me!. I wanna set domain for my cookie,\nIn my main function, i set : </p>\n\n<pre><code>store := sessions.NewCookieStore([]byte(\"secretkey\"))\nstore.Options(sessions.Options{\n    Domain: \"myexample.com\",\n})\nrouter.Use(sessions.Sessions(\"mysession\", store))\n</code></pre>\n\n<p>In my first handler function, i set: </p>\n\n<pre><code>    session := sessions.Default(c)\n    session.Set(\"test\", \"test value\")\n    session.Save()\n</code></pre>\n\n<p>In another handler, i get the \"test\" session by:</p>\n\n<pre><code>    session := sessions.Default(c)\n    result = session.Get(\"test\")\n</code></pre>\n\n<p>But the problem is the value of result is nil, if i remove </p>\n\n<pre><code>    store.Options(sessions.Options{\n    Domain: \"myexample.com\",\n})\n</code></pre>\n\n<p>in main function, it will work. So anyone can explain for me. \nMoreover, if i get session \"test\" in my first handler function, it will be ok. </p>\n"}, {"tags": ["go", "runtime", "panic"], "comments": [{"owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "edited": false, "score": 0, "creation_date": 1482904567, "post_id": 41356117, "comment_id": 69913979, "body": "It would seem you&#39;re not handling arrays of length 0"}], "answers": [{"tags": [], "owner": {"reputation": 390, "user_id": 4401682, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a5696cfc9087ea6003bada234cb2c8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Vutuz", "link": "https://stackoverflow.com/users/4401682/vutuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1482906661, "creation_date": 1482906661, "answer_id": 41356553, "question_id": 41356117, "link": "https://stackoverflow.com/questions/41356117/golang-panic-runtime-error-index-out-of-range/41356553#41356553", "title": "Golang panic: runtime error: index out of range", "body": "<p>Do you want write a recursive function?, you can see my code below : </p>\n\n<pre><code>func domath(newarray []int, i int, array []int) []int {\nif i &lt; len(array) {\n    if array[i] &gt;= 0 {\n        newarray = append(newarray, array[i])\n    }\n    i++\n} else {\n    return newarray\n}\nreturn domath(newarray, i, array)\n</code></pre>\n\n<p>}</p>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 2, "last_activity_date": 1482907202, "last_edit_date": 1482907202, "creation_date": 1482906784, "answer_id": 41356578, "question_id": 41356117, "link": "https://stackoverflow.com/questions/41356117/golang-panic-runtime-error-index-out-of-range/41356578#41356578", "title": "Golang panic: runtime error: index out of range", "body": "<p>The problem with that implementation is that it's incrementing i inside the first if block and then using the new i value to check newarray[i] >= 0 on the second if block, so when you call domath(a, x, b) with x = len(a)-1 it tries to do newarray[x+1] (i.e. newarray[len(newarray)]) which is out of bounds.</p>\n\n<p>You probably meant to write something like:</p>\n\n<pre><code>func domath(newarray []int, i int, array []int) []int {\n    if i &lt; len(newarray) {\n        if newarray[i] &lt; 0 {\n            return domath(newarray, i+1, array)\n        }\n        if newarray[i] &gt;= 0 {\n            array = append(array, newarray[i])\n            return domath(newarray, i+1, array)\n        }\n    }\n    return array\n}\n</code></pre>\n\n<p>A simplified version of your algorithm could be:</p>\n\n<pre><code>func domath(newarray []int, i int, array []int) []int {\n    if len(newarray) == i {\n        return array\n    }\n    if newarray[i] &gt;= 0 {\n        array = append(array, newarray[i])\n    }\n    return domath(newarray, i+1, array)\n}\n</code></pre>\n\n<p>Yet you should probably be using an implementation more idiomatic like the following one, which will also be faster:</p>\n\n<pre><code>func domath(ns []int) []int {\n    var ps []int\n    for _, n := range ns {\n        if n &gt;= 0 {\n            ps = append(ps, n)\n        }\n    }\n    return ps\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7348435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/251854fea5a3abecfbf761241c9f9a28?s=128&d=identicon&r=PG&f=1", "display_name": "John Taylor", "link": "https://stackoverflow.com/users/7348435/john-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2340, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1482917510, "creation_date": 1482904296, "last_edit_date": 1482917510, "question_id": 41356117, "link": "https://stackoverflow.com/questions/41356117/golang-panic-runtime-error-index-out-of-range", "title": "Golang panic: runtime error: index out of range", "body": "<p>Hi This function takes an array with some integers and my goal is to have a new array with just positive integers. However, I am keep getting the same error saying panic: runtime error: index out of range</p>\n\n<p>Can anybody please help me..??</p>\n\n<pre><code>func domath(newarray[] int, i int, array[] int)([]int){\n    if i &lt; len(newarray) {\n        if newarray[i] &lt; 0{\n            i ++    \n            domath(newarray, i, array)\n        }\n        if newarray[i] &gt;= 0 {\n            array = append(array, newarray[i])\n            i ++\n            domath(newarray, i, array)\n        }\n    }\n    return array \n}\n</code></pre>\n"}, {"tags": ["go", "tcp"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "edited": false, "score": 0, "creation_date": 1483026303, "post_id": 41363498, "comment_id": 69967727, "body": "No, this is not what I want. Of caourse I saw this functions and I&#39;ll never ask this question if these functions was what I want. This functions just set the timeout of read or write or both operations! But if there is no any of it, then nothing happens."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "edited": false, "score": 0, "creation_date": 1483026574, "post_id": 41363498, "comment_id": 69967892, "body": "@IgniSerpens: then please show an example of what you need. The <code>Decode</code> call is going to do a <code>Read</code> on the connection, so this will cause <code>Decode</code> to return after the Deadline expires."}, {"owner": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "edited": false, "score": 0, "creation_date": 1483026666, "post_id": 41363498, "comment_id": 69967940, "body": "We need to make a timeout for existing of the connection itself."}, {"owner": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "edited": false, "score": 0, "creation_date": 1483026758, "post_id": 41363498, "comment_id": 69967990, "body": "but this Decode will never be executed until we have someone who connects to our socket."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "edited": false, "score": 1, "creation_date": 1483028373, "post_id": 41363498, "comment_id": 69968859, "body": "You say in the question that you are making a connection, so one would assume it&#39;s been accepted and you&#39;re in the <code>Decode</code> method. If you want <code>Accept</code> to timeout, use <code>SetDeadline</code> on the <code>TCPListener</code>."}, {"owner": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "edited": false, "score": 0, "creation_date": 1483028710, "post_id": 41363498, "comment_id": 69969046, "body": "Oh, thats what I want! Thanks! It works! Seems standart net.Listener does not have this method, but net.TCPListener does."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1483035244, "last_edit_date": 1483035244, "creation_date": 1482933135, "answer_id": 41363498, "question_id": 41356088, "link": "https://stackoverflow.com/questions/41356088/set-the-time-for-connections-life-in-golang/41363498#41363498", "title": "Set the time for connection&#39;s life in Golang", "body": "<p>Use <code>SetDeadline</code> or <code>SetReadDeadline</code></p>\n\n<p>From the <a href=\"https://golang.org/pkg/net/#Conn\" rel=\"nofollow noreferrer\"><code>net.Conn</code> docs</a></p>\n\n<pre><code>    // SetDeadline sets the read and write deadlines associated\n    // with the connection. It is equivalent to calling both\n    // SetReadDeadline and SetWriteDeadline.\n    //\n    // A deadline is an absolute time after which I/O operations\n    // fail with a timeout (see type Error) instead of\n    // blocking. The deadline applies to all future I/O, not just\n    // the immediately following call to Read or Write.\n    //\n    // An idle timeout can be implemented by repeatedly extending\n    // the deadline after successful Read or Write calls.\n    //\n    // A zero value for t means I/O operations will not time out.\n    SetDeadline(t time.Time) error\n\n    // SetReadDeadline sets the deadline for future Read calls.\n    // A zero value for t means Read will not time out.\n    SetReadDeadline(t time.Time) error\n\n    // SetWriteDeadline sets the deadline for future Write calls.\n    // Even if write times out, it may return n &gt; 0, indicating that\n    // some of the data was successfully written.\n    // A zero value for t means Write will not time out.\n    SetWriteDeadline(t time.Time) error\n</code></pre>\n\n<p>If you want the Accept call to timeout, you can use the <a href=\"https://golang.org/pkg/net/#TCPListener.SetDeadline\" rel=\"nofollow noreferrer\"><code>TCPListener.SetDeadline</code></a> method.</p>\n\n<pre><code>ln.(*net.TCPListener).SetDeadline(time.Now().Add(time.Second))\n</code></pre>\n\n<p>Optionally, you could have a timer call <code>Close()</code> or <code>CloseRead()</code> on the connection, or <code>Close()</code> on the net.Listener, but that won't leave you with the cleaner timeout error. </p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "is_accepted": false, "score": 0, "last_activity_date": 1483028928, "creation_date": 1483028928, "answer_id": 41383571, "question_id": 41356088, "link": "https://stackoverflow.com/questions/41356088/set-the-time-for-connections-life-in-golang/41383571#41383571", "title": "Set the time for connection&#39;s life in Golang", "body": "<p>As @JimB said in comments, we need to use another listener - net.TCPListener, which have method SetDeadline, setting the connection lifetime, while the standart net.Listener doesn't have it.</p>\n"}], "owner": {"reputation": 61, "user_id": 7169284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pvddMsO36IQ/AAAAAAAAAAI/AAAAAAAAABg/scyIWPDGtdY/photo.jpg?sz=128", "display_name": "Igni Serpens", "link": "https://stackoverflow.com/users/7169284/igni-serpens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6473, "favorite_count": 0, "accepted_answer_id": 41363498, "answer_count": 2, "score": 0, "last_activity_date": 1483069169, "creation_date": 1482904159, "last_edit_date": 1482914190, "question_id": 41356088, "link": "https://stackoverflow.com/questions/41356088/set-the-time-for-connections-life-in-golang", "title": "Set the time for connection&#39;s life in Golang", "body": "<p>I am a novice in golang and I am writing a client-server application through the TCP protocol. I need to make a temporary connection, which will close after a couple of seconds. I don't understand how to do that.<br>\nI have a such function, which creates a connection and waits for gob data:</p>\n\n<pre><code>    func net_AcceptAppsList(timesleep time.Duration) {\n        ln, err := net.Listen(\"tcp\", \":\"+conf.PORT)\n        CheckError(err)\n        conn, err := ln.Accept()\n        CheckError(err)\n        dec := gob.NewDecoder(conn)\n        pack := map[string]string{}\n        err = dec.Decode(&amp;pack)\n        fmt.Println(\"Message:\", pack)\n        conn.Close()\n}\n</code></pre>\n\n<p>I need to make this function to wait for data for only some seconds - not forever.</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 3589, "user_id": 337988, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a0929a98013283051149383445c2fad5?s=128&d=identicon&r=PG", "display_name": "philipjkim", "link": "https://stackoverflow.com/users/337988/philipjkim"}, "is_accepted": false, "score": 4, "last_activity_date": 1482904524, "last_edit_date": 1495540803, "creation_date": 1482904178, "answer_id": 41356094, "question_id": 41355847, "link": "https://stackoverflow.com/questions/41355847/how-to-unmarshal-json-in-golang/41356094#41356094", "title": "how to Unmarshal json in golang", "body": "<p>You should export fields (<code>code</code>, <code>msg</code>, <code>data</code>) for <code>Result</code> by capitalizing the first letter of fields (<code>Code</code>, <code>Msg</code>, <code>Data</code>) to access (set/get) them:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Result struct {\n    Code int                    `json:\"code\"`\n    Msg  string                 `json:\"msg\"`\n    Data map[string]interface{} `json:\"data\"`\n}\n\nfunc main() {\n    str := `{\"code\":200,\"msg\":\"success\",\"data\":{\"url\":\"https:\\/\\/mp.weixin.qq.com\\/cgi-bin\\/showqrcode?ticket=gQHQ7jwAAAAAAAAAAS5odHRwOi8vd2VpeGluLnFxLmNvbS9xLzAyX3pqS0pMZlA4a1AxbEJkemhvMVoAAgQ5TGNYAwQsAQAA\"}}`\n    var res Result\n    err := json.Unmarshal([]byte(str), &amp;res)\n    fmt.Println(err)\n    fmt.Println(res)\n}\n</code></pre>\n\n<p>Play the code on <a href=\"https://play.golang.org/p/23ah8e_hCa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/23ah8e_hCa</a></p>\n\n<p>Related question: <a href=\"https://stackoverflow.com/questions/24837432/golang-capitals-in-struct-fields\">Golang - Capitals in struct fields</a></p>\n"}], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1528, "favorite_count": 1, "closed_date": 1482928332, "answer_count": 1, "score": 2, "last_activity_date": 1482906848, "creation_date": 1482902732, "question_id": 41355847, "link": "https://stackoverflow.com/questions/41355847/how-to-unmarshal-json-in-golang", "closed_reason": "Duplicate", "title": "how to Unmarshal json in golang", "body": "<p>I have a json:</p>\n\n<pre><code>{\"code\":200,\n \"msg\":\"success\",\n \"data\":{\"url\":\"https:\\/\\/mp.weixin.qq.com\\/cgi-bin\\/showqrcode?ticket=gQHQ7jwAAAAAAAAAAS5odHRwOi8vd2VpeGluLnFxLmNvbS9xLzAyX3pqS0pMZlA4a1AxbEJkemhvMVoAAgQ5TGNYAwQsAQAA\"}}\n</code></pre>\n\n<p>and i define a struct :</p>\n\n<pre><code>type Result struct {\n    code int\n    msg  string                 `json:\"msg\"`\n    data map[string]interface{} `json:\"data\"`\n}\n</code></pre>\n\n<p>for this code:</p>\n\n<pre><code>var res Result\njson.Unmarshal(body, &amp;res)\nfmt.Println(res)\n</code></pre>\n\n<p>the output is: <code>{0  map[]}</code></p>\n\n<p>i want to get <code>url</code> in <code>data</code>, how to get it?</p>\n"}, {"tags": ["go", "directory", "package"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1482895375, "post_id": 41354700, "comment_id": 69911683, "body": "take a look here: <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">github.com/jteeuwen/go-bindata</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 1, "last_activity_date": 1482900583, "creation_date": 1482900583, "answer_id": 41355518, "question_id": 41354700, "link": "https://stackoverflow.com/questions/41354700/binary-and-additional-files/41355518#41355518", "title": "Binary and additional files", "body": "<p><code>os.Getwd</code> is going to correspond to where you <em>start</em> your binary from not where the binary is located.</p>\n\n<p>To make for a more robust solution I would pass in the location of the files directory using a <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">flag</a> or using a config value.</p>\n"}], "owner": {"reputation": 77, "user_id": 6803922, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/148de7ec8289954fcd634b00556026d0?s=128&d=identicon&r=PG&f=1", "display_name": "Cam.phiefr", "link": "https://stackoverflow.com/users/6803922/cam-phiefr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 41355518, "answer_count": 1, "score": 0, "last_activity_date": 1482919085, "creation_date": 1482893208, "question_id": 41354700, "link": "https://stackoverflow.com/questions/41354700/binary-and-additional-files", "title": "Binary and additional files", "body": "<p>I'm trying to package my go application binary which is accessible by a web interface running on localhost:8080 so that when downloaded it's able to find the JS(front-end) files in the folder where the file is ran but i can't seem to make it work.</p>\n\n<p>I've been doing something like this :</p>\n\n<pre><code>  pwd, err := os.Getwd()\n  if err != nil {\n      fmt.Println(err)\n      os.Exit(1)\n  }\n</code></pre>\n\n<p>Then trying to use the working directory of the binary to access the files inside it but that doesn't seem to work.</p>\n\n<p>The binary is located at : </p>\n\n<p>/Users/admin/Desktop/testappfolder</p>\n\n<p>but when i run the program with just :</p>\n\n<pre><code>pwd, err := os.Getwd()\nif err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n}\nfmt.Println(pwd)\n</code></pre>\n\n<p>I end up getting <code>/Users/admin</code> as the working directory instead.</p>\n\n<p>I wondering :</p>\n\n<p>Where i'm going wrong ?\nIs this has something to do with the Gopath ? \nAm i going at it the right way regarding distributing the app as a \"zip\" and having file path setup directly inside my program relative to the working directory ? or is it that logic that's wrong ?</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 283, "user_id": 2223032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c9fbe6b078012683ca82721dc4284f38?s=128&d=identicon&r=PG", "display_name": "user2223032", "link": "https://stackoverflow.com/users/2223032/user2223032"}, "is_accepted": true, "score": 0, "last_activity_date": 1483172163, "creation_date": 1483172163, "answer_id": 41406661, "question_id": 41354631, "link": "https://stackoverflow.com/questions/41354631/golang-parsing-template-from-third-party-lib/41406661#41406661", "title": "Golang parsing template from third party lib", "body": "<p>One alternative soultion is to copy content from file into a variable and use template.parse instead of template.parsefiles</p>\n"}], "owner": {"reputation": 283, "user_id": 2223032, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c9fbe6b078012683ca82721dc4284f38?s=128&d=identicon&r=PG", "display_name": "user2223032", "link": "https://stackoverflow.com/users/2223032/user2223032"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 41406661, "answer_count": 1, "score": -1, "last_activity_date": 1483172163, "creation_date": 1482892597, "question_id": 41354631, "link": "https://stackoverflow.com/questions/41354631/golang-parsing-template-from-third-party-lib", "title": "Golang parsing template from third party lib", "body": "<p>I am writing a library which is parsing templates from its template package. When I am using it within a sample application its reading the template from its own directory but the code in libary is failing.</p>\n\n<p>Here is the libary - <a href=\"https://github.com/bangarharshit/bigpipe-golang\" rel=\"nofollow noreferrer\">https://github.com/bangarharshit/bigpipe-golang</a> and I am facing issues with this line - <a href=\"https://github.com/bangarharshit/bigpipe-golang/blob/master/Application.go#L66\" rel=\"nofollow noreferrer\">https://github.com/bangarharshit/bigpipe-golang/blob/master/Application.go#L66</a></p>\n\n<p>Copying code from lib - </p>\n\n<pre><code>templates, err := template.ParseFiles(\"templates/bigpipe.html\")\nif err != nil {\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "apache-zookeeper"], "answers": [{"tags": [], "owner": {"reputation": 556, "user_id": 2977686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hmTSA.jpg?s=128&g=1", "display_name": "kext", "link": "https://stackoverflow.com/users/2977686/kext"}, "is_accepted": false, "score": 2, "last_activity_date": 1482888761, "creation_date": 1482888761, "answer_id": 41354230, "question_id": 41354170, "link": "https://stackoverflow.com/questions/41354170/writing-apache-zookeeper-like-service-in-go/41354230#41354230", "title": "Writing Apache Zookeeper like service in go", "body": "<p>Hm, i think you should understand what zookeeper do first, eg. configuration information, naming, providing distributed synchronization , also need to know paxos, and so on.\nplease reference to <a href=\"https://github.com/coreos/etcd\" rel=\"nofollow noreferrer\">etcd</a> on github.</p>\n"}], "owner": {"reputation": 167, "user_id": 1958194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a239d1a6e9c02ca436ffac58fec8d1e?s=128&d=identicon&r=PG", "display_name": "vHalaharvi", "link": "https://stackoverflow.com/users/1958194/vhalaharvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1482903761, "answer_count": 1, "score": -2, "last_activity_date": 1482888761, "creation_date": 1482888194, "question_id": 41354170, "link": "https://stackoverflow.com/questions/41354170/writing-apache-zookeeper-like-service-in-go", "closed_reason": "Needs more focus", "title": "Writing Apache Zookeeper like service in go", "body": "<p>I want to write a very simple (but fully functional) Apache Zookeeper like service in go? Where do I start ? </p>\n"}, {"tags": ["performance", "go", "concurrency", "channel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482886956, "post_id": 41353508, "comment_id": 69910074, "body": "Have you tried just running a blocking profile?"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1482896704, "post_id": 41353508, "comment_id": 69911923, "body": "you can use <code>len()</code> and <code>cap()</code> for channels"}, {"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482938593, "post_id": 41353508, "comment_id": 69931284, "body": "@JimB I&#39;m not clear on what you mean by &quot;a blocking profile&quot;."}, {"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1482938617, "post_id": 41353508, "comment_id": 69931297, "body": "@YandryPozo yup, that one is pretty simple :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482939342, "post_id": 41353508, "comment_id": 69931670, "body": "The pprof package can profile blocking events. Outside of the standard docs, this blog post mentions it too <a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"nofollow noreferrer\">software.intel.com/en-us/blogs/2014/05/10/&hellip;</a>"}, {"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482939672, "post_id": 41353508, "comment_id": 69931847, "body": "@JimB Ah that&#39;s neat! I think pprof would still roll up most stats to the function level, though, which would still be a bit too course grained for what I need here, which is looking at an individual instance of a channel instead of all instances of a function call working on all channels of a given type."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482939857, "post_id": 41353508, "comment_id": 69931971, "body": "Yeah, I thought you were trying to debug a problem, rather than make decisions at runtime."}], "answers": [{"comments": [{"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "edited": false, "score": 0, "creation_date": 1483623841, "post_id": 41383871, "comment_id": 70178267, "body": "Sorry for the late reply.  This would work in the case that the timeout used with the channel is consistently less than the delay time for reading from the channel.  If we want to capture periodic fluctuations in load, we could lean on <a href=\"https://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem\" rel=\"nofollow noreferrer\">nyqist</a> to tell us that our sampling rate needs to be pretty high. In this case we&#39;d be interpreting a discrete stream of chunks as a continuous stream, then discretizing again to sample."}, {"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "edited": false, "score": 0, "creation_date": 1483624194, "post_id": 41383871, "comment_id": 70178542, "body": "Granted, what I said about getting the length of the channel has the same problems. Your solution means we don&#39;t have to use buffered channels just to get an accurate measurement (and everything is a bit more event driven); mine requires a background process to do the sampling but doesn&#39;t have the overhead of the timers.  The timer on yours probably needs to be tied to the estimated time between sends to the channel, which may be hard to calculate in some circumstances.  It may not be the best solution for what I need but it&#39;s definitely a cool idea - thanks!"}], "tags": [], "owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "is_accepted": false, "score": 3, "last_activity_date": 1483151995, "last_edit_date": 1483151995, "creation_date": 1483030159, "answer_id": 41383871, "question_id": 41353508, "link": "https://stackoverflow.com/questions/41353508/how-to-determine-which-side-of-go-channel-is-waiting/41383871#41383871", "title": "How to determine which side of go channel is waiting?", "body": "<p>One way to reach your goal is to use \"bounded send\" and \"bounded receive\" operations\u2014if you're able to come up with reasonable polling timeouts.</p>\n\n<p>When any one of your workers attempts to send a completed result over the channel, don't let it block \"forever\" (until there's space in the channel's buffer); instead, only allow it to block some maximum amount of time. If the timeout occurs before there was space in the channel's buffer, you can react to that condition: count how many times it occurs, adjust future deadlines, throttle or reduce the worker count, and so on.</p>\n\n<p>Similarly, for your \"processor\" receiving results from the workers, you can limit the amount of time it blocks. If the timeout occurs before there was a value available, the processor is starved. Create more workers to feed it more quickly (assuming the workers will benefit from such parallelism).</p>\n\n<p>The downside to this approach is the overhead in <a href=\"https://golang.org/pkg/time/#After\" rel=\"nofollow noreferrer\">creating timers</a> for each <a href=\"https://golang.org/ref/spec#Send_statements\" rel=\"nofollow noreferrer\">send</a> or <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">receive operation</a>.</p>\n\n<p>Sketching, with these declarations accessible to each of your workers:</p>\n\n<pre><code>const minWorkers = 3\nvar workers uint32\n</code></pre>\n\n<p>In each worker goroutine:</p>\n\n<pre><code>atomic.AddUint32(&amp;workers, 1)\nfor {\n    result, ok := produce()\n    if !ok {\n        break\n    }\n    // Detect when channel \"p\"'s buffer is full.\n    select {\n    case p &lt;- result:\n    case &lt;-time.After(500 * time.Millisecond):\n        // Hand over the pending result, no matter how long it takes.\n        p &lt;- result\n        // Reduce worker count if above minimum.\n        if current := atomic.LoadUint32(&amp;workers); current &gt; minWorkers &amp;&amp;\n            atomic.CompareAndSwapUint32(&amp;workers, current, current-1) {\n            return\n        }\n        // Consider whether to try decrementing the working count again\n        // if we're still above the minimum. It's possible another one\n        // of the workers also exited voluntarily, changing the count.\n    }\n}\natomic.AddUint32(&amp;workers, -1)\n</code></pre>\n\n<p>Note that as written above, you could achieve the same effect by timing how long it takes for the send to channel <code>p</code> to complete, and reacting to it having taken too long, as opposed to doing one bounded send followed by a potential blocking send. However, I sketched it that way because I suspect that such code would mature to include logging and instrumentation counter bumps when the timeout expires.</p>\n\n<p>Similarly, in your processor goroutine, you could limit the amount of time you block receiving a value from the workers:</p>\n\n<pre><code>for {\n    select {\n    case result &lt;- p:\n        consume(result)\n    case &lt;-time.After(500 * time.Millisecond):\n        maybeStartAnotherWorker()\n    }\n}\n</code></pre>\n\n<p>Obviously, there are many knobs you can attach to this contraption. You wind up coupling the scheduling of the producers to both the consumer and the producers themselves. Introducing an opaque \"listener\" to which the producers and consumer \"complain\" about delays allows you to break this circular relationship and more easily vary the policy that governs how you react to congestion.</p>\n"}], "owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1483151995, "creation_date": 1482881609, "last_edit_date": 1482896455, "question_id": 41353508, "link": "https://stackoverflow.com/questions/41353508/how-to-determine-which-side-of-go-channel-is-waiting", "title": "How to determine which side of go channel is waiting?", "body": "<p>How do I determine which side of a go channel is waiting on the other side?</p>\n\n<p>I'd like to know this so I can figure out where my processing is being limited and respond by allocating more resources.</p>\n\n<h1>Some options</h1>\n\n<p>The 2 methods I thought of both require something to do a moving average of recorded values so measurements are not too noisy, but that's not a <a href=\"https://github.com/RobinUS2/golang-moving-average\" rel=\"nofollow noreferrer\">big</a> <a href=\"https://github.com/VividCortex/ewma\" rel=\"nofollow noreferrer\">problem</a>.</p>\n\n<hr>\n\n<ol>\n<li>Use a timer to check % of time waiting in consumer</li>\n</ol>\n\n<p>In the case of a single consumer, I can start a timer before consuming from the channel, stopping the timer after I get a record. I can keep track of the % of the time I spend waiting and respond accordingly during each fetch cycle.</p>\n\n<ol start=\"2\">\n<li>Sample length of buffered channel</li>\n</ol>\n\n<p>If the channel is regularly 0, that means we are consuming faster than sending. Similarly if the buffer is full, we're sending faster than we can receive.  We can check the length of the our channel over time to determine what is running slow.</p>\n\n<hr>\n\n<p>Is there a good reason to prefer one of there to another, for performance reasons or otherwise? Is there a simpler solution to this problem?</p>\n\n<h1>Example</h1>\n\n<p>I have a service that is performing <code>N</code> HTTP requests to grab content in up to <code>W</code> goroutines at the same time and sending all that content on a channel to a <code>processor</code> running in a single goroutine, which in turn feeds data back to a client.</p>\n\n<p>Each worker task will result in a large number of messages sent on the channel.  Each <code>worker</code>'s task can take several minutes to complete.</p>\n\n<p>The following diagram summarizes the flow of data with 3 concurrent workers (<code>W=3</code>).</p>\n\n<pre><code>    [worker: task 1] -\n                      \\\n    [worker: task 2] - | --- [ channel ] --- [ processor ] -&gt; [ client ]\n                      /\n    [worker: task 3] -\n</code></pre>\n\n<p>I want to know whether I should run more workers (increase <code>W</code>) or less workers (decrease <code>W</code>) during a request.  This can vary a lot per request since client work over connections of very different speeds.</p>\n"}, {"tags": ["json", "go", "struct", "slice", "literals"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1482874739, "last_edit_date": 1495539963, "creation_date": 1482873632, "answer_id": 41352362, "question_id": 41352295, "link": "https://stackoverflow.com/questions/41352295/golang-cannot-use-as-type-struct-array-or-slice-literal/41352362#41352362", "title": "Golang cannot use as type struct array or slice literal", "body": "<p>Your <code>ContentResp</code> type is a <em>slice</em>, not a struct, yet you're treating it as a struct when you use a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a> trying to create a value of it:</p>\n\n<pre><code>type ContentResp []struct {\n    // ...\n}\n</code></pre>\n\n<p>More precisely it's a slice of a type which is an anonymous struct. Creating values of anonymous structs are unpleasant, so instead you should create (name) a type being only the <code>struct</code>, and use a slice of this, e.g.:</p>\n\n<pre><code>type ContentResp struct {\n    Name        string `json:\"name\"`\n    ContentType string `json:\"type\"`\n    DownloadURL string `json:\"download_url\"`\n}\n\nvar contentResps []ContentResp\n</code></pre>\n\n<p><strong>Further issues:</strong></p>\n\n<p>Let's examine this loop:</p>\n\n<pre><code>for _, cont := range contentResp {\n    append(contentResp, ...)\n}\n</code></pre>\n\n<p>The code above ranges over a slice, and inside it it tries to append elements to the slice. 2 issues with this: <code>append()</code> returns the result which must be stored (it might even have to allocate a new, bigger backing array and copy existing elements over, in which case the result slice will point to a completely different array and the old one should be abandoned). So it should be used like this:</p>\n\n<pre><code>    contentResps = append(contentResps, ...)\n</code></pre>\n\n<p>Second: you shouldn't change the slice you're ranging over. The <code>for ... range</code> evaluates the range expression <em>once</em> (at most), so you changing it (adding elements to it) will have no effect to the iterator code (it will not see the slice header changes).</p>\n\n<p>If you have such a case where you have \"tasks\" to be completed, but during execution new tasks may arise (to be completed, recursively), a channel is a much better solution. See this answer to get a feeling of channels: <a href=\"https://stackoverflow.com/questions/39826692/what-are-golang-channels-used-for/39826883#39826883\">What are golang channels used for?</a></p>\n"}], "owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9089, "favorite_count": 0, "accepted_answer_id": 41352362, "answer_count": 1, "score": 5, "last_activity_date": 1482911281, "creation_date": 1482873221, "last_edit_date": 1482911281, "question_id": 41352295, "link": "https://stackoverflow.com/questions/41352295/golang-cannot-use-as-type-struct-array-or-slice-literal", "title": "Golang cannot use as type struct array or slice literal", "body": "<p>I'm trying to write a function in Go that takes a JSON with URLs of a directory and perform BFS to find files in that directory. When I find a JSON that is a directory, the code makes a URL and should enqueue that URL. When I try to create the struct in the <code>append()</code> in the loop, I get errors.</p>\n\n<pre><code>type ContentResp []struct {\n    Name string `json:\"name\"`\n    ContentType string `json:\"type\"`\n    DownloadURL string `json:\"download_url\"`\n}\n...\n\nvar contentResp ContentResp\nsearch(contentQuery, &amp;contentResp)\n\nfor _, cont := range contentResp {\n        append(contentResp, ContentResp{Name:cont.Name, ContentType:\"dir\", DownloadURL:cont.contentDir.String()})\n}\n\n./bfs.go:129: undefined: Name\n./bfs.go:129: cannot use cont.Name (type string) as type struct { Name string \"json:\\\"name\\\"\"; ContentType string \"json:\\\"type\\\"\"; DownloadURL string \"json:\\\"download_url\\\"\" } in array or slice literal\n./bfs.go:129: undefined: ContentType\n./bfs.go:129: cannot use \"dir\" (type string) as type struct { Name string \"json:\\\"name\\\"\"; ContentType string \"json:\\\"type\\\"\"; DownloadURL string \"json:\\\"download_url\\\"\" } in array or slice literal\n./bfs.go:129: undefined: DownloadURL\n./bfs.go:129: cannot use cont.contentDir.String() (type string) as type struct { Name string \"json:\\\"name\\\"\"; ContentType string \"json:\\\"type\\\"\"; DownloadURL string \"json:\\\"download_url\\\"\" } in array or slice literal  \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1482866276, "post_id": 41350255, "comment_id": 69903540, "body": "look <a href=\"https://maxhalford.github.io/blog/halftoning-1/\" rel=\"nofollow noreferrer\">this</a> article."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4368004, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/333c847aad425113e386336dcf420c83?s=128&d=identicon&r=PG&f=1", "display_name": "CS456", "link": "https://stackoverflow.com/users/4368004/cs456"}, "edited": false, "score": 0, "creation_date": 1482871012, "post_id": 41351595, "comment_id": 69905514, "body": "That&#39;s correct, what I&#39;m struggling with here is how the above code I provided reads in a file when I replace &#39;1&#39; or &#39;2&#39; with say, &quot;file.png&quot; I get an error that states: &#39;non-integer slice index &quot;1.png&quot;&#39;"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 109, "user_id": 4368004, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/333c847aad425113e386336dcf420c83?s=128&d=identicon&r=PG&f=1", "display_name": "CS456", "link": "https://stackoverflow.com/users/4368004/cs456"}, "edited": false, "score": 0, "creation_date": 1482871467, "post_id": 41351595, "comment_id": 69905674, "body": "Are you asking about the Args? &quot; Args hold the command-line arguments, starting with the program name. &quot; I updated my answer, if that is what you&#39;re looking for"}, {"owner": {"reputation": 109, "user_id": 4368004, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/333c847aad425113e386336dcf420c83?s=128&d=identicon&r=PG&f=1", "display_name": "CS456", "link": "https://stackoverflow.com/users/4368004/cs456"}, "edited": false, "score": 0, "creation_date": 1482872118, "post_id": 41351595, "comment_id": 69905930, "body": "Okay, thanks for clarifying, I get that now. I&#39;d rather hard code in the file names as you have, to convert what I&#39;ve provided to what you have, I would just need to change the way the file is inputted?"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 109, "user_id": 4368004, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/333c847aad425113e386336dcf420c83?s=128&d=identicon&r=PG&f=1", "display_name": "CS456", "link": "https://stackoverflow.com/users/4368004/cs456"}, "edited": false, "score": 0, "creation_date": 1482872289, "post_id": 41351595, "comment_id": 69906008, "body": "Yeah, instead of os.Open(os.Args[1]) -- try os.Open(&quot;infile.png&quot;). Make sure the file is in the same directory from which you are running the code."}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 2, "last_activity_date": 1601930719, "last_edit_date": 1601930719, "creation_date": 1482869404, "answer_id": 41351595, "question_id": 41350255, "link": "https://stackoverflow.com/questions/41350255/convert-an-image-to-grayscale-in-go/41351595#41351595", "title": "Convert an image to grayscale in Go", "body": "<p>So as Atomic_alarm pointed out, <a href=\"https://maxhalford.github.io/blog/halftoning-1/\" rel=\"nofollow noreferrer\">https://maxhalford.github.io/blog/halftoning-1/</a> explains how to do this succinctly.</p>\n<p>But you're question, if I understand correctly, is about the file opening and creation?</p>\n<p>The first step is to use the <code>image</code> package to <code>Decode</code> the opened <code>file</code> into an <code>image.Image</code> struct:</p>\n<pre><code>infile, err := os.Open(&quot;fullcolor.png&quot;)\nif err != nil {\n    return nil, err\n}\ndefer infile.Close()\n\nimg, _, err := image.Decode(infile) // img -&gt; image.Image\nif err != nil {\n    return nil, err\n}\n</code></pre>\n<p>With this Go <code>image.Image</code> struct, you can convert it to a grayscaled image, <code>image.Gray</code> and then, finally, write or <em>encode</em> the image onto an outgoing file on the disk:</p>\n<pre><code>outfile, _ := os.Create(&quot;grayscaled.png&quot;)\ndefer outfile.Close()\npng.Encode(outfile, grayscaledImage) // grayscaledImage -&gt; image.Gray\n</code></pre>\n<p>Inbetween the infile opening and outfile creating, you have to, of course, convert the image to grayscale. Again, try the link above, and you'll find this function, which takes an <code>image.Image</code> and returns a pointer to a  <code>image.Gray</code>:</p>\n<pre><code>func rgbaToGray(img image.Image) *image.Gray {\n    var (\n        bounds = img.Bounds()\n        gray   = image.NewGray(bounds)\n    )\n    for x := 0; x &lt; bounds.Max.X; x++ {\n        for y := 0; y &lt; bounds.Max.Y; y++ {\n            var rgba = img.At(x, y)\n            gray.Set(x, y, rgba)\n        }\n    }\n    return gray\n}\n</code></pre>\n<p>Concerning the code you provided (and your comment), you were opening a file with <code>os.Args[1]</code>, and creating the file <code>os.Args[2]</code>. <code>os.Args</code> is a slice of arguments passed when running the program, <code>0</code> will always be the program itself (<code>main</code>), and whatever follows will with <code>1</code>, <code>2</code>, etc. The docs states:</p>\n<blockquote>\n<p>Args hold the command-line arguments, starting with the program name.\n<code>var Args []string</code></p>\n</blockquote>\n<p>so you would run your code above like this:</p>\n<pre><code>$ go run main.go infile.png outfile.png\n</code></pre>\n<p>infile.png must to be a file on disk (inside the directory you are running the code from, or the complete path to file).</p>\n<p>What I have provide above doesn't use <code>os.Args</code> but rather <em>hard codes</em> the file names into the program.</p>\n"}], "owner": {"reputation": 109, "user_id": 4368004, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/333c847aad425113e386336dcf420c83?s=128&d=identicon&r=PG&f=1", "display_name": "CS456", "link": "https://stackoverflow.com/users/4368004/cs456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1754, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1601930719, "creation_date": 1482862998, "last_edit_date": 1482871073, "question_id": 41350255, "link": "https://stackoverflow.com/questions/41350255/convert-an-image-to-grayscale-in-go", "title": "Convert an image to grayscale in Go", "body": "<p>I'm trying to convert an image to grayscale using Go.</p>\n\n<p>I've found the below code, however, I'm struggling to understand it. </p>\n\n<p>It would be extremely helpful if you could explain what each function is doing and where to define the incoming and outgoing file. </p>\n\n<pre><code>package main\n\nimport (\n    \"image\"\n    _ \"image/jpeg\" // Register JPEG format\n    \"image/png\"    // Register PNG  format\n    \"image/color\"\n    \"log\"\n    \"os\"\n)\n\n// Converted implements image.Image, so you can\n// pretend that it is the converted image.\ntype Converted struct {\n    Img image.Image\n    Mod color.Model\n}\n\n// We return the new color model...\nfunc (c *Converted) ColorModel() color.Model{\n    return c.Mod\n}\n\n// ... but the original bounds\nfunc (c *Converted) Bounds() image.Rectangle{\n    return c.Img.Bounds()\n}\n\n// At forwards the call to the original image and\n// then asks the color model to convert it.\nfunc (c *Converted) At(x, y int) color.Color{\n    return c.Mod.Convert(c.Img.At(x,y))\n}\n\nfunc main() {\n    if len(os.Args) != 3 { log.Fatalln(\"Needs two arguments\")}\n    infile, err := os.Open(os.Args[1])\n    if err != nil {\n        log.Fatalln(err)\n    }\n    defer infile.Close()\n\n    img, _, err := image.Decode(infile)\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    // Since Converted implements image, this is now a grayscale image\n    gr := &amp;Converted{img, color.GrayModel}\n    // Or do something like this to convert it into a black and\n    // white image.\n    // bw := []color.Color{color.Black,color.White}\n    // gr := &amp;Converted{img, color.Palette(bw)}\n\n\n    outfile, err := os.Create(os.Args[2])\n    if err != nil {\n        log.Fatalln(err)\n    }\n    defer outfile.Close()\n\n    png.Encode(outfile,gr)\n}\n</code></pre>\n\n<p>I'm quite new to Go so any suggestions or help would be appreciated.</p>\n"}, {"tags": [".net", "go"], "comments": [{"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1482861861, "post_id": 41349782, "comment_id": 69901638, "body": "Regarding concurrency, no, there&#39;s nothing preventing that. Go concurrency is a subset of .NET concurrency."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1482905125, "post_id": 41349782, "comment_id": 69914159, "body": "0) The claim &quot;.net framework was designed to support languages of all flavors&quot; is a very bold one, and should be taken with several ounces of salt. First of all, .NET 1.0 was merely created to displace Java on Windows Desktop where MS has problems interacting with Sun back then. Hence .NET has certain birth traumas which stem directly from this initial goal. Actually if you&#39;ll look at C# 2.0 you&#39;ll see it also dutifully implements most of Java warts. Hence .NET was created to support OO-languages based on Java-like ideas."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1482905543, "post_id": 41349782, "comment_id": 69914303, "body": "1) Yes; 2) Yes but see #4; 3) Probably yes; 4) That one is hard to answer definitely. The chief difference in concurrency between .NET and Go is very well explained <a href=\"http://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/\" rel=\"nofollow noreferrer\">here</a>. Go has support for concurrency in its runtime by having separate stacks for its goroutines and the scheduler which kicks in completely transparently to the goroutine at certain key point of its execution--naturally when it&#39;s about to stall on an I/O operation. Conversely, <code>async&#47;await</code> of .NET involve splitting of functions at each <code>await</code> they do."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1482905818, "post_id": 41349782, "comment_id": 69914411, "body": "So yes, it should definitely be possible to utilize the .NET core to simulate the behaviour of the Go runtime but these worlds are different enough, so only simulation is possible--not sort of direct mapping of concepts. 5) I think this one is next to impossible to achieve. First, I doubt this concept exist in Go &quot;as is&quot;--up until v1.7 I would say: Go probrams built by its reference tool stack are static, and libraries were AFAIK explicitly not designed as being &quot;shippable&quot;: you were supposed to (re)build them as needed from the source code. Go 1.7 introduced support for &quot;shippable&quot; libraries"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1482906027, "post_id": 41349782, "comment_id": 69914478, "body": "on certain platforms, and Go 1.8 will have certain support for &quot;plugin-style&quot; libraries which can be dynamically loaded. This all definitely makes the idea of ABI existing but the next roadblock in implementing it would be the fact Go is compiled down to machine level--not to some sort of IL like .NET does. Hence there is a distinct ABI for each supported H/W architecture (and supposedly also Go version), and it&#39;s defined in terms of calling conventions involving CPU registers and all that. I&#39;m afraid implementing this would require working through the interop level of .NET (P/Invoke),"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1482906182, "post_id": 41349782, "comment_id": 69914554, "body": "and I&#39;m afraid that one might make broad assumptions about what it can call (and what it&#39;s able to export)--as .NET&#39;s P/Invoke was IMO primarily designed to introperate with libraries written in C, C++, Pascal et all with the support of several &quot;well-known in x86&quot; calling conventions. Dunno whether it will be able to cut what Go uses as ABI."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1482906379, "post_id": 41349782, "comment_id": 69914638, "body": "All-in-all, I don&#39;t really see a point in making Go available on .NET except for its nice syntax. If we forget about interop and assume all the Go-native libraries we&#39;d like to use are available with its source code and can be compiled with that imaginary Go.NET compiler, that could possibly work if there would be a reasonably seamless way to call .NET libs from such Go programs. This one is the most interesting topic but it&#39;s absolutely not fit for SO. I&#39;d hence recommend bring this question up on the <a href=\"https://groups.google.com/forum/#!forum/golang-nuts\" rel=\"nofollow noreferrer\">Go mailing list</a> ;-)"}, {"owner": {"reputation": 4298, "user_id": 90291, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886949252e28d35e5e09ba74c0ccfa26?s=128&d=identicon&r=PG&f=1", "display_name": "bright", "link": "https://stackoverflow.com/users/90291/bright"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1482915150, "post_id": 41349782, "comment_id": 69918336, "body": "@kostix, Thanks. There&#39;s a very good reason for running Go (or any other language) on .net - code reuse in both directions. It enables Go apps to reuse the vast ecosystem of .net libraries, and vice versa. It also permits .net apps an eventual migration path to Go that does not require everything to be rewritten overnight. That&#39;s much more than nice syntax, although syntax is a good reason for choosing Go in the first place."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1482916444, "post_id": 41349782, "comment_id": 69919041, "body": "I&#39;m afraid you might be missing one &quot;devops&quot; point here:people writing in Go usually value its ease of deployment. Sure .NET also touts &quot;xcopy deployment&quot; but it implies .NET of a required version is installed on the target machine. This might be perfectly sensible in Windows world but much less so in other OS domains where .NET core and related technologies &quot;are not there yet&quot;. And there is the question of performance (expectations when moving from &quot;native&quot; to &quot;hosted&quot; Go) and tooling etc. Gradual rewrites are another thing; I tend to agree on this point."}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1482940832, "post_id": 41349782, "comment_id": 69932519, "body": "Go interop with .NET is not possible without breaking Go&#39;s concurrency model. It <i>depends</i> on things like synchronization primitives and OS threads <i>not</i> being available."}, {"owner": {"reputation": 4298, "user_id": 90291, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886949252e28d35e5e09ba74c0ccfa26?s=128&d=identicon&r=PG&f=1", "display_name": "bright", "link": "https://stackoverflow.com/users/90291/bright"}, "reply_to_user": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1483014209, "post_id": 41349782, "comment_id": 69961064, "body": "@StephenCleary, are you referring to &quot;shoot yourself in the foot&quot; scenarios? Misuse of Go pointers is already in that category, so that isn&#39;t necessarily a blocker, do you agree?"}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1483023955, "post_id": 41349782, "comment_id": 69966390, "body": "@bright: No, I mean that Go&#39;s concurrency model only works if it&#39;s the <i>only</i> concurrency model. It would fall apart if you tried to combine it with another concurrency model."}, {"owner": {"reputation": 4298, "user_id": 90291, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886949252e28d35e5e09ba74c0ccfa26?s=128&d=identicon&r=PG&f=1", "display_name": "bright", "link": "https://stackoverflow.com/users/90291/bright"}, "reply_to_user": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1483116958, "post_id": 41349782, "comment_id": 70001438, "body": "@StephenCleary, is that really so? As an extreme case, a Go process coexists with other processes in the OS, so one could visualize a process barrier between the rest of .net and Go. I&#39;m not saying that&#39;s the way to go, but it&#39;s a starting point in thinking about the isolation Go types need from other code running in the CLR, and whether CLR changes are needed or whether the Go semantics can be represented with the existing opcodes."}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1483185541, "post_id": 41349782, "comment_id": 70019050, "body": "@bright: What I&#39;m saying is that you can&#39;t, e.g., have a thread in the Go world lock on a Win32 OS Mutex. It would prevent Go&#39;s concurrency from working. Thus, a Go system would have to be in its own world, without .NET interop (direct calls). They&#39;d have to be made into remote non-blocking calls."}], "owner": {"reputation": 4298, "user_id": 90291, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886949252e28d35e5e09ba74c0ccfa26?s=128&d=identicon&r=PG&f=1", "display_name": "bright", "link": "https://stackoverflow.com/users/90291/bright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 1, "closed_date": 1482872865, "answer_count": 0, "score": 4, "last_activity_date": 1482861379, "creation_date": 1482860903, "last_edit_date": 1482861379, "question_id": 41349782, "link": "https://stackoverflow.com/questions/41349782/can-go-be-reasonably-implemented-on-the-net-framework", "closed_reason": "Needs more focus", "title": "Can Go be reasonably implemented on the .net framework?", "body": "<p>Given that the .net framework was designed to support languages of all flavors, can Go be implemented with full fidelity on it? While both are managed, there seem to be many unique aspects to Go compared to the languages currently supported by .net, including:</p>\n\n<ol>\n<li>Go's automatic management of stack vs heap variables.</li>\n<li>Channels</li>\n<li>Packages as an intrinsic part of Go</li>\n<li>Go's concurrency vs .net's Async/await</li>\n<li>Go's ABI</li>\n</ol>\n\n<p>Do any of these (or any other factors) prevent a full-featured Go from being written on top of the .net framework?</p>\n\n<p>This question is to help me understand of the differences between Go and the .net framework at the most basic levels.</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 2, "creation_date": 1482855690, "post_id": 41348512, "comment_id": 69898810, "body": "How do you know later what the type is? I don&#39;t think there is a way to leave it as an unknown protobuf message but you could try leaving it as a byte array and then later desearlizing it with the protobuf library."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1482868285, "post_id": 41348512, "comment_id": 69904336, "body": "It sounds like you know what the universe of message types is but you don&#39;t know what particular message you&#39;re getting when you get a message. If that&#39;s the case, you should have one message definition that contains all the message types you can receive along with a message type field that tells you what type the message is."}], "owner": {"reputation": 4200, "user_id": 258011, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/82890582bc10ffebe1ae4c7127effa01?s=128&d=identicon&r=PG", "display_name": "gucki", "link": "https://stackoverflow.com/users/258011/gucki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1544, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482855261, "creation_date": 1482855261, "question_id": 41348512, "link": "https://stackoverflow.com/questions/41348512/protobuf-unmarshal-unknown-message", "title": "protobuf unmarshal unknown message", "body": "<p>I have a listener which receives protobuf messages. However it doesn't know which type of message comes in when. So I tried to unmarshal into an <code>interface{}</code> so I can later type cast:</p>\n\n<pre><code>var data interface{}\nerr := proto.Unmarshal(message, data)\nif err != nil {\n  log.Fatal(\"unmarshaling error: \", err)\n}\nlog.Printf(\"%v\\n\", data)\n</code></pre>\n\n<p>However this code doesn't compile:</p>\n\n<pre><code>cannot use data (type interface {}) as type proto.Message in argument to proto.Unmarshal:\n  interface {} does not implement proto.Message (missing ProtoMessage method)\n</code></pre>\n\n<p>How can I unmarshal and later type cast an \"unknown\" protobuf message in go?</p>\n"}, {"tags": ["go", "panic"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1482851913, "post_id": 41347423, "comment_id": 69897105, "body": "<code>os.Args</code> holds what was passed to your program on its command line. You&#39;re supposedly intend to open a file which name was interactively input by the user and ended up in the variable named &quot;input&quot;. Why the heck don&#39;t you attempt to use it as the name of the file to input?"}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1482852034, "post_id": 41347423, "comment_id": 69897150, "body": "to request the user"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1482852158, "post_id": 41347423, "comment_id": 69897217, "body": "Uh.... what? I cannot make sense of this."}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1482853289, "post_id": 41347423, "comment_id": 69897710, "body": "oh sorry, i have just understand what you mean -_-&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482851457, "post_id": 41347565, "comment_id": 69896894, "body": "with that on the request I got:"}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482851818, "post_id": 41347565, "comment_id": 69897056, "body": "go run gocat2.go Which file would you like to read?: ~/bob ~/bobpanic: runtime error: index out of range gorountine 1 [running]: panic(0x4...) /usr/lib/go/src/runtime/panic.go:500 +0x1a main.main() /home/user/git/go/gocat2/gocat2.go:22 +0x4ba exist status 2"}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482852217, "post_id": 41347565, "comment_id": 69897248, "body": "sounds better but the output is not just fine .. now get: go run gocat2.go Which file would you like to read?: ~/bob ~/bob2016/12/27 16:23.10 my program broken exit status 1"}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482852355, "post_id": 41347565, "comment_id": 69897314, "body": "and if i specify the /home/user/ it produce an output like: /home/user/bobinput%!(EXTRA []uint8=[104 109 109 32 104 109 109 10])"}, {"owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "reply_to_user": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482852657, "post_id": 41347565, "comment_id": 69897468, "body": "@aurelien just input the file name, and use <code>fmt.Printf(&quot;input %s&quot;, bs)</code> to print the text file."}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482853114, "post_id": 41347565, "comment_id": 69897643, "body": "this produce: ~/bob2016/12/27 16:38:08 my program broken exit status 1"}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482853372, "post_id": 41347565, "comment_id": 69897743, "body": "and with the /home/user/bob with just %s and/or with input %s it produce an output with not just the response but the input and the output"}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482916529, "post_id": 41347565, "comment_id": 69919088, "body": "That was that + the point that there is a line too much with a print output of the input on fmt.Print(input) that should not be and produce the + input line on output"}], "tags": [], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "is_accepted": false, "score": 1, "last_activity_date": 1482852026, "last_edit_date": 1482852026, "creation_date": 1482851333, "answer_id": 41347565, "question_id": 41347423, "link": "https://stackoverflow.com/questions/41347423/correct-on-input-but-panic-on-output-in-golang/41347565#41347565", "title": "Correct on input but panic on output in golang", "body": "<p>not <code>os.Open(os.Args[1])</code>, <code>Args[1]</code> is out of range. you should open the file you input like this:</p>\n\n<pre><code>f, err := os.Open(input)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482854714, "post_id": 41348032, "comment_id": 69898361, "body": "the output produce the input + the output but i need just the output (that if i give the full directories information, but I wish to use ~/ for user and that give back that the program is broken"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482856039, "post_id": 41348032, "comment_id": 69898978, "body": "Removing the input will be easy just remove it from the <code>Printf</code> statement. <code>fmt.Printf(&quot;%s&quot;, string(bs))</code> using the <code>~</code> short cut will add a little bit of programming. You could check if the first character is a <code>~</code> and if it is get the <code>$HOME</code> env variable using <a href=\"https://golang.org/pkg/os/#Getenv\" rel=\"nofollow noreferrer\"><code>os.Getenv</code></a> then construct your path with  <code>$HOME</code>"}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482856202, "post_id": 41348032, "comment_id": 69899060, "body": "nop that produce an error on ~/bob and an input+output on output on /home/user/bob"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482858050, "post_id": 41348032, "comment_id": 69899905, "body": "Not quite sure what you mean. What was the error? Is <code>&#47;home&#47;user&#47;bob</code> a file that can be read?"}, {"owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "edited": false, "score": 0, "creation_date": 1482860794, "post_id": 41348032, "comment_id": 69901121, "body": "cat ~/bob read just fine but not go run gocat.go then after the request ~/bob"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 3, "last_activity_date": 1482858808, "last_edit_date": 1482858808, "creation_date": 1482853222, "answer_id": 41348032, "question_id": 41347423, "link": "https://stackoverflow.com/questions/41347423/correct-on-input-but-panic-on-output-in-golang/41348032#41348032", "title": "Correct on input but panic on output in golang", "body": "<p>I imagine you found some examples online and don't quite understand what is going on. </p>\n\n<p>From the <a href=\"https://golang.org/pkg/os/\" rel=\"nofollow noreferrer\"><code>os</code></a> package's documentation.</p>\n\n<blockquote>\n  <p>Args hold the command-line arguments, starting with the program name.</p>\n</blockquote>\n\n<p>Since you started your program without any arguments and <code>os.Args</code> is a slice, the program panics when you access out of the slice's bounds. (Like trying to access an element of any array that does not exist)</p>\n\n<p>It looks like you are trying to prompt for the input here</p>\n\n<pre><code>var input string\nfmt.Scanln(&amp;input)\nfmt.Print(input)\n</code></pre>\n\n<p>All you need to do is replace</p>\n\n<pre><code>f, err := os.Open(os.Args[1])\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>f, err := os.Open(input)\n</code></pre>\n\n<p>Your last print statement is also incorrect.</p>\n\n<p>It should be:</p>\n\n<pre><code>// part to print the output\nfmt.Printf(\"input \\n %s\", string(bs))\n</code></pre>\n\n<p>You need to cast <code>bs</code> which is currently <code>[]byte</code> to a <code>string</code> and you need to add <code>%s</code> to indicate to <code>fmt.Printf</code> where <code>string(bs)</code> should be placed in the format string</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 9204155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bfc9f76325d1079a4cde3dd48fc2f1?s=128&d=identicon&r=PG&f=1", "display_name": "Uncle Bob", "link": "https://stackoverflow.com/users/9204155/uncle-bob"}, "is_accepted": true, "score": 1, "last_activity_date": 1516113388, "creation_date": 1516113388, "answer_id": 48283660, "question_id": 41347423, "link": "https://stackoverflow.com/questions/41347423/correct-on-input-but-panic-on-output-in-golang/48283660#48283660", "title": "Correct on input but panic on output in golang", "body": "<p>You use <code>=</code> rather than <code>:=</code>\nSo here is from where your error comes from.</p>\n"}], "owner": {"reputation": 384, "user_id": 4255909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msCBN.png?s=128&g=1", "display_name": "aurelien", "link": "https://stackoverflow.com/users/4255909/aurelien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 1, "accepted_answer_id": 48283660, "answer_count": 3, "score": 0, "last_activity_date": 1516113388, "creation_date": 1482850627, "question_id": 41347423, "link": "https://stackoverflow.com/questions/41347423/correct-on-input-but-panic-on-output-in-golang", "title": "Correct on input but panic on output in golang", "body": "<p>Trying to write a bit of go, I would like to create a sort of cat function in Golang:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"os\"\n        \"io/ioutil\"\n        \"log\"\n)\n\nfunc main() {\n        // part to ask the question and get the input\n        fmt.Print(\"Which file would you like to read?: \")\n        var input string\n        fmt.Scanln(&amp;input)\n        fmt.Print(input)\n\n        // part to give the output\n        f, err := os.Open(os.Args[1]) // Open the file                                       \n        if err != nil {\n                log.Fatalln(\"my program broken\")\n        }\n\n        defer f.Close() // Always close things open                                          \n\n        bs, err := ioutil.ReadAll(f)\n        if err != nil {\n                log.Fatalln(\"my program broken\")\n        }\n\n        // part to print the output\n        fmt.Printf(\"input\", bs) // %s convert directly in string the result                  \n\n}\n</code></pre>\n\n<p>But I get a go panic on execution and do not find more explicit information.</p>\n\n<p>What I have done wrong?</p>\n\n<p>How can I get more information about that error from the terminal?</p>\n\n<blockquote>\n  <p>$\n   go run gocat.go Which file would you like to read?: gocat.go\n  gocat.gopanic: runtime error: index out of range</p>\n  \n  <p>goroutine 1 [running]: panic(0x4b1840, 0xc42000a0e0)\n  /usr/lib/go/src/runtime/panic.go:500 +0x1a1 main.main()\n  /home/user/git/go-experimentations/gocat/gocat.go:23 +0x4ba exit\n  status 2</p>\n</blockquote>\n"}, {"tags": ["go", "google-calendar-api"], "comments": [{"owner": {"reputation": 11, "user_id": 2934552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed1c6250e7669a9b151660bd41cb6d81?s=128&d=identicon&r=PG&f=1", "display_name": "hungpk", "link": "https://stackoverflow.com/users/2934552/hungpk"}, "edited": false, "score": 1, "creation_date": 1482877825, "post_id": 41344074, "comment_id": 69907900, "body": "I found solution. We must add  <code>ForceSendFields: []string{&quot;UseDefault&quot;}, </code> after UseDefault: false, because they think false value is empty value and they didn&#39;t send it to server: <a href=\"https://godoc.org/google.golang.org/api/calendar/v3#EventReminders\" rel=\"nofollow noreferrer\">godoc.org/google.golang.org/api/calendar/v3#EventReminders</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2934552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed1c6250e7669a9b151660bd41cb6d81?s=128&d=identicon&r=PG&f=1", "display_name": "hungpk", "link": "https://stackoverflow.com/users/2934552/hungpk"}, "edited": false, "score": 0, "creation_date": 1482874729, "post_id": 41351666, "comment_id": 69906908, "body": "Thanks for your answer."}, {"owner": {"reputation": 11, "user_id": 2934552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed1c6250e7669a9b151660bd41cb6d81?s=128&d=identicon&r=PG&f=1", "display_name": "hungpk", "link": "https://stackoverflow.com/users/2934552/hungpk"}, "edited": false, "score": 1, "creation_date": 1482875241, "post_id": 41351666, "comment_id": 69907069, "body": "In Go, default value of bool is false so UserDefault value always false when we didn&#39;t specify it. In this sample code, we must set false for UserDefault: <a href=\"https://developers.google.com/google-apps/calendar/create-events\" rel=\"nofollow noreferrer\">developers.google.com/google-apps/calendar/create-events</a>. I don&#39;t know why google removed reminder sample code in Go part. You can see it in Java or PHP part."}], "tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": false, "score": 1, "last_activity_date": 1482869794, "creation_date": 1482869794, "answer_id": 41351666, "question_id": 41344074, "link": "https://stackoverflow.com/questions/41344074/add-reminder-on-google-calendar-with-golang/41351666#41351666", "title": "Add reminder on google calendar with golang", "body": "<p>Based on my reading of <a href=\"https://developers.google.com/google-apps/calendar/concepts/reminders\" rel=\"nofollow noreferrer\">google-apps/calendar/concepts/reminders</a>, it seems that you should not specify the <code>UseDefault: false,</code> at the same time as setting the <code>Overrides</code>.  Do not put the <code>UseDefault: false,</code> part, and it will be defaulting to false as its only required to set when wanting to remove overrides that are in place already.</p>\n\n<p>So the expected code is:</p>\n\n<pre><code>event := &amp;calendar.Event{\n    Summary:     \"Test GG calendar\",\n    Location:    \"31 AAA\",\n    Description: \"Test google calendar\",\n    Start: &amp;calendar.EventDateTime{\n        DateTime: \"2016-12-27T17:30:00+07:00\",\n        TimeZone: \"Asia/Ho_Chi_Minh\",\n    },\n    End: &amp;calendar.EventDateTime{\n        DateTime: \"2016-12-27T17:40:00+07:00\",\n        TimeZone: \"Asia/Ho_Chi_Minh\",\n    },\n    Reminders: &amp;calendar.EventReminders{\n        Overrides: []*calendar.EventReminder{\n            {Method: \"email\", Minutes: 30},\n            {Method: \"popup\", Minutes: 10},\n        },\n    },\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5370753, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eaWRdZeS2Cw/AAAAAAAAAAI/AAAAAAAARQk/QiDVGAdHZrI/photo.jpg?sz=128", "display_name": "Nicki Feathers", "link": "https://stackoverflow.com/users/5370753/nicki-feathers"}, "is_accepted": false, "score": 0, "last_activity_date": 1608830470, "creation_date": 1608830470, "answer_id": 65441406, "question_id": 41344074, "link": "https://stackoverflow.com/questions/41344074/add-reminder-on-google-calendar-with-golang/65441406#65441406", "title": "Add reminder on google calendar with golang", "body": "<p>You should send <code>ForceSendFields</code> with <code>UseDefault</code> and set <code>UseDefault</code> to <code>false</code></p>\n<pre><code>&amp;calendar.EventReminders{\n    Overrides: []*calendar.EventReminder{\n        {\n            Method:  &quot;email&quot;,\n            Minutes: 12,\n        },\n    },\n    UseDefault:      false,\n    ForceSendFields: []string{&quot;UseDefault&quot;},\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2934552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed1c6250e7669a9b151660bd41cb6d81?s=128&d=identicon&r=PG&f=1", "display_name": "hungpk", "link": "https://stackoverflow.com/users/2934552/hungpk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1096, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1608830470, "creation_date": 1482837075, "question_id": 41344074, "link": "https://stackoverflow.com/questions/41344074/add-reminder-on-google-calendar-with-golang", "title": "Add reminder on google calendar with golang", "body": "<p>I want to add a custom reminder to Google Calendar with golang:</p>\n\n<pre><code>event := &amp;calendar.Event{\n    Summary:     \"Test GG calendar\",\n    Location:    \"31 AAA\",\n    Description: \"Test google calendar\",\n    Start: &amp;calendar.EventDateTime{\n        DateTime: \"2016-12-27T17:30:00+07:00\",\n        TimeZone: \"Asia/Ho_Chi_Minh\",\n    },\n    End: &amp;calendar.EventDateTime{\n        DateTime: \"2016-12-27T17:40:00+07:00\",\n        TimeZone: \"Asia/Ho_Chi_Minh\",\n    },\n    Reminders: &amp;calendar.EventReminders{\n        Overrides: []*calendar.EventReminder{\n            {Method: \"email\", Minutes: 30},\n            {Method: \"popup\", Minutes: 10},\n        },\n        UseDefault: false,\n    },\n}\n</code></pre>\n\n<p>When I run this code, google could not add event. I received this error: Unable to create event. googleapi: Error 400: Cannot specify both default reminders and overrides at the same time., cannotUseDefaultRemindersAndSpecifyOverride</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "docker", "websocket"], "comments": [{"owner": {"reputation": 716, "user_id": 1032294, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/7em4L.jpg?s=128&g=1", "display_name": "Wang Ruiqi", "link": "https://stackoverflow.com/users/1032294/wang-ruiqi"}, "edited": false, "score": 0, "creation_date": 1482836295, "post_id": 41342097, "comment_id": 69901266, "body": "Maybe is the DNS server does not work. You can enter your docker container , ping google.com or ping 192.168.1.4 to see anything wrong"}, {"owner": {"reputation": 508, "user_id": 936052, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/35791690683d0f5626b2ce342c1d2bbb?s=128&d=identicon&r=PG", "display_name": "Nexus2020", "link": "https://stackoverflow.com/users/936052/nexus2020"}, "reply_to_user": {"reputation": 716, "user_id": 1032294, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/7em4L.jpg?s=128&g=1", "display_name": "Wang Ruiqi", "link": "https://stackoverflow.com/users/1032294/wang-ruiqi"}, "edited": false, "score": 0, "creation_date": 1483071070, "post_id": 41342097, "comment_id": 69983139, "body": "I checked, it can ping outside"}, {"owner": {"reputation": 2386, "user_id": 1903672, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/8yjVe.jpg?s=128&g=1", "display_name": "Yuyutsu", "link": "https://stackoverflow.com/users/1903672/yuyutsu"}, "edited": false, "score": 0, "creation_date": 1580993394, "post_id": 41342097, "comment_id": 106285876, "body": "Hi @Nexus2020 do you find any solution for this?"}], "owner": {"reputation": 508, "user_id": 936052, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/35791690683d0f5626b2ce342c1d2bbb?s=128&d=identicon&r=PG", "display_name": "Nexus2020", "link": "https://stackoverflow.com/users/936052/nexus2020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482836295, "creation_date": 1482829537, "question_id": 41342097, "link": "https://stackoverflow.com/questions/41342097/golang-websocket-server-on-docker-container-wont-send-out-message-to-outside-wo", "title": "Golang websocket server on docker container won&#39;t send out message to outside world", "body": "<p>I have a golang backend, node frontend. And it worked both on windows and ubuntu without docker. Now I am trying to dockerize everything. I put both backend and frontend in the same docker container. I can establish initial connection but later the backend kept throwing error like this: <a href=\"https://i.stack.imgur.com/5gl4H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5gl4H.png\" alt=\"Error message printed by golang\"></a></p>\n\n<p>I have exposed port 8000 to 8004, the ws port is 8000 and frontend port is 8004. I have tried both --net=host as well as exposing everything as host ip address 192.168.1.4. Non of them worked.</p>\n\n<p>On the browser side, the websocket client always get 101 response like this:\n<a href=\"https://i.stack.imgur.com/I1boX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I1boX.png\" alt=\"Screenshot from chrome\"></a></p>\n\n<p>I think it could be a config problem on docker. But I have no lead right now on how to deal with this. The browser tested is Chrome 55 on windows 10. Docker, golang and node are of the latest. The host machine is on Ubuntu 16.10 as well as container os.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 696, "user_id": 1856086, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/edb72c51ff89eddf7e9d7a274cfd81fe?s=128&d=identicon&r=PG&f=1", "display_name": "Stas Makarov", "link": "https://stackoverflow.com/users/1856086/stas-makarov"}, "is_accepted": false, "score": 7, "last_activity_date": 1483000102, "last_edit_date": 1483000102, "creation_date": 1482828332, "answer_id": 41341824, "question_id": 41341682, "link": "https://stackoverflow.com/questions/41341682/how-to-replace-multiple-slashes-in-a-string-to-one-slash-in-go-lang/41341824#41341824", "title": "How to replace multiple slashes (///) in a string to one slash (/) in Go lang?", "body": "<p>You can use <a href=\"https://golang.org/pkg/path/#Clean\" rel=\"nofollow noreferrer\"><code>path.Clean</code></a> for that.</p>\n\n<blockquote>\n<pre><code>func Clean(path string) string\n</code></pre>\n  \n  <p>Clean returns the shortest path name equivalent to path by purely lexical processing. It applies the following rules iteratively until no further processing can be done:</p>\n  \n  <ol>\n  <li>Replace multiple slashes with a single slash.</li>\n  <li>Eliminate each . path name element (the current directory).</li>\n  <li>Eliminate each inner .. path name element (the parent directory)\n  along with the non-.. element that precedes it.</li>\n  <li>Eliminate .. elements that begin a rooted path:\n  that is, replace \"/..\" by \"/\" at the beginning of a path.\n  The returned path ends in a slash only if it is the root \"/\".</li>\n  </ol>\n  \n  <p>If the result of this process is an empty string, Clean returns the string \".\".</p>\n</blockquote>\n\n<p>And here's a simple benchmark which compares it with regexp solution: </p>\n\n<pre><code>package main\n\nimport (\n    \"path\"\n    \"regexp\"\n    \"testing\"\n)\n\nvar p = \"///hello//stackover.flow\"\n\nfunc BenchmarkPathRegexp(b *testing.B) {\n    re := regexp.MustCompile(\"/+\")\n    for i := 0; i &lt; b.N; i++ {\n        re.ReplaceAllLiteralString(p, \"/\")\n    }\n}\n\nfunc BenchmarkPathClean(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        path.Clean(p)\n    }\n}\n</code></pre>\n\n<p>Results: </p>\n\n<pre><code>BenchmarkPathRegexp-4        2000000           794 ns/op\nBenchmarkPathClean-4        10000000           145 ns/op\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 1511725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4342adb5363651ea41edc1082902ea20?s=128&d=identicon&r=PG", "display_name": "Sergei Ten", "link": "https://stackoverflow.com/users/1511725/sergei-ten"}, "is_accepted": true, "score": 1, "last_activity_date": 1482829656, "creation_date": 1482829656, "answer_id": 41342123, "question_id": 41341682, "link": "https://stackoverflow.com/questions/41341682/how-to-replace-multiple-slashes-in-a-string-to-one-slash-in-go-lang/41342123#41342123", "title": "How to replace multiple slashes (///) in a string to one slash (/) in Go lang?", "body": "<p>Just an option. You can use it if you need to replace some other multiple characters.</p>\n\n<pre><code>re, _ := regexp.Compile(\"/+\")\n\nfmt.Println(re.ReplaceAllLiteralString(\"///hello//stackover.flow\", \"/\"))\n</code></pre>\n"}], "owner": {"reputation": 950, "user_id": 3803062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1406df89029fd0b63367a9dda17d3fcb?s=128&d=identicon&r=PG&f=1", "display_name": "Ark", "link": "https://stackoverflow.com/users/3803062/ark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1688, "favorite_count": 0, "accepted_answer_id": 41342123, "answer_count": 2, "score": 1, "last_activity_date": 1483000102, "creation_date": 1482827754, "question_id": 41341682, "link": "https://stackoverflow.com/questions/41341682/how-to-replace-multiple-slashes-in-a-string-to-one-slash-in-go-lang", "title": "How to replace multiple slashes (///) in a string to one slash (/) in Go lang?", "body": "<p><strong>Input string:</strong> \"///hello//stackover.flow\"</p>\n\n<p><strong>Expected output:</strong> \"/hello/stackover.flow\"</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1482818517, "post_id": 41339470, "comment_id": 69882060, "body": "&quot;Numeric constants represent exact values of arbitrary precision and do not overflow.&quot; -- <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Constants</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1482818410, "creation_date": 1482818410, "answer_id": 41339792, "question_id": 41339470, "link": "https://stackoverflow.com/questions/41339470/how-the-big-int-represent-in-golang/41339792#41339792", "title": "How the big int represent in golang?", "body": "<p>Big and Small are untyped constants.</p>\n\n<p><code>fmt.Println</code> accepts <code>interface{}</code>. Constant is converted to its default type.</p>\n\n<p>The default type is int.</p>\n"}, {"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1482827732, "post_id": 41339920, "comment_id": 69885519, "body": "@blackmamba plese mark  it as done , if it answered the question"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 2, "last_activity_date": 1482819607, "last_edit_date": 1482819607, "creation_date": 1482819072, "answer_id": 41339920, "question_id": 41339470, "link": "https://stackoverflow.com/questions/41339470/how-the-big-int-represent-in-golang/41339920#41339920", "title": "How the big int represent in golang?", "body": "<p>Short answer : Big is <strong>untyped integer constant</strong></p>\n\n<p>Constant expressions are always evaluated exactly; intermediate values and the constants themselves may require precision significantly larger than supported by any predeclared type in the language. The following are legal declarations:</p>\n\n<pre><code>const Huge = 1 &lt;&lt; 100         // Huge == 1267650600228229401496703205376  (untyped integer constant)\nconst Four int8 = Huge &gt;&gt; 98  // Four == 4                                (type int8)\n</code></pre>\n\n<p>reference <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Constant_expressions</a></p>\n\n<p>Here in the constant you have not explicitly said it is an integer if said it would have failed</p>\n\n<pre><code>const (\n    Big  int = 1 &lt;&lt; 100\n    Small       = Big &gt;&gt; 99\n)\n</code></pre>\n\n<p>will show error </p>\n\n<pre><code>tmp/sandbox351128854/main.go:9: constant 1267650600228229401496703205376 overflows int\n</code></pre>\n"}], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1482819607, "creation_date": 1482816329, "question_id": 41339470, "link": "https://stackoverflow.com/questions/41339470/how-the-big-int-represent-in-golang", "title": "How the big int represent in golang?", "body": "<p>this code is right,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nconst (\n    Big   = 1 &lt;&lt; 100\n    Small = Big &gt;&gt; 99\n)\n\nfunc needInt(x int) int { return x*10 + 1 }\nfunc needFloat(x float64) float64 {\n    return x * 0.1\n}\n\nfunc main() {\n    fmt.Println(needInt(Small))\n    fmt.Println(needFloat(Small))\n    fmt.Println(needFloat(Big))\n}\n</code></pre>\n\n<p>But when i add </p>\n\n<pre><code>fmt.Println(Big)\n</code></pre>\n\n<p>I meet an error:</p>\n\n<pre><code>tmp/sandbox042871394/main.go:16: constant 1267650600228229401496703205376 overflows int\n</code></pre>\n\n<p>i am confused for </p>\n\n<pre><code> const (\n        Big   = 1 &lt;&lt; 100\n        Small = Big &gt;&gt; 99\n    )\n</code></pre>\n\n<p>why there is no error for this two lines code.</p>\n"}, {"tags": ["database", "postgresql", "go", "error-handling"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1482817481, "post_id": 41338715, "comment_id": 69881751, "body": "You may use any golaang ORM . I would highly recomend <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow noreferrer\">github.com/jinzhu/gorm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 0, "last_activity_date": 1482818199, "creation_date": 1482818199, "answer_id": 41339753, "question_id": 41338715, "link": "https://stackoverflow.com/questions/41338715/golang-database-updating-a-non-existing-entry/41339753#41339753", "title": "golang database updating a non-existing entry", "body": "<p>If you need to make it less verbose and easy to maintain I would highly recomend using ORM. You may try <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow noreferrer\">https://github.com/jinzhu/gorm</a></p>\n\n<p>Named return might make it less verbose, but this is not a best practise for lot of scenarios</p>\n\n<pre><code>func (adb *AppDB) UpdateTicket(t Ticket) (err error) {\n    var result ResultType\n    var nRows int\n    if result, err = adb.db.NamedExec(`UPDATE ticket SET detail=:detail, start_time=:start_time, end_time=:end_time, priority=:priority WHERE id=:id;`, &amp;t); err != nil {\n        return\n    }\n    if nRows, err = result.RowsAffected(); err != nil {\n        return\n    }\n    if nRows == 0 {\n        err = fmt.Errorf(\"Ticket:%s does not exist for update\", t)\n    }\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 41339753, "answer_count": 1, "score": 0, "last_activity_date": 1482818199, "creation_date": 1482809967, "question_id": 41338715, "link": "https://stackoverflow.com/questions/41338715/golang-database-updating-a-non-existing-entry", "title": "golang database updating a non-existing entry", "body": "<p>I have a function to update a database entry as follows. The logic is that updating a non-exisitng entry returns error. Somehow I find the code a bit verbose on error handling. Is there a better way to do this? Thanks.</p>\n\n<pre><code>func (adb *AppDB) UpdateTicket(t Ticket) error {                                   \n    result, err := adb.db.NamedExec(`UPDATE ticket SET detail=:detail, start_time=:start_time, end_time=:end_time, priority=:priority WHERE id=:id;`, &amp;t) \n    if err != nil {                                                                \n        return err                                                                 \n    }                                                                              \n    nRows, err := result.RowsAffected()                                            \n    if err != nil {                                                                \n        return err                                                                 \n    }                                                                              \n    if nRows == 0 {                                                                \n        return fmt.Errorf(\"Ticket:%s does not exist for update\", t)                \n    }                                                                              \n    return nil                                                                     \n}     \n</code></pre>\n"}, {"tags": ["javascript", "go", "dynamic", "struct", "slice"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 3, "creation_date": 1482809994, "post_id": 41338339, "comment_id": 69880129, "body": "With nested structs, you&#39;ll just have to do <code>A.B.C ...</code>. With maps, arrays, or slices, the you&#39;d just do <code>a[0][&quot;x&quot;] ...</code>.  There are no other idiomatic shortcuts."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1482840418, "post_id": 41338339, "comment_id": 69891684, "body": "Python&#39;s list comprehensions offer a different way to do functional operations like this. <a href=\"http://stackoverflow.com/a/27848524/539810\">This answer addressing another question involving list comprehensions in Go</a> is worth reading as it explains that it&#39;s possible but not worth it."}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 548357, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/44d570571c893820c9d74defe572249e?s=128&d=identicon&r=PG", "display_name": "seogrady", "link": "https://stackoverflow.com/users/548357/seogrady"}, "edited": false, "score": 0, "creation_date": 1482874376, "post_id": 41348952, "comment_id": 69906784, "body": "Thanks for that.  Great example!"}, {"owner": {"reputation": 261, "user_id": 548357, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/44d570571c893820c9d74defe572249e?s=128&d=identicon&r=PG", "display_name": "seogrady", "link": "https://stackoverflow.com/users/548357/seogrady"}, "edited": false, "score": 0, "creation_date": 1482877518, "post_id": 41348952, "comment_id": 69907790, "body": "How would I do it without reflection.  For example, using a path with only integers &quot;0.0.0&quot; and then return the struct Foo that can be mutated?"}, {"owner": {"reputation": 261, "user_id": 548357, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/44d570571c893820c9d74defe572249e?s=128&d=identicon&r=PG", "display_name": "seogrady", "link": "https://stackoverflow.com/users/548357/seogrady"}, "edited": false, "score": 0, "creation_date": 1482880489, "post_id": 41348952, "comment_id": 69908702, "body": "Yes, but that requires you to know the exact length of nesting and isn&#39;t flexible. If the structure is consistent but nested length varies how can I access the nested object to update the tree?  Something comparable in JS is working with immutable data structures."}, {"owner": {"reputation": 261, "user_id": 548357, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/44d570571c893820c9d74defe572249e?s=128&d=identicon&r=PG", "display_name": "seogrady", "link": "https://stackoverflow.com/users/548357/seogrady"}, "edited": false, "score": 0, "creation_date": 1482904362, "post_id": 41348952, "comment_id": 69913928, "body": "Awesome.  Thanks for your help!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1482881139, "last_edit_date": 1482881139, "creation_date": 1482857236, "answer_id": 41348952, "question_id": 41338339, "link": "https://stackoverflow.com/questions/41338339/golang-assign-value-to-deep-nested-structure/41348952#41348952", "title": "Golang assign value to deep nested structure", "body": "<p>If you need a general solution, you can do it using package <a href=\"https://golang.org/pkg/reflect/\" rel=\"noreferrer\"><code>reflect</code></a>, but it's better to avoid it if possible (e.g. if you know the types and the \"path\" at compile time, simply use field <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"noreferrer\">selectors</a> and <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">index expressions</a>).</p>\n\n<p>Here's a demonstration. A helper function that sets a \"deep\" value specified by <code>string</code> elements may look like this:</p>\n\n<pre><code>func set(d interface{}, value interface{}, path ...string) {\n    v := reflect.ValueOf(d)\n    for _, s := range path {\n        v = index(v, s)\n    }\n    v.Set(reflect.ValueOf(value))\n}\n</code></pre>\n\n<p>The <code>index()</code> function used above may look like this:</p>\n\n<pre><code>func index(v reflect.Value, idx string) reflect.Value {\n    if i, err := strconv.Atoi(idx); err == nil {\n        return v.Index(i)\n    }\n    return v.FieldByName(idx)\n}\n</code></pre>\n\n<p>This is how we can test it:</p>\n\n<pre><code>type Foo struct {\n    Children []Foo\n    A        int\n}\n\nfunc main() {\n    x := []Foo{\n        {\n            Children: []Foo{\n                {\n                    Children: []Foo{\n                        {\n                            A: 1,\n                        },\n                    },\n                },\n            },\n        },\n    }\n    fmt.Printf(\"%+v\\n\", x)\n    path := \"0.Children.0.Children.0.A\"\n    set(x, 2, strings.Split(path, \".\")...)\n    fmt.Printf(\"%+v\\n\", x)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/i36wueuYgG\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[{Children:[{Children:[{Children:[] A:1}] A:0}] A:0}]\n[{Children:[{Children:[{Children:[] A:2}] A:0}] A:0}]\n</code></pre>\n\n<p>As can be seen from the output, the \"deep\" field <code>A</code> denoted by the <code>string</code> path <code>\"0.Children.0.Children.0.A\"</code> changed from the initial <code>1</code> to <code>2</code>.</p>\n\n<p>Note that fields of structs (<code>Foo.A</code> and <code>Foo.Children</code> in this case) must be exported (must start with capital letter), else other packages would not be able to access those fields, and their value could not be changed using package <code>reflect</code>.</p>\n\n<hr>\n\n<p>Without reflection, knowing the types and \"path\" prior, it can be done like this (continuing the previous example):</p>\n\n<pre><code>f := &amp;x[0].Children[0].Children[0]\nfmt.Printf(\"%+v\\n\", f)\nf.A = 3\nfmt.Printf(\"%+v\\n\", f)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/y0x3JJjUO0\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{Children:[] A:2}\n&amp;{Children:[] A:3}\n</code></pre>\n\n<p>The general solution of this (without reflection):</p>\n\n<pre><code>func getFoo(x []Foo, path ...string) (f *Foo) {\n    for _, s := range path {\n        if i, err := strconv.Atoi(s); err != nil {\n            panic(err)\n        } else {\n            f = &amp;x[i]\n            x = f.Children\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>Using it (again, continuing the previous example):</p>\n\n<pre><code>path = \"0.0.0\"\nf2 := getFoo(x, strings.Split(path, \".\")...)\nfmt.Printf(\"%+v\\n\", f2)\nf2.A = 4\nfmt.Printf(\"%+v\\n\", f2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/QABDDX0Rz1\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{Children:[] A:3}\n&amp;{Children:[] A:4}\n</code></pre>\n\n<p>But note that if we're only dealing with <code>int</code> indices, it does not make sense anymore to declare <code>path</code> to be <code>...string</code> (which is <code>[]string</code>), an <code>int</code> slice would make a lot more sense.</p>\n"}], "owner": {"reputation": 261, "user_id": 548357, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/44d570571c893820c9d74defe572249e?s=128&d=identicon&r=PG", "display_name": "seogrady", "link": "https://stackoverflow.com/users/548357/seogrady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1516, "favorite_count": 0, "accepted_answer_id": 41348952, "answer_count": 1, "score": 1, "last_activity_date": 1482881139, "creation_date": 1482806166, "last_edit_date": 1482858125, "question_id": 41338339, "link": "https://stackoverflow.com/questions/41338339/golang-assign-value-to-deep-nested-structure", "title": "Golang assign value to deep nested structure", "body": "<p>I'm learning Go and so far really enjoying it. Coming from a JS background, there are certain patterns and best practices that I'm still discovering.</p>\n\n<p>What would be the best way to get and assign a value to a deeply nested object in Go using a Object path? For example, in JS it could be done like this...</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var children = [{children:[{children:[{a:1}]}]}]\r\nvar child = \"0.children.0.children.0\".split('.').reduce((c, p) =&gt; c[p], children)\r\nchild.a = 2\r\nconsole.log(children[0].children[0].children[0].a)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 420, "user_id": 635855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ea7ff66be8e4c611891d49efa70307?s=128&d=identicon&r=PG", "display_name": "Ben M.", "link": "https://stackoverflow.com/users/635855/ben-m"}, "edited": false, "score": 0, "creation_date": 1487181899, "post_id": 41336341, "comment_id": 71671552, "body": "I&#39;m having the same issue.  godoc does not seem to respect my $GOROOT environment variable or the -goroot parameter."}], "answers": [{"tags": [], "owner": {"reputation": 420, "user_id": 635855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ea7ff66be8e4c611891d49efa70307?s=128&d=identicon&r=PG", "display_name": "Ben M.", "link": "https://stackoverflow.com/users/635855/ben-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1487190995, "creation_date": 1487190995, "answer_id": 42259531, "question_id": 41336341, "link": "https://stackoverflow.com/questions/41336341/cannot-find-package-error-on-godoc-playable-examples/42259531#42259531", "title": "&quot;cannot find package&quot; error on godoc playable examples", "body": "<p>This is because godoc uses the golang.org/x/tools/playground tool, which just proxies requests to golang.org.  It does not appear that you can run your example functions unless they are in a package that is published on golang.org.  Here's the relevant file in github: <a href=\"https://github.com/golang/tools/blob/master/playground/common.go\" rel=\"nofollow noreferrer\">https://github.com/golang/tools/blob/master/playground/common.go</a> which is referenced by the godoc tool here: <a href=\"https://github.com/golang/tools/blob/master/cmd/godoc/play.go\" rel=\"nofollow noreferrer\">https://github.com/golang/tools/blob/master/cmd/godoc/play.go</a></p>\n"}], "owner": {"reputation": 163, "user_id": 2113202, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0e95a8690a27a08cdf1c4c9f7919135b?s=128&d=identicon&r=PG", "display_name": "hogedigo", "link": "https://stackoverflow.com/users/2113202/hogedigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 0, "accepted_answer_id": 42259531, "answer_count": 1, "score": 1, "last_activity_date": 1487190995, "creation_date": 1482786883, "last_edit_date": 1483056910, "question_id": 41336341, "link": "https://stackoverflow.com/questions/41336341/cannot-find-package-error-on-godoc-playable-examples", "title": "&quot;cannot find package&quot; error on godoc playable examples", "body": "<p>I'm trying to make palyable example on godoc.</p>\n\n<ul>\n<li>OS X Yosemite 10.10.5 </li>\n<li>Go: go1.7.4 darwin/amd64</li>\n</ul>\n\n<p>test code:\n$GOPATH/src/hoge/hoge_test.go</p>\n\n<pre><code>package hoge_test\n\nimport (\n    \"fmt\"\n    \"hoge\"\n    \"testing\"\n)\n\nfunc ExampleHoge() {\n    fmt.Println(hoge.Hoge())\n\n    // Output:\n    // hoge!!\n}\n</code></pre>\n\n<p>The test passes:</p>\n\n<pre><code>$ go test hoge\nok      hoge    0.011s\n</code></pre>\n\n<p>Godoc</p>\n\n<pre><code>$ godoc -play -http=:8080\n</code></pre>\n\n<p>I can see the <code>hoge</code> package's example playground as I expected on a web browser, but an error below occurs when I 'Run' the example.</p>\n\n<pre><code>tmp/sandbox389904218/main.go:5:2: cannot find package \"hoge\" in any of:\n/usr/local/go/src/hoge (from $GOROOT)\n/go/src/hoge (from $GOPATH)\n</code></pre>\n\n<p>I set my own GOPATH, but it's not <code>/go</code> as shown in the error.</p>\n\n<p>What I need to run examples.</p>\n\n<h3>Additional</h3>\n\n<p>I've got a reason of the error above.\nGodoc playable example redirects to play.golang.org to run the code, so the GOPATH in the error seems to be on the play.golang.org environment.</p>\n\n<p>I'm still not sure how to run my own pkg example though...</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "edited": false, "score": 0, "creation_date": 1482779431, "post_id": 41335279, "comment_id": 69873220, "body": "I see. My confusion was caused by thinking <code>*i</code> was a way of <b>getting</b> the value at the address of <code>i</code>, and therefore not usable for setting values. Not sure why I thought that. Thanks."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1482779015, "creation_date": 1482779015, "answer_id": 41335279, "question_id": 41335255, "link": "https://stackoverflow.com/questions/41335255/changing-the-value-of-a-non-struct-with-a-pointer-receiver/41335279#41335279", "title": "Changing the value of a non-struct with a pointer receiver", "body": "<p>You're changing the value of the <strong>pointer</strong> <code>i</code>, not the <strong>value</strong> at which the pointer is pointing.</p>\n\n<p>You will see your expected output by using the <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\"><code>*</code> operator</a>:</p>\n\n<pre><code>*i = newValue\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/mKsKC0lsj9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mKsKC0lsj9</a></p>\n"}, {"tags": [], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "is_accepted": false, "score": 0, "last_activity_date": 1482802196, "creation_date": 1482802196, "answer_id": 41337924, "question_id": 41335255, "link": "https://stackoverflow.com/questions/41335255/changing-the-value-of-a-non-struct-with-a-pointer-receiver/41337924#41337924", "title": "Changing the value of a non-struct with a pointer receiver", "body": "<p>for your function define:</p>\n\n<pre><code>func (i *MyInt) Change() {\n    newValue := MyInt(32)\n    i = &amp;newValue\n}\n</code></pre>\n\n<p>when you call this function:</p>\n\n<pre><code>myInt := MyInt(64)\nmyInt.Change()\n</code></pre>\n\n<p>the value of <code>myInt</code> will pass to <code>i</code>, so after call <code>func (i *MyInt) Change()</code>, you only modify the <code>i</code>, not <code>myInt</code>.</p>\n"}], "owner": {"reputation": 1235, "user_id": 4470895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac18a4e724071d9e029e921786264b97?s=128&d=identicon&r=PG&f=1", "display_name": "HenryTK", "link": "https://stackoverflow.com/users/4470895/henrytk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 41335279, "answer_count": 2, "score": 0, "last_activity_date": 1482802196, "creation_date": 1482778806, "question_id": 41335255, "link": "https://stackoverflow.com/questions/41335255/changing-the-value-of-a-non-struct-with-a-pointer-receiver", "title": "Changing the value of a non-struct with a pointer receiver", "body": "<p>If I have a type which is not a struct how do I change its value with a pointer receiver?</p>\n\n<p>For example, given the <a href=\"https://play.golang.org/p/HW53RD_h1V\" rel=\"nofollow noreferrer\">following code</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype MyInt int\n\nfunc (i *MyInt) Change() {\n    newValue := MyInt(32)\n    i = &amp;newValue\n}\n\nfunc main() {\n    myInt := MyInt(64)\n    fmt.Println(myInt)\n    myInt.Change()\n    fmt.Println(myInt)\n}\n</code></pre>\n\n<p>It outputs:</p>\n\n<pre><code>64\n64\n</code></pre>\n\n<p>Why does it not output the following:</p>\n\n<pre><code>64\n32\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["string", "go", "time", "formatting", "duration"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1578581463, "last_edit_date": 1578581463, "creation_date": 1482786157, "answer_id": 41336257, "question_id": 41335155, "link": "https://stackoverflow.com/questions/41335155/time-duration-to-string-2h-instead-2h0m0s/41336257#41336257", "title": "Time duration to string 2h instead 2h0m0s", "body": "<p><strong>Foreword:</strong> I released this utility in <a href=\"https://github.com/icza/gox\" rel=\"nofollow noreferrer\"><code>github.com/icza/gox</code></a>, see <a href=\"https://godoc.org/github.com/icza/gox/timex#ShortDuration\" rel=\"nofollow noreferrer\"><code>timex.ShortDuration()</code></a>.</p>\n\n<hr>\n\n<p>Not in the standard library, but it's really easy to create one:</p>\n\n<pre><code>func shortDur(d time.Duration) string {\n    s := d.String()\n    if strings.HasSuffix(s, \"m0s\") {\n        s = s[:len(s)-2]\n    }\n    if strings.HasSuffix(s, \"h0m\") {\n        s = s[:len(s)-2]\n    }\n    return s\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>h, m, s := 5*time.Hour, 4*time.Minute, 3*time.Second\nds := []time.Duration{\n    h + m + s, h + m, h + s, m + s, h, m, s,\n}\n\nfor _, d := range ds {\n    fmt.Printf(\"%-8v %v\\n\", d, shortDur(d))\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/7HML7TZvbR\" rel=\"nofollow noreferrer\">Go Playground)</a>:</p>\n\n<pre><code>5h4m3s   5h4m3s\n5h4m0s   5h4m\n5h0m3s   5h0m3s\n4m3s     4m3s\n5h0m0s   5h\n4m0s     4m\n3s       3s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13903, "user_id": 86388, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/cPl84.jpg?s=128&g=1", "display_name": "Tarion", "link": "https://stackoverflow.com/users/86388/tarion"}, "is_accepted": false, "score": 2, "last_activity_date": 1503296616, "creation_date": 1503296616, "answer_id": 45790473, "question_id": 41335155, "link": "https://stackoverflow.com/questions/41335155/time-duration-to-string-2h-instead-2h0m0s/45790473#45790473", "title": "Time duration to string 2h instead 2h0m0s", "body": "<p>You can just round the duration like this:</p>\n\n<pre><code>        func RountTime(roundTo string, value time.Time) string {\n            since := time.Since(value)\n            if roundTo == \"h\" {\n                since -= since % time.Hour\n            }\n            if roundTo == \"m\" {\n                since -= since % time.Minute\n            }\n            if roundTo == \"s\" {\n                since -= since % time.Second\n            }\n            return since.String()\n        }\n</code></pre>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10560, "favorite_count": 0, "accepted_answer_id": 41336257, "answer_count": 2, "score": 4, "last_activity_date": 1578581463, "creation_date": 1482778115, "last_edit_date": 1571234621, "question_id": 41335155, "link": "https://stackoverflow.com/questions/41335155/time-duration-to-string-2h-instead-2h0m0s", "title": "Time duration to string 2h instead 2h0m0s", "body": "<p>The default time.Duration String method formats the duration with adding <code>0s</code> for minutes and <code>0m0s</code> for hours. Is there function that I can use that will produce <code>5m</code> instead <code>5m0s</code> and <code>2h</code> instead <code>2h0m0s</code> ... or I have to implement my own?</p>\n"}, {"tags": ["go", "intellij-idea", "plugins", "jetbrains-ide"], "comments": [{"owner": {"reputation": 195, "user_id": 3696633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2o9SH.jpg?s=128&g=1", "display_name": "hedgehogues", "link": "https://stackoverflow.com/users/3696633/hedgehogues"}, "reply_to_user": {"reputation": 4227, "user_id": 437506, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1f81d6e639fd42098d15302f098f0531?s=128&d=identicon&r=PG&f=1", "display_name": "Kedar Mhaswade", "link": "https://stackoverflow.com/users/437506/kedar-mhaswade"}, "edited": false, "score": 0, "creation_date": 1482821312, "post_id": 41334268, "comment_id": 69882983, "body": "I am trying next <a href=\"https://sourceforge.net/projects/liteide/files/X30.3/\" rel=\"nofollow noreferrer\">LiteIDE</a> and <a href=\"https://github.com/visualfc/liteide\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "edited": false, "score": 0, "creation_date": 1482852469, "post_id": 41334268, "comment_id": 69897374, "body": "Just to make sure you wont miss it: the team at Jetbrains is working on its own implementation of a Go IDE called Gogland. It looks very promising. As far as I know it&#39;s currently still in a closed Beta stage. Take a look at <a href=\"https://www.jetbrains.com/go/\" rel=\"nofollow noreferrer\">jetbrains.com/go</a> for more information."}], "answers": [{"comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 195, "user_id": 3696633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2o9SH.jpg?s=128&g=1", "display_name": "hedgehogues", "link": "https://stackoverflow.com/users/3696633/hedgehogues"}, "edited": false, "score": 0, "creation_date": 1482856720, "post_id": 41342002, "comment_id": 69899294, "body": "And the second one?"}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 0, "last_activity_date": 1482829072, "creation_date": 1482829072, "answer_id": 41342002, "question_id": 41334268, "link": "https://stackoverflow.com/questions/41334268/golang-plugin-on-intellij-library-and-break-points/41342002#41342002", "title": "Golang plugin on Intellij. Library and break points", "body": "<ul>\n<li>Build my project without warning -> you need to use the full package name (for example you need to use \"github.com/dlsniper/demo\" for a package under the GOPATH <code>/home/florin/go</code> and full path <code>$GOPATH/src/github.com/dlsniper/demo</code>. Alternatively, you can use the <code>Run Kind</code> directory and point it to the directory or simply just use the green arrow near the <code>func main</code>, click on it, select <code>Run ...</code> and then select <code>Go Application</code></li>\n</ul>\n\n<hr>\n\n<ul>\n<li>Debugging my project -> once you get your <code>Run Configuration</code> of type <code>Go Application</code> to run the application then to debug it you'll just need to use the Debug option instead of Run. Alternatively, you can click on the green arrow near the <code>func main</code> and choose <code>Debug...</code> to debug your application.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 195, "user_id": 3696633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2o9SH.jpg?s=128&g=1", "display_name": "hedgehogues", "link": "https://stackoverflow.com/users/3696633/hedgehogues"}, "is_accepted": true, "score": 0, "last_activity_date": 1490105760, "last_edit_date": 1495541837, "creation_date": 1483098198, "answer_id": 41395709, "question_id": 41334268, "link": "https://stackoverflow.com/questions/41334268/golang-plugin-on-intellij-library-and-break-points/41395709#41395709", "title": "Golang plugin on Intellij. Library and break points", "body": "<h2>The answer to the first question</h2>\n\n<p>Any project in Go consist of packages. There is nothing except for packages. All packages are located in the same directory, which one is project. Other directories are libraries. They set through environment variable <code>$GOPATH</code>. IDEA IntelliJ let make it as:</p>\n\n<p>File->Settings:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pI19p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pI19p.png\" alt=\"Outer packages\"></a></p>\n\n<p>There are two type of libs in Go: globals and locals. You read about this <a href=\"https://stackoverflow.com/a/17844770/3696633\">here</a>. </p>\n\n<p>In the build time is necessary to specify which package we want to gather and line up all the dependencies themselves. In my project, there are n packets. For example, I can build mapsfullsearch package. I can build mfsimporter package. Or I can build any other, in which there is <code>func main () {/*...*/}</code>. To build just specify the appropriate configuration.</p>\n\n<p>After that, all Imports (if relevant packages exist), resolved.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bjVVq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bjVVq.png\" alt=\"Struct of my project\"></a></p>\n\n<p>About configurations. Go to Run -> Edit Configurations... </p>\n\n<p><a href=\"https://i.stack.imgur.com/Y5bbY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y5bbY.png\" alt=\"Settings of configurations\"></a></p>\n\n<p>Name: name of compilled file. \nRun kind: which type of building (file or package).\nPackage: package name that matches the name of the directory in which the <code>main()</code>. There are drop-down list in IDEA IntelliJ. It appears, if you start to write his name.\nOutput directory: directory where the binary.\nEnvironments: variables of environments\nGo Tool arguments: compiler's arguments\nProgram arguments: program's arguments</p>\n\n<p>For more information about config can be read <a href=\"https://rootpd.com/2016/02/04/setting-up-intellij-idea-for-your-first-golang-project/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<h2>The answer to the second question</h2>\n\n<p>In the IDEA may be poorly specified file path. In that case, to which I referred in her question, the problem was related to the fact that the path to the library is specified via the home directory, which is denoted by <code>~</code>. IDEA  does not perceive such format. Repeat this problem I did not succeed. Although up to the moment until I put the project in the root file system, my project didn't work.</p>\n"}], "owner": {"reputation": 195, "user_id": 3696633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2o9SH.jpg?s=128&g=1", "display_name": "hedgehogues", "link": "https://stackoverflow.com/users/3696633/hedgehogues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "accepted_answer_id": 41395709, "answer_count": 2, "score": 0, "last_activity_date": 1490105760, "creation_date": 1482772548, "last_edit_date": 1483002023, "question_id": 41334268, "link": "https://stackoverflow.com/questions/41334268/golang-plugin-on-intellij-library-and-break-points", "title": "Golang plugin on Intellij. Library and break points", "body": "<p>I write my code on Go. I build my project in Idea Intellij with plugin for golang. I have a package main. In main import different packages.</p>\n\n<pre><code>import (\n    \"RF\"\n    \"flag\"\n    \"io\"\n    \"net/http\"\n    \"os\"\n    \"runtime\"\n    \"depot\"\n    \"info\"\n    \"logger\"\n    \"logic\"\n    \"poly\"\n    \"ranker\"\n    \"revgeocoder\"\n    \"search\"\n    \"search/engine\"\n    \"stat\"\n    \"views\"\n    \"fmt\"\n)\n</code></pre>\n\n<p>This packages very well linked if I write paths in <code>$GOPATH</code>. In Idea Intellij it makes such way: </p>\n\n<p><a href=\"https://i.stack.imgur.com/CY8gw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CY8gw.png\" alt=\"Path to packages\"></a></p>\n\n<p>Now, I want:</p>\n\n<ol>\n<li>Build my project without warning</li>\n<li>Debugging my project</li>\n</ol>\n\n<hr>\n\n<p>First point. I make a 'build' and than I have: \"Package is not specified\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/gWbKS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gWbKS.png\" alt=\"Package is not specified\"></a></p>\n\n<p>If I write to Package name <code>main</code>, than warning doesn't disappear:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RKpGE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RKpGE.png\" alt=\"Cannot find package &lt;code&gt;main&lt;/code&gt;\"></a></p>\n\n<p>What I can do?</p>\n\n<hr>\n\n<p>Point number two. The assembly is successful. After that part of package I can debug, another package I cannot debug. For example package <code>engine</code> I can debug. Path to this package:</p>\n\n<pre><code>/home/INT.PV.KM/urvanov/hedgehogues/distr/mapsfullsearch/src/search/engine/engine.go\n</code></pre>\n\n<p>Next file I cannot debug.</p>\n\n<pre><code>/home/INT.PV.KM/urvanov/hedgehogues/distr/mapsfullsearch/src/search/context.go\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7p1Fe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7p1Fe.png\" alt=\"Tree of catalog\"></a></p>\n\n<p>I cannot set a breaks point in this file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JasKB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JasKB.png\" alt=\"Break point\"></a></p>\n\n<p>Please, help me with my problems.</p>\n"}, {"tags": ["go", "video-streaming"], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": true, "score": 2, "last_activity_date": 1482768504, "creation_date": 1482768504, "answer_id": 41333649, "question_id": 41333525, "link": "https://stackoverflow.com/questions/41333525/video-stream-optimization/41333649#41333649", "title": "Video stream optimization", "body": "<p>Video compression is amazingly efficient, you will never get anything better than that. Look at H.264 for instance <a href=\"https://sidbala.com/h-264-is-magic/\" rel=\"nofollow noreferrer\">https://sidbala.com/h-264-is-magic/</a></p>\n"}], "owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 41333649, "answer_count": 1, "score": -1, "last_activity_date": 1482768504, "creation_date": 1482767842, "question_id": 41333525, "link": "https://stackoverflow.com/questions/41333525/video-stream-optimization", "title": "Video stream optimization", "body": "<p>I am building a video surveillance app, for learning purposes.</p>\n\n<p>At the moment I have a very basic prototype working.</p>\n\n<p>I am capturing and sending webcam frames to a browser over a websocket.</p>\n\n<p>Just for some context on how basic the implementation is, on the client side I have:</p>\n\n<pre><code>&lt;img id=\"frame\" src=\"\"&gt;\n</code></pre>\n\n<p>I am appending the frames via javascript. </p>\n\n<p>The app and the server are written in Golang</p>\n\n<p>Although what I have works, I know sending individual frames to a browser is never going to cut it if I want to view the stream from outside my home network.</p>\n\n<p>I have to optimize the process.</p>\n\n<p>So far I have only thought of compressing the cam frames before sending them to the client. </p>\n\n<p>Also encoding the frames to video and implementing a video player on the client side.</p>\n\n<p>What else can be done?</p>\n\n<p>I know the question is broad, but I assume there must be a standard optimization pattern for video streaming.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5194, "user_id": 41344, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e0dedec2ffb08c81d5eb0d3d8fb966d7?s=128&d=identicon&r=PG", "display_name": "rog", "link": "https://stackoverflow.com/users/41344/rog"}, "edited": false, "score": 0, "creation_date": 1482765433, "post_id": 41332454, "comment_id": 69868890, "body": "Please provide more information - for example a small, complete working program that illustrates the problem. If you&#39;re saying that you&#39;re getting a nil-pointer panic just after your &quot;nil pointer&quot; comment, then you could trivially get around that by doing &quot;if wi != nil { wi.Ctx = ct }&quot; but why is your code calling SetContext on a nil object in the first place?"}, {"owner": {"reputation": 586, "user_id": 1338765, "user_type": "registered", "accept_rate": 8, "profile_image": "https://graph.facebook.com/520538811/picture?type=large", "display_name": "asaf000", "link": "https://stackoverflow.com/users/1338765/asaf000"}, "reply_to_user": {"reputation": 5194, "user_id": 41344, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e0dedec2ffb08c81d5eb0d3d8fb966d7?s=128&d=identicon&r=PG", "display_name": "rog", "link": "https://stackoverflow.com/users/41344/rog"}, "edited": false, "score": 0, "creation_date": 1482768783, "post_id": 41332454, "comment_id": 69869950, "body": "If some code by reflection creates p := Parent{}, p.SetContext(value) will cause nil, of course I can avoid nil by &#39;if wi != nil&#39; but my question is whether or not it&#39;s possible to change what the address of the pointer receiver to a new instance. (such wi = &amp;WithContext{})"}, {"owner": {"reputation": 5194, "user_id": 41344, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e0dedec2ffb08c81d5eb0d3d8fb966d7?s=128&d=identicon&r=PG", "display_name": "rog", "link": "https://stackoverflow.com/users/41344/rog"}, "edited": false, "score": 0, "creation_date": 1484653508, "post_id": 41332454, "comment_id": 70588346, "body": "The receiver parameter is just like any other parameter - if you change it, it changes the value locally but does not have any other side effects."}], "answers": [{"tags": [], "owner": {"reputation": 984, "user_id": 1244420, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ca029fbc9431b4df66c61c4c7447b3d5?s=128&d=identicon&r=PG", "display_name": "Addison", "link": "https://stackoverflow.com/users/1244420/addison"}, "is_accepted": false, "score": 1, "last_activity_date": 1482777669, "creation_date": 1482777669, "answer_id": 41335088, "question_id": 41332454, "link": "https://stackoverflow.com/questions/41332454/initializing-embedded-struct-when-no-control-over-parent-initialization/41335088#41335088", "title": "Initializing embedded struct when no control over parent initialization", "body": "<p>Ideally, whatever is constructing the <code>Parent</code> struct should initialize it so it's in a usable state. But since you have no control over it, the next best thing is to have a piece of code that lets you set the <code>WithContext</code> pointer in <code>Parent</code>, by providing a member function on <code>Parent</code> or just a piece of code in your application to set it, since <code>WithContext</code> field is exported.</p>\n"}], "owner": {"reputation": 586, "user_id": 1338765, "user_type": "registered", "accept_rate": 8, "profile_image": "https://graph.facebook.com/520538811/picture?type=large", "display_name": "asaf000", "link": "https://stackoverflow.com/users/1338765/asaf000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1482777669, "creation_date": 1482761329, "question_id": 41332454, "link": "https://stackoverflow.com/questions/41332454/initializing-embedded-struct-when-no-control-over-parent-initialization", "title": "Initializing embedded struct when no control over parent initialization", "body": "<p>I have a struct such:</p>\n\n<pre><code>type Parent struct {\n  *WithContext\n}\n\ntype WithContext struct {\n  Ctx context.Context\n}\n\nfunc (wi *WithContext) SetContext(ctx context.Context) {\n  // nil pointer\n  wi.Ctx = ctx\n}\n</code></pre>\n\n<p>Parent is initialized by some automated process (as apart of unmarshalling flow), so I cannot initialize the embedded WithContext struct,</p>\n\n<p>Is there any way to avoid the nil pointer in the 'SetContext' func ? I tried overriding the pointer receiver but it doesn't have any effect,</p>\n\n<p>Thanks,</p>\n\n<p>Asaf.</p>\n"}, {"tags": ["parsing", "datetime", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1482760097, "post_id": 41329583, "comment_id": 69867170, "body": "<code>Monday</code> without further date reference is meaningless in the eyes of the parser, so it is discarded. Which Monday? You will not to write your own more sophisticated parser for that."}, {"owner": {"reputation": 39085, "user_id": 67332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C0tuF.jpg?s=128&g=1", "display_name": "Glavi\u0107", "link": "https://stackoverflow.com/users/67332/glavi%c4%87"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1482761053, "post_id": 41329583, "comment_id": 69867500, "body": "@Not_a_Golfer: first Monday in the past, I already wrote that in the question: <code>So format is &quot;DAY (in the past) at TIME&quot;. I tried next example:</code>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1482761137, "post_id": 41329583, "comment_id": 69867529, "body": "Yes, but can you tell the parser that? nope!"}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 1, "last_activity_date": 1482760928, "creation_date": 1482760928, "answer_id": 41332382, "question_id": 41329583, "link": "https://stackoverflow.com/questions/41329583/relative-date-parsing/41332382#41332382", "title": "Relative date parsing", "body": "<p>Expanding on my comment: </p>\n\n<p>Just <code>Monday</code> without further date reference is meaningless in the eyes of the parser, so it is discarded. Which Monday? The parser is strict, not fuzzy. Assuming Monday refers to the current week is not something that such a parser can do. You will not to write your own more sophisticated parser for that.</p>\n\n<p>So it would have to be along these lines - one function that converts a relative fuzzy day to a real date, and replaces that in the original expression, and another one that parses the whole thing:</p>\n\n<pre><code>const dateFormat = \"2006-01-02\"\nconst longForm = \"2006-01-02 at 3:04 PM\"\n\nfunc parseFuzzyDate(fuzzyTime string) (time.Time, error) {\n\n    formattedTime, err := parseDayAndReplaceIt(fuzzyTime)\n    if err != nil {\n       return nil, err\n    }\n\n    return time.Parse(longForm, formattedTime)\n}\n</code></pre>\n\n<p>and the second function gets the fuzzy time, finds the day, parses it and returns. I'm not going to implement it, just write in comments what should be done:</p>\n\n<pre><code>func parseDayAndReplaceIt(fuzzyTime string) (string, error) {\n   // 1. Extract the day\n\n   // 2. Parse weekday names to relative time\n\n   // 3. if it's not a weekday name, parse things like \"tomorrow\" \"yesterday\"\n\n   // 4. replace the day string in the original fuzzyTime with a formatted date that the parser can understand\n\n   // 5. return the formatted date\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1482763712, "last_edit_date": 1482763712, "creation_date": 1482763374, "answer_id": 41332787, "question_id": 41329583, "link": "https://stackoverflow.com/questions/41329583/relative-date-parsing/41332787#41332787", "title": "Relative date parsing", "body": "<p>I tweaked something that I wrote a while back and consolidated it into this example code:</p>\n\n<pre><code>func lastDateOf(targetDay time.Weekday, timeOfDay time.Time) time.Time {\n    const oneDay = 24 * time.Hour\n    var dayIndex time.Duration\n\n    //dayIndex -= oneDay\n    for {\n        if time.Now().Add(dayIndex).Weekday() == targetDay {\n            y, m, d := time.Now().Add(dayIndex).Date()\n            return timeOfDay.AddDate(y, int(m)-1, d-1)\n        }\n        dayIndex -= oneDay\n    }\n}\n</code></pre>\n\n<p>It returns the date, relative to now, of the previous <code>targetDay</code>, added to <code>timeOfDay</code>, assuming that <code>timeOfDay</code> consists of hours, minutes and seconds, and the zero time values for year, month and day it will give you a suitable answer.</p>\n\n<p>It's not very flexible but I believe it suits your example reasonably well. Although it doesn't address relative terms like \"tomorrow\", \"yesterday\" or \"next Saturday\".</p>\n\n<p>runnable version in the <a href=\"https://play.golang.org/p/MP7v3QgcCS\" rel=\"nofollow noreferrer\">playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 39085, "user_id": 67332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C0tuF.jpg?s=128&g=1", "display_name": "Glavi\u0107", "link": "https://stackoverflow.com/users/67332/glavi%c4%87"}, "is_accepted": false, "score": 0, "last_activity_date": 1497508193, "creation_date": 1497508193, "answer_id": 44560167, "question_id": 41329583, "link": "https://stackoverflow.com/questions/41329583/relative-date-parsing/44560167#44560167", "title": "Relative date parsing", "body": "<p>Custom parser:</p>\n\n<pre><code>func RelativeDateParse(s string) (time.Time, error) {\n    for n := 0; n &lt; 7; n++ {\n        day := time.Now().AddDate(0, 0, -n)\n        dayName := day.Format(\"Monday\")\n        switch n {\n        case 0:\n            dayName = \"today\"\n        case 1:\n            dayName = \"yesterday\"\n        }\n        s = strings.Replace(s, dayName + \" at\", day.Format(\"2006-01-02\"), -1)\n    }\n    return time.Parse(\"2006-01-02 3:04 PM\", s)\n}\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/ibOU4KcuSi\" rel=\"nofollow noreferrer\"><strong>demo</strong></a></kbd></p>\n"}], "owner": {"reputation": 39085, "user_id": 67332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C0tuF.jpg?s=128&g=1", "display_name": "Glavi\u0107", "link": "https://stackoverflow.com/users/67332/glavi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1497508193, "creation_date": 1482746959, "question_id": 41329583, "link": "https://stackoverflow.com/questions/41329583/relative-date-parsing", "title": "Relative date parsing", "body": "<p>How to parse relative datetime in GO?</p>\n\n<p>Example of relative dates:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>today at 9:17 AM\nyesterday at 9:58 PM\nSaturday at 9:44 PM\nWednesday at 11:01 AM\n</code></pre>\n\n<p>So format is <code>DAY (in the past) at TIME</code>. I tried next example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>const longForm = \"Monday at 3:04 PM\"\nt, _ := time.Parse(longForm, \"Saturday at 3:50 PM\")\nfmt.Println(t)\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/VgC5ITuu-c\" rel=\"nofollow noreferrer\"><strong>demo</strong></a></kbd></p>\n\n<p>Time is parsed correctly, but day/date is ignored...</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1482745831, "post_id": 41329168, "comment_id": 69861732, "body": "Write an test where you use the type as the required interface. The test wouldn&#39;t pass unless the type implements the said interface."}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1584071377, "post_id": 41329168, "comment_id": 107330050, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/a/60663003\">Ensure a type implements an interface at compile time in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1482746180, "post_id": 41329276, "comment_id": 69861898, "body": "Thanks @Sarathsp for that elegant solution. I have learned that it\u2019s sometimes called a canary test (from the poor canary in the mine that would die from gas poisoning quickly enough to warn the mines)."}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1482746691, "post_id": 41329276, "comment_id": 69862123, "body": "I assume that the dummy variable will just be discarded by the compiler and consume neither space nor CPU time. I guess, it can always be moved to a _test.go file if in doubt."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1482747050, "post_id": 41329276, "comment_id": 69862299, "body": "This will be discarded by the compiler . Moving that to test file is your call , but i would suggest put it there as it makes the implemenation requirement  explicit :D,   BTW , you my try <code>var _ Stringer = (*A)(nil)</code> if memory is a concern :D"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 2, "last_activity_date": 1482745646, "creation_date": 1482745646, "answer_id": 41329276, "question_id": 41329168, "link": "https://stackoverflow.com/questions/41329168/forcing-go-types-to-implement-an-interface/41329276#41329276", "title": "Forcing Go types to implement an interface", "body": "<p>Best thing you may do is  try to assign an instance of the type to a interface variable </p>\n\n<p>For example you want to make sure type <code>A</code> implements <code>Stringer</code> interface.</p>\n\n<p>You may do like this</p>\n\n<pre><code>var _ Stringer = new(A) //or\nvar _ Stringer = A{}\n</code></pre>\n\n<p>Here is the sample program, In the example <code>A</code> implements the interface and <code>B</code> does not </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Stringer interface {\n   String() string\n}\n\ntype A struct {\n}\n\nfunc (a A) String() string {\n    return \"A\"\n}\n\ntype B struct {}\n\n\nvar _ Stringer = new(A)\nvar _ Stringer = new(B)\n\nfunc main() {\n\n    fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>Play link here : <a href=\"https://play.golang.org/p/tp0rUtNN4s\" rel=\"nofollow noreferrer\">play.golang</a></p>\n"}, {"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 0, "last_activity_date": 1482746527, "creation_date": 1482746527, "answer_id": 41329481, "question_id": 41329168, "link": "https://stackoverflow.com/questions/41329168/forcing-go-types-to-implement-an-interface/41329481#41329481", "title": "Forcing Go types to implement an interface", "body": "<p>To complete what @Sarathsp said:\nBasically, by declaring a dummy variable (underscore means that it is not used) of the interface type while assigning an instance of your type to it, you get very explicit compile-time errors:</p>\n\n<pre><code>    type MyType struct {\n    }\n\n    func (*MyType) Read() {\n\n    }\n\n    var _ io.Reader = &amp;MyType{}\n\n\ncannot use MyType literal (type *MyType) as type io.Reader in assignment:\n        *MyType does not implement io.Reader (missing Read method)\n\nOr\n\ncannot use MyType literal (type *MyType) as type io.Reader in assignment:\n        *MyType does not implement io.Reader (wrong type for Read method)\n                have Read()\n                want Read([]byte) (int, error)\n</code></pre>\n"}], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 41329276, "answer_count": 2, "score": 0, "last_activity_date": 1482746527, "creation_date": 1482745136, "question_id": 41329168, "link": "https://stackoverflow.com/questions/41329168/forcing-go-types-to-implement-an-interface", "title": "Forcing Go types to implement an interface", "body": "<p>In Go, you don\u2019t state that you need to implement an interface, you just do it (it\u2019s called \u2018structural typing\u2019 similar to \u2018duck typing\u2019 in dynamic languages).\nWhat if you want to force a type to implement an interface (like when you \u2018inherit\u2019 an interface in C# or Java for instance)? In other words, what if forgetting to implement an interface (or getting the signature wrong) is a mistake and you want to catch that mistake early. What is the best way to do it?</p>\n"}, {"tags": ["c", "linux", "go", "shared-libraries"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1482745283, "post_id": 41328972, "comment_id": 69861488, "body": "I don&#39;t think you can do it that way. look at this example, you can do it with a static bridge function <a href=\"https://github.com/coreos/pkg/blob/master/dlopen/dlopen_example.go\" rel=\"nofollow noreferrer\">github.com/coreos/pkg/blob/master/dlopen/dlopen_example.go</a>"}, {"owner": {"reputation": 31, "user_id": 7341707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sRzja.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/7341707/alex"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1482894862, "post_id": 41328972, "comment_id": 69911577, "body": "Thank you! Bridge function was the missing link."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 7341707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sRzja.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/7341707/alex"}, "is_accepted": false, "score": 2, "last_activity_date": 1482894798, "creation_date": 1482894798, "answer_id": 41354882, "question_id": 41328972, "link": "https://stackoverflow.com/questions/41328972/golang-c-so-imports-segmentation-violation-on-call/41354882#41354882", "title": "Golang C (.so) imports segmentation violation on call", "body": "<p>Here is solution. I had to use bridge C function:</p>\n\n<pre><code>package main\n\n// #cgo LDFLAGS: -ldl\n// #include &lt;dlfcn.h&gt;\n// #include &lt;stdio.h&gt;\n//\n// double\n// my_sqrt_bridge(void *f, double x)\n// {\n//  //description: ((return_data_type (*)(input_data_type))bridge_input_function_pointer) (bridge_input_value)\n//  return ((double (*)(double))f)(x);\n// }\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n\n    export_name := \"sqrt\"\n    lib_path := \"/lib/libm.so.6\"\n\n    //Loading .so\n    handle := C.dlopen(C.CString(lib_path), C.RTLD_LAZY)\n    if handle == nil {\n        fmt.Println(lib_path + \":\\tNOT FOUND\")\n        return\n    } else {\n        fmt.Println(lib_path + \":\\tSUCCESS\")\n    }\n\n    //looking for function address\n    func_pointer := C.dlsym(handle, C.CString(export_name))\n    if func_pointer == nil {\n        fmt.Println(export_name + \":\\tNOT FOUND\")\n        return\n    } else {\n        fmt.Println(export_name+\":\\t\", func_pointer)\n    }\n\n    fmt.Printf(\"%f\", C.my_sqrt_bridge(func_pointer, 2))\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1483013839, "creation_date": 1483013839, "answer_id": 41379579, "question_id": 41328972, "link": "https://stackoverflow.com/questions/41328972/golang-c-so-imports-segmentation-violation-on-call/41379579#41379579", "title": "Golang C (.so) imports segmentation violation on call", "body": "<p>Would it be possible in your case to let cgo link the library for you? Eg:</p>\n\n<pre><code>package main\n\n/*\n#cgo LDFLAGS: -lm\n#include &lt;math.h&gt;\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n    fmt.Printf(\"%g\\n\", C.sqrt(2))  //prints 1.4142135623730951\n}\n</code></pre>\n\n<p>For a third party library /some/lib/dir/libxxx.so: </p>\n\n<pre><code>LDFLAGS: -L/some/lib/dir -lxxx\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7341707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sRzja.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/7341707/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1483013839, "creation_date": 1482744198, "last_edit_date": 1495542825, "question_id": 41328972, "link": "https://stackoverflow.com/questions/41328972/golang-c-so-imports-segmentation-violation-on-call", "title": "Golang C (.so) imports segmentation violation on call", "body": "<p>Hello I'm going to work with thirdparty library (.so file) with golang in linux environment. So I tried to practice a bit with something trivial, like importing functions from linux native libs. And got stuck on importing and calling sqrt function. Here is my code:</p>\n\n<pre><code>package main\n        // #cgo LDFLAGS: -ldl\n        // #include &lt;dlfcn.h&gt;\n        // #include &lt;stdio.h&gt;\n        import \"C\"\n        import \"fmt\"\n\n        func main() {\n\n\n            export_name := \"sqrt\"\n            lib_path := \"/lib/libm.so.6\"\n\n            //Loading .so\n            handle := C.dlopen(C.CString(lib_path), C.RTLD_LAZY)\n            if handle == nil {\n                fmt.Println(lib_path+\":\\tNOT FOUND\")\n                return\n            } else {\n                fmt.Println(lib_path+\":\\tSUCCESS\")\n                }\n\n            //looking for function address\n            func_pointer := C.dlsym(handle, C.CString(export_name ))\n            if func_pointer == nil {\n                fmt.Println(export_name+\":\\tNOT FOUND\")\n                return\n            } else {\n                fmt.Println(export_name+\":\\t\", func_pointer)\n                }\n\n            //negotiating datatypes\n            //From c lib description: double sqrt(double x);\n            sqrt  := *(*(func(float64)float64))(func_pointer)\n\n            //Calling function\n            sqrt(4)\n\n        }\n</code></pre>\n\n<p>when I run it, I always get segmentation violation:</p>\n\n<pre><code>/lib/libm.so.6: SUCCESS\nsqrt:    0x7f37117ea270\nunexpected fault address 0x0\nfatal error: fault\n[signal SIGSEGV: segmentation violation code=0x80 addr=0x0 pc=0x4019fa]\n\ngoroutine 1 [running]:\nruntime.throw(0x4a6643, 0x5)\n        /usr/lib/go/src/runtime/panic.go:566 +0x95 fp=0xc42004be00 sp=0xc42004bde0\nruntime.sigpanic()\n        /usr/lib/go/src/runtime/sigpanic_unix.go:27 +0x288 fp=0xc42004be58 sp=0xc42004be00\nmain.main()\n        /home/afx/goc/so.go:37 +0x2ba fp=0xc42004bf48 sp=0xc42004be58\nruntime.main()\n        /usr/lib/go/src/runtime/proc.go:183 +0x1f4 fp=0xc42004bfa0 sp=0xc42004bf48\nruntime.goexit()\n        /usr/lib/go/src/runtime/asm_amd64.s:2086 +0x1 fp=0xc42004bfa8 sp=0xc42004bfa0\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n        /usr/lib/go/src/runtime/asm_amd64.s:2086 +0x1\nexit status 2\n</code></pre>\n\n<p>What is  the problem ? \nThank you in advance.</p>\n\n<p>P.S.\nWhen I'm redefining function pointers of native Go functions (like here <a href=\"https://stackoverflow.com/questions/22933169/go-convert-unsafe-pointer-to-function-pointer-and-vice-versa\">Go: convert unsafe.Pointer to function pointer and vice versa</a>)  everything works fine. But import fails.</p>\n"}, {"tags": ["ajax", "http", "post", "go"], "answers": [{"tags": [], "owner": {"reputation": 4635, "user_id": 1411589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2a6b1a1c31198db776d76af7f04c1bbd?s=128&d=identicon&r=PG", "display_name": "deepakssn", "link": "https://stackoverflow.com/users/1411589/deepakssn"}, "is_accepted": false, "score": 0, "last_activity_date": 1482754023, "creation_date": 1482754023, "answer_id": 41331017, "question_id": 41328484, "link": "https://stackoverflow.com/questions/41328484/http-post-request-decoding-issue-golang-eof/41331017#41331017", "title": "Http post request decoding issue golang EOF", "body": "<p>Your application may be posting the data as Form.</p>\n\n<p>You may have to use the following code to parse the data.</p>\n\n<pre><code>r.ParseForm()\ndefer r.Body.Close()\nlog.Println(r.Form)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "is_accepted": false, "score": 0, "last_activity_date": 1482759345, "creation_date": 1482759345, "answer_id": 41332097, "question_id": 41328484, "link": "https://stackoverflow.com/questions/41328484/http-post-request-decoding-issue-golang-eof/41332097#41332097", "title": "Http post request decoding issue golang EOF", "body": "<p>You should check the header Content-Type.\nAnd maybe this example can be helpful.</p>\n\n<pre><code>if request.Method == \"POST\" {\n    dat := make(map[string]interface{})\n    if postData, err := ioutil.ReadAll(request.Body); err != nil {\n        panic(err)\n    } else if err = json.Unmarshal(postData, &amp;dat); err != nil{\n        panic(err)\n    } else {\n        //use dat....\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 5461428, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gxTkNRr0Lck/AAAAAAAAAAI/AAAAAAAAAcY/uZ1rNKFav_s/photo.jpg?sz=128", "display_name": "Rahul Kamboj", "link": "https://stackoverflow.com/users/5461428/rahul-kamboj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1473, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482759345, "creation_date": 1482741110, "question_id": 41328484, "link": "https://stackoverflow.com/questions/41328484/http-post-request-decoding-issue-golang-eof", "title": "Http post request decoding issue golang EOF", "body": "<p>Request with postman is ok but in case of ajax call http: panic serving XXX.XXX.XXX.XXX:XXXXX: EOF </p>\n\n<pre><code>func BodyToJson(r *http.Request)  map[string]interface{}{\n    decoder := json.NewDecoder(r.Body);\n    fmt.Println(reflect.TypeOf(r.Body).Kind())\n    fmt.Println(decoder);\n    var dat map[string]interface{}\n    err := decoder.Decode(&amp;dat)\n    if err!= nil{\n        panic(err);\n    }\n    return dat\n }\n</code></pre>\n"}, {"tags": ["performance", "go", "compiler-optimization"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1482744648, "last_edit_date": 1482744648, "creation_date": 1482739777, "answer_id": 41328287, "question_id": 41327984, "link": "https://stackoverflow.com/questions/41327984/does-go-runtime-evaluate-the-for-loop-condition-every-iteration/41328287#41328287", "title": "Does Go runtime evaluate the for loop condition every iteration?", "body": "<p>It does not seems optimized, and is not listed in \"<a href=\"https://github.com/golang/go/wiki/CompilerOptimizations\" rel=\"nofollow noreferrer\">Compiler And Runtime Optimizations</a>\".</p>\n\n<p>As mentioned in <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/jVM0VhsPM04\" rel=\"nofollow noreferrer\">this older discussion</a>, </p>\n\n<blockquote>\n  <p>The gc compiler does not do any loop optimizations.  One of the major goals of that compiler is to compile quickly.  While improved optimization is always useful, it has to fit within that goal</p>\n</blockquote>\n\n<p>But that could have changed. A good technique to see what is going on is illustrated in \"<a href=\"https://www.goinggo.net/2013/09/recursion-and-tail-calls-in-go_26.html\" rel=\"nofollow noreferrer\">Recursion And Tail Calls In Go</a>\", where you can look at the assembly code produced by a go program.<br>\nSee also the more recent 2016 \"<a href=\"https://rednaga.io/2016/09/21/reversing_go_binaries_like_a_pro/\" rel=\"nofollow noreferrer\">Reversing GO binaries like a pro</a>\" article.<br>\nAnd \"<a href=\"https://go.godbolt.org/\" rel=\"nofollow noreferrer\">go.godbolt.org</a>\" can help too: see the <a href=\"https://godbolt.org/g/j6PE2B\" rel=\"nofollow noreferrer\">assembly code here</a>.</p>\n\n<p>You can see the \"<code>t &lt; cycles*2*math.Pi</code>\" part always evaluated</p>\n\n<pre><code>.L2:\n        movsd   xmm0, QWORD PTR [rbp-24]\n        addsd   xmm0, xmm0\n        movsd   xmm1, QWORD PTR .LC2[rip]\n        mulsd   xmm0, xmm1\n        ucomisd xmm0, QWORD PTR [rbp-8]\n        seta    al\n        test    al, al\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1482745479, "post_id": 41328449, "comment_id": 69861572, "body": "That seems more accurate than my answer. +1"}], "tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": true, "score": 4, "last_activity_date": 1482745363, "last_edit_date": 1482745363, "creation_date": 1482740838, "answer_id": 41328449, "question_id": 41327984, "link": "https://stackoverflow.com/questions/41327984/does-go-runtime-evaluate-the-for-loop-condition-every-iteration/41328449#41328449", "title": "Does Go runtime evaluate the for loop condition every iteration?", "body": "<p>This really depends on the Go version but <code>go version go1.7 windows/amd64</code> does appear to calculate the value once.</p>\n\n<p>Go code:</p>\n\n<pre><code>var cycles = 10.0\nvar res = 1000.0\nfor t := 0.0; t &lt; cycles*2*math.Pi; t += res {\n}\n</code></pre>\n\n<p>Asm code:</p>\n\n<pre><code>movsd   [rsp+58h+var_20], xmm0\nmov     [rsp+58h+var_18], 0\nmov     [rsp+58h+var_10], 0\nlea     rax, qword_494500\nmov     [rsp+58h+var_58], rax\nlea     rax, [rsp+58h+var_20]\nmov     [rsp+58h+var_50], rax\nmov     [rsp+58h+var_48], 0\ncall    runtime_convT2E\nmov     rax, [rsp+58h+var_40]\nmov     rcx, [rsp+58h+a] ; a\nmov     [rsp+58h+var_18], rax\nmov     [rsp+58h+var_10], rcx\nlea     rax, [rsp+58h+var_18]\nmov     [rsp+58h+var_58], rax\nmov     [rsp+58h+var_50], 1\nmov     [rsp+58h+var_48], 1\ncall    fmt_Println\nmovsd   xmm0, cs:$f64_408f400000000000\nmovsd   xmm1, [rsp+58h+t]\naddsd   xmm0, xmm1\nmovsd   [rsp+58h+t], xmm0\nmovsd   xmm1, cs:$f64_404f6a7a2955385e\nucomisd xmm1, xmm0\nja      loc_401083\n</code></pre>\n\n<p><code>f64_404f6a7a2955385e</code> is a precalculated double value equal to <code>10 * 2 * math.Pi</code> or <code>62.8318530718</code></p>\n\n<p>Go compiler <a href=\"https://golang.org/doc/go1.7#compiler\" rel=\"nofollow noreferrer\">recently switched</a> to <a href=\"https://en.wikipedia.org/wiki/Static_single_assignment_form\" rel=\"nofollow noreferrer\">SSA</a>, so these kind of optimizations will just keep improving as they greatly benefit from it. For now SSA is only available on amd64:</p>\n\n<blockquote>\n  <h3>Compiler Toolchain</h3>\n  \n  <p>This release includes a new code generation back end for 64-bit x86\n  systems, following a proposal from 2015 that has been under development\n  since then. The new back end, based on SSA, generates more compact, more\n  efficient code and provides a better platform for optimizations such as\n  bounds check elimination.</p>\n</blockquote>\n\n<p><a href=\"https://tip.golang.org/doc/go1.8#compiler\" rel=\"nofollow noreferrer\">1.8 should have it for all supported architectures</a>:</p>\n\n<blockquote>\n  <h3>Compiler Toolchain</h3>\n  \n  <p>Go 1.7 introduced a new compiler back end for 64-bit x86 systems. In Go\n  1.8, that back end has been developed further and is now used for all\n  architectures.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1482783760, "post_id": 41329878, "comment_id": 69874434, "body": "Current compiler as in 1.7 or 1.8 beta 2? Does that mean my answer is more accurate than creker&#39;s? In 1.7? Does that remain true with 1.8?"}, {"owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1482789801, "post_id": 41329878, "comment_id": 69876055, "body": "Yes, for all versions, including master branch."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1482789862, "post_id": 41329878, "comment_id": 69876071, "body": "OK. That seems to confirm what I mentioned in my answer. +1"}], "tags": [], "owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "is_accepted": false, "score": 1, "last_activity_date": 1482748384, "creation_date": 1482748384, "answer_id": 41329878, "question_id": 41327984, "link": "https://stackoverflow.com/questions/41327984/does-go-runtime-evaluate-the-for-loop-condition-every-iteration/41329878#41329878", "title": "Does Go runtime evaluate the for loop condition every iteration?", "body": "<p>The current Go compiler does not move loop invariant computations outside loops.</p>\n\n<p>The list of passes of the compiler can be seen here <a href=\"https://github.com/golang/go/blob/master/src/cmd/compile/internal/ssa/compile.go#L329\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/cmd/compile/internal/ssa/compile.go#L329</a></p>\n\n<p>In the example by @creker, the compiler did constant folding, not loop invariant code motion.</p>\n\n<p>As a side note, I did make a few months ago a LICM pass for the Go compiler <a href=\"https://github.com/golang/go/compare/master...momchil-velikov:dev.chill.licm\" rel=\"nofollow noreferrer\">https://github.com/golang/go/compare/master...momchil-velikov:dev.chill.licm</a></p>\n\n<p>which does not improve performance very much on the typically used Go benchmarks. (I blame the atrocious register allocation :P)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1820956"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 3, "accepted_answer_id": 41328449, "answer_count": 3, "score": 3, "last_activity_date": 1606122043, "creation_date": 1482737984, "question_id": 41327984, "link": "https://stackoverflow.com/questions/41327984/does-go-runtime-evaluate-the-for-loop-condition-every-iteration", "title": "Does Go runtime evaluate the for loop condition every iteration?", "body": "<p>Here is a code snippet from the book \"The Go Programming Language\":</p>\n\n<pre><code>for t := 0.0; t &lt; cycles*2*math.Pi; t += res {\n    ...\n}\n</code></pre>\n\n<p>It appears that the expression in the for loop condition <code>t &lt; cycles*2*math.Pi</code> must be evaluated before every iteration of the for loop. Or, does the compiler optimize this by pre-calculating the result of the expression (assuming none of the variables change during the iteration)? Does the above style of coding affect performance?</p>\n"}, {"tags": ["python", "go", "beanstalkd", "beanstalkc"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 0, "creation_date": 1482905887, "post_id": 41327030, "comment_id": 69914435, "body": "Thinkyou for your help.What your mean is set publisher and consumer on the same machine \uff1f So that it can be \u201cA publish B\uff08consumer\uff09 and then B\uff08publisher\uff09 publish A\u201d\uff1f"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 0, "creation_date": 1482908896, "post_id": 41327030, "comment_id": 69915627, "body": "Need not be in the same machine. Let&#39;s call <code>master</code>(publisher) and <code>workers</code>(consumers). When master asks workers to do something any one  of the workers may own the work and on completion it has to let master know it is done ,for that purpose master may attach a <code>callbaclurl</code> with the job request."}, {"owner": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 0, "creation_date": 1482913186, "post_id": 41327030, "comment_id": 69917497, "body": "Thank you your explain, so I can not find any function to do that in  beanstalk(golang) or beanstalkc(python).I really confuse."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 1, "creation_date": 1482913583, "post_id": 41327030, "comment_id": 69917635, "body": "It is not a queue(or libray) specific thing. Using beanstalk <code>master</code> will push the job where job body is a json say <code>{&quot;id&quot;:&quot;Sasa&quot;, &quot;job&quot;:&quot;actualjob&quot;,&quot;callback&quot;:&quot;http:&#47;&#47;example.com&#47;status&quot;}</code> . One <code>worker</code> do a <code>reserve</code> gets the job decode json and now it knows the job body that is <code>json.job</code> and the <code>status callback</code> ie json.callback . Once job is finished the worker will do a <code>delete</code> on queue for the job and send status to the callback url"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 0, "creation_date": 1482914211, "post_id": 41327030, "comment_id": 69917889, "body": "Updated the answer please read . Tick as accepted if that helps you :D"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 1, "last_activity_date": 1482914172, "last_edit_date": 1482914172, "creation_date": 1482732219, "answer_id": 41327030, "question_id": 41326122, "link": "https://stackoverflow.com/questions/41326122/how-to-use-callback-in-beanstalkd/41327030#41327030", "title": "how to use callback in beanstalkd \uff1f", "body": "<p>The right way to let publisher know the status of a job is using callbacks </p>\n\n<p>With job let the publisher put a callback url (a queue or http) and on success or failure of the job th consumer may send a status message to the status call back</p>\n\n<p>so the job structure may loom like</p>\n\n<pre><code>//JobRequest has the struct storing request name and body\ntype JobRequest struct {\n        ID              string\n        RequestBody     []byte\n        CallbackURL  *string\n}\n</code></pre>\n\n<p>The json strng of the above struct will be the job body.The consumer would get the <code>CallbackURL</code> and will senbd status to that url</p>\n\n<p><strong>Trying to explain as reqiuested details</strong></p>\n\n<p>Let's call <code>producer</code> and <code>consumer(s)</code> <code>master</code> and <code>workers(s)</code> . </p>\n\n<ol>\n<li><p>When ever a job is available master would create a <code>job object</code> which has</p>\n\n<ul>\n<li>job id (A unique value to identify teh job)</li>\n<li>RequestBody (The details of the job)</li>\n<li>StatusCallbackURL (URL the worker would hit with the job status)</li>\n</ul></li>\n<li><p>One of the workers listening to the queue <code>reserve</code> the job,there buy telling i will <strong>try to do</strong> this job</p></li>\n<li>Decode the json and get the job details .Now does the job</li>\n<li>On success <code>delete</code> the job from queue and send status to the CallbackURL</li>\n<li>On failure if non temporary failure send status as fail to the CallbackURL and <code>delete</code> the job</li>\n<li>If temporary failure do nothing as after reserve timeout over it wil be re-enqueued</li>\n</ol>\n\n<p>Now this object is converted to json and put in queue</p>\n\n<p><strong>PS:</strong> Do not delete the job before succesfully completing .On Completion or Permanant Failure only delte the job</p>\n"}], "owner": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 41327030, "answer_count": 1, "score": 0, "last_activity_date": 1491498580, "creation_date": 1482722320, "last_edit_date": 1491498580, "question_id": 41326122, "link": "https://stackoverflow.com/questions/41326122/how-to-use-callback-in-beanstalkd", "title": "how to use callback in beanstalkd \uff1f", "body": "<p>There is 3 machines and one publisher, two consumers.\nI am using golang to publish order to some machine.\nAnd the machine is used python to be consumer.\nI want to know how can I get the result that the order is finished or failed in publisher.</p>\n\n<p>And if the order is not belong to machine one, what should i do?\nrelease or bury it?</p>\n\n<p>python:\n    consumer:</p>\n\n<pre><code>import beanstalkc\n\ndef get_beanstalk_data(conf):\n    beanstalk = beanstalkc.Connection(host='127.0.0.1',port=11300)\n    beanstalk.use('cloud')\n    beanstalk.watch('cloud')\n    beanstalk.ignore('default')\n    job = beanstalk.reserve()\n\n    if job.body == \"one\":  #job.body == \"two\"\n        #TODO\n        job.delete()\n        return job.body\n    else:\n        #TODO    what should I do in here, because there is two consumer and get different orders\n\nwhile True:\n    data = get_beanstalk_data(conf)\n    print data\n</code></pre>\n\n<p>golang:\n    publish:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/kr/beanstalk\"\n    \"time\"\n)\n\nfunc main() {\n    c, err := beanstalk.Dial(\"tcp\", \"127.0.0.1:11300\")\n    id, err := c.Put([]byte(\"hello\"), 1, 0, 120*time.Second)\n\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(id)\n}\n</code></pre>\n"}, {"tags": ["go", "hex", "bignum"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 3, "creation_date": 1482703626, "post_id": 41324671, "comment_id": 69853340, "body": "<code>big.Int</code> has a <code>Text()</code> function that converts the number to a string in a given base. To create a hex string, use <code>value.Text(16)</code>. Will that do what you want?"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6803922, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/148de7ec8289954fcd634b00556026d0?s=128&d=identicon&r=PG&f=1", "display_name": "Cam.phiefr", "link": "https://stackoverflow.com/users/6803922/cam-phiefr"}, "edited": false, "score": 0, "creation_date": 1482710480, "post_id": 41324889, "comment_id": 69854400, "body": "well for example shouldn&#39;t -54 be FFFFFFFFFFFFFFCA or FFCA instead of  -34 ? maybe something i didn&#39;t get"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 77, "user_id": 6803922, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/148de7ec8289954fcd634b00556026d0?s=128&d=identicon&r=PG&f=1", "display_name": "Cam.phiefr", "link": "https://stackoverflow.com/users/6803922/cam-phiefr"}, "edited": false, "score": 0, "creation_date": 1482725535, "post_id": 41324889, "comment_id": 69856234, "body": "not sure where did you get that representation, at least what I know for all the languages in the <b>C</b> family is they sacrifice the first bit to represent the sign, that&#39;s why we have unsigned ints vs. ints, but if you want to know the internals you may check <a href=\"http://stackoverflow.com/questions/37582550/golang-twos-complement-and-fmt-printf\">here</a> Also in this case we&#39;re referring to big numbers and internally they&#39;re stored in a slice or list &#39;cause they don&#39;t fit in a regular register, so not sure how useful may be having the internal representation of that array"}, {"owner": {"reputation": 2664, "user_id": 1862101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e069875829ca4da3cd8895e468c64409?s=128&d=identicon&r=PG", "display_name": "brian beuning", "link": "https://stackoverflow.com/users/1862101/brian-beuning"}, "edited": false, "score": 0, "creation_date": 1482883227, "post_id": 41324889, "comment_id": 69909372, "body": "-54 (base 10) would be -36 (base 16) . FFCA would be the twos complement representation.  Many objects like big.Int like to keep the details of how they store data a secret.  Not because they don&#39;t want to share but they want to be able to change the implementation without breaking their users code."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 5, "last_activity_date": 1482704055, "creation_date": 1482704055, "answer_id": 41324889, "question_id": 41324671, "link": "https://stackoverflow.com/questions/41324671/big-number-to-hex-in-golang/41324889#41324889", "title": "Big number to HEX in golang", "body": "<p>Not sure what kind of issues are you having, but big.Int, big.Float and big.Rat implement the <code>fmt.Formatter</code> interface, you can use the printf family with the <strong>%x</strong> <strong>%X</strong> to convert to hexadecimal string representation, example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc toHexInt(n *big.Int) string {\n    return fmt.Sprintf(\"%x\", n) // or %X or upper case\n}\n\nfunc toHexRat(n *big.Rat) string {\n    return fmt.Sprintf(\"%x\", n) // or %X or upper case\n}\n\nfunc main() {\n    a := big.NewInt(-59)\n    b := big.NewInt(59)\n\n    fmt.Printf(\"negative int lower case: %x\\n\", a)\n    fmt.Printf(\"negative int upper case: %X\\n\", a) // %X or upper case\n\n    fmt.Println(\"using Int function:\", toHexInt(b))\n\n    f := big.NewRat(3, 4) // fraction: 3/4\n\n    fmt.Printf(\"rational lower case: %x\\n\", f)\n    fmt.Printf(\"rational lower case: %X\\n\", f)\n\n    fmt.Println(\"using Rat function:\", toHexRat(f))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BVh7wAYfbF\" rel=\"noreferrer\">https://play.golang.org/p/BVh7wAYfbF</a></p>\n"}], "owner": {"reputation": 77, "user_id": 6803922, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/148de7ec8289954fcd634b00556026d0?s=128&d=identicon&r=PG&f=1", "display_name": "Cam.phiefr", "link": "https://stackoverflow.com/users/6803922/cam-phiefr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5784, "favorite_count": 0, "accepted_answer_id": 41324889, "answer_count": 1, "score": 2, "last_activity_date": 1482704055, "creation_date": 1482701633, "question_id": 41324671, "link": "https://stackoverflow.com/questions/41324671/big-number-to-hex-in-golang", "title": "Big number to HEX in golang", "body": "<p>I'm trying to convert bignumbers(big.Int or even better big.Rat ) to Hex values.</p>\n\n<p>I'm always having issue converting number when they are negative 0xff..xx or Fixed numbers.</p>\n\n<p>Is there a way to do that ?</p>\n"}, {"tags": ["go", "smtp", "html-email"], "answers": [{"tags": [], "owner": {"reputation": 1104, "user_id": 7296908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523fdee63293ed32d8b695c146a9c35c?s=128&d=identicon&r=PG&f=1", "display_name": "negacao", "link": "https://stackoverflow.com/users/7296908/negacao"}, "is_accepted": true, "score": 1, "last_activity_date": 1482699677, "creation_date": 1482699677, "answer_id": 41324491, "question_id": 41324476, "link": "https://stackoverflow.com/questions/41324476/html-not-translated-in-email-golang/41324491#41324491", "title": "html not translated in email golang", "body": "<p>That sample is wrong. On line 46, it has </p>\n\n<pre><code>mime := \"MIME-version: 1.0;\\nContent-Type: text/plain; charset=\\\"UTF-8\\\";\\n\\n\"\n</code></pre>\n\n<p>Namely the <code>Content-Type: text/plain</code>). If you're sending HTML mail, you should use <code>Content-Type: text/html</code>.</p>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 41324491, "answer_count": 1, "score": 0, "last_activity_date": 1482699677, "creation_date": 1482699470, "question_id": 41324476, "link": "https://stackoverflow.com/questions/41324476/html-not-translated-in-email-golang", "title": "html not translated in email golang", "body": "<p>I'm actually trying to send email with html content with golang and net/smtp lib.\nBut when i send email, html is not translated and i receive an email like that : </p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n        \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt; &lt;html&gt;\n\n&lt;/head&gt;\n\n&lt;body&gt; &lt;p&gt;\n    Hello Louis\n    &lt;a href=\"http://google.com/\"&gt;Confirm email address&lt;/a&gt; &lt;/p&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>Because with my own code it did not work, i've tried with <a href=\"https://medium.com/@dhanushgopinath/sending-html-emails-using-templates-in-golang-9e953ca32f3d#.whzu9z3if\" rel=\"nofollow noreferrer\">this tutorial</a>\nbut it doesn't work either..</p>\n\n<p>So with the example of this tutorial why i receive email in the form of string and not in formatted html ?</p>\n\n<p>ps : My code is absolutely the same as in the tutorial</p>\n"}, {"tags": ["linux", "go", "process", "ipc", "shared-memory"], "comments": [{"owner": {"reputation": 3521, "user_id": 2304215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W708V.png?s=128&g=1", "display_name": "chrk", "link": "https://stackoverflow.com/users/2304215/chrk"}, "edited": false, "score": 2, "creation_date": 1482680202, "post_id": 41322376, "comment_id": 69848296, "body": "<a href=\"https://golang.org/doc/effective_go.html#goroutines\" rel=\"nofollow noreferrer\">The official documentation of goroutines</a> should be helpful."}, {"owner": {"reputation": 3521, "user_id": 2304215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W708V.png?s=128&g=1", "display_name": "chrk", "link": "https://stackoverflow.com/users/2304215/chrk"}, "edited": false, "score": 0, "creation_date": 1482680598, "post_id": 41322376, "comment_id": 69848403, "body": "As well as <a href=\"https://www.goinggo.net/2014/01/concurrency-goroutines-and-gomaxprocs.html\" rel=\"nofollow noreferrer\">this article</a>."}, {"owner": {"reputation": 123, "user_id": 4769561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aanTb.png?s=128&g=1", "display_name": "ea7ababe", "link": "https://stackoverflow.com/users/4769561/ea7ababe"}, "reply_to_user": {"reputation": 3521, "user_id": 2304215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W708V.png?s=128&g=1", "display_name": "chrk", "link": "https://stackoverflow.com/users/2304215/chrk"}, "edited": false, "score": 0, "creation_date": 1482681821, "post_id": 41322376, "comment_id": 69848695, "body": "@chrk, the problem is: not the official documentation nor the second article shed light on how go runtime provides synchronization of shared variables. The official documentation states: &quot;A goroutine has a simple model: it is a function executing concurrently with other goroutines in the same address space&quot;. But they can&#39;t be in the same address space if they are in different processes..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482682195, "post_id": 41322376, "comment_id": 69848790, "body": "Where are you getting the idea that Go uses separate processes for anything?"}, {"owner": {"reputation": 3521, "user_id": 2304215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W708V.png?s=128&g=1", "display_name": "chrk", "link": "https://stackoverflow.com/users/2304215/chrk"}, "edited": false, "score": 2, "creation_date": 1482682867, "post_id": 41322376, "comment_id": 69848924, "body": "Let&#39;s read it again more carefully then.It states:&quot;They&#39;re called goroutines because the existing terms\u2014threads, coroutines, <b>processes</b>, and so on-convey inaccurate connotations&quot;; so don&#39;t assume they&#39;re processes. As far as the address space is concerned, it states that &quot;Goroutines are multiplexed onto multiple <b>OS threads</b>&quot;.I don&#39;t aim to provide a complete answer here, but what you really need to study in order to figure out the answers to your questions by yourself, is how threads work in Linux; then test:<code>strace</code>,<code>&#47;proc&#47;&lt;PID&gt;&#47;*</code> and see some answers here in SO for more advanced stuff"}, {"owner": {"reputation": 123, "user_id": 4769561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aanTb.png?s=128&g=1", "display_name": "ea7ababe", "link": "https://stackoverflow.com/users/4769561/ea7ababe"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482682905, "post_id": 41322376, "comment_id": 69848933, "body": "@JimB, well, <a href=\"http://stackoverflow.com/a/25390444/4769561\">this answer</a> says that linux task scheduler can only run a process on one CPU core at a time. This means that a go program must use multiple OS tasks to utilize multiple cores. And that means different address spaces for each task. Am I wrong?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1482683611, "post_id": 41322376, "comment_id": 69849100, "body": "A thread, in linux, is also known as a Light Weight Process (<a href=\"http://www.tldp.org/FAQ/Threads-FAQ/Types.html\" rel=\"nofollow noreferrer\">tldp.org/FAQ/Threads-FAQ/Types.html</a>).   Each thread can be on a separate core and has it&#39;s own stack, but shares the address space of the spawning process (shared memory)"}, {"owner": {"reputation": 123, "user_id": 4769561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aanTb.png?s=128&g=1", "display_name": "ea7ababe", "link": "https://stackoverflow.com/users/4769561/ea7ababe"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1482684223, "post_id": 41322376, "comment_id": 69849239, "body": "@DavidBudworth, o-o-oh, so Linux does have support for threads with shared memory... I never heard about that. Well that clears up everything."}, {"owner": {"reputation": 123, "user_id": 4769561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aanTb.png?s=128&g=1", "display_name": "ea7ababe", "link": "https://stackoverflow.com/users/4769561/ea7ababe"}, "edited": false, "score": 0, "creation_date": 1482684278, "post_id": 41322376, "comment_id": 69849254, "body": "Thank you all for your hints. :)"}], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 4769561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aanTb.png?s=128&g=1", "display_name": "ea7ababe", "link": "https://stackoverflow.com/users/4769561/ea7ababe"}, "is_accepted": true, "score": 5, "last_activity_date": 1482708959, "last_edit_date": 1482708959, "creation_date": 1482708418, "answer_id": 41325240, "question_id": 41322376, "link": "https://stackoverflow.com/questions/41322376/golang-processes-and-shared-memory/41325240#41325240", "title": "Golang, processes and shared memory", "body": "<p>I figured it out! It's all in go sources.</p>\n\n<p>There is a Linux system call that I were unaware of.\nIt's called \"clone\". It is more flexible than fork and it allows\na child process to live in its parent's address space.</p>\n\n<p>Here is a short overview of the thread creation process.</p>\n\n<p>First there is a <code>newm</code> function in <code>src/runtime/proc.go</code>. This\nfunction is responsible for creating a new working thread\n(or machine as it is called in comments).</p>\n\n<pre><code>// Create a new m. It will start off with a call to fn, or else the scheduler.\n// fn needs to be static and not a heap allocated closure.\n// May run with m.p==nil, so write barriers are not allowed.\n//go:nowritebarrier\nfunc newm(fn func(), _p_ *p) {\n\n    // ... some code skipped ...\n\n    newosproc(mp, unsafe.Pointer(mp.g0.stack.hi))\n}\n</code></pre>\n\n<p>This function calls <code>newosproc</code> which is OS-specific.\nFor Linux it can be found in <code>src/runtime/os_linux.go</code>. Here\nare relevant parts of that file:</p>\n\n<pre><code>var (\n    // ...\n\n    cloneFlags = _CLONE_VM | /* share memory */\n        _CLONE_FS | /* share cwd, etc */\n        _CLONE_FILES | /* share fd table */\n        _CLONE_SIGHAND | /* share sig handler table */\n        _CLONE_THREAD /* revisit - okay for now */\n)\n\n// May run with m.p==nil, so write barriers are not allowed.\n//go:nowritebarrier\nfunc newosproc(mp *m, stk unsafe.Pointer) {\n\n    // ... some code skipped ...\n\n    ret := clone(cloneFlags, /* ... other flags ... */)\n\n    // ... code skipped\n}\n</code></pre>\n\n<p>And the <code>clone</code> function is defined in architecture-specific\nfiles. For amd64 it is in <code>src/runtime/sys_linux_amd64.s</code>.\nIt is the actual system call.</p>\n\n<p>So Go programs do run in multiple OS threads which enables\nspanning across CPUs, but they use one shared address space.</p>\n\n<p>Phew... I love Go.</p>\n"}], "owner": {"reputation": 123, "user_id": 4769561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aanTb.png?s=128&g=1", "display_name": "ea7ababe", "link": "https://stackoverflow.com/users/4769561/ea7ababe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1584, "favorite_count": 1, "accepted_answer_id": 41325240, "answer_count": 1, "score": 1, "last_activity_date": 1482708959, "creation_date": 1482679680, "last_edit_date": 1482682368, "question_id": 41322376, "link": "https://stackoverflow.com/questions/41322376/golang-processes-and-shared-memory", "title": "Golang, processes and shared memory", "body": "<p>Today a friend of mine told me that Go programs can scale themselves on multiple CPU cores. I were quite surprised to hear that knowing that system task schedulers do not know anything about goroutines and hence can't run them on multiple cores.</p>\n\n<p>I did some search and found out that Go programs can spawn multiple OS tasks to run them on different cores (the number is controlled by GOMAXPROCS environment variable). But as far as I know forking a process leads to complete copy of process data and different processes run in different address spaces.</p>\n\n<p>So what about global variables in Go programs? Are they safe to use with multiple goroutines? Do they somehow synchronize between system processes? And if they do then how? I am mainly concerned about linux and freebsd implementations.</p>\n"}, {"tags": ["go", "socket.io"], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 0, "last_activity_date": 1482708044, "creation_date": 1482708044, "answer_id": 41325217, "question_id": 41319992, "link": "https://stackoverflow.com/questions/41319992/error-in-receiving-byte-array-via-go-socked-io/41325217#41325217", "title": "Error in Receiving byte array via go-socked.io", "body": "<p>You aren't sending an attachment, just data. This data can be used mapped with <code>map[string]int8</code> because you're sending an array of int8 and this is translated as a map in socketio.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func on_connection(so socketio.Socket) {\n    log.Println(\"On connection\")\n    so.Join(\"Room\")\n    so.On(\"m\", func(data map[string]int8) {\n        array := make([]int8, len(data))\n        for k, v := range data {\n            pos, _ := strconv.Atoi(k)\n            array[pos] = v\n        }\n        fmt.Println(array)\n    })\n}\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 6893963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154623771900712/picture?type=large", "display_name": "Louis Ng", "link": "https://stackoverflow.com/users/6893963/louis-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 41325217, "answer_count": 1, "score": 0, "last_activity_date": 1482708044, "creation_date": 1482658004, "question_id": 41319992, "link": "https://stackoverflow.com/questions/41319992/error-in-receiving-byte-array-via-go-socked-io", "title": "Error in Receiving byte array via go-socked.io", "body": "<p>I am trying to send an Int8Array from browser to go-socked.io, here is my client's code:</p>\n\n<pre><code>function init(){\n    conn = io('http://localhost:8080/');\n    var c = new Int8Array([127]);\n    conn.emit('m',c)\n}\n</code></pre>\n\n<p>This is my server code</p>\n\n<pre><code>func main() {\n    server, err := socketio.NewServer(nil)\n    if err!= nil{\n        log.Fatal(err)\n    }\n    server.On(\"connection\",on_connection)\n    http.Handle(\"/socket.io/\", server)\n    http.Handle(\"/src/\", maxAgeHandler(0,http.FileServer(http.Dir(\"./\"))))\n    http.Handle(\"/app/\", maxAgeHandler(0,http.FileServer(http.Dir(\"./\"))))\n    http.ListenAndServe(\":8080\",nil)\n}\n\nfunc on_connection(so socketio.Socket){\n    log.Println(\"On connection\")\n    so.Join(\"Room\")\n    so.On(\"m\",func(msg *socketio.Attachment){\n        b, _ := ioutil.ReadAll(msg.Data)    &lt;---- I got error in this line\n        fmt.Println(b)\n    })\n\n}\n</code></pre>\n\n<p>The error I got said:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference [recovered]\n    panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>I would like to know how to read the byte data in the message.</p>\n"}, {"tags": ["github", "go"], "comments": [{"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 1, "creation_date": 1482657450, "post_id": 41319633, "comment_id": 69843394, "body": "Is your code directly in $GOPATH/src? Than that is the problem. Even with the vendor directory your code must still be in it&#39;s own subdirectory inside the $GOPATH (e.g. $GOPATH/src/foo)"}, {"owner": {"reputation": 131, "user_id": 7339242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ab878da4fd078f0dcb559a76b960b9?s=128&d=identicon&r=PG&f=1", "display_name": "chrisWhyTea", "link": "https://stackoverflow.com/users/7339242/chriswhytea"}, "reply_to_user": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 0, "creation_date": 1482658076, "post_id": 41319633, "comment_id": 69843495, "body": "its in a subfolder ($GOPATH/src/project)"}, {"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 1, "creation_date": 1482658668, "post_id": 41319633, "comment_id": 69843622, "body": "<code>go build</code> should list the paths it searched. One of them should have &#39;(vendor tree)&#39; after the path. In your case it should list &#39;$GOPATH/src/project/vendor/github.com/google/go-github/gith&zwnj;&#8203;ub&#39;. If not, you vendor directory is not recognized by the go tool."}, {"owner": {"reputation": 131, "user_id": 7339242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ab878da4fd078f0dcb559a76b960b9?s=128&d=identicon&r=PG&f=1", "display_name": "chrisWhyTea", "link": "https://stackoverflow.com/users/7339242/chriswhytea"}, "reply_to_user": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 0, "creation_date": 1482659138, "post_id": 41319633, "comment_id": 69843734, "body": "I know that it lists them but only $GOPATH and $GOROOT are listed... so yes it doesnt recognize my vendor folder and thats what I&#39;m trying to fix ^^"}], "answers": [{"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 1, "last_activity_date": 1521991437, "last_edit_date": 1521991437, "creation_date": 1482658815, "answer_id": 41320089, "question_id": 41319633, "link": "https://stackoverflow.com/questions/41319633/vendor-folder-not-used-with-go-build/41320089#41320089", "title": "vendor folder not used with &#39;go build&#39;", "body": "<p>you could use <code>echo $GOPATH</code> in your terminal to see your path of golang in my case is <code>/home/gujarat/golang</code>. this is the default path without <code>src</code> path.</p>\n\n<p>So from here all your packages and dependencies are inside <code>src</code> in <code>$GOPATH</code>. for example here is some packages that I used in my project. </p>\n\n<pre><code>\"fmt\"\n\"github.com/myproject/lol/src/config\" // notice the first github.com\n\"gopkg.in/redis.v4\" // notice the gopkg.in\n\"log\"\n</code></pre>\n\n<p>from the above package you must have all the folder and dependencies copied in your <code>src</code> folder. like <code>github.com</code> and <code>gopkg.in</code> these are the folder that must exist if in <code>src</code> root. </p>\n\n<p>and if you cant import your <code>\"github.com/google/go-github/github\"</code> it means that your <code>github.com</code> inside your <code>src</code> doens't have this folder. hope it helps</p>\n"}, {"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 1, "creation_date": 1482667368, "post_id": 41320196, "comment_id": 69845514, "body": "Could you explain more in detail the problem and the fix please ? This might be helpful for other people."}, {"owner": {"reputation": 131, "user_id": 7339242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ab878da4fd078f0dcb559a76b960b9?s=128&d=identicon&r=PG&f=1", "display_name": "chrisWhyTea", "link": "https://stackoverflow.com/users/7339242/chriswhytea"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 3, "creation_date": 1482701638, "post_id": 41320196, "comment_id": 69852969, "body": "Well, i simply changed the $GOPATH inside my shell config file... so instead  of export GOPATH=/projects/go I changed it to export GOPATH=/Projects/go because thats was the acctual folder name.."}, {"owner": {"reputation": 380, "user_id": 1704830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d7fe8ff82fa8aa25972045b57b42d98?s=128&d=identicon&r=PG", "display_name": "djfarrelly", "link": "https://stackoverflow.com/users/1704830/djfarrelly"}, "edited": false, "score": 0, "creation_date": 1527709520, "post_id": 41320196, "comment_id": 88234618, "body": "This is exactly what happened to me. On my mac I did a <code>cd directory&#47;to&#47;my&#47;gopath</code> then ran build which broke since the directory was <code>Directory&#47;to&#47;my&#47;gopath</code>."}], "tags": [], "owner": {"reputation": 131, "user_id": 7339242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ab878da4fd078f0dcb559a76b960b9?s=128&d=identicon&r=PG&f=1", "display_name": "chrisWhyTea", "link": "https://stackoverflow.com/users/7339242/chriswhytea"}, "is_accepted": true, "score": 4, "last_activity_date": 1482659831, "creation_date": 1482659831, "answer_id": 41320196, "question_id": 41319633, "link": "https://stackoverflow.com/questions/41319633/vendor-folder-not-used-with-go-build/41320196#41320196", "title": "vendor folder not used with &#39;go build&#39;", "body": "<p>Ok found the problem: </p>\n\n<p>My MacOS File System is Case Insensitive but it looks like the go tools cant handle that... \nfixed my $GOPATH and now it works like it should... </p>\n"}, {"comments": [{"owner": {"reputation": 12097, "user_id": 544463, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3fa4c6b8b65db8891412a2aef81c88d8?s=128&d=identicon&r=PG", "display_name": "Yauhen Yakimovich", "link": "https://stackoverflow.com/users/544463/yauhen-yakimovich"}, "edited": false, "score": 0, "creation_date": 1529152722, "post_id": 44962773, "comment_id": 88777311, "body": "In fact, it is in the docs already if one looks <code>go help gopath</code>"}], "tags": [], "owner": {"reputation": 3280, "user_id": 429476, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/V3SVL.jpg?s=128&g=1", "display_name": "Alex Punnen", "link": "https://stackoverflow.com/users/429476/alex-punnen"}, "is_accepted": false, "score": 2, "last_activity_date": 1499403169, "creation_date": 1499403169, "answer_id": 44962773, "question_id": 41319633, "link": "https://stackoverflow.com/questions/41319633/vendor-folder-not-used-with-go-build/44962773#44962773", "title": "vendor folder not used with &#39;go build&#39;", "body": "<p>I got this error and struggled for a while; I update to Go 1.8.3 and was using glide version 0.12.3; and my GOPATH was set as $PWD and glide was installing everything in ./vendor folder;</p>\n\n<p>Finally got the error; <strong>THERE SHOULD BE a src folder under GOPATH and all your workspace should be under this src folder</strong></p>\n\n<p>It must be in the docs, and in dev machine I set it proper; but missed in Jenkins build</p>\n"}, {"tags": [], "owner": {"reputation": 362, "user_id": 8202594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FGi20.jpg?s=128&g=1", "display_name": "iwasidiotic", "link": "https://stackoverflow.com/users/8202594/iwasidiotic"}, "is_accepted": false, "score": 5, "last_activity_date": 1591679659, "creation_date": 1591679659, "answer_id": 62275480, "question_id": 41319633, "link": "https://stackoverflow.com/questions/41319633/vendor-folder-not-used-with-go-build/62275480#62275480", "title": "vendor folder not used with &#39;go build&#39;", "body": "<p>From go 1.12+ go modules is the new way of handling dependencies.</p>\n\n<ul>\n<li>To fix dependency version <code>go mod init</code></li>\n<li>To bring modules in vendor folder <code>go mod vendor</code></li>\n<li>To build from the vendor directory <code>go build -mod vendor -o output</code></li>\n</ul>\n"}], "owner": {"reputation": 131, "user_id": 7339242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ab878da4fd078f0dcb559a76b960b9?s=128&d=identicon&r=PG&f=1", "display_name": "chrisWhyTea", "link": "https://stackoverflow.com/users/7339242/chriswhytea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17303, "favorite_count": 0, "accepted_answer_id": 41320196, "answer_count": 4, "score": 9, "last_activity_date": 1591679659, "creation_date": 1482653382, "last_edit_date": 1482653877, "question_id": 41319633, "link": "https://stackoverflow.com/questions/41319633/vendor-folder-not-used-with-go-build", "title": "vendor folder not used with &#39;go build&#39;", "body": "<p>I'm using go-1.7 in MacOS Sierra.</p>\n\n<p>My project is inside my <em>$GOPATH/src</em> folder and has a <em>vendor</em> folder inside with all its dependencies.</p>\n\n<p>and I'm using the dependencies like this inside my code: </p>\n\n<pre><code>import (\n\"github.com/google/go-github/github\"\n)\n</code></pre>\n\n<p>Now if I run <code>go build</code> i get the message that all my dependencies I use could not be found inside the $GOROOT and $GOPATH on the other and adding \"vendor\" to my code is working:</p>\n\n<pre><code>import (\n\"vendor/github.com/google/go-github/github\"\n)\n</code></pre>\n\n<p>But as far as I understood it should be possible to to like in the first code snipped.</p>\n\n<p>ah FYI there are no symlinks etc.</p>\n"}, {"tags": ["html", "nginx", "go", "static-files"], "comments": [{"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1482704300, "post_id": 41319517, "comment_id": 69853465, "body": "are the links for your files working without the nginx proxy?. What is the generated code of your index template?, this it&#39;s to see what is the URL for the files. Also, if you go app is serving the hole site without any external resource, you don&#39;t have to set <code>root</code>, <code>index</code> and <code>try_files</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6780752"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1482782298, "post_id": 41319517, "comment_id": 69874037, "body": "The files are loading without the nginx proxy. The refs in index are pointing to the static files from the index&#39;s location. I have images, JS, and CSS that I need to load."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6780752"}, "edited": false, "score": 0, "creation_date": 1482724381, "post_id": 41324623, "comment_id": 69856104, "body": "Nothing changes after reconfiguring. Would the root configuration have something to do with it?"}], "tags": [], "owner": {"reputation": 34412, "user_id": 4862445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppXKM.jpg?s=128&g=1", "display_name": "Richard Smith", "link": "https://stackoverflow.com/users/4862445/richard-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1482701112, "creation_date": 1482701112, "answer_id": 41324623, "question_id": 41319517, "link": "https://stackoverflow.com/questions/41319517/trouble-serving-static-files-with-my-goapp-through-nginx/41324623#41324623", "title": "Trouble serving static files with my goapp through nginx", "body": "<p>You might want to separate the <code>try_files</code> and <code>proxy_pass</code> into separate locations:</p>\n\n<pre><code>location / {\n    try_files $uri $uri/ @proxy;\n}\nlocation @proxy {\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $remote_addr;\n    proxy_set_header Host $host;\n    proxy_pass http://127.0.0.1:8001;\n}\n</code></pre>\n\n<p>If the static file does not exist, the request will be forwarded to the service running on port 8001.</p>\n\n<p>See <a href=\"http://nginx.org/en/docs/http/ngx_http_core_module.html#try_files\" rel=\"nofollow noreferrer\">this document</a> for details.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6780752"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1482701112, "creation_date": 1482652173, "question_id": 41319517, "link": "https://stackoverflow.com/questions/41319517/trouble-serving-static-files-with-my-goapp-through-nginx", "title": "Trouble serving static files with my goapp through nginx", "body": "<p>I am making my first go app on an Ubuntu Server. When I run my server using either an executable or simply go run main.go, I get the initial html page to render, but none of the css, images, or js. The routes also take me to a 404 page. The only thing that seems to pass is the index.html(which is named index.gohtml as a template for go)</p>\n\n<p>All my assets are loaded when I run it on localhost and ip:port configuration on the server, however when I use nginx the assets are not loading in at all. I am assuming because of these factors that nginx is where I am coming across my issue.</p>\n\n<p>Below is what I have so far. This is my first time using nginx so I am unaware of what is necessary to configure it properly.</p>\n\n<pre><code>server {\n    listen 80 default_server;\n    listen [::]:80 default_server;\n\n\n    root /var/www/html;\n\n    index index.html index.htm index.nginx-debian.html;\n\n    server_name _;\n\n    location / {\n\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $remote_addr;\n            proxy_set_header Host $host;\n            proxy_pass http://127.0.0.1:8001;\n\n            try_files $uri $uri/ =404;\n\n    }\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1482652473, "post_id": 41319501, "comment_id": 69842619, "body": "It&#39;s called <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">struct tag</a>.  Possible duplicate of <a href=\"http://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">What are the use(s) for tags in Go?</a>"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483100268, "post_id": 41319501, "comment_id": 69993924, "body": "@RdB below is an answer with example , please accept the answer if that helped you / satsfied the requirements"}], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 5, "last_activity_date": 1487066938, "last_edit_date": 1487066938, "creation_date": 1482665179, "answer_id": 41320724, "question_id": 41319501, "link": "https://stackoverflow.com/questions/41319501/string-literals-in-go-structure-definition/41320724#41320724", "title": "String literals in GO structure definition", "body": "<p>These are struct tags. This struct tag is used by package \n<code>encoding/json</code>  to <code>Marshal</code> objects to JSON  and <code>Unmarshal</code>  JSON string to objects</p>\n\n<p>while  marshaling (encoding ) a struct to JSON string it will look for this struct tag to assign <code>JSON</code>  key name, if not present it may use the struct field name itself </p>\n\n<p>btw the syntax is wrong it has to be </p>\n\n<pre><code>type API struct {\n    Message string `json:\"message\"`\n}\n</code></pre>\n\n<p>Here is a sample program for reference <a href=\"https://play.golang.org/p/FsMGNuDB8P\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FsMGNuDB8P</a></p>\n"}], "owner": {"reputation": 1188, "user_id": 1308927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6c692ca1e6b1ad945b14b3a2f7e0850?s=128&d=identicon&r=PG", "display_name": "RdB", "link": "https://stackoverflow.com/users/1308927/rdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 769, "favorite_count": 1, "accepted_answer_id": 41320724, "answer_count": 1, "score": 3, "last_activity_date": 1487066938, "creation_date": 1482651982, "question_id": 41319501, "link": "https://stackoverflow.com/questions/41319501/string-literals-in-go-structure-definition", "title": "String literals in GO structure definition", "body": "<p>In this structure definition:</p>\n\n<pre><code>type API struct {\n    Message string \"json:message\"\n}\n</code></pre>\n\n<p>what is the meaning of the string <strong><em>\"json:message\"</em></strong> and how to access it if it is accessible.\nThank you in advance.</p>\n"}, {"tags": ["javascript", "go", "websocket"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1482636073, "post_id": 41318358, "comment_id": 69840582, "body": "I recommend you to use <a href=\"https://developers.google.com/protocol-buffers/docs/gotutorial\" rel=\"nofollow noreferrer\">Protobuf</a> or just <a href=\"http://www.json.org/\" rel=\"nofollow noreferrer\">JSON</a>"}, {"owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1482636867, "post_id": 41318358, "comment_id": 69840683, "body": "Thanks for your recommendation, i already do this with JSON before, but now is optimization phase so i need to switch to binary data. I want the solution with raw binary data like my example in javascript."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1482657435, "post_id": 41318358, "comment_id": 69843390, "body": "well time to use Flat Buffers <a href=\"https://google.github.io/flatbuffers/flatbuffers_guide_use_go.html\" rel=\"nofollow noreferrer\">google.github.io/flatbuffers/flatbuffers_guide_use_go.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 965724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5395c41b2ec6b180a1e28193596b9f49?s=128&d=identicon&r=PG", "display_name": "mlg", "link": "https://stackoverflow.com/users/965724/mlg"}, "is_accepted": false, "score": 0, "last_activity_date": 1483006344, "creation_date": 1483006344, "answer_id": 41377505, "question_id": 41318358, "link": "https://stackoverflow.com/questions/41318358/golang-dealing-with-binary-data/41377505#41377505", "title": "Golang: dealing with binary data", "body": "<p>For the uint16 you'll need the binary package. Double-check if LittleEndian is what you want.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n)\n\nfunc main() {\n    a := []byte(\"yak\")\n\n    /* opcode  */ _ = uint8(a[0])\n    /* message */ _ = binary.LittleEndian.Uint16(a[1:3])\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/HRu7C5h2a5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/HRu7C5h2a5</a></p>\n"}], "owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1172, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483006344, "creation_date": 1482634596, "question_id": 41318358, "link": "https://stackoverflow.com/questions/41318358/golang-dealing-with-binary-data", "title": "Golang: dealing with binary data", "body": "<p>I have application client(javascript)-server(golang) and the connection between them are all over websocket. I'm planing using binary messages and i want to create my own protocol for messaging like in this page <a href=\"http://agar.gcommer.com/index.php?title=Protocol\" rel=\"nofollow noreferrer\">protocol</a>.</p>\n\n<p>I'm already figure it out in javascript by using DataView but not in golang. Event the primitive data type are similar like they have int8, uint8, int16, uint16 etc, i can't figure it out.</p>\n\n<p>This is the message frame:</p>\n\n<pre><code>1      Uint8      opcode\n2      Uint16     msg\n</code></pre>\n\n<p>This is the example of javascript code handling the incoming message form websocket with message frame above:</p>\n\n<pre><code>websocket.onmessage = function(evt) {\n    var data = new DataView(evt.data);\n    var opcode = data.getUint8(0);\n    var msg = data.getUint16(1);\n}\n</code></pre>\n\n<p>Can you show me how to do it in golang? i'm using <a href=\"http://www.gorillatoolkit.org/pkg/websocket\" rel=\"nofollow noreferrer\">gorilla websocket</a>. I know that read message are in <code>[]byte</code>, but i don't know how to slice it like javascript does with DataView.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["python", "regex", "go"], "comments": [{"owner": {"reputation": 13815, "user_id": 6575931, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CumJFhlEBdA/AAAAAAAAAAI/AAAAAAAAi5U/sqexnazvXek/photo.jpg?sz=128", "display_name": "Uriel", "link": "https://stackoverflow.com/users/6575931/uriel"}, "edited": false, "score": 0, "creation_date": 1482672905, "post_id": 41317786, "comment_id": 69846729, "body": "I&#39;ll just note that <code>{0,}</code> can be <code>*</code> and <code>{0,1}</code> is <code>?</code>."}, {"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 1, "creation_date": 1482699315, "post_id": 41317786, "comment_id": 69852519, "body": "I think the answer you are trying to get is ((1.0, 1.0), (3.3, -50.0), (15.0, 25.5), (2.0, 2.0), (3.0, -2.5), (1.1, 0.0))... note the 5th pair is (3.0,-2.5) instead of (3.0,-3.5). Right?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7338666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e3e476ea7906c25f43778047cb6842?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7338666/chris"}, "edited": false, "score": 0, "creation_date": 1488233936, "post_id": 41323559, "comment_id": 72132882, "body": "Thank you so much, this was a little project I was working on over xmas and just decided to come back to - really appreciate the help!"}], "tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 1, "last_activity_date": 1482701523, "last_edit_date": 1482701523, "creation_date": 1482690557, "answer_id": 41323559, "question_id": 41317786, "link": "https://stackoverflow.com/questions/41317786/regex-to-parse-badly-formatted-polynomials/41323559#41323559", "title": "Regex to parse badly formatted polynomials", "body": "<p>The following regex will mostly do:</p>\n\n<pre><code>(?P&lt;c1&gt;[+-]? *\\d+(?:\\.\\d+)?)? *\\*? *[xX] *(?:\\^ *(?P&lt;e1&gt;-? *\\d+(?:\\.\\d+)?)|(?P&lt;e2&gt;-? *\\d+(?:\\.\\d+)?)?)|(?P&lt;c2&gt;[+-]? *\\d+(?:\\.\\d+)?)\n</code></pre>\n\n<p>I say mostly because this solution takes the \"4x^\" case as having order 1, given the requirements are already pretty lenient and otherwise trying to ignore such term makes the RE much much more complicated or even impossible because it creates an ambiguity which can not be parsed with a RE.</p>\n\n<p>Please note that absent coeficients/exponents will not be captured as '1.0' as you represent in your example result, that will have to be done after applying the regex and taking all empty capture groups as '1' (or '0' for the exponent depending on the captured groups).</p>\n\n<p><a href=\"https://regex101.com/r/GLdtTZ/3\" rel=\"nofollow noreferrer\">Here you have the regex in regex101.com</a> for checking/trying how it works.</p>\n\n<p>And here a working program in golang which tests a couple of cases:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n    \"strconv\"\n    \"strings\"\n)\n\nconst e = `(?P&lt;c1&gt;[+-]? *\\d+(?:\\.\\d+)?)? *\\*? *[xX] *(?:\\^ *(?P&lt;e1&gt;-? *\\d+(?:\\.\\d+)?)|(?P&lt;e2&gt;-? *\\d+(?:\\.\\d+)?)?)|(?P&lt;c2&gt;[+-]? *\\d+(?:\\.\\d+)?)`\n\nvar cases = []string{\n    \"y=x+3.3X^-50+ 15x25.5 - 4x^+2x^2 +3*x-2.5+1.1\",\n    \"3.3X^-50\",\n}\n\nfunc parse(d float64, ss ...string) float64 {\n    for _, s := range ss {\n        if s != \"\" {\n            c, _ := strconv.ParseFloat(strings.Replace(s, \" \", \"\", -1), 64)\n            return c\n        }\n    }\n    return d\n}\n\nfunc main() {\n    re := regexp.MustCompile(e)\n    for i, c := range cases {\n        fmt.Printf(\"testing case %v: %q\\n\", i, c)\n        ms := re.FindAllStringSubmatch(c, -1)\n        if ms == nil {\n            fmt.Println(\"no match\")\n            continue\n        }\n        for i, m := range ms {\n            fmt.Printf(\"  match %v: %q\\n\", i, m[0])\n            c := parse(1.0, m[1], m[4])\n            de := 1.0\n            if m[4] != \"\" {\n                de = 0.0\n            }\n            e := parse(de, m[2], m[3])\n            fmt.Printf(\"    c: %v\\n\", c)\n            fmt.Printf(\"    e: %v\\n\", e)\n        }\n    }\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>testing case 0: \"y=x+3.3X^-50+ 15x25.5 - 4x^+2x^2 +3*x-2.5+1.1\"\n  match 0: \"x\"\n    c: 1\n    e: 1\n  match 1: \"+3.3X^-50\"\n    c: 3.3\n    e: -50\n  match 2: \"+ 15x25.5\"\n    c: 15\n    e: 25.5\n  match 3: \"- 4x\"\n    c: -4\n    e: 1\n  match 4: \"+2x^2\"\n    c: 2\n    e: 2\n  match 5: \"+3*x-2.5\"\n    c: 3\n    e: -2.5\n  match 6: \"+1.1\"\n    c: 1.1\n    e: 0\ntesting case 1: \"3.3X^-50\"\n  match 0: \"3.3X^-50\"\n    c: 3.3\n    e: -50\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/6cga8BxoiS\" rel=\"nofollow noreferrer\">Here you have the program on golang playground</a> to try.</p>\n"}], "owner": {"reputation": 21, "user_id": 7338666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e3e476ea7906c25f43778047cb6842?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7338666/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1482701523, "creation_date": 1482624365, "question_id": 41317786, "link": "https://stackoverflow.com/questions/41317786/regex-to-parse-badly-formatted-polynomials", "title": "Regex to parse badly formatted polynomials", "body": "<p><strong>Shortish version</strong></p>\n\n<p>I am using this regex:</p>\n\n<pre><code>(^|[yY]\\s{0,}\\=|\\+|\\-)\\s{0,}([0-9]{0,}\\.?[0-9]{0,})\\s{0,}(\\*{0,1}[xX]{0,1})\\s{0,}(\\^{0,1})(-?)([0-9]{0,}\\.?[0-9]{0,})(\\s{0,}|$)?\n</code></pre>\n\n<p>To try and extract all the element coefficient and order numbers from equations like this:</p>\n\n<pre><code>y=x+3.3X^-50+ 15x25.5 - 4x^+2x^2 +3*x-2.5+1.1\n</code></pre>\n\n<p>I want the regex to ignore the erroneous <code>4x^</code> which is missing its power number (doesn't currently do this) and allow me to get to this final result:</p>\n\n<pre><code>((1.0, 1.0), (3.3, -50.0), (15.0, 25.5), (2.0, 2.0), (3.0, -3.5), (1.1, 0.0))\n</code></pre>\n\n<p>Where first coordinate is coefficient and second is order for each element. Currently the regex above 'nearly' works if I take groups 1&amp;2 and 5&amp;6 to give me the coefficient and order respectively. </p>\n\n<p>It just falls over on the erroneous <code>4x^</code> plus feels extremely inelegant, but I am somewhat noob at regex and am not sure what improvements to make.</p>\n\n<p>How can I improve this regex, and also fix so that <code>4x^</code> is considered 'wrong' but <code>4x2</code> and <code>4x^2</code> are both fine?</p>\n\n<p><strong>tl;dr version</strong></p>\n\n<p>I am trying parse polynomial equations entered by users in order to validate and then decompose the equation into a series of elements. The equations will be presented as strings.</p>\n\n<p>Here is an example of how the users are asked to format their string:</p>\n\n<pre><code>y = 2.0x^2.5 - 3.1x + 5.2\n</code></pre>\n\n<p>Where <code>x</code> is the independent variable (not a times symbol) and <code>y</code> is the dependent variable.</p>\n\n<p>In reality the users commonly make any of the following mistakes:</p>\n\n<ul>\n<li>Forgetting to include <code>y =</code></li>\n<li>Adding a <code>*</code> to coefficients such as <code>y = 2.0*x</code></li>\n<li>Using integers instead of floats, e.g. <code>y = 5x</code></li>\n<li>Missing the <code>^</code> when setting the order e.g. <code>y = x3</code> </li>\n<li>Adding or removing whitespace anywhere</li>\n</ul>\n\n<p>However, for all of these I'd say it's still easily understandable what the user is trying to write. By that I mean it is obvious what the coefficient and order are meant to be for each element.</p>\n\n<p>So what I want to do is write some regex that correctly splits the entered string into separate elements and can get me <code>A</code> (the coefficient) and <code>B</code> (the order) of each element where an element in general is of the form <code>Ax^B</code> and <code>A</code> and <code>B</code> can each be any real number.</p>\n\n<p>I devised the following example:</p>\n\n<pre><code>y=x+3.3X^-50+ 15x25.5 - 4x^+2x^2 +3*x-2.5+1.1\n</code></pre>\n\n<p>Which I believe covers all of the potential issues I outlined above, in addition to one other straight up mistake <code>4x^+2x^2</code> is missing the order on the element <code>4x^</code>.</p>\n\n<p>For this example I'd like to get to: <code>((1.0, 1.0), (3.3, -50.0), (15.0, 25.5), (2.0, 2.0), (3.0, -3.5), (1.1, 0.0))</code> where <code>4x^</code> has been ignored.</p>\n\n<p>I am somewhat new to regex but I have made an effort using regex101.com to create the following:</p>\n\n<pre><code>(^|[yY]\\s{0,}\\=|\\+|\\-)\\s{0,}([0-9]{0,}\\.?[0-9]{0,})\\s{0,}(\\*{0,1}[xX]{0,1})\\s{0,}(\\^{0,1})(-?)([0-9]{0,}\\.?[0-9]{0,})(\\s{0,}|$)?\n</code></pre>\n\n<p>This appears to nearly work, with the following issues:</p>\n\n<ul>\n<li>Does not catch missing order as per example <code>4x^</code> given above - I am not sure how to make the optionality of the order number 'conditional' on the presence of <code>^</code> whilst also working when <code>^</code> is not present but the order number is such as <code>y = 4x2</code></li>\n<li>Feels extremely in-concise / inelegant, but being inexperienced I am struggling to see where improvements can be made</li>\n</ul>\n\n<p>Also please note I am happily ignoring the issue of repeated elements with the same order not being summed, e.g. I am happy to ignore <code>y = x^2 + x^2</code> not appearing as <code>y = 2x^2</code>.</p>\n\n<p>Thank you for any help.</p>\n\n<p>p.s. Program to be written in Go, but I am also somewhat noob at Go so I am first prototyping in Python. Not sure if this will make any difference to the regex (I really am that new to regex).</p>\n"}, {"tags": ["go", "http-status-code-304"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 5559718, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1068554619822559/picture?type=large", "display_name": "jgulacsy", "link": "https://stackoverflow.com/users/5559718/jgulacsy"}, "edited": false, "score": 0, "creation_date": 1482676137, "post_id": 41318194, "comment_id": 69847405, "body": "I am just implementing the client using a third party server. My problem is that if I receive the 304 I don&#39;t have access to the response body. The strange thing is, if I manually open the url of the response it takes me to a proper json structure."}], "tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 1, "last_activity_date": 1482631291, "creation_date": 1482631291, "answer_id": 41318194, "question_id": 41317413, "link": "https://stackoverflow.com/questions/41317413/receiving-304-code-after-query-from-db-golang/41318194#41318194", "title": "Receiving 304 code after query from DB golang", "body": "<p>Are implementing the server too? Or just a client? Do you control the server? If you don't then you'll probably have to handle 304 not modified. It could be nice if the server tells you the resource has not been modified, because you may be able to short circuit some processing.</p>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 5559718, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1068554619822559/picture?type=large", "display_name": "jgulacsy", "link": "https://stackoverflow.com/users/5559718/jgulacsy"}, "is_accepted": false, "score": 0, "last_activity_date": 1482679206, "creation_date": 1482679206, "answer_id": 41322321, "question_id": 41317413, "link": "https://stackoverflow.com/questions/41317413/receiving-304-code-after-query-from-db-golang/41322321#41322321", "title": "Receiving 304 code after query from DB golang", "body": "<p>Okay, problem has been solved by waiting for 1 second and polling again.</p>\n"}], "owner": {"reputation": 117, "user_id": 5559718, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1068554619822559/picture?type=large", "display_name": "jgulacsy", "link": "https://stackoverflow.com/users/5559718/jgulacsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482679206, "creation_date": 1482619985, "question_id": 41317413, "link": "https://stackoverflow.com/questions/41317413/receiving-304-code-after-query-from-db-golang", "title": "Receiving 304 code after query from DB golang", "body": "<p>I am trying to implement an API at the moment, in the first step a session is created, and after this sesson is queried with a get request. Sometimes I get a response code of <strong>304 Not Modified \u2013 the results have not been modified since the last poll</strong>, and it seems to be all random to me. In this case I am unable to save the response into a Golang structure. It is very frustrating. Do you have any insights what could be the problem? Thanks!</p>\n\n<pre><code>client := &amp;http.Client{Timeout: 10 * time.Second}\nreq, err := http.NewRequest(\"GET\", url, nil)\nq := req.URL.Query()\nq.Add(\"apiKey\", apiKey)\nq.Add(\"sortorder\", \"asc\")\nreq.URL.RawQuery = q.Encode()\n\nif err != nil {\n    panic(err)\n}\nreq.Header.Set(\"ACCEPT\", \"application/json\")\nresp, err := client.Do(req)\nif err != nil {\n    panic(err)\n}\n\ndefer resp.Body.Close()\nif resp.StatusCode == 200{\n    if err != nil {\n        panic(err)\n    }\n}else{\n    fmt.Println(resp.StatusCode)\n}\ndata, err := ioutil.ReadAll(resp.Body)\n\nreturn []byte(data)\n</code></pre>\n"}, {"tags": ["forms", "web", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1482613413, "post_id": 41316794, "comment_id": 69837434, "body": "Show all of the request handler.  The other header write is coming from code we cannot see."}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1482629985, "post_id": 41316794, "comment_id": 69839937, "body": "You cannot call <code>http.Error</code> and then <code>http.Redirect</code> which is likely the source of your error. I&#39;m not sure if you commented it out for this post intentionally though."}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 6217784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e05ac65fb0901437371eba086fc3eec2?s=128&d=identicon&r=PG&f=1", "display_name": "gone", "link": "https://stackoverflow.com/users/6217784/gone"}, "edited": false, "score": 0, "creation_date": 1482778812, "post_id": 41316979, "comment_id": 69873010, "body": "Thank you very much! I ended up adding another gohtml template and adding this code so that when a user wrongfully fills out a form, they are redirected to the &quot;forbidden.gohtml&quot; page. Given the error message and redirected back. Thank you very much!"}], "tags": [], "owner": {"reputation": 2354, "user_id": 6540936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5365ef69ba8eeefddfaff5cc1750dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6540936/julian"}, "is_accepted": true, "score": 2, "last_activity_date": 1482712429, "last_edit_date": 1482712429, "creation_date": 1482615243, "answer_id": 41316979, "question_id": 41316794, "link": "https://stackoverflow.com/questions/41316794/golang-http-multiple-response-writeheader-calls/41316979#41316979", "title": "Golang http: multiple response.WriteHeader calls", "body": "<p>You can not send multiple responses to the same request (first the validation error (403 but 400 would be better) and then the redirection (301, ...)).</p>\n\n<p>You could use a meta tag or javascript to redirect on the client side after an delay or directly use the http redirect, like</p>\n\n<pre><code>&lt;meta http-equiv=\"refresh\" content=\"3; URL=https://your.site/\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 56, "user_id": 6217784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e05ac65fb0901437371eba086fc3eec2?s=128&d=identicon&r=PG&f=1", "display_name": "gone", "link": "https://stackoverflow.com/users/6217784/gone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 41316979, "answer_count": 1, "score": 0, "last_activity_date": 1482712429, "creation_date": 1482613206, "question_id": 41316794, "link": "https://stackoverflow.com/questions/41316794/golang-http-multiple-response-writeheader-calls", "title": "Golang http: multiple response.WriteHeader calls", "body": "<p>So I am currently writing a login and respectively a signup features for my Go web App and I am attempting to implement a feature that if you don't fill out both the required form fields \"username\" \"password\" it will give you an <code>http.Error</code> and then I am attempting to make it <code>http.Redirect</code> yet i get this error when redirecting occurs. <code>http: multiple response.WriteHeader calls</code> Here is my code..</p>\n\n<pre><code>//Check form submission\nvar u user\nif req.Method == http.MethodPost {\n    un := req.FormValue(\"username\")\n    p := req.FormValue(\"password\")\n\n\n    //Checking to see if user filled out required fields.\n    if un == \"\"{\n        http.Error(w, \"Please fill out required fields, you will be redirected shortly.\", http.StatusForbidden)\n        time.Sleep(3000 * time.Millisecond)\n        //http.Redirect(w, req, \"/\" http.StatusSeeOther)\n        return\n\n    }else if p == \"\" {\n        http.Error(w, \"Please fill out required fields, you will be redirected shortly.\", http.StatusForbidden)\n        time.Sleep(3000 * time.Millisecond)\n        //http.Redirect(w, req, \"/\", http.StatusSeeOther)\n        return\n    }\n\n    c.Value = un\n    u = user{un, p}\n\n    dbUsers[c.Value] = u\n    http.Redirect(w, req, \"/login\", http.StatusSeeOther)\n\n    log.Println(dbUsers)\n    return\n}\n</code></pre>\n\n<p>I do know that it is because of the multiple http calls within the if/else statement yet I can't quite come up with an alternative. Any help would be greatly appreciated! </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "edited": false, "score": 1, "creation_date": 1482616782, "post_id": 41317057, "comment_id": 69838057, "body": "The time zone there is UTC, so that&#39;s why you&#39;re getting &quot;+0000&quot;."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1482616358, "last_edit_date": 1482616358, "creation_date": 1482615951, "answer_id": 41317057, "question_id": 41316596, "link": "https://stackoverflow.com/questions/41316596/timezone-string-formatting/41317057#41317057", "title": "TimeZone string formatting", "body": "<p>You don't need to call <code>Local()</code> there since <code>time.Now()</code> returns local time. When I try to run your code on my machine, I get the correct result. It looks like the time zone where you're running this is UTC. (You can see the time zone by printing the result of <code>time.Now().Zone()</code>).</p>\n\n<p><code>gmtime</code> in Python returns UTC time. In Go, you can convert a time to UTC by calling <code>In(time.UTC)</code> on the time value. (I'm not a Python expert, and I don't know why the time zone of <code>gmtime()</code> is reported as the local time zone (I reproduced that on my machine).)</p>\n"}], "owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 41317057, "answer_count": 1, "score": 1, "last_activity_date": 1482616358, "creation_date": 1482610952, "question_id": 41316596, "link": "https://stackoverflow.com/questions/41316596/timezone-string-formatting", "title": "TimeZone string formatting", "body": "<p>How can I translate this code from Python to Go?</p>\n\n<pre><code>&gt;&gt;&gt; from time import gmtime\n&gt;&gt;&gt; from time import strftime\n&gt;&gt;&gt; strftime(\"%z\", gmtime())\n'-0800'\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Println(time.Now().Local().Format(\"-0700\"))\n}\n</code></pre>\n\n<p>But it's obviously not working:</p>\n\n<pre><code>+0000\n</code></pre>\n\n<p>I am somewhat confused in general about the formatting part of time because the const symbols (e.g. <code>stdNumTZ</code>) are not exported from the <code>time</code> package.</p>\n\n<p>Is <code>time.Now().Local()</code> in Go the real substitute for <code>gmtime.gmtime()</code> in Python?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 11, "last_activity_date": 1482599040, "creation_date": 1482599040, "answer_id": 41315277, "question_id": 41314959, "link": "https://stackoverflow.com/questions/41314959/assigning-values-to-multiple-variables-in-go/41315277#41315277", "title": "Assigning values to multiple variables in Go", "body": "<p>This is how it's <a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">specified</a>:</p>\n\n<blockquote>\n  <p>The assignment proceeds in two phases. First, the operands of index expressions and pointer indirections (including implicit pointer indirections in selectors) on the left and the expressions on the right are all evaluated in the usual order. Second, the assignments are carried out in left-to-right order.</p>\n</blockquote>\n\n<p>Assignment first evaluates all expressions on the right side and then assigns the results to the variables on the left side.</p>\n\n<p>Your </p>\n\n<pre><code>x, y = y, x+y\n</code></pre>\n\n<p>is basically equivalent to this</p>\n\n<pre><code>tmp1 := y\ntmp2 := x+y\nx = tmp1\ny = tmp2\n</code></pre>\n\n<p>You can even use this fact to swap 2 variables in one line, like this:</p>\n\n<pre><code>a, b = b, a\n</code></pre>\n"}], "owner": {"reputation": 2169, "user_id": 4564505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qRYlQ.jpg?s=128&g=1", "display_name": "pavlos163", "link": "https://stackoverflow.com/users/4564505/pavlos163"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4119, "favorite_count": 3, "accepted_answer_id": 41315277, "answer_count": 1, "score": 5, "last_activity_date": 1482599040, "creation_date": 1482596703, "question_id": 41314959, "link": "https://stackoverflow.com/questions/41314959/assigning-values-to-multiple-variables-in-go", "title": "Assigning values to multiple variables in Go", "body": "<p>I recently came up across this:</p>\n\n<pre><code>func main() {\n    x, y := 0, 1\n    x, y = y, x+y\n    fmt.Println(y)\n}\n</code></pre>\n\n<p>What I thought was that:</p>\n\n<pre><code>x, y = y, x+y\n</code></pre>\n\n<p>Is identical to:</p>\n\n<pre><code>x = y\ny = x+y\n</code></pre>\n\n<p>Which would result to final values <code>x = 1, y = 2</code></p>\n\n<p>However the final values I get is <code>x = 1, y = 1</code></p>\n\n<p>Why is that?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["assembly", "go", "x86"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1482595469, "post_id": 41314733, "comment_id": 69832951, "body": "Well, +1 -- it doesn&#39;t seem to be mentioned in x64 instruction sets, so it is kind of unusual to find it in working code. A comment in one of these sources remarks &quot;MOVOU seems always faster than REP STOSL.&quot; but that&#39;s about it."}, {"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 1, "creation_date": 1482601863, "post_id": 41314733, "comment_id": 69834642, "body": "Related: <a href=\"https://codereview.appspot.com/133740043/\" rel=\"nofollow noreferrer\">Add MOVDQA and MOVDQU instructions</a>"}, {"owner": {"reputation": 85, "user_id": 5593831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5180h.jpg?s=128&g=1", "display_name": "templexxx", "link": "https://stackoverflow.com/users/5593831/templexxx"}, "reply_to_user": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 1, "creation_date": 1482602452, "post_id": 41314733, "comment_id": 69834796, "body": "@AshwiniChaudhary thank you. That&#39;s what I need. The O stands for octo-word. How did you find that? I have tried many ways but nothing found"}, {"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 0, "creation_date": 1482603618, "post_id": 41314733, "comment_id": 69835102, "body": "@templexxx Glad that helped. My query was <b>&quot;movou&quot; in golang</b>, it lead me to: <a href=\"https://groups.google.com/d/msg/golang-nuts/aPjvemV4F0U/lPv5rJeOhfMJ\" rel=\"nofollow noreferrer\">groups.google.com/d/msg/golang-nuts/aPjvemV4F0U/lPv5rJeOhfMJ</a>"}, {"owner": {"reputation": 85, "user_id": 5593831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5180h.jpg?s=128&g=1", "display_name": "templexxx", "link": "https://stackoverflow.com/users/5593831/templexxx"}, "reply_to_user": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 0, "creation_date": 1482605223, "post_id": 41314733, "comment_id": 69835535, "body": "@AshwiniChaudhary I never tried  &quot;&quot; &amp; in. That&#39;s funny. I think I need to spend more time on how to search on Google. Thank you"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1482614035, "post_id": 41314733, "comment_id": 69837551, "body": "From that page: &quot;.. SSE registers are X0...X15. MOVDQA is called MOVO (or MOVOA) and MOVDQU is called MOVOU.&quot; But why isn&#39;t it in x86 opcode listings? Even an explicit search for <code>sse movou</code> yields mainly those same Go-Lang sources!"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 3, "creation_date": 1482621193, "post_id": 41314733, "comment_id": 69838830, "body": "Because Golang has invented their own assembly language, @rad. MOVO and MOVOU are <i>not</i> Intel-defined opcodes."}, {"owner": {"reputation": 85, "user_id": 5593831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5180h.jpg?s=128&g=1", "display_name": "templexxx", "link": "https://stackoverflow.com/users/5593831/templexxx"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1482633871, "post_id": 41314733, "comment_id": 69840323, "body": "@RadLexus For example: Golang has no SUB but SUBQ"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1574095846, "post_id": 41314733, "comment_id": 104100048, "body": "@CodyGray Correction: Go took the Plan 9 assembly language and extended it to support SSE and AVX.  The Plan 9 assembler was primarily designed to have identical syntax and opcodes on all platforms, which is why its mnemonics are different from Intel&#39;s."}], "answers": [{"comments": [{"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1515821980, "post_id": 48229842, "comment_id": 83457028, "body": "So Go uses O (as in Oct-word) everywhere instead of DQ (double-quad)?  Intel hasn&#39;t been consistent either (<code>cqo</code> mnemonic vs. SSE2 and other SIMD instructions), although maybe that&#39;s AMD&#39;s fault.  I guess AMD64 introduced the <code>cqo</code> mnemonic.  Heh, we could have had <code>cqdq</code> to go with <code>punpcklqdq</code> if Intel had been naming things."}, {"owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "reply_to_user": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1515822140, "post_id": 48229842, "comment_id": 83457050, "body": "@PeterCordes, starting from AVX, it&#39;s Intel instruction names. If any of them mismatch -- it&#39;s a bug. Prior to that, I don&#39;t think stuff like &quot;everywhere&quot; applies, because there are lot&#39;s of inconsistencies here and there."}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1515823189, "post_id": 48229842, "comment_id": 83457179, "body": "So Go uses <code>vmovdqa (AX), x1</code> for an AVX-128 load, but <code>movo (AX), x1</code> for the non-VEX legacy SSE encoding (which leaves the upper part of ymm1 / zmm1 unmodified)?  That&#39;s interesting...  But yes, probably good to stop making up their own names; it could get really confusing really quickly once you start to get Intel instruction mnemonics that include numbers, too, like AVX512BW <code>vmovdqu8</code> (which masks with 8-bit granularity) or <a href=\"https://github.com/HJLebbink/asm-dude/wiki/VSHUFF32x4_VSHUFF64x2_VSHUFI32x4_VSHUFI64x2\" rel=\"nofollow noreferrer\"><code>VSHUFF32x4</code></a> (different granularity masking for 128b lane shuffles)"}, {"owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "reply_to_user": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1515824152, "post_id": 48229842, "comment_id": 83457330, "body": "@PeterCordes, yes, that is correct, <code>VMOVDQA</code> for AVX1 instruction."}], "tags": [], "owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "is_accepted": true, "score": 5, "last_activity_date": 1515778149, "last_edit_date": 1515778149, "creation_date": 1515772839, "answer_id": 48229842, "question_id": 41314733, "link": "https://stackoverflow.com/questions/41314733/what-does-movou-mean-in-golang-assembly/48229842#48229842", "title": "What does &quot;MOVOU&quot; mean in golang assembly", "body": "<p>Unfortunately, there are lots of weird names, inconsistencies and issues in Go x86 syntax.</p>\n\n<p>As already pointed in comments, the MOVOU is MOVDQU.</p>\n\n<p>I try to maintain <a href=\"https://quasilyte.github.io/blog/post/go-asm-complementary-reference/\" rel=\"nofollow noreferrer\">Go assembly complementary reference</a>, which fills some documentation gaps of official documentation, but currently it's pretty out-of-date and requires some cleanup.\nPlanning to write AVX512 details there, when <a href=\"https://github.com/golang/go/issues/22779\" rel=\"nofollow noreferrer\">implementation details</a> are stabilized. \nI hope it is useful for quick <code>ctrl+F</code> search for some Go asm questions.</p>\n\n<p>For your particular question, it's definitely useful:</p>\n\n<p><a href=\"https://i.stack.imgur.com/z9p2p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z9p2p.png\" alt=\"enter image description here\"></a></p>\n\n<p>You may find <a href=\"https://github.com/golang/arch/blob/master/x86/x86.v0.2.csv\" rel=\"nofollow noreferrer\">x86.v0.2.csv</a> useful, as it gives you Intel, GNU and Go syntax for each listed instruction.\nAs <code>v0.2</code> in name suggests, there will be updates and fixes in future.</p>\n\n<p>To make things worse, there are <a href=\"https://quasilyte.github.io/blog/files/go_x86_aliases.txt\" rel=\"nofollow noreferrer\">aliases</a> that allow you to write, for example, <code>PADDD</code> instead of <code>PADDL</code>.\nThis is unlikely to ever change due to backwards-compatibility.</p>\n\n<p>To avoid completely negative impression, there are some stuff that Go asm \"does well\". For example, it checks immediate operands widths for instructions that expect only lower N bits to be set. \nIt also does not permit negative constants for \"unsigned\" immediate operands.<br>\n(as a bonus, here is an issue that contains some Russ Cox thoughts on this topic: <a href=\"https://github.com/golang/go/issues/21528\" rel=\"nofollow noreferrer\">issue21528</a>.)</p>\n"}], "owner": {"reputation": 85, "user_id": 5593831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5180h.jpg?s=128&g=1", "display_name": "templexxx", "link": "https://stackoverflow.com/users/5593831/templexxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 48229842, "answer_count": 1, "score": 6, "last_activity_date": 1515778149, "creation_date": 1482594944, "last_edit_date": 1482599732, "question_id": 41314733, "link": "https://stackoverflow.com/questions/41314733/what-does-movou-mean-in-golang-assembly", "title": "What does &quot;MOVOU&quot; mean in golang assembly", "body": "<p>When I was reading some Golang's asm codes, I found <code>MOVOU</code>. And I can't get anything about this instruction by searching on Google.</p>\n\n<p>For example: <a href=\"https://github.com/golang/go/blob/master/src/runtime/asm_amd64.s#L933\" rel=\"noreferrer\">src/runtime/asm_amd64.s#L933</a></p>\n\n<pre><code>MOVOU   -16(AX), X1\n</code></pre>\n"}, {"tags": ["go", "proxy", "http-proxy"], "comments": [{"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 1, "creation_date": 1482590410, "post_id": 41313949, "comment_id": 69831699, "body": "You should be writing the response&#39;s body to <code>w</code> not the whole response(http headers + body): <code>body, _ := ioutil.ReadAll(resp.Body); w.Write(body)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 3782101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Skytp.jpg?s=128&g=1", "display_name": "Jspdown", "link": "https://stackoverflow.com/users/3782101/jspdown"}, "edited": false, "score": 0, "creation_date": 1572524226, "post_id": 41315867, "comment_id": 103591584, "body": "I struggled to understand why io.Copy has to be after w.WriteHeader. Looking at the http documentation I found this: &quot;If WriteHeader has not yet been called, Write calls WriteHeader(http.StatusOK) before writing the data. If the Header does not contain a Content-Type line, Write adds a Content-Type set to the result of passing the initial 512 bytes of written data to DetectContentType. Additionally, if the total size of all written data is under a few KB and there are no Flush calls, the Content-Length header is added automatically.&quot; <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 10, "last_activity_date": 1482604942, "last_edit_date": 1482604942, "creation_date": 1482603928, "answer_id": 41315867, "question_id": 41313949, "link": "https://stackoverflow.com/questions/41313949/how-to-dump-a-response-of-an-http-get-request-and-write-it-in-http-responsewrite/41315867#41315867", "title": "How to dump a response of an HTTP GET request and write it in http.ResponseWriter", "body": "<p>Copy the headers, status and response body to the response writer:</p>\n\n<pre><code>resp, err :=http.Get(\"http://google.com\")\nif err != nil {\n    // handle error\n}\ndefer resp.Body.Close()\n\n// headers\n\nfor name, values := range resp.Header {\n    w.Header()[name] = values\n}\n\n// status (must come after setting headers and before copying body)\n\nw.WriteHeader(resp.StatusCode)\n\n// body\n\nio.Copy(w, resp.Body)\n</code></pre>\n\n<p>If you are creating a proxy server, then the <a href=\"https://godoc.org/net/http/httputil#ReverseProxy\" rel=\"noreferrer\">net/http/httputil ReverseProxy type</a> might be of help.</p>\n"}], "owner": {"reputation": 429, "user_id": 6893963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154623771900712/picture?type=large", "display_name": "Louis Ng", "link": "https://stackoverflow.com/users/6893963/louis-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3831, "favorite_count": 3, "accepted_answer_id": 41315867, "answer_count": 1, "score": 3, "last_activity_date": 1555240856, "creation_date": 1482588393, "last_edit_date": 1555240856, "question_id": 41313949, "link": "https://stackoverflow.com/questions/41313949/how-to-dump-a-response-of-an-http-get-request-and-write-it-in-http-responsewrite", "title": "How to dump a response of an HTTP GET request and write it in http.ResponseWriter", "body": "<p>I am trying to do it to dump the response of an HTTP GET request and write the very same response in an <code>http.ResponseWriter</code>. Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"net/http/httputil\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    resp, _ := http.Get(\"http://google.com\")\n    dump, _ := httputil.DumpResponse(resp,true)\n    w.Write(dump)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>I get a full page of HTML code of google.com instead of the Google front page. Is there a way I can achieve a proxy-like effect?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1482547415, "post_id": 41309725, "comment_id": 69822980, "body": "You can reinitialize with <code>init_db()</code>"}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1482618491, "post_id": 41309725, "comment_id": 69838331, "body": "It won&#39;t be possible to call get/put from other modules because these symbols are not exported. The first letter must be uppercase for the symbol/identifier to be exported. Kvstore is defined as a global variable but since it&#39;s first letter is not uppercase, it&#39;s not directly visible and accessible from external modules. It&#39;s like a static variable in C."}], "answers": [{"comments": [{"owner": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 1, "creation_date": 1482546498, "post_id": 41309786, "comment_id": 69822851, "body": "That&#39;s not entirely accurate. The current implementation allows one to safely use put/get without calling init_db. init_db can be used to clear the db. Whether that&#39;s desirable is a different story but the double initialization is not equivalent to the single init."}, {"owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "reply_to_user": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 0, "creation_date": 1482547429, "post_id": 41309786, "comment_id": 69822983, "body": "@pvg Good point. I think <code>init_db</code> should be renamed to <code>clear_db</code>, because whenever you call the function it always just <b>clear the db</b>. And <code>init_db</code> sounds like a function that must called before using some library/module."}, {"owner": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 1, "creation_date": 1482548379, "post_id": 41309786, "comment_id": 69823121, "body": "It seems to be some skeleton/starter code from a CMU distributed systems class. So there&#39;s probably no changing it or thinking too many deep thoughts about its design! <a href=\"https://github.com/CMU-440-F16/p0\" rel=\"nofollow noreferrer\">github.com/CMU-440-F16/p0</a>"}, {"owner": {"reputation": 1028, "user_id": 2334787, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/JYVGB.jpg?s=128&g=1", "display_name": "Nullpointer", "link": "https://stackoverflow.com/users/2334787/nullpointer"}, "reply_to_user": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 0, "creation_date": 1482719952, "post_id": 41309786, "comment_id": 69855555, "body": "@pvg yes, this is the code from CMU distributed class assignment."}, {"owner": {"reputation": 1028, "user_id": 2334787, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/JYVGB.jpg?s=128&g=1", "display_name": "Nullpointer", "link": "https://stackoverflow.com/users/2334787/nullpointer"}, "edited": false, "score": 0, "creation_date": 1482720018, "post_id": 41309786, "comment_id": 69855567, "body": "@cshu: Regarding the variable <code>kvstore</code>. If we declare some variable globally in some module then does it mean it will be globally accessible to all other modules? (contrary to &#39;C&#39; where you need <code>extern</code> keyword for that)"}, {"owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "reply_to_user": {"reputation": 1028, "user_id": 2334787, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/JYVGB.jpg?s=128&g=1", "display_name": "Nullpointer", "link": "https://stackoverflow.com/users/2334787/nullpointer"}, "edited": false, "score": 0, "creation_date": 1482722076, "post_id": 41309786, "comment_id": 69855827, "body": "@Nullpointer <code>Kvstore</code> is globally accessible. <code>kvstore</code> is not. The capital letter determines accessibility. Actually package is closer to namespace in C++. Storage Duration, Namespace, and Linkage. These 3 are 3 different things."}], "tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1482546515, "last_edit_date": 1482546515, "creation_date": 1482546339, "answer_id": 41309786, "question_id": 41309725, "link": "https://stackoverflow.com/questions/41309725/variable-initialization-scope-in-golang/41309786#41309786", "title": "Variable initialization &amp; scope in Golang", "body": "<p>There is no need to initialize kvstore twice.</p>\n\n<p>You can think of the global kvstore variable as something similar to variable with static duration in C. And it's not safe to access map concurrently with writes. You might need to synchronize, just like accessing static global variable in C.</p>\n"}], "owner": {"reputation": 1028, "user_id": 2334787, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/JYVGB.jpg?s=128&g=1", "display_name": "Nullpointer", "link": "https://stackoverflow.com/users/2334787/nullpointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 617, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482546515, "creation_date": 1482545481, "question_id": 41309725, "link": "https://stackoverflow.com/questions/41309725/variable-initialization-scope-in-golang", "title": "Variable initialization &amp; scope in Golang", "body": "<p>I am learning go lang and I came across below code </p>\n\n<pre><code>var kvstore = make(map[string][]byte)\n\n// this function instantiates the database\nfunc init_db() {\n    kvstore = make(map[string][]byte)\n}\n\n// put inserts a new key value pair or updates the value for a\n// given key in the store\nfunc put(key string, value []byte) {\n    kvstore[key] = value\n}\n\n// get fetches the value associated with the key\nfunc get(key string) []byte {\n    v, _ := kvstore[key]\n    return v\n}\n</code></pre>\n\n<p>I have 2 doubts:</p>\n\n<ol>\n<li><p>why is it required to initialize <code>kvstore</code> variable once globally and then once in <code>init_db</code> function?</p></li>\n<li><p>When someone calls <code>put/get</code> function from other module how is the state of kvstore maintained? (In 'C' we generally have to explicitly pass the data structure to the function but in this case put or get directly works on global kvstore variable)</p></li>\n</ol>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "edited": false, "score": 0, "creation_date": 1482582362, "post_id": 41310345, "comment_id": 69829722, "body": "I feel shame about not coming up with this. Thanks a lot"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1482555496, "last_edit_date": 1482555496, "creation_date": 1482554029, "answer_id": 41310345, "question_id": 41309499, "link": "https://stackoverflow.com/questions/41309499/returning-error-value-in-reflect-makefunc/41310345#41310345", "title": "Returning error value in reflect.MakeFunc", "body": "<p>Use this line to set <code>secondValue</code>:</p>\n\n<pre><code>secondValue := reflect.ValueOf(&amp;err).Elem()\n</code></pre>\n\n<p>The call <code>ValueOf(&amp;err)</code> returns a <code>reflect.Value</code> with type <code>*error</code>.  Calling <code>Elem()</code> on that value returns a <code>reflect.Value</code> with type <code>error</code>.</p>\n\n<p>The call <code>ValueOf(err)</code> returns a <code>reflect.Value</code> with the type of the concrete value of <code>err</code> or an invalid <code>reflect.Value</code> if there is no concrete value in <code>err</code> (<code>err == nil</code>). Either way, the returned <code>reflect.Value</code> does not have type <code>error</code>.</p>\n"}], "owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 41310345, "answer_count": 1, "score": 1, "last_activity_date": 1482555496, "creation_date": 1482542246, "question_id": 41309499, "link": "https://stackoverflow.com/questions/41309499/returning-error-value-in-reflect-makefunc", "title": "Returning error value in reflect.MakeFunc", "body": "<p>I am trying to create an return a function in golang which has a return type of (SomeStruct, error) (standard error interface)</p>\n\n<pre><code>fn := func (args []reflect.Value) []reflect.Value {\n    database := mongoConnectorInstance.GetDatabase()\n    defer database.Session.Close()\n\n    selector := bson.M{\n        field : args[0].Interface(),\n    }\n\n    newValue := reflect.New(fieldFunctionValue.Type().Out(0))\n    newValueInterface := newValue.Interface()\n    fmt.Println(reflect.TypeOf(newValueInterface))\n\n    err := database.C(collection).Find(selector).One(newValueInterface)\n\n    secondValue := reflect.ValueOf(err)\n    return []reflect.Value {\n        newValue.Elem(),\n        secondValue,\n    }\n}\n\nresultFunctionValue := reflect.MakeFunc(fieldFunctionValue.Type(), fn)\n</code></pre>\n\n<p>If err returned by <code>.One</code> function is null, I get address pointer error on this line, internally in golang :</p>\n\n<pre><code>panic(\"reflect: function created by MakeFunc using \" + funcName(f) +\n                    \" returned wrong type: have \" +\n                    out[i].typ.String() + \" for \" + typ.String())\n</code></pre>\n\n<p>I have tried to change the line of secondValue assignment to :</p>\n\n<pre><code>secondValue := reflect.ValueOf((error)(nil)) \n</code></pre>\n\n<p>in the case where <code>err == nil</code>, however the problem did not go away.</p>\n\n<p>If I create a dummy error struct that implements the interface error and return that, ignoring error return value has to be nil when it is really nil, then it complains that <code>the return value by the function made by makeFunc is incorrect</code></p>\n\n<p>Can you think of a way to solve this problem? (Except wrapping the error in a struct, and changing the return type to that struct instead )</p>\n"}, {"tags": ["go", "static-site", "hugo"], "answers": [{"tags": [], "owner": {"reputation": 734, "user_id": 201526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5de6b8edb4455c78dbb5ac56f2438e?s=128&d=identicon&r=PG", "display_name": "Skrylar", "link": "https://stackoverflow.com/users/201526/skrylar"}, "is_accepted": false, "score": 1, "last_activity_date": 1484464469, "creation_date": 1484464469, "answer_id": 41658754, "question_id": 41309310, "link": "https://stackoverflow.com/questions/41309310/how-to-create-a-page-to-render-permalink-in-hugo/41658754#41658754", "title": "How to create a page to render permalink in Hugo", "body": "<p>The easiest way to do this was found on the Hugo forums, and the answer is to use a Taxonomy for every year. Each post needs to be placed in to that year's taxonomy and a custom listing template is used to generate the pages. This will allow Hugo to create an index page for each \"year\" (taxonomy) where the entries are the \"month.\" It's a creative solution, although more cumbersome than one would like.</p>\n\n<p><a href=\"https://discuss.gohugo.io/t/pagination-and-group-by-date/1441\" rel=\"nofollow noreferrer\">https://discuss.gohugo.io/t/pagination-and-group-by-date/1441</a></p>\n"}], "owner": {"reputation": 579, "user_id": 1902919, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2c8c5fc84d8adc4a843eabdedb8ecb91?s=128&d=identicon&r=PG", "display_name": "Mark Dee", "link": "https://stackoverflow.com/users/1902919/mark-dee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1246, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1484464469, "creation_date": 1482539819, "question_id": 41309310, "link": "https://stackoverflow.com/questions/41309310/how-to-create-a-page-to-render-permalink-in-hugo", "title": "How to create a page to render permalink in Hugo", "body": "<p>I followed this <a href=\"https://gohugo.io/extras/permalinks/\" rel=\"noreferrer\">tutorial</a> in Hugo and its working fine. Basically I have the following content:</p>\n\n<pre><code>- content\n  `- post\n     `- coding\n        `- html\n           `- my-post.md\n</code></pre>\n\n<p>and my config file set to</p>\n\n<pre><code>[permalinks]\n  post = \"/:year/:month/:title/\"\n</code></pre>\n\n<p>which gives me the URL</p>\n\n<pre><code>http://example.com/2016/12/my-post/\n</code></pre>\n\n<p>What I want is for readers to see a list of post based on a date or year. For example if they visit <code>http://example.com/2016/12/</code> they will see a list of post published in December. If they visit <code>http://example.com/2016/</code> they will see a list of post published in 2016.</p>\n\n<p>Is there any way to do that in Hugo?</p>\n"}, {"tags": ["debugging", "go", "oauth", "oauth2"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1482536505, "post_id": 41308650, "comment_id": 69821166, "body": "Try calling <code>tconf.Client.Token</code>; does that give you a valid token?"}, {"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1482610859, "post_id": 41308650, "comment_id": 69836901, "body": "<code>tconf.Client.Token undefined (type func(&quot;golang.org&#47;x&#47;net&#47;context&quot;.Context) *http.Client has no field or method Token)</code> was the error I got. However, <code>tok, err := tconf.Token(context.Background())</code> returned the same error message I am trying to debug."}], "owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 589, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482610881, "creation_date": 1482533402, "last_edit_date": 1482610881, "question_id": 41308650, "link": "https://stackoverflow.com/questions/41308650/debugging-2-legged-oauth2-in-go", "title": "Debugging 2-legged OAuth2 in Go", "body": "<p>I am working on implementing a client library for a remote API which uses 2-legged OAuth2 for authentication.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"golang.org/x/oauth2/clientcredentials\"\n    \"golang.org/x/net/context\"\n)\n\ntype SpecialClient struct {\n    *http.Client\n}\n\nfunc NewClient(cid, cis string) *SpecialClient {\n    tconf := clientcredentials.Config{\n        ClientID:     cid,\n        ClientSecret: cis,\n        TokenURL:     \"http://some.remote.resource/token\",\n    }\n\n    c := tconf.Client(context.Background())\n    return &amp;SpecialClient{c}\n}\n\nfunc main() {\n    c := NewClient(\"clientID\", \"clientSecret\")\n    c.Get(\"http://some.remote.resource/path/to/resource\")\n}\n</code></pre>\n\n<p>It is extremely straightforward. Right now, I think the remote API's OAuth2 implementation is broken, as it's not returning a token properly according to <a href=\"https://tools.ietf.org/html/rfc6749\" rel=\"nofollow noreferrer\">RFC 6749</a>. I'm trying to debug the client creation with <code>golang.org/x/oauth2/clientcredentials</code>, but I cannot determine at which point a token is fetched from the token URL. I've stepped through almost 100 calls with <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow noreferrer\">delve</a>, and I do not see the client creating a new request to fetch a token. Is there a way I can review the request created by the <code>*http.Client</code> used to retrieve the token?</p>\n"}, {"tags": ["arrays", "memory", "go", "slice"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1482525513, "post_id": 41306956, "comment_id": 69818121, "body": "<a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1482521850, "creation_date": 1482521850, "answer_id": 41307016, "question_id": 41306956, "link": "https://stackoverflow.com/questions/41306956/what-are-the-costs-associated-with-increasing-the-capacity-of-an-array-slice-in/41307016#41307016", "title": "What are the costs associated with increasing the capacity of an array slice in Go?", "body": "<p>The slice capacity is just the size of the backing array. You only need to set the capacity if you know you will be appending to the slice, and want to avoid future allocations and copies. If you're not using <code>append</code> (or the rare case of manually resizing by slicing past the length), then the additional capacity serves no purpose.</p>\n\n<p>In most cases, the relative cost of appending to an array is so little that you can just let <code>append</code> allocate and copy as needed.</p>\n"}], "owner": {"reputation": 163, "user_id": 2390898, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qKT68.jpg?s=128&g=1", "display_name": "R. Duke", "link": "https://stackoverflow.com/users/2390898/r-duke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 1, "accepted_answer_id": 41307016, "answer_count": 1, "score": 2, "last_activity_date": 1482521850, "creation_date": 1482521548, "question_id": 41306956, "link": "https://stackoverflow.com/questions/41306956/what-are-the-costs-associated-with-increasing-the-capacity-of-an-array-slice-in", "title": "What are the costs associated with increasing the capacity of an array slice in Go?", "body": "<p>The Tour of Go states that: \"Slices can be created with the built-in make function; this is how you create dynamically-sized arrays. The make function allocates a zeroed array and returns a slice that refers to that array\". I'd like to know what the cost of increasing array slice capacity is.</p>\n\n<p>E.g. what would be the difference in memory usage between these two array slices:</p>\n\n<pre><code>a := make([]int, 0, 5) // len(a)=0, cap(a)=5\nb := make([]int, 0, 1000) // len(b)=0, cap(b)=1000\n</code></pre>\n\n<p>Does giving an array slice a capacity of x just create an array of that slice in memory or does it do something else? Is it better to keep the capacity size of an array slice close to its actual size or is it cheap to increase the capacity to avoid the costs of future resizing? </p>\n\n<p>Thanks in advance for your time and wisdom.</p>\n"}, {"tags": ["go", "synchronization"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482512706, "post_id": 41305244, "comment_id": 69813187, "body": "Please include where exactly the race detector shows the read and write access."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1482512817, "post_id": 41305244, "comment_id": 69813240, "body": "Yeah, you built with the <code>-race</code> flag right? With that Go will tell you right where the problem is. Without it, you may be hitting some sort of worst-case corrupted memory detection error."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1482513685, "post_id": 41305244, "comment_id": 69813640, "body": "From this code I don&#39;t see any obvious problems. Except that this can&#39;t be all of the code, or why did you use a RWLock as only a simple Mutex? This code never read locks it. I suspect a goroutine or other structure has and is using a pointer to your map."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1482513830, "post_id": 41305244, "comment_id": 69813696, "body": "It might be something sneaky like passing a CCache object into a goroutine or a defer function through a closure, so you don&#39;t see how it got outside of a lock on first sight."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1482514074, "post_id": 41305244, "comment_id": 69813804, "body": "<a href=\"http://stackoverflow.com/a/36167319/13422\">stackoverflow.com/a/36167319/13422</a>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1482517087, "post_id": 41305244, "comment_id": 69815041, "body": "It does look like a problem with the lock. One thing that can cause this is if you <b>ever, anywhere, made a COPY of that sync.RWMutex</b>. Don&#39;t ever do that."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1482517213, "post_id": 41305244, "comment_id": 69815099, "body": "You may want to try declaring <code>lock</code> as a pointer to a RWMutex which could solve a lock copy problem."}, {"owner": {"reputation": 2763, "user_id": 2074467, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8e3be260bc0d9477984286415c2179ad?s=128&d=identicon&r=PG", "display_name": "replay", "link": "https://stackoverflow.com/users/2074467/replay"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1482517431, "post_id": 41305244, "comment_id": 69815187, "body": "@ZanLynx you were totally right, I created a copy of the lock"}], "answers": [{"tags": [], "owner": {"reputation": 2763, "user_id": 2074467, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8e3be260bc0d9477984286415c2179ad?s=128&d=identicon&r=PG", "display_name": "replay", "link": "https://stackoverflow.com/users/2074467/replay"}, "is_accepted": false, "score": 2, "last_activity_date": 1482517362, "creation_date": 1482517362, "answer_id": 41306175, "question_id": 41305244, "link": "https://stackoverflow.com/questions/41305244/go-detects-concurrent-read-and-write-on-map-despite-locks/41306175#41306175", "title": "Go detects concurrent read and write on map despite locks", "body": "<p>A colleague of mine has found the answer:</p>\n\n<p>After calling <code>NewCCache()</code> I copied the returned variable by value (including the lock) and then called <code>Add()</code> on the copy, at the same time the <code>evictLoop()</code> go routine was still referring to the old copy. So they were operating on different copies of the lock :)</p>\n"}], "owner": {"reputation": 2763, "user_id": 2074467, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8e3be260bc0d9477984286415c2179ad?s=128&d=identicon&r=PG", "display_name": "replay", "link": "https://stackoverflow.com/users/2074467/replay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482517362, "creation_date": 1482512556, "last_edit_date": 1482514209, "question_id": 41305244, "link": "https://stackoverflow.com/questions/41305244/go-detects-concurrent-read-and-write-on-map-despite-locks", "title": "Go detects concurrent read and write on map despite locks", "body": "<p>I'm writing a simple caching mechanism which has an <code>Add</code> an <code>Evict</code> and a <code>Search</code> method. The <code>Search</code> is currently not implemented yet, so there's no need to worry about that. </p>\n\n<p>There's a relatively large number of goroutines that call <code>Add</code> to add data and there's only one which runs in an evict loop to evict data. As soon as I put some serious traffic on it Go throws up saying there's a concurrent read and write access on the map <code>metricCache</code>, but I can't see how that can happen because there are locks around it. I'm using Go 1.7.</p>\n\n<p>File <code>mdata/cache.go</code>:</p>\n\n<pre><code>57: func NewCCache() *CCache {\n58:     cc := &amp;CCache{\n59:         lock:        sync.RWMutex{},\n60:         metricCache: make(map[string]*CCacheMetric),\n61:         accnt:       accnt.NewFlatAccnt(maxSize),\n62:     }\n63:     go cc.evictLoop()\n64:     return cc\n65: }\n66:\n67: func (c *CCache) evictLoop() {\n68:     evictQ := c.accnt.GetEvictQ()\n69:     for target := range evictQ {\n70:         c.evict(target)\n71:     }\n72: }\n73: \n74: func (c *CCache) Add(metric string, prev uint32, itergen chunk.IterGen) {\n75:     c.lock.Lock()\n76: \n77:     if ccm, ok := c.metricCache[metric]; !ok {\n78:         var ccm *CCacheMetric\n79:         ccm = NewCCacheMetric()\n80:         ccm.Init(prev, itergen)\n81:         c.metricCache[metric] = ccm\n82:     } else {\n83:         ccm.Add(prev, itergen)\n84:     }\n85:     c.lock.Unlock()\n86: \n87:     c.accnt.AddChunk(metric, itergen.Ts(), itergen.Size())\n88: }\n89: \n90: func (c *CCache) evict(target *accnt.EvictTarget) {\n91:     c.lock.Lock()\n92: \n93:     if _, ok := c.metricCache[target.Metric]; ok {\n94:         log.Debug(\"cache: evicting chunk %d on metric %s\\n\", target.Ts, target.Metric)\n95:         length := c.metricCache[target.Metric].Del(target.Ts)\n96:         if length == 0 {\n97:             delete(c.metricCache, target.Metric)\n98:         }\n99:     }\n100: \n101:     c.lock.Unlock()\n102: }\n</code></pre>\n\n<p>That's the error message:</p>\n\n<pre><code>metrictank_1    | fatal error: concurrent map read and map write\nmetrictank_1    | \nmetrictank_1    | goroutine 3159 [running]:\nmetrictank_1    | runtime.throw(0xaade7e, 0x21)\nmetrictank_1    |       /usr/local/go/src/runtime/panic.go:566 +0x95 fp=0xc4216a7eb8 sp=0xc4216a7e98\nmetrictank_1    | runtime.mapaccess2_faststr(0x9e22c0, 0xc42031e600, 0xc4210c2b10, 0x22, 0x28, 0xa585d5496)\nmetrictank_1    |       /usr/local/go/src/runtime/hashmap_fast.go:306 +0x52b fp=0xc4216a7f18 sp=0xc4216a7eb8\nmetrictank_1    | github.com/raintank/metrictank/mdata/cache.(*CCache).Add(0xc4202fa070, 0xc4210c2b10, 0x22, 0x0, 0xc421875f82, 0x25, 0x25, 0xa585d5496)\nmetrictank_1    |       /home/mst/go/src/github.com/raintank/metrictank/mdata/cache/cache.go:77 +0x63 fp=0xc4216a7f80 sp=0xc4216a7f18\nmetrictank_1    | runtime.goexit()\nmetrictank_1    |       /usr/local/go/src/runtime/asm_amd64.s:2086 +0x1 fp=0xc4216a7f88 sp=0xc4216a7f80\nmetrictank_1    | created by github.com/raintank/metrictank/api.(*Server).getSeries\nmetrictank_1    |       /home/mst/go/src/github.com/raintank/metrictank/api/dataprocessor.go:442 +0x122b\n</code></pre>\n\n<p>UPDATE: I recompiled with <code>-race</code> and now I'm getting a different error. This looks as if the <code>RWMutex</code> were completely ineffective because according to the backtraces the problem must be in the combination of the <code>evict</code> and <code>Add</code> methods.</p>\n\n<pre><code>==================\nWARNING: DATA RACE\nRead at 0x00c4201c81e0 by goroutine 215:\n  runtime.mapaccess2_faststr()\n      /usr/local/go/src/runtime/hashmap_fast.go:297 +0x0\n  github.com/raintank/metrictank/mdata/cache.(*CCache).Add()\n      /home/mst/go/src/github.com/raintank/metrictank/mdata/cache/cache.go:77 +0xaa\n\nPrevious write at 0x00c4201c81e0 by goroutine 155:\n  runtime.mapdelete()\n      /usr/local/go/src/runtime/hashmap.go:558 +0x0\n  github.com/raintank/metrictank/mdata/cache.(*CCache).evict()\n      /home/mst/go/src/github.com/raintank/metrictank/mdata/cache/cache.go:97 +0x30e\n  github.com/raintank/metrictank/mdata/cache.(*CCache).evictLoop()\n      /home/mst/go/src/github.com/raintank/metrictank/mdata/cache/cache.go:70 +0xb3\n\nGoroutine 215 (running) created at:\n  github.com/raintank/metrictank/api.(*Server).getSeries()\n      /home/mst/go/src/github.com/raintank/metrictank/api/dataprocessor.go:442 +0x17c9\n  github.com/raintank/metrictank/api.(*Server).getTarget()\n      /home/mst/go/src/github.com/raintank/metrictank/api/dataprocessor.go:331 +0x9c3\n  github.com/raintank/metrictank/api.(*Server).getTargetsLocal.func1()\n      /home/mst/go/src/github.com/raintank/metrictank/api/dataprocessor.go:284 +0xa9\n\nGoroutine 155 (running) created at:\n  github.com/raintank/metrictank/mdata/cache.NewCCache()\n      /home/mst/go/src/github.com/raintank/metrictank/mdata/cache/cache.go:63 +0x12f\n  main.main()\n      /home/mst/go/src/github.com/raintank/metrictank/metrictank.go:388 +0x246c\n==================\n</code></pre>\n"}, {"tags": ["go", "plugins"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1482509216, "post_id": 41304466, "comment_id": 69811506, "body": "Like most Go docs, they are short but precise. A plugin &quot;cannot be closed&quot;  (i.e. unloaded), so you need to restart to ensure that only the newest version of the plugin is loaded."}, {"owner": {"reputation": 43, "user_id": 6077334, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EgItGk9emug/AAAAAAAAAAI/AAAAAAAAAqg/XoIBMsSAYGg/photo.jpg?sz=128", "display_name": "Lupo Dharkael", "link": "https://stackoverflow.com/users/6077334/lupo-dharkael"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482509449, "post_id": 41304466, "comment_id": 69811623, "body": "@JimB so the data of the plugin keeps associated with your program in execution time until it ends execution, right?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482509793, "post_id": 41304466, "comment_id": 69811787, "body": "The compiled package remains in memory, so any static data will remain. Heap allocated data is the same as any other and can be garbage collected."}], "owner": {"reputation": 43, "user_id": 6077334, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EgItGk9emug/AAAAAAAAAAI/AAAAAAAAAqg/XoIBMsSAYGg/photo.jpg?sz=128", "display_name": "Lupo Dharkael", "link": "https://stackoverflow.com/users/6077334/lupo-dharkael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 677, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502899228, "creation_date": 1482508806, "last_edit_date": 1502899228, "question_id": 41304466, "link": "https://stackoverflow.com/questions/41304466/how-to-reload-a-plugin-using-the-new-plugin-system-in-golang-1-8", "title": "How to reload a plugin using the new plugin system in Golang 1.8", "body": "<p>I want to implement a plugin manager in my application with the new plugin package from Go 1.8 beta.</p>\n\n<p>As the docs say (<a href=\"https://tip.golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">https://tip.golang.org/pkg/plugin/</a>): \"A plugin is only initialized once, and cannot be closed.\"</p>\n\n<p>What are the implications of this?</p>\n\n<p>Let's suppose I want to implement the load of plugins in runtime, and my program detects a change in a binary plugin (through md5 checking).<br>\nDo I have to restart my program to be able to load the modified and recompiled version of a plugin?\nWhat happens when I discard every reference to the older plugin? is it garbage collected? I don't know if it's that simple so I can just discard all the references and just load the new plugin.</p>\n"}, {"tags": ["go", "atomic"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1482595511, "post_id": 41304326, "comment_id": 69832960, "body": "Consider reading <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">&quot;Benign data races: what could possibly go wrong&quot;</a> for a gentle introduction to the topic. Written by one of the core Go devs FWIW."}], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 0, "last_activity_date": 1482509421, "creation_date": 1482509421, "answer_id": 41304582, "question_id": 41304326, "link": "https://stackoverflow.com/questions/41304326/when-to-use-atomic-loadpointer/41304582#41304582", "title": "When to use atomic.LoadPointer", "body": "<p>As long as you only have one goroutine accessing the value, nothing will go wrong. As soon as you have several goroutines, you need atomic access in order to read/write the latest value (not the possibly stale value that is in your CPU cache).</p>\n"}], "owner": {"reputation": 3436, "user_id": 307614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/671aed37f0d4a6668053a70a75f5c715?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/307614/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1464, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482509421, "creation_date": 1482508167, "question_id": 41304326, "link": "https://stackoverflow.com/questions/41304326/when-to-use-atomic-loadpointer", "title": "When to use atomic.LoadPointer", "body": "<p>What is the difference between using <code>atomic.StorePointer</code> / <code>LoadPointer</code>:</p>\n\n<pre><code>data := \"abc\"\natomic.StorePointer(&amp;p, unsafe.Pointer(&amp;data))\nfmt.Printf(\"value is %s\\n\", *(*string)(atomic.LoadPointer(&amp;p)))\n</code></pre>\n\n<p>And just using using the pointer normally?</p>\n\n<pre><code>data := \"abc\"\np = unsafe.Pointer(&amp;data)\nfmt.Printf(\"value is %s\\n\", *(*string)(p))\n</code></pre>\n\n<p>What could go wrong if I decide to just read from a pointer like in the second example, instead of using <code>LoadPointer</code>? I can guess there might be some kind of race, but practically, what could actually go wrong?</p>\n\n<p>Some examples:</p>\n\n<ul>\n<li><a href=\"https://play.golang.org/p/3kfl-CB7Pk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3kfl-CB7Pk</a></li>\n<li><a href=\"https://play.golang.org/p/31MlnelaJ_\" rel=\"nofollow noreferrer\">https://play.golang.org/p/31MlnelaJ_</a></li>\n</ul>\n"}, {"tags": ["database", "rest", "go"], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 965724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5395c41b2ec6b180a1e28193596b9f49?s=128&d=identicon&r=PG", "display_name": "mlg", "link": "https://stackoverflow.com/users/965724/mlg"}, "is_accepted": true, "score": 0, "last_activity_date": 1483005017, "creation_date": 1483005017, "answer_id": 41377115, "question_id": 41304058, "link": "https://stackoverflow.com/questions/41304058/go-rest-api-server-design-good-practice/41377115#41377115", "title": "go rest api server design good practice", "body": "<ol>\n<li><p>I think making 2 packages is a bad decision based on what you've described. If you're making a \"small web app\", there's nothing to gain but extra complexity in having more than one package. If you're not sure, always choose the simpler solution.</p></li>\n<li><p>I don't think having 2 packages is cleaner or that it mixes less. You can have your package stuff on several different files, and functions as methods of different structs.</p></li>\n<li><p>How about this? Define your db initialisation in an idempotent way (e.g. CREATE SCHEMA IF NOT EXISTS, CREATE TABLE IF NOT EXISTS) and run it every single time at the beginning of your <code>main.go</code>, right after you <code>db.Ping()</code>. Should be milliseconds most of the time, and you ensure that the db always has the structure you expect.</p></li>\n</ol>\n"}], "owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 41377115, "answer_count": 1, "score": 1, "last_activity_date": 1483005017, "creation_date": 1482507015, "question_id": 41304058, "link": "https://stackoverflow.com/questions/41304058/go-rest-api-server-design-good-practice", "title": "go rest api server design good practice", "body": "<p>I am new to golang and would like to make a small web app of to-do list to polish my go skills. I would like to know what is a good practice to organize the code.</p>\n\n<p>Right now, I define two packages for this project: <code>ticket</code> and <code>server</code>. <code>ticket</code> is about database and <code>server</code> is about http handlers.</p>\n\n<p>My data has two types: Ticket and Todo. One Ticket can have multiple Todo in it. They are defined in the <code>ticket</code> package.</p>\n\n<pre><code>type Ticket struct {                                                               \n    Id          int64      `db:\"id\" json:\"id\"`                                     \n    Label       string     `db:\"label\" json:\"label\"`                               \n    Description string     `db:\"description\" json:\"description\"`                   \n    StartTime   time.Time  `db:\"start_time\" json:\"start_time\"`                     \n    EndTime     *time.Time `db:\"end_time\" json:\"end_time\"`                         \n    Priority    bool       `db:\"priority\" json:\"priority\"`                         \n}                                                                                  \ntype Todo struct {                                                                 \n    Id       int64 `db:\"id\" json:\"id\"`                                             \n    Item     int64 `db:\"item\" json:\"item\"`                                         \n    TicketId int64 `db:\"ticket_id\" json:\"ticket_id\"`                               \n    Active   bool  `db:\"active\" json:\"active\"`                                     \n}  \n</code></pre>\n\n<p>In the <code>ticket</code> package, I also define </p>\n\n<pre><code>type AppDB struct {                                                                \n    db *sqlx.DB                                                                    \n}   \n</code></pre>\n\n<p>This wrapping around <code>*sqlx.DB</code> allows me to put all the database access functions inside <code>ticket</code> package, e.g.,</p>\n\n<pre><code>func (adb *AppDB) MustInit() \nfunc (adb *AppDB) AddTicket(i *Ticket) (int64, error)\n</code></pre>\n\n<p>In the <code>server</code> package, I define</p>\n\n<pre><code>type Application struct {                                                          \n    db ticket.AppDB                                                                \n}   \n</code></pre>\n\n<p>And the http handler functions are defined as methods of <code>Application</code>, e.g.,</p>\n\n<pre><code>func (app *Application) CreateTicket(w http.ResponseWriter, req *http.Request)\n</code></pre>\n\n<p>In the <code>main.go</code>, I register the handle functions.</p>\n\n<pre><code>func main() {                                                                      \n    app := server.NewApplication()                                                 \n\n    fmt.Println(\"now listening...\")                                                \n    router := mux.NewRouter()                                                      \n    router.HandleFunc(\"/\", app.Hello).Methods(\"GET\")                               \n    router.HandleFunc(\"/get\", app.Get).Methods(\"GET\")                              \n    log.Fatal(http.ListenAndServe(\":\"+os.Getenv(\"PORT\"), router))                  \n}  \n</code></pre>\n\n<p>I have the following questions:</p>\n\n<ol>\n<li>Is this design a good practice? If not, what is the right way?</li>\n<li>In Donovan and Kernighan's Go programming book p.194, they give an example where the http handlers are defined as the database's method directly. Would that be a better design? It makes sense because my <code>server</code> package only works for data types in <code>ticket</code>. It also makes the code a little cleaner to write. On the other hand it mixes http and database, which I am not sure if it is a good thing.</li>\n<li>How to deal with database table creation? Shall I create another <code>main.go</code> which only creates the database tables and build it into executable such that I can run it on the server just once?</li>\n</ol>\n"}, {"tags": ["go", "go-html-template"], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "is_accepted": true, "score": 1, "last_activity_date": 1482516394, "creation_date": 1482516394, "answer_id": 41305983, "question_id": 41303601, "link": "https://stackoverflow.com/questions/41303601/how-to-execute-multiple-templates-in-a-single-webpage-using-different-interfaces/41305983#41305983", "title": "How to execute multiple templates in a single webpage using different interfaces in golang?", "body": "<p>I decided to edit my header template to include everything above it as well and changed my go code accordingly. I actually had some css and script references above it. Since it was going to be different for every page, I only included the nav_bar in the header but I figured out to fix this problem.</p>\n\n<p>I made a new struct</p>\n\n<pre><code>type Header struct{\n    Css []string;\n    Title string;\n    Js []string;\n    Categories []string;\n}\n</code></pre>\n\n<p>and this is part of my header template</p>\n\n<pre><code>{{range $i,$e:=.Css}}\n&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"{{$e}}\"&gt;\n{{end}}\n{{range $i,$e:=.Js}}\n&lt;script src=\"{{$e}}\"&gt;&lt;/script&gt;\n{{end}}\n</code></pre>\n\n<p>I did the execute template part with the header first with the respective header interface and then another execute template with its respective interface. Also i had to remove the {{template \"header\"}} part from index.html. The result Looks perfect now and is working the way I want it to. </p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 41305983, "answer_count": 1, "score": 0, "last_activity_date": 1482516394, "creation_date": 1482504930, "question_id": 41303601, "link": "https://stackoverflow.com/questions/41303601/how-to-execute-multiple-templates-in-a-single-webpage-using-different-interfaces", "title": "How to execute multiple templates in a single webpage using different interfaces in golang?", "body": "<p>Please forgive me for a weird looking question. I wasn't sure exactly how to state my problem in a single statement.</p>\n\n<p>I have three templates in my webpage, header, layout and footer.</p>\n\n<p>In the template header, I have a categories dropdown menu and I have a slice of strings with sub-menu items in my go code.</p>\n\n<pre><code>Categories := []string{\"Holiday\",\"IQ\",\"Future\"}\n</code></pre>\n\n<p>and the template header has following html code</p>\n\n<pre><code>&lt;div class=\"ui dropdown item\"&gt;\n  &lt;i class=\"browser icon\"&gt;&lt;/i&gt;\n  Categories\n  &lt;i class=\"dropdown icon\"&gt;&lt;/i&gt;\n  &lt;div class=\"menu\"&gt;              \n    {{range $i,$e:= .}}\n    &lt;a class=\"item\"&gt;&lt;i class=\"hashtag icon\"&gt;&lt;/i&gt;{{$e}}&lt;/a&gt;\n    {{end}}\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>so when I do a,</p>\n\n<pre><code>t,err :=template.ParseFiles(\"template/header.html\",\"template/index.html\",\"template/footer.html\")\nt.ExecuteTemplate(w,\"header\",Categories)\n</code></pre>\n\n<p>It gives me a nice looking header but I need to do</p>\n\n<pre><code>t.ExecuteTemplate(w,\"layout\",Featured)\n</code></pre>\n\n<p>for the main page. Layout template has the following structure</p>\n\n<pre><code>some html code\n{{template \"header\"}}\nmore html code\n{{template \"footer\"}}\n</code></pre>\n\n<p>Using both the execute template statements together gives me two different headers,obviously.</p>\n\n<p>If I remove template header from the template layout, the visual output is perfect but when you look at the html code, the menu bar is above the \"link rel\" statements(remember,I had 'some html code' above {{template \"header\"}} in the layout template) and that is obviously not good.</p>\n\n<p>What should I do so that both the templates are executed simultaneously using their respective structs?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1482499608, "post_id": 41302079, "comment_id": 69807020, "body": "You may want to check the error at <code>tx, err := dbMaster.Begin()</code> but I guess tx would be nil if it failed (so Prepare would panic)."}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1482499714, "post_id": 41302079, "comment_id": 69807081, "body": "Might be a connection issue with a long (or infinite) timeout."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 1, "creation_date": 1517019922, "post_id": 41302079, "comment_id": 83937955, "body": "Did you ever solve this?"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482498425, "creation_date": 1482498425, "question_id": 41302079, "link": "https://stackoverflow.com/questions/41302079/code-hangs-at-stmt-exec-transactions-in-golang", "title": "Code hangs at stmt.Exec() transactions in golang", "body": "<p>I am facing a weird issue. In the following code the code reaches to break point 1 but not break point 2. There is no error as well. The code just gets stuck there without throwing any error.</p>\n\n<pre><code>dbMaster := s.master\ntx, err := dbMaster.Begin()\n\nstmt, err := tx.Prepare(\"UPDATE service set status='deleted' where id=1\")\nif err != nil {\n    tx.Rollback()\n    log.Printf(\"Error while preparing statement: %s\\n\", err)\n}\n\ndefer stmt.Close()\nfmt.Println(\"break point 1\")\nresult, err := stmt.Exec()\nfmt.Println(\"break point 2\")\nif err != nil {\n    log.Printf(\"Error executing statement: %s\\n\", err)\n}\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482498043, "post_id": 41301974, "comment_id": 69806293, "body": "What is wrong with <a href=\"https://golang.org/pkg/regexp/#Regexp.Split\" rel=\"nofollow noreferrer\"><code>func (*Regexp) Split</code></a>? Could you please provide some sample input text with the expected output?"}, {"owner": {"reputation": 392, "user_id": 1832496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5860f6ae31ba8a90320c31b8d2e69d05?s=128&d=identicon&r=PG", "display_name": "Dariush Abbasi", "link": "https://stackoverflow.com/users/1832496/dariush-abbasi"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482498662, "post_id": 41301974, "comment_id": 69806550, "body": "<code>Split </code> remove split character point, but <code>SplitAfter</code> just split after split character without character removing"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482499080, "post_id": 41301974, "comment_id": 69806762, "body": "Ok, I see. As Go regex flavor does not support lookarounds, this could be a really nice feature."}, {"owner": {"reputation": 392, "user_id": 1832496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5860f6ae31ba8a90320c31b8d2e69d05?s=128&d=identicon&r=PG", "display_name": "Dariush Abbasi", "link": "https://stackoverflow.com/users/1832496/dariush-abbasi"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1482499431, "post_id": 41301974, "comment_id": 69806936, "body": "I means there is no way to do that currently?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1482499568, "post_id": 41301974, "comment_id": 69806994, "body": "Only using workarounds. E.g., your current result can be achieved by matching all 1+ digits followed with an optional <code>.</code>.  See <a href=\"https://play.golang.org/p/-6g0mjz02v\" rel=\"nofollow noreferrer\">this demo</a>. Or even any char other than <code>.</code> and an optional <code>.</code> - <code>`[^.]*\\.?`</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 1, "last_activity_date": 1482707451, "creation_date": 1482707451, "answer_id": 41325161, "question_id": 41301974, "link": "https://stackoverflow.com/questions/41301974/golang-splitafter-for-regexp-type/41325161#41325161", "title": "Golang SplitAfter for Regexp type", "body": "<p>Regexp type itself does not have a method to do that exactly that but it's quite simple to write a function that implements what your asking based on Regexp functionality:</p>\n\n<pre><code>func SplitAfter(s string, re *regexp.Regexp) []string {\n    var (\n        r []string\n        p int\n    )\n    is := re.FindAllStringIndex(s, -1)\n    if is == nil {\n        return append(r, s)\n    }\n    for _, i := range is {\n        r = append(r, s[p:i[1]])\n        p = i[1]\n    }\n    return append(r, s[p:])\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/L31rgR8apI\" rel=\"nofollow noreferrer\">Here</a> I left a program to play with it.</p>\n"}], "owner": {"reputation": 392, "user_id": 1832496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5860f6ae31ba8a90320c31b8d2e69d05?s=128&d=identicon&r=PG", "display_name": "Dariush Abbasi", "link": "https://stackoverflow.com/users/1832496/dariush-abbasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482707451, "creation_date": 1482497954, "last_edit_date": 1482498937, "question_id": 41301974, "link": "https://stackoverflow.com/questions/41301974/golang-splitafter-for-regexp-type", "title": "Golang SplitAfter for Regexp type", "body": "<p>In golang <code>strings.SplitAfter</code> method split text after an special character into an slice, but I didn't find a way for Regexp type to split text after matches. Is there a way to do that?</p>\n\n<p>Example :</p>\n\n<pre><code>var text string = \"1.2.3.4.5.6.7.8.9\"\n\nres := strings.Split(text, \".\")\nfmt.Println(res) // print [1 2 3 4 5 6 7 8 9]\n\nres = strings.SplitAfter(text, \".\")\nfmt.Println(res) // print [1. 2. 3. 4. 5. 6. 7. 8. 9]\n</code></pre>\n"}, {"tags": ["http", "pointers", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482495133, "post_id": 41301163, "comment_id": 69804836, "body": "The documentation says it returns a shallow copy of the request. If it just returned <code>r</code> it wouldn&#39;t be a copy."}, {"owner": {"reputation": 585, "user_id": 1351845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c99f53a3d404b190dee9200fb471f5?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Bauer", "link": "https://stackoverflow.com/users/1351845/vladimir-bauer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482507650, "post_id": 41301163, "comment_id": 69810790, "body": "I know what documentations says, I try to understand what happens under the hood"}], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 1351845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c99f53a3d404b190dee9200fb471f5?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Bauer", "link": "https://stackoverflow.com/users/1351845/vladimir-bauer"}, "edited": false, "score": 0, "creation_date": 1482508254, "post_id": 41302570, "comment_id": 69811063, "body": "I got it! The key phrase is: <i>Since the pointed value is of type Request which is a struct, the assignment copies the values of the fields.</i> Thanks!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1482501007, "last_edit_date": 1482501007, "creation_date": 1482500624, "answer_id": 41302570, "question_id": 41301163, "link": "https://stackoverflow.com/questions/41301163/golang-http-package-request-withcontext-method-src-code-explanation/41302570#41302570", "title": "Golang http package: Request.WithContext method src code explanation", "body": "<p>Let's examine the lines in question:</p>\n\n<pre><code>r2 := new(Request)\n</code></pre>\n\n<p>This is a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"noreferrer\">short variable declaration</a>, creates the <code>r2</code> variable, and initializes it with the value of the right-hand side expression, which is a call to the builtin <a href=\"https://golang.org/pkg/builtin/#new\" rel=\"noreferrer\"><code>new()</code></a> function, which allocates memory for the given type, and returns a pointer to it (being the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">zero value</a> of the type).</p>\n\n<pre><code>*r2 = *r\n</code></pre>\n\n<p>This line assigns the value <em>pointed</em> by <code>r</code> to the value <em>pointed</em> by <code>r2</code>. Note that this does not assign the pointer value, but the <em>pointed</em> value. Since the pointed value is of type <code>Request</code> which is a struct, the assignment copies the values of the fields.</p>\n\n<pre><code>r2.ctx = ctx\n</code></pre>\n\n<p>Since <code>r2</code> is a pointer to a struct, this is a shorthand for <code>(*r2).ctx = ctx</code>, which assigns the given context value to the <code>ctx</code> field of the value (of type <code>Context</code>) pointed by <code>r2</code>.</p>\n\n<pre><code>return r2\n</code></pre>\n\n<p>This <code>r2</code> pointer is then returned. Note that <code>r2</code> is a pointer different from <code>r</code>, and the pointed value is a different and independent request from that pointed by <code>r</code>.</p>\n\n<hr>\n\n<p>If you would do</p>\n\n<pre><code>r.ctx = ctx\nreturn r\n</code></pre>\n\n<p>It would assign the context to the <code>ctx</code> field pointed by <code>r</code>, and this same <code>r</code> pointer would be returned. The returned value would be identical to the value of <code>r</code>, so both <code>r</code> and the returned value would point to the same <code>Request</code> value, and both would have the new <code>Context</code> value. The original code does not modify the <code>ctx</code> of the original request (the one whose <code>WithContext()</code> method is called).</p>\n"}], "owner": {"reputation": 585, "user_id": 1351845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c99f53a3d404b190dee9200fb471f5?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir Bauer", "link": "https://stackoverflow.com/users/1351845/vladimir-bauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1530012090, "creation_date": 1482494645, "last_edit_date": 1530012090, "question_id": 41301163, "link": "https://stackoverflow.com/questions/41301163/golang-http-package-request-withcontext-method-src-code-explanation", "title": "Golang http package: Request.WithContext method src code explanation", "body": "<p>Following is an excerpt from source code of <code>http/request.go</code> line 290:</p>\n\n<pre><code>// WithContext returns a shallow copy of r with its context changed\n// to ctx. The provided ctx must be non-nil.\nfunc (r *Request) WithContext(ctx context.Context) *Request {\n    if ctx == nil {\n        panic(\"nil context\")\n    }\n    r2 := new(Request)      //\n    *r2 = *r                // strange gymnastics\n    r2.ctx = ctx            //\n    return r2\n}\n</code></pre>\n\n<p>I looked at it for an hour trying to understand last 4 lines. Why is that gymnastics for? Doesn't it means just the following:</p>\n\n<pre><code>r.ctx = ctx\nreturn r\n</code></pre>\n\n<p>Or do I miss something?</p>\n"}, {"tags": ["http", "go", "proxy"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482492487, "post_id": 41300350, "comment_id": 69803401, "body": "<code>ab</code> is using http/1.0 without keepalive. Don&#39;t use <code>ab</code>."}, {"owner": {"reputation": 844, "user_id": 2459515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SkRr0.jpg?s=128&g=1", "display_name": "StevieB", "link": "https://stackoverflow.com/users/2459515/stevieb"}, "edited": false, "score": 0, "creation_date": 1482494264, "post_id": 41300350, "comment_id": 69804360, "body": "ab is not your best choice. Have a look at wrk which is like ab but better in so many ways or vegeta (<a href=\"https://github.com/tsenart/vegeta\" rel=\"nofollow noreferrer\">github.com/tsenart/vegeta</a>)"}, {"owner": {"reputation": 56, "user_id": 4826587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d582cb14d08641b713ceb619e22851?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Belotskiy", "link": "https://stackoverflow.com/users/4826587/mark-belotskiy"}, "edited": false, "score": 0, "creation_date": 1482505422, "post_id": 41300350, "comment_id": 69809746, "body": "Maybe it not best, and i definitely will try other solutions (thanks for it), but i can&#39;t guarantee that this problem won&#39;t occur in production. So i want to now how to fix/debug it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482508892, "post_id": 41300350, "comment_id": 69811371, "body": "@MarkBelotskiy: see <a href=\"https://stackoverflow.com/questions/37774624/go-http-get-concurrency-and-connection-reset-by-peer/37813844#37813844\" title=\"go http get concurrency and connection reset by peer\">stackoverflow.com/questions/37774624/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/30352725/why-is-my-hello-world-go-server-getting-crushed-by-apachebench/30357879#30357879\" title=\"why is my hello world go server getting crushed by apachebench\">stackoverflow.com/questions/30352725/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/39813587/go-client-program-generates-a-lot-a-sockets-in-time-wait-state/39834253#39834253\" title=\"go client program generates a lot a sockets in time wait state\">stackoverflow.com/questions/39813587/&hellip;</a>"}, {"owner": {"reputation": 56, "user_id": 4826587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d582cb14d08641b713ceb619e22851?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Belotskiy", "link": "https://stackoverflow.com/users/4826587/mark-belotskiy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482571326, "post_id": 41300350, "comment_id": 69827131, "body": "@JimB So it either OS limit or http.Transport limit... thanks for hints. I&#39;ll  try both and report."}, {"owner": {"reputation": 56, "user_id": 4826587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d582cb14d08641b713ceb619e22851?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Belotskiy", "link": "https://stackoverflow.com/users/4826587/mark-belotskiy"}, "edited": false, "score": 0, "creation_date": 1484145832, "post_id": 41300350, "comment_id": 70390472, "body": "I have tried to change both  net.inet.tcp.msl system parameter and MaxIdleConnsPerHost (this way<code>proxy.Transport = &amp;mimTransport{MaxIdleConnsPerHost: 10}</code>) it seems have no effect on <code>connection reset by peer</code> error. I also switched to vegeta, and it gives me much better results. But error still occurs when i set keepalive to false (real http requests usually do not use keepalive)."}], "owner": {"reputation": 56, "user_id": 4826587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d582cb14d08641b713ceb619e22851?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Belotskiy", "link": "https://stackoverflow.com/users/4826587/mark-belotskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1231, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1482491558, "creation_date": 1482491558, "question_id": 41300350, "link": "https://stackoverflow.com/questions/41300350/go-httputil-reverseproxy-connection-reset-by-peer", "title": "Go httputil.ReverseProxy connection reset by peer", "body": "<p>I have the task to make a reverse proxy app which extracts some specific info from request/response body and send it into logstash. So i decided to do some load testing first. I wrote very simple backend web server and basic proxy.</p>\n\n<p><em>Backend server code:</em></p>\n\n<pre><code>package main\n\nimport \"net/http\"\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":3001\", nil)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    r.Body.Close()\n    w.Write([]byte(\"test\"))\n}\n</code></pre>\n\n<p><em>Reverse proxy server code:</em></p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"net/http/httputil\"\n    \"net/url\"\n)\n\nvar (\n    proxy *httputil.ReverseProxy\n)\n\nfunc init() {\n    url, _ := url.Parse(\"http://localhost:3001\")\n    proxy = httputil.NewSingleHostReverseProxy(url)\n    proxy.Transport = &amp;mimTransport{}\n}\n\nfunc main() {\n    http.ListenAndServe(\":3000\", proxy)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    r.Host = \"localhost:3001\"\n    proxy.ServeHTTP(w, r)\n}\n\ntype mimTransport struct {\n}\n\nfunc (t *mimTransport) RoundTrip(request *http.Request) (*http.Response, error) {\n    response, err := http.DefaultTransport.RoundTrip(request)\n    if response != nil {\n        defer request.Body.Close()\n    }\n\n    // info extraction will be here\n\n    return response, err\n}\n</code></pre>\n\n<p>As you can see backend server listening <code>localhost:3001</code> and proxy listening <code>localhost:3000</code></p>\n\n<p>I'am using apache benchmark for load testing.</p>\n\n<p>When i running <code>$ ab -c 20 -n 20000 -s 10 http://127.0.0.1:3000/</code> around 12k-14k requests proxy start writing errors like:</p>\n\n<pre><code>2016/12/23 13:02:50 http: proxy error: read tcp [::1]:58330-&gt;[::1]:3001: read: connection reset by peer\n2016/12/23 13:02:50 http: proxy error: read tcp [::1]:58461-&gt;[::1]:3001: read: connection reset by peer\n2016/12/23 13:02:50 http: proxy error: read tcp [::1]:58977-&gt;[::1]:3001: read: connection reset by peer\n2016/12/23 13:02:50 http: proxy error: read tcp [::1]:59459-&gt;[::1]:3001: read: connection reset by peer\n...\n</code></pre>\n\n<p>and soon after that apache bench dies by timeout. Some bench results:</p>\n\n<pre><code>Benchmarking 127.0.0.1 (be patient)\nCompleted 2000 requests\nCompleted 4000 requests\nCompleted 6000 requests\nCompleted 8000 requests\nCompleted 10000 requests\n^C\n\nServer Software:        \nServer Hostname:        127.0.0.1\nServer Port:            3000\n\nDocument Path:          /\nDocument Length:        4 bytes\n\nConcurrency Level:      20\nTime taken for tests:   4.868 seconds\nComplete requests:      11514\nFailed requests:        22\n   (Connect: 0, Receive: 0, Length: 22, Exceptions: 0)\nNon-2xx responses:      22\nTotal transferred:      1381790 bytes\nHTML transferred:       45968 bytes\nRequests per second:    2365.28 [#/sec] (mean)\nTime per request:       8.456 [ms] (mean)\nTime per request:       0.423 [ms] (mean, across all concurrent requests)\nTransfer rate:          277.20 [Kbytes/sec] received\n\nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0    1   4.2      1     111\nProcessing:     0    3   4.8      3     113\nWaiting:        0    3   4.7      3     113\nTotal:          0    4   6.4      4     116\n\nPercentage of the requests served within a certain time (ms)\n  50%      4\n  66%      4\n  75%      5\n  80%      5\n  90%      5\n  95%      6\n  98%      6\n  99%      7\n 100%    116 (longest request)\n</code></pre>\n\n<p>There is more, if i start <code>ab</code> again right after the end of first test, i'll receive something like:</p>\n\n<pre><code>Benchmarking 127.0.0.1 (be patient)\napr_pollset_poll: The timeout specified has expired (70007)\nTotal of 52 requests completed\n</code></pre>\n\n<p>(Maybe some connection from previous test still alive)</p>\n\n<p>Internet says there is some DoS protection mechanism in Go, and apparently it is cause of reseted connections. \nSo my questions is:</p>\n\n<ol>\n<li>Why it reset connections (read buffer is full, timeout is happens, too many connections or maybe my code is broken)</li>\n<li>Can i tweak this mechanism? For example extend buffer of change max timeout.</li>\n<li>Some hints how correctly handle this type of errors.</li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["regex", "string", "go"], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 9, "last_activity_date": 1482491889, "last_edit_date": 1482491889, "creation_date": 1482488602, "answer_id": 41299572, "question_id": 41299523, "link": "https://stackoverflow.com/questions/41299523/escape-string-special-characters-for-use-in-golang-regexp/41299572#41299572", "title": "Escape string special characters for use in golang regexp", "body": "<p>You must put the <code>-</code> item at the start/end of the array so that <code>-</code> appears either at the start - <code>[-.()]</code> -  or end - <code>[.()-]</code> - of the character class.</p>\n\n<p>Or escape the <code>-</code> in the <code>chars</code> array: <code>\"\\\\-\"</code>.</p>\n\n<p><strong>NOTE</strong>: That is not the only caveat, the <code>^</code> and <code>]</code> must also be escaped, or placed in a specific location in the character class.  The <code>\\</code> must be escaped always.</p>\n\n<p>See a <a href=\"https://play.golang.org/p/7ZBKa3m6yx\" rel=\"noreferrer\">Go demo</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"regexp\"\n)\n\nfunc main() {\n    chars := []string{\"]\", \"^\", \"\\\\\\\\\", \"[\", \".\", \"(\", \")\", \"-\"}\n    r := strings.Join(chars, \"\")\n    s := \"[Some]-\\\\(string)^.\"\n    re := regexp.MustCompile(\"[\" + r + \"]+\")\n    s = re.ReplaceAllString(s, \"\")\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output: <code>Somestring</code></p>\n\n<p>Note that the <code>^</code> must not be the first item, <code>]</code> must be at the start and <code>-</code> at the end.</p>\n"}], "owner": {"reputation": 392, "user_id": 1832496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5860f6ae31ba8a90320c31b8d2e69d05?s=128&d=identicon&r=PG", "display_name": "Dariush Abbasi", "link": "https://stackoverflow.com/users/1832496/dariush-abbasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8721, "favorite_count": 0, "accepted_answer_id": 41299572, "answer_count": 1, "score": 6, "last_activity_date": 1533279742, "creation_date": 1482488441, "last_edit_date": 1533279742, "question_id": 41299523, "link": "https://stackoverflow.com/questions/41299523/escape-string-special-characters-for-use-in-golang-regexp", "title": "Escape string special characters for use in golang regexp", "body": "<p>I have an array of characters like this :</p>\n\n<pre><code>chars := []string{\".\", \"-\", \"(\", \")\"}\n</code></pre>\n\n<p>When I join them in regular way (<code>strings.Join(chars, \"\")</code>) and pass it to <code>regexp.MustCompile</code>, Its panic :</p>\n\n<pre><code>panic: regexp: Compile(`[.-()]`): error parsing regexp: invalid character class range: `.-(`\n</code></pre>\n\n<p>How can I scape string special characters for use in golang regexp as a character not regexp operator?</p>\n"}, {"tags": ["go", "google-bigquery", "google-cloud-datastore", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 25696, "user_id": 6253347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1387a55798cae58a3a836dcbcd6e1951?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott Brossard", "link": "https://stackoverflow.com/users/6253347/elliott-brossard"}, "is_accepted": true, "score": 2, "last_activity_date": 1482501573, "creation_date": 1482501573, "answer_id": 41302818, "question_id": 41297410, "link": "https://stackoverflow.com/questions/41297410/build-errors-in-datastore-while-using-golang-protobuf/41302818#41302818", "title": "Build errors in datastore while using golang/protobuf", "body": "<p>You did the right thing by filing a bug, so hopefully that will be resolved soon. The most recent version of the cloud APIs adds support for <a href=\"https://cloud.google.com/bigquery/release-notes#december_22_2016\" rel=\"nofollow noreferrer\">query parameters</a> but based on the error that you are seeing, one of the libraries was not updated properly.</p>\n"}], "owner": {"reputation": 3391, "user_id": 461112, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/332d4c4a09f271a4a921ce52cbba0ae0?s=128&d=identicon&r=PG", "display_name": "user461112", "link": "https://stackoverflow.com/users/461112/user461112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 41302818, "answer_count": 1, "score": 1, "last_activity_date": 1482501573, "creation_date": 1482479681, "question_id": 41297410, "link": "https://stackoverflow.com/questions/41297410/build-errors-in-datastore-while-using-golang-protobuf", "title": "Build errors in datastore while using golang/protobuf", "body": "<p>I have an application which uses both bigquery and cloud datastore APIs. I use glide for go package management. I keep seeing build errors with either bigquery or datastore depending upon the version of golang/protobuf that I use. I am not able to find a version that is compatible with both bigquery and datastore. Either one of the packages keeps failing to build.</p>\n\n<p>Build errors in datastore while using golang/protobuf version 7cc19b78d562895b13596ddce7aafb59dd789318:</p>\n\n<blockquote>\n  <p>../../vendor/google.golang.org/genproto/googleapis/api/annotations/annotations.pb.go:33:\n  undefined: proto.ProtoPackageIsVersion2\n  ../../vendor/google.golang.org/genproto/googleapis/api/annotations/annotations.pb.go:41:\n  unknown proto.ExtensionDesc field 'Filename' in struct literal\n  ../../vendor/google.golang.org/genproto/googleapis/api/annotations/annotations.pb.go:48:\n  undefined: proto.RegisterFile\n  ../../vendor/google.golang.org/genproto/googleapis/api/annotations/http.pb.go:540:\n  undefined: proto.RegisterFile Build errors in bigquery while using\n  golang/protobuf version 8ee79997227bf9b34611aee7946ae64735e6fd93:</p>\n  \n  <p>../../vendor/cloud.google.com/go/bigquery/params.go:55: undefined:\n  bigquery.QueryParameterType\n  ../../vendor/cloud.google.com/go/bigquery/params.go:56: undefined:\n  bigquery.QueryParameterType\n  ../../vendor/cloud.google.com/go/bigquery/params.go:57: undefined:\n  bigquery.QueryParameterType\n  ../../vendor/cloud.google.com/go/bigquery/params.go:58: undefined:\n  bigquery.QueryParameterType\n  ../../vendor/cloud.google.com/go/bigquery/params.go:59: undefined:\n  bigquery.QueryParameterType\n  ../../vendor/cloud.google.com/go/bigquery/params.go:60: undefined:\n  bigquery.QueryParameterType\n  ../../vendor/cloud.google.com/go/bigquery/params.go:61: undefined:\n  bigquery.QueryParameterType\n  ../../vendor/cloud.google.com/go/bigquery/params.go:94: undefined:\n  bigquery.QueryParameter\n  ../../vendor/cloud.google.com/go/bigquery/params.go:110: undefined:\n  bigquery.QueryParameterType\n  ../../vendor/cloud.google.com/go/bigquery/params.go:178: undefined:\n  bigquery.QueryParameter</p>\n</blockquote>\n\n<p>Opened an issue here - <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/issues/475\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/google-cloud-go/issues/475</a>. Any pointers would be appreciated. </p>\n"}, {"tags": ["testing", "go", "version"], "comments": [{"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1482515831, "post_id": 41297073, "comment_id": 69814533, "body": "Thanks @icza - I missed that one before."}], "answers": [{"tags": [], "owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "is_accepted": false, "score": 1, "last_activity_date": 1482479093, "creation_date": 1482479093, "answer_id": 41297251, "question_id": 41297073, "link": "https://stackoverflow.com/questions/41297073/running-a-test-in-golang-that-only-works-for-some-versions/41297251#41297251", "title": "Running a test in golang that only works for some versions", "body": "<p>A few minutes after posting this I remembered about <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">build constraints</a>. Go has a built in constraint that handles this exact case, i.e. \"version of go must be >= X\".</p>\n\n<p>Moving that test into <a href=\"https://github.com/turtlemonvh/altscanner/blob/master/altscanner_16_test.go\" rel=\"nofollow noreferrer\">a separate file</a> and adding <code>//+build go1.6</code> at the top fixed it.</p>\n"}], "owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1482487664, "answer_count": 1, "score": 0, "last_activity_date": 1482479093, "creation_date": 1482478305, "question_id": 41297073, "link": "https://stackoverflow.com/questions/41297073/running-a-test-in-golang-that-only-works-for-some-versions", "closed_reason": "Duplicate", "title": "Running a test in golang that only works for some versions", "body": "<p>I have a library here (<a href=\"https://github.com/turtlemonvh/altscanner\" rel=\"nofollow noreferrer\">https://github.com/turtlemonvh/altscanner</a>) that includes a test comparing functionality of a custom scanner to <code>bufio.Scanner</code>.  In particular, I am comparing my approach to <a href=\"https://golang.org/pkg/bufio/#Scanner.Buffer\" rel=\"nofollow noreferrer\">the <code>Buffer</code> method</a> which <a href=\"https://golang.org/doc/go1.6#minor_library_changes\" rel=\"nofollow noreferrer\">wasn't added until go1.6</a>.</p>\n\n<p>My actual code works with versions of go back to 1.4, but I wanted to include this test (and I'd like to add a benchmark as well) that uses the <code>Buffer</code> function of the <code>bufio.Scanner</code> object.</p>\n\n<p>How can I include these tests that use features of go1.6+ while still allowing code to run for go1.4 and 1.5?</p>\n\n<p>I imagine the answer is <a href=\"https://blog.cloudflare.com/setting-go-variables-at-compile-time/\" rel=\"nofollow noreferrer\">using a build flag</a> to trigger the execution of these tests only if explicitly requested (and I do have access to the go version in my CI pipeline via <a href=\"https://docs.travis-ci.com/user/languages/go#Environment-Variable\" rel=\"nofollow noreferrer\">a travis environment variable</a>).  I could also abuse <a href=\"https://golang.org/pkg/testing/#Short\" rel=\"nofollow noreferrer\">the short flag</a> here.</p>\n\n<p>Is there a cleaner approach?</p>\n"}, {"tags": ["go", "servemux"], "answers": [{"comments": [{"owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "edited": false, "score": 0, "creation_date": 1482476627, "post_id": 41296699, "comment_id": 69795812, "body": "Y Y Y on this earth i did commit that mistake. I am locking myself in bathroom for an hour now."}], "tags": [], "owner": {"reputation": 10697, "user_id": 2456263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a3cf0df72502fdc81fad7301b2b887d8?s=128&d=identicon&r=PG", "display_name": "0xcaff", "link": "https://stackoverflow.com/users/2456263/0xcaff"}, "is_accepted": true, "score": 3, "last_activity_date": 1482476500, "creation_date": 1482476500, "answer_id": 41296699, "question_id": 41296633, "link": "https://stackoverflow.com/questions/41296633/go-language-cannot-use-r-type-mux-router-as-type-mux-route-in-return-argumen/41296699#41296699", "title": "Go language cannot use r (type *mux.Router) as type *mux.Route in return argument", "body": "<p>The return type for <code>InitRouter</code> is wrong. You return a <code>*mux.Router</code> but specify a return type of <code>*mux.Route</code>.</p>\n"}], "owner": {"reputation": 5473, "user_id": 1752366, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/HoNYQ.jpg?s=128&g=1", "display_name": "silentsudo", "link": "https://stackoverflow.com/users/1752366/silentsudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 41296699, "answer_count": 1, "score": 0, "last_activity_date": 1482476500, "creation_date": 1482476238, "question_id": 41296633, "link": "https://stackoverflow.com/questions/41296633/go-language-cannot-use-r-type-mux-router-as-type-mux-route-in-return-argumen", "title": "Go language cannot use r (type *mux.Router) as type *mux.Route in return argument", "body": "<p>Hi i am initializing Router in other Go file and returning reference of it in Main file and then in Main file i am initializing serve.\nThis piece of code is not compiling</p>\n\n<pre><code>package router\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"binapp/controllers\"\n)\n\nconst all_bin string = \"/bin\"\n\nfunc InitRouter() (*mux.Route) {\n    r := mux.NewRouter().StrictSlash(true)\n\n    r.HandleFunc(all_bin, controllers.BinController)\n\n    return r\n}\n\n\npackage main\n\nimport (\n    \"binapp/router\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    router := router.InitRouter()\n    log.Fatal(http.ListenAndServe(\":9096\", router))\n}\n</code></pre>\n\n<p>I am getting error as:</p>\n\n<pre><code># binapp/router\nbinapp/router/Route.go:15: cannot use r (type *mux.Router) as type *mux.Route in return argument\n</code></pre>\n"}, {"tags": ["go", "concurrency", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 8, "last_activity_date": 1482471430, "creation_date": 1482471430, "answer_id": 41295737, "question_id": 41295538, "link": "https://stackoverflow.com/questions/41295538/goroutine-analogues-in-other-languages/41295737#41295737", "title": "Goroutine analogues in other languages", "body": "<p>goroutine are inspired by <a href=\"https://en.wikipedia.org/wiki/Communicating_sequential_processes\" rel=\"noreferrer\">CSP (Communicating sequential processes)</a>, which is highly influential in the design of the <a href=\"https://en.wikipedia.org/wiki/Occam_(programming_language)\" rel=\"noreferrer\">occam</a> programming language, and also influenced the design of programming languages such as <a href=\"https://en.wikipedia.org/wiki/Limbo_(programming_language)\" rel=\"noreferrer\">Limbo</a>, <a href=\"https://en.wikipedia.org/wiki/RaftLib\" rel=\"noreferrer\">RaftLib</a>, <a href=\"https://en.wikipedia.org/wiki/Go_(programming_language)\" rel=\"noreferrer\">Go</a>, and <a href=\"https://en.wikipedia.org/wiki/Crystal_(programming_language)\" rel=\"noreferrer\">Crystal</a>.</p>\n\n<p>Note that <a href=\"http://www.jtolds.com/writing/2016/03/go-channels-are-bad-and-you-should-feel-bad/\" rel=\"noreferrer\">goroutine are not without criticisms</a>. </p>\n\n<p>It differs from the <a href=\"https://en.wikipedia.org/wiki/Actor_model\" rel=\"noreferrer\">Actor Model</a> in that: </p>\n\n<ul>\n<li>CSP processes are anonymous, while actors have identities.</li>\n<li>CSP message-passing fundamentally involves a rendezvous between the processes involved in sending and receiving the message. In contrast, message-passing in actor systems is fundamentally asynchronous</li>\n<li>CSP uses explicit channels for message passing, whereas actor systems transmit messages to named destination actors.</li>\n</ul>\n"}], "owner": {"reputation": 793, "user_id": 1688697, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Pypcy.png?s=128&g=1", "display_name": "Doseke", "link": "https://stackoverflow.com/users/1688697/doseke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 2, "accepted_answer_id": 41295737, "answer_count": 1, "score": 6, "last_activity_date": 1482471430, "creation_date": 1482470058, "question_id": 41295538, "link": "https://stackoverflow.com/questions/41295538/goroutine-analogues-in-other-languages", "title": "Goroutine analogues in other languages", "body": "<p>Concurrency is really hard part of programming. Recent time goroutine is very popular. My question is - What kind of goroutine analogues exist in other languages?</p>\n"}, {"tags": ["twitter", "go", "twitter-oauth"], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1482513402, "creation_date": 1482513402, "answer_id": 41305428, "question_id": 41295487, "link": "https://stackoverflow.com/questions/41295487/twitter-oauth-golang-getting-error-code32-messagecould-not-authenticate-y/41305428#41305428", "title": "Twitter oauth golang getting Error &quot;code&quot;:32,&quot;message&quot;:&quot;Could not authenticate you.&quot;", "body": "<p>Able to solve the problem. I made two changes:</p>\n\n<ol>\n<li><p>encoded the params variables before passing for encryption to create signature</p>\n\n<p>baseString := \"POST\"+\"&amp;\"+ encode(twitterConf.Endpoint.RequestTokenUrl) + \"&amp;\"+encode(params.Encode()) </p></li>\n<li><p>To create header, I created my own header string</p>\n\n<pre><code>    headerstring := \"OAuth oauth_callback=\\\"http%3A%2F%2Flocalhost%3A8080%2Foauth%2FtwitterOauth2callback\\\",oauth_consumer_key=\\\"consumerkey\\\",oauth_nonce=\\\"\" +\n        params.Get(NONCE_PARAM) + \"\\\",oauth_signature=\\\"\" + escape(signature) + \"\\\",oauth_signature_method=\\\"HMAC-SHA1\\\",oauth_timestamp=\\\"\" + params.Get(TIMESTAMP_PARAM) +\n        \"\\\",oauth_token=\\\"\" + escape(\"oauth token\") + \"\\\",oauth_version=\\\"1.0\\\"\"\n</code></pre>\n\n<p>reqnew.Header.Add(\"Authorization\", headerstring)</p></li>\n</ol>\n\n<p>This solved the problem and I started getting access token</p>\n"}], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1332, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496144282, "creation_date": 1482469720, "last_edit_date": 1482474436, "question_id": 41295487, "link": "https://stackoverflow.com/questions/41295487/twitter-oauth-golang-getting-error-code32-messagecould-not-authenticate-y", "title": "Twitter oauth golang getting Error &quot;code&quot;:32,&quot;message&quot;:&quot;Could not authenticate you.&quot;", "body": "<p>I am trying to do implement signing in with twitter account in golang. I am the first step where in I am trying to get the request token. As a reference I used the mrjones's code available at below link. <a href=\"https://github.com/mrjones/oauth/blob/master/examples/twitterserver/twitterserver.go\" rel=\"nofollow noreferrer\">https://github.com/mrjones/oauth/blob/master/examples/twitterserver/twitterserver.go</a></p>\n\n<p>I am getting following error. Please let me know where am I going wrong:</p>\n\n<blockquote>\n  <p>{\"errors\":[{\"code\":32,\"message\":\"Could not authenticate you.\"}]}</p>\n</blockquote>\n\n<pre><code>var twitterConf = &amp;TwitterConfig{\n    ClientID:     \" my consumer key\",\n    ClientSecret: \"my consumer key secret\",\n    RedirectURL:  \"http://localhost:8080/oauth/twitterOauth2callback\",\n\n    Endpoint: ServiceProvider{\n        RequestTokenUrl:   \"https://api.twitter.com/oauth/request_token\",\n        AuthorizeTokenUrl: \"https://api.twitter.com/oauth/authorize\",\n        AccessTokenUrl:    \"https://api.twitter.com/oauth2/token\",\n    },\n}\n\nfunc HandletwitterLogin(res http.ResponseWriter, req *http.Request, _ httprouter.Params) {\n\n    ctx := appengine.NewContext(req)\n\n    params := url.Values{}\n    params.Add(CALLBACK_PARAM, twitterConf.RedirectURL)\n    params.Add(CONSUMER_KEY_PARAM, twitterConf.ClientID)\n    params.Add(NONCE_PARAM, strconv.FormatInt(rand.New(rand.NewSource(time.Now().UnixNano())).Int63(), 10))\n    params.Add(SIGNATURE_METHOD_PARAM, SIGNATURE_METHOD_HMAC+\"SHA1\")\n    params.Add(TIMESTAMP_PARAM, strconv.FormatInt(time.Now().Unix(), 10))\n    params.Add(VERSION_PARAM, OAUTH_VERSION)\n    params.Add(\"oauth_token\", \"my oauth token\")\n\n    baseString := requestString(\"POST\", twitterConf.Endpoint.RequestTokenUrl, params)\n\n    signature, err6 := Sign(baseString, \"my token secret\")\n\n    params.Add(SIGNATURE_PARAM, signature)\n\n    Url, err := url.Parse(twitterConf.Endpoint.RequestTokenUrl)\n\n    Url.RawQuery = params.Encode()\n    firsturl := Url.String()\n\n    reqnew, err2 := http.NewRequest(\"POST\", firsturl, nil)\n    if err2 != nil {\n        log.Errorf(ctx, \"ERROR IN CREATING NEW REQUEST %+v \", err2)\n    }\n\n    reqnew.Header.Add(\"Authorization\", \"OAuth \")\n\n    client := urlfetch.Client(ctx)\n\n    resp, err3 := client.Do(reqnew)\n    if err3 != nil {\n        log.Errorf(ctx, \"ERROR IN doing the client request  %+v \", err3)\n    }\n\n    bodyBytes, err4 := ioutil.ReadAll(resp.Body)\n    resp.Body.Close()\n    log.Infof(ctx, \"HandletwitterLogin 5 \")\n    if err4 != nil {\n        log.Errorf(ctx, \"ERROR IN READALL RESP BODY   %+v \", err4)\n    }\n\n    bodyStr := string(bodyBytes)\n\n//Here i am getting above mentioned error\n}\n</code></pre>\n\n<p>These are the other functions which I used. </p>\n\n<pre><code>func requestString(method string, url string, params url.Values) string {\n    result := method + \"&amp;\" + escape(url)\n\n    for key, value := range params {\n        if len(value) &gt; 0 {\n            result += escape(\"&amp;\")\n\n            result += escape(fmt.Sprintf(\"%s=%s\", key, value))\n        }\n    }\n    return result\n}\n\nfunc Sign(message string, tokenSecret string) (string, error) {\n    key := escape(twitterConf.ClientSecret) + \"&amp;\" + escape(tokenSecret)\n\n    h := hmac.New(crypto.SHA1.New, []byte(key))\n    h.Write([]byte(message))\n    rawSignature := h.Sum(nil)\n\n    base64signature := base64.StdEncoding.EncodeToString(rawSignature)\n    return base64signature, nil\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482502981, "post_id": 41294843, "comment_id": 69808524, "body": "Thanks for the response. I&#39;m trying to find out a little more about the 3 different approaches suggested here (to decode into an Interface (<a href=\"http://stackoverflow.com/a/41294843/1745001\">stackoverflow.com/a/41294843/1745001</a> and <a href=\"http://stackoverflow.com/a/41295594/1745001\">stackoverflow.com/a/41295594/1745001</a>), or a Named structure (<a href=\"http://stackoverflow.com/a/41296043/1745001\">stackoverflow.com/a/41296043/1745001</a>), or an Unnamed structure (<a href=\"http://stackoverflow.com/a/41296207/1745001\">stackoverflow.com/a/41296207/1745001</a>). ) and then I&#39;ll start testing."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482888245, "post_id": 41294843, "comment_id": 69910284, "body": "Thanks for all the help, in the end I went with the named structure approach as that is apparently the convention in some other code for the product I&#39;m working on."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 4, "last_activity_date": 1542737746, "last_edit_date": 1542737746, "creation_date": 1482464213, "answer_id": 41294843, "question_id": 41294649, "link": "https://stackoverflow.com/questions/41294649/how-do-i-read-one-value-from-a-json-file-using-go/41294843#41294843", "title": "How do I read one value from a JSON file using Go", "body": "<p>One thing is reading a file and other one is decoding a JSON document. I leave you a full example doing both. To run it you have to have a file called <code>file.json</code> in the same directory of your code or binary executable:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    f, err := os.Open(\"file.json\") // file.json has the json content\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    bb, err := ioutil.ReadAll(f)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    doc := make(map[string]interface{})\n    if err := json.Unmarshal(bb, &amp;doc); err != nil {\n        log.Fatal(err)\n    }\n\n    if name, contains := doc[\"name\"]; contains {\n        log.Printf(\"Happy end we have a name: %q\\n\", name)\n    } else {\n        log.Println(\"Json document doesn't have a name field.\")\n    }\n\n    log.Printf(\"full json: %s\", string(bb))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/0u04MwwGfn\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0u04MwwGfn</a></p>\n"}, {"comments": [{"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482888236, "post_id": 41295594, "comment_id": 69910282, "body": "Thanks for all the help, in the end I went with the named structure approach as that is apparently the convention in some other code for the product I&#39;m working on."}], "tags": [], "owner": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1482472230, "last_edit_date": 1482472230, "creation_date": 1482470438, "answer_id": 41295594, "question_id": 41294649, "link": "https://stackoverflow.com/questions/41294649/how-do-i-read-one-value-from-a-json-file-using-go/41295594#41295594", "title": "How do I read one value from a JSON file using Go", "body": "<p>I have also tried to find a simple solution such as <code>$d = json_decode($json, true)</code> in PHP and came to the conclusion that there is no such simple way in Golang. The following is the simplest solution I could make <em>(the checks are skipped for clarity)</em>:</p>\n\n<pre><code>var f interface{}\nerr = json.Unmarshal(file, &amp;f)\n\nm := f.(map[string]interface{})\nif (m[\"name\"] == \"apple\") {\n  // Do something\n}\n</code></pre>\n\n<p>where</p>\n\n<ul>\n<li><code>file</code> is an array of bytes of JSON string,</li>\n<li><code>f</code> interface serves as a generic container for unknown JSON structure,</li>\n<li><code>m</code> is a map returned by the <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>.</li>\n</ul>\n\n<p>We can assert that <code>f</code> is a map of strings, because <code>Unmarshal()</code> builds a variable of that type for any JSON input. At least, I couldn't make it return something different. It is possible to detect the type of a variable by means of <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">run-time reflection</a>:</p>\n\n<pre><code>fmt.Printf(\"Type of f = %s\\n\", reflect.TypeOf(f))\n</code></pre>\n\n<p>For the <code>f</code> variable above, the code will print <code>Type of f = map[string]interface {}</code>.</p>\n\n<h1>Example</h1>\n\n<p>And this is the full code with necessary checks:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"os\"\n  \"io/ioutil\"\n  \"encoding/json\"\n)\n\nfunc main() {\n  // Read entire file into an array of bytes\n  file, err := ioutil.ReadFile(\"foo.json\")\n  if (err != nil) {\n    fmt.Fprintf(os.Stderr, \"Failed read file: %s\\n\", err)\n    os.Exit(1)\n  }\n\n  var f interface{}\n  err = json.Unmarshal(file, &amp;f)\n  if (err != nil) {\n    fmt.Fprintf(os.Stderr, \"Failed to parse JSON: %s\\n\", err)\n    os.Exit(1)\n  }\n\n  // Type-cast `f` to a map by means of type assertion.\n  m := f.(map[string]interface{})\n  fmt.Printf(\"Parsed data: %v\\n\", m)\n\n  // Now we can check if the parsed data contains 'name' key\n  if (m[\"name\"] == \"apple\") {\n    fmt.Print(\"Apple found\\n\")\n  }\n}\n</code></pre>\n\n<p><em>Output</em></p>\n\n<pre><code>Parsed data: map[type:fruit name:apple color:red]\nApple found\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 1, "creation_date": 1482497249, "post_id": 41296043, "comment_id": 69805907, "body": "You do not need to explicitly declare <code>data</code>. Also, if there&#39;s only one output (i.e. <code>err</code> from <code>json.Unmarshal()</code>)and you&#39;re deciding to ignore it, then there&#39;s no need to assign the output at all."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482502640, "post_id": 41296043, "comment_id": 69808357, "body": "Thanks for the response. When you say <code>Provided the format remains similar to..</code> - what would be an example of it becoming dis-similar and result in breaking the code?"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482821493, "post_id": 41296043, "comment_id": 69883052, "body": "@EdMorton Sorry, was away for Christmas. Updated."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 0, "creation_date": 1482821807, "post_id": 41296043, "comment_id": 69883174, "body": "@W.K.S I explicitly declared <code>data</code> to make is clear that it was a <code>[]byte</code>, since it was being used for the other examples as well (gabs &amp; jason).   And put in the <code>_ = json.Unmarshal</code> to make it clear that I was masking the error  since it was sample code. :)"}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482883824, "post_id": 41296043, "comment_id": 69909502, "body": "@JohnSPerayil thanks for the clarification, it makes sense that the Go structure would need to match the JSON structure in terms of nested levels."}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 4, "last_activity_date": 1482821349, "last_edit_date": 1482821349, "creation_date": 1482473344, "answer_id": 41296043, "question_id": 41294649, "link": "https://stackoverflow.com/questions/41294649/how-do-i-read-one-value-from-a-json-file-using-go/41296043#41296043", "title": "How do I read one value from a JSON file using Go", "body": "<p>The easiest method to do what you want is to decode into a struct.</p>\n\n<p>Provided the format remains similar to   <code>{\"type\":\"fruit\",\"name\":\"apple\",\"color\":\"red\"}</code></p>\n\n<pre><code>type Name struct {\n    Name string `json:\"name\"`\n}\n\nvar data []byte\ndata, _ = ioutil.ReadFile(\"foo.json\")\n\nvar str Name\n_ = json.Unmarshal(data, &amp;str)\n\nif str.Name == \"apple\" {\n    // Do Stuff\n}\n</code></pre>\n\n<p>Your other option is to use third party libraries such as <a href=\"https://github.com/Jeffail/gabs\" rel=\"nofollow noreferrer\"><code>gabs</code></a> or <a href=\"https://github.com/antonholmquist/jason\" rel=\"nofollow noreferrer\"><code>jason</code></a>.</p>\n\n<p>Gabs :</p>\n\n<pre><code>jsonParsed, err := gabs.ParseJSON(data)\nname, ok := jsonParsed.Path(\"name\").Data().(string)\n</code></pre>\n\n<p>Jason :</p>\n\n<pre><code>v, _ := jason.NewObjectFromBytes(data)\nname, _ := v.GetString(\"name\")\n</code></pre>\n\n<hr>\n\n<p>Update :</p>\n\n<p>The structure</p>\n\n<pre><code>type Name struct {\n    Name string `json:\"name\"`\n}\n</code></pre>\n\n<p>is the json equivalent of <code>{\"name\":\"foo\"}</code>.</p>\n\n<p>So unmarshaling won't work for the following json with different formats.</p>\n\n<pre><code>[{\"name\":\"foo\"}]\n\n{\"bar\":{\"name\":\"foo\"}}\n</code></pre>\n\n<p>PS : As mentioned by <code>W.K.S</code>. In your case an anonymous struct would suffice since you're not using this structure for anything else.</p>\n"}, {"comments": [{"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482502789, "post_id": 41296207, "comment_id": 69808425, "body": "Thanks for the response. I seem to have 3 choices to decode into - an Interface (<a href=\"http://stackoverflow.com/a/41294843/1745001\">stackoverflow.com/a/41294843/1745001</a> and <a href=\"http://stackoverflow.com/a/41295594/1745001\">stackoverflow.com/a/41295594/1745001</a>), a Named structure (<a href=\"http://stackoverflow.com/a/41296043/1745001\">stackoverflow.com/a/41296043/1745001</a>), or an Unnamed structure (<a href=\"http://stackoverflow.com/a/41296207/1745001\">stackoverflow.com/a/41296207/1745001</a>). Are there any pros/cons to either approach beyond possible code brevity?"}, {"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "reply_to_user": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482504540, "post_id": 41296207, "comment_id": 69809334, "body": "I&#39;d say it depends on what your requirements are. Decoding into an interface makes sense when, say, a web api returns a different json structure depending on the request parameters it receives. When the json structure is known, a struct makes more sense: A named struct would be preferable when the json structure maps directly to an entity in your application. On the other hand, when the json does not represent an entity and you simply need to read the value of a few field (such as in your question), an anonymous struct would suffice."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482504905, "post_id": 41296207, "comment_id": 69809501, "body": "That makes sense, thanks. It does sound like an unnamed struct would be the way to do this for my case (reading a config file that rarely changes). Now to testing..."}, {"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "reply_to_user": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482505403, "post_id": 41296207, "comment_id": 69809740, "body": "In your question, you mentioned that this configuration file rarely changes and is not that relevant to your application. In this context, I agree, you&#39;re best of using an anonymous struct. However, In general, I do prefer to define a Configuration struct because it clearly documents what the configuration fields are and their data types. Additionally you can use enumerators for readability and associate convenience functions."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1482888148, "post_id": 41296207, "comment_id": 69910269, "body": "Thanks for all the help, in the end I went with the named structure approach as that is apparently the convention in some other code for the product I&#39;m working on."}], "tags": [], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1482475261, "last_edit_date": 1482475261, "creation_date": 1482474251, "answer_id": 41296207, "question_id": 41294649, "link": "https://stackoverflow.com/questions/41294649/how-do-i-read-one-value-from-a-json-file-using-go/41296207#41296207", "title": "How do I read one value from a JSON file using Go", "body": "<p>The proper Go way of doing this would be to decode into an instance of an anonymous struct containing only the field you need.</p>\n\n<pre><code>func main() {\n    myStruct := struct{ Name string }{}\n    json.Unmarshal([]byte(`{\"type\":\"fruit\",\"name\":\"apple\",\"color\":\"red\"}`), &amp;myStruct)\n    fmt.Print(myStruct.Name)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/R4THsaW1q3\" rel=\"nofollow noreferrer\">Playground Link</a></p>\n\n<p>Alternatively, You could use <a href=\"https://github.com/Jeffail/gabs\" rel=\"nofollow noreferrer\">Jeffails/gabs</a> JSON Parser:</p>\n\n<pre><code>jsonParsed,_ := gabs.ParseJSON([]byte(`{\"type\":\"fruit\",\"name\":\"apple\",\"color\":\"red\"}`));\nvalue, ok = jsonParsed.Path(\"name\").Data().(string)\n</code></pre>\n"}], "owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4325, "favorite_count": 1, "accepted_answer_id": 41296043, "answer_count": 4, "score": 1, "last_activity_date": 1542737746, "creation_date": 1482462286, "question_id": 41294649, "link": "https://stackoverflow.com/questions/41294649/how-do-i-read-one-value-from-a-json-file-using-go", "title": "How do I read one value from a JSON file using Go", "body": "<p>I an new to programming in <code>Go</code> so apologies if this is something obvious. I have a <code>JSON</code> file named <code>foo.json</code>:</p>\n\n<pre><code>{\"type\":\"fruit\",\"name\":\"apple\",\"color\":\"red\"}\n</code></pre>\n\n<p>and I am writing a <code>Go</code> program that has to do something when the \"name\" value in the JSON file is \"apple\". It needs no other information from that JSON file as that file is used for a completely different purpose in another area of the code.</p>\n\n<p>I have read documentation on Decode() and Unmarshal() and abut 30 different web pages describing how to read the whole file into structures, etc. but it all seems extremely complicated for what I want to do which is just write the correct code to implement the first 2 lines of this pseudo-code:</p>\n\n<pre><code>file, _ := os.Open(\"foo.json\")\nname = file[\"name\"]\nif (name == \"apple\") {\n    do stuff\n}\n</code></pre>\n\n<p>such that I end up with a <code>Go</code> variable named <code>name</code> that contains the string value <code>apple</code>. What is the right way to do this in Go?</p>\n"}, {"tags": ["multithreading", "go", "lock-free", "compare-and-swap"], "answers": [{"comments": [{"owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "edited": false, "score": 0, "creation_date": 1482472037, "post_id": 41294424, "comment_id": 69794231, "body": "Aha! It just now clicked for me after reading your answer about 5 times."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 1, "last_activity_date": 1482472087, "last_edit_date": 1482472087, "creation_date": 1482460057, "answer_id": 41294424, "question_id": 41294061, "link": "https://stackoverflow.com/questions/41294061/does-the-following-lock-free-code-exhibit-a-race-condition/41294424#41294424", "title": "Does the following lock-free code exhibit a race-condition?", "body": "<p>If another thread got in the middle, the CompareAndSwap would fail and the loop would start over.</p>\n\n<p>Think of CompareAndSwap as</p>\n\n<pre><code>if actual == expected { \n   actual = newval\n}\n</code></pre>\n\n<p>but done atomically</p>\n\n<p>So this code says:</p>\n\n<pre><code>old = hwm // but done in a thread safe atomic read way\nif old &lt; current {\n   set hwm to current if hwm == old // atomically compare and then set value\n}\n</code></pre>\n\n<p>when CAS (CompareAndSwap) fails, it returns false, causing the loop to start over until either:</p>\n\n<p>a) \"current\" is not bigger than hwm</p>\n\n<p>or </p>\n\n<p>b) It successfully performs Load and then CompareAndSwap without another thread in the middle</p>\n"}], "owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 1, "accepted_answer_id": 41294424, "answer_count": 1, "score": 0, "last_activity_date": 1482472087, "creation_date": 1482456884, "question_id": 41294061, "link": "https://stackoverflow.com/questions/41294061/does-the-following-lock-free-code-exhibit-a-race-condition", "title": "Does the following lock-free code exhibit a race-condition?", "body": "<p>Within the <a href=\"https://github.com/kubernetes/kubernetes/blob/master/pkg/storage/util.go#L148\" rel=\"nofollow noreferrer\">Kubernetes Go repo on Github.com</a>,</p>\n\n<p>There is a lock-free implementation of a HighWaterMark data-structure.  This code relies on atomic operations to achieve thread-safe code that is free of data races.</p>\n\n<pre><code>// HighWaterMark is a thread-safe object for tracking the maximum value seen\n// for some quantity.\ntype HighWaterMark int64\n\n// Update returns true if and only if 'current' is the highest value ever seen.\nfunc (hwm *HighWaterMark) Update(current int64) bool {\n    for {\n        old := atomic.LoadInt64((*int64)(hwm))\n        if current &lt;= old {\n            return false\n        }\n        if atomic.CompareAndSwapInt64((*int64)(hwm), old, current) {\n            return true\n        }\n    }\n}\n</code></pre>\n\n<p>This code relies on the <code>atomic.LoadInt64</code> and <code>atomic.CompareAndSwapInt64</code> functions within the standard library to achieve data race free code...which I believe it does but I believe there is another problem of a race condition.</p>\n\n<p>If two competing threads (<code>goroutines</code>) are executing such code there exists an edge case where after the <code>atomic.LoadInt64</code> occurs in the first thread, the second thread could have swapped out for a higher value. But after the first thread <em>thinks</em> the <code>current</code> int64 is actually larger than the <code>old</code> int64 a swap will happen.  This swap would then effectively lower the stored value due to observing a stale <code>old</code> value.</p>\n"}, {"tags": ["string", "text", "go"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 3, "creation_date": 1482449773, "post_id": 41293154, "comment_id": 69789121, "body": "You will need to <a href=\"https://stackoverflow.com/posts/41293154/edit\">edit</a> to be more specific with what you&#39;re trying to accomplish. Before you edit though, please read about the <a href=\"https://en.wikipedia.org/wiki/Scunthorpe_problem\" rel=\"nofollow noreferrer\">Scunthorpe problem</a>, so that you can understand the pitfalls in what you&#39;re asking for."}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 7266656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ea81b2c8cc2626611e7f2d06ab5e31?s=128&d=identicon&r=PG&f=1", "display_name": "r3vit", "link": "https://stackoverflow.com/users/7266656/r3vit"}, "is_accepted": true, "score": 1, "last_activity_date": 1482487471, "creation_date": 1482487471, "answer_id": 41299250, "question_id": 41293154, "link": "https://stackoverflow.com/questions/41293154/the-best-way-to-censor-words-in-golang/41299250#41299250", "title": "the best way to censor words in golang", "body": "<p>This problem can be solved with <a href=\"https://golang.org/pkg/strings/\" rel=\"nofollow noreferrer\">\"strings\"</a> library functions.</p>\n\n<p>Look at this example:\n<a href=\"https://www.socketloop.com/tutorials/golang-simple-word-filter-or-censor-example\" rel=\"nofollow noreferrer\">Golang simple world filter o censor</a></p>\n"}], "owner": {"reputation": 392, "user_id": 1832496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5860f6ae31ba8a90320c31b8d2e69d05?s=128&d=identicon&r=PG", "display_name": "Dariush Abbasi", "link": "https://stackoverflow.com/users/1832496/dariush-abbasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "closed_date": 1482487550, "accepted_answer_id": 41299250, "answer_count": 1, "score": -2, "last_activity_date": 1482487471, "creation_date": 1482449446, "last_edit_date": 1482480269, "question_id": 41293154, "link": "https://stackoverflow.com/questions/41293154/the-best-way-to-censor-words-in-golang", "closed_reason": "Needs more focus", "title": "the best way to censor words in golang", "body": "<p>What is the best pattern to censor specific abuse words in string with golang?</p>\n\n<p>For example censor this text:</p>\n\n<blockquote>\n  <p>Mark is a porn-star.</p>\n</blockquote>\n\n<p>to </p>\n\n<blockquote>\n  <p>Mark is a p*******r.</p>\n</blockquote>\n\n<p>from a list of words that we pass to it.</p>\n"}, {"tags": ["go", "struct", "comparison"], "comments": [{"owner": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "edited": false, "score": 0, "creation_date": 1482440092, "post_id": 41290735, "comment_id": 69785606, "body": "Can you explain why you prefer not to make the <code>Favorites</code> field a pointer? If you don&#39;t care about equivalence and are simply trying to verify the field is set at all, then this seems like the best option."}, {"owner": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "edited": false, "score": 1, "creation_date": 1482440249, "post_id": 41290735, "comment_id": 69785665, "body": "To add to my previous comment, I would suggest being careful about using the zero value to denote &quot;un-set&quot; on other types as well. 0 may be a perfectly valid value for an <code>int</code> field."}, {"owner": {"reputation": 5153, "user_id": 804713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/454ce0be068cbbf25ee685af20dc7cd6?s=128&d=identicon&r=PG", "display_name": "stephenbez", "link": "https://stackoverflow.com/users/804713/stephenbez"}, "reply_to_user": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "edited": false, "score": 0, "creation_date": 1482441103, "post_id": 41290735, "comment_id": 69786013, "body": "@daltonclaybrook It would usually be the best option.  In a large codebase where the struct is used all over, I would be more concerned with making the change.  Also if there are many struct fields in the struct, it seems like if I changed one to be a pointer, then for consistency I should probably change all of them."}], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "edited": false, "score": 0, "creation_date": 1482486446, "post_id": 41291190, "comment_id": 69800245, "body": "Does need to sort the arrays before comparison their values?"}], "tags": [], "owner": {"reputation": 3591, "user_id": 4107956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LjlBF.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4107956/will"}, "is_accepted": false, "score": 4, "last_activity_date": 1482499982, "last_edit_date": 1495535433, "creation_date": 1482438495, "answer_id": 41291190, "question_id": 41290735, "link": "https://stackoverflow.com/questions/41290735/is-there-a-way-to-compare-a-struct-with-a-slice-field-with-the-zero-value-struct/41291190#41291190", "title": "Is there a way to compare a struct with a slice field with the zero value struct?", "body": "<p><a href=\"https://stackoverflow.com/questions/24534072/how-to-compare-struct-slice-map-are-equal\">According to this</a>, you can use <code>reflect.DeepEqual()</code>, but probably should just write your own:</p>\n\n<pre><code>type Favorites struct {\n    Color string\n    Lunch string\n    Place string\n    Hobbies []string \n}\n\nfunc (favs *Favorites) Equals(other *Favorites) bool {\n    color_eq := favs.Color == other.Color\n    lunch_eq := favs.Lunch == other.Lunch\n    place_eq := favs.Place == other.Place\n    hobbies_eq := len(favs.Hobbies) == len(other.Hobbies)\n    if hobbies_eq {  // copy slices so sorting won't affect original structs\n        f_hobbies := make([]string, len(favs.Hobbies))\n        o_hobbies := make([]string, len(other.Hobbies))\n        copy(favs.Hobbies, f_hobbies)\n        copy(other.Hobbies, o_hobbies)\n        sort.Strings(f_hobbies)\n        sort.Strings(o_hobbies)\n        for index, item := range f_hobbies {\n            if item != o_hobbies[index] {\n                hobbies_eq = false\n            }\n        }\n    }\n    return (color_eq &amp;&amp; lunch_eq &amp;&amp; place_eq &amp;&amp; hobbies_eq)\n}\n</code></pre>\n\n<p>Then call it with:</p>\n\n<pre><code>p2.Favorites.Equals(zeroValue)\n</code></pre>\n"}], "owner": {"reputation": 5153, "user_id": 804713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/454ce0be068cbbf25ee685af20dc7cd6?s=128&d=identicon&r=PG", "display_name": "stephenbez", "link": "https://stackoverflow.com/users/804713/stephenbez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4937, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1482499982, "creation_date": 1482436517, "last_edit_date": 1482441394, "question_id": 41290735, "link": "https://stackoverflow.com/questions/41290735/is-there-a-way-to-compare-a-struct-with-a-slice-field-with-the-zero-value-struct", "title": "Is there a way to compare a struct with a slice field with the zero value struct?", "body": "<p>I have a <code>Favorites</code> struct with a slice field:</p>\n\n<pre><code>type Favorites struct {\n    Color string\n    Lunch string\n    Place string\n    Hobbies []string \n}\n</code></pre>\n\n<p>and I have a <code>Person</code> which contains the other struct:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Favorites Favorites\n}\n</code></pre>\n\n<p>I'd like to see if the <code>Favorites</code> field is set on Person.   For other types of fields, for example, a string or an int, I would compare that field to the zero value (\"\" or 0 respectively).</p>\n\n<p>If I try to compare with the zero as below I get the error <code>invalid operation: p2.Favorites == zeroValue (struct containing []string cannot be compared)</code>:</p>\n\n<pre><code>p2 := Person{Name: \"Joe\"}\n\nzeroValue := Favorites{}\nif p2.Favorites == zeroValue {\n    fmt.Println(\"Favorites not set\")\n}\n</code></pre>\n\n<p>This matches what is defined in the spec (<a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Comparison_operators</a>).</p>\n\n<p>Is there anyway to do this comparison other than tediously comparing every single field (and having to remember to update it if the struct changes)?</p>\n\n<p>One option is to make the Favorites field a pointer to the struct instead of the struct itself and then just compare with nil, but this is in a large codebase so I'd rather not make potentially far-reaching changes in this case.</p>\n\n<p><a href=\"https://play.golang.org/p/d0NSp8eBes\" rel=\"nofollow noreferrer\">https://play.golang.org/p/d0NSp8eBes</a></p>\n"}, {"tags": ["mysql", "go", "unicode", "utf-8"], "comments": [{"owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "edited": false, "score": 1, "creation_date": 1482429231, "post_id": 41288165, "comment_id": 69780515, "body": "Did you try what says in charset here: <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">github.com/go-sql-driver/mysql</a> ?"}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1482515362, "post_id": 41288165, "comment_id": 69814347, "body": "Does your API allow multiple statements??  Check for errors after every <code>db.exec()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1482515446, "post_id": 41290102, "comment_id": 69814381, "body": "The <code>SET NAMES utf8mb4</code> <i>should</i> have compensated for the lack of specification to the driver."}], "tags": [], "owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "is_accepted": false, "score": 0, "last_activity_date": 1482433576, "last_edit_date": 1495535437, "creation_date": 1482433576, "answer_id": 41290102, "question_id": 41288165, "link": "https://stackoverflow.com/questions/41288165/error-inserting-valid-4-byte-utf-8-sequence-into-mysql/41290102#41290102", "title": "Error inserting valid 4-byte UTF-8 sequence into MySQL", "body": "<p><a href=\"https://stackoverflow.com/questions/41288165/error-inserting-valid-utf8-byte-sequence-into-mysql#comment69780515_41288165\">Like @Rico said</a> I needed to specify the collation (utf8mb4_unicode_ci) so the go-mysql lib didn't default to <code>utf8</code> and cause problems with my 4byte unicode runes (mysql's utf8 only supports up to 3byte unicode). </p>\n\n<pre><code>[username[:password]@][protocol[(address)]]/dbname?collation=utf8mb4_unicode_ci\n</code></pre>\n\n<p>See the <a href=\"https://github.com/go-sql-driver/mysql#charset\" rel=\"nofollow noreferrer\">go-sql-driver readme</a> for more information.</p>\n"}], "owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1482515636, "creation_date": 1482425705, "last_edit_date": 1482515636, "question_id": 41288165, "link": "https://stackoverflow.com/questions/41288165/error-inserting-valid-4-byte-utf-8-sequence-into-mysql", "title": "Error inserting valid 4-byte UTF-8 sequence into MySQL", "body": "<p>I have the following UTF-8 byte string I'm trying to store in a MySQL table (utf8mb4) but getting a failure from the mysql server.</p>\n\n<pre><code>...\ndb.Exec(\"SET NAMES 'utf8mb4'; SET CHARACTER SET utf8mb4;\")\n\nvar badBytes = []byte{\n    34, 48, 34, 32, 47, 62, 66, 117, 121, 32, 105, 116, 32, 110, 111, 119, 32,\n    240, 159, 147, 149, 32, 60, 97, 32, 104, 114, 101, 102, 61, 34, 104, 116,\n}\n\nfmt.Println(\"UTF8 Valid\", utf8.Valid(badBytes))\nfmt.Println()\nfmt.Println(string(badBytes))\nfmt.Println()\n\nres, err := db.Exec(\"INSERT INTO demo (body) VALUES (?)\", string(badBytes))\nif err != nil {\n    log.Fatal(err)\n}\n\nid, err := res.LastInsertId()\nfmt.Println(id, err)\n</code></pre>\n\n<p>The output is below</p>\n\n<pre><code>UTF8 Valid true\n\n=\"1\" border=\"0\" /&gt;Buy it now \ud83d\udcd5 &lt;a href=\"ht_tl\n\nError 1366: Incorrect string value: '\\xF0\\x9F\\x93\\x95 &lt;...' for column 'body' at row 1\n</code></pre>\n\n<p>The MySQL table and connections are all <code>utf8mb4</code>:</p>\n\n<pre><code>CREATE TABLE `demo` (\n  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n  `body` text COLLATE utf8mb4_unicode_ci,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n</code></pre>\n"}, {"tags": ["if-statement", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": true, "score": 85, "last_activity_date": 1482421265, "creation_date": 1482421265, "answer_id": 41286801, "question_id": 41285924, "link": "https://stackoverflow.com/questions/41285924/if-not-true-true/41286801#41286801", "title": "If not true (!true)", "body": "<p>Use the function <a href=\"https://golang.org/pkg/text/template/#hdr-Functions\" rel=\"noreferrer\"><code>not</code></a>:</p>\n\n<pre><code>{{ if not .loggedIn }}\n&lt;h1&gt;Not logged in&lt;/h1&gt;\n{{ end }}\n</code></pre>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38501, "favorite_count": 7, "accepted_answer_id": 41286801, "answer_count": 1, "score": 59, "last_activity_date": 1531329969, "creation_date": 1482418560, "last_edit_date": 1531329969, "question_id": 41285924, "link": "https://stackoverflow.com/questions/41285924/if-not-true-true", "title": "If not true (!true)", "body": "<p>In golang's template/html package, I can use <code>{{ if .loggedIn }}</code> to check if logged in is true.</p>\n\n<p>How do I check if .loggedIn is false without using ne or eq?</p>\n\n<hr>\n\n<p>For example, I am looking for something like</p>\n\n<pre><code>{{ if !.loggedIn }}\n&lt;h1&gt;Not logged in&lt;/h1&gt;\n{{ end }}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "channel"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1482421086, "post_id": 41285842, "comment_id": 69775393, "body": "Note that your second code <code>case &lt;-mychan: fmt.Println(&lt;-mychan)</code> reads from mychan <b>twice</b> and discards the first result. That&#39;s my you see 1, 3, 5, .... You might want <code>case i &lt;- myhcan: fmt.Println(i)</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482421609, "post_id": 41285842, "comment_id": 69775745, "body": "All channel receive operations are the same (expect of course the 2 value assignment, which can show the status of a closed channel). The only difference in behavior you have is discarding every other received value in the select statement."}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1482430605, "post_id": 41285842, "comment_id": 69781154, "body": "<a href=\"https://play.golang.org/p/CEMKqJF3ya\" rel=\"nofollow noreferrer\">play.golang.org/p/CEMKqJF3ya</a> &lt;- This code snippet &quot;proves&quot; that the range keyword will work with open channels. I am pretty curious why the program hangs. Does it know it won&#39;t be closed somehow?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1482432220, "post_id": 41285842, "comment_id": 69781978, "body": "@BenjaminKadish: it doesn&#39;t hang, it reports a deadlock because no goroutines can proceed. This doesn&#39;t happen If there is another goroutine doing <i>something</i> <a href=\"https://play.golang.org/p/8CwgCaw4Qq\" rel=\"nofollow noreferrer\">play.golang.org/p/8CwgCaw4Qq</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 1, "creation_date": 1482444164, "post_id": 41289595, "comment_id": 69787360, "body": "Looks good. However, the first case should be omitted or it will only print &quot;foo&quot; after an initial print. Also, the second case is missing <code>:=</code>"}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "reply_to_user": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1482854423, "post_id": 41289595, "comment_id": 69898214, "body": "Foo appears to print out for me? I&#39;m not sure I understand (thanks for the assignment fix)"}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": true, "score": 4, "last_activity_date": 1482854369, "last_edit_date": 1482854369, "creation_date": 1482431327, "answer_id": 41289595, "question_id": 41285842, "link": "https://stackoverflow.com/questions/41285842/difference-ways-to-read-channels/41289595#41289595", "title": "Difference Ways to Read Channels", "body": "<p>The behavior from </p>\n\n<pre><code>for i := range mychan {\n    fmt.Println(i)\n}\n</code></pre>\n\n<p>Appears to result from running examples on <a href=\"https://play.golang.org/p/bMvtp4UVZX\" rel=\"nofollow noreferrer\">go playground</a> When I ran the code locally the program prints out one value every second indefinitely. It would be cool if there is some code analysis tool they are using on the server to figure out if the code will run forever.</p>\n\n<p>As Volker points out your second example is reading the channel twice per print statement. You can fix this with </p>\n\n<pre><code>for i:=0; i&lt;=10;i++ {\n    select {\n    case &lt;-time.After(1 * time.Second):\n        fmt.Println(\"foo\")\n    case x, open := &lt;-mychan:\n        if !open { return }\n        fmt.Println(x)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 41289595, "answer_count": 1, "score": 0, "last_activity_date": 1482854369, "creation_date": 1482418300, "question_id": 41285842, "link": "https://stackoverflow.com/questions/41285842/difference-ways-to-read-channels", "title": "Difference Ways to Read Channels", "body": "<p>I am curious of why different ways of reading values from a channel result in different behaviors. Provided the code:</p>\n\n<pre><code>mychan := make(chan int)\n\ngo func() {\n    i := 0\n    for {\n        mychan &lt;- i\n        &lt;-time.After(time.Second * 1)\n        i++\n    }\n}()\n</code></pre>\n\n<p>The goroutine \"streams\" a sequence of integer infinitely to a <code>mychan</code> channel. After this code, if you read directly with <code>&lt;-mychan</code> like so:</p>\n\n<pre><code>fmt.Println(&lt;-mychan)\n</code></pre>\n\n<p>This prints \"0\" as expected. If you keep repeating, it keeps reading:</p>\n\n<pre><code>fmt.Println(&lt;-mychan)    // 1\nfmt.Println(&lt;-mychan)    // 2\n//...\n</code></pre>\n\n<p>However, using the looping mechanism, it blocks infinitely.</p>\n\n<pre><code>for i := range mychan {\n    fmt.Println(i)\n}\n</code></pre>\n\n<p>That means that this mechanism can only reads from a closed channel, right?\nHowever, with <code>select</code> method, thing gets wierder:</p>\n\n<pre><code>for i:=0; i&lt;=10;i++ {\n    select {\n    case &lt;-mychan:\n        fmt.Println(&lt;-mychan)\n    }\n}\n</code></pre>\n\n<p>Now it prints alternately, like 1, 3, 5, 9, ... every 2s as if <code>select</code> was switching between <code>mychan</code> and some other invisible channel. Adding another <code>case</code> makes the case (no pun intended):</p>\n\n<pre><code>for i:=0; i&lt;=10;i++ {\n    select {\n    case &lt;-time.After(1 * time.Second):\n        fmt.Println(\"foo\")\n    case &lt;-mychan:\n        fmt.Println(&lt;-mychan)\n    }\n}\n\n// now prints 1, foo, 3, foo, 5, foo, ... every 1s\n</code></pre>\n\n<p>As trivial the question as it may seems to some of you, I'd appreciate if anyone can explain and enlighten me. </p>\n"}, {"tags": ["ruby", "string", "go"], "answers": [{"comments": [{"owner": {"reputation": 2910, "user_id": 351149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e711a4293f85d60fcb46497ff214acfd?s=128&d=identicon&r=PG", "display_name": "DSimon", "link": "https://stackoverflow.com/users/351149/dsimon"}, "edited": false, "score": 0, "creation_date": 1482419171, "post_id": 41286022, "comment_id": 69774021, "body": "That is awesome that Go calls them &quot;runes&quot; :-)"}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": true, "score": 4, "last_activity_date": 1482418873, "creation_date": 1482418873, "answer_id": 41286022, "question_id": 41285456, "link": "https://stackoverflow.com/questions/41285456/ruby-squeeze-alternative-in-go/41286022#41286022", "title": "Ruby squeeze alternative in go", "body": "<p>You can do it like this:</p>\n\n<pre><code>func Squeeze(s string) string {\n    result := make([]rune, 0)\n    var previous rune\n    for _, rune := range s {\n        if rune != previous {\n            result = append(result, rune)\n        }\n        previous = rune\n    }\n    return string(result)\n}\n</code></pre>\n\n<p>Bear in mind that strings are UTF8 in Go so you have to use runes (characters) rather than bytes in order to be compatible with non-ASCII strings.</p>\n"}], "owner": {"reputation": 392, "user_id": 1832496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5860f6ae31ba8a90320c31b8d2e69d05?s=128&d=identicon&r=PG", "display_name": "Dariush Abbasi", "link": "https://stackoverflow.com/users/1832496/dariush-abbasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 41286022, "answer_count": 1, "score": 1, "last_activity_date": 1482418873, "creation_date": 1482417077, "question_id": 41285456, "link": "https://stackoverflow.com/questions/41285456/ruby-squeeze-alternative-in-go", "title": "Ruby squeeze alternative in go", "body": "<p>Ruby strings had a method called <code>squeeze</code>. From ruby docs :</p>\n\n<blockquote>\n  <p>Builds a set of characters from the other_str parameter(s) using the\n  procedure described for String#count. Returns a new string where runs\n  of the same character that occur in this set are replaced by a single\n  character. If no arguments are given, all runs of identical characters\n  are replaced by a single character.</p>\n</blockquote>\n\n<pre><code>\"yellow moon\".squeeze                  #=&gt; \"yelow mon\"\n\"  now   is  the\".squeeze(\" \")         #=&gt; \" now is the\"\n\"putters shoot balls\".squeeze(\"m-z\")   #=&gt; \"puters shot balls\"\n</code></pre>\n\n<p>IS there an alternative function for this operation in golang? If not whats the best way to do it in go?</p>\n"}, {"tags": ["go", "swagger", "mustache", "swagger-codegen"], "comments": [{"owner": {"reputation": 7509, "user_id": 677735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pyjch.png?s=128&g=1", "display_name": "William Cheng", "link": "https://stackoverflow.com/users/677735/william-cheng"}, "edited": false, "score": 0, "creation_date": 1482426087, "post_id": 41284057, "comment_id": 69778814, "body": "Please open an &quot;issue&quot; in <a href=\"https://github.com/swagger-api/swagger-codegen/issues/new\" rel=\"nofollow noreferrer\">github.com/swagger-api/swagger-codegen/issues/new</a> so that we can look into the issue with a spec you provided."}, {"owner": {"reputation": 721, "user_id": 3065701, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f022411fe52babb7026b79339b24d919?s=128&d=identicon&r=PG&f=1", "display_name": "Jeet", "link": "https://stackoverflow.com/users/3065701/jeet"}, "reply_to_user": {"reputation": 7509, "user_id": 677735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pyjch.png?s=128&g=1", "display_name": "William Cheng", "link": "https://stackoverflow.com/users/677735/william-cheng"}, "edited": false, "score": 0, "creation_date": 1482484603, "post_id": 41284057, "comment_id": 69799292, "body": "Have posted in swagger-codegen as new issue.. I am new and not able to figure out how can I generate enum with the same model.mustache as I dont see the support for the same in the mustache file. I can see that DefaultCodegen has the option but I m not able to understand it for reusing. I feel that something must be added within mustache file to support the same and GoClientCodegen as well needs to be modified."}], "owner": {"reputation": 721, "user_id": 3065701, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f022411fe52babb7026b79339b24d919?s=128&d=identicon&r=PG&f=1", "display_name": "Jeet", "link": "https://stackoverflow.com/users/3065701/jeet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482431227, "creation_date": 1482412482, "last_edit_date": 1482431227, "question_id": 41284057, "link": "https://stackoverflow.com/questions/41284057/golang-enum-support-in-swagger-codegen", "title": "golang enum support in swagger codegen", "body": "<p>I am not able to generate the enum with swagger codegen for golang. What modification needs to be done in go model.mustache and GoClientCodegen.java ? </p>\n\n<p>I tried this in mustache  : </p>\n\n<pre><code>{{&gt;partial_header}}\npackage {{packageName}}\n{{#models}}{{#imports}}\nimport ({{/imports}}{{#imports}}\n\"{{import}}\"{{/imports}}{{#imports}}\n)\n{{/imports}}{{#model}}{{#description}}\n// {{{description}}}{{/description}}\ntype {{classname}} struct {\n{{#vars}}{{#description}}\n// {{{description}}}{{/description}}\n{{name}} {{{datatype}}} `json:\"{{baseName}},omitempty\"`\n{{/vars}}\n}\n{{#enum}}\ntype enum string\nconst (\n\"COMPLETE\"\n\"INCOMPLETE\"\n)\n{{/enum}}\n{{/model}}{{/models}}\n</code></pre>\n\n<p>GoClientCodegen.java is same. What needs to be modified in the java file and the mustache file ?</p>\n"}, {"tags": ["go", "atom-editor"], "answers": [{"comments": [{"owner": {"reputation": 18185, "user_id": 165071, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EWdkL.jpg?s=128&g=1", "display_name": "Alexander Farber", "link": "https://stackoverflow.com/users/165071/alexander-farber"}, "edited": false, "score": 1, "creation_date": 1545901903, "post_id": 41282389, "comment_id": 94723761, "body": "atom-runner: CTRL-R on Mac"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1482408639, "last_edit_date": 1482408639, "creation_date": 1482406931, "answer_id": 41282389, "question_id": 41281772, "link": "https://stackoverflow.com/questions/41281772/how-can-i-run-my-golang-main-package-under-atom-io/41282389#41282389", "title": "How can I run my golang main package under atom.io?", "body": "<p>With additional plugins:</p>\n\n<h3>atom-runner: <a href=\"https://atom.io/packages/atom-runner\" rel=\"noreferrer\">https://atom.io/packages/atom-runner</a></h3>\n\n<p>Once you install it, just hit <kbd>ALT+R</kbd> to run the file. Note that this may collide with the go-plus plugin's Rename functionality. You may change any of the key bindings in Atom's settings (change one of them to be unique to your liking). If you don't want to change keybindings, you may use Atom's Command Palette: press <kbd>CTRL+SHIFT+P</kbd>, then type \"run\" or \"run file\", and it will be the first or second item.</p>\n\n<h3>plattformio-ide-terminal: <a href=\"https://atom.io/packages/platformio-ide-terminal\" rel=\"noreferrer\">https://atom.io/packages/platformio-ide-terminal</a></h3>\n\n<p>Installing this gives you an internal terminal. Click the plus icon at the bottom, which opens a terminal. You can configure it to open a terminal having the working directly of the current file, so after that all you need is to type <code>go run xx.go</code>. You may also \"fast-open\" the terminal by pressing <kbd>ALT+SHIFT+T</kbd>.</p>\n\n<p>Note: platformio-ide-terminal is a fork of terminal-plus, one which did not work for me (and reportedly for others).</p>\n"}], "owner": {"reputation": 725, "user_id": 156459, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e944b56331602c572d23b47243dca582?s=128&d=identicon&r=PG", "display_name": "thamurath", "link": "https://stackoverflow.com/users/156459/thamurath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6651, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1547141529, "creation_date": 1482404980, "last_edit_date": 1547141529, "question_id": 41281772, "link": "https://stackoverflow.com/questions/41281772/how-can-i-run-my-golang-main-package-under-atom-io", "title": "How can I run my golang main package under atom.io?", "body": "<p>I use atom.io with go-plus package to develop golang. \nI usually run main package with \"Golang: run Package\" command, but it has disappeared recently, and I do not know if there is another way to do it apart from that ... </p>\n\n<p>Any help will be nice.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "edited": false, "score": 0, "creation_date": 1482397870, "post_id": 41279297, "comment_id": 69760449, "body": "Please share some code."}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "reply_to_user": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "edited": false, "score": 0, "creation_date": 1482398313, "post_id": 41279297, "comment_id": 69760710, "body": "added the code."}], "answers": [{"tags": [], "owner": {"reputation": 410, "user_id": 3338740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHA9F.jpg?s=128&g=1", "display_name": "ellimist", "link": "https://stackoverflow.com/users/3338740/ellimist"}, "is_accepted": false, "score": 14, "last_activity_date": 1482398483, "creation_date": 1482398483, "answer_id": 41279639, "question_id": 41279297, "link": "https://stackoverflow.com/questions/41279297/how-to-get-all-query-parameters-from-go-gin-context-object/41279639#41279639", "title": "How to get all query parameters from go *gin.context object", "body": "<p>If you're talking about GET query params, you can retrieve them using:</p>\n\n<pre><code>c.Request.URL.Query()\n</code></pre>\n\n<p>You'll get back a Values type which is a <code>map[string][]string</code></p>\n\n<p>Docs: <a href=\"https://golang.org/pkg/net/url/#URL.Query\" rel=\"noreferrer\">https://golang.org/pkg/net/url/#URL.Query</a></p>\n"}, {"comments": [{"owner": {"reputation": 146, "user_id": 7602866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sM8GA.jpg?s=128&g=1", "display_name": "R wang", "link": "https://stackoverflow.com/users/7602866/r-wang"}, "edited": false, "score": 1, "creation_date": 1559873177, "post_id": 41279660, "comment_id": 99563948, "body": "why choose map[string][]string instead of map[string]string?"}, {"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 146, "user_id": 7602866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sM8GA.jpg?s=128&g=1", "display_name": "R wang", "link": "https://stackoverflow.com/users/7602866/r-wang"}, "edited": false, "score": 4, "creation_date": 1559945418, "post_id": 41279660, "comment_id": 99592509, "body": "In a query string, a param name can be used more than once, using []string for the value of the map allows them to capture all of different values that share the same param name. <a href=\"https://play.golang.org/p/FtQIz_ePF_N\" rel=\"nofollow noreferrer\">play.golang.org/p/FtQIz_ePF_N</a>"}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 38, "last_activity_date": 1482398539, "creation_date": 1482398539, "answer_id": 41279660, "question_id": 41279297, "link": "https://stackoverflow.com/questions/41279297/how-to-get-all-query-parameters-from-go-gin-context-object/41279660#41279660", "title": "How to get all query parameters from go *gin.context object", "body": "<p>You should be able to do <code>c.Request.URL.Query()</code> which will return a <a href=\"https://golang.org/pkg/net/url/#URL.Query\" rel=\"noreferrer\">Values</a> which is a <code>map[string][]string</code></p>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32206, "favorite_count": 5, "accepted_answer_id": 41279660, "answer_count": 2, "score": 22, "last_activity_date": 1491142388, "creation_date": 1482397372, "last_edit_date": 1491142388, "question_id": 41279297, "link": "https://stackoverflow.com/questions/41279297/how-to-get-all-query-parameters-from-go-gin-context-object", "title": "How to get all query parameters from go *gin.context object", "body": "<p>I am looking at <code>https://godoc.org/github.com/gin-gonic/gin</code> documentation for a method which returns list of all the query parameters passed. There are methods which return value of a query parameter. Is there any method which returns list of all the query parameters passed ? It's ok if we don't get values. I am fetching the values of the query parameter using the following code. But this code can only check if the query parameter exists or not.</p>\n\n<pre><code>func myHandler(c *gin.Context) {\n\n    // check for query params\n    if queryParam, ok := c.GetQuery(\"startingIndex\"); ok {\n        if queryParam == \"\" {\n            c.Header(\"Content-Type\", \"application/json\")\n            c.JSON(http.StatusNotFound,\n                gin.H{\"Error: \": \"Invalid startingIndex on search filter!\"})\n            c.Abort()\n            return\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["windows", "go", "mapping", "drive"], "comments": [{"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1482395331, "post_id": 41277465, "comment_id": 69758974, "body": "@Nadh: the question asked was how to map a network drive, not how to list (network) drives."}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1482396792, "post_id": 41277465, "comment_id": 69759771, "body": "Ah yes, my bad. Removed the flag."}], "answers": [{"tags": [], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "is_accepted": true, "score": 0, "last_activity_date": 1497948875, "creation_date": 1497948875, "answer_id": 44648319, "question_id": 41277465, "link": "https://stackoverflow.com/questions/41277465/what-is-the-best-way-to-map-windows-drives-using-golang/44648319#44648319", "title": "What is the best way to map windows drives using golang?", "body": "<p>As of now there is no direct way to do that in Go; I would recommend using <code>net use</code>, which of course limits the functionality to Windows, but that's actually what you need.</p>\n\n<p>So, when you open a command prompt in Windows you can map network shares to Windows drives by using:</p>\n\n<p><code>net use Q: \\\\SERVER\\SHARE /user:Alice pa$$word /P</code></p>\n\n<p><code>Q:</code> represents your windows drive, <code>\\\\SERVER\\SHARE</code> is the network address, <code>/user:Alice pa$$word</code> are your credentials, and <code>/P</code> is for persistence.</p>\n\n<p>Executing this in Go would look something like:</p>\n\n<pre><code>func mapDrive(letter string, address string, user string, pw string) ([]byte, error) {\n  // return combined output for std and err\n  return exec.Command(\"net use\", letter, address, fmt.Sprintf(\"/user:%s\", user), pw, \"/P\").CombinedOutput()\n}\n\nfunc main() {\n  out, err := mapDrive(\"Q:\", `\\\\SERVER\\SHARE`, \"Alice\", \"pa$$word\")\n  if err != nil {\n    log.Fatal(err)\n  }\n  // print whatever comes out\n  log.Println(string(out))\n}\n</code></pre>\n"}], "owner": {"reputation": 714, "user_id": 2664205, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07d12439f8e9f596e223be6fd6ea11b0?s=128&d=identicon&r=PG", "display_name": "witek", "link": "https://stackoverflow.com/users/2664205/witek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1781, "favorite_count": 0, "accepted_answer_id": 44648319, "answer_count": 1, "score": 3, "last_activity_date": 1515021555, "creation_date": 1482390107, "last_edit_date": 1495542824, "question_id": 41277465, "link": "https://stackoverflow.com/questions/41277465/what-is-the-best-way-to-map-windows-drives-using-golang", "title": "What is the best way to map windows drives using golang?", "body": "<p>What is the best way to map a network share to a windows drive using go-lang? This share also requires a username and password.\nA similar question was asked for python <a href=\"https://stackoverflow.com/questions/1271317\">What is the best way to map windows drives using Python?</a></p>\n"}, {"tags": ["go", "atomic"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1482390268, "post_id": 41277379, "comment_id": 69756409, "body": "yes those types are protected for both read and write"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 2828102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8d340520171240f5e3bac58e95bdb6e1?s=128&d=identicon&r=PG&f=1", "display_name": "user2828102", "link": "https://stackoverflow.com/users/2828102/user2828102"}, "edited": false, "score": 0, "creation_date": 1482478434, "post_id": 41286373, "comment_id": 69796604, "body": "So, the answer to the first question is I must use atomic.LoadInt even if there&#39;s only one thread write to the variable using atomic.StoreInt? regarding the second question,  the first line reads <code>procCound</code> directly, so the problem is the value it reads may be a middle status of being modifying, the value at that time may be nonsense?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 83, "user_id": 2828102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8d340520171240f5e3bac58e95bdb6e1?s=128&d=identicon&r=PG&f=1", "display_name": "user2828102", "link": "https://stackoverflow.com/users/2828102/user2828102"}, "edited": false, "score": 0, "creation_date": 1482509519, "post_id": 41286373, "comment_id": 69811651, "body": "If there are concurrent reads and writes <i>of any kind</i>, you need to serialize access with a mutex or atomic operations. The second question is just a restatement of the first, it is unsafe to read <code>procCount</code> if it&#39;s being modified so the result may be meaningless."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1482419947, "creation_date": 1482419947, "answer_id": 41286373, "question_id": 41277379, "link": "https://stackoverflow.com/questions/41277379/golang-when-theres-only-one-writer-change-the-value-using-atomic-storeint32-i/41286373#41286373", "title": "Golang: when there&#39;s only one writer change the value using atomic.StoreInt32, is it necessary to use atomic.LoadInt32 in the multiple readers?", "body": "<p>Yes, you need to use atomic operations when you are both loading and storing the same value. The race detector should warn you about this.</p>\n\n<p>As for the second question, if the <code>procCount</code> value is also being used concurrently, then you still need to load it using an atomic operation. These two are <em>not</em> equivalent:</p>\n\n<pre><code>atomic.StoreUint64(&amp;procRate, procCount)\natomic.StoreUint64(&amp;procRate, atomic.LoadUint64(&amp;procCount))\n</code></pre>\n\n<p>The former reads <code>procCount</code> directly to pass to <code>StoreUint64</code>, while the latter passes a copy safely obtained via <code>LoadUint64</code>.</p>\n"}], "owner": {"reputation": 83, "user_id": 2828102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8d340520171240f5e3bac58e95bdb6e1?s=128&d=identicon&r=PG&f=1", "display_name": "user2828102", "link": "https://stackoverflow.com/users/2828102/user2828102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 41286373, "answer_count": 1, "score": 0, "last_activity_date": 1482419947, "creation_date": 1482389744, "last_edit_date": 1482390082, "question_id": 41277379, "link": "https://stackoverflow.com/questions/41277379/golang-when-theres-only-one-writer-change-the-value-using-atomic-storeint32-i", "title": "Golang: when there&#39;s only one writer change the value using atomic.StoreInt32, is it necessary to use atomic.LoadInt32 in the multiple readers?", "body": "<p>As the title says. \nbasically what I'm wondering is that will the atomic.StoreInt32 also lock read operation while it's writing? </p>\n\n<p>Another relative question:, is <code>atomic.StoreUint64(&amp;procRate, procCount)</code> equivalent to <code>atomic.StoreUint64(&amp;procRate, atomic.LoadUint64(&amp;procCount))</code>? </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go", "enums"], "answers": [{"tags": [], "owner": {"reputation": 4222, "user_id": 2072269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xNPjb.png?s=128&g=1", "display_name": "muru", "link": "https://stackoverflow.com/users/2072269/muru"}, "is_accepted": true, "score": 1, "last_activity_date": 1482389034, "creation_date": 1482389034, "answer_id": 41277204, "question_id": 41276859, "link": "https://stackoverflow.com/questions/41276859/data-structure-that-only-allows-one-of-a-set-golang/41277204#41277204", "title": "Data structure that only allows one of a set? Golang", "body": "<p>You could hide away the member field using a different package. This limits ways of creating the structure to functions from that package, and you can then control those functions to accept a limited set of inputs.</p>\n\n<p><code>foo/foo.go</code>:</p>\n\n<pre><code>package foo\n\nimport \"fmt\"\n\ntype entity int\n\nconst (\n    one entity = iota + 1\n    two\n)\n\ntype Foo struct {\n    e entity\n}\n\nfunc (f Foo) Get() int {\n    return int(f.e)\n}\n\nfunc NewFoo(i int) Foo {\n    switch i {\n    case 1:\n        return Foo{one}\n    case 2:\n        return Foo{two}\n    default:\n        panic(fmt.Errorf(\"%s\", \"foo\"))\n    }\n}\n</code></pre>\n\n<p><code>bar.go</code>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"./foo\"\n\nfunc main() {\n    f := foo.NewFoo(2)\n    fmt.Println(f.Get())\n    e := foo.Foo{3}  // Error: implicit assignment of unexported field 'e' in foo.Foo literal\n    fmt.Println(e.Get())\n    d := foo.NewFoo(3) // panic: foo!\n    fmt.Println(d.Get())\n}\n</code></pre>\n\n<p>You cannot create a <code>Foo</code> struct outside of the <code>foo</code> package, and the only function that creates <code>Foo</code> structs in a <code>foo</code> package accepts only a limited set of values.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 0, "last_activity_date": 1482390724, "creation_date": 1482390724, "answer_id": 41277600, "question_id": 41276859, "link": "https://stackoverflow.com/questions/41276859/data-structure-that-only-allows-one-of-a-set-golang/41277600#41277600", "title": "Data structure that only allows one of a set? Golang", "body": "<p>I'm not sure this makes much sense since your <code>day_number</code> field is already inaccessible outside your package.</p>\n\n<p>Still, if this is really necessary, you'd set the private field via a method that validates the input such as the <code>SetDay</code> method below:</p>\n\n<pre><code>func (d Day) String() string {\n    if v, ok := map[Day]string{\n        Monday:    \"Monday\",\n        Tuesday:   \"Tuesday\",\n        Wednesday: \"Wednesday\",\n        Thursday:  \"Thursday\",\n        Friday:    \"Friday\",\n        Saturday:  \"Saturday\",\n        Sunday:    \"Sunday\",\n    }[d]; ok {\n        return v\n    }\n    return \"Bad day\"\n}\n\nfunc (e *Event) SetDay(d Day) error {\n    if v := d.String(); v == \"Bad day\" {\n        return fmt.Errorf(v)\n    }\n    e.day_number = d\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/R0PtH74i4v\" rel=\"nofollow noreferrer\">Playground link</a></p>\n"}], "owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1343, "favorite_count": 0, "closed_date": 1482390182, "accepted_answer_id": 41277204, "answer_count": 2, "score": 0, "last_activity_date": 1482390724, "creation_date": 1482387502, "last_edit_date": 1482387593, "question_id": 41276859, "link": "https://stackoverflow.com/questions/41276859/data-structure-that-only-allows-one-of-a-set-golang", "closed_reason": "Duplicate", "title": "Data structure that only allows one of a set? Golang", "body": "<p>What's a data structure that only allows one of a possible set of options? </p>\n\n<p>I tried playing around with <code>enum</code>s but they are not what I want. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Event struct {\n        day_number Day \n}\n\ntype Day int \n\nconst (\n        Monday Day = iota\n        Tuesday\n        Wednesday\n        Thursday\n        Friday\n        Saturday\n        Sunday\n)\n\nfunc main() {\n        var r Event\n        r.day_number = Monday\n        fmt.Println(r.day_number)\n        // Keep this from happening.\n        var impossible Event\n        impossible.day_number = 12\n        fmt.Println(impossible.day_number)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482421818, "post_id": 41275410, "comment_id": 69775896, "body": "<a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow noreferrer\">golang.org/doc/faq#closures_and_goroutines</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1482377923, "creation_date": 1482377923, "answer_id": 41275424, "question_id": 41275410, "link": "https://stackoverflow.com/questions/41275410/golang-closure-catch-wrong-value-from-range/41275424#41275424", "title": "golang closure catch wrong value from range", "body": "<p>just write the function like this, to catch the verb <code>l</code> into function</p>\n\n<pre><code> go func(l string) {\n     fmt.Println(l)\n }(l)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7328466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6dcfaf2bab3ca0f5ab11d508547138?s=128&d=identicon&r=PG&f=1", "display_name": "wgwigw", "link": "https://stackoverflow.com/users/7328466/wgwigw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 41275424, "answer_count": 1, "score": 0, "last_activity_date": 1482377923, "creation_date": 1482377830, "question_id": 41275410, "link": "https://stackoverflow.com/questions/41275410/golang-closure-catch-wrong-value-from-range", "title": "golang closure catch wrong value from range", "body": "<p>test codes below:</p>\n\n<pre><code>func main() {\n    lans := [5]string{\"java\", \"python\", \"erlang\", \"cpp\", \"go\"}\n    fin := make(chan bool)\n    for _, l := range(lans) {\n        go func() {\n            fmt.Println(l)\n            }()\n    }\n     &lt;- fin\n}\n</code></pre>\n\n<p>I think the output will be: java, python, erlang, cpp, go;\nbut the output is:\ngo  go  go  go  go;\nwhat's wrong here?</p>\n"}]