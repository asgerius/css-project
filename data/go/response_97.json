[{"tags": ["http", "go", "multipartform-data"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1479340542, "post_id": 40644415, "comment_id": 68520856, "body": "Can you be more specific than &quot;data gets invalidated&quot;?   What error are you seeing?  Subsequent calls return <code>&quot;&quot;</code> or some sort of panic... or?"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1479340678, "post_id": 40644415, "comment_id": 68520904, "body": "From the docs:  &quot;FormValue calls ParseMultipartForm and ParseForm if necessary&quot;... and &quot;After one call to ParseMultipartForm, subsequent calls have no effect.&quot;.  <code>FormValue()</code> may be intrinsically non-repeatable (which would sound like a bug to me!).    Is there a simple example to test?"}, {"owner": {"reputation": 4786, "user_id": 1012149, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/754c40373db2331c02a81ef7654ca0c7?s=128&d=identicon&r=PG", "display_name": "Jana", "link": "https://stackoverflow.com/users/1012149/jana"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1479343645, "post_id": 40644415, "comment_id": 68521751, "body": "the content is nil."}], "answers": [{"comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1479389044, "post_id": 40645720, "comment_id": 68543108, "body": "Cool!   Should this maybe be a bug / rfe on <a href=\"https://github.com/golang/go/issues\" rel=\"nofollow noreferrer\">github.com/golang/go/issues</a>?  (It looks like the current behavior was the result of fixing a bug that was causing a /segfault/ in this use case!)"}, {"owner": {"reputation": 4786, "user_id": 1012149, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/754c40373db2331c02a81ef7654ca0c7?s=128&d=identicon&r=PG", "display_name": "Jana", "link": "https://stackoverflow.com/users/1012149/jana"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1479413368, "post_id": 40645720, "comment_id": 68559365, "body": "I agree this should be a bug, I think it is very intuitive to expect the request body to be nil after calling <code>FormValue</code> function."}], "tags": [], "owner": {"reputation": 4786, "user_id": 1012149, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/754c40373db2331c02a81ef7654ca0c7?s=128&d=identicon&r=PG", "display_name": "Jana", "link": "https://stackoverflow.com/users/1012149/jana"}, "is_accepted": false, "score": 4, "last_activity_date": 1479408357, "last_edit_date": 1479408357, "creation_date": 1479349566, "answer_id": 40645720, "question_id": 40644415, "link": "https://stackoverflow.com/questions/40644415/how-to-combine-regular-formvalue-with-multipart-form-data-in-golang-net-http-req/40645720#40645720", "title": "how to combine regular FormValue with multipart form data in Golang net/http Request", "body": "<p>I wrote a utility function that solved my problem:</p>\n\n<pre><code>package utils\n\nimport (\n    \"bytes\"\n    \"io\"\n    \"io/ioutil\"\n    \"mime\"\n    \"mime/multipart\"\n    \"net/http\"\n    \"strings\"\n)\n\n// Get form values without invalidating the request body in case the data is multiform\nfunc GetFormValues(request *http.Request, keys []string) []string {\n    var values []string\n    mediaType, params, err := mime.ParseMediaType(request.Header.Get(\"Content-Type\"))\n    if err != nil || !strings.HasPrefix(mediaType, \"multipart/\") {\n        for i := range keys {\n            values = append(values, request.FormValue(keys[i]))\n        }\n    } else { // multi form\n        buf, _ := ioutil.ReadAll(request.Body)\n        origBody := ioutil.NopCloser(bytes.NewBuffer(buf))\n        var rdr = multipart.NewReader(bytes.NewBuffer(buf), params[\"boundary\"])\n        for len(values) &lt; len(keys) {\n            part, err_part := rdr.NextPart()\n            if err_part == io.EOF {\n                break\n            }\n            for i := range keys {\n                if part.FormName() == keys[i] {\n                    buf := new(bytes.Buffer)\n                    buf.ReadFrom(part)\n                    values = append(values, buf.String())\n                }\n            }\n        }\n        request.Body = origBody\n    }\n    if len(values) == len(keys) {\n        return values\n    } else {\n        return nil\n    }\n}\n\n// Get form value without invalidating the request body in case the data is multiform\nfunc GetFormValue(request *http.Request, key string) string {\n    if result := GetFormValues(request, []string{key}); len(result) == 1 {\n        return result[0]\n    } else {\n        return \"\"\n    }\n}\n</code></pre>\n\n<p>Now instead of calling </p>\n\n<pre><code>value := request.FormValue(key)\n</code></pre>\n\n<p>I do</p>\n\n<pre><code>value := utils.GetFormValue(request, key)\n</code></pre>\n\n<p>or for multiple values</p>\n\n<pre><code>values := utils.GetFormValues(request, []string{keys...})\n</code></pre>\n"}], "owner": {"reputation": 4786, "user_id": 1012149, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/754c40373db2331c02a81ef7654ca0c7?s=128&d=identicon&r=PG", "display_name": "Jana", "link": "https://stackoverflow.com/users/1012149/jana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1303, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1479408357, "creation_date": 1479340336, "question_id": 40644415, "link": "https://stackoverflow.com/questions/40644415/how-to-combine-regular-formvalue-with-multipart-form-data-in-golang-net-http-req", "title": "how to combine regular FormValue with multipart form data in Golang net/http Request", "body": "<p>I want to call <code>FormValue</code> on <code>golang</code> <code>net/http</code> <code>Request</code> from several  middleware handler functions before serving the request. And I do not want to invalidate the request while doing this.</p>\n\n<p>It works fine except when the incoming request has a <code>multipart</code> <code>form-data</code>, the data gets invalidated after I call <code>FormValue</code> and there is nothing to parse in the final route.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1479340838, "post_id": 40644183, "comment_id": 68520946, "body": "Can you show your function prototype?   What type is <code>name</code>, in particular?"}, {"owner": {"reputation": 686, "user_id": 842108, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/6opW3.jpg?s=128&g=1", "display_name": "mahesmohan", "link": "https://stackoverflow.com/users/842108/mahesmohan"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1479354897, "post_id": 40644183, "comment_id": 68524488, "body": "@BadZen I have updated the question with the function prototype."}], "owner": {"reputation": 686, "user_id": 842108, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/6opW3.jpg?s=128&g=1", "display_name": "mahesmohan", "link": "https://stackoverflow.com/users/842108/mahesmohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479354862, "creation_date": 1479338962, "last_edit_date": 1479354862, "question_id": 40644183, "link": "https://stackoverflow.com/questions/40644183/mgo-regex-query-returns-empty-result", "title": "MGo Regex query returns empty result", "body": "<p>I have been using the following code to list users starting with a search keyword which is passed to the function as <code>name</code>. </p>\n\n<pre><code>func (this *user) GetUsersByEmailOrName(name *string) ([]types.User, error) {\nformattedName := \"/^\" + *name + \"/\"\n\nvar ors []bson.M\nuserNameOr := bson.M{\n    \"user_name\": bson.M{\n        \"$regex\": bson.RegEx{formattedName, \"i\"},\n    },\n}\nors = append(ors, userNameOr)\n\nnameOr := bson.M{\n    \"name\": bson.M{\n        \"$regex\": bson.RegEx{formattedName, \"i\"},\n    },\n}\nors = append(ors, nameOr)\n\nquery := bson.M{\n    \"$or\": ors,\n}\n\nfmt.Println(query)\ns := this.Database.Session.Copy()\ndefer s.Close()\n\nvar users []types.User\nerr := s.DB(\"\").C(this.Collection).Find(query).Sort(\"name\").All(&amp;users)\nif err != nil {\n    return nil, err\n}\nfmt.Println(users)\nreturn users, nil\n}\n</code></pre>\n\n<p>I am fairly new to GoLang and MGo. I am not sure what went wrong. Please point me to the right direction.</p>\n"}, {"tags": ["design-patterns", "go"], "comments": [{"owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "edited": false, "score": 1, "creation_date": 1479337222, "post_id": 40643671, "comment_id": 68519819, "body": "What is the goal of an action filter?  And either way, I&#39;d air on the side of no, Go favors simplicity and this strikes me as something that leads to more complexity."}, {"owner": {"reputation": 365, "user_id": 6463324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dKccE.png?s=128&g=1", "display_name": "olpo.graphy", "link": "https://stackoverflow.com/users/6463324/olpo-graphy"}, "reply_to_user": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "edited": false, "score": 0, "creation_date": 1479337701, "post_id": 40643671, "comment_id": 68520006, "body": "Action Filters are custom attributes that provide declarative means to add pre-action and post-action behavior to the controller&#39;s methods. Very good explanation (from point of ASP.NET MVC) is here: <a href=\"http://www.codeproject.com/Articles/577776/Filters-and-Attributes-in-ASPNET-MVC\" rel=\"nofollow noreferrer\">codeproject.com/Articles/577776/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 6463324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dKccE.png?s=128&g=1", "display_name": "olpo.graphy", "link": "https://stackoverflow.com/users/6463324/olpo-graphy"}, "is_accepted": false, "score": 0, "last_activity_date": 1479339177, "creation_date": 1479339177, "answer_id": 40644220, "question_id": 40643671, "link": "https://stackoverflow.com/questions/40643671/go-how-to-use-middleware-pattern/40644220#40644220", "title": "Go: How to use middleware pattern?", "body": "<p>Revel (web framework for the Go) provides similar functionality with<br>\n<b>Interceptors</b> (function that is invoked by the framework BEFORE or AFTER an action invocation).<br>\nConcept and implementation described here: <a href=\"https://revel.github.io/manual/interceptors.html\" rel=\"nofollow noreferrer\">https://revel.github.io/manual/interceptors.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "is_accepted": true, "score": 2, "last_activity_date": 1479369279, "creation_date": 1479369279, "answer_id": 40649419, "question_id": 40643671, "link": "https://stackoverflow.com/questions/40643671/go-how-to-use-middleware-pattern/40649419#40649419", "title": "Go: How to use middleware pattern?", "body": "<p>This sort of thing is typically done with <em>middleware</em> in Go. The easiest is to show by example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.HandleFunc(\"/foo\", middleware(handler))\n\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello, %q\", html.EscapeString(r.URL.Path))\n}\n\nfunc middleware(next http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        r.URL.Path = \"/MODIFIED\"\n\n        // Run the next handler\n        next.ServeHTTP(w, r)\n    }\n}\n</code></pre>\n\n<p>As you can see, a middleware is a function that:</p>\n\n<ol>\n<li>accepts a <code>http.HandlerFunc</code> as an argument;</li>\n<li>returns a <code>http.HandlerFunc</code>;</li>\n<li>calls the <code>http.handlerFunc</code> passed in.</li>\n</ol>\n\n<p>With this basic technique you can \"chain\" as many middlewares as you like:</p>\n\n<pre><code>http.HandleFunc(\"/foo\", another(middleware(handler)))\n</code></pre>\n\n<hr>\n\n<p>There are some variants to this pattern, and most Go frameworks use a slightly different syntax, but the concept is typically the same.</p>\n"}], "owner": {"reputation": 365, "user_id": 6463324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dKccE.png?s=128&g=1", "display_name": "olpo.graphy", "link": "https://stackoverflow.com/users/6463324/olpo-graphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 40649419, "answer_count": 2, "score": -1, "last_activity_date": 1539545170, "creation_date": 1479336158, "last_edit_date": 1539545170, "question_id": 40643671, "link": "https://stackoverflow.com/questions/40643671/go-how-to-use-middleware-pattern", "title": "Go: How to use middleware pattern?", "body": "<p>I have a function that executes only with specific conditions (e.g. <i>role == 'Administrator'</i>). Now, I use <i>'if'</i> statement. But it could be situations when number of conditions is high and <i>'if'</i> with long definition looks not so esthetic.<br>\nIs it available mechanism in Go (or related with Go framework) allows implementation of middleware <b>concept</b> (action filters)?<br><br>\n<i>For example, ASP.NET MVC allows to do this:</i></p>\n\n<pre><code>[MyFilter]\npublic ViewResult Index()\n{\n     // Filter will be applied to this specific action method\n}\n</code></pre>\n\n<p><i>So, MyFilter() implemented in the separate class allows better code composition and testing.</i><br></p>\n\n<p><b>Update:</b>\nRevel (web framework for the Go) provides similar functionality with\nInterceptors (function that is invoked by the framework BEFORE or AFTER an action invocation): <a href=\"https://revel.github.io/manual/interceptors.html\" rel=\"nofollow noreferrer\">https://revel.github.io/manual/interceptors.html</a></p>\n"}, {"tags": ["http", "go", "race-condition"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1479337562, "post_id": 40643379, "comment_id": 68519951, "body": "How about passing something other than the original <code>ResponseWriter</code> to <code>nextHandler()</code>? You would then have to copy the results back to the original <code>ResponseWriter</code> in the <code>&lt;-errCh</code> case."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479400229, "post_id": 40643379, "comment_id": 68551497, "body": "Whatever is going to write to the ResponseWriter needs to also be responsible for the timeout. You&#39;re providing a timeout context to the nextHandler, so that should be able to handle the timeout itself. In general it&#39;s easier if only one handler is responsible for writing the response."}], "answers": [{"tags": [], "owner": {"reputation": 764, "user_id": 1398066, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213b36a51eaf5c87bf8a7db78176770b?s=128&d=identicon&r=PG", "display_name": "P&#233;ter Szakszon", "link": "https://stackoverflow.com/users/1398066/p%c3%a9ter-szakszon"}, "is_accepted": false, "score": 0, "last_activity_date": 1479411353, "creation_date": 1479411353, "answer_id": 40663575, "question_id": 40643379, "link": "https://stackoverflow.com/questions/40643379/go-race-condition-in-timeout-handler/40663575#40663575", "title": "Go race condition in timeout handler", "body": "<p>Here is a possible solution, which is based on @Andy's comment.</p>\n\n<p>A new <code>responseRecorder</code> will be passed to the <code>nextHandler</code>, and the recorded response will be copied back to the client:</p>\n\n<pre><code>func timeoutHandler(w http.ResponseWriter, r *http.Request) error {\n    const seconds = 1\n    ctx, cancel := context.WithTimeout(r.Context(),\n        time.Duration(seconds)*time.Second)\n    defer cancel()\n\n    r = r.WithContext(ctx)\n\n    errCh := make(chan error, 1)\n    w2 := newResponseRecorder()\n    go func() {\n        errCh &lt;- nextHandler(w2, r)\n    }()\n\n    select {\n    case err := &lt;-errCh:\n        if err != nil {\n            return err\n        }\n\n        w2.cloneHeader(w.Header())\n        w.WriteHeader(w2.status)\n        w.Write(w2.buf.Bytes())\n        return nil\n    case &lt;-ctx.Done():\n        http.Error(w, \"Request timeout\", 408)\n        return nil\n    }\n}\n</code></pre>\n\n<p>And here is the <code>responseRecorder</code>:</p>\n\n<pre><code>type responseRecorder struct {\n    http.ResponseWriter\n    header http.Header\n    buf    *bytes.Buffer\n    status int\n}\n\nfunc newResponseRecorder() *responseRecorder {\n    return &amp;responseRecorder{\n        header: http.Header{},\n        buf:    &amp;bytes.Buffer{},\n    }\n}\n\nfunc (w *responseRecorder) Header() http.Header {\n    return w.header\n}\n\nfunc (w *responseRecorder) cloneHeader(dst http.Header) {\n    for k, v := range w.header {\n        tmp := make([]string, len(v))\n        copy(tmp, v)\n        dst[k] = tmp\n    }\n}\n\nfunc (w *responseRecorder) Write(data []byte) (int, error) {\n    if w.status == 0 {\n        w.WriteHeader(http.StatusOK)\n    }\n    return w.buf.Write(data)\n}\n\nfunc (w *responseRecorder) WriteHeader(status int) {\n    w.status = status\n}\n</code></pre>\n"}], "owner": {"reputation": 764, "user_id": 1398066, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213b36a51eaf5c87bf8a7db78176770b?s=128&d=identicon&r=PG", "display_name": "P&#233;ter Szakszon", "link": "https://stackoverflow.com/users/1398066/p%c3%a9ter-szakszon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479411353, "creation_date": 1479334716, "last_edit_date": 1479335708, "question_id": 40643379, "link": "https://stackoverflow.com/questions/40643379/go-race-condition-in-timeout-handler", "title": "Go race condition in timeout handler", "body": "<p>I can see two main issues in the example code below, but I don't know how to solve them correctly.</p>\n\n<p>If the timeout handler does not get the signal through the errCh that the next handler has completed or an error occured, it will reply \"408 Request timeout\" to the request.</p>\n\n<p>The problem here is that the ResponseWriter is not safe to be used by multiple goroutines. And the timeout handler starts a new goroutine when executing the next handler.</p>\n\n<p>Issues:</p>\n\n<ol>\n<li><p>How to prevent the next handler from writing into the ResponseWriter when the ctx's Done channel times out in the timeout handler.</p></li>\n<li><p>How to prevent the timeout handler from replying 408 status code when the next handler is writing into the ResponseWriter but it has not finished yet and the ctx's Done channel times out in the timeout handler.</p></li>\n</ol>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n  \"context\"\n  \"fmt\"\n  \"net/http\"\n  \"time\"\n)\n\nfunc main() {\n  http.Handle(\"/race\", handlerFunc(timeoutHandler))\n  http.ListenAndServe(\":8080\", nil)\n}\n\nfunc timeoutHandler(w http.ResponseWriter, r *http.Request) error {\n  const seconds = 1\n  ctx, cancel := context.WithTimeout(r.Context(), time.Duration(seconds)*time.Second)\n  defer cancel()\n\n  r = r.WithContext(ctx)\n\n  errCh := make(chan error, 1)\n  go func() {\n    // w is not safe for concurrent use by multiple goroutines\n    errCh &lt;- nextHandler(w, r)\n  }()\n\n  select {\n  case err := &lt;-errCh:\n    return err\n  case &lt;-ctx.Done():\n    // w is not safe for concurrent use by multiple goroutines\n    http.Error(w, \"Request timeout\", 408)\n    return nil\n  }\n}\n\nfunc nextHandler(w http.ResponseWriter, r *http.Request) error {\n  // just for fun to simulate a better race condition\n  const seconds = 1\n  time.Sleep(time.Duration(seconds) * time.Second)\n  fmt.Fprint(w, \"nextHandler\")\n  return nil\n}\n\ntype handlerFunc func(w http.ResponseWriter, r *http.Request) error\n\nfunc (fn handlerFunc) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n  if err := fn(w, r); err != nil {\n    http.Error(w, \"Server error\", 500)\n  }\n}\n</code></pre>\n"}, {"tags": ["string", "url", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1479333240, "post_id": 40643030, "comment_id": 68518118, "body": "The <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\"><code>net&#47;http</code> package documentation</a> has a good overview, and examples. What there don&#39;t you understand?"}, {"owner": {"reputation": 47, "user_id": 4565160, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f9224ae8929237a88dd1d78e888036fa?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Benson", "link": "https://stackoverflow.com/users/4565160/bob-benson"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479333405, "post_id": 40643030, "comment_id": 68518190, "body": "I am just not sure how to &quot;turn&quot; it into a string."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1479333644, "post_id": 40643030, "comment_id": 68518307, "body": "Your function prototype takes <code>result</code> as an argument, yet your description of the desired behavior seems to indicate it is a return value...   Which is it?   (Do you mean <code>func OnPage(link string) string</code>, perhaps?)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479333692, "post_id": 40643030, "comment_id": 68518327, "body": "You can convert a <code>[]byte</code> directly to a <code>string</code> as needed"}, {"owner": {"reputation": 47, "user_id": 4565160, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f9224ae8929237a88dd1d78e888036fa?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Benson", "link": "https://stackoverflow.com/users/4565160/bob-benson"}, "edited": false, "score": 0, "creation_date": 1479333913, "post_id": 40643030, "comment_id": 68518454, "body": "Sorry, did not notice that. Edited it out."}], "answers": [{"tags": [], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "is_accepted": false, "score": 6, "last_activity_date": 1479333832, "creation_date": 1479333832, "answer_id": 40643195, "question_id": 40643030, "link": "https://stackoverflow.com/questions/40643030/how-to-get-webpage-content-into-a-string-using-go/40643195#40643195", "title": "How to get webpage content into a string using Go", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\nfunc OnPage(link string)(string) {\n    res, err := http.Get(link)\n    if err != nil {\n        log.Fatal(err)\n    }\n    content, err := ioutil.ReadAll(res.Body)\n    res.Body.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n    return string(content)\n}\n\nfunc main() {\n    fmt.Println(OnPage(\"http://www.bbc.co.uk/news/uk-england-38003934\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4565160, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f9224ae8929237a88dd1d78e888036fa?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Benson", "link": "https://stackoverflow.com/users/4565160/bob-benson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1479333832, "creation_date": 1479333100, "last_edit_date": 1479333720, "question_id": 40643030, "link": "https://stackoverflow.com/questions/40643030/how-to-get-webpage-content-into-a-string-using-go", "title": "How to get webpage content into a string using Go", "body": "<p>I am trying to use Go and the http package to get the content of a webpage into a string, then be able to process the string. I am new to Go, so I am not entirely sure where to begin. Here is the function I am trying to make.</p>\n\n<pre><code>func OnPage(link string) {\n\n}\n</code></pre>\n\n<p>I am not sure how to write the function. Link is the url of the webpage to use, and result would be the string from the webpage. So for example, if I used reddit as the link, then the result would just be the string form of the content on reddit, and I could process that string in different ways. From what I have read, I want to use the http package, but as I stated before, I do not know where to begin. Any help would be appreciated.</p>\n"}, {"tags": ["go", "concurrency", "parallel-processing"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4963306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8035636c9e71e81e89b01e60d014f0?s=128&d=identicon&r=PG&f=1", "display_name": "mtonsmann", "link": "https://stackoverflow.com/users/4963306/mtonsmann"}, "edited": false, "score": 0, "creation_date": 1479335660, "post_id": 40642847, "comment_id": 68519219, "body": "So the problem was with modifying the job element instead of jobs[i] directly. Classic dumb mistake. Thank you!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 33, "user_id": 4963306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8035636c9e71e81e89b01e60d014f0?s=128&d=identicon&r=PG&f=1", "display_name": "mtonsmann", "link": "https://stackoverflow.com/users/4963306/mtonsmann"}, "edited": false, "score": 0, "creation_date": 1479335816, "post_id": 40642847, "comment_id": 68519285, "body": "@mtonsmann: note that using <code>[]*Job</code> would have worked too, and may even be preferable depending on what you&#39;re actual <code>Job</code> type is."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1479332394, "creation_date": 1479332394, "answer_id": 40642847, "question_id": 40642699, "link": "https://stackoverflow.com/questions/40642699/saving-results-from-a-parallelized-goroutine/40642847#40642847", "title": "Saving results from a parallelized goroutine", "body": "<p>As long as the <code>[]Job</code> slice is only modified by one goroutine at a time, there's no reason you can't modify the job in place.</p>\n\n<pre><code>for i, job := range jobs {\n    jobs[i].result = temp.Binomial(int64(job.a), int64(job.b))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/CcEGsa1fLh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CcEGsa1fLh</a></p>\n\n<p>You should also use a WaitGroup, rather than rely on counting tokens in a channel yourself.</p>\n"}], "owner": {"reputation": 33, "user_id": 4963306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8035636c9e71e81e89b01e60d014f0?s=128&d=identicon&r=PG&f=1", "display_name": "mtonsmann", "link": "https://stackoverflow.com/users/4963306/mtonsmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 40642847, "answer_count": 1, "score": 0, "last_activity_date": 1479332394, "creation_date": 1479331825, "question_id": 40642699, "link": "https://stackoverflow.com/questions/40642699/saving-results-from-a-parallelized-goroutine", "title": "Saving results from a parallelized goroutine", "body": "<p>I am trying to parallelize an operation in golang and save the results in a manner that I can iterate over to sum up afterwords. </p>\n\n<p>I have managed to set up the parameters so that no deadlock occurs, and I have confirmed that the operations are working and being saved correctly within the function. When I iterate over the Slice of my struct and try and sum up the results of the operation, they all remain 0. I have tried passing by reference, with pointers, and with channels (causes deadlock). </p>\n\n<p>I have only found this example for help: <a href=\"https://golang.org/doc/effective_go.html#parallel\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#parallel</a>. But this seems outdated now, as Vector as been deprecated? I also have not found any references to the way this function (in the example) was constructed (with the func (u Vector) before the name). I tried replacing this with a Slice but got compile time errors.</p>\n\n<p>Any help would be very appreciated. Here is the key parts of my code:</p>\n\n<pre><code>type job struct {\n  a int\n  b int\n  result *big.Int\n}\n\nfunc choose(jobs []Job, c chan int) {\n  temp := new(big.Int)\n  for _,job := range jobs {\n    job.result = //perform operation on job.a and job.b\n    //fmt.Println(job.result)\n  }\n  c &lt;- 1\n}\n\nfunc main() {\n  num := 100 //can be very large (why we need big.Int)\n  n := num\n  k := 0\n  const numCPU = 6 //runtime.NumCPU\n  count := new(big.Int)\n\n  // create a 2d slice of jobs, one for each core\n  jobs := make([][]Job, numCPU)\n\n\n  for (float64(k) &lt;= math.Ceil(float64(num / 2))) {\n    // add one job to each core, alternating so that\n    // job set is similar in difficulty\n    for i := 0; i &lt; numCPU; i++ {\n      if !(float64(k) &lt;= math.Ceil(float64(num / 2))) {\n        break\n      }\n      jobs[i] = append(jobs[i], Job{n, k, new(big.Int)})\n      n -= 1\n      k += 1\n    }\n  }\n\n  c := make(chan int, numCPU)\n  for i := 0; i &lt; numCPU; i++ {\n    go choose(jobs[i], c)\n  }\n\n  // drain the channel\n  for i := 0; i &lt; numCPU; i++ {\n   &lt;-c\n   }\n  // computations are done\n\n for i := range jobs {\n    for _,job := range jobs[i] {\n      //fmt.Println(job.result)\n      count.Add(count, job.result)\n    }\n  }\n\n\n\n  fmt.Println(count)\n}\n</code></pre>\n\n<p>Here is the code running on the go playground <a href=\"https://play.golang.org/p/X5IYaG36U-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/X5IYaG36U-</a></p>\n"}, {"tags": ["go", "apache-kafka", "shopify"], "answers": [{"comments": [{"owner": {"reputation": 1320, "user_id": 357480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nSHyr.jpg?s=128&g=1", "display_name": "pbathala", "link": "https://stackoverflow.com/users/357480/pbathala"}, "edited": false, "score": 0, "creation_date": 1485470751, "post_id": 40723989, "comment_id": 70951066, "body": "This works. I figured there was a problem on my Kafka cluster side which caused not returning any data for this API call. Works now."}, {"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1485963255, "post_id": 40723989, "comment_id": 71144953, "body": "Does this return the offset of the last message produced for a partition, or the offset of the last message marked and committed by the consumer for a partition?"}, {"owner": {"reputation": 240, "user_id": 501267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037ab9993d1b047089da69b5c340f5d5?s=128&d=identicon&r=PG", "display_name": "Mike Chen", "link": "https://stackoverflow.com/users/501267/mike-chen"}, "reply_to_user": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 2, "creation_date": 1492471336, "post_id": 40723989, "comment_id": 73978127, "body": "@LorenzoBelli The code returns the latest offset produced for a partition, NOT offset committed by consumer"}, {"owner": {"reputation": 751, "user_id": 1238392, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d5793d326a8d9a4bc5070645e479a917?s=128&d=identicon&r=PG", "display_name": "Battleroid", "link": "https://stackoverflow.com/users/1238392/battleroid"}, "edited": false, "score": 2, "creation_date": 1515620235, "post_id": 40723989, "comment_id": 83373962, "body": "This doesn&#39;t actually answer the OP&#39;s question. This just gets the latest offset for the given partition of a topic."}], "tags": [], "owner": {"reputation": 133, "user_id": 5950149, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BSXiMQUmrrs/AAAAAAAAAAI/AAAAAAAADqk/zc3Ly-PCpx0/photo.jpg?sz=128", "display_name": "Sarwesh Suman", "link": "https://stackoverflow.com/users/5950149/sarwesh-suman"}, "is_accepted": true, "score": 0, "last_activity_date": 1479744287, "last_edit_date": 1479744287, "creation_date": 1479742992, "answer_id": 40723989, "question_id": 40642689, "link": "https://stackoverflow.com/questions/40642689/how-to-get-consumer-group-offsets-for-partition-in-golang-kafka-10/40723989#40723989", "title": "How to get consumer group offsets for partition in Golang Kafka 10", "body": "<p>I am also working with Sarama and Kafka to get offset of a topic.</p>\n\n<p>You can get offset with following code.</p>\n\n<pre><code>    package main\n\n    import (\n     \"gopkg.in/Shopify/sarama\"\n     \"fmt\"\n    )\n\n    func main(){\n      client , err := sarama.Client([]string{\"localhost:9092\"},nil) // I am not giving any configuration\n      if err != nil {\n          panic(err)\n      }\n      lastoffset, err := client.GetOffset(\"topic-test\",0,sarama.OffsetNewest)\n      if err != nil {\n          panic(err)\n      }\n      fmt.Println(\"Last Commited Offset \",lastoffset)\n    }\n</code></pre>\n\n<p>Let me know if this is the answer you are looking for and if it is helpful.</p>\n"}], "owner": {"reputation": 1320, "user_id": 357480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nSHyr.jpg?s=128&g=1", "display_name": "pbathala", "link": "https://stackoverflow.com/users/357480/pbathala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3948, "favorite_count": 2, "accepted_answer_id": 40723989, "answer_count": 1, "score": 3, "last_activity_date": 1479744287, "creation_date": 1479331786, "last_edit_date": 1479406660, "question_id": 40642689, "link": "https://stackoverflow.com/questions/40642689/how-to-get-consumer-group-offsets-for-partition-in-golang-kafka-10", "title": "How to get consumer group offsets for partition in Golang Kafka 10", "body": "<p>Now that Golang Kafka library (sarama) is providing consumer group capability without any external library help with kafka 10. How can I get the current message offset being processed by a consumer group at any given time ?</p>\n\n<p>Previously I used kazoo-go (<a href=\"https://github.com/wvanbergen/kazoo-go\" rel=\"nofollow noreferrer\">https://github.com/wvanbergen/kazoo-go</a>) to get my consumer group message offset as it is stored in Zookeeper. Now I use sarama-cluster (<a href=\"https://github.com/bsm/sarama-cluster\" rel=\"nofollow noreferrer\">https://github.com/bsm/sarama-cluster</a>), I am not sure which API to use to get my consumer group message offset.</p>\n"}, {"tags": ["go", "split"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1479330854, "post_id": 40642305, "comment_id": 68516923, "body": "unsigned values should be reserved for bitwise operations. There&#39;s no reason for <code>uint</code> here."}, {"owner": {"reputation": 14732, "user_id": 1026572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a74388494ea3475fe5a99a04d6120bcc?s=128&d=identicon&r=PG", "display_name": "dragonx", "link": "https://stackoverflow.com/users/1026572/dragonx"}, "edited": false, "score": 0, "creation_date": 1479429585, "post_id": 40642305, "comment_id": 68566142, "body": "That&#39;s an odd comment.  You can use bitwise ops for both int and uint (though I agree it&#39;s much less hassle with uint).  You can also count twice as high with a uint than an int, and that works here in situations where you never get negative word counts."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 14732, "user_id": 1026572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a74388494ea3475fe5a99a04d6120bcc?s=128&d=identicon&r=PG", "display_name": "dragonx", "link": "https://stackoverflow.com/users/1026572/dragonx"}, "edited": false, "score": 0, "creation_date": 1479483441, "post_id": 40642305, "comment_id": 68591709, "body": "@dragonx: it&#39;s generally accepted best practice to avoid unsigned values for any values used with arithmetic operations. You might not expect a negative count, but you&#39;re not going to easily catch that bug when it does happen with an unsigned value. You&#39;ll notice Go uses signed values for all counts and indexing operations. &quot;Count twice as high&quot; isn&#39;t really a good argument either, that&#39;s only 1 bit difference, and you&#39;ll have a very special case if you specifically need integer values between (2&lt;&lt;63, 2&lt;&lt;64) -- most likely you&#39;ll be looking for arbitrary precision integers at that point."}], "answers": [{"tags": [], "owner": {"reputation": 14732, "user_id": 1026572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a74388494ea3475fe5a99a04d6120bcc?s=128&d=identicon&r=PG", "display_name": "dragonx", "link": "https://stackoverflow.com/users/1026572/dragonx"}, "is_accepted": false, "score": 0, "last_activity_date": 1479330695, "creation_date": 1479330695, "answer_id": 40642394, "question_id": 40642305, "link": "https://stackoverflow.com/questions/40642305/search-for-specific-word-using-go/40642394#40642394", "title": "Search for specific word using Go", "body": "<p>The simplest thing is to use a <code>map[string]int</code>, where the key is the word, and the value is the count for that word.</p>\n\n<p>You would have to add each word to the map the first time it appears, and increment the count every time after that.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1479330730, "creation_date": 1479330730, "answer_id": 40642410, "question_id": 40642305, "link": "https://stackoverflow.com/questions/40642305/search-for-specific-word-using-go/40642410#40642410", "title": "Search for specific word using Go", "body": "<p>Compare the word string with the current string token in the scanner</p>\n\n<pre><code>func Occurrences(word string, r io.Reader) (int, error) {\n    scanner := bufio.NewScanner(r)\n\n    wordCount := 0\n    scanner.Split(bufio.ScanWords)\n    for scanner.Scan() {\n        if scanner.Text() == word {\n            wordCount++\n        }\n    }\n    return wordCount, scanner.Err()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gfl1jjM9Bd\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gfl1jjM9Bd</a></p>\n"}], "owner": {"reputation": 29, "user_id": 4191802, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcc807dcadfb2c19558df8d1673f86da?s=128&d=identicon&r=PG&f=1", "display_name": "Redmond", "link": "https://stackoverflow.com/users/4191802/redmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1479330956, "creation_date": 1479330357, "last_edit_date": 1479330956, "question_id": 40642305, "link": "https://stackoverflow.com/questions/40642305/search-for-specific-word-using-go", "title": "Search for specific word using Go", "body": "<p>I am new to Go, and am trying to set up a program that splits a Reader object word by word, then records the amount of times the word was found. Here is what I have so far.</p>\n\n<pre><code>func Occurrences(word string, s io.Reader) (uint, error) {\n    scanner := bufio.NewScanner(strings.NewReader(s))\n\n    // Split the reader into words\n    var word_count int // Number of the specific word found\n    scanner.Split(budfio.ScanWords)\n    for scanner.Scan() {\n\n    }\n}\n</code></pre>\n\n<p>I am not sure where to go from there. I do not know what to compare the word I am searching for with. Any help is appreciated</p>\n"}, {"tags": ["c++", "go", "swig"], "comments": [{"owner": {"reputation": 676, "user_id": 105456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f0049842700597b89972e1fbf6f542?s=128&d=identicon&r=PG", "display_name": "tmc", "link": "https://stackoverflow.com/users/105456/tmc"}, "edited": false, "score": 0, "creation_date": 1508719352, "post_id": 40642046, "comment_id": 80708277, "body": "can you put your failing example up somewhere?"}, {"owner": {"reputation": 14732, "user_id": 1026572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a74388494ea3475fe5a99a04d6120bcc?s=128&d=identicon&r=PG", "display_name": "dragonx", "link": "https://stackoverflow.com/users/1026572/dragonx"}, "reply_to_user": {"reputation": 676, "user_id": 105456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f0049842700597b89972e1fbf6f542?s=128&d=identicon&r=PG", "display_name": "tmc", "link": "https://stackoverflow.com/users/105456/tmc"}, "edited": false, "score": 0, "creation_date": 1530921590, "post_id": 40642046, "comment_id": 89418821, "body": "I don&#39;t remember exactly how I got around this, but I think I used a wrapper that converted the string to a <code>char *</code>."}, {"owner": {"reputation": 1169, "user_id": 230825, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/274ee5a62543653734586319874daf57?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/230825/david"}, "edited": false, "score": 0, "creation_date": 1538082981, "post_id": 40642046, "comment_id": 92030375, "body": "The code generated by swig 3.0.12 casts the Go String reference to a <code>void*</code> that is finally casted into a <code>std::string*</code>. So it crashes.  @dragonx What do you mean by <i>I lose the return value in this case</i> ?"}, {"owner": {"reputation": 14732, "user_id": 1026572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a74388494ea3475fe5a99a04d6120bcc?s=128&d=identicon&r=PG", "display_name": "dragonx", "link": "https://stackoverflow.com/users/1026572/dragonx"}, "reply_to_user": {"reputation": 1169, "user_id": 230825, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/274ee5a62543653734586319874daf57?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/230825/david"}, "edited": false, "score": 0, "creation_date": 1538179846, "post_id": 40642046, "comment_id": 92066257, "body": "@david It&#39;s been a while since I&#39;ve looked at this.  My solution was to convert the std::string&amp; to a char*, and pass a char* instead.  The early solution I had was to have Foo() return a std::string, which worked, but that also mean that Foo() could no longer return a meaningful error code."}], "owner": {"reputation": 14732, "user_id": 1026572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a74388494ea3475fe5a99a04d6120bcc?s=128&d=identicon&r=PG", "display_name": "dragonx", "link": "https://stackoverflow.com/users/1026572/dragonx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1479329407, "creation_date": 1479329407, "last_edit_date": 1495542749, "question_id": 40642046, "link": "https://stackoverflow.com/questions/40642046/can-swig-golang-handle-a-stdstring-out-param", "title": "Can swig + golang handle a std::string out param?", "body": "<p>I'm trying to connect a go project to a C++ lib using SWIG.  I've got most things working, but there's one function that takes a C++ std::string as a param and assigns a value to it, and I haven't been able to get that working.</p>\n\n<p>The closest thing I've found online is this question: <a href=\"https://stackoverflow.com/questions/17753105/string-parameters\">String parameters</a></p>\n\n<p>It's not the same since it takes a <code>const std::string &amp;</code>, and SWIG translates that to a go string.</p>\n\n<p>My function looks something like:</p>\n\n<p><code>bool foo(std::string &amp;result);</code></p>\n\n<p>SWIG converts this to <code>func Foo(result *string) boolean</code></p>\n\n<p>This compiles and builds, but if I pass in a pointer to a go string, it panics.</p>\n\n<pre><code>var result string\nFoo(&amp;result)\n</code></pre>\n\n<p>I have been able to make foo() return a std::string, which SWIG seems to make work with a go string just fine.  However, I lose the return value in this case.</p>\n\n<p>I'm using golang 1.7, swig 3.0.10</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1479326424, "post_id": 40641194, "comment_id": 68514415, "body": "If you&#39;re having trouble converting an integer to a string take a look at Go&#39;s package <a href=\"https://golang.org/pkg/strconv/\" rel=\"nofollow noreferrer\">golang.org/pkg/strconv</a> specifically the Itoa method"}, {"owner": {"reputation": 484, "user_id": 6666017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Xeyin.jpg?s=128&g=1", "display_name": "StackB00m", "link": "https://stackoverflow.com/users/6666017/stackb00m"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479326541, "post_id": 40641194, "comment_id": 68514486, "body": "i tried converting int to string, then the numbers changed their values to some special chars its weird"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479326607, "post_id": 40641194, "comment_id": 68514522, "body": "That sounds like and encoding issue."}, {"owner": {"reputation": 484, "user_id": 6666017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Xeyin.jpg?s=128&g=1", "display_name": "StackB00m", "link": "https://stackoverflow.com/users/6666017/stackb00m"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479326626, "post_id": 40641194, "comment_id": 68514533, "body": "yea any idea how to get rid of that ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1479327983, "post_id": 40641194, "comment_id": 68515314, "body": "Related / possible duplicate of (regarding your problem): <a href=\"http://stackoverflow.com/questions/11123865/golang-format-a-string-without-printing/31742265#31742265\">Golang: format a string without printing?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 484, "user_id": 6666017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Xeyin.jpg?s=128&g=1", "display_name": "StackB00m", "link": "https://stackoverflow.com/users/6666017/stackb00m"}, "edited": false, "score": 0, "creation_date": 1479326777, "post_id": 40641285, "comment_id": 68514634, "body": "Can you try these and complete the above code, so that when an ip is given it checks for each port and gives response recursively , please thanks"}], "tags": [], "owner": {"reputation": 6023, "user_id": 4236078, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9959d878feda9f2bab4b43b554e09847?s=128&d=identicon&r=PG&f=1", "display_name": "ale64bit", "link": "https://stackoverflow.com/users/4236078/ale64bit"}, "is_accepted": true, "score": 8, "last_activity_date": 1479326644, "creation_date": 1479326644, "answer_id": 40641285, "question_id": 40641194, "link": "https://stackoverflow.com/questions/40641194/string-and-integer-concatenation-issues-golang/40641285#40641285", "title": "String and integer concatenation issues golang", "body": "<p>One possibility is using <code>strconv.Itoa(getport)</code> to convert the <code>int</code> into a <code>string</code>. Another possibility is formatting the string, as in <code>fmt.Sprintf(\"%s:%d\", getip, getport)</code> or <code>fmt.Sprintf(\"%d - Open\", getport)</code>.</p>\n"}], "owner": {"reputation": 484, "user_id": 6666017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/Xeyin.jpg?s=128&g=1", "display_name": "StackB00m", "link": "https://stackoverflow.com/users/6666017/stackb00m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10550, "favorite_count": 1, "accepted_answer_id": 40641285, "answer_count": 1, "score": -2, "last_activity_date": 1479330240, "creation_date": 1479326296, "last_edit_date": 1479326777, "question_id": 40641194, "link": "https://stackoverflow.com/questions/40641194/string-and-integer-concatenation-issues-golang", "title": "String and integer concatenation issues golang", "body": "<p>I am trying to write a port scanner in Go, i am facing few problems since i am new to this. Below is the code i have written till now. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"os\"\n)\n\nfunc main() {\n\n    callme()\n\n}\n\nfunc callme() {\n\n    var status string\n    getip := os.Args[1]\n    getport := 0\n    for i := 0; i &lt; 10; i++ {\n        getport += i\n\n        data := getip + \":\" + getport\n        conn, err := net.Dial(\"tcp\", data)\n        if err != nil {\n            log.Println(\"Connection error:\", err)\n            status = \"Unreachable\"\n        } else {\n\n            status = getport + \" - \" + \"Open\"\n            defer conn.Close()\n        }\n\n        fmt.Println(status)\n\n    }\n}\n</code></pre>\n\n<p>I take ip from user as a command line arg, and then want to scan all ports on this ip. Since the net.Dial function needs data in a format like \"ip:port\" i am kinda confused how to concat string and int each time. Can any1 help me achieve this ? </p>\n"}, {"tags": ["mongodb", "go", "pagination", "mongodb-query", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1479344769, "post_id": 40634866, "comment_id": 68522054, "body": "Why var users []*User and not var users []User ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 1, "creation_date": 1479367508, "post_id": 40634866, "comment_id": 68529209, "body": "@EzequielMoreno Both works; I usually use a slice of pointers because I can easily post-process the slice with a <code>for range</code>, and it&#39;s more efficient to pass around individual users."}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1479574752, "post_id": 40634866, "comment_id": 68620330, "body": "@icza can you provide an example of the getLastCursor() function? There is no example in doc and I&#39;m not sure what <code>cursor</code> should be initialized to."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1479575739, "post_id": 40634866, "comment_id": 68620688, "body": "@nosequeldeebee <code>getLastCursor()</code> is a  non-existing function, it is supposed to represent <i>your</i> logic how you acquire the last cursor. When you query the first page, <code>cursor</code> should be the empty string (you don&#39;t have to call <code>Minquery.Cursor()</code> to get the first page). <code>MinQuery.All()</code> returns you the docs of the first page and a cursor. To get the second (next) page, use this cursor. In general, to get the next page, use the cursor returned by the previous <code>MinQuery.All()</code> call."}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1479579806, "post_id": 40634866, "comment_id": 68622131, "body": "@icza thank you. I took a bit of a shortcut and just initialized a global variable, which starts as an empty string, then takes the contents of <code>newCursor</code> as the cursor changes. This is a fantastic package. Makes my life much easier."}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1479585241, "post_id": 40634866, "comment_id": 68623823, "body": "@icza I had some problems with skipping results using your package. Setting the skip value back to 0 fixed it for me, but I was using a simple global variable instead of writing a function to set cursors. I created a humble pull request, feel free to reject it if you disagree."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1479588397, "post_id": 40634866, "comment_id": 68624749, "body": "@nosequeldeebee The <code>skip(1)</code> is the right way as the entry / document specified by the cursor is implicit, meaning the cursor is generated from the last result, and using it without skip would again return the last result, hence the <code>skip(1)</code> to start listing elements after the last result. I&#39;ve tested and it works correctly. The error is most likely in your code which I don&#39;t know. You should post it as a new question."}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1479588890, "post_id": 40634866, "comment_id": 68624864, "body": "Ok, I closed the pull request. Anyways thank you. This is a really useful package."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1479589557, "post_id": 40634866, "comment_id": 68625065, "body": "@nosequeldeebee I posted a full working example on your pull request in a comment which demonstrates the correct working. Please check it: <a href=\"https://github.com/icza/minquery/pull/1\" rel=\"nofollow noreferrer\">full working example</a>."}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1479593308, "post_id": 40634866, "comment_id": 68626046, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/128547/discussion-between-nosequeldeebee-and-icza\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1487772447, "post_id": 40634866, "comment_id": 71934886, "body": "is this able to handle  pipelines?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1487772752, "post_id": 40634866, "comment_id": 71935094, "body": "@EzequielMoreno <code>MinQuery</code> utilizes / operates on a MongoDB index, so it supports what an index supports: sorting, projecting and limiting the results. Plus setting the index entry of the first element to retrieve."}, {"owner": {"reputation": 386, "user_id": 1359876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40741f2e530c398d996ff4329b3b4076?s=128&d=identicon&r=PG", "display_name": "tutley", "link": "https://stackoverflow.com/users/1359876/tutley"}, "edited": false, "score": 2, "creation_date": 1509842940, "post_id": 40634866, "comment_id": 81184283, "body": "I just wanted to stop in and say this is one of the best answers I&#39;ve ever read on this site."}, {"owner": {"reputation": 3641, "user_id": 3139595, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/r1GRx.png?s=128&g=1", "display_name": "Edwin O.", "link": "https://stackoverflow.com/users/3139595/edwin-o"}, "edited": false, "score": 0, "creation_date": 1525707896, "post_id": 40634866, "comment_id": 87452871, "body": "how do you return the total count using minquery?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3641, "user_id": 3139595, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/r1GRx.png?s=128&g=1", "display_name": "Edwin O.", "link": "https://stackoverflow.com/users/3139595/edwin-o"}, "edited": false, "score": 0, "creation_date": 1525713415, "post_id": 40634866, "comment_id": 87455733, "body": "@EdwinIkechukwu You don&#39;t need <code>MinQuery</code> to query the total number of records. Simply execute a count-query with the query you pass to <code>minquery.New()</code>, something like: <code>coll.Find(query).Count()</code>."}, {"owner": {"reputation": 1178, "user_id": 3436921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0xi3.jpg?s=128&g=1", "display_name": "valichek", "link": "https://stackoverflow.com/users/3436921/valichek"}, "edited": false, "score": 0, "creation_date": 1533040156, "post_id": 40634866, "comment_id": 90191921, "body": "@icza hi, have a question about having <code>cursorFields</code> in <code>MinQuery.All(...)</code>. Why this fields are not constructed from <code>filter</code> and <code>sort</code>? What is the reason to keep this explicit?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1178, "user_id": 3436921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0xi3.jpg?s=128&g=1", "display_name": "valichek", "link": "https://stackoverflow.com/users/3436921/valichek"}, "edited": false, "score": 0, "creation_date": 1533046132, "post_id": 40634866, "comment_id": 90196034, "body": "@valichek Filter and sorting fields may be completely different than the cursor fields. To allow this kind of flexibility, you have to be explicit about the cursor fields."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 20, "last_activity_date": 1479627939, "last_edit_date": 1479627939, "creation_date": 1479307087, "answer_id": 40634866, "question_id": 40634865, "link": "https://stackoverflow.com/questions/40634865/efficient-paging-in-mongodb-using-mgo/40634866#40634866", "title": "Efficient paging in MongoDB using mgo", "body": "<p>Unfortunately the <a href=\"https://godoc.org/gopkg.in/mgo.v2\" rel=\"noreferrer\"><code>mgo.v2</code></a> driver does not provide API calls to specify <a href=\"https://docs.mongodb.com/manual/reference/method/cursor.min/\" rel=\"noreferrer\"><code>cursor.min()</code></a>.</p>\n\n<p>But there is a solution. The <a href=\"https://godoc.org/gopkg.in/mgo.v2#Database\" rel=\"noreferrer\"><code>mgo.Database</code></a> type provides a <a href=\"https://godoc.org/gopkg.in/mgo.v2#Database.Run\" rel=\"noreferrer\"><code>Database.Run()</code></a> method to run any MongoDB commands. The available commands and their documentation can be found here: <a href=\"https://docs.mongodb.com/manual/reference/command/\" rel=\"noreferrer\">Database commands</a></p>\n\n<p>Starting with MongoDB 3.2, a new <a href=\"https://docs.mongodb.com/manual/reference/command/find/\" rel=\"noreferrer\"><code>find</code></a> command is available which can be used to execute queries, and it supports specifying the <code>min</code> argument that denotes the first index entry to start listing results from.</p>\n\n<p>Good. What we need to do is after each batch (documents of a page) generate the <code>min</code> document from the last document of the query result, which must contain the values of the index entry that was used to execute the query, and then the next batch (the documents of the next page) can be acquired by setting this min index entry prior to executing the query.</p>\n\n<p>This index entry \u2013let's call it <em>cursor</em> from now on\u2013 may be encoded to a <code>string</code> and sent to the client along with the results, and when the client wants the next page, he sends back the <em>cursor</em> saying he wants results starting after this cursor.</p>\n\n<h2>Doing it manually (the \"hard\" way)</h2>\n\n<p>The command to be executed can be in different forms, but the command name (<code>find</code>) must be first in the marshaled result, so we'll use <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#D\" rel=\"noreferrer\"><code>bson.D</code></a> (which preserves order in contrast to <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#M\" rel=\"noreferrer\"><code>bson.M</code></a>):</p>\n\n<pre><code>limit := 10\ncmd := bson.D{\n    {Name: \"find\", Value: \"users\"},\n    {Name: \"filter\", Value: bson.M{\"country\": \"USA\"}},\n    {Name: \"sort\", Value: []bson.D{\n        {Name: \"name\", Value: 1},\n        {Name: \"_id\", Value: 1},\n    },\n    {Name: \"limit\", Value: limit},\n    {Name: \"batchSize\", Value: limit},\n    {Name: \"singleBatch\", Value: true},\n}\nif min != nil {\n    // min is inclusive, must skip first (which is the previous last)\n    cmd = append(cmd,\n        bson.DocElem{Name: \"skip\", Value: 1},\n        bson.DocElem{Name: \"min\", Value: min},\n    )\n}\n</code></pre>\n\n<p>The result of executing a MongoDB <code>find</code> command with <code>Database.Run()</code> can be captured with the following type:</p>\n\n<pre><code>var res struct {\n    OK       int `bson:\"ok\"`\n    WaitedMS int `bson:\"waitedMS\"`\n    Cursor   struct {\n        ID         interface{} `bson:\"id\"`\n        NS         string      `bson:\"ns\"`\n        FirstBatch []bson.Raw  `bson:\"firstBatch\"`\n    } `bson:\"cursor\"`\n}\n\ndb := session.DB(\"\")\nif err := db.Run(cmd, &amp;res); err != nil {\n    // Handle error (abort)\n}\n</code></pre>\n\n<p>We now have the results, but in a slice of type <code>[]bson.Raw</code>. But we want it in a slice of type <code>[]*User</code>. This is where <a href=\"https://godoc.org/gopkg.in/mgo.v2#Collection.NewIter\" rel=\"noreferrer\"><code>Collection.NewIter()</code></a> comes handy. It can transform (unmarshal) a value of type <code>[]bson.Raw</code> into any type we usually pass to <a href=\"https://godoc.org/gopkg.in/mgo.v2#Query.All\" rel=\"noreferrer\"><code>Query.All()</code></a> or <a href=\"https://godoc.org/gopkg.in/mgo.v2#Iter.All\" rel=\"noreferrer\"><code>Iter.All()</code></a>. Good. Let's see it:</p>\n\n<pre><code>firstBatch := res.Cursor.FirstBatch\nvar users []*User\nerr = db.C(\"users\").NewIter(nil, firstBatch, 0, nil).All(&amp;users)\n</code></pre>\n\n<p>We now have the users of the next page. Only one thing left: generating the cursor to be used to get the subsequent page should we ever need it:</p>\n\n<pre><code>if len(users) &gt; 0 {\n    lastUser := users[len(users)-1]\n    cursorData := []bson.D{\n        {Name: \"country\", Value: lastUser.Country},\n        {Name: \"name\", Value: lastUser.Name},\n        {Name: \"_id\", Value: lastUser.ID},\n    }\n} else {\n    // No more users found, use the last cursor\n}\n</code></pre>\n\n<p>This is all good, but how do we convert a <code>cursorData</code> to <code>string</code> and vice versa? We may use <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#Marshal\" rel=\"noreferrer\"><code>bson.Marshal()</code></a> and <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#Unmarshal\" rel=\"noreferrer\"><code>bson.Unmarshal()</code></a> combined with base64 encoding; the use of <a href=\"https://golang.org/pkg/encoding/base64/#RawURLEncoding\" rel=\"noreferrer\"><code>base64.RawURLEncoding</code></a> will give us a web-safe cursor string, one that can be added to URL queries without escaping.</p>\n\n<p>Here's an example implementation:</p>\n\n<pre><code>// CreateCursor returns a web-safe cursor string from the specified fields.\n// The returned cursor string is safe to include in URL queries without escaping.\nfunc CreateCursor(cursorData bson.D) (string, error) {\n    // bson.Marshal() never returns error, so I skip a check and early return\n    // (but I do return the error if it would ever happen)\n    data, err := bson.Marshal(cursorData)\n    return base64.RawURLEncoding.EncodeToString(data), err\n}\n\n// ParseCursor parses the cursor string and returns the cursor data.\nfunc ParseCursor(c string) (cursorData bson.D, err error) {\n    var data []byte\n    if data, err = base64.RawURLEncoding.DecodeString(c); err != nil {\n        return\n    }\n\n    err = bson.Unmarshal(data, &amp;cursorData)\n    return\n}\n</code></pre>\n\n<p>And we finally have our efficient, but not so short MongoDB <code>mgo</code> paging functionality. Read on...</p>\n\n<h2>Using <code>github.com/icza/minquery</code> (the \"easy\" way)</h2>\n\n<p>The manual way is quite lengthy; it can be made <em>general</em> and <em>automated</em>. This is where <a href=\"https://github.com/icza/minquery\" rel=\"noreferrer\"><code>github.com/icza/minquery</code></a> comes into the picture (<em>disclosure: I'm the author</em>). It provides a wrapper to configure and execute a MongoDB <code>find</code> command, allowing you to specify a cursor, and after executing the query, it gives you back the new cursor to be used to query the next batch of results. The wrapper is the <a href=\"https://godoc.org/github.com/icza/minquery#MinQuery\" rel=\"noreferrer\"><code>MinQuery</code></a> type which is very similar to <a href=\"https://godoc.org/gopkg.in/mgo.v2#Query\" rel=\"noreferrer\"><code>mgo.Query</code></a> but it supports specifying MongoDB's <code>min</code> via the <code>MinQuery.Cursor()</code> method.</p>\n\n<p>The above solution using <code>minquery</code> looks like this:</p>\n\n<pre><code>q := minquery.New(session.DB(\"\"), \"users\", bson.M{\"country\" : \"USA\"}).\n    Sort(\"name\", \"_id\").Limit(10)\n// If this is not the first page, set cursor:\n// getLastCursor() represents your logic how you acquire the last cursor.\nif cursor := getLastCursor(); cursor != \"\" {\n    q = q.Cursor(cursor)\n}\n\nvar users []*User\nnewCursor, err := q.All(&amp;users, \"country\", \"name\", \"_id\")\n</code></pre>\n\n<p>And that's all. <code>newCursor</code> is the cursor to be used to fetch the next batch.</p>\n\n<p><strong>Note #1:</strong> When calling <code>MinQuery.All()</code>, you have to provide the names of the cursor fields, this will be used to build the cursor data (and ultimately the cursor string) from.</p>\n\n<p><strong>Note #2:</strong> If you're retrieving partial results (by using <code>MinQuery.Select()</code>), you have to include all the fields that are part of the cursor (the index entry) even if you don't intend to use them directly, else <code>MinQuery.All()</code> will not have all the values of the cursor fields, and so it will not be able to create the proper cursor value.</p>\n\n<p>Check out the package doc of <code>minquery</code> here: <a href=\"https://godoc.org/github.com/icza/minquery\" rel=\"noreferrer\">https://godoc.org/github.com/icza/minquery</a>, it is rather short and hopefully clean.</p>\n"}], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8318, "favorite_count": 6, "accepted_answer_id": 40634866, "answer_count": 1, "score": 9, "last_activity_date": 1585519572, "creation_date": 1479307087, "last_edit_date": 1495539963, "question_id": 40634865, "link": "https://stackoverflow.com/questions/40634865/efficient-paging-in-mongodb-using-mgo", "title": "Efficient paging in MongoDB using mgo", "body": "<p><sup>I've searched and found no Go solution to the problem, not with or without using <a href=\"https://godoc.org/gopkg.in/mgo.v2\" rel=\"noreferrer\"><code>mgo.v2</code></a>, not on StackOverflow and not on any other site. This Q&amp;A is in the spirit of <a href=\"https://stackoverflow.blog/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">knowledge sharing / documenting</a>.</sup></p>\n\n<hr>\n\n<p>Let's say we have a <code>users</code> collection in MongoDB modeled with this Go <code>struct</code>:</p>\n\n<pre><code>type User struct {\n    ID      bson.ObjectId `bson:\"_id\"`\n    Name    string        `bson:\"name\"`\n    Country string        `bson:\"country\"`\n}\n</code></pre>\n\n<p>We want to sort and list users based on some criteria, but have paging implemented due to the expected long result list.</p>\n\n<p>To achieve paging of the results of some query, MongoDB and the <a href=\"https://godoc.org/gopkg.in/mgo.v2\" rel=\"noreferrer\"><code>mgo.v2</code></a> driver package has built-in support in the form of <a href=\"https://godoc.org/gopkg.in/mgo.v2#Query.Skip\" rel=\"noreferrer\"><code>Query.Skip()</code></a> and <a href=\"https://godoc.org/gopkg.in/mgo.v2#Query.Limit\" rel=\"noreferrer\"><code>Query.Limit()</code></a>, e.g.:</p>\n\n<pre><code>session, err := mgo.Dial(url) // Acquire Mongo session, handle error!\n\nc := session.DB(\"\").C(\"users\")\nq := c.Find(bson.M{\"country\" : \"USA\"}).Sort(\"name\", \"_id\").Limit(10)\n\n// To get the nth page:\nq = q.Skip((n-1)*10)\n\nvar users []*User\nerr = q.All(&amp;users)\n</code></pre>\n\n<p>This however becomes slow if the page number increases, as MongoDB can't just \"magically\" jump to the x<sup>th</sup> document in the result, it has to iterate over all the result documents and omit (not return) the first <code>x</code> that need to be skipped.</p>\n\n<p>MongoDB provides the right solution: If the query operates on an index (it has to work on an index), <a href=\"https://docs.mongodb.com/manual/reference/method/cursor.min/\" rel=\"noreferrer\"><code>cursor.min()</code></a> can be used to specify the first <em>index entry</em> to start listing results from.</p>\n\n<p>This Stack Overflow answer shows how it can be done using a mongo client: <a href=\"https://stackoverflow.com/questions/5525304/how-to-do-pagination-using-range-queries-in-mongodb/5526907#5526907\">How to do pagination using range queries in MongoDB?</a></p>\n\n<p>Note: the required index for the above query would be:</p>\n\n<pre><code>db.users.createIndex(\n    {\n        country: 1,\n        name: 1,\n        _id: 1\n    }\n)\n</code></pre>\n\n<p>There is one problem though: the <code>mgo.v2</code> package has no support specifying this <code>min()</code>.</p>\n\n<p>How can we achieve efficient paging that uses MongoDB's <code>cursor.min()</code> feature using the <code>mgo.v2</code> driver?</p>\n"}, {"tags": ["svg", "go"], "comments": [{"owner": {"reputation": 239, "user_id": 4015178, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100003976369429/picture?type=large", "display_name": "Raimondas Kazlauskas", "link": "https://stackoverflow.com/users/4015178/raimondas-kazlauskas"}, "edited": false, "score": 1, "creation_date": 1479308280, "post_id": 40633669, "comment_id": 68502805, "body": "What template engine are you using? Default one? If you are using default, my suggestion will be to read SVG file as variable and pass it to template. You can find more information here:  <a href=\"https://astaxie.gitbooks.io/build-web-application-with-golang/content/en/07.4.html\" rel=\"nofollow noreferrer\">astaxie.gitbooks.io/build-web-application-with-golang/conten&zwnj;&#8203;t/&hellip;</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1479316633, "post_id": 40633669, "comment_id": 68508800, "body": "you also could define a function which would read the path as a file, and print the content, <a href=\"https://golang.org/pkg/text/template/#Template.Funcs\" rel=\"nofollow noreferrer\">see this</a>. Be aware that you ll need to wrap the result into a <code>template.HTML(&quot;string&quot;)</code> <a href=\"https://golang.org/pkg/html/template/#HTML\" rel=\"nofollow noreferrer\">type</a> to avoid html encoding!"}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 1, "last_activity_date": 1479330156, "last_edit_date": 1479330156, "creation_date": 1479320983, "answer_id": 40639621, "question_id": 40633669, "link": "https://stackoverflow.com/questions/40633669/how-to-directly-include-svg-as-a-html-partial-in-go/40639621#40639621", "title": "How to directly include SVG as a html partial in Go", "body": "<p>Here is a working example of how to add a template function and include an svg by path in a template</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc IncludeHTML(path string) template.HTML {\n    b, err := ioutil.ReadFile(path)\n    if err != nil {\n        log.Println(\"includeHTML - error reading file: %v\", err)\n        return \"\"\n    }\n\n    return template.HTML(string(b))\n}\n\nfunc main() {\n    tmpl := template.New(\"sample\")\n    tmpl.Funcs(template.FuncMap{\n        \"IncludeHTML\": IncludeHTML,\n    })\n\n    tmpl, err := tmpl.Parse(`\n&lt;!DOCTYPE&gt;\n&lt;html&gt;\n&lt;body&gt;\n    &lt;h1&gt;Check out this svg&lt;/h1&gt;\n    {{ IncludeHTML \"/path/to/svg\" }}\n&lt;/body&gt;\n&lt;/html&gt;\n    `)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"text/html\")\n        if err := tmpl.Execute(w, nil); err != nil {\n            log.Println(\"Error executing template: %v\", err)\n        }\n    })\n\n    if err := http.ListenAndServe(\":8000\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 971, "user_id": 1386906, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a81dc59cf05f7fccc8222907a105c37f?s=128&d=identicon&r=PG", "display_name": "user1386906", "link": "https://stackoverflow.com/users/1386906/user1386906"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "accepted_answer_id": 40639621, "answer_count": 1, "score": 0, "last_activity_date": 1479330156, "creation_date": 1479303709, "question_id": 40633669, "link": "https://stackoverflow.com/questions/40633669/how-to-directly-include-svg-as-a-html-partial-in-go", "title": "How to directly include SVG as a html partial in Go", "body": "<p>I want to include svg files as a html partial so I can use it inline in my HTML.\nI now I have my svg wrapped in html files and include them like this:</p>\n\n<pre><code>{{ template \"/partial/my-svg.html\" }}\n</code></pre>\n\n<p>But I want to include my svg's directly. PHP does this like so:</p>\n\n<pre><code>&lt;?php echo file_get_contents(\"/partial/my-svg.svg\"); ?&gt; \n</code></pre>\n\n<p>I don't think go has something similar? So I think I need to extend the template logic with a custom function. Something like:</p>\n\n<pre><code>{{ includeSvg \"/partial/my-svg.svg\" }}\n</code></pre>\n\n<p>How would such a function look like in go?</p>\n"}, {"tags": ["go", "types", "sha1"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1479304790, "post_id": 40632802, "comment_id": 68500355, "body": "<code>[]byte</code> can be converted directly to <code>string</code>. Please show an example of what problem you&#39;re having."}, {"owner": {"reputation": 219, "user_id": 7159949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7a4bbgbd3xc/AAAAAAAAAAI/AAAAAAAAA1w/BxjeuF93Zk8/photo.jpg?sz=128", "display_name": "lindsay show", "link": "https://stackoverflow.com/users/7159949/lindsay-show"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479349295, "post_id": 40632802, "comment_id": 68523260, "body": "eg. file hash value  to string for filename"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479400808, "post_id": 40632802, "comment_id": 68551908, "body": "If you just show us an example of what you tried, it would be a very easy question to answer, rather than waiting for us to guess the correct answer."}, {"owner": {"reputation": 2775, "user_id": 2102748, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a1adcb8ed924ecd1045fd6252a7df18?s=128&d=identicon&r=PG", "display_name": "milosmns", "link": "https://stackoverflow.com/users/2102748/milosmns"}, "edited": false, "score": 0, "creation_date": 1572803183, "post_id": 40632802, "comment_id": 103665334, "body": "In most modern languages it would be perfectly clear what he was trying to do, sadly, and without any additional context needed. I also stumbled upon this question looking for the same answer (as answered below)."}], "answers": [{"comments": [{"owner": {"reputation": 219, "user_id": 7159949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7a4bbgbd3xc/AAAAAAAAAAI/AAAAAAAAA1w/BxjeuF93Zk8/photo.jpg?sz=128", "display_name": "lindsay show", "link": "https://stackoverflow.com/users/7159949/lindsay-show"}, "edited": false, "score": 0, "creation_date": 1479348692, "post_id": 40632899, "comment_id": 68523107, "body": "I have just try like this.but failed. In fact ,I need to convert a file sha1 value to string ,named for the filename"}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 6, "last_activity_date": 1479327614, "last_edit_date": 1479327614, "creation_date": 1479301492, "answer_id": 40632899, "question_id": 40632802, "link": "https://stackoverflow.com/questions/40632802/how-to-convert-byte-array-to-string-in-go/40632899#40632899", "title": "How to convert byte array to string in Go", "body": "<p>In Go you convert a byte array (utf-8) to a string by doing <code>string(bytes)</code> so in your example, it should be <code>string(byte[:n])</code> assuming <code>byte</code> is a slice of bytes.</p>\n"}, {"comments": [{"owner": {"reputation": 219, "user_id": 7159949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7a4bbgbd3xc/AAAAAAAAAAI/AAAAAAAAA1w/BxjeuF93Zk8/photo.jpg?sz=128", "display_name": "lindsay show", "link": "https://stackoverflow.com/users/7159949/lindsay-show"}, "edited": false, "score": 0, "creation_date": 1479357243, "post_id": 40641124, "comment_id": 68525118, "body": "Thanks a lot. EncodeToString returns the hexadecimal encoding of src.it works well."}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 0, "last_activity_date": 1479326087, "last_edit_date": 1495540795, "creation_date": 1479326087, "answer_id": 40641124, "question_id": 40632802, "link": "https://stackoverflow.com/questions/40632802/how-to-convert-byte-array-to-string-in-go/40641124#40641124", "title": "How to convert byte array to string in Go", "body": "<p>First you're getting all these negatives reviews because you didn't provided any code.\nSecond, without a good example. This is what i'd do</p>\n\n<pre><code>var Buf bytes.Buffer\nBuf.Write([]byte)\nmyString := Buf.String()\nBuf.Reset() // Reset the buffer to reuse later\n</code></pre>\n\n<p>or better yet </p>\n\n<pre><code>myString := string(someByteArray[:n])\n</code></pre>\n\n<p>see <a href=\"https://stackoverflow.com/questions/14230145/what-is-the-best-way-to-convert-byte-array-to-string\">here</a> also see @JimB's comment</p>\n\n<p>That being said if you help that targets your program, please provide and example of what you've tried, the expect results, and error.</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479400763, "post_id": 40649570, "comment_id": 68551878, "body": "While technically correct, it&#39;s rather unusual in Go to use <code>var</code> and declare every type without just inferring them. <a href=\"https://play.golang.org/p/JUl57LKfzk\" rel=\"nofollow noreferrer\">play.golang.org/p/JUl57LKfzk</a>"}, {"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 0, "creation_date": 1496598768, "post_id": 40649570, "comment_id": 75716197, "body": "Ah! &quot;%x&quot;! That&#39;s what I was doing wrong! :) I was using the wrong Sprintf placeholder, duh..."}], "tags": [], "owner": {"reputation": 144, "user_id": 3037327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2c40f8020cc8c146d3df354e63fd56?s=128&d=identicon&r=PG&f=1", "display_name": "alarcl", "link": "https://stackoverflow.com/users/3037327/alarcl"}, "is_accepted": false, "score": 4, "last_activity_date": 1479370281, "last_edit_date": 1479370281, "creation_date": 1479369798, "answer_id": 40649570, "question_id": 40632802, "link": "https://stackoverflow.com/questions/40632802/how-to-convert-byte-array-to-string-in-go/40649570#40649570", "title": "How to convert byte array to string in Go", "body": "<p>I am not sure that i understand question correctly, but may be:</p>\n\n<pre><code>var ab20 [20]byte = sha1.Sum([]byte(\"filename.txt\"))\nvar sx16 string = fmt.Sprintf(\"%x\", ab20)\nfmt.Print(sx16)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/haChjjsH0-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/haChjjsH0-</a></p>\n"}, {"comments": [{"owner": {"reputation": 1329, "user_id": 3359227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qpcB.png?s=128&g=1", "display_name": "pranavrao1", "link": "https://stackoverflow.com/users/3359227/pranavrao1"}, "edited": false, "score": 0, "creation_date": 1576019193, "post_id": 40673073, "comment_id": 104760181, "body": "why does it include &quot;!!binary&quot; in the front?"}], "tags": [], "owner": {"reputation": 341, "user_id": 7177261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67c3ac0e931c734e23b51eb03952dd3?s=128&d=identicon&r=PG&f=1", "display_name": "warbear0129", "link": "https://stackoverflow.com/users/7177261/warbear0129"}, "is_accepted": false, "score": 34, "last_activity_date": 1596602092, "last_edit_date": 1596602092, "creation_date": 1479460062, "answer_id": 40673073, "question_id": 40632802, "link": "https://stackoverflow.com/questions/40632802/how-to-convert-byte-array-to-string-in-go/40673073#40673073", "title": "How to convert byte array to string in Go", "body": "<p>The easiest method I use to convert <code>byte</code> to <code>string</code> is:</p>\n<pre><code>myString := string(myBytes[:])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1554192963, "creation_date": 1554192963, "answer_id": 55469949, "question_id": 40632802, "link": "https://stackoverflow.com/questions/40632802/how-to-convert-byte-array-to-string-in-go/55469949#55469949", "title": "How to convert byte array to string in Go", "body": "<p>We can just guess what is wrong with your code because no meaningful example is provided. But first what I see that <code>string([]byte[:n])</code> is not valid at all. <code>[]byte[:n]</code> is not a valid expression because no memory allocated for the array. Since byte array could be converted to string directly I assume that you have just a syntax error.</p>\n\n<p>Shortest valid is <code>fmt.Println(string([]byte{'g', 'o'}))</code></p>\n"}, {"comments": [{"owner": {"reputation": 304, "user_id": 1920432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecf52ab8b4891d2477fae50f7b487bcb?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan Ponnappan", "link": "https://stackoverflow.com/users/1920432/rajan-ponnappan"}, "edited": false, "score": 0, "creation_date": 1593375147, "post_id": 59175412, "comment_id": 110752089, "body": "Awesome, it is quite handy to encode the bytes to string in golang!"}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 20, "last_activity_date": 1575460358, "creation_date": 1575460358, "answer_id": 59175412, "question_id": 40632802, "link": "https://stackoverflow.com/questions/40632802/how-to-convert-byte-array-to-string-in-go/59175412#59175412", "title": "How to convert byte array to string in Go", "body": "<p>The easiest way to convert <code>[]byte</code> to <code>string</code> in Go:</p>\n\n<pre><code>myString := string(myBytes)\n</code></pre>\n\n<hr>\n\n<p>Note: to convert a \"<em>sha1 value to string</em>\" like you're asking, it needs to be <em>encoded</em> first, since a hash is binary. The traditional encoding for SHA hashes is hex (<code>import \"encoding/hex\"</code>):</p>\n\n<pre><code>myString := hex.EncodeToString(sha1bytes)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13460406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6cf6b427a2d16dd24d4a9a6249b4ea1?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Kalra", "link": "https://stackoverflow.com/users/13460406/dev-kalra"}, "is_accepted": false, "score": 0, "last_activity_date": 1588513740, "creation_date": 1588513740, "answer_id": 61575526, "question_id": 40632802, "link": "https://stackoverflow.com/questions/40632802/how-to-convert-byte-array-to-string-in-go/61575526#61575526", "title": "How to convert byte array to string in Go", "body": "<pre><code>ToBe := [6]byte{65, 66, 67, 226, 130, 172}\ns:=ToBe[:3]\n// this will work\nfmt.Printf(\"%s\",string(s))\n// this will not\nfmt.Printf(\"%s\",string(ToBe))\n</code></pre>\n\n<p>Difference : ToBe is an array whereas s is a slice.</p>\n"}], "owner": {"reputation": 219, "user_id": 7159949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7a4bbgbd3xc/AAAAAAAAAAI/AAAAAAAAA1w/BxjeuF93Zk8/photo.jpg?sz=128", "display_name": "lindsay show", "link": "https://stackoverflow.com/users/7159949/lindsay-show"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52179, "favorite_count": 1, "closed_date": 1590248571, "answer_count": 7, "score": 13, "last_activity_date": 1596602092, "creation_date": 1479301157, "last_edit_date": 1554192077, "question_id": 40632802, "link": "https://stackoverflow.com/questions/40632802/how-to-convert-byte-array-to-string-in-go", "closed_reason": "Duplicate", "title": "How to convert byte array to string in Go", "body": "<p><code>[]byte</code> to string raises an error.\n<code>string([]byte[:n])</code> raises an error too.\nBy the way, for example, sha1 value to string for filename.\nDoes it need utf-8 or any other encoding set explicitly? \nThanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1479305145, "post_id": 40630562, "comment_id": 68500613, "body": "@Volker For your question, yes! it&#39;s doable. Golang validates the len and cap using function maxSliceCap[go1.7/src/runtime/slice.go:32]. There are  APIs to get runtime information. Though this can be achieved by using a defer function to capture the panic and recover, we can use an API which will be straight forward. Question is whether there is any exposed API which will help."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 1, "creation_date": 1479309054, "post_id": 40630562, "comment_id": 68503394, "body": "@Spartan This are just <i>hard</i> <i>upper</i> <i>limits</i>! There is no guarantee that there actually will be enough free memory to allocate this slice. _MaxMem is not the actual available or even physically present RAM. But you are right : If this is the question of the OP, then I stand corrected."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1479325843, "last_edit_date": 1479325843, "creation_date": 1479325522, "answer_id": 40640967, "question_id": 40630562, "link": "https://stackoverflow.com/questions/40630562/finding-the-maximum-length-value-of-a-collection-that-can-be-declared-in-golang/40640967#40640967", "title": "Finding the maximum length value of a collection that can be declared in golang using make()", "body": "<p>If you really want the max length of a slice, you can copy the algorithm used from the runtime package. This will take an example of the slice element to determine its size, and return the maximum slice capacity for that value type.</p>\n\n<pre><code>func maxSliceCap(i interface{}) int {\n    _64bit := uintptr(1 &lt;&lt; (^uintptr(0) &gt;&gt; 63) / 2)\n\n    var goosWindows, goosDarwin, goarchArm64 uintptr\n    switch runtime.GOOS {\n    case \"darwin\":\n        goosDarwin = 1\n    case \"windows\":\n        goosWindows = 1\n    }\n\n    switch runtime.GOARCH {\n    case \"arm64\":\n        goarchArm64 = 1\n    }\n\n    heapMapBits := (_64bit*goosWindows)*35 + (_64bit*(1-goosWindows)*(1-goosDarwin*goarchArm64))*39 + goosDarwin*goarchArm64*31 + (1-_64bit)*32\n    maxMem := uintptr(1&lt;&lt;heapMapBits - 1)\n\n    elemSize := reflect.ValueOf(i).Type().Size()\n    max := maxMem / elemSize\n\n    if int(max) &lt; 0 {\n        return 1&lt;&lt;31 - 1\n    }\n\n    return int(max)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/roOarwQpZL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/roOarwQpZL</a></p>\n"}], "owner": {"reputation": 1455, "user_id": 465147, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e824e3adb5aa777566fa8e53f89bebbe?s=128&d=identicon&r=PG", "display_name": "sprabhakaran", "link": "https://stackoverflow.com/users/465147/sprabhakaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479325843, "creation_date": 1479294395, "last_edit_date": 1495542623, "question_id": 40630562, "link": "https://stackoverflow.com/questions/40630562/finding-the-maximum-length-value-of-a-collection-that-can-be-declared-in-golang", "title": "Finding the maximum length value of a collection that can be declared in golang using make()", "body": "<p>I'm facing the error \"panic: runtime error: makeslice: len out of range\", while creating a dynamic array, for large values of length using \"make()\".</p>\n\n<p>eg.</p>\n\n<pre><code>arr := make([]int, length)   //length is a dynamic value\n</code></pre>\n\n<p>I know, this question was already asked here (<a href=\"https://stackoverflow.com/questions/27647737/maximum-length-of-a-slice-in-go\">Maximum length of a slice in Go</a>). \nBut, the make method does not support maximum value of the \"int\" datatype in golang. They consume the length value based on (size of) struct type. \nIs there any predefined APIs available to find maximum of the length value of a collection that can be declared in golang ?  </p>\n\n<p>Eg:</p>\n\n<pre><code>maxInt := int(^uint(0) &gt;&gt; 1) \n\narr := make([]struct{}, maxInt-1)  //accepted\narr := make([]int, maxInt-1)  //throw error\n</code></pre>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1479293056, "creation_date": 1479293056, "answer_id": 40630090, "question_id": 40629079, "link": "https://stackoverflow.com/questions/40629079/copy-data-file-within-go-package/40630090#40630090", "title": "Copy data file within Go package?", "body": "<blockquote>\n  <p>Is there any option to put custom file near go package while installing package?</p>\n</blockquote>\n\n<p>No there is not. Sorry. This has to be solved by other means like system package managers.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3584166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5rp7B.png?s=128&g=1", "display_name": "Deforciant", "link": "https://stackoverflow.com/users/3584166/deforciant"}, "is_accepted": false, "score": 0, "last_activity_date": 1479300739, "creation_date": 1479300739, "answer_id": 40632650, "question_id": 40629079, "link": "https://stackoverflow.com/questions/40629079/copy-data-file-within-go-package/40632650#40632650", "title": "Copy data file within Go package?", "body": "<p>I would suggest using <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">https://github.com/jteeuwen/go-bindata</a> tool to compile that dependency into your main Go binary. This way you can then store multiple files inside your single binary (for different operating systems) and pick the right one on runtime. I use it in several projects - haven't found any problems with this approach. </p>\n\n<pre><code>go-bindata -o output_file.go input_data_directory/\n</code></pre>\n\n<p>and then to access it:</p>\n\n<pre><code>data, err := Asset(\"some_important_file\")\nif err != nil {\n    // Asset was not found.\n}\n</code></pre>\n\n<p>So, when you start your application - just copy the files from your inside Asset to the paths that your application is expecting. I hope that helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 2372965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pHeJO.jpg?s=128&g=1", "display_name": "Anatolii", "link": "https://stackoverflow.com/users/2372965/anatolii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1479300739, "creation_date": 1479290416, "question_id": 40629079, "link": "https://stackoverflow.com/questions/40629079/copy-data-file-within-go-package", "title": "Copy data file within Go package?", "body": "<p>I have a Go package that links to C library using CFLAGS for cgo. C library, in turn, requires local data file to work properly. It's prebuilt 3d-party library and option to set data file path is not available.</p>\n\n<p>Everything works as expected if client of package is local and data is loaded by lib, but when I build &amp; install package, data file is not copied.</p>\n\n<p>Is there any option to put custom file near go package while installing package?</p>\n"}, {"tags": ["go", "resultset", "exit-code"], "answers": [{"tags": [], "owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": true, "score": 5, "last_activity_date": 1479290040, "last_edit_date": 1479290040, "creation_date": 1479289839, "answer_id": 40628854, "question_id": 40628760, "link": "https://stackoverflow.com/questions/40628760/can-we-write-loops-conditions-block-of-code-in-a-defer/40628854#40628854", "title": "Can we write loops/conditions/block of code in a defer?", "body": "<p>You can pass to <code>defer</code> a function call, and this can be a function literal :</p>\n\n<pre><code>defer func() {\n     if res!=nil {\n          res.Close()\n     }\n}()\n</code></pre>\n\n<p>Note that you usually avoid this problem by writing the <code>defer</code> statement right after the resource assignment.</p>\n"}], "owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 40628854, "answer_count": 1, "score": -1, "last_activity_date": 1479877942, "creation_date": 1479289640, "last_edit_date": 1479877942, "question_id": 40628760, "link": "https://stackoverflow.com/questions/40628760/can-we-write-loops-conditions-block-of-code-in-a-defer", "title": "Can we write loops/conditions/block of code in a defer?", "body": "<p>Hi I am new to golang,</p>\n\n<p>I use defer to close my result set like this.</p>\n\n<pre><code>defer res.Close() \n</code></pre>\n\n<p>I would like to check whether <code>res is nil</code> or not before calling  <code>res.Close()</code>.</p>\n\n<p>I have below code block in the end of the function but it is not invoked when exited due to some error.</p>\n\n<pre><code>if(res!=nil){\n            res.Close()\n        }\n</code></pre>\n\n<p>I would like to know is there any way I could achieve this using <code>defer</code> .</p>\n\n<pre><code>defer  if(res!=nil){\n                res.Close()\n            }\n</code></pre>\n\n<p>Also what is the Idiomatic way for handling these situations?</p>\n"}, {"tags": ["go", "aerospike"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479327162, "post_id": 40626519, "comment_id": 68514826, "body": "Does Aerospike limit the number of connections one can make?  Have you tried increading the ulimit on the machine?  Are you closing connections when you&#39;re done with them? Can you create a connection pool with a min max number of connections?"}], "answers": [{"comments": [{"owner": {"reputation": 2039, "user_id": 1709417, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/LLCY0.jpg?s=128&g=1", "display_name": "Nishant Kumar", "link": "https://stackoverflow.com/users/1709417/nishant-kumar"}, "edited": false, "score": 1, "creation_date": 1479383290, "post_id": 40653792, "comment_id": 68539308, "body": "ConnectionQueueSize is 1500. I am not using LimitConnectionsToQueueSize.  I am using commit ID : 7f3a312c3b2a60ac083ec6da296091c52c795c63 [Date:   Fri Aug 19 19:47:49 2016 +0200]"}, {"owner": {"reputation": 571, "user_id": 1049413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9dd09ead92e1b1d21895b9318f316595?s=128&d=identicon&r=PG", "display_name": "ameykpatil", "link": "https://stackoverflow.com/users/1049413/ameykpatil"}, "edited": false, "score": 0, "creation_date": 1480401318, "post_id": 40653792, "comment_id": 68934256, "body": "What are the recommended values for these attributes? What is the exact cause of this error?"}, {"owner": {"reputation": 141, "user_id": 4960414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed9229cac8ae44671f7468aa72429a5?s=128&d=identicon&r=PG&f=1", "display_name": "Khosrow Afroozeh", "link": "https://stackoverflow.com/users/4960414/khosrow-afroozeh"}, "reply_to_user": {"reputation": 2039, "user_id": 1709417, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/LLCY0.jpg?s=128&g=1", "display_name": "Nishant Kumar", "link": "https://stackoverflow.com/users/1709417/nishant-kumar"}, "edited": false, "score": 0, "creation_date": 1480852261, "post_id": 40653792, "comment_id": 69125839, "body": "@NishantKumar Please use the latest released version. 1500 connections <i>per node</i> is excessive. Rarely should you need more than 512. Using <code>LimitConnectionsToQueueSize</code> prevents the node to try making a new connection when the queue is empty and all connections are already created and in use."}, {"owner": {"reputation": 2039, "user_id": 1709417, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/LLCY0.jpg?s=128&g=1", "display_name": "Nishant Kumar", "link": "https://stackoverflow.com/users/1709417/nishant-kumar"}, "edited": false, "score": 0, "creation_date": 1497954974, "post_id": 40653792, "comment_id": 76286252, "body": "@KhosrowAfroozeh Sorry for late reply. I am still facing this issue. I ran go-client in debug mode and got this error: <code>logger: logger.go:102: Node BB9A4083AJJJ40C 10.57.115.42:3000: No available connections to the node. Connection Pool was empty, and limited to certain number of connections.</code> when i checked that particular node has high number of client connections (~15k) and other nodes has ~3-4k client connection. <code>proto-fd-max</code> in server config is 30k"}, {"owner": {"reputation": 141, "user_id": 4960414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed9229cac8ae44671f7468aa72429a5?s=128&d=identicon&r=PG&f=1", "display_name": "Khosrow Afroozeh", "link": "https://stackoverflow.com/users/4960414/khosrow-afroozeh"}, "edited": false, "score": 0, "creation_date": 1498048263, "post_id": 40653792, "comment_id": 76336334, "body": "how many clients are connected to that particular node? We have observed that sometimes hardware failures, disproportionate scan/query load and hot keys can contribute to this problem."}], "tags": [], "owner": {"reputation": 141, "user_id": 4960414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed9229cac8ae44671f7468aa72429a5?s=128&d=identicon&r=PG&f=1", "display_name": "Khosrow Afroozeh", "link": "https://stackoverflow.com/users/4960414/khosrow-afroozeh"}, "is_accepted": false, "score": 2, "last_activity_date": 1479382286, "creation_date": 1479382286, "answer_id": 40653792, "question_id": 40626519, "link": "https://stackoverflow.com/questions/40626519/aerospike-go-client-no-available-connections-to-the-node-connection-pool-was-e/40653792#40653792", "title": "Aerospike Go Client: No available connections to the node. Connection Pool was empty, and limited to certain number of connections", "body": "<p>Aerospike Go Client dev here.</p>\n\n<p>The error you are getting means that the app is using all the connections available in the pool already, and no connections are available to connect to the nodes.</p>\n\n<p>This behavior depends on the following attributes in the <em><code>ClientPolicy</code></em> when you're connecting to the database:</p>\n\n<ul>\n<li><strong><em>ConnectionQueueSize</em></strong>: determines how many connections will be pooled per node.</li>\n<li><strong><em>LimitConnectionsToQueueSize</em></strong>: Determines if an attempt should be made to connect to a node, in case the pool is empty when a connection is needed.</li>\n</ul>\n\n<p>There is also the <strong><em><code>MaxRetries</code></em></strong> attribute on <code>Read/WritePolicy</code>, which determines the number of retries.</p>\n\n<p>Which version of the go client are you using, and what are values you are passing for the above settings?</p>\n"}], "owner": {"reputation": 2039, "user_id": 1709417, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/LLCY0.jpg?s=128&g=1", "display_name": "Nishant Kumar", "link": "https://stackoverflow.com/users/1709417/nishant-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1479382286, "creation_date": 1479282167, "last_edit_date": 1479285613, "question_id": 40626519, "link": "https://stackoverflow.com/questions/40626519/aerospike-go-client-no-available-connections-to-the-node-connection-pool-was-e", "title": "Aerospike Go Client: No available connections to the node. Connection Pool was empty, and limited to certain number of connections", "body": "<p>I have 8 node Aerospike cluster. My Aerospike Go client (18 servers) sends <code>x</code> (~8k per seconds) batch request per second with batch size ~8-12. What will be Total TPS on my cluster and per Node? </p>\n\n<p>I an getting frequent error in Go client:</p>\n\n<blockquote>\n  <p>command execution timed out: Exceeded number of retries. See\n  <code>Policy.MaxRetries</code>. (last error: No available connections to the\n  node. Connection Pool was empty, and limited to certain number of\n  connections.)</p>\n</blockquote>\n\n<p>I want to check if it's because of network limitation. what could be other reasons? Total storage used is ~12-15% and there are some ~3k per second writes overall as well.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1479283298, "creation_date": 1479283298, "answer_id": 40626817, "question_id": 40626125, "link": "https://stackoverflow.com/questions/40626125/golang-unmarshal-json-cannot-unmarshal-array-into-go-value-of-type-main-moni/40626817#40626817", "title": "golang : Unmarshal: json: cannot unmarshal array into Go value of type main.MonitorServerInfo", "body": "<p>Your <code>MonitorServerInfo</code> type is the cause of the problem. Get rid of it and it works:</p>\n\n<pre><code>type ConfigServer struct {\n    ServerInfo []ServerInfoStrap `json:\"monitor_servers_info\"`\n    ConnServer SentryServer      `json:\"sentry_server\"`\n    DeadTime   string            `json:\"deadtime\"`\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Prt1j7ePCZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Prt1j7ePCZ</a>.</p>\n"}], "owner": {"reputation": 95, "user_id": 6507836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80a17bb7ecb37f2f1f0e2906b0e2c253?s=128&d=identicon&r=PG", "display_name": "Sotter.liu", "link": "https://stackoverflow.com/users/6507836/sotter-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5121, "favorite_count": 1, "accepted_answer_id": 40626817, "answer_count": 1, "score": 0, "last_activity_date": 1479283338, "creation_date": 1479280494, "last_edit_date": 1479283338, "question_id": 40626125, "link": "https://stackoverflow.com/questions/40626125/golang-unmarshal-json-cannot-unmarshal-array-into-go-value-of-type-main-moni", "title": "golang : Unmarshal: json: cannot unmarshal array into Go value of type main.MonitorServerInfo", "body": "<p>json: cannot unmarshal array into Go value of type</p>\n\n<p>config json:</p>\n\n<pre><code>{\n    \"monitor_servers_info\":[\n            {\n                \"server_info\":{\n                        \"host\":\"127.0.0.1\",\n                        \"port\":28081,\n                        \"magic\":\"magic0\",\n                        \"params\":\"all\",\n                        \"interval\":10000\n                }\n            },\n            {\n                    \"server_info\":{\n                            \"host\":\"127.0.0.1\",\n                            \"port\":28080,\n                            \"magic\":\"magic1\",\n                            \"params\":\"all\",\n                            \"interval\":10000\n                    }\n            }\n    ],\n\n    \"sentry_server\":{\n        \"host\":\"127.0.0.1\",\n        \"port\":80\n    },\n\n    \"deadtime\":\"110000\"\n}\n</code></pre>\n\n<p>and my golang code like this:</p>\n\n<pre><code>type ServerInfo struct {\n    Host string     `json:\"host\"`\n    Port int64      `json:\"port\"`\n    Magic string    `json:\"magic\"`\n    Params string   `json:\"params\"`\n    Interval int64  `json:\"interval\"`\n}\n\ntype ServerInfoStrap struct {\n    ConnInfo ServerInfo  `json:\"server_info\"`\n}\n\ntype MonitorServerInfo struct {\n    Servers []ServerInfoStrap\n}\n\ntype SentryServer struct {\n    Host string     `json:\"host\"`\n    Port int64      `json:\"port\"`\n}\n\ntype ConfigServer struct {\n    ServerInfo  MonitorServerInfo  `json:\"monitor_servers_info\"`\n    ConnServer  SentryServer       `json:\"sentry_server\"`\n    DeadTime    string             `json:\"deadtime\"`\n}\n</code></pre>\n\n<p>json parse code :</p>\n\n<pre><code>func readFile(filename string) (config ConfigServer, err error) {\n    bytes, err := ioutil.ReadFile(filename)\n    if err != nil {\n        fmt.Println(\"ReadFile: \", err.Error())\n        return\n    }\n\n    //bytes, err = StripComments(bytes) //\u53bb\u6389\u6ce8\u91ca\n    //if err != nil {\n    //  log.Info(\"Failed to strip comments from json: %s\\n\", err)\n    //  return\n    //}\n\n    //xxx := make(map[string]interface{})\n    fmt.Println(string(bytes))\n    err = json.Unmarshal(bytes, &amp;config)\n    if err != nil {\n        fmt.Println(\"Unmarshal: \", err.Error())\n        return\n    }\n\n    fmt.Println(config)\n\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "https", "request", "ip-address", "resolve"], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 5494985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9100b9db686b28ffe9637aa37a33f1?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan D.", "link": "https://stackoverflow.com/users/5494985/ryan-d"}, "edited": false, "score": 0, "creation_date": 1479570766, "post_id": 40624305, "comment_id": 68619004, "body": "Thanks, this worked well, I had to make one adjustment to convert &quot;https&quot; in the &quot;addr&quot; to &quot;443&quot;"}, {"owner": {"reputation": 293, "user_id": 5494985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9100b9db686b28ffe9637aa37a33f1?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan D.", "link": "https://stackoverflow.com/users/5494985/ryan-d"}, "edited": false, "score": 1, "creation_date": 1479946779, "post_id": 40624305, "comment_id": 68776133, "body": "@ OneOfOne I ran into an issue when specifying an IPv6 address addr=&quot;2001:558:fe0d:23::2:443&quot;, I am guessing due to confusion around the colon separator &quot;:&quot;.  I thought I saw an example where they put [] around the ipv6 addresss like this &quot;[2001:558:fe0d:23::2]:443&quot; and I thought I had this working but it failed as well. Struggling to find IPv6 examples.  Any ideas?"}, {"owner": {"reputation": 293, "user_id": 5494985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9100b9db686b28ffe9637aa37a33f1?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan D.", "link": "https://stackoverflow.com/users/5494985/ryan-d"}, "edited": false, "score": 1, "creation_date": 1479950103, "post_id": 40624305, "comment_id": 68776850, "body": "I resolved it. the &quot;[]&quot; did work for IPv6.  I forgot I was on a VPN that didn&#39;t support IPv6 when I was testing.  I turned the &quot;ip&quot; and &quot;port&quot;  into variables so I could alternate between servers. addr = &quot;[&quot; + ip + &quot;]&quot; + &quot;:&quot; + port  now works for both IPv4 and IPv6"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 293, "user_id": 5494985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9100b9db686b28ffe9637aa37a33f1?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan D.", "link": "https://stackoverflow.com/users/5494985/ryan-d"}, "edited": false, "score": 0, "creation_date": 1479964070, "post_id": 40624305, "comment_id": 68780293, "body": "@RyanD. you should update your answer with that so it would be a future reference."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 29, "last_activity_date": 1479610131, "last_edit_date": 1479610131, "creation_date": 1479271967, "answer_id": 40624305, "question_id": 40624248, "link": "https://stackoverflow.com/questions/40624248/golang-force-http-request-to-specific-ip-similar-to-curl-resolve/40624305#40624305", "title": "golang force http request to specific ip (similar to curl --resolve)", "body": "<p>You can provide a custom <a href=\"https://golang.org/pkg/net/http/#Transport\" rel=\"noreferrer\"><code>Transport.DialContext</code></a> function.</p>\n\n<pre><code>func main() {\n    dialer := &amp;net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n        DualStack: true,\n    }\n    // or create your own transport, there's an example on godoc.\n    http.DefaultTransport.(*http.Transport).DialContext = func(ctx context.Context, network, addr string) (net.Conn, error) {\n        if addr == \"google.com:443\" {\n            addr = \"216.58.198.206:443\"\n        }\n        return dialer.DialContext(ctx, network, addr)\n    }\n    resp, err := http.Get(\"https://google.com\")\n    log.Println(resp.Header, err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 293, "user_id": 5494985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9100b9db686b28ffe9637aa37a33f1?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan D.", "link": "https://stackoverflow.com/users/5494985/ryan-d"}, "is_accepted": false, "score": 4, "last_activity_date": 1479571380, "creation_date": 1479571380, "answer_id": 40694979, "question_id": 40624248, "link": "https://stackoverflow.com/questions/40624248/golang-force-http-request-to-specific-ip-similar-to-curl-resolve/40694979#40694979", "title": "golang force http request to specific ip (similar to curl --resolve)", "body": "<p>OneOfOne's answer above is excellent.   I am posting the full working package code here to make it easier for noobs like me.  I added a couple of println so that you could see the addr value before and after modification.</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    dialer := &amp;net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n        DualStack: true,\n    }\n    // or create your own transport, there's an example on godoc.\n    http.DefaultTransport.(*http.Transport).DialContext = func(ctx context.Context, network, addr string) (net.Conn, error) {\n        fmt.Println(\"address original =\", addr)\n        if addr == \"google.com:443\" {\n            addr = \"216.58.198.206:443\"\n            fmt.Println(\"address modified =\", addr)\n        }\n        return dialer.DialContext(ctx, network, addr)\n    }\n    resp, err := http.Get(\"https://google.com\")\n    log.Println(resp.Header, err)\n}\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 5494985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9100b9db686b28ffe9637aa37a33f1?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan D.", "link": "https://stackoverflow.com/users/5494985/ryan-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7557, "favorite_count": 5, "accepted_answer_id": 40624305, "answer_count": 2, "score": 19, "last_activity_date": 1479727685, "creation_date": 1479271597, "question_id": 40624248, "link": "https://stackoverflow.com/questions/40624248/golang-force-http-request-to-specific-ip-similar-to-curl-resolve", "title": "golang force http request to specific ip (similar to curl --resolve)", "body": "<p>How can I force a golang https get request to use a specific IP address.  I want to skip DNS resolution and provide the IP myself.  The equivalent in curl would be a --resolve as illustrated below.</p>\n\n<p>curl <a href=\"https://domain.com/dir/filename\" rel=\"noreferrer\">https://domain.com/dir/filename</a> --resolve \"domain.com:443:10.10.10.10\"</p>\n\n<p>Since this is ssl I want to avoid substituting in the IP for the domain as in the following example.</p>\n\n<p>curl <a href=\"https://10.10.10.10/dir/filename\" rel=\"noreferrer\">https://10.10.10.10/dir/filename</a> --header \"Host: domain.com\"</p>\n"}, {"tags": ["go", "methods", "logic", "conceptual", "repeat"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1479268034, "post_id": 40623482, "comment_id": 68481294, "body": "I recommend you this reading <a href=\"https://www.goinggo.net/2016/10/reducing-type-hierarchies.html\" rel=\"nofollow noreferrer\">goinggo.net/2016/10/reducing-type-hierarchies.html</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1479352794, "post_id": 40623482, "comment_id": 68524044, "body": "It depends on what you expect to do with <code>isLight()</code>. For a hard-coded size, I&#39;d use a function since it would scale across various types satisfying the <code>file</code> interface, and there would be a consistent definition of what &quot;light&quot; means. If you define it as a method, all types wanting to satisfy the <code>file</code> interface would need to define the implementation of <code>isLight()</code> method. Varying definitions of what constitutes &quot;light&quot; might arise if you use a method, but that might be desirable. A 10 MB video might be &quot;light&quot; for example while a 10 MB &quot;plain text&quot; file could be a few sections of a book."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1479352925, "post_id": 40623482, "comment_id": 68524073, "body": "You might also define a method that returns a value that constitutes what the maximum size of a &quot;light&quot; file could be, and a plain <code>isLight(f file) bool</code> function could use that method in combination with the <code>size()</code> method to return, e.g., <code>f.size() &lt; f.maxLight()</code>. This would allow you to define the behavior of <code>isLight()</code> as a function, unlike a method defined on the <code>file</code> interface, while still allowing the flexibility of the method."}], "owner": {"reputation": 332, "user_id": 3610070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GVKt.png?s=128&g=1", "display_name": "Charlyzzz", "link": "https://stackoverflow.com/users/3610070/charlyzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1479283359, "creation_date": 1479266102, "question_id": 40623482, "link": "https://stackoverflow.com/questions/40623482/logic-distribution-in-go", "title": "Logic distribution in GO", "body": "<p>I was playing arround in Go and stumbled upon this dilemma:</p>\n\n<p><i>(Keep in mind that this is purely conceptual and my goal is try to minize logic repetition and so)</i></p>\n\n<p>Imagine I had to model two type of files: binary and text. First, each should know how to calculate their size, so I declared two structs and their methods</p>\n\n<pre><code>type file interface {\n size() int\n ...\n}\n\ntype text struct {\n ...\n}\n\nfunc (t text) size() int {\n...\n}\n\ntype binary struct {\n ...\n}\n\nfunc (b binary) size() int {\n...\n}\n</code></pre>\n\n<p>So far, so good. The next requirement is to check if they are light (their size is less than some fixed size). In OOP I would use a superclass to avoid repetition, but since I need access to <code>size()</code> method, I can't use a struct and embeed it.</p>\n\n<p>I have two possible options:</p>\n\n<ul>\n<li><p>Define a function <code>isLight(f file) bool</code>, but this kind of ruin the interface because it wont show that files should know if they are light.</p></li>\n<li><p>Try to mimic some OOP composition, but the resulting code looks less readable than it should (perhaps not in the snippet, but adding some more methods make it looks like 'middle man' code smell because content only redirects the message to the corresponding struct)</p></li>\n</ul>\n\n<pre><code>    type file interface {\n     size() int\n     isLight() bool\n    }\n\n    type typeOfContent interface {\n     size() int     \n    }\n\n    type content struct {\n     file\n     type typeOfContent\n    }\n\n    func (c content) size() int {\n     return type.size()\n    }\n\n    func (c content) isLight() int {\n     return c.size() &lt; 100\n    }\n</code></pre>\n\n<p>Which is the 'Go way' of doing this?</p>\n\n<p>Cheers!</p>\n\n<p>Erwin</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1479264939, "post_id": 40622459, "comment_id": 68480566, "body": "I&#39;m not sure what you mean by &quot;the array is key-less&quot;, or what the problem is. Your example code works: <a href=\"https://play.golang.org/p/zbybX0tnRB\" rel=\"nofollow noreferrer\">play.golang.org/p/zbybX0tnRB</a>"}, {"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "edited": false, "score": 2, "creation_date": 1479269319, "post_id": 40622459, "comment_id": 68481605, "body": "@nik-kunkel your example code works fine, take a look <a href=\"https://play.golang.org/p/743MBHL3Y4\" rel=\"nofollow noreferrer\">play.golang.org/p/743MBHL3Y4</a>. My best guss is that your body is not right. probably what you are reading from body is not that data."}, {"owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479308572, "post_id": 40622459, "comment_id": 68503030, "body": "@JimB and Nik are right,  maybe you should try writing to stdout/file the body you&#39;re retrieving and check if all the elements of the array are consistent with the type you&#39;re trying to decode into."}, {"owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "edited": false, "score": 0, "creation_date": 1479309031, "post_id": 40622459, "comment_id": 68503378, "body": "I wrote a modification of your code for better understanding: <a href=\"https://play.golang.org/p/aoqjYyjuXT\" rel=\"nofollow noreferrer\">play.golang.org/p/aoqjYyjuXT</a>"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "edited": false, "score": 0, "creation_date": 1479260415, "post_id": 40622622, "comment_id": 68479366, "body": "This was actually a mistake I made when creating this post, to minimize the amount of code I had to post. In the Unmarshall function the second parameter is in fact a variable for TradeHistoryResponse.  Note that I&#39;ve edited the original post to reflect this."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 0, "last_activity_date": 1479259895, "creation_date": 1479259895, "answer_id": 40622622, "question_id": 40622459, "link": "https://stackoverflow.com/questions/40622459/how-to-unmarshall-key-less-json-array-in-golang-correctly/40622622#40622622", "title": "How to Unmarshall key-less JSON array in Golang correctly?", "body": "<p><strong>TradeHistoryResponse</strong> is a type no a variable, you have to create a var of type TradeHistoryResponse, like this:</p>\n\n<pre><code>var th TradeHistoryResponse\n\n//Convert JSON to struct\nerr = json.Unmarshal(body, &amp;th)\n// ...\n\nfmt.Printf(\"%+v\\n\", th)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "edited": false, "score": 0, "creation_date": 1479323090, "post_id": 40625273, "comment_id": 68512559, "body": "You are correct with your theory the body didn&#39;t contain the correct data. I had implemented a method to catch the server returning errors, but it doesn&#39;t seem to be working. After further review it seems the server was returning an error because the URL parameters weren&#39;t being encoded correctly."}], "tags": [], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "is_accepted": true, "score": 1, "last_activity_date": 1479276972, "creation_date": 1479276972, "answer_id": 40625273, "question_id": 40622459, "link": "https://stackoverflow.com/questions/40622459/how-to-unmarshall-key-less-json-array-in-golang-correctly/40625273#40625273", "title": "How to Unmarshall key-less JSON array in Golang correctly?", "body": "<p>I didn't think unmarhsalling an array in a JSON like you intended actually works but to the props of encoding/json it does. Example code:\npackage main</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\nvar mjs string = \"[\" +\n    \"{\" +\n    `\"globalTradeID\": 64201000,\n                          \"tradeID\": 549285,\n                          \"date\": \"2016-11-11 23:51:58\",\n                          \"type\": \"buy\",\n                          \"rate\": \"10.33999779\",\n                          \"amount\": \"0.02176472\",\n                          \"total\": \"0.22504715\"\n                        },\n                        {\n                          \"globalTradeID\": 64200631,\n                          \"tradeID\": 549284,\n                          \"date\": \"2016-11-11 23:48:39\",\n                          \"type\": \"buy\",\n                          \"rate\": \"10.33999822\",\n                          \"amount\": \"0.18211700\",\n                          \"total\": \"1.88308945\"\n                        }\n                        ]`\n\ntype TradeHistoryResponse []TradeHistoryInfo\n\ntype TradeHistoryInfo struct {\n    GlobalTradeID int64   `json:\"globalTradeID\"`\n    TradeID       int64   `json:\"tradeID\"`\n    Date          string  `json:\"date\"`\n    Type          string  `json:\"type\"`\n    Rate          float64 `json:\"rate,string\"`\n    Amount        float64 `json:\"amount,string\"`\n    Total         float64 `json:\"total,string\"`\n}\n\nfunc main() {\n\n    //Convert JSON to struct\n\n    var THR TradeHistoryResponse\n    err := json.Unmarshal([]byte(mjs), &amp;THR)\n    if err != nil {\n    log.Fatal(err)\n    }\n  for _, v := range THR {\n    fmt.Printf(\"%+v\", v)\n    fmt.Printf(\"\\n\")\n  }\n}\n</code></pre>\n\n<p>This prints out all the values as expected. So it doesn't have a problem converting the json values to float/int either (which would have been my second guess).</p>\n\n<p>Are you sure you aren't modifying the Body in any way ? And that the example you give cover all edge cases ?</p>\n\n<p>Could you add:</p>\n\n<pre><code>fmt.Println(string(body)) \n</code></pre>\n\n<p>to the second error block and log the error it give here.</p>\n\n<p>Also what version of go are you using ? I wouldn't exclude the possibility of encoding/json to have changed between versions. In the end, if this is indeed the case the easy fix would be taking your response as a string, removing all whitespaces and splitting at \"}'{\" as in:</p>\n\n<pre><code>fmtBody := strings.Replace(string(body), \"\\n\", \"\", -1)\nfmtBody = strings.Replace(string(fmtBody), \"\\w\", \"\", -1)\nfmtBody = strings.Replace(string(fmtBody), \"[\", \"\", -1)\nfmtBody = strings.Replace(string(fmtBody), \"]\", \"\", -1)\nvar goArrOfYourJsonsObj []String = strings.Split(fmtBody, \"},{\")\nfor k, _ := range goArrOfYourJsonsObj {\n  goArrOfYourJsonsObj[k] += \"}\"\n}\n</code></pre>\n\n<p>And now you have your JSON objects neatly separated into a go array of types String which, can be used in Unmarshall as []byte(val).</p>\n"}], "owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 40625273, "answer_count": 2, "score": 0, "last_activity_date": 1479276972, "creation_date": 1479258575, "last_edit_date": 1479260552, "question_id": 40622459, "link": "https://stackoverflow.com/questions/40622459/how-to-unmarshall-key-less-json-array-in-golang-correctly", "title": "How to Unmarshall key-less JSON array in Golang correctly?", "body": "<p>I have JSON data which looks like this:</p>\n\n<pre><code>[\n  {\n    \"globalTradeID\": 64201000,\n    \"tradeID\": 549285,\n    \"date\": \"2016-11-11 23:51:58\",\n    \"type\": \"buy\",\n    \"rate\": \"10.33999779\",\n    \"amount\": \"0.02176472\",\n    \"total\": \"0.22504715\"\n  },\n  {\n    \"globalTradeID\": 64200631,\n    \"tradeID\": 549284,\n    \"date\": \"2016-11-11 23:48:39\",\n    \"type\": \"buy\",\n    \"rate\": \"10.33999822\",\n    \"amount\": \"0.18211700\",\n    \"total\": \"1.88308945\"\n  }...\n]\n</code></pre>\n\n<p>I've tried to unmarshall this JSON by defining a type:</p>\n\n<pre><code>type TradeHistoryResponse   []TradeHistoryInfo\n\ntype TradeHistoryInfo struct {\n    GlobalTradeID   int64   `json:\"globalTradeID\"`\n    TradeID         int64   `json:\"tradeID\"`\n    Date            string  `json:\"date\"`\n    Type            string  `json:\"type\"`\n    Rate            float64 `json:\"rate,string\"`\n    Amount          float64 `json:\"amount,string\"`\n    Total           float64 `json:\"total,string\"`\n}\n</code></pre>\n\n<p>And then pulling the JSON data as so:</p>\n\n<pre><code>    //Read response\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return nil, fmt.Errorf(\"[Poloniex] (doRequest) Failed to parse response for query to %s! (%s)\", reqURL, err.Error())\n    } \n\n    //Convert JSON to struct\n\n    var THR TradeHistoryResponse\n    err = json.Unmarshal(body, &amp;THR)\n    if err != nil {\n        return nil, fmt.Errorf(\"[Poloniex] (doRequest) Failed to convert response into JSON for query to %s! (%s)\", reqURL, err.Error())\n    }\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>(json: cannot unmarshal object into Go value of type poloniex.TradeHistoryResponse)\n</code></pre>\n\n<p>My best guess why the Unmarshall doesn't work is because the array is key-less? </p>\n\n<p>Would love to have some clarification on the matter on how I might best get this working.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 20516, "user_id": 381588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cff6fe4f2e32e4ae131e65a0fda7f88?s=128&d=identicon&r=PG", "display_name": "Iridium", "link": "https://stackoverflow.com/users/381588/iridium"}, "edited": false, "score": 1, "creation_date": 1479256660, "post_id": 40622131, "comment_id": 68478420, "body": "Hopefully it&#39;s also clear that a brute-force approach isn&#39;t the best way to solve the problem, concurrently or otherwise."}], "answers": [{"tags": [], "owner": {"reputation": 1837, "user_id": 381849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d44bcf5700e4fcb934221db2dab496?s=128&d=identicon&r=PG", "display_name": "KAdot", "link": "https://stackoverflow.com/users/381849/kadot"}, "is_accepted": true, "score": 1, "last_activity_date": 1479265964, "last_edit_date": 1479265964, "creation_date": 1479264569, "answer_id": 40623277, "question_id": 40622131, "link": "https://stackoverflow.com/questions/40622131/correct-the-implemention-of-my-goroutines/40623277#40623277", "title": "Correct the implemention of my goroutines", "body": "<p>It doesn't make sense to launch unlimited number of goroutines - it will be performing worse, than non-concurrent solution. You can try to use a \"worker pool\" pattern and batch the calculations.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc divide(num int) bool {\n    for i := 1; i &lt;= 20; i++ {\n        if num%i != 0 {\n            return false\n        }\n    }\n    return true\n}\n\nconst step = 100000\n\nfunc main() {\n    result := make(chan int)\n    jobs := make(chan int)\n    for w := 0; w &lt; runtime.NumCPU(); w++ {\n        go func() {\n            for n := range jobs {\n                for i := n; i &lt; n+step; i++ {\n                    if divide(i) {\n                        result &lt;- i\n                    }\n                }\n            }\n        }()\n    }\n    num := 1\n    for {\n        select {\n        case jobs &lt;- num:\n            num += step\n        case x := &lt;-result:\n            fmt.Println(\"Smallest number is:\", x)\n            return\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "is_accepted": false, "score": 1, "last_activity_date": 1479287889, "creation_date": 1479287889, "answer_id": 40628133, "question_id": 40622131, "link": "https://stackoverflow.com/questions/40622131/correct-the-implemention-of-my-goroutines/40628133#40628133", "title": "Correct the implemention of my goroutines", "body": "<p>A different approach to your problem would be filters. The idea is to chain a bunch of goroutines with channels and make them filter all values that don't pass some test. In your case you want to filter numbers that are not evenly divisible by some number. This is how it looks:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    in := make(chan int)\n    tmp := in\n    // Create filter-goroutines\n    for i := 1; i &lt;= 20; i++ {\n        tmp = makeDivisor(i, tmp)\n    }\n\n    running := true\n\n    // Now feed in all the numbers...\n    for i := 1; running; i++ {\n        select {\n\n        // Check if a number passed all filters.\n        case k := &lt;-tmp:\n            fmt.Printf(\"Answer is %d\\n\", k)\n            close(in)\n            running = false\n\n        // Otherwise feed in the next.\n        case in &lt;- i:\n        }\n    }\n\n}\n\nfunc makeDivisor(n int, c chan int) chan int {\n    cc := make(chan int)\n    go func() {\n        for i := range c {\n            if i%n == 0 {\n                cc &lt;- i\n            }\n        }\n        close(cc)\n    }()\n    return cc\n}\n</code></pre>\n\n<p>Here it is on the <a href=\"https://play.golang.org/p/bL9Fev-Hbh\" rel=\"nofollow noreferrer\">playground</a>. (Note that the playground won't work with 20 filters, but try it locally too.)</p>\n\n<p>Note that the first filters have much more work to do than the ones further into the chain. You could launch more of the first filters to solve this, although the integer-division is pretty fast and this whole thing might be limited by channel communication at the moment.</p>\n\n<p>Does it work?</p>\n\n<blockquote>\n  <p>Answer is 232792560</p>\n</blockquote>\n\n<p>Yes.</p>\n"}], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 40623277, "answer_count": 2, "score": 0, "last_activity_date": 1479287889, "creation_date": 1479256179, "last_edit_date": 1479287869, "question_id": 40622131, "link": "https://stackoverflow.com/questions/40622131/correct-the-implemention-of-my-goroutines", "title": "Correct the implemention of my goroutines", "body": "<p><strong>Background:</strong> I am trying to implement a logic which find the smallest positive number that is evenly divisible by all of the numbers from 1 to 20. I have implemented a sequential version and got an answer as 232792560.</p>\n\n<p><strong>Question:</strong> When I try to build some concurrency on this problem ( see uncommented block of code), it does run but never shows any result. Can anyone of you guide me on where I am going wrong?</p>\n\n<p><strong>Note</strong>: I am very much new to golang; and I am aware that, this is not the best problem for concurrency since there is no guarantee that I will have the smallest positive number as first result. However, I tried it out of my curiosity.</p>\n\n<pre><code>    package main\n\n    import(\n        \"fmt\"\n    )\n\n    func divide(num int) bool {\n        for i := 1; i &lt;= 20; i++ {\n            if num % i != 0 {\n                return false\n            }\n        }\n        return true\n    }\n\n    func main() {\n        num:=0\n        //simple function\n        /*for {\n            num++;\n            result := divide(num)\n                if result {\n                    fmt.Println(\"Smallest number is: \", num)\n                    break\n                }\n            }*/\n\n\n        //go-routine\n        //go-routine\n    var wg sync.WaitGroup\n    for {\n        num++;\n        wg.Add(1)\n        go func(x int) {\n            result := divide(x)\n            if result {\n                fmt.Println(\"Smallest number is: \", x)\n                defer wg.Done()\n            }\n\n        }(num)\n\n    }\n    wg.Wait()\n  fmt.Println(\"End.\")\n\n }\n</code></pre>\n"}, {"tags": ["vim", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1479245366, "post_id": 40619632, "comment_id": 68474256, "body": "Read (and follow) <a href=\"https://golang.org/doc/code.html#Organization\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#Organization</a>."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1479247322, "post_id": 40619632, "comment_id": 68475218, "body": "It&#39;s just a simple question, do I want to make a project <b>go get</b>-able ? if yes you should follow the hierarchy in your GOPATH"}], "answers": [{"comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1479272313, "post_id": 40619826, "comment_id": 68482407, "body": "It&#39;s more like <code>$domain&#47;$pathname</code>. If you use GitHub, this means <code>$provider&#47;$username&#47;$project</code>, but this is in no way enforced or even &quot;recommended&quot; as such. e.g. I use my own domain for packages which doesn&#39;t follow this convention."}], "tags": [], "owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "is_accepted": true, "score": 3, "last_activity_date": 1479246061, "last_edit_date": 1479246061, "creation_date": 1479244627, "answer_id": 40619826, "question_id": 40619632, "link": "https://stackoverflow.com/questions/40619632/setting-up-environment-gopath/40619826#40619826", "title": "Setting up environment - $GOPATH", "body": "<ol>\n<li><p>You should follow the convention of <code>$GOPATH/src/REPOSITORY_PROVIDER/USERNAME/PROJECT</code>. So, if your <code>virtual_tree</code> project resides in github, then you should locate it in <code>$GOPATH/src/github.com/naz/virtual_tree</code>.</p></li>\n<li><p>The <code>pkg</code> directory contains the compiled packages. Within that directory a sub-directory that describes the target architecture is created and that mirrors the source directories.</p></li>\n</ol>\n\n<p>Read more on:</p>\n\n<p><a href=\"https://dave.cheney.net/2014/12/01/five-suggestions-for-setting-up-a-go-project\" rel=\"nofollow noreferrer\">https://dave.cheney.net/2014/12/01/five-suggestions-for-setting-up-a-go-project</a></p>\n\n<p><a href=\"https://www.goinggo.net/2013/07/how-packages-work-in-go-language.html\" rel=\"nofollow noreferrer\">https://www.goinggo.net/2013/07/how-packages-work-in-go-language.html</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2580104"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 40619826, "answer_count": 1, "score": 1, "last_activity_date": 1479246061, "creation_date": 1479243754, "question_id": 40619632, "link": "https://stackoverflow.com/questions/40619632/setting-up-environment-gopath", "title": "Setting up environment - $GOPATH", "body": "<p>I have defined my <code>$GOPATH</code> to be <code>$HOME/go</code> and when using vim-go, it has installed several binaries (using :GoInstallBinaries) into that folder. Now the structure is similar to:</p>\n\n<pre><code>--go/\n----bin/\n------ list of binaries\n\n----pkg/\n------linux_amd64\n--------- list of other directories\n\n----src/\n------github.com\n--------several other directories, similar with ones below\n------golang.org\n------gopg.in\n</code></pre>\n\n<p>I'm confused now where to start my own project within this structure? Say I wanted to create my own project virtual_tree, from what I understand it should be under src. But should that be inside of github.com? Where should my project go? Do I need to use <code>pkg/</code> for anything? I understand that <code>bin/</code> contains the executable for the project. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["javascript", "rest", "reactjs", "go", "cors"], "answers": [{"tags": [], "owner": {"reputation": 692, "user_id": 6221850, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3AiUO.jpg?s=128&g=1", "display_name": "Tuco", "link": "https://stackoverflow.com/users/6221850/tuco"}, "is_accepted": true, "score": 1, "last_activity_date": 1479312443, "creation_date": 1479312443, "answer_id": 40636834, "question_id": 40619173, "link": "https://stackoverflow.com/questions/40619173/using-cors-in-golang-server-made-with-kami/40636834#40636834", "title": "Using CORS in golang server made with kami", "body": "<p>I just had to create a cors object and pass its handler as middleware to kami:</p>\n\n<pre><code>c := cors.New(cors.Options{\n    AllowedOrigins: []string{\"http://localhost:3000\"},\n    AllowCredentials: true,\n})\n\nkami.Use(\"/api/\", c.Handler)\n</code></pre>\n\n<p>This let's me make requests now. </p>\n"}], "owner": {"reputation": 692, "user_id": 6221850, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3AiUO.jpg?s=128&g=1", "display_name": "Tuco", "link": "https://stackoverflow.com/users/6221850/tuco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 2, "accepted_answer_id": 40636834, "answer_count": 1, "score": 3, "last_activity_date": 1479312443, "creation_date": 1479241971, "last_edit_date": 1479310440, "question_id": 40619173, "link": "https://stackoverflow.com/questions/40619173/using-cors-in-golang-server-made-with-kami", "title": "Using CORS in golang server made with kami", "body": "<p>Hello I'm trying to access a GET request on a Golang api running on localhost:8000 from a ReactJS web app running on localhost:3000. But whenever I try to do this, I get the following error:</p>\n\n<pre><code>Fetch API cannot load http://localhost:8000/api/v1/systems.\nNo 'Access-Control-Allow-Origin' header is present on the requested resource. \nOrigin 'http://localhost:3000' is therefore not allowed access. The response had HTTP status code 401. \nIf an opaque response serves your needs, set the request's mode to 'no-cors' to fetch the resource with CORS disabled. \n</code></pre>\n\n<p>Here's a snippet of my Go server code:</p>\n\n<pre><code>func main() {\n    session, err := mgo.Dial(mongoURI())\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer session.Close()\n\n    systemsC := session.DB(\"\").C(\"systems\")\n\n    flag.Parse()\n    ctx := context.Background()\n    kami.Context = ctx\n\n    kami.Use(\"/api/\", httpauth.SimpleBasicAuth(os.Getenv(\"BASIC_USERNAME\"), os.Getenv(\"BASIC_PASSWORD\")))\n\n...\n\n    kami.Get(\"/api/v1/systems\", func(ctx context.Context, w http.ResponseWriter, r *http.Request) {\n        systems := []alpha.System{}\n        systemsMap := map[string][]alpha.System{}\n\n        err := systemsC.Find(nil).All(&amp;systems)\n        if err != nil {\n            log.Println(err.Error())\n            http.Error(w, err.Error(), 404)\n        }\n        systemsMap[\"systems\"] = systems\n\n        err = json.NewEncoder(w).Encode(&amp;systemsMap)\n        if err != nil {\n            http.Error(w, err.Error(), 500)\n        }\n        w.Header().Set(\"Content-Type\", \"application/json\")\n    })\n\n    kami.Serve()\n}\n</code></pre>\n\n<p>Here's the ReactJS code I'm using to make the GET request:</p>\n\n<pre><code>componentDidMount() {\n    fetch('http://localhost:8000/api/v1/systems') \n    .then(function(response) {\n        return response.json()\n    }).then(function(data) {\n        this.setState({ data }, () =&gt; console.log(this.state));\n    });\n}\n</code></pre>\n\n<p>The complete URL requires credentials: <code>http://user:password@localhost:8000/api/v1/systems</code></p>\n\n<p>I've tried adding various headers to my <a href=\"https://github.com/guregu/kami\" rel=\"nofollow noreferrer\" title=\"kami\">kami</a>.Get function, but keep getting the same error:</p>\n\n<pre><code>w.Header().Set(\"Access-Control-Allow-Origin\", \"*\") //This header doesn't work when credentials are sent\n</code></pre>\n\n<p>Also tried these to no avail: </p>\n\n<pre><code>w.Header().Set(\"Access-Control-Allow-Origin\", r.Header.Get(\"Origin\"))\nw.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, DELETE\")\nw.Header().Set(\"Access-Control-Allow-Headers\", \"Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization\")\n</code></pre>\n\n<p>Right now I'm trying to use <a href=\"https://github.com/rs/cors\" rel=\"nofollow noreferrer\" title=\"rs/cors\">rs/cors</a>, but not sure on how to add it to my code. Do I only need these 3 lines of code:</p>\n\n<pre><code>mux := http.NewServeMux()\nhandler := cors.Default().Handler(mux)\nhttp.ListenAndServe(\":8080\", handler)\n</code></pre>\n\n<p>Not really sure how to mix mux, kami and cors, any help is appreciated, thank you!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Maybe a much simpler question would be if anyone knows how to integrate <a href=\"https://github.com/rs/cors\" rel=\"nofollow noreferrer\" title=\"rs/cors\">cors</a> with <a href=\"https://github.com/guregu/kami\" rel=\"nofollow noreferrer\" title=\"kami\">kami</a>. I think this could fix my problem, just can't figure out how to use them together.</p>\n"}, {"tags": ["http", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1479279738, "last_edit_date": 1479279738, "creation_date": 1479244852, "answer_id": 40619878, "question_id": 40619171, "link": "https://stackoverflow.com/questions/40619171/go-http-post-file/40619878#40619878", "title": "Go http POST file", "body": "<p>Use <a href=\"https://godoc.org/mime/multipart#Writer\" rel=\"nofollow noreferrer\">multipart.Writer</a> to create the request body:</p>\n\n<pre><code> var buf bytes.Buffer\n mpw := multipart.NewWriter(&amp;buf)\n w, err := mpw.CreateFormFile(\"source_file\", \"portrait.gif\")\n if err != nil {\n    // handle error\n }\n if _, err := w.Write(imageBytes); err != nil {\n    // handle error\n }\n if err := mpw.WriteField(\"target_format\", \"png\"); err != nil {\n   // handle error\n }\n if err := mpw.Close(); err != nil {\n    // handle error\n }\n\n req, err := http.NewRequest(\"GET\", \"https://sandbox.zamzar.com/v1/jobs\", &amp;buf)\n req.Header.Set(\"Content-Type\", mpw.FormDataContentType())\n\n ... continue as before.\n</code></pre>\n"}], "owner": {"reputation": 2544, "user_id": 2734665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/7GwAG.jpg?s=128&g=1", "display_name": "Mati Tucci", "link": "https://stackoverflow.com/users/2734665/mati-tucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 0, "accepted_answer_id": 40619878, "answer_count": 1, "score": 1, "last_activity_date": 1479290754, "creation_date": 1479241964, "last_edit_date": 1479290754, "question_id": 40619171, "link": "https://stackoverflow.com/questions/40619171/go-http-post-file", "title": "Go http POST file", "body": "<p>I'm really new in Go and I have to integrate <a href=\"https://developers.zamzar.com/docs\" rel=\"nofollow noreferrer\">Zamzar</a> in a Go microservice. I need to <code>POST</code> a file and a data type (string).</p>\n\n<p>Doing a <code>curl</code> looks like this:</p>\n\n<p><code>curl https://sandbox.zamzar.com/v1/jobs \\\n -u user:pass \\\n -X POST \\\n -F \"source_file=@/tmp/portrait.gif\" \\\n -F \"target_format=png\"\n</code></p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>client := &amp;http.Client{}\n\nreq, err := http.NewRequest(\"GET\", \"https://sandbox.zamzar.com/v1/jobs\", nil)\n\nreq.SetBasicAuth(\"user\", \"pass\")\n\nresp, err := client.Do(req)\n\nif err != nil {\n  fmt.Printf(\"Error : %s\", err)\n} else {\n  fmt.Println(resp)\n}\n</code></pre>\n\n<p>How can I send the <code>target_format</code> as a string and <code>source_file</code> as a file? <strong>I already have the file (<code>[]byte</code>)</strong></p>\n"}, {"tags": ["unit-testing", "testing", "go", "architecture", "coveralls"], "comments": [{"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 2, "creation_date": 1479289262, "post_id": 40615641, "comment_id": 68490257, "body": "OK, so -3 points, and no comments. How can this question be improved? It appears to address a specific problem (without being constrained to one particular program)l, has a small reproducible example (which is exactly the same as the go team&#39;s recommended example)."}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1479745519, "post_id": 40615641, "comment_id": 68676705, "body": "Would excluding the fucntion from the coverage test be ok ? (I assume not, but just in case)"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 1, "creation_date": 1479745602, "post_id": 40615641, "comment_id": 68676756, "body": "@Tensibai, no the result that I want to achieve is to ensure I get a full coverage test. In reality in any case what I am checking is coverage for particular lines (and their checks) within existing functions which do (e.g.) <code>log.Fatalf</code>, so excluding the entire function would be substantially worse than the current position."}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1479747406, "post_id": 40615641, "comment_id": 68678010, "body": "My ruby feeling would be to stub the os.Exit function and test a return value instead of an exit... but that&#39;s probably out of scope (digging into GO coverage)"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1479747651, "post_id": 40615641, "comment_id": 68678154, "body": "@Tensibai I don&#39;t think you can do that where (e.g.) <code>os.Exit()</code> is called by <code>log.Fatalf()</code> etc., as you&#39;d have to make the return value pass all the way up. That would be substantial changes to the go source code, as well as to the tested application. Making <code>os.Exit()</code> panic and using <code>recover</code> might help slightly, but would be suboptimal if recover was being used internally."}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1479809952, "post_id": 40615641, "comment_id": 68704265, "body": "After a bunch of research, best approach seems to refactor code, using custom functions for exit and log, so you can stub them in test. Sources <a href=\"http://stackoverflow.com/a/30690532/3627607\">This answer</a> and for log.Fatalf <a href=\"http://stackoverflow.com/a/39817424/3627607\">this one</a>. Sorry but even looking to interfaces from <a href=\"https://deferpanic.com/blog/golang-testing-for-rubyists/\" rel=\"nofollow noreferrer\">here</a> I can&#39;t see a proper solution as cover &quot;count&quot; in the current process if statement was called <a href=\"https://github.com/golang/go/blob/0104a31b8fbcbe52728a08867b26415d282c35d2/src/cmd/cover/cover.go#L162\" rel=\"nofollow noreferrer\">source here</a>"}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1479810033, "post_id": 40615641, "comment_id": 68704339, "body": "FWIW I even tried with a TestMain, this simplify a little the test case for the Crash one, but this doesn&#39;t help as relaunching is needed and the &quot;visit&quot; interface is never called within the current test process."}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1479844662, "post_id": 40615641, "comment_id": 68726974, "body": "@Tensibai I can&#39;t see how you can make that (refactoring <code>log.Fatalf</code> work) - you can&#39;t call <code>t.</code> functions (pass/fail) within other threads than the main test thread. I think you&#39;d have to do pretty serious code surgery, which rather gets you away from a coverage test. I suspect the answer is somehow to detect the coverage test, then run the test case with <code>-cover</code> and somehow merge the outputs - i.e. run the <code>visit</code> interface twice. <code>goveralls</code> already does some merging."}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1479845031, "post_id": 40615641, "comment_id": 68727200, "body": "The main idea is to replace native log.x calls by customs Mylog.x call, then you can override (stub/mock) Mylog.x in your test cases to return without exiting the test process. I may write an answer in this way if you think it could be of help, but that would be copying a bunch from the other answers."}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1479845152, "post_id": 40615641, "comment_id": 68727283, "body": "The point is rewriting your code to never call log.Fatalf directly but always through a wrapper you can stub to avoid the exit and just return."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1479877565, "post_id": 40615641, "comment_id": 68738263, "body": "TL;DR: go library isn&#39;t quite designed for testability at the moment. The cleanest approach would be to tweak your version of Go library to fix the issue. If you control your test environment, this will not be a problem. You don&#39;t need the testability improvement patches on production machines."}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "edited": false, "score": 0, "creation_date": 1479985538, "post_id": 40615641, "comment_id": 68792071, "body": "Some one had a similar issue check this answer if you think it is oke i will put an answer <a href=\"http://stackoverflow.com/questions/39690509/showing-coverage-of-functional-tests-without-blind-spots/39891957#39891957\" title=\"showing coverage of functional tests without blind spots\">stackoverflow.com/questions/39690509/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "is_accepted": false, "score": 0, "last_activity_date": 1479987111, "last_edit_date": 1592644375, "creation_date": 1479987111, "answer_id": 40785321, "question_id": 40615641, "link": "https://stackoverflow.com/questions/40615641/testing-os-exit-scenarios-in-go-with-coverage-information-coveralls-io-goverall/40785321#40785321", "title": "Testing os.Exit scenarios in Go with coverage information (coveralls.io/Goveralls)", "body": "<p>It not common practice to put tests around the <code>Main</code> function of an application in <code>GOLANG</code> specifically because of issues like that. There was a question that is already answered that touched this same issue.</p>\n<blockquote>\n<p><a href=\"https://stackoverflow.com/questions/39690509/showing-coverage-of-functional-tests-without-blind-spots/39891957#39891957\">showing coverage of functional tests without blind spots</a></p>\n</blockquote>\n<h2>To Summarize</h2>\n<p>To summarize it you should avoid putting tests around the main entry point of the application and try to design your application in way that little code is on the <code>Main</code> function so it decoupled enough to allow you to test as much of your code as possible.</p>\n<p>Check <a href=\"https://golang.org/pkg/testing\" rel=\"nofollow noreferrer\">GOLANG Testing</a> for more information.</p>\n<h3>Coverage to 100%</h3>\n<p>As I detailed on on the previous answer since is a bad idea to try getting tests around the <code>Main</code> func and the best practice is to put as little code there as possible so it can be tested properly with out blind spots it stands to reason that trying to get 100% coverage while trying to include the <code>Main</code> func is wasted effort so it better to ignore it in the tests.</p>\n<p>You can use build tags to exclude the <code>main.go</code> file from the tests therefore reaching your <strong>100%</strong> coverage or <strong>all green</strong>.</p>\n<p>Check: <a href=\"https://stackoverflow.com/questions/39690509/showing-coverage-of-functional-tests-without-blind-spots/39891957#39891957\">showing coverage of functional tests without blind spots</a></p>\n<p>If you design your code well and keep all the actual functionality well decoupled and tested having a few lines of code that do very little other then calling the actual pieces of code that do all the actual work and are well tested it does't really matter that you are not testing a tiny and not significant code.</p>\n"}, {"comments": [{"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1480254103, "post_id": 40801733, "comment_id": 68876963, "body": "Interesting. However <code>osExit</code> no longer stops the execution flow (as <code>os.Exit()</code> did), which may give false negatives (i.e. things shown as covered in the coverage test which wouldn&#39;t normally be) and other issues. I wonder whether <code>myFatalF</code> could instead the failure into a channel (then block), <code>Crasher()</code> could be in its own goroutine, and the main goroutine could call <code>t.Fail()</code> on reception of an error on the channel. It&#39;s a shame this can&#39;t be done without rewriting the code though."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1480332516, "post_id": 40801733, "comment_id": 68903370, "body": "@abligh I agree, if there are statements after an <code>os.Exit()</code> call, normally they wouldn&#39;t get executed, but in this test they would be. This can be avoided by not writing such code (it wouldn&#39;t make sense anyway)."}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1480333947, "post_id": 40801733, "comment_id": 68904183, "body": "@izca The problem is code like <code>if foo.IsBroken() {log.Fatalf(&quot;The foo is broken&quot;)}</code>. If the code continues to executed after that (after the <code>if</code> block), you might will get a panic or similar because, well <code>foo</code> is broken (or whatever)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 3, "creation_date": 1480334339, "post_id": 40801733, "comment_id": 68904391, "body": "@abligh That could be &quot;solved&quot; by adding a <code>return</code> statement after the <code>logFatal()</code> even though normally it wouldn&#39;t be required (only for making the code testable)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 21, "last_activity_date": 1480067518, "last_edit_date": 1480067518, "creation_date": 1480066613, "answer_id": 40801733, "question_id": 40615641, "link": "https://stackoverflow.com/questions/40615641/testing-os-exit-scenarios-in-go-with-coverage-information-coveralls-io-goverall/40801733#40801733", "title": "Testing os.Exit scenarios in Go with coverage information (coveralls.io/Goveralls)", "body": "<p>With a slight refactoring, you may easily achieve 100% coverage.</p>\n\n<p><code>foo/bar.go</code>:</p>\n\n<pre><code>package foo\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nvar osExit = os.Exit\n\nfunc Crasher() {\n    fmt.Println(\"Going down in flames!\")\n    osExit(1)\n}\n</code></pre>\n\n<p>And the testing code: <code>foo/bar_test.go</code>:</p>\n\n<pre><code>package foo\n\nimport \"testing\"\n\nfunc TestCrasher(t *testing.T) {\n    // Save current function and restore at the end:\n    oldOsExit := osExit\n    defer func() { osExit = oldOsExit }()\n\n    var got int\n    myExit := func(code int) {\n        got = code\n    }\n\n    osExit = myExit\n    Crasher()\n    if exp := 1; got != exp {\n        t.Errorf(\"Expected exit code: %d, got: %d\", exp, got)\n    }\n}\n</code></pre>\n\n<p>Running <code>go test -cover</code>:</p>\n\n<pre><code>Going down in flames!\nPASS\ncoverage: 100.0% of statements\nok      foo        0.002s\n</code></pre>\n\n<p>Yes, you might say this works if <a href=\"https://golang.org/pkg/os/#Exit\" rel=\"noreferrer\"><code>os.Exit()</code></a> is called explicitly, but what if <code>os.Exit()</code> is called by someone else, e.g. <a href=\"https://golang.org/pkg/log/#Fatalf\" rel=\"noreferrer\"><code>log.Fatalf()</code></a>?</p>\n\n<p>The same technique works there too, you just have to switch <code>log.Fatalf()</code> instead of <code>os.Exit()</code>, e.g.:</p>\n\n<p>Relevant part of <code>foo/bar.go</code>:</p>\n\n<pre><code>var logFatalf = log.Fatalf\n\nfunc Crasher() {\n    fmt.Println(\"Going down in flames!\")\n    logFatalf(\"Exiting with code: %d\", 1)\n}\n</code></pre>\n\n<p>And the testing code: <code>TestCrasher()</code> in <code>foo/bar_test.go</code>:</p>\n\n<pre><code>func TestCrasher(t *testing.T) {\n    // Save current function and restore at the end:\n    oldLogFatalf := logFatalf\n    defer func() { logFatalf = oldLogFatalf }()\n\n    var gotFormat string\n    var gotV []interface{}\n    myFatalf := func(format string, v ...interface{}) {\n        gotFormat, gotV = format, v\n    }\n\n    logFatalf = myFatalf\n    Crasher()\n    expFormat, expV := \"Exiting with code: %d\", []interface{}{1}\n    if gotFormat != expFormat || !reflect.DeepEqual(gotV, expV) {\n        t.Error(\"Something went wrong\")\n    }\n}\n</code></pre>\n\n<p>Running <code>go test -cover</code>:</p>\n\n<pre><code>Going down in flames!\nPASS\ncoverage: 100.0% of statements\nok      foo     0.002s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 7, "last_activity_date": 1484934868, "last_edit_date": 1484934868, "creation_date": 1480252086, "answer_id": 40829307, "question_id": 40615641, "link": "https://stackoverflow.com/questions/40615641/testing-os-exit-scenarios-in-go-with-coverage-information-coveralls-io-goverall/40829307#40829307", "title": "Testing os.Exit scenarios in Go with coverage information (coveralls.io/Goveralls)", "body": "<h2>Interfaces and mocks</h2>\n\n<p>Using Go interfaces possible to create mock-able compositions. A type could have interfaces as bound dependencies. These dependencies could be  easily substituted with mocks appropriate to the interfaces.</p>\n\n<pre><code>type Exiter interface {\n    Exit(int)\n}\n\ntype osExit struct {}\n\nfunc (o* osExit) Exit (code int) {\n    os.Exit(code)\n}\n\ntype Crasher struct {\n    Exiter\n}\n\nfunc (c *Crasher) Crash() {\n    fmt.Println(\"Going down in flames!\")\n    c.Exit(1)\n}\n</code></pre>\n\n<p>Testing</p>\n\n<pre><code>type MockOsExit struct {\n    ExitCode int\n}\n\nfunc (m *MockOsExit) Exit(code int){\n    m.ExitCode = code\n}\n\nfunc TestCrasher(t *testing.T) {\n    crasher := &amp;Crasher{&amp;MockOsExit{}}\n    crasher.Crash() // This causes os.Exit(1) to be called\n    f := crasher.Exiter.(*MockOsExit)\n    if f.ExitCode == 1 {\n        fmt.Printf(\"Error code is %d\\n\", f.ExitCode)\n        return\n    }\n    t.Fatalf(\"Process ran with err code %d, want exit status 1\", f.ExitCode)\n}\n</code></pre>\n\n<p><strong><em>Disadvantages</em></strong></p>\n\n<p>Original <code>Exit</code> method still won't be tested so it should be responsible only for exit, nothing more.</p>\n\n<h2>Functions are first class citizens</h2>\n\n<h3>Parameter dependency</h3>\n\n<p>Functions are first class citizens in Go. A lot of operations are allowed with functions so we can do some tricks with functions directly.</p>\n\n<p>Using 'pass as parameter' operation we can do a dependency injection:</p>\n\n<pre><code>type osExit func(code int)\n\nfunc Crasher(os_exit osExit) {\n    fmt.Println(\"Going down in flames!\")\n    os_exit(1)\n}\n</code></pre>\n\n<p>Testing:</p>\n\n<pre><code>var exit_code int \nfunc os_exit_mock(code int) {\n     exit_code = code\n}\n\nfunc TestCrasher(t *testing.T) {\n\n    Crasher(os_exit_mock) // This causes os.Exit(1) to be called\n    if exit_code == 1 {\n        fmt.Printf(\"Error code is %d\\n\", exit_code)\n        return\n    }\n    t.Fatalf(\"Process ran with err code %v, want exit status 1\", exit_code)\n}\n</code></pre>\n\n<p><strong><em>Disadvantages</em></strong></p>\n\n<p>You must pass a dependency as a parameter. If you have many dependencies a length of params list could be huge.</p>\n\n<h3>Variable substitution</h3>\n\n<p>Actually it is possible to do it using \"assign to variable\" operation without explicit passing a function as a parameter.</p>\n\n<pre><code>var osExit = os.Exit\n\nfunc Crasher() {\n    fmt.Println(\"Going down in flames!\")\n    osExit(1)\n}\n</code></pre>\n\n<p>Testing</p>\n\n<pre><code>var exit_code int\nfunc osExitMock(code int) {\n    exit_code = code\n}\n\nfunc TestCrasher(t *testing.T) {\n    origOsExit := osExit\n    osExit = osExitMock\n    // Don't forget to switch functions back!\n    defer func() { osExit = origOsExit }()\n\n    Crasher()\n    if exit_code != 1 {\n        t.Fatalf(\"Process ran with err code %v, want exit status 1\", exit_code)\n    }\n}\n</code></pre>\n\n<p><strong><em>disadvantages</em></strong></p>\n\n<p>It is implicit and easy to crash.</p>\n\n<h3>Design notes</h3>\n\n<p>If you plan to declare some logic below <code>Exit</code> an exit logic must be isolated with <code>else</code> block or extra <code>return</code> after exit because mock won't stop execution.</p>\n\n<pre><code>func (c *Crasher) Crash() {\n    if SomeCondition == true {\n        fmt.Println(\"Going down in flames!\")\n        c.Exit(1)  // Exit in real situation, invoke mock when testing\n    } else {\n        DoSomeOtherStuff()\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5426, "favorite_count": 7, "accepted_answer_id": 40801733, "answer_count": 3, "score": 19, "last_activity_date": 1484934868, "creation_date": 1479229431, "last_edit_date": 1495535359, "question_id": 40615641, "link": "https://stackoverflow.com/questions/40615641/testing-os-exit-scenarios-in-go-with-coverage-information-coveralls-io-goverall", "title": "Testing os.Exit scenarios in Go with coverage information (coveralls.io/Goveralls)", "body": "<p>This question: <a href=\"https://stackoverflow.com/questions/26225513/how-to-test-os-exit-scenarios-in-go\">How to test os.exit scenarios in Go</a> (and the highest voted answer therein) sets out how to test <code>os.Exit()</code> scenarios within go. As <code>os.Exit()</code> cannot easily be intercepted, the  method used is to reinvoke the binary and check the exit value. This method is described at <a href=\"https://talks.golang.org/2014/testing.slide#23\" rel=\"noreferrer\">slide 23 on this presentation</a> by Andrew Gerrand (one of the core members of the Go team); the code is very simple and is reproduced in full below.</p>\n\n<p>The relevant test and main files look like this <strong>(note that this pair of files alone is an MVCE)</strong>:</p>\n\n<pre><code>package foo\n\nimport (\n    \"os\"\n    \"os/exec\"\n    \"testing\"\n)\n\nfunc TestCrasher(t *testing.T) {\n    if os.Getenv(\"BE_CRASHER\") == \"1\" {\n        Crasher() // This causes os.Exit(1) to be called\n        return\n    }\n    cmd := exec.Command(os.Args[0], \"-test.run=TestCrasher\")\n    cmd.Env = append(os.Environ(), \"BE_CRASHER=1\")\n    err := cmd.Run()\n    if e, ok := err.(*exec.ExitError); ok &amp;&amp; !e.Success() {\n        fmt.Printf(\"Error is %v\\n\", e)\n    return\n    }\n    t.Fatalf(\"process ran with err %v, want exit status 1\", err)\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>package foo\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\n// Coverage testing thinks (incorrectly) that the func below is\n// never being called\nfunc Crasher() {\n    fmt.Println(\"Going down in flames!\")\n    os.Exit(1)\n}\n</code></pre>\n\n<p>However, this method appears to suffer certain limitations:</p>\n\n<ol>\n<li><p>Coverage testing with goveralls / coveralls.io does not work - see for instance the example <a href=\"https://github.com/abligh/testcrasher\" rel=\"noreferrer\">here</a> (the same code as above but put into github for your convenience) which produces the coverage test <a href=\"https://coveralls.io/builds/8836153/source?filename=foo%2Fbar.go\" rel=\"noreferrer\">here</a>, i.e. it does not record the test functions being run. <strong>NOTE that you don't need to those links to answer the question - the above example will work fine - they are just there to show what happens if you put the above into github, and take it all the way through travis to coveralls.io</strong></p></li>\n<li><p>Rerunning the test binary appears fragile.</p></li>\n</ol>\n\n<p>Specifically, as requested, here is a screenshot (rather than a link) for the coverage failure; the red shading indicates that as far as coveralls.io is concerned, <code>Crasher()</code> is not being called.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HcUWj.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/HcUWj.png\" alt=\"Coverage test showing Crasher() not being called\"></a></p>\n\n<p>Is there a way around this? Particularly the first point.</p>\n\n<p>At a golang level the problem is this:</p>\n\n<ul>\n<li><p>The Goveralls framework runs <code>go test -cover ...</code>, which invokes the test above.</p></li>\n<li><p>The test above calls <code>exec.Command / .Run</code> without <code>-cover</code> in the OS arguments</p></li>\n<li><p>Unconditionally putting <code>-cover</code> etc. in the argument list is unattractive as it would then run a coverage test (as the subprocess) within a non-coverage test, and parsing the argument list for the presence of <code>-cover</code> etc. seems a heavy duty solution.</p></li>\n<li><p>Even if I put <code>-cover</code> etc. in the argument list, my understanding is that I'd then have two coverage outputs written to the same file, which isn't going to work - these would need merging somehow. The closest I've got to that is <a href=\"https://github.com/golang/go/issues/6909\" rel=\"noreferrer\">this golang issue</a>.</p></li>\n</ul>\n\n<hr>\n\n<p><strong>Summary</strong></p>\n\n<p>What I am after is a simple way to run go coverage testing (preferably via travis, goveralls, and coveralls.io), where it is possible to both test cases where the tested routine exits with <code>OS.exit()</code>, and where the coverage of that test is noted. I'd quite like it to use the re-exec method above (if that can be made to work) if that can be made to work.</p>\n\n<p>The solution should show coverage testing of <code>Crasher()</code>. Excluding <code>Crasher()</code> from coverage testing is not an option, as in the real world what I am trying to do is test a more complex function, where somewhere deep within, under certain conditions, it calls e.g. <code>log.Fatalf()</code>; what I am coverage testing is that the tests for those conditions works properly.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 1, "creation_date": 1479226551, "post_id": 40613067, "comment_id": 68463315, "body": "Im not sure I entirely understand: If this is just for your own client why can&#39;t you just write whatever bytes you want to the head of the file in some kind of wrapper - create your own metadata format and reader/writer. Failing that there are some examples of reading/writing meta data for pdf/image/audio files here as well as some file system abstractions which give some access to metadata,hopefully somethings helpful or you get a better answer: <a href=\"https://github.com/golang/go/wiki/Project\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Project</a>."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 5344248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/34edf86a38d9e680bc75b0f95236aa09?s=128&d=identicon&r=PG&f=1", "display_name": "1729", "link": "https://stackoverflow.com/users/5344248/1729"}, "is_accepted": true, "score": 2, "last_activity_date": 1479260502, "creation_date": 1479260502, "answer_id": 40622689, "question_id": 40613067, "link": "https://stackoverflow.com/questions/40613067/how-to-add-edit-file-metadata-in-golang/40622689#40622689", "title": "How to add/edit file metadata in Golang?", "body": "<p>I realized there are no library functions in Golang like that because metadata is a filesystem specific implementation. So, I have decided to hide my metadata in a hidden file like .filename.meta</p>\n"}], "owner": {"reputation": 165, "user_id": 5344248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/34edf86a38d9e680bc75b0f95236aa09?s=128&d=identicon&r=PG&f=1", "display_name": "1729", "link": "https://stackoverflow.com/users/5344248/1729"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1858, "favorite_count": 0, "accepted_answer_id": 40622689, "answer_count": 1, "score": 2, "last_activity_date": 1479397994, "creation_date": 1479222035, "last_edit_date": 1479397994, "question_id": 40613067, "link": "https://stackoverflow.com/questions/40613067/how-to-add-edit-file-metadata-in-golang", "title": "How to add/edit file metadata in Golang?", "body": "<p>I am writing a Bittorrent client in Go and I would like to save the progress of the download by writing a bitfield to the file headers/metadata. This allows me to cancel the download and restart from where I left off the next time I start downloading. </p>\n\n<p>However, I could not find any standard or third party libraries that allow me to write to file metadata. The closest I have gotten was printing the FileInfo struct returned by os.Stat. I am not sure how to add/edit the FileInfo struct. </p>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 1, "creation_date": 1479221097, "post_id": 40612070, "comment_id": 68459504, "body": "Another interesting <a href=\"https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully\" rel=\"nofollow noreferrer\">article</a> by Dave Cheney on errors."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1479240520, "post_id": 40612070, "comment_id": 68471607, "body": "yes just read the article that John S Perayil suggests"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1479253269, "post_id": 40612070, "comment_id": 68477384, "body": "Related: <a href=\"http://stackoverflow.com/questions/37346694/go-best-practice-to-handle-error-from-multiple-abstract-level\">Go. Best practice to handle error from multiple abstract level</a>"}, {"owner": {"reputation": 166, "user_id": 769240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HrVGf.png?s=128&g=1", "display_name": "Kasper Middelboe Petersen", "link": "https://stackoverflow.com/users/769240/kasper-middelboe-petersen"}, "edited": false, "score": 0, "creation_date": 1479285339, "post_id": 40612070, "comment_id": 68487888, "body": "He&#39;s also done a nice <a href=\"https://www.youtube.com/watch?v=lsBF58Q-DnY\" rel=\"nofollow noreferrer\">talk</a> about it"}, {"owner": {"reputation": 166, "user_id": 769240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HrVGf.png?s=128&g=1", "display_name": "Kasper Middelboe Petersen", "link": "https://stackoverflow.com/users/769240/kasper-middelboe-petersen"}, "edited": false, "score": 0, "creation_date": 1479289780, "post_id": 40612070, "comment_id": 68490566, "body": "I read/watched those prior to posting this though. The question is posted because I don&#39;t know how to apply them to the problem described."}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 769240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HrVGf.png?s=128&g=1", "display_name": "Kasper Middelboe Petersen", "link": "https://stackoverflow.com/users/769240/kasper-middelboe-petersen"}, "edited": false, "score": 0, "creation_date": 1479224993, "post_id": 40613567, "comment_id": 68462238, "body": "The point with Dave Cheneys blog is that one should avoid type asserting errors. It also quickly ramps up when all the different possible errors needs its own type so the caller can be the judge of how to treat the error further up the chain."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1479223445, "creation_date": 1479223445, "answer_id": 40613567, "question_id": 40612070, "link": "https://stackoverflow.com/questions/40612070/working-with-errors-in-go/40613567#40613567", "title": "Working with errors in Go", "body": "<p>What I'd do is define a few \"wrapper errors\" to signify where error has actually happened. E.g.</p>\n\n<pre><code>type SerializationError struct { Error error }\nfunc (err SerializationError) Error() string { return err.Error.Error() }\n\ntype HTTPError struct { Error error }\n// ...\n</code></pre>\n\n<p>And then in the code of your API Client:</p>\n\n<pre><code>b, err := json.Marshal(v)\nif err != nil {\n     return nil, SerializationError{err}\n}\n\n// ...\n\nresp, err := client.Post(url, ct, body)\nif err != nil {\n    return nil, HTTPError{err}\n}\n</code></pre>\n\n<p>Then, you can do this:</p>\n\n<pre><code>err := client.GetUser(id)\nswitch err.(type) {\ncase SerializationError:\n    // respond with 400\ncase HTTPError:\n    // respond with 500\n// etc.\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 769240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HrVGf.png?s=128&g=1", "display_name": "Kasper Middelboe Petersen", "link": "https://stackoverflow.com/users/769240/kasper-middelboe-petersen"}, "is_accepted": true, "score": 0, "last_activity_date": 1479803172, "last_edit_date": 1495541627, "creation_date": 1479803172, "answer_id": 40736965, "question_id": 40612070, "link": "https://stackoverflow.com/questions/40612070/working-with-errors-in-go/40736965#40736965", "title": "Working with errors in Go", "body": "<p>After working with this for a while without coming any closer to a solution that feels just right I'm coming to terms with there not being a good single solution for this.</p>\n\n<p>I guess this might also be what <a href=\"https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully\" rel=\"nofollow noreferrer\">Dave Cheney</a> means by:</p>\n\n<blockquote>\n  <p>However, I have concluded that there is no single way to handle errors.</p>\n</blockquote>\n\n<p>Since I still want to avoid type asserting the error due to the dependency challenges that brings I've ended up introducing an <code>Internal() bool</code> behaviour similar to the <code>Temporary() bool</code> pattern mentioned in the linked articles.</p>\n\n<p>This at least allow me to assert the behavior without being forced to import the package that originally created the error.</p>\n\n<p>It's not the best fit, but it will have to do for now.</p>\n\n<p>Ainar-G's <a href=\"https://stackoverflow.com/a/40613567/769240\">answer</a> is worth taking a look at as well.</p>\n"}], "owner": {"reputation": 166, "user_id": 769240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HrVGf.png?s=128&g=1", "display_name": "Kasper Middelboe Petersen", "link": "https://stackoverflow.com/users/769240/kasper-middelboe-petersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 2, "accepted_answer_id": 40736965, "answer_count": 2, "score": 4, "last_activity_date": 1479803172, "creation_date": 1479219350, "question_id": 40612070, "link": "https://stackoverflow.com/questions/40612070/working-with-errors-in-go", "title": "Working with errors in Go", "body": "<p>I've worked with Go for a while now and has yet to really nail how I work with errors.</p>\n\n<p>Even the standard library has a number of different ways to deal with errors (some not even making it possible to inspect the errors without having to resort to string matching).</p>\n\n<p>I've recently read the blog post <a href=\"https://dave.cheney.net/2014/12/24/inspecting-errors\" rel=\"nofollow noreferrer\">Inspecting Errors</a> by Dave Cheney. This sounds like its a step in the right direction, but I'm still having a hard time really putting it to real use.</p>\n\n<p>Say I have made a package <code>a</code> that does requests to a 3rd party REST API (such as Facebook Graph for instance). I'd like this package to expose functions matching those of the API - lets say <code>GetUser</code>.</p>\n\n<p>Calling <code>GetUser</code> can have a number of outcomes:</p>\n\n<ol>\n<li>Success</li>\n<li>Failed due to request failure like 3rd party API being down</li>\n<li>3rd party API returned an error (like user not found)</li>\n<li>Deserialization of response or similar failed</li>\n</ol>\n\n<p>Asserting the error for behaviour works very well in the second case. However it falls short in distinguishing between the third and fourth case.</p>\n\n<p>My current use case is implementing my own REST API that use this first package. In this case I'd like be able to return <code>200 OK</code>, <code>503 Service Unavailable</code>, <code>400 Bad Request</code>, <code>500 Internal Server Error</code> responses respectively to the possible outcomes.</p>\n\n<p>What would be a good general approach to solving this problem without having to include returning http response codes or similar from package <code>a</code>?</p>\n"}, {"tags": ["elasticsearch", "go"], "answers": [{"comments": [{"owner": {"reputation": 2359, "user_id": 3794110, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a165f5d869885be194d9ac5ee349d837?s=128&d=identicon&r=PG&f=1", "display_name": "Mornor", "link": "https://stackoverflow.com/users/3794110/mornor"}, "edited": false, "score": 0, "creation_date": 1479216558, "post_id": 40610924, "comment_id": 68456255, "body": "Thanks! Although I do not get the <code>.TODO()</code>. What that should be? (And thanks for the advice about the testcases)"}, {"owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "reply_to_user": {"reputation": 2359, "user_id": 3794110, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a165f5d869885be194d9ac5ee349d837?s=128&d=identicon&r=PG&f=1", "display_name": "Mornor", "link": "https://stackoverflow.com/users/3794110/mornor"}, "edited": false, "score": 1, "creation_date": 1479216611, "post_id": 40610924, "comment_id": 68456295, "body": "That simply returns an non-null, empty context that you can use: <a href=\"https://godoc.org/golang.org/x/net/context#TODO\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/net/context#TODO</a>"}], "tags": [], "owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "is_accepted": true, "score": 4, "last_activity_date": 1479216167, "creation_date": 1479216167, "answer_id": 40610924, "question_id": 40610757, "link": "https://stackoverflow.com/questions/40610757/elasticsearch-createindex-not-enough-arguments/40610924#40610924", "title": "Elasticsearch CreateIndex() not enough arguments", "body": "<p>The <a href=\"https://github.com/olivere/elastic/blob/1368b91516f39100baf5e23a02ae9f090c0d90e2/indices_create.go#L80\" rel=\"nofollow noreferrer\"><code>IndicesCreateService.Do()</code> function</a> expects a <code>context.Context</code> to be passed.</p>\n\n<p>So, you need to import <code>\"golang.org/x/net/context\"</code> and then change your call to this:</p>\n\n<pre><code>import (\n    ... your other imports...    \n    \"golang.org/x/net/context\"\n)\n...\n_, err := client.CreateIndex(\"events\").Do(context.TODO())\n                                                ^\n                                                |\n                                             add this\n</code></pre>\n\n<p>You can also check the <a href=\"https://github.com/olivere/elastic/blob/1368b91516f39100baf5e23a02ae9f090c0d90e2/indices_create_test.go\" rel=\"nofollow noreferrer\"><code>indices_create_test.go</code></a> test case in order to see how it's done.</p>\n"}], "owner": {"reputation": 2359, "user_id": 3794110, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a165f5d869885be194d9ac5ee349d837?s=128&d=identicon&r=PG&f=1", "display_name": "Mornor", "link": "https://stackoverflow.com/users/3794110/mornor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 40610924, "answer_count": 1, "score": -3, "last_activity_date": 1479216167, "creation_date": 1479215679, "question_id": 40610757, "link": "https://stackoverflow.com/questions/40610757/elasticsearch-createindex-not-enough-arguments", "title": "Elasticsearch CreateIndex() not enough arguments", "body": "<p>I am trying to use Elasticsearch for GO with this well-known <a href=\"https://github.com/olivere/elastic\" rel=\"nofollow noreferrer\">repo</a></p>\n\n<p>However, when I am trying to create an <code>index</code> (<a href=\"https://godoc.org/github.com/olivere/elastic#Client.CreateIndex\" rel=\"nofollow noreferrer\">docs</a>, and also given as an example <a href=\"https://github.com/olivere/elastic\" rel=\"nofollow noreferrer\">here</a>): </p>\n\n<pre><code>    // Define an elastic client \n    client, err := elastic.NewClient(elastic.SetURL(\"host1\"))\n    if err != nil {\n        client, err := elastic.NewClient(elastic.SetURL(\"host2\"))\n        if err != nil {\n            fmt.Println(\"Error when connecting Elasticsearch host\");    \n        }\n    }\n\n    // Create an index\n    _, err = client.CreateIndex(\"events\").Do()\n    if err != nil {\n        fmt.Println(\"Error when creating Elasticsearch index\"); \n        panic(err)\n    }\n</code></pre>\n\n<p>I got the following error, which I do not understand: </p>\n\n<blockquote>\n  <p>not enough arguments in call to client.CreateIndex(\"events\").Do</p>\n</blockquote>\n\n<p>Why is that? What do I miss here?</p>\n"}, {"tags": ["multithreading", "go", "concurrency", "httpserver"], "comments": [{"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1479215003, "post_id": 40610398, "comment_id": 68455263, "body": "The requests are concurrent by default. Whatever goes on inside a handler is sequential unless you use goroutines."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1479216101, "post_id": 40610398, "comment_id": 68455975, "body": "Your way of checking if the request are handled concurrent is flawed. All the request are always handled in a concurrent fashion no matter what your print statements make you think."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 1, "creation_date": 1479216767, "post_id": 40610398, "comment_id": 68456403, "body": "I would suggest you to send concurrent requests to you&#39;re server and see what happens!"}, {"owner": {"reputation": 43, "user_id": 6808610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/139553519cc6fa7d00f9164e7aef9b7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ety", "link": "https://stackoverflow.com/users/6808610/ety"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1479217400, "post_id": 40610398, "comment_id": 68456857, "body": "@FranckJeannin Of course inside the handler, everything is sequential, but if the handlers run in the same time then the prints may interapt one inside the other. If you create 10 goroutins and every one will print numbers 1 - 100 and you start them all you will not see 1, 2, 3, ..., 100, 1, 2, ..., 100, 1, 2.... . But you will see a mess inside like: 1, 2, 3, 1, 4, 1, 2, 5, 3, ..."}, {"owner": {"reputation": 43, "user_id": 6808610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/139553519cc6fa7d00f9164e7aef9b7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ety", "link": "https://stackoverflow.com/users/6808610/ety"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1479217511, "post_id": 40610398, "comment_id": 68456944, "body": "@AnkitDeshpande I sent concurrent requests in my test (a python script with 10 threads each thread sends 10 requestst)"}, {"owner": {"reputation": 43, "user_id": 6808610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/139553519cc6fa7d00f9164e7aef9b7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ety", "link": "https://stackoverflow.com/users/6808610/ety"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1479217737, "post_id": 40610398, "comment_id": 68457092, "body": "@Volker then why don&#39;t I see concurrent prints? I changed the test handler to print numbers 1 to 100 and sent requests from 20 concurrent threads, but all the prints are sequential without any interrupting... How can it be if the requests handled concurrently?"}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1479218124, "post_id": 40610398, "comment_id": 68457339, "body": "what are you printing in you&#39;re handlers?"}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1479218713, "post_id": 40610398, "comment_id": 68457737, "body": "The thing is, when you remove the Sleep, your goroutine is so quick to execute that the probability that another goroutine will run <i>during</i> the time it takes to print &quot;1&quot; and &quot;2&quot; is close to zero. The compiler may even decide that your two prints can be combined into one atomic print, etc."}, {"owner": {"reputation": 43, "user_id": 6808610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/139553519cc6fa7d00f9164e7aef9b7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ety", "link": "https://stackoverflow.com/users/6808610/ety"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1479218981, "post_id": 40610398, "comment_id": 68457930, "body": "@AnkitDeshpande in my sample i printed just numbers 1 to 100. Now I increased it to 1-100000 and when I run this code I see some interruptions, but less then I would expect. In the real handler, I proxy the request to other server and then return the answer to user. In the middle I add some prints to see the how much each step takes in format: 1 [time], 2[ time], 3 [ time] ...., and I see that all my prints are sequential. Proxy the request to other server takes time and I would expect that in this time other handlers would run (and print) as well..."}, {"owner": {"reputation": 43, "user_id": 6808610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/139553519cc6fa7d00f9164e7aef9b7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ety", "link": "https://stackoverflow.com/users/6808610/ety"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1479219803, "post_id": 40610398, "comment_id": 68458539, "body": "@FranckJeannin you are right, this is why started to increase the numbers. 1-100 it was still sequential. 1-100000 I start to see some interruptions. But in my real handler there are moment when I send a request to other server, and wait until I get the answer... so there is a plenty of time to switch to another request. And still I don&#39;t see such switches but all the prints there are sequential too."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1479226142, "post_id": 40610398, "comment_id": 68463046, "body": "<a href=\"https://godoc.org/net/http#Serve\" rel=\"nofollow noreferrer\">The documentation states</a> that a goroutine is created to service the requests on a connection."}], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479327356, "post_id": 40617444, "comment_id": 68514935, "body": "On top of the transparency that @jmaloney&#39;s codes provides.  It would also be best to send concurrent requests using a tool like Siege, <a href=\"https://www.joedog.org/siege-home/\" rel=\"nofollow noreferrer\">joedog.org/siege-home</a>"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 6, "last_activity_date": 1479236331, "last_edit_date": 1479236331, "creation_date": 1479235613, "answer_id": 40617444, "question_id": 40610398, "link": "https://stackoverflow.com/questions/40610398/golang-concurrent-http-request-handling/40617444#40617444", "title": "golang concurrent http request handling", "body": "<p>Your example makes it very hard to tell what is happening.</p>\n\n<p>The below example will clearly illustrate that the requests are run in parallel.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        if len(r.FormValue(\"case-two\")) &gt; 0 {\n            fmt.Println(\"case two\")\n        } else {\n            fmt.Println(\"case one start\")\n            time.Sleep(time.Second * 5)\n            fmt.Println(\"case one end\")\n        }\n    })\n\n    if err := http.ListenAndServe(\":8000\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Make one request to <a href=\"http://localhost:8000\" rel=\"noreferrer\">http://localhost:8000</a></p>\n\n<p>Make another request to <a href=\"http://localhost:8000?case-two=true\" rel=\"noreferrer\">http://localhost:8000?case-two=true</a> within 5 seconds</p>\n\n<p>console output will be</p>\n\n<pre><code>case one start\ncase two\ncase one end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 3056512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e00d6316d600b22d61669aa7c785ea?s=128&d=identicon&r=PG&f=1", "display_name": "rbh", "link": "https://stackoverflow.com/users/3056512/rbh"}, "is_accepted": false, "score": 0, "last_activity_date": 1486159861, "creation_date": 1486159861, "answer_id": 42033812, "question_id": 40610398, "link": "https://stackoverflow.com/questions/40610398/golang-concurrent-http-request-handling/42033812#42033812", "title": "golang concurrent http request handling", "body": "<p>It does serve requests in a concurrent fashion as can be seen here in the source <a href=\"https://golang.org/src/net/http/server.go#L2293\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/server.go#L2293</a>.</p>\n\n<p>Here is a <strong>contrived example</strong>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    go startServer()\n    sendRequest := func() {\n        resp, _ := http.Get(\"http://localhost:8000/\")\n        defer resp.Body.Close()\n    }\n    start := time.Now()\n    var wg sync.WaitGroup\n    ch := make(chan int, 10)\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go func(n int) {\n            defer wg.Done()\n            sendRequest()\n            ch &lt;- n\n        }(i)\n    }\n    go func() {\n        wg.Wait()\n        close(ch)\n    }()\n\n    fmt.Printf(\"completion sequence :\")\n    for routineNumber := range ch {\n        fmt.Printf(\"%d \", routineNumber)\n    }\n    fmt.Println()\n    fmt.Println(\"time:\", time.Since(start))\n}\n\nfunc startServer() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        time.Sleep(1 * time.Second)\n    })\n    if err := http.ListenAndServe(\":8000\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Over several runs it is easy to visualize that the completion ordering of the go routines which send the requests are completely random and given the fact that channels are fifo, we can summarize that the server handled the requests in a concurrent fashion, irrespective of whether HandleFunc sleeps or not.\n(Assumption being all the requests start at about the same time).</p>\n\n<p>In addition to the above, if you did sleep for a second in HandleFunc, the time it takes to complete all 10 routines is consistently 1.xxx seconds which further shows that the server handled the requests concurrently as else the total time to complete all requests should have been 10+ seconds.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>completion sequence :3 0 6 2 9 4 5 1 7 8 \ntime: 1.002279359s\n\ncompletion sequence :7 2 3 0 6 4 1 9 5 8 \ntime: 1.001573873s\n\ncompletion sequence :6 1 0 8 5 4 2 7 9 3 \ntime: 1.002026465s\n</code></pre>\n\n<p>Analyzing concurrency by printing without synchronization is almost always indeterminate.</p>\n"}, {"tags": [], "owner": {"reputation": 571, "user_id": 1691455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478c1e02777864acbcfe0955348de695?s=128&d=identicon&r=PG", "display_name": "Igor Afanasyev", "link": "https://stackoverflow.com/users/1691455/igor-afanasyev"}, "is_accepted": false, "score": 0, "last_activity_date": 1507523588, "last_edit_date": 1507523588, "creation_date": 1507509181, "answer_id": 46637378, "question_id": 40610398, "link": "https://stackoverflow.com/questions/40610398/golang-concurrent-http-request-handling/46637378#46637378", "title": "golang concurrent http request handling", "body": "<p>While Go serves requests concurrently, the client might actually be blocking (wait for the first request to complete before sending the second), and then one will see exactly the behavior reported initially.</p>\n\n<p>I was having the same problem, and my client code was sending a \"GET\" request via XMLHttpRequest to a slow handler (I used a similar handler code as posted above, with 10 sec timeout). In turns out that such requests block each other. Example JavaScript client code:</p>\n\n<pre><code>for (var i = 0; i &lt; 3; i++) {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"GET\", \"/slowhandler\");\n  xhr.send();\n}\n</code></pre>\n\n<p>Note that <code>xhr.send()</code> will return immediately, since this is an asynchronous call, but that doesn't guarantee that the browser will send the actual \"GET\" request right away.</p>\n\n<p>GET requests are subject to caching, and if one tries to GET the same URL, caching might (in fact, will) affect how the requests to the server are made. POST requests are not cached, so if one changes <code>\"GET\"</code> to <code>\"POST\"</code> in the example above, the Go server code will show that the <code>/slowhandler</code> will be fired concurrently (you will see \"1 1 1 [...pause...] 2 2 2\" printed).</p>\n"}], "owner": {"reputation": 43, "user_id": 6808610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/139553519cc6fa7d00f9164e7aef9b7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ety", "link": "https://stackoverflow.com/users/6808610/ety"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7128, "favorite_count": 2, "answer_count": 3, "score": 1, "last_activity_date": 1507523588, "creation_date": 1479214604, "question_id": 40610398, "link": "https://stackoverflow.com/questions/40610398/golang-concurrent-http-request-handling", "title": "golang concurrent http request handling", "body": "<p>I am creating a simple http server using golang. I have two questions, one is more theoretic and another one about the real program.</p>\n\n<ol>\n<li>Concurrent request handling </li>\n</ol>\n\n<p>I create a server and use s.ListenAndServe() to handle the requests.\nAs much as I understand the requests served concurrently. I use a simple handler to check it:</p>\n\n<pre><code>func  ServeHTTP(rw http.ResponseWriter, request *http.Request) {  \n    fmt.Println(\"1\")  \n    time.Sleep(1 * time.Second)       //Phase 2 delete this line\n    fmt.Fprintln(rw, \"Hello, world.\")\n    fmt.Println(\"2\")  \n}\n</code></pre>\n\n<p>I see that if I send several requests, I will see all the \"1\" appear and only after a second all the \"2\" appear.\nBut if I delete the Sleep line, I see that program never start a request before it finishes with the previous one (the output is 1 2 1 2 1 2 ...).\nSo I don't understand, if they are concurrent or not really. If they are I would expect to see some mess in prints...</p>\n\n<ol start=\"2\">\n<li>The real life problem</li>\n</ol>\n\n<p>In the real handler, I send the request to another server and return the answer to the user (with some changes to request and the answer but in idea it is kind of a proxy). All this of course takes time and from what can see (by adding some prints to the handler), the requests are handled one by one, with no concurrency between them (my prints show me that a request starts, go through all the steps, ends and only then I see a new start....). \nWhat can I do to make them really concurrent?<br>\nPutting the handler function as goroutine gives an error, that body of the request is already closed. Also if it is already concurrent adding more goroutines will make things only worse.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go", "struct", "slice"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2696943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62abc25432c0cc75a0e7017c047e880d?s=128&d=identicon&r=PG", "display_name": "Alex Demskie", "link": "https://stackoverflow.com/users/2696943/alex-demskie"}, "edited": false, "score": 0, "creation_date": 1479208449, "post_id": 40608106, "comment_id": 68451182, "body": "No doubt I&#39;ve got lots of reading to do. Was hoping I could practice some of it in the meantime. My thought process was that the &quot;name&quot; field would be unnecessary if I could initialize the struct with the proper name. Thanks"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1479207505, "creation_date": 1479207505, "answer_id": 40608106, "question_id": 40607811, "link": "https://stackoverflow.com/questions/40607811/initialize-structs-from-list-of-strings/40608106#40608106", "title": "Initialize structs from list of strings", "body": "<p>Your <code>Galaxy</code> struct doesn't even store the name, in your attempt there isn't any connection between the names and the struct values. Add the name to the struct:</p>\n\n<pre><code>type Galaxy struct {\n    Name  string\n    UberX int64\n    UberY int64\n}\n</code></pre>\n\n<p>Next, in your first loop you create a <code>*Galaxy</code> value, but you only store it in a local variable <code>v</code> which by the way shadows the loop variable <code>v</code>:</p>\n\n<pre><code>for _, v := range galaxies {\n    v := &amp;Galaxy{}\n}\n</code></pre>\n\n<p>You need a slice of <code>Galaxy</code> or a slice of <code>*Galaxy</code> which you can populate:</p>\n\n<pre><code>gs := make([]*Galaxy, len(galaxies))\n</code></pre>\n\n<p>Then 1 loop is enough to loop over the galaxy names and populate the <code>gs</code> slice:</p>\n\n<pre><code>for i, v := range galaxies {\n    gs[i] = &amp;Galaxy{\n        Name:  v,\n        UberX: 1000,\n        UberY: 750,\n    }\n}\n</code></pre>\n\n<p>Verifying the result:</p>\n\n<pre><code>for _, v := range gs {\n    fmt.Printf(\"%+v\\n\", v)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/a4kkdx7gX1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{Name:andromeda UberX:1000 UberY:750}\n&amp;{Name:milkyway UberX:1000 UberY:750}\n&amp;{Name:maffei UberX:1000 UberY:750}\n</code></pre>\n\n<p>Recommended to go through the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Golang Tour</a> first to learn the basics.</p>\n"}], "owner": {"reputation": 13, "user_id": 2696943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62abc25432c0cc75a0e7017c047e880d?s=128&d=identicon&r=PG", "display_name": "Alex Demskie", "link": "https://stackoverflow.com/users/2696943/alex-demskie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 40608106, "answer_count": 1, "score": 0, "last_activity_date": 1479207665, "creation_date": 1479206702, "last_edit_date": 1479207665, "question_id": 40607811, "link": "https://stackoverflow.com/questions/40607811/initialize-structs-from-list-of-strings", "title": "Initialize structs from list of strings", "body": "<p>I'm trying to initialize structs from a list of strings, but the compiler is throwing the following error. I'm still learning the language so excuse my ignorance, but is this solved by utilizing type assertion?</p>\n\n<blockquote>\n  <p>ERROR: v.UberX undefined (type string has no field method UberX)</p>\n</blockquote>\n\n<pre><code>type Galaxy struct {\n    UberX     int64\n    UberY     int64\n}\n\nfunc main() {\n    galaxies := []string{\"andromeda\", \"milkyway\", \"maffei\"}\n    for _, v := range galaxies {\n        v := &amp;Galaxy{}\n    }\n    for _, v := range galaxies {\n        v.UberX += 1000\n        v.UberY += 750\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "pq"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1479205841, "post_id": 40607359, "comment_id": 68449588, "body": "Yes, see related question: <a href=\"http://stackoverflow.com/questions/40587008/how-do-i-handle-opening-closing-db-connection-in-a-go-app/40587071#40587071\">How do I handle opening/closing Db connection in a Go app?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 1509414, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/410ac3df4157f9e37d90585d04018768?s=128&d=identicon&r=PG", "display_name": "Gavello", "link": "https://stackoverflow.com/users/1509414/gavello"}, "edited": false, "score": 1, "creation_date": 1479206181, "post_id": 40607500, "comment_id": 68449819, "body": "thanks sadil I should read the documentation with more patience!"}], "tags": [], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "is_accepted": true, "score": 3, "last_activity_date": 1479205749, "creation_date": 1479205749, "answer_id": 40607500, "question_id": 40607359, "link": "https://stackoverflow.com/questions/40607359/golang-database-sql-using-pq/40607500#40607500", "title": "golang database/sql using pq", "body": "<p>According to <a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"nofollow noreferrer\">this</a>, <strong>Yes</strong> it is an expected behavior. Open() does not directly open a connection to the database.\nInstead the first connection is opened when the database is actually used the first time.</p>\n\n<pre><code>Open may just validate its arguments without creating a connection \nto the database. \nTo verify that the data source name is valid, call Ping.\n</code></pre>\n\n<p>Use <a href=\"https://golang.org/src/database/sql/sql.go?s=14097:14123#L489\" rel=\"nofollow noreferrer\">Ping()</a> to check if the connection is valid or not.</p>\n"}], "owner": {"reputation": 999, "user_id": 1509414, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/410ac3df4157f9e37d90585d04018768?s=128&d=identicon&r=PG", "display_name": "Gavello", "link": "https://stackoverflow.com/users/1509414/gavello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 40607500, "answer_count": 1, "score": 1, "last_activity_date": 1479205749, "creation_date": 1479205342, "question_id": 40607359, "link": "https://stackoverflow.com/questions/40607359/golang-database-sql-using-pq", "title": "golang database/sql using pq", "body": "<p>I'm having this issue </p>\n\n<pre><code> db, err := sql.Open(\"postgres\", \"user=xxx dbname=xxx connect_timeout=5 sslmode=disable\")\n if err != nil {\n    log.Fatal(err)\n }\n</code></pre>\n\n<p>I have no postgres installed on my localhost so sql.Open should return some error but actually it is not until I try to prepare a query and finally I get a connection refused error</p>\n\n<pre><code>stmt, err := c.DB.Prepare(\"SELECT id FROM services WHERE name = $1\")\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>is this an expected behaviour? or I'm missing something... </p>\n"}, {"tags": ["serialization", "go", "deserialization"], "comments": [{"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1479202166, "post_id": 40605630, "comment_id": 68447146, "body": "github.com/golang/protobuf works really well."}], "answers": [{"tags": [], "owner": {"reputation": 1923, "user_id": 298275, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/959931af6b71c9c3c9f1ed621ff09f61?s=128&d=identicon&r=PG", "display_name": "Koala3", "link": "https://stackoverflow.com/users/298275/koala3"}, "is_accepted": false, "score": 1, "last_activity_date": 1513639034, "creation_date": 1513639034, "answer_id": 47877842, "question_id": 40605630, "link": "https://stackoverflow.com/questions/40605630/golang-map-array-non-struct-serialization/47877842#47877842", "title": "Golang map/array (non-struct) serialization", "body": "<p>Your data structures look like they can be represented as several tables of\ndata. That is, normalised into tables (like with database tables). If that is\nthe case, then consider using a table-based subset of FlatBuffers.</p>\n\n<p>I have just released a Go library and utility that does that. All you need to\ndo is redesign your data structures into tabular format and represent them\nin a simple table data format, then install and run a utility gotflat which\nwill generate all the glue for you. The following link shows how to install\nand use it. I hope that helps.</p>\n\n<p><a href=\"https://github.com/urban-wombat/gotablesutils/releases/tag/v0.2-alpha\" rel=\"nofollow noreferrer\">https://github.com/urban-wombat/gotablesutils/releases/tag/v0.2-alpha</a></p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513639034, "creation_date": 1479200264, "last_edit_date": 1479201631, "question_id": 40605630, "link": "https://stackoverflow.com/questions/40605630/golang-map-array-non-struct-serialization", "title": "Golang map/array (non-struct) serialization", "body": "<p>I do lot of queries resulting in map or slice/array of map, something like this:</p>\n\n<pre><code>// package M\ntype SX map[string]interface{}\ntype IX map[int64]interface{}\ntype IAX map[int64][]interface{}\ntype SAX map[string][]interface{}\ntype SS map[string]string\ntype SF map[string]float64\ntype II map[int64]int64\ntype IB map[int64]bool\ntype SI map[string]int64\ntype IS map[int64]string\ntype SB map[string]bool\n\n// package A\ntype X []interface{}\ntype MSX []map[string]interface{}\n</code></pre>\n\n<p>So I could declare it something like this:</p>\n\n<pre><code> // import `gitlab.com/kokizzu/gokil/A`\n // import `gitlab.com/kokizzu/gokil/M`\nvalues := M.SX{\n    `orderId`:  `1-12-1`,\n    `apiKey`:   `16313c061a8e3288528123bd8`,\n    `country`:  `360`, \n    `currency`: `360`, \n    `payType`:  1,\n    `items`: A.MSX{\n        M.SX{\n            `code`:  `subscription for 7 days`,\n            `name`:  `Bla bla`,\n            `price`: price,\n        },\n    },\n    `profile`: M.SX{\n        `entry`: A.MSX{\n            M.SX{\n                `key`:   `need_mno_id`,\n                `value`: `yes`,\n            },\n            M.SX{\n                `key`:   `foo`,\n                `value`: `bar`,\n            },\n        },\n    },\n    `profile`: A.MSX{\n        M.SX{`foo`:`bar`,`age`:123},\n        M.SX{`foo`:`wow`,`age`:234,`currency`:360},\n        M.SX{`foo`:`such`,`age`:45,`is_admin`:true},\n        M.SX{`foo`:`wow`,`age`:57,`is_deleted`:true},\n    },\n}\n</code></pre>\n\n<p>Which one of the <a href=\"https://github.com/alecthomas/go_serialization_benchmarks\" rel=\"nofollow noreferrer\">list</a> other than <code>encoding/gob</code> and <code>encoding/json</code>, that support this kind of serialization (no need to generate struct/schema)?</p>\n\n<pre><code>github.com/alecthomas/binary\ngithub.com/davecgh/go-xdr/xdr\ngithub.com/Sereal/Sereal/Go/sereal\ngithub.com/ugorji/go/codec\ngopkg.in/vmihailenco/msgpack.v2 --&gt; has example for enc/dec-ing a map\nlabix.org/v2/mgo/bson\ngithub.com/tinylib/msgp (code generator for msgpack)\ngithub.com/golang/protobuf (generated code)\ngithub.com/gogo/protobuf (generated code, optimized version of goprotobuf)\ngithub.com/DeDiS/protobuf (reflection based)\ngithub.com/google/flatbuffers\ngithub.com/hprose/hprose-go/io\ngithub.com/glycerine/go-capnproto\nzombiezen.com/go/capnproto2\ngithub.com/andyleap/gencode\ngithub.com/pascaldekloe/colfer\n</code></pre>\n\n<p><strong>Note</strong>: there is nothing wrong with <code>Gob</code> (currently I use them), I just need to prepare for the alternative (or start with the best one) when <code>Gob</code> no longer suffice (not fast/small enough) since I use it to cache the database (with ever changing schema) queries result on RAM.</p>\n"}, {"tags": ["json", "parsing", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1479198817, "post_id": 40605170, "comment_id": 68445203, "body": "Yes, take a look at this answer which provides a getter / setter function to get any element from a JSON: <a href=\"http://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an/28878037#28878037\">Taking a JSON string, unmarshaling it into a map, editing, and marshaling it back</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1513700194, "post_id": 40605170, "comment_id": 82748381, "body": "Take a look at my library <a href=\"https://github.com/icza/dyno\" rel=\"nofollow noreferrer\"><code>github.com&#47;icza&#47;dyno</code></a> which does exactly this."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7165765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2343db3552247889ca05f81bbee40ec?s=128&d=identicon&r=PG&f=1", "display_name": "persimmon_jones", "link": "https://stackoverflow.com/users/7165765/persimmon-jones"}, "is_accepted": false, "score": 1, "last_activity_date": 1479276521, "creation_date": 1479276521, "answer_id": 40625174, "question_id": 40605170, "link": "https://stackoverflow.com/questions/40605170/go-and-json-how-to-dynamically-load-a-field/40625174#40625174", "title": "Go and JSON: how to dynamically load a field", "body": "<p>There are several packages that I can think of that have tools to solve problems like this. Here are some examples off the top of my head: </p>\n\n<p>1) <code>github.com/jmoiron/jsonq</code></p>\n\n<pre><code>jq := jsonq.NewQuery(yourData)\njq.Int(\"id\")\njq.String(\"tags\", \"0\")\n</code></pre>\n\n<p>2) <code>github.com/araddon/gou</code>: </p>\n\n<pre><code>jh := gou.NewJsonHelper(yourData)\njh.Int(\"id\")\njh.Strings(\"tags[0]\")\n</code></pre>\n\n<p>3) <code>https://github.com/elgs/gojq</code></p>\n\n<p>The packages are very similar, but slightly different function structure. </p>\n"}], "owner": {"reputation": 25, "user_id": 586883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/061c7f5f2abdff9a7ad28476c0176744?s=128&d=identicon&r=PG", "display_name": "user586883", "link": "https://stackoverflow.com/users/586883/user586883"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479276521, "creation_date": 1479198619, "last_edit_date": 1479210787, "question_id": 40605170, "link": "https://stackoverflow.com/questions/40605170/go-and-json-how-to-dynamically-load-a-field", "title": "Go and JSON: how to dynamically load a field", "body": "<p>I know how to play with JSON and interfaces in go without too many problems.</p>\n\n<p>I would like to let users choose a JSON element from a JSON string and to store the element pattern in a string so that I can dynamically load it later.\nI have the following JSON:</p>\n\n<pre><code>{\n    \"id\": 1,\n    \"name\": \"A green door\",\n    \"price\": 12.50,\n    \"tags\": [\"home\", \"green\"]\n}\n</code></pre>\n\n<p>Of course this is easy if I want the <code>id</code> element of my JSON , as <code>id</code> is the string I'm going to save.</p>\n\n<p>Now let's say I want tags[1].</p>\n\n<p>You can see this gets harder and harder as the JSON gets more complicated. For example I could want to save a pattern similar to <code>tags[1].data[0].values.id</code> and so on...</p>\n\n<p>Basically I need to get a well defined element from my JSON and need to save the pattern to a string.</p>\n\n<p>Does GO have a solution to this kind of problem without me implementing my own string parser?</p>\n"}, {"tags": ["arrays", "go", "struct"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 1, "creation_date": 1479192914, "post_id": 40603752, "comment_id": 68442426, "body": "Don&#39;t you need to first <b>allocate</b> an entry for index 0 (and, of course, any additional entry)?"}, {"owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "reply_to_user": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479193225, "post_id": 40603752, "comment_id": 68442559, "body": "As i have learned, we need to use make keyword for the allocation.But for this i dont know how to allocate or am i wrong???.Please help me .Thanks"}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1479193471, "post_id": 40603752, "comment_id": 68442663, "body": "I don&#39;t know the language you are using, but you may try looking for the command <code>new</code>, which in many languages means <i>allocate space for a new object (in your case) into an array</i>."}, {"owner": {"reputation": 32215, "user_id": 3789550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8mGqv.gif?s=128&g=1", "display_name": "heemayl", "link": "https://stackoverflow.com/users/3789550/heemayl"}, "edited": false, "score": 0, "creation_date": 1479193780, "post_id": 40603752, "comment_id": 68442795, "body": "Whats your goal? Define a struct and initiate values?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1479193940, "post_id": 40603752, "comment_id": 68442866, "body": "If you are new to Go: Take the Tour of Go. You will learn much more and faster than asking here. Your problem is covered in <a href=\"https://tour.golang.org/moretypes/6\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/6</a> and the following handful of pges."}, {"owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1479194384, "post_id": 40603752, "comment_id": 68443083, "body": "Thanks Volker. I  learned how to do this from your link..I will learn from tour of go lang first  .It seems a good documentation...."}], "answers": [{"tags": [], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "is_accepted": false, "score": 0, "last_activity_date": 1479206832, "creation_date": 1479206832, "answer_id": 40607857, "question_id": 40603752, "link": "https://stackoverflow.com/questions/40603752/need-help-in-storing-in-the-array-struct/40607857#40607857", "title": "Need help in storing in the array struct", "body": "<p>Following approach might be the one you are looking.</p>\n\n<pre><code>package main\nimport (\"fmt\")\ntype YourType struct {\n    Name, Value string\n}\nvar ListOfTypes=[]YourType{\n    {Name:\"NameOne\",Value:\"ValueOne\"},\n    {Name:\"NameTwo\",Value:\"ValueTwo\"},\n}\nfunc main() {\n    fmt.Println(ListOfTypes[0]) // This will print {NameOne ValueOne}\n    ListOfTypes[0].Name=\"NewValue\"\n    fmt.Println(ListOfTypes[0]) //{NewValue ValueOne}\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32215, "user_id": 3789550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8mGqv.gif?s=128&g=1", "display_name": "heemayl", "link": "https://stackoverflow.com/users/3789550/heemayl"}, "edited": false, "score": 1, "creation_date": 1479208893, "post_id": 40607935, "comment_id": 68451449, "body": "Thats technically a slice, not an array."}, {"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "reply_to_user": {"reputation": 32215, "user_id": 3789550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8mGqv.gif?s=128&g=1", "display_name": "heemayl", "link": "https://stackoverflow.com/users/3789550/heemayl"}, "edited": false, "score": 0, "creation_date": 1479211439, "post_id": 40607935, "comment_id": 68453079, "body": "Yep that&#39;s true, my bad. I&#39;m mixing between C and Go."}], "tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": false, "score": 3, "last_activity_date": 1479475825, "last_edit_date": 1479475825, "creation_date": 1479207062, "answer_id": 40607935, "question_id": 40603752, "link": "https://stackoverflow.com/questions/40603752/need-help-in-storing-in-the-array-struct/40607935#40607935", "title": "Need help in storing in the array struct", "body": "<p>Firstly you have to declare a type of struct outside of the main scope :</p>\n\n<pre><code>type myStruct struct {\n   Name  string\n   Value string\n}\n</code></pre>\n\n<p>Then you say to go, \"i want an slice of x of this struct\" : </p>\n\n<pre><code>list := make([]myStruct, 5)\n</code></pre>\n\n<p>Then you just fill your struct with the right index : </p>\n\n<pre><code>list[0].Name = \"12\"\nlist[0].Value = \"123\"\n</code></pre>\n"}], "owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479475825, "creation_date": 1479192777, "last_edit_date": 1479212963, "question_id": 40603752, "link": "https://stackoverflow.com/questions/40603752/need-help-in-storing-in-the-array-struct", "title": "Need help in storing in the array struct", "body": "<p>I m a beginner in programming and right now I'm learning go lang and this question might be simple. I have a declaration as follows:</p>\n\n<pre><code>var list []struct {\n    Name    string\n    Value string\n}\n</code></pre>\n\n<p>The problem is I don't know how to initialize a variable inside this. Appreciate any help.</p>\n\n<p>I have tried </p>\n\n<pre><code>    list[0].Name=\"12\"\n    list[0].Value=\"123\"\n    // this throws an index out of range exception..\n</code></pre>\n"}, {"tags": ["go", "rethinkdb"], "answers": [{"tags": [], "owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "is_accepted": true, "score": 2, "last_activity_date": 1479236912, "creation_date": 1479236912, "answer_id": 40617801, "question_id": 40602933, "link": "https://stackoverflow.com/questions/40602933/how-to-make-circle-in-go-using-gorethinkdbs-geospatial-commands/40617801#40617801", "title": "How to make circle in go using gorethinkdb&#39;s geospatial commands", "body": "<p>In this particular case, you can use <a href=\"https://godoc.org/github.com/dancannon/gorethink#Circle\" rel=\"nofollow noreferrer\">r.Circle</a> as follows:</p>\n\n<pre><code>import r \"gopkg.in/dancannon/gorethink.v2\"\n...\n\nr.Circle(r.Point(-117.220406, 32.719464), r.Expr(10), r.CircleOpts{Unit: \"mi\"})\n</code></pre>\n\n<p>You can check out more examples directly from the <a href=\"https://godoc.org/github.com/dancannon/gorethink\" rel=\"nofollow noreferrer\">documentation</a></p>\n"}], "owner": {"reputation": 31, "user_id": 7146134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbf644ed3ffdf7ee99d075707acf546?s=128&d=identicon&r=PG&f=1", "display_name": "user7146134", "link": "https://stackoverflow.com/users/7146134/user7146134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 40617801, "answer_count": 1, "score": 2, "last_activity_date": 1479236912, "creation_date": 1479189136, "question_id": 40602933, "link": "https://stackoverflow.com/questions/40602933/how-to-make-circle-in-go-using-gorethinkdbs-geospatial-commands", "title": "How to make circle in go using gorethinkdb&#39;s geospatial commands", "body": "<p>How to write the following code in go using <a href=\"https://github.com/dancannon/gorethink\" rel=\"nofollow noreferrer\">gorethinkdb</a></p>\n\n<pre><code>r.circle([-117.220406,32.719464], 10, {:unit =&gt; 'mi'})\n</code></pre>\n"}, {"tags": ["go", "markdown", "hugo"], "answers": [{"tags": [], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "is_accepted": false, "score": 5, "last_activity_date": 1479210504, "creation_date": 1479210504, "answer_id": 40609119, "question_id": 40602050, "link": "https://stackoverflow.com/questions/40602050/markdown-support-in-hugo-blog-posts-title/40609119#40609119", "title": "Markdown support in hugo blog post&#39;s title?", "body": "<p>You could use</p>\n\n<pre><code>{{ .Title | markdownify }}\n</code></pre>\n\n<p>in your layout that is generating the title. It is usually found at <code>layouts/</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 3244118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pgf07.jpg?s=128&g=1", "display_name": "DudeWhoCode", "link": "https://stackoverflow.com/users/3244118/dudewhocode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479210504, "creation_date": 1479184126, "question_id": 40602050, "link": "https://stackoverflow.com/questions/40602050/markdown-support-in-hugo-blog-posts-title", "title": "Markdown support in hugo blog post&#39;s title?", "body": "<p>Hugo has its front matter where it supports TOML format.</p>\n\n<blockquote>\n  <p>+++<br>\n   date = \"2016-11-15T09:36:44+05:30\"<br>\n   draft = true<br>\n   title = \"Grab it for <s>$100</s> $40\"<br>\n   +++</p>\n</blockquote>\n\n<p>Here I used <code>&lt;s&gt;$100&lt;/s&gt;</code> to strike through $100,  but I am unable to do the same in hugo post, inside that front matter. So Hugo doesn't support markdown in title?, Is there any workaround for it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 689, "user_id": 1081900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60c67510f2b108f7a768b0960979aa0?s=128&d=identicon&r=PG", "display_name": "oldmonk", "link": "https://stackoverflow.com/users/1081900/oldmonk"}, "edited": false, "score": 0, "creation_date": 1479188550, "post_id": 40601862, "comment_id": 68440598, "body": "How about to use a nginx as a proxy server for your go server? Then time taken could be logged into nginx access logs."}, {"owner": {"reputation": 795, "user_id": 3041613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061da320c11b785e534f4fcc2ecfc6ac?s=128&d=identicon&r=PG&f=1", "display_name": "Artorias", "link": "https://stackoverflow.com/users/3041613/artorias"}, "reply_to_user": {"reputation": 689, "user_id": 1081900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60c67510f2b108f7a768b0960979aa0?s=128&d=identicon&r=PG", "display_name": "oldmonk", "link": "https://stackoverflow.com/users/1081900/oldmonk"}, "edited": false, "score": 0, "creation_date": 1479189776, "post_id": 40601862, "comment_id": 68441055, "body": "however that&#39;s exactly what I am trying to do, replacing nginx..."}], "answers": [{"comments": [{"owner": {"reputation": 795, "user_id": 3041613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061da320c11b785e534f4fcc2ecfc6ac?s=128&d=identicon&r=PG&f=1", "display_name": "Artorias", "link": "https://stackoverflow.com/users/3041613/artorias"}, "edited": false, "score": 0, "creation_date": 1479195500, "post_id": 40603506, "comment_id": 68443611, "body": "so I have to modify the standard library in order to get the time used? That seems not to be very desirable."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 795, "user_id": 3041613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061da320c11b785e534f4fcc2ecfc6ac?s=128&d=identicon&r=PG&f=1", "display_name": "Artorias", "link": "https://stackoverflow.com/users/3041613/artorias"}, "edited": false, "score": 0, "creation_date": 1479195622, "post_id": 40603506, "comment_id": 68443674, "body": "The best option without doing that is to use a middleware. But the time won&#39;t be as accurate as it would return the duration of processing the request / response not the actual time between writes."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 795, "user_id": 3041613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061da320c11b785e534f4fcc2ecfc6ac?s=128&d=identicon&r=PG&f=1", "display_name": "Artorias", "link": "https://stackoverflow.com/users/3041613/artorias"}, "edited": false, "score": 0, "creation_date": 1479206272, "post_id": 40603506, "comment_id": 68449870, "body": "@wachiu I have updated the answer with the best you can do in your current code."}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 12, "last_activity_date": 1479206248, "last_edit_date": 1479206248, "creation_date": 1479191666, "answer_id": 40603506, "question_id": 40601862, "link": "https://stackoverflow.com/questions/40601862/golang-http-handler-time-taken-for-request/40603506#40603506", "title": "Golang http handler - time taken for request", "body": "<p>The easier but not as accurate way to do it would be using a middleware to wrap your handler function.</p>\n\n<pre><code>func timer(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        startTime := time.Now()\n        h.ServeHTTP(w, r)\n        duration := time.Now().Sub(startTime)\n    })\n}\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>http.Handle(\"/route\",timer(yourHandler))\n</code></pre>\n\n<p>This is more accurately the time taken to process the request and form the response and not the time between writes.</p>\n\n<hr>\n\n<p>If you absolutely need a more accurate duration then the parts of code you're looking to change reside in the <code>net/http</code> package.</p>\n\n<p>It would be around <a href=\"https://golang.org/src/net/http/server.go?s=70171:70186#L2270\" rel=\"noreferrer\">here</a>.</p>\n\n<p>The highlighted line <code>go c.serve(ctx)</code> is where the the go routine for serving the request is spawned.</p>\n\n<pre><code>for {\n    rw, e := l.Accept()\n    if e != nil {\n        if ne, ok := e.(net.Error); ok &amp;&amp; ne.Temporary() {\n            if tempDelay == 0 {\n                tempDelay = 5 * time.Millisecond\n            } else {\n                tempDelay *= 2\n            }\n            if max := 1 * time.Second; tempDelay &gt; max {\n                tempDelay = max\n            }\n            srv.logf(\"http: Accept error: %v; retrying in %v\", e, tempDelay)\n            time.Sleep(tempDelay)\n            continue\n        }\n        return e\n    }\n    tempDelay = 0\n\n    c := srv.newConn(rw)\n    c.setState(c.rwc, StateNew) // before Serve can return\n</code></pre>\n\n<blockquote>\n<pre><code>    go func(){\n          startTime := time.Now()\n          c.serve(ctx)\n          duration := time.Now().Sub(startTime)\n    }()\n</code></pre>\n</blockquote>\n\n<pre><code>}\n</code></pre>\n\n<p>Note : The request actually gets written in the <code>net.Conn</code> somewhere inside <code>l.Accept()</code> but the highlighted point is the only place where we can have the approximate start time and end time within the same scope in the code. </p>\n"}], "owner": {"reputation": 795, "user_id": 3041613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061da320c11b785e534f4fcc2ecfc6ac?s=128&d=identicon&r=PG&f=1", "display_name": "Artorias", "link": "https://stackoverflow.com/users/3041613/artorias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4587, "favorite_count": 0, "accepted_answer_id": 40603506, "answer_count": 1, "score": 8, "last_activity_date": 1543983047, "creation_date": 1479182913, "last_edit_date": 1479195580, "question_id": 40601862, "link": "https://stackoverflow.com/questions/40601862/golang-http-handler-time-taken-for-request", "title": "Golang http handler - time taken for request", "body": "<p>I am trying to set a timer to count how much time is needed for my server to finish a request and I want the timer to stop after the last byte of the response is sent. </p>\n\n<p>I found that the http server will only send the response after the handler function returns. </p>\n\n<p>Is there any way to add a callback after the response is sent ? </p>\n\n<p>Or is there a better way to count the time taken from the first byte of the request coming in till the last byte byte of the response is sent ?</p>\n"}, {"tags": ["go", "content-type", "net-http"], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 1, "last_activity_date": 1479185646, "creation_date": 1479185646, "answer_id": 40602297, "question_id": 40601725, "link": "https://stackoverflow.com/questions/40601725/golang-net-http-detectcontenttype-error/40602297#40602297", "title": "Golang \u201cnet/http\u201d DetectContentType error", "body": "<p>The standard library's code is only supposed to detect certain types (like HTML that contains one of a few common tags) according to a certain standardized algorithm--more in <a href=\"https://golang.org/src/net/http/sniff.go\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/sniff.go</a>. You could use <a href=\"https://godoc.org/github.com/rakyll/magicmime\" rel=\"nofollow noreferrer\">github.com/rakyll/magicmime</a>, which uses libmagic and cgo to guess at more file types.</p>\n"}], "owner": {"reputation": 219, "user_id": 7159949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7a4bbgbd3xc/AAAAAAAAAAI/AAAAAAAAA1w/BxjeuF93Zk8/photo.jpg?sz=128", "display_name": "lindsay show", "link": "https://stackoverflow.com/users/7159949/lindsay-show"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1215, "favorite_count": 0, "accepted_answer_id": 40602297, "answer_count": 1, "score": 0, "last_activity_date": 1479481821, "creation_date": 1479181980, "last_edit_date": 1479481821, "question_id": 40601725, "link": "https://stackoverflow.com/questions/40601725/golang-net-http-detectcontenttype-error", "title": "Golang \u201cnet/http\u201d DetectContentType error", "body": "<p>Use <code>DetectContentType</code> to detect the uploaded file <code>content-type</code>, but the result is always <code>application/octet-stream</code>.this is just the default return in this function.</p>\n\n<p>So what's the problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1479173757, "post_id": 40600569, "comment_id": 68436881, "body": "From the docs &quot;Stop the ticker to release associated resources.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 1299930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67005382b9156d5db68cc3bc4d78ed4e?s=128&d=identicon&r=PG", "display_name": "theeddieh", "link": "https://stackoverflow.com/users/1299930/theeddieh"}, "edited": false, "score": 0, "creation_date": 1479202491, "post_id": 40605142, "comment_id": 68447356, "body": "In this case, trying to close the channel gives the following error: <code>cannot close receive-only channel</code>. <a href=\"https://stackoverflow.com/questions/8593645/is-it-ok-to-leave-a-channel-open\">This question</a> indicates that it is not necessary to close every channel, that the garbage collector wil pick up that <code>oldTicker.C</code> can be cleaned up. My concern is that if this runs for a while there will be many <code>oldTicker</code>s left around."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 449, "user_id": 1299930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67005382b9156d5db68cc3bc4d78ed4e?s=128&d=identicon&r=PG", "display_name": "theeddieh", "link": "https://stackoverflow.com/users/1299930/theeddieh"}, "edited": false, "score": 0, "creation_date": 1479205719, "post_id": 40605142, "comment_id": 68449512, "body": "Sorry about that. The answer you linked to is right. &#39;timer.C&#39; is  a receive only channel <code>&lt;-chan Time</code>. The last part of the answer is wrong."}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 2, "last_activity_date": 1479266531, "last_edit_date": 1479266531, "creation_date": 1479198508, "answer_id": 40605142, "question_id": 40600569, "link": "https://stackoverflow.com/questions/40600569/do-i-need-to-explicitly-stop-a-ticker-whose-reference-has-been-reassigned/40605142#40605142", "title": "Do I need to explicitly stop a ticker whose reference has been reassigned?", "body": "<p>As <code>JimB</code> mentioned as per <code>time</code> package GoDoc.</p>\n\n<p>Under <a href=\"https://golang.org/pkg/time/#NewTicker\" rel=\"nofollow noreferrer\"><code>time.NewTicker</code></a>, the following is mentioned.</p>\n\n<blockquote>\n  <p>Stop the ticker to release associated resources.</p>\n</blockquote>\n\n<p>Provided you run <code>oldTimer.Stop()</code>, <code>oldTicker</code> will get garbage collected after exiting the case statement as it's out of scope.</p>\n"}], "owner": {"reputation": 449, "user_id": 1299930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67005382b9156d5db68cc3bc4d78ed4e?s=128&d=identicon&r=PG", "display_name": "theeddieh", "link": "https://stackoverflow.com/users/1299930/theeddieh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 40605142, "answer_count": 1, "score": 3, "last_activity_date": 1479266531, "creation_date": 1479173060, "question_id": 40600569, "link": "https://stackoverflow.com/questions/40600569/do-i-need-to-explicitly-stop-a-ticker-whose-reference-has-been-reassigned", "title": "Do I need to explicitly stop a ticker whose reference has been reassigned?", "body": "<p>I'm using <code>time.Ticker</code> to do some stuff at a regular interval. I want to be able to change the frequency that <code>stuff</code> happens at:</p>\n\n<pre><code>for {\n        select {\n        case &lt;-ticker.C:\n            //do stuff\n        case t := &lt;-newTicker:\n            oldTicker := ticker\n            ticker = t\n            oldTicker.Stop()\n        }\n    }\n</code></pre>\n\n<p>Do I need that ticker cleanup to avoid a memory leak, or will reassigning <code>ticker</code> like </p>\n\n<pre><code>case ticker := &lt;-newTicker:\n</code></pre>\n\n<p>be enough?</p>\n"}, {"tags": ["http", "go", "memory-leaks"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1479173707, "post_id": 40600463, "comment_id": 68436869, "body": "memory leaks in Golang ??"}, {"owner": {"reputation": 378, "user_id": 4584060, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f92ddb544499541e5451d408832ac134?s=128&d=identicon&r=PG&f=1", "display_name": "RuslanN", "link": "https://stackoverflow.com/users/4584060/ruslann"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 2, "creation_date": 1479174232, "post_id": 40600463, "comment_id": 68436997, "body": "@YandryPozo What does confuse you? Memory leaks are very possible in Golang."}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 1, "creation_date": 1479178428, "post_id": 40600463, "comment_id": 68437849, "body": "What would you do with the returned response if you set a blank identifier? How would you close it?"}], "answers": [{"comments": [{"owner": {"reputation": 378, "user_id": 4584060, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f92ddb544499541e5451d408832ac134?s=128&d=identicon&r=PG&f=1", "display_name": "RuslanN", "link": "https://stackoverflow.com/users/4584060/ruslann"}, "edited": false, "score": 0, "creation_date": 1479217492, "post_id": 40602547, "comment_id": 68456929, "body": "Thanks. I know that it is needed to close the response body to reclaim the resources but from my understanding of blank identifier documentation it disregards the data almost like writing to  /dev/null. Can you give me a link about that or maybe make go playground POC?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479226515, "post_id": 40602547, "comment_id": 68463288, "body": "You might note that you also need to read the body in full to ensure that the connection can be reused by the transport."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1479229694, "last_edit_date": 1479229694, "creation_date": 1479187163, "answer_id": 40602547, "question_id": 40600463, "link": "https://stackoverflow.com/questions/40600463/is-it-enough-to-use-blank-identifier-for-http-response-to-prevent-memory-leaks-i/40602547#40602547", "title": "Is it enough to use blank identifier for http.Response to prevent memory leaks in Golang?", "body": "<p>The application must close the response body to reclaim the resources used by the underlying network connection. To enable reuse of the underlying connection, the application must read the response body before closing.</p>\n\n<p>Assigning the response to the blank identifier will not close the connection. </p>\n\n<p>There are no side effects for assignments, including assignments to the blank identifier.</p>\n\n<p><a href=\"https://play.golang.org/p/mNDiyFxZdh\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 378, "user_id": 4584060, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f92ddb544499541e5451d408832ac134?s=128&d=identicon&r=PG&f=1", "display_name": "RuslanN", "link": "https://stackoverflow.com/users/4584060/ruslann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 40602547, "answer_count": 1, "score": 2, "last_activity_date": 1479229694, "creation_date": 1479172168, "question_id": 40600463, "link": "https://stackoverflow.com/questions/40600463/is-it-enough-to-use-blank-identifier-for-http-response-to-prevent-memory-leaks-i", "title": "Is it enough to use blank identifier for http.Response to prevent memory leaks in Golang?", "body": "<p>For example, I am making a post request and I don't need the response object at all.</p>\n\n<pre><code>_, err := http.Post(url, \"\", &amp;buf)\n</code></pre>\n\n<p>Am I safe from memory leak in that case? Will the response.Body be drained for proper connection reuse? Or I need to do the usual <code>defer resp.Body.Close()</code> thing?</p>\n"}, {"tags": ["http", "go", "request"], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 1580766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32f5585916c55d908b8486118f82be56?s=128&d=identicon&r=PG", "display_name": "Mikhail Kochegarov", "link": "https://stackoverflow.com/users/1580766/mikhail-kochegarov"}, "is_accepted": false, "score": 0, "last_activity_date": 1479196267, "creation_date": 1479196267, "answer_id": 40604607, "question_id": 40599775, "link": "https://stackoverflow.com/questions/40599775/go-use-different-handlers-or-inject-variables-into-request-context/40604607#40604607", "title": "Go: use different handlers or inject variables into request Context?", "body": "<p>You probably could create some kind of Router which will provide ServeHTTP and do mapping between your real handlers and route paths.</p>\n\n<p>Something like this:</p>\n\n<pre><code>package main\n\nimport \"net/http\"\n\ntype Router struct {\n    routes map[string]func(rw http.ResponseWriter, r *http.Request)\n}\n\nfunc NewRouter() *Router {\n    var r Router\n    r.routes = make(map[string]func(rw http.ResponseWriter, r *http.Request))\n    return &amp;r\n}\n\nfunc (router *Router) addRoute(path string, f func(rw http.ResponseWriter, r *http.Request)) {\n    router.routes[path] = f\n}\n\nfunc (router *Router) ServeHTTP(rw http.ResponseWriter, r *http.Request) {\n    for route, serveHTTP := range router.routes {\n        if route == r.URL.Path {\n            serveHTTP(rw, r)\n            return\n        }\n    }\n    rw.WriteHeader(http.StatusNotFound)\n}\n\nfunc teapot(rw http.ResponseWriter, r *http.Request) {\n    rw.WriteHeader(http.StatusTeapot)\n}\n\nfunc ok(rw http.ResponseWriter, r *http.Request) {\n    rw.WriteHeader(http.StatusOK)\n}\n\nfunc main() {\n    r := NewRouter()\n    r.addRoute(\"/teapot\", teapot)\n    r.addRoute(\"/ok\", ok)\n\n    http.ListenAndServe(\"localhost:8080\", r)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "is_accepted": true, "score": 2, "last_activity_date": 1479197865, "last_edit_date": 1479197865, "creation_date": 1479197049, "answer_id": 40604777, "question_id": 40599775, "link": "https://stackoverflow.com/questions/40599775/go-use-different-handlers-or-inject-variables-into-request-context/40604777#40604777", "title": "Go: use different handlers or inject variables into request Context?", "body": "<p>As an alternative to creating all these handler types, you can have functions which return other functions (<a href=\"https://golang.org/pkg/net/http/#HandlerFunc\" rel=\"nofollow noreferrer\">http.HandlerFunc</a>). This way, you will create a closure and can access the parameters when the request arrives in the handler. For example:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc SomeHandler(conf SomeConfig, service SomeService) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        fmt.Fprintf(w, \"foobar config: %q\", conf)\n    }\n}\n\nfunc main() {\n    // TODO: initialise your conf &amp; service\n    http.HandleFunc(\"/somepath\", SomeHandler(conf, service))\n}\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 2681565, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c2e8a18c9f769a0ef3ecdd58559df2b?s=128&d=identicon&r=PG", "display_name": "Henrique Dias", "link": "https://stackoverflow.com/users/2681565/henrique-dias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 40604777, "answer_count": 2, "score": 1, "last_activity_date": 1479197865, "creation_date": 1479167306, "question_id": 40599775, "link": "https://stackoverflow.com/questions/40599775/go-use-different-handlers-or-inject-variables-into-request-context", "title": "Go: use different handlers or inject variables into request Context?", "body": "<p>I have an Handler like this:</p>\n\n<pre><code>type handler struct {\n    Services *domain.Services\n    Config *domain.Config\n}\n</code></pre>\n\n<p>And then, a lot of new types (they can be twenty or more), like this:</p>\n\n<pre><code>type Handler1 handler\ntype Handler2 handler\n</code></pre>\n\n<p>And each one has a <code>ServeHTTP</code> method. And I use this so they can access the Services and Config variables. </p>\n\n<p>They are being used in routes like this:</p>\n\n<pre><code>r.Handle(\"/login\", &amp;h.Handler1{\n    Services: s,\n    Config: c,\n})\n</code></pre>\n\n<p>My question is: should I create all of this structs or just create a function that injects the Services and Config into the request Context and then I access them using <code>r.Context().Value()</code>?</p>\n\n<p>I thought about doing this:</p>\n\n<pre><code>func handler1(w http.ResponseWriter, r *http.Request) {\n    s, c := r.Context().Value(\"services\"), r.Context().Value(\"config\")\n    // My code\n}\n\nr.HandleFunc(\"/login\", inject(handler1, s, c))\n</code></pre>\n\n<p>What's the best/recommended?</p>\n"}, {"tags": ["go", "docker", "containers"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479162712, "post_id": 40598804, "comment_id": 68433457, "body": "I&#39;m not sure how this client api is used, but why are you supplying an <code>http.Client</code> when you&#39;re only connecting to a <code>tcp:&#47;&#47;</code> protocol?"}, {"owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1479162852, "post_id": 40598804, "comment_id": 68433513, "body": "2375 is the HTTP port. 2376 is the default HTTPS port."}], "answers": [{"comments": [{"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1487705388, "post_id": 40900381, "comment_id": 71901615, "body": "Note that running your docker daemon without TLS and listening on a port is the same as enabling telnet with root and not setting a password on the root user. I wouldn&#39;t recommend doing this, anywhere, ever."}, {"owner": {"reputation": 169, "user_id": 6221280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/62b05c078c911318507b89317a9b794f?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6221280/rajesh"}, "reply_to_user": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1487789320, "post_id": 40900381, "comment_id": 71946708, "body": "Yerek, Thans. I understand that, but as you can see I was just getting started back then."}, {"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1487795005, "post_id": 40900381, "comment_id": 71949965, "body": "Yup, just saw it pop up with the edit. There&#39;s lots of bad examples out on the internet, so I just wanted to be sure this came with a warning label before someone blindly copy/paste."}], "tags": [], "owner": {"reputation": 169, "user_id": 6221280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/62b05c078c911318507b89317a9b794f?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6221280/rajesh"}, "is_accepted": true, "score": -1, "last_activity_date": 1487696404, "last_edit_date": 1487696404, "creation_date": 1480550135, "answer_id": 40900381, "question_id": 40598804, "link": "https://stackoverflow.com/questions/40598804/docker-api-call-returns-server-gave-http-response-to-https-client/40900381#40900381", "title": "Docker API call returns &quot;server gave HTTP response to HTTPS client&quot;", "body": "<pre><code>func main() {\n    var headers map[string]string\n\n    tr := &amp;http.Transport{} &lt;---- Note the difference here. \n\n    tr.Dial = func(proto, addr string) (net.Conn, error) {\n        fmt.Println(\"Dial called\")\n        conn, err := net.DialTimeout(proto, addr, time.Minute)\n        if err != nil {\n            fmt.Println(\"There was  an err\", err)\n        }\n        return conn, err\n    }\n\n    cl := &amp;http.Client{Transport: tr}\n    cli, err := client.NewClient(\"http://x.y.z.w:2376\", \"1.24\", cl, headers)\n    if err != nil {\n        panic(err)\n    }\n\n    containers, err := cli.ContainerList(context.Background(), types.ContainerListOptions{})\n    if err != nil {\n        panic(err)\n    }\n\n    for _, container := range containers {\n        fmt.Printf(\"%s %s\\n\", container.ID[:10], container.Image)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 6221280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/62b05c078c911318507b89317a9b794f?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6221280/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2753, "favorite_count": 0, "accepted_answer_id": 40900381, "answer_count": 1, "score": 0, "last_activity_date": 1487696404, "creation_date": 1479162084, "question_id": 40598804, "link": "https://stackoverflow.com/questions/40598804/docker-api-call-returns-server-gave-http-response-to-https-client", "title": "Docker API call returns &quot;server gave HTTP response to HTTPS client&quot;", "body": "<p>I have the following Code and a Call to the API returns an error as follows, I hve also pasted Docker Daemon command below. I have tried a few combinations from HTTP/ HTTPS / TCP with / without TLS. </p>\n\n<p>Where could I be wrong here?</p>\n\n<p><em>\"panic: An error occurred trying to connect: Get <a href=\"https://172.28.8.212:2375/v1.24/containers/json?limit=0\" rel=\"nofollow noreferrer\">https://172.28.8.212:2375/v1.24/containers/json?limit=0</a>: http: server gave HTTP response to HTTPS client\n\"</em></p>\n\n<pre><code>func main() {\n    var headers map[string]string\n\n    tr := &amp;http.Transport{\n        TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n    }\n\n    cl := &amp;http.Client{Timeout: time.Minute}\n\n    cli, err := client.NewClient(\"tcp://172.28.8.212:2375\", \"1.24\", cl, headers)\n    if err != nil {\n        panic(err)\n    }\n\n    containers, err := cli.ContainerList(context.Background(), types.ContainerListOptions{})\n    if err != nil {\n        panic(err)\n    }\n\n    for _, container := range containers {\n        fmt.Printf(\"%s %s\\n\", container.ID[:10], container.Image)\n    }\n}\n</code></pre>\n\n<p>My Docker Daemon is started as follows </p>\n\n<pre><code>[Unit]\nDescription = Docker Service Daemon\n[Service]\nExecStart=/usr/bin/docker daemon -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock --cluster-store=consul://172.28.8.211:8500\n</code></pre>\n"}, {"tags": ["go", "getstream-io"], "comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 4, "creation_date": 1479155789, "post_id": 40597344, "comment_id": 68430181, "body": "<code>[&amp;UserFeed]</code> isn&#39;t legal syntax in go. If your adding an slice literal, which it looks like you&#39;re trying to do, then you need to do: <code>[]YourType{&amp;UserFeed}</code> which reads as <code>a slice of your type which is initialized to only have a single value in it which is set to the provided value</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3769, "user_id": 364024, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/97eb936641f63111d3a2a0a155386515?s=128&d=identicon&r=PG", "display_name": "iandouglas", "link": "https://stackoverflow.com/users/364024/iandouglas"}, "edited": false, "score": 1, "creation_date": 1479160992, "post_id": 40597505, "comment_id": 68432694, "body": "Thanks for the feedback, and apologies for the confusion. I&#39;ve updated some of the snippets on our Go documentation and just waiting for caching to expire so they&#39;ll go live soon."}], "tags": [], "owner": {"reputation": 57, "user_id": 1359658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ab0d38a001785f14556a9e1b98dcff?s=128&d=identicon&r=PG", "display_name": "Fyb3roptik", "link": "https://stackoverflow.com/users/1359658/fyb3roptik"}, "is_accepted": true, "score": 2, "last_activity_date": 1479156181, "creation_date": 1479156181, "answer_id": 40597505, "question_id": 40597344, "link": "https://stackoverflow.com/questions/40597344/golang-example-not-working-for-adding-activity/40597505#40597505", "title": "Golang example not working for adding Activity", "body": "<p>The TO field should look like this. Hope this helps someone:</p>\n\n<pre><code>To: []getstream.Feed{UserFeed}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 1359658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ab0d38a001785f14556a9e1b98dcff?s=128&d=identicon&r=PG", "display_name": "Fyb3roptik", "link": "https://stackoverflow.com/users/1359658/fyb3roptik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 40597505, "answer_count": 1, "score": 1, "last_activity_date": 1479156181, "creation_date": 1479155610, "question_id": 40597344, "link": "https://stackoverflow.com/questions/40597344/golang-example-not-working-for-adding-activity", "title": "Golang example not working for adding Activity", "body": "<p>I have tried to get this to work and am growing more and more frustrated. I have used the examples in the docs but they are throwing errors.</p>\n\n<p>Specifically this field:</p>\n\n<pre><code>To: [&amp;UserFeed]\n</code></pre>\n\n<p>Throws this error:</p>\n\n<pre><code>does not compile: expected type, found ','\n</code></pre>\n\n<p>Here is code snippet:</p>\n\n<pre><code>getstream_client, err := getstream.New(&amp;getstream.Config{\n    APIKey:      os.Getenv(\"STREAM_API_KEY\"),\n    APISecret:   os.Getenv(\"STREAM_API_SECRET\"),\n    AppID:       os.Getenv(\"STREAM_APP_ID\"),\n    Location:    \"us-west\",\n  })\n  if err != nil {\n    log.Println(\"ERR :\", err)\n  }\n\n    UserFeed, err := getstream_client.FlatFeed(\"user\", u.StreamId)\n    if err != nil {\n        return err\n    }\n    GlobalFeed, err := getstream_client.FlatFeed(\"user\", \"global\")\n    if err != nil {\n        return err\n    }\n    activity := &amp;getstream.Activity{\n        Actor: UserFeed.FeedID(),\n        ForeignID: uuid.New(),\n        To: [&amp;UserFeed],\n        Verb: \"attempt\",\n    };\n    activity, err = GlobalFeed.AddActivity(activity);\n    if err != nil {\n        return err\n    }\n</code></pre>\n"}, {"tags": ["angularjs", "mongodb", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1479150590, "post_id": 40595919, "comment_id": 68427597, "body": "<code>ExecuteTemplate</code> writes a response; you can&#39;t write another response header after that if <code>dup == &quot;true&quot;</code>. You also don&#39;t want to use <code>log.Fatal</code> in a web server, since a single request error could crash the server."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7158434, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/924069c15816b3725efced6b4b8a09c4?s=128&d=identicon&r=PG&f=1", "display_name": "Racket", "link": "https://stackoverflow.com/users/7158434/racket"}, "edited": false, "score": 0, "creation_date": 1479152324, "post_id": 40596259, "comment_id": 68428463, "body": "Thank you much appreciated"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 3, "last_activity_date": 1479151264, "creation_date": 1479151264, "answer_id": 40596259, "question_id": 40595919, "link": "https://stackoverflow.com/questions/40595919/http-multiple-response-writeheader-calls/40596259#40596259", "title": "http: multiple response.WriteHeader calls", "body": "<p>This line <code>err := tpl.ExecuteTemplate(w, \"index.html\", User{u, p, e, n})</code> should be the last thing you do since it will write to your response.</p>\n\n<p>If you want to handle any potential errors that you may encounter when you render <code>index.html</code> you can render the template by passing in a <code>bytes.Buffer</code></p>\n\n<pre><code>buf := &amp;bytes.Buffer{}\nif err := tpl.ExecuteTemplate(buf, \"index.html\", User{u, p, e, n}); err != nil {\n    log.Printf(\"Error rendering 'index.html' - error: %v\", err)\n    http.Error(w, \"Internal Server Error\", 500)\n    return\n}\n\n// Write your rendered template to the ResponseWriter\nw.Write(buf.Bytes())\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7158434, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/924069c15816b3725efced6b4b8a09c4?s=128&d=identicon&r=PG&f=1", "display_name": "Racket", "link": "https://stackoverflow.com/users/7158434/racket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479158265, "creation_date": 1479150038, "last_edit_date": 1479158265, "question_id": 40595919, "link": "https://stackoverflow.com/questions/40595919/http-multiple-response-writeheader-calls", "title": "http: multiple response.WriteHeader calls", "body": "<p>I am currently receiving this <code>http: multiple response.WriteHeader calls</code> error while trying to send back a response to Angular. The main thing I'm doing is sending a post request from Angular to Go. Go then inserts the data received into mongoDB, but if the username already exists I change <code>dup=\"true\"</code> and try to send a custom response.  </p>\n\n<pre><code>func Register(w http.ResponseWriter, req *http.Request) {\n\nu := req.FormValue(\"username\")\np := req.FormValue(\"password\")\ne := req.FormValue(\"email\")\nn := req.FormValue(\"name\")\n\nerr := tpl.ExecuteTemplate(w, \"index.html\", User{u, p, e, n})\nif err != nil {\n    http.Error(w, err.Error(), 500)\n    log.Fatalln(err)\n}\n\na := User{Username: u, Password: p, Email: e, Name: n}\nif a.Username != \"\" || a.Password != \"\" || a.Email != \"\" || a.Name != \"\" {\n    insert(a)\n    if dup == \"true\" {\n        w.WriteHeader(http.StatusInternalServerError)\n    }\n}}\n</code></pre>\n\n<p><code>w.WriteHeader(http.StatusInternalServerError)</code> is just an example; if I use anything with write header I get the same <code>http: multiple response.WriteHeader calls</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479158727, "post_id": 40595563, "comment_id": 68431596, "body": "from the search docs <code>Search uses binary search to find and return the smallest index i in [0, n) at which f(i) is true</code>. If you want to test if the item is in the list, you must check that separately. From the example in the same documentation section: <code>If the caller wants to find whether 23 is in the slice, it must test data[i] == 23 separately</code>"}, {"owner": {"reputation": 7400, "user_id": 139637, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/452808dcde6558ad24d44be6fb8babc5?s=128&d=identicon&r=PG", "display_name": "Custodio", "link": "https://stackoverflow.com/users/139637/custodio"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479159162, "post_id": 40595563, "comment_id": 68431788, "body": "Awesome! This explain <code>data[i] == x</code> at the end of the if check. Great stuff."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1479149877, "last_edit_date": 1479149877, "creation_date": 1479149432, "answer_id": 40595743, "question_id": 40595563, "link": "https://stackoverflow.com/questions/40595563/handle-not-found-when-searching-string-in-slice/40595743#40595743", "title": "Handle not found when searching string in slice", "body": "<p>A binary search requires a greater than or less than comparison, otherwise it would just be a linear search over the slice. Any comparison greater than the value at the requested index needs to be true, in order for the search method to scan backwards looking for the smallest index.</p>\n\n<p>See the default implementation of the string search function from the sort package:</p>\n\n<p><a href=\"https://golang.org/src/sort/search.go?s=3673:3717#L91\" rel=\"nofollow noreferrer\">https://golang.org/src/sort/search.go?s=3673:3717#L91</a></p>\n\n<pre><code>func SearchStrings(a []string, x string) int {\n    return Search(len(a), func(i int) bool { return a[i] &gt;= x })\n}\n</code></pre>\n"}], "owner": {"reputation": 7400, "user_id": 139637, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/452808dcde6558ad24d44be6fb8babc5?s=128&d=identicon&r=PG", "display_name": "Custodio", "link": "https://stackoverflow.com/users/139637/custodio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 40595743, "answer_count": 1, "score": -1, "last_activity_date": 1479159401, "creation_date": 1479148758, "last_edit_date": 1479159401, "question_id": 40595563, "link": "https://stackoverflow.com/questions/40595563/handle-not-found-when-searching-string-in-slice", "title": "Handle not found when searching string in slice", "body": "<p>Based on this fairly simple code based on the <a href=\"https://golang.org/src/sort/search.go\" rel=\"nofollow noreferrer\">sort package</a>. The response index of <code>o1</code> is invalid as pointed by @JimB because a bigger or equals operator is required for binary search</p>\n\n<pre><code>l := []string{\"o1\", \"o2\", \"o3\"} \n\ni1 := sort.Search(len(l), func(i int) bool { return strings.EqualFold(l[i], \"o1\") })\nfmt.Println(\"o1:\", i1) //PRINTS 3 - WRONG\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nUs-ozTYsY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/nUs-ozTYsY</a></p>\n\n<p>The working solution is:</p>\n\n<pre><code>l := []string{\"o1\", \"o2\", \"o3\"} \n\ni1 := sort.Search(len(l), func(i int) bool { return l[i] &gt;= \"o1\" })\nfmt.Println(\"o1:\", i1)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/WRsijy_xzV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/WRsijy_xzV</a></p>\n\n<p>However this still it's important to bare in mind a important last check. <code>The return value is the index to insert x</code>, which means that you can end up with something like:</p>\n\n<pre><code>o1: 0 (index 0)\no2: 1\no3: 2\no777: 0 (Same 0 index!) \n</code></pre>\n\n<p>Therefore it's important as pointed by @JimB to check for <code>data[i] == 23</code> separately.</p>\n\n<pre><code>if i &lt; len(data) &amp;&amp; ---&gt; data[i] == x &lt;--- {\n    x is present at data[i]\n} else {\n    ...\n}\n</code></pre>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 2138, "user_id": 2315473, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e611302f4eae2c6ddc4c6221b882bf69?s=128&d=identicon&r=PG&f=1", "display_name": "sunkuet02", "link": "https://stackoverflow.com/users/2315473/sunkuet02"}, "edited": false, "score": 2, "creation_date": 1479128934, "post_id": 40589353, "comment_id": 68414278, "body": "<a href=\"https://golang.org/pkg/time/#Time.AddDate\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#Time.AddDate</a>  AddDate() function added years, months and days to time"}], "answers": [{"comments": [{"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 2, "creation_date": 1565503012, "post_id": 40589592, "comment_id": 101371026, "body": "This no longer answers the question. (I can see how it might have been an answer for the first version, before edits)."}], "tags": [], "owner": {"reputation": 32215, "user_id": 3789550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8mGqv.gif?s=128&g=1", "display_name": "heemayl", "link": "https://stackoverflow.com/users/3789550/heemayl"}, "is_accepted": false, "score": 7, "last_activity_date": 1479129123, "creation_date": 1479129123, "answer_id": 40589592, "question_id": 40589353, "link": "https://stackoverflow.com/questions/40589353/adding-hours-minutes-seconds-to-current-time/40589592#40589592", "title": "Adding hours, minutes, seconds to current time", "body": "<p><code>AddDate</code> takes (and adds) year, month, day as parameters, not hour, minute, second.</p>\n\n<p>From <a href=\"https://golang.org/pkg/time/#Time.AddDate\" rel=\"noreferrer\">https://golang.org/pkg/time/#Time.AddDate</a>:</p>\n\n<pre><code>func (t Time) AddDate(years int, months int, days int) Time\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1209, "user_id": 5003199, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-FEsljcRevSs/AAAAAAAAAAI/AAAAAAAADTA/NQAif-AeXYU/photo.jpg?sz=128", "display_name": "joshii_h", "link": "https://stackoverflow.com/users/5003199/joshii-h"}, "edited": false, "score": 0, "creation_date": 1479135999, "post_id": 40589596, "comment_id": 68419068, "body": "Thank you for the fast response!"}, {"owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "edited": false, "score": 0, "creation_date": 1527408902, "post_id": 40589596, "comment_id": 88111415, "body": "what is that := symbol?"}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 1, "creation_date": 1527426191, "post_id": 40589596, "comment_id": 88115611, "body": "Syntactic sugar for declaring and assigning a variable at the same time. Replaces var timein time.Time followed by timein = ..."}, {"owner": {"reputation": 2140, "user_id": 2463800, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f64864174529fc76f8e80786d1d082e8?s=128&d=identicon&r=PG", "display_name": "Trevin Avery", "link": "https://stackoverflow.com/users/2463800/trevin-avery"}, "edited": false, "score": 13, "creation_date": 1529538564, "post_id": 40589596, "comment_id": 88914309, "body": "Simplified: <code>timein := time.Now().Add(time.Hour * hours + time.Minute * mins + time.Second * sec)</code>"}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": true, "score": 155, "last_activity_date": 1489600196, "last_edit_date": 1489600196, "creation_date": 1479129139, "answer_id": 40589596, "question_id": 40589353, "link": "https://stackoverflow.com/questions/40589353/adding-hours-minutes-seconds-to-current-time/40589596#40589596", "title": "Adding hours, minutes, seconds to current time", "body": "<p>I guess what you are looking for is</p>\n\n<pre><code>timein := time.Now().Local().Add(time.Hour * time.Duration(Hours) +\n                                 time.Minute * time.Duration(Mins) +\n                                 time.Second * time.Duration(Sec))\n</code></pre>\n"}], "owner": {"reputation": 1209, "user_id": 5003199, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-FEsljcRevSs/AAAAAAAAAAI/AAAAAAAADTA/NQAif-AeXYU/photo.jpg?sz=128", "display_name": "joshii_h", "link": "https://stackoverflow.com/users/5003199/joshii-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85920, "favorite_count": 12, "accepted_answer_id": 40589596, "answer_count": 2, "score": 102, "last_activity_date": 1512661335, "creation_date": 1479128297, "last_edit_date": 1512661335, "question_id": 40589353, "link": "https://stackoverflow.com/questions/40589353/adding-hours-minutes-seconds-to-current-time", "title": "Adding hours, minutes, seconds to current time", "body": "<p>How do I add hours, minutes, and seconds (defined as ints) to the current time, similar to <code>AddDate</code>?</p>\n\n<pre><code>timein := time.Now().Local().AddDate(Hours, Mins, Sec)\n</code></pre>\n\n<p>but with hours, minutes, and seconds.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "edited": false, "score": 0, "creation_date": 1479123919, "post_id": 40587860, "comment_id": 68411121, "body": "why is it you need to unmarshal using easy json?"}], "answers": [{"comments": [{"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 4, "creation_date": 1479185358, "post_id": 40588324, "comment_id": 68439525, "body": "My json blob is quite big. <code>encoding&#47;json</code> seems to be quite slow. So trying out <code>easyjson</code> as they claim it to be 3x-5x faster than <code>encoding&#47;json</code>."}, {"owner": {"reputation": 1062, "user_id": 1235165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a00749a25d0ec2501ef174d92569?s=128&d=identicon&r=PG", "display_name": "hmijail mourns resignees", "link": "https://stackoverflow.com/users/1235165/hmijail-mourns-resignees"}, "edited": false, "score": 0, "creation_date": 1603079769, "post_id": 40588324, "comment_id": 113912405, "body": "@sadlil, why would it be &quot;better if you use encoding/json&quot;?"}], "tags": [], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "is_accepted": true, "score": 6, "last_activity_date": 1479185260, "last_edit_date": 1479185260, "creation_date": 1479124908, "answer_id": 40588324, "question_id": 40587860, "link": "https://stackoverflow.com/questions/40587860/using-easyjson-with-golang/40588324#40588324", "title": "Using EasyJSON with golang", "body": "<p>I don't know why you trying to use easyjson. encoding/json is pretty fine to work with. But though here is the answer for you.</p>\n\n<p>NB: <strong>It would be better if you use encoding/json.</strong></p>\n\n<pre><code>//easyjson:json\ntype JSONData struct {\n    Data []string\n}\n</code></pre>\n\n<p>After define this struct run <code>easyjson &lt;fileName-JSONData-is-defined&gt;.go</code>. this will create an extra go file containg</p>\n\n<pre><code>func (v JSONData) MarshalJSON() ([]byte, error)\nfunc (v JSONData) MarshalEasyJSON(w *jwriter.Writer)\nfunc (v *JSONData) UnmarshalJSON(data []byte) errorfunc (v *JSONData) \nfunc UnmarshalEasyJSON(l *jlexer.Lexer)\n</code></pre>\n\n<p>those methods.\nThen (un-)marshal using</p>\n\n<pre><code>d := &amp;JSONData{}\nd.UnmarshalJSON([]byte(`{\"Data\" : [\"One\", \"Two\", \"Three\"]} `))\n// Or you could also use\n// json.Unmarshal(data, d) this will also call this d.UnmarshalJSON\nfmt.Println(d)\n</code></pre>\n\n<p>A full example is <a href=\"https://github.com/sadlil/experiments/tree/master/go/easyjson\" rel=\"noreferrer\">here.</a></p>\n"}, {"comments": [{"owner": {"reputation": 942, "user_id": 7147393, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nonlb.jpg?s=128&g=1", "display_name": "Russiancold", "link": "https://stackoverflow.com/users/7147393/russiancold"}, "edited": false, "score": 1, "creation_date": 1547061440, "post_id": 40588452, "comment_id": 95066460, "body": "You are using encoding/json&#39;s Unmarshal, not generated."}], "tags": [], "owner": {"reputation": 60, "user_id": 4511332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSgP7.jpg?s=128&g=1", "display_name": "James Pudney", "link": "https://stackoverflow.com/users/4511332/james-pudney"}, "is_accepted": false, "score": -1, "last_activity_date": 1479125367, "creation_date": 1479125367, "answer_id": 40588452, "question_id": 40587860, "link": "https://stackoverflow.com/questions/40587860/using-easyjson-with-golang/40588452#40588452", "title": "Using EasyJSON with golang", "body": "<p>I installed using the instructions from the README.md file:</p>\n\n<blockquote>\n  <p>go get github.com/mailru/easyjson/...</p>\n</blockquote>\n\n<p>Then I created a directory in my GOPATH for this example:</p>\n\n<blockquote>\n  <p>$GOPATH/github.com/jpudney/stack-overflow/40587860</p>\n</blockquote>\n\n<pre><code>tree  .                                              \n.\n\u251c\u2500\u2500 main.go\n\u2514\u2500\u2500 mypackage\n    \u251c\u2500\u2500 example.go\n    \u2514\u2500\u2500 example_easyjson.go\n</code></pre>\n\n<p>In mypackage/example.go I have the following code:</p>\n\n<pre><code>package mypackage\n\n//easyjson:json\ntype JSONData struct {\n    Data []string\n}\n</code></pre>\n\n<p>Then, within the mypackage directory I ran the following command from the README:</p>\n\n<blockquote>\n  <p>easyjson -all <code>&lt;file&gt;</code>.go</p>\n</blockquote>\n\n<p>Where I replace <code>&lt;file&gt;</code> with example. So ended up running the following:</p>\n\n<pre><code>easyjson -all example.go\n</code></pre>\n\n<p>This results in a file called <code>example_easyjson.go</code> which contains the generated code.</p>\n\n<p>I then created a <code>main.go</code> file to us the generated code. The contents of which is:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n\n    \"github.com/jpudney/stack-overflow/40587860/mypackage\"\n)\n\nfunc main() {\n\n    var data mypackage.JSONData\n    jsonBlob := `{\"Data\" : [\"One\", \"Two\", \"Three\"]}`\n\n    err := json.Unmarshal([]byte(jsonBlob), &amp;data)\n\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(data.Data)\n\n}\n</code></pre>\n\n<p>I build and ran this file and it outputted the data as expected:</p>\n\n<pre><code>$ go build -o test\n$ ./test\n[One Two Three]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1101, "user_id": 5261216, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cC2sAyNVGuk/AAAAAAAAAAI/AAAAAAAAAJo/2r_RFyBF1Xo/photo.jpg?sz=128", "display_name": "Sharath BJ", "link": "https://stackoverflow.com/users/5261216/sharath-bj"}, "is_accepted": false, "score": 6, "last_activity_date": 1588321709, "last_edit_date": 1588321709, "creation_date": 1498473119, "answer_id": 44757748, "question_id": 40587860, "link": "https://stackoverflow.com/questions/40587860/using-easyjson-with-golang/44757748#44757748", "title": "Using EasyJSON with golang", "body": "<p>Well, easyJson is 4 times faster than normal json(as per its documets) ,in our organization we have used it extensively and yes its faster. Here is a small example to get started. my current directory name is <strong>easyJson</strong></p>\n\n<blockquote>\n  <p>vim easyjson.go</p>\n</blockquote>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport ej \"random/golang/easyJson/model\"\n\nfunc main() {\n t1 := time.Now()\n var d ej.Data\n d.Name = \"sharathbj\"\n d.Age = 23\n data, _ := d.MarshalJSON()\n fmt.Println(string(data))\n fmt.Println(\"elapsedTime:\", time.Now().Sub(t1))\n}\n</code></pre>\n\n<p>create a directory named model ,where your structures are defined and new go file models.go </p>\n\n<blockquote>\n  <p>mkdir model</p>\n  \n  <p>vim models.go</p>\n</blockquote>\n\n<pre><code>package easyJson\n\n//easyjson:json\ntype Data struct {\n  Name string `json:\"name\"`\n  Age  int    `json:\"age\"`\n}\n</code></pre>\n\n<p>Now run command to create a easyjson file (<strong>-all</strong> specified to reference all the structure inside a given file)</p>\n\n<blockquote>\n  <p>easyjson -all model/models.go</p>\n</blockquote>\n\n<p>now a new file will be generated <strong>models_easyjson.go</strong> using which marshaling/unmarshaling will be referenced</p>\n\n<blockquote>\n  <p>go run easyjson.go </p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/3bF0S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3bF0S.png\" alt=\"enter image description here\"></a></p>\n\n<p>To compare easyjson with normal encoding/json ,below is the code </p>\n\n<blockquote>\n  <p>vim normaljson.go</p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n   \"time\"\n   \"encoding/json\"\n    model \"random/golang/easyJson/model\"\n )\n func main() {\n   t1 := time.Now()\n   var d model.Data\n   d.Name = \"sharathbj\"\n   d.Age = 23\n   data, _ := json.Marshal(d)\n   fmt.Println(string(data))\n   fmt.Println(\"elapsedTime:\", time.Now().Sub(t1))\n }\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hDtkm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hDtkm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Clearly easyjson is 7 micro second faster than normal json ,and you will see its impact when you do it for bigger structures , u can see the source code below .<br>\n <a href=\"https://github.com/sharathbj/random/tree/master/golang/easyJson\" rel=\"nofollow noreferrer\">https://github.com/sharathbj/random/tree/master/golang/easyJson</a></p>\n\n<p>Cheers!!</p>\n"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9620, "favorite_count": 3, "accepted_answer_id": 40588324, "answer_count": 3, "score": 2, "last_activity_date": 1588321709, "creation_date": 1479123534, "question_id": 40587860, "link": "https://stackoverflow.com/questions/40587860/using-easyjson-with-golang", "title": "Using EasyJSON with golang", "body": "<p>Let's say I have a struct like below:-</p>\n\n<pre><code>//easyjson:json\ntype JSONData struct {\n    Data []string\n}\n</code></pre>\n\n<p>I want to un-marshal the below json to <code>JSONData</code> struct</p>\n\n<pre><code>{\"Data\" : [\"One\", \"Two\", \"Three\"]} \n</code></pre>\n\n<p>Can someone let me know how can I use <a href=\"https://github.com/mailru/easyjson\" rel=\"nofollow noreferrer\">easyjson</a> to un-marshal a json in Golang? I could not find any example in their <code>README</code></p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 3689, "user_id": 3027001, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xW0N1.jpg?s=128&g=1", "display_name": "Ankur Anand", "link": "https://stackoverflow.com/users/3027001/ankur-anand"}, "edited": false, "score": 0, "creation_date": 1479123300, "post_id": 40587700, "comment_id": 68410712, "body": "It becomes clear now with Open and closed state .. Correct Terminiolgy are of great help . Thanks :)"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 5, "last_activity_date": 1479123439, "last_edit_date": 1479123439, "creation_date": 1479122972, "answer_id": 40587700, "question_id": 40587553, "link": "https://stackoverflow.com/questions/40587553/why-same-go-channel-cant-be-started-twice/40587700#40587700", "title": "Why same Go Channel can&#39;t be started twice?", "body": "<p>Channels are not \"started\", channels simply exist and are in one of two states:</p>\n\n<ul>\n<li>\"open\" in which case you can send values to them (and receive the values sent), or</li>\n<li>\"closed\" in which you cannot send and receiving from a closed channel results in \"the-zero-value, false\".</li>\n</ul>\n\n<p>A once closed channel stays closed forever. So yes, you have to <code>make</code> a new channel, there is no \"reopen\" in Go. </p>\n"}], "owner": {"reputation": 3689, "user_id": 3027001, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xW0N1.jpg?s=128&g=1", "display_name": "Ankur Anand", "link": "https://stackoverflow.com/users/3027001/ankur-anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 1, "accepted_answer_id": 40587700, "answer_count": 1, "score": 2, "last_activity_date": 1479123439, "creation_date": 1479122455, "last_edit_date": 1479122811, "question_id": 40587553, "link": "https://stackoverflow.com/questions/40587553/why-same-go-channel-cant-be-started-twice", "title": "Why same Go Channel can&#39;t be started twice?", "body": "<p>Can we start the one decalred channel twice in Go lang ?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc emit(c chan string) {\n\n    words := []string {\"The\", \"quick\", \"brown\", \"fox\"}\n\n    for _, word := range  words {\n        c &lt;- word\n    }\n    close(c)\n}\n</code></pre>\n\n<p>In the function main If i try to use the same channel twice i'm getting default value of that channel</p>\n\n<pre><code>func main() {\n\n    wordChannel := make(chan string)\n\n    go emit(wordChannel)\n\n    for word := range wordChannel {\n        fmt.Printf(\"%s \", word)\n    }\n\n    go emit(wordChannel)\n    word1 := &lt;-wordChannel\n    fmt.Printf(\"%s\" , word1) // prints Default value\n}\n</code></pre>\n\n<p><a href=\"https://code.hackerearth.com/b6e5e2V\" rel=\"nofollow noreferrer\">Output</a></p>\n\n<p>So to use it again i've to declare another channel. \nIf this is not an error why this was done in the Go Lang. ?\ni'm using go -lang version 1.6</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 0, "creation_date": 1486799459, "post_id": 40587071, "comment_id": 71511246, "body": "by definition <code>It is rarely necessary to close a DB.</code> so it doesn&#39;t have to be closed? and open the connection at all times?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 2, "creation_date": 1486840425, "post_id": 40587071, "comment_id": 71523186, "body": "@GujaratSantana Yes, it&#39;s strongly recommended not to close and reopen db connections all the time. You only have to close a db connection if db changes (e.g. database name, host or authentication info changes). Or when your app exits."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1479121337, "last_edit_date": 1479121337, "creation_date": 1479121019, "answer_id": 40587071, "question_id": 40587008, "link": "https://stackoverflow.com/questions/40587008/how-do-i-handle-opening-closing-db-connection-in-a-go-app/40587071#40587071", "title": "How do I handle opening/closing Db connection in a Go app?", "body": "<p>Opening a db connection every time it's needed is a waste of resources and it's slow.</p>\n\n<p>Instead, you should create an <a href=\"https://golang.org/pkg/database/sql/#DB\" rel=\"noreferrer\"><code>sql.DB</code></a> once, when your application starts (or on first demand), and either pass it where it is needed (e.g. as a function parameter or via some context), or simply make it a global variable and so everyone can access it. It's safe to call from multiple goroutines.</p>\n\n<p>Quoting from the doc of <a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"noreferrer\"><code>sql.Open()</code></a>:</p>\n\n<blockquote>\n  <p>The returned DB is safe for concurrent use by multiple goroutines and maintains its own pool of idle connections. Thus, the Open function should be called just once. It is rarely necessary to close a DB.</p>\n</blockquote>\n\n<p>You may use a package <code>init()</code> function to initialize it:</p>\n\n<pre><code>var db *sql.DB\n\nfunc init() {\n    var err error\n    db, err = sql.Open(\"yourdriver\", \"yourDs\")\n    if err != nil {\n        log.Fatal(\"Invalid DB config:\", err)\n    }\n}\n</code></pre>\n\n<p>One thing to note here is that <code>sql.Open()</code> may not create an actual connection to your DB, it may just validate its arguments. To test if you can actually connect to the db, use <a href=\"https://golang.org/pkg/database/sql/#DB.Ping\" rel=\"noreferrer\"><code>DB.Ping()</code></a>, e.g.:</p>\n\n<pre><code>func init() {\n    var err error\n    db, err = sql.Open(\"yourdriver\", \"yourDs\")\n    if err != nil {\n        log.Fatal(\"Invalid DB config:\", err)\n    }\n    if err = db.Ping(); err != nil {\n        log.Fatal(\"DB unreachable:\", err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8988673, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3mTUMZnpY/AAAAAAAAAAI/AAAAAAAAAGs/ixOwSqJu_Cc/photo.jpg?sz=128", "display_name": "Maxwell Githinji", "link": "https://stackoverflow.com/users/8988673/maxwell-githinji"}, "is_accepted": false, "score": 0, "last_activity_date": 1590585243, "last_edit_date": 1590585243, "creation_date": 1590581070, "answer_id": 62042725, "question_id": 40587008, "link": "https://stackoverflow.com/questions/40587008/how-do-i-handle-opening-closing-db-connection-in-a-go-app/62042725#62042725", "title": "How do I handle opening/closing Db connection in a Go app?", "body": "<blockquote>\n  <p>I will use a postgres example</p>\n</blockquote>\n\n<pre><code>package main\n</code></pre>\n\n<blockquote>\n  <p>import necessary packages and don't forget the postgres driver</p>\n</blockquote>\n\n<pre><code>import (\n  \"database/sql\"\n  _ \"github.com/lib/pq\" //postgres driver\n)\n</code></pre>\n\n<blockquote>\n  <p>initialize your connection in the package scope</p>\n</blockquote>\n\n<pre><code>var db *sql.DB\n</code></pre>\n\n<blockquote>\n  <p>have an init function for your connection</p>\n</blockquote>\n\n<pre><code>func init() {\n  var err error\n  db, err = sql.open(\"postgres\", \"connectionString\")\n  //connectioString example =&gt; 'postgres://username:password@localhost/dbName?sslmode=disable'\n  if err != nil {\n    panic(err)\n  }\n  err = db.Ping()\n  if err != nil {\n    panic(err)\n  }\n  // note, we haven't deffered db.Close() at the init function since the connection will close after init. you could close it at main or ommit it\n}\n</code></pre>\n\n<blockquote>\n  <p>main function</p>\n</blockquote>\n\n<pre><code>func main() {\ndefer db.Close() //optional\n//run your db functions\n}\n</code></pre>\n\n<blockquote>\n  <p>checkout this example\n  <a href=\"https://play.golang.org/p/FAiGbqeJG0H\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FAiGbqeJG0H</a></p>\n</blockquote>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3400, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1590585243, "creation_date": 1479120798, "question_id": 40587008, "link": "https://stackoverflow.com/questions/40587008/how-do-i-handle-opening-closing-db-connection-in-a-go-app", "title": "How do I handle opening/closing Db connection in a Go app?", "body": "<p>I have a set of functions in my web API app. They perform some operations on the data in the Postgres database.</p>\n\n<pre><code>func CreateUser () {\n    db, err := sql.Open(\"postgres\", \"user=postgres password=password dbname=api_dev sslmode=disable\")\n    // Do some db operations here\n}\n</code></pre>\n\n<p>I suppose functions should work with db independently from each other, so now I have <code>sql.Open(...)</code> inside each function. I don't know if it's a correct way to manage db connection.</p>\n\n<p>Should I open it somewhere once the app starts and pass db as an argument to the corresponding functions instead of opening the connection in every function?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1479119245, "post_id": 40586313, "comment_id": 68408297, "body": "Note that in Python you can use <code>re.findall(r&quot;\\(([^)]+)\\)&quot;, &quot;foo(bar)foo(baz)golang&quot;)</code> to get the same results. You do not have to use lookarounds with <code>re.findall</code>."}], "answers": [{"tags": [], "owner": {"reputation": 9384, "user_id": 761132, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fa462ba2bc6318a8b2e7662bb8e91aa1?s=128&d=identicon&r=PG", "display_name": "Rizwan M.Tuman", "link": "https://stackoverflow.com/users/761132/rizwan-m-tuman"}, "is_accepted": false, "score": 1, "last_activity_date": 1479119978, "last_edit_date": 1479119978, "creation_date": 1479118821, "answer_id": 40586380, "question_id": 40586313, "link": "https://stackoverflow.com/questions/40586313/get-all-substrings-inside-parentheses-in-golang-regexp/40586380#40586380", "title": "Get all substrings inside parentheses in Golang regexp", "body": "<p>Try this:</p>\n\n<pre><code>\\((.*?)\\)\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/KlIUre/1\" rel=\"nofollow noreferrer\">Explanation</a></p>\n\n<p>Code Sample:</p>\n\n<pre><code>package main\n\nimport (\n    \"regexp\"\n    \"fmt\"\n)\n\nfunc main() {\n    var re = regexp.MustCompile(`\\((.*?)\\)`)\n    var str = `foo(bar)foo(baz)golang`\n\n    mt:= re.FindAllStringSubmatch(str, -1)\n\n    for _, i := range mt {\n        fmt.Println(i[1])\n    }\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/JyP5g2\" rel=\"nofollow noreferrer\">Run the go code here</a></p>\n"}, {"tags": [], "owner": {"reputation": 32215, "user_id": 3789550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8mGqv.gif?s=128&g=1", "display_name": "heemayl", "link": "https://stackoverflow.com/users/3789550/heemayl"}, "is_accepted": true, "score": 5, "last_activity_date": 1479118899, "creation_date": 1479118899, "answer_id": 40586418, "question_id": 40586313, "link": "https://stackoverflow.com/questions/40586313/get-all-substrings-inside-parentheses-in-golang-regexp/40586418#40586418", "title": "Get all substrings inside parentheses in Golang regexp", "body": "<p><code>go</code>'s <code>regexp</code> package does not support zero width lookarounds. You can leverage captured grouping with the <code>regexp.FindAllStringSubmatch()</code> function:</p>\n\n<pre><code>package main\n\nimport (\n    \"regexp\"\n    \"fmt\"\n)\n\nfunc main() {\n    str := \"foo(bar)foo(baz)golang\"\n    rex := regexp.MustCompile(`\\(([^)]+)\\)`)\n    out := rex.FindAllStringSubmatch(str, -1)\n\n    for _, i := range out {\n        fmt.Println(i[1])\n    }\n}\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>bar\nbaz\n</code></pre>\n\n<hr>\n\n<p>The Regex <code>\\(([^)]+)\\)</code>:</p>\n\n<ul>\n<li><p><code>\\(</code> matches literal <code>(</code></p></li>\n<li><p><code>([^)]+)</code> matches substring upto next <code>)</code> and put the match in a captured group, here you can use non-greeedy match <code>.*?\\)</code> too</p></li>\n<li><p><code>\\)</code> matches literal <code>)</code></p></li>\n</ul>\n\n<hr>\n\n<p><a href=\"https://play.golang.org/p/YqcnWiBapg\" rel=\"noreferrer\">Go playground demo</a></p>\n"}], "owner": {"reputation": 31, "user_id": 7156186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf3c5b35ae00d67c2bd6219b39f8a62?s=128&d=identicon&r=PG&f=1", "display_name": "utlamn", "link": "https://stackoverflow.com/users/7156186/utlamn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2200, "favorite_count": 1, "accepted_answer_id": 40586418, "answer_count": 2, "score": 2, "last_activity_date": 1479119978, "creation_date": 1479118588, "question_id": 40586313, "link": "https://stackoverflow.com/questions/40586313/get-all-substrings-inside-parentheses-in-golang-regexp", "title": "Get all substrings inside parentheses in Golang regexp", "body": "<p>I want to get all the substrings inside all parentheses in go using Regex.</p>\n\n<p>As an example for the string \"foo(bar)foo(baz)golang\", i want \"bar\" and \"baz\"</p>\n\n<p>in python i can do <code>re.findall(\"(?&lt;=\\()[^)]+(?=\\))\", \"foo(bar)foo(baz)golang\")</code></p>\n\n<p>How to do it in go?</p>\n"}, {"tags": ["templates", "go", "go-templates"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1479113893, "post_id": 40584612, "comment_id": 68405056, "body": "A template contains a parse.Tree which exposes this kind of stuff (FieldNode). Form the docs: &quot;The *parse.Tree field is exported only for use by html/template and should be treated as unexported by all other clients.&quot; So: Don&#39;t do that. If you do not follow that advice: Good luck."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4940673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwvRj.png?s=128&g=1", "display_name": "JackMordaunt", "link": "https://stackoverflow.com/users/4940673/jackmordaunt"}, "edited": false, "score": 1, "creation_date": 1479183285, "post_id": 40584967, "comment_id": 68438988, "body": "Thanks for your answer. To clarify, the reason you would want to get the actions at runtime is if you are not in control of the template creation, or the template changes frequently. For example I have templates representing letters. I have a GUI that allows a user to input values for the template. Obviously every template will have some similar and some different actions that need to be filled. So the GUI needs to be able to display input boxes for every action found on a template at runtime, otherwise I would have to statically code in the all the input boxes for every single template."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1479114882, "last_edit_date": 1479114882, "creation_date": 1479113909, "answer_id": 40584967, "question_id": 40584612, "link": "https://stackoverflow.com/questions/40584612/how-to-get-a-map-or-list-of-template-actions-from-a-parsed-template/40584967#40584967", "title": "How to get a map or list of template &#39;actions&#39; from a parsed template?", "body": "<p>Foreword: As Voker suggests, the <code>Template.Tree</code> field is <em>\"exported only for use by html/template and should be treated as unexported by all other clients.\"</em></p>\n\n<p>You should not rely on such thing to be able to provide input for a template execution. You must know the template you want to execute along with the data it expects. You shouldn't \"explore\" it at runtime to provide arguments for it.</p>\n\n<hr>\n\n<p>The value you get out of parsing a template is <a href=\"https://golang.org/pkg/html/template/#Template\" rel=\"noreferrer\"><code>template.Template</code></a> (either <code>text/template</code> or <code>html/template</code>, they have the same API). This template represents the templates as a tree of type <a href=\"https://golang.org/pkg/text/template/parse/#Tree\" rel=\"noreferrer\"><code>parse.Tree</code></a>. Everything that a text template contains is stored in this tree in nodes, including static texts, actions etc.</p>\n\n<p>Having said that, you can walk this tree and look for nodes that identify such actions that access fields or call functions. The nodes are of type <a href=\"https://golang.org/pkg/text/template/parse/#Node\" rel=\"noreferrer\"><code>parse.Node</code></a> which has a <code>Node.Type()</code> method returning its type. The possible types are defined as constants in the <code>parse</code> package, next to the <a href=\"https://golang.org/pkg/text/template/parse/#NodeType\" rel=\"noreferrer\"><code>parse.NodeType</code></a> type, e.g.</p>\n\n<pre><code>const (\n        NodeText    NodeType = iota // Plain text.\n        NodeAction                  // A non-control action such as a field evaluation.\n        NodeBool                    // A boolean constant.\n        NodeChain                   // A sequence of field accesses.\n        NodeCommand                 // An element of a pipeline.\n        NodeDot                     // The cursor, dot.\n\n        NodeField      // A field or method name.\n        NodeIdentifier // An identifier; always a function name.\n        NodeIf         // An if action.\n        NodeList       // A list of Nodes.\n        NodeNil        // An untyped nil constant.\n        NodeNumber     // A numerical constant.\n        NodePipe       // A pipeline of commands.\n        NodeRange      // A range action.\n        NodeString     // A string constant.\n        NodeTemplate   // A template invocation action.\n        NodeVariable   // A $ variable.\n        NodeWith       // A with action.\n)\n</code></pre>\n\n<p>So here is an example program that recursively walks a template tree, and looks for nodes with <code>NodeAction</code> type, which is <em>\"A non-control action such as a field evaluation.\"</em></p>\n\n<p>This solution is just a demonstration, a proof of concept, it does not handle all cases.</p>\n\n<pre><code>func ListTemplFields(t *template.Template) []string {\n    return listNodeFields(t.Tree.Root, nil)\n}\n\nfunc listNodeFields(node parse.Node, res []string) []string {\n    if node.Type() == parse.NodeAction {\n        res = append(res, node.String())\n    }\n\n    if ln, ok := node.(*parse.ListNode); ok {\n        for _, n := range ln.Nodes {\n            res = listNodeFields(n, res)\n        }\n    }\n    return res\n}\n</code></pre>\n\n<p>Example using it:</p>\n\n<pre><code>t := template.Must(template.New(\"cooltemplate\").\n    Parse(`&lt;h1&gt;{{ .name }} {{ .age }}&lt;/h1&gt;`))\nfmt.Println(ListTemplFields(t))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/YjcFtjRVIS\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[{{.name}} {{.age}}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13667494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69bb13a61543933cafba45dc477dd14e?s=128&d=identicon&r=PG&f=1", "display_name": "Ugo", "link": "https://stackoverflow.com/users/13667494/ugo"}, "is_accepted": false, "score": 0, "last_activity_date": 1591391618, "last_edit_date": 1591391618, "creation_date": 1591391272, "answer_id": 62224127, "question_id": 40584612, "link": "https://stackoverflow.com/questions/40584612/how-to-get-a-map-or-list-of-template-actions-from-a-parsed-template/62224127#62224127", "title": "How to get a map or list of template &#39;actions&#39; from a parsed template?", "body": "<p>I have happened to need roughly the same code.\nIn my use case, we allow users to create templates on one side, and to enter a <code>map[string]string</code> of variables to be used for rendering in a different form.</p>\n\n<p>This is the code that I came up with so far (inspired by icza's answer):</p>\n\n<pre><code>// Extract the template vars required from *simple* templates.\n// Only works for top level, plain variables. Returns all problematic parse.Node as errors.\nfunc RequiredTemplateVars(t *template.Template) ([]string, []error) {\n    var res []string\n    var errors []error\n    var ln *parse.ListNode\n    ln = t.Tree.Root\nNode:\n    for _, n := range ln.Nodes {\n        if nn, ok := n.(*parse.ActionNode); ok {\n            p := nn.Pipe\n            if len(p.Decl) &gt; 0 {\n                errors = append(errors, fmt.Errorf(\"Node %v not supported\", n))\n                continue Node\n            }\n            for _, c := range p.Cmds {\n                if len(c.Args) != 1 {\n                    errors = append(errors, fmt.Errorf(\"Node %v not supported\", n))\n                    continue Node\n                }\n                if a, ok := c.Args[0].(*parse.FieldNode); ok {\n                    if len(a.Ident) != 1 {\n                        errors = append(errors, fmt.Errorf(\"Node %v not supported\", n))\n                        continue Node\n                    }\n                    res = append(res, a.Ident[0])\n                } else {\n                    errors = append(errors, fmt.Errorf(\"Node %v not supported\", n))\n                    continue Node\n                }\n\n            }\n        } else {\n            if _, ok := n.(*parse.TextNode); !ok {\n                errors = append(errors, fmt.Errorf(\"Node %v not supported\", n))\n                continue Node\n            }\n        }\n    }\n    return res, errors\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nH95B45jUmI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/nH95B45jUmI</a></p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 7202914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n1KJb.jpg?s=128&g=1", "display_name": "replper", "link": "https://stackoverflow.com/users/7202914/replper"}, "is_accepted": false, "score": 0, "last_activity_date": 1595338917, "creation_date": 1595338917, "answer_id": 63015852, "question_id": 40584612, "link": "https://stackoverflow.com/questions/40584612/how-to-get-a-map-or-list-of-template-actions-from-a-parsed-template/63015852#63015852", "title": "How to get a map or list of template &#39;actions&#39; from a parsed template?", "body": "<p>A small optimization to @icza 's answer, maybe it helps a little :)</p>\n<pre class=\"lang-golang prettyprint-override\"><code>func listNodeFieldsV2(node parse.Node) []string {\n    var res []string\n    if node.Type() == parse.NodeAction {\n        res = append(res, node.String())\n    }\n    if ln, ok := node.(*parse.ListNode); ok {\n        for _, n := range ln.Nodes {\n            res = append(res, listNodeFieldsV2(n)...)\n        }\n    }\n    return res\n}\n\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4940673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwvRj.png?s=128&g=1", "display_name": "JackMordaunt", "link": "https://stackoverflow.com/users/4940673/jackmordaunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1870, "favorite_count": 2, "accepted_answer_id": 40584967, "answer_count": 3, "score": 3, "last_activity_date": 1595338917, "creation_date": 1479112438, "last_edit_date": 1532161769, "question_id": 40584612, "link": "https://stackoverflow.com/questions/40584612/how-to-get-a-map-or-list-of-template-actions-from-a-parsed-template", "title": "How to get a map or list of template &#39;actions&#39; from a parsed template?", "body": "<p>So I would like to somehow get all of my <code>{{ .blahblah }}</code> actions defined in a template as slice of strings. </p>\n\n<p>For example if I have this template:   </p>\n\n<pre><code>&lt;h1&gt;{{ .name }} {{ .age }}&lt;/h1&gt;\n</code></pre>\n\n<p>I would like to be able to get <code>[]string{\"name\", \"age\"}</code>. Pretend that a template has the method <code>func (t *Template) Fields() []string</code>:</p>\n\n<pre><code>t := template.New(\"cooltemplate\").Parse(`&lt;h1&gt;{{ .name }} {{ .age }}&lt;/h1&gt;`)\nif t.Fields() == []string{\"name\", \"age\"} {\n    fmt.Println(\"Yay, now I know what fields I can pass in!\")\n    // Now lets pass in the name field that we just discovered.\n    _ = t.Execute(os.Stdout, map[string]string{\"name\": \"Jack\", \"age\":\"120\"})\n}\n</code></pre>\n\n<p>Is there a way to inspect a parsed template like this?<br>\nThanks!</p>\n"}, {"tags": ["go", "gdb"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 3721292, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/64ad8586eb0d834812870a940c1c869f?s=128&d=identicon&r=PG&f=1", "display_name": "yskyj", "link": "https://stackoverflow.com/users/3721292/yskyj"}, "edited": false, "score": 0, "creation_date": 1479553648, "post_id": 40583733, "comment_id": 68613779, "body": "Thanks mko! Perhaps it&#39;s golang compile&#39;s optimization results in such question mark."}], "tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 0, "last_activity_date": 1479108278, "creation_date": 1479108278, "answer_id": 40583733, "question_id": 40583258, "link": "https://stackoverflow.com/questions/40583258/debugging-go-code-with-gdb-encountering-question-mark/40583733#40583733", "title": "Debugging go code with gdb encountering question mark", "body": "<p>The code, probably, has stripped debugging symbols:</p>\n\n<pre><code>gcc -s\n</code></pre>\n\n<p>You can see that behavior with this simple sample</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid riskyCode() {\n  char *error_str = \"This code will fail with SIGSEGV\";\n  *error_str = 'g';\n}\n\nint c() {\n  riskyCode();\n  return 1;\n}\n\nint b() {\n  return c();\n}\n\nint a() {\n  return b();\n}\n\nint main() {\n  return a();\n}\n</code></pre>\n\n<p>Compile it like this</p>\n\n<pre><code>gcc -s -O0 -o main main.c\n</code></pre>\n\n<p>And run code in gdb</p>\n\n<pre><code>gdb main\n&gt; run\n</code></pre>\n\n<p>Then, you will see ?? in stack locations</p>\n\n<pre><code>bt\n#0  0x000000000040056a in ?? ()\n#1  0x000000000040057d in ?? ()\n#2  0x0000000000400592 in ?? ()\n#3  0x00000000004005a2 in ?? ()\n#4  0x00000000004005b2 in ?? ()\n#5  0x00002aaaaacebc36 in __libc_start_main () from /lib64/libc.so.6\n#6  0x0000000000400429 in ?? ()\n#7  0x00007fffffff93f8 in ?? ()\n#8  0x000000000000001c in ?? ()\n#9  0x0000000000000001 in ?? ()\n#10 0x00007fffffff9ca2 in ?? ()\n#11 0x0000000000000000 in ?? ()\n</code></pre>\n\n<p>Try to use very same library, but compiled with debugging symbols?</p>\n"}], "owner": {"reputation": 141, "user_id": 3721292, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/64ad8586eb0d834812870a940c1c869f?s=128&d=identicon&r=PG&f=1", "display_name": "yskyj", "link": "https://stackoverflow.com/users/3721292/yskyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 481, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479108278, "creation_date": 1479106090, "question_id": 40583258, "link": "https://stackoverflow.com/questions/40583258/debugging-go-code-with-gdb-encountering-question-mark", "title": "Debugging go code with gdb encountering question mark", "body": "<p>I read golang official gdb document here <strike><a href=\"https://golang.org/doc/gdb\" rel=\"nofollow noreferrer\">https://golang.org/doc/gdb</a></strike></p>\n\n<p>And I'm curious about what causes question mark when inspecting the stack.</p>\n\n<pre><code>(gdb) bt  # backtrace\n#0  regexp.TestFind (t=0xf8404a89c0) at /home/user/go/src/regexp/find_test.go:148\n#1  0x000000000042f60b in testing.tRunner (t=0xf8404a89c0, test=0x573720) at /home/user/go/src/testing/testing.go:156\n#2  0x000000000040df64 in runtime.initdone () at /home/user/go/src/runtime/proc.c:242\n#3  0x000000f8404a89c0 in ?? ()\n#4  0x0000000000573720 in ?? ()\n#5  0x0000000000000000 in ?? ()\n</code></pre>\n\n<p>So, Is the gdb optimizations caused the question mark? Or what on earth result in such question mark?</p>\n\n<p>One more question, How can I retrieve the message hiden behind question mark?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 5, "creation_date": 1479070533, "post_id": 40578646, "comment_id": 68393032, "body": "You can make a map of pointers to a struct..."}, {"owner": {"reputation": 9826, "user_id": 467732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93af4ec7a03d6ec6e95eff3a83af3dd4?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/467732/lucas"}, "edited": false, "score": 1, "creation_date": 1479099466, "post_id": 40578646, "comment_id": 68399802, "body": "The answers you seem to be looking for are available here: <a href=\"http://stackoverflow.com/questions/32751537/why-do-i-get-a-cannot-assign-error-when-setting-value-to-a-struct-as-a-value-i\" title=\"why do i get a cannot assign error when setting value to a struct as a value i\">stackoverflow.com/questions/32751537/&hellip;</a> and here: <a href=\"http://stackoverflow.com/questions/17438253/access-struct-in-map-without-copying\" title=\"access struct in map without copying\">stackoverflow.com/questions/17438253/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 7154113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bd73c23196151f5b247f45019a8c28?s=128&d=identicon&r=PG", "display_name": "kanu", "link": "https://stackoverflow.com/users/7154113/kanu"}, "edited": false, "score": 0, "creation_date": 1479098931, "post_id": 40578841, "comment_id": 68399689, "body": "I understand how pointers work, and that access gives you a copy. Perhaps I didn&#39;t frame it right, but my question is why did the designers of Go choose not to allow direct modification of struct fields?"}, {"owner": {"reputation": 11620, "user_id": 1832301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfe654f47e3de2384ffd4e2165c575c?s=128&d=identicon&r=PG", "display_name": "BraveNewCurrency", "link": "https://stackoverflow.com/users/1832301/bravenewcurrency"}, "edited": false, "score": 5, "creation_date": 1479103421, "post_id": 40578841, "comment_id": 68400850, "body": "Safety during parallelism. When you are adding elements to a hash, the language often has to copy all the values to a new (bigger) hash table in the background. If elements can be directly modified in memory, it will be impossible to keep all the copies in sync. If all update operations are forced thru &quot;here is a new value&quot;, then it&#39;s easy to make sure both copies get updated.  Without this, copying a hash would be a &quot;stop the world&quot; operation."}, {"owner": {"reputation": 307, "user_id": 7154113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bd73c23196151f5b247f45019a8c28?s=128&d=identicon&r=PG", "display_name": "kanu", "link": "https://stackoverflow.com/users/7154113/kanu"}, "edited": false, "score": 0, "creation_date": 1479140864, "post_id": 40578841, "comment_id": 68422291, "body": "That makes sense, thanks!"}, {"owner": {"reputation": 2266, "user_id": 6680253, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/7rPyV.png?s=128&g=1", "display_name": "leogoesger", "link": "https://stackoverflow.com/users/6680253/leogoesger"}, "edited": false, "score": 1, "creation_date": 1580310395, "post_id": 40578841, "comment_id": 106056566, "body": "I think this does not explain why error was thrown when trying to modify map of struct, whereas no error was thrown when modify map of string."}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1617009654, "post_id": 40578841, "comment_id": 118171012, "body": "Thanks. Finding this solved a problem that has been cursing me for days."}], "tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 27, "last_activity_date": 1479071366, "creation_date": 1479071366, "answer_id": 40578841, "question_id": 40578646, "link": "https://stackoverflow.com/questions/40578646/golang-i-have-a-map-of-int-to-struct-why-cant-i-directly-modify-a-field-in-a/40578841#40578841", "title": "Golang: I have a map of int to struct. Why can&#39;t I directly modify a field in a map value?", "body": "<p>You are storing a struct by value which means that accession of that struct in the map gives you a copy of the value. This is why when you modify it, the struct in the map remains unmutated until you overwrite it with the new copy. </p>\n\n<p>As RickyA pointed out in the comment, you can store the pointer to the struct instead and this allows direct modification of the struct being referenced by the stored struct pointer. </p>\n\n<p>i.e. <code>map[whatever]*struct</code> instead of <code>map[whatever]struct</code></p>\n"}], "owner": {"reputation": 307, "user_id": 7154113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bd73c23196151f5b247f45019a8c28?s=128&d=identicon&r=PG", "display_name": "kanu", "link": "https://stackoverflow.com/users/7154113/kanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34327, "favorite_count": 2, "closed_date": 1479140775, "answer_count": 1, "score": 19, "last_activity_date": 1582705153, "creation_date": 1479070038, "last_edit_date": 1582705153, "question_id": 40578646, "link": "https://stackoverflow.com/questions/40578646/golang-i-have-a-map-of-int-to-struct-why-cant-i-directly-modify-a-field-in-a", "closed_reason": "Duplicate", "title": "Golang: I have a map of int to struct. Why can&#39;t I directly modify a field in a map value?", "body": "<p>Why do we have to first read the struct, modify it, and then write it back to the map? Am I missing some kind of implied hidden cost in modifying fields of structs in other data structures (like a map or a slice)?</p>\n\n<p>Edit: \nI realize I can use pointers, but <em>why</em> is this not allowed by Go? </p>\n\n<pre><code>type dummy struct {\n    a int\n}\nx := make(map[int]dummy)\nx[1] = dummy{a:1}\nx[1].a = 2\n</code></pre>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1479061808, "post_id": 40577116, "comment_id": 68390180, "body": "Short answer: you can return either, but I think you usually want to return the form that you want people to use the most. So often when it&#39;s a small type like <code>time.Time</code> you return a value and otherwise a pointer. Saying something more detailed in an answer."}], "answers": [{"comments": [{"owner": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1479063842, "post_id": 40577502, "comment_id": 68390830, "body": "Thank you for the detailed response. I might grow my queue in the next few days so I&#39;ll keep it  as a struct."}, {"owner": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1479063956, "post_id": 40577502, "comment_id": 68390873, "body": "Oops clicked send too soon. The thing that I don&#39;t understand is: if what I am returning above is different for the two cases, then how come usage afterwards is the same? That is, whatever <code>queue</code> I end up initializing, I am using it the same, with no regard to whether it is a value or a pointer, which is why I wondered if the distinction is worth it."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1479064478, "post_id": 40577502, "comment_id": 68391035, "body": "Usage isn&#39;t the same; Go hides the <code>.</code> vs <code>-&gt;</code> distinction that there is in C++, but other differences remain. For example, after <code>q := NewQueue()</code>, to pass <code>q</code> to <code>func f (q *Queue)</code> you need to use <code>f(&amp;q)</code> if <code>q</code> is a value but just <code>f(q)</code> if it&#39;s a pointer. Similarly you can&#39;t assign between pointers and values without explicit <code>&amp;</code>/<code>*</code>, if you&#39;re trying to store a <code>Queue</code> or <code>*Queue</code> in a global or such."}, {"owner": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1479064965, "post_id": 40577502, "comment_id": 68391199, "body": "Got it, the key here is the hiding of the distinction. Thank you."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 2, "last_activity_date": 1479155046, "last_edit_date": 1495540888, "creation_date": 1479062932, "answer_id": 40577502, "question_id": 40577116, "link": "https://stackoverflow.com/questions/40577116/difference-between-returning-a-pointer-and-a-value-in-initialization-methods/40577502#40577502", "title": "Difference between returning a pointer and a value in initialization methods", "body": "<p>It's possible to return a value and then the caller to call methods that have a pointer receiver. However, if the caller is always going to want to use pointers, because the object's big or because methods need to modify it in place, you might as well return a pointer. <a href=\"https://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values/23551970#23551970\">Pointers vs. values is a common question in Go and there's an answer trying to break down when to use one or the other.</a></p>\n\n<p>In the specific case of a slice-backed <code>Queue</code> type, it's pretty small and fast to copy as a value, <em>but</em> if you want to be able to copy it around and have everyone see the same data whichever copy is accessed, you're going to need to use a pointer, because a slice is really a little struct of start pointer, length, and capacity, and those change when you reslice or grow it. If this is a surprise, the Go blog posts on <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">the mechanics of <code>append</code></a> and <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">slice usage and internals</a> could be useful reading.</p>\n\n<p>If your queue isn't for sharing or passing around but for using locally in a single function, you could provide an <code>append</code>-style interface where operations return a modified queue, but at that point maybe you just want to <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">use slice tricks directly</a>.</p>\n\n<p>(If your queue is meant to be used <em>concurrently</em>, think hard about using a buffered channel. It might not be exactly what you're imagining, but a lot of the tricky bits have already been figured out for you by the implementers.)</p>\n\n<p>Also--if <code>Queue</code> is <em>really</em> a slice with methods added, you can make it <code>type Queue []int</code>.</p>\n"}], "owner": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "closed_date": 1569320541, "accepted_answer_id": 40577502, "answer_count": 1, "score": -1, "last_activity_date": 1569320536, "creation_date": 1479060583, "last_edit_date": 1569320536, "question_id": 40577116, "link": "https://stackoverflow.com/questions/40577116/difference-between-returning-a-pointer-and-a-value-in-initialization-methods", "closed_reason": "Duplicate", "title": "Difference between returning a pointer and a value in initialization methods", "body": "<p>Consider the following struct:</p>\n\n<pre><code>type Queue struct {\n  Elements []int\n}\n</code></pre>\n\n<p>What would be the different between:</p>\n\n<pre><code>func NewQueue() Queue {\n  queue := Queue{}\n  return queue\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>func NewQueue() *Queue {\n  queue := &amp;Queue{}\n  return queue\n}\n</code></pre>\n\n<p>To me the seem practically the same, (and in fact trying it with some enqueuing and dequeueing yields the same results) but I still see both usages in the wild, so perhaps one is preferable. </p>\n"}, {"tags": ["pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "edited": false, "score": 0, "creation_date": 1479055058, "post_id": 40576009, "comment_id": 68387806, "body": "Thank you for reply. But this explanation is far away to me due to my lack of information. A pointer is referance to memory that is represented as an 32 bit or 64 bit int. Is this correct ?. If this information is correct, why are we use different pointer types related to variable type? If this information is not correct, what is the differance between different pointer types?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "edited": false, "score": 2, "creation_date": 1479058646, "post_id": 40576009, "comment_id": 68389025, "body": "@AliAltun first of all, one key point is that if all pointers were the same, you&#39;d lose type information and make the language much less efficient and less safe. You wouldn&#39;t want a function accepting <code>*int</code> to accept <code>*float</code>, or you&#39;re losing one of the key advantages of a statically typed langues."}], "tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1479053918, "creation_date": 1479053918, "answer_id": 40576009, "question_id": 40575845, "link": "https://stackoverflow.com/questions/40575845/whats-the-difference-between-different-type-of-pointers/40576009#40576009", "title": "What&#39;s the difference between different type of pointers?", "body": "<p>The type system in Go is designed to prevent memory errors relating to pointers. This allows programmers to have enough control to manipulate objects in memory while Allowing the garbage collector top cop moody of the heavy lifting.<br>\nIf you need to manually memory and convert pointer types you can use the <a href=\"http://golang.org/pkg/unsafe\" rel=\"nofollow\">unsafe package</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 1, "creation_date": 1525773635, "post_id": 40582925, "comment_id": 87479007, "body": "When was the last time you programmed in C? 1970? C pointers have the type of &quot;pointer to the thing they are pointing to&quot;. They are not all one type."}, {"owner": {"reputation": 11620, "user_id": 1832301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfe654f47e3de2384ffd4e2165c575c?s=128&d=identicon&r=PG", "display_name": "BraveNewCurrency", "link": "https://stackoverflow.com/users/1832301/bravenewcurrency"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1533346711, "post_id": 40582925, "comment_id": 90326506, "body": "Try this experiment: <code>int a=42; int p=&amp;a; p=43</code>. Yes, that code is logically wrong, but the default compiler won&#39;t stop you from <i>writing and running</i> that code. Even worse, a novice can use a cast to &#39;fix&#39; the problem, hiding it forever. C may have &quot;different pointer types&quot;, but without enforcement it can&#39;t prevent bugs. In contrast, Go won&#39;t compile code like that, and will reject any attempts to &#39;fix&#39; the problem with a cast. And we can scare away any novices from using the &quot;unsafe&quot; module because it&#39;s almost never needed."}], "tags": [], "owner": {"reputation": 11620, "user_id": 1832301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfe654f47e3de2384ffd4e2165c575c?s=128&d=identicon&r=PG", "display_name": "BraveNewCurrency", "link": "https://stackoverflow.com/users/1832301/bravenewcurrency"}, "is_accepted": true, "score": 1, "last_activity_date": 1479104504, "creation_date": 1479104504, "answer_id": 40582925, "question_id": 40575845, "link": "https://stackoverflow.com/questions/40575845/whats-the-difference-between-different-type-of-pointers/40582925#40582925", "title": "What&#39;s the difference between different type of pointers?", "body": "<blockquote>\n  <p>is this possible using only one type for all the pointer types?</p>\n</blockquote>\n\n<p>Yes, that is pretty much how C works. Unfortunately, that makes the language dangerous. Say you have an array of 10 bytes. If you JUST pass the pointer, the other code won't know how many bytes it's safe to access. That leads to all kinds of buffer overflow errors. (i.e. HeartBleed)</p>\n\n<p>In Go, they pointer knows the type of the thing it points to, so it can prevent your code from having buffer overflow problems all the time.</p>\n\n<p>You can do what you want, but only by using the Unsafe package. As the name suggests, that is a very dangerous thing to do.</p>\n\n<p>Perhaps if you post what you are ACTUALLY trying to do, people can help you. Using unsafe pointers is not the only way to write performant code.</p>\n"}], "owner": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 40582925, "answer_count": 2, "score": -4, "last_activity_date": 1525678714, "creation_date": 1479052992, "last_edit_date": 1479055736, "question_id": 40575845, "link": "https://stackoverflow.com/questions/40575845/whats-the-difference-between-different-type-of-pointers", "title": "What&#39;s the difference between different type of pointers?", "body": "<p>A pointer references a location in memory. Actually all memory addresses have the same type independently of the variable type as far as I understand.</p>\n\n<p>Instead of using different pointer type (<code>*int</code>, <code>*string</code> etc..), is this possible using only one type (<code>var p pointer</code>) for all the pointer types? </p>\n\n<p>What is the difference between different pointer types?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    i := 5\n    s := \"abc\"\n\n    var pi *int      // alternatively var pi pointer\n    var ps *string   // alternatively var ps pointer \n\n    pi = &amp;i\n    ps = &amp;s\n\n    fmt.Printf(\"%p %p\", pi, ps)  // result is 0x1040e0f8 0x1040a120\n}\n</code></pre>\n"}, {"tags": ["android", "go", "command-line"], "comments": [{"owner": {"reputation": 905471, "user_id": 115145, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/wDnd8.png?s=128&g=1", "display_name": "CommonsWare", "link": "https://stackoverflow.com/users/115145/commonsware"}, "edited": false, "score": 1, "creation_date": 1479051537, "post_id": 40575532, "comment_id": 68386567, "body": "<code>am start</code> does not take an APK as an argument. It is for starting an Android activity (which you do not have) via an <code>Intent</code> (which you do not have). APKs do not have a command-line interface like the one that you are seeking. You are welcome to compile a native binary, upload it to the device, mark it as executable, and try to run it from the command line."}, {"owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "reply_to_user": {"reputation": 905471, "user_id": 115145, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/wDnd8.png?s=128&g=1", "display_name": "CommonsWare", "link": "https://stackoverflow.com/users/115145/commonsware"}, "edited": false, "score": 0, "creation_date": 1479057730, "post_id": 40575532, "comment_id": 68388720, "body": "yeah I&#39;m not very smart. I was able to build it by installing the android-ndk, and running <code>CC=&quot;$NDK_ROOT&#47;bin&#47;arm-linux-androideabi-gcc&quot; GOOS=linux GOARCH=arm GOARM=7 CGO_ENABLED=0 go build -v -o goserv main.go</code>"}], "answers": [{"tags": [], "owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "is_accepted": true, "score": 6, "last_activity_date": 1479058248, "creation_date": 1479058248, "answer_id": 40576742, "question_id": 40575532, "link": "https://stackoverflow.com/questions/40575532/how-can-i-build-a-command-line-app-for-android/40576742#40576742", "title": "How can I build a command line app for android?", "body": "<p>Appears to vary by system and version, but I needed to get the android ndk from here:</p>\n\n<p><code>https://developer.android.com/ndk/downloads/index.html</code></p>\n\n<p>and install the toolchain</p>\n\n<p><code>./android-ndk-r10c/build/tools/make-standalone-toolchain.sh --platform=android-21 --install-dir=$NDK_ROOT</code></p>\n\n<p>and then build the binary with </p>\n\n<p><code>CC=\"$NDK_ROOT/bin/arm-linux-androideabi-gcc\" GOOS=linux GOARCH=arm GOARM=7 CGO_ENABLED=0 go build -v -o goserv main.go</code></p>\n\n<p>I got most of this info from here: <a href=\"https://github.com/golang/go/issues/9412\" rel=\"noreferrer\">https://github.com/golang/go/issues/9412</a></p>\n\n<p>But needed to change change some paths, change <code>CC_FOR_TARGET</code> to just <code>CC</code>, <code>GOOS=android</code> to <code>GOOS=linux</code>, and needed to set <code>CGO_ENABLED=0</code>.</p>\n\n<p>This was on Linux Fedora 25 Beta with Go 1.7.4</p>\n"}], "owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3346, "favorite_count": 2, "accepted_answer_id": 40576742, "answer_count": 1, "score": 4, "last_activity_date": 1479058248, "creation_date": 1479051105, "question_id": 40575532, "link": "https://stackoverflow.com/questions/40575532/how-can-i-build-a-command-line-app-for-android", "title": "How can I build a command line app for android?", "body": "<p>I want to build small app for android that I can run from the android command line while I'm remotely connected to the android device through ssh. I don't want a button/launcher/icon or gui interface of any kind.</p>\n\n<p>I prefer to do this in golang if possible.</p>\n\n<p>I tried using <code>gomobile</code> (<code>golang.org/x/mobile</code>) but when I put the apk on my device and try to run it I get the error:</p>\n\n<pre><code>u0_a44@ghost:/data/data/berserker.android.apps.sshdroid/home $ am start gserv.apk                                         \nStarting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] pkg=gserv.apk }\njava.lang.SecurityException: Permission Denial: startActivity asks to run as user -2 but is calling from user 0; this requires android.permission.INTERACT_ACROSS_USERS_FULL\n    at android.os.Parcel.readException(Parcel.java:1546)\n    at android.os.Parcel.readException(Parcel.java:1499)\n    at android.app.ActivityManagerProxy.startActivityAsUser(ActivityManagerNative.java:2504)\n    at com.android.commands.am.Am.runStart(Am.java:770)\n    at com.android.commands.am.Am.onRun(Am.java:307)\n    at com.android.internal.os.BaseCommand.run(BaseCommand.java:47)\n    at com.android.commands.am.Am.main(Am.java:98)\n    at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)\n    at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:249)\n</code></pre>\n\n<p>The app is just a small hello world http server. How can I install and run it in a way that allows me to use it like other command line programs built into android that don't require gui (<code>ls</code>, <code>cat</code>, <code>cd</code>, etc).</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 4, "last_activity_date": 1479050654, "creation_date": 1479050654, "answer_id": 40575465, "question_id": 40575126, "link": "https://stackoverflow.com/questions/40575126/parse-repeating-fields-in-xml/40575465#40575465", "title": "Parse repeating fields in xml", "body": "<p>Due to the layout of the XML document, the built-in marshaling rules cannot decode the data into your given data types.</p>\n\n<p>Below is a marshaler and unmarshaler implementation that should work for your document:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"strconv\"\n)\n\nvar data = []byte(`&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n    &lt;SessionInfo&gt;\n       &lt;SID&gt;000000000000&lt;/SID&gt;\n       &lt;Challenge&gt;1337&lt;/Challenge&gt;\n       &lt;BlockTime&gt;0&lt;/BlockTime&gt;\n       &lt;Rights&gt;\n          &lt;Name&gt;Dial&lt;/Name&gt;\n          &lt;Access&gt;2&lt;/Access&gt;\n          &lt;Name&gt;App&lt;/Name&gt;\n          &lt;Access&gt;2&lt;/Access&gt;\n          &lt;Name&gt;HomeAuto&lt;/Name&gt;\n          &lt;Access&gt;2&lt;/Access&gt;\n          &lt;Name&gt;BoxAdmin&lt;/Name&gt;\n          &lt;Access&gt;2&lt;/Access&gt;\n          &lt;Name&gt;Phone&lt;/Name&gt;\n          &lt;Access&gt;2&lt;/Access&gt;\n          &lt;Name&gt;NAS&lt;/Name&gt;\n          &lt;Access&gt;2&lt;/Access&gt;\n       &lt;/Rights&gt;\n    &lt;/SessionInfo&gt;`)\n\ntype sessionInfo struct {\n    XMLName   xml.Name `xml:\"SessionInfo\"`\n    SID       string   `xml:\"SID\"`\n    Challenge string   `xml:\"Challenge\"`\n    BlockTime uint     `xml:\"BlockTime\"`\n    Rights    *rights  `xml:\"Rights\"`\n}\n\ntype rights struct {\n    Rights []*right\n}\n\ntype NameElement struct {\n    XMLName xml.Name `xml:\"Name\"`\n    Value   string   `xml:\",chardata\"`\n}\ntype AccessElement struct {\n    XMLName xml.Name `xml:\"Access\"`\n    Value   string   `xml:\",chardata\"`\n}\n\nfunc (r *rights) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    for {\n        var name NameElement\n        var access AccessElement\n        if err := d.Decode(&amp;name); err != nil {\n            if err == io.EOF {\n                break\n            }\n            return err\n        }\n        if err := d.Decode(&amp;access); err != nil {\n            return err\n        }\n        value, err := strconv.Atoi(access.Value)\n        if err != nil {\n            return err\n        }\n        r.Rights = append(r.Rights, &amp;right{\n            Name:   name.Value,\n            Access: value,\n        })\n    }\n    return nil\n}\n\nfunc (r *rights) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n\n    parentName := xml.Name{\n        Local: \"Rights\",\n    }\n\n    parentStart := xml.StartElement{\n        Name: parentName,\n    }\n\n    if err := e.EncodeToken(parentStart); err != nil {\n        return err\n    }\n\n    for _, right := range r.Rights {\n        name := NameElement{\n            Value: right.Name,\n        }\n        value := AccessElement{\n            Value: strconv.Itoa(right.Access),\n        }\n        if err := e.Encode(&amp;name); err != nil {\n            return err\n        }\n        if err := e.Encode(&amp;value); err != nil {\n            return err\n        }\n    }\n\n    parentEnd := xml.EndElement{\n        Name: parentName,\n    }\n    if err := e.EncodeToken(parentEnd); err != nil {\n        return err\n    }\n\n    return nil\n}\n\ntype right struct {\n    Name   string\n    Access int\n}\n\nfunc main() {\n    var result sessionInfo\n    if err := xml.Unmarshal(data, &amp;result); err != nil {\n        log.Fatalln(err)\n    }\n\n    if out, err := xml.MarshalIndent(result, \"\", \"  \"); err != nil {\n        log.Fatalln(err)\n    } else {\n        fmt.Println(string(out))\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/MK0RCfJo0a\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MK0RCfJo0a</a></p>\n"}], "owner": {"reputation": 7127, "user_id": 247002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f494e0363428b11d080c35ec3d199ff?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/247002/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 1, "accepted_answer_id": 40575465, "answer_count": 1, "score": 1, "last_activity_date": 1479050654, "creation_date": 1479048633, "question_id": 40575126, "link": "https://stackoverflow.com/questions/40575126/parse-repeating-fields-in-xml", "title": "Parse repeating fields in xml", "body": "<p>I got an xml response that contains multiple entries in the <code>&lt;Rights&gt;&lt;/Rights&gt;</code> block. It has several <code>&lt;Name&gt;&lt;/Name&gt;</code> and <code>&lt;Access&gt;&lt;/Access&gt;</code> fields. </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;SessionInfo&gt;\n   &lt;SID&gt;000000000000&lt;/SID&gt;\n   &lt;Challenge&gt;1337&lt;/Challenge&gt;\n   &lt;BlockTime&gt;0&lt;/BlockTime&gt;\n   &lt;Rights&gt;\n      &lt;Name&gt;Dial&lt;/Name&gt;\n      &lt;Access&gt;2&lt;/Access&gt;\n      &lt;Name&gt;App&lt;/Name&gt;\n      &lt;Access&gt;2&lt;/Access&gt;\n      &lt;Name&gt;HomeAuto&lt;/Name&gt;\n      &lt;Access&gt;2&lt;/Access&gt;\n      &lt;Name&gt;BoxAdmin&lt;/Name&gt;\n      &lt;Access&gt;2&lt;/Access&gt;\n      &lt;Name&gt;Phone&lt;/Name&gt;\n      &lt;Access&gt;2&lt;/Access&gt;\n      &lt;Name&gt;NAS&lt;/Name&gt;\n      &lt;Access&gt;2&lt;/Access&gt;\n   &lt;/Rights&gt;\n&lt;/SessionInfo&gt;\n</code></pre>\n\n<p>I would like to have this converted into a rights struct.</p>\n\n<pre><code>type sessionInfo struct {\n    XMLName    xml.Name `xml:\"SessionInfo\"`\n    SID        string   `xml:\"SID\"`\n    Challenge  string   `xml:\"Challenge\"`\n    BlockTime  uint     `xml:\"BlockTime\"`\n    Rights     []rights `xml:\"Rights\"`\n}\n\ntype rights struct {\n    Name   string `xml:\"Name\"`\n    Access int    `xml:\"Access\"`\n}\n</code></pre>\n\n<p>Unfortunatelly it does only write the last Element into the array. Is it somehow possible to do this in Go without the need to write an own decoder? </p>\n\n<pre><code>&lt;SessionInfo&gt;\n    &lt;SID&gt;000000000000&lt;/SID&gt;\n    &lt;Challenge&gt;1337&lt;/Challenge&gt;\n    &lt;BlockTime&gt;0&lt;/BlockTime&gt;\n    &lt;Rights&gt;\n        &lt;Name&gt;NAS&lt;/Name&gt;\n        &lt;Access&gt;2&lt;/Access&gt;\n    &lt;/Rights&gt;\n&lt;/SessionInfo&gt;\n</code></pre>\n\n<p>You can test this here: <a href=\"https://play.golang.org/p/29I2GPttOz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/29I2GPttOz</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1479048354, "creation_date": 1479048354, "answer_id": 40575079, "question_id": 40575033, "link": "https://stackoverflow.com/questions/40575033/golang-multiple-case-in-type-switch/40575079#40575079", "title": "golang multiple case in type switch", "body": "<p>This is normal behaviour that is defined by <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"noreferrer\">the spec</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>The TypeSwitchGuard may include a short variable declaration. When that form is used, the variable is declared at the beginning of the implicit block in each clause. <strong>In clauses with a case listing exactly one type, the variable has that type; otherwise, the variable has the type of the expression in the TypeSwitchGuard</strong>.</p>\n</blockquote>\n\n<p>So, in fact, the type switch does take effect, but the variable <code>a</code> keeps the type <code>interface{}</code>.</p>\n\n<p>One way you could get around this is to <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">assert</a> that <code>foo</code> has the method <code>test()</code>, which would look something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    a int\n}\n\nfunc (this *A) test() {\n    fmt.Println(this)\n}\n\ntype B struct {\n    A\n}\n\ntype tester interface {\n    test()\n}\n\nfunc main() {\n    var foo interface{}\n    foo = &amp;B{}\n    if a, ok := foo.(tester); ok {\n        fmt.Println(\"foo has test() method\")\n        a.test()\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1315, "user_id": 97550, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9b1045a49a0df780f26ea9910d8a154c?s=128&d=identicon&r=PG", "display_name": "yjfuk", "link": "https://stackoverflow.com/users/97550/yjfuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9251, "favorite_count": 1, "accepted_answer_id": 40575079, "answer_count": 1, "score": 7, "last_activity_date": 1479048497, "creation_date": 1479048151, "last_edit_date": 1479048497, "question_id": 40575033, "link": "https://stackoverflow.com/questions/40575033/golang-multiple-case-in-type-switch", "title": "golang multiple case in type switch", "body": "<p>when I run the code snippet bellow, it raise a error</p>\n\n<blockquote>\n  <p>a.test undefined (type interface {} is interface with no methods)</p>\n</blockquote>\n\n<p>It seem the type switch does not take effect.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    a int\n}\n\nfunc(this *A) test(){\n    fmt.Println(this)\n}\n\ntype B struct {\n    A\n}\n\nfunc main() {\n    var foo interface{}\n    foo = A{}\n    switch a := foo.(type){\n        case B, A:\n            a.test()\n    }\n}\n</code></pre>\n\n<p>If I change it to </p>\n\n<pre><code>    switch a := foo.(type){\n        case A:\n            a.test()\n    }\n</code></pre>\n\n<p>it's ok now.</p>\n"}, {"tags": ["mysql", "go", "kubernetes", "google-kubernetes-engine"], "comments": [{"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 1, "creation_date": 1479046241, "post_id": 40574651, "comment_id": 68384851, "body": "<code>getsockopt</code> implies there&#39;s no actual connectivity to the mysql host.  Do you have a pod network set up?"}, {"owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "reply_to_user": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1479046584, "post_id": 40574651, "comment_id": 68384960, "body": "pod connecting to the mysql host has a network setup, because it can connect to other services, and other db, only mysql can&#39;t connect.."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1479071782, "post_id": 40574651, "comment_id": 68393461, "body": "you should copy here the code where you&#39;re Open()ing the connection"}, {"owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "edited": false, "score": 0, "creation_date": 1479091201, "post_id": 40574651, "comment_id": 68398018, "body": "hey, I updated my post with service, connection func, and other logs"}], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "is_accepted": true, "score": 2, "last_activity_date": 1479105387, "creation_date": 1479105387, "answer_id": 40583114, "question_id": 40574651, "link": "https://stackoverflow.com/questions/40574651/go-mysql-connection-refused-when-connecting-to-kubernetes-mysql-service/40583114#40583114", "title": "go-mysql connection refused when connecting to kubernetes mysql service", "body": "<p>got a response from kubernetes-slack, from mav. I am accessing the <code>mysql-service</code> to a wrong <code>container-port</code>. default mysql port was <code>3306</code>. I thought I was using a custom container that exposes <code>3340</code>.</p>\n"}], "owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1376, "favorite_count": 0, "accepted_answer_id": 40583114, "answer_count": 1, "score": 1, "last_activity_date": 1479105387, "creation_date": 1479045704, "last_edit_date": 1479091153, "question_id": 40574651, "link": "https://stackoverflow.com/questions/40574651/go-mysql-connection-refused-when-connecting-to-kubernetes-mysql-service", "title": "go-mysql connection refused when connecting to kubernetes mysql service", "body": "<p>I have a problem when connecting  to a mysql instance with a go app using standard package.\nThis is my connection string/log</p>\n\n<pre><code>    [13 Nov 16 13:53 +0000] [INFO] connecting to MySQL.. root:awsomepass@tcp(a-mysql-0:3340)/db?charset=utf8&amp;parseTime=True&amp;loc=Local\n    2016/11/13 13:53:25 dial tcp 10.108.1.35:3340: getsockopt: connection refused\n</code></pre>\n\n<p>I tried </p>\n\n<pre><code>GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;\n</code></pre>\n\n<p>here is how I make connection, just basic, with string concatenation only</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"root:awsomepass@tcp(a-mysql-0:3340)/db?charset=utf8&amp;parseTime=True&amp;loc=Local\")\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>I can ping the service, connect to it with mysql-client from a different pod. </p>\n\n<pre><code>    # can connect without port for service\n    / # mysql -u root -h a-mysql-0 -p\n    Enter password:\n    Welcome to the MariaDB monitor.  Commands end with ; or \\g.\n    Your MySQL connection id is 11\n    Server version: 5.7.16 MySQL Community Server (GPL)\n\n    Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.\n\n    Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\n    MySQL [(none)]&gt; Ctrl-C -- exit!\n    Aborted\n\n    # can't' connect with port for service\n    / # mysql -u root -h a-mysql-0:3340 -p\n    Enter password:\n    ERROR 2005 (HY000): Unknown MySQL server host 'a-mysql-0:3340' (-3)\n</code></pre>\n\n<p>and the mysql-service </p>\n\n<pre><code>    \u279c  stg git:(develop) \u2717 kubectl describe svc a-mysql-0\n    Name:            a-mysql-0\n    Namespace:        default\n    Labels:            name=a-mysql-0\n                tier=database\n                type=mysql\n    Selector:        name=a-mysql-0,tier=database\n    Type:            ClusterIP\n    IP:            None\n    Port:            a-mysql-0    3340/TCP\n    Endpoints:        10.108.1.35:3340\n    Session Affinity:    None\n    No events.\n</code></pre>\n\n<p>Is there anything I have missed or permission?</p>\n"}, {"tags": ["python", "node.js", "linux", "go", "format"], "comments": [{"owner": {"reputation": 195, "user_id": 3560330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1612bb4174235e68972b3533aff6051b?s=128&d=identicon&r=PG&f=1", "display_name": "bi0phaz3", "link": "https://stackoverflow.com/users/3560330/bi0phaz3"}, "edited": false, "score": 0, "creation_date": 1479040827, "post_id": 40573841, "comment_id": 68383395, "body": "It is in the format RedNotebook saves it in, it is its own format, so you have to figure out how to parse it yourself"}], "answers": [{"tags": [], "owner": {"reputation": 5356, "user_id": 1885921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02ba513b62ef9f2f7798b9bac1ccf822?s=128&d=identicon&r=PG", "display_name": "vodolaz095", "link": "https://stackoverflow.com/users/1885921/vodolaz095"}, "is_accepted": true, "score": 0, "last_activity_date": 1479042451, "creation_date": 1479042451, "answer_id": 40574163, "question_id": 40573841, "link": "https://stackoverflow.com/questions/40573841/how-to-parse-this-data-provided-by-python/40574163#40574163", "title": "How to parse this data provided by python?", "body": "<p>It turned to be the YAML code.\nIt can be parsed by <a href=\"https://github.com/nodeca/js-yaml\" rel=\"nofollow noreferrer\">https://github.com/nodeca/js-yaml</a></p>\n"}], "owner": {"reputation": 5356, "user_id": 1885921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02ba513b62ef9f2f7798b9bac1ccf822?s=128&d=identicon&r=PG", "display_name": "vodolaz095", "link": "https://stackoverflow.com/users/1885921/vodolaz095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 40574163, "answer_count": 1, "score": -1, "last_activity_date": 1479042451, "creation_date": 1479040249, "last_edit_date": 1592644375, "question_id": 40573841, "link": "https://stackoverflow.com/questions/40573841/how-to-parse-this-data-provided-by-python", "title": "How to parse this data provided by python?", "body": "<p>I have program written in Python - <a href=\"http://rednotebook.sourceforge.net/\" rel=\"nofollow noreferrer\">RedNotebook</a>.\nIt is a modern journal being saved on my PC locally in text files with this format:</p>\n<p><code>$ cat ~/.rednotebook/data/2016-01.txt</code></p>\n<p>gives me something like this:</p>\n<pre><code>10: {text: \u043f\u043b\u043e\u0432}\n11: {text: '#\u043f\u0435\u0440\u0435\u0445\u043e\u0434\n\n    \u041b\u0435\u0433\u043b\u0438 \u043e\u043a\u043e\u043b\u043e \u0447\u0430\u0441\u0430\n\n    \u0412\u0441\u0442\u0430\u043b\u0438 \u043e\u043a\u043e\u043b\u043e 12 \u0447\u0430\u0441\u043e\u0432'}\n12: {text: '{}\n\n''\n\n''{\n\n''}\n\n\\''\n\n\\{\n\n\\}'}\n</code></pre>\n<p>Note that format looks like json, but with single quotes <code>'</code> instead of double quotes, it has integers as primary keys(?) to indicate the day in month. And it escapes special characters by prepending <code>'</code> single quote.</p>\n<p>So, my question is this:</p>\n<p><strong>How does this format of data is called?</strong></p>\n<p>Are there any libraries for parsing this format in Nodejs or Golang?</p>\n<p>UPD1: i have found this post <a href=\"https://answers.launchpad.net/rednotebook/+question/254990\" rel=\"nofollow noreferrer\">How to merge two versions of RedNotebook</a>\nThey say -</p>\n<blockquote>\n<p>it's quite easy to mess up the YAML markup that is used in the month\nfiles, but RedNotebook will issue a warning when it sees such a file\nand you can fix it.</p>\n</blockquote>\n<p>I'll try to parse it as yaml code</p>\n"}, {"tags": ["linux", "ubuntu", "go"], "comments": [{"owner": {"reputation": 5551, "user_id": 1201488, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cce2b982a2acdfb40f3c376489403f1e?s=128&d=identicon&r=PG", "display_name": "Ivan Velichko", "link": "https://stackoverflow.com/users/1201488/ivan-velichko"}, "edited": false, "score": 1, "creation_date": 1479040467, "post_id": 40573837, "comment_id": 68383295, "body": "It is not a host name <code>http:&#47;&#47;127.0.0.1:8090</code>. It&#39;s URL. You can do <code>ping localhost</code> which is pretty useless in this case. Better try something like <code>wget http:&#47;&#47;127.0.0.1:8090</code>"}, {"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 2, "creation_date": 1479040566, "post_id": 40573837, "comment_id": 68383322, "body": "Please post text instead of images when possible."}, {"owner": {"reputation": 105, "user_id": 9064684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e7d1f944d5b90a3268a915f17ad9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Martinez", "link": "https://stackoverflow.com/users/9064684/mauricio-martinez"}, "edited": false, "score": 0, "creation_date": 1589528498, "post_id": 40573837, "comment_id": 109335484, "body": "Not sure why people were giving you downvotes, but this was very helpful to me. Exactly what I was looking for. thank you"}], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 2110053, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57005d8628cb2bf998af91ceea5bbc93?s=128&d=identicon&r=PG", "display_name": "Adi", "link": "https://stackoverflow.com/users/2110053/adi"}, "edited": false, "score": 0, "creation_date": 1479058057, "post_id": 40573963, "comment_id": 68388821, "body": "Thanks. I will try netcat."}], "tags": [], "owner": {"reputation": 59346, "user_id": 444036, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/My2AZ.jpg?s=128&g=1", "display_name": "Paulo Scardine", "link": "https://stackoverflow.com/users/444036/paulo-scardine"}, "is_accepted": true, "score": 4, "last_activity_date": 1479041046, "last_edit_date": 1492085618, "creation_date": 1479041046, "answer_id": 40573963, "question_id": 40573837, "link": "https://stackoverflow.com/questions/40573837/how-to-run-multiple-go-lang-http-servers-at-the-same-time-and-test-them-using-co/40573963#40573963", "title": "How to run multiple Go lang http Servers at the same time and test them using command line?", "body": "<p>The classic ping does not work for testing TCP ports, just hosts (see <a href=\"https://serverfault.com/questions/309357/ping-a-specific-port\">https://serverfault.com/questions/309357/ping-a-specific-port</a>). I've seen many frameworks provide a \"ping\" option to test if the server is alive, may be this is the source of the mistake. </p>\n\n<p>I like to use netcat:</p>\n\n<pre><code>$ nc localhost 8090 -vvv\nnc: connectx to localhost port 8090 (tcp) failed: Connection refused\n\n$ nc localhost 8888 -vvv\nfound 0 associations\nfound 1 connections:\n     1: flags=82&lt;CONNECTED,PREFERRED&gt;\n     outif lo0\n     src ::1 port 64550\n     dst ::1 port 8888\n     rank info not available\n     TCP aux info available\n\nConnection to localhost port 8888 [tcp/ddi-tcp-1] succeeded!\n</code></pre>\n\n<p>You may have to install it with <code>sudo yum install netcat</code> or <code>sudo apt-get install netcat</code> (respectively for RPM and DEB based distros).</p>\n"}], "owner": {"reputation": 337, "user_id": 2110053, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57005d8628cb2bf998af91ceea5bbc93?s=128&d=identicon&r=PG", "display_name": "Adi", "link": "https://stackoverflow.com/users/2110053/adi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6359, "favorite_count": 1, "accepted_answer_id": 40573963, "answer_count": 1, "score": 3, "last_activity_date": 1479791806, "creation_date": 1479040237, "last_edit_date": 1479791806, "question_id": 40573837, "link": "https://stackoverflow.com/questions/40573837/how-to-run-multiple-go-lang-http-servers-at-the-same-time-and-test-them-using-co", "title": "How to run multiple Go lang http Servers at the same time and test them using command line?", "body": "<p>EDIT: My aim was to run multiple Go HTTP Servers at the same time. I was facing some issues while accessing the Go HTTP server running on multiple ports while using Nginx reverse proxy. </p>\n\n<p>Finally, this is the code that I used to run multiple servers. </p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n\n    // Show on console the application stated\n    log.Println(\"Server started on: http://localhost:9000\")\n    main_server := http.NewServeMux()\n\n    //Creating sub-domain\n    server1 := http.NewServeMux()\n    server1.HandleFunc(\"/\", server1func)\n\n    server2 := http.NewServeMux()\n    server2.HandleFunc(\"/\", server2func)\n\n    //Running First Server\n    go func() {\n        log.Println(\"Server started on: http://localhost:9001\")\n        http.ListenAndServe(\"localhost:9001\", server1)\n    }()\n\n    //Running Second Server\n    go func() {\n        log.Println(\"Server started on: http://localhost:9002\")\n        http.ListenAndServe(\"localhost:9002\", server2)\n    }()\n\n    //Running Main Server\n    http.ListenAndServe(\"localhost:9000\", main_server)\n}\n\nfunc server1func(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Running First Server\")\n}\n\nfunc server2func(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Running Second Server\")\n}\n</code></pre>\n\n<p>Few newbie mistakes I was making:</p>\n\n<ol>\n<li><strong>ping <a href=\"http://localhost:9000\" rel=\"noreferrer\">http://localhost:9000</a></strong> -- As mentioned, ping is used for host not a web address. Use <strong>wget <a href=\"http://localhost:9000\" rel=\"noreferrer\">http://localhost:9000</a></strong> instead. Thanks for others for correcting it.</li>\n<li><strong>Ending SSH session while running the application on server</strong> -- Once you close your session, it will also shut down the application.</li>\n<li>Use of Ctrl + Z -- If you are using single terminal window and you will use Ctrl + Z, it will pause the program and you will face issues while accessing the servers </li>\n</ol>\n\n<p>I hope it will help newbie Go lang programmers like me. </p>\n"}, {"tags": ["windows", "go", "dll", "mingw-w64"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479132591, "post_id": 40573401, "comment_id": 68416697, "body": "<code>-buildmode=shared</code> is a Go shared library, which wouldn&#39;t make a DLL anyways. You most likely were looking for <code>buildmode=c-shared</code>, though that hasn&#39;t been worked on for windows yet, and you can follow <a href=\"https://golang.org/issue/11058\" rel=\"nofollow noreferrer\">issue #11058</a>"}, {"owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "edited": false, "score": 1, "creation_date": 1542961736, "post_id": 40573401, "comment_id": 93758887, "body": "Btw, Go 1.10 does support building windows DLLs since update in Oct 10, 2017.  <code>go build -buildmode=c-shared</code>  That single command will generate any DLL for Windows systems.  refer to:  <a href=\"https://go-review.googlesource.com/c/go/+/69091\" rel=\"nofollow noreferrer\">go-review.googlesource.com/c/go/+/69091</a>"}], "answers": [{"tags": [], "owner": {"reputation": 211, "user_id": 7155193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac8633b2f3f4f1a32c329e0938a2236?s=128&d=identicon&r=PG&f=1", "display_name": "user7155193", "link": "https://stackoverflow.com/users/7155193/user7155193"}, "is_accepted": false, "score": 21, "last_activity_date": 1479163272, "last_edit_date": 1479163272, "creation_date": 1479151689, "answer_id": 40596368, "question_id": 40573401, "link": "https://stackoverflow.com/questions/40573401/building-a-dll-with-go-1-7/40596368#40596368", "title": "Building a dll with Go 1.7", "body": "<pre><code>go build -buildmode=c-archive github.com/user/ExportHello\n</code></pre>\n\n<p>====> will build  <code>ExportHello.a</code>, <code>ExportHello.h</code></p>\n\n<p>Take the functions built in <code>ExportHello.a</code> and re-export in <code>Hello2.c</code></p>\n\n<pre><code>gcc -shared -pthread -o Hello2.dll Hello2.c ExportHello.a -lWinMM -lntdll -lWS2_32\n</code></pre>\n\n<p>====> will generate <code>Hello2.dll</code></p>\n"}, {"tags": [], "owner": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "is_accepted": false, "score": 12, "last_activity_date": 1493918547, "creation_date": 1493918547, "answer_id": 43789192, "question_id": 40573401, "link": "https://stackoverflow.com/questions/40573401/building-a-dll-with-go-1-7/43789192#43789192", "title": "Building a dll with Go 1.7", "body": "<p>There is a project on github which shows how to create a DLL, based on, and thanks to user7155193's answer.</p>\n\n<p>Basically you use GCC to build the DLL from golang generated .a and .h files.</p>\n\n<p>First you make a simple Go file that exports a function (or more).</p>\n\n<pre><code>package main\n\nimport \"C\"\nimport \"fmt\"\n\n//export PrintBye\nfunc PrintBye() {\n    fmt.Println(\"From DLL: Bye!\")\n}\n\nfunc main() {\n    // Need a main function to make CGO compile package as C shared library\n}\n</code></pre>\n\n<p>Compile it with:</p>\n\n<pre><code>go build -buildmode=c-archive exportgo.go\n</code></pre>\n\n<p>Then you make a C program (goDLL.c) which will link in the .h and .a files generated above</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"exportgo.h\"\n\n// force gcc to link in go runtime (may be a better solution than this)\nvoid dummy() {\n    PrintBye();\n}\n\nint main() {\n\n}\n</code></pre>\n\n<p>Compile/link the DLL with GCC:</p>\n\n<pre><code>gcc -shared -pthread -o goDLL.dll goDLL.c exportgo.a -lWinMM -lntdll -lWS2_32\n</code></pre>\n\n<p>The goDLL.dll then can be loaded into another C program, a freepascal/lazarus program, or your program of choice.</p>\n\n<p>The complete code with a lazarus/fpc project that loads the DLL is here:\n<a href=\"https://github.com/z505/goDLL\" rel=\"noreferrer\">https://github.com/z505/goDLL</a></p>\n"}, {"tags": [], "owner": {"reputation": 186, "user_id": 7932076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r1K87.png?s=128&g=1", "display_name": "Andrew Dolder", "link": "https://stackoverflow.com/users/7932076/andrew-dolder"}, "is_accepted": true, "score": 17, "last_activity_date": 1539101427, "last_edit_date": 1539101427, "creation_date": 1539007018, "answer_id": 52703905, "question_id": 40573401, "link": "https://stackoverflow.com/questions/40573401/building-a-dll-with-go-1-7/52703905#52703905", "title": "Building a dll with Go 1.7", "body": "<p>As of Go 1.10, -buildmode=c-shared is now supported on Windows.</p>\n\n<p>Release notes:\n<a href=\"https://golang.org/doc/go1.10#compiler\" rel=\"noreferrer\">https://golang.org/doc/go1.10#compiler</a></p>\n\n<p>So now compiling to DLL is a one-liner:</p>\n\n<pre><code>go build -o helloworld.dll -buildmode=c-shared\n</code></pre>\n\n<p>I believe the headers are only compatible with GCC.  If you're only exposing C-types, this should not be a big issue.  I was able to get LoadLibrary to work in Visual Studio without the header.</p>\n"}], "owner": {"reputation": 3396, "user_id": 140053, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/acabd93a27e43aedab281e666615b575?s=128&d=identicon&r=PG", "display_name": "Stef", "link": "https://stackoverflow.com/users/140053/stef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26466, "favorite_count": 14, "accepted_answer_id": 52703905, "answer_count": 3, "score": 16, "last_activity_date": 1539101427, "creation_date": 1479037298, "last_edit_date": 1479041223, "question_id": 40573401, "link": "https://stackoverflow.com/questions/40573401/building-a-dll-with-go-1-7", "title": "Building a dll with Go 1.7", "body": "<p>Is there a way to build a dll against Go v1.7 under Windows ?</p>\n\n<p>I tried a classic</p>\n\n<pre><code>go build -buildmode=shared main.go\n</code></pre>\n\n<p>but get </p>\n\n<blockquote>\n  <p>-buildmode=shared not supported on windows/amd64</p>\n</blockquote>\n\n<p><strong>update</strong>\nOk, I've got my answer. For those who are interested :\n<a href=\"https://groups.google.com/forum/#!topic/golang-dev/ckFZAZbnjzU\" rel=\"noreferrer\">https://groups.google.com/forum/#!topic/golang-dev/ckFZAZbnjzU</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1479032027, "creation_date": 1479032027, "answer_id": 40572729, "question_id": 40572645, "link": "https://stackoverflow.com/questions/40572645/should-i-care-about-providing-asynchronous-calls-in-my-go-library/40572729#40572729", "title": "Should I care about providing asynchronous calls in my go library?", "body": "<p>The whole point of go's execution model is to hide the asynchronous operations from the developer, and behave like a threaded model with blocking operations. Behind the scenes there are green-threads and asynchronous IO and a very sophisticated scheduler.</p>\n\n<p>So no, you shouldn't provide an async API to your library. Networking in go is done in a pseudo-blocking way from the code's perspective, and you open as many goroutines as needed, as they are very cheap. </p>\n\n<p>So your last example is the way to go, and I don't consider it ugly. Because it allows the developer to choose the concurrency model. In the context of an http server, where each command is handled in separate goroutine, I'd just call <code>rpcClient.Call(\"myMethod\", myParam1, myParam2)</code>.</p>\n\n<p>Or if I want a fanout - I'll create fanout logic. </p>\n\n<p>You can also create a convenience function for executing the call and returning on a channel:</p>\n\n<pre><code>func CallAsync(method, p1, p2) chan AsyncResponse {\n    result := make(chan AsyncResponse)\n    go func() {\n        res, err := rpcClient.Call(method, p1, p2)\n        result &lt;- AsyncResponse{res, err}\n    }()\n    return result\n}\n</code></pre>\n"}], "owner": {"reputation": 1747, "user_id": 1223777, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e5d57bacf254409375e9d7b28f2ee952?s=128&d=identicon&r=PG", "display_name": "Subby", "link": "https://stackoverflow.com/users/1223777/subby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 40572729, "answer_count": 1, "score": 2, "last_activity_date": 1479032027, "creation_date": 1479031436, "question_id": 40572645, "link": "https://stackoverflow.com/questions/40572645/should-i-care-about-providing-asynchronous-calls-in-my-go-library", "title": "Should I care about providing asynchronous calls in my go library?", "body": "<p>I am developing a simple go library for jsonrpc over http.</p>\n\n<p>There is the following method:</p>\n\n<pre><code>rpcClient.Call(\"myMethod\", myParam1, myParam2)\n</code></pre>\n\n<p>This method internally does a http.Get() and returns the result or an error (tuple).</p>\n\n<p>This is of course synchron for the caller and returns when the Get() call returns.</p>\n\n<p>Is this the way to provide libraries in go? Should I leave it to the user of my library to make it asynchron if she wants to?</p>\n\n<p>Or should I provide a second function called:</p>\n\n<pre><code>rpcClient.CallAsync()\n</code></pre>\n\n<p>and return a channel here? Because channels cannot provide tuples I have to pack the (response, error) tuple in a struct and return that struct instead.</p>\n\n<p>Does this make sense?</p>\n\n<p>Otherwise the user would have to wrap every call in an ugly method like:</p>\n\n<pre><code>result := make(chan AsyncResponse)\ngo func() {\n    res, err := rpcClient.Call(\"myMethod\", myParam1, myParam2)\n    result &lt;- AsyncResponse{res, err}\n}()\n</code></pre>\n\n<p>Is there a best practice for go libraries and asynchrony?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1479027102, "post_id": 40572106, "comment_id": 68379826, "body": "&quot;need to have many definitions of the Data struct in the same package, which is no good&quot; is an assumption. Just drop that assumption and start coding."}, {"owner": {"reputation": 436, "user_id": 1638158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlmL8.jpg?s=128&g=1", "display_name": "John Dowling", "link": "https://stackoverflow.com/users/1638158/john-dowling"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1479027939, "post_id": 40572106, "comment_id": 68380018, "body": "So are you saying that this is ok to do? I cant find that in any documentation that I have read. Even if is possible to do is it the right way to tackle the problem or am I trying to do the whole square peg thing"}, {"owner": {"reputation": 1057, "user_id": 1750407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EobHJ.jpg?s=128&g=1", "display_name": "Wendy Adi", "link": "https://stackoverflow.com/users/1750407/wendy-adi"}, "edited": false, "score": 0, "creation_date": 1479030538, "post_id": 40572106, "comment_id": 68380625, "body": "Are the &quot;results&quot; you mean is the <code>Result string</code> variable in your <code>Data</code> struct? if yes, then you can use <code>interface{}</code> as data type of <code>Result</code>"}, {"owner": {"reputation": 436, "user_id": 1638158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlmL8.jpg?s=128&g=1", "display_name": "John Dowling", "link": "https://stackoverflow.com/users/1638158/john-dowling"}, "edited": false, "score": 0, "creation_date": 1479032441, "post_id": 40572106, "comment_id": 68381124, "body": "I have already tried this, and while it does work and gives me a map back, it does not seem that great as a solution, if this is the only one or the most accepted one then I can live with that but i would like to think there is something more to it"}], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 1638158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlmL8.jpg?s=128&g=1", "display_name": "John Dowling", "link": "https://stackoverflow.com/users/1638158/john-dowling"}, "edited": false, "score": 0, "creation_date": 1479031519, "post_id": 40572541, "comment_id": 68380869, "body": "Thanks for the links I will give those a read, unfortunately the sole purpose of the package is to talk to this API, so the goal is to efficiently talk to it and handoff structs that others can use."}], "tags": [], "owner": {"reputation": 109227, "user_id": 641955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Hg2nO.jpg?s=128&g=1", "display_name": "janos", "link": "https://stackoverflow.com/users/641955/janos"}, "is_accepted": false, "score": 0, "last_activity_date": 1479030784, "creation_date": 1479030784, "answer_id": 40572541, "question_id": 40572106, "link": "https://stackoverflow.com/questions/40572106/multiple-structs-with-different-composition/40572541#40572541", "title": "Multiple structs with different composition", "body": "<p>Do not create a model structure that mirrors or imitates the API you want to use.\nDesign your model in a way that makes sense to your program,\nfollowing <a href=\"https://en.wikipedia.org/wiki/Domain-driven_design\" rel=\"nofollow noreferrer\">DDD principles</a> at a high conceptual level,\nand <a href=\"https://en.wikipedia.org/wiki/SOLID_(object-oriented_design)\" rel=\"nofollow noreferrer\">SOLID principles</a> at implementation level, for example.</p>\n\n<p>Most probably:</p>\n\n<ul>\n<li>You don't need all the features of the foreign API. By adhering too much to their structures, you will implement a lot of boilerplate that serves no purpose of its own in your program.</li>\n<li>You don't want your program to break down due to minor changes in the foreign API.</li>\n</ul>\n\n<p>Create a layer in your program for communicating with the foreign API,\nand make the rest of your program depend on this layer, never directly on the foreign API.\nThis way, if something changes in the API, you just need to change the communication layer, the rest of the program can continue working unaffected.</p>\n\n<p>In this communication layer, use whatever structures needed to talk to the API.\nDo not use any structures not needed.\nAnd convert these structures to the structures used within the rest of your program.\nThis may involve a lot of manual copying that might not seem pretty at first,\nbut it's the way to protect your program from external changes.</p>\n"}], "owner": {"reputation": 436, "user_id": 1638158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlmL8.jpg?s=128&g=1", "display_name": "John Dowling", "link": "https://stackoverflow.com/users/1638158/john-dowling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1491976708, "creation_date": 1479026982, "last_edit_date": 1491976708, "question_id": 40572106, "link": "https://stackoverflow.com/questions/40572106/multiple-structs-with-different-composition", "title": "Multiple structs with different composition", "body": "<p>I have a problem that I am not sure how to solve in Go. I need to make a client that talks to a json based api.</p>\n\n<p>So I thought that I would use composition to build the struct similar to below.</p>\n\n<pre><code>type (\n    BaseData struct {\n        CommonFields string\n    }\n\n    Data struct {\n        BaseData\n        Result string\n    }\n)\n</code></pre>\n\n<p>Now I would send the Data struct to the api and unmarshal the response to the results, all good so far.</p>\n\n<p>Now the issue is that I have different requests to send that require a different \"results\" composition and therefore would need to have many definitions of the Data struct in the same package, which is no good.</p>\n\n<p>I am struggling to see how this should be done. Any pointers in a direction will great.</p>\n"}, {"tags": ["go", "bessel-functions"], "answers": [{"comments": [{"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1479051579, "post_id": 40572276, "comment_id": 68386574, "body": "Thank you so much for expounding on this. It was all very interesting."}], "tags": [], "owner": {"reputation": 10627, "user_id": 1537925, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U8DRJ.png?s=128&g=1", "display_name": "The Vee", "link": "https://stackoverflow.com/users/1537925/the-vee"}, "is_accepted": true, "score": 7, "last_activity_date": 1479041163, "last_edit_date": 1479041163, "creation_date": 1479028485, "answer_id": 40572276, "question_id": 40572081, "link": "https://stackoverflow.com/questions/40572081/go-bessel-functions/40572276#40572276", "title": "Go: Bessel functions", "body": "<p>I believe it's there mainly because a function of the same name (except capitalisation) and behaviour is in <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/j0.html\" rel=\"nofollow noreferrer\">standard POSIX library</a>. That's also the case for many other functions in the page you link to, like <code>ldexp</code> or <code>lgamma</code> or <code>nextafter</code>.</p>\n\n<p>Speaking of the uses of Bessel functions, they just do come in handy from time to time in mathematical simulations. They are tightly connected with Laplacian problems with spherical symmetry, which relates to physical models like that of an ideal circular drum, quantum mechanical model of hydrogen, or sidebands of a FM radio signal (all heavily simplified in this list). A value of a Bessel function is a denominator of <a href=\"https://en.wikipedia.org/wiki/Von_Mises_distribution\" rel=\"nofollow noreferrer\">von Mises distribution</a>, which is a well-behaved probabilistic distribution on a circle or a sphere, that's also super useful. There are many more, these are just first ideas that came to my mind.</p>\n\n<p>Speaking of motivation, in a way <em>J</em>\u2080 is the next best-behaved special function after the exponential. In calculating an exponential one sums a power series weighted by an inverse factorial. For <em>J</em>\u2080, it's basically the same with the inverse factorial <em>squared</em>. If there's enough justification for a cosine or for erf, there's just as much for that, too. In a few words it's just a function that's sufficiently simple to be quite ubiquitous in mathematics, and there's enough programmers of C-like languages that came there for high-performance computation to actually make some momentum in laying out the standard.</p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 40572276, "answer_count": 1, "score": 4, "last_activity_date": 1479041163, "creation_date": 1479026803, "question_id": 40572081, "link": "https://stackoverflow.com/questions/40572081/go-bessel-functions", "title": "Go: Bessel functions", "body": "<p>I noticed that there are functions for first-order, second-order, and N-order Bessel functions (Y0, Y1, Yn) defined in the standard Go library (<a href=\"https://golang.org/pkg/math/#Y0\" rel=\"nofollow noreferrer\">Y0</a>). I can't seem to determine the practical application of these mathematical functions that would make them so important as to include in the standard library.</p>\n\n<p>Can someone help me out? It seems like Bessels (which I haven't heard of before) relate to describing [graduated?] shapes of quadratic curves, but I'm unsure why this is of special significance to general development.</p>\n"}, {"tags": ["date", "parsing", "datetime", "go", "time"], "comments": [{"owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "reply_to_user": {"reputation": 1557, "user_id": 3825777, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7765923fd9744ac24608e6b463f5bc41?s=128&d=identicon&r=PG&f=1", "display_name": "jqueryHtmlCSS", "link": "https://stackoverflow.com/users/3825777/jqueryhtmlcss"}, "edited": false, "score": 0, "creation_date": 1479024299, "post_id": 40571711, "comment_id": 68379328, "body": "@natel: standard <code>time.Parse</code> function with layout set to above date string."}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "is_accepted": true, "score": 4, "last_activity_date": 1479025528, "creation_date": 1479025528, "answer_id": 40571909, "question_id": 40571711, "link": "https://stackoverflow.com/questions/40571711/how-to-parse-date-time-of-the-following-format/40571909#40571909", "title": "How to parse date/time of the following format?", "body": "<p><a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/#Parse</a></p>\n\n<pre><code>time.Parse(`January 02, 2006, 15:04:05 PM`, `November 05, 2016, 01:02:31 PM`)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/LOD5D-8i_U\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LOD5D-8i_U</a></p>\n"}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 40571909, "answer_count": 1, "score": -2, "last_activity_date": 1479025528, "creation_date": 1479023591, "question_id": 40571711, "link": "https://stackoverflow.com/questions/40571711/how-to-parse-date-time-of-the-following-format", "title": "How to parse date/time of the following format?", "body": "<p>I have time strings of the following format</p>\n\n<pre><code>November 05, 2016, 01:02:31 PM\n</code></pre>\n\n<p>Does any one know how can I parse them into golang <code>Time</code>?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1478999332, "post_id": 40569482, "comment_id": 68375341, "body": "Unmarshal into a <code>map[string]SomeParticularStructType</code>."}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 6, "last_activity_date": 1478999595, "creation_date": 1478999595, "answer_id": 40569510, "question_id": 40569482, "link": "https://stackoverflow.com/questions/40569482/unmarshal-json-with-unknown-field-name/40569510#40569510", "title": "Unmarshal JSON with unknown field name", "body": "<p>Use a map where the key type is <code>string</code> and the value type is a struct with the fields you want, like in <a href=\"https://play.golang.org/p/Lf8FqSz7eY\" rel=\"noreferrer\">this example on the Playground</a> and below:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\ntype Item struct{ X int }\n\nvar x = []byte(`{\n    \"zbqnx\": {\"x\": 3}\n}`)\n\nfunc main() {\n    m := map[string]Item{}\n    err := json.Unmarshal(x, &amp;m)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(m)\n}\n</code></pre>\n"}], "owner": {"reputation": 1789, "user_id": 4056372, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/285fed6a5df00f048a00732292105729?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4056372/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 0, "closed_date": 1562744710, "accepted_answer_id": 40569510, "answer_count": 1, "score": 5, "last_activity_date": 1478999595, "creation_date": 1478999253, "question_id": 40569482, "link": "https://stackoverflow.com/questions/40569482/unmarshal-json-with-unknown-field-name", "closed_reason": "Duplicate", "title": "Unmarshal JSON with unknown field name", "body": "<p>I have a JSON object, something like this:</p>\n\n<pre><code>{\n    \"randomstring\": {\n        \"everything\": \"here\",\n        \"is\": \"known\"\n    }\n}\n</code></pre>\n\n<p>Basically everything inside the <code>randomstring</code> object is known, I can model that, but the <em>randomstring</em> itself is random. I know what it's going to be, but it's different every time. Basically all the data I need is in the <em>randomstring</em> object. How could I parse this kind of JSON to get the data?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1478989221, "post_id": 40568227, "comment_id": 68373157, "body": "Should probably point out that comparing against a bool constant like this is unnecessary. <code>if d() {</code> would suffice. Unless of course you really do want to check that it&#39;s <code>true</code>, and not just truthy, but that&#39;s a rare case."}], "tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": true, "score": 3, "last_activity_date": 1478989761, "last_edit_date": 1478989761, "creation_date": 1478988677, "answer_id": 40568227, "question_id": 40568208, "link": "https://stackoverflow.com/questions/40568208/golangs-bool-type/40568227#40568227", "title": "Golang&#39;s Bool Type", "body": "<p>You're comparing the actual function to true, not the function result, you need to call the function, e.g.</p>\n\n<pre><code>func d() bool {\n    var e bool\n    return e\n}\n\nif d() {\n    fmt.Printf(\"true\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1606, "user_id": 2497650, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/9qcHe.jpg?s=128&g=1", "display_name": "Natus Drew", "link": "https://stackoverflow.com/users/2497650/natus-drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8720, "favorite_count": 0, "accepted_answer_id": 40568227, "answer_count": 1, "score": -4, "last_activity_date": 1478989761, "creation_date": 1478988576, "question_id": 40568208, "link": "https://stackoverflow.com/questions/40568208/golangs-bool-type", "title": "Golang&#39;s Bool Type", "body": "<p>How do I return a true or false from a function and then check it. This code returns an error: <strong>mismatched types func() bool and bool</strong></p>\n\n<pre><code>func d() bool {\n    var e bool\n    return e\n}\n\nif d == true {\n    fmt.Printf(\"true\")\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1478977171, "post_id": 40566314, "comment_id": 68369753, "body": "Yes. I&#39;m not sure how else to answer, because I&#39;m unsure what would lead you to believe it could be unsafe."}, {"owner": {"reputation": 5551, "user_id": 1201488, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cce2b982a2acdfb40f3c376489403f1e?s=128&d=identicon&r=PG", "display_name": "Ivan Velichko", "link": "https://stackoverflow.com/users/1201488/ivan-velichko"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1478977496, "post_id": 40566314, "comment_id": 68369838, "body": "@JimB, actually, after thinking awhile how it works under the hood I realized that the answer is pretty obvious as far as writing to the channel is thread-safe."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1478987292, "post_id": 40566314, "comment_id": 68372578, "body": "<i>A single channel may be used in send statements, receive operations, and calls to the built-in functions cap and len by any number of goroutines without further synchronization.</i> Fore more, see <a href=\"http://stackoverflow.com/questions/34039229/if-i-am-using-channels-properly-should-i-need-to-use-mutexes\">If I am using channels properly should I need to use mutexes?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1479013156, "post_id": 40570705, "comment_id": 68377465, "body": "This is actively confusing; the question asked was whether channel send semantics are changed by moving the send into a function, and they aren&#39;t. <code>&amp;Hub{}</code> is an invalid value of the type full-stop whether the channel send is inside a function call or not."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": -1, "last_activity_date": 1479012631, "creation_date": 1479012631, "answer_id": 40570705, "question_id": 40566314, "link": "https://stackoverflow.com/questions/40566314/is-it-safe-to-hide-sending-to-channel-behind-function-call/40570705#40570705", "title": "Is it safe to hide sending to channel behind function call", "body": "<p><strong>Easy answer</strong></p>\n\n<p><em>Yes</em></p>\n\n<p><strong>Better answer</strong></p>\n\n<p><em>No</em></p>\n\n<p>Channels are great for emitting data from unknown go-routines. They do so safely, however I would recommend being careful with a few parts. In the listed example the channel is created with the construction of the struct by the consumer (and not not by a consumer).</p>\n\n<p>Say the consumer creates the Hub like the following: <code>&amp;Hub{}</code>. Perfectly valid... Apart from the fact that all the invokes of <code>SendMsg()</code> will block for forever. Luckily you placed those in their own go-routines. So you're still fine right? Wrong. You are now leaking go-routines. Seems fine... until you run this for a period of time. Go encourages you to have valid zero values. In this case <code>&amp;Hub{}</code> is not valid.</p>\n\n<p>Ensuring <code>SendMsg()</code> won't block could be achieved via a <code>select{}</code> however you then have to decide what to do when you encounter the default case (e.g. throw data away). The channel could block for more reasons than bad setup too. Say later you do more than simply print the data after reading from the channel. What if the read gets very slow, or blocks on IO. You then will start pushing back on the producers.</p>\n\n<p>Ultimately, channels allow you to not think much about concurrency... However if this is something of high-throughput, then you have quite a bit to consider. If it is production code, then you need to understand that your API here involves <code>SendMsg()</code> blocking.</p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 2, "last_activity_date": 1479013828, "creation_date": 1479013828, "answer_id": 40570798, "question_id": 40566314, "link": "https://stackoverflow.com/questions/40566314/is-it-safe-to-hide-sending-to-channel-behind-function-call/40570798#40570798", "title": "Is it safe to hide sending to channel behind function call", "body": "<p>Channel send semantics do not change when you move the send into a method. Andrew's answer points out that the channel needs to be created with <code>make</code> to send successfully, but that was always true, whether or not the send is inside a method. </p>\n\n<p>If you are concerned about making sure callers can't accidentally wind up with invalid <code>Hub</code> instances with a <code>nil</code> channel, one approach is to make the struct type private (<code>hub</code>) and have a <code>NewHub()</code> function that returns a fully initialized <code>hub</code> wrapped in your interface type. Since the struct is private, code in other packages can't try to initialize it with an incomplete struct literal (or any struct literal).</p>\n\n<p>That said, it's <em>often</em> possible to create invalid or nonsense values in Go and that's accepted: <code>net.IP(\"HELLO THERE BOB\")</code> is valid syntax, or <code>net.IP{}</code>. So if you think it's better to expose your <code>Hub</code> type go ahead.</p>\n"}], "owner": {"reputation": 5551, "user_id": 1201488, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cce2b982a2acdfb40f3c376489403f1e?s=128&d=identicon&r=PG", "display_name": "Ivan Velichko", "link": "https://stackoverflow.com/users/1201488/ivan-velichko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 40570798, "answer_count": 2, "score": 1, "last_activity_date": 1479013828, "creation_date": 1478975909, "question_id": 40566314, "link": "https://stackoverflow.com/questions/40566314/is-it-safe-to-hide-sending-to-channel-behind-function-call", "title": "Is it safe to hide sending to channel behind function call", "body": "<p>I have a struct called <code>Hub</code> with a <code>Run()</code> method which is executed in its own goroutine. This method sequentially handles incoming messages. Messages arrive concurrently from multiple producers (separate goroutines). Of course I use a <code>channel</code> to accomplish this task. But now I want to hide the <code>Hub</code> behind an <code>interface</code> to be able to choose from its implementations. So, using a <code>channel</code> as a simple <code>Hub</code>'s field isn't appropriate. </p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"time\"\n\ntype Hub struct {\n    msgs chan string\n}\nfunc (h *Hub) Run() {\n    for {\n        msg, hasMore := &lt;- h.msgs\n        if !hasMore {\n            return\n        }\n        fmt.Println(\"hub: msg received\", msg)\n    }\n}\nfunc (h *Hub) SendMsg(msg string) {\n    h.msgs &lt;- msg\n}\n\nfunc send(h *Hub, prefix string) {\n    for i := 0; i &lt; 5; i++ {\n        fmt.Println(\"main: sending msg\")\n        h.SendMsg(fmt.Sprintf(\"%s %d\", prefix, i))\n    }\n}\n\nfunc main() {\n    h := &amp;Hub{make(chan string)}\n    go h.Run()\n    for i := 0; i &lt; 10; i++ {\n        go send(h, fmt.Sprintf(\"msg sender #%d\", i))\n    }\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p>So I've introduced <code>Hub.SendMsg(msg string)</code> function that just calls <code>h.msgs &lt;- msg</code> and which I can add to the <code>HubInterface</code>. And as a <code>Go</code>-newbie I wonder, is it safe from the concurrency perspective? And if so - is it a common approach in <code>Go</code>?</p>\n\n<p>Playground <a href=\"https://play.golang.org/p/As7ZqiwWJT\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["mysql", "go", "sqlx"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1478974240, "post_id": 40565805, "comment_id": 68368847, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/38036752/go-and-in-clause-in-postgres\">Go and IN clause in Postgres</a>; and <a href=\"http://stackoverflow.com/questions/39223856/golang-mysql-querying-undefined-amount-of-args-using-in-operator\">Golang MySQL querying undefined amount of args using IN operator</a>."}, {"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1478983577, "post_id": 40565805, "comment_id": 68371598, "body": "@icza I don&#39;t think so. This about a feature that is only available in <code>sqlx</code>."}], "answers": [{"tags": [], "owner": {"reputation": 756, "user_id": 5118579, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pZP_Lc3mcB0/AAAAAAAAAAI/AAAAAAAAAEg/OjPdMmFE3kQ/photo.jpg?sz=128", "display_name": "jai dutt", "link": "https://stackoverflow.com/users/5118579/jai-dutt"}, "is_accepted": false, "score": 0, "last_activity_date": 1572216885, "last_edit_date": 1572216885, "creation_date": 1478973770, "answer_id": 40566002, "question_id": 40565805, "link": "https://stackoverflow.com/questions/40565805/how-to-use-sqlx-to-query-mysql-in-a-slice/40566002#40566002", "title": "How to use sqlx to query mysql IN a slice?", "body": "<p>Hey its because of []int<br>\ntry this</p>\n\n<pre><code>type Int64Array []int64\n\n// Value returns the driver compatible value\nfunc (a Int64Array) Value() (driver.Value, error) {\nvar strs []string\nfor _, i := range a {\n    strs = append(strs, strconv.FormatInt(i, 10))\n}\nreturn \"{\" + strings.Join(strs, \",\") + \"}\", nil\n}\n</code></pre>\n\n<p>and then pass int64 to query</p>\n\n<pre><code>db.Queryx(\"SELECT * FROM quote WHERE qid IN $1\", int64IDs)\n</code></pre>\n\n<p><strong>for more detail check <a href=\"http://www.dammitjim.co.uk/blog/golang-using-pq-sqlx-slices/\" rel=\"nofollow noreferrer\">here</a></strong></p>\n"}, {"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1478984421, "post_id": 40567520, "comment_id": 68371848, "body": "Yes I use <code>sqlx</code> but not sure why I still get the same error."}], "tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": false, "score": -2, "last_activity_date": 1478983830, "creation_date": 1478983830, "answer_id": 40567520, "question_id": 40565805, "link": "https://stackoverflow.com/questions/40565805/how-to-use-sqlx-to-query-mysql-in-a-slice/40567520#40567520", "title": "How to use sqlx to query mysql IN a slice?", "body": "<p>The tags suggest that you are using <code>sqlx</code>. It has <a href=\"http://jmoiron.github.io/sqlx/#inQueries\" rel=\"nofollow noreferrer\">support for <code>IN</code></a> in queries.</p>\n\n<p>So you can do</p>\n\n<pre><code>var qids []int\n//fill qids dynamically\nrows, err = db.Query(&amp;quotes, \"SELECT * FROM quote WHERE qid IN ($1)\", qids)\nif err != nil {\n    log.Println(err)\n}\n// scan the rows\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 3, "creation_date": 1478999580, "post_id": 40567910, "comment_id": 68375397, "body": "It is much more convoluted that I wished to be, but works nonetheless. Thanks."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 18, "last_activity_date": 1543945959, "last_edit_date": 1543945959, "creation_date": 1478986664, "answer_id": 40567910, "question_id": 40565805, "link": "https://stackoverflow.com/questions/40565805/how-to-use-sqlx-to-query-mysql-in-a-slice/40567910#40567910", "title": "How to use sqlx to query mysql IN a slice?", "body": "<p>sqlx has a great helper for that: <a href=\"https://godoc.org/github.com/jmoiron/sqlx#In\" rel=\"noreferrer\">In()</a> we just have to prepare the query taking the args and Rebind, like this:</p>\n\n<pre><code>var qids []int\n\n// fills qids on query dynamically\nquery, args, err := sqlx.In(\"SELECT * FROM quote WHERE qid IN (?)\", qids)\nif err != nil {\n    log.Fatal(err)\n}\n\n// sqlx.In returns queries with the `?` bindvar, we can rebind it for our backend\n//\nquery = database.SQL.Rebind(query)  // database.SQL should be a *sqlx.DB\n\nerr = database.SQL.Select(&amp;quotes, query, args...)\nif err != nil {\n    log.Fatal(err)\n}\n\n// or just in one line:\n\nerr = database.SQL.Select(&amp;quotes, database.SQL.Rebind(query), args...)\n</code></pre>\n\n<p>Also I recommend you take a look here: <a href=\"http://jmoiron.github.io/sqlx/\" rel=\"noreferrer\">http://jmoiron.github.io/sqlx/</a> there're a lot of examples including <strong>IN</strong></p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13483, "favorite_count": 2, "accepted_answer_id": 40567910, "answer_count": 3, "score": 10, "last_activity_date": 1572216885, "creation_date": 1478972683, "last_edit_date": 1478973065, "question_id": 40565805, "link": "https://stackoverflow.com/questions/40565805/how-to-use-sqlx-to-query-mysql-in-a-slice", "title": "How to use sqlx to query mysql IN a slice?", "body": "<p>I want to query a table in mysql database for values <code>IN</code> a slice:</p>\n\n<pre><code>var qids []int\n//fill qids dynamically\nerr = database.SQL.Select(&amp;quotes,\n    \"SELECT * FROM quote WHERE qid IN $1\", qids)\nif err != nil {\n    log.Println(err)\n}\n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code>sql: converting Exec argument #0's type: unsupported type []int, a slice\nquotes []\n</code></pre>\n\n<p>How can I fix this? </p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 3, "creation_date": 1478976911, "post_id": 40564842, "comment_id": 68369674, "body": "a GET is --not likely to-- can have duplicated params. In which cases it is translated to a slice of values. Have you looked to gorilla.schema package ? I believe it can do the job."}, {"owner": {"reputation": 7400, "user_id": 139637, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/452808dcde6558ad24d44be6fb8babc5?s=128&d=identicon&r=PG", "display_name": "Custodio", "link": "https://stackoverflow.com/users/139637/custodio"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1478988731, "post_id": 40564842, "comment_id": 68373016, "body": "In my case I would be fine and keen to have one exception fired in case of duplicates. I gave a look into gorilla.schema, it&#39;s awesome! thanks."}], "answers": [{"tags": [], "owner": {"reputation": 7400, "user_id": 139637, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/452808dcde6558ad24d44be6fb8babc5?s=128&d=identicon&r=PG", "display_name": "Custodio", "link": "https://stackoverflow.com/users/139637/custodio"}, "is_accepted": false, "score": 2, "last_activity_date": 1478990310, "creation_date": 1478990310, "answer_id": 40568479, "question_id": 40564842, "link": "https://stackoverflow.com/questions/40564842/convert-url-query-map-of-slices-to-struct-golang/40568479#40568479", "title": "Convert URL.Query (map of slices) to struct golang", "body": "<p>As pointed out by @mh-cbon <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"nofollow noreferrer\">gorilla schema</a> is the ultimate solution here.</p>\n\n<p>Instead for obtaining the queryParams from the URL attribute.</p>\n\n<pre><code>func handleRequest(w http.ResponseWriter, r *http.Request) {\n    queryString := r.URL.Query()\n    //...parsing the Values -&gt; map[string][]string\n}\n</code></pre>\n\n<p>The approach of gorilla schema is to ship <code>r.PostForm</code> to the decode function.</p>\n\n<pre><code>func handleRequest(w http.ResponseWriter, r *http.Request) {\n    err := decoder.Decode(person, r.PostForm)\n    //...using reflect each struct's property can be called using \n    // the PostForm(url string, data url.Values) signature\n\n    fmt.Print(person.GoodJobGorilla)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "is_accepted": false, "score": 7, "last_activity_date": 1521616763, "last_edit_date": 1521616763, "creation_date": 1521615018, "answer_id": 49399946, "question_id": 40564842, "link": "https://stackoverflow.com/questions/40564842/convert-url-query-map-of-slices-to-struct-golang/49399946#49399946", "title": "Convert URL.Query (map of slices) to struct golang", "body": "<p>Please find below the complete example of parsing get query params directly in a golang struct and then sending the struct back as response</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"encoding/json\"\n    \"github.com/gorilla/schema\"\n)\n\nvar decoder  = schema.NewDecoder()\n\ntype EmployeeStruct struct {\n    MemberId         string `schema:\"memberId\"`\n    ActivityType     string `schema:\"activityType\"`\n    BusinessUnitCode int    `schema:\"businessUnitCode\"`\n}\n\nfunc GetEmployee(w http.ResponseWriter, r *http.Request) {\n    var employeeStruct EmployeeStruct\n\n    err := decoder.Decode(&amp;employeeStruct, r.URL.Query())\n    if err != nil {\n        log.Println(\"Error in GET parameters : \", err)\n    } else {\n        log.Println(\"GET parameters : \", employeeStruct)\n    }\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    json.NewEncoder(w).Encode(employeeStruct)\n}\n\nfunc main() {\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/GetEmployee\", GetEmployee)\n    log.Fatal(http.ListenAndServe(\":8080\", mux))\n}\n</code></pre>\n\n<p>Steps to execute &amp; Test (Assuming you are saving above code in <strong>employee.go</strong>) :</p>\n\n<p><strong>Step 1</strong> : go run employee.go</p>\n\n<p><strong>Step 2</strong> : Open in browser <a href=\"http://localhost:8080/GetEmployee?memberId=123&amp;activityType=Call&amp;businessUnitCode=56\" rel=\"noreferrer\">http://localhost:8080/GetEmployee?memberId=123&amp;activityType=Call&amp;businessUnitCode=56</a></p>\n\n<p><strong>Step 3</strong> : You should get below response in browser window</p>\n\n<pre><code>{\n    \"MemberId\": \"123\",\n    \"ActivityType\": \"Call\",\n    \"BusinessUnitCode\": 56\n}\n</code></pre>\n\n<p><strong>Step 4</strong> : On console you should see below </p>\n\n<pre><code>GET parameters :  {123 Call 56}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 397, "user_id": 4997793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5dkyN.jpg?s=128&g=1", "display_name": "Nima Ghoroubi", "link": "https://stackoverflow.com/users/4997793/nima-ghoroubi"}, "is_accepted": false, "score": 0, "last_activity_date": 1570365585, "creation_date": 1570365585, "answer_id": 58257310, "question_id": 40564842, "link": "https://stackoverflow.com/questions/40564842/convert-url-query-map-of-slices-to-struct-golang/58257310#58257310", "title": "Convert URL.Query (map of slices) to struct golang", "body": "<p>You can use the graceful package of 'Echo'. I write some codes as an example, with self-explanatory comments </p>\n\n<pre><code> package main\n\n import (\n     \"log\"\n     \"github.com/labstacks/echo\"\n)\n\n// Declare your struct with form: \"\" tag\ntype Employee struct {\n    MemberId         string `form:\"memberId\"`\n    ActivityType     string `form:\"activityType\"`\n    BusinessUnitCode int    `form:\"businessUnitCode\"`\n}\n\n// Your handlers should look like this method \n// Which takes an echo.Context and returns an error\nfunc GetEmployee(ctx echo.Context) error{\n    var employee Employee\n    // With Bind, you can get the Post Body or query params from http.Request\n    // that is wrapped by echo.Context here \n    if err := ctx.Bind(&amp;employee);err != nil {\n        return err\n    } \n\n// now you can use your struct , e.g\nreturn ctx.json(200,employee.MemberId)\n}\n\n// now use the handler in your main function or anywhere you need\nfunc main() {\n    e := echo.New\n    e.Get(\"/employee\", GetEmployee)\n    log.Fatal(e.Start(\":8080\"))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 10899423, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L1bhotUREgE/AAAAAAAAAAI/AAAAAAAAAEM/4ozEE_iBB2k/photo.jpg?sz=128", "display_name": "\u5f20\u9986\u957f", "link": "https://stackoverflow.com/users/10899423/%e5%bc%a0%e9%a6%86%e9%95%bf"}, "is_accepted": false, "score": 1, "last_activity_date": 1605598570, "creation_date": 1605598570, "answer_id": 64871019, "question_id": 40564842, "link": "https://stackoverflow.com/questions/40564842/convert-url-query-map-of-slices-to-struct-golang/64871019#64871019", "title": "Convert URL.Query (map of slices) to struct golang", "body": "<p>example:</p>\n<pre><code>filters={&quot;reference&quot;:[&quot;docker.io/library/alpine:latest&quot;]}\n</code></pre>\n<p>need url encode to:</p>\n<pre><code>filters=%7B%22reference%22%3A%5B%22docker.io%2Flibrary%2Falpine%3Alatest%22%5D%7D\n</code></pre>\n<p>and could use <code>&quot;github.com/gorilla/schema&quot;</code></p>\n<pre class=\"lang-golang prettyprint-override\"><code>    query := struct {\n        All     bool\n        Filters map[string][]string `schema:&quot;filters&quot;`\n        Digests bool\n        Filter  string // Docker 1.24 compatibility\n    }{}\n    decoder := schema.NewDecoder()\n    decoder.Decode(&amp;query, r.URL.Query())\n</code></pre>\n"}], "owner": {"reputation": 7400, "user_id": 139637, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/452808dcde6558ad24d44be6fb8babc5?s=128&d=identicon&r=PG", "display_name": "Custodio", "link": "https://stackoverflow.com/users/139637/custodio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14303, "favorite_count": 0, "answer_count": 4, "score": 6, "last_activity_date": 1605598570, "creation_date": 1478967091, "last_edit_date": 1526630757, "question_id": 40564842, "link": "https://stackoverflow.com/questions/40564842/convert-url-query-map-of-slices-to-struct-golang", "title": "Convert URL.Query (map of slices) to struct golang", "body": "<p>It would be awesome to have a straight forward mapping from the standard library <a href=\"https://golang.org/pkg/net/url/#URL.Query\" rel=\"nofollow noreferrer\">URL.Query()</a> to an struct.</p>\n\n<p><code>Query()</code> returns a map like:\n<code>map[a:[aaaa] b:[bbbb] c:[cccc]]</code></p>\n\n<p>The struct looks like:</p>\n\n<pre><code>type Thing struct {\n    A    string\n    B    string\n    C    string\n}\n</code></pre>\n\n<ul>\n<li>I've no idea why URL.Query returns a map with array elements inside tough. (well.. I know <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\">why</a> but a <code>GET</code> is not likely to have duplicated params)</li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 1, "creation_date": 1478954009, "post_id": 40562539, "comment_id": 68362645, "body": "Had a somewhat <a href=\"https://github.com/mhausenblas/cinf/issues/1\" rel=\"nofollow noreferrer\">similar case</a> and never figured out what it was. One hypothesis was that cross-compiling was the root cause (since I built on MacOS)."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 1, "creation_date": 1478980183, "post_id": 40562539, "comment_id": 68370595, "body": "Please compile program with option -ldflags &quot;-w&quot; (e.g go build -ldflags &quot;-w&quot; prog.go) and try to degug it into gdb (gdb prog) and run it (run) . If problem appears, please show us backtrace in that time (bt)."}, {"owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 1, "creation_date": 1479127929, "post_id": 40562539, "comment_id": 68413670, "body": "I built the program on the problematic machine and now it works."}], "answers": [{"tags": [], "owner": {"reputation": 376, "user_id": 899843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2156758e4d22a4dc2a4df09d51931e8e?s=128&d=identicon&r=PG", "display_name": "Josh Lubawy", "link": "https://stackoverflow.com/users/899843/josh-lubawy"}, "is_accepted": false, "score": 2, "last_activity_date": 1484819231, "creation_date": 1484819231, "answer_id": 41738521, "question_id": 40562539, "link": "https://stackoverflow.com/questions/40562539/golang-segmentation-fault-core-dumped/41738521#41738521", "title": "Golang segmentation fault (core dumped)", "body": "<p>My first guess would be you are over-running the bounds of the 's' array:</p>\n\n<pre><code>dest := s[*dir]\n</code></pre>\n\n<p>I added some safety checks (see [Added]):</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"regexp\"\n    \"strings\"\n)\n\nfunc main() {\n    batch := flag.Int(\"batch\", 0, \"the amount of files to be processed\")\n    pattern := flag.String(\"pattern\", \"\", \"string pattern to be matched\")\n    dir := flag.Int(\"dir\", 0, \"key from strings.Split(pattern, '')\")\n    confirm := flag.String(\"move\", \"no\", \"flags if program should move files\")\n\n    flag.Parse()\n\n    d, err := os.Open(\".\")\n    if err != nil {\n        log.Fatal(\"Could not open directory. \", err)\n    }\n    defer d.Close() // [Added] probably not needed if a directory but doesn't hurt\n\n    files, err := d.Readdir(*batch)\n    if err != nil {\n        log.Fatal(\"Could not read directory. \", err)\n    }\n\n    for _, file := range files {\n        fname := file.Name()\n        match, err := regexp.Match(*pattern, []byte(fname))\n        if err != nil {\n            log.Fatal(err)\n        }\n        if match == true {\n            s := strings.Split(fname, \"_\")\n\n            // [Added] Sanity check *dir index before using\n            if *dir &gt;= len(s) {\n                log.Fatalf(\"dir is out of range: dir=%d len(s)=%d\\n\", *dir, len(s))\n            }\n\n            dest := s[*dir]\n\n            switch *confirm {\n            case \"no\":\n                fmt.Printf(\" %s  matches  %s\\n Dir name =  %s\\n -----------------------\\n\", fname, *pattern, dest)\n\n            case \"yes\":\n                //all directories are expected to be a number.\n                //terminate execution if directory doesn't match regex\n                if match, err := regexp.Match(\"[0-9]\", []byte(dest)); match == false {\n                    log.Fatalf(\"Expected directory name does not match prepared directory.\\n Expected dir name must be a number (regex [0-9]) | Current dir name is: %s\\n\", dest)\n                    if err != nil {\n                        log.Fatal(err)\n                    }\n                }\n\n                //check if direcotry exists. create it if it doesn't\n                if _, err := os.Stat(dest); os.IsNotExist(err) {\n                    err = os.Mkdir(dest, 0777)\n                    if err != nil {\n                        log.Fatal(\"Could not create directory. \", err)\n                    }\n                }\n                err = os.Rename(fname, fmt.Sprintf(\"%s/%s\", dest, fname))\n                if err != nil {\n                    log.Fatal(\"Could not move file. \", err)\n                }\n                fmt.Printf(\"Moved %s to %s\\n\", fname, dest)\n\n                // [Added]: Make sure to handle non 'yes/no' answers\n            default:\n                log.Fatalf(\"confirm is invalid '%s'\\n\", *confirm)\n            }\n        }\n    }\n    fmt.Println(\"Exit\")\n}\n</code></pre>\n\n<p>Not sure what you're inputting to the program but nothing else I can see would cause a segmentation fault.</p>\n"}], "owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4948, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1484819231, "creation_date": 1478951257, "question_id": 40562539, "link": "https://stackoverflow.com/questions/40562539/golang-segmentation-fault-core-dumped", "title": "Golang segmentation fault (core dumped)", "body": "<p>I'm new to golang and programming.</p>\n\n<p>I have written a small program that moves files matching a regex from one directory to another.</p>\n\n<p>The program runs successfully on ubuntu 16.04 and on a Centos 6.8 (Final)</p>\n\n<p>On a certain Centos machine (I don't know the exact version of that one. I do know it is 6.? and it is lower than 6.8), I get:</p>\n\n<blockquote>\n  <p>Segmentation fault (core dumped)</p>\n</blockquote>\n\n<p>My research shows that this error occurs when the OS does not allow me to access memory.</p>\n\n<p>Can somebody tell me where it goes wrong in my code. Also please point out bad practices if you see any.</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"regexp\"\n    \"strings\"\n)\n\nfunc main() {\n\n    batch := flag.Int(\"batch\", 0, \"the amount of files to be processed\")\n    pattern := flag.String(\"pattern\", \"\", \"string pattern to be matched\")\n    dir := flag.Int(\"dir\", 0, \"key from strings.Split(pattern, '')\")\n    confirm := flag.String(\"move\", \"no\", \"flags if program should move files\")\n\n    flag.Parse()\n\n    d, err := os.Open(\".\")\n    if err != nil {\n        log.Fatal(\"Could not open directory. \", err)\n    }\n\n    files, err := d.Readdir(*batch)\n    if err != nil {\n        log.Fatal(\"Could not read directory. \", err)\n    }\n\n    for _, file := range files {\n        fname := file.Name()\n        match, err := regexp.Match(*pattern, []byte(fname))\n        if err != nil {\n            log.Fatal(err)\n        }\n        if match == true {\n\n            s := strings.Split(fname, \"_\")\n            dest := s[*dir]\n\n            switch *confirm {\n            case \"no\":\n                fmt.Printf(\" %s  matches  %s\\n Dir name =  %s\\n -----------------------\\n\", fname, *pattern, dest)\n\n            case \"yes\":\n                //all directories are expected to be a number.\n                //terminate execution if directory doesn't match regex\n                if match, err := regexp.Match(\"[0-9]\", []byte(dest)); match == false {\n                    log.Fatalf(\"Expected directory name does not match prepared directory.\\n Expected dir name must be a number (regex [0-9]) | Current dir name is: %s\\n\", dest)\n                    if err != nil {\n                        log.Fatal(err)\n                    }\n                }\n\n                //check if direcotry exists. create it if it doesn't\n                if _, err := os.Stat(dest); os.IsNotExist(err) {\n                    err = os.Mkdir(dest, 0777)\n                    if err != nil {\n                        log.Fatal(\"Could not create directory. \", err)\n                    }\n                }\n                err = os.Rename(fname, fmt.Sprintf(\"%s/%s\", dest, fname))\n                if err != nil {\n                    log.Fatal(\"Could not move file. \", err)\n                }\n                fmt.Printf(\"Moved %s to %s\\n\", fname, dest)\n            }\n        }\n    }\n    fmt.Println(\"Exit\")\n}\n</code></pre>\n"}, {"tags": ["arrays", "json", "go", "marshalling"], "comments": [{"owner": {"reputation": 3365, "user_id": 4322228, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/388b0e91fd6bb09be4f12dc5a67a992a?s=128&d=identicon&r=PG&f=1", "display_name": "kskyriacou", "link": "https://stackoverflow.com/users/4322228/kskyriacou"}, "edited": false, "score": 1, "creation_date": 1478961405, "post_id": 40561930, "comment_id": 68364706, "body": "Not sure if there&#39;s an elegant solution to this, other than a hack where you remove the last array square brace, append the json object and then add the brace again. However, if you&#39;re holding 20MB worth of data in a single file then maybe you should consider going for a db solution, such as mongodb."}, {"owner": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "edited": false, "score": 0, "creation_date": 1478965980, "post_id": 40561930, "comment_id": 68366140, "body": "If you do go for a hacky solution, make sure there is only ever one thread writing to the file."}, {"owner": {"reputation": 167, "user_id": 9316126, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NNuPzpCOcug/AAAAAAAAAAI/AAAAAAAAADo/XPDyVPMo1y8/photo.jpg?sz=128", "display_name": "Milan Vlach", "link": "https://stackoverflow.com/users/9316126/milan-vlach"}, "edited": false, "score": 0, "creation_date": 1599056266, "post_id": 40561930, "comment_id": 112655930, "body": "I think this is a good question for whoever might come across the same issue. The answers are great, as well. Don&#39;t know who voted -1, but I think it should be used as a last resort more wisely."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 2707807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8CyS.jpg?s=128&g=1", "display_name": "wgoudsbloem", "link": "https://stackoverflow.com/users/2707807/wgoudsbloem"}, "is_accepted": false, "score": 0, "last_activity_date": 1478987539, "creation_date": 1478987539, "answer_id": 40568042, "question_id": 40561930, "link": "https://stackoverflow.com/questions/40561930/go-how-to-append-marshalled-json-object-to-a-file/40568042#40568042", "title": "Go - how to append marshalled json object to a file", "body": "<p>You'll have to operate on the raw byte stream, you can remove the closing tags, append the new json objects in and rewrite the closing tags again.</p>\n"}], "owner": {"reputation": 17, "user_id": 3113432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9fb8a10e1600b2aa3520a1b3f6373e?s=128&d=identicon&r=PG&f=1", "display_name": "Davy", "link": "https://stackoverflow.com/users/3113432/davy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478987539, "creation_date": 1478946742, "question_id": 40561930, "link": "https://stackoverflow.com/questions/40561930/go-how-to-append-marshalled-json-object-to-a-file", "title": "Go - how to append marshalled json object to a file", "body": "<p>Is there a way to append marshalled json object into json array inside a file, without loading that file?</p>\n\n<p>Here is what I mean:</p>\n\n<pre><code>Contents of \"file.json\":\n\n// json array\n[\n    // json objects\n    {...},\n    {...},\n    {...}\n    // APPEND NEW marshalled json object here\n]\n</code></pre>\n\n<p>If that's not possible or not efficient, then how viable is holding 20MB worth of structs in a slice for a long period of time?</p>\n"}, {"tags": ["go", "concurrency", "mutex"], "comments": [{"owner": {"reputation": 1715, "user_id": 8712494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iWUnn1PqAuw/AAAAAAAAAAI/AAAAAAAAAGQ/2OslFo_DLk4/photo.jpg?sz=128", "display_name": "Amin Shojaei", "link": "https://stackoverflow.com/users/8712494/amin-shojaei"}, "edited": false, "score": 0, "creation_date": 1618645914, "post_id": 40560007, "comment_id": 118669007, "body": "You can lock your map&#39;s keys by wrapping it"}], "answers": [{"tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": true, "score": 1, "last_activity_date": 1478938378, "creation_date": 1478938378, "answer_id": 40560901, "question_id": 40560007, "link": "https://stackoverflow.com/questions/40560007/in-go-can-we-synchronize-each-key-of-a-map-using-a-lock-per-key/40560901#40560901", "title": "In Go, can we synchronize each key of a map using a lock per key?", "body": "<p>Not exactly, but if you are only reading pointers off a map and modifying the referents, then you aren't modifying the map itself.</p>\n"}, {"tags": [], "owner": {"reputation": 471, "user_id": 1633004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4362c618a90c5601d79bf6c7e5502?s=128&d=identicon&r=PG", "display_name": "Eagle", "link": "https://stackoverflow.com/users/1633004/eagle"}, "is_accepted": false, "score": 0, "last_activity_date": 1524040620, "creation_date": 1524040620, "answer_id": 49894958, "question_id": 40560007, "link": "https://stackoverflow.com/questions/40560007/in-go-can-we-synchronize-each-key-of-a-map-using-a-lock-per-key/49894958#49894958", "title": "In Go, can we synchronize each key of a map using a lock per key?", "body": "<p>This is a simple implementation of what you want: <a href=\"https://github.com/EagleChen/mapmutex\" rel=\"nofollow noreferrer\">mapmutex</a>.</p>\n\n<p>Basically, a mutex is used to guard the map and each item in the map is used like a 'lock'. </p>\n"}], "owner": {"reputation": 347, "user_id": 3143464, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/61846a259282a88fce249311d3ebbf63?s=128&d=identicon&r=PG&f=1", "display_name": "surbhi", "link": "https://stackoverflow.com/users/3143464/surbhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 1, "accepted_answer_id": 40560901, "answer_count": 2, "score": 2, "last_activity_date": 1524040620, "creation_date": 1478930086, "question_id": 40560007, "link": "https://stackoverflow.com/questions/40560007/in-go-can-we-synchronize-each-key-of-a-map-using-a-lock-per-key", "title": "In Go, can we synchronize each key of a map using a lock per key?", "body": "<p>In Go, can we synchronize each key of a map using a lock per key? \nIs map level global lock always required?\nThe documentation says that any access to map is not thread safe. But if a key exists, then can it be locked individually?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 249, "user_id": 5646855, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-KM8NNjCsmog/AAAAAAAAAAI/AAAAAAAACxE/tQ5qSYpFYY8/photo.jpg?sz=128", "display_name": "WinterDev", "link": "https://stackoverflow.com/users/5646855/winterdev"}, "is_accepted": false, "score": 2, "last_activity_date": 1478927887, "creation_date": 1478927887, "answer_id": 40559834, "question_id": 40559810, "link": "https://stackoverflow.com/questions/40559810/string-not-printing-properly-using-fprintf/40559834#40559834", "title": "String not printing properly using FprintF", "body": "<p>Ok, just figured it out </p>\n\n<pre><code> _, err := fmt.Fprintf(irc.connection, message+\" \\r\\n\", args)\n</code></pre>\n\n<p>needs to become</p>\n\n<pre><code> _, err := fmt.Fprintf(irc.connection, message+\" \\r\\n\", args...)\n</code></pre>\n\n<p>I was trying to print an array/slice</p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1478927899, "creation_date": 1478927899, "answer_id": 40559836, "question_id": 40559810, "link": "https://stackoverflow.com/questions/40559810/string-not-printing-properly-using-fprintf/40559836#40559836", "title": "String not printing properly using FprintF", "body": "<p>You want <code>fmt.Fprintf(irc.connection, message+\" \\r\\n\", args...</code>) \u2014 note the <code>args...</code>, not <code>args</code>. When your function declares <code>args ...interface{}</code> that means that it will get all of the remaining arguments as a slice. When you pass <code>args</code> to <code>Fprintf</code>, you're telling it to print that slice. As one thing, a slice. To flatten the slice back out into a list of arguments you use the <code>...</code>.</p>\n\n<p>See <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">Passing arguments to ... parameters</a>.</p>\n"}], "owner": {"reputation": 249, "user_id": 5646855, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-KM8NNjCsmog/AAAAAAAAAAI/AAAAAAAACxE/tQ5qSYpFYY8/photo.jpg?sz=128", "display_name": "WinterDev", "link": "https://stackoverflow.com/users/5646855/winterdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1478927899, "creation_date": 1478927646, "question_id": 40559810, "link": "https://stackoverflow.com/questions/40559810/string-not-printing-properly-using-fprintf", "title": "String not printing properly using FprintF", "body": "<p>I was trying my hand at an irc client but I can't get a string to \"print\" properly using Fprintf. This is the method that is not working:</p>\n\n<pre><code>func (irc *IrcConnection) sendMessage(message string, args ...interface{}) (error){\n\n    fmt.Printf(\"Sending: \"+message, args)\n    _, err := fmt.Fprintf(irc.connection, message+\" \\r\\n\", args)\n    if err != nil{\n        return err;\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>An example of me calling it is </p>\n\n<pre><code>ircConnection.sendMessage(\"PASS %s\",  ircConnection.info.password)\n</code></pre>\n\n<p>The output ends up being \"PASS [password]\", meaning that the password prints with square brackets instead of just the password. </p>\n\n<p>I though at first it was the ...interface{} making it print like that but if I change it to ...string it has the same problem. </p>\n\n<p>If I try:</p>\n\n<pre><code>var test interface{} = ircConnection.info.password\nfmt.Printf(\"%s\", test)\n</code></pre>\n\n<p>It prints without the brackets. </p>\n\n<p>I'm pretty new to go and have no idea what to try next. </p>\n"}, {"tags": ["go", "go-server"], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 5832310, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d332cbdee3fdc26f4964954a94405e7?s=128&d=identicon&r=PG&f=1", "display_name": "UniSound Waterloo", "link": "https://stackoverflow.com/users/5832310/unisound-waterloo"}, "edited": false, "score": 0, "creation_date": 1478966318, "post_id": 40561032, "comment_id": 68366226, "body": "Maybe I need to re-phrase my question. Let&#39;s say I want to construct a json body. I don&#39;t know what the internal structure of the json is. How can I create a map like that?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1478993859, "post_id": 40561032, "comment_id": 68374313, "body": "Go through <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">tour.golang.org</a>, which tells you about maps and a lot of other things you will need. Then, as others say, <code>map[string]interface{}</code> is the type for a JSON object with unknown keys and value types (and <code>[]interface{}</code> is a JSON array with unknown element types)."}], "tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": false, "score": 2, "last_activity_date": 1478939523, "creation_date": 1478939523, "answer_id": 40561032, "question_id": 40559250, "link": "https://stackoverflow.com/questions/40559250/golang-dynamically-creating-member-of-struct/40561032#40561032", "title": "Golang dynamically creating member of struct", "body": "<p>You can't. Go is statically typed, and does not allow such constructs.</p>\n\n<p>Structs have a layout in memory that directly related to the definition, and there's no where to store such additional fields.</p>\n\n<p>You can use a map instead. Moreover, you can use <code>&amp;circle</code> as a key or part of a key, to associate map elements with arbitrary structs.</p>\n\n<pre><code>type key struct {\n    target interface{}\n    field string\n}\n\nx := make(map[key]string)\nx[key{ target: circle, field: \"color\" }] = \"black\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1285, "user_id": 1175849, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cdc21a87b9b48409aa2c5b087d66fd4a?s=128&d=identicon&r=PG", "display_name": "user1175849", "link": "https://stackoverflow.com/users/1175849/user1175849"}, "edited": false, "score": 8, "creation_date": 1551257797, "post_id": 40568896, "comment_id": 96570255, "body": "This answer seems to be all about JSON.  I don&#39;t see in the original question where JSON is mentioned at all. Can you adjust the answer or edit the question?"}], "tags": [], "owner": {"reputation": 615, "user_id": 6026783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b67d843bfecdf923f7fbb9f82cd3ad?s=128&d=identicon&r=PG", "display_name": "James Hillyerd", "link": "https://stackoverflow.com/users/6026783/james-hillyerd"}, "is_accepted": true, "score": 47, "last_activity_date": 1478994010, "last_edit_date": 1478994010, "creation_date": 1478993624, "answer_id": 40568896, "question_id": 40559250, "link": "https://stackoverflow.com/questions/40559250/golang-dynamically-creating-member-of-struct/40568896#40568896", "title": "Golang dynamically creating member of struct", "body": "<p>You will need to use a map (of type <code>map[string]interface{}</code>) to work with dynamic JSON.  Here is an example of creating a new map:</p>\n\n<pre><code>// Initial declaration\nm := map[string]interface{}{\n    \"key\": \"value\",\n}\n\n// Dynamically add a sub-map\nm[\"sub\"] = map[string]interface{}{\n    \"deepKey\": \"deepValue\",\n}\n</code></pre>\n\n<p>Unmarshalling JSON into a map looks like:</p>\n\n<pre><code>var f interface{}\nerr := json.Unmarshal(b, &amp;f)\n</code></pre>\n\n<p>The code above would leave you with a map in <code>f</code>, with a structure resembling:</p>\n\n<pre><code>f = map[string]interface{}{\n    \"Name\": \"Wednesday\",\n    \"Age\":  6,\n    \"Parents\": []interface{}{\n        \"Gomez\",\n        \"Morticia\",\n    },\n}\n</code></pre>\n\n<p>You will need to use a type assertion to access it, otherwise Go won't know it's a map:</p>\n\n<pre><code>m := f.(map[string]interface{})\n</code></pre>\n\n<p>You will also need to use assertions or type switches on each item you pull out of the map.  Dealing with unstructured JSON is a hassle.</p>\n\n<p>More information:</p>\n\n<ul>\n<li><a href=\"https://blog.golang.org/json-and-go\" rel=\"noreferrer\">https://blog.golang.org/json-and-go</a></li>\n<li><a href=\"https://godoc.org/encoding/json#Unmarshal\" rel=\"noreferrer\">https://godoc.org/encoding/json#Unmarshal</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 3381, "user_id": 4479004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56fWH.png?s=128&g=1", "display_name": "xdevs23", "link": "https://stackoverflow.com/users/4479004/xdevs23"}, "edited": false, "score": 0, "creation_date": 1582926209, "post_id": 54056330, "comment_id": 106957794, "body": "You&#39;re a genius! This library is more than useful. One thing is missing, though. Unexported fields can only be added if they have a PkgPath. My suggestion: If extending a field, use the one from the <code>model</code> (<code>reflect.TypeOf(model).Elem().PkgPath()</code>) and for new structs, ask for a PkgPath or maybe try finding it out through the stack. If you want, here is what I did on quick: <a href=\"https://github.com/xdevs23/dynamic-struct/blob/master/builder.go\" rel=\"nofollow noreferrer\">github.com/xdevs23/dynamic-struct/blob/master/builder.go</a>"}, {"owner": {"reputation": 651, "user_id": 4364334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yCAFO.png?s=128&g=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/4364334/marko-milojevic"}, "reply_to_user": {"reputation": 3381, "user_id": 4479004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56fWH.png?s=128&g=1", "display_name": "xdevs23", "link": "https://stackoverflow.com/users/4479004/xdevs23"}, "edited": false, "score": 1, "creation_date": 1589020244, "post_id": 54056330, "comment_id": 109128633, "body": "Thx! I&#39;ll try to add that :)"}], "tags": [], "owner": {"reputation": 651, "user_id": 4364334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yCAFO.png?s=128&g=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/4364334/marko-milojevic"}, "is_accepted": false, "score": 10, "last_activity_date": 1567106624, "last_edit_date": 1567106624, "creation_date": 1546722891, "answer_id": 54056330, "question_id": 40559250, "link": "https://stackoverflow.com/questions/40559250/golang-dynamically-creating-member-of-struct/54056330#54056330", "title": "Golang dynamically creating member of struct", "body": "<p>I've started to work on this small repository <a href=\"https://github.com/Ompluscator/dynamic-struct\" rel=\"noreferrer\">https://github.com/Ompluscator/dynamic-struct</a></p>\n\n<p>It's possible at this point to extend existing struct in runtime, by passing a instance of struct and modifying fields (adding, removing, changing types and tags).</p>\n\n<p>Still in progress, so don't expect something huge :)</p>\n\n<p>EDIT: At this point, work on library is done, and it looks stable for last a couple of months :)</p>\n"}, {"tags": [], "owner": {"reputation": 7266, "user_id": 1055200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e07717a37e32da4c3af5bbfd4e0e7950?s=128&d=identicon&r=PG", "display_name": "b.b3rn4rd", "link": "https://stackoverflow.com/users/1055200/b-b3rn4rd"}, "is_accepted": false, "score": 0, "last_activity_date": 1596679342, "creation_date": 1596679342, "answer_id": 63275846, "question_id": 40559250, "link": "https://stackoverflow.com/questions/40559250/golang-dynamically-creating-member-of-struct/63275846#63275846", "title": "Golang dynamically creating member of struct", "body": "<p>You can do it using reflect package, check <code>StructOf</code> method it allows you to create a new struct from <code>[]reflect.StructField</code>. Example:</p>\n<pre><code>func main() {\ntyp := reflect.StructOf([]reflect.StructField{\n    {\n        Name: &quot;Height&quot;,\n        Type: reflect.TypeOf(float64(0)),\n        Tag:  `json:&quot;height&quot;`,\n    },\n    {\n        Name: &quot;Age&quot;,\n        Type: reflect.TypeOf(int(0)),\n        Tag:  `json:&quot;age&quot;`,\n    },\n})\n\nv := reflect.New(typ).Elem()\nv.Field(0).SetFloat(0.4)\nv.Field(1).SetInt(2)\ns := v.Addr().Interface()\n\nw := new(bytes.Buffer)\nif err := json.NewEncoder(w).Encode(s); err != nil {\n    panic(err)\n}\n\nfmt.Printf(&quot;value: %+v\\n&quot;, s)\nfmt.Printf(&quot;json:  %s&quot;, w.Bytes())\n\nr := bytes.NewReader([]byte(`{&quot;height&quot;:1.5,&quot;age&quot;:10}`))\nif err := json.NewDecoder(r).Decode(s); err != nil {\n    panic(err)\n}\nfmt.Printf(&quot;value: %+v\\n&quot;, s)\n</code></pre>\n<p>}</p>\n"}], "owner": {"reputation": 421, "user_id": 5832310, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d332cbdee3fdc26f4964954a94405e7?s=128&d=identicon&r=PG&f=1", "display_name": "UniSound Waterloo", "link": "https://stackoverflow.com/users/5832310/unisound-waterloo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47420, "favorite_count": 9, "accepted_answer_id": 40568896, "answer_count": 4, "score": 20, "last_activity_date": 1596679342, "creation_date": 1478920751, "last_edit_date": 1574422632, "question_id": 40559250, "link": "https://stackoverflow.com/questions/40559250/golang-dynamically-creating-member-of-struct", "title": "Golang dynamically creating member of struct", "body": "<p>I know there is struct in Go, but for all I know, you have to define struct </p>\n\n<pre><code>type Circle struct{\n    x,y,r float64\n}\n</code></pre>\n\n<p>I am wondering how you can declare a new variable that doesn't exist in the struct</p>\n\n<pre><code>circle := new(Circle)\ncircle.color = \"black\"\n</code></pre>\n"}, {"tags": ["http", "go", "reverse-proxy"], "answers": [{"tags": [], "owner": {"reputation": 3584, "user_id": 743761, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/abe8647a64a9d4220d601a4a32499493?s=128&d=identicon&r=PG&f=1", "display_name": "Keeto", "link": "https://stackoverflow.com/users/743761/keeto"}, "is_accepted": false, "score": -2, "last_activity_date": 1478919675, "creation_date": 1478919675, "answer_id": 40559148, "question_id": 40559051, "link": "https://stackoverflow.com/questions/40559051/golang-reverse-proxy-for-google-com/40559148#40559148", "title": "golang reverse proxy for google.com", "body": "<p>it turns out it is because google uses https.</p>\n"}], "owner": {"reputation": 3584, "user_id": 743761, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/abe8647a64a9d4220d601a4a32499493?s=128&d=identicon&r=PG&f=1", "display_name": "Keeto", "link": "https://stackoverflow.com/users/743761/keeto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1478919675, "creation_date": 1478918511, "question_id": 40559051, "link": "https://stackoverflow.com/questions/40559051/golang-reverse-proxy-for-google-com", "title": "golang reverse proxy for google.com", "body": "<p>I am trying to play with golang's reverse proxy. I am trying to create a reverse proxy on my localhost that would forward my request to google.com and get back with the response. Even though this seems a simple task, I am not able to get a correct result. I am getting a google 404 response saying that the url \"/\" is not found</p>\n\n<p>My code</p>\n\n<pre><code>package main\nimport (\n    \"log\"\n    \"net/http\"\n    \"net/http/httputil\"\n    \"net/url\"\n)\n\nfunc main() {\n    gogle, _ := url.Parse(\"http://www.google.com\")\n    proxy := httputil.NewSingleHostReverseProxy(gogle)\n    log.Fatal(http.ListenAndServe(\":12345\", proxy))\n}\n</code></pre>\n\n<p>what is that I am missing?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1478916706, "post_id": 40558854, "comment_id": 68355266, "body": "When you want &quot;mutual exclusion&quot; around a resource, use a mutex. There&#39;s no reason for a more complex solution with more concurrency, when a simple lock will do."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1478916832, "post_id": 40558854, "comment_id": 68355290, "body": "Roughly: a single goroutine acts as a &quot;server&quot;, and &quot;requests&quot; are sent to it and &quot;responses&quot; sent back via channels--&quot;requests&quot; can include a struct with the response channel itself as a member. Agree with JimB you essentially never want to do that, though, but assigning all state a single &quot;owner&quot; is basically how you get from locks to CSP."}, {"owner": {"reputation": 743, "user_id": 4234140, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/O3b4i.jpg?s=128&g=1", "display_name": "dylan7", "link": "https://stackoverflow.com/users/4234140/dylan7"}, "edited": false, "score": 0, "creation_date": 1478916833, "post_id": 40558854, "comment_id": 68355291, "body": "So then what is the difference between &quot;passing ownership&quot; and mutual exclusion? because the situation you both provided with the &quot;server&quot; and making requests sounds like passing ownership and also sounds like mutual exclusion."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1479001100, "post_id": 40558854, "comment_id": 68375661, "body": "Often, the usefulness of &quot;passing ownership&quot; is that you can describe the your app&#39;s data flow and your mutual-exclusion scheme at once using channel notation. If you want to do something like a work queue or pipeline, channels fit more naturally than mutexes. They&#39;re not terribly useful in the situation you&#39;re describing, as noted in the question and the comments above."}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1528427090, "post_id": 40558854, "comment_id": 88513487, "body": "While I think the mutex is the right approach. If you have one lock object and you want sending it on a channel to have the semantics of releasing the lock, I think you could represent this with a buffered channel of size 1. Of course this will give you another problem where some other misbehaving code could push two values onto your channel. You should just use a mutex."}], "owner": {"reputation": 743, "user_id": 4234140, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/O3b4i.jpg?s=128&g=1", "display_name": "dylan7", "link": "https://stackoverflow.com/users/4234140/dylan7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478916423, "creation_date": 1478916423, "question_id": 40558854, "link": "https://stackoverflow.com/questions/40558854/converting-a-mutex-solution-into-a-channel-solution", "title": "converting a mutex solution into a channel solution", "body": "<p>I am writing a golang program that has to perform multiple download requests at a time utilizing goroutines running in parallel (using GOMAXPROCS). In addition, there is a form of state kept, which is which components have been downloaded and which components are left to be downloaded. The mutex solution would be to lock this structure keeping track of which components have been successfully downloaded. I have read that when attempting to keep state, mutexes are the best option.</p>\n\n<p>However, I am wondering what would be a solution utilizing channels (passing ownership instead of providing exclusive access to state) instead of mutexes, or are mutexes the best option?</p>\n\n<p>P.S. \nSo far I have thought of passing the global structure keeping state between go routines which are all utilizing one channel (a read-write channel). A go routine attempts to read the structure from the channel and then write it back when it's done.The problem I found with this, is that when the last running go routine [assume all others have finished and stopped running] gives up its posession of the structure by writing to the channel, it will result in deadlock since there are no receivers. In addition, this is still attempting to use channels as mutexes [attempting to provide exclusive access].</p>\n"}, {"tags": ["bash", "go", "directory"], "comments": [{"owner": {"reputation": 3594, "user_id": 2079249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3fcded7f2ae3a90901101a27b5867f56?s=128&d=identicon&r=PG", "display_name": "Ronak Patel", "link": "https://stackoverflow.com/users/2079249/ronak-patel"}, "edited": false, "score": 2, "creation_date": 1478906333, "post_id": 40556004, "comment_id": 68353344, "body": "There should not be space between <code>=</code> , variable name and value <code>export GOPATH=$HOME &gt;&gt; ~&#47;.profile</code>"}, {"owner": {"reputation": 691, "user_id": 7139528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ac1707910f28b04551ed7ba6f1b645bc?s=128&d=identicon&r=PG&f=1", "display_name": "siur", "link": "https://stackoverflow.com/users/7139528/siur"}, "reply_to_user": {"reputation": 3594, "user_id": 2079249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3fcded7f2ae3a90901101a27b5867f56?s=128&d=identicon&r=PG", "display_name": "Ronak Patel", "link": "https://stackoverflow.com/users/2079249/ronak-patel"}, "edited": false, "score": 0, "creation_date": 1478913969, "post_id": 40556004, "comment_id": 68354861, "body": "@BigDataLearner This time I did not include the space, and It worked but when I entered the <code>source $HOME&#47;.profile</code> it returned the <code>-bash: export: =&#39; : not a valid identifier.</code> error"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1478917173, "post_id": 40556004, "comment_id": 68355369, "body": "Open the .profile in an editor and fix the incorrect lines you&#39;ve added."}, {"owner": {"reputation": 3594, "user_id": 2079249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3fcded7f2ae3a90901101a27b5867f56?s=128&d=identicon&r=PG", "display_name": "Ronak Patel", "link": "https://stackoverflow.com/users/2079249/ronak-patel"}, "edited": false, "score": 0, "creation_date": 1478918511, "post_id": 40556004, "comment_id": 68355532, "body": "@siur - JimB is right...you already have inserted lines with spaces, you will need to delete/edit those"}], "answers": [{"tags": [], "owner": {"reputation": 157, "user_id": 3088280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/814c5f8886e75babd54d53848e54e25a?s=128&d=identicon&r=PG&f=1", "display_name": "cleung2010", "link": "https://stackoverflow.com/users/3088280/cleung2010"}, "is_accepted": false, "score": 1, "last_activity_date": 1478902132, "creation_date": 1478902132, "answer_id": 40557008, "question_id": 40556004, "link": "https://stackoverflow.com/questions/40556004/i-am-having-problems-creating-my-gopath-on-my-mac/40557008#40557008", "title": "I am having problems creating my GOPATH on my mac", "body": "<p>It should be: </p>\n\n<pre><code>echo 'export GOPATH=$HOME' &gt;&gt; $HOME/.profile\n</code></pre>\n"}], "owner": {"reputation": 691, "user_id": 7139528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ac1707910f28b04551ed7ba6f1b645bc?s=128&d=identicon&r=PG&f=1", "display_name": "siur", "link": "https://stackoverflow.com/users/7139528/siur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1478902132, "creation_date": 1478897439, "question_id": 40556004, "link": "https://stackoverflow.com/questions/40556004/i-am-having-problems-creating-my-gopath-on-my-mac", "title": "I am having problems creating my GOPATH on my mac", "body": "<pre><code>    Andres-Air:~ iivri.andre$ echo 'export GOPATH = $HOME'&gt;&gt; $HOME/.profile\nAndres-Air:~ iivri.andre$ source $HOME/.profile\n-bash: export: `=': not a valid identifier\n-bash: export: `/Users/iivri.andre': not a valid identifier\nAndres-Air:~ iivri.andre$ source $HOME/.profile\n-bash: export: `=': not a valid identifier\n-bash: export: `/Users/iivri.andre': not a valid identifier\n</code></pre>\n\n<p>I am attempting to export it to my environment but I am getting these errors. How do I ensure that created the root directory correctly ? </p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 3365, "user_id": 4322228, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/388b0e91fd6bb09be4f12dc5a67a992a?s=128&d=identicon&r=PG&f=1", "display_name": "kskyriacou", "link": "https://stackoverflow.com/users/4322228/kskyriacou"}, "edited": false, "score": 0, "creation_date": 1478909810, "post_id": 40552001, "comment_id": 68354152, "body": "You can launch them locally using <code>goapp serve</code>. Check this video out, goes over the process pretty well: <a href=\"https://www.bigmarker.com/remote-meetup-go/Mini-Workshop-Build-a-Web-App-with-Francesc\" rel=\"nofollow noreferrer\">bigmarker.com/remote-meetup-go/&hellip;</a>"}, {"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "reply_to_user": {"reputation": 3365, "user_id": 4322228, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/388b0e91fd6bb09be4f12dc5a67a992a?s=128&d=identicon&r=PG&f=1", "display_name": "kskyriacou", "link": "https://stackoverflow.com/users/4322228/kskyriacou"}, "edited": false, "score": 0, "creation_date": 1478924091, "post_id": 40552001, "comment_id": 68356468, "body": "goapp serve returns an error that the <code>context</code> library, which is a go system library, is not found. This issue seems to be the Google App Engine SDK bundles it&#39;s own version of Go that doesn&#39;t include the context library."}], "answers": [{"comments": [{"owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "edited": false, "score": 0, "creation_date": 1478999455, "post_id": 40561187, "comment_id": 68375369, "body": "Damn, that sucks, because 1.6.x does not work on macOS Sierra."}, {"owner": {"reputation": 18841, "user_id": 368070, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5aefd3e85213e1c22ee31e4ce6123d40?s=128&d=identicon&r=PG", "display_name": "gideon", "link": "https://stackoverflow.com/users/368070/gideon"}, "edited": false, "score": 0, "creation_date": 1503655264, "post_id": 40561187, "comment_id": 78716166, "body": "if I have go1.8 on my machine how would I develop for GAE. Would I have to have a virtual machine or something?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 18841, "user_id": 368070, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5aefd3e85213e1c22ee31e4ce6123d40?s=128&d=identicon&r=PG", "display_name": "gideon", "link": "https://stackoverflow.com/users/368070/gideon"}, "edited": false, "score": 0, "creation_date": 1503655446, "post_id": 40561187, "comment_id": 78716257, "body": "@gideon Not needed, the appengine SDK contains a Go compiler. Just start your project with the SDK, and it monitors the Go source files and recompiles / restarts if something changes. Your installed Go is not used by the SDK. At least this is how it worked back in the old days. I&#39;m not up-to-date on this, things might have changed."}, {"owner": {"reputation": 18841, "user_id": 368070, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5aefd3e85213e1c22ee31e4ce6123d40?s=128&d=identicon&r=PG", "display_name": "gideon", "link": "https://stackoverflow.com/users/368070/gideon"}, "edited": false, "score": 0, "creation_date": 1503655534, "post_id": 40561187, "comment_id": 78716315, "body": "aha. I see so the gae tools have a whole toolchain around go1.6? I see. Now the docs sort of fit. Thanks so much :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1478941277, "last_edit_date": 1495541634, "creation_date": 1478940735, "answer_id": 40561187, "question_id": 40552001, "link": "https://stackoverflow.com/questions/40552001/running-go-app-engine-apps-locally/40561187#40561187", "title": "Running Go App Engine apps locally.", "body": "<p>The GAE Go SDK contains and uses a modified version of Go 1.6.2., and the <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\"><code>context</code></a> package was added to the standard lib in Go 1.7. The old API that comes bundled in the SDK uses the <code>appengine.Context</code> context.</p>\n\n<p>See related question: <a href=\"https://stackoverflow.com/questions/39638348/appengine-go-using-a-new-version-of-go-with-the-sdk\">AppEngine/Go: Using a new version of Go with the SDK</a></p>\n"}], "owner": {"reputation": 13004, "user_id": 887128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21dfdd82b179972af12332a8db35ac64?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/887128/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1478941277, "creation_date": 1478880845, "question_id": 40552001, "link": "https://stackoverflow.com/questions/40552001/running-go-app-engine-apps-locally", "title": "Running Go App Engine apps locally.", "body": "<p>I'm trying to run an App Engine app locally using the <a href=\"https://cloud.google.com/appengine/docs/go/tools/using-local-server#Go_Running_the_development_web_server\" rel=\"nofollow noreferrer\">development server</a>, as specified in Google's docs. I'm running into a ton of compilation errors due to the go library packaged in the SDK missing system libraries. </p>\n\n<p>Looking at the <a href=\"https://cloud.google.com/appengine/docs/go/download\" rel=\"nofollow noreferrer\">SDK download page</a>, it says:</p>\n\n<blockquote>\n  <p>Note: The Google App Engine Launcher does not work with Go apps.</p>\n</blockquote>\n\n<p>So is there no way to launch Go apps running on App Engine locally? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1478876755, "post_id": 40550441, "comment_id": 68339853, "body": "I don&#39;t think this is possible to do without a <code>map[string]http.Handler</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1478877611, "post_id": 40550441, "comment_id": 68340322, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/37384473/call-all-functions-with-special-prefix-or-suffix-in-golang\">Call all functions with special prefix or suffix in Golang</a>."}], "answers": [{"tags": [], "owner": {"reputation": 8073, "user_id": 2852624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/682806d261e4f00f77aa8633689a9558?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias247", "link": "https://stackoverflow.com/users/2852624/matthias247"}, "is_accepted": false, "score": 1, "last_activity_date": 1478876755, "creation_date": 1478876755, "answer_id": 40550754, "question_id": 40550441, "link": "https://stackoverflow.com/questions/40550441/runtime-access-to-symbols-in-go/40550754#40550754", "title": "Runtime access to symbols in Go", "body": "<p>There's some limited way to access things during runtime with the <code>reflect</code> package. However it doesn't allow you to search for all suitable standalone functions in a package. It would be possible if they are all methods on a known struct type/value.</p>\n\n<p>As an alternative your given example you could simply use a <code>map[string]func(...)</code> to store all handlers, initialize it at startup (during <code>init()</code>) and fetch the handlers from there. But that also more or less what the existing http muxes are doing.</p>\n"}, {"tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 1, "last_activity_date": 1478876923, "creation_date": 1478876923, "answer_id": 40550801, "question_id": 40550441, "link": "https://stackoverflow.com/questions/40550441/runtime-access-to-symbols-in-go/40550801#40550801", "title": "Runtime access to symbols in Go", "body": "<p>There's nothing like eval in Go, which is a good thing since things like that are very dangerous.</p>\n\n<p>What you can do is have a map mapping the handler strings in your config file to the handler functions in your code:</p>\n\n<pre><code>var handlers = map[string]func(http.ResponseWriter, *http.Request) (int, error){\n        \"Apple\": AppleHandler,\n        \"Banana\": BananaHandler,\n}\n</code></pre>\n\n<p>Then you can register those handlers by simply doing:</p>\n\n<pre><code>handler, ok := handlers[config.Handler]\nif !ok {\n        log.Fatal(fmt.Errorf(\"Handler not found\"))\n}\nr.HandleFunc(config.URL, handler).Methods(config.Method)\n</code></pre>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 40550801, "answer_count": 2, "score": 0, "last_activity_date": 1478876923, "creation_date": 1478875631, "question_id": 40550441, "link": "https://stackoverflow.com/questions/40550441/runtime-access-to-symbols-in-go", "title": "Runtime access to symbols in Go", "body": "<p>In writing a Web server in Go, I'd like to be able to dereference symbols at runtime, to allow me to figure out which functions to call from a configuration file, something like the call to the fictional \"eval\" function in the example below. That would allow me to select handlers from a library of handlers, and to deploy a new server with just a config file. Is there any way to accomplish this in Go?</p>\n\n<p><strong>config.json</strong></p>\n\n<pre><code>{ \"url\": \"/api/apple\", \"handler\": \"Apple\", \"method\": \"get\" }\n{ \"url\": \"/api/banana\", \"handler\": \"Banana\", \"method\": \"get\" }\n</code></pre>\n\n<p><strong>play.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n    \"encoding/json\"\n    \"log\"\n)\n\ntype ConfigEntry struct {\n    URL string `json:\"url\"`\n    Method string `json:\"method\"`\n    Handler string `json:\"handler\"`\n}\n\nfunc main() {\n    ifp, err := os.Open(\"config.json\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    dec := json.NewDecoder(ifp)\n    r := mux.NewRouter()\n\n    for {\n        var config ConfigEntry\n\n        if err = dec.Decode(&amp;m); err == io.EOF {\n            break\n        } else if err != nil {\n            log.Fatal(err)\n        }\n\n        r.HandleFunc(config.URL, eval(config.Handler + \"Handler\")).Methods(config.Method)\n    }\n\n    http.Handle(\"/\", r)\n    http.ListenAndServe(8080, nil)\n}\n\nfunc AppleHandler(w http.ResponseWriter, r *http.Request) (status int, err error) {\n    w.Write(\"Apples!\\n\")\n    return http.StatusOK, nil\n}\n\nfunc BananaHandler(w http.ResponseWriter, r *http.Request) (status int, err error) {\n    w.Write(\"Bananas!\\n\")\n    return http.StatusOK, nil\n}\n</code></pre>\n"}, {"tags": ["c++", "go", "tcp", "udp", "p2p"], "comments": [{"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1478872956, "post_id": 40549502, "comment_id": 68337555, "body": "<code>if they are behind any sort of router</code> The main problem is NAT, which in turn is because of the lack of addresses in IPv4. Without NAT, it would be simple, yes. And no, without third host this is not doable (in IPv4). One end has to start the connection, and the other router has no way to know which host behind it is the target."}, {"owner": {"reputation": 503, "user_id": 7106084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f169a8f4cb706ce899562e82a817b6?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Waldon", "link": "https://stackoverflow.com/users/7106084/christopher-waldon"}, "edited": false, "score": 0, "creation_date": 1478892406, "post_id": 40549502, "comment_id": 68347914, "body": "Have you looked at <a href=\"https://github.com/libp2p/go-libp2p\" rel=\"nofollow noreferrer\">libp2p</a>?"}, {"owner": {"reputation": 103, "user_id": 3185732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98899f36f3a90c53a05d8df8c114e737?s=128&d=identicon&r=PG&f=1", "display_name": "Chrysm_Seal", "link": "https://stackoverflow.com/users/3185732/chrysm-seal"}, "reply_to_user": {"reputation": 503, "user_id": 7106084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f169a8f4cb706ce899562e82a817b6?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Waldon", "link": "https://stackoverflow.com/users/7106084/christopher-waldon"}, "edited": false, "score": 0, "creation_date": 1478903323, "post_id": 40549502, "comment_id": 68352374, "body": "@ChristopherWaldon Looks interesting but is still WIP and doesn&#39;t seem to offer anything ICE doesn&#39;t, ie still falls back on a server relay if other connection types aren&#39;t possible. Thanks though."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1479253862, "post_id": 40549502, "comment_id": 68477580, "body": "To setup a P2P connection requires <i>exchange</i> of IP address and ports. Hence, at least some service is needed to get those IP addresses and ports passed around.  How else would you do it?  I&#39;d previously answered this question <a href=\"http://stackoverflow.com/questions/8523330/programming-p2p-application\">here</a> with some of the lightweight overview of how to do ICE."}], "answers": [{"tags": [], "owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "is_accepted": false, "score": 2, "last_activity_date": 1479254050, "last_edit_date": 1479254050, "creation_date": 1479253525, "answer_id": 40621714, "question_id": 40549502, "link": "https://stackoverflow.com/questions/40549502/establishing-p2p-tcp-udp-connections-nat-traversal/40621714#40621714", "title": "Establishing P2P TCP/UDP connections (NAT traversal)", "body": "<p>This is not strictly a Go question \u2014 it's a general networking question.</p>\n\n<p>The reason this is so difficult is that the Internet was never designed to support NAT, NAT just happened and broke a lot of functionality.  The clean solution to your problem is to switch to IPv6, where there is no NAT, but that might not be possible </p>\n\n<p>If your NAT box supports NAT-PMP or uPNP, you could use that.  The simplest way would be to create a cgo binding to <code>libminiupnpc</code>, or you could go fishing for a native Go library.</p>\n\n<p>If your NAT doesn't support either of these protocols, then you're probably out of luck, as hole punching is a fragile and difficult technique that you will probably find difficult to implement.</p>\n"}], "owner": {"reputation": 103, "user_id": 3185732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98899f36f3a90c53a05d8df8c114e737?s=128&d=identicon&r=PG&f=1", "display_name": "Chrysm_Seal", "link": "https://stackoverflow.com/users/3185732/chrysm-seal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 951, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480009467, "creation_date": 1478872591, "last_edit_date": 1479253206, "question_id": 40549502, "link": "https://stackoverflow.com/questions/40549502/establishing-p2p-tcp-udp-connections-nat-traversal", "title": "Establishing P2P TCP/UDP connections (NAT traversal)", "body": "<p>Is there any way to establish true P2P communication through TCP or UDP without an intermediary server? I understand that this is quite doable if the two computers have only public IP addresses but if they are behind any sort of NAT router or on a private network it starts to get tricky.. in fact the more I look into it the more it seems plain not possible. I have discovered STUN, TURN and ICE protocols and hole-punching but as far as I understand they all require some sort of server to at least establish the connection. I am amazed something seemingly so simple seems so hard to do, am I missing something? \nIdeally I am looking for solutions using Golang any help or examples in C++ would also be useful, thanks.</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1478871540, "post_id": 40549132, "comment_id": 68336753, "body": "What does the error say?"}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1478871722, "post_id": 40549132, "comment_id": 68336856, "body": "No error <code>fmt.Println(decodedBody)</code> gives me <code>map[]</code> instead of <code>map[id:1]</code>. The first decoded body is giving me <code>map[name:abc]</code> correctly"}, {"owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 3, "creation_date": 1478872171, "post_id": 40549132, "comment_id": 68337100, "body": "Coudn&#39;t reproduce <a href=\"https://play.golang.org/p/YzdXR90x0O\" rel=\"nofollow noreferrer\">play.golang.org/p/YzdXR90x0O</a>. Please provide a MVCE."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4493478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e56f347eef544fa7d0740c8222a1c01?s=128&d=identicon&r=PG&f=1", "display_name": "mkchristina", "link": "https://stackoverflow.com/users/4493478/mkchristina"}, "is_accepted": false, "score": 0, "last_activity_date": 1545359189, "creation_date": 1545359189, "answer_id": 53878450, "question_id": 40549132, "link": "https://stackoverflow.com/questions/40549132/go-gin-intercepting-a-request-body/53878450#53878450", "title": "Go-gin intercepting a request body", "body": "<p>because you set the decodeBody's data type with string,if your value is not the string value, it will not decode the correct value,{\"id\":1},it's value's type is int,not the string.</p>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 591, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545359189, "creation_date": 1478871256, "last_edit_date": 1478895179, "question_id": 40549132, "link": "https://stackoverflow.com/questions/40549132/go-gin-intercepting-a-request-body", "title": "Go-gin intercepting a request body", "body": "<p>I am using go-gin as server and trying to decode the request body. When I send request which has both the strings </p>\n\n<pre><code>{\n    \"name\": \"abc\"\n}\n</code></pre>\n\n<p>The following code decodes it correctly:</p>\n\n<pre><code>var decodedBody map[string]string\nerr = json.NewDecoder(c.Request.Body).Decode(&amp;decodedBody)\n</code></pre>\n\n<p>But if I send</p>\n\n<pre><code>{\n    \"id\": 1\n}\n</code></pre>\n\n<p>The following code gives me a blank map</p>\n\n<pre><code>var decodedBody map[string]int\nerr = json.NewDecoder(c.Request.Body).Decode(&amp;decodedBody)\n</code></pre>\n\n<p>Not sure what am I missing here. Any pointers?</p>\n"}, {"tags": ["go", "apache-kafka", "avro", "kafka-consumer-api"], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 5989625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UgpQM.jpg?s=128&g=1", "display_name": "Mehran Prs", "link": "https://stackoverflow.com/users/5989625/mehran-prs"}, "edited": false, "score": 0, "creation_date": 1608898580, "post_id": 40585412, "comment_id": 115708953, "body": "The answer of &quot;Maybe someone can explain why&quot;: when you produce a message with schema registry serializer, Kafka client&#39;s message serializer add schema id in the first bytes of the message, if you use the cline deserializer, it checks that first byte to detect schema id and fetch it from schema registry(if needed), but when you don&#39;t use standard Kafka client&#39;s deserializer, so you need to skip those first bytes."}], "tags": [], "owner": {"reputation": 679, "user_id": 445721, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/869911ed2233aa61b241826b57038c8d?s=128&d=identicon&r=PG", "display_name": "imehl", "link": "https://stackoverflow.com/users/445721/imehl"}, "is_accepted": true, "score": 8, "last_activity_date": 1479115665, "creation_date": 1479115665, "answer_id": 40585412, "question_id": 40548909, "link": "https://stackoverflow.com/questions/40548909/consume-kafka-avro-messages-in-go/40585412#40585412", "title": "Consume Kafka Avro messages in go", "body": "<p>Just found out (by comparing binary avro messages) that I had to remove the first 5 elements of the message byte array - now everything works :)</p>\n\n<pre><code>message = msg.Value[5:]\n</code></pre>\n\n<p>Maybe someone can explain why</p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 7427500, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/59393822d5ee1abae1801b4ce72bdcc5?s=128&d=identicon&r=PG", "display_name": "Gavin", "link": "https://stackoverflow.com/users/7427500/gavin"}, "is_accepted": false, "score": 17, "last_activity_date": 1527523702, "last_edit_date": 1527523702, "creation_date": 1484601769, "answer_id": 41685186, "question_id": 40548909, "link": "https://stackoverflow.com/questions/40548909/consume-kafka-avro-messages-in-go/41685186#41685186", "title": "Consume Kafka Avro messages in go", "body": "<p><a href=\"https://docs.confluent.io/current/schema-registry/docs/serializer-formatter.html#wire-format\" rel=\"noreferrer\">The first byte is a magic byte (0). The following 4 bytes are the avro schema ID</a> </p>\n\n<p>Which is only really useful if you use the Confluent schema registry. </p>\n"}], "owner": {"reputation": 679, "user_id": 445721, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/869911ed2233aa61b241826b57038c8d?s=128&d=identicon&r=PG", "display_name": "imehl", "link": "https://stackoverflow.com/users/445721/imehl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3706, "favorite_count": 1, "accepted_answer_id": 40585412, "answer_count": 2, "score": 3, "last_activity_date": 1530200538, "creation_date": 1478870423, "question_id": 40548909, "link": "https://stackoverflow.com/questions/40548909/consume-kafka-avro-messages-in-go", "title": "Consume Kafka Avro messages in go", "body": "<p>I'm trying to consume Kafka messages in avro format but I'm not able to decode the messages from avro to json in Go.</p>\n\n<p>I'm using the Confluent platform (3.0.1). For example I produce avro messages like:</p>\n\n<pre><code>kafka-avro-console-producer --broker-list localhost:9092 --topic test --property value.schema='{\"type\":\"record\",\"name\":\"myrecord\",\"fields\":[{\"name\":\"f1\",\"type\":\"string\"}]}'\n{\"f1\":\"message1\"}\n{\"f1\":\"message2\"}\n</code></pre>\n\n<p>Now I consume messages with the go Kafka libary: sarama. Plain text message are working fine. Avro message have to be decoded. I found different libs: github.com/linkedin/goavro, github.com/elodina/go-avro</p>\n\n<p>But after decoding I get a json without values (both libs):</p>\n\n<pre><code>{\"f1\":\"\"}\n</code></pre>\n\n<p>goavro:</p>\n\n<pre><code>avroSchema := `\n{\"type\":\"record\",\"name\":\"myrecord\",\"fields\":[{\"name\":\"f1\",\"type\":\"string\"}]}\n`\ncodec, err := goavro.NewCodec(avroSchema)\nif err != nil {\n    log.Fatal(err)\n}\nbb := bytes.NewBuffer(msg.Value)\ndecoded, err := codec.Decode(bb)\nlog.Println(fmt.Sprintf(\"%s\", decoded))\n</code></pre>\n\n<p>go-avro:</p>\n\n<pre><code>schema := avro.MustParseSchema(avroSchema)\nreader := avro.NewGenericDatumReader()\nreader.SetSchema(schema)\ndecoder := avro.NewBinaryDecoder(msg.Value)\ndecodedRecord := avro.NewGenericRecord(schema)\nlog.Println(decodedRecord.String())\n</code></pre>\n\n<p>msg = sarama.ConsumerMessage</p>\n"}, {"tags": ["arrays", "json", "go"], "answers": [{"comments": [{"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1478881123, "post_id": 40551355, "comment_id": 68342398, "body": "I tried that but the problem is that the JSON is nested and the data I want is inside other objects. The other parser I used solves this issue but forces me to use strings. Anyway, I solved the problem by iterating over the string and manipulating it using its indices. Thanks though!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1478878854, "creation_date": 1478878854, "answer_id": 40551355, "question_id": 40548648, "link": "https://stackoverflow.com/questions/40548648/how-can-i-convert-a-string-to-json-and-save-the-data-in-an-array/40551355#40551355", "title": "How can I convert a string to JSON and save the data in an array?", "body": "<p>Use the standard <a href=\"https://godoc.org/encoding/json\" rel=\"nofollow noreferrer\">encoding/json</a> package to unmarshal the data into a value matching the shape of the data:</p>\n\n<pre><code>var items []struct {  // Use slice for JSON array, struct for JSON object\n    Name string       \n    Type string        \n}\nif err := json.Unmarshal(d, &amp;items); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Loop through the unmarshaled items to find shows and movies:</p>\n\n<pre><code>var shows, movies []string\nfor _, item := range items {\n    switch item.Type {\n    case \"movie\":\n        movies = append(movies, item.Name)\n    case \"show\":\n        shows = append(shows, item.Name)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/jEZc7dxI67\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 40551355, "answer_count": 1, "score": 0, "last_activity_date": 1478878854, "creation_date": 1478869417, "last_edit_date": 1478869738, "question_id": 40548648, "link": "https://stackoverflow.com/questions/40548648/how-can-i-convert-a-string-to-json-and-save-the-data-in-an-array", "title": "How can I convert a string to JSON and save the data in an array?", "body": "<p>I'm using <a href=\"http://github.com/buger/jsonparser\" rel=\"nofollow noreferrer\">this</a> JSON parser to extract data from a JSON response I'm getting from an API. It returns a byte array containing the data and when convert the byte array to a string and print it, I get the following output:</p>\n\n<pre><code>   [{\"Name\": \"Vikings\", \"Type\": \"show\"}, \n   {\"Name\": \"Spartacus: Gods Of The Arena\", \"Type\": \"show\"}, \n   {\"Name\": \"True Detective\", \"Type\": \"show\"}, \n   {\"Name\": \"The Borgias\", \"Type\": \"show\"}, \n   {\"Name\": \"Se7en\", \"Type\": \"movie\"}]\n</code></pre>\n\n<p>Since this is a regular string, I have no way of maniuplating the data to extract whatever I need. Ideally, I'd like to have arrays like these:</p>\n\n<pre><code>   shows := [\"Vikings\", \"Spartacus: Gods Of The Arena\"...]\n   movies := [\"Se7en\", \"other data\", ...]\n</code></pre>\n\n<p>What I want to do with these arrays is give the user titles based on the type (ie: show, movie, etc) he/she asked for. So essentially what I'm looking for is a way to convert the string in to something that I can easily manipulate (and possibly filter).  </p>\n\n<p>I apoligize if this seems like a strange way of doing this, but I can't think of any other way of doing it. I feel like Go's syntax and way of doing things is very unconventional compared to another language like Javascript where I could easily have done this in a line or two.  </p>\n"}, {"tags": ["go", "cross-compiling"], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1478964249, "post_id": 40547140, "comment_id": 68365558, "body": "Thank you for the answer! Information on the links explains quite a lot!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1478866462, "last_edit_date": 1478866462, "creation_date": 1478864029, "answer_id": 40547140, "question_id": 40546840, "link": "https://stackoverflow.com/questions/40546840/how-can-a-compiler-cross-compile-to-a-different-os-and-architecture/40547140#40547140", "title": "How can a compiler cross-compile to a different OS and architecture?", "body": "<blockquote>\n  <p>I mean that would require knowing (and probably behaving like) the target machine language and platform.</p>\n</blockquote>\n\n<p>Yes, the Go compiler has to know how the target operating system works, but it <em>doesn't need to behave</em> like the target OS, as the Go compiler <em>will not run</em> the compiled executable binary, it just needs to <em>produce</em> it.</p>\n\n<p>All the Go tools need to know is the binary formats of the different Operating Systems, and OS and architectural details (such as the instruction set, word size, endianness, alignment, available registers etc.; <a href=\"https://landley.net/writing/docs/cross-compiling.html\" rel=\"nofollow noreferrer\">more info on this</a>). And this knowledge is built into the Go tools.</p>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 2, "accepted_answer_id": 40547140, "answer_count": 1, "score": 3, "last_activity_date": 1478866462, "creation_date": 1478863028, "question_id": 40546840, "link": "https://stackoverflow.com/questions/40546840/how-can-a-compiler-cross-compile-to-a-different-os-and-architecture", "title": "How can a compiler cross-compile to a different OS and architecture?", "body": "<p>I'm very intrigued by the fact that Go (since v1.5) has in-built cross compilation options.\nBut how is it possible to compile for a different OS and architecture?\nI mean that would require knowing (and probably behaving like) the target machine language and platform.</p>\n"}, {"tags": ["laravel", "http", "redirect", "go", "server"], "answers": [{"comments": [{"owner": {"reputation": 781, "user_id": 5057805, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9USavIbjP-M/AAAAAAAAAAI/AAAAAAAAADk/5fj7tZo247s/photo.jpg?sz=128", "display_name": "Paul Parker", "link": "https://stackoverflow.com/users/5057805/paul-parker"}, "edited": false, "score": 1, "creation_date": 1478871064, "post_id": 40545484, "comment_id": 68336456, "body": "Awesome answer. This also led me to the <code>Request</code> <code>Referer()</code> method which allows the compiler to check for the mis-mis-spelling of Referer."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 781, "user_id": 5057805, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9USavIbjP-M/AAAAAAAAAAI/AAAAAAAAADk/5fj7tZo247s/photo.jpg?sz=128", "display_name": "Paul Parker", "link": "https://stackoverflow.com/users/5057805/paul-parker"}, "edited": false, "score": 1, "creation_date": 1478873113, "post_id": 40545484, "comment_id": 68337656, "body": "@PaulParker You&#39;re right, using <a href=\"https://golang.org/pkg/net/http/#Request.Referer\" rel=\"nofollow noreferrer\"><code>Request.Referer()</code></a> is even better. I&#39;ll edit."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1478874288, "last_edit_date": 1478874288, "creation_date": 1478858449, "answer_id": 40545484, "question_id": 40544972, "link": "https://stackoverflow.com/questions/40544972/can-go-easily-emulate-the-behaviour-of-laravels-return-redirectback/40545484#40545484", "title": "Can Go easily emulate the behaviour of Laravel&#39;s return Redirect::back()?", "body": "<p>The <code>Redirect::back()</code> function uses the URL from the <code>Referer</code> HTTP header specified by the client (browser).</p>\n\n<p>You could access this header value like <code>r.Header.Get(\"Referer\")</code>, but the <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\"><code>http.Request</code></a> type also provides a direct <a href=\"https://golang.org/pkg/net/http/#Request.Referer\" rel=\"nofollow noreferrer\"><code>Request.Referer()</code></a> method that returns the value of this <code>Referer</code> field, which also deals with its 2 possible forms (<code>\"Referer\"</code> and <code>\"Referrer\"</code>).</p>\n\n<p>This is how you can mimic the \"go back\" behavior:</p>\n\n<pre><code>func PostHandler(w http.ResponseWriter, r *http.Request) {\n    // Process form, then:\n    if rf := r.Referer(); rf != \"\" {\n        http.Redirect(w, r, rf, http.StatusSeeOther)\n        return\n    }\n\n    // No Referer specified, supply your own response\n    // or redirect to a default / home page\n    http.Redirect(w, r, \"/\", http.StatusSeeOther)\n}\n</code></pre>\n\n<p>If you want to call this from many handlers, you may capture this functionality in a helper function:</p>\n\n<pre><code>func redirectBack(w http.ResponseWriter, r *http.Request) {\n    if rf := r.Referer(); rf != \"\" {\n        http.Redirect(w, r, rf, http.StatusSeeOther)\n        return\n    }\n\n    // No Referer specified, supply your own response\n    // or redirect to a default / home page\n    http.Redirect(w, r, \"/\", http.StatusSeeOther)\n}\n</code></pre>\n\n<p>And then using it:</p>\n\n<pre><code>func PostHandler(w http.ResponseWriter, r *http.Request) {\n    // Process form, then:\n    redirectBack(w, r)\n}\n</code></pre>\n"}], "owner": {"reputation": 781, "user_id": 5057805, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9USavIbjP-M/AAAAAAAAAAI/AAAAAAAAADk/5fj7tZo247s/photo.jpg?sz=128", "display_name": "Paul Parker", "link": "https://stackoverflow.com/users/5057805/paul-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 40545484, "answer_count": 1, "score": 2, "last_activity_date": 1478910820, "creation_date": 1478856892, "last_edit_date": 1478910820, "question_id": 40544972, "link": "https://stackoverflow.com/questions/40544972/can-go-easily-emulate-the-behaviour-of-laravels-return-redirectback", "title": "Can Go easily emulate the behaviour of Laravel&#39;s return Redirect::back()?", "body": "<p>While using <strong>Laravel</strong>, I really appreciated being able to use:        </p>\n\n<pre><code>return Redirect::back();   \n</code></pre>\n\n<p>to return to the previous URL after a <code>POST</code> request.   </p>\n\n<p>Is there a simple in-built way to do this in <strong>Go</strong>?</p>\n\n<pre><code>http.Redirect(w, r, backURL, http.StatusSeeOther)\n</code></pre>\n\n<p>where <code>backURL</code> is the URL that the POST request was made from.</p>\n\n<p>I've looked through <code>net/http</code> and searched SE and google, but I haven't turned anything up. Failing an easy way, I'd appreciate any pointer toward the idiomatic way of doing this in <strong>Go</strong>.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1478912668, "post_id": 40558440, "comment_id": 68354685, "body": "Thanks user1638680.....Is there any other attribute in mongodb which helps us in finding the least index.This is definitely better than the code of mine but i dont want the 1000 records of leave array to be retrieved inside the ram for every request even though we are just retrieving only two attributes of the leave array.Thanks...Once again thanks for your help."}, {"owner": {"reputation": 75, "user_id": 1638680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3daa6d9e1fd176087a06f2bac4475895?s=128&d=identicon&r=PG", "display_name": "dgm", "link": "https://stackoverflow.com/users/1638680/dgm"}, "reply_to_user": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1478913357, "post_id": 40558440, "comment_id": 68354780, "body": "In Mongo 3.2 you can use $slice with a negative number from the Mongo shell, eg"}, {"owner": {"reputation": 75, "user_id": 1638680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3daa6d9e1fd176087a06f2bac4475895?s=128&d=identicon&r=PG", "display_name": "dgm", "link": "https://stackoverflow.com/users/1638680/dgm"}, "reply_to_user": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1478913569, "post_id": 40558440, "comment_id": 68354814, "body": "Oops, I pressed return prematurely. With the Mongo shell you can run a query like: db.c.find({&quot;empid&quot;: &quot;1234&quot;}, { &quot;leave&quot;: { $slice: -1 }}) and get the last entry in the array. I had a quick look and didn\u2019t find any examples of using $slice from Go."}, {"owner": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1478918095, "post_id": 40558440, "comment_id": 68355471, "body": "Thanks for pointing me in the right direction.I have researched and found this link <a href=\"http://stackoverflow.com/questions/37253400/how-to-write-a-mongodb-slice-in-golang.So\" title=\"how to write a mongodb slice in golang.So\">stackoverflow.com/questions/37253400/&hellip;</a> i have written my code based on this but the result gives me more than the no of records in the array.I will update my question please take a look to it and please help to solve this .Thanks"}], "tags": [], "owner": {"reputation": 75, "user_id": 1638680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3daa6d9e1fd176087a06f2bac4475895?s=128&d=identicon&r=PG", "display_name": "dgm", "link": "https://stackoverflow.com/users/1638680/dgm"}, "is_accepted": false, "score": 1, "last_activity_date": 1478914858, "last_edit_date": 1478914858, "creation_date": 1478911920, "answer_id": 40558440, "question_id": 40544700, "link": "https://stackoverflow.com/questions/40544700/to-find-the-last-index-of-the-array-in-mongodb/40558440#40558440", "title": "to find the last index of the array in mongodb", "body": "<p>If you are running a version on Mongo which has $slice in it, It was introduced in 2.4, you can use it in a Find with the addition of a Select Function, which works like project.</p>\n\n<pre><code>err = c.Find(bson.M{\"empid\": \"1234\"}).Select(bson.M{\"name\": 1, \"leave\": bson.M{\"$slice\": -1}}).One(&amp;result) // result is an Employee struct\n</code></pre>\n\n<p>Otherwise, aggregation is your friend. You need to use a pipeline and unwind the Employee Leave field.</p>\n\n<p>There are a few simple steps:</p>\n\n<p>1) Define a result record based on your Employee record where the Leave field is defined as a single LeaveInfo rather than a slice of LeaveInfos, eg</p>\n\n<pre><code>EmployeeResult struct {\n    Name   string    `bson:\"name\"`\n    Leave  LeaveInfo `bson:\"leave\"`\n}\n</code></pre>\n\n<p>Do not forget to make the bson tag the same name as the LeaveInfo tag in the Employee struct.</p>\n\n<p>2) Then create a pipeline with a couple of stages:</p>\n\n<pre><code>query := bson.M{\"empid\": \"1234\"}  // gets the employee you are interested in\nmatch := bson.M{\"$match\": query}  // Set up the match part of the pipeline\nunwind := bson.M{\"$unwind\": \"$leave\"}  // sets up the leave field to be unwound\npipeline := []bson.M{match, unwind} // the pipeline you are passing to pipe. I like to split the parts of the pipe call up for clarity and ease of later modification\n</code></pre>\n\n<p>3) Call Pipe with the pipeline as a parameter then Iter over the results, this should give you one LeaveInfo at a time</p>\n\n<pre><code>var (\n    result EmployeeResult\n)\niter := postCollection.Pipe(pipeline).Iter()\nfor iter.Next(&amp;result) {\n    fmt.Printf(\"%+v\\n\", result)\n}\niter.Close()\n</code></pre>\n\n<p>4) At the end of the loop, result will have the last item in the list, or be blank if nothing was read.</p>\n"}], "owner": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478919844, "creation_date": 1478855985, "last_edit_date": 1478919844, "question_id": 40544700, "link": "https://stackoverflow.com/questions/40544700/to-find-the-last-index-of-the-array-in-mongodb", "title": "to find the last index of the array in mongodb", "body": "<p>In the back end i m using go lang and for database i use mongoDB. I m trying to find the last document inserted in the embedded array so i can retrieve the document in the last array index without knowing its index.Right now i m getting all the documents of the employee and then find the last index.It is like overloading my RAM as i need to retrieve 1000 of record of employee and store it in ram before finding the last index of the array\nMy struct is as follows</p>\n\n<pre><code> type (\n        Employee struct {\n            Name               string\n            Password           string\n            EmpId              string \n           EmailAddress       string\n           Position           string\n           Gender             string\n           Nationality        string\n           Department         string\n           MaritalStatus      string\n           Approvedby         string\n           JoinDate           time.Time\n           ConfirmationDate   time.Time\n           EndDate            time.Time\n            Leave             []*LeaveInfo  \n        }\n        LeaveInfo struct {\n            Total        float64\n            Id           int\n            Days         float64\n            From        time.Time\n             To          time.Time  \n            Status       string\n            Certificate  []*CertificateInfo\n        }\n        CertificateInfo struct {\n            FileName string\n            FileType string\n            FileSize int\n\n        }\n</code></pre>\n\n<p>Here is how i do in my application </p>\n\n<pre><code> My code is follows\n\n    employee := Employee{}\n    err = c.Find(bson.M{\n                  \"empid\": \"1234\"\n                 }).One(&amp;result)\n    if err != nil {\n            log.Fatal(err)\n    }\n          name:=result.Name        \n          lastindex:= result.LeaveInfo[len(result.LeaveInfo)-1].Id\n</code></pre>\n\n<p>As you can see  i retrive the whole employee data and then find the Id of the last document.Is there any better way to do this.Appreciate any help.Please ...Thanks..</p>\n\n<blockquote>\n  <p>Newly Added Codes</p>\n</blockquote>\n\n<pre><code> This code is based on your example\n\n   var result bson.M\n\n    query := bson.M{\"empid\": \"1234\"}  // gets the employee you are interested in\n    match := bson.M{\"$match\": query}  // Set up the match part of the pipeline\n    unwind := bson.M{\"$unwind\": \"$leave\"}  // sets up the leave field to be unwound\n\n    pipeline := []bson.M{match, unwind,{\n    \"$project\":bson.M{\n           \"ID\":bson.M{\n                \"$slice\": []interface{}{\"$leave.id\", -1},\n        }\n       }\n\n\n    iter := postCollection.Pipe(pipeline).Iter()\n    for iter.Next(&amp;result) {\n        fmt.Printf(\"%+v\\n\", result)\n    }\n    iter.Close()\n</code></pre>\n\n<p>This code gives me lot of same document  like 542 documents .But all these document are same...</p>\n"}, {"tags": ["http", "ssl", "go"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7144860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JwkBMtqcRTo/AAAAAAAAAAI/AAAAAAAAKiQ/TD2WidbCGv4/photo.jpg?sz=128", "display_name": "Manoj Saha", "link": "https://stackoverflow.com/users/7144860/manoj-saha"}, "edited": false, "score": 0, "creation_date": 1478946290, "post_id": 40549614, "comment_id": 68360803, "body": "Thanks  for your detailed response. I have tested above code through sample program But socket option IP_TOS value couldn&#39;t set in syn packet initiated from http client. Here I have one doubt , while passing argument to DialContext( ctx, network, addr), how to create context to pass as ctx. Currently I used  <b>DialContext(context.Background() network, addr)</b> ?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 31, "user_id": 7144860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JwkBMtqcRTo/AAAAAAAAAAI/AAAAAAAAKiQ/TD2WidbCGv4/photo.jpg?sz=128", "display_name": "Manoj Saha", "link": "https://stackoverflow.com/users/7144860/manoj-saha"}, "edited": false, "score": 0, "creation_date": 1478954641, "post_id": 40549614, "comment_id": 68362787, "body": "@ManojSaha See edit and try it. Whether it works or not, you might want to request a feature on the Go issue tracker to somehow allow setting options on FDs."}, {"owner": {"reputation": 31, "user_id": 7144860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JwkBMtqcRTo/AAAAAAAAAAI/AAAAAAAAKiQ/TD2WidbCGv4/photo.jpg?sz=128", "display_name": "Manoj Saha", "link": "https://stackoverflow.com/users/7144860/manoj-saha"}, "edited": false, "score": 1, "creation_date": 1479367156, "post_id": 40549614, "comment_id": 68529021, "body": "Thanks again for your efforts!! I tested in sample program , set api for dscp setting is success and I could read the dscp value through get api for dscp, but it&#39;s not reflecting in the tcp connection request in syn packet. still I am seeing dscp is 0."}, {"owner": {"reputation": 139, "user_id": 3310346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4082fff872a770c6427baeea723fa3?s=128&d=identicon&r=PG", "display_name": "Pedro A. Aranda", "link": "https://stackoverflow.com/users/3310346/pedro-a-aranda"}, "edited": false, "score": 1, "creation_date": 1532324154, "post_id": 40549614, "comment_id": 89912355, "body": "Same here. Used <code>SetsockoptInt</code> on a <code>TCPConn</code> directly and saw <code>dscp=0</code> on wireshark. Go 1.10 on MacOS 10.13"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 139, "user_id": 3310346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4082fff872a770c6427baeea723fa3?s=128&d=identicon&r=PG", "display_name": "Pedro A. Aranda", "link": "https://stackoverflow.com/users/3310346/pedro-a-aranda"}, "edited": false, "score": 0, "creation_date": 1532372504, "post_id": 40549614, "comment_id": 89940236, "body": "@PedroA.Aranda @manoj-saha Two years later I have finally found the mistake. I should&#39;ve been using <code>syscall.IPPROTO_IP</code> instead of <code>syscall.SOL_SOCKET</code> all this time. See my last edit. I&#39;ve checked in in Wireshark, and I&#39;m getting non-zero DSCP."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1532372368, "last_edit_date": 1532372368, "creation_date": 1478872953, "answer_id": 40549614, "question_id": 40544096, "link": "https://stackoverflow.com/questions/40544096/how-to-set-socket-option-ip-tos-for-http-client-in-go-language/40549614#40549614", "title": "How to set socket option (IP_TOS) for http client in go language?", "body": "<p>You can create your own <code>DialContext</code> for your own <code>http.RoundTripper</code> of your own <code>*http.Client</code>:</p>\n\n<pre><code>dial := func(ctx context.Context, network, addr string) (net.Conn, error) {\n    conn, err := (&amp;net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n    }).DialContext(ctx, network, addr)\n    if err != nil {\n        return nil, err\n    }\n\n    tcpConn, ok := conn.(*net.TCPConn)\n    if !ok {\n        err = errors.New(\"conn is not tcp\")\n        return nil, err\n    }\n\n    f, err := tcpConn.File()\n    if err != nil {\n        return nil, err\n    }\n\n    err = syscall.SetsockoptInt(int(f.Fd()), syscall.IPPROTO_IP, syscall.IP_TOS, 128)\n    if err != nil {\n        return nil, err\n    }\n\n    return conn, nil\n}\ntr := &amp;http.Transport{\n    Proxy:                 http.ProxyFromEnvironment,\n    DialContext:           dial,\n    MaxIdleConns:          100,\n    IdleConnTimeout:       90 * time.Second,\n    TLSHandshakeTimeout:   10 * time.Second,\n    ExpectContinueTimeout: 1 * time.Second,\n}\nc := &amp;http.Client{\n    Transport: tr,\n}\nresp, err := c.Get(\"https://google.com/\")\nif err != nil {\n    log.Fatalf(\"GET error: %v\", err)\n}\n\nlog.Printf(\"got %q\", resp.Status)\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong> If you need to set the option <em>before</em> the connection actually happens, you can try this in your <code>DialContext</code>, but this is fairly non-portable, unsafe, doesn't account for context, and will probably break sooner or later:</p>\n\n<pre><code>tcpAddr, err := net.ResolveTCPAddr(network, addr)\nif err != nil {\n    return nil, err\n}\n\nsa := &amp;syscall.SockaddrInet4{\n    Port: tcpAddr.Port,\n    Addr: [4]byte{tcpAddr.IP[0], tcpAddr.IP[1], tcpAddr.IP[2], tcpAddr.IP[3]},\n}\n\nfd, err := syscall.Socket(syscall.AF_INET, syscall.SOCK_STREAM, syscall.IPPROTO_TCP)\nif err != nil {\n    return nil, err\n}\n\nerr = syscall.SetsockoptInt(fd, syscall.IPPROTO_IP, syscall.IP_TOS, 128)\nif err != nil {\n    return nil, err\n}\n\nerr = syscall.Connect(fd, sa)\nif err != nil {\n    return nil, err\n}\n\nfile := os.NewFile(uintptr(fd), \"\")\nconn, err := net.FileConn(file)\nif err != nil {\n    return nil, err\n}\n\nreturn conn, nil\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT 2:</strong> In Go 1.11 you'll be able to do this:</p>\n\n<pre><code>dialer := &amp;net.Dialer{\n    Control: func(network, address string, c syscall.RawConn) error {\n        return c.Control(func(fd uintptr) {\n            err := syscall.SetsockoptInt(int(fd), syscall.IPPROTO_IP, syscall.IP_TOS, 128)\n            if err != nil {\n                log.Printf(\"control: %s\", err)\n                return\n            }\n        })\n    },\n}\n// ...\ntr := &amp;http.Transport{\n    Proxy:                 http.ProxyFromEnvironment,\n    DialContext:           dialer.DialContext,\n    MaxIdleConns:          100,\n    IdleConnTimeout:       90 * time.Second,\n    TLSHandshakeTimeout:   10 * time.Second,\n    ExpectContinueTimeout: 1 * time.Second,\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7144860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JwkBMtqcRTo/AAAAAAAAAAI/AAAAAAAAKiQ/TD2WidbCGv4/photo.jpg?sz=128", "display_name": "Manoj Saha", "link": "https://stackoverflow.com/users/7144860/manoj-saha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3256, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1532372368, "creation_date": 1478853613, "question_id": 40544096, "link": "https://stackoverflow.com/questions/40544096/how-to-set-socket-option-ip-tos-for-http-client-in-go-language", "title": "How to set socket option (IP_TOS) for http client in go language?", "body": "<p>I am a newbie to go language. I plan to use go language for developing an http client/Server. \nWhile browsing through the list of features supported in http client package I do not find a way to set socket option in the package \n(May be I just do not know how to use it). I am in a need to set DSCP option (IP_TOS) in the fd before calling http client connection. \n(Although I find syscall option to set socket options, I do not find a way to get fd from http package).</p>\n\n<p><strong>In http server side</strong>, able to set socket option (IP_TOS).\ncode excerpt: </p>\n\n<pre><code>       tcpListener,err := net.ListenTCP(\"tcp4\", addr)\n        if  err != nil {\n             //fmt.Println(\"error in listen\", err.error())\n             log.Fatal(\"net.ListenTCP()\", err)\n        }\n        //get lisenet socket fd\n        f, _ := tcpListener.File()\n        err = syscall.SetsockoptInt(int(f.Fd()), syscall.SOL_SOCKET, syscall.IP_TOS, 128)\n</code></pre>\n\n<p><strong>In http client side,</strong> <strong>not able to get socket fd and set socket option</strong> (IP_TOS):\n(I want to set IP_TOS before calling NewRequest)</p>\n\n<pre><code>     client := &amp;http.Client{\n                         Transport : tr,\n                         //Timeout: time.Duration(10) * time.Second,\n       }\n\n     request, err := http.NewRequest(\"POST\", url, body)\n       if err != nil {\n           panic(err)\n       }\n\n      response, err := client.Do(request)\n</code></pre>\n\n<p>Thanks !!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1480956331, "last_edit_date": 1495535413, "creation_date": 1478852047, "answer_id": 40543748, "question_id": 40543648, "link": "https://stackoverflow.com/questions/40543648/go-project-structure-to-produce-library-and-cli-with-the-same-name-in-single-rep/40543748#40543748", "title": "Go project structure to produce library and cli with the same name in single repository", "body": "<p>This isn't a convention, and you may do however you like, but it's a common practice to have a <code>cmd</code> folder in the project root, and all the executables go under that, each in is own folder.</p>\n\n<p>So a good solution in your case could be simply:</p>\n\n<pre><code>host.com/project/\n    cmd/\n        project/\n            project.go\n    filea.go\n    fileb.go\n</code></pre>\n\n<p>In <code>filea.go</code> and <code>fileb.go</code> the package declaration should be:</p>\n\n<pre><code>package project\n</code></pre>\n\n<p>In <code>cmd/project/project.go</code> package and import declaration should be:</p>\n\n<pre><code>package main\n\nimport \"host.com/project\"\n</code></pre>\n\n<p>Of course if your project is more complex, you may create further packages under the project root, and it may have multiple commands (multiple <code>main</code> packages), e.g.:</p>\n\n<pre><code>host.com/project/\n    cmd/\n        project/\n            project.go\n        prjtool/\n            prjtool.go\n    packagex/\n        x.go\n    packagey/\n        y.go\n    filea.go\n    fileb.go\n</code></pre>\n\n<p>An example following this layout is the very popular Go Delve debugger (4.5k stars currently), available at <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow noreferrer\">https://github.com/derekparker/delve</a>.</p>\n\n<p>A very complex repository example is the <code>golang.org/x/tools</code> package which is a collection of multiple, essential Go tools, available at <a href=\"https://github.com/golang/tools/\" rel=\"nofollow noreferrer\">https://github.com/golang/tools/</a>. Its <code>cmd</code> folder contains more than 20 subfolders (commands), many of the tools (<code>main</code> packages) even consist of multiple <code>.go</code> files (but each using <code>package main</code> declaration, forming a single package of the executable).</p>\n\n<p>Also check out the following related question: <a href=\"https://stackoverflow.com/questions/14867452/what-is-a-sensible-way-to-layout-a-go-project\">What is a sensible way to layout a Go project</a></p>\n"}], "owner": {"reputation": 3567, "user_id": 4019871, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7db9ac6bdc0a996dd01da64b3660f8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mas Bagol", "link": "https://stackoverflow.com/users/4019871/mas-bagol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 40543748, "answer_count": 1, "score": 4, "last_activity_date": 1480956331, "creation_date": 1478851646, "question_id": 40543648, "link": "https://stackoverflow.com/questions/40543648/go-project-structure-to-produce-library-and-cli-with-the-same-name-in-single-rep", "title": "Go project structure to produce library and cli with the same name in single repository", "body": "<p>How to setup project structure to produce library and cli with same name in\nsingle repository?</p>\n\n<p>Suppose my project name is <code>project</code>. I want to make it importable with name\n<code>project</code> and have executable binary with name <code>project</code> when installed with\n<code>go get</code>. My setup currently is like this:</p>\n\n<pre><code>host.com/project/\n    project/\n        main.go\n    core/\n        project.go\n</code></pre>\n\n<p>Then, when installed with:</p>\n\n<pre><code>go get host.com/project/project\n</code></pre>\n\n<p>it installs <code>project</code> as executable which pulls <code>core</code> as dependency. In\n<code>core/project.go</code> file, the package has this:</p>\n\n<pre><code>package project\n</code></pre>\n\n<p>The problem is it is imported with:</p>\n\n<pre><code>import (\n    \"host.com/project/core\"\n)\n</code></pre>\n\n<p>And it exports <code>project</code> as name space not <code>core</code> which violates go's convention.\nHow can I do this?</p>\n"}, {"tags": ["web-services", "go"], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 3, "last_activity_date": 1478846756, "creation_date": 1478846756, "answer_id": 40542537, "question_id": 40542005, "link": "https://stackoverflow.com/questions/40542005/what-is-the-best-practices-of-writing-web-services-using-gin-gonic/40542537#40542537", "title": "What is the best practices of writing web services using gin-gonic", "body": "<p>Gin is not an opinionated framework.This is the directory structure I follow for REST services</p>\n\n<ol>\n<li>Contracts\n\n<ul>\n<li>Contains the contracts between requester and the service</li>\n<li>request structure per resource</li>\n<li>response structure per resource</li>\n<li>error response structures</li>\n</ul></li>\n<li>Core\n\n<ul>\n<li>This directory contains code that does the actual work</li>\n<li>It will be irrespective of the fact that the request originally was http</li>\n</ul></li>\n<li>HTTPService \n\n<ul>\n<li>routes</li>\n<li>http handlers</li>\n<li>code that handles http request etc.</li>\n</ul></li>\n</ol>\n\n<p>The reasoning behind this approach is that the code base won't be much coupled to HTTP and later one may add <code>ThriftService</code> and the whole server is ready for being used as a thrift service</p>\n"}], "owner": {"reputation": 177, "user_id": 3312887, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3d0f7ac5248e2d1cf4b0e9351e578d4c?s=128&d=identicon&r=PG&f=1", "display_name": "Gurunath", "link": "https://stackoverflow.com/users/3312887/gurunath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 1, "accepted_answer_id": 40542537, "answer_count": 1, "score": -1, "last_activity_date": 1478846756, "creation_date": 1478844089, "question_id": 40542005, "link": "https://stackoverflow.com/questions/40542005/what-is-the-best-practices-of-writing-web-services-using-gin-gonic", "title": "What is the best practices of writing web services using gin-gonic", "body": "<p>In other frameworks like Ruby on Rails, they are having directory structure like where to keep model related code, where to keep view related code, where to keep controller related code and where to seed DB. Is there any directory organization in <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">gin-gonic</a>? Or Any suggestion?</p>\n"}, {"tags": ["arrays", "go", "types"], "answers": [{"comments": [{"owner": {"reputation": 595, "user_id": 621460, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/196ee442bda8b74a1982ba5fa5389670?s=128&d=identicon&r=PG", "display_name": "Carlos Vergara", "link": "https://stackoverflow.com/users/621460/carlos-vergara"}, "edited": false, "score": 0, "creation_date": 1478834032, "post_id": 40540527, "comment_id": 68320366, "body": "Works for me! Apparently I have to wait a bit to accept your answer though. Thanks!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1478834070, "last_edit_date": 1478834070, "creation_date": 1478833750, "answer_id": 40540527, "question_id": 40540490, "link": "https://stackoverflow.com/questions/40540490/types-of-specific-positions-in-array-of-arrays/40540527#40540527", "title": "Types of specific positions in array of arrays?", "body": "<p>Try this:</p>\n\n<pre><code> type ConfigItem struct {\n    Name string\n    Value interface{}\n    SomethingElse bool\n }\n\nmapOfResults = ThingDoer([]ConfigItem{\n  {\"One\",    -1,    true},\n  {\"Flying\", \"\",    true},\n  {\"Banana\", false, true},\n})\n</code></pre>\n\n<p>The ThingDoer can use a <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">type switch</a> to determine the value types:</p>\n\n<pre><code>func ThingDoer(config []ConfigItem) map[foo]bar {\n    for _, item := range config {\n      switch v := item.Value.(type) {\n      case int:\n        // v is int\n      case bool:\n        // v is bool\n      case string:\n        // v is string\n      }\n    }\n }\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/1Cbr0X-PlI\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 595, "user_id": 621460, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/196ee442bda8b74a1982ba5fa5389670?s=128&d=identicon&r=PG", "display_name": "Carlos Vergara", "link": "https://stackoverflow.com/users/621460/carlos-vergara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 40540527, "answer_count": 1, "score": -1, "last_activity_date": 1478834070, "creation_date": 1478833386, "last_edit_date": 1478833956, "question_id": 40540490, "link": "https://stackoverflow.com/questions/40540490/types-of-specific-positions-in-array-of-arrays", "title": "Types of specific positions in array of arrays?", "body": "<p>I'm very much a newb in Go and I'm trying to build a function with this general aspect: </p>\n\n<pre><code>mapOfResults = ThingDoer([\n  [\"One\",    int,    -1,    true],\n  [\"Flying\", string, \"\",    true],\n  [\"Banana\", bool,   false, true]\n])\n</code></pre>\n\n<p>But I cannot even figure its signature (is signature even the proper term for it in Go? the definition of all its params etc). </p>\n\n<p>I'm talking about this construct:</p>\n\n<pre><code>func ThingDoer(config ThisIsWhatICannotFigure) map[string]Results {\n    // the body of my function\n}\n</code></pre>\n\n<p>How do I define the types for such a parameter?</p>\n"}, {"tags": ["go", "push-notification", "google-api", "gmail-api", "watch"], "comments": [{"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "edited": false, "score": 1, "creation_date": 1478862736, "post_id": 40537015, "comment_id": 68331844, "body": "If anyone is wondering the solution turned out to be in the end user domain account. The gmail permission was missing from there. Please comment if you would like to see a working version of this, and I&#39;ll make a gist of it"}], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1478812047, "creation_date": 1478812047, "question_id": 40537015, "link": "https://stackoverflow.com/questions/40537015/google-service-account-permission-denied-gmail-pub-sub-golang", "title": "Google Service Account permission denied gmail pub/sub Golang", "body": "<p>Trying to create an application that updates links in my domains emails. I have got the service account element working, and can retrieve all the email accounts in my domain on Google Apps.</p>\n\n<p>So with</p>\n\n<pre><code>  config, err := google.JWTConfigFromJSON(data, \n    \"https://www.googleapis.com/auth/admin.directory.user\",\n    \"https://www.googleapis.com/auth/gmail.readonly\")\n</code></pre>\n\n<p>I create a new admin object, and <code>srv.Users.List()</code> giving me the users.</p>\n\n<p>I now want to start a <code>watch</code> on each account so that Gmail can push emails to my app.</p>\n\n<p>To do this, I need an access token and the impersonate the email address of the account I want to start the watch on.</p>\n\n<pre><code>   ctx := context.Background()\n    tokenSource := config.TokenSource(ctx)\n    token, err := tokenSource.Token()\n</code></pre>\n\n<p>where config comes from <code>JWTConfigFromJSON</code> earlier.</p>\n\n<p>It attemps to make the <code>watch</code> request, but I get the error <code>googleapi: Error 403: Insufficient Permission, insufficientPermissions</code></p>\n\n<p>First issue: I'm not sure I can get the token like this, do I have to have a seperate oAuth config and then use that to get the token? (That would surely require user interaction).</p>\n\n<p>Second issue: I suspect I have not set the correct permissions, in either the code, or in the Service Account, but I'm not sure what they should be</p>\n\n<p>Last issue: in the <code>JWTConfigFromJSON</code> call, When I remove the gmail scope, it it successfully gets a token. When I put it back I get <code>\"Unauthorized client or scope in request.\"</code></p>\n\n<p>Any help greatly appreciated!\nThanks</p>\n"}, {"tags": ["go", "containers", "heap"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1478808672, "post_id": 40536082, "comment_id": 68311845, "body": "It&#39;s up to you. You can either return nil, or panic. (I would say it&#39;s more proper to let it panic, rather than let the user get a nil return value)"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1478808685, "post_id": 40536082, "comment_id": 68311851, "body": "go deeper and check the methods h.Swap() and down(), they check the limits"}, {"owner": {"reputation": 29, "user_id": 3676852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574ca633d3c094ed07774848a8a17d67?s=128&d=identicon&r=PG&f=1", "display_name": "Eduard Semsch", "link": "https://stackoverflow.com/users/3676852/eduard-semsch"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1478809557, "post_id": 40536082, "comment_id": 68312299, "body": "@YandryPozo - <code>if j1 &gt;= n || j1 &lt; 0 { &#47;&#47; j1 &lt; 0 after int overflow</code>  I think this is a bit different.  And <code>h.Swap()</code> is implemented by the underlying <code>sort.Interface</code>."}, {"owner": {"reputation": 29, "user_id": 3676852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574ca633d3c094ed07774848a8a17d67?s=128&d=identicon&r=PG&f=1", "display_name": "Eduard Semsch", "link": "https://stackoverflow.com/users/3676852/eduard-semsch"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1478809748, "post_id": 40536082, "comment_id": 68312407, "body": "@JimB - thanks.  Out of curiosity, how do you know this?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1478811194, "post_id": 40536082, "comment_id": 68313112, "body": "@EduardSemsch; know what? Those are the only 2 possibilities for that method signature. As for panicking, popping off an empty heap is akin to indexing a slice out of bounds (which is probably what will happen underneath), which is a programming error."}], "answers": [{"tags": [], "owner": {"reputation": 17785, "user_id": 952648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c85487802cc06d71bf6b7d739685f4bd?s=128&d=identicon&r=PG", "display_name": "tom", "link": "https://stackoverflow.com/users/952648/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1478823945, "creation_date": 1478823945, "answer_id": 40539348, "question_id": 40536082, "link": "https://stackoverflow.com/questions/40536082/container-heap-pop-on-empty-heap/40539348#40539348", "title": "Container/heap Pop() on empty heap", "body": "<p>The natural behaviour is to panic. This is what the <a href=\"https://golang.org/pkg/container/heap/#example__intHeap\" rel=\"nofollow noreferrer\">IntHeap example</a> does.</p>\n\n<p>As pointed out in the comments, control will not reach <code>h.Pop()</code> if <code>h.Swap()</code> panics. However, <code>h.Pop()</code> can still be called on an empty heap if <code>heap.Remove()</code> is given -1 as the index:</p>\n\n<pre><code>// Remove removes the element at index i from the heap.\n// The complexity is O(log(n)) where n = h.Len().\n//\nfunc Remove(h Interface, i int) interface{} {\n    n := h.Len() - 1\n    if n != i {\n        h.Swap(i, n)\n        down(h, i, n)\n        up(h, i)\n    }\n    return h.Pop()\n}\n</code></pre>\n\n<p>If <code>h.Swap()</code> panics on negative indices, <code>h.Pop()</code> should also panic for consistency.</p>\n\n<p>Having <code>h.Swap()</code> silently ignore negative indices and <code>h.Pop()</code> return a default value like <code>nil</code> is consistent, but other programmers would find that surprising so I don't recommend it.</p>\n"}], "owner": {"reputation": 29, "user_id": 3676852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574ca633d3c094ed07774848a8a17d67?s=128&d=identicon&r=PG&f=1", "display_name": "Eduard Semsch", "link": "https://stackoverflow.com/users/3676852/eduard-semsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 40539348, "answer_count": 1, "score": 1, "last_activity_date": 1488114124, "creation_date": 1478808173, "last_edit_date": 1488114124, "question_id": 40536082, "link": "https://stackoverflow.com/questions/40536082/container-heap-pop-on-empty-heap", "title": "Container/heap Pop() on empty heap", "body": "<p>I have used the <code>container/heap</code> package to implement a priority queue.  One thing bothers me though.  What should the behaviour of the <code>interface.Pop()</code> method be if the heap is empty?  I don't see anything mentioned in the documentation and the source code doesn't seem to be expecting this situation:</p>\n\n<pre><code>// Pop removes the minimum element (according to Less) from the heap\n// and returns it. The complexity is O(log(n)) where n = h.Len().\n// It is equivalent to Remove(h, 0).\n//\nfunc Pop(h Interface) interface{} {\n        n := h.Len() - 1\n        h.Swap(0, n)\n        down(h, 0, n)\n        return h.Pop()\n}\n</code></pre>\n\n<p>Clearly, if <code>h.Len()</code> is <code>0</code> this is not going to work well.  Is this simply meant to <code>panic</code> or is the user expected to always check whether there are any items left?</p>\n"}, {"tags": ["go", "zip", "pipe", "streamreader", "writer"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1478808571, "post_id": 40536018, "comment_id": 68311796, "body": "You need to read the entire file. <code>zip.NewReader</code> takes an <code>io.ReaderAt</code>, which you can&#39;t do with a Pipe."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1478810752, "post_id": 40536018, "comment_id": 68312896, "body": "could not use io.Copy(zipReader, w) ? <a href=\"https://golang.org/pkg/io/#Copy\" rel=\"nofollow noreferrer\">golang.org/pkg/io/#Copy</a>"}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1478818087, "post_id": 40536018, "comment_id": 68316130, "body": "@mh-cbon I am not 100% sure but doesn&#39;t io.Copy use a buffer underneath ? I wanted to avoid that ."}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1478818269, "post_id": 40536018, "comment_id": 68316194, "body": "@JimB Isn&#39;t there a way to avoid reading the whole zip file somehow ? I am sure when zip file sizes are huge, no one wants to bring all the data into the memory. How about reading the bytes in chunks ? Curious, if it was a regular directory , can I use the Pipe ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1478818872, "post_id": 40536018, "comment_id": 68316428, "body": "@psbits: that&#39;s how the zip format works. The central directory is located at the end of the file, so you can&#39;t (easily, or correctly) extract the files without first seeking to the end of the file and reading the directory."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1478819015, "post_id": 40536018, "comment_id": 68316483, "body": "yes, <a href=\"https://golang.org/src/io/io.go#L387\" rel=\"nofollow noreferrer\">there is a buffer for the operations</a>. Anyway i double checked, and yes zipReader itself is not a Reader, so even io.copy won t work. You have to go through each files to get a reader."}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "edited": false, "score": 0, "creation_date": 1478819175, "post_id": 40536018, "comment_id": 68316555, "body": "@mh-cbonYup, I was trying that...looping over each file in the zip and reading it&#39;s bytes: zf, err := zip.OpenReader(&quot;test.zip&quot;) for _, file := range zf.File { \t\t\t\t\tfc, err := file.Open() \t\t\t\t\t// read bytes and pipe it ?? } jimB mentioned we cannot use Pipe here to read the bytes and pass it to the writer ?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1478908656, "post_id": 40557039, "comment_id": 68353920, "body": "The goroutine and pipe are pointless here. You&#39;re still reading the file synchronously, just adding another copy for no reason."}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479332047, "post_id": 40557039, "comment_id": 68517539, "body": "@JimB Could you explain how is the grouting/pipe pointless here ? The go routine is making the pipe writer write to the pipe in chunks and without blocking the pipe reader read from the other end. I do agree it&#39;s a sort of copy but then that wouldn&#39;t that copy all the data at once ? May be I could use copyN."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479332727, "post_id": 40557039, "comment_id": 68517853, "body": "Any read/copy has to happen in chunks, so I&#39;m not sure what you mean by &quot;all at once&quot;. What you have here is a less-efficient version of <code>io.Copy</code>, but there&#39;s no need to copy at all since <code>ioutil.ReadAll</code> is going to read the entire file into memory anyway, so just use that directly."}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479345000, "post_id": 40557039, "comment_id": 68522131, "body": "That makes sense. What I was trying to achieve using the io.Pipe() was to write chunks of data to the pipe and read it from the other end , so I don&#39;t have to bring all the data into memory together. Is there a way I can achieve that @jimB ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479398766, "post_id": 40557039, "comment_id": 68550517, "body": "The pipe is irrelevant. You use a pipe to synchronously connect something that takes a <code>io.Reader</code> to something that takes an <code>io.Writer</code>. That is all. Reading the entire file into memory at once or not is strictly up to you -- i.e. if you don&#39;t want to read it all don&#39;t use <code>ReadAll</code>. You seem to have an XY problem here, and you need to show what you&#39;re trying to accomplish, rather than what you <i>think</i> you need to do."}], "tags": [], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "is_accepted": true, "score": 0, "last_activity_date": 1478902359, "creation_date": 1478902359, "answer_id": 40557039, "question_id": 40536018, "link": "https://stackoverflow.com/questions/40536018/download-a-zip-file-using-io-pipe-read-write-golang/40557039#40557039", "title": "Download a zip file using io.Pipe() read/write golang", "body": "<p>I made it work using golang io.Pipe().The Pipewriter writes byte to the pipe in chunks and the pipeReader reader from the other end. The reason for using a go-routine is to have a non-blocking write operation while simultaneous reads happen form the pipe.</p>\n\n<p>Note: It's important to close the pipe writer (w.Close()) to send EOF on the stream otherwise it will not close the stream. </p>\n\n<pre><code>func DownloadZip() ([]byte, error) {\n    r, w := io.Pipe()\n\n    defer r.Close()\n    defer w.Close()\n\n    zip, err := os.Stat(\"temp.zip\")\n    if err != nil{\n        return nil, err\n    }\n\n    go func(){\n\n        f, err := os.Open(zip.Name())\n        if err != nil {\n            return\n\n        }\n\n        buf := make([]byte, 1024)\n        for {\n            chunk, err := f.Read(buf)\n            if err != nil &amp;&amp; err != io.EOF {\n                panic(err)\n            }\n            if chunk == 0 {\n                break\n            }\n\n            if _, err := w.Write(buf[:chunk]); err != nil{\n                return\n            }\n\n        }\n\n        w.Close()\n    }()\n\n    body, err := ioutil.ReadAll(r)\n    if err != nil {\n        return nil, err\n    }\n    return body, nil\n\n}\n</code></pre>\n\n<p>Please let me know if someone has another way of doing it.</p>\n"}], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3677, "favorite_count": 0, "accepted_answer_id": 40557039, "answer_count": 1, "score": 1, "last_activity_date": 1478902359, "creation_date": 1478807956, "question_id": 40536018, "link": "https://stackoverflow.com/questions/40536018/download-a-zip-file-using-io-pipe-read-write-golang", "title": "Download a zip file using io.Pipe() read/write golang", "body": "<p>I am trying to stream out bytes of a zip file using io.Pipe() function in golang. I am using pipe reader to read the bytes of each file in the zip and then stream those out and use the pipe writer to write the bytes in the response object.</p>\n\n<pre><code>func main() {\n  r, w := io.Pipe()\n // go routine to make the write/read non-blocking\n  go func() {\n\n    defer w.Close()\n\n    bytes, err := ReadBytesforEachFileFromTheZip() \n    err := json.NewEncoder(w).Encode(bytes)\n    handleErr(err)\n  }()\n</code></pre>\n\n<p>This is not a working implementation but a structure of what I am trying to achieve. I don't want to use ioutil.ReadAll since the file is going to be very large and Pipe() will help me avoid bringing all the data into memory. Can someone help with a working implementation using io.Pipe() ?</p>\n"}, {"tags": ["go", "rabbitmq"], "answers": [{"tags": [], "owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "is_accepted": true, "score": 1, "last_activity_date": 1478856553, "creation_date": 1478856553, "answer_id": 40544869, "question_id": 40534860, "link": "https://stackoverflow.com/questions/40534860/cant-return-amqp-channel-from-a-function-when-using-the-go-rabbitmq-streadway/40544869#40544869", "title": "Can&#39;t return *amqp.Channel from a function when using the Go RabbitMQ streadway/amqp driver", "body": "<p>You have a typo in your error checking after <code>amqp.DialConfig</code> !</p>\n\n<p>Change the <code>err == nil</code> to <code>err != nil</code></p>\n\n<pre><code>conn, err := amqp.DialConfig(url, rabbitConfig)\nif err != nil { // you typed it as err == nil\n    return nil, nil, err\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 2643032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e57f61abb204bfa2df90e0e71a30f9?s=128&d=identicon&r=PG", "display_name": "Ismael Arenzana", "link": "https://stackoverflow.com/users/2643032/ismael-arenzana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 40544869, "answer_count": 1, "score": 0, "last_activity_date": 1478860840, "creation_date": 1478803478, "last_edit_date": 1478860840, "question_id": 40534860, "link": "https://stackoverflow.com/questions/40534860/cant-return-amqp-channel-from-a-function-when-using-the-go-rabbitmq-streadway", "title": "Can&#39;t return *amqp.Channel from a function when using the Go RabbitMQ streadway/amqp driver", "body": "<p>I'm trying to connect to a RabbitMQ bus using the <a href=\"https://github.com/streadway/amqp\" rel=\"nofollow noreferrer\">streadway/amqp</a> driver for Go. I'm working on a reconnection routine and, for it, I have a <code>rabbitMQConsume</code> function call a <code>rabbitMQConnect</code> function.</p>\n\n<pre><code>func rabbitMQConnect(cfg objects.GlobalConfig) (*amqp.Connection, *amqp.Channel, error) {\n    rabbitConfig := amqp.Config{\n        Vhost:     cfg.RabbitVHost,\n        Heartbeat: 5,\n    }\n\n    //Open connection to Rabbit\n    url := fmt.Sprintf(\"amqp://\" + cfg.RabbitUser + \":\" + cfg.RabbitPassword + \"@\" + cfg.RabbitHost + \":\" + cfg.RabbitPort + cfg.RabbitVHost)\n\n    conn, err := amqp.DialConfig(url, rabbitConfig)\n    if err == nil {\n        return nil, nil, err\n    }\n\n    ch, err := conn.Channel()\n    if err != nil {\n        return nil, nil, err\n    }\n    // Create Exchange if it doesn't exist\n    err = ch.ExchangeDeclare(\n        \"ali\",    // name\n        \"direct\", // type\n        true,     // durable\n        false,    // auto-deleted\n        false,    // internal\n        false,    // no-wait\n        nil,      // arguments\n    )\n    if err != nil {\n        return nil, nil, err\n    }\n\n    //Declare queue\n    _, err = ch.QueueDeclare(\n        cfg.RabbitQueue, // name\n        true,            // durable\n        false,           // delete when usused\n        false,           // exclusive\n        false,           // no-wait\n        nil,             // arguments\n    )\n    if err != nil {\n        return nil, nil, err\n    }\n\n    //Bind queue\n    err = ch.QueueBind(\n        cfg.RabbitQueue,    // queue name\n        cfg.RabbitKey,      // routing key\n        cfg.RabbitExchange, // exchange\n        false,\n        nil,\n    )\n    if err != nil {\n        return nil, nil, err\n    }\n    return conn, ch, nil\n}\n\n//RabbitMQConsume setup the channel/exchange data\nfunc rabbitMQConsume(cfg objects.GlobalConfig) (*amqp.Connection, &lt;-chan amqp.Delivery, error) {\n    conn, ch, err := rabbitMQConnect(cfg)\n    if err != nil {\n        return nil, nil, err\n    }\n\n    consumerID, err := helper.GetConsumerID()\n    if err != nil {\n        return nil, nil, err\n    }\n\n    //Start receiving data in the msgs channel\n    msgs, err := ch.Consume(\n        cfg.RabbitQueue, // queue\n        consumerID,      // consumer\n        false,           // auto-ack\n        false,           // exclusive\n        false,           // no-local\n        false,           // no-wait\n        nil,             // args\n    )\n    if err != nil {\n        return nil, nil, err\n    }\n\n    return conn, msgs, nil\n}\n</code></pre>\n\n<p>The problem I'm having is that the value of <code>ch</code> and <code>conn</code> when they're returned to <code>rabbitMQConsume</code> from <code>rabbitMQconnect</code>, are <code>nil</code> and the program panics when I run the <code>ch.Consume</code> line. \nI'm losely basing this on <a href=\"https://github.com/streadway/amqp/blob/master/reconnect_test.go\" rel=\"nofollow noreferrer\">this example</a>\nAny ideas? Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1478801013, "post_id": 40534196, "comment_id": 68308177, "body": "but you should not have <code>vendor&#47;</code> within <code>vendor&#47;</code> folders."}], "answers": [{"tags": [], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "is_accepted": false, "score": 0, "last_activity_date": 1478806711, "last_edit_date": 1478806711, "creation_date": 1478800887, "answer_id": 40534197, "question_id": 40534196, "link": "https://stackoverflow.com/questions/40534196/how-should-a-glide-project-import-another-project-with-a-vendor-directory/40534197#40534197", "title": "How should a glide project import another project with a vendor/ directory?", "body": "<p>My current solution has been to manually delete vendor/ directories from libraries which are brought in that keep vendor/. </p>\n\n<p>... (Update) glide supports a --strip-vendor option.</p>\n"}, {"tags": [], "owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "is_accepted": false, "score": 2, "last_activity_date": 1478801795, "creation_date": 1478801795, "answer_id": 40534418, "question_id": 40534196, "link": "https://stackoverflow.com/questions/40534196/how-should-a-glide-project-import-another-project-with-a-vendor-directory/40534418#40534418", "title": "How should a glide project import another project with a vendor/ directory?", "body": "<p>I think this is quite a common issue for people using glide. My team ran into the same issue and had to investigate for a while but eventually found that using the flatten operation solved this for us.</p>\n\n<p>To do this pass the <code>-v</code> flag to your glide operations.</p>\n\n<p>e.g. <code>glide up -v</code></p>\n\n<p>You can read more about it on the <a href=\"https://glide.readthedocs.io/en/latest/getting-started/#updating-dependencies\" rel=\"nofollow noreferrer\">glide docs</a>.</p>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1478806711, "creation_date": 1478800887, "question_id": 40534196, "link": "https://stackoverflow.com/questions/40534196/how-should-a-glide-project-import-another-project-with-a-vendor-directory", "title": "How should a glide project import another project with a vendor/ directory?", "body": "<p>The golang Glide packager automatically will install dependencies for a project, however, in doing so it pulls in dependencies from the vendor/, since many projects check in vendor dependencies.</p>\n\n<p>How should one import a glide dependency which includes a vendor/ directory? </p>\n\n<p>As of now, it appears that you can get errors such as : </p>\n\n<p><code>./scheduler.go:36: cannot use \"github.com/jayunit100/my-project/vendor/github.com/spf13/pflag\".CommandLine (type *\"github.com/jayunit100/my-project/vendor/a/b/spf13/pflag\".FlagSet)</code> \nas type \n<code>*\"github.com/jayunit100/my-project/vendor/a/b/vendor/github.com/spf13/pflag\".FlagSet</code></p>\n\n<ul>\n<li>import as normal, and then manually delete <code>vendor/</code> so there are no redundancies.</li>\n<li>import as normal, and use some kind of configuration trick to avoid the <code>vendor/</code> dependency duplication?</li>\n</ul>\n"}, {"tags": ["go", "read-eval-print-loop"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1479297058, "post_id": 40533859, "comment_id": 68495329, "body": "About <code>src&#47;github.com&#47;dshearer&#47;jobber&#47;common&#47;sudo.go:15: undefined: sudo_cmd</code> What is your current system os ? see file suffixes at <a href=\"https://dave.cheney.net/2013/10/12/how-to-use-conditional-compilation-with-the-go-build-tool\" rel=\"nofollow noreferrer\">dave.cheney.net/2013/10/12/&hellip;</a>, maybe this explains that."}], "answers": [{"comments": [{"owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "edited": false, "score": 0, "creation_date": 1478913068, "post_id": 40535015, "comment_id": 68354738, "body": "I got same error <code>import: can&#39;t find import:</code> when I input <code>:import github.com&#47;dshearer&#47;jobber&#47;jobfile</code> in <code>gore</code>. Am I doing wrong?"}, {"owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "edited": false, "score": 0, "creation_date": 1478939996, "post_id": 40535015, "comment_id": 68359351, "body": "I tried to add the package to my go workspace, but it failed. I wrote the process of it in my question. Sorry, this must be a basic knowledge of <code>go</code>, but I really couldn&#39;t find out how to do it."}], "tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": false, "score": 1, "last_activity_date": 1478804142, "creation_date": 1478804142, "answer_id": 40535015, "question_id": 40533859, "link": "https://stackoverflow.com/questions/40533859/how-to-load-local-go-file-by-using-gore/40535015#40535015", "title": "How to load local go file by using gore", "body": "<p>You need to import the package itself, which <a href=\"https://golang.org/doc/code.html#Overview\" rel=\"nofollow noreferrer\">that file is a part of</a>. You can't import files separately in go.</p>\n\n<pre><code>:import github.com/dshearer/jobber/jobfile\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "is_accepted": false, "score": 1, "last_activity_date": 1479298370, "last_edit_date": 1479298370, "creation_date": 1479298066, "answer_id": 40631812, "question_id": 40533859, "link": "https://stackoverflow.com/questions/40533859/how-to-load-local-go-file-by-using-gore/40631812#40631812", "title": "How to load local go file by using gore", "body": "<p>Your last output seems to show you're doing it right, but the source code you're using is not in proper state:</p>\n\n<pre><code>go install github.com/dshearer/jobber/common\n# github.com/dshearer/jobber/common\nsrc/github.com/dshearer/jobber/common/sudo.go:15: undefined: sudo_cmd\n</code></pre>\n\n<p>Looking at the sources for jobber, it appears it has a <a href=\"https://github.com/dshearer/jobber/blob/master/Makefile\" rel=\"nofollow noreferrer\">Makefile</a>, which is supposed to add the missing function for your architecture.</p>\n\n<p>This project actually has specific install instructions, you can <a href=\"http://dshearer.github.io/jobber/doc/v1.1/\" rel=\"nofollow noreferrer\">find them here</a>.</p>\n\n<pre><code>cd /path/to/your/workspace\ngo get github.com/dshearer/jobber\ncd src/github.com/dshearer/jobber\ngit checkout v1.1\nmake GO_WKSPC=/path/to/your/workspace\n</code></pre>\n\n<p>PS: note that the canonical way to install dependency in your <code>$GOPATH</code> is to use <code>go get</code>:</p>\n\n<pre><code>go get host.com/namespace/package\n</code></pre>\n\n<p>This is not enough here, though, as package author decided to have an adhoc build mechanism.</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 700973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJ8fe.jpg?s=128&g=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/700973/marius"}, "is_accepted": false, "score": 1, "last_activity_date": 1534143119, "last_edit_date": 1534143119, "creation_date": 1479854396, "answer_id": 40752977, "question_id": 40533859, "link": "https://stackoverflow.com/questions/40533859/how-to-load-local-go-file-by-using-gore/40752977#40752977", "title": "How to load local go file by using gore", "body": "<p>So there two problems:</p>\n\n<p>1) You can import packages, but not specific files (package might contain multiple files)</p>\n\n<p>2) The source code and error about sudo_cmd - sudo_cmd is available only on Linux and FreeBSD platforms. See:</p>\n\n<pre><code>nkts@zulu ~ $ ls -l go/src/github.com/dshearer/jobber/common/sudo_cmd_*\n-rw-rw-r--. 1 nkts nkts 214 Nov 22 22:28 go/src/github.com/dshearer/jobber/common/sudo_cmd_freebsd.go\n-rw-rw-r--. 1 nkts nkts 229 Nov 22 22:28 go/src/github.com/dshearer/jobber/common/sudo_cmd_linux.go\n</code></pre>\n\n<p>So it should not work on Windows or MacOSX.</p>\n\n<p>But clearly works on Linux (with auto complete):</p>\n\n<pre><code>nkts@zulu ~ $ go get -u github.com/motemen/gore\nnkts@zulu ~ $ go get -v github.com/dshearer/jobber/jobfile\ngithub.com/dshearer/jobber (download)\ngithub.com/dshearer/jobber/Godeps/_workspace/src/gopkg.in/yaml.v2\ngithub.com/dshearer/jobber/common\ngithub.com/dshearer/jobber/jobfile\nnkts@zulu ~ $ gore\ngore version 0.2.6  :help for help\ngore&gt; :import github.com/dshearer/jobber/jobfile\ngore&gt; jobfile.ErrorHandlerStopNam^C\n</code></pre>\n"}], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1534143119, "creation_date": 1478799646, "last_edit_date": 1478939756, "question_id": 40533859, "link": "https://stackoverflow.com/questions/40533859/how-to-load-local-go-file-by-using-gore", "title": "How to load local go file by using gore", "body": "<p>I installed <code>gore</code> to use REPL.</p>\n\n<p>And I want to check behavior of a <code>ParseFullTimeSpec</code> function in this file.</p>\n\n<p><a href=\"https://github.com/dshearer/jobber/blob/master/jobfile/time_spec.go#L79\" rel=\"nofollow noreferrer\">https://github.com/dshearer/jobber/blob/master/jobfile/time_spec.go#L79</a></p>\n\n<p>I tried by <code>:import github.com/dshearer/jobber/jobfile/time_spec.go</code>, but it returned a error <code>error: import: can't find import:</code></p>\n\n<p>I also tried relative path after <code>git clone</code>, but I couldn't import it anyway.</p>\n\n<p>What is a right way to load the go file from <code>gore</code>?</p>\n\n<h3>Installing the package to workplace</h3>\n\n<p>To install the package to my workplace I did like this:</p>\n\n<pre><code>mkdir $GOPATH/src/github.com/dshearer\ncd $GOPATH/src/github.com/dshearer\ngit clone git@github.com:dshearer/jobber.git\ngo install github.com/dshearer/jobber/jobfile\n</code></pre>\n\n<p>It returns a error:</p>\n\n<pre><code># github.com/dshearer/jobber/common\nsrc/github.com/dshearer/jobber/common/sudo.go:15: undefined: sudo_cmd\n</code></pre>\n\n<p>And I couldn't install <code>common</code> package with a error <code>undefined: sudo_cmd</code>.</p>\n\n<pre><code>go install github.com/dshearer/jobber/common\n# github.com/dshearer/jobber/common\nsrc/github.com/dshearer/jobber/common/sudo.go:15: undefined: sudo_cmd\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1509793930, "post_id": 40531874, "comment_id": 81170279, "body": "Note: <a href=\"https://github.com/golang/go/issues/19090\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/19090</a> (for <code>go vet</code> specifically) follows that issues and reference other issues."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1509794582, "post_id": 40531874, "comment_id": 81170437, "body": "With go 1.10 (Q1 2018), go vet won&#39;f fail with <code>uses unkeyed fields</code> errors when depending on vendor packages. See <a href=\"https://stackoverflow.com/a/47110039/6309\">my answer below</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1478794284, "creation_date": 1478794284, "answer_id": 40532137, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor/40532137#40532137", "title": "How to make go linters ignore vendor/?", "body": "<p>You can put all your source code into a subdirectory (e.g. <code>internal</code> or <code>lib</code>). Alternatively, you can do this:</p>\n\n<pre><code>go vet ./... | grep -v vendor/ &amp;&amp; exit 1 || exit 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "is_accepted": false, "score": 4, "last_activity_date": 1479345597, "last_edit_date": 1479345597, "creation_date": 1478795317, "answer_id": 40532504, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor/40532504#40532504", "title": "How to make go linters ignore vendor/?", "body": "<p>Usually <code>go list</code> is more helpful than <code>find</code> here:</p>\n\n<pre><code>$ go list ./... \narp242.net/trackwall\narp242.net/trackwall/cmdline\narp242.net/trackwall/vendor/arp242.net/sconfig\narp242.net/trackwall/vendor/bitbucket.org/pkg/inflect\n[..trim..]\n</code></pre>\n\n<p>As you see, this will list all the package names in the current directory. To filter the <code>vendor</code> directory we can use <code>grep</code>:</p>\n\n<pre><code>$ go list ./... | grep -v /vendor/\narp242.net/trackwall\narp242.net/trackwall/cmdline\n</code></pre>\n\n<p>If you want to run several linters, report all errors, and return <code>0</code> only if there is a success, you could use a loop and a status variable:</p>\n\n<pre><code>#!/bin/sh\n\nst=0\nfor pkg in $(go list ./... | grep -v /vendor/); do\n    echo \"==&gt; $pkg\"\n\n    go vet \"$pkg\"\n    [ $? -ne 0 ] &amp;&amp; st=1\n\n    golint \"$pkg\"\n    [ $? -ne 0 ] &amp;&amp; st=1\n\n    # gofmt works on files, not packages\n    gofmt -d \"${f#arp242.net/trackwall}\"*.go\n    [ $? -ne 0 ] &amp;&amp; st=1\ndone\nexit $st\n</code></pre>\n\n<p>Which will output something like:</p>\n\n<pre><code>==&gt; arp242.net/trackwall\nhttp.go:71: database/sql.NullString composite literal uses unkeyed fields\nexit status 1\n/home/martin/gocode/src/arp242.net/trackwall/http.go:70:2: don't use ALL_CAPS in Go names; use CamelCase\n/home/martin/gocode/src/arp242.net/trackwall/http.go:75:9: if block ends with a return statement, so drop this else and outdent its block\n==&gt; arp242.net/trackwall/cmdline\nExit 1\n</code></pre>\n\n<hr>\n\n<p>Of course, you're not the first one with this problem, and there are tools which basically do the same as above, except better. <a href=\"https://github.com/alecthomas/gometalinter\" rel=\"nofollow noreferrer\">gometalinter</a> is probably the best known and I recommend you use this. It helpfully includes a <code>--vendor</code> switch to ignore the vendor directory:</p>\n\n<pre><code>$ go get -u github.com/alecthomas/gometalinter\n\n$ gometalinter --vendor ./...\nhelpers.go:25:1:warning: realpath is unused (deadcode)\nhttp.go:32:1:warning: _list is unused (deadcode)\n[..trim..]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 1, "creation_date": 1478805589, "post_id": 40532801, "comment_id": 68310423, "body": "I&#39;m not sure what philae is, and have failed to find out on my own, you should probably link to whatever that is"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 1, "creation_date": 1478808842, "post_id": 40532801, "comment_id": 68311917, "body": "those stuff here <a href=\"https://github.com/mh-cbon/philea\" rel=\"nofollow noreferrer\">github.com/mh-cbon/philea</a> and here <a href=\"https://github.com/mh-cbon/go-fmt-fail\" rel=\"nofollow noreferrer\">github.com/mh-cbon/go-fmt-fail</a> and also this <a href=\"https://github.com/mh-cbon/666\" rel=\"nofollow noreferrer\">github.com/mh-cbon/666</a>"}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1478796131, "creation_date": 1478796131, "answer_id": 40532801, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor/40532801#40532801", "title": "How to make go linters ignore vendor/?", "body": "<p>In a cross platform fashion i do this <code>philea -s \"666 go vet %s\" \"666 go-fmt-fail %s\"</code></p>\n\n<p>yields,</p>\n\n<pre><code>$ ls -alh | grep ven\ndrwxr-xr-x  5 mh-cbon mh-cbon 4,0K 14 juin  20:43 vendor\n$ philea -s \"666 go vet %s\" \"666 go-fmt-fail %s\"\ngo-fmt-fail ./local/local.go\n \u2714 Success\ngo-fmt-fail ./dl/index.go\n \u2714 Success\ngo vet ./local/local.go\n \u2714 Success\ngo-fmt-fail ./gh/gh.go\n \u2714 Success\ngo vet ./main.go\n \u2714 Success\ngo vet ./gh/gh.go\n \u2714 Success\ngo vet ./dl/index.go\n \u2714 Success\ngo-fmt-fail ./main.go\n \u2714 Success\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "is_accepted": false, "score": 9, "last_activity_date": 1478812610, "creation_date": 1478812610, "answer_id": 40537141, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor/40537141#40537141", "title": "How to make go linters ignore vendor/?", "body": "<p>I usually do   </p>\n\n<pre><code>go fmt $(go list ./... | grep -v /vendor/)\ngo test $(go list ./... | grep -v /vendor/)\n</code></pre>\n\n<p>But since I started using <code>govendor</code> discovered I can do the same using govendor with less typing</p>\n\n<pre><code>govendor fmt +l // +l is shorthand for local\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "is_accepted": false, "score": 2, "last_activity_date": 1480358204, "creation_date": 1480358204, "answer_id": 40851203, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor/40851203#40851203", "title": "How to make go linters ignore vendor/?", "body": "<p>Thanks for all the helpful suggestions! This works for my purposes:</p>\n\n<p><a href=\"https://github.com/mcandre/go-ios7crypt/blob/ea8dd957e8f146ea20a57122870008a968875b53/Makefile\" rel=\"nofollow noreferrer\">https://github.com/mcandre/go-ios7crypt/blob/ea8dd957e8f146ea20a57122870008a968875b53/Makefile</a></p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1509794512, "last_edit_date": 1509794512, "creation_date": 1509793643, "answer_id": 47110039, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor/47110039#47110039", "title": "How to make go linters ignore vendor/?", "body": "<p>With Go 1.10 (Q1 2018), the <a href=\"https://github.com/mcandre/go-ios7crypt/blob/ea8dd957e8f146ea20a57122870008a968875b53/Makefile#L21-L22\" rel=\"nofollow noreferrer\">kind of tips</a> mentioned by the <a href=\"https://stackoverflow.com/users/350106/mcandre\">OP mcandre</a>'s <a href=\"https://stackoverflow.com/a/40851203/6309\">answer</a> will be more robust:</p>\n\n<pre><code>go list ./... | grep -v vendor | xargs go vet -v\n</code></pre>\n\n<p>As illustrated in <a href=\"https://stackoverflow.com/users/660921/carpetsmoker\">carpetsmoker</a>'s <a href=\"https://stackoverflow.com/a/40532504/6309\">answer</a>, a <code>go vet</code> on packages depending on (yet non-compiled) vendored packages will fail:</p>\n\n<pre><code>==&gt; arp242.net/trackwall\nhttp.go:71: database/sql.NullString composite literal uses unkeyed fields\n</code></pre>\n\n<p>Note anymore, since <a href=\"https://github.com/golang/go/issues/16086\" rel=\"nofollow noreferrer\">go issue 16086</a> is resolved!</p>\n\n<p>See <a href=\"https://groups.google.com/forum/#!msg/golang-dev/qfa3mHN4ZPA/X2UzjNV1BAAJ\" rel=\"nofollow noreferrer\">this thread</a>: </p>\n\n<blockquote>\n  <h2>Go vet</h2>\n  \n  <p>The \"<code>go vet</code>\" command works best with full type information for the packages it is analyzing. Historically that's been problematic in a variety of situations: packages using <code>cgo</code>, packages using vendoring, and packages that don't have up-to-date installed dependencies have all been things that kept <code>vet</code> from running with full type information. </p>\n  \n  <p>Not anymore. <strong>The \"<code>go vet</code>\" command now passes to <code>vet</code> full information about all these things</strong>, building new <code>.a</code> files if needed (CL 74355 and CL 74750).<br>\n  Now \"<code>go vet</code>\" is guaranteed to have up-to-date type information when it analyzes a package, which will improve the accuracy of its analyses.<br>\n  Having the <a href=\"https://stackoverflow.com/a/47109826/6309\"><strong>build cache</strong></a> to amortize the cost of building those <code>.a</code> files was the final piece needed to make this happen.</p>\n  \n  <p>Only \"<code>go vet</code>\" has this guarantee. Do not use \"<code>go tool vet</code>\", which is essentially only useful to people working on <code>vet</code> (just like you don't typically run \"<code>go tool compile</code>\").<br>\n  Previously you needed to use \"<code>go tool vet</code>\" if you wanted control over vet flags, but \"<code>go vet</code>\" now accepts all the flags that \"<code>go tool vet</code>\" does. (See \"<code>go help vet</code>\".)</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1765, "user_id": 3823826, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/19add980b878cac93905e623ad5f6646?s=128&d=identicon&r=PG", "display_name": "Csongor Halmai", "link": "https://stackoverflow.com/users/3823826/csongor-halmai"}, "is_accepted": false, "score": 1, "last_activity_date": 1603784761, "creation_date": 1603784761, "answer_id": 64550058, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor/64550058#64550058", "title": "How to make go linters ignore vendor/?", "body": "<p>Here is what I use:</p>\n<pre><code>golint $(ls -d1 */ | sed s/\\\\//\\\\/.../g | grep -v -E &quot;^vendor/&quot; | tr &quot;\\n&quot; &quot; &quot;)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1614990933, "creation_date": 1614990933, "answer_id": 66501252, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor/66501252#66501252", "title": "How to make go linters ignore vendor/?", "body": "<p>In Go 1.9, a <a href=\"https://github.com/golang/go/commit/fa1d54c2edad607866445577fe4949fbe55166e1\" rel=\"nofollow noreferrer\">change</a> was introduced for <code>./...</code> to no longer match packages in the <code>vendor</code> directory (<a href=\"https://golang.org/doc/go1.9#vendor-dotdotdot\" rel=\"nofollow noreferrer\">release notes</a>), which was a popular <a href=\"https://github.com/golang/go/issues/19090\" rel=\"nofollow noreferrer\">issue</a>.</p>\n<p>This means that for most purposes, the easiest way is now</p>\n<pre class=\"lang-sh prettyprint-override\"><code>go test ./...  # ignores vendor\ngo fmt ./...   # ignores vendor\ngo list ./...  # ignores vendor\n# etc.\n</code></pre>\n<p>However, specifically for <code>gofmt</code> (which we might want to use if <code>go fmt</code> doesn't have the option we need), the case is not as clear cut:</p>\n<ul>\n<li><code>gofmt</code> takes paths as arguments, not packages</li>\n<li>it works recursively if given directories, so it seems like just <code>gofmt .</code> should work \u2013\u00a0but that does <em>not</em> ignore <code>vendor</code></li>\n</ul>\n<p>So either we have to go back to</p>\n<pre class=\"lang-sh prettyprint-override\"><code>gofmt -l . | grep -v vendor\n</code></pre>\n<p>but this would match <code>vendor</code> for a directory that is <em>not</em> the actual vendor directory, and it feels wasteful to check everything in <code>vendor</code> before throwing it away.</p>\n<p>We also can't use</p>\n<pre class=\"lang-sh prettyprint-override\"><code>gofmt -l $(go list -f '{{.Dir}}' ./...)\n</code></pre>\n<p>because <code>./...</code> matches the package of the current directory, causing <code>gofmt</code> to descend everywhere including <code>vendor</code>.</p>\n<p>A more robust solution using templates iterating over the files directly</p>\n<pre class=\"lang-sh prettyprint-override\"><code>gofmt -l $(go list -f '{{range .GoFiles}} {{$.Dir}}/{{.}}{{end}}' ./...)\n</code></pre>\n<p>can run into command line length limitations in a large directory tree with longs paths, so that's not perfect either. My inclination is to use <code>go fmt ./...</code> where possible.</p>\n"}], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7682, "favorite_count": 1, "answer_count": 8, "score": 8, "last_activity_date": 1614990933, "creation_date": 1478793587, "last_edit_date": 1478794137, "question_id": 40531874, "link": "https://stackoverflow.com/questions/40531874/how-to-make-go-linters-ignore-vendor", "title": "How to make go linters ignore vendor/?", "body": "<p>How do we make <code>go vet</code>, <code>gofmt</code>, and other Go linter tools ignore third-party files in <code>vendor/</code>, preferably with an accurate, cumulative exit status?</p>\n\n<p>For example, would <code>find . -name vendor -prune -o -name '*.go' -exec gofmt -s -w {} \\;</code> present a meaningful exit status?</p>\n"}]