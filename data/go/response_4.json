[{"tags": ["arrays", "string", "go"], "comments": [{"owner": {"reputation": 6027, "user_id": 205832, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/23c6d359b6f7af3d3f91ca9e17b804b3?s=128&d=identicon&r=PG", "display_name": "Peter Bengtsson", "link": "https://stackoverflow.com/users/205832/peter-bengtsson"}, "edited": false, "score": 1, "creation_date": 1423082047, "post_id": 28330908, "comment_id": 45008935, "body": "Demonstrated here <a href=\"https://play.golang.org/p/heJXcjerIN\" rel=\"nofollow noreferrer\">play.golang.org/p/heJXcjerIN</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4516901"}, "edited": false, "score": 0, "creation_date": 1423089431, "post_id": 28330908, "comment_id": 45012666, "body": "Oh my, I just learned that its length is 1 in C++ too. For all these years I didn&#39;t know that. But why didn&#39;t I?"}], "answers": [{"comments": [{"owner": {"reputation": 6027, "user_id": 205832, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/23c6d359b6f7af3d3f91ca9e17b804b3?s=128&d=identicon&r=PG", "display_name": "Peter Bengtsson", "link": "https://stackoverflow.com/users/205832/peter-bengtsson"}, "edited": false, "score": 0, "creation_date": 1423115375, "post_id": 28330986, "comment_id": 45019916, "body": "I noticed that it&#39;s actually the same in JavaScript. <code>(&quot;&quot;.split(&#39;,&#39;)).length</code> is <code>1</code>."}], "tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": true, "score": 12, "last_activity_date": 1423082702, "last_edit_date": 1423082702, "creation_date": 1423082380, "answer_id": 28330986, "question_id": 28330908, "link": "https://stackoverflow.com/questions/28330908/how-to-string-split-an-empty-string-in-go/28330986#28330986", "title": "How to string split an empty string in Go", "body": "<p>The result of <code>strings.Split</code> is a slice with one element - the empty string.</p>\n\n<p><code>fmt.Println</code> is just not displaying it.  Try this example (notice the change to the last print).</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    groups := strings.Split(\"one,two\", \",\")\n    fmt.Println(groups, len(groups))\n    groups = strings.Split(\"one\", \",\")\n    fmt.Println(groups, len(groups))\n    groups = strings.Split(\"\", \",\")\n    fmt.Printf(\"%q, %d\\n\", groups, len(groups))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rVwQqBn4Mh\">Playground link</a></p>\n\n<p>This makes sense.  If you wanted to split the string <code>\"HelloWorld\"</code> using a <code>,</code> character as the delimiter, you'd expect the result to be <code>\"HelloWorld\"</code> - the same as your input.</p>\n"}], "owner": {"reputation": 6027, "user_id": 205832, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/23c6d359b6f7af3d3f91ca9e17b804b3?s=128&d=identicon&r=PG", "display_name": "Peter Bengtsson", "link": "https://stackoverflow.com/users/205832/peter-bengtsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2982, "favorite_count": 0, "accepted_answer_id": 28330986, "answer_count": 1, "score": 8, "last_activity_date": 1423082702, "creation_date": 1423082028, "question_id": 28330908, "link": "https://stackoverflow.com/questions/28330908/how-to-string-split-an-empty-string-in-go", "title": "How to string split an empty string in Go", "body": "<p>In Python if I do...:</p>\n\n<pre><code>parts = \"\".split(\",\")\nprint parts, len(parts)\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>[], 0\n</code></pre>\n\n<p>If I do the equivalent in Go...:</p>\n\n<pre><code>parts = strings.Split(\"\", \",\")        \nfmt.Println(parts, len(parts))\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code>[], 1\n</code></pre>\n\n<p>How can it have a length of 1 if there's nothing in it?</p>\n"}, {"tags": ["json", "reflection", "interface", "go"], "answers": [{"comments": [{"owner": {"reputation": 5356, "user_id": 1885921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02ba513b62ef9f2f7798b9bac1ccf822?s=128&d=identicon&r=PG", "display_name": "vodolaz095", "link": "https://stackoverflow.com/users/1885921/vodolaz095"}, "edited": false, "score": 0, "creation_date": 1423090531, "post_id": 28330458, "comment_id": 45013180, "body": "thanks for answer, can you provide me some more insights how can i make it? i&#39;m quite new to go, my previous language was javascript"}], "tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": true, "score": 1, "last_activity_date": 1423108603, "last_edit_date": 1423108603, "creation_date": 1423080358, "answer_id": 28330458, "question_id": 28329938, "link": "https://stackoverflow.com/questions/28329938/pass-struct-as-type-name-to-function-argument/28330458#28330458", "title": "Pass `struct` as type name to function argument", "body": "<p>You can use reflection, but be warned that it is non-trivial and relatively slow. I don't know of any other way.</p>\n\n<ul>\n<li><a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow\">http://golang.org/pkg/reflect/</a></li>\n<li><a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\">http://blog.golang.org/laws-of-reflection</a></li>\n</ul>\n\n<p>The simplest way to do this is to make your parameter of type <code>interface{}</code> and pass in an empty (uninitialized) instance of the struct you wish to unmarshal into. I highly suggest reading the second of the two links I list - it provides a clear introduction to reflection and how to use it for solving problems like this one.</p>\n"}], "owner": {"reputation": 5356, "user_id": 1885921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02ba513b62ef9f2f7798b9bac1ccf822?s=128&d=identicon&r=PG", "display_name": "vodolaz095", "link": "https://stackoverflow.com/users/1885921/vodolaz095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 28330458, "answer_count": 1, "score": 1, "last_activity_date": 1424070110, "creation_date": 1423078682, "last_edit_date": 1424070110, "question_id": 28329938, "link": "https://stackoverflow.com/questions/28329938/pass-struct-as-type-name-to-function-argument", "title": "Pass `struct` as type name to function argument", "body": "<p>I'm writing some sort of RESTfull API based Object relational mapper in go.\nI plan to make it MIT licensed, when i finish it.\nThe idea is to use some 3rd party REST API as data storage, and the <code>golang</code> client will query it for data needed.</p>\n\n<p>The API responses are JSONs with known structure.</p>\n\n<p>this is my code:</p>\n\n<pre><code>type AClient struct {\n    Id        string `json:\"id\"`\n    Uid       string `json:\"uid\"`\n    FirstName string `json:\"firstName\"`\n    LastName  string `json:\"lastName\"`\n    CreatedAt string `json:\"createdAt\"`\n    UpdatedAt string `json:\"updatedAt\"`\n    City      string `json:\"city\"`\n    Address   string `json:\"address\"`\n    Telefone  string `json:\"telefone\"`\n    Zip       string `json:\"zip\"`\n    Telefon   string `json:\"telefon\"`\n    Comment   string `json:\"comment\"`\n}\n\ntype AEvents struct {\n    Id          string    `json:\"id\"`\n    Security    bool      `json:\"security\"`\n    Description string    `json:\"description\"`\n    Good        AGood     `json:\"good\"`\n    Client      AClient   `json:\"client\"`\n    Author      AAuthor   `json:\"author\"`\n    InFuture    bool      `json:\"inFuture\"`\n    CreatedAt   time.Time `json:\"createdAt\"`\n    UpdatedAt   time.Time `json:\"updatedAt\"`\n}\n\ntype Entry struct {\n    AEvents //this have to be changed to `AClients` in runtime when needed\n}\n\ntype ORM struct {\n    ApiUrl         string\n    ModelName      string\n    ModelInterface Entry\n    HuntKey        string\n    HuntSid        string\n    Csrf           string\n}\n\nfunc (o *ORM) Query(parameters map[string]string) ([]Entry, AMetadata, error) {\n    responseParsed := struct {\n        Status   string    `json:\"status\"`\n        Metadata AMetadata `json:\"metadata\"`\n        Data     []Entry   `json:\"data\"` //todo - use o.ModelInterface\n    }{}\n    client := &amp;http.Client{}\n\n    var queryString string\n\n    for k, v := range parameters {\n        queryString = queryString + fmt.Sprintf(\"%v=%v&amp;\", url.QueryEscape(k), url.QueryEscape(v))\n    }\n\n    req, err := http.NewRequest(\"GET\", fmt.Sprintf(\"%v%v?%v\", o.ApiUrl, o.ModelName, queryString), nil)\n    fmt.Println(\"---------------------------------------------\")\n    fmt.Println(fmt.Sprintf(\"[GET] %v%v?%v\", o.ApiUrl, o.ModelName, queryString))\n    req.Header.Set(\"huntKey\", o.HuntKey)\n    if err != nil {\n        return nil, AMetadata{}, err\n    }\n    res, err1 := client.Do(req)\n    defer res.Body.Close()\n    if err1 != nil {\n        return nil, AMetadata{}, err1\n    }\n    if res.StatusCode == 200 {\n        for _, v := range res.Cookies() {\n            if v.Name == \"XSRF-TOKEN\" {\n                o.Csrf = v.Value\n            }\n            if v.Name == \"hunt.sid\" {\n                o.HuntSid = v.Value\n            }\n        }\n        fmt.Printf(\"CSRF %v\\n\", o.Csrf)\n        fmt.Printf(\"HuntSid %v\\n\", o.HuntSid)\n        fmt.Println(\"---------------------------------------------\")\n        raw, err2 := ioutil.ReadAll(res.Body)\n        if err2 != nil {\n            return nil, AMetadata{}, err2\n        } else {\n            err2 = json.Unmarshal(raw, &amp;responseParsed)\n            return responseParsed.Data, responseParsed.Metadata, nil\n        }\n    } else {\n        return nil, AMetadata{}, errors.New(\"Unable to fetch data!\")\n    }\n}\n</code></pre>\n\n<p>How can I make this:\nWhen instantiating the  <code>ORM</code> object, how can i pass the struct name, that will be used to parse the JSON response. The current code works with the <code>struct</code> of <code>AEvents</code>, but i want it to be easy changeble t <code>AClient</code> and so on.</p>\n\n<p>UPD: \ni have reviewed the code of <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow\">https://github.com/jinzhu/gorm</a> and find out tons of things how can i implement it.\nThan, as i have promised, I publish this code as open source -<a href=\"https://github.com/vodolaz095/hrorm\" rel=\"nofollow\">https://github.com/vodolaz095/hrorm</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "edited": false, "score": 1, "creation_date": 1526479521, "post_id": 28323218, "comment_id": 87762107, "body": "Your approach doesn&#39;t allow to pass arguments divided by space like <code>-opt 1 2 3</code>."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "edited": false, "score": 7, "creation_date": 1526479978, "post_id": 28323218, "comment_id": 87762498, "body": "@AlexMedveshchek If the argument to the option is truely separated by spaces (e.g. if you typed <code>foo -opt &quot;1 2 3&quot;</code>), then of course it works.  If you Pass them as separate arguments to the program (i.e. if you typed <code>foo -opt 1 2 3</code>) then of course it can&#39;t work at all, even with other strategies, as you cannot distinguish the arguments to the option from other operands following it.  Don&#39;t write programs that way."}, {"owner": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "edited": false, "score": 2, "creation_date": 1526544742, "post_id": 28323218, "comment_id": 87788457, "body": "Yes, you are right, you can feed <code>&quot;1 2 3&quot;</code> in quotes, and it will work. But it&#39;s artificial, and the original question was how to implement argument parsing like it implemented in python&#39;s <code>argparse</code>, which allows to parse mentioned case. In fact it&#39;s really easy to implement: you just need to consume <code>-opt</code>&#39;s arguments until you meet some other known option like <code>-opt2</code> or the last argument in command line."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "edited": false, "score": 5, "creation_date": 1526545669, "post_id": 28323218, "comment_id": 87788978, "body": "@Alex Medveshchek That&#39;s a super shitty way of parsing option arguments because you can&#39;t easily have operands after them. Plus it&#39;s in violation of the UCB utility guidelines which is a bad thing, too."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "edited": false, "score": 1, "creation_date": 1526550393, "post_id": 28323218, "comment_id": 87792177, "body": "@AlexMedveshchek Indeed! Few people know about them and proceed to design unintuitive command line interfaces due to not following established conventions."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "edited": false, "score": 5, "creation_date": 1526550626, "post_id": 28323218, "comment_id": 87792352, "body": "@AlexMedveshchek <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html#tag_12_01\" rel=\"nofollow noreferrer\">The guidelines in question</a>."}, {"owner": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "edited": false, "score": 1, "creation_date": 1526551227, "post_id": 28323218, "comment_id": 87792757, "body": "Thank you, it&#39;s interesting. In fact pythonic <code>argparse</code> allows to implement this approach and even more. And I&#39;ve met other cases in my practice when using OG&#39;s approach was not sufficient. Anyway, thank you for valuable info."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 12, "last_activity_date": 1423058239, "creation_date": 1423058239, "answer_id": 28323218, "question_id": 28322997, "link": "https://stackoverflow.com/questions/28322997/how-to-get-a-list-of-values-into-a-flag-in-golang/28323218#28323218", "title": "How to get a list of values into a flag in Golang?", "body": "<p>Use <a href=\"http://golang.org/pkg/flag/#String\" rel=\"noreferrer\">flag.String()</a> to get the entire list of values for the argument you need and then split it up into individual items with <a href=\"http://golang.org/pkg/strings/#Split\" rel=\"noreferrer\">strings.Split()</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1423058715, "post_id": 28323276, "comment_id": 44994524, "body": "+1. The <code>flag.Value()</code> method can also be used if you want to specify all list elements in one comma separated <code>string</code> which <code>Value()</code> can split into a slice of <code>string</code>s. <code>flag.Value</code> and <code>flag.Var()</code> is much more general than just using <code>flag.String()</code> and <code>strings.Split()</code>. Errors reported by <code>Value()</code> are also handled automatically by package <code>flag</code>."}, {"owner": {"reputation": 1957, "user_id": 2094708, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nIQKY.jpg?s=128&g=1", "display_name": "Sidharth C. Nadhan", "link": "https://stackoverflow.com/users/2094708/sidharth-c-nadhan"}, "edited": false, "score": 2, "creation_date": 1423113956, "post_id": 28323276, "comment_id": 45019475, "body": "Thanks, that works! But is it possible to implement it this way : go run my_file.go --list1 value1 value2"}, {"owner": {"reputation": 13539, "user_id": 319006, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/da577908b04f60453c85f9c64e91638a?s=128&d=identicon&r=PG", "display_name": "sholsapp", "link": "https://stackoverflow.com/users/319006/sholsapp"}, "edited": false, "score": 0, "creation_date": 1450557006, "post_id": 28323276, "comment_id": 56491924, "body": "The link is dead now."}, {"owner": {"reputation": 13539, "user_id": 319006, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/da577908b04f60453c85f9c64e91638a?s=128&d=identicon&r=PG", "display_name": "sholsapp", "link": "https://stackoverflow.com/users/319006/sholsapp"}, "edited": false, "score": 0, "creation_date": 1450736178, "post_id": 28323276, "comment_id": 56552298, "body": "Yep -- looks like it is back now. Before it was returning a server error. Maybe it would be best to include the code snippet here so there isn&#39;t the dependency on that site being up."}, {"owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "reply_to_user": {"reputation": 13539, "user_id": 319006, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/da577908b04f60453c85f9c64e91638a?s=128&d=identicon&r=PG", "display_name": "sholsapp", "link": "https://stackoverflow.com/users/319006/sholsapp"}, "edited": false, "score": 0, "creation_date": 1450774925, "post_id": 28323276, "comment_id": 56564936, "body": "@sholsapp updated answer to include the code snippet"}, {"owner": {"reputation": 1260, "user_id": 695459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8766f0303f842207f52c2789896a7214?s=128&d=identicon&r=PG", "display_name": "mikijov", "link": "https://stackoverflow.com/users/695459/mikijov"}, "edited": false, "score": 2, "creation_date": 1518279501, "post_id": 28323276, "comment_id": 84444467, "body": "This is such an awesome suggestion which is completely not apparent from official documentation. I wish there was +10. Please consider adding this to official documentation."}, {"owner": {"reputation": 165, "user_id": 4825206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-W4QVgGUUPgY/AAAAAAAAAAI/AAAAAAAAApg/fXCxdZNiI9k/photo.jpg?sz=128", "display_name": "Koala Bear", "link": "https://stackoverflow.com/users/4825206/koala-bear"}, "edited": false, "score": 7, "creation_date": 1524755210, "post_id": 28323276, "comment_id": 87108911, "body": "I realize this is 3 years old but this does not fully answer the original question. You can utilize duplicate flags this way but to my knowledge you cannot perform the original desire: A single flag call with multiple values.  This is a really basic flag operation and I refuse to believe Go doesn&#39;t allow it in the standard library"}, {"owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "reply_to_user": {"reputation": 165, "user_id": 4825206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-W4QVgGUUPgY/AAAAAAAAAAI/AAAAAAAAApg/fXCxdZNiI9k/photo.jpg?sz=128", "display_name": "Koala Bear", "link": "https://stackoverflow.com/users/4825206/koala-bear"}, "edited": false, "score": 3, "creation_date": 1528048936, "post_id": 28323276, "comment_id": 88348600, "body": "@KoalaBear the problem with a single flag call with multiple values is it is ambiguous. The same syntax normally means a single flag call with a single value, followed by a single <a href=\"https://golang.org/pkg/flag/#Arg\" rel=\"nofollow noreferrer\">argument</a>. I think the solution in this answer is the best you can hope for."}, {"owner": {"reputation": 3949, "user_id": 1816872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1V08e.jpg?s=128&g=1", "display_name": "Ivan Black", "link": "https://stackoverflow.com/users/1816872/ivan-black"}, "edited": false, "score": 1, "creation_date": 1539412070, "post_id": 28323276, "comment_id": 92501250, "body": "The same example with <code>flag.Set()</code> and checking out: <a href=\"https://play.golang.org/p/H_IiaBv2TPx\" rel=\"nofollow noreferrer\">play.golang.org/p/H_IiaBv2TPx</a>"}, {"owner": {"reputation": 2672, "user_id": 9208887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b42a62830357a073f912ce786822e1?s=128&d=identicon&r=PG&f=1", "display_name": "The Fool", "link": "https://stackoverflow.com/users/9208887/the-fool"}, "edited": false, "score": 0, "creation_date": 1588969061, "post_id": 28323276, "comment_id": 109115380, "body": "can we have a default here that is overwritten when the flags are set?"}, {"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 0, "creation_date": 1594489652, "post_id": 28323276, "comment_id": 111146804, "body": "Note that this answer, in spite of being up-voted so much, does <i>not</i> address the way the OP wishes to do things. Please see the comment <a href=\"https://stackoverflow.com/a/53672394/1035977\">stackoverflow.com/a/53672394/1035977</a> below, which neatly exemplifies how it&#39;s properly done."}], "tags": [], "owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "is_accepted": false, "score": 149, "last_activity_date": 1450774911, "last_edit_date": 1450774911, "creation_date": 1423058421, "answer_id": 28323276, "question_id": 28322997, "link": "https://stackoverflow.com/questions/28322997/how-to-get-a-list-of-values-into-a-flag-in-golang/28323276#28323276", "title": "How to get a list of values into a flag in Golang?", "body": "<p>You can define your own <code>flag.Value</code> and use <code>flag.Var()</code> for binding it.</p>\n\n<p>The example is <a href=\"http://play.golang.org/p/Ig5sm7jA14\">here</a>.</p>\n\n<p>Then you can pass multiple flags like following:</p>\n\n<pre><code>go run your_file.go --list1 value1 --list1 value2\n</code></pre>\n\n<p>UPD: including code snippet right there just in case.</p>\n\n<pre><code>package main\n\nimport \"flag\"\n\ntype arrayFlags []string\n\nfunc (i *arrayFlags) String() string {\n    return \"my string representation\"\n}\n\nfunc (i *arrayFlags) Set(value string) error {\n    *i = append(*i, value)\n    return nil\n}\n\nvar myFlags arrayFlags\n\nfunc main() {\n    flag.Var(&amp;myFlags, \"list1\", \"Some description for this param.\")\n    flag.Parse()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9266, "user_id": 1465640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b64a91edcfaad3c6290039008deea285?s=128&d=identicon&r=PG", "display_name": "Pylinux", "link": "https://stackoverflow.com/users/1465640/pylinux"}, "is_accepted": false, "score": 12, "last_activity_date": 1544196207, "creation_date": 1544196207, "answer_id": 53672394, "question_id": 28322997, "link": "https://stackoverflow.com/questions/28322997/how-to-get-a-list-of-values-into-a-flag-in-golang/53672394#53672394", "title": "How to get a list of values into a flag in Golang?", "body": "<p>You can at least have a list of arguments on the end of you command by using the <a href=\"https://golang.org/pkg/flag/#Args\" rel=\"noreferrer\"><code>flag.Args()</code></a> function. </p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n)\n\nvar one string\n\nfunc main() {\n    flag.StringVar(&amp;one, \"o\", \"default\", \"arg one\")\n    flag.Parse()\n    tail := flag.Args()\n    fmt.Printf(\"Tail: %+q\\n\", tail)\n}\n</code></pre>\n\n<p><code>my-go-app -o 1 this is the rest</code> will print <code>Tail: [\"this\" \"is\" \"the\" \"rest\"]</code></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12254674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gf7Bt.jpg?s=128&g=1", "display_name": "arithmeticsx", "link": "https://stackoverflow.com/users/12254674/arithmeticsx"}, "is_accepted": false, "score": 1, "last_activity_date": 1594569494, "last_edit_date": 1594569494, "creation_date": 1592815816, "answer_id": 62510653, "question_id": 28322997, "link": "https://stackoverflow.com/questions/28322997/how-to-get-a-list-of-values-into-a-flag-in-golang/62510653#62510653", "title": "How to get a list of values into a flag in Golang?", "body": "<p>If you have a series of integer values at the end of the command line, this helper function will properly convert them and place them in a slice of <code>int</code>s:</p>\n<pre><code>package main\n\nimport (\n    &quot;flag&quot;\n    &quot;fmt&quot;\n    &quot;strconv&quot;\n)\n\nfunc GetIntSlice(i *[]string) []int {\n    var arr = *i\n    ret := []int{}\n    for _, str := range arr {\n        one_int, _ := strconv.Atoi(str)\n        ret = append(ret, one_int)\n    }\n    return ret\n}\n\nfunc main() {\n    flag.Parse()\n    tail := flag.Args()\n    fmt.Printf(&quot;Tail: %T,  %+v\\n&quot;, tail, tail)\n    intSlice := GetIntSlice(&amp;tail)\n\n    fmt.Printf(&quot;intSlice: %T,  %+v\\n&quot;, intSlice, intSlice)\n\n}\n\nmac:demoProject sx$ go run demo2.go 1 2 3 4\nTail: []string,  [1 2 3 4]\nintSlice: []int,  [1 2 3 4]\n</code></pre>\n"}], "owner": {"reputation": 1957, "user_id": 2094708, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nIQKY.jpg?s=128&g=1", "display_name": "Sidharth C. Nadhan", "link": "https://stackoverflow.com/users/2094708/sidharth-c-nadhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47649, "favorite_count": 14, "answer_count": 4, "score": 67, "last_activity_date": 1594569494, "creation_date": 1423057595, "last_edit_date": 1506386122, "question_id": 28322997, "link": "https://stackoverflow.com/questions/28322997/how-to-get-a-list-of-values-into-a-flag-in-golang", "title": "How to get a list of values into a flag in Golang?", "body": "<p>What is Golang's equivalent of the below python commands ?</p>\n\n<pre><code>import argparse\nparser = argparse.ArgumentParser(description=\"something\")\nparser.add_argument(\"-getList1\",nargs='*',help=\"get 0 or more values\")\nparser.add_argument(\"-getList2\",nargs='?',help=\"get 1 or more values\")\n</code></pre>\n\n<p>I have seen that the flag package allows argument parsing in Golang.\nBut it seems to support only String, Int or Bool.\nHow to get a list of values into a flag in this format :</p>\n\n<pre><code>go run myCode.go -getList1 value1 value2 \n</code></pre>\n"}, {"tags": ["go", "riak", "beego"], "answers": [{"tags": [], "owner": {"reputation": 13124, "user_id": 2282634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c5a01e93856e53a2f16eec3267a9b2?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/2282634/joe"}, "is_accepted": false, "score": 2, "last_activity_date": 1423066654, "creation_date": 1423066654, "answer_id": 28326188, "question_id": 28322666, "link": "https://stackoverflow.com/questions/28322666/how-can-i-use-riak-connection-pool-with-beego-framework/28326188#28326188", "title": "How can I use Riak connection pool with Beego Framework", "body": "<p>Whether or not to use a connection pool depends more on your usage pattern and workload that your choice of data store or client library.</p>\n\n<p>Each time a TCP connection is established, there is a three-way handshake:</p>\n\n<ol>\n<li>client --<code>syn</code>--> server  </li>\n<li>client &lt;--<code>syn-ack</code>-- server</li>\n<li>client --<code>ack</code>--> server</li>\n</ol>\n\n<p>This usually takes a very small amount of time and network bandwith, and creates an entry in the conntrack table on each machine. If your application opens a new connection to the server for every request and will be sending many thousands of requests per second, you may overflow the conntrack table, blocking new connections until some previous connections close; or the overhead traffic of creating connections could limit how many requests you can handle per second.</p>\n\n<p>If you decide to use a pool and use short-lived processes that handle a single request and then terminate, you will need some method of creating and maintaining connections separately from the request processes, and a method for the request processes to send requests and receive responses using a connection from the pool.</p>\n\n<p>You may find that if your application does not generate a sufficient volume of traffic, the effort required to design your application to use a connection pool outweighs any benefits gained by using a pool.  </p>\n\n<p>There is not right or wrong answer, this is going to heavily depend on your use case, request volume, and network capabilities.</p>\n"}], "owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423066654, "creation_date": 1423056563, "question_id": 28322666, "link": "https://stackoverflow.com/questions/28322666/how-can-i-use-riak-connection-pool-with-beego-framework", "title": "How can I use Riak connection pool with Beego Framework", "body": "<p>I'm developing a back-end using Beego and Riak. I'm searching for a way to keep the riak connection pool alive but I cannot find nothing in documentation besides SQL related. </p>\n\n<p>I'm really freshman to the Go language (started learning 2 days ago) and I don't know if connection pool is the write choice. As I understand, each Go app should be designed to work independently allowing easy scalability. If this is write maybe a single connection should be better choice. If this is the case, what is the best practice I can use?</p>\n\n<p>I'm sorry in advance if my question seems noobie, but, with my Django background, I'm not used to manage db connections.</p>\n\n<p>The riak connector I'm using is \"github.com/tpjg/goriakpbc\"</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1423053357, "post_id": 28321534, "comment_id": 44991017, "body": "I&#39;m not sure I get the issue with io.Writer. Didn&#39;t I provide an io.Writer? Otherwise it won&#39;t compile isn&#39;t it ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1423053522, "post_id": 28321534, "comment_id": 44991100, "body": "@Theuserwithnohat Edited the answer. Your <code>stringer.Writer()</code> method might be called multiple times and your implementation always throws away data written to it earlier."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1423053894, "post_id": 28321534, "comment_id": 44991312, "body": "Got it ... I didn&#39;t know it calls it several times, thus the whole misunderstanding. I&#39;m wondering if I should use a buffer too if I want to write the output to a file. Initially I thought I could give it just an *os.File( <a href=\"http://golang.org/pkg/os/#File.Write\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#File.Write</a>) argument but I guess it&#39;s not the case as it would truncate the file content just like it did with my receiver, right ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1423053972, "post_id": 28321534, "comment_id": 44991365, "body": "@Theuserwithnohat No, passing a <code>File</code> to <code>Execute()</code> is perfectly fine. It doesn&#39;t matter how many times <code>File.Write()</code> is called, because the implementation writes out the bytes passed to it, it will not be lost."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1423120280, "last_edit_date": 1423120280, "creation_date": 1423053214, "answer_id": 28321534, "question_id": 28321399, "link": "https://stackoverflow.com/questions/28321399/why-the-io-writer-doesnt-fill-the-receiver/28321534#28321534", "title": "Why the IO.Writer doesn&#39;t fill the receiver?", "body": "<p>Your <code>stringer</code> type is just an \"alias\" to <code>*string</code> type. <code>string</code> in Go is immutable. You shouldn't use a <code>string</code> or a pointer to a <code>string</code> to build the the output of a template, because you can't modify a <code>string</code>, you can only create a new (and throw away the old one).</p>\n\n<p><a href=\"http://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow\"><code>template.Execute()</code></a> expects an <a href=\"http://golang.org/pkg/io/#Writer\" rel=\"nofollow\"><code>io.Writer</code></a>. The <code>Write()</code> method of the output might be called multiple times, and your <code>stringer.Write()</code> method always throws away data written to it earlier. You could fix it by always concatenating the new data to the old like this:</p>\n\n<pre><code>*s = *s + stringer(b)\n</code></pre>\n\n<p>But this solution is terribly inefficient (it generates new <code>string</code>s and throws away old ones).</p>\n\n<p>A much better and ready-to-use alternative is <a href=\"http://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow\"><code>bytes.Buffer</code></a>. You can create a byte buffer which implements the <code>Writer</code> interface like this:</p>\n\n<pre><code>bytes.NewBuffer(nil)\n</code></pre>\n\n<p>You don't need to create your own <code>stringer</code> type. Try your modified program on <a href=\"http://play.golang.org/p/GzNb9CG_er\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 28321534, "answer_count": 1, "score": 0, "last_activity_date": 1423120280, "creation_date": 1423052883, "question_id": 28321399, "link": "https://stackoverflow.com/questions/28321399/why-the-io-writer-doesnt-fill-the-receiver", "title": "Why the IO.Writer doesn&#39;t fill the receiver?", "body": "<p>I'm trying to test a template generation tool. In order to do this I was thinking that the easiest way to capture the template execution output is to use a io writer and provide it during testing. The issue is that for some reasons the receiver is not \"updated\" with the template output. Hopefully the code below explains better the issue I'm facing.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"text/template\"\n\ntype Company struct{\n    Name string\n} \n\ntype Companies []Company\n\nfunc main() {\n    s := new(stringer)\n\n    v := Companies{Company{Name:\"Sony\"}}\n    tmp :=  template.Must(template.New(\"main\").Parse(src))\n    if err := tmp.Execute(s, v); err !=nil{\n        panic(err)\n    }\n    if *s != \"this is the header template\"{\n        fmt.Println(\"expected: \\\"this is the header template\\\" received: \", *s) \n    }else{\n      fmt.Println(\"s is %v\", *s)\n    }\n}\n\ntype stringer string\nfunc (s *stringer)Write(b []byte)(int, error){\n    *s = stringer(b)\n    return len(b), nil\n}\n\nvar src = `\n this is the header template\n    {{range .}}\n\n    {{.Name}}\n\n    {{end}}\n`\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/y4zWgyd5G1\" rel=\"nofollow\">http://play.golang.org/p/y4zWgyd5G1</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1423044164, "post_id": 28318415, "comment_id": 44985798, "body": "You&#39;re skipping error checks in your example. Are you skipping them in your real code too?"}, {"owner": {"reputation": 14611, "user_id": 468311, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-R2kbPXmZbho/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jKxaTxYHTYxiImqnqvR0jJmhDlaw/mo/photo.jpg?sz=128", "display_name": "Igor Filippov", "link": "https://stackoverflow.com/users/468311/igor-filippov"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1423048350, "post_id": 28318415, "comment_id": 44988336, "body": "@Ainar-G yes, I do skip them."}], "answers": [{"comments": [{"owner": {"reputation": 14611, "user_id": 468311, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-R2kbPXmZbho/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jKxaTxYHTYxiImqnqvR0jJmhDlaw/mo/photo.jpg?sz=128", "display_name": "Igor Filippov", "link": "https://stackoverflow.com/users/468311/igor-filippov"}, "edited": false, "score": 0, "creation_date": 1423048457, "post_id": 28319285, "comment_id": 44988395, "body": "My question is more about if I do post request correctly. It seems that I don&#39;t send any data."}, {"owner": {"reputation": 113, "user_id": 1211451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b6f66bf0bb6c714a13008acb72b478e?s=128&d=identicon&r=PG", "display_name": "llgcode", "link": "https://stackoverflow.com/users/1211451/llgcode"}, "reply_to_user": {"reputation": 14611, "user_id": 468311, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-R2kbPXmZbho/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jKxaTxYHTYxiImqnqvR0jJmhDlaw/mo/photo.jpg?sz=128", "display_name": "Igor Filippov", "link": "https://stackoverflow.com/users/468311/igor-filippov"}, "edited": false, "score": 0, "creation_date": 1423054715, "post_id": 28319285, "comment_id": 44991835, "body": "Yes I understand. I posted another answer below."}, {"owner": {"reputation": 14611, "user_id": 468311, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-R2kbPXmZbho/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jKxaTxYHTYxiImqnqvR0jJmhDlaw/mo/photo.jpg?sz=128", "display_name": "Igor Filippov", "link": "https://stackoverflow.com/users/468311/igor-filippov"}, "edited": false, "score": 1, "creation_date": 1423056175, "post_id": 28319285, "comment_id": 44992788, "body": "Thanks, actually mime type was the solution."}], "tags": [], "owner": {"reputation": 113, "user_id": 1211451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b6f66bf0bb6c714a13008acb72b478e?s=128&d=identicon&r=PG", "display_name": "llgcode", "link": "https://stackoverflow.com/users/1211451/llgcode"}, "is_accepted": true, "score": 2, "last_activity_date": 1423055256, "last_edit_date": 1423055256, "creation_date": 1423046465, "answer_id": 28319285, "question_id": 28318415, "link": "https://stackoverflow.com/questions/28318415/post-request-with-data-in-go/28319285#28319285", "title": "Post request with data in go", "body": "<p>You may want to use this form of request</p>\n\n<pre><code>resp, err := http.PostForm(\"http://example.com/form\", \n                            url.Values{\"key\": {\"Value\"}, \"id\": {\"123\"}})\n</code></pre>\n\n<p>or use the right mime type :</p>\n\n<pre><code>req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n</code></pre>\n\n<p>and encode data</p>\n\n<pre><code>strings.NewReader(data.Encode())\n</code></pre>\n\n<p>It's better if you test err != nil and return if necessary. This code may not work cause the request failed.</p>\n\n<pre><code>defer resp.Body.Close()\n</code></pre>\n\n<p>instead use this pattern:</p>\n\n<pre><code>client := &amp;http.Client{}\nresp, err := client.Do(req)\nif err != nil {\n    fmt.Println(err)\n    return\n}\ndefer resp.Body.Close()\nbody, _ := ioutil.ReadAll(resp.Body)\nfmt.Println(resp.Status)\nfmt.Println(string(body))\n</code></pre>\n\n<p>So you can see in the console if the request failed or not</p>\n"}], "owner": {"reputation": 14611, "user_id": 468311, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-R2kbPXmZbho/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jKxaTxYHTYxiImqnqvR0jJmhDlaw/mo/photo.jpg?sz=128", "display_name": "Igor Filippov", "link": "https://stackoverflow.com/users/468311/igor-filippov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 28319285, "answer_count": 1, "score": 1, "last_activity_date": 1423055256, "creation_date": 1423043877, "question_id": 28318415, "link": "https://stackoverflow.com/questions/28318415/post-request-with-data-in-go", "title": "Post request with data in go", "body": "<p>I'm trying to access an API like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc main() {\n    apiUrl := \"https://example.com/api/\"\n    data := url.Values{}\n    data.Set(\"api_token\", \"MY_KEY\")\n    data.Add(\"action\", \"list_projects\")\n    req, _ := http.NewRequest(\"POST\", apiUrl, bytes.NewBufferString(data.Encode()))\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    defer resp.Body.Close()\n    if err == nil {\n        body, _ := ioutil.ReadAll(resp.Body)\n        fmt.Println(resp.Status)\n        fmt.Println(string(body))\n    }\n}\n</code></pre>\n\n<p>But the response from an API tells me there was no data in POST request. </p>\n\n<p>If I do it like this with curl, it works:</p>\n\n<pre><code>$ curl -X POST \"https://example.com/api/\" -d \"api_token=MY_KEY\" -d \"action=list_projects\"\n</code></pre>\n"}, {"tags": ["multithreading", "memory-leaks", "go", "goroutine"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1423047312, "post_id": 28317989, "comment_id": 44987729, "body": "I would try the code you posted <i>without</i> the code you haven&#39;t posted. Use a <code>manager()</code> function which just generates input endlessly and a <code>do()</code> function which does nothing (empty function). See if you still have a memory leak. If not, then obviously the leak is in the code you haven&#39;t posted in which case there&#39;s nothing we can do in the current state of the question."}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1423056479, "post_id": 28317989, "comment_id": 44993003, "body": "Are you using unsafe or C anywhere? Latest Go version? I would try to run it with GODEBUG=gctrace=1 to check what is going on with the garbage collector."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1423065591, "post_id": 28317989, "comment_id": 44999133, "body": "I don&#39;t know if it&#39;s intended or not, but there&#39;s no guarantee that this code will use a maximum of 10 goroutines. If you goal is to limit the number of workers to 10, then do <a href=\"http://play.golang.org/p/ADc99JTMBJ\" rel=\"nofollow noreferrer\">this</a>. The code above has a field name <code>type</code> which will not compile. Can you show the actual code?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1423089166, "post_id": 28317989, "comment_id": 45012552, "body": "Could be, somehow, it&#39;s leaking goroutines: something never gets to exit.  There are old statements from mailing lists that goroutine stacks are never returned to the system. <code>goroutineCount, _ := runtime.GoroutineProfile(nil)</code> can quickly tell you how many are running."}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 3, "creation_date": 1423100778, "post_id": 28317989, "comment_id": 45016128, "body": "ThunderCat&#39;s comment is spot on.  The code you&#39;re trying to use to limit the number of working threads looks low-level and frankly error-prone.  You most likely want to take the approach in: <a href=\"http://talks.golang.org/2012/waza.slide#41\" rel=\"nofollow noreferrer\">talks.golang.org/2012/waza.slide#41</a>, where you limit the number of worker goroutines, which pull from a shared channel of work."}, {"owner": {"reputation": 11711, "user_id": 1018582, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18789a2f20eee6dfe637fef8bd7ebf5?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1018582/alasdair"}, "edited": false, "score": 0, "creation_date": 1423118893, "post_id": 28317989, "comment_id": 45021111, "body": "Thanks, I&#39;ve changed from atomic to a fixed number of goroutines that are reused. Ironic actually because I avoided that specifically thinking it would increase memory usage. It&#39;ll take a couple of days to see the results. Still this must represent a bug in the compiler, no? (Assuming this fixes it.)"}, {"owner": {"reputation": 11711, "user_id": 1018582, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18789a2f20eee6dfe637fef8bd7ebf5?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1018582/alasdair"}, "edited": false, "score": 0, "creation_date": 1423196772, "post_id": 28317989, "comment_id": 45060247, "body": "So the problem is worse now that goroutines are reused rather than destroyed. So that points to a memory leak unrelated to the goroutines but it must be a package using C or unsafe. I will investigate all such packages."}], "answers": [{"tags": [], "owner": {"reputation": 632, "user_id": 872227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ddef50299354758664f679265746cd?s=128&d=identicon&r=PG", "display_name": "freeformz", "link": "https://stackoverflow.com/users/872227/freeformz"}, "is_accepted": false, "score": 1, "last_activity_date": 1428479263, "creation_date": 1428479263, "answer_id": 29508856, "question_id": 28317989, "link": "https://stackoverflow.com/questions/28317989/golang-memory-leak-concerning-goroutines/29508856#29508856", "title": "Golang Memory Leak Concerning Goroutines", "body": "<p>Please consider inverting the pattern, see <a href=\"https://play.golang.org/p/CJ8-Z8W3GL\" rel=\"nofollow\">here</a> or below....</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\n// I do work\nfunc worker(id int, work chan int) {\n    for i := range work {\n        // Work simulation\n        log.Printf(\"Worker %d, sleeping for %d seconds\\n\", id, i)\n        time.Sleep(time.Duration(rand.Intn(i)) * time.Second)\n    }\n}\n\n// Return some fake work\nfunc getWork() int {\n    return rand.Intn(2) + 1\n}\n\nfunc main() {\n    wg := new(sync.WaitGroup)\n    work := make(chan int)\n\n    // run 10 workers\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go func(i int) {\n            worker(i, work)\n            wg.Done()\n        }(i)\n    }\n\n    // main \"thread\"\n    for i := 0; i &lt; 100; i++ {\n        work &lt;- getWork()\n    }\n\n    // signal there is no more work to be done\n    close(work)\n\n    // Wait for the workers to exit\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 11711, "user_id": 1018582, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18789a2f20eee6dfe637fef8bd7ebf5?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1018582/alasdair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2908, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1428479263, "creation_date": 1423042630, "question_id": 28317989, "link": "https://stackoverflow.com/questions/28317989/golang-memory-leak-concerning-goroutines", "title": "Golang Memory Leak Concerning Goroutines", "body": "<p>I have a Go program that runs continuously and relies entirely on goroutines + 1 <code>manager</code> thread. The main thread simply calls goroutines and otherwise sleeps.</p>\n\n<p>There is a memory leak. The program uses more and more memory until it drains all 16GB RAM + 32GB SWAP and then each goroutine panics. It is actually OS memory that causes the panic, usually the panic is <code>fork/exec ./anotherapp: cannot allocate memory</code> when I try to execute <code>anotherapp</code>.</p>\n\n<p>When this happens all of the worker threads will panic and be recovered and restarted. So each goroutine will panic, be recovered and restarted... at which point the memory usage will not decrease, it remains at 48GB even though there is now virtually nothing allocated. This means all goroutines will always panic as there is never enough memory, until the entire executable is killed and restarted completely.</p>\n\n<p>The entire thing is about 50,000 lines, but the actual problematic area is as follows:</p>\n\n<pre><code>type queue struct {\n    identifier string\n    type bool\n}\n\nfunc main() {\n\n    // Set number of gorountines that can be run\n    var xthreads int32 = 10\n    var usedthreads int32\n    runtime.GOMAXPROCS(14)\n    ready := make(chan *queue, 5)\n\n    // Start the manager goroutine, which prepared identifiers in the background ready for processing, always with 5 waiting to go\n    go manager(ready)\n\n    // Start creating goroutines to process as they are ready\n    for obj := range ready { // loops through \"ready\" channel and waits when there is nothing\n\n        // This section uses atomic instead of a blocking channel in an earlier attempt to stop the memory leak, but it didn't work\n        for atomic.LoadInt32(&amp;usedthreads) &gt;= xthreads {\n            time.Sleep(time.Second)\n        }\n        debug.FreeOSMemory() // Try to clean up the memory, also did not stop the leak\n        atomic.AddInt32(&amp;usedthreads, 1) // Mark goroutine as started\n\n        // Unleak obj, probably unnecessary, but just to be safe\n        copy := new(queue)\n        copy.identifier = unleak.String(obj.identifier) // unleak is a 3rd party package that makes a copy of the string\n        copy.type = obj.type\n        go runit(copy, &amp;usedthreads) // Start the processing thread\n\n    }\n\n    fmt.Println(`END`) // This should never happen as the channels are never closed\n}\n\nfunc manager(ready chan *queue) {\n    // This thread communicates with another server and fills the \"ready\" channel\n}\n\n// This is the goroutine\nfunc runit(obj *queue, threadcount *int32) {\n    defer func() {\n        if r := recover(); r != nil {\n            // Panicked\n            erstring := fmt.Sprint(r)\n            reportFatal(obj.identifier, erstring)\n        } else {\n            // Completed successfully\n            reportDone(obj.identifier)\n        }\n        atomic.AddInt32(threadcount, -1) // Mark goroutine as finished\n    }()\n    do(obj) // This function does the actual processing\n}\n</code></pre>\n\n<p>As far as I can see, when the <code>do</code> function (last line) ends, either by having finished or having panicked, the <code>runit</code> function then ends, which ends the goroutine entirely, which means all of the memory from that goroutine should now be free. This is now what happens. What happens is that this app just uses more and more and more memory until it becomes unable to function, all the <code>runit</code> goroutines panic, and yet the memory does not decrease.</p>\n\n<p>Profiling does not reveal anything suspicious. The leak appears to be outside of the profiler's scope.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "edited": false, "score": 0, "creation_date": 1423031546, "post_id": 28314879, "comment_id": 44979360, "body": "Ah ok. That is what I thought."}, {"owner": {"reputation": 14111, "user_id": 217019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ede807eedb7fe77242664741f91627f7?s=128&d=identicon&r=PG", "display_name": "Mateusz Dymczyk", "link": "https://stackoverflow.com/users/217019/mateusz-dymczyk"}, "edited": false, "score": 1, "creation_date": 1423031660, "post_id": 28314879, "comment_id": 44979406, "body": "why not just use the shorthand <code>:=</code>?"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 4, "last_activity_date": 1423040061, "last_edit_date": 1423040061, "creation_date": 1423031489, "answer_id": 28314879, "question_id": 28314691, "link": "https://stackoverflow.com/questions/28314691/go-type-inference-and-named-return-variables/28314879#28314879", "title": "Go type inference and named return variables", "body": "<p>No, you can't do what you want to do.</p>\n\n<p>Your choices are to not use named returns, or like you said declare</p>\n\n<pre><code>var usr *user.User \nusr, err = user.Current()\n</code></pre>\n\n<p>In some circumstances you could do that, but in your case you are are creating a new <code>err</code> because you are within the if block and it is making a locally scoped reference to a new <code>err</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "edited": false, "score": 0, "creation_date": 1423039046, "post_id": 28315414, "comment_id": 44982721, "body": "Oh yeah, I can use type inference if I&#39;m in the top level scope. But I think when I now read the function it isn&#39;t as clear and is more lines of code. <a href=\"https://play.golang.org/p/0LY2V1fhjP\" rel=\"nofollow noreferrer\">play.golang.org/p/0LY2V1fhjP</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "edited": false, "score": 0, "creation_date": 1423039780, "post_id": 28315414, "comment_id": 44983103, "body": "@Neil Please see my edited answer. You were comparing the proposed code to an invalid and incomplete version of your code. Completing yours and modifying your proposed edit of the code changes the picture. But which one is more readable is not an objective question. But your original question was whether you can use type inference is solved with this code: this code doesn&#39;t include the type <code>*user.User</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1423040117, "last_edit_date": 1423040117, "creation_date": 1423033558, "answer_id": 28315414, "question_id": 28314691, "link": "https://stackoverflow.com/questions/28314691/go-type-inference-and-named-return-variables/28315414#28315414", "title": "Go type inference and named return variables", "body": "<p>You can if you slightly restructure your code and you don't put the <code>user.Current()</code> call in another block (<code>if</code> in your case), then you can do it with the <code>:=</code> <a href=\"http://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">Short variable declaration</a>:</p>\n\n<pre><code>func getConfigFilepath(userSuppliedFilepath string) (filepath string, err error) {\n    if userSuppliedFilepath != \"\" {\n        return userSuppliedFilepath, nil\n    }\n\n    usr, err := user.Current()\n    filepath = path.Join(usr.HomeDir, \".myprogram.config.json\")\n    return\n}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>You might say this code is longer than your original, but note that your original code is <em>not yet valid</em> and is also <em>incomplete</em> because it does not handle the case when <code>userSuppliedFilepath</code> is provided. You should compare the proposed code to the full and valid version of your code which is below:</p>\n\n<pre><code>func getConfigFilepath(userSuppliedFilepath string) (filepath string, err error) {\n    if userSuppliedFilepath == \"\" {\n        var usr *user.User\n        usr, err = user.Current()\n        filepath = path.Join(usr.HomeDir, \".myprogram.config.json\")\n    } else {\n        filepath = userSuppliedFilepath\n    }\n\n    return\n}\n</code></pre>\n\n<p>And now the proposed code isn't longer (on the contrary, it's a little shorter).</p>\n"}], "owner": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 28314879, "answer_count": 2, "score": 3, "last_activity_date": 1423040117, "creation_date": 1423030618, "question_id": 28314691, "link": "https://stackoverflow.com/questions/28314691/go-type-inference-and-named-return-variables", "title": "Go type inference and named return variables", "body": "<p>In Go if you give a name to the return variables they are initialised to their zero values when the function begins. I'm using this feature below with the <code>err</code> variable on the line <code>usr, err = user.Current()</code>. Is it possible to use type inference for <code>usr</code> variable and not for the <code>err</code> variable? I don't really want to declare <code>var usr *user.user</code> I would much rather use type inference here. </p>\n\n<pre><code>func getConfigFilepath(userSuppliedFilepath string) (filepath string, err error) {\n\n    if userSuppliedFilepath == \"\" {\n        usr, err = user.Current()\n        filepath = path.Join(usr.HomeDir, \".myprogram.config.json\")\n    }\n\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "goconvey"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1423027436, "post_id": 28313189, "comment_id": 44977939, "body": "Is your GOPATH symlinked."}], "answers": [{"comments": [{"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1423079041, "post_id": 28329980, "comment_id": 45007308, "body": "I&#39;ve opened a new issue on the github repository: <a href=\"https://github.com/smartystreets/goconvey/issues/309\" rel=\"nofollow noreferrer\">github.com/smartystreets/goconvey/issues/309</a>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1423080426, "post_id": 28329980, "comment_id": 45008059, "body": "I removed my answer .+1"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1423106919, "post_id": 28329980, "comment_id": 45017558, "body": "Given the misleading name of the const your intuition was spot on."}, {"owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "edited": false, "score": 1, "creation_date": 1423131418, "post_id": 28329980, "comment_id": 45027443, "body": "Thank you! Yeah would be good if the message was a little clearer.. Thanks for opening the issue"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1423151320, "post_id": 28329980, "comment_id": 45040514, "body": "I&#39;ve pushed a fix, which closed the issue I opened."}], "tags": [], "owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "is_accepted": true, "score": 3, "last_activity_date": 1423079192, "last_edit_date": 1423079192, "creation_date": 1423078857, "answer_id": 28329980, "question_id": 28313189, "link": "https://stackoverflow.com/questions/28313189/goconvey-please-run-goconvey-from-within-your-gopath-cannot-import-absolute-pat/28329980#28329980", "title": "goconvey Please run goconvey from within your $GOPATH cannot import absolute path", "body": "<p>All go code needs to be within <code>$GOPATH/src/</code> for the GoConvey UI to work.</p>\n\n<p>So, if your <code>$GOPATH</code> is set to</p>\n\n<pre><code>/Users/joe/Desktop/playground/go\n</code></pre>\n\n<p>then you will need to put your project at </p>\n\n<pre><code>/Users/joe/Desktop/playground/go/src/some-project\n</code></pre>\n\n<p>Your code is currently at</p>\n\n<pre><code>/Users/joe/Desktop/playground/go/some-project\n</code></pre>\n\n<p>Having said all that, the error message should probably be modified to read something like this:</p>\n\n<blockquote>\n  <p>Please run goconvey from within $GOPATH/src (also, symlinks might be problematic).</p>\n</blockquote>\n\n<p>The name of the variable referenced by @VonC is probably a slight misnomer in this case.</p>\n"}], "owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 2, "accepted_answer_id": 28329980, "answer_count": 1, "score": 2, "last_activity_date": 1436562820, "creation_date": 1423021843, "last_edit_date": 1436562820, "question_id": 28313189, "link": "https://stackoverflow.com/questions/28313189/goconvey-please-run-goconvey-from-within-your-gopath-cannot-import-absolute-pat", "title": "goconvey Please run goconvey from within your $GOPATH cannot import absolute path", "body": "<p>I'm setting up go and trying to get a simple project working with <a href=\"http://goconvey.co/\" rel=\"nofollow\">http://goconvey.co/</a> </p>\n\n<p>I have my $GOPATH set to /Users/joe/Desktop/playground/go</p>\n\n<p>and when I run</p>\n\n<blockquote>\n  <p>$ go get github.com/smartystreets/goconvey</p>\n</blockquote>\n\n<p>it downloads all good to my GOPATH</p>\n\n<p>so when I create a project here\n/Users/joe/Desktop/playground/go/some-project</p>\n\n<p>and run goconvey I get </p>\n\n<pre><code>2015/02/04 14:41:05 shell.go:93: Please run goconvey from within your $GOPATH\n</code></pre>\n\n<p>My testing code is</p>\n\n<pre><code>package main\n\nimport (\n    . \"github.com/smartystreets/goconvey/convey\"\n    \"testing\"\n)\n\nfunc TestStuff(t *testing.T) {\n    Convey(\"Truth\", t, func() {\n        Convey(\"is falsey\", func() {\n            So(false, ShouldBeFalse)\n        })\n    })\n\n}\n</code></pre>\n\n<p>I don't know why it connot find the files.\nWhen I run go test it works perfectly.\nHelp?</p>\n"}, {"tags": ["xml", "struct", "go"], "answers": [{"comments": [{"owner": {"reputation": 11762, "user_id": 14540, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c4ceadae4f61dac8ff3ababc3faa6c42?s=128&d=identicon&r=PG", "display_name": "kolrie", "link": "https://stackoverflow.com/users/14540/kolrie"}, "edited": false, "score": 0, "creation_date": 1423051618, "post_id": 28318573, "comment_id": 44990085, "body": "Thanks! What I ended up doing was using a regexp to replace <code>&lt;value type=&quot;item&quot;&gt;..&lt;&#47;values&gt;</code> with <code>&lt;item&gt;..&lt;&#47;item&gt;</code>. Here&#39;s the code I used: <a href=\"https://gist.github.com/fcoury/355f6f8ef7fb7655afab\" rel=\"nofollow noreferrer\">gist.github.com/fcoury/355f6f8ef7fb7655afab</a>"}], "tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": true, "score": 1, "last_activity_date": 1423044353, "creation_date": 1423044353, "answer_id": 28318573, "question_id": 28311908, "link": "https://stackoverflow.com/questions/28311908/different-structs-for-same-xml-tag-with-different-attributes/28318573#28318573", "title": "Different structs for same XML tag with different attributes", "body": "<p>I do not think it is possible to directly map a list of items discriminated by an attribute value to specific fields. You need to map it to a slice, like in the following example (Items slice):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    type Item struct {\n        Type string `xml:\"type,attr\"`\n        Value string `xml:\",chardata\"`\n    }\n\n    type Something struct {\n        XMLName xml.Name `xml:\"something\"`\n        Name string `xml:\"name\"`\n        Items []Item `xml:\"value\"`\n    }\n\n    var v Something\n\n    data := `\n    &lt;something&gt;\n        &lt;name&gt; toto &lt;/name&gt;\n        &lt;value type=\"item\"&gt; my item &lt;/value&gt;\n        &lt;value type=\"other\"&gt; my other value &lt;/value&gt;\n    &lt;/something&gt;\n    `\n    err := xml.Unmarshal([]byte(data), &amp;v)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        return\n    }\n\n    fmt.Println(v)\n}\n</code></pre>\n\n<p>Up to you to process the slice after the decoding to extract the values and put them in specific fields if needed.</p>\n"}], "owner": {"reputation": 11762, "user_id": 14540, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c4ceadae4f61dac8ff3ababc3faa6c42?s=128&d=identicon&r=PG", "display_name": "kolrie", "link": "https://stackoverflow.com/users/14540/kolrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 28318573, "answer_count": 1, "score": 1, "last_activity_date": 1423044353, "creation_date": 1423013017, "question_id": 28311908, "link": "https://stackoverflow.com/questions/28311908/different-structs-for-same-xml-tag-with-different-attributes", "title": "Different structs for same XML tag with different attributes", "body": "<p>Let's say I have this XML:</p>\n\n<pre><code>&lt;something&gt;\n  &lt;value type=\"item\"&gt;\n    ...\n  &lt;/value&gt;\n  &lt;value type=\"other\"&gt;\n    ...\n  &lt;/value&gt;\n&lt;/something&gt;\n</code></pre>\n\n<p>Can I somehow extract the value with different attributes to different items on my struct, like:</p>\n\n<pre><code>type Something struct {\n  Item  Item  `xml:\"value[type=item]\"` // metacode\n  Other Other `xml:\"value[type=other]\"`\n}\n</code></pre>\n\n<p>Is it possible? What should I use as the xml: attribute?</p>\n"}, {"tags": ["go", "gzip"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1423003986, "post_id": 28309988, "comment_id": 44971544, "body": "Makes me wonder if something outside this code is faulty--garbled text from a gzip reader is definitely something I don&#39;t expect. (Edit: whoops, that &quot;don&#39;t&quot; is important. :) )"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1423004293, "post_id": 28309988, "comment_id": 44971680, "body": "The code looks correct to me.  I recommend <code>contentType == &quot;application&#47;x-gzip&quot;</code>  instead of strings.Contains."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1423015580, "post_id": 28309988, "comment_id": 44974945, "body": "If the compressed stream itself were corrupted I&#39;d expect you to get a CRC error; could be something before compression or after decompression--anyway, I fear there may not be enough information here to solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 5624, "user_id": 437277, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/20a6c2f5052087c9896a07604a5f9c5d?s=128&d=identicon&r=PG", "display_name": "sparrovv", "link": "https://stackoverflow.com/users/437277/sparrovv"}, "is_accepted": false, "score": 4, "last_activity_date": 1501328802, "last_edit_date": 1501328802, "creation_date": 1423086156, "answer_id": 28332019, "question_id": 28309988, "link": "https://stackoverflow.com/questions/28309988/how-to-read-from-either-gzip-or-plain-text-reader-in-golang/28332019#28332019", "title": "How to read from either gzip or plain text reader in golang?", "body": "<p>You can detect that a file is gziped by checking if the first 2 bytes are equal to <code>0x1f8b</code> (I found that information <a href=\"https://stackoverflow.com/questions/6059302/how-to-check-if-a-file-is-gzip-compressed\">here</a>). </p>\n\n<p>In comments someone mentioned that you should check these bytes separately, so the first one is <code>0x1f</code> and the second is <code>0x8b</code>.</p>\n\n<pre><code>testBytes, err := bReader.Peek(2) //read 2 bytes\n....\nif testBytes[0] == 31 &amp;&amp; testBytes[1] == 139 {\n    //gzip\n}else{\n   ...\n}\n</code></pre>\n\n<p>Hope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 2225493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7134663e223da0dc6c1d20fd9dd7a46f?s=128&d=identicon&r=PG", "display_name": "homesalad", "link": "https://stackoverflow.com/users/2225493/homesalad"}, "is_accepted": false, "score": 0, "last_activity_date": 1423107996, "creation_date": 1423107996, "answer_id": 28335871, "question_id": 28309988, "link": "https://stackoverflow.com/questions/28309988/how-to-read-from-either-gzip-or-plain-text-reader-in-golang/28335871#28335871", "title": "How to read from either gzip or plain text reader in golang?", "body": "<p>Thanks everyone - turns out that twotwotwo and thundercat were correct, and the stream was getting corrupted in a spot unrelated to the code I posted. Weirdly, it seems to be related to writing to the http response while still reading from the request stream. I'm still investigating it, but it seems the original question was misguided.  </p>\n"}], "owner": {"reputation": 359, "user_id": 2225493, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7134663e223da0dc6c1d20fd9dd7a46f?s=128&d=identicon&r=PG", "display_name": "homesalad", "link": "https://stackoverflow.com/users/2225493/homesalad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3076, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1501328802, "creation_date": 1423002519, "question_id": 28309988, "link": "https://stackoverflow.com/questions/28309988/how-to-read-from-either-gzip-or-plain-text-reader-in-golang", "title": "How to read from either gzip or plain text reader in golang?", "body": "<p>I'm writing a small webapp in golang, and it involves parsing a file uploaded by the user. I'd like to auto-detect if the file is gzipped or not and create readers / scanners appropriately. One twist is that I can't read the whole file into memory, I can only operate on the stream alone. Here's what I've got: </p>\n\n<pre><code>func scannerFromFile(reader io.Reader) (*bufio.Scanner, error) {\n\nvar scanner *bufio.Scanner\n//create a bufio.Reader so we can 'peek' at the first few bytes\nbReader := bufio.NewReader(reader)\n\ntestBytes, err := bReader.Peek(64) //read a few bytes without consuming\nif err != nil {\n    return nil, err\n}\n//Detect if the content is gzipped\ncontentType := http.DetectContentType(testBytes)\n\n//If we detect gzip, then make a gzip reader, then wrap it in a scanner\nif strings.Contains(contentType, \"x-gzip\") {\n    gzipReader, err := gzip.NewReader(bReader)\n    if (err != nil) {\n        return nil, err\n    }\n\n    scanner = bufio.NewScanner(gzipReader)\n\n} else {\n    //Not gzipped, just make a scanner based on the reader\n    scanner = bufio.NewScanner(bReader)\n}\n\nreturn scanner, nil\n}\n</code></pre>\n\n<p>This works fine for plain text, but for gzipped data it inflates incorrectly, and after a few kb I inevitably get garbled text. Is there a simpler method out there? Any ideas why after a few thousand lines it uncompresses incorrectly? </p>\n"}, {"tags": ["xml", "parsing", "soap", "go"], "answers": [{"comments": [{"owner": {"reputation": 1571, "user_id": 1587118, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cBN8s.jpg?s=128&g=1", "display_name": "SRC", "link": "https://stackoverflow.com/users/1587118/src"}, "edited": false, "score": 0, "creation_date": 1423054130, "post_id": 28308318, "comment_id": 44991445, "body": "well I solved it for now. And I think that I understood the XML parsing better while doing so. Thanks for the pointers anyway."}], "tags": [], "owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "is_accepted": false, "score": 0, "last_activity_date": 1422996043, "creation_date": 1422996043, "answer_id": 28308318, "question_id": 28308100, "link": "https://stackoverflow.com/questions/28308100/golang-with-soap/28308318#28308318", "title": "golang with SOAP", "body": "<p>Self promotion: <a href=\"https://github.com/kylewolfe/simplexml\" rel=\"nofollow\">https://github.com/kylewolfe/simplexml</a> (under development but I have used it for a few projects). Also, this will help you understand what's going in / out: <a href=\"https://github.com/ernesto-jimenez/httplogger\" rel=\"nofollow\">https://github.com/ernesto-jimenez/httplogger</a></p>\n\n<p>What you have printed is an empty struct (with default values) that has failed to unmarshal correctly, most likely due to namespace issues.</p>\n"}], "owner": {"reputation": 1571, "user_id": 1587118, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cBN8s.jpg?s=128&g=1", "display_name": "SRC", "link": "https://stackoverflow.com/users/1587118/src"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3518, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437170416, "creation_date": 1422995159, "last_edit_date": 1437170416, "question_id": 28308100, "link": "https://stackoverflow.com/questions/28308100/golang-with-soap", "title": "golang with SOAP", "body": "<p>Bellow is the code </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/xml\"\n)\n\ntype Return struct {\n    RequestId int\n    DataCenterId string\n    DataCenterVersion int\n    StorageId string\n}\n\ntype StorageReturn struct{\n    Ret  Return `xml:\"return\"`\n}\n\ntype Body struct {\n    StrgRet StorageReturn `xml:\"ns:createStorageReturn\"`\n}\n\ntype StorageResponse struct{\n    XMLName xml.Name\n    RespBody Body `xml:\"S:Body\"`\n}\n\n\nfunc main(){\n   s = `&lt;?xml version='1.0' encoding='UTF-8'?&gt;&lt;S:Envelope xmlns:S=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;&lt;S:Body&gt;&lt;ns2:createStorageReturn xmlns:ns2=\"http://ws.api.mysite.com/\"&gt;&lt;return&gt;&lt;requestId&gt;16660663&lt;/requestId&gt;&lt;dataCenterId&gt;ssrr-444tt-yy-99&lt;/dataCenterId&gt;&lt;dataCenterVersion&gt;12&lt;/dataCenterVersion&gt;&lt;storageId&gt;towrrt24903FR55405&lt;/storageId&gt;&lt;/return&gt;&lt;/ns2:createStorageReturn&gt;&lt;/S:Body&gt;&lt;/S:Envelope&gt;`\n\n    parser := xml.NewDecoder(bytes.NewBufferString(s))\n    envelope := new(StorageResponse)\n    err = parser.DecodeElement(&amp;envelope, nil)\n    if err != nil {\n        fmt.Printf(\"Error in parsing\")\n        fmt.Printf(\"%v\", err)\n        return\n    }\n    fmt.Printf(\"%+v\", envelope)\n}\n</code></pre>\n\n<p>It does print this ---</p>\n\n<p>{XMLName:{Space:<a href=\"http://schemas.xmlsoap.org/soap/envelope/\" rel=\"nofollow\">http://schemas.xmlsoap.org/soap/envelope/</a> Local:Envelope} RespBody:{StrgRet:{Ret:{RequestId:0 DataCenterId: DataCenterVersion:0 StorageId:}}}}</p>\n\n<p>no idea  why. </p>\n\n<p>I am bad at xml parsing and i do not understand what i am doing wrong. For further reference I mention here that this is a response from a SOAP call that I want to parse. The calling and receiving parts are omitted as they are working fine and no problem. Problem is just the parsing of the return XML.</p>\n\n<p>Please help me.</p>\n\n<p>Thanks in advance</p>\n\n<p>As per request of Goku. Here is a working version of the code I posted above </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/xml\"\n)\n\ntype Return struct {\n    RequestId int `xml:\"requestId\"`\n    DataCenterId string `xml:\"dataCenterId\"`\n    DataCenterVersion int `xml:\"dataCenterVersion\"`\n    StorageId string `xml:\"storageId\"`\n}\n\ntype StorageReturn struct{\n    Ret  Return `xml:\"return\"`\n}\n\ntype Body struct {\n    StrgRet StorageReturn `xml:\"createStorageReturn\"`\n}\n\ntype StorageResponse struct{\n    XMLName xml.Name `xml:\"Envelope\"`\n    RespBody Body `xml:\"Body\"`\n}\n\n\nfunc main(){\n   s := `&lt;?xml version='1.0' encoding='UTF-8'?&gt;&lt;S:Envelope xmlns:S=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;&lt;S:Body&gt;&lt;ns2:createStorageReturn xmlns:ns2=\"http://ws.api.mysite.com/\"&gt;&lt;return&gt;&lt;requestId&gt;16660663&lt;/requestId&gt;&lt;dataCenterId&gt;ssrr-444tt-yy-99&lt;/dataCenterId&gt;&lt;dataCenterVersion&gt;12&lt;/dataCenterVersion&gt;&lt;storageId&gt;towrrt24903FR55405&lt;/storageId&gt;&lt;/return&gt;&lt;/ns2:createStorageReturn&gt;&lt;/S:Body&gt;&lt;/S:Envelope&gt;`\n\n    v := StorageResponse{}  \n    err := xml.Unmarshal([]byte(s), &amp;v)\n    if err != nil{\n        fmt.Println(err)\n    }\n    fmt.Printf(\"%+v\", v)\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 2, "creation_date": 1422994435, "post_id": 28307829, "comment_id": 44966603, "body": "Can you explain why in my first example <code>my_func</code> finishes before main ends, but not in the second example?"}, {"owner": {"reputation": 1736, "user_id": 130554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1affa5f0b72a1a76c8b72bc0ccc6f552?s=128&d=identicon&r=PG", "display_name": "Digikata", "link": "https://stackoverflow.com/users/130554/digikata"}, "edited": false, "score": 0, "creation_date": 1422994456, "post_id": 28307829, "comment_id": 44966621, "body": "I think this is the right answer, but might be better if some info was added re: a way (or ways) to get the example code to wait ..."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1422996124, "post_id": 28307829, "comment_id": 44967525, "body": "Added explanation and an example how to make sure the value sent on the channel gets printed."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1422996308, "post_id": 28307829, "comment_id": 44967628, "body": "I think I get it, but I want to make sure. Is my understanding correct: &quot;both first and second example, my goroutine might or might not be able to complete before main finishes, and the fact that it happens in first example and not second is just pure chance."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 4, "creation_date": 1422996430, "post_id": 28307829, "comment_id": 44967694, "body": "@Akavall Yes, in both of those cases the value might or might not get printed. Note that on the Go Playground the results of programs are cached. So if in one case it gets printed, running the same program will always print it (until someone deletes the output caches of the programs)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1423030868, "last_edit_date": 1423030868, "creation_date": 1422994218, "answer_id": 28307829, "question_id": 28307783, "link": "https://stackoverflow.com/questions/28307783/goroutine-does-not-execute-if-time-sleep-included/28307829#28307829", "title": "Goroutine does not execute if time.Sleep included", "body": "<p>When the <code>main</code> function ends, the program ends with it. It does not wait for other goroutines to finish.</p>\n\n<p>Quoting from the <a href=\"http://golang.org/ref/spec#Program_execution\" rel=\"noreferrer\">Go Language Specification: Program Execution</a>:</p>\n\n<blockquote>\n  <p>Program execution begins by initializing the main package and then invoking the function <code>main</code>. When that function invocation returns, the program exits. It does not wait for other (non-<code>main</code>) goroutines to complete.</p>\n</blockquote>\n\n<p>So simply when your <code>main</code> function succeeds by sending the value on the channel, the program might terminate immediately, before the other goroutine has the chance to print the received value to the console.</p>\n\n<p>If you want to make sure the value gets printed to the console, you have to synchronize it with the event of exiting from the <code>main</code> function:</p>\n\n<p>Example with a \"done\" channel (try it on <a href=\"https://play.golang.org/p/539XE6MxvN\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>func my_func(c, done chan int) {\n    fmt.Println(&lt;-c)\n    done &lt;- 1\n}\n\nfunc main() {\n    c := make(chan int)\n    done := make(chan int)\n    go my_func(c, done)\n\n    time.Sleep(time.Second)\n    c &lt;- 3\n    &lt;-done\n}\n</code></pre>\n\n<p>Since <code>done</code> is also an unbuffered channel, receiving from it at the end of the <code>main</code> function must wait the sending of a value on the <code>done</code> channel, which happens after the value sent on channel <code>c</code> has been received and printed to the console.</p>\n\n<p><strong>Explanation for the seemingly non-deterministic runs:</strong></p>\n\n<p>Goroutines may or may not be executed parallel <em>at the same time</em>. Synchronization ensures that certain events happen before other events. That is the only guarantee you get, and the only thing you should rely on.\n2 examples of this <em>Happens Before</em>:</p>\n\n<blockquote>\n  <ul>\n  <li>The <code>go</code> statement that starts a new goroutine happens before the goroutine's execution begins.</li>\n  <li>A send on a channel happens before the corresponding receive from that channel completes.</li>\n  </ul>\n</blockquote>\n\n<p>For more details read <a href=\"http://golang.org/ref/mem\" rel=\"noreferrer\"><strong>The Go Memory Model</strong></a>.</p>\n\n<p><strong>Back to your example:</strong></p>\n\n<blockquote>\n  <p>A receive from an unbuffered channel happens before the send on that channel completes.</p>\n</blockquote>\n\n<p>So the only guarantee you get is that the goroutine that runs <code>my_func()</code> will receive the value from channel <code>c</code> sent from <code>main()</code>. But once the value is received, the <code>main</code> function <em>may</em> continue but since there is no more statements after the send, it simply ends - along with the program. Whether the non-<code>main</code> goroutine will have <em>time</em> or <em>chance</em> to print it with <code>fmt.Println()</code> is <em>not defined</em>.</p>\n"}], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2389, "favorite_count": 3, "accepted_answer_id": 28307829, "answer_count": 1, "score": 11, "last_activity_date": 1475438900, "creation_date": 1422994042, "last_edit_date": 1475438900, "question_id": 28307783, "link": "https://stackoverflow.com/questions/28307783/goroutine-does-not-execute-if-time-sleep-included", "title": "Goroutine does not execute if time.Sleep included", "body": "<p>The following code runs perfectly fine:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc my_func(c chan int){\n    fmt.Println(&lt;-c)\n}\n\nfunc main(){\n    c := make(chan int)\n    go my_func(c)\n\n    c&lt;-3\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/A1iylDEsv1\">playgound_1</a></p>\n\n<p>However if I change</p>\n\n<pre><code>c&lt;-3\n</code></pre>\n\n<p>to</p>\n\n<pre><code>time.Sleep(time.Second)\nc&lt;-3\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ZjoYbY2xQ3\">playground_2</a></p>\n\n<p>My code does not execute.</p>\n\n<p>My gut feeling is that somehow <code>main</code> returns before the <code>my_func</code> finishes executing, but it seems like adding a pause should not have any effect. I am totally lost on this simple example, what's going on here?</p>\n"}, {"tags": ["go", "docker"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1422993006, "post_id": 28307234, "comment_id": 44965811, "body": "I think you forgot to finish your question."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1422995843, "post_id": 28307234, "comment_id": 44967363, "body": "Try to move the statements from your <code>init()</code> function to your <code>main()</code> function and see if it works."}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1423001731, "creation_date": 1423001731, "answer_id": 28309799, "question_id": 28307234, "link": "https://stackoverflow.com/questions/28307234/cross-compile-net-http-for-distribution/28309799#28309799", "title": "Cross compile net/http for distribution", "body": "<p>The answer is most probably the one described in <a href=\"https://inconshreveable.com/04-30-2014/cross-compiling-golang-programs-with-native-libraries/\" rel=\"nofollow\">this article</a>.</p>\n\n<blockquote>\n  <p>Some critical parts of the standard library use CGO [...] if you cross-compile Go to Darwin or Linux your programs won\u2019t use the system DNS resolver. They also can\u2019t use the native host certificate store. They also can\u2019t look up the user\u2019s home directory, either.</p>\n</blockquote>\n\n<p>And CGO links against some standard system interfaces by default, dynamically.</p>\n\n<p>The article suggests using <a href=\"https://github.com/inconshreveable/gonative\" rel=\"nofollow\">gonative</a> to fix the problem. If that's not your cup of tea, some people suggest using:</p>\n\n<pre><code>go build -ldflags \"-linkmode external -extldflags -static\" \n</code></pre>\n\n<p>Also read: <a href=\"https://groups.google.com/d/topic/golang-nuts/H-NTwhQVp-8/discussion\" rel=\"nofollow\">https://groups.google.com/d/topic/golang-nuts/H-NTwhQVp-8/discussion</a></p>\n"}, {"tags": [], "owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "is_accepted": false, "score": 1, "last_activity_date": 1423007729, "creation_date": 1423007729, "answer_id": 28311075, "question_id": 28307234, "link": "https://stackoverflow.com/questions/28307234/cross-compile-net-http-for-distribution/28311075#28311075", "title": "Cross compile net/http for distribution", "body": "<p>I think you need to disable cgo and build with <code>netgo</code> flag :</p>\n\n<blockquote>\n  <p>The net package requires cgo by default because the host operating\n  system must in general mediate network call setup. On some systems,\n  though, it is possible to use the network without cgo, and useful to\n  do so, for instance to avoid dynamic linking. The new build tag netgo\n  (off by default) allows the construction of a net package in pure Go\n  on those systems where it is possible.</p>\n</blockquote>\n\n<p>The <code>netgo</code> tag requires version <a href=\"https://golang.org/doc/go1.2\" rel=\"nofollow\">1.2 and above</a>.</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1423050838, "creation_date": 1422992029, "last_edit_date": 1592644375, "question_id": 28307234, "link": "https://stackoverflow.com/questions/28307234/cross-compile-net-http-for-distribution", "title": "Cross compile net/http for distribution", "body": "<p>I have build the following code in a docker container with the following architecture:<br>\ncat /proc/version\nLinux version 3.16.7-tinycore64 (root@064f0e1ce709) (gcc version 4.7.2 (Debian 4.7.2-5) ) #1 SMP Tue Dec 16 23:03:39 UTC 2014</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc main() {\n    fmt.Println(&quot;Hello&quot;)\n}\n</code></pre>\n<p>The binary distributed, runs with no problem on a busybox container, with the same architecture without installing golang.<br></p>\n<br>\n<h1>The problem</h1>\n<p>When I do the same for the following code:<br></p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;net/http&quot;\n)\n\nconst (\n    port = &quot;:80&quot;\n)\n\nvar calls = 0\n\nfunc HelloWorld(w http.ResponseWriter, r *http.Request) {\n    calls++\n    fmt.Fprintf(w, &quot;Hello, world! You have called me %d times.\\n&quot;, calls)\n}\n\nfunc init() {\n    fmt.Printf(&quot;Started server at http://localhost%v.\\n&quot;, port)\n    http.HandleFunc(&quot;/&quot;, HelloWorld)\n    http.ListenAndServe(port, nil)\n}\n\nfunc main() {}\n</code></pre>\n<p>Then I get:<br>\nash: ./hello_world: not found <br></p>\n<p>I might be missing some dependencies - like &quot;net/http&quot;?<br>\nBut I thought the go build would build all into the binaries.<br>\nThis is for both go build &amp; go install.</p>\n<p>Any idea?</p>\n"}, {"tags": ["go", "docker"], "answers": [{"tags": [], "owner": {"reputation": 38746, "user_id": 4332, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/11e0717b37120636599e19dfc789b193?s=128&d=identicon&r=PG", "display_name": "Adrian Mouat", "link": "https://stackoverflow.com/users/4332/adrian-mouat"}, "is_accepted": true, "score": 2, "last_activity_date": 1422987409, "last_edit_date": 1422987409, "creation_date": 1422986980, "answer_id": 28305815, "question_id": 28302557, "link": "https://stackoverflow.com/questions/28302557/building-small-container-for-running-compiled-go-code/28305815#28305815", "title": "Building small container for running compiled go code", "body": "<p>I'm not sure I entirely follow.</p>\n\n<p>The Dockerfile from the linked project builds an image with nothing in it except an executable - there will be no shell or compiler, so running bash will be impossible. It does this by using the special <code>scratch</code> base image, which is simply a completely empty filesystem.</p>\n\n<p>If you clone the repository and build the image using the Dockerfile (<code>docker build -t go-image .</code>), it will simply copy the executable directly into the image (note the Dockerfile copies the executable <code>true-asm</code>, not the source code <code>true.go</code>). If you then use <code>docker run</code> to start the image, it will run it (<code>docker run go-image</code>).</p>\n\n<p>Does that make sense? The code is compiled locally (or by another container) and the compiled, stand-alone executable is placed by itself into the image.</p>\n\n<p>Generally, you don't want to do this and definitely not when you're beginning - it will be easier for you to use a <code>golang</code> or <code>debian</code> image which will include basic tools such as a shell.</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 28305815, "answer_count": 1, "score": 0, "last_activity_date": 1422987409, "creation_date": 1422977145, "question_id": 28302557, "link": "https://stackoverflow.com/questions/28302557/building-small-container-for-running-compiled-go-code", "title": "Building small container for running compiled go code", "body": "<p>From \n<a href=\"https://docs.docker.com/articles/baseimages/\" rel=\"nofollow\">https://docs.docker.com/articles/baseimages/</a></p>\n\n<p>I am trying to build a base image to run compiled go code, from:\n<a href=\"https://github.com/tianon/dockerfiles/tree/master/true\" rel=\"nofollow\">https://github.com/tianon/dockerfiles/tree/master/true</a></p>\n\n<ol>\n<li>I have tried to copy into docker the true.go<br>Then: exec: \"/true\": permission denied </li>\n<li>Also tried to bash into it, then: \"bash\"<br>Then: executable file not found in $PATH</li>\n<li>Also tried to use the debootstrap raring raring > /dev/null <br> Then: \"bash\": executable file not found in $PATH</li>\n</ol>\n\n<p>How do you do this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["concurrency", "go"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1422975549, "post_id": 28301847, "comment_id": 44955187, "body": "It is recommend to run middlwares in their goroutine?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1422975807, "post_id": 28301847, "comment_id": 44955366, "body": "@zero_coding I wouldn&#39;t. I doubt negroni had this use case in in mind."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1422976014, "post_id": 28301847, "comment_id": 44955521, "body": "Running middlwares in their goroutine is so fast, really fast."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1422976290, "post_id": 28301847, "comment_id": 44955743, "body": "@zero_coding Then just make sure you setup a mutex around your shared memory in <code>security.ServeHttp</code> and <code>session.ServeHttp</code>"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 1, "last_activity_date": 1422975173, "creation_date": 1422975173, "answer_id": 28301847, "question_id": 28301402, "link": "https://stackoverflow.com/questions/28301402/a-lot-of-data-race-web-application/28301847#28301847", "title": "A lot of data race web application", "body": "<p>It's the fact that you're running the middleware within a goroutine that is the problem.</p>\n\n<p>If you want to run your middleware in parallel you will have to set up a <a href=\"http://golang.org/pkg/sync/#Mutex\" rel=\"nofollow\">mutex</a> around the memory that is written to by any middleware executed within a goroutine. </p>\n\n<p>In your particular case you are both writing and reading from the <code>ResponseWriter</code>'s <code>Header</code></p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 28301847, "answer_count": 1, "score": 0, "last_activity_date": 1422975173, "creation_date": 1422973937, "question_id": 28301402, "link": "https://stackoverflow.com/questions/28301402/a-lot-of-data-race-web-application", "title": "A lot of data race web application", "body": "<p>I am writing a web application. Incoming requests will pass through middlewares first. At the moment, I've added two middlwares session and security.<br>\nAfter walked through middlwares, it will execute the handler for the request.\nSession and security middlwares will execute in their own goroutine.</p>\n\n<p>When I am testing I've got a lot of data race, specially in middlware section</p>\n\n<pre><code>WARNING: DATA RACE\nWrite by goroutine 18:\n  runtime.mapassign1()\n      c:/go/src/runtime/hashmap.go:383 +0x0\n  net/textproto.MIMEHeader.Set()\n      c:/go/src/net/textproto/header.go:22 +0xf4\n  net/http.Header.Set()\n      c:/go/src/net/http/header.go:31 +0x64\n  project/middlewares/session.(*ctrl).setHttpHeader()\n      D:/gocode/src/project/middlewares/session/ctrl.go:76 +0x9d\n  project/middlewares/session.(*ctrl).evaluateJwt()\n      D:/gocode/src/project/middlewares/session/ctrl.go:56 +0x31a\n  project/middlewares/session.(*ctrl).serveHttp()\n      D:/gocode/src/project/middlewares/session/ctrl.go:94 +0x8a\n  project/middlewares/session.func\u252c\u00c0006()\n      D:/gocode/src/project/middlewares/session/serve_http.go:23 +0x\n\nPrevious write by goroutine 17:\n  runtime.mapassign1()\n      c:/go/src/runtime/hashmap.go:383 +0x0\n  net/textproto.MIMEHeader.Add()\n      c:/go/src/net/textproto/header.go:15 +0x212\n  net/http.Header.Add()\n      c:/go/src/net/http/header.go:24 +0x64\n  github.com/unrolled/secure.(*Secure).Process()\n      D:/gocode/src/github.com/unrolled/secure/secure.go:177 +0xe5b\n  project/middlewares/security.func\u252c\u00c0001()\n      D:/gocode/src/project/middlewares/security/serve_http.go:33 +0\n\nGoroutine 18 (running) created at:\n  project/middlewares/session.ServeHttp()\n      D:/gocode/src/project/middlewares/session/serve_http.go:29 +0x\n  project/middlewares.New()\n      D:/gocode/src/project/middlewares/ctrl.go:12 +0x99\n  github.com/codegangsta/negroni.HandlerFunc.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:24 +0x5f\n  github.com/codegangsta/negroni.middleware.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x114\n  github.com/codegangsta/negroni.middleware.ServeHTTP\u252c\u00c0fm()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x84\n  github.com/codegangsta/negroni.(*Static).ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/static.go:30 +0xb71\n  github.com/codegangsta/negroni.middleware.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x114\n  github.com/codegangsta/negroni.middleware.ServeHTTP\u252c\u00c0fm()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x84\n  github.com/codegangsta/negroni.(*Logger).ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/logger.go:25 +0x249\n  github.com/codegangsta/negroni.middleware.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x114\n  github.com/codegangsta/negroni.middleware.ServeHTTP\u252c\u00c0fm()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x84\n  github.com/codegangsta/negroni.(*Recovery).ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/recovery.go:45 +0xd9\n  github.com/codegangsta/negroni.middleware.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x114\n  github.com/codegangsta/negroni.(*Negroni).ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:73 +0x1c7\n  net/http/httptest.(*waitGroupHandler).ServeHTTP()\n      c:/go/src/net/http/httptest/server.go:200 +0xfe\n  net/http.serverHandler.ServeHTTP()\n      c:/go/src/net/http/server.go:1703 +0x1fd\n  net/http.(*conn).serve()\n      c:/go/src/net/http/server.go:1204 +0x108e\n\nGoroutine 17 (finished) created at:\n  project/middlewares/security.ServeHttp()\n      D:/gocode/src/project/middlewares/security/serve_http.go:37 +0\n  project/middlewares.New()\n      D:/gocode/src/project/middlewares/ctrl.go:12 +0x64\n  github.com/codegangsta/negroni.HandlerFunc.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:24 +0x5f\n  github.com/codegangsta/negroni.middleware.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x114\n  github.com/codegangsta/negroni.middleware.ServeHTTP\u252c\u00c0fm()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x84\n  github.com/codegangsta/negroni.(*Static).ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/static.go:30 +0xb71\n  github.com/codegangsta/negroni.middleware.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x114\n  github.com/codegangsta/negroni.middleware.ServeHTTP\u252c\u00c0fm()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x84\n  github.com/codegangsta/negroni.(*Logger).ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/logger.go:25 +0x249\n  github.com/codegangsta/negroni.middleware.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x114\n  github.com/codegangsta/negroni.middleware.ServeHTTP\u252c\u00c0fm()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x84\n  github.com/codegangsta/negroni.(*Recovery).ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/recovery.go:45 +0xd9\n  github.com/codegangsta/negroni.middleware.ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:33 +0x114\n  github.com/codegangsta/negroni.(*Negroni).ServeHTTP()\n      D:/gocode/src/github.com/codegangsta/negroni/negroni.go:73 +0x1c7\n  net/http/httptest.(*waitGroupHandler).ServeHTTP()\n      c:/go/src/net/http/httptest/server.go:200 +0xfe\n  net/http.serverHandler.ServeHTTP()\n      c:/go/src/net/http/server.go:1703 +0x1fd\n  net/http.(*conn).serve()\n      c:/go/src/net/http/server.go:1204 +0x108e\n==================\n2015/02/03 15:05:31 ctrl.go:17: End of process middlewares\n2015/02/03 15:05:31 funcs.go:10: Create new user\n2015/02/03 15:05:31 validate.go:14: Validate email thompson@example.com\n2015/02/03 15:05:31 validate.go:100: Validate password Test!1234\n2015/02/03 15:05:31 validate.go:52: Validate name:  ValidName\n2015/02/03 15:05:31 create.go:120: Done\n[negroni] Completed 0  in 197ms\nPASS\nok      project/testing/account_test 0.664s\nPS D:\\gocode\\src\\project\\testing\\account_test&gt; go test -race\n2015/02/03 15:08:10 vs.go:50: Connect to neo4j db.\n[negroni] Started POST /user\n==================\nWARNING: DATA RACE\nWrite by goroutine 18:\n  net/http.(*response).Header()\n      c:/go/src/net/http/server.go:615 +0x11a\n  github.com/codegangsta/negroni.(*responseWriter).Header()\n      &lt;autogenerated&gt;:42 +0x78\n  project/middlewares/session.(*ctrl).setHttpHeader()\n      D:/gocode/src/project/middlewares/session/ctrl.go:76 +0x68\n  project/middlewares/session.(*ctrl).evaluateJwt()\n      D:/gocode/src/project/middlewares/session/ctrl.go:56 +0x31a\n  project/middlewares/session.(*ctrl).serveHttp()\n      D:/gocode/src/project/middlewares/session/ctrl.go:94 +0x8a\n  project/middlewares/session.func\u252c\u00c0006()\n      D:/gocode/src/project/middlewares/session/serve_http.go:23 +0x\n\nPrevious write by goroutine 17:\n  net/http.(*response).Header()\n      c:/go/src/net/http/server.go:615 +0x11a\n  github.com/codegangsta/negroni.(*responseWriter).Header()\n      &lt;autogenerated&gt;:42 +0x78\n  github.com/unrolled/secure.(*Secure).Process()\n      D:/gocode/src/github.com/unrolled/secure/secure.go:177 +0xe24\n  project/middlewares/security.func\u252c\u00c0001()\n      D:/gocode/src/project/middlewares/security/serve_http.go:33 +0\n</code></pre>\n\n<p>I use negroni to process middlwares works. </p>\n\n<p>The way, how I process middlwares</p>\n\n<pre><code>func New(res http.ResponseWriter, req *http.Request, next http.HandlerFunc) {\n\n    if err := process(security.ServeHttp(res, req), session.ServeHttp(res, req)); err != nil {\n        res.WriteHeader(http.StatusInternalServerError)\n        return\n    }\n\n    log.Println(\"End of process middlewares\")\n    next(res, req)\n\n}\n\n// Process all middlewares\nfunc process(chErrs ...&lt;-chan error) error {\n\n    for _, chErr := range chErrs {\n\n        // Will abort the loop, when error occurs\n        if err := &lt;-chErr; err != nil {\n            return err\n        }\n\n    }\n    return nil\n}\n</code></pre>\n\n<p>As you can see, every middlware have they own channel. The for statement will loop until the error channel is closed or error send.</p>\n\n<p>The server configuration</p>\n\n<pre><code>func Config() *negroni.Negroni {\n    n := negroni.Classic()\n    n.Use(negroni.HandlerFunc(middlewares.New))\n    n.UseHandler(routes.Set())\n    return n\n\n}\n</code></pre>\n\n<p>My question is, are the middlewares the reason, why I've got the data race?</p>\n"}, {"tags": ["go", "deadlock", "goroutine"], "comments": [{"owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "edited": false, "score": 0, "creation_date": 1422972926, "post_id": 28300581, "comment_id": 44953387, "body": "We need to see source for runTheCommand() which is reading from your channel(s), but my suspicion is that your not using a wait group, or using it incorrectly."}, {"owner": {"reputation": 1957, "user_id": 2094708, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nIQKY.jpg?s=128&g=1", "display_name": "Sidharth C. Nadhan", "link": "https://stackoverflow.com/users/2094708/sidharth-c-nadhan"}, "reply_to_user": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "edited": false, "score": 0, "creation_date": 1422973431, "post_id": 28300581, "comment_id": 44953707, "body": "hi kwolfe, I have pasted the functions I used. Kindly help me."}], "answers": [{"comments": [{"owner": {"reputation": 1957, "user_id": 2094708, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nIQKY.jpg?s=128&g=1", "display_name": "Sidharth C. Nadhan", "link": "https://stackoverflow.com/users/2094708/sidharth-c-nadhan"}, "edited": false, "score": 0, "creation_date": 1422976621, "post_id": 28301545, "comment_id": 44955956, "body": "thanks a lot, kwolfe. I added close(ch) as the last command in my &quot;runTheCommand&quot; function and it resolved the error :)"}, {"owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "reply_to_user": {"reputation": 1957, "user_id": 2094708, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nIQKY.jpg?s=128&g=1", "display_name": "Sidharth C. Nadhan", "link": "https://stackoverflow.com/users/2094708/sidharth-c-nadhan"}, "edited": false, "score": 0, "creation_date": 1422976717, "post_id": 28301545, "comment_id": 44956029, "body": "I would still have a look at your design, though. I don&#39;t see why a slice of chan would be necessary."}], "tags": [], "owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "is_accepted": true, "score": 2, "last_activity_date": 1422974356, "creation_date": 1422974356, "answer_id": 28301545, "question_id": 28300581, "link": "https://stackoverflow.com/questions/28300581/golang-fatal-error-all-goroutines-are-asleep-deadlock/28301545#28301545", "title": "GOLANG: fatal error: all goroutines are asleep - deadlock", "body": "<p>It looks like you are trying to to read from a file and then split the work across multiple workers (fan out). I do not see any closing of channels in your code. See <a href=\"https://gist.github.com/kylewolfe/7c54018a9ed16517c0dd\" rel=\"nofollow\">https://gist.github.com/kylewolfe/7c54018a9ed16517c0dd</a> for an example of the pattern I'm referring to. For each line of your file, you would read into the one channel, where x workers would read from it (and reflect / do work).</p>\n"}], "owner": {"reputation": 1957, "user_id": 2094708, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nIQKY.jpg?s=128&g=1", "display_name": "Sidharth C. Nadhan", "link": "https://stackoverflow.com/users/2094708/sidharth-c-nadhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2019, "favorite_count": 0, "accepted_answer_id": 28301545, "answer_count": 1, "score": 1, "last_activity_date": 1422974356, "creation_date": 1422971495, "last_edit_date": 1422973893, "question_id": 28300581, "link": "https://stackoverflow.com/questions/28300581/golang-fatal-error-all-goroutines-are-asleep-deadlock", "title": "GOLANG: fatal error: all goroutines are asleep - deadlock", "body": "<pre><code>package main\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n    \"bufio\"\n    \"reflect\"\n)\n\nfunc runTheCommand(ch chan&lt;- string, cmD string)  {\n    ouT,_ := exec.Command(\"sh\",\"-c\",cmD).Output()\n    ch &lt;- string(ouT)\n}\n// Readln returns a single line (without the ending \\n) from the input buffered reader. An error is returned iff there is an error with the buffered reader.\nfunc Readln(r *bufio.Reader) (string, error) {\n    var (isPrefix bool = true\n        err error = nil \n        line, ln []byte\n    )   \n    for isPrefix &amp;&amp; err == nil {\n        line, isPrefix, err = r.ReadLine()\n        ln = append(ln, line...)\n    }   \n    return string(ln),err\n}\n\n\n\nfunc main() {\n    var chans = []chan string{}\n    f, _ := os.Open(\"../tmpStatus.config\")\n    r := bufio.NewReader(f)\n    cmD, e := Readln(r)\n    for e == nil {\n        ch := make(chan string)\n        chans = append(chans, ch) \n        go runTheCommand(ch,cmD)\n        cmD,e = Readln(r)\n    }   \n\n    cases := make([]reflect.SelectCase, len(chans))\n    for i, ch := range chans {\n        cases[i] = reflect.SelectCase{Dir: reflect.SelectRecv, Chan: reflect.ValueOf(ch)}\n    }   \n\n    remaining := len(cases)\n    for remaining &gt; 0 { \n        chosen, value, ok := reflect.Select(cases)\n        if !ok {\n            cases[chosen].Chan = reflect.ValueOf(nil)\n            remaining -= 1\n            continue\n        }\n        fmt.Printf(\"%s\", value.String())\n    }   \n}    \n</code></pre>\n\n<p>This code is correctly printing out all the received values from the channels.\nBut in the end it is exiting with the below error :</p>\n\n<blockquote>\n  <p>fatal error: all goroutines are asleep - deadlock!</p>\n  \n  <p>goroutine 1 [select]: reflect.rselect(0xc200283480, 0x22, 0x22,\n  0xffffffffffffffff, 0x0, ...)\n          /usr/local/go/src/pkg/runtime/chan.c:1212 +0x10d \n   reflect.Select(0xc200066800, 0x22, 0x22, 0x1, 0x0, ...)\n          /usr/local/go/src/pkg/reflect/value.go:1957 +0x1fb</p>\n</blockquote>\n\n<p>I am a newbee at GO. I referred google and somehow managed to write a working code. I didn't understand fully how this script works especially the reflect package commands. My intention here is to execute the unix commands listed in ../tmpStatus.config file parallely and print out the results. I am excited by the concurrency features offered by GO and hence decided to give it a try. Now it is printing the results so fast. Till now, I was doing this in python one by one.\nI ran this script in go version go1.1.2 linux/amd64 installed to a custom location.\nAny idea why the deadlock is happening ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1422968905, "post_id": 28298154, "comment_id": 44950966, "body": "You are executing a program named something like &quot;/usr/local/bin/go build /data/test/mycode.go&quot; with exactly zero arguments. You should provide each argument (&quot;build&quot; and &quot;/data/test/mycode.go&quot;) individually, that&#39;s what exec.Command <code>arg ...string</code> is good for."}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1615627203, "last_edit_date": 1615627203, "creation_date": 1422969042, "answer_id": 28299783, "question_id": 28298154, "link": "https://stackoverflow.com/questions/28298154/call-go-build-command-from-golang-os-exec/28299783#28299783", "title": "call &#39;go build&#39; command from golang os.exec", "body": "<p><code>fmt.Sprintf(&quot;%s/go build /data/test/mycode.go&quot;, goPath) string</code> returns a single string internally divided by a blank space, but as a single string.</p>\n<p><code>os/exec.Command(name string, arg ...string) *Cmd</code>\nexpects a few arguments. It won't divide one string itself.</p>\n"}], "owner": {"reputation": 83, "user_id": 3142129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0olqR.jpg?s=128&g=1", "display_name": "William", "link": "https://stackoverflow.com/users/3142129/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1610, "favorite_count": 0, "accepted_answer_id": 28299783, "answer_count": 1, "score": 1, "last_activity_date": 1615627203, "creation_date": 1422964085, "question_id": 28298154, "link": "https://stackoverflow.com/questions/28298154/call-go-build-command-from-golang-os-exec", "title": "call &#39;go build&#39; command from golang os.exec", "body": "<p>in my project, i need to write some go code dynamically and need to test the code is valid. so need to call \"go build\" command  use 'os.exec' function.</p>\n\n<p>when i write go code in a temp directory like '/data/test/mycode.go'. and i try to call 'go build', they return a error as 'no such file or directory'.\nhow i can do this correctly? thanks all:)</p>\n\n<p>below is some code '</p>\n\n<pre><code>// is not work too\n// goPath, err := exec.LookPath(\"go\")\n\nvar out, stderr bytes.Buffer\ncmd := exec.Command(fmt.Sprintf(\"%s/go build /data/test/mycode.go\", goPath))\ncmd.Stdout = &amp;out\ncmd.Stderr = &amp;stderr\nerr = cmd.Run()\n</code></pre>\n\n<p>PS: but i call the command 'go build /data/test/mycode.go' directly in terminal. it can works.</p>\n"}, {"tags": ["html", "css", "go", "http-status-code-404", "go-templates"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1422948593, "post_id": 28293452, "comment_id": 44939686, "body": "Would that work better if you put the full path of the <code>css</code> folder in <code>http.FileServer(http.Dir(&quot;&#47;full&#47;path&#47;of&#47;css&quot;)</code>?"}, {"owner": {"reputation": 75, "user_id": 2923605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92c1c848c826e56644b5227a78313f5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2923605", "link": "https://stackoverflow.com/users/2923605/user2923605"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1422948880, "post_id": 28293452, "comment_id": 44939807, "body": "Yes when i use the full path it works as expected. The only gripe i have is why it work on my friend machine (mac) with the code above but when i ran it on my machine (windows) it didn&#39;t work. We literally have the same file paths for the css file to the server.go"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1422949536, "post_id": 28293452, "comment_id": 44940106, "body": "Just for testing, would replacing <code>&quot;css&quot;</code> with <code>filepath.FromSlash(path.Clean(&quot;css&quot;)</code> work better (and for any platform)?"}], "answers": [{"comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1422954460, "post_id": 28294524, "comment_id": 44942529, "body": "This seems to trip a lot of people up - all the time."}, {"owner": {"reputation": 75, "user_id": 2923605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92c1c848c826e56644b5227a78313f5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2923605", "link": "https://stackoverflow.com/users/2923605/user2923605"}, "edited": false, "score": 0, "creation_date": 1422992213, "post_id": 28294524, "comment_id": 44965377, "body": "Thank you for the explanation. i thought that i was running my files from src/server but i was using the command go install server which creates an executable in the bin folder."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1422958241, "last_edit_date": 1422958241, "creation_date": 1422952732, "answer_id": 28294524, "question_id": 28293452, "link": "https://stackoverflow.com/questions/28293452/404-page-not-found-go-rendering-css-file/28294524#28294524", "title": "404 page not found - Go rendering css file", "body": "<p>Since you don't specify full path for the <code>css</code> folder just a relative one, whether your css files are found depends on the <em>folder you run your application from</em> (the working directory, this is what relative paths are resolved to).</p>\n\n<p>For example if you start your application from your <code>src</code> with <code>go run server/server.go</code> it will work. If you start it from your <code>src/server</code> folder with <code>go run server.go</code>, it will not work. Also if you create a native executable from your app which is put into the <code>bin</code> folder and you start that from the <code>bin</code> folder, this also won't work because the <code>css</code> folder is not in the <code>bin</code> folder.</p>\n\n<p>Either start it with <code>go run server/server.go</code> from the <code>src</code> folder, or copy the <code>css</code> folder to your <code>bin</code> folder and start the executable from the <code>bin</code> folder and it should work (but in this case you also have to copy other static files like html templates).</p>\n"}], "owner": {"reputation": 75, "user_id": 2923605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92c1c848c826e56644b5227a78313f5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2923605", "link": "https://stackoverflow.com/users/2923605/user2923605"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2123, "favorite_count": 1, "accepted_answer_id": 28294524, "answer_count": 1, "score": 2, "last_activity_date": 1470159017, "creation_date": 1422948315, "last_edit_date": 1495535253, "question_id": 28293452, "link": "https://stackoverflow.com/questions/28293452/404-page-not-found-go-rendering-css-file", "title": "404 page not found - Go rendering css file", "body": "<p>I'm currently working in Go. I created a web server on my local machine. I followed the instruction on this page <a href=\"https://stackoverflow.com/questions/13302020/rendering-css-in-a-go-web-application\">Rendering CSS in a Go Web Application</a>\nbut I'm still getting the 404 error that the program can't seem to find where my css file is. My directory is as follows. </p>\n\n<p>In <code>src</code> folder contains <code>css/somefilename.css</code>, <code>src</code> also contains <code>server/server.go</code>.</p>\n\n<p>The code inside my <code>server.go</code> file is as follows.</p>\n\n<pre><code>http.Handle(\"/css/\", http.StripPrefix(\"/css/\", http.FileServer(http.Dir(\"css\"))))\n</code></pre>\n\n<p>When I go to <code>localhost:8080/css/</code> I get 404 page not found. I'm also using templates to render the html code. The templates are in the folder</p>\n\n<pre><code>src/templates/layout.html\n</code></pre>\n\n<p>the html code is as follows:</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"../css/css490.css\" /&gt;\n</code></pre>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 105, "user_id": 3106499, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81b33f771ca8d7f16fa99a17f1ca6d99?s=128&d=identicon&r=PG&f=1", "display_name": "joshua29", "link": "https://stackoverflow.com/users/3106499/joshua29"}, "edited": false, "score": 0, "creation_date": 1422946726, "post_id": 28292697, "comment_id": 44938956, "body": "Can somebody helm me. thanx"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1422952993, "post_id": 28292697, "comment_id": 44941751, "body": "There is a deleted answer to your question which apparently answers the question. You replied: <code>i already did that. but the go lang code doesn&#39;t read. html code was only read</code>. Can you please fix your question so it demonstrates your actual problem?"}], "answers": [{"tags": [], "owner": {"reputation": 1151, "user_id": 2241348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb155ddab6564900c4c5f35923723ff4?s=128&d=identicon&r=PG", "display_name": "abalos", "link": "https://stackoverflow.com/users/2241348/abalos"}, "is_accepted": false, "score": 1, "last_activity_date": 1422968292, "creation_date": 1422968292, "answer_id": 28299528, "question_id": 28292697, "link": "https://stackoverflow.com/questions/28292697/how-to-deploy-revel-frameworkgo-lang-using-nginx/28299528#28299528", "title": "How to deploy revel framework(Go lang) using nginx", "body": "<p>Based on your question, I assume you are trying to reverse proxy from nginx to your revel framework application. Essentially using proxy pass forwards HTTP request headers from one port/application to another. This allows you to use your web application directly.</p>\n\n<p>If this is the case, you'll need to do the following:</p>\n\n<ul>\n<li>Start the app on some port (say 8089)</li>\n<li>Configure Nginx to handle reverse proxy web connections from port 80 / 443 to that port.</li>\n<li>Navigate to the URL specified by the Nginx proxy pass configuration.</li>\n</ul>\n\n<p><a href=\"http://nginx.com/resources/admin-guide/reverse-proxy/\" rel=\"nofollow\">This link from Nginx should be helpful in setting up the proxy pass.</a></p>\n\n<p>If this is not what you are trying to achieve, let me know and I'll try to help out some more!</p>\n"}], "owner": {"reputation": 105, "user_id": 3106499, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81b33f771ca8d7f16fa99a17f1ca6d99?s=128&d=identicon&r=PG&f=1", "display_name": "joshua29", "link": "https://stackoverflow.com/users/3106499/joshua29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456671634, "creation_date": 1422944897, "question_id": 28292697, "link": "https://stackoverflow.com/questions/28292697/how-to-deploy-revel-frameworkgo-lang-using-nginx", "title": "How to deploy revel framework(Go lang) using nginx", "body": "<p>I like to ask, how can i deploy my revel framework app using nginx in different linten port, for example port 8089. Thank you</p>\n"}, {"tags": ["web-applications", "go", "router", "mux", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 2133846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f126eb59387d563ffcf3d686b8e11f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jaehoon", "link": "https://stackoverflow.com/users/2133846/jaehoon"}, "is_accepted": true, "score": 0, "last_activity_date": 1422944220, "creation_date": 1422944220, "answer_id": 28292554, "question_id": 28291701, "link": "https://stackoverflow.com/questions/28291701/go-gorilla-mux-to-handles-api-requests/28292554#28292554", "title": "Go Gorilla mux to handles API requests", "body": "<p>Will you want me to do?</p>\n\n<pre><code>func myHandler(r http.ResponseWriter, q *http.Request) {\n    vars := mux.Vars(q)\n    fmt.Println(vars[\"action\"])\n\n    fmt.Println(q.FormValue(\"id\"))\n    fmt.Println(q.FormValue(\"password\"))\n    fmt.Println(q.FormValue(\"product\")) \n    fmt.Println(q.FormValue(\"confirm\"))     \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1422953065, "last_edit_date": 1422953065, "creation_date": 1422944695, "answer_id": 28292653, "question_id": 28291701, "link": "https://stackoverflow.com/questions/28291701/go-gorilla-mux-to-handles-api-requests/28292653#28292653", "title": "Go Gorilla mux to handles API requests", "body": "<p>You can use Queries method on you router</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n    router := mux.NewRouter().Queries(\"id\", \"{id:[a-z]+}\", \"password\", \"{password:[a-z]+}\", \"product\", \"{product:[a-z]+}\", \"confirm\", \"{confirm:true|false}\")\n    request, _ := http.NewRequest(\"GET\", \"http://example.com?id=hello&amp;password=great&amp;product=ipad&amp;confirm=true\", nil)\n\n    var match mux.RouteMatch\n    router.Match(request, &amp;match)\n    fmt.Println(match.Vars)\n}\n</code></pre>\n\n<p><a href=\"http://www.gorillatoolkit.org/pkg/mux#Route.Queries\" rel=\"nofollow\">Documentation</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1291, "favorite_count": 0, "accepted_answer_id": 28292554, "answer_count": 2, "score": 1, "last_activity_date": 1544450819, "creation_date": 1422939822, "last_edit_date": 1544450819, "question_id": 28291701, "link": "https://stackoverflow.com/questions/28291701/go-gorilla-mux-to-handles-api-requests", "title": "Go Gorilla mux to handles API requests", "body": "<p>I want to get the map structure from the following Gorilla Mux router input.package main</p>\n\n<p>For example,</p>\n\n<pre><code> router.Methods(\"GET\").Path(\"/api/{action}\").HandlerFunc(httpLog(myHandler))\n\nfunc myHandler(rw http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\n    log.Println(vars[\"action\"])\n}\n</code></pre>\n\n<p>Serves <code>0.0.0.0:3000/api/input</code> and this prints out the string <code>input</code></p>\n\n<p>What if I want to be able to receive requests like:</p>\n\n<p><code>0.0.0.0:3000/api/v3?id=hello&amp;password=great&amp;product=ipad&amp;confirm=true</code></p>\n\n<p>And from this requests, I want to get a map of:</p>\n\n<pre><code>map[\"id\"] = \"hello\"\nmap[\"password\"] = \"great\"\nmap[\"product\"] = \"ipad\"\nmap[\"confirm\"] = \"true\"\n</code></pre>\n"}, {"tags": ["html", "go", "go-templates"], "comments": [{"owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "edited": false, "score": 0, "creation_date": 1422910621, "post_id": 28286472, "comment_id": 44927146, "body": "From where are you running your application? Paths are relative to that, not the src file."}, {"owner": {"reputation": 75, "user_id": 2923605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92c1c848c826e56644b5227a78313f5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2923605", "link": "https://stackoverflow.com/users/2923605/user2923605"}, "reply_to_user": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "edited": false, "score": 0, "creation_date": 1422910689, "post_id": 28286472, "comment_id": 44927180, "body": "i&#39;m running it on a cygwin terminal. I&#39;m going to that page when i go to localhost:8080/time"}, {"owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "edited": false, "score": 0, "creation_date": 1422910889, "post_id": 28286472, "comment_id": 44927281, "body": "Right, but from what folder within your terminal?"}, {"owner": {"reputation": 75, "user_id": 2923605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92c1c848c826e56644b5227a78313f5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2923605", "link": "https://stackoverflow.com/users/2923605/user2923605"}, "reply_to_user": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "edited": false, "score": 0, "creation_date": 1422911189, "post_id": 28286472, "comment_id": 44927431, "body": "/cygdrive/c/Users/Paul/Documents  gopath = c/Users/Paul/Documents/Home/go"}, {"owner": {"reputation": 75, "user_id": 2923605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92c1c848c826e56644b5227a78313f5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2923605", "link": "https://stackoverflow.com/users/2923605/user2923605"}, "reply_to_user": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "edited": false, "score": 0, "creation_date": 1422912357, "post_id": 28286472, "comment_id": 44928019, "body": "src is a folder inside c/Users/Paul/Documents/Home/go"}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 2923605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92c1c848c826e56644b5227a78313f5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2923605", "link": "https://stackoverflow.com/users/2923605/user2923605"}, "is_accepted": false, "score": 0, "last_activity_date": 1422914899, "creation_date": 1422914899, "answer_id": 28287716, "question_id": 28286472, "link": "https://stackoverflow.com/questions/28286472/system-cannot-find-path-specified-trying-to-parse-template/28287716#28287716", "title": "System cannot find path specified trying to parse template", "body": "<p>Problem was that my path wasn't correct. changed </p>\n\n<pre><code>fp := path.Join(\"templates\", \"time.html\")\n</code></pre>\n\n<p>to </p>\n\n<pre><code>fp := path.Join(\"Home/go/src/templates\", \"time.html\")\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2923605, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/92c1c848c826e56644b5227a78313f5c?s=128&d=identicon&r=PG&f=1", "display_name": "user2923605", "link": "https://stackoverflow.com/users/2923605/user2923605"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2963, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569600454, "creation_date": 1422910150, "last_edit_date": 1569600454, "question_id": 28286472, "link": "https://stackoverflow.com/questions/28286472/system-cannot-find-path-specified-trying-to-parse-template", "title": "System cannot find path specified trying to parse template", "body": "<p>I'm just getting started learning about html/templates in Go. The error I'm getting is that 'system cannot find file path specified'. and the file path is templates/time.html. the location of time.html (the page I'm trying to render) is </p>\n\n<p>src/templates/time.html</p>\n\n<p>the location of my go main is src/timeserver/timerserver.go</p>\n\n<p>here's the code I used</p>\n\n<pre><code>func TimeServer(w http.ResponseWriter, req *http.Request) {\n// if user goes to another website after time/...\nif req.URL.Path != \"/time/\" {\n    errorHandler(w, req, http.StatusNotFound)\n    return\n}\ncookie, _ := req.Cookie(\"UUID\")\n//existCheck := false\n//temp2 := \"\"\nprofile := Profile{\"\",time.Now().Format(\"3:04:04 PM\")}\nif cookie != nil { // if cookie exist set flags\n    name, check := cookieJar.GetValue(cookie.Value)\n    profile = Profile{name,time.Now().Format(\"3:04:04 PM\")}\n    fmt.Println(name)\n    //existCheck = check\n    //temp2 = name\n    fmt.Println(check)\n}\nfp := path.Join(\"templates\", \"time.html\")\ntmpl, err := template.ParseFiles(fp)\nif err != nil {\n    http.Error(w, err.Error(), http.StatusInternalServerError)\n    return\n}\n\nif err := tmpl.Execute(w, profile); err != nil {\n    http.Error(w, err.Error(), http.StatusInternalServerError)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1422902160, "post_id": 28284138, "comment_id": 44922797, "body": "No. But is it really that long that you want to shorten it? If yes, then also make the <code>err</code> variable global..."}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1422907011, "post_id": 28284469, "comment_id": 44925361, "body": "&quot;:= is just a shortcut to New()&quot; doesn&#39;t seem right: <code>new()</code> returns a pointer but <code>x := 1</code> doesn&#39;t create a pointer."}], "tags": [], "owner": {"reputation": 1599, "user_id": 2623893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/t40xu.png?s=128&g=1", "display_name": "kwolfe", "link": "https://stackoverflow.com/users/2623893/kwolfe"}, "is_accepted": true, "score": 6, "last_activity_date": 1527591958, "last_edit_date": 1527591958, "creation_date": 1422902335, "answer_id": 28284469, "question_id": 28284138, "link": "https://stackoverflow.com/questions/28284138/go-global-variable-and-short-variable-definition/28284469#28284469", "title": "Go global variable and short variable definition", "body": "<p>Nope, that's it. <code>:=</code> is just a shortcut to <strike>New() (<a href=\"https://golang.org/doc/effective_go.html#allocation_new\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#allocation_new</a>)</strike> variable declaration (var foo int). A more idiomatic approach (and better design in general) is to return the connection and not to use global variables.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Init(user string, pwd string, dbname string, port int) (*sql.DB, error) {\n    // ...\n}\n</code></pre>\n\n<p>Dependency injection is your friend, try not to break scope.</p>\n"}, {"tags": [], "owner": {"reputation": 20703, "user_id": 2805033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TasHL.jpg?s=128&g=1", "display_name": "Ben Darnell", "link": "https://stackoverflow.com/users/2805033/ben-darnell"}, "is_accepted": false, "score": 4, "last_activity_date": 1422902612, "creation_date": 1422902612, "answer_id": 28284549, "question_id": 28284138, "link": "https://stackoverflow.com/questions/28284138/go-global-variable-and-short-variable-definition/28284549#28284549", "title": "Go global variable and short variable definition", "body": "<p>No, there is no shorthand for this. <code>:=</code> always assigns to variables in the current (innermost) scope, creating new variables if necessary. To assign to any variables outside the current scope, you must use <code>=</code> instead of <code>:=</code>, and in the case of multiple-assignment this means that all variables must be pre-declared.</p>\n"}], "owner": {"reputation": 7182, "user_id": 326257, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/daa06ea257d7820ff84735a55b931ec8?s=128&d=identicon&r=PG", "display_name": "Mikulas Dite", "link": "https://stackoverflow.com/users/326257/mikulas-dite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 28284469, "answer_count": 2, "score": 2, "last_activity_date": 1527591958, "creation_date": 1422901108, "question_id": 28284138, "link": "https://stackoverflow.com/questions/28284138/go-global-variable-and-short-variable-definition", "title": "Go global variable and short variable definition", "body": "<p>In the following snippet</p>\n\n<pre><code>package ...\n\nvar Conn *sql.DB // outer Conn\n\nfunc Init(user, pwd, dbname string, port int) {\n    Conn, err := sql.Open(\"postgres\", \"... args\") // inner Conn\n    // ..\n}\n</code></pre>\n\n<p>the inner <code>Conn</code> is a new variable and <em>outer</em> <code>Conn</code> will remain null.</p>\n\n<p>By explicitly defining <code>err</code> and replacing the short variable definition with assignment it seems to properly init the outer <code>Conn</code> variable</p>\n\n<pre><code>    var err error\n    Conn, err = sql.Open(\"postgres\", \"... args\") // inner Conn\n</code></pre>\n\n<p>Is there a simpler way to specify the inner <code>Conn</code> should not really be a scoped variable but instead the global <code>Conn</code> variable? I'm thinking something like <code>package.Conn</code>, but that's invalid inside the package itself.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1422899273, "post_id": 28282370, "comment_id": 44921363, "body": "The way you&#39;re proposing looks fine. Won&#39;t read everything, or the stdlib&#39;s 10MB limit would be ineffective too. A huge POST with no Content-Length is not going to be generated by most browsers/user agents, and I think hanging up on the request is a reasonable response if it happens."}, {"owner": {"reputation": 6686, "user_id": 520857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EE9Th.png?s=128&g=1", "display_name": "Populus", "link": "https://stackoverflow.com/users/520857/populus"}, "edited": false, "score": 0, "creation_date": 1422901435, "post_id": 28282370, "comment_id": 44922399, "body": "I think this is premature optimization. Until you notice that you are getting unusually high traffic, you should just leave it as simple as you can. I&#39;m sure you have plenty of other higher priority tasks you need to complete. :P"}, {"owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "reply_to_user": {"reputation": 6686, "user_id": 520857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EE9Th.png?s=128&g=1", "display_name": "Populus", "link": "https://stackoverflow.com/users/520857/populus"}, "edited": false, "score": 0, "creation_date": 1422901607, "post_id": 28282370, "comment_id": 44922487, "body": "@Populus I&#39;ve realized. I&#39;m not too concerned about it at the moment. I&#39;ll keep up the question up though."}, {"owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "edited": false, "score": 0, "creation_date": 1450489108, "post_id": 28282370, "comment_id": 56475171, "body": "Check the documentation carefully, it isn&#39;t actually a 10MB limit. &quot;The whole request body is parsed and up to a total of maxMemory bytes of its file parts are stored in memory, with the <b>remainder stored on disk in temporary files</b>.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 198, "user_id": 1363306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cf39a73546e2a48d7a491e461bbdbbe?s=128&d=identicon&r=PG", "display_name": "rfliam", "link": "https://stackoverflow.com/users/1363306/rfliam"}, "is_accepted": false, "score": 0, "last_activity_date": 1422947086, "last_edit_date": 1422947086, "creation_date": 1422942269, "answer_id": 28292148, "question_id": 28282370, "link": "https://stackoverflow.com/questions/28282370/is-it-advisable-to-further-limit-the-size-of-forms-when-using-golang/28292148#28292148", "title": "Is it advisable to (further) limit the size of forms when using golang?", "body": "<p>Edit: As others cited MaxByteReader is the supported way. It is interesting that the default reader is instead, limitreader after type asserting for max byte reader.</p>\n\n<p><strike>Submit a patch to the Go source code and make it configurable! You are working with an open source project after all. Adding a setter to http.Request and some unit tests for it is probably only 20 minutes worth of work. Having a hardcoded value here is a bit clunky, give back and fix it :).</p>\n\n<p>You can of course implement your own <code>ParseForm(r *http.Request)</code> method if you really need to override this. Go is essentially BSD, so you can copy paste the library ParseForm and change the limit, but thats a bit ugly no?</strike></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 30, "last_activity_date": 1459184816, "last_edit_date": 1459184816, "creation_date": 1422944027, "answer_id": 28292505, "question_id": 28282370, "link": "https://stackoverflow.com/questions/28282370/is-it-advisable-to-further-limit-the-size-of-forms-when-using-golang/28292505#28292505", "title": "Is it advisable to (further) limit the size of forms when using golang?", "body": "<p>The correct way to limit the size of the request body is to do as you suggested:</p>\n\n<pre><code>r.Body = http.MaxBytesReader(w, r.Body, MaxFileSize) \nerr := r.ParseForm()\nif err != nil {\n // redirect or set error status code.\n return\n}\n</code></pre>\n\n<p>MaxBytesReader sets a <a href=\"https://github.com/golang/go/blob/3c4be235be8dcd124fe8d536af3e422729a85785/src/net/http/server.go#L340-L347\" rel=\"noreferrer\">flag on the response</a> when the limit is reached. When this flag is set, the server does not read the remainder of the request body and the server closes the connection on return from the handler. </p>\n\n<p>If you are concerned about malicious clients, then you should also set <a href=\"http://godoc.org/net/http#Server.ReadTimeout\" rel=\"noreferrer\">Server.ReadTimeout</a>, <a href=\"http://godoc.org/net/http#Server.WriteTimeout\" rel=\"noreferrer\">Server.WriteTimeout</a> and possibly <a href=\"http://godoc.org/net/http#Server.MaxHeaderBytes\" rel=\"noreferrer\">Server.MaxHeaderBytes</a>.</p>\n\n<p>If you want to set the request body limit for all of your handlers, then wrap root handler with a handler that sets the limit before delegating to the root handler:</p>\n\n<pre><code> type maxBytesHandler struct {\n     h http.Handler\n     n int64\n }\n\n func (h *maxBytesHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n     r.Body = http.MaxBytesReader(w, r.Body, h.n) \n     h.h.ServeHTTP(w, r)\n }\n</code></pre>\n\n<p>Wrap the root handler when calling ListenAndServe:</p>\n\n<pre><code>log.Fatal(http.ListenAndServe(\":8080\", &amp;maxBytesHandler{h:mux, n:4096))\n</code></pre>\n\n<p>or when configuring a server:</p>\n\n<pre><code>s := http.Server{\n    Addr: \":8080\",\n    Handler: &amp;maxBytesReader{h:mux, n:4096},\n}\nlog.Fatal(s.ListenAndServe())\n</code></pre>\n\n<p>There's no need for a patch as suggested in another answer. MaxBytesReader is the official way to limit the size of the request body.</p>\n"}], "owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10894, "favorite_count": 3, "accepted_answer_id": 28292505, "answer_count": 2, "score": 17, "last_activity_date": 1459184816, "creation_date": 1422894939, "last_edit_date": 1495540936, "question_id": 28282370, "link": "https://stackoverflow.com/questions/28282370/is-it-advisable-to-further-limit-the-size-of-forms-when-using-golang", "title": "Is it advisable to (further) limit the size of forms when using golang?", "body": "<p>I searched around and as far as I can tell, POST form requests are already limited to 10MB (<a href=\"http://golang.org/src/net/http/request.go#L721\" rel=\"noreferrer\">http://golang.org/src/net/http/request.go#L721</a>). </p>\n\n<p>If I were to go about reducing this in my <code>ServeHTTP</code> method, I'm not sure how to properly do it. I would try something like this:</p>\n\n<pre><code>r.Body = http.MaxBytesReader(w, r.Body, MaxFileSize) \nerr := r.ParseForm()\nif err != nil {\n     //redirect to some error page\n     return\n}\n</code></pre>\n\n<p>But would returning upon error close the connection as well? How would I prevent having to read everything? I found this: <a href=\"https://stackoverflow.com/a/26393261/2202497\">https://stackoverflow.com/a/26393261/2202497</a>, but what if content length is not set and in the middle of reading I realize that the file is too big.</p>\n\n<p>I'm using this as a security measure to prevent someone from hogging my server's resources.</p>\n"}, {"tags": ["go", "mixins"], "answers": [{"comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1422894880, "post_id": 28282213, "comment_id": 44918890, "body": "Compiler is correct but inconsistent. Why in previous case it uses the last found version of <code>F()</code> while the same rationale applies? And I prefer the first approach (using last found <code>F()</code> starting from the type itself - in an overriding manner)."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1422895345, "post_id": 28282213, "comment_id": 44919163, "body": "I do not consider &quot;using last found&quot; as bug and I like it. It would be nice if the second case gets removed."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1422895415, "post_id": 28282213, "comment_id": 44919206, "body": "@KavehShahbazian It doesn&#39;t use the last found, it uses the shallowest one. See the edit."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1422895607, "post_id": 28282213, "comment_id": 44919303, "body": "Thanks @Ainar, the comment is an answer to another comment which is deleted now."}, {"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "edited": false, "score": 0, "creation_date": 1422895673, "post_id": 28282213, "comment_id": 44919347, "body": "Yeah, I was wrong, it is documented and I never saw it. It just gets unhappy if there are two equally shallow options."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 8, "last_activity_date": 1422895388, "last_edit_date": 1592644375, "creation_date": 1422894452, "answer_id": 28282213, "question_id": 28281564, "link": "https://stackoverflow.com/questions/28281564/implementing-mixins-and-an-inconsistency-in-compiler-behavior/28282213#28282213", "title": "Implementing Mixins and an Inconsistency in Compiler Behavior", "body": "<h3>Question 1</h3>\n<p>The compiler is correct. How should it decide, which of <code>OX.F</code> and <code>Y.F</code> should it use? It can't. So it's up to you to call the desired method directly: either with</p>\n<pre><code>z.Y.F()\n</code></pre>\n<p>or</p>\n<pre><code>z.OX.F()\n</code></pre>\n<p><strong>Edit:</strong> As for why your example worked until you've defined <code>F</code> on <code>Y</code>, this is mentioned in <a href=\"http://golang.org/ref/spec#Selectors\" rel=\"noreferrer\">the Spec</a>:</p>\n<blockquote>\n<p>For a value x of type <code>T</code> or <code>*T</code> where <code>T</code> is not a pointer or interface type, <code>x.f</code> denotes the field or method at the shallowest depth in <code>T</code> where there is such an <code>f</code>. <em>If there is not exactly one <code>f</code> with shallowest depth, the selector expression is illegal.</em></p>\n</blockquote>\n<p>(Emphasis added.)</p>\n<p>Before you defined the method, the shallowest implementation was <code>OX.F</code>. After you've defined <code>Y.F</code>, there became two <code>F</code>s on the same level, which is illegal.</p>\n<h3>Question 2</h3>\n<p>Again, the compiler is correct. You have embedded types <code>Y</code> and <code>OX</code> into <code>Z</code>, not <code>*Y</code> and <code>*OX</code>. As written in <a href=\"http://golang.org/ref/spec#Method_sets\" rel=\"noreferrer\">the Spec</a>,</p>\n<blockquote>\n<p>The method set of the corresponding pointer type <code>*T</code> is the set of all methods declared with receiver <code>*T</code> or <code>T</code> (that is, it also contains the method set of <code>T</code>).</p>\n</blockquote>\n<p><code>*T</code> has all methods of <code>T</code>, but <em>not the other way around.</em> Methods sets of <code>OX</code> and <code>Y</code> are empty, so obviously, <code>fmt.Println</code> just prints them as if they were any other kind of struct with no <code>String()</code> method defined.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1422914382, "creation_date": 1422914382, "answer_id": 28287595, "question_id": 28281564, "link": "https://stackoverflow.com/questions/28281564/implementing-mixins-and-an-inconsistency-in-compiler-behavior/28287595#28287595", "title": "Implementing Mixins and an Inconsistency in Compiler Behavior", "body": "<p>Ainar-G write neat answer</p>\n\n<p><a href=\"http://golang.org/ref/spec#Selectors\" rel=\"nofollow\">Spec:</a></p>\n\n<blockquote>\n  <p>For a value x of type T or *T where T is not a pointer or interface\n  type, x.f denotes the field or method at the shallowest depth in T\n  where there is such an f. If there is not exactly one f with\n  shallowest depth, the selector expression is illegal.</p>\n</blockquote>\n\n<p>I'd like to add a bit</p>\n\n<p><a href=\"http://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">Spec:</a></p>\n\n<blockquote>\n  <p>If S contains an anonymous field T, the method sets of S and *S both include promoted methods with receiver T. The method set of *S also includes promoted methods with receiver *T.</p>\n</blockquote>\n\n<p>So things would work if you just use referencing to promote methods like</p>\n\n<pre><code>fmt.Println(&amp;z)\n</code></pre>\n\n<p>But this will cause ambiguity in selection cause of there are few possibilities for String method and so selector String is illegal due to spec. Compiler must complain, but it doesn't. This behaviour looks unspecified and can be only explained as special case for common printing operation to my mind.\nThis will work as expected</p>\n\n<pre><code>var y Y\nfmt.Println(&amp;y)\n</code></pre>\n\n<p>Here is working example\n<a href=\"https://play.golang.org/p/54NtwAjwzv\" rel=\"nofollow\">Playground</a></p>\n"}], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "accepted_answer_id": 28282213, "answer_count": 2, "score": 4, "last_activity_date": 1422914382, "creation_date": 1422892453, "last_edit_date": 1422893084, "question_id": 28281564, "link": "https://stackoverflow.com/questions/28281564/implementing-mixins-and-an-inconsistency-in-compiler-behavior", "title": "Implementing Mixins and an Inconsistency in Compiler Behavior", "body": "<p>Mixins can be implemented in Go (1.4.1) using embedding and since <code>struct{}</code> occupies no memory (as I understand) it fits for the situations that we want to add some functionality or just add a method to a type that may actually has nothing to do with it's state, but we like to avoid <code>ParseThing(...)</code> and instead write <code>thing.Parse(...)</code>.</p>\n\n<p>So having:</p>\n\n<pre><code>type X struct{}\n\nfunc (x X) F() {\n    fmt.Println(\"functionality in X.F()\")\n}\n\ntype Y struct{ X }\ntype Z struct{ Y }\n</code></pre>\n\n<p>Then if we do:</p>\n\n<pre><code>var z Z\nz.F()\n</code></pre>\n\n<p>Will give us:</p>\n\n<pre><code>functionality in X.F()\n</code></pre>\n\n<p>So far so good.</p>\n\n<p>Now let's add another type <code>OX</code> with method <code>F()</code> and embed it in <code>Z</code>:</p>\n\n<pre><code>type Z struct {\n    Y\n    OX\n}\n\ntype OX struct{} // overriding X\n\nfunc (x OX) F() {\n    fmt.Println(\"functionality in OX.F()\")\n}\n</code></pre>\n\n<p>Interesting! Now we get <code>functionality in OX.F()</code> which shows us that Go compiler searches for the method, starting from type it self and then the last embedded type. We can check that by adding <code>F()</code> to <code>Z</code>:</p>\n\n<pre><code>func (x Z) F() {\n    fmt.Println(\"functionality in Z.F()\")\n}\n</code></pre>\n\n<p>The output is <code>functionality in Z.F()</code>. Now if we remove the <code>Z.F()</code> method and add <code>F()</code> to <code>Y</code>:</p>\n\n<pre><code>//func (x Z) F() {\n//    fmt.Println(\"functionality in Z.F()\")\n//}\n\nfunc (x Y) F() {\n    fmt.Println(\"functionality in Y.F()\")\n}\n</code></pre>\n\n<p>Then we see this error <code>ambiguous selector z.F</code>; redirecting via pointers makes no difference.</p>\n\n<p><strong>Question 1:</strong> Why that's so? </p>\n\n<p>The extra level of indirection <code>Y</code> meant for something else, but brought me to this. And as I've guessed <code>func (t T) String() string{}</code> is an exception. This code:</p>\n\n<pre><code>type X struct{}\n\nfunc (x X) String() string {\n    return \"in X.String()\"\n}\n\ntype Y struct{ X }\ntype Z struct {\n    Y\n    OX\n}\n\ntype OX struct{} // overriding X\n\nfunc (x OX) String() string {\n    return \"in OX.String()\"\n}\n\nfunc (x Y) String() string {\n    return \"in Y.String()\"\n}\n</code></pre>\n\n<p>And then this:</p>\n\n<pre><code>var z Z\nfmt.Println(z)\n</code></pre>\n\n<p>Gives us:</p>\n\n<pre><code>{in Y.String() in OX.String()}\n</code></pre>\n\n<p>Which is logical. But if we use pointer receivers:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"testing\"\n)\n\nfunc TestIt(t *testing.T) {\n    var z Z\n    fmt.Println(z)\n}\n\ntype X struct{}\n\nfunc (x *X) String() string {\n    return \"in X.String()\"\n}\n\ntype Y struct{ X }\ntype Z struct {\n    Y\n    OX\n}\n\ntype OX struct{} // overriding X\n\nfunc (x *OX) String() string {\n    return \"in OX.String()\"\n}\n\nfunc (x *Y) String() string {\n    return \"in Y.String()\"\n}\n</code></pre>\n\n<p>Will print out:</p>\n\n<pre><code>{{{}} {}}\n</code></pre>\n\n<p><strong>Question 2</strong>: Why is that so?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1422891871, "last_edit_date": 1422891871, "creation_date": 1422885040, "answer_id": 28279237, "question_id": 28279155, "link": "https://stackoverflow.com/questions/28279155/using-defer-with-pointers/28279237#28279237", "title": "Using defer with pointers", "body": "<p>If the purpose of your function is to return a file, why would you want to close it in the function that returns it?</p>\n\n<p>In this case it is the responsibility of the <em>caller</em> to properly close the file, preferably with <code>defer</code>:</p>\n\n<pre><code>func usingGetConnection() {\n    f := getConnection(\"file.txt\")\n    defer f.Close()\n    // Use f here\n}\n</code></pre>\n\n<p>Although your <code>getConnection()</code> function swallows errors, you should use multi-return value to indicate problems like this:</p>\n\n<pre><code>func getConnection(fileName string) (*os.File, error) {\n    file, err := os.Open(fileName)\n    //Check for error\n    if err != nil {\n        return nil, err\n    }\n    return file, nil\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>func usingGetConnection() {\n    f, err := getConnection(\"file.txt\")\n    if err != nil {\n        panic(err) // Handle err somehow\n    }\n    defer f.Close()\n    // Use f here\n}\n</code></pre>\n"}], "owner": {"reputation": 10232, "user_id": 2104976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1a5168ce005df0148523b929ea9983c0?s=128&d=identicon&r=PG", "display_name": "callmekatootie", "link": "https://stackoverflow.com/users/2104976/callmekatootie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 28279237, "answer_count": 1, "score": 3, "last_activity_date": 1422891871, "creation_date": 1422884743, "question_id": 28279155, "link": "https://stackoverflow.com/questions/28279155/using-defer-with-pointers", "title": "Using defer with pointers", "body": "<p>Let us say that I have the following code:</p>\n\n<pre><code>func getConnection(fileName string) *os.File {\n    file, err := os.Open(fileName)\n    //Check for error\n    return file\n}\n</code></pre>\n\n<p>I use this function to open a file and the function is called from another function that does some other activity.</p>\n\n<p>My question is, now that I have opened the file, how do I close it. If I were to add <code>defer file.Close()</code> inside <code>getConnection()</code>, wouldn't it close the file before returning? Does it make sense to use defer inside the calling function?</p>\n"}, {"tags": ["google-app-engine", "go", "channel-api"], "comments": [{"owner": {"reputation": 1124, "user_id": 3911538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61549e3ff0b73f48d0861e8c83b61dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Uchaev", "link": "https://stackoverflow.com/users/3911538/nikita-uchaev"}, "edited": false, "score": 0, "creation_date": 1423389357, "post_id": 28276666, "comment_id": 45122029, "body": "Please see this <a href=\"http://stackoverflow.com/a/26622898/3852106\">answer</a>. Judging by your app.yaml, you correctly enabled the service, but need to define presence path handlers. Hope it helps."}, {"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "reply_to_user": {"reputation": 1124, "user_id": 3911538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61549e3ff0b73f48d0861e8c83b61dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Uchaev", "link": "https://stackoverflow.com/users/3911538/nikita-uchaev"}, "edited": false, "score": 0, "creation_date": 1423416014, "post_id": 28276666, "comment_id": 45129674, "body": "For the time being I&#39;ve just ported it to using the main app instead of modules, but might play with explicitly naming the handlers instead of relying on &quot;/.*&quot; later. Thanks!"}], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1422884819, "creation_date": 1422876274, "last_edit_date": 1422884819, "question_id": 28276666, "link": "https://stackoverflow.com/questions/28276666/channel-api-presence-urls-are-not-called-when-deployed-to-production-module", "title": "Channel API: Presence URLs are not called when deployed to production module", "body": "<p>I have a Go app using the Channel API that works fine locally, presence URLs are called and clients can send data back and forth to eachother via the channel API.</p>\n\n<p>However, once deployed, presence URLs are <em>not</em> called- at least from what I see both in the app itself and in the logs on the Google console (i.e. no logs to /_ah/channel/*). Clients can still connect and send data back and forth to eachother (i.e. can force them to notify on connect via a faked presence call issued via ajax), but no presence</p>\n\n<p>This only happens when I deploy as a module</p>\n\n<p>Here is the app.yaml if that helps:</p>\n\n<pre><code>application: my-app-name\nmodule: chat\nversion: 1\nruntime: go\napi_version: go1\n\ninbound_services:\n- channel_presence\n\nhandlers:\n- url: /static\n  static_dir: static\n\n- url: /.*\n  script: _go_app\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "edited": false, "score": 0, "creation_date": 1422867860, "post_id": 28274022, "comment_id": 44903177, "body": "@Neil I edited my answer, the &quot;new&quot; linked gopass is also cross platform."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1422867688, "last_edit_date": 1422867688, "creation_date": 1422867353, "answer_id": 28274022, "question_id": 28273904, "link": "https://stackoverflow.com/questions/28273904/go-fmt-scanln-that-doesnt-echo-back-characters-typed-by-user-for-password/28274022#28274022", "title": "Go fmt.Scanln that doesn&#39;t echo back characters typed by user. For password", "body": "<p>There is no helper function in the standard library for this.</p>\n\n<p>You have to create your own, or use an existing one like <a href=\"https://github.com/howeyc/gopass\" rel=\"nofollow\"><strong>gopass</strong></a> (supports windows, unix, bsd).</p>\n\n<p><strong>Using gopass:</strong> (example taken from their website)</p>\n\n<pre><code>import \"fmt\"\nimport \"github.com/howeyc/gopass\"\n\nfunc main() {\n    fmt.Printf(\"Password: \")\n    pass := gopass.GetPasswd() // Silent, for *'s use gopass.GetPasswdMasked()\n    // Do something with pass\n}\n</code></pre>\n"}], "owner": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 28274022, "answer_count": 1, "score": 2, "last_activity_date": 1422867688, "creation_date": 1422866948, "question_id": 28273904, "link": "https://stackoverflow.com/questions/28273904/go-fmt-scanln-that-doesnt-echo-back-characters-typed-by-user-for-password", "title": "Go fmt.Scanln that doesn&#39;t echo back characters typed by user. For password", "body": "<p>How do I capture user input from the command line without echoing back the characters that the user types. I want to use this to capture a password. Like <a href=\"https://docs.python.org/2/library/getpass.html#getpass.getpass\" rel=\"nofollow\">getpass.getpass</a> in Python.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var password string\n    fmt.Scanln(&amp;password)\n}\n</code></pre>\n"}, {"tags": ["node.js", "go"], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422866641, "post_id": 28273501, "comment_id": 44902602, "body": "have you seen any serious Go vs. V8/Node benchmarks? the &quot;language shootout&quot; project doesn&#39;t include JS for some reason."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422867033, "post_id": 28273501, "comment_id": 44902778, "body": "@Not_a_Golfer No, I have not. I only know that performance is only one of the factors when switching to Go (as in <a href=\"http://thenewstack.io/from-node-js-to-go-why-one-startup-made-the-switch/\" rel=\"nofollow noreferrer\">thenewstack.io/&hellip;</a>)"}, {"owner": {"reputation": 5, "user_id": 3753986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e563b0672b1a3bdab4d00f88d512b6ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3753986", "link": "https://stackoverflow.com/users/3753986/user3753986"}, "edited": false, "score": 0, "creation_date": 1422868277, "post_id": 28273501, "comment_id": 44903377, "body": "AVonC, any idea on architecure for GO lang"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422871516, "post_id": 28273501, "comment_id": 44905081, "body": "@Not_a_Golfer Seems the &quot;language shootout&quot; project does include  JavaScript V8."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422873158, "post_id": 28273501, "comment_id": 44905997, "body": "oh, found it. I was looking under x64-quad core, and apparently, it doesn&#39;t have v8 benchmarks. <a href=\"http://benchmarksgame.alioth.debian.org/u64/compare.php?lang=v8&amp;lang2=go\" rel=\"nofollow noreferrer\">benchmarksgame.alioth.debian.org/u64/&hellip;</a>"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422876375, "post_id": 28273501, "comment_id": 44907772, "body": "@Not_a_Golfer  <a href=\"http://benchmarksgame.alioth.debian.org/u64/compare.php?lang=v8&amp;lang2=go\" rel=\"nofollow noreferrer\">benchmarksgame.alioth.debian.org/u64/&hellip;</a>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 5, "user_id": 3753986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e563b0672b1a3bdab4d00f88d512b6ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3753986", "link": "https://stackoverflow.com/users/3753986/user3753986"}, "edited": false, "score": 0, "creation_date": 1422876819, "post_id": 28273501, "comment_id": 44907997, "body": "@user3753986 I have edited the answer."}, {"owner": {"reputation": 5, "user_id": 3753986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e563b0672b1a3bdab4d00f88d512b6ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3753986", "link": "https://stackoverflow.com/users/3753986/user3753986"}, "edited": false, "score": 0, "creation_date": 1422933436, "post_id": 28273501, "comment_id": 44935012, "body": "From the bench marks I could see c++ is much faster than go, any reason we need to choose go lang over c++? I have seen the bench marks in the following link:  <a href=\"http://benchmarksgame.alioth.debian.org/u64/compare.php?lang=gpp&amp;lang2=go\" rel=\"nofollow noreferrer\">benchmarksgame.alioth.debian.org/u64/&hellip;</a>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 5, "user_id": 3753986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e563b0672b1a3bdab4d00f88d512b6ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3753986", "link": "https://stackoverflow.com/users/3753986/user3753986"}, "edited": false, "score": 0, "creation_date": 1422944283, "post_id": 28273501, "comment_id": 44938064, "body": "@user3753986 fir the same reason Rob Pike invented Go after seing a C++ presentation about memory management: much simpler to maintain. After that, it is a question of use case: for concurrency, Go is much simpler to use."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1422876599, "last_edit_date": 1495542511, "creation_date": 1422865022, "answer_id": 28273501, "question_id": 28273432, "link": "https://stackoverflow.com/questions/28273432/can-some-one-explain-the-architecture-of-go-lang-is-it-faster-compared-to-nodej/28273501#28273501", "title": "Can some one explain the architecture of GO lang, Is it faster compared to Nodejs &amp; if so what makes it faster", "body": "<p>Note that Go 1.5 will feature its compiler, assembler, linker, and runtime written entirely in Go. </p>\n\n<blockquote>\n  <p>The goal is to have Go written entirely in Go and to rid the codebase of any C code. The only exception to the <a href=\"http://blog.golang.org/c-go-cgo\" rel=\"nofollow noreferrer\">C code is for Cgo</a>. </p>\n</blockquote>\n\n<p>(See <a href=\"https://docs.google.com/document/d/1OaatvGhEAq7VseQ9kkavxKNAfepWy2yhPUBs96FGV28/edit\" rel=\"nofollow noreferrer\">Go 1.5 Bootstrap plan</a>)</p>\n\n<p>The speed is more about about the native code generated, and the simplicity of the language (no genericity means less dynamic data to keep track of)</p>\n\n<p>Go hasn't been always fast: \"<a href=\"https://stackoverflow.com/a/2705047/6309\">Why is go language so slow?</a>\".<br>\nIt improves incrementally, notably on the garbage collection side, and <a href=\"https://stackoverflow.com/a/27676056/6309\">stack management side</a>.</p>\n\n<hr>\n\n<p><a href=\"https://stackoverflow.com/users/4374109/uvelichitel\">Uvelichitel</a> mentions below <a href=\"http://benchmarksgame.alioth.debian.org/u64/compare.php?lang=v8&amp;lang2=go\" rel=\"nofollow noreferrer\">x64 Ubuntu : Intel\u00ae Q6600\u00ae one core -- Computer Language Benchmarks Game</a></p>\n\n<hr>\n\n<p>As for \"Golang Architecture\", this doesn't really apply here (as detailed <a href=\"http://www.quora.com/What-does-golangs-architecture-look-like\" rel=\"nofollow noreferrer\">in this answer</a>):</p>\n\n<blockquote>\n  <p>Go has no VM like the Java JVM. It compiles straight to metal like c/c++.</p>\n</blockquote>\n\n<p>The <a href=\"https://docs.google.com/document/d/1xN-g6qjjWflecSP08LNgh2uFsKjWb-rR9KA11ip_DIE/edit\" rel=\"nofollow noreferrer\">Go 1.3 Linker overhaul</a> mentions:</p>\n\n<blockquote>\n  <p>The current linker performs two separable tasks. </p>\n  \n  <ul>\n  <li>First, it translates an input stream of pseudo-instructions into executable code and data blocks, along with a list of relocations. </li>\n  <li>Second, it deletes dead code, merges what\u2019s left into a single image, resolves relocations, and generates a few whole-program data structures such as the <a href=\"https://docs.google.com/document/d/1lyPIbmsYbXnpNj57a261hgOYVpNRcgydurVQIyZOz_o/pub\" rel=\"nofollow noreferrer\">runtime symbol table</a>.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 5, "user_id": 3753986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e563b0672b1a3bdab4d00f88d512b6ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3753986", "link": "https://stackoverflow.com/users/3753986/user3753986"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 1, "closed_date": 1422870917, "answer_count": 1, "score": -3, "last_activity_date": 1422876599, "creation_date": 1422864706, "question_id": 28273432, "link": "https://stackoverflow.com/questions/28273432/can-some-one-explain-the-architecture-of-go-lang-is-it-faster-compared-to-nodej", "closed_reason": "Needs more focus", "title": "Can some one explain the architecture of GO lang, Is it faster compared to Nodejs &amp; if so what makes it faster", "body": "<p>Can some one explain the architecture of GO lang, Is it faster compared to Nodejs &amp; if so what makes it faster and Go is developed using C/C++, So, does GO beats out in performance when compared to C/C++ and is the only difference between C/C++ &amp; Go is all about more functions which makes developer easy to code using GO?</p>\n"}, {"tags": ["c", "performance", "go", "cgo"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1422860061, "post_id": 28272285, "comment_id": 44900050, "body": "Why do you think that calling a C function from Go should be faster than calling a Go function from Go?"}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "edited": false, "score": 0, "creation_date": 1422905665, "post_id": 28272285, "comment_id": 44924644, "body": "I&#39;d expect the go code to inline the go version of <code>show()</code> which is a further advantage to the go code over <code>C.show()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": -3, "last_activity_date": 1422862266, "creation_date": 1422862266, "answer_id": 28272938, "question_id": 28272285, "link": "https://stackoverflow.com/questions/28272285/why-cgos-performance-is-so-slow-is-there-something-wrong-with-my-testing-code/28272938#28272938", "title": "Why cgo&#39;s performance is so slow? is there something wrong with my testing code?", "body": "<p>There is a little overhead in calling C functions from Go. This cannot be changed.</p>\n"}, {"comments": [{"owner": {"reputation": 341, "user_id": 4407799, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c741afb406509f1b64422fd5fa3879b3?s=128&d=identicon&r=PG&f=1", "display_name": "\u4e60\u660e\u660a", "link": "https://stackoverflow.com/users/4407799/%e4%b9%a0%e6%98%8e%e6%98%8a"}, "edited": false, "score": 0, "creation_date": 1422878919, "post_id": 28272990, "comment_id": 44909142, "body": "Thanks ,it does help me a lot!"}, {"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 1, "creation_date": 1466583440, "post_id": 28272990, "comment_id": 63371544, "body": "This is probably outdated: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/RTtMsgZi88Q\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/RTtMsgZi88Q</a>"}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 34, "last_activity_date": 1422862481, "creation_date": 1422862481, "answer_id": 28272990, "question_id": 28272285, "link": "https://stackoverflow.com/questions/28272285/why-cgos-performance-is-so-slow-is-there-something-wrong-with-my-testing-code/28272990#28272990", "title": "Why cgo&#39;s performance is so slow? is there something wrong with my testing code?", "body": "<p>As you've discovered, there is fairly high overhead in calling C/C++ code via CGo.  So in general, you are best off trying to minimise the number of CGo calls you make.  For the above example, rather than calling a CGo function repeatedly in a loop it might make sense to move the loop down to C.</p>\n\n<p>There are a number of aspects of how the Go runtime sets up its threads that can break the expectations of many pieces of C code:</p>\n\n<ol>\n<li>Goroutines run on a relatively small stack, handling stack growth through segmented stacks (old versions) or by copying (new versions).</li>\n<li>Threads created by the Go runtime may not interact properly with <code>libpthread</code>'s thread local storage implementation.</li>\n<li>The Go runtime's UNIX signal handler may interfere with traditional C or C++ code.</li>\n<li>Go reuses OS threads to run multiple Goroutines.  If the C code called a blocking system call or otherwise monopolised the thread, it could be detrimental to other goroutines.</li>\n</ol>\n\n<p>For these reasons, CGo picks the safe approach of running the C code in a separate thread set up with a traditional stack.</p>\n\n<p>If you are coming from languages like Python where it isn't uncommon to rewrite code hotspots in C as a way to speed up a program you will be disappointed.  But at the same time, there is a much smaller gap in performance between equivalent C and Go code.</p>\n\n<p>In general I reserve CGo for interfacing with existing libraries, possibly with small C wrapper functions that can reduce the number of calls I need to make from Go.</p>\n"}, {"tags": [], "owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "is_accepted": false, "score": 17, "last_activity_date": 1466923540, "last_edit_date": 1495540950, "creation_date": 1466583947, "answer_id": 37962500, "question_id": 28272285, "link": "https://stackoverflow.com/questions/28272285/why-cgos-performance-is-so-slow-is-there-something-wrong-with-my-testing-code/37962500#37962500", "title": "Why cgo&#39;s performance is so slow? is there something wrong with my testing code?", "body": "<p>Update for James's <a href=\"https://stackoverflow.com/a/28272990\">answer</a>: it seems that there's no thread switch in current implementation.</p>\n\n<p>See <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/RTtMsgZi88Q\" rel=\"noreferrer\">this thread</a> on golang-nuts:</p>\n\n<blockquote>\n  <p>There's always going to be some overhead.\n  It's more expensive than a simple function call but\n  significantly less expensive than a context switch\n  (agl is remembering an earlier implementation;\n  <strong>we cut out the thread switch before the public release</strong>).\n  Right now the expense is basically just having to\n  do a full register set switch (no kernel involvement).\n  I'd guess it's comparable to ten function calls.</p>\n</blockquote>\n\n<p>See also <a href=\"https://stackoverflow.com/a/37961486/3169754\">this answer</a> which links <a href=\"http://dave.cheney.net/2016/01/18/cgo-is-not-go\" rel=\"noreferrer\">\"cgo is not Go\"</a> blog post.</p>\n\n<blockquote>\n  <p>C doesn\u2019t know anything about Go\u2019s calling convention or growable stacks, so a call down to C code must record all the details of the goroutine stack, switch to the C stack, and run C code which has no knowledge of how it was invoked, or the larger Go runtime in charge of the program.</p>\n</blockquote>\n\n<p>Thus, cgo has an overhead because it performs a <strong>stack switch</strong>, not thread switch.</p>\n\n<p>It saves and restores <em>all</em> registers when C function is called, while it's not required when Go function or assembly function is called.</p>\n\n<hr>\n\n<p>Besides that, cgo's calling conventions forbid passing Go pointers directly to C code, and common workaround is to use <code>C.malloc</code>, and so introduce additional allocations. See <a href=\"https://stackoverflow.com/questions/38031401/how-can-i-fill-out-void-c-pointer-in-go\">this question</a> for details.</p>\n"}], "owner": {"reputation": 341, "user_id": 4407799, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c741afb406509f1b64422fd5fa3879b3?s=128&d=identicon&r=PG&f=1", "display_name": "\u4e60\u660e\u660a", "link": "https://stackoverflow.com/users/4407799/%e4%b9%a0%e6%98%8e%e6%98%8a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9194, "favorite_count": 10, "accepted_answer_id": 28272990, "answer_count": 3, "score": 13, "last_activity_date": 1470199498, "creation_date": 1422858913, "last_edit_date": 1470199498, "question_id": 28272285, "link": "https://stackoverflow.com/questions/28272285/why-cgos-performance-is-so-slow-is-there-something-wrong-with-my-testing-code", "title": "Why cgo&#39;s performance is so slow? is there something wrong with my testing code?", "body": "<p>I'm doing a test: compare excecution times of cgo and pure Go functions run 100 million times each.  The cgo function takes longer time compared to the Golang function, and I am confused with this result.  My testing code is:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\n/*\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid show() {\n\n}\n\n*/\n// #cgo LDFLAGS: -lstdc++\nimport \"C\"\n\n//import \"fmt\"\n\nfunc show() {\n\n}\n\nfunc main() {\n    now := time.Now()\n    for i := 0; i &lt; 100000000; i = i + 1 {\n        C.show()\n    }\n    end_time := time.Now()\n\n    var dur_time time.Duration = end_time.Sub(now)\n    var elapsed_min float64 = dur_time.Minutes()\n    var elapsed_sec float64 = dur_time.Seconds()\n    var elapsed_nano int64 = dur_time.Nanoseconds()\n    fmt.Printf(\"cgo show function elasped %f minutes or \\nelapsed %f seconds or \\nelapsed %d nanoseconds\\n\",\n        elapsed_min, elapsed_sec, elapsed_nano)\n\n    now = time.Now()\n    for i := 0; i &lt; 100000000; i = i + 1 {\n        show()\n    }\n    end_time = time.Now()\n\n    dur_time = end_time.Sub(now)\n    elapsed_min = dur_time.Minutes()\n    elapsed_sec = dur_time.Seconds()\n    elapsed_nano = dur_time.Nanoseconds()\n    fmt.Printf(\"go show function elasped %f minutes or \\nelapsed %f seconds or \\nelapsed %d nanoseconds\\n\",\n        elapsed_min, elapsed_sec, elapsed_nano)\n\n    var input string\n    fmt.Scanln(&amp;input)\n}\n</code></pre>\n\n<p>and result is:</p>\n\n<pre><code>cgo show function elasped 0.368096 minutes or \nelapsed 22.085756 seconds or \nelapsed 22085755775 nanoseconds\n\ngo show function elasped 0.000654 minutes or \nelapsed 0.039257 seconds or \nelapsed 39257120 nanoseconds\n</code></pre>\n\n<p>The results show that invoking the C function is slower than the Go function. Is there something wrong with my testing code?</p>\n\n<p>My system is : mac OS X 10.9.4 (13E28)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1422852725, "post_id": 28271223, "comment_id": 44898078, "body": "do you need a space before the open curly brace of the <code>if isPrimeNumber(i){</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1017, "user_id": 2601733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AFDjZ.jpg?s=128&g=1", "display_name": "Andy Xu", "link": "https://stackoverflow.com/users/2601733/andy-xu"}, "is_accepted": true, "score": 1, "last_activity_date": 1422854462, "last_edit_date": 1422854462, "creation_date": 1422854142, "answer_id": 28271483, "question_id": 28271223, "link": "https://stackoverflow.com/questions/28271223/golang-strange-error-around-braces-or-return/28271483#28271483", "title": "golang ,strange error around braces or return", "body": "<p>Use <code>channel &lt;- i</code> instead of <code>chan &lt;- i</code>.</p>\n\n<p>In you function definition (<code>channel chan int</code>), <code>channel</code> is parameter's name, and <code>chan int</code> is the type. To clarify, your function could be rewrote to the following one:</p>\n\n<pre><code>func findPrimeNumbers(primeNumberChannel chan int) {\n    for i := 2; ; i++ {\n        if isPrimeNumber(i){\n            primeNumberChannel &lt;- i  \n        }\n    }\n}\n</code></pre>\n\n<p>Additionally, <code>assert</code> is not available in Go (<a href=\"http://golang.org/doc/faq#assertions\" rel=\"nofollow\">http://golang.org/doc/faq#assertions</a>).</p>\n"}], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 28271483, "answer_count": 1, "score": -1, "last_activity_date": 1422854462, "creation_date": 1422852066, "question_id": 28271223, "link": "https://stackoverflow.com/questions/28271223/golang-strange-error-around-braces-or-return", "title": "golang ,strange error around braces or return", "body": "<pre><code>func isPrimeNumber(possiblePrime int) bool {\n    for underPrime := 2; underPrime &lt; possiblePrime; underPrime++ {\n        if possiblePrime%underPrime == 0 {\n            return false\n        }\n    }\n    return true\n}\n\n\nfunc findPrimeNumbers(channel chan int) {\n    for i := 2; ; /* infinite loop */ i++ {\n        // your code goes here\n        if isPrimeNumber(i){\n            chan &lt;- i     &lt;========error on this line\n        }\n        assert(i &lt; 100) // i is afraid of heights\n    }\n}\n</code></pre>\n\n<p>I got error on this but could not figure it out, need help. thanks</p>\n\n<p>syntax error: unexpected semicolon or newline, expecting {\nFAIL    </p>\n"}, {"tags": ["java", "tcp", "go", "tcpclient", "tcpserver"], "answers": [{"tags": [], "owner": {"reputation": 152158, "user_id": 871026, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/TgXEW.png?s=128&g=1", "display_name": "Reimeus", "link": "https://stackoverflow.com/users/871026/reimeus"}, "is_accepted": true, "score": 2, "last_activity_date": 1422832844, "last_edit_date": 1422832844, "creation_date": 1422832418, "answer_id": 28269076, "question_id": 28268997, "link": "https://stackoverflow.com/questions/28268997/echoserver-java-not-returning-message-back-to-client-golang/28269076#28269076", "title": "EchoServer (Java) not returning message back to client (golang)", "body": "<p>Try sending a newline character to match the <code>readLine</code> statement on the server-side</p>\n\n<pre><code>strEcho := \"Hello\\n\"\n</code></pre>\n"}], "owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 28269076, "answer_count": 1, "score": 0, "last_activity_date": 1422832844, "creation_date": 1422831806, "question_id": 28268997, "link": "https://stackoverflow.com/questions/28268997/echoserver-java-not-returning-message-back-to-client-golang", "title": "EchoServer (Java) not returning message back to client (golang)", "body": "<p>I am trying to create a TCP client (golang) server (Java) application where the client writes, the server echos this text and returns the message back to the client, which subsequently echos the reply.</p>\n\n<p><strong>Server code (Java):</strong></p>\n\n<pre><code>public static void main(String[] args) throws Exception {\n\n    int port = 4444;\n    ServerSocket serverSocket = new ServerSocket(port);\n    System.err.println(\"Started server on port \" + port);\n\n    while (true) {\n        Socket clientSocket = serverSocket.accept();\n        System.err.println(\"Accepted connection from client\");\n\n        BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));\n\n        PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true);\n        String s;\n        while ((s = in.readLine()) != null) {\n            out.println(s);\n            System.out.println(s);\n\n        }\n\n        System.err.println(\"Closing connection with client\");\n        out.close();\n        in.close();\n        clientSocket.close();\n    }\n}\n</code></pre>\n\n<p><strong>Client code (golang):</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"net\"\n    \"os\"\n)\n\nfunc main() {\n    strEcho := \"Hello\"\n    servAddr := \"localhost:4444\"\n    tcpAddr, err := net.ResolveTCPAddr(\"tcp\", servAddr)\n    if err != nil {\n        println(\"ResolveTCPAddr failed:\", err.Error())\n        os.Exit(1)\n    }\n\n    conn, err := net.DialTCP(\"tcp\", nil, tcpAddr)\n    if err != nil {\n        println(\"Dial failed:\", err.Error())\n        os.Exit(1)\n    }\n\n    _, err = conn.Write([]byte(strEcho))\n    if err != nil {\n        println(\"Write to server failed:\", err.Error())\n        os.Exit(1)\n    }\n\n    println(\"write to server = \", strEcho)\n\n    reply := make([]byte, 1024)\n    _, err = conn.Read(reply)\n\n    if err != nil {\n        println(\"Write to server failed:\", err.Error())\n        os.Exit(1)\n    }\n\n    println(\"reply from server=\", string(reply))\n\n    conn.Close()\n}\n</code></pre>\n\n<p>When I start the Java server and then run the Go application, the server says that the connection has been accepted (i.e. \"Accepted connection from client\") but never returns the echo back to the client. The client stalls on \"write to server = Hello\" i.e. the write to the server works fine, but the read back to the client does not. Any idea why this is happening?</p>\n"}, {"tags": ["bash", "shell", "go", "sh"], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 2, "last_activity_date": 1422829790, "creation_date": 1422829790, "answer_id": 28268690, "question_id": 28268433, "link": "https://stackoverflow.com/questions/28268433/os-exec-and-bin-sh-executing-multiple-commands/28268690#28268690", "title": "os.Exec and /bin/sh: executing multiple commands", "body": "<p>the quotes are for your shell where you typed the command line, they should not be included when programatically launching an app</p>\n\n<p>just make this change and it will work:</p>\n\n<pre><code>command2 := \"pwd &amp;&amp; pwd\" // you don't want the extra quotes\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4411236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/acc8fcf9b7c403a303be88c8fed25d0c?s=128&d=identicon&r=PG&f=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/4411236/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 28268690, "answer_count": 1, "score": 3, "last_activity_date": 1422829790, "creation_date": 1422827930, "question_id": 28268433, "link": "https://stackoverflow.com/questions/28268433/os-exec-and-bin-sh-executing-multiple-commands", "title": "os.Exec and /bin/sh: executing multiple commands", "body": "<p>I've run into an issue with the <code>os/exec</code> library.  I want to run a shell and pass it multiple commands to run, but it's failing when I do.  Here's my test code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    fmt.Printf(\"-- Test 1 --\\n`\")\n    command1 := fmt.Sprintf(\"\\\"%s\\\"\", \"pwd\") // this one succeeds\n    fmt.Printf(\"Running: %s\\n\", command1)\n    cmd1 := exec.Command(\"/bin/sh\", \"-c\", command1)\n    output1,err1 := cmd1.CombinedOutput()\n    if err1 != nil {\n        fmt.Printf(\"error: %v\\n\", err1)\n        return\n    }\n    fmt.Printf(string(output1))\n\n\n    fmt.Printf(\"-- Test 2 --\\n\")\n    command2 := fmt.Sprintf(\"\\\"%s\\\"\", \"pwd &amp;&amp; pwd\") // this one fails\n    fmt.Printf(\"Running: %s\\n\", command2)\n    cmd2 := exec.Command(\"/bin/sh\", \"-c\", command2)\n    output2,err2 := cmd2.CombinedOutput()\n    if err2 != nil {\n        fmt.Printf(\"error: %v\\n\", err2)\n        return\n    }\n    fmt.Printf(string(output2))\n}\n</code></pre>\n\n<p>When running this I get an error 127 on the second example.  It seems like it's looking for a literal \"pwd &amp;&amp; pwd\" command instead of evaluating it as a script.</p>\n\n<p>If I do the same thing from the command line it works just fine.</p>\n\n<pre><code>$ /bin/sh -c \"pwd &amp;&amp; pwd\"\n</code></pre>\n\n<p>I'm using Go 1.4 on OS X 10.10.2.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1422817910, "post_id": 28266589, "comment_id": 44889644, "body": "In binary, <code>101</code> xor&#39;d with <code>010</code> is <code>111</code>."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 4, "creation_date": 1422818755, "post_id": 28266589, "comment_id": 44889922, "body": "This is not <code>go</code> specific <code>^</code> is <code>XOR</code> operator in most programming languages."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 7, "last_activity_date": 1422817835, "creation_date": 1422817835, "answer_id": 28266648, "question_id": 28266589, "link": "https://stackoverflow.com/questions/28266589/in-go-lang-why-this-is-7-assert52-7/28266648#28266648", "title": "in go lang, why this is 7 ? assert(5^2 == 7)", "body": "<p>It is an <a href=\"https://golang.org/ref/spec#Arithmetic_operators\">Arithmetic operators</a>:</p>\n\n<pre><code>^    bitwise XOR            integers\n</code></pre>\n\n<p>You can see it on this <a href=\"http://www.miniwebtool.com/bitwise-calculator/?data_type=10&amp;number1=5&amp;number2=2&amp;operator=XOR\">Bitwise Calculator</a></p>\n\n<pre><code>Result in binary    111\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1422817880, "creation_date": 1422817880, "answer_id": 28266659, "question_id": 28266589, "link": "https://stackoverflow.com/questions/28266589/in-go-lang-why-this-is-7-assert52-7/28266659#28266659", "title": "in go lang, why this is 7 ? assert(5^2 == 7)", "body": "<p>The <code>^</code> operator is the XOR (exclusive OR), applied bitwise if operands are numbers.</p>\n\n<pre><code>5 = 101b // in binary, but Go doesn't have binary literals\n2 = 010b\nXOR:\n7 = 111b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 676, "user_id": 2122085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7febb82f8ebb1d3278e249ff0bd83cdd?s=128&d=identicon&r=PG", "display_name": "Takashi Oguma", "link": "https://stackoverflow.com/users/2122085/takashi-oguma"}, "is_accepted": false, "score": 2, "last_activity_date": 1422845039, "creation_date": 1422845039, "answer_id": 28270446, "question_id": 28266589, "link": "https://stackoverflow.com/questions/28266589/in-go-lang-why-this-is-7-assert52-7/28270446#28270446", "title": "in go lang, why this is 7 ? assert(5^2 == 7)", "body": "<p>As others already described, ^ is an operator for XOR. If you want to calculate the square of 5, you can use math.Pow() function.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    fmt.Printf(\"square of 5 = %f\\n\", math.Pow(5,2))\n}\n</code></pre>\n"}], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 1, "accepted_answer_id": 28266659, "answer_count": 3, "score": 2, "last_activity_date": 1422845039, "creation_date": 1422817562, "question_id": 28266589, "link": "https://stackoverflow.com/questions/28266589/in-go-lang-why-this-is-7-assert52-7", "title": "in go lang, why this is 7 ? assert(5^2 == 7)", "body": "<p>in go lang, why this is 7 ?</p>\n\n<p><code>assert(5^2 == 7)</code></p>\n\n<p>so strange.\nI tried to google it. but google does not work well with special characters.\nThanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 0, "creation_date": 1422809960, "post_id": 28265225, "comment_id": 44887066, "body": "I googled the error and and found <a href=\"https://github.com/docker/docker-network/issues/2\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://code.google.com/p/go/issues/detail?id=9211\" rel=\"nofollow noreferrer\">this</a> which seem to imply you need go1.4 to build it."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 2, "last_activity_date": 1422813114, "creation_date": 1422813114, "answer_id": 28265813, "question_id": 28265225, "link": "https://stackoverflow.com/questions/28265225/go-get-sys-textflag-h-missing/28265813#28265813", "title": "go get sys: textflag.h missing", "body": "<p>The sys package was introduced as a replacement for syscall in go 1.4, I would assume that it doesn't work in versions prior to 1.4.</p>\n\n<p>if you cannot upgrade, look at the syscall package to see if it meets your needs.</p>\n"}], "owner": {"reputation": 741, "user_id": 3569471, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9139a126d3b268b1c52c5cc438a57f85?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3569471/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1928, "favorite_count": 0, "accepted_answer_id": 28265813, "answer_count": 1, "score": 0, "last_activity_date": 1422813114, "creation_date": 1422809797, "question_id": 28265225, "link": "https://stackoverflow.com/questions/28265225/go-get-sys-textflag-h-missing", "title": "go get sys: textflag.h missing", "body": "<p>I am trying to use the \"sys\" package in a go program. So I did</p>\n\n<pre><code>go get golang.org/x/sys/unix\n</code></pre>\n\n<p>and got </p>\n\n<pre><code># golang.org/x/sys/unix\nsrc/golang.org/x/sys/unix/asm.s:6 6a: No such file or directory: textflag.h\n</code></pre>\n\n<p>I am on Fedora 20, using \n    go version go1.3.3 linux/amd64</p>\n\n<p>Any ideas how to solve this? </p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1422804894, "creation_date": 1422804894, "answer_id": 28264422, "question_id": 28264343, "link": "https://stackoverflow.com/questions/28264343/json-unmarshal-return-nil/28264422#28264422", "title": "json.unmarshal() - return nil", "body": "<p>You are printing the error returned by <a href=\"http://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\"><code>json.Unmarshal</code></a> not the actual decoded value. It is <code>nil</code> so everything is fine.</p>\n\n<p>It should be:</p>\n\n<pre><code>coded := redis.LoadFromBase()\nerr := json.Unmarshal(coded, &amp;p)\nif (err != nil) {\n    // handle error here\n}\n\nfmt.Println(\"Bytes:\", coded)\nfmt.Println(\"Unmarshalled:\", p)\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4489257, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/755572e35afde5bf222b3096a3b9d36b?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Lis", "link": "https://stackoverflow.com/users/4489257/maxim-lis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1496, "favorite_count": 0, "accepted_answer_id": 28264422, "answer_count": 1, "score": 1, "last_activity_date": 1534849081, "creation_date": 1422804438, "last_edit_date": 1534849081, "question_id": 28264343, "link": "https://stackoverflow.com/questions/28264343/json-unmarshal-return-nil", "title": "json.unmarshal() - return nil", "body": "<p>I get normal slice a bytes from base (slice maked by json.Marshal) and try decode them, but json.unmarshal() - return nil</p>\n\n<p>Code :</p>\n\n<pre><code>coded := redis.LoadFromBase()\nuncoded := json.Unmarshal(coded, &amp;p)\n\nfmt.Println(\"Bytes:\", coded)\nfmt.Println(\"Unmarshalled:\", uncoded)\n</code></pre>\n\n<p>Returned:</p>\n\n<pre><code>Bytes: [123 34 84 105 116 108 101 34 58 34 97 34 44 34 67 111 110 116 101 110 116 34 58 34 98 34 125]\nUnmarshalled: &lt;nil&gt;\n</code></pre>\n\n<p>LoadFromBase() works fine</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 4407799, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c741afb406509f1b64422fd5fa3879b3?s=128&d=identicon&r=PG&f=1", "display_name": "\u4e60\u660e\u660a", "link": "https://stackoverflow.com/users/4407799/%e4%b9%a0%e6%98%8e%e6%98%8a"}, "edited": false, "score": 0, "creation_date": 1422859031, "post_id": 28263846, "comment_id": 44899748, "body": "but it seems that cgo is very slower?? <a href=\"http://stackoverflow.com/questions/28272285/why-is-cgos-performance-is-so-slow-is-there-something-wrong-with-my-testing-co\" title=\"why is cgos performance is so slow is there something wrong with my testing co\">stackoverflow.com/questions/28272285/&hellip;</a>"}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 6, "last_activity_date": 1463545853, "last_edit_date": 1463545853, "creation_date": 1422801338, "answer_id": 28263846, "question_id": 28263276, "link": "https://stackoverflow.com/questions/28263276/how-to-use-stdvector-or-other-container-in-cgo-of-golang/28263846#28263846", "title": "How to use std::vector or other container in cgo of golang?", "body": "<p>While you can use C++ with CGo, you can't embed that code inside the <code>.go</code> file, since it ultimately gets built with a C compiler.</p>\n\n<p>Instead, place your <code>dosome</code> function in a separate <code>.cpp</code> file in the same directory as the <code>.go</code> file, and declare your function to use C linkage.  For example:</p>\n\n<pre><code>extern \"C\" {\n    void dosome() {\n        vector&lt;int&gt; ivec;\n        ...\n    }\n}\n</code></pre>\n\n<p>If you include a prototype for the function in the CGo comment in the <code>.go</code> file so you can call it from Go.</p>\n\n<p>Since you have multiple files now, you can't use the <code>go run foo.go</code> shorthand any more (since it only compiles a single file).  Instead, you will need to use <code>go run package</code> or <code>go build package</code>, where your code is located at <code>$GOPATH/src/package</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 341, "user_id": 4407799, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c741afb406509f1b64422fd5fa3879b3?s=128&d=identicon&r=PG&f=1", "display_name": "\u4e60\u660e\u660a", "link": "https://stackoverflow.com/users/4407799/%e4%b9%a0%e6%98%8e%e6%98%8a"}, "edited": false, "score": 0, "creation_date": 1422858253, "post_id": 28264081, "comment_id": 44899497, "body": "thank you very much. It seems that i totally go to the wrong way!"}, {"owner": {"reputation": 341, "user_id": 4407799, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c741afb406509f1b64422fd5fa3879b3?s=128&d=identicon&r=PG&f=1", "display_name": "\u4e60\u660e\u660a", "link": "https://stackoverflow.com/users/4407799/%e4%b9%a0%e6%98%8e%e6%98%8a"}, "edited": false, "score": 0, "creation_date": 1422858980, "post_id": 28264081, "comment_id": 44899724, "body": "cgo function seems much more slower than go function? <a href=\"http://stackoverflow.com/questions/28272285/why-is-cgos-performance-is-so-slow-is-there-something-wrong-with-my-testing-co\" title=\"why is cgos performance is so slow is there something wrong with my testing co\">stackoverflow.com/questions/28272285/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13962, "user_id": 52573, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f46863ecd43e4ac1a482558a8a13683d?s=128&d=identicon&r=PG", "display_name": "nes1983", "link": "https://stackoverflow.com/users/52573/nes1983"}, "is_accepted": false, "score": 4, "last_activity_date": 1422802841, "creation_date": 1422802841, "answer_id": 28264081, "question_id": 28263276, "link": "https://stackoverflow.com/questions/28263276/how-to-use-stdvector-or-other-container-in-cgo-of-golang/28264081#28264081", "title": "How to use std::vector or other container in cgo of golang?", "body": "<p>Uhh I think your conclusions are a bit too fast. GC cost is driven by two things: The more garbage your program produces, the more the GC will have to run. Second: The more pointers there are to scan, the longer a single GC will take. </p>\n\n<p>That is to say: as long as you put your 100 million things into a go slice and keep them there: the GC won't have to run much, because there's no garbage. And second: if your things don't contain pointers, GC time, should it still occur, will be fine. </p>\n\n<p>So, my question is: do your things have pointers?</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 11639160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5adcfcd7961080c20363080bf57c612c?s=128&d=identicon&r=PG&f=1", "display_name": "user_number153", "link": "https://stackoverflow.com/users/11639160/user-number153"}, "is_accepted": false, "score": 0, "last_activity_date": 1567700180, "creation_date": 1567700180, "answer_id": 57809449, "question_id": 28263276, "link": "https://stackoverflow.com/questions/28263276/how-to-use-stdvector-or-other-container-in-cgo-of-golang/57809449#57809449", "title": "How to use std::vector or other container in cgo of golang?", "body": "<p>if you just want to call someone's golang code this is a quick ram inefficient way:</p>\n\n<pre><code>package main\n\nimport \"C\"\nimport \"fmt\"\nimport \"unsafe\"\n\nfunc intArrayFromC (src unsafe.Pointer, sz int) []uint64 {\n    dest := make([]uint64, sz)\n    copy(dest, (*(*[1000000000]uint64)(unsafe.Pointer(src)))[:sz:sz])// big number dose not affect ram.\n    return dest\n}\n\n//export doPrint\nfunc doPrint(src unsafe.Pointer, sz int){\n    var numbers []uint64 = intArrayFromC(src, sz);\n\n    for i := 0; i &lt; len(numbers); i++ {\n        fmt.Printf(\"%d  index: %d\\n\", numbers[i], i)\n    }\n}\n\nfunc main() {}\n</code></pre>\n\n<p>and the c++ code:</p>\n\n<pre><code>#include \"print.h\"\n#include &lt;string.h&gt;\n#include &lt;vector&gt;\n\nint main() {\n    std::vector&lt;GoUint64&gt; numbers{99,44,11,00,2,33,44};\n\n    while (1) {\n        doPrint(numbers.data(), numbers.size());\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 4407799, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c741afb406509f1b64422fd5fa3879b3?s=128&d=identicon&r=PG&f=1", "display_name": "\u4e60\u660e\u660a", "link": "https://stackoverflow.com/users/4407799/%e4%b9%a0%e6%98%8e%e6%98%8a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2947, "favorite_count": 1, "answer_count": 3, "score": 5, "last_activity_date": 1567700180, "creation_date": 1422797759, "last_edit_date": 1554107383, "question_id": 28263276, "link": "https://stackoverflow.com/questions/28263276/how-to-use-stdvector-or-other-container-in-cgo-of-golang", "title": "How to use std::vector or other container in cgo of golang?", "body": "<p>I want to malloc large number of objects in to memory.(about 100 million objects) because the gc of golang is not effective enough,so i need to use c/c++ to malloc memory and use std::vector to hold objects.\nthis is my code,i want use std container in cgo:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\n/*\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;vector&gt;\n\n\nusing namespace std;\n\nvoid dosome(){\n    vector&lt;int&gt; ivec;   // empty vector\n    for (vector&lt;int&gt;::size_type ix = 0; ix != 10; ++ix)\n        ivec[ix] = ix; // disaster: ivec has no elements\n}\n\n*/\n// #cgo LDFLAGS: -lstdc++\nimport \"C\"\n\n//import \"fmt\"\nfunc main() {\n\n    C.dosome()\n\n    var input string\n    fmt.Scanln(&amp;input)\n}\n</code></pre>\n\n<p>and have error message below:</p>\n\n<pre><code>go run stddemo.go \n# command-line-arguments\n./stddemo.go:13:10: fatal error: 'vector' file not found\n#include &lt;vector&gt;\n     ^\n1 error generated.\n</code></pre>\n\n<p>how can i set the include path or is there another idea?</p>\n"}, {"tags": ["html", "templates", "go"], "comments": [{"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 0, "creation_date": 1426151646, "post_id": 28262392, "comment_id": 46257534, "body": "Hi, I have come to this particular problem to, do you have found a better solution for this?"}], "answers": [{"comments": [{"owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "edited": false, "score": 0, "creation_date": 1422808849, "post_id": 28263012, "comment_id": 44886735, "body": "Hmm, this doesn&#39;t seem to work when using it in a loop though <code>{{ .$value.Rating.Id }}</code>"}, {"owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "edited": false, "score": 0, "creation_date": 1422890780, "post_id": 28263012, "comment_id": 44916084, "body": "FYI, just using <code>{{ $value.Rating.Id }}</code> prints out: <code>ObjectIdHex(&quot;54ce0e86d2b38b9d26000001&quot;)</code> and not the actual string"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1422795892, "creation_date": 1422795892, "answer_id": 28263012, "question_id": 28262392, "link": "https://stackoverflow.com/questions/28262392/bson-objectid-in-a-template/28263012#28263012", "title": "bson.ObjectId in a template", "body": "<p>Things like to work <a href=\"https://play.golang.org/p/1LG1NlFEK-\" rel=\"nofollow\">playground</a>\nJust define dot <code>.</code> for your template</p>\n\n<pre><code>{{ .Name }} {{ .Food }}\n&lt;a href=\"/remove/{{ .Id }}\"&gt;Remove me&lt;/a&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "edited": false, "score": 0, "creation_date": 1422862101, "post_id": 28271620, "comment_id": 44900765, "body": "How would this work if I&#39;m using this in a template? <code>Id.Hex()</code> doesn&#39;t seem to be accepted"}, {"owner": {"reputation": 1017, "user_id": 2601733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AFDjZ.jpg?s=128&g=1", "display_name": "Andy Xu", "link": "https://stackoverflow.com/users/2601733/andy-xu"}, "reply_to_user": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "edited": false, "score": 0, "creation_date": 1422865383, "post_id": 28271620, "comment_id": 44902052, "body": "@woutr_be try to pass the string when you call <code>template.Execute</code>?"}, {"owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "edited": false, "score": 0, "creation_date": 1422886946, "post_id": 28271620, "comment_id": 44913547, "body": "The problem that I&#39;m having is that the <code>Id</code> in my struct is defined as a <code>bson.ObjectId</code>, so if I use <code>.Hex()</code> on it, it won&#39;t match the type anymore. Not sure what the solution for that is"}, {"owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "edited": false, "score": 0, "creation_date": 1422934587, "post_id": 28271620, "comment_id": 44935261, "body": "the only solution I found so far was to add a new parameter in my struct <code>String_id string</code>, which works fine. Although not sure if it&#39;s the best solution."}, {"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "reply_to_user": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "edited": false, "score": 0, "creation_date": 1426154132, "post_id": 28271620, "comment_id": 46258822, "body": "@woutr_be Could you please be more specific how to add this <code>String_id string</code> ? in the retrieved data structure? won&#39;t that influence the result stored in db when insert data with that?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426187515, "post_id": 28271620, "comment_id": 46280639, "body": "You should be able to just use {{.Id.Hex}} in the template to call that method. E.g. see <a href=\"https://play.golang.org/p/NfZ-Jv7Ck3\" rel=\"nofollow noreferrer\">play.golang.org/p/NfZ-Jv7Ck3</a>. See the <a href=\"https://golang.org/pkg/text/template/#hdr-Arguments\" rel=\"nofollow noreferrer\">documentation</a>."}], "tags": [], "owner": {"reputation": 1017, "user_id": 2601733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AFDjZ.jpg?s=128&g=1", "display_name": "Andy Xu", "link": "https://stackoverflow.com/users/2601733/andy-xu"}, "is_accepted": true, "score": 1, "last_activity_date": 1422855063, "creation_date": 1422855063, "answer_id": 28271620, "question_id": 28262392, "link": "https://stackoverflow.com/questions/28262392/bson-objectid-in-a-template/28271620#28271620", "title": "bson.ObjectId in a template", "body": "<p>Calling <code>id.Hex()</code> will return a string representation of the <code>bson.ObjectId</code>.</p>\n\n<p>This is also the default behavior if you try to marshal one <code>bson.ObjectId</code> to json string.</p>\n"}, {"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473416201, "post_id": 29011856, "comment_id": 66142871, "body": "This is correct. While generating a new Object ID, you could call bson.NewObjectId().Hex() and get the string only - in case you later want to insert that to a database and you use string type _id fields"}], "tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": false, "score": 4, "last_activity_date": 1426168873, "creation_date": 1426168873, "answer_id": 29011856, "question_id": 28262392, "link": "https://stackoverflow.com/questions/28262392/bson-objectid-in-a-template/29011856#29011856", "title": "bson.ObjectId in a template", "body": "<p>The <a href=\"http://gopkg.in/mgo.v2/bson#ObjectId\" rel=\"nofollow\">bson.ObjectId</a> type offers a <a href=\"http://gopkg.in/mgo.v2/bson#ObjectId.Hex\" rel=\"nofollow\">Hex</a> method that will return the hex representation you are looking for, and the <a href=\"http://golang.org/pkg/html/template\" rel=\"nofollow\">template</a> package allows one to call arbitrary methods on values you have at hand, so there's no need to store that value in duplicity anywhere else as a string.</p>\n\n<p>This would work, for example:</p>\n\n<pre><code>&lt;a href=\"/remove/{{ .Id.Hex }}\"&gt;Remove me&lt;/a&gt;\n</code></pre>\n"}], "owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 2, "accepted_answer_id": 28271620, "answer_count": 3, "score": 5, "last_activity_date": 1426168873, "creation_date": 1422791639, "question_id": 28262392, "link": "https://stackoverflow.com/questions/28262392/bson-objectid-in-a-template", "title": "bson.ObjectId in a template", "body": "<p>I have a struct with a bson.ObjectId type, for example something like this:</p>\n\n<pre><code>type Test struct {\n     Id bson.ObjectId\n     Name string\n     Foo string\n}\n</code></pre>\n\n<p>I want to render this in an html template</p>\n\n<pre><code>{{ Name }} {{ Food }}\n&lt;a href=\"/remove/{{ Id }}\"&gt;Remove me&lt;/a&gt;\n</code></pre>\n\n<p>But this obviously doesn't work since <code>{{ Id }}</code> would just return a ObjectId type, is there a way to convert this into a string inside the template?</p>\n\n<p>Or do I have to do this when I pass data to the <code>template.Execute</code>?</p>\n"}, {"tags": ["sqlite", "go", "clang", "cgo"], "comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1422835033, "post_id": 28262389, "comment_id": 44894715, "body": "Do you have an ARM Linux cross compiler tool chain installed?"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1422940759, "post_id": 28262389, "comment_id": 44936948, "body": "As the bug report you linked to says, you will need a C compiler that targets ARM Linux.  While the Go toolchain comes with everything you need to cross compile pure Go code, it doesn&#39;t include the tools needed to cross compile the C components of packages that use cgo."}, {"owner": {"reputation": 249, "user_id": 1644033, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/25a28669256c08e8b495ced8e69507a4?s=128&d=identicon&r=PG&f=1", "display_name": "user1644033", "link": "https://stackoverflow.com/users/1644033/user1644033"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1422984405, "post_id": 28262389, "comment_id": 44961175, "body": "After hours of reading some stuff about cgo. I find this out to. Thanks for your time!"}], "answers": [{"tags": [], "owner": {"reputation": 249, "user_id": 1644033, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/25a28669256c08e8b495ced8e69507a4?s=128&d=identicon&r=PG&f=1", "display_name": "user1644033", "link": "https://stackoverflow.com/users/1644033/user1644033"}, "is_accepted": true, "score": 1, "last_activity_date": 1422984509, "creation_date": 1422984509, "answer_id": 28305067, "question_id": 28262389, "link": "https://stackoverflow.com/questions/28262389/golang-cgo-clang-with-sqlite3-c/28305067#28305067", "title": "golang: CGO / clang with sqlite3.c", "body": "<p>\"As the bug report you linked to says, you will need a C compiler that targets ARM Linux. While the Go toolchain comes with everything you need to cross compile pure Go code, it doesn't include the tools needed to cross compile the C components of packages that use cgo.\" \u2013  James Henstridge</p>\n\n<p>The result, I compiled it on the arm device (raspberrypi).</p>\n"}], "owner": {"reputation": 249, "user_id": 1644033, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/25a28669256c08e8b495ced8e69507a4?s=128&d=identicon&r=PG&f=1", "display_name": "user1644033", "link": "https://stackoverflow.com/users/1644033/user1644033"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2186, "favorite_count": 0, "accepted_answer_id": 28305067, "answer_count": 1, "score": 2, "last_activity_date": 1422984509, "creation_date": 1422791633, "question_id": 28262389, "link": "https://stackoverflow.com/questions/28262389/golang-cgo-clang-with-sqlite3-c", "title": "golang: CGO / clang with sqlite3.c", "body": "<p>I would like to compile to arm on osx.\nWith the following command:\nGOOS=linux GOARCH=arm CGO_ENABLED=1 go build -o foo main.go</p>\n\n<p>But I get:\nruntime/cgo\nclang: error: argument unused during compilation: '-mno-thumb'</p>\n\n<p>I use this package: <a href=\"https://github.com/mattn/go-sqlite3\" rel=\"nofollow\">https://github.com/mattn/go-sqlite3</a>\nI tried the hints: <a href=\"https://github.com/mattn/go-sqlite3/issues/106\" rel=\"nofollow\">https://github.com/mattn/go-sqlite3/issues/106</a></p>\n\n<p>Thanks for every help :-)</p>\n"}, {"tags": ["cookies", "go"], "comments": [{"owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "edited": false, "score": 0, "creation_date": 1422812900, "post_id": 28262376, "comment_id": 44887994, "body": "Would you please why I get a -1?"}], "answers": [{"tags": [], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "is_accepted": true, "score": 11, "last_activity_date": 1422794606, "creation_date": 1422794606, "answer_id": 28262843, "question_id": 28262376, "link": "https://stackoverflow.com/questions/28262376/parse-cookie-string-in-golang/28262843#28262843", "title": "Parse cookie string in golang", "body": "<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc main() {\n    rawCookies := \"cookie1=value1;cookie2=value2\"\n    rawRequest := fmt.Sprintf(\"GET / HTTP/1.0\\r\\nCookie: %s\\r\\n\\r\\n\", rawCookies)\n\n    req, err := http.ReadRequest(bufio.NewReader(strings.NewReader(rawRequest)))\n\n    if err == nil {\n        cookies := req.Cookies()\n        fmt.Println(cookies)\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/TsY6RlGADT\">Playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1585631570, "post_id": 33926065, "comment_id": 107821380, "body": "Just a note, the text from <code>document.cookie</code> and the header value <code>Set-Cookie</code> are not the same. This won&#39;t work if you&#39;re trying to parse the cookie from a <code>Set-Cookie</code> header. Mixing the two messed me up. This answer is 100% right though."}], "tags": [], "owner": {"reputation": 3547, "user_id": 546750, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5e663c9fc0ebe46af81b8a49d5e2aa91?s=128&d=identicon&r=PG", "display_name": "ahmy", "link": "https://stackoverflow.com/users/546750/ahmy"}, "is_accepted": false, "score": 27, "last_activity_date": 1448484136, "creation_date": 1448484136, "answer_id": 33926065, "question_id": 28262376, "link": "https://stackoverflow.com/questions/28262376/parse-cookie-string-in-golang/33926065#33926065", "title": "Parse cookie string in golang", "body": "<p>A bit shorter version</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    rawCookies := \"cookie1=value1;cookie2=value2\"\n\n    header := http.Header{}\n    header.Add(\"Cookie\", rawCookies)\n    request := http.Request{Header: header}\n\n    fmt.Println(request.Cookies()) // [cookie1=value1 cookie2=value2]\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/PLVwT6Kzr9\" rel=\"noreferrer\">http://play.golang.org/p/PLVwT6Kzr9</a></p>\n"}], "owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13109, "favorite_count": 4, "accepted_answer_id": 28262843, "answer_count": 2, "score": 15, "last_activity_date": 1589419412, "creation_date": 1422791555, "last_edit_date": 1488741487, "question_id": 28262376, "link": "https://stackoverflow.com/questions/28262376/parse-cookie-string-in-golang", "title": "Parse cookie string in golang", "body": "<p>If I get the cookie by typing <code>document.cookie</code> in the browser, is there any way to parse the raw string and save it as a <a href=\"http://golang.org/pkg/net/http/#Cookie\" rel=\"noreferrer\">http.Cookie</a>?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "edited": false, "score": 0, "creation_date": 1423096894, "post_id": 28313755, "comment_id": 45015192, "body": "Thank you @anonymous4444. That makes a lot of sense -- I would never thought about this. Is there anything you would recommend that I do to ensure it does not lead to any security issues? The file upload form is for logged in users only and the files themselves are not displayed publicly and no destructive action can be taken."}], "tags": [], "owner": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "is_accepted": true, "score": 1, "last_activity_date": 1423025678, "creation_date": 1423025678, "answer_id": 28313755, "question_id": 28260883, "link": "https://stackoverflow.com/questions/28260883/http-400-when-using-nosurf-and-appengine-blobstore/28313755#28313755", "title": "HTTP 400 When Using Nosurf and Appengine Blobstore", "body": "<p>The blobstore upload URL works by actually posting your file upload to a special <code>/_ah/...</code> route on your app, which is not actually handled by your app but is used as a signal for the infrastructure to send the data over to the storage upload handler, which is an internal handler that does the actual put to storage. </p>\n\n<p>The callback route you pass to the function that generated the upload URL is the route on your app which will receive a request once this is done that contains not the file data but the file metadata, such as the filenames, along with any other parameters passed to the request (such as, importantly, the CSRF token). </p>\n\n<p>The token which you pass, however, was generated from a call to <code>nosurf.Token(r)</code>, where <code>r</code> is the request <em>the user's browser made to your app at the time the page was generated</em>. When the storage upload handler sends the callback request to your <code>/upload</code> route, nosurf expects the client that sent the request to have a valid CSRF token generated for <em>that client</em> (the storage upload handler) and validates that request based on that expectation. Instead it receives the CSRF token that was generated for the page which you originally sent to the user, containing the form.</p>\n"}], "owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 28313755, "answer_count": 1, "score": 0, "last_activity_date": 1423025678, "creation_date": 1422779473, "question_id": 28260883, "link": "https://stackoverflow.com/questions/28260883/http-400-when-using-nosurf-and-appengine-blobstore", "title": "HTTP 400 When Using Nosurf and Appengine Blobstore", "body": "<p>I am using the Appengine Blob store <a href=\"https://cloud.google.com/appengine/docs/go/blobstore/\" rel=\"nofollow\">example</a> and it works fine (I modified to take two files but that is not the issue). However, when I turn on <a href=\"https://github.com/justinas/nosurf\" rel=\"nofollow\">nosurf</a> it gives me a <code>HTTP 400</code>. I am passing in the csrf token to my form. The issue exists even if I just upload one file.  </p>\n\n<p><code>nosurf</code> works just fine for other forms but only gives me trouble with blobstore file upload. </p>\n\n<p>Since the code is large (it is the just the example with some minor tweaks), I have put it here: <a href=\"http://play.golang.org/p/SJADmn-WvJ\" rel=\"nofollow\">http://play.golang.org/p/SJADmn-WvJ</a> (of course you cannot run it there as you need app-engine and nosurf)</p>\n\n<p>Small parts of the code: </p>\n\n<pre><code>const rootTemplateHTML = `\n&lt;html&gt;&lt;body&gt;\n&lt;form action=\"{{.UpUrl}}\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\n    Upload File: &lt;input type=\"file\" name=\"file1\"&gt;&lt;br&gt;\n    Upload File: &lt;input type=\"file\" name=\"file2\"&gt;&lt;br&gt;\n    &lt;input type=\"hidden\" name=\"csrf_token\" value=\"{{ .Token }}\"&gt;\n    &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;&lt;/html&gt;\n`\n</code></pre>\n\n<p>This does not work: </p>\n\n<pre><code>    http.Handle(\"/\", nosurf.New(http.HandlerFunc(handleRoot)))\n    http.Handle(\"/upload\", nosurf.New(http.HandlerFunc(handleUpload)))\n    http.HandleFunc(\"/serve/\", handleServe)\n</code></pre>\n\n<p>But this works (no <code>400</code> status): </p>\n\n<pre><code>    http.HandleFunc(\"/\", handleRoot)\n    http.HandleFunc(\"/serve/\", handleServe)\n    http.HandleFunc(\"/upload\", handleUpload)\n</code></pre>\n\n<p>Is this something to do with <code>nosurf</code> or <code>app-engine</code>? Any suggestions on what I should do to fix this issue?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "scope"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1422771665, "post_id": 28259941, "comment_id": 44877658, "body": "Dupicate of <a href=\"http://stackoverflow.com/questions/21293000/go-build-works-fine-but-go-run-fails\" title=\"go build works fine but go run fails\">stackoverflow.com/questions/21293000/&hellip;</a> ,"}], "answers": [{"tags": [], "owner": {"reputation": 16513, "user_id": 95642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/36cf75fa7751ef674df65ab65cecd255?s=128&d=identicon&r=PG", "display_name": "Drew LeSueur", "link": "https://stackoverflow.com/users/95642/drew-lesueur"}, "is_accepted": true, "score": -1, "last_activity_date": 1422770784, "creation_date": 1422770784, "answer_id": 28260010, "question_id": 28259941, "link": "https://stackoverflow.com/questions/28259941/go-main-package-in-two-files/28260010#28260010", "title": "Go main package in two files", "body": "<p>If I run <code>go run *.go</code> it works.<br>\nIt also works if I <code>go build</code> and then <code>./testapp</code>.<br>\nHopefully this question helps someone in the future.</p>\n\n<p>Some comments on this page helped me: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/555\" rel=\"nofollow\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/555</a></p>\n"}], "owner": {"reputation": 16513, "user_id": 95642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/36cf75fa7751ef674df65ab65cecd255?s=128&d=identicon&r=PG", "display_name": "Drew LeSueur", "link": "https://stackoverflow.com/users/95642/drew-lesueur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 1, "closed_date": 1423303719, "accepted_answer_id": 28260010, "answer_count": 1, "score": -2, "last_activity_date": 1422770784, "creation_date": 1422769987, "last_edit_date": 1422770312, "question_id": 28259941, "link": "https://stackoverflow.com/questions/28259941/go-main-package-in-two-files", "closed_reason": "Duplicate", "title": "Go main package in two files", "body": "<p>In <code>$GOPATH/src/testapp</code> I have two files</p>\n\n<ul>\n<li><code>main.go</code></li>\n<li><code>otherfile.go</code></li>\n</ul>\n\n<p>main.go has</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n  fmt.Println(SomeFunc())\n}\n</code></pre>\n\n<p>otherfile.go has</p>\n\n<pre><code>package main\n\nfunc SomeFunc() string {\n  return \"a thing\"\n}\n</code></pre>\n\n<p>When I try to run with <code>go run main.go</code>, I get an error</p>\n\n<pre><code>./main.go:6: undefined: SomeFunc\n</code></pre>\n\n<p>I thought I could create another file with <code>package main</code> and code in <code>main.go</code> would have access to its declarations. Why doesn't this work? How would I do something like this?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "edited": false, "score": 0, "creation_date": 1422767004, "post_id": 28259565, "comment_id": 44876920, "body": "This helped thank you! As for sending it back to the front end, is json.Marshal the way to go or would you recommend something else that would be better?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "edited": false, "score": 0, "creation_date": 1422768570, "post_id": 28259565, "comment_id": 44877180, "body": "Use json.Marshal or json.NewEncoder(w).Encode(v) where w is the http.ResposneWriter and v is the value you want to send back to the frontend."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1422766667, "last_edit_date": 1422766667, "creation_date": 1422765891, "answer_id": 28259565, "question_id": 28259300, "link": "https://stackoverflow.com/questions/28259300/why-doesnt-this-json-decode-into-my-struct/28259565#28259565", "title": "Why doesn&#39;t this JSON decode into my struct?", "body": "<p>Decode the JSON value directly to a <code>map[string]int</code>. The map corresponds to the one object in the JSON value.</p>\n\n<pre><code>decoder := json.NewDecoder(r.Body)\nvar t map[string]int\nerr := decoder.Decode(&amp;t)\nif err != nil {\n    log.Println(\"I tried\")\n    log.Println(r.Body)\n}\nlog.Println(t)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/D0Wn-v4bcl\" rel=\"nofollow\">similar playground example</a></p>\n"}], "owner": {"reputation": 970, "user_id": 2807904, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/74cf72489d0114349f7c5e0966ba6e05?s=128&d=identicon&r=PG&f=1", "display_name": "irregular", "link": "https://stackoverflow.com/users/2807904/irregular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 28259565, "answer_count": 1, "score": 1, "last_activity_date": 1422766667, "creation_date": 1422763131, "last_edit_date": 1422765354, "question_id": 28259300, "link": "https://stackoverflow.com/questions/28259300/why-doesnt-this-json-decode-into-my-struct", "title": "Why doesn&#39;t this JSON decode into my struct?", "body": "<p>I am sending this kind of array after calling JSON.stringify on it</p>\n\n<pre><code>{\n  \"\u4e16\": 1,\n  \"\u754c\": 1,\n  \"\u6700\": 1,\n  \"\u5f37\": 1\n}\n</code></pre>\n\n<p>but am having trouble using json.NewDecoder.Decode on it, is my struct wrong? </p>\n\n<pre><code>type text struct {\n    Text map[string]int\n}\n</code></pre>\n\n<p>I am also having trouble sending that data back to the front end, how do I convert my data back to []byte or is there another method available to send json back to front end?</p>\n\n<pre><code>func PostHandler(w http.ResponseWriter, r *http.Request){\n    log.Println(\"post start\")\n    if r.Method != \"POST\" {\n        log.Println(\"in post but early return\")\n        http.NotFound(w, r)\n        return\n    }\n\n    decoder := json.NewDecoder(r.Body)\n    var t text\n    err := decoder.Decode(&amp;t)\n    if err != nil {\n        log.Println(\"I tried\")\n        log.Println(r.Body)\n    }\n    log.Println(t.Text)\n    //w.Write([]byte(t.Text))     //throws conversion error\n}    \n</code></pre>\n\n<p>(I am trying to send data back and forth between front and back end to get the basics down before moving on and expanding) </p>\n\n<p>Also what's printed from the log is</p>\n\n<pre><code>post start\nmap[]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "edited": false, "score": 0, "creation_date": 1422767387, "post_id": 28259624, "comment_id": 44876971, "body": "Thanks for this, just one question, is there a way to iterate through that map? I will never know the different <code>ids</code>, so I can&#39;t substitute it. The only way would be to iterate over all the form data, and grab the <code>id</code> from there."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 12, "last_activity_date": 1422768357, "last_edit_date": 1422768357, "creation_date": 1422766421, "answer_id": 28259624, "question_id": 28259063, "link": "https://stackoverflow.com/questions/28259063/golang-parse-form/28259624#28259624", "title": "Golang parse form", "body": "<p>The form keys look like <code>rating[id]</code> where <code>id</code> is a value identifier.  To get one of the values, call <code>r.FormValue(\"rating[id]\")</code> after substituting <code>id</code> for an actual id value.</p>\n\n<p>I suggest printing the form to see what's going on:</p>\n\n<pre><code>fmt.Printf(\"%+v\\n\", r.Form)  // No () following Form, Form is not a function\n</code></pre>\n\n<p>The <a href=\"http://godoc.org/net/http#Request.Form\" rel=\"noreferrer\">form</a> is an <a href=\"http://godoc.org/net/url#Values\" rel=\"noreferrer\">url.Values</a>. An url.Values is a map[string][]string. You can iterate through the form as follows:</p>\n\n<pre><code>for key, values := range r.Form {   // range over map\n  for _, value := range values {    // range over []string\n     fmt.Println(key, value)\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 700, "user_id": 4229820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PSShC.jpg?s=128&g=1", "display_name": "Henri Koski", "link": "https://stackoverflow.com/users/4229820/henri-koski"}, "is_accepted": false, "score": 6, "last_activity_date": 1456381774, "creation_date": 1456381774, "answer_id": 35619954, "question_id": 28259063, "link": "https://stackoverflow.com/questions/28259063/golang-parse-form/35619954#35619954", "title": "Golang parse form", "body": "<p>For others that are looking answers for this I found <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"noreferrer\"><strong>Gorilla's schema</strong></a> really helpful. It allows you to parse forms to structs and has support for arrays and nested structs. When you combine that with <a href=\"https://github.com/guregu/null\" rel=\"noreferrer\"><strong>guregu's null</strong></a> package you can easily parse sructs with optional fields.</p>\n\n<p><strong>Example Go:</strong></p>\n\n<pre><code>package models\n\nimport (\n    \"github.com/gorilla/schema\"\n    \"gopkg.in/guregu/null.v3\"\n)\n\ntype User struct {\n    Id            null.Int    `db:\"id\" json:\"id\"`\n    // Custom mapping for form input \"user_name\" \n    Name          string      `db:\"user_name\" json:\"user_name\" schema:\"user_name\"`\n    EmailAddress  string      `db:\"email_address\" json:\"email_address\"`\n    OptionalField null.String `db:\"optional_field\" json:\"optional_field\"`\n}\n</code></pre>\n\n<p><strong>Example html</strong></p>\n\n<pre><code>&lt;form&gt;\n    &lt;input type=\"text\" name=\"user_name\"&gt;\n    &lt;input type=\"text\" name=\"EmailAddress\"&gt;\n    &lt;input type=\"text\" name=\"OptionalField\"&gt;\n&lt;/form&gt;\n</code></pre>\n"}], "owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22189, "favorite_count": 3, "accepted_answer_id": 28259624, "answer_count": 2, "score": 7, "last_activity_date": 1456381774, "creation_date": 1422760555, "question_id": 28259063, "link": "https://stackoverflow.com/questions/28259063/golang-parse-form", "title": "Golang parse form", "body": "<p>If I have the following form setup:</p>\n\n<pre><code>{{ range $key, $value := .Scores }}\n    &lt;input id=\"{{$value.Id}}_rating__1\" type=\"radio\" name=\"rating[{{$value.Id}}]\" value=\"-1\"&gt;\n    &lt;input id=\"{{$value.Id}}_rating__0\" type=\"radio\" name=\"rating[{{$value.Id}}]\" value=\"0\"&gt;\n    &lt;input id=\"{{$value.Id}}_rating__2\" type=\"radio\" name=\"rating[{{$value.Id}}]\" value=\"+1\"&gt;\n{{ end }}\n</code></pre>\n\n<p>How can I then extract that data correctly? Knowing that there <code>.Scores</code> can contain multiple structs</p>\n\n<pre><code>func categoryViewSubmit(w http.ResponseWriter, r *http.Request) {\n    err := r.ParseForm()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"POST\")\n\n    fmt.Printf(\"%+v\\n\", r.Form()) // annot call non-function r.Form (type url.Values)\n    fmt.Printf(\"%+v\\n\", r.FormValue(\"rating\")) // Returns nothing\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1422754235, "post_id": 28258456, "comment_id": 44874929, "body": "Please provide an example of the JSON text. The text <code>{{&quot;word name&quot;:&quot;word meaning&quot;},{&quot;word name&quot;:&quot;word meaning&quot;},\u2026}</code> is not valid JSON."}, {"owner": {"reputation": 11, "user_id": 3215204, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000460950765/picture?type=large", "display_name": "user3215204", "link": "https://stackoverflow.com/users/3215204/user3215204"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1422757026, "post_id": 28258456, "comment_id": 44875373, "body": "I know this is not valid json but data was provided like that. Is there any solution to deal with that data? Or Is there any method to change to regular json form?"}], "answers": [{"tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": false, "score": 1, "last_activity_date": 1422756465, "creation_date": 1422756465, "answer_id": 28258696, "question_id": 28258456, "link": "https://stackoverflow.com/questions/28258456/golang-how-to-parse-json-that-get-trait-and-data-both/28258696#28258696", "title": "Golang: how to parse json that get trait and data both?", "body": "<p>For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nvar jsonText = []byte(`[\n    {\"Name\": \"Cat\", \"Meaning\": \"A Cat\"},\n    {\"Name\": \"Dog\", \"Meaning\": \"A Dog\"}\n]`)\n\ntype Word struct {\n    Name, Meaning string\n}\n\nfunc main() {\n    var words []Word\n    dict := make(map[string]string)\n    if err := json.Unmarshal(jsonText, &amp;words); err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    for _, w := range words {\n        dict[w.Name] = w.Meaning\n    }\n    fmt.Printf(\"%v\", dict)\n}\n</code></pre>\n\n<p>Produces:</p>\n\n<blockquote>\n  <p>map[Cat:A Cat Dog:A Dog]</p>\n</blockquote>\n\n<p><a href=\"http://play.golang.org/p/LVYp9E8nm_\" rel=\"nofollow\">Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 2, "last_activity_date": 1422759049, "last_edit_date": 1422759049, "creation_date": 1422758634, "answer_id": 28258862, "question_id": 28258456, "link": "https://stackoverflow.com/questions/28258456/golang-how-to-parse-json-that-get-trait-and-data-both/28258862#28258862", "title": "Golang: how to parse json that get trait and data both?", "body": "<p>If you have a way of changing first and last curly brace, to a square brackets, then you could do the following:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n\n    var raw_list []map[string]string\n\n    var jsonText = []byte(`[\n        {\"Cat\": \"small animal\"},\n        {\"Cow\": \"Big animal\"}\n        ]`)\n\n    err := json.Unmarshal(jsonText, &amp;raw_list)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"raw_list : %s\\n\", raw_list)\n\n    new_map := make(map[string]string)\n\n    for _, ele := range raw_list {\n        for key, val := range ele {\n            new_map[key] = val\n        }\n    }\n\n    fmt.Printf(\"new_map %s\\n\", new_map)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Z2H8YNBrBc\" rel=\"nofollow\">GoPlayground</a></p>\n\n<p>Result:</p>\n\n<pre><code>raw_list : [map[Cat:small animal] map[Cow:Big animal]]\nnew_map map[Cat:small animal Cow:Big animal]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 3215204, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000460950765/picture?type=large", "display_name": "user3215204", "link": "https://stackoverflow.com/users/3215204/user3215204"}, "edited": false, "score": 0, "creation_date": 1422766328, "post_id": 28259098, "comment_id": 44876826, "body": "Thats what i looking for! Thanks"}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422771971, "post_id": 28259098, "comment_id": 44877697, "body": "This is not a good solution for technical reasons.  Specifically, it treats the content as if it were a flat string, and completely ignores structure. Consider what happens when your meanings has embedded curly braces.  The example <code>{{&quot;curly&quot;: &quot;looks like this: &#39;{&#39;.&quot;}}</code> will completely break with the proposed solution."}, {"owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "reply_to_user": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1422773054, "post_id": 28259098, "comment_id": 44877839, "body": "@dyoo fixJson function here is just an example. Probably I should mention that it will break a string in case it contain curly brace, but the main idea of solution was to lead a text to a format which can be unmarshaled into to map[string]string without extra efforts."}], "tags": [], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1422760893, "creation_date": 1422760893, "answer_id": 28259098, "question_id": 28258456, "link": "https://stackoverflow.com/questions/28258456/golang-how-to-parse-json-that-get-trait-and-data-both/28259098#28259098", "title": "Golang: how to parse json that get trait and data both?", "body": "<p>Your JSON should be like the following</p>\n\n<pre><code>{\n    \"word 1\": \"meaning 1\",\n    \"word 2\": \"meaning 2\"\n}\n</code></pre>\n\n<p>to accomplish that you may use something like that</p>\n\n<pre><code>func fixJson(s string) string {\n    s = strings.Replace(s, \"{\", \"\", -1)\n    s = strings.Replace(s, \"}\", \"\", -1)\n    return \"{\" + s + \"}\"\n}\n</code></pre>\n\n<p>Full code</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"strings\"\n    \"fmt\"\n    \"log\"\n)\n\nfunc fixJson(s string) string {\n    s = strings.Replace(s, \"{\", \"\", -1)\n    s = strings.Replace(s, \"}\", \"\", -1)\n    return \"{\" + s + \"}\"\n}\n\nfunc main() {\n\n    var words map[string]string\n\n    var text = `{\n        {\"word 1\": \"meaning 1\"},\n        {\"word 2\": \"meaning 2\"}\n    }`\n\n    var jsonText = []byte(fixJson(text))\n\n    err := json.Unmarshal(jsonText, &amp;words)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(words)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/41VkZMlMrB\" rel=\"nofollow\">Playground</a></p>\n"}], "owner": {"reputation": 11, "user_id": 3215204, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000460950765/picture?type=large", "display_name": "user3215204", "link": "https://stackoverflow.com/users/3215204/user3215204"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1422760893, "creation_date": 1422753659, "question_id": 28258456, "link": "https://stackoverflow.com/questions/28258456/golang-how-to-parse-json-that-get-trait-and-data-both", "title": "Golang: how to parse json that get trait and data both?", "body": "<p>I got a dic data with {{\"word name\":\"word meaning\"},{\"word name\":\"word meaning\"},\u2026}\nI want to parse to map of the words. \nI tried to write code with interface{} but i cant imagine how to. Thanks for reading.</p>\n"}, {"tags": ["pointers", "struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1422748861, "last_edit_date": 1495541571, "creation_date": 1422748037, "answer_id": 28257877, "question_id": 28257842, "link": "https://stackoverflow.com/questions/28257842/pointer-to-a-struct-or-lack-thereof/28257877#28257877", "title": "Pointer to a struct (or lack thereof)", "body": "<blockquote>\n  <p>why doesn't the program spit out an error when I don't use a pointer and directly call <code>Abs()</code> on a struct instance? </p>\n</blockquote>\n\n<p>Because you can get the pointer to (address of) a struct instance.  </p>\n\n<p>As mentioned in \"<a href=\"https://stackoverflow.com/a/24391459/6309\">What do the terms pointer receiver and value receiver mean in Golang?</a>\"</p>\n\n<blockquote>\n  <p>Go will auto address and auto-dereference pointers (in most cases) so <code>m := MyStruct{}; m.DoOtherStuff()</code> still works since Go automatically does <code>(&amp;m).DoOtherStuff()</code> for you.</p>\n</blockquote>\n\n<p>As illustrated by \"<a href=\"http://nathanleclaire.com/blog/2014/08/09/dont-get-bitten-by-pointer-vs-non-pointer-method-receivers-in-golang/\" rel=\"nofollow noreferrer\">Don't Get Bitten by Pointer vs Non-Pointer Method Receivers in Golang</a>\" or \"<a href=\"http://zduck.com/2014/go-101-methods-on-pointers-vs-values/\" rel=\"nofollow noreferrer\">Go 101: Methods on Pointers vs. Values</a>\", using a pointer receiver <code>(v *Vertex)</code> is great to avoid copy, since <a href=\"http://golang.org/doc/faq#pass_by_value\" rel=\"nofollow noreferrer\">Go passes everything by value</a>.  </p>\n\n<p>The <a href=\"http://golang.org/ref/spec#Method_values\" rel=\"nofollow noreferrer\">spec mentions (Method values)</a>:</p>\n\n<blockquote>\n  <p>As with <a href=\"http://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">method calls</a>, a reference to a non-interface method with a pointer receiver using an addressable value will automatically take the address of that value: <code>t.Mp</code> is equivalent to <code>(&amp;t).Mp</code>. </p>\n</blockquote>\n"}], "owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 2, "accepted_answer_id": 28257877, "answer_count": 1, "score": 2, "last_activity_date": 1422748861, "creation_date": 1422747755, "question_id": 28257842, "link": "https://stackoverflow.com/questions/28257842/pointer-to-a-struct-or-lack-thereof", "title": "Pointer to a struct (or lack thereof)", "body": "<p>Let's say I have defined this struct:</p>\n\n<pre><code>type Vertex struct {\n    X, Y float64\n}\n</code></pre>\n\n<p>now it's perfectly legal Go to use it like this:</p>\n\n<pre><code>func (v *Vertex) Abs() float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc main() {\n    v := &amp;Vertex{3, 4}\n    fmt.Println(v.Abs())\n}\n</code></pre>\n\n<p>but it's also ok not to use a pointer:</p>\n\n<pre><code>func main() {\n    v := Vertex{3, 4}\n    fmt.Println(v.Abs())\n}\n</code></pre>\n\n<p>The results in both cases is the same, but how are they different, internally? Does the use of pointer makes the program run faster?</p>\n\n<p>PS. I get it that the <code>Abs()</code> function needs a pointer as a receiver. That explains the reason why a pointer has been used later in the main function. But why doesn't the program spit out an error when I don't use a pointer and directly call <code>Abs()</code> on a struct instance? </p>\n"}, {"tags": ["mongodb", "go", "sql-like", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 12, "last_activity_date": 1461759591, "last_edit_date": 1461759591, "creation_date": 1422753106, "answer_id": 28258409, "question_id": 28257734, "link": "https://stackoverflow.com/questions/28257734/how-to-do-a-like-query-using-mgo-package-for-golang/28258409#28258409", "title": "how to do a like query using mgo package for golang", "body": "<p>Use <a href=\"http://godoc.org/gopkg.in/mgo.v2/bson#RegEx\" rel=\"noreferrer\">bson.Regex</a> to specify a regular expression value:</p>\n\n<pre><code>sess\n  .DB(db)\n  .C(cApp)\n  .Find(bson.M{\"permalink\": bson.RegEx{\"org.*\", \"\"}})\n  .All(&amp;m)\n</code></pre>\n"}], "owner": {"reputation": 2922, "user_id": 132347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/317976b83cf7b2cf3a23c233ef65661b?s=128&d=identicon&r=PG", "display_name": "Sumit M Asok", "link": "https://stackoverflow.com/users/132347/sumit-m-asok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6183, "favorite_count": 0, "accepted_answer_id": 28258409, "answer_count": 1, "score": 7, "last_activity_date": 1461759591, "creation_date": 1422747034, "last_edit_date": 1422751185, "question_id": 28257734, "link": "https://stackoverflow.com/questions/28257734/how-to-do-a-like-query-using-mgo-package-for-golang", "title": "how to do a like query using mgo package for golang", "body": "<p>I am trying to do a <code>like</code> query using mgo with no luck.</p>\n\n<p>what I want is a mongodb query similar to</p>\n\n<pre><code>db.organisation.find( { \"permalink\" : /org.*/ } )\n</code></pre>\n\n<p>I am still stuck at</p>\n\n<pre><code>sess.DB(db).C(cApp).\n    Find(bson.M{\"permalink\": \"org:bms.*\"}).\n    All(&amp;m)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 16, "creation_date": 1422741200, "post_id": 28256923, "comment_id": 44872023, "body": "The <code>account</code> package imports the <code>base</code> package, which imports the <code>mux</code> package, which imports the <code>account</code> package.  That&#39;s a cyclical set of import dependencies, which is not allowed.  It looks like you have another cycle as well, <code>base</code> imports <code>mux</code>, which imports <code>routes</code>, which imports <code>base</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2804, "user_id": 2326753, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tzfnK.png?s=128&g=1", "display_name": "C4d", "link": "https://stackoverflow.com/users/2326753/c4d"}, "edited": false, "score": 16, "creation_date": 1534760789, "post_id": 28258647, "comment_id": 90807005, "body": "So bad this shows up on compiling only. Wasted a lot of time for restructuring my hole project just to see I&#39;m not allowed to do what I did... dafug..."}, {"owner": {"reputation": 2951, "user_id": 2736817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38f596a60d51c899ee86eaec38ec8efe?s=128&d=identicon&r=PG&f=1", "display_name": "tom10271", "link": "https://stackoverflow.com/users/2736817/tom10271"}, "edited": false, "score": 57, "creation_date": 1538470122, "post_id": 28258647, "comment_id": 92144021, "body": "This is one of the reason why I don&#39;t like Go. And it is just one out of dozen reasons."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 26, "creation_date": 1538496111, "post_id": 28258647, "comment_id": 92158767, "body": "Allowing circular deps would significantly increase compile times since your entire circle of deps would need to get recompiled every time one of the deps changed. Having circular deps is also a heavy cognitive load since it makes it harder to reason about your program and tends towards complexity."}, {"owner": {"reputation": 702, "user_id": 5105411, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ad132.jpg?s=128&g=1", "display_name": "Gopherine", "link": "https://stackoverflow.com/users/5105411/gopherine"}, "edited": false, "score": 0, "creation_date": 1567542232, "post_id": 28258647, "comment_id": 101991497, "body": "which linter are you using i dont see any linting on vs code"}, {"owner": {"reputation": 841, "user_id": 1274890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bb1f2b6bd55ffb4ec3524b0e00d23f?s=128&d=identicon&r=PG", "display_name": "R Sun", "link": "https://stackoverflow.com/users/1274890/r-sun"}, "edited": false, "score": 0, "creation_date": 1567883684, "post_id": 28258647, "comment_id": 102101855, "body": "I can see this error while running app through <code>watcher</code>"}, {"owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "edited": false, "score": 0, "creation_date": 1600752452, "post_id": 28258647, "comment_id": 113178180, "body": "This can be resolved by defining a custom interface through which each package can link to types of other packages, instead of importing them directly."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 201, "last_activity_date": 1473190937, "last_edit_date": 1473190937, "creation_date": 1422755840, "answer_id": 28258647, "question_id": 28256923, "link": "https://stackoverflow.com/questions/28256923/import-cycle-not-allowed/28258647#28258647", "title": "Import cycle not allowed", "body": "<p>Here is an illustration of your first import cycle problem.</p>\n\n<pre><code>                  project/controllers/account\n                     ^                    \\    \n                    /                      \\\n                   /                        \\ \n                  /                         \\/\n         project/components/mux &lt;--- project/controllers/base\n</code></pre>\n\n<p>As you can see with my bad ASCII chart is that you are creating an import cycle when <code>project/components/mux</code> imports <code>project/controllers/account</code>. Since Go does not support circular dependencies you get the <code>import cycle not allowed</code> error during compile time. </p>\n"}, {"comments": [{"owner": {"reputation": 5015, "user_id": 983925, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d824ee5b7e18058b97236525d9afdd5?s=128&d=identicon&r=PG&f=1", "display_name": "fantasitcalbeastly", "link": "https://stackoverflow.com/users/983925/fantasitcalbeastly"}, "edited": false, "score": 20, "creation_date": 1539267316, "post_id": 45477477, "comment_id": 92447573, "body": "In my opinion this is the better answer. The accepted answer is just as valid, but doesn&#39;t explain anything other than the theory for such a failure. @Jonathan Lin &#39;s answer however, perfectly explains this cryptic error message, and how to combat it."}, {"owner": {"reputation": 876, "user_id": 137196, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/244e6196a79d2f18d873577f0d6459f7?s=128&d=identicon&r=PG", "display_name": "Louie Miranda", "link": "https://stackoverflow.com/users/137196/louie-miranda"}, "edited": false, "score": 3, "creation_date": 1598346347, "post_id": 45477477, "comment_id": 112421683, "body": "It&#39;s 2020 and I propose that this should be the better and accepted answer. @stackoverflow"}], "tags": [], "owner": {"reputation": 16764, "user_id": 1161743, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/18aebb65726f793706e6bba28e921420?s=128&d=identicon&r=PG", "display_name": "Jonathan Lin", "link": "https://stackoverflow.com/users/1161743/jonathan-lin"}, "is_accepted": false, "score": 124, "last_activity_date": 1501744958, "creation_date": 1501744958, "answer_id": 45477477, "question_id": 28256923, "link": "https://stackoverflow.com/questions/28256923/import-cycle-not-allowed/45477477#45477477", "title": "Import cycle not allowed", "body": "<p>I just encountered this. You may be accessing a method/type from within the same package using the package name itself. </p>\n\n<p>Here is an example to illustrate what I mean:</p>\n\n<p>In foo.go: </p>\n\n<pre><code>// foo.go\npackage foo\n\nfunc Foo() {...}\n</code></pre>\n\n<p>In foo_test.go:</p>\n\n<pre><code>// foo_test.go\npackage foo\n\n// try to access Foo()\nfoo.Foo() // WRONG &lt;== This was the issue. You are already in package foo, there is no need to use foo.Foo() to access Foo()\nFoo() // CORRECT\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 713, "user_id": 12162813, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-22W2wmyNnEQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCiW9MIj-T5ov3H31eHm8dOqD1pg/photo.jpg?sz=128", "display_name": "Thushara Buddhika", "link": "https://stackoverflow.com/users/12162813/thushara-buddhika"}, "is_accepted": false, "score": 4, "last_activity_date": 1571723978, "creation_date": 1571723978, "answer_id": 58497894, "question_id": 28256923, "link": "https://stackoverflow.com/questions/28256923/import-cycle-not-allowed/58497894#58497894", "title": "Import cycle not allowed", "body": "<p>You may have imported,</p>\n\n<pre><code>project/controllers/base\n</code></pre>\n\n<p>inside the </p>\n\n<pre><code>project/controllers/routes\n</code></pre>\n\n<p>You have already imported before. That's not supported.</p>\n"}, {"comments": [{"owner": {"reputation": 514, "user_id": 3311216, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ZwA54.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/3311216/ash"}, "edited": false, "score": 3, "creation_date": 1605195633, "post_id": 63328107, "comment_id": 114582029, "body": "thanks for the answer, however I like the DRY methodology due to maintainability. For me saying &quot;Sometimes code repetition is not bad idea&quot; is not nice, because if i have common functionality between 12 struct groups, i have to write it 12 times in each, and update that code 12 times."}, {"owner": {"reputation": 412, "user_id": 6498438, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/OFuAw.png?s=128&g=1", "display_name": "trashgenerator", "link": "https://stackoverflow.com/users/6498438/trashgenerator"}, "edited": false, "score": 1, "creation_date": 1605799780, "post_id": 63328107, "comment_id": 114768224, "body": "Yes. You are right about 12. But if it has only 2 or 3 in different services - sometimes it not so bad. Just like create a table in DB with lower normalization level but avoid additional join to optimize it."}, {"owner": {"reputation": 21272, "user_id": 52277, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/67498fd0e17d27cb9be0c107f306e378?s=128&d=identicon&r=PG", "display_name": "Michael Freidgeim", "link": "https://stackoverflow.com/users/52277/michael-freidgeim"}, "edited": false, "score": 0, "creation_date": 1619230311, "post_id": 63328107, "comment_id": 118849685, "body": "\u201cBreak Circular Dependencies via implicit interfaces&quot; (I personally don&#39;t recommend, and highly discourage this practise,  because by design Go programs must be acyclic)  . It is Go technical limitation, not the architectural  advantage of Go. Using interfaces is a good solution to work around the limitation if developers need it."}], "tags": [], "owner": {"reputation": 228, "user_id": 4777965, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-FsJljCfzVNE/AAAAAAAAAAI/AAAAAAAAAgg/MPZIb-DusD0/photo.jpg?sz=128", "display_name": "Sachin Raut", "link": "https://stackoverflow.com/users/4777965/sachin-raut"}, "is_accepted": false, "score": 6, "last_activity_date": 1601323259, "last_edit_date": 1601323259, "creation_date": 1596986781, "answer_id": 63328107, "question_id": 28256923, "link": "https://stackoverflow.com/questions/28256923/import-cycle-not-allowed/63328107#63328107", "title": "Import cycle not allowed", "body": "<p>This is a circular dependency issue. Golang programs must be acyclic. In Golang cyclic imports are not allowed (That is its import graph must not contain any loops)</p>\n<p>Lets say your project <code>go-circular-dependency</code> have 2 packages &quot;package one&quot; &amp; it has &quot;one.go&quot; &amp; &quot;package two&quot; &amp; it has &quot;two.go&quot; So your project structure is as follows</p>\n<pre><code>+--go-circular-dependency    \n      +--one    \n         +-one.go\n      +--two        \n         +-two.go\n</code></pre>\n<p>This issue occurs when you try to do something like following.</p>\n<p><strong>Step 1</strong> - In <code>one.go</code> you import <code>package two</code> (Following is <code>one.go</code>)</p>\n<pre><code>package one\n\nimport (\n    &quot;go-circular-dependency/two&quot;\n)\n\n//AddOne is\nfunc AddOne() int {\n    a := two.Multiplier()\n    return a + 1\n}\n</code></pre>\n<p><strong>Step 2</strong> - In <code>two.go</code> you import <code>package one</code> (Following is <code>two.go</code>)</p>\n<pre><code>package two\n\nimport (\n    &quot;fmt&quot;\n    &quot;go-circular-dependency/one&quot;\n)\n\n//Multiplier is going to be used in package one\nfunc Multiplier() int {\n    return 2\n}\n\n//Total is\nfunc Total() {\n    //import AddOne from &quot;package one&quot;\n    x := one.AddOne()\n    fmt.Println(x)\n}\n</code></pre>\n<p>In Step 2, you will receive an error &quot;can't load package: import cycle not allowed&quot;\n(This is called <strong>&quot;Circular Dependency&quot; error</strong>)</p>\n<p>Technically speaking this is bad design decision and you should avoid this as much as possible, but you can &quot;Break Circular Dependencies via implicit interfaces&quot; (I personally don't recommend, and highly discourage this practise, because by design Go programs must be acyclic)</p>\n<p>Try to keep your import dependency shallow. When the dependency graph becomes deeper (i.e package x imports y, y imports z, z imports x) then circular dependencies become more likely.</p>\n<p>Sometimes code repetition is not bad idea, which is exactly opposite of DRY (don't repeat yourself)</p>\n<p>So in <strong>Step 2</strong> that is in <code>two.go</code> you should not import package one. Instead in <code>two.go</code> you should actually replicate the functionality of <code>AddOne()</code> written in <code>one.go</code> as follows.</p>\n<pre><code>package two\n\nimport (\n    &quot;fmt&quot;\n)\n\n//Multiplier is going to be used in package one\nfunc Multiplier() int {\n    return 2\n}\n\n//Total is\nfunc Total() {\n    // x := one.AddOne()\n    x := Multiplier() + 1\n    fmt.Println(x)\n}\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134652, "favorite_count": 28, "protected_date": 1531328706, "accepted_answer_id": 28258647, "answer_count": 4, "score": 161, "last_activity_date": 1601323259, "creation_date": 1422741008, "question_id": 28256923, "link": "https://stackoverflow.com/questions/28256923/import-cycle-not-allowed", "title": "Import cycle not allowed", "body": "<p>I have a problem with </p>\n\n<blockquote>\n  <p>import cycle not allowed</p>\n</blockquote>\n\n<p>It appears, when I am trying to test my controller. As output I've got</p>\n\n<pre><code>can't load package: import cycle not allowed\npackage project/controllers/account\n    imports project/controllers/base\n    imports project/components/mux\n    imports project/controllers/account\nimport cycle not allowed\npackage project/controllers/account\n    imports project/controllers/base\n    imports project/components/mux\n    imports project/controllers/account\nimport cycle not allowed\npackage project/controllers/account\n    imports project/controllers/base\n    imports project/components/mux\n    imports project/controllers/routes\n    imports project/controllers/base\n</code></pre>\n\n<p>Can someone tell me, how to read or understand this error? Where is the dependency wrong?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 40, "last_activity_date": 1481798498, "last_edit_date": 1481798498, "creation_date": 1422726926, "answer_id": 28254703, "question_id": 28254102, "link": "https://stackoverflow.com/questions/28254102/how-to-unmarshal-json-into-interface-in-go/28254703#28254703", "title": "How to unmarshal JSON into interface{} in Go?", "body": "<p>Define a struct type for the fixed part of the message with a <a href=\"http://godoc.org/encoding/json#RawMessage\" rel=\"noreferrer\">json.RawMessage</a> field to capture the variant part of the message. Define struct types for each of the variant types and decode to them based on the the command.</p>\n\n<pre><code>type Message struct {\n  Cmd string `json:\"cmd\"`\n  Data      json.RawMessage\n}  \n\ntype CreateMessage struct {\n    Conf map[string]int `json:\"conf\"`\n    Info map[string]int `json:\"info\"`\n}  \n\nfunc main() {\n    var m Message\n    if err := json.Unmarshal(data, &amp;m); err != nil {\n        log.Fatal(err)\n    }\n    switch m.Cmd {\n    case \"create\":\n        var cm CreateMessage\n        if err := json.Unmarshal([]byte(m.Data), &amp;cm); err != nil {\n            log.Fatal(err)\n        }\n        fmt.Println(m.Cmd, cm.Conf, cm.Info)\n    default:\n        log.Fatal(\"bad command\")\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/aAFa3yxYP4\" rel=\"noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 637, "user_id": 1646577, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb397bc4b574eee54f603a0ad6d7b002?s=128&d=identicon&r=PG", "display_name": "Shanicky_C", "link": "https://stackoverflow.com/users/1646577/shanicky-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23062, "favorite_count": 7, "accepted_answer_id": 28254703, "answer_count": 1, "score": 29, "last_activity_date": 1520883999, "creation_date": 1422723387, "last_edit_date": 1520883999, "question_id": 28254102, "link": "https://stackoverflow.com/questions/28254102/how-to-unmarshal-json-into-interface-in-go", "title": "How to unmarshal JSON into interface{} in Go?", "body": "<p>I'm a newbie in Go and now I have a problem. I have a type called Message, it is a struct like this:</p>\n\n<pre><code>type Message struct {\n    Cmd string `json:\"cmd\"`\n    Data interface{} `json:\"data\"`\n}\n</code></pre>\n\n<p>I also have a type called CreateMessage like this: </p>\n\n<pre><code>type CreateMessage struct {\n    Conf map[string]int `json:\"conf\"`\n    Info map[string]int `json:\"info\"`\n}\n</code></pre>\n\n<p>And I have a JSON string like <code>{\"cmd\":\"create\",\"data\":{\"conf\":{\"a\":1},\"info\":{\"b\":2}}}</code>. </p>\n\n<p>When I use <code>json.Unmarshal</code> to decode that into a Message variable, the answer is <code>{Cmd:create Data:map[conf:map[a:1] info:map[b:2]]}</code>.</p>\n\n<p>So could I decode the JSON into a Message struct and change its Data's interface{} to type CreateMessage according to the Cmd?</p>\n\n<p>I tried to convert Data directly into type CreateMessage but the complier told me that Data is a map[sting]interface{} type.</p>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 3, "creation_date": 1422721616, "post_id": 28253796, "comment_id": 44866253, "body": "The path of GOROOT seems off. It can&#39;t be inside GOPATH, it&#39;s usually some system directory."}, {"owner": {"reputation": 673, "user_id": 1692922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ONr8J.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1692922/michael"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422722472, "post_id": 28253796, "comment_id": 44866530, "body": "@Not_a_Golfer Do you have an example of what it should be? I installed via brew, so should it be something in <code>&#47;usr&#47;local&#47;Cellar&#47;go</code>? If so, any idea what?"}, {"owner": {"reputation": 673, "user_id": 1692922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ONr8J.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1692922/michael"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1422722923, "post_id": 28253796, "comment_id": 44866669, "body": "Okay, got it figured out -- using <code>export GOROOT=&#47;usr&#47;local&#47;Cellar&#47;go&#47;1.4.1&#47;libexec</code> did the trick."}], "answers": [{"comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1422759357, "post_id": 28254042, "comment_id": 44875721, "body": "You should not have to set your <code>GOROOT</code>. checkout out this <a href=\"http://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"nofollow noreferrer\">blog post</a> by Dave Cheney."}, {"owner": {"reputation": 673, "user_id": 1692922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ONr8J.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1692922/michael"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1422800134, "post_id": 28254042, "comment_id": 44884092, "body": "@jmaloney If you put that in an answer, I&#39;d be happy to accept it."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1422804783, "post_id": 28254042, "comment_id": 44885457, "body": "Hey @Michael I moved my comment to the answer."}], "tags": [], "owner": {"reputation": 673, "user_id": 1692922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ONr8J.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1692922/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1422723042, "creation_date": 1422723042, "answer_id": 28254042, "question_id": 28253796, "link": "https://stackoverflow.com/questions/28253796/trouble-setting-up-go-environment-on-osx-yosemite/28254042#28254042", "title": "Trouble setting up Go environment on OSX Yosemite", "body": "<p>Okay, @not_a_golfer 's comment helped me figure this out -- the GOROOT needs to be where brew installed Go.</p>\n\n<p>In my case <code>export GOROOT=/usr/local/Cellar/go/1.4.1/libexec</code> resolved it.</p>\n"}, {"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 0, "last_activity_date": 1422805172, "last_edit_date": 1422805172, "creation_date": 1422804726, "answer_id": 28264390, "question_id": 28253796, "link": "https://stackoverflow.com/questions/28253796/trouble-setting-up-go-environment-on-osx-yosemite/28264390#28264390", "title": "Trouble setting up Go environment on OSX Yosemite", "body": "<p><code>GOROOT=\"/Users/mc/go/packages\"</code> is incorrect.</p>\n\n<p>You should not have to set your <code>GOROOT</code>. checkout out this <a href=\"http://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"nofollow\">blog post</a> by Dave Cheney.</p>\n"}], "owner": {"reputation": 673, "user_id": 1692922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ONr8J.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1692922/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 28264390, "answer_count": 2, "score": 0, "last_activity_date": 1422805172, "creation_date": 1422721351, "last_edit_date": 1422800180, "question_id": 28253796, "link": "https://stackoverflow.com/questions/28253796/trouble-setting-up-go-environment-on-osx-yosemite", "title": "Trouble setting up Go environment on OSX Yosemite", "body": "<p>I've installed Go on OSX using Homebrew so that I could install <a href=\"https://github.com/pksunkara/alpaca#installation\" rel=\"nofollow\">alpaca</a>, but keep getting errors like this:</p>\n\n<pre><code>package github.com/GeertJohan/go.rice/rice\n    imports github.com/GeertJohan/go.incremental\n    imports github.com/GeertJohan/go.rice/embedded\n    imports github.com/akavel/rsrc/binutil\n    imports github.com/akavel/rsrc/coff\n    imports github.com/daaku/go.zipexe\n    imports github.com/jessevdk/go-flags\n    imports github.com/robertkrimen/terst\n    imports testing: unrecognized import path \"testing\"\npackage github.com/GeertJohan/go.rice/rice\n    imports github.com/GeertJohan/go.incremental\n    imports github.com/GeertJohan/go.rice/embedded\n    imports github.com/akavel/rsrc/binutil\n    imports github.com/akavel/rsrc/coff\n    imports github.com/daaku/go.zipexe\n    imports github.com/jessevdk/go-flags\n    imports github.com/robertkrimen/terst\n    imports bitbucket.org/kardianos/osext\n    imports bitbucket.org/pkg/inflect\n    imports unicode: unrecognized import path \"unicode\"\nmake: *** [deps] Error 1\n</code></pre>\n\n<p>Googling around it seems the issue is with my go environment, but I can't seem to figure out how to resolve this. Here's what I see when I run <code>go env</code>:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/mc/go\"\nGORACE=\"\"\nGOROOT=\"/Users/mc/go/packages\"\nGOTOOLDIR=\"/Users/mc/go/packages/pkg/tool/darwin_amd64\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>What am I getting wrong here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422715246, "post_id": 28252295, "comment_id": 44864407, "body": "why the vote to close it?"}], "answers": [{"comments": [{"owner": {"reputation": 1041, "user_id": 5419599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SbCyV.png?s=128&g=1", "display_name": "Wildcard", "link": "https://stackoverflow.com/users/5419599/wildcard"}, "edited": false, "score": 0, "creation_date": 1557598712, "post_id": 28252313, "comment_id": 98822266, "body": "The link is broken, and I&#39;m darned if I can find the current source.  (I&#39;m looking for the &quot;go run&quot; source.)  Do you know where it is now?  (<a href=\"https://github.com/golang/go/tree/master/src/cmd\" rel=\"nofollow noreferrer\">github.com/golang/go/tree/master/src/cmd</a> is the tree where I would have expected to find it.)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1041, "user_id": 5419599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SbCyV.png?s=128&g=1", "display_name": "Wildcard", "link": "https://stackoverflow.com/users/5419599/wildcard"}, "edited": false, "score": 1, "creation_date": 1557610200, "post_id": 28252313, "comment_id": 98824839, "body": "No problem: <a href=\"https://stackoverflow.com/a/7203551/6309\">stackoverflow.com/a/7203551/6309</a> allowed me to find the last commit and <a href=\"https://stackoverflow.com/a/56054951/6309\">stackoverflow.com/a/56054951/6309</a> show me the new location!"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1557610199, "last_edit_date": 1557610199, "creation_date": 1422712177, "answer_id": 28252313, "question_id": 28252295, "link": "https://stackoverflow.com/questions/28252295/where-is-go-test-source-code-documented/28252313#28252313", "title": "Where is &quot;Go test&quot; source code documented?", "body": "<p>You can start looking in the <code>cmd/go</code> package, where most of the <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">go commands</a> are defined:</p>\n\n<p><a href=\"https://github.com/golang/go/blob/1ba29926f3bfd245d46cf1f287716290bc2f1034/src/cmd/go/test.go\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/1ba29926f3bfd245d46cf1f287716290bc2f1034/src/cmd/go/test.go</a> (last known commit with <code>src/cmd/go/test.go</code>, Go 1.8)<br>\nThen <a href=\"https://github.com/golang/go/commit/4efe9250e5e182c8269a2b98497a9bdea4875c8f\" rel=\"nofollow noreferrer\">commit 4efe925</a> shows <code>src/cmd/go/test.go</code> being renamed/moved to <code>src/cmd/go/internal/test/test.go</code> in Go 1.9, Jan. 2017.<br>\nLast modification: <a href=\"https://github.com/golang/go/commit/ca33f33b1420cf333c59c6458bb9bc8910c91ecb\" rel=\"nofollow noreferrer\">commit ca33f33</a> in Oct. 2018 for Go 1.12.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "accepted_answer_id": 28252313, "answer_count": 1, "score": 2, "last_activity_date": 1557610199, "creation_date": 1422712037, "question_id": 28252295, "link": "https://stackoverflow.com/questions/28252295/where-is-go-test-source-code-documented", "title": "Where is &quot;Go test&quot; source code documented?", "body": "<p>I'm looking for the source code of the \"go test\" command which afaik does some funky stuff (exports the functions, recompiles the package etc). So far I could find only \"<a href=\"http://golang.org/src/testing/\" rel=\"nofollow\">testing</a>\" and the <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow\">cmd/go</a> doc </p>\n"}, {"tags": ["go", "nested"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1422711079, "post_id": 28252117, "comment_id": 44863350, "body": "<code>struct</code> is a struct type. Go doesn&#39;t have classes."}, {"owner": {"reputation": 505, "user_id": 3831468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a098533ad1ee9d0bcb759251cbbab0d?s=128&d=identicon&r=PG", "display_name": "Hayes Pan", "link": "https://stackoverflow.com/users/3831468/hayes-pan"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1422711304, "post_id": 28252117, "comment_id": 44863401, "body": "@icza sorry the <code>class</code> above means <code>struct</code> with bounding function. Forgive my incorrect expression."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1422711511, "post_id": 28252117, "comment_id": 44863445, "body": "Yes, I understood, I just corrected the term or terminology."}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 3831468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a098533ad1ee9d0bcb759251cbbab0d?s=128&d=identicon&r=PG", "display_name": "Hayes Pan", "link": "https://stackoverflow.com/users/3831468/hayes-pan"}, "edited": false, "score": 0, "creation_date": 1422711597, "post_id": 28252170, "comment_id": 44863470, "body": "ok~ and is there a way to bound a Function literal to the nested <code>struct</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 505, "user_id": 3831468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a098533ad1ee9d0bcb759251cbbab0d?s=128&d=identicon&r=PG", "display_name": "Hayes Pan", "link": "https://stackoverflow.com/users/3831468/hayes-pan"}, "edited": false, "score": 0, "creation_date": 1422711968, "post_id": 28252170, "comment_id": 44863570, "body": "@HayesPan No, you can&#39;t. Not in the sense of creating a method for the type. You could specifying an additional parameter to the function literal which would be of the <code>struct</code> type like the receiver, but it will not be a part of the <code>struct</code>&#39;s method set. A <i>Function literal</i> is not a <i>function</i>, it is just a <i>value</i> (which has a function type)."}, {"owner": {"reputation": 505, "user_id": 3831468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a098533ad1ee9d0bcb759251cbbab0d?s=128&d=identicon&r=PG", "display_name": "Hayes Pan", "link": "https://stackoverflow.com/users/3831468/hayes-pan"}, "edited": false, "score": 0, "creation_date": 1422712101, "post_id": 28252170, "comment_id": 44863621, "body": "got it\u221a Thanks! @icza"}, {"owner": {"reputation": 503, "user_id": 3098902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EQSV3.jpg?s=128&g=1", "display_name": "she7ata", "link": "https://stackoverflow.com/users/3098902/she7ata"}, "edited": false, "score": 0, "creation_date": 1588934295, "post_id": 28252170, "comment_id": 109097021, "body": "what if i want to call this literal function recursively from inside itself?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 503, "user_id": 3098902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EQSV3.jpg?s=128&g=1", "display_name": "she7ata", "link": "https://stackoverflow.com/users/3098902/she7ata"}, "edited": false, "score": 1, "creation_date": 1588935820, "post_id": 28252170, "comment_id": 109097706, "body": "@schehata Then check out this: <a href=\"https://stackoverflow.com/questions/28099441/define-a-recursive-function-within-a-function-in-go/28099510#28099510\">Define a recursive function within a function in Go</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1422711567, "last_edit_date": 1422711567, "creation_date": 1422711222, "answer_id": 28252170, "question_id": 28252117, "link": "https://stackoverflow.com/questions/28252117/golang-nested-class-inside-function/28252170#28252170", "title": "Golang nested class inside function", "body": "<p>Actually it doesn't matter if you want to declare the function <em>with</em> or <em>without</em> a receiver: nesting functions in Go are not allowed.</p>\n\n<p>Although you can use <a href=\"http://golang.org/ref/spec#Function_literals\" rel=\"noreferrer\">Function literals</a> to achieve something like this:</p>\n\n<pre><code>func f() {\n    foo := func(s string) {\n        fmt.Println(s)\n    }\n\n    foo(\"Hello World!\")\n}\n</code></pre>\n\n<p>Here we created a variable <code>foo</code> which has a function type and it is delcared inside another function <code>f</code>. Calling the \"outer\" function <code>f</code> outputs: <code>\"Hello World!\"</code> as expected.</p>\n\n<p>Try it on <a href=\"http://play.golang.org/p/7BH8C5nJOB\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 505, "user_id": 3831468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a098533ad1ee9d0bcb759251cbbab0d?s=128&d=identicon&r=PG", "display_name": "Hayes Pan", "link": "https://stackoverflow.com/users/3831468/hayes-pan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9846, "favorite_count": 2, "accepted_answer_id": 28252170, "answer_count": 1, "score": 11, "last_activity_date": 1422713440, "creation_date": 1422710889, "last_edit_date": 1422713440, "question_id": 28252117, "link": "https://stackoverflow.com/questions/28252117/golang-nested-class-inside-function", "title": "Golang nested class inside function", "body": "<p>Go supports nested struct  inside function but no nested function except lambda, does it mean there is no way to define a nested class inside function?</p>\n\n<pre><code>func f() {\n    // nested struct Cls inside f\n    type Cls struct {\n    ...\n    }\n    // try bounding foo to Cls but fail\n    func (c *Cls) foo() {\n    ...\n    }\n}\n</code></pre>\n\n<p>Thus it feels a bit strange that class is weaken inside function.</p>\n\n<p>Any hints?</p>\n"}, {"tags": ["javascript", "node.js", "dll", "go", "network-programming"], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 1211451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b6f66bf0bb6c714a13008acb72b478e?s=128&d=identicon&r=PG", "display_name": "llgcode", "link": "https://stackoverflow.com/users/1211451/llgcode"}, "is_accepted": true, "score": 1, "last_activity_date": 1424106375, "last_edit_date": 1495542867, "creation_date": 1422886270, "answer_id": 28279602, "question_id": 28251903, "link": "https://stackoverflow.com/questions/28251903/is-there-a-way-to-create-bindings-for-golang-library-for-node-js/28279602#28279602", "title": "Is there a way to create bindings for golang library for node.js?", "body": "<p>It seems that it is not possible right now to build shared library in golang. There's an issue talking about this in <a href=\"https://github.com/golang/go/issues/256\" rel=\"nofollow noreferrer\">golang repos</a> and a document describing the <a href=\"https://docs.google.com/document/d/1nr-TQHw_er6GOQRsF6T43GGhFDelrAP0NqSS_00RgZQ/edit#heading=h.fwmrrio0df0i\" rel=\"nofollow noreferrer\">go execution mode</a>.</p>\n\n<p>A discussion about this <a href=\"https://stackoverflow.com/questions/6125683/call-go-functions-from-c\">Call Go functions from C</a></p>\n"}], "owner": {"reputation": 2102, "user_id": 1215031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6ae3697b2cf910eb587338b46daf7856?s=128&d=identicon&r=PG", "display_name": "Moonwalker", "link": "https://stackoverflow.com/users/1215031/moonwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2061, "favorite_count": 0, "accepted_answer_id": 28279602, "answer_count": 1, "score": 4, "last_activity_date": 1424106375, "creation_date": 1422709401, "last_edit_date": 1422711096, "question_id": 28251903, "link": "https://stackoverflow.com/questions/28251903/is-there-a-way-to-create-bindings-for-golang-library-for-node-js", "title": "Is there a way to create bindings for golang library for node.js?", "body": "<p>The situation is very simple: I have a node.js application and want it to be able to call functions from my networking library written in golang. As far as I understand there are numerous wrappers around c/c++ code in node, can I create a one around my golang library?</p>\n\n<p>There is a tool gopy <a href=\"http://gopy.qur.me/extensions/install.html\" rel=\"nofollow\">http://gopy.qur.me/extensions/install.html</a> which solves this problem for python, but I was unable to found something similar for node.js</p>\n"}, {"tags": ["go", "alias"], "answers": [{"tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": true, "score": 17, "last_activity_date": 1422705952, "creation_date": 1422705952, "answer_id": 28251387, "question_id": 28251283, "link": "https://stackoverflow.com/questions/28251283/golang-function-alias-on-method-receiver/28251387#28251387", "title": "golang function alias on method receiver", "body": "<p>Yes.  You can make an alias like this:</p>\n\n<pre><code>var MethodReceiver = (*Person).methodReceiver\n</code></pre>\n\n<p>When you call it, you have to provide a pointer to a person object as the first argument:</p>\n\n<pre><code>MethodReceiver(&amp;p)\n</code></pre>\n\n<p>You can <a href=\"https://play.golang.org/p/l-5Vu8bQ10\" rel=\"noreferrer\">see this in action on the Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1422705978, "creation_date": 1422705978, "answer_id": 28251391, "question_id": 28251283, "link": "https://stackoverflow.com/questions/28251283/golang-function-alias-on-method-receiver/28251391#28251391", "title": "golang function alias on method receiver", "body": "<p>This is called <a href=\"http://golang.org/ref/spec#Method_expressions\" rel=\"nofollow\">method expression</a> <code>var MethodReceiver = (*Person).methodReceiver</code></p>\n\n<p><a href=\"https://play.golang.org/p/l-5Vu8bQ10\" rel=\"nofollow\">Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 28, "last_activity_date": 1452240628, "last_edit_date": 1452240628, "creation_date": 1422710728, "answer_id": 28252088, "question_id": 28251283, "link": "https://stackoverflow.com/questions/28251283/golang-function-alias-on-method-receiver/28252088#28252088", "title": "golang function alias on method receiver", "body": "<p>Basically you have 2 options:</p>\n\n<h3>1. Using a <a href=\"http://golang.org/ref/spec#Method_expressions\" rel=\"noreferrer\">Method Expression</a></h3>\n\n<p>Which has the form of <code>ReceiverType.MethodName</code> and it yields a value of a function type:</p>\n\n<pre><code>var MethodReceiver = (*Person).methodReceiver\n</code></pre>\n\n<p><code>MethodReceiver</code> just holds the function reference but <em>not</em> the receiver, so if you want to call it, you also have to pass a receiver (of type <code>*Person</code>) to it as its fist argument:</p>\n\n<pre><code>var p = &amp;Person{\"Alice\"}\nMethodReceiver(p)  // Receiver is explicit: p\n</code></pre>\n\n<h3>2. Using a <a href=\"http://golang.org/ref/spec#Method_values\" rel=\"noreferrer\">Method Value</a></h3>\n\n<p>Which has the form of <code>x.MethodName</code> where the expression <code>x</code> has a static type <code>T</code>:</p>\n\n<pre><code>var p = &amp;Person{\"Bob\"}\nvar MethodReceiver2 = p.methodReceiver\n</code></pre>\n\n<p>A method value also stores the <em>receiver</em> too, so when you call it, you don't have to pass a receiver to it:</p>\n\n<pre><code>MethodReceiver2()  // Receiver is implicit: p\n</code></pre>\n\n<h3>Complete Example</h3>\n\n<p>Try it on <a href=\"http://play.golang.org/p/5AsTTuqU-z\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<pre><code>type Person struct {\n    Name string\n}\n\nfunc (p *Person) printName() {\n    fmt.Println(p.Name)\n}\n\nvar PrintName1 = (*Person).printName\n\nfunc main() {\n    var p1 *Person = &amp;Person{\"Bob\"}\n    PrintName1(p1) // Have to specify receiver explicitly: p1\n\n    p2 := &amp;Person{\"Alice\"}\n    var PrintName2 = p2.printName // Method value, also stores p2\n    PrintName2()                  // Implicit receiver: p2\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Bob\nAlice\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10077, "favorite_count": 6, "accepted_answer_id": 28251387, "answer_count": 3, "score": 10, "last_activity_date": 1452240628, "creation_date": 1422705191, "last_edit_date": 1422708796, "question_id": 28251283, "link": "https://stackoverflow.com/questions/28251283/golang-function-alias-on-method-receiver", "title": "golang function alias on method receiver", "body": "<p>I can create method alias for an usual method:</p>\n\n<pre><code>func method1() {\n    fmt.Println(\"method1\")\n}\n\nvar Method1 = method1\n</code></pre>\n\n<p>But cannot do the same for a method receiver:</p>\n\n<pre><code>type Person struct {\n    Name string\n}\n\nfunc (p *Person) methodReciver() {\n    fmt.Println(\"method reciver\")\n}\n\nvar MethodReciver = methodReciver\n</code></pre>\n\n<p>In this case I got the error on line <code>var MethodReciver = methodReciver</code>: </p>\n\n<pre><code>undefined: methodReciver\n</code></pre>\n\n<p>Full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Person struct {\n    Name string\n}\n\nfunc method1() {\n    fmt.Println(\"method1\")\n}\n\nvar Method1 = method1\n\nfunc (p *Person) methodReceiver() {\n    fmt.Println(\"method receiver\")\n}\n\nvar MethodReceiver = methodReceiver\n\nfunc main() {\n    method1()\n    Method1()\n    p := Person{\"Nick\"}\n    p.methodReceiver()\n    p.MethodReceiver()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nQeu-U08MQ\" rel=\"noreferrer\">Playground</a></p>\n\n<p>Is it possible to create a method alias for <code>methodReceiver</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1422713632, "post_id": 28251148, "comment_id": 44864007, "body": "You might want to report this as a bug."}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1422725102, "post_id": 28251148, "comment_id": 44867297, "body": "Maybe you better ask this on the mailing list"}], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 3294609, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5de31e40076b4254ba02c64f576e5ce?s=128&d=identicon&r=PG", "display_name": "mvryan", "link": "https://stackoverflow.com/users/3294609/mvryan"}, "edited": false, "score": 0, "creation_date": 1438947635, "post_id": 28257474, "comment_id": 51671279, "body": "I just want to keep everyone up to date on this matter. The Go project as of the following commit supports 512GB by default on non-windows 64-bit platforms. <a href=\"https://go-review.googlesource.com/#/c/10819/4\" rel=\"nofollow noreferrer\">go-review.googlesource.com/#/c/10819/4</a>  I believe this will be part of 1.5 when it is released."}], "tags": [], "owner": {"reputation": 257, "user_id": 3294609, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5de31e40076b4254ba02c64f576e5ce?s=128&d=identicon&r=PG", "display_name": "mvryan", "link": "https://stackoverflow.com/users/3294609/mvryan"}, "is_accepted": true, "score": 1, "last_activity_date": 1422744891, "creation_date": 1422744891, "answer_id": 28257474, "question_id": 28251148, "link": "https://stackoverflow.com/questions/28251148/increase-max-allocated-memory-golang-1-4/28257474#28257474", "title": "Increase Max Allocated Memory Golang 1.4+", "body": "<p>So I realized I did not find the file because I am not use to using the Google Code repo explorer. I located what are now 3 malloc.go files and have found the relevant section of code.\n<a href=\"https://code.google.com/p/go/source/browse/src/runtime/malloc2.go#122\" rel=\"nofollow\">https://code.google.com/p/go/source/browse/src/runtime/malloc2.go#122</a></p>\n\n<p>Honestly I think the update using 1 and 0 booleans and multiplication rather than simple if statements is overly confusing and doesn't convey what is going on as clearly as the header file used to.</p>\n\n<p>Also thank you bamboon I only realized my mistake after reading the mailing list and getting linked to a different repo viewer.</p>\n"}], "owner": {"reputation": 257, "user_id": 3294609, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5de31e40076b4254ba02c64f576e5ce?s=128&d=identicon&r=PG", "display_name": "mvryan", "link": "https://stackoverflow.com/users/3294609/mvryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 1, "accepted_answer_id": 28257474, "answer_count": 1, "score": 2, "last_activity_date": 1422744891, "creation_date": 1422704186, "question_id": 28251148, "link": "https://stackoverflow.com/questions/28251148/increase-max-allocated-memory-golang-1-4", "title": "Increase Max Allocated Memory Golang 1.4+", "body": "<p>I'm thinking about upgrading to Go 1.4 but am concerned because I no longer know how to change the max amount of memory I can address.\nI have been using Go to run some machine learning experiments on a large server, 512GB of main memory, which makes the 128GB limit set using a 37 bit address insufficient.</p>\n\n<p>Previously I would edit malloc.h in the runtime package to change to 38 bit addresses but with the conversion from C to Go of the source I'm having difficulty finding if there is still something as simple to modify. </p>\n\n<p>This commit that changed max memory to 128GB from 16GB shows the kind of change I am talking about <a href=\"https://code.google.com/p/go/source/detail?r=a310cb32c278\" rel=\"nofollow\">https://code.google.com/p/go/source/detail?r=a310cb32c278</a></p>\n"}, {"tags": ["go", "docstring"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1422706554, "post_id": 28251091, "comment_id": 44862251, "body": "The <code>go&#47;doc</code> package may help. <a href=\"http://golang.org/pkg/go/doc/#ToHTML\" rel=\"nofollow noreferrer\">golang.org/pkg/go/doc/#ToHTML</a>"}, {"owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1422710596, "post_id": 28251091, "comment_id": 44863222, "body": "@Intermernet, I still don&#39;t see a way to access the docstring of the current file."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 2, "creation_date": 1422710875, "post_id": 28251091, "comment_id": 44863290, "body": "@techtonik you can&#39;t do that on runtime unless you manually load the go file (source code; e.g. main.go ) . You can do that with the parser package and you can extract the comments with the ast package. I had a question which may help you  <a href=\"http://stackoverflow.com/q/28246970/613453\">stackoverflow.com/q/28246970/613453</a> )"}], "answers": [{"comments": [{"owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "edited": false, "score": 0, "creation_date": 1422739050, "post_id": 28252586, "comment_id": 44871465, "body": "Looks like its impossible, indeed. Prooflink - <a href=\"http://blog.golang.org/godoc-documenting-go-code\" rel=\"nofollow noreferrer\">blog.golang.org/godoc-documenting-go-code</a>"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1422713727, "creation_date": 1422713727, "answer_id": 28252586, "question_id": 28251091, "link": "https://stackoverflow.com/questions/28251091/access-package-comment-from-inside-go-program/28252586#28252586", "title": "Access package comment from inside Go program?", "body": "<p>Go is not an interpreted language. The source code representation of a program is not part of a compiled Go program and cannot be generated from a compiled Go program. What you want is not possible without external tools that embed the parts of the source you want into the binary.</p>\n"}], "owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 28252586, "answer_count": 1, "score": 2, "last_activity_date": 1422713727, "creation_date": 1422703803, "question_id": 28251091, "link": "https://stackoverflow.com/questions/28251091/access-package-comment-from-inside-go-program", "title": "Access package comment from inside Go program?", "body": "<p>Is it possible to get package comment from inside of Go program? The equivalent Python code:</p>\n\n<pre><code>#!/usr/bin/env python\n\"\"\"\nProgram v1.0\n\"\"\"\nprint(__doc__)\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 490, "user_id": 299320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd1756e82d772e55c7dd92d7bd7baf8?s=128&d=identicon&r=PG", "display_name": "i80and", "link": "https://stackoverflow.com/users/299320/i80and"}, "is_accepted": false, "score": 1, "last_activity_date": 1423072948, "creation_date": 1423072948, "answer_id": 28328244, "question_id": 28250668, "link": "https://stackoverflow.com/questions/28250668/golang-nested-objects-in-mongodb/28328244#28328244", "title": "Golang nested objects in MongoDB", "body": "<p>For this problem, I would denormalize your schema a little to make querying in MongoDB more natural. Looking only at the types you need for this query, you might use the following:</p>\n\n<pre><code>type Movie struct {\n    Id     bson.ObjectId `_id,omitempty`\n    Name   string\n    Actors []bson.ObjectId\n}\n\ntype Actor struct {\n    Id     bson.ObjectId `_id,omitempty`\n    Name     string\n    Age      int\n    Ratings []Rating\n    NRatings int\n}\n</code></pre>\n\n<p>Here the Movie directly embeds the Actor IDs, and the Actor keeps track of the number of ratings in a separate field from the ratings themselves. If you only wanted to run this single type of query, you could fully denormalize the data model by embedding the Movies directly into the Actors who played in them. This would simplify the query even more, but would also create a lot of duplication of information and prevent you from dealing with Movies as separate entities.</p>\n\n<p>See <a href=\"http://docs.mongodb.org/manual/core/data-modeling-introduction/\" rel=\"nofollow\">the documentation on schema design</a> for a discussion on these tradeoffs.</p>\n\n<p>In this design, you can find the actors in the movie <a href=\"http://www.imdb.com/title/tt0432283/\" rel=\"nofollow\">Fantastic Mr. Fox</a> with fewer than 5 ratings using the following:</p>\n\n<pre><code>// Find the actors in the movie\nvar m Movie\ndb.C(\"movies\").Find(bson.M{\"name\": \"Fantastic Mr. Fox\"}).One(&amp;m)\n\n// Filter the actors to find those with less than 5 ratings.\nvar results []Actor\ndb.C(\"actors\").Find(bson.M{\"_id\": bson.M{\"$in\": m.Actors}, \"nratings\": bson.M{\"$lt\": 5}}).All(&amp;results)\nfmt.Println(results)\n</code></pre>\n"}], "owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2018, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423072948, "creation_date": 1422700786, "last_edit_date": 1422700951, "question_id": 28250668, "link": "https://stackoverflow.com/questions/28250668/golang-nested-objects-in-mongodb", "title": "Golang nested objects in MongoDB", "body": "<p>I'm currently working on a small application that allows users to rate certain objects, my database (MongoDB) structure looks like this</p>\n\n<pre><code>Movie {\n    Id int\n    Name string\n}\nActor {\n    Id int\n    Name string\n    Age int\n}\nMovie_Actors {\n    Movie Movie\n    Actor Actor\n}\nUser {\n    Id int\n    Username string\n    Password string\n}\nRating {\n    Id int\n    User User\n    Actor Actor\n    Rating int\n}\n</code></pre>\n\n<p>My problem begins when I want to select all <code>Actors</code> in a <code>Movie</code> where there are less than 5 <code>Ratings</code></p>\n\n<pre><code>// db *mgo.Database\nc := db.C('ratings')\nerr := c.Find(...)\n</code></pre>\n"}, {"tags": ["go", "martini"], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 4514265, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WHTU0H6Btt4/AAAAAAAAAAI/AAAAAAAAAA0/WiqfE7a-fKI/photo.jpg?sz=128", "display_name": "Ra&#250;l Gonz&#225;lez Mart&#237;nez", "link": "https://stackoverflow.com/users/4514265/ra%c3%bal-gonz%c3%a1lez-mart%c3%adnez"}, "is_accepted": false, "score": 0, "last_activity_date": 1422881215, "last_edit_date": 1422881215, "creation_date": 1422873551, "answer_id": 28275802, "question_id": 28250392, "link": "https://stackoverflow.com/questions/28250392/martini-binding-cannot-return-value-obtained-from-unexported-field-or-method/28275802#28275802", "title": "Martini Binding &quot;cannot return value obtained from unexported field or method&quot;", "body": "<p>I know the problem now.</p>\n\n<p>The problem is the attribute \"id\" of the User struct. If \"id\" is renamed to \"Id\" the binding process works perfectly. </p>\n\n<p>With tag <code>form:\"-\"</code> you can ignore struct attributes.</p>\n\n<pre><code>type User struct {\n    id         int       `form:\"-\"`\n    UUID       string    `json:\"uuid\"`\n    Username   string    `json:\"userName\" form:\"userName\" binding:\"required\"`\n    Firstname  string    `json:\"firstName\" form:\"Firstname\" binding:\"required`\n    Lastname   string    `json:\"lastName\" form:\"Lastname\" binding:\"required`\n    Email      string    `json:\"email\" form:\"Email\" binding:\"required`\n    IsActive   bool      `json:\"isActive\"`\n    DateJoined time.Time `json:\"dateJoined\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4514265, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WHTU0H6Btt4/AAAAAAAAAAI/AAAAAAAAAA0/WiqfE7a-fKI/photo.jpg?sz=128", "display_name": "Ra&#250;l Gonz&#225;lez Mart&#237;nez", "link": "https://stackoverflow.com/users/4514265/ra%c3%bal-gonz%c3%a1lez-mart%c3%adnez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3553, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1422881215, "creation_date": 1422698622, "last_edit_date": 1422700620, "question_id": 28250392, "link": "https://stackoverflow.com/questions/28250392/martini-binding-cannot-return-value-obtained-from-unexported-field-or-method", "title": "Martini Binding &quot;cannot return value obtained from unexported field or method&quot;", "body": "<p>I have the following route:</p>\n\n<pre><code>m.Post(\"/users\", binding.Bind(models.User{}), func(user models.User, r render.Render)\n</code></pre>\n\n<p>And I receive the following error message when I try to do a <code>Post</code> request:</p>\n\n<blockquote>\n  <p>\"PANIC: reflect.Value.Interface: cannot return value obtained from unexported field or method\"</p>\n</blockquote>\n\n<pre><code>type User struct {\n    id         int\n    UUID       string    `json:\"uuid\"`\n    Username   string    `json:\"userName\" form:\"userName\" binding:\"required\"`\n    Firstname  string    `json:\"firstName\" form:\"Firstname\" binding:\"required`\n    Lastname   string    `json:\"lastName\" form:\"Lastname\" binding:\"required`\n    Email      string    `json:\"email\" form:\"Email\" binding:\"required`\n    IsActive   bool      `json:\"isActive\"`\n    DateJoined time.Time `json:\"dateJoined\"`\n}\n</code></pre>\n\n<p>Does anyone have any idea?</p>\n"}, {"tags": ["go", "xz"], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 0, "creation_date": 1422774536, "post_id": 28250418, "comment_id": 44878083, "body": "This doesn&#39;t actually decompress via tar. You probably want tar xvJf archive.tar.xz..."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 0, "creation_date": 1422862217, "post_id": 28250418, "comment_id": 44900817, "body": "@Fire It does with GNU tar, as GNU tar automatically detects the presence of compression. None the less, to keep this program compatible with other tar implementations that do not provide <code>J</code>, you might want to set up a pipe between <code>xz -d</code> and <code>tar x</code>. Also, why do you provide <code>v</code>? It isn&#39;t required."}, {"owner": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 1, "creation_date": 1422896432, "post_id": 28250418, "comment_id": 44919840, "body": "That&#39;s true. <code>v</code> isn&#39;t required."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 4, "last_activity_date": 1422698840, "creation_date": 1422698840, "answer_id": 28250418, "question_id": 28249782, "link": "https://stackoverflow.com/questions/28249782/is-it-possible-to-extract-a-tar-xz-package-in-golang/28250418#28250418", "title": "Is it possible to extract a tar.xz package in golang?", "body": "<p><a href=\"http://golang.org/pkg/archive/tar/#example_\" rel=\"nofollow\">http://golang.org/pkg/archive/tar/#example_</a></p>\n\n<p>also you can do</p>\n\n<pre><code>import \"os/exec\"\n\ncmd := exec.Command(\"tar\", \"-x\", \"/your/archive.tar.xz\")\nerr := cmd.Run()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 0, "creation_date": 1422855002, "post_id": 28252723, "comment_id": 44898608, "body": "Note not enough arguments to return."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 0, "creation_date": 1422862116, "post_id": 28252723, "comment_id": 44900775, "body": "@Fire Sorry, I was tired when I wrote this. All bugs are fixed by now."}, {"owner": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 0, "creation_date": 1422895719, "post_id": 28252723, "comment_id": 44919375, "body": "I have code that processes the tar, but it is also <a href=\"http://golang.org/pkg/archive/tar/#example\" rel=\"nofollow noreferrer\">golang.org/pkg/archive/tar/#example</a> here.  It would be best for completeness to have code that starts from an os.Open() and decompresses xz using the above code. Afterwards, send it to tar and for each directory / file extract."}, {"owner": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 0, "creation_date": 1422896600, "post_id": 28252723, "comment_id": 44919928, "body": "It would be best for future searches I mean."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 0, "creation_date": 1422897399, "post_id": 28252723, "comment_id": 44920368, "body": "@Fire The rest is left as an exercise to the reader. It&#39;s not really difficult."}, {"owner": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "edited": false, "score": 0, "creation_date": 1422917631, "post_id": 28252723, "comment_id": 44930485, "body": "For future readers, note that <code>xz -d -T0</code> uses all the threads of the computer to decompress."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 1, "last_activity_date": 1422862073, "last_edit_date": 1422862073, "creation_date": 1422714557, "answer_id": 28252723, "question_id": 28249782, "link": "https://stackoverflow.com/questions/28249782/is-it-possible-to-extract-a-tar-xz-package-in-golang/28252723#28252723", "title": "Is it possible to extract a tar.xz package in golang?", "body": "<p>There is no Lempel-Ziv-Markow encoder or decoder in the Go standard library. If you are allowed to assume that the platform your code runs on provides the <code>xz</code> utility, you could use stub functions like these:</p>\n\n<pre><code>import \"os/exec\"\n\n// decompress xz compressed data stream r.\nfunc UnxzReader(r io.Reader) (io.ReadCloser, error) {\n    unxz := exec.Command(\"xz\", \"-d\")\n    unxz.Stdin = r\n    out, err := unxz.StdoutPipe()\n    if err != nil {\n        return nil, err\n    }\n\n    err = unxz.Start()\n    if err != nil {\n        return nil, err\n    }\n\n    // we are not interested in the exit status, but we should really collect\n    // that zombie process\n    go unxz.Wait()\n\n    return out, nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 5130206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540f4bd65dcead6af4ba33827493ae16?s=128&d=identicon&r=PG&f=1", "display_name": "xi2", "link": "https://stackoverflow.com/users/5130206/xi2"}, "is_accepted": true, "score": 4, "last_activity_date": 1531254354, "last_edit_date": 1531254354, "creation_date": 1437221637, "answer_id": 31491033, "question_id": 28249782, "link": "https://stackoverflow.com/questions/28249782/is-it-possible-to-extract-a-tar-xz-package-in-golang/31491033#31491033", "title": "Is it possible to extract a tar.xz package in golang?", "body": "<p>I recently created an <a href=\"https://godoc.org/github.com/xi2/xz\" rel=\"nofollow noreferrer\">XZ decompression package</a> so it is now\npossible to extract a tar.xz using only Go code.</p>\n\n<p>The following code extracts the file <code>myfile.tar.xz</code> to the current\ndirectory:</p>\n\n<pre><code>package main\n\nimport (\n    \"archive/tar\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n\n    \"github.com/xi2/xz\"\n)\n\nfunc main() {\n    // Open a file\n    f, err := os.Open(\"myfile.tar.xz\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    // Create an xz Reader\n    r, err := xz.NewReader(f, 0)\n    if err != nil {\n        log.Fatal(err)\n    }\n    // Create a tar Reader\n    tr := tar.NewReader(r)\n    // Iterate through the files in the archive.\n    for {\n        hdr, err := tr.Next()\n        if err == io.EOF {\n            // end of tar archive\n            break\n        }\n        if err != nil {\n            log.Fatal(err)\n        }\n        switch hdr.Typeflag {\n        case tar.TypeDir:\n            // create a directory\n            fmt.Println(\"creating:   \" + hdr.Name)\n            err = os.MkdirAll(hdr.Name, 0777)\n            if err != nil {\n                log.Fatal(err)\n            }\n        case tar.TypeReg, tar.TypeRegA:\n            // write a file\n            fmt.Println(\"extracting: \" + hdr.Name)\n            w, err := os.Create(hdr.Name)\n            if err != nil {\n                log.Fatal(err)\n            }\n            _, err = io.Copy(w, tr)\n            if err != nil {\n                log.Fatal(err)\n            }\n            w.Close()\n        }\n    }\n    f.Close()\n}\n</code></pre>\n"}], "owner": {"reputation": 257, "user_id": 381724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66349e4630b8f49508e271b01fba4e18?s=128&d=identicon&r=PG", "display_name": "Fire", "link": "https://stackoverflow.com/users/381724/fire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3277, "favorite_count": 1, "accepted_answer_id": 31491033, "answer_count": 3, "score": 3, "last_activity_date": 1531254354, "creation_date": 1422693725, "last_edit_date": 1437331372, "question_id": 28249782, "link": "https://stackoverflow.com/questions/28249782/is-it-possible-to-extract-a-tar-xz-package-in-golang", "title": "Is it possible to extract a tar.xz package in golang?", "body": "<p>Is it possible to extract a tar.xz package in golang? My understanding is it's possible to use the library for tar and sending it to an xz go library.</p>\n"}, {"tags": ["go", "static-analysis"], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422691578, "post_id": 28249535, "comment_id": 44858846, "body": "I&#39;m aware of the reflect package but the question is quite different."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422691704, "post_id": 28249535, "comment_id": 44858860, "body": "@Theuserwithnohat then please edit your question and explain how it is different, because the example you&#39;ve given (JSON schema) can be done with <code>reflect</code>."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422692029, "post_id": 28249535, "comment_id": 44858923, "body": "The point is that the code is loaded from an external file / source code."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1422691228, "creation_date": 1422691228, "answer_id": 28249535, "question_id": 28249366, "link": "https://stackoverflow.com/questions/28249366/how-to-evaluate-external-go-source-code-dynamically/28249535#28249535", "title": "How to evaluate external go source code &quot;dynamically&quot;?", "body": "<p>If you need to extract type information at runtime, you need to use the <a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow\"><code>reflect</code></a> package. This is the way Go's <code>encoding/json</code> and other similar packages work.</p>\n"}, {"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422702943, "post_id": 28250545, "comment_id": 44861425, "body": "The issue is how to use the type found in the source code and use it in the current program I&#39;m running  not how to parse the source code. I&#39;ve edited the question with some code to make sure the issue is understood."}, {"owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422728783, "post_id": 28250545, "comment_id": 44868393, "body": "What do you want to do with it? It&#39;s not at all clear from your question what you&#39;re trying to ultimately achieve. Depending on your needs, you may simply have to inspect the fields in the type loaded from the source and output the necessary JSON yourself."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422737668, "post_id": 28250545, "comment_id": 44871047, "body": "In the example provided in the question I&#39;ve encoded <code>sometype</code> which is part of the running program. The question is simply how to encode <code>alltype</code> too which is not part of the main program(I&#39;ve loaded the source as a string as the playground doesn&#39;t have file access)."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422737687, "post_id": 28250545, "comment_id": 44871053, "body": "Can you please point me how to do this that?  (inspect the fields in the type loaded from the source and output the necessary JSON). The main issue is that I can&#39;t find a way to &quot;load&quot; the type from source code.  As far what I&#39;m trying to do let&#39;s say that I want to extract  some types from  a *.go source code file and encode them so that they can serve as &quot;documentation&quot;. In the question I&#39;ve used the json package but I&#39;m actually planning to use json schema which basically &quot;documents&quot; the types for web applications. You may think of this as godoc for web."}, {"owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422739517, "post_id": 28250545, "comment_id": 44871575, "body": "You should expect the <code>TypeSpec</code> to contain a <code>StructType</code> in its <code>node</code> field; you can then iterate over its <code>FieldList</code> to get all the fields and their data types, and output those however you wish."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422746131, "post_id": 28250545, "comment_id": 44873359, "body": "I need to evaluate the type not to print it. Can you write a snippet which encodes <code>type allTypes</code> as provided in the question?"}, {"owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422861481, "post_id": 28250545, "comment_id": 44900540, "body": "What do you mean by &quot;evaluate&quot; in this context? What do you actually need to do with the type?"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422930847, "post_id": 28250545, "comment_id": 44934413, "body": "I have an example in the question. See the latest comment from the snippet provided. I kinda get what you mean but to me it seems to requires a great amount of effort(maybe I&#39;m overestimating)  so if you can solve the issue from the example provided(encode alltypes which is a &quot;simple&quot; tyoe) I will definitely consider it the right answer."}, {"owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422963078, "post_id": 28250545, "comment_id": 44947653, "body": "As rfilam says in his answer, you can&#39;t (practically speaking) load the type and expect the compiler to do it for you - you&#39;ll have to inspect the type and output its schema yourself."}], "tags": [], "owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1422699777, "creation_date": 1422699777, "answer_id": 28250545, "question_id": 28249366, "link": "https://stackoverflow.com/questions/28249366/how-to-evaluate-external-go-source-code-dynamically/28250545#28250545", "title": "How to evaluate external go source code &quot;dynamically&quot;?", "body": "<p>If you want to operate on the types defined in a Go source file, you can use the <a href=\"http://golang.org/pkg/go/parser/\" rel=\"nofollow\">go.parser</a> package to read and parse a source file into an AST, then traverse the AST for the elements you want to examine.</p>\n"}, {"tags": [], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "is_accepted": false, "score": 0, "last_activity_date": 1422746412, "last_edit_date": 1422746412, "creation_date": 1422737958, "answer_id": 28256470, "question_id": 28249366, "link": "https://stackoverflow.com/questions/28249366/how-to-evaluate-external-go-source-code-dynamically/28256470#28256470", "title": "How to evaluate external go source code &quot;dynamically&quot;?", "body": "<p>It seems there is no way to load the type information extracted from the source code(please correct me if I'm wrong).  The only solution is to create/generate a package (main), inject it with all the types extracted from the target source code file, build/compile it, execute it and collect the encoded data from stdout.</p>\n"}, {"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1422970061, "post_id": 28291894, "comment_id": 44951650, "body": "would you mind to share a snippet which encodes <code>allType</code> as provided in the question? The question is actually what&#39;s the best way to use solve this problem so I assume that the ast parsing &amp; encoding should be easier than compile &amp; stdout, right?"}], "tags": [], "owner": {"reputation": 198, "user_id": 1363306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cf39a73546e2a48d7a491e461bbdbbe?s=128&d=identicon&r=PG", "display_name": "rfliam", "link": "https://stackoverflow.com/users/1363306/rfliam"}, "is_accepted": false, "score": 1, "last_activity_date": 1422941274, "last_edit_date": 1422941274, "creation_date": 1422940921, "answer_id": 28291894, "question_id": 28249366, "link": "https://stackoverflow.com/questions/28249366/how-to-evaluate-external-go-source-code-dynamically/28291894#28291894", "title": "How to evaluate external go source code &quot;dynamically&quot;?", "body": "<p>If I understand you are asking for dynamic type loading ala Java's <code>Class.forName(String className)</code>. The short answer is Go doesn't support this. </p>\n\n<p>The correct way, as Nick Johnson pointed out, is to parse the tree using ast, and then \"generate\" the JSON yourself. You will not be able to \"load\" the type and use <code>JSON.Marshal</code>. It is also worth noting that any type which supports the <code>json.Marshaler</code> interface may generate custom JSON. You also need to ignore, but mark optional \"omitempty\" behavior. This really prevents you from using the compile it and hack through \"stdout\" behavior as well.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1422941274, "creation_date": 1422689649, "last_edit_date": 1422930873, "question_id": 28249366, "link": "https://stackoverflow.com/questions/28249366/how-to-evaluate-external-go-source-code-dynamically", "title": "How to evaluate external go source code &quot;dynamically&quot;?", "body": "<p>I need to parse a  Go source code file, find a specific type (by name) and use it in my program. \n I already managed to find the type I need using the <a href=\"http://golang.org/pkg/go/ast/\" rel=\"nofollow\">go/ast</a> package but I don't know how to \"load\" it into my program so that I can use it. </p>\n\n<p>Question: What's the best way to extract and use a type from an external source code file and use it on runtime?</p>\n\n<p>I can't think of anything except an ugly method to basically copy the file, modify it by injecting a \"main\" function with my encoding stuff which sends the result to stdOut, execute the it, collect the encoded data from stdout, delete the modified file.</p>\n\n<p>Use case: Analyse go source code and encode the types in a specific format (e.g. json schema) </p>\n\n<p>Edit:\nHere is some code. The question is how to encode <code>type allTypes</code> (zero value) and then print it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"go/ast\"\n    \"go/parser\"\n    \"go/token\"\n    \"encoding/json\"\n)\n    var src string = `\npackage mypack\n\ntype allTypes struct{\n    Brands Brands\n    Colours Colours\n}\ntype Brands struct{\n    Sony string\n    Apple string\n}\n\ntype Colours struct{\n    Red string\n    Green string\n}\n\n`\ntype sometype struct{\n    Nothing int\n}\nfunc main() {\n    // src is the input for which we want to inspect the AST.\n\n    // Create the AST by parsing src.\n    fset := token.NewFileSet() // positions are relative to fset\n    f, err := parser.ParseFile(fset, \"src.go\", src, 0)\n    if err != nil {\n        panic(err)\n    }\n\n    // Inspect the AST and find our function\n    var tp ast.TypeSpec\n    ast.Inspect(f, func(n ast.Node) bool {\n        switch x := n.(type) {\n        case *ast.TypeSpec:\n            if x.Name.Name == \"allTypes\"{\n                tp = *x\n            }\n        }\n        return true\n    })\n\n    fmt.Printf(\"We found the type: it is %v\", tp)\n    // Encode the zero value of sometype\n    x := sometype{}\n    b, _ := json.Marshal(&amp;x)\n    fmt.Printf(\"\\n Zero value of someType (json) %s\", b)\n    //Next/Question: How to encode the zero value of \"allTypes\" ???\n}\n</code></pre>\n\n<p>Also on <a href=\"http://play.golang.org/p/2XjrxKoUdU\" rel=\"nofollow\">playground</a></p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 506, "user_id": 1432249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab39d7e547423f2a0c72823eeec95b2?s=128&d=identicon&r=PG", "display_name": "Rouven We&#223;ling", "link": "https://stackoverflow.com/users/1432249/rouven-we%c3%9fling"}, "edited": false, "score": 0, "creation_date": 1422704746, "post_id": 28247830, "comment_id": 44861815, "body": "Thanks a lot! I foolishly only checked the documentation for the Unmarshal function."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1422678598, "last_edit_date": 1422678598, "creation_date": 1422674767, "answer_id": 28247830, "question_id": 28247649, "link": "https://stackoverflow.com/questions/28247649/why-are-string-and-bytes-treated-differently-when-unmarshaling-json/28247830#28247830", "title": "Why are string and []bytes treated differently when unmarshaling JSON?", "body": "<p>The designers of the <a href=\"http://godoc.org/encoding/json\" rel=\"nofollow\">encoding/json</a> package made the decision that applications must provide valid UTF-8 text in <code>string</code> values and that applications can put arbitrary byte sequences in <code>[]byte</code> values.  The package base64 encodes <code>[]byte</code> values to ensure that the resulting string is valid UTF-8.</p>\n\n<p>The encoding of <code>[]byte</code> values is described in the <a href=\"http://godoc.org/encoding/json#Marshal\" rel=\"nofollow\">Marshal function documentation</a>.</p>\n\n<p>This decision was not dictated by the design of the Go language.  The <code>string</code> type can contain arbitrary byte sequences.  The <code>[]byte</code> type can contain valid UTF-8 text.</p>\n\n<p>The designers could have used a flag in the field tag to indicate that a <code>string</code> or <code>[]byte</code> value should be encoded and which encoder to use, but that's not what they did.</p>\n"}], "owner": {"reputation": 506, "user_id": 1432249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab39d7e547423f2a0c72823eeec95b2?s=128&d=identicon&r=PG", "display_name": "Rouven We&#223;ling", "link": "https://stackoverflow.com/users/1432249/rouven-we%c3%9fling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 28247830, "answer_count": 1, "score": 0, "last_activity_date": 1424818965, "creation_date": 1422672697, "last_edit_date": 1424818965, "question_id": 28247649, "link": "https://stackoverflow.com/questions/28247649/why-are-string-and-bytes-treated-differently-when-unmarshaling-json", "title": "Why are string and []bytes treated differently when unmarshaling JSON?", "body": "<p>My understanding from reading the documentation was that <code>string</code> is essentially an immutable <code>[]byte</code> and that one can easily convert between the two.</p>\n\n<p>However when unmarshaling from JSON this doesn't seem to be true. Take the following example program:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype STHRaw struct {\n    Hash []byte `json:\"hash\"`\n}\n\ntype STHString struct {\n    Hash string `json:\"hash\"`\n}\n\nfunc main() {\n    bytes := []byte(`{\"hash\": \"nuyHN9wx4lZL2L3Ir3dhZpmggTQEIHEZcC3DUNCtQsk=\"}`)\n\n    stringHead := new(STHString)\n    if err := json.Unmarshal(bytes, &amp;stringHead); err != nil {\n        return\n    }\n\n    rawHead := new(STHRaw)\n    if err := json.Unmarshal(bytes, &amp;rawHead); err != nil {\n        return\n    }\n\n    fmt.Printf(\"String:\\t\\t%x\\n\", stringHead.Hash)\n    fmt.Printf(\"Raw:\\t\\t%x\\n\", rawHead.Hash)\n    fmt.Printf(\"Raw to string:\\t%x\\n\", string(rawHead.Hash[:]))\n}\n</code></pre>\n\n<p>This gives the following output:</p>\n\n<pre><code>String:         6e7579484e397778346c5a4c324c3349723364685a706d67675451454948455a63433344554e437451736b3d\nRaw:            9eec8737dc31e2564bd8bdc8af77616699a0813404207119702dc350d0ad42c9\nRaw to string:  9eec8737dc31e2564bd8bdc8af77616699a0813404207119702dc350d0ad42c9 \n</code></pre>\n\n<p>Instead I would have expected to receive the same value each time.</p>\n\n<p>What is the difference?</p>\n"}, {"tags": ["parsing", "go"], "answers": [{"comments": [{"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1422674171, "post_id": 28247287, "comment_id": 44855999, "body": "Any idea why the method receiver type has to use a generic {{interface}} type  and not <code>StarExpr</code> ? There doesn&#39;t seem to be more ways to declare a method."}], "tags": [], "owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "is_accepted": true, "score": 6, "last_activity_date": 1422668488, "creation_date": 1422668488, "answer_id": 28247287, "question_id": 28246970, "link": "https://stackoverflow.com/questions/28246970/how-to-parse-a-method-declaration/28247287#28247287", "title": "How to parse a method declaration?", "body": "<p>To get the type you need to look at the <code>Type</code> attribute which could be an <code>ast.StarExpr</code> or an <code>ast.Ident</code>.</p>\n\n<p>Here take a look at <a href=\"http://play.golang.org/p/sn0-MioJel\" rel=\"noreferrer\">this</a> :</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"go/ast\"\n    \"go/parser\"\n    \"go/token\"\n)\n\nfunc main() {\n    // src is the input for which we want to inspect the AST.\n    src := `\npackage mypack\n// type hello is a cool type\ntype hello string\n\n// type notype is not that cool\ntype notype int\n\n// printme is like nothing else.\nfunc (x *hello)printme(s string)(notype, error){\n    return 0, nil\n}\n`\n    // Create the AST by parsing src.\n    fset := token.NewFileSet() // positions are relative to fset\n    f, err := parser.ParseFile(fset, \"src.go\", src, 0)\n    if err != nil {\n        panic(err)\n    }\n\n    // Inspect the AST and find our function\n    var mf ast.FuncDecl\n    ast.Inspect(f, func(n ast.Node) bool {\n        switch x := n.(type) {\n        case *ast.FuncDecl:\n            mf = *x\n        }\n        return true\n    })\n\n    if mf.Recv != nil {\n        for _, v := range mf.Recv.List {\n            fmt.Print(\"recv type : \")\n            switch xv := v.Type.(type) {\n            case *ast.StarExpr:\n                if si, ok := xv.X.(*ast.Ident); ok {\n                    fmt.Println(si.Name)\n                }\n            case *ast.Ident:\n                fmt.Println(xv.Name)\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 3, "accepted_answer_id": 28247287, "answer_count": 1, "score": 5, "last_activity_date": 1430872992, "creation_date": 1422665508, "last_edit_date": 1430872992, "question_id": 28246970, "link": "https://stackoverflow.com/questions/28246970/how-to-parse-a-method-declaration", "title": "How to parse a method declaration?", "body": "<p>I'm trying to parse a method declaration. Basically I need to get the syntax node of the receiver base type (<code>type hello</code>) and the return types (<code>notype</code> and <code>error</code>). The <code>ast</code> package seems straightforward but for some reason I don't get the data I need (i.e. the fields are reported nil). </p>\n\n<p>The only useful data seems provided only in <code>Object -&gt; Decl</code> field  which is of type <code>interface{}</code>  so I don't think I can serialize it.</p>\n\n<p>Any help would be appreciated. Code below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"go/ast\"\n    \"go/parser\"\n    \"go/token\"\n)\n\nfunc main() {\n    // src is the input for which we want to inspect the AST.\n    src := `\npackage mypack\n// type hello is a cool type\ntype hello string\n\n// type notype is not that cool\ntype notype int\n\n// func printme is like nothing else.\nfunc (x *hello)printme(s string)(notype, error){\n    return 0, nil\n}\n`\n    // Create the AST by parsing src.\n    fset := token.NewFileSet() // positions are relative to fset\n    f, err := parser.ParseFile(fset, \"src.go\", src, 0)\n    if err != nil {\n        panic(err)\n    }\n\n    // Inspect the AST and find our function\n    var mf ast.FuncDecl\n    ast.Inspect(f, func(n ast.Node) bool {\n        switch x := n.(type) {\n        case *ast.FuncDecl:\n            mf = *x\n        }\n        return true\n    })\n\n    if mf.Recv != nil {\n        fmt.Printf(\"\\n receivers:\")\n        for _, v := range mf.Recv.List {\n            fmt.Printf(\",tag %v\", v.Tag)\n            for _, xv := range v.Names {\n                fmt.Printf(\"name %v, decl %v, data %v, type %v\",\n                    xv.Name, xv.Obj.Decl, xv.Obj.Data, xv.Obj.Type)\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/U0q9Un0Icu\" rel=\"nofollow\">Playground</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1422654335, "post_id": 28244595, "comment_id": 44850934, "body": "<code>stats.StackSys = stats.StackInuse</code> is not <code>stats.StackSys equals stats.StackInuse</code>, but <b>assigns</b> <code>stats.StackInuse</code> to <code>stats.StackSys</code>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1422654381, "post_id": 28244595, "comment_id": 44850959, "body": "<code>stats.HeapInuse -= stats.StackInuse</code> is shorthand for <code>stats.HeapInuse = stats.HeapInuse  - stats.StackInuse</code>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1422655164, "post_id": 28244595, "comment_id": 44851321, "body": "And take a look at the <a href=\"http://golang.org/pkg/runtime/#MemStats\" rel=\"nofollow noreferrer\">runtime</a> docs."}, {"owner": {"reputation": 467, "user_id": 1930945, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/sSjw1.png?s=128&g=1", "display_name": "Tomoko Yamaguchi", "link": "https://stackoverflow.com/users/1930945/tomoko-yamaguchi"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1422732673, "post_id": 28244595, "comment_id": 44869541, "body": "sorry I know that <code>stats.StackSys = stats.StackInuse</code>  is assigns, but after assignment the two are equal.  Runtime docs don&#39;t clarify this comment, <code>Stack numbers are part of the heap numbers, separate those out for user consumption</code>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423064430, "post_id": 28244595, "comment_id": 44998327, "body": "You do realize that the difference between stack and heap is hard to draw in Go? Go uses small stacks allocated on the heap."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1423149279, "post_id": 28244595, "comment_id": 45039111, "body": "@TomokoYamaguchi I think that it&#39;s better to ask in the <a href=\"http://groups.google.com/group/golang-nuts\" rel=\"nofollow noreferrer\">golang-nuts</a> mailing list. It&#39;s popular and is frequented by the Go creators, who know more about this struct than anyone."}, {"owner": {"reputation": 467, "user_id": 1930945, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/sSjw1.png?s=128&g=1", "display_name": "Tomoko Yamaguchi", "link": "https://stackoverflow.com/users/1930945/tomoko-yamaguchi"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1423163232, "post_id": 28244595, "comment_id": 45047852, "body": "@FUZxxl that&#39;s fine, but the fields in the memstats Struct clearly delineate something,and the comment quoted in the OP says that they should be distinguishable, so I think an answer is possible"}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1423473809, "post_id": 28402606, "comment_id": 45146988, "body": "I&#39;m not seeing TotalAlloc grow if I allocate big locals or start lots of goroutines. I know you know more about Go internals than I do--feel free to set me straight or point me in the right direction if I said something wrong in my answer (I may be slow to update (day job!) but don&#39;t want to leave bad info up if it&#39;s bad)."}, {"owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1423524123, "post_id": 28402606, "comment_id": 45175867, "body": "Thanks for the comment.  You&#39;re right, and I&#39;m wrong.  I misread some of the code.  I will edit my answer."}], "tags": [], "owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "is_accepted": true, "score": 6, "last_activity_date": 1423524870, "last_edit_date": 1423524870, "creation_date": 1423454264, "answer_id": 28402606, "question_id": 28244595, "link": "https://stackoverflow.com/questions/28244595/which-fields-in-memstats-struct-refer-only-to-heap-only-to-stack/28402606#28402606", "title": "which fields in memstats struct refer only to heap, only to stack", "body": "<p>These questions are a little hard to answer because the goroutine stacks are allocated from the heap.  Go does not have the clear separation between stack and heap that exists in C.</p>\n\n<p><strong>Does total allocation field include heap, stack or both?</strong></p>\n\n<p>The TotalAlloc field of the MemStats struct includes all memory that the Go runtime has requested from the OS for the Go heap.  It does not include memory allocated for goroutine stacks.  Initially I thought it did, but I was wrong.  Sorry for the confusion.  I hope this answer is more accurate.</p>\n\n<p>(To be precise, I should mention that in a program that uses cgo every thread (not goroutine--there are normally more goroutines than threads) will have a stack allocated by the OS; that stack is not allocated by the Go runtime and is not counted in TotalAlloc.  It is only used by cgo calls.)</p>\n\n<p><strong>which heap fields do not include numbers stack?</strong>\n<strong>which heap fields include numbers for stack?</strong></p>\n\n<p>These fields include numbers for goroutine stacks: HeapIdle, HeapReleased.</p>\n\n<p>These fields do not include numbers for goroutine stacks: HeapAlloc, HeapInUse, HeapObjects.</p>\n\n<p>The HeapSys field does not include memory used by currently active goroutine stacks, but does include memory for goroutine stacks that were once in use but were then freed.</p>\n\n<p><strong>which stack fields do not include numbers for heap?</strong></p>\n\n<p>I don't know how to answer this question in a way that makes sense.  The stack fields report information specifically about goroutine stacks.</p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 4, "last_activity_date": 1423518441, "last_edit_date": 1423518441, "creation_date": 1423473468, "answer_id": 28406247, "question_id": 28244595, "link": "https://stackoverflow.com/questions/28244595/which-fields-in-memstats-struct-refer-only-to-heap-only-to-stack/28406247#28406247", "title": "which fields in memstats struct refer only to heap, only to stack", "body": "<p>From running (variations of) <a href=\"http://play.golang.org/p/aK1kco6k4n\" rel=\"nofollow\">a test program</a> and peeking at the Go source, I'm seeing:</p>\n\n<ul>\n<li><p>Alloc and TotalAlloc appear to cover only non-stack allocations. Allocating big locals did not add their size to TotalAlloc, even when it caused stacks to grow.</p></li>\n<li><p>If memory is currently reserved for a goroutine's stack it counts in the StackX vars and not the HeapX vars. This is the subtraction you found in the source. It also implies anything that allocates space for stacks can reduce HeapSys and HeapIdle but leave HeapInuse alone.</p>\n\n<ul>\n<li>Because you asked: stack fields never include heap allocations--stacks come from the heap but not vice versa.</li>\n<li>Variables you think are on the heap (<code>ssp := new(SomeStruct)</code>) might in fact be stack-allocated if escape analysis can determine they don't outlive the function call. This is almost always useful to you, because those vars can be freed at function exit without generating garbage for the GC. Don't worry about this too much. :)</li>\n</ul></li>\n<li><p>Once a goroutine quits, its stack space <em>can</em> be returned to the heap. (If its stack is small, though, it's likely be cached to be reused as a future goroutine's stack.) Then it will not show up as stack space and may show up as available heap space again. I'm seeing this both empirically and in the Go source (proc.c's gfput calling runtime\u00b7stackfree). That means that exiting goroutines or old stacks being returned after stack growth can appear to grow HeapSys and HeapIdle, but it's really just space shifting between uses.</p></li>\n<li><p>There appears to be no TotalAlloc-style running counter covering all pages ever allocated for stacks. If a goroutine's stack is freed and reused it only gets counted once. </p></li>\n<li><p>There is definitely no TotalAlloc-style running counter covering all stack-allocated variables ever. That would involve tracking overhead per function call.</p></li>\n</ul>\n\n<p><strong>Stack related problems are relatively rare</strong>, because stack-allocated variables are freed on function return, and large stacks themselves are freed on goroutine exit. They <em>can</em> happen, like if goroutines are leaking (never exiting even as you create new ones), or if you make huge stack allocations (<code>var bigLocal [1e7]uint64</code>, or ridiculous deep recursion) in goroutines that don't exit. But it's a lot more common to have trouble with the heap, since stuff on the heap isn't freed until GC (tools like the standard <a href=\"http://golang.org/pkg/sync/#Pool\" rel=\"nofollow\"><code>Pool</code></a> help you <em>recycle</em> heap-allocated items to delay the need for GC). </p>\n\n<p>So, practically speaking, I would mostly keep an eye on Alloc and TotalAlloc for heap overuse, and if somehow stack space becomes a problem, look at the stack numbers (and maybe <a href=\"http://golang.org/pkg/runtime/#GoroutineProfile\" rel=\"nofollow\">check for unexpectedly many running goroutines</a>). </p>\n\n<p>These observations are implementation-specific (I'm looking at go 1.4, not tip), and I am not an expert on the Go source code, so take as what they are. That test program, for reference:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"runtime\"\n    \"sync\"\n)\n\nvar g []byte\n\nfunc usesHeap() {\n    g = make([]byte, 1000)\n}\n\nfunc usesTempStack() {\n    var l [1000]byte\n    _ = l\n}\n\nfunc createsGoroutineAndWaits() {\n    wg := new(sync.WaitGroup)\n    wg.Add(1)\n    go func() {\n        usesTempStack()\n        wg.Done()\n    }()\n    wg.Wait()\n}\n\nfunc createsGoroutine() {\n    go usesTempStack()\n}\n\nfunc recurse(depth int, max int) {\n    var l [1024]byte\n    _ = l\n    if depth &lt; max {\n        recurse(depth+1, max)\n    }\n}\n\nfunc growsTheStack() {\n    recurse(0, 1000)\n}\n\nfunc checkUsageOf(lbl string, f func(), before, after *runtime.MemStats) {\n    _ = new(sync.WaitGroup)\n    runtime.ReadMemStats(before)\n\n    // using own goroutine so everyone starts w/the same stack size\n    wg := new(sync.WaitGroup)\n    wg.Add(1)\n    // request GC in hopes of a fair start\n    runtime.GC()\n    go func() {\n        runtime.ReadMemStats(before)\n        for i := 0; i &lt; 1000; i++ {\n            f()\n        }\n        runtime.Gosched()\n        runtime.ReadMemStats(after)\n        wg.Done()\n    }()\n    wg.Wait()\n\n    fmt.Println(\"Results for\", lbl, \"\\n\")\n    beforeVal, afterVal := reflect.ValueOf(*before), reflect.ValueOf(*after)\n    memStatsType := beforeVal.Type()\n    fieldCount := memStatsType.NumField()\n    for i := 0; i &lt; fieldCount; i++ {\n        field := memStatsType.Field(i)\n        if field.Type.Kind() != reflect.Uint64 {\n            continue\n        }\n        beforeStat, afterStat := int64(beforeVal.Field(i).Uint()), int64(afterVal.Field(i).Uint())\n        if beforeStat == afterStat {\n            continue\n        }\n        fmt.Println(field.Name, \"differs by\", afterStat-beforeStat)\n    }\n    fmt.Println(\"\\n\")\n}\n\nfunc main() {\n    before, after := new(runtime.MemStats), new(runtime.MemStats)\n    checkUsageOf(\"growsTheStack\", growsTheStack, before, after)\n    checkUsageOf(\"createsGoroutineAndWaits\", createsGoroutine, before, after)\n    checkUsageOf(\"usesHeap\", usesHeap, before, after)\n    checkUsageOf(\"usesTempStack\", usesTempStack, before, after)\n    checkUsageOf(\"createsGoroutine\", createsGoroutine, before, after)\n}\n</code></pre>\n"}], "owner": {"reputation": 467, "user_id": 1930945, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/sSjw1.png?s=128&g=1", "display_name": "Tomoko Yamaguchi", "link": "https://stackoverflow.com/users/1930945/tomoko-yamaguchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 3, "accepted_answer_id": 28402606, "answer_count": 2, "score": 7, "last_activity_date": 1423524870, "creation_date": 1422651908, "last_edit_date": 1423004825, "question_id": 28244595, "link": "https://stackoverflow.com/questions/28244595/which-fields-in-memstats-struct-refer-only-to-heap-only-to-stack", "title": "which fields in memstats struct refer only to heap, only to stack", "body": "<p>Go runtime has a lot of different variables related to heap and stack and some of the stack numbers are part of the heap numbers, leading to confusion (for me). For example, <a href=\"https://github.com/golang/go/blob/master/src/runtime/mgc.go#L1743\">in this link</a>. it says</p>\n\n<pre><code>// Stack numbers are part of the heap numbers, separate those out for user consumption\n    stats.StackSys = stats.StackInuse\n    stats.HeapInuse -= stats.StackInuse\n    stats.HeapSys -= stats.StackInuse\n</code></pre>\n\n<p>In the <a href=\"http://golang.org/pkg/runtime/\">runtime docs</a> (excerpt below), it gives 7 different heap related fields (that is, fields of the memstat struct) without clearly explaining which ones include stack, and similarly, which stack fields are included in heap, and how that relates to total allocations.</p>\n\n<p>this is a problem, because I want to compare heap against stack, but I don't want to choose a heap variable that includes stack (obviously).</p>\n\n<p>Questions\n1). Does total allocation field include heap, stack or both?\n2) which heap fields do not include numbers stack?\n3) which heap fields include numbers for stack?\n4) which stack fields do not include numbers for heap?</p>\n\n<pre><code>  Alloc      uint64 // bytes allocated and still in use\n        TotalAlloc uint64 // bytes allocated (even if freed)\n        Sys        uint64 // bytes obtained from system (sum of XxxSys below)\n        Lookups    uint64 // number of pointer lookups\n        Mallocs    uint64 // number of mallocs\n        Frees      uint64 // number of frees\n\n        // Main allocation heap statistics.\n        HeapAlloc    uint64 // bytes allocated and still in use\n        HeapSys      uint64 // bytes obtained from system\n        HeapIdle     uint64 // bytes in idle spans\n        HeapInuse    uint64 // bytes in non-idle span\n        HeapReleased uint64 // bytes released to the OS\n        HeapObjects  uint64 // total number of allocated objects\n\n        // Low-level fixed-size structure allocator statistics.\n        //  Inuse is bytes used now.\n        //  Sys is bytes obtained from system.\n        StackInuse  uint64 // bytes used by stack allocator\n        StackSys    uint64\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "edited": false, "score": 0, "creation_date": 1422647555, "post_id": 28243409, "comment_id": 44847914, "body": "tangential to this, but I have a very fast queue implementation at <a href=\"https://github.com/eapache/queue/\" rel=\"nofollow noreferrer\">github.com/eapache/queue</a> which you can use - adding mutexes to that is probably still faster than writing your own"}], "answers": [{"comments": [{"owner": {"reputation": 4984, "user_id": 1013460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b92f3751fd7ac0f3e78c676d8f5b0a?s=128&d=identicon&r=PG", "display_name": "voidlogic", "link": "https://stackoverflow.com/users/1013460/voidlogic"}, "edited": false, "score": 1, "creation_date": 1422648753, "post_id": 28243464, "comment_id": 44848474, "body": "Or change the declaration of lock to be <code>lock sync.Mutex.</code>, no pointer"}], "tags": [], "owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "is_accepted": true, "score": 4, "last_activity_date": 1422647141, "creation_date": 1422647141, "answer_id": 28243464, "question_id": 28243409, "link": "https://stackoverflow.com/questions/28243409/using-mutexes-in-go/28243464#28243464", "title": "Using mutexes in Go", "body": "<p>Looks like the issue is that you're never instantiating the mutex. When you run the <code>New()</code> function you're creating an empty Queue with a variable that can reference a mutex, but you never actually tell it to do so, which means that at this point <code>queue.lock == nil</code>. You can fix this by adding in an instantiation line to your <code>New()</code> function.</p>\n\n<pre><code>queue.lock = new(sync.Mutex)\n</code></pre>\n\n<p>Here is a playground demo that works: <a href=\"http://play.golang.org/p/Qa6buDaHIj\" rel=\"nofollow\">http://play.golang.org/p/Qa6buDaHIj</a></p>\n"}, {"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1422774934, "post_id": 28244472, "comment_id": 44878157, "body": "This should be the chosen answer, you don&#39;t need to make the mutex a pointer."}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 15, "last_activity_date": 1422651381, "creation_date": 1422651381, "answer_id": 28244472, "question_id": 28243409, "link": "https://stackoverflow.com/questions/28243409/using-mutexes-in-go/28244472#28244472", "title": "Using mutexes in Go", "body": "<p>You get that error because you did not allocated any mutex, you have only a pointer to a mutex. \nMutex usually are declared inside the structure and without the pointer. See working example below:</p>\n\n<p><a href=\"http://play.golang.org/p/8LF3yVOkSW\" rel=\"noreferrer\">http://play.golang.org/p/8LF3yVOkSW</a></p>\n\n<pre><code>import \"sync\"\n\ntype Queue struct {\n    len int\n\n    lock  sync.Mutex // add it before the fields that are being protected by the mutex\n    queue []interface{}\n}\n\nfunc New() *Queue {\n    queue := &amp;Queue{}\n    queue.queue = make([]interface{}, 0)\n    queue.len = 0\n\n    return queue\n}\n\nfunc (q *Queue) Push(el interface{}) {\n    q.lock.Lock()\n    defer q.lock.Unlock()\n\n    q.queue = append(q.queue, el)\n    q.len++\n}\n\nfunc main() {\n    q := New()\n    q.Push(1)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 1863413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7e0fb89d33e32bf27c7ad59cc47aed?s=128&d=identicon&r=PG", "display_name": "ChrisLee", "link": "https://stackoverflow.com/users/1863413/chrislee"}, "is_accepted": false, "score": 2, "last_activity_date": 1494584045, "last_edit_date": 1494584045, "creation_date": 1491528250, "answer_id": 43268191, "question_id": 28243409, "link": "https://stackoverflow.com/questions/28243409/using-mutexes-in-go/43268191#43268191", "title": "Using mutexes in Go", "body": "<p>Zero value for a pointer is nil, q.lock is a nil pointer, dereference nil pointer will cause panic.\nYou can use <strong><em>lock sync.Mutex</em></strong> instead of <strong>*lock <em>sync.Mutex</em></strong>, zero value for a Mutex is an unlocked mutex.\n<strong>Struct anonymous nesting</strong> can also solve your problem:</p>\n\n<pre><code>package queue\n\nimport \"sync\"\n\ntype Queue struct {\n    queue []interface{}\n    len   int\n    sync.Mutex\n}\n\nfunc New() *Queue {\n    queue := &amp;Queue{}\n    queue.queue = make([]interface{}, 0)\n    queue.len = 0\n\n    return queue\n}\n\nfunc (q *Queue) Push(el interface{}) {\n    q.Lock()\n    defer q.Unlock()\n\n    q.queue = append(q.queue, el)\n    q.len++\n}\n</code></pre>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5854, "favorite_count": 0, "accepted_answer_id": 28243464, "answer_count": 3, "score": 4, "last_activity_date": 1494584045, "creation_date": 1422646892, "question_id": 28243409, "link": "https://stackoverflow.com/questions/28243409/using-mutexes-in-go", "title": "Using mutexes in Go", "body": "<p>I am trying to understand how mutexes work. From my understanding so far, it is made to carry atomic operations and synchronize access to some data.</p>\n\n<p>I built an example of a queue data structure here: <a href=\"https://github.com/arnauddri/algorithms/blob/master/data-structures%2Fqueue%2Fqueue.go\" rel=\"nofollow\">https://github.com/arnauddri/algorithms/blob/master/data-structures%2Fqueue%2Fqueue.go</a></p>\n\n<p>Here is a bit of the code:</p>\n\n<pre><code>package queue\n\nimport \"sync\"\n\ntype Queue struct {\n    queue []interface{}\n    len   int\n    lock  *sync.Mutex\n}\n\nfunc New() *Queue {\n    queue := &amp;Queue{}\n    queue.queue = make([]interface{}, 0)\n    queue.len = 0\n\n    return queue\n}\n\nfunc (q *Queue) Push(el interface{}) {\n    q.lock.Lock()\n    defer q.lock.Unlock()\n\n    q.queue = append(q.queue, el)\n    q.len++\n}\n</code></pre>\n\n<p>However when I try to create a queue and push an item to it I get a runtime error:</p>\n\n<pre><code>q := New()\nq.Push(1)\n\npanic: runtime error: invalid memory address or nil pointer dereference [recovered]\npanic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>I really don't understand what is happening here.</p>\n\n<p>How should I use the Mutex here?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 6959, "user_id": 411141, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/R4sK6.png?s=128&g=1", "display_name": "ehime", "link": "https://stackoverflow.com/users/411141/ehime"}, "edited": false, "score": 0, "creation_date": 1422645740, "post_id": 28243035, "comment_id": 44847028, "body": "How would I then turn my map into a struct?"}], "tags": [], "owner": {"reputation": 3021, "user_id": 1146303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbd332c7f56a631f09a65de8dcffb85d?s=128&d=identicon&r=PG", "display_name": "Haile", "link": "https://stackoverflow.com/users/1146303/haile"}, "is_accepted": true, "score": 1, "last_activity_date": 1422645254, "creation_date": 1422645254, "answer_id": 28243035, "question_id": 28242991, "link": "https://stackoverflow.com/questions/28242991/undefined-map-element-in-golang/28243035#28243035", "title": "Undefined map element in Golang", "body": "<p><code>template</code> is a map, not a <code>struct</code>. If you want to access the <code>datacenter</code> string you need to write <code>template[\"datacenter\"]</code>.</p>\n\n<p><a href=\"http://play.golang.org/p/M0PHGx8R8g\" rel=\"nofollow\">http://play.golang.org/p/M0PHGx8R8g</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar template map[string]string\n\nfunc main() {\n    template := map[string]string{\n        \"cluster\":    \"\",\n        \"datacenter\": \"The_Datacenter\",\n        \"host\":       \"\",\n        \"password\":   \"\",\n        \"username\":   \"\",\n        \"vm_name\":    \"\",\n    }\n\n    args := []string{\n        \"--acceptAllEulas\",\n        \"--compress=9\",\n    }\n\n    if template[\"datacenter\"] != \"\" {\n        args = append(args, fmt.Sprintf(\"--datacenter=%s\", template[\"datacenter\"]))\n    }\n\n    fmt.Println(template)\n}\n</code></pre>\n"}], "owner": {"reputation": 6959, "user_id": 411141, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/R4sK6.png?s=128&g=1", "display_name": "ehime", "link": "https://stackoverflow.com/users/411141/ehime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "accepted_answer_id": 28243035, "answer_count": 1, "score": -1, "last_activity_date": 1422645254, "creation_date": 1422644996, "question_id": 28242991, "link": "https://stackoverflow.com/questions/28242991/undefined-map-element-in-golang", "title": "Undefined map element in Golang", "body": "<p>For some reason I am getting the error below</p>\n\n<pre><code>./execTest.go:24: template.datacenter undefined (type map[string]string has no field or method datacenter)\n./execTest.go:25: template.datacenter undefined (type map[string]string has no field or method datacenter)\n</code></pre>\n\n<p>Here is my Go code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar template map[string]string\n\nfunc main() {\n    template := map[string]string{\n        \"cluster\":    \"\",\n        \"datacenter\": \"The_Datacenter\",\n        \"host\":       \"\",\n        \"password\":   \"\",\n        \"username\":   \"\",\n        \"vm_name\":    \"\",\n    }\n\n    args := []string{\n        \"--acceptAllEulas\",\n        \"--compress=9\",\n    }\n\n    if template.datacenter != \"\" {\n        args = append(args, fmt.Sprintf(\"--datacenter=%s\", template.datacenter))\n    }\n\n    fmt.Println(template)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 2953356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/baleC.jpg?s=128&g=1", "display_name": "Quinn Carver", "link": "https://stackoverflow.com/users/2953356/quinn-carver"}, "is_accepted": false, "score": 0, "last_activity_date": 1422643484, "creation_date": 1422643484, "answer_id": 28242632, "question_id": 28242430, "link": "https://stackoverflow.com/questions/28242430/setting-up-absolute-file-path-in-golang/28242632#28242632", "title": "Setting up absolute file path in Golang", "body": "<p>Run the <strong>install</strong> command with the <strong>go</strong> tool and you should be able to run your command from anywhere on your system. Here's a good link that gives an example of the <strong>install</strong> command: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How To Write Go Code</a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1422643744, "creation_date": 1422643744, "answer_id": 28242688, "question_id": 28242430, "link": "https://stackoverflow.com/questions/28242430/setting-up-absolute-file-path-in-golang/28242688#28242688", "title": "Setting up absolute file path in Golang", "body": "<p>You should check the error return from os.Open and handle it. </p>\n\n<p>You can get the absolute path to the source code directory using the <a href=\"http://godoc.org/go/build\" rel=\"nofollow\">go/build</a> package:</p>\n\n<pre><code>p, err := build.Default.Import(\"github.com/user/repo/dummy\", \"\", build.FindOnly)\nif err != nil {\n    // handle error\n}\nfname := filepath.Join(p.Dir, \"arrays.txt\")\n</code></pre>\n\n<p>This code assumes that the GOPATH environment variable is set. </p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1436, "favorite_count": 1, "accepted_answer_id": 28242688, "answer_count": 2, "score": 1, "last_activity_date": 1422643744, "creation_date": 1422642748, "question_id": 28242430, "link": "https://stackoverflow.com/questions/28242430/setting-up-absolute-file-path-in-golang", "title": "Setting up absolute file path in Golang", "body": "<p>I am a package whose only role is to provide a collection of dummy data read from files.</p>\n\n<p>It looks like this:</p>\n\n<pre><code>func GetArrayOfSize(n int) []int {\nf, _ := os.Open(\"./arrays.txt\")\ndefer f.Close()\n\nnumbers := make([]int, 0)\nscanner := bufio.NewScanner(f)\n\nfor scanner.Scan() {\n    s, _ := strconv.Atoi(scanner.Text())\n    numbers = append(numbers, s)\n}\n\n    return numbers[0:n]\n}\n</code></pre>\n\n<p>It works fine when I test it inside this package however whenever I call <code>GetArrayOfSize</code> from another package I get a runtime error:</p>\n\n<pre><code>panic: runtime error: slice bounds out of range [recovered]\n    panic: runtime error: slice bounds out of range\n</code></pre>\n\n<p>I am guessing this error is due to the relative path: <code>'./arrays.txt</code>. How can I fetch the absolute path of my <code>dummy</code> package to fix this?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "edited": false, "score": 0, "creation_date": 1422640934, "post_id": 28241870, "comment_id": 44844671, "body": "Can you show the current code that you have printing the struct without their keys?"}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 2253855, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8855ae0dd92cb343c3e7060b9d6dd0de?s=128&d=identicon&r=PG", "display_name": "Jordan Michael Rushing", "link": "https://stackoverflow.com/users/2253855/jordan-michael-rushing"}, "edited": false, "score": 0, "creation_date": 1422895230, "post_id": 28242119, "comment_id": 44919094, "body": "Hmm let me try this with my current code and see if it does that. I feel like I did it exactly like that before and it wasn&#39;t printing the keys of the structs for some reason. I&#39;ll comment on this in a few hours when I&#39;m back to my work computer, thanks Leo."}, {"owner": {"reputation": 502, "user_id": 2253855, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8855ae0dd92cb343c3e7060b9d6dd0de?s=128&d=identicon&r=PG", "display_name": "Jordan Michael Rushing", "link": "https://stackoverflow.com/users/2253855/jordan-michael-rushing"}, "edited": false, "score": 0, "creation_date": 1426962195, "post_id": 28242119, "comment_id": 46587840, "body": "Hey so I finally got around to checking out your answer. Sorry it took so long. So your example output only outputs: <code>foo struct : {Hello:world JSON:stuff}</code> Unfortunately I really need the quotes and commas like a normal JSON strong would have, so I don&#39;t think this way would work. Thanks though"}, {"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "reply_to_user": {"reputation": 502, "user_id": 2253855, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8855ae0dd92cb343c3e7060b9d6dd0de?s=128&d=identicon&r=PG", "display_name": "Jordan Michael Rushing", "link": "https://stackoverflow.com/users/2253855/jordan-michael-rushing"}, "edited": false, "score": 0, "creation_date": 1427134784, "post_id": 28242119, "comment_id": 46643987, "body": "I still don&#39;t understand what you&#39;re trying to accomplish. Why do you want to write out the struct as close as possible to JSON? You could just print out it&#39;s JSON representation which is the second line of that output by using <code>json.NewEncoder</code>"}, {"owner": {"reputation": 612, "user_id": 199093, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b4d4eafb531583c2bfe14a85655bdf08?s=128&d=identicon&r=PG", "display_name": "semi", "link": "https://stackoverflow.com/users/199093/semi"}, "edited": false, "score": 0, "creation_date": 1466098516, "post_id": 28242119, "comment_id": 63188643, "body": "If your problem is its not printing out the keys, make sure your keys all start with an uppercase letter. Lowercase signifies that it is not exported, so the encoding/json package will not see the keys and can not print them out."}], "tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": false, "score": 1, "last_activity_date": 1422641561, "creation_date": 1422641561, "answer_id": 28242119, "question_id": 28241870, "link": "https://stackoverflow.com/questions/28241870/go-lang-return-json/28242119#28242119", "title": "Go Lang Return JSON", "body": "<p>Printing a struct as JSON to STDOUT is fairly straight forward in Go:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    foo := struct {\n        Hello string\n        JSON  string\n    }{\n        Hello: \"world\",\n        JSON:  \"stuff\",\n    }\n\n    fmt.Printf(\"foo struct : %+v\\n\", foo)\n\n    if err := json.NewEncoder(os.Stdout).Encode(foo); err != nil {\n        log.Fatal(err)\n    }\n\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/wqqGJ1V_Zg\" rel=\"nofollow\">http://play.golang.org/p/wqqGJ1V_Zg</a></p>\n\n<p>That program will output the following:</p>\n\n<pre><code>foo struct : {Hello:world JSON:stuff}\n{\"Hello\":\"world\",\"JSON\":\"stuff\"}\n</code></pre>\n\n<p>From your question I really didn't understand what you meant. In any case, if you wanted to print the struct as JSON or if you just wanted to print the struct as close to JSON as possible your answer is there. </p>\n"}], "owner": {"reputation": 502, "user_id": 2253855, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8855ae0dd92cb343c3e7060b9d6dd0de?s=128&d=identicon&r=PG", "display_name": "Jordan Michael Rushing", "link": "https://stackoverflow.com/users/2253855/jordan-michael-rushing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1422641561, "creation_date": 1422640640, "question_id": 28241870, "link": "https://stackoverflow.com/questions/28241870/go-lang-return-json", "title": "Go Lang Return JSON", "body": "<p>Still pretty new with Go. I'm trying to get go to essentially print a struct with the keys and values as close to json as possible.</p>\n\n<p>The way I'm currently doing this is having GO on it's own server and whenever a get request is made, it returns the JSON. I would like to have GO as an executable on my primary Rails server and just return the JSON with something like Println (or whatever would make it stay in struct form). The problem is when I try to go this route, the keys from the struct aren't printed with it and I would basically have to add the keys as part of the return string.</p>\n\n<p>Is there a simple way to do this with keeping the correct keys and values (and their types, so if the value is an array, keep the array)</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 3, "last_activity_date": 1422642438, "last_edit_date": 1422642438, "creation_date": 1422641959, "answer_id": 28242226, "question_id": 28241595, "link": "https://stackoverflow.com/questions/28241595/organizing-and-testing-a-go-project/28242226#28242226", "title": "Organizing and testing a go project", "body": "<p>There is no language feature that will unite packages.</p>\n\n<p>You can call <code>go test ./...</code> to run all of your tests from your project root.</p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 28242226, "answer_count": 1, "score": 1, "last_activity_date": 1422642438, "creation_date": 1422639564, "question_id": 28241595, "link": "https://stackoverflow.com/questions/28241595/organizing-and-testing-a-go-project", "title": "Organizing and testing a go project", "body": "<p>I have been working on a multi-packages project in Go: my project involves several packages for each data structures or algorithms -  <a href=\"https://github.com/arnauddri/algorithms\" rel=\"nofollow\">https://github.com/arnauddri/algorithms</a></p>\n\n<p>Each package can be tested separately and works fine. I can call any of the package in any other one.</p>\n\n<p>At this stage I have several questions:</p>\n\n<ul>\n<li><p>is there a way to 'unite' the packages like there is with node, binding all the module under a unique name? Here I would be looking to add a <code>main.go</code> file defining a package 'algo' and I could use any of the underlying packages with <code>algo.heap</code>, <code>algo.queue</code>, <code>algo.stack</code>...</p></li>\n<li><p>every one of my package has tests and they work fine, however everytime I change a data structure for example, I check in every other package using this one that my tests still pass and that I havent broken anything. How can I make <code>go test</code> work from my root file to launch all the tests?</p></li>\n</ul>\n\n<p>Any other feedback on my package layout is more than welcome and appreciated :)</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1424354164, "last_edit_date": 1424354164, "creation_date": 1422675576, "answer_id": 28247909, "question_id": 28241146, "link": "https://stackoverflow.com/questions/28241146/golang-encoding-json-marshal-or-fmt-sprintf/28247909#28247909", "title": "GoLang - encoding/json.Marshal or fmt.sprintf?", "body": "<p>Highly depends on what you're trying to do, you should benchmark it and see.</p>\n\n<p>However for your very specific example, the fastest way is just use basic string concat like :</p>\n\n<pre><code>data := `{\"TEST\":3, \"ID\":\"` + Id + `\"}`\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9146870"}, "is_accepted": false, "score": 5, "last_activity_date": 1521509552, "last_edit_date": 1521509552, "creation_date": 1515112724, "answer_id": 48105641, "question_id": 28241146, "link": "https://stackoverflow.com/questions/28241146/golang-encoding-json-marshal-or-fmt-sprintf/48105641#48105641", "title": "GoLang - encoding/json.Marshal or fmt.sprintf?", "body": "<p>In the case of JSON with basic data types (string, bool, int) <code>fmt.Sprintf</code> is faster. Benchmarking shows that it is on the order of twice as fast as <code>json.Marshal</code> for rendering a very small JSON object, with the spread in performance increasing as more data is added.</p>\n\n<p>The benchmark results for rendering a JSON object using both methods (10,000,000 times each for clarity) are as follows:</p>\n\n<pre><code>Benchmarks for rendering a small JSON object\nTime taken to render JSON object using json.Marshal:     8.747821898s\nTime taken to render JSON object using fmt.Sprintf:      4.452937712s\n\nBenchmarks for rendering a larger JSON object\nTime taken to render JSON object using json.Marshal:     32.100388801s\nTime taken to render JSON object using fmt.Sprintf:      10.392861696s\n</code></pre>\n\n<p>Note that these results do not hold if your JSON object contains more complex data types like lists and nested objects.</p>\n"}], "owner": {"reputation": 79, "user_id": 1184210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f095e4f5824ec364f98379c1d8783be?s=128&d=identicon&r=PG", "display_name": "user324324", "link": "https://stackoverflow.com/users/1184210/user324324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1799, "favorite_count": 0, "accepted_answer_id": 28247909, "answer_count": 2, "score": -2, "last_activity_date": 1544481877, "creation_date": 1422638110, "last_edit_date": 1424354139, "question_id": 28241146, "link": "https://stackoverflow.com/questions/28241146/golang-encoding-json-marshal-or-fmt-sprintf", "title": "GoLang - encoding/json.Marshal or fmt.sprintf?", "body": "<p>Which would be faster? </p>\n\n<pre><code>data := fmt.Sprintf(\"{\\\"TEST\\\":3, \\\"ID\\\":\\\"%s\\\"}\", Id)\n</code></pre>\n\n<p>OR json marshalling a struct like that?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1422652769, "post_id": 28241402, "comment_id": 44850183, "body": "In addition, if you REALLY want it to feel the same, I believe you could put the models in &quot;models&quot; package and have main.go do: import . &quot;./models&quot; (so you dont have to refer to foo as models.foo)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1422638913, "creation_date": 1422638913, "answer_id": 28241402, "question_id": 28241132, "link": "https://stackoverflow.com/questions/28241132/go-folder-structure-same-package/28241402#28241402", "title": "Go folder structure same package", "body": "<p>The <a href=\"http://golang.org/cmd/go/\">go</a> tool assumes one directory per package.</p>\n\n<p>You can run the compiler and linker directly to achieve any layout you want. Because nobody does this, you will find that documentation to support this approach is slim.</p>\n\n<p>Go with the flow. Use more than one package.</p>\n"}], "owner": {"reputation": 8843, "user_id": 871021, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7b1506bd19aca1265192a7ace837e854?s=128&d=identicon&r=PG", "display_name": "woutr_be", "link": "https://stackoverflow.com/users/871021/woutr-be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 28241402, "answer_count": 1, "score": 0, "last_activity_date": 1422638913, "creation_date": 1422638067, "question_id": 28241132, "link": "https://stackoverflow.com/questions/28241132/go-folder-structure-same-package", "title": "Go folder structure same package", "body": "<p>Let's say I want to order my project files like this:</p>\n\n<pre><code>- src\n    - myProject\n        - main.go\n        - models\n            - foo.go\n            - bar.go\n</code></pre>\n\n<p>How can I tell the compiler about this structure, at the moment it looks that all my files have to be in the <code>myProject</code> folder, although with quite a few models, this will get crowded really quickly.</p>\n\n<p>Is there a way I can achieve this structure without having to use external packages? (i.e. I still want to use the main package inside <code>models/foo</code>)</p>\n"}, {"tags": ["testing", "go", "terminal"], "comments": [{"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 1, "creation_date": 1521563666, "post_id": 28240489, "comment_id": 85780685, "body": "for <code>Go testing</code> your Test file should have <code>**_test.go</code> <code>example.go</code> should have corresponding<code>example_test.go</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 3, "creation_date": 1422636801, "post_id": 28240537, "comment_id": 44842551, "body": "In addition to this, your test methods should be in the same package as the tested code, not main as in your question."}, {"owner": {"reputation": 7988, "user_id": 584947, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5c0e998a5b4fdce4f95cbec31e6dab22?s=128&d=identicon&r=PG", "display_name": "anon58192932", "link": "https://stackoverflow.com/users/584947/anon58192932"}, "edited": false, "score": 1, "creation_date": 1481124033, "post_id": 28240537, "comment_id": 69249272, "body": "my file did end in _test.go. fixing the issue for me required removing a re-definition of TestMain in the new test file that I added to the package. I also had to change directory into the package folder itself and run <code>go test</code> from there instead of running it from the root directory"}, {"owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 6, "creation_date": 1493647432, "post_id": 28240537, "comment_id": 74484156, "body": "@thwd Test methods don&#39;t need to be (and many times shouldn&#39;t be) in the same package as the tested code."}, {"owner": {"reputation": 1455, "user_id": 2649611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff3b4b9e7a105dc104f8d76a0b31e92?s=128&d=identicon&r=PG", "display_name": "cakraww", "link": "https://stackoverflow.com/users/2649611/cakraww"}, "edited": false, "score": 0, "creation_date": 1567841978, "post_id": 28240537, "comment_id": 102092677, "body": "The file containing test can&#39;t be named only <code>_test.go</code>. It should be at least one character before underscore like <code>a_test.go</code>."}, {"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "reply_to_user": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "edited": false, "score": 0, "creation_date": 1601838154, "post_id": 28240537, "comment_id": 113523510, "body": "@Dan Esparza: +1, But I don&#39;t know how to separate them without getting th error."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 93, "last_activity_date": 1589854494, "last_edit_date": 1589854494, "creation_date": 1422636036, "answer_id": 28240537, "question_id": 28240489, "link": "https://stackoverflow.com/questions/28240489/golang-testing-no-test-files/28240537#28240537", "title": "Golang testing: &quot;no test files&quot;", "body": "<p>Files containing tests should be called <code>name_test</code>, with the <code>_test</code> suffix. They should be alongside the code that they are testing. </p>\n\n<p>To run the tests recursively call <code>go test -v ./...</code></p>\n\n<p>From <a href=\"http://golang.org/doc/code.html#Testing\" rel=\"noreferrer\">How to Write Go Code</a>:</p>\n\n<blockquote>\n  <p>You write a test by creating a file with a name ending in <code>_test.go</code> that contains functions named <code>TestXXX</code> with signature <code>func (t *testing.T)</code>. The test framework runs each such function; if the function calls a failure function such as <code>t.Error</code> or <code>t.Fail</code>, the test is considered to have failed. </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 456, "user_id": 3338418, "user_type": "registered", "accept_rate": 10, "profile_image": "https://i.stack.imgur.com/uoCMC.jpg?s=128&g=1", "display_name": "Adi Sivasankaran", "link": "https://stackoverflow.com/users/3338418/adi-sivasankaran"}, "edited": false, "score": 4, "creation_date": 1500068468, "post_id": 41516560, "comment_id": 77195679, "body": "This helped. To run tests for non-main packages (in sub-directories): <code>go test -v .&#47;&lt;package_name&gt;</code> runs the tests for that specific package."}, {"owner": {"reputation": 683, "user_id": 453820, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a83229661e7dafa10b1c0d502aa15c8a?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/453820/john"}, "edited": false, "score": 0, "creation_date": 1585419274, "post_id": 41516560, "comment_id": 107753931, "body": "Under Wndows 10, go test -v ./packagename worked for me."}], "tags": [], "owner": {"reputation": 4805, "user_id": 903025, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/aa7a1efbbc8b24a85f7b95a4739909b0?s=128&d=identicon&r=PG", "display_name": "blockloop", "link": "https://stackoverflow.com/users/903025/blockloop"}, "is_accepted": false, "score": 94, "last_activity_date": 1564415308, "last_edit_date": 1564415308, "creation_date": 1483749472, "answer_id": 41516560, "question_id": 28240489, "link": "https://stackoverflow.com/questions/28240489/golang-testing-no-test-files/41516560#41516560", "title": "Golang testing: &quot;no test files&quot;", "body": "<p>It's possible you don't have any test files in the root package and running <code>go test -v</code> does not test sub-packages, only the root package. </p>\n\n<p>For example</p>\n\n<pre><code>.\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 auth/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 jwt.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 jwt_test.go\n\u251c\u2500\u2500 main.go\n</code></pre>\n\n<p>As you see there are no test files in the root package, only the main.go file. You will get \"no test files.\" </p>\n\n<p>The solution is to test all packages within the current working directory, recursively</p>\n\n<pre><code>go test -v ./...\n</code></pre>\n\n<p>Or if you use <a href=\"https://github.com/kardianos/govendor\" rel=\"noreferrer\">govendor</a> </p>\n\n<pre><code>govendor test +local\n</code></pre>\n\n<p>Or you can specify which package (directory) to test</p>\n\n<pre><code>go test -v ./packagename\n</code></pre>\n\n<p>Or test a package recursively</p>\n\n<pre><code>go test -v ./packagename/...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4462, "user_id": 808603, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f46f9ebbb5f9e66326cdb0ba6c1ece?s=128&d=identicon&r=PG", "display_name": "Jerinaw", "link": "https://stackoverflow.com/users/808603/jerinaw"}, "edited": false, "score": 0, "creation_date": 1618445267, "post_id": 50834587, "comment_id": 118606286, "body": "To add to this it has to be <code>Test</code> followed by an capital letter or underscore etc. You can&#39;t have <code>TestmyFunction()</code>. This bit me."}], "tags": [], "owner": {"reputation": 3588, "user_id": 1842743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUYWV.png?s=128&g=1", "display_name": "PodTech.io", "link": "https://stackoverflow.com/users/1842743/podtech-io"}, "is_accepted": false, "score": 16, "last_activity_date": 1528884635, "creation_date": 1528884635, "answer_id": 50834587, "question_id": 28240489, "link": "https://stackoverflow.com/questions/28240489/golang-testing-no-test-files/50834587#50834587", "title": "Golang testing: &quot;no test files&quot;", "body": "<p>Your test function within your _test file must start with the prefix \"Test\"</p>\n\n<p>GOOD:</p>\n\n<pre><code>func TestName (\n</code></pre>\n\n<p>BAD: </p>\n\n<pre><code>func NameTest (\n</code></pre>\n\n<p><em>This function will not be executed as a test and results with the reported error</em></p>\n"}, {"tags": [], "owner": {"reputation": 394, "user_id": 2360072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh6.googleusercontent.com/-nk2tmJ3mw-E/AAAAAAAAAAI/AAAAAAAAClk/VygMiLtmkJ0/photo.jpg?sz=128", "display_name": "Yevhenii Shashkov", "link": "https://stackoverflow.com/users/2360072/yevhenii-shashkov"}, "is_accepted": false, "score": 1, "last_activity_date": 1560630234, "creation_date": 1560630234, "answer_id": 56613913, "question_id": 28240489, "link": "https://stackoverflow.com/questions/28240489/golang-testing-no-test-files/56613913#56613913", "title": "Golang testing: &quot;no test files&quot;", "body": "<p>I faced same problem.\nIn addition to previous answers i find an issue when impossible to run test if your package's folder name is <code>testing</code>.</p>\n\n<p>Terminal demonstration of the issue below:</p>\n\n<p><strong>with <code>testing</code> folder name:</strong></p>\n\n<pre><code>~/go/src/testing$ go test\n?       testing [no test files]\n</code></pre>\n\n<p><strong>without <code>testing</code> folder name:</strong></p>\n\n<pre><code>~/go/src/testing_someothername$ go test\nPASS\nok      testing_someothername   0.089s\n</code></pre>\n\n<p>In my case it was helpful</p>\n"}], "owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53808, "favorite_count": 6, "accepted_answer_id": 28240537, "answer_count": 4, "score": 70, "last_activity_date": 1589854494, "creation_date": 1422635875, "last_edit_date": 1519775876, "question_id": 28240489, "link": "https://stackoverflow.com/questions/28240489/golang-testing-no-test-files", "title": "Golang testing: &quot;no test files&quot;", "body": "<p>I'm creating a simple test within my package directory called reverseTest.go</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc TestReverse(t *testing.T) {\n    cases := []struct {\n        in, want string\n    }{\n        {\"Hello, world\", \"dlrow ,olleH\"},\n        {\"Hello, \u4e16\u754c\", \"\u754c\u4e16 ,olleH\"},\n        {\"\", \"\"},\n    }\n\n    for _, c := range cases {\n        got := Reverse(c.in)\n        if got != c.want {\n            t.Errorf(\"Reverse(%q) == %q, want %q\", c.in, got, c.want)\n        }\n    }\n}\n</code></pre>\n\n<p>whenever i try to run it the output is</p>\n\n<pre><code>exampleFolder[no test files] \n</code></pre>\n\n<p>this is my go env</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/juan/go\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go\"\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_amd64\"\nTERM=\"dumb\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-g -O2 -fPIC -m64 -pthread\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Any help will be greatly appreciated. Thanks!!</p>\n"}, {"tags": ["go", "timeout", "blocking", "goroutine"], "comments": [{"owner": {"reputation": 1993, "user_id": 623949, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf441bdd92dabf1b772104901c78cf99?s=128&d=identicon&r=PG", "display_name": "tgrosinger", "link": "https://stackoverflow.com/users/623949/tgrosinger"}, "edited": false, "score": 2, "creation_date": 1422635574, "post_id": 28240133, "comment_id": 44841802, "body": "Is the third party library open source? Maybe you can fix this for them and submit a pull request."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1422635868, "last_edit_date": 1422635868, "creation_date": 1422635226, "answer_id": 28240299, "question_id": 28240133, "link": "https://stackoverflow.com/questions/28240133/cancel-a-blocking-operation-in-go/28240299#28240299", "title": "cancel a blocking operation in Go", "body": "<p>You can't stop a goroutine from the \"outside\". The goroutine has to support some kind of termination signalling (most often a channel). But if it does not, you can't force it or kill it.</p>\n\n<p>If you can't do anything about the 3rd party lib you're using, the most that you could do is run it in a different process (in a different application started by your go app) which you can kill, but that is just ugly and too cumbersome.</p>\n"}, {"tags": [], "owner": {"reputation": 2562, "user_id": 216636, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7e9e3684b967676457914eeed61598e?s=128&d=identicon&r=PG", "display_name": "Marko Kevac", "link": "https://stackoverflow.com/users/216636/marko-kevac"}, "is_accepted": false, "score": 0, "last_activity_date": 1422641466, "creation_date": 1422641466, "answer_id": 28242083, "question_id": 28240133, "link": "https://stackoverflow.com/questions/28240133/cancel-a-blocking-operation-in-go/28242083#28242083", "title": "cancel a blocking operation in Go", "body": "<p>I don't think you can do anything. In Go you can't stop a goroutine from outside. If you can't fix this library and you think it could block forever, then write new one that you would be able to control.</p>\n"}], "owner": {"reputation": 3918, "user_id": 554135, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/03637ef1a5121222c8db0ed48c34e124?s=128&d=identicon&r=PG", "display_name": "Amjad Masad", "link": "https://stackoverflow.com/users/554135/amjad-masad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2167, "favorite_count": 0, "accepted_answer_id": 28240299, "answer_count": 2, "score": 6, "last_activity_date": 1422641466, "creation_date": 1422634688, "question_id": 28240133, "link": "https://stackoverflow.com/questions/28240133/cancel-a-blocking-operation-in-go", "title": "cancel a blocking operation in Go", "body": "<p>I have a blocking operation in a 3rd party library that I don't control. It could potentially go forever. So I want to set a timeout on it. The obvious way is to wrap it with a channel and a goroutine and then select on the result with <code>time.After</code>. However, the problem is the goroutine running the blocking operation could potentially go forever.</p>\n\n<p>Here is an example to illustrate this <a href=\"http://repl.it/90o\" rel=\"noreferrer\">http://repl.it/90o</a></p>\n\n<p>Is there a way to cancel a goroutine or have it garbage collected?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1422636639, "post_id": 28239911, "comment_id": 44842449, "body": "<code>range</code> is not an operator but a keyword."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1422637863, "post_id": 28239911, "comment_id": 44843223, "body": "@thwd: thanks for the clarification."}], "answers": [{"comments": [{"owner": {"reputation": 5555, "user_id": 1547699, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DfkK6.jpg?s=128&g=1", "display_name": "Sumudu", "link": "https://stackoverflow.com/users/1547699/sumudu"}, "edited": false, "score": 0, "creation_date": 1516696981, "post_id": 28239936, "comment_id": 83782376, "body": "But still, shouldn&#39;t the index also be an <code>uint</code> ?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 5555, "user_id": 1547699, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DfkK6.jpg?s=128&g=1", "display_name": "Sumudu", "link": "https://stackoverflow.com/users/1547699/sumudu"}, "edited": false, "score": 0, "creation_date": 1516700057, "post_id": 28239936, "comment_id": 83784366, "body": "@Anubis Indices are usually <code>int</code> so that you could use negative values for special cases. E.g. a search function can return <code>-1</code> as index if a value was not found."}, {"owner": {"reputation": 5555, "user_id": 1547699, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DfkK6.jpg?s=128&g=1", "display_name": "Sumudu", "link": "https://stackoverflow.com/users/1547699/sumudu"}, "edited": false, "score": 0, "creation_date": 1516778308, "post_id": 28239936, "comment_id": 83823190, "body": "yeah i get that, but that&#39;s the something decided inside a function. But i think, for example, range can&#39;t return a negative index at any time (at least for an array) right? If that is true, then what is the point of keeping a signed data type? (Sorry, I&#39;m very new to Go language, maybe I&#39;m overlooking something)"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 5555, "user_id": 1547699, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DfkK6.jpg?s=128&g=1", "display_name": "Sumudu", "link": "https://stackoverflow.com/users/1547699/sumudu"}, "edited": false, "score": 1, "creation_date": 1516787168, "post_id": 28239936, "comment_id": 83828229, "body": "@Anubis Basically it&#39;s to make life easier for everyone. If it was <code>int</code> <i>unless in range,</i> that would be confusing. So most programming language designers simply decide to make all array indices <code>int</code> and not think too much about it. In a language with <a href=\"https://en.wikipedia.org/wiki/Algebraic_data_type\" rel=\"nofollow noreferrer\">ADTs</a>, like Rust, indices are actually often <code>uint</code>, and an ADT is used to return absence of a value."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1422634021, "creation_date": 1422634021, "answer_id": 28239936, "question_id": 28239911, "link": "https://stackoverflow.com/questions/28239911/does-the-golang-range-keyword-botch-uint-type-information/28239936#28239936", "title": "Does the golang `range` keyword botch uint type information?", "body": "<p>The first value returned by <code>range</code> is the index, not the value. What you need is:</p>\n\n<pre><code>func main() {\n    one := uint(1)\n    ones := []uint{1, 1, 1}\n    for _, x := range ones {\n        if x != one {\n            print(\"ERR\")\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 28239936, "answer_count": 1, "score": 1, "last_activity_date": 1422637883, "creation_date": 1422633935, "last_edit_date": 1422637883, "question_id": 28239911, "link": "https://stackoverflow.com/questions/28239911/does-the-golang-range-keyword-botch-uint-type-information", "title": "Does the golang `range` keyword botch uint type information?", "body": "<p>Consider this golang program:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>func main() {\n    one := uint(1)\n    ones := []uint{1, 1, 1}\n    for x := range ones {\n        if x != one {\n            print(\"ERR\")\n        }\n    }\n}\n</code></pre>\n\n<p>When I try to compile I get an unexpected error:</p>\n\n<pre><code>$ go build foo.go \n# command-line-arguments\n./foo.go:7: invalid operation: x != one (mismatched types int and uint)\n</code></pre>\n\n<p>Why does go think <code>x</code> has type <code>int</code> instead of <code>uint</code>?</p>\n"}, {"tags": ["go", "named-pipes"], "comments": [{"owner": {"reputation": 1632, "user_id": 888714, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VBF3z.png?s=128&g=1", "display_name": "rvignacio", "link": "https://stackoverflow.com/users/888714/rvignacio"}, "edited": false, "score": 1, "creation_date": 1422633442, "post_id": 28238767, "comment_id": 44840416, "body": "<a href=\"http://golang.org/pkg/bufio/#Reader.ReadLine\" rel=\"nofollow noreferrer\">Reader.ReadLine()</a> returns an error, are you sure you aren&#39;t getting an error in your program? It&#39;s always a good practice to check errors, do not ignore them using &quot;_&quot;."}, {"owner": {"reputation": 1450, "user_id": 2444027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Moqiv.jpg?s=128&g=1", "display_name": "dchesterton", "link": "https://stackoverflow.com/users/2444027/dchesterton"}, "reply_to_user": {"reputation": 1632, "user_id": 888714, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VBF3z.png?s=128&g=1", "display_name": "rvignacio", "link": "https://stackoverflow.com/users/888714/rvignacio"}, "edited": false, "score": 1, "creation_date": 1422634507, "post_id": 28238767, "comment_id": 44841072, "body": "Thanks, checking the error helped me find the problem."}], "answers": [{"comments": [{"owner": {"reputation": 1450, "user_id": 2444027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Moqiv.jpg?s=128&g=1", "display_name": "dchesterton", "link": "https://stackoverflow.com/users/2444027/dchesterton"}, "edited": false, "score": 0, "creation_date": 1422631478, "post_id": 28238958, "comment_id": 44839162, "body": "It&#39;s intentionally infinite, as the program needs to process new writes to the named pipe as they come in.  The <code>awaitingExit</code> code is just to gracefully handle termination, i.e. finish the current goroutines first."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1450, "user_id": 2444027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Moqiv.jpg?s=128&g=1", "display_name": "dchesterton", "link": "https://stackoverflow.com/users/2444027/dchesterton"}, "edited": false, "score": 0, "creation_date": 1422631591, "post_id": 28238958, "comment_id": 44839234, "body": "@dchesterton Edited the answer. If there are no more data, <code>reader</code> will return EOF immediately, you check the <code>awaitExit</code> variable and do these 2 steps endlessly - there is no wait in this code sequence."}, {"owner": {"reputation": 1450, "user_id": 2444027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Moqiv.jpg?s=128&g=1", "display_name": "dchesterton", "link": "https://stackoverflow.com/users/2444027/dchesterton"}, "edited": false, "score": 0, "creation_date": 1422632015, "post_id": 28238958, "comment_id": 44839494, "body": "Thanks for your help but <code>reader</code> doesn&#39;t EOF immediately as it blocks until the other process writes to it as it&#39;s a named pipe, not a standard file. It seems this blocking causes the process to max out CPU. I don&#39;t know if there&#39;s a better way of reading from the named pipe?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1450, "user_id": 2444027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Moqiv.jpg?s=128&g=1", "display_name": "dchesterton", "link": "https://stackoverflow.com/users/2444027/dchesterton"}, "edited": false, "score": 0, "creation_date": 1422634188, "post_id": 28238958, "comment_id": 44840861, "body": "@dchesterton Are you sure about that? And also about that you don&#39;t get any other errors? Never discard errors, the least you can do is print them to the consol or <code>panic</code>."}, {"owner": {"reputation": 1450, "user_id": 2444027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Moqiv.jpg?s=128&g=1", "display_name": "dchesterton", "link": "https://stackoverflow.com/users/2444027/dchesterton"}, "edited": false, "score": 1, "creation_date": 1422634454, "post_id": 28238958, "comment_id": 44841029, "body": "I&#39;ve logged the error from <code>ReadLine</code> and you&#39;re right, it does EOF eventually after a few minutes, causing the program to just infinitely loop. Not sure why it doesn&#39;t do this immediately and only does it after the process has been idle for a while, but I&#39;ll look into it more. Lesson learnt, don&#39;t ignore errors!"}, {"owner": {"reputation": 1450, "user_id": 2444027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Moqiv.jpg?s=128&g=1", "display_name": "dchesterton", "link": "https://stackoverflow.com/users/2444027/dchesterton"}, "edited": false, "score": 2, "creation_date": 1422640545, "post_id": 28238958, "comment_id": 44844517, "body": "It seems the other process would close the named pipe after a period of inactivity on its end. Changing <code>os.OpenFile(&quot;file.fifo&quot;, os.O_RDONLY, os.ModeNamedPipe)</code> to <code>os.OpenFile(&quot;file.fifo&quot;, os.O_RDWR, os.ModeNamedPipe)</code> keeps the file open and seems to fix the issue."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1422631520, "last_edit_date": 1422631520, "creation_date": 1422631119, "answer_id": 28238958, "question_id": 28238767, "link": "https://stackoverflow.com/questions/28238767/100-cpu-usage-when-reading-named-pipe-in-go/28238958#28238958", "title": "100% CPU usage when reading named pipe in Go", "body": "<p>Your \"infinite loop\" is really <em>infinite</em>: you never exit it or jump out of it.</p>\n\n<p>It contains an <code>if</code>:</p>\n\n<pre><code>// stop handling new lines if we're waiting to exit\nif !awaitingExit &amp;&amp; len(line) &gt; 0 {\n    // code omitted\n}\n</code></pre>\n\n<p>But if the condition is false, you're still not getting out of the <code>for</code> loop, just continue with another iteration. Once you reach the end of <code>reader</code>, this loop will consume 100% of a core because after that it will not wait for anything just trying to read (which will immediately return EOF) and checking the <code>awaitExit</code> variable and doing these 2 steps again.</p>\n\n<p>You either need to add condition to the <code>for</code> loop to exit sometime, or use a <code>break</code> statement to break out of it.</p>\n\n<p>Altered <code>for</code> loop with a condition:</p>\n\n<pre><code>for !awaitingExit {\n}\n</code></pre>\n\n<p>Altered <code>for</code> with a <code>break</code> statement:</p>\n\n<pre><code>for {\n    if awaitingExit {\n        break\n    }\n    // code omitted\n}\n</code></pre>\n\n<p>Note: if <code>awaitingExit</code> variable is changed by another goroutine, you need proper synchronization, or better, use channels for exit signalling.</p>\n"}], "owner": {"reputation": 1450, "user_id": 2444027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Moqiv.jpg?s=128&g=1", "display_name": "dchesterton", "link": "https://stackoverflow.com/users/2444027/dchesterton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "accepted_answer_id": 28238958, "answer_count": 1, "score": 2, "last_activity_date": 1422631520, "creation_date": 1422630507, "last_edit_date": 1422631030, "question_id": 28238767, "link": "https://stackoverflow.com/questions/28238767/100-cpu-usage-when-reading-named-pipe-in-go", "title": "100% CPU usage when reading named pipe in Go", "body": "<p>I have a short Go program which reads from a named pipe and processes each line as an external process writes to the pipe. The named pipe is created before the program runs using <code>mkfifo</code>.</p>\n\n<p>The process is taking up 100% of the CPU when waiting for a new line from the named pipe, even when it's not doing any processing. It's running on Ubuntu 14.04. Any ideas?</p>\n\n<pre><code>c := make(chan os.Signal, 1)\nsignal.Notify(c, os.Interrupt, syscall.SIGTERM)\n\nawaitingExit := false\n\nvar wg sync.WaitGroup\n\ngo func() {\n    for sig := range c {\n        awaitingExit = true\n\n        // wait for goroutines to finish processing new lines\n        wg.Wait()\n        os.Exit(1)\n    }\n}()\n\nfile, err := os.OpenFile(\"file.fifo\", os.O_RDONLY, os.ModeNamedPipe)\n\ndefer file.Close()\n\nif err != nil {\n    log.Fatal(err)\n}\n\nreader := bufio.NewReader(file)\n\n// infinite loop\nfor {\n    line, _, _ := reader.ReadLine()\n\n    // stop handling new lines if we're waiting to exit\n    if !awaitingExit &amp;&amp; len(line) &gt; 0 {\n        wg.Add(1)\n\n        go func(uploadLog string) {\n            defer wg.Done()\n            handleNewLine(uploadLog)\n        }(string(line))\n    }\n}\n\nfunc handleNewLine(line string) {\n    ....\n}\n</code></pre>\n"}, {"tags": ["go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1422630905, "last_edit_date": 1422630905, "creation_date": 1422630515, "answer_id": 28238770, "question_id": 28237806, "link": "https://stackoverflow.com/questions/28237806/cannot-get-gorilla-session-value-by-key/28238770#28238770", "title": "cannot get gorilla session value by key", "body": "<p>In your <code>initSession()</code> function you change the store options:</p>\n\n<pre><code>store.Options = &amp;sessions.Options{\n    MaxAge:   3600 * 1, // 1 hour\n    HttpOnly: true,\n}\n</code></pre>\n\n<p>The <a href=\"http://www.gorillatoolkit.org/pkg/sessions#Options\" rel=\"nofollow\"><code>Options</code></a> struct also contains an important <code>Path</code> field to which the cookie will apply. If you don't set it, its default value will be the empty string: <code>\"\"</code>. This will most likely cause that the cookie will not be matched with any of your urls/paths, so your existing session will not be found.</p>\n\n<p>Add a path to match all your urls like this:</p>\n\n<pre><code>store.Options = &amp;sessions.Options{\n    Path:     \"/\",      // to match all requests\n    MaxAge:   3600 * 1, // 1 hour\n    HttpOnly: true,\n}\n</code></pre>\n\n<p>Also you shouldn't change <code>store.Options</code> in each call of <code>initSession()</code> since you call this in each incoming request. Just set this once when you create your <code>store</code> like this:</p>\n\n<pre><code>var store = sessions.NewCookieStore(authKey, encKey)\n\nfunc init() {\n    store.Options = &amp;sessions.Options{\n        Path:     \"/\",      // to match all requests\n        MaxAge:   3600 * 1, // 1 hour\n        HttpOnly: true,\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "is_accepted": false, "score": 1, "last_activity_date": 1422665801, "creation_date": 1422665801, "answer_id": 28247008, "question_id": 28237806, "link": "https://stackoverflow.com/questions/28237806/cannot-get-gorilla-session-value-by-key/28247008#28247008", "title": "cannot get gorilla session value by key", "body": "<p>As I have not found answer I decided not to use cookie store but use redis store for sessions. And I found full working example <a href=\"https://github.com/aaudis/GoRedisSession#simple-usage\" rel=\"nofollow\">here</a> </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/aaudis/GoRedisSession\"\n    \"log\"\n    \"net/http\"\n)\n\nvar (\n    redis_session *rsess.SessionConnect\n)\n\nfunc main() {\n    // Configurable parameters\n    rsess.Prefix = \"sess:\" // session prefix (in Redis)\n    rsess.Expire = 1800    // 30 minute session expiration\n\n    // Connecting to Redis and creating storage instance\n    temp_sess, err := rsess.New(\"sid\", 0, \"127.0.0.1\", 6379)\n    if err != nil {\n        log.Printf(\"%s\", err)\n    }\n\n    redis_session = temp_sess // assing to global variable\n\n    http.HandleFunc(\"/\", Root)\n    http.HandleFunc(\"/get\", Get)\n    http.HandleFunc(\"/set\", Set)\n    http.HandleFunc(\"/des\", Des)\n    http.ListenAndServe(\":8888\", nil)\n}\n\nfunc Root(w http.ResponseWriter, r *http.Request) {\n    w.Header().Add(\"Content-Type\", \"text/html\")\n    fmt.Fprintf(w, `\n        Redis session storage example:&lt;br&gt;&lt;br&gt;\n        &lt;a href=\"/set\"&gt;Store key in session&lt;/a&gt;&lt;br&gt;\n        &lt;a href=\"/get\"&gt;Get key value from session&lt;/a&gt;&lt;br&gt;\n        &lt;a href=\"/des\"&gt;Destroy session&lt;/a&gt;\n    `)\n}\n\n// Destroy session\nfunc Des(w http.ResponseWriter, r *http.Request) {\n    s := redis_session.Session(w, r)\n    s.Destroy(w)\n    fmt.Fprintf(w, \"Session deleted!\")\n}\n\n// Set variable to session\nfunc Set(w http.ResponseWriter, r *http.Request) {\n    s := redis_session.Session(w, r)\n    s.Set(\"UserID\", \"1000\")\n    fmt.Fprintf(w, \"Setting session variable done!\")\n}\n\n// Get variable from session\nfunc Get(w http.ResponseWriter, r *http.Request) {\n    s := redis_session.Session(w, r)\n    fmt.Fprintf(w, \"Value %s\", s.Get(\"UserID\"))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 2816546, "user_type": "registered", "profile_image": "https://graph.facebook.com/1616390031/picture?type=large", "display_name": "Hubert Sobk&#243;w", "link": "https://stackoverflow.com/users/2816546/hubert-sobk%c3%b3w"}, "is_accepted": false, "score": 3, "last_activity_date": 1546562399, "last_edit_date": 1546562399, "creation_date": 1435339201, "answer_id": 31078762, "question_id": 28237806, "link": "https://stackoverflow.com/questions/28237806/cannot-get-gorilla-session-value-by-key/31078762#31078762", "title": "cannot get gorilla session value by key", "body": "<p>What you are probably doing in your init session function with the get method you are restarting the whole session again so every time you do it the session is empty. I did a quick hack around what you wrote to show you where your error is. Please work around this example! </p>\n\n<pre><code>package appSession\n\nimport (        \n    \"net/http\"\n    \"fmt\"\n    \"log\"\n    \"github.com/gorilla/sessions\"    \n)\n\nvar appSession *sessions.Session;\n\nvar authKey = []byte(\"qwer\")\nvar encKey = []byte(\"asdf\")\n\nvar store = sessions.NewCookieStore(authKey, encKey)    \n\nfunc initSession(r *http.Request) *sessions.Session {\n\n    log.Println(\"session before get\", appSession)\n\n    if appSession != nil {    \n        return appSession;    \n    }\n\n    session, err := store.Get(r, \"golang_cookie\")\n    appSession = session;\n\n    log.Println(\"session after get\", session)\n    if err != nil {\n        panic(err)\n    }\n    return session\n}\n\nfunc SetSessionValue(w http.ResponseWriter, r *http.Request, key, value string) {\n    session := initSession(r)\n    session.Values[key] = value\n    fmt.Printf(\"set session with key %s and value %s\\n\", key, value)\n    session.Save(r, w)\n}\n\nfunc GetSessionValue(w http.ResponseWriter, r *http.Request, key string) string {   \n    session := initSession(r)\n    valWithOutType := session.Values[key]\n    fmt.Printf(\"valWithOutType: %s\\n\", valWithOutType)\n    value, ok := valWithOutType.(string)\n    log.Println(\"returned value: \", value);\n\n    if !ok {\n        fmt.Println(\"cannot get session value by key: \" + key)\n    }\n    return value\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10380052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlnVS.png?s=128&g=1", "display_name": "ace28", "link": "https://stackoverflow.com/users/10380052/ace28"}, "is_accepted": false, "score": 0, "last_activity_date": 1537435532, "creation_date": 1537435532, "answer_id": 52421739, "question_id": 28237806, "link": "https://stackoverflow.com/questions/28237806/cannot-get-gorilla-session-value-by-key/52421739#52421739", "title": "cannot get gorilla session value by key", "body": "<p>I played with your code for a long time and finally found out that it does not work, because you set the encryption key to an illegal value.</p>\n\n<p>In the <a href=\"http://www.gorillatoolkit.org/pkg/sessions\" rel=\"nofollow noreferrer\">/gorilla/sessions documentation</a> it says: </p>\n\n<blockquote>\n  <p>The encryption key, if set, must be either 16, 24, or 32 bytes to select AES-128, AES-192, or AES-256 modes.</p>\n</blockquote>\n\n<p>So since I believe that <code>var encKey = []byte(\"encKey\")</code> simply does not follow this requirement. In turn, the cookie is not set in the first place.</p>\n\n<p>See my code for reference. I basically added some more command line output and used a template with a redirect:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"github.com/gorilla/sessions\"\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n)\n\nvar authKey = []byte(\"secret\") // Authorization Key\n\n//var encKey = []byte(\"encKey\") // Encryption Key\n\nvar store sessions.Store\n\nfunc main() {\n    rtr := mux.NewRouter()\n    rtr.HandleFunc(\"/setSession/\", handler1).Methods(\"GET\")\n    rtr.HandleFunc(\"/getSession/\", handler2).Methods(\"GET\")\n    http.Handle(\"/\", rtr)\n    store = GetCookieStore()\n    log.Println(\"Listening...\")\n    http.ListenAndServe(\":4000\", http.DefaultServeMux)\n\n}\n\n//setting up the cookiestore\nfunc GetCookieStore() sessions.Store {\n\n    //maxAge := 3600 * 1 // 1 hour\n    maxAge := 100\n    //cookieStore := sessions.NewCookieStore(authKey, encKey)\n    cookieStore := sessions.NewCookieStore(authKey)\n\n    cookieStore.Options.HttpOnly = true\n    cookieStore.Options.Path = \"/\" // to match all requests\n    cookieStore.MaxAge(maxAge)\n\n    return cookieStore\n}\n\nfunc handler1(w http.ResponseWriter, r *http.Request) {\n    t, _ := template.New(\"foo\").Parse(getSessionTemplate)\n\n    SetSessionValue(w, r, \"key\", \"value\")\n    session := initSession(r)\n    fmt.Print(\"handler1: \")\n    fmt.Println(session)\n\n    Value, ok := session.Values[\"key\"].(string)\n    if !ok {\n        fmt.Println(\"Type assertion to string failed or session value could not be retrieved.\")\n    }\n\n    t.Execute(w, Value)\n\n}\n\nfunc handler2(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"getSession\"))\n    session := initSession(r)\n    fmt.Print(\"handler2: \")\n    fmt.Println(session)\n    value := GetSessionValue(w, r, \"key\")\n    fmt.Println(\"value from session\")\n    fmt.Println(value)\n}\n\nfunc initSession(r *http.Request) *sessions.Session {\n    session, err := store.Get(r, \"_golang_cookie\")\n    if err != nil {\n        panic(err)\n    }\n    return session\n}\n\nfunc SetSessionValue(w http.ResponseWriter, r *http.Request, key, value string) {\n    session := initSession(r)\n    session.Values[key] = value\n    fmt.Printf(\"set session with key %s and value %s\\n\", key, value)\n    session.Save(r, w)\n    fmt.Print(\"setsession: \")\n    fmt.Println(session)\n}\n\nfunc GetSessionValue(w http.ResponseWriter, r *http.Request, key string) string {\n    session := initSession(r)\n    fmt.Print(\"getsession: \")\n    fmt.Println(session)\n    valWithOutType := session.Values[key]\n    fmt.Printf(\"valWithOutType: %s\\n\", valWithOutType)\n    value, ok := valWithOutType.(string)\n    if !ok {\n        fmt.Println(\"cannot get session value by key: \" + key)\n    }\n\n    return value\n}\n\nvar getSessionTemplate = `\n&lt;p&gt;&lt;label&gt;Session value set:&lt;/label&gt;&lt;/p&gt;\n&lt;p&gt;&lt;label&gt;Value: is now: {{.}}&lt;/label&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=\"/getSession/\"&gt;Getsession&lt;/a&gt;&lt;/p&gt;`\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2765, "favorite_count": 0, "answer_count": 4, "score": 6, "last_activity_date": 1546562399, "creation_date": 1422627442, "last_edit_date": 1592644375, "question_id": 28237806, "link": "https://stackoverflow.com/questions/28237806/cannot-get-gorilla-session-value-by-key", "title": "cannot get gorilla session value by key", "body": "<p>I cannot get value from session this way, it is <code>nil</code>:</p>\n<pre><code>session := initSession(r)\nvalWithOutType := session.Values[key]\n</code></pre>\n<p>Full code:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;github.com/gorilla/mux&quot;\n    &quot;github.com/gorilla/sessions&quot;\n    &quot;log&quot;\n    &quot;net/http&quot;\n)\n\nfunc main() {\n    rtr := mux.NewRouter()\n    rtr.HandleFunc(&quot;/setSession&quot;, handler1).Methods(&quot;GET&quot;)\n    rtr.HandleFunc(&quot;/getSession&quot;, handler2).Methods(&quot;GET&quot;)\n    http.Handle(&quot;/&quot;, rtr)\n    log.Println(&quot;Listening...&quot;)\n    http.ListenAndServe(&quot;:3000&quot;, http.DefaultServeMux)\n}\n\nfunc handler1(w http.ResponseWriter, r *http.Request) {\n    SetSessionValue(w, r, &quot;key&quot;, &quot;value&quot;)\n    w.Write([]byte(&quot;setSession&quot;))\n}\n\nfunc handler2(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(&quot;getSession&quot;))\n    value := GetSessionValue(w, r, &quot;key&quot;)\n    fmt.Println(&quot;value from session&quot;)\n    fmt.Println(value)\n}\n\nvar authKey = []byte(&quot;secret&quot;) // Authorization Key\n\nvar encKey = []byte(&quot;encKey&quot;) // Encryption Key\n\nvar store = sessions.NewCookieStore(authKey, encKey)\n\nfunc initSession(r *http.Request) *sessions.Session {\n    store.Options = &amp;sessions.Options{\n        MaxAge:   3600 * 1, // 1 hour\n        HttpOnly: true,\n    }\n    session, err := store.Get(r, &quot;golang_cookie&quot;)\n    if err != nil {\n        panic(err)\n    }\n\n    return session\n}\n\nfunc SetSessionValue(w http.ResponseWriter, r *http.Request, key, value string) {\n    session := initSession(r)\n    session.Values[key] = value\n    fmt.Printf(&quot;set session with key %s and value %s\\n&quot;, key, value)\n    session.Save(r, w)\n}\n\nfunc GetSessionValue(w http.ResponseWriter, r *http.Request, key string) string {\n    session := initSession(r)\n    valWithOutType := session.Values[key]\n    fmt.Printf(&quot;valWithOutType: %s\\n&quot;, valWithOutType)\n    value, ok := valWithOutType.(string)\n    if !ok {\n        fmt.Println(&quot;cannot get session value by key: &quot; + key)\n    }\n    return value\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>myMac ~/forStack/session $ go run ./session.go\n2015/01/30 16:47:26 Listening...\n</code></pre>\n<p>First I open url <code>http://localhost:3000/setSession</code> and get output:</p>\n<pre><code>set session with key key and value value\n</code></pre>\n<p>Then I open url <code>http://localhost:3000/getSession</code> and get output:</p>\n<pre><code>valWithOutType: %!s(&lt;nil&gt;)\ncannot get session value by key: key\nvalue from session\n</code></pre>\n<p>Why <code>valWithOutType</code> is nil, although I set it requesting <code>/setSession</code>?</p>\n<h1>Update</h1>\n<p>I changed code according to @isza answer, but session value is still <code>nil</code>.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;github.com/gorilla/mux&quot;\n    &quot;github.com/gorilla/sessions&quot;\n    &quot;log&quot;\n    &quot;net/http&quot;\n)\n\nfunc main() {\n    rtr := mux.NewRouter()\n    rtr.HandleFunc(&quot;/setSession&quot;, handler1).Methods(&quot;GET&quot;)\n    rtr.HandleFunc(&quot;/getSession&quot;, handler2).Methods(&quot;GET&quot;)\n    http.Handle(&quot;/&quot;, rtr)\n    log.Println(&quot;Listening...&quot;)\n    store.Options = &amp;sessions.Options{\n        MaxAge:   3600 * 1, // 1 hour\n        HttpOnly: true,\n        Path:     &quot;/&quot;, // to match all requests\n    }\n    http.ListenAndServe(&quot;:3000&quot;, http.DefaultServeMux)\n\n}\n\nfunc handler1(w http.ResponseWriter, r *http.Request) {\n    SetSessionValue(w, r, &quot;key&quot;, &quot;value&quot;)\n    w.Write([]byte(&quot;setSession&quot;))\n}\n\nfunc handler2(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(&quot;getSession&quot;))\n    value := GetSessionValue(w, r, &quot;key&quot;)\n    fmt.Println(&quot;value from session&quot;)\n    fmt.Println(value)\n}\n\nvar authKey = []byte(&quot;secret&quot;) // Authorization Key\n\nvar encKey = []byte(&quot;encKey&quot;) // Encryption Key\n\nvar store = sessions.NewCookieStore(authKey, encKey)\n\nfunc initSession(r *http.Request) *sessions.Session {\n    session, err := store.Get(r, &quot;golang_cookie&quot;)\n    if err != nil {\n        panic(err)\n    }\n    return session\n}\n\nfunc SetSessionValue(w http.ResponseWriter, r *http.Request, key, value string) {\n    session := initSession(r)\n    session.Values[key] = value\n    fmt.Printf(&quot;set session with key %s and value %s\\n&quot;, key, value)\n    session.Save(r, w)\n}\n\nfunc GetSessionValue(w http.ResponseWriter, r *http.Request, key string) string {\n    session := initSession(r)\n    valWithOutType := session.Values[key]\n    fmt.Printf(&quot;valWithOutType: %s\\n&quot;, valWithOutType)\n    value, ok := valWithOutType.(string)\n    if !ok {\n        fmt.Println(&quot;cannot get session value by key: &quot; + key)\n    }\n    return value\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "go", "gomock"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1422613633, "post_id": 28233174, "comment_id": 44829570, "body": "I don&#39;t know gomock, but 2 and 3 seem legit. I think 2 would result in cleaner code. However, if you can alter the server&#39;s API to return an error from Send, it would be both healthier for your application, and easier to verify - make MockServer check the messages and return an error if it&#39;s not valid. Not returning errors from operations that can fail is a design flaw."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1422613860, "creation_date": 1422613860, "answer_id": 28233881, "question_id": 28233174, "link": "https://stackoverflow.com/questions/28233174/how-to-test-call-expectation-in-go/28233881#28233881", "title": "How to test call expectation in Go", "body": "<p>You could make a function out of your method like this:</p>\n\n<pre><code>var sendToServer = (*Server).Send\n\nfunc func (d *MyClass) SendToServer(args) {\n    // ...\n    sendToServer(server, msg)\n    // ...\n}\n</code></pre>\n\n<p>And in your tests:</p>\n\n<pre><code>func TestMyClass_SendToServer(t *testing.T) {\n    // ...\n    sent := false\n    sendToServer = func(*Server, args) {\n        sent = true\n    }\n    mc.SendToServer(args)\n    if !sent {\n        t.Error(\"fail\")\n    }\n}\n</code></pre>\n\n<p>This is described in Andrew Gerrand's <a href=\"http://www.youtube.com/watch?v=ndmB0bj7eyw\" rel=\"nofollow\">Testing Techniques talk</a>.</p>\n"}], "owner": {"reputation": 2688, "user_id": 844541, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/132f26344d16815ff98870de795b4ded?s=128&d=identicon&r=PG", "display_name": "user844541", "link": "https://stackoverflow.com/users/844541/user844541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1422613860, "creation_date": 1422611399, "question_id": 28233174, "link": "https://stackoverflow.com/questions/28233174/how-to-test-call-expectation-in-go", "title": "How to test call expectation in Go", "body": "<p>I have a class MyClass that I want to test.</p>\n\n<p>MyClass has a void method that calls an inner server to do something.</p>\n\n<pre><code>func (d *MyClass) SendToServer(args)\n  do stuff....\n  server.Send(myMessage)\n</code></pre>\n\n<p>I want to mock the server call Send, but since the method is a void method I can't be sure that I am actually calling it right.</p>\n\n<p>These are the options I had in mind:</p>\n\n<ol>\n<li>Use gomock, mock the server, and set expectations on the send method of the service</li>\n<li>create my own MockServer, and \"override\" the method Send with a bunch of verifications. Something like:</li>\n</ol>\n\n<p>func (d *MockedServer) Send(message)\n      // verify message...</p>\n\n<ol start=\"3\">\n<li>create my own MockServer, but instead of verifying the expectation within the method, add the message to a list of messages, and then verify the content of the list.</li>\n</ol>\n\n<p>What is a better approach in Go? </p>\n"}, {"tags": ["go", "command-line-interface", "docopt"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1422597513, "creation_date": 1422597513, "answer_id": 28230052, "question_id": 28229808, "link": "https://stackoverflow.com/questions/28229808/docopt-go-weird-error-message/28230052#28230052", "title": "docopt.go weird error message", "body": "<p>You need to declare an argument for port:</p>\n\n<pre><code>const Usage = `\nUsage:\n    serve [--port=&lt;arg&gt;] &lt;dir&gt;\n    serve help | --help\n    serve --version \n\nOptions:\n    -p, --port=&lt;arg&gt; port for the sever to listen on\n    -h, --help       display help information\n    -v, --version    display Version\n</code></pre>\n\n<p>Use the two value type assertion to handle the case where port is not set:</p>\n\n<pre><code>port, ok := args[\"--port\"].(string)\nif ok {\n   // port is set\n}\n</code></pre>\n\n<p>Also, remove the \"[]\" from around the map key.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2693845"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 1, "accepted_answer_id": 28230052, "answer_count": 1, "score": 2, "last_activity_date": 1422597513, "creation_date": 1422595961, "question_id": 28229808, "link": "https://stackoverflow.com/questions/28229808/docopt-go-weird-error-message", "title": "docopt.go weird error message", "body": "<p>using docopt.go to refactor an old project and minimalise code the program looks like this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/docopt/docopt.go\"\n)\n\nconst Version = `2.0`\nconst Usage = `\nUsage:\n    serve [--port] &lt;dir&gt;\n    serve help | --help\n    serve --version \n\nOptions:\n    -p, --port       port for the sever to listen on\n    -h, --help       display help information\n    -v, --version    display Version\n`\n\nfunc check(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc main() {\n    args, err := docopt.Parse(Usage, nil, true, Version, false)\n    check(err)\n\n    port := args[\"[--port]\"].(string)\n\n    fmt.Println(args)\n    fmt.Println(port)v\n}\n</code></pre>\n\n<p>however when I run the program <code>go run ./serve.go help</code> expecting the help message i get this</p>\n\n<pre><code>panic: interface conversion: interface is nil, not string\n\ngoroutine 1 [running]:\nmain.main()\n    /Users/jburns/Development/Gopath/src/github.com/nyumal/serve/serve.go:31 +0x148\n\ngoroutine 2 [runnable]:\nruntime.forcegchelper()\n    /usr/local/Cellar/go/1.4.1/libexec/src/runtime/proc.go:90\nruntime.goexit()\n    /usr/local/Cellar/go/1.4.1/libexec/src/runtime/asm_amd64.s:2232 +0x1\n\ngoroutine 3 [runnable]:\nruntime.bgsweep()\n    /usr/local/Cellar/go/1.4.1/libexec/src/runtime/mgc0.go:82\nruntime.goexit()\n    /usr/local/Cellar/go/1.4.1/libexec/src/runtime/asm_amd64.s:2232 +0x1\n\ngoroutine 4 [runnable]:\nruntime.runfinq()\n    /usr/local/Cellar/go/1.4.1/libexec/src/runtime/malloc.go:712\nruntime.goexit()\n    /usr/local/Cellar/go/1.4.1/libexec/src/runtime/asm_amd64.s:2232 +0x1\nexit status 2\n</code></pre>\n\n<p>and running <code>go run ./serve.go --port 5000</code> it returns the same thing however running <code>go run ./serve.go --port 5000 .</code> return</p>\n\n<pre><code>Usage:\n    serve [--port] &lt;dir&gt;\n    serve help | --help\n    serve --version\nexit status 1\n</code></pre>\n\n<p>where did i go wrong?</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 3, "creation_date": 1422594481, "post_id": 28228444, "comment_id": 44821933, "body": "This should not be downvoted, but you should mention the json tag values for giving the marshaled json a desired name.  like <code>json:&quot;entry_count&quot;</code>"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1422613197, "post_id": 28228444, "comment_id": 44829372, "body": "Apologies. Fixed. I wrote this after heavy code discussions at work (where I am a .NET developer)."}, {"owner": {"reputation": 360, "user_id": 3368499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b423054f8db73de88e1c7643354f96b?s=128&d=identicon&r=PG&f=1", "display_name": "sten", "link": "https://stackoverflow.com/users/3368499/sten"}, "edited": false, "score": 3, "creation_date": 1489873740, "post_id": 28228444, "comment_id": 72863986, "body": "I&#39;m going to upvote this because it helped me. But man does it make me cranky."}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 76, "last_activity_date": 1422613256, "last_edit_date": 1422613256, "creation_date": 1422586222, "answer_id": 28228444, "question_id": 28228393, "link": "https://stackoverflow.com/questions/28228393/json-unmarshal-returning-blank-structure/28228444#28228444", "title": "json.Unmarshal returning blank structure", "body": "<p>Your struct fields are not exported. This is because they start with a lowercase letter.</p>\n\n<pre><code>EntryCount // &lt;--- Exported\nentryCount // &lt;--- Not exported\n</code></pre>\n\n<p>When I say \"not exported\", I mean they are not visible outside of your package. Your package can happily access them because they are scoped locally to it.</p>\n\n<p>As for the <code>encoding/json</code> package though - it cannot see them. You need to make all of your fields visible to the <code>encoding/json</code> package by making them all start with an uppercase letter, thereby exporting them:</p>\n\n<pre><code>type Status struct {\n    Status  string\n    Node_id string\n}\n\ntype Meta struct {\n    To         string\n    From       string\n    Id         string\n    EntryCount int64\n    Size       int64\n    Depricated bool\n}\n\ntype Mydata struct {\n    Metadata  Meta\n    Status []Status\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/adZgg_x4j3\" rel=\"noreferrer\">See it working on the Go Playground here</a></kbd></p>\n\n<p>You should also reference the Golang specification for answers. Specifically, <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"noreferrer\">the part that talks about Exported Identifiers</a>.</p>\n"}], "owner": {"reputation": 610, "user_id": 1530293, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/850986c2ba967e56f0fca158ba03c3ec?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1530293/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12306, "favorite_count": 1, "accepted_answer_id": 28228444, "answer_count": 1, "score": 16, "last_activity_date": 1422613256, "creation_date": 1422585774, "question_id": 28228393, "link": "https://stackoverflow.com/questions/28228393/json-unmarshal-returning-blank-structure", "title": "json.Unmarshal returning blank structure", "body": "<p>I have a JSON blob that looks like this</p>\n\n<pre><code>{\n    \"metadata\":{\n        \"id\":\"2377f625-619b-4e20-90af-9a6cbfb80040\",\n        \"from\":\"2014-12-30T07:23:42.000Z\",\n        \"to\":\"2015-01-14T05:11:51.000Z\",\n        \"entryCount\":801,\n        \"size\":821472,\n        \"deprecated\":false\n    },\n    \"status\":[{\n         \"node_id\":\"de713614-be3d-4c39-a3f8-1154957e46a6\",\n         \"status\":\"PUBLISHED\"\n    }]\n}\n</code></pre>\n\n<p>and I have a little code to transform that back into go structs</p>\n\n<pre><code>type Status struct {\n    status string\n    node_id string\n}\n\ntype Meta struct {\n    to string\n    from string\n    id string\n    entryCount int64\n    size int64\n    depricated bool\n}\n\ntype Mydata struct {\n    met meta\n    stat []status\n}\n\nvar realdata Mydata\nerr1 := json.Unmarshal(data, &amp;realdata)\nif err1 != nil {\n    fmt.Println(\"error:\", err1)\n}\nfmt.Printf(\"%T: %+v\\n\", realdata, realdata)\n</code></pre>\n\n<p>but what I see when I run this is just a zeroed structure </p>\n\n<pre><code>main.Mydata: {met:{to: from: id: entryCount:0 size:0 depricated:false} stat:[]}\n</code></pre>\n\n<p>I tried allocating the struct first but that also didn't work, I'm not sure why its not producing values, and its not returning an error</p>\n"}, {"tags": ["java", "tcp", "go", "client-server", "tcpclient"], "answers": [{"comments": [{"owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "edited": false, "score": 0, "creation_date": 1422582288, "post_id": 28227492, "comment_id": 44818870, "body": "Changed to: while (true) {         \tinputLine = in.readLine();             \tif(inputLine != null){                     System.out.println(inputLine);             \t}              } Now it prints once, doesn&#39;t terminate, but doesnt print any more."}, {"owner": {"reputation": 41460, "user_id": 2310289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PO7Uz.jpg?s=128&g=1", "display_name": "Scary Wombat", "link": "https://stackoverflow.com/users/2310289/scary-wombat"}, "reply_to_user": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "edited": false, "score": 1, "creation_date": 1422582626, "post_id": 28227492, "comment_id": 44818962, "body": "No, the meaning of <code>above code</code> means ALL of the <code>above server code</code>.  It has to re-establish the server socket"}], "tags": [], "owner": {"reputation": 41460, "user_id": 2310289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PO7Uz.jpg?s=128&g=1", "display_name": "Scary Wombat", "link": "https://stackoverflow.com/users/2310289/scary-wombat"}, "is_accepted": true, "score": 0, "last_activity_date": 1422579325, "creation_date": 1422579325, "answer_id": 28227492, "question_id": 28227338, "link": "https://stackoverflow.com/questions/28227338/prevent-server-terminating-in-client-golang-server-java-application/28227492#28227492", "title": "Prevent server terminating in client (golang) server (Java) application", "body": "<p>When the client terminates, the <code>readLine</code> on server side will result in the end of the stream.  So if you want the server to continuously listen for new connections the simply put the above server code in a endless loop. </p>\n\n<p>e.g.</p>\n\n<pre><code>while (true) {\n   // above code\n}\n</code></pre>\n\n<p>For a play application that would be adequate.</p>\n"}], "owner": {"reputation": 2349, "user_id": 653331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4bf914078e4f4732891156dd917d69?s=128&d=identicon&r=PG&f=1", "display_name": "p_mcp", "link": "https://stackoverflow.com/users/653331/p-mcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 28227492, "answer_count": 1, "score": 0, "last_activity_date": 1422579325, "creation_date": 1422578187, "question_id": 28227338, "link": "https://stackoverflow.com/questions/28227338/prevent-server-terminating-in-client-golang-server-java-application", "title": "Prevent server terminating in client (golang) server (Java) application", "body": "<p>I have a simple echo-server in Java:</p>\n\n<pre><code> int portNumber = 4444;\n\n    try (\n        ServerSocket serverSocket =\n            new ServerSocket(Integer.parseInt(args[0]));\n        Socket clientSocket = serverSocket.accept();     \n        PrintWriter out =\n            new PrintWriter(clientSocket.getOutputStream(), true);                   \n        BufferedReader in = new BufferedReader(\n            new InputStreamReader(clientSocket.getInputStream()));\n    ) {\n        String inputLine;\n        while ((inputLine = in.readLine()) != null) {\n            out.println(inputLine);\n            System.out.println(inputLine);\n        }\n    } catch (IOException e) {\n        System.out.println(\"Exception caught when trying to listen on port \"\n            + portNumber + \" or listening for a connection\");\n        System.out.println(e.getMessage());\n    }\n</code></pre>\n\n<p>and a simple golang client:</p>\n\n<pre><code>func main() {\n    fmt.Println(\"start client\")\n    conn, err := net.Dial(\"tcp\", \"localhost:4444\")\n    if err != nil {\n        log.Fatal(\"Connection error\", err)\n    }\n    conn.Write([]byte(\"hello world\"))\n    conn.Close()\n    fmt.Println(\"done\")\n}\n</code></pre>\n\n<p>When I start the server and then run the client, the server echo's \"hello world\" as expected but then the server exits/terminates. </p>\n\n<p><strong>Q. How do I prevent this Java termination and force the server to continually wait for more client requests?</strong></p>\n"}, {"tags": ["go", "error-handling", "return-value", "multiple-return-values"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 3, "creation_date": 1422576995, "post_id": 28227095, "comment_id": 44817442, "body": "<code>item</code> will typically be <code>nil</code> in case of an error. Without checking for an error first, your code will crash in that case."}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 7, "last_activity_date": 1422579531, "creation_date": 1422579531, "answer_id": 28227531, "question_id": 28227095, "link": "https://stackoverflow.com/questions/28227095/multiple-values-in-single-value-context/28227531#28227531", "title": "Multiple values in single-value context", "body": "<p>No, but that is a good thing since you should always handle your errors.</p>\n\n<p>There are techniques that you can employ to defer error handling, see <a href=\"http://blog.golang.org/errors-are-values\">Errors are values</a> by Rob Pike.</p>\n\n<blockquote>\n<pre><code>ew := &amp;errWriter{w: fd}\new.write(p0[a:b])\new.write(p1[c:d])\new.write(p2[e:f])\n// and so on\nif ew.err != nil {\n    return ew.err\n}\n</code></pre>\n</blockquote>\n\n<p>In this example from the blog post he illustrates how you could create an <code>errWriter</code> type that defers error handling till you are done calling <code>write</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2171, "user_id": 1190376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61970bb1278cba93a6060586f35241b0?s=128&d=identicon&r=PG", "display_name": "Antimony", "link": "https://stackoverflow.com/users/1190376/antimony"}, "is_accepted": false, "score": 5, "last_activity_date": 1422589886, "creation_date": 1422589886, "answer_id": 28228942, "question_id": 28227095, "link": "https://stackoverflow.com/questions/28227095/multiple-values-in-single-value-context/28228942#28228942", "title": "Multiple values in single-value context", "body": "<p>No, you cannot directly access the first value.</p>\n\n<p>I suppose a hack for this would be to return an array of values instead of \"item\" and \"err\", and then just do\n    <code>item, _ := Get(1)[0]</code>\nbut I would not recommend this.</p>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 2133846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f126eb59387d563ffcf3d686b8e11f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jaehoon", "link": "https://stackoverflow.com/users/2133846/jaehoon"}, "is_accepted": false, "score": 3, "last_activity_date": 1422607927, "creation_date": 1422607927, "answer_id": 28232249, "question_id": 28227095, "link": "https://stackoverflow.com/questions/28227095/multiple-values-in-single-value-context/28232249#28232249", "title": "Multiple values in single-value context", "body": "<p>How about this way?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"errors\"\n)\n\ntype Item struct {\n    Value int\n    Name string\n}\n\nvar items []Item = []Item{{Value:0, Name:\"zero\"}, \n                        {Value:1, Name:\"one\"}, \n                        {Value:2, Name:\"two\"}}\n\nfunc main() {\n    var err error\n    v := Get(3, &amp;err).Value\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(v)\n\n}\n\nfunc Get(value int, err *error) Item {\n    if value &gt; (len(items) - 1) {\n        *err = errors.New(\"error\")\n        return Item{}\n    } else {\n        return items[value]\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 86, "last_activity_date": 1538687074, "last_edit_date": 1538687074, "creation_date": 1422611396, "answer_id": 28233172, "question_id": 28227095, "link": "https://stackoverflow.com/questions/28227095/multiple-values-in-single-value-context/28233172#28233172", "title": "Multiple values in single-value context", "body": "<p>In case of a multi-value return function you can't refer to fields or methods of a specific value of the result when calling the function.</p>\n\n<p>And if one of them is an <code>error</code>, it's there for a <em>reason</em> (which is the function <em>might</em> fail) and you should <em>not</em> bypass it because if you do, your subsequent code <em>might</em> also fail miserably (e.g. resulting in runtime panic).</p>\n\n<p>However there might be situations where you <em>know</em> the code will not fail in any circumstances. In these cases you can provide a <em>helper</em> function (or method) which will discard the <code>error</code> (or raise a runtime panic if it still occurs).<br>\nThis can be the case if you provide the input values for a function from code, and you know they work.<br>\nGreat examples of this are the <a href=\"http://golang.org/pkg/text/template/\" rel=\"noreferrer\"><code>template</code></a> and <a href=\"http://golang.org/pkg/regexp/\" rel=\"noreferrer\"><code>regexp</code></a> packages: if you provide a valid template or regexp at compile time, you can be sure they can always be parsed without errors at runtime. For this reason the <code>template</code> package provides the <a href=\"http://golang.org/pkg/text/template/#Must\" rel=\"noreferrer\"><code>Must(t *Template, err error) *Template</code></a> function and the <code>regexp</code> package provides the <a href=\"http://golang.org/pkg/regexp/#MustCompile\" rel=\"noreferrer\"><code>MustCompile(str string) *Regexp</code></a> function: they don't return <code>error</code>s because their intended use is where the input is guaranteed to be valid.</p>\n\n<p>Examples:</p>\n\n<pre><code>// \"text\" is a valid template, parsing it will not fail\nvar t = template.Must(template.New(\"name\").Parse(\"text\"))\n\n// `^[a-z]+\\[[0-9]+\\]$` is a valid regexp, always compiles\nvar validID = regexp.MustCompile(`^[a-z]+\\[[0-9]+\\]$`)\n</code></pre>\n\n<h2>Back to your case</h2>\n\n<p><em>IF</em> you can be certain <code>Get()</code> will not produce <code>error</code> for certain input values, you can create a helper <code>Must()</code> function which would not return the <code>error</code> but raise a runtime panic if it still occurs:</p>\n\n<pre><code>func Must(i Item, err error) Item {\n    if err != nil {\n        panic(err)\n    }\n    return i\n}\n</code></pre>\n\n<p>But you should not use this in all cases, just when you're sure it succeeds. Usage:</p>\n\n<pre><code>val := Must(Get(1)).Value\n</code></pre>\n\n<p><strong>Alternative / Simplification</strong></p>\n\n<p>You can even simplify it further if you incorporate the <code>Get()</code> call into your helper function, let's call it <code>MustGet</code>:</p>\n\n<pre><code>func MustGet(value int) Item {\n    i, err := Get(value)\n    if err != nil {\n        panic(err)\n    }\n    return i\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>val := MustGet(1).Value\n</code></pre>\n\n<p><strong>See some interesting / related questions:</strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/52653779/how-to-parse-multiple-returns-in-golang/52654950#52654950\">how to parse multiple returns in golang</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/28487036/return-map-like-ok-in-golang-on-normal-functions/28487270#28487270\">Return map like &#39;ok&#39; in Golang on normal functions</a></p>\n"}, {"tags": [], "owner": {"reputation": 2459, "user_id": 439745, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/16a8ca59efba12bdd0fb9b484ea82833?s=128&d=identicon&r=PG", "display_name": "Kesarion", "link": "https://stackoverflow.com/users/439745/kesarion"}, "is_accepted": false, "score": 7, "last_activity_date": 1482335217, "creation_date": 1482335217, "answer_id": 41266753, "question_id": 28227095, "link": "https://stackoverflow.com/questions/28227095/multiple-values-in-single-value-context/41266753#41266753", "title": "Multiple values in single-value context", "body": "<p>Yes, there is.</p>\n\n<p>Surprising, huh? You can get a specific value from a multiple return using a simple <code>mute</code> function:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\nfunc \u00b5(a ...interface{}) []interface{} {\n    return a\n}\n\ntype A struct {\n    B string\n    C func()(string)\n}\n\nfunc main() {\n    a := A {\n        B:strings.TrimSpace(\u00b5(E())[1].(string)),\n        C:\u00b5(G())[0].(func()(string)),\n    }\n\n    fmt.Printf (\"%s says %s\\n\", a.B, a.C())\n}\n\nfunc E() (bool, string) {\n    return false, \"F\"\n}\n\nfunc G() (func()(string), bool) {\n    return func() string { return \"Hello\" }, true\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/IwqmoKwVm-\" rel=\"noreferrer\">https://play.golang.org/p/IwqmoKwVm-</a></p>\n\n<p>Notice how you select the value number just like you would from a slice/array and then the type to get the actual value.</p>\n\n<p>You can read more about the science behind that from <a href=\"http://blog.vladimirvivien.com/2014/03/hacking-go-filter-values-from-multi.html\" rel=\"noreferrer\">this article</a>. Credits to the author.</p>\n"}, {"tags": [], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "is_accepted": false, "score": 1, "last_activity_date": 1602651042, "creation_date": 1602651042, "answer_id": 64346779, "question_id": 28227095, "link": "https://stackoverflow.com/questions/28227095/multiple-values-in-single-value-context/64346779#64346779", "title": "Multiple values in single-value context", "body": "<p>Here's a generic helper function with assumption checking:</p>\n<pre><code>func assumeNoError(value interface{}, err error) interface{} {\n    if err != nil {\n        panic(&quot;error encountered when none assumed:&quot; + err.Error())\n    }\n    return value\n}\n</code></pre>\n<p>Since this returns as an <code>interface{}</code>, you'll generally need to cast it back to your function's return type.</p>\n<p><em>For example, the OP's example called <code>Get(1)</code>, which returns <code>(Item, error)</code>.</em></p>\n<pre><code>item := assumeNoError(Get(1)).(Item)\n</code></pre>\n<hr />\n<p>The trick that makes this possible: <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Multi-values returned from one function call can be passed in as multi-variable arguments to another function.</a></p>\n<blockquote>\n<p>As a special case, if the return values of a function or method g are equal in number and individually assignable to the parameters of another function or method f, then the call f(g(parameters_of_g)) will invoke f after binding the return values of g to the parameters of f in order.</p>\n</blockquote>\n<hr />\n<p><em>This answer borrows heavily from existing answers, but none had provided a simple, generic solution of this form.</em></p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105985, "favorite_count": 17, "accepted_answer_id": 28233172, "answer_count": 6, "score": 121, "last_activity_date": 1602651042, "creation_date": 1422576616, "last_edit_date": 1522249579, "question_id": 28227095, "link": "https://stackoverflow.com/questions/28227095/multiple-values-in-single-value-context", "title": "Multiple values in single-value context", "body": "<p>Due to error handling in Go, I often end up with multiple values functions. So far, the way I have managed this has been very messy and I am looking for best practices to write cleaner code.</p>\n\n<p>Let's say I have the following function:</p>\n\n<pre><code>type Item struct {\n   Value int\n   Name string\n}\n\nfunc Get(value int) (Item, error) {\n  // some code\n\n  return item, nil\n}\n</code></pre>\n\n<p>How can I assign a new variable to <code>item.Value</code> elegantly. Before introducing the error handling, my function just returned <code>item</code> and I could simply do this:</p>\n\n<pre><code>val := Get(1).Value\n</code></pre>\n\n<p>Now I do this:</p>\n\n<pre><code>item, _ := Get(1)\nval := item.Value\n</code></pre>\n\n<p>Isn't there a way to access directly the first returned variable?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 6, "creation_date": 1422573065, "post_id": 28226395, "comment_id": 44816013, "body": "<a href=\"http://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">blog.golang.org/defer-panic-and-recover</a>. In this case, don&#39;t use it. It&#39;s only meant for exceptional &quot;the world is on fire&quot; circumstances."}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 1, "creation_date": 1422574381, "post_id": 28226395, "comment_id": 44816521, "body": "Also of note: <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#dont-panic\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/CodeReviewComments#dont-panic</a>"}, {"owner": {"reputation": 2171, "user_id": 1190376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61970bb1278cba93a6060586f35241b0?s=128&d=identicon&r=PG", "display_name": "Antimony", "link": "https://stackoverflow.com/users/1190376/antimony"}, "edited": false, "score": 0, "creation_date": 1422590320, "post_id": 28226395, "comment_id": 44820907, "body": "<a href=\"http://stackoverflow.com/questions/25025467/catching-panics-in-go-lang\">Similar question</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2171, "user_id": 1190376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61970bb1278cba93a6060586f35241b0?s=128&d=identicon&r=PG", "display_name": "Antimony", "link": "https://stackoverflow.com/users/1190376/antimony"}, "is_accepted": false, "score": 0, "last_activity_date": 1422590680, "creation_date": 1422590680, "answer_id": 28229060, "question_id": 28226395, "link": "https://stackoverflow.com/questions/28226395/golang-error-handling-understanding-panic/28229060#28229060", "title": "Golang error handling: understanding panic", "body": "<p>You want to use the <code>recover</code> function. </p>\n\n<pre><code>func Find(i int) item {\n    defer func() {\n        if e := recover(); e != nil {\n            // e is the interface{} typed-value we passed to panic()\n            fmt.Println(\"Whoops: \", e) // Prints \"Whoops: Not Found\"\n        }\n    }()\n\n    if (not found)\n    {    panic(\"Not Found\")\n    }\n\n    return myItem\n }       \n</code></pre>\n\n<p>Refer: <a href=\"http://blog.denevell.org/golang-panic-recover.html\" rel=\"nofollow\">http://blog.denevell.org/golang-panic-recover.html</a>   </p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 871, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1422590680, "creation_date": 1422572846, "question_id": 28226395, "link": "https://stackoverflow.com/questions/28226395/golang-error-handling-understanding-panic", "title": "Golang error handling: understanding panic", "body": "<p>I am quite new to Go and I am trying to grasp the <code>panic</code> function.</p>\n\n<p>Up until now, I have been using this similar syntax to handle errors in programs:</p>\n\n<pre><code>func Find(i int) (item, error) {\n  // some code\n\n  if (not found) {\n    return nil, errors.New('Not Found')\n  }\n\n  // if found:\n  return myItem, nil\n\n}\n</code></pre>\n\n<p>Then I stumbled upon the <code>panic</code> function. I am having a hard time understanding it. Is it possible to get rid of the <code>error</code> in the return statement and do something like this?</p>\n\n<pre><code>func Find(i int) item {\n  // some code\n\n  if (not found) {\n    panic('Not found')\n  }\n\n  return myItem\n\n}\n</code></pre>\n\n<p>If yes how do I handle the error when the function is called?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1422619463, "post_id": 28225629, "comment_id": 44832490, "body": "Note: There is absolutely no notion of &quot;pass by reference&quot; in Go. You pass pointers by value."}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 2, "last_activity_date": 1422571739, "creation_date": 1422571739, "answer_id": 28226147, "question_id": 28225629, "link": "https://stackoverflow.com/questions/28225629/golang-error-function-arguments-too-large-for-new-goroutine/28226147#28226147", "title": "Golang error function arguments too large for new goroutine", "body": "<p>No, none I know of.</p>\n\n<p>I don't think you should be too aggressive tuning to avoid copying, but it appears <a href=\"http://golang.org/src/runtime/proc.c#L2199\" rel=\"nofollow\">from the source</a> that this error is emitted when parameters exceed the usable stack space for a new goroutine, which should be kilobytes. The copying overhead is real at that point, especially if this isn't the only time these things are copied. Perhaps some struct either explicitly is larger than expected thanks to a large struct member (1kb array rather than a slice, say) or indirectly. If not, just using a pointer as you have makes sense, and if you're worried about creating garbage, recycle the structs pointed to using <a href=\"http://golang.org/pkg/sync/#Pool\" rel=\"nofollow\"><code>sync.Pool</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 7907, "user_id": 1592008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e208220f7cb95e6854adb653663736a?s=128&d=identicon&r=PG", "display_name": "Oleg Neumyvakin", "link": "https://stackoverflow.com/users/1592008/oleg-neumyvakin"}, "is_accepted": false, "score": 0, "last_activity_date": 1482827020, "creation_date": 1482827020, "answer_id": 41341532, "question_id": 28225629, "link": "https://stackoverflow.com/questions/28225629/golang-error-function-arguments-too-large-for-new-goroutine/41341532#41341532", "title": "Golang error function arguments too large for new goroutine", "body": "<p>Got this issue at processing list of values(<code>[]BigType</code>) of big struct:</p>\n\n<pre><code>for _, stct := range listBigStcts {\n    go func(stct BigType) {\n        ...process stct ...\n    }(stct) // &lt;-- error occurs here\n\n}\n</code></pre>\n\n<p>Workaround is to replace <code>[]BigType</code> with <code>[]*BigType</code></p>\n"}, {"tags": [], "owner": {"reputation": 1640, "user_id": 5531595, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/455940914617164/picture?type=large", "display_name": "Rohman HM", "link": "https://stackoverflow.com/users/5531595/rohman-hm"}, "is_accepted": false, "score": 1, "last_activity_date": 1604492137, "creation_date": 1604492137, "answer_id": 64679894, "question_id": 28225629, "link": "https://stackoverflow.com/questions/28225629/golang-error-function-arguments-too-large-for-new-goroutine/64679894#64679894", "title": "Golang error function arguments too large for new goroutine", "body": "<p>I was able to fix this issue by changing the arguments from</p>\n<pre><code>func doStuff(prev, next User)\n</code></pre>\n<p>to</p>\n<pre><code>func doStuff(prev, next *User)\n</code></pre>\n<p>The answer from @twotwotwo in <a href=\"https://stackoverflow.com/a/28226147/5531595\">here</a> is very helpful.</p>\n"}], "owner": {"reputation": 411, "user_id": 3011331, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1373ada708df2e3cecf0d3b5a6bb037b?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/3011331/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2502, "favorite_count": 1, "accepted_answer_id": 28226147, "answer_count": 3, "score": 6, "last_activity_date": 1604492137, "creation_date": 1422569539, "question_id": 28225629, "link": "https://stackoverflow.com/questions/28225629/golang-error-function-arguments-too-large-for-new-goroutine", "title": "Golang error function arguments too large for new goroutine", "body": "<p>I am running a program with go 1.4 and I am trying to pass a large struct to a go function. </p>\n\n<pre><code>go ProcessImpression(network, &amp;logImpression, campaign, actualSpent, partnerAccount, deviceId, otherParams)\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>runtime.newproc: function arguments too large for new goroutine\n</code></pre>\n\n<p>I have moved to pass by reference which helps but I am wondering if there is some way to pass large structs in a go function.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1422566755, "post_id": 28220714, "comment_id": 44812916, "body": "Does it make any difference if you reverse the order of the <code>Order()</code> and <code>Filter()</code>?  (It shouldn&#39;t, but I&#39;m curious!)."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1422725250, "post_id": 28220714, "comment_id": 44867347, "body": "You sure it&#39;s not zeroed-memory initialization from <code>new</code> keyword you use to create MyStruct instance? 0 maps to &quot;&quot; for any string field in a struct."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1422897332, "post_id": 28220714, "comment_id": 44920329, "body": "Definitely makes no difference if I switch Order() and Filter().  I&#39;m looking into the zeroed-memory init theory now..."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1422898117, "post_id": 28220714, "comment_id": 44920736, "body": "@pie-o-pah MyStruct is really a slice, which I init with <code>mySlice := new(MyStruct, 0)</code>, which I do plenty of time in other code.  I don&#39;t think that is the issue, unless it is with the underlying struct which consists of five *datastore.Key properties, and one float64 property, nothing fancy, and all of those properties should zero out without any problems I would think."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1422900410, "post_id": 28220714, "comment_id": 44921887, "body": "@pie-o-pah, see my edits to the original post for the declarations of all of the different types."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1422902286, "post_id": 28220714, "comment_id": 44922857, "body": "@pie-o-pah, I figured it out thanks to your help!  It was related to the way that I was initializing something, but I was looking at all the wrong somethings.  The function in my code actually takes a few more parameters (all keys that will create other <code>.Filters()</code> if not nil).  They all should have been nil as I am not actually using them yet, and I assumed that they were.  I was initializing one of them using <code>myKey := new(datastore.Key)</code>, which I never do; the others using <code>var myKey2 *datastore.Key</code>, which I always use. The former creates an incomplete key, the latter creates a nil key."}, {"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "reply_to_user": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1422902318, "post_id": 28220714, "comment_id": 44922882, "body": "@pie-o-pah, if you create an answer to this question based on your comment, I will select it as the official answer so that you can get the rep points"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1422926262, "post_id": 28220714, "comment_id": 44933276, "body": "Wow, okay glad I can help. Thanks for the generosity!"}], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "edited": false, "score": 0, "creation_date": 1422986731, "post_id": 28289866, "comment_id": 44962561, "body": "Thanks for the help, @pie-oh-pah, much appreciated!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 1, "last_activity_date": 1422926677, "creation_date": 1422926677, "answer_id": 28289866, "question_id": 28220714, "link": "https://stackoverflow.com/questions/28220714/weird-datastore-error-in-go-the-kind-is-the-empty-string/28289866#28289866", "title": "Weird datastore error in Go, &quot;The kind is the empty string&quot;", "body": "<p>Looking at your issue on the first glance (because I am not familiar with Google's datastore API), it seems to me the problem is a result of zeroed-memory initialization using <code>new</code> keyword. </p>\n\n<p>When a struct is created with the keyword without assigning starting values for the fields, 0's are given as default. When mapped to string, it's \"\" (empty). Go actually threw a very helpful error for you.</p>\n\n<p>As you have pointed out, you have used <code>Mykey := new(datastore.Key)</code>. Thanks for your generosity and this can serve as answer for future users.</p>\n"}], "owner": {"reputation": 554, "user_id": 1827960, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ABmWI.jpg?s=128&g=1", "display_name": "Blair Connolly", "link": "https://stackoverflow.com/users/1827960/blair-connolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 28289866, "answer_count": 1, "score": 1, "last_activity_date": 1472825083, "creation_date": 1422551890, "last_edit_date": 1472825083, "question_id": 28220714, "link": "https://stackoverflow.com/questions/28220714/weird-datastore-error-in-go-the-kind-is-the-empty-string", "title": "Weird datastore error in Go, &quot;The kind is the empty string&quot;", "body": "<p>I am recently getting an error that I have never seen before when making a simple datastore.GetAll() request.  I can't figure out what it means and I can't find any documentation with the error message or any help from Googleing the error message.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>type MyUnderlyingStruct struct {\n    ApplyTo             *datastore.Key\n    ApplyFrom           *datastore.Key\n    Amount              float64\n    LocationKey         *datastore.Key\n    DepartmentKey       *datastore.Key\n    SubjectAreaKey      *datastore.Key\n}\n\ntype MyStruct []MyUnderlyingStruct \n\n//In the case where I get the error someKey is a valid, complete Key value\n//  of a different kind that what we are querying for and there is actually\n//  an entity in my datastore that matches this query\nfunc (x *MyStruct) Load(w http.ResponseWriter, r *http.Request, someKey *datastore.Key) (error) {\n    c := appengine.NewContext(r)\n    q := datastore.NewQuery(\"MyUnderlyingStruct_KindName\").Order(\"-Amount\")\n    if someKey != nil { q = q.Filter(\"ApplyTo=\", someKey) }\n\n    keys, err := q.GetAll(c,x)\n    if _, ok := err.(*datastore.ErrFieldMismatch); ok { err = nil }\n    if err != nil &amp;&amp; err != datastore.Done {return err}\n    return nil\n}\n</code></pre>\n\n<p>Which returns this error:</p>\n\n<pre><code>API error 1 (datastore_v3: BAD_REQUEST): The kind is the empty string.\n</code></pre>\n\n<p>Can anyone tell me why I am getting this error, or what it is trying to tell me?</p>\n"}, {"tags": ["mysql", "go", "localhost", "mysql-error-1045"], "answers": [{"tags": [], "owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1423255414, "creation_date": 1423255414, "answer_id": 28374468, "question_id": 28219810, "link": "https://stackoverflow.com/questions/28219810/golang-editing-previously-set-flag-mysql-error-1045/28374468#28374468", "title": "golang editing previously set flag. MySQL error 1045", "body": "<p>After doing some more research I've found that there's no need to edit a flag specifying a connection parameter through user input, since it is possible to pass such mysql parameters when running a go application (i.e. : -user, -p, etc).</p>\n"}], "owner": {"reputation": 2741, "user_id": 2438413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cLAr2.jpg?s=128&g=1", "display_name": "Juan M", "link": "https://stackoverflow.com/users/2438413/juan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 28374468, "answer_count": 1, "score": 0, "last_activity_date": 1423255414, "creation_date": 1422549213, "question_id": 28219810, "link": "https://stackoverflow.com/questions/28219810/golang-editing-previously-set-flag-mysql-error-1045", "title": "golang editing previously set flag. MySQL error 1045", "body": "<p>I'm having trouble setting a flag after user input to use as a connection parameter to a MySQL Database. Below is a snippet of my code:</p>\n\n<pre><code>func init() {\n\n    flag.StringVar(&amp;flagUser, \"user\", \"root\", \"User\")\n\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter username: \")\n    inputUser, _ := reader.ReadString('\\n')\n\n    f := flag.Lookup(\"user\")\n        if inputUser != f.Value.String() {\n            flag.StringVar(&amp;flagUser, \"user\", inputUser, \"User\")\n        }\n\n    flag.Parse()\n}\n</code></pre>\n\n<p>Even if I call flag.Parse only once and the user input is also \"root\", i get a 1045 (\"mysql access denied for user root@localhost\"), which doesn't occur if i don't edit the flag. I would really appreciate any suggestions on this issue.</p>\n\n<p>Once again, thanks for the help!</p>\n"}, {"tags": ["angularjs", "go", "beego"], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 1139107, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/faf978713caf2baf42359335bd729c4d?s=128&d=identicon&r=PG", "display_name": "under5hell", "link": "https://stackoverflow.com/users/1139107/under5hell"}, "edited": false, "score": 0, "creation_date": 1423116416, "post_id": 28336936, "comment_id": 45020264, "body": "But, there&#39;s another issue. Everytime i send POST request, beego treat it as OPTIONS request. Also it say &quot;http: multiple response.WriteHeader calls&quot;. i really have no idea what is goin on. I have set AllowMethods to GET,POST,PUT,PATCH,DELETE.. but still no luck."}, {"owner": {"reputation": 987, "user_id": 1139107, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/faf978713caf2baf42359335bd729c4d?s=128&d=identicon&r=PG", "display_name": "under5hell", "link": "https://stackoverflow.com/users/1139107/under5hell"}, "edited": false, "score": 0, "creation_date": 1423117138, "post_id": 28336936, "comment_id": 45020513, "body": "here&#39;s my question about the issue  [link] <a href=\"http://stackoverflow.com/questions/28337387/post-request-treated-as-options-on-beego-framework\" title=\"post request treated as options on beego framework\">stackoverflow.com/questions/28337387/&hellip;</a> [/link]"}], "tags": [], "owner": {"reputation": 566, "user_id": 2232944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d574ec26a01516e243e9b6faeb9346c3?s=128&d=identicon&r=PG", "display_name": "Will Krause", "link": "https://stackoverflow.com/users/2232944/will-krause"}, "is_accepted": true, "score": 9, "last_activity_date": 1423114924, "creation_date": 1423114924, "answer_id": 28336936, "question_id": 28216342, "link": "https://stackoverflow.com/questions/28216342/how-to-set-acces-control-allow-origin-in-beego-framework/28336936#28336936", "title": "how to set acces-control-allow-origin in beego framework", "body": "<p>You want to use the cors plugin by including \"github.com/astaxie/beego/plugins/cors\" in your import statement. </p>\n\n<p>The package has a commented out example shown below:</p>\n\n<pre><code> func main() {\n // CORS for https://foo.* origins, allowing:\n // - PUT and PATCH methods\n // - Origin header\n// // - Credentials share\n beego.InsertFilter(\"*\", beego.BeforeRouter,cors.Allow(&amp;cors.Options{\n AllowOrigins: []string{\"https://*.foo.com\"},\n AllowMethods: []string{\"PUT\", \"PATCH\"},\n AllowHeaders: []string{\"Origin\"},\n ExposeHeaders: []string{\"Content-Length\"},\n AllowCredentials: true,\n }))\n beego.Run()\n }\n</code></pre>\n\n<p>So if you want anyone to be able to hit your backend, change the AllowOrigins parameter to just []String{\"*\"}. And presumably include \"GET\" in the AllowMethods paramter. </p>\n"}], "owner": {"reputation": 987, "user_id": 1139107, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/faf978713caf2baf42359335bd729c4d?s=128&d=identicon&r=PG", "display_name": "under5hell", "link": "https://stackoverflow.com/users/1139107/under5hell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2652, "favorite_count": 0, "accepted_answer_id": 28336936, "answer_count": 1, "score": 4, "last_activity_date": 1423114924, "creation_date": 1422539266, "question_id": 28216342, "link": "https://stackoverflow.com/questions/28216342/how-to-set-acces-control-allow-origin-in-beego-framework", "title": "how to set acces-control-allow-origin in beego framework", "body": "<p>I'm developing a RESTFul API using beego framework on the server and AngularJS on the client side. Both server and client are in my laptop (still in dev). Client run on 127.0.0.1:8000 and server on 127.0.0.1:8080.</p>\n\n<p>When i try to hit an endpoint (using AngularJS $http service). i get the following error:</p>\n\n<pre><code>XMLHttpRequest cannot load http://127.0.0.1:8080/v1/products/. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://127.0.0.1:8000' is therefore not allowed access.\n</code></pre>\n\n<p>I know i have to set this CORS stuff on beego. Unfortunately, after searching google, the only answer i got was from official website (<a href=\"http://beego.me/docs/advantage/docs.md\" rel=\"nofollow\">in the comment section</a>)  which is not clear enough for me. Any advice guys? what kind of code should i write and where to put it on beego? thanks.</p>\n"}, {"tags": ["python", "performance", "google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 11357, "user_id": 584846, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uD1uQ.jpg?s=128&g=1", "display_name": "Brent Washburne", "link": "https://stackoverflow.com/users/584846/brent-washburne"}, "edited": false, "score": 0, "creation_date": 1422554002, "post_id": 28215393, "comment_id": 44805708, "body": "Where is the source code in each language for computing the Fibonacci numbers?  In Python, it&#39;s <code>from math import sqrt,pow; p=sqrt(5); n=33; print int((pow(1+p,n) - pow(1-p,n)) &#47; (pow(2,n)*p))</code> as shown here: <a href=\"http://www.math.rutgers.edu/~erowland/fibonacci.html\" rel=\"nofollow noreferrer\">math.rutgers.edu/~erowland/fibonacci.html</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11357, "user_id": 584846, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uD1uQ.jpg?s=128&g=1", "display_name": "Brent Washburne", "link": "https://stackoverflow.com/users/584846/brent-washburne"}, "edited": false, "score": 0, "creation_date": 1422556882, "post_id": 28215393, "comment_id": 44807371, "body": "@BrentWashburne I don&#39;t know the source code or implementation that is used, this is all that is mentioned on the &quot;CPU Latency&quot; tab of each language&#39;s status page (e.g. this is the <a href=\"https://code.google.com/status/appengine/detail/serving-go/2015/01/27#ae-trust-detail-cpu-fibonacci-go-latency\" rel=\"nofollow noreferrer\">Go Status page</a>). But I would be surprised if different implementations would be used (that would defeat the purpose of this statistics)."}, {"owner": {"reputation": 11357, "user_id": 584846, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uD1uQ.jpg?s=128&g=1", "display_name": "Brent Washburne", "link": "https://stackoverflow.com/users/584846/brent-washburne"}, "edited": false, "score": 0, "creation_date": 1422557534, "post_id": 28215393, "comment_id": 44807721, "body": "I&#39;d be more interested in performance of &quot;real-world&quot; applications, like a NDB filtered query and a JSON-encoded response, i.e. a REST request/response.  Are there any comparisons like this?"}, {"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1422566252, "post_id": 28215393, "comment_id": 44812626, "body": "Something else to bear in mind is that <code>goroutines</code> are <a href=\"https://cloud.google.com/appengine/docs/go/\" rel=\"nofollow noreferrer\">not supported for parallel execution</a> in the regular Go runtime (in the same way that the Java runtime doesn&#39;t support thread creation).  However, I believe this restriction doesn&#39;t apply to the Go Managed VM.  <a href=\"https://cloud.google.com/appengine/docs/managed-vms/\" rel=\"nofollow noreferrer\">This page</a> doesn&#39;t explicitly mention golang, but it might be inferred from the Python and Java comments.  If your workload benefits from this sort of concurrency, this may give golang a performance advantage."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1422572527, "post_id": 28215393, "comment_id": 44815810, "body": "@tx802 Multi-threaded execution is available for Java too for a long time now (<a href=\"https://cloud.google.com/appengine/docs/java/\" rel=\"nofollow noreferrer\">source</a>): <i>&quot;A Java application can create a new thread, but there are some restrictions on how to do it. These threads can&#39;t &quot;outlive&quot; the request that creates them.&quot;</i>"}, {"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1422601892, "post_id": 28215393, "comment_id": 44824222, "body": "@icza good point, I had forgotten that change. The goroutine restriction still applies though."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1422556780, "last_edit_date": 1592644375, "creation_date": 1422536314, "answer_id": 28215393, "question_id": 28215085, "link": "https://stackoverflow.com/questions/28215085/what-are-the-cost-perfomance-advantages-of-using-golang-in-gae/28215393#28215393", "title": "what are the cost/perfomance advantages of using &quot;golang&quot; in GAE", "body": "<p>App Engine doesn't have explicit limits or restrictions that would apply only when using a specific language. However the languages and their technologies might imply certain limitations, for example a Java Virtual Machine instance by itself requires significantly more memory and has significantly higher startup time (even when warmup requests are enabled) than starting the built-in web server of Go, so in case of a Java instance less memory will remain for the webapp itself to allocate and use (for a specific plan/type and instance).</p>\n<p>I don't have concrete measures to compare, but (in case of Go):</p>\n<blockquote>\n<p>&quot;Code is deployed in source form and compiled in the cloud... Go is the first true compiled language that runs on App Engine. Go on App Engine makes it possible to deploy efficient, CPU-intensive web applications&quot;. (<a href=\"http://blog.golang.org/go-and-google-app-engine\" rel=\"nofollow noreferrer\">source</a>)</p>\n</blockquote>\n<p>If you think about it, other languages at App Engine are all interpreted (including Java which is byte code interpreted by a Virtual Machine) while Go is compiled into and runs as platform dependent <em>native code</em>. This should already tell something about performance.</p>\n<p>For a &quot;case-study&quot; check out the following blog post:</p>\n<p><a href=\"http://blog.golang.org/from-zero-to-go-launching-on-google\" rel=\"nofollow noreferrer\"><strong>From zero to Go: launching on the Google homepage in 24 hours</strong></a></p>\n<p>This blog also contains some performance report of a real-world app used by millions:</p>\n<blockquote>\n<p><img src=\"https://i.stack.imgur.com/LWKR8.png\" alt=\"dynamic requests\" /></p>\n<p>This chart - taken directly from the App Engine dashboard - shows average request latency during launch. As you can see, even under load it never exceeds 60 ms, with a median latency of 32 milliseconds. This is wicked fast, considering that our request handler is doing image manipulation and encoding on the fly.</p>\n</blockquote>\n<p>App Engine uses the web server that is included in the Go standard library to serve your app, so that also means you can easily port a Go web app to App Engine, and that you know exactly what to expect from the web server serving your app on App Engine.</p>\n<h2>Found Official time comparisions of Python, Java and Go</h2>\n<p>The <a href=\"http://code.google.com/status/appengine\" rel=\"nofollow noreferrer\"><strong>App Engine System Status</strong></a> can be considered official and a good comparision base.</p>\n<p>You can click on any cells belonging to a specific day and language, and you get detailed historical statistics for Static and Dynamic GET latency (both secure and unsecure), Error rates, CPU usage/latency. These statistics are measured on an instance that is already up and ready to serve.</p>\n<p>Analysing it for the day of <strong>January 27, 2015</strong> here are the conclusions for <a href=\"http://code.google.com/status/appengine/detail/serving-go/2015/01/27#ae-trust-detail-helloworld-get-go-latency\" rel=\"nofollow noreferrer\">Go</a>, <a href=\"http://code.google.com/status/appengine/detail/serving-java/2015/01/27#ae-trust-detail-helloworld-get-java-latency\" rel=\"nofollow noreferrer\">Java</a> and <a href=\"http://code.google.com/status/appengine/detail/serving/2015/01/27#ae-trust-detail-helloworld-get-latency\" rel=\"nofollow noreferrer\">Python</a>:</p>\n<ul>\n<li>Dynamic latency is roughly the same for all</li>\n<li>CPU latency (to compute the 33<sup>rd</sup> Fibonacci number) is best for Java, then Go and slowest is Python.</li>\n<li>Static file serving time is roughly the same but Go is fastest.</li>\n</ul>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1462, "favorite_count": 1, "accepted_answer_id": 28215393, "answer_count": 1, "score": 5, "last_activity_date": 1422556780, "creation_date": 1422535389, "question_id": 28215085, "link": "https://stackoverflow.com/questions/28215085/what-are-the-cost-perfomance-advantages-of-using-golang-in-gae", "title": "what are the cost/perfomance advantages of using &quot;golang&quot; in GAE", "body": "<p>In terms of the Quotas/Usage limits per instance, is there any considerable improvement/advantage when using <a href=\"http://golang.org/\">golang</a> in Google appengine <a href=\"https://appengine.google.com/\">GAE</a> instead of other offered language that run within GAE like python, java,php or all of them behave the same?</p>\n\n<p>Or basically any instance no matter the language in use, behave the same way and can handle barely the same amount of maximum requests/sec per instance considering that this concerns more to the \"GAE load balancer\" or infrastructure, rather than the used programming language, same logic could applied to the memory,cpu usage?</p>\n"}, {"tags": ["pointers", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1422538368, "post_id": 28215295, "comment_id": 44795291, "body": "Mmm, reflect is nice and generic, but to slow to be of use. I missed the go generate, and it looks interesting. Will dive into."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1422538528, "post_id": 28215295, "comment_id": 44795410, "body": "@RickyA yes, each time you see: &quot; it will be a pain to write all these ... <code>&lt;code&gt;</code>&quot;, you now have the go 1.4 option of <code>go generate</code>: <a href=\"https://golang.org/cmd/go/#hdr-Generate_Go_files_by_processing_source\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-Generate_Go_files_by_processing_sourc&zwnj;&#8203;e</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 3, "last_activity_date": 1569419966, "last_edit_date": 1569419966, "creation_date": 1422536039, "answer_id": 28215295, "question_id": 28215031, "link": "https://stackoverflow.com/questions/28215031/test-for-nil-values-in-nested-stucts/28215295#28215295", "title": "Test for nil values in nested stucts", "body": "<p>If you want to avoid '<a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a>' (reflection, as a \"generic\" way to test fields of any <code>struct</code>, a bit as in \"<a href=\"https://stackoverflow.com/q/24348184/6309\">Get pointer to value using reflection</a>\" or in <a href=\"https://gist.github.com/hvoecking/10772475#file-translate-go-L191-L204\" rel=\"nofollow noreferrer\">this gist</a>: it is slower), the surest way would be to implement methods on <code>Foo</code> in order to return the right value</p>\n\n<pre><code>func (foo *Foo) BarBaz() string {\n    if f2.Bar != nil &amp;&amp; f2.Bar.Baz != nil {\n        return f2.Bar.Baz.Baz\n    } else {\n        fmt.Println(\"something nil\")\n        return \"\" // for example\n    } \n}\n</code></pre>\n\n<p>If there are <em>a lot</em> of such functions to write, maybe <a href=\"http://blog.golang.org/generate\" rel=\"nofollow noreferrer\">go 1.4 <code>go generate</code></a> command can help generate most of them.</p>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1569426411, "post_id": 58100426, "comment_id": 102595891, "body": "Very good suggestion (upvoted). I had seen that before in a debate about null-safe operator for Go: <a href=\"https://www.reddit.com/r/golang/comments/5eizbo/why_doesnt_go_have_a_nullsafe_operator/\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/5eizbo/&hellip;</a>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1569493849, "post_id": 58100426, "comment_id": 102618935, "body": "I swapped the accepted answer to this one because this is what I ended up using: a lot of accessor functions. I could improve by using your <code>self==nil</code> test though."}, {"owner": {"reputation": 5706, "user_id": 4424236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZmVLO.jpg?s=128&g=1", "display_name": "beatcracker", "link": "https://stackoverflow.com/users/4424236/beatcracker"}, "edited": false, "score": 0, "creation_date": 1619040223, "post_id": 58100426, "comment_id": 118788191, "body": "I&#39;ve found implementation of this approach for codegen: <a href=\"https://github.com/google/go-github/blob/7a077bbd7313615d4f924f12b065913ee94e1d58/github/gen-accessors.go\" rel=\"nofollow noreferrer\">google/go-github/github/gen-accessors.go</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1569426770, "last_edit_date": 1569426770, "creation_date": 1569420721, "answer_id": 58100426, "question_id": 28215031, "link": "https://stackoverflow.com/questions/28215031/test-for-nil-values-in-nested-stucts/58100426#58100426", "title": "Test for nil values in nested stucts", "body": "<p>One elegant way (in my opinion) of handling it is to add getters to structs that are used as pointers. This \"technique\" is also used by the generated Go code of <a href=\"https://developers.google.com/protocol-buffers/docs/gotutorial\" rel=\"noreferrer\">protobuf</a>, and it allows natural chaining of method calls without having to worry about runtime panic due to <code>nil</code> pointers.</p>\n\n<p>In your example the <code>Bar</code> and <code>Baz</code> structs are used as pointers, so arm them with getters. The focus is on adding methods with pointer receiver, and first it must be checked if the receiver is <code>nil</code>. If so, return the zero value of the result type. If not, proceed to return the field of the struct:</p>\n\n<pre><code>func (b *Bar) GetBaz() *Baz {\n    if b == nil {\n        return nil\n    }\n    return b.Baz\n}\n\nfunc (b *Baz) GetBaz() string {\n    if b == nil {\n        return \"\"\n    }\n    return b.Baz\n}\n</code></pre>\n\n<p>The good thing about methods with pointer receivers is that you may call them with <code>nil</code> receivers. It does not cause a runtime panic until you try to refer to their fields, which we don't, that's why we first check if the receiver is <code>nil</code> (ultimately, receivers act as normal parameters\u2013and it's never an error to pass <code>nil</code> as a pointer argument).</p>\n\n<p>Having the above getters, use is simplified to this, and no runtime panic occurs in any of these examples:</p>\n\n<pre><code>fmt.Println(f3.Bar.GetBaz().GetBaz()) // naturally no panic\nfmt.Println(f2.Bar.GetBaz().GetBaz()) // No panic\nfmt.Println(f1.Bar.GetBaz().GetBaz()) // No panic\n\nif baz := f2.Bar.GetBaz(); baz != nil {\n    fmt.Println(baz.GetBaz())\n} else {\n    fmt.Println(\"something nil\")\n}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/3pDCZYGmDqT\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3229, "favorite_count": 5, "accepted_answer_id": 58100426, "answer_count": 2, "score": 8, "last_activity_date": 1602119162, "creation_date": 1422535243, "last_edit_date": 1569420734, "question_id": 28215031, "link": "https://stackoverflow.com/questions/28215031/test-for-nil-values-in-nested-stucts", "title": "Test for nil values in nested stucts", "body": "<p>I have a deeply nested struct in go. These are constructed by a json unmarshaller. </p>\n\n<p>Quite some fields in this struct are however 'omitifempty' so I end op with a struct that can have nills in various places.</p>\n\n<p>Example (the real thing is even deeper nested, and big: 400 lines of structs):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Foo struct {\n    Foo string\n    Bar *Bar\n}\n\ntype Bar struct {\n    Bar string\n    Baz *Baz\n}\n\ntype Baz struct {\n    Baz string\n}\n\nfunc main() {\n    f1 := Foo{Foo: \"f1\"}\n    f2 := Foo{Foo: \"f2\", Bar: &amp;Bar{Bar: \"br2\"}}\n    f3 := Foo{Foo: \"f3\", Bar: &amp;Bar{Bar: \"br3\", Baz: &amp;Baz{Baz: \"bz3\"}}}\n\n    fmt.Println(f3.Bar.Baz.Baz) //-&gt; bz3\n    fmt.Println(f2.Bar.Baz.Baz) //-&gt; panic: runtime error: invalid memory address or nil pointer dereference\n    fmt.Println(f1.Bar.Baz.Baz) //-&gt; panic: runtime error: invalid memory address or nil pointer dereference    \n    //so far so good, but\n\n    //is there a more generic way to do this kind of testing?\n    if f2.Bar != nil &amp;&amp; f2.Bar.Baz != nil {\n        fmt.Println(f2.Bar.Baz.Baz)\n    } else {\n        fmt.Println(\"something nil\")\n    }\n}\n</code></pre>\n\n<p>The question is if there is a more generic way to test if some node in the reference tree is nil? I need to get a lot of different items and it will be a pain to write all these if statements. \nOh and speed is of concern.</p>\n"}, {"tags": ["node.js", "go", "socket.io"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1422545742, "post_id": 28212586, "comment_id": 44800389, "body": "Have you considered http? Seems like a simple REST API should suffice."}], "answers": [{"comments": [{"owner": {"reputation": 5360, "user_id": 2147188, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/WBpQ5.jpg?s=128&g=1", "display_name": "karthick", "link": "https://stackoverflow.com/users/2147188/karthick"}, "edited": false, "score": 0, "creation_date": 1422530970, "post_id": 28213501, "comment_id": 44790746, "body": "Thanks for information. Any suggestion to choose protocol to communicate between nodejs and golang."}, {"owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "reply_to_user": {"reputation": 5360, "user_id": 2147188, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/WBpQ5.jpg?s=128&g=1", "display_name": "karthick", "link": "https://stackoverflow.com/users/2147188/karthick"}, "edited": false, "score": 0, "creation_date": 1422545715, "post_id": 28213501, "comment_id": 44800369, "body": "Go comes with a JSON-RPC implementation. There are some good JSON-RPC implementations for Node.js, so I would just try to use them. For instance: <a href=\"https://github.com/tedeh/jayson\" rel=\"nofollow noreferrer\">github.com/tedeh/jayson</a>"}], "tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": false, "score": 1, "last_activity_date": 1422530646, "creation_date": 1422530646, "answer_id": 28213501, "question_id": 28212586, "link": "https://stackoverflow.com/questions/28212586/what-is-the-disadvantage-of-using-socket-io-to-conenct-nodejs-server-and-golang/28213501#28213501", "title": "What is the disadvantage of using socket.io to conenct nodejs server and golang server?", "body": "<p>This is mostly an opinion-based question, but I could see some drawbacks.</p>\n\n<p>Socket.io is a solution designed to unify communications between a browser and a server. It is useful to implement highly dynamic web sites, and hides the different underlying solutions/protocols which are more or less well supported by the browsers (websockets, long polling, etc ...).</p>\n\n<p>It is not really designed to communicate between two servers, even if it can probably be used for this as well. Since you can develop the node.js and Go servers, just choose an adequate protocol for that. You do not have to wrap it into a layer such as socket.io.</p>\n\n<p>Go supports socket.io through third-parties libraries such as:\n<a href=\"https://github.com/googollee/go-socket.io\" rel=\"nofollow\">https://github.com/googollee/go-socket.io</a></p>\n\n<p>It is an extra dependency you have to handle for your application.</p>\n"}, {"tags": [], "owner": {"reputation": 1360, "user_id": 1555884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e3d4fedd25c399d281ae47b4177d105?s=128&d=identicon&r=PG", "display_name": "Sergiy Kozachenko", "link": "https://stackoverflow.com/users/1555884/sergiy-kozachenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1423206829, "creation_date": 1423206829, "answer_id": 28360448, "question_id": 28212586, "link": "https://stackoverflow.com/questions/28212586/what-is-the-disadvantage-of-using-socket-io-to-conenct-nodejs-server-and-golang/28360448#28360448", "title": "What is the disadvantage of using socket.io to conenct nodejs server and golang server?", "body": "<p>If you have node and go apps on the same machine consider using unix sockets <a href=\"https://www.npmjs.com/package/socket-model\" rel=\"nofollow\">https://www.npmjs.com/package/socket-model</a> here the npm package for that.</p>\n"}], "owner": {"reputation": 5360, "user_id": 2147188, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/WBpQ5.jpg?s=128&g=1", "display_name": "karthick", "link": "https://stackoverflow.com/users/2147188/karthick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1423206829, "creation_date": 1422528007, "last_edit_date": 1592644375, "question_id": 28212586, "link": "https://stackoverflow.com/questions/28212586/what-is-the-disadvantage-of-using-socket-io-to-conenct-nodejs-server-and-golang", "title": "What is the disadvantage of using socket.io to conenct nodejs server and golang server?", "body": "<p>I am working on web application which includes visualization - pie, bar, grid etc.</p>\n<h3>Note:</h3>\n<p>Application includes</p>\n<ol>\n<li><p>Two technologies <code>nodejs</code> and <code>golang</code>.</p>\n</li>\n<li><p>Nodejs is used for performing simple operations, routing, validation etc.</p>\n</li>\n<li><p>Golang is used for db connection, processing data, etc.</p>\n</li>\n</ol>\n<h3>Architecture/ Flow:</h3>\n<ol>\n<li><p>Client(angularjs) will communicate to <code>nodejs</code> server.</p>\n</li>\n<li><p><code>Nodejs</code> will talk to <code>golang</code> server using <code>socket.io</code> to get processed data.</p>\n</li>\n<li><p><code>Nodejs</code> will respond to client after getting processed data from golang.</p>\n</li>\n</ol>\n<p>Here is my question</p>\n<p>Is there any drawback of using socket.io in this case?</p>\n<p>Any suggestion or idea will be grateful.</p>\n"}, {"tags": ["python", "go", "rust", "docopt"], "comments": [{"owner": {"reputation": 10100, "user_id": 619216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c07104de771c3b6f6c30be8f592ef8f7?s=128&d=identicon&r=PG", "display_name": "BurntSushi5", "link": "https://stackoverflow.com/users/619216/burntsushi5"}, "edited": false, "score": 0, "creation_date": 1422539299, "post_id": 28210260, "comment_id": 44795903, "body": "Can you add more examples of what you want? It seems I may have misinterpreted your question."}, {"owner": {"reputation": 2244, "user_id": 664196, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bbfb56212931fc5d7e92867fb3bf3050?s=128&d=identicon&r=PG", "display_name": "jkgeyti", "link": "https://stackoverflow.com/users/664196/jkgeyti"}, "reply_to_user": {"reputation": 10100, "user_id": 619216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c07104de771c3b6f6c30be8f592ef8f7?s=128&d=identicon&r=PG", "display_name": "BurntSushi5", "link": "https://stackoverflow.com/users/619216/burntsushi5"}, "edited": false, "score": 0, "creation_date": 1422544174, "post_id": 28210260, "comment_id": 44799262, "body": "Sorry for the ambiguity. I&#39;ve edited my question, and hope it&#39;s clearer now."}, {"owner": {"reputation": 10100, "user_id": 619216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c07104de771c3b6f6c30be8f592ef8f7?s=128&d=identicon&r=PG", "display_name": "BurntSushi5", "link": "https://stackoverflow.com/users/619216/burntsushi5"}, "edited": false, "score": 1, "creation_date": 1422547445, "post_id": 28210260, "comment_id": 44801629, "body": "Neat request. Rust&#39;s Docopt does indeed drop this information on the floor. Unfortunately, I don&#39;t know if any other Docopt parser makes it available. I opened a new feature request: <a href=\"https://github.com/docopt/docopt.rs/issues/88\" rel=\"nofollow noreferrer\">github.com/docopt/docopt.rs/issues/88</a>"}, {"owner": {"reputation": 2244, "user_id": 664196, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bbfb56212931fc5d7e92867fb3bf3050?s=128&d=identicon&r=PG", "display_name": "jkgeyti", "link": "https://stackoverflow.com/users/664196/jkgeyti"}, "reply_to_user": {"reputation": 10100, "user_id": 619216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c07104de771c3b6f6c30be8f592ef8f7?s=128&d=identicon&r=PG", "display_name": "BurntSushi5", "link": "https://stackoverflow.com/users/619216/burntsushi5"}, "edited": false, "score": 1, "creation_date": 1422547875, "post_id": 28210260, "comment_id": 44801929, "body": "Cheers. I&#39;m not convinced adding &quot;non-standard&quot; features to any docopt parser is the right way to go, as the goal must be to have all docopt parsers to behave the same? Maybe some sort of functionality that allows the user to traverse/inspect the parsed docopt document would be the right way to go about it? Anyway, that&#39;s probably a discussion best left for the feature request."}, {"owner": {"reputation": 10100, "user_id": 619216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c07104de771c3b6f6c30be8f592ef8f7?s=128&d=identicon&r=PG", "display_name": "BurntSushi5", "link": "https://stackoverflow.com/users/619216/burntsushi5"}, "edited": false, "score": 0, "creation_date": 1422549995, "post_id": 28210260, "comment_id": 44803312, "body": "I&#39;ve already added some &quot;non-standard&quot; features to docopt.rs. (It&#39;s a superset.) And there&#39;s some special functionality for type based decoding. I&#39;m not convinced either that adding special introspection features is worthwhile, but I figured I&#39;d file the issue anyway."}, {"owner": {"reputation": 2244, "user_id": 664196, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bbfb56212931fc5d7e92867fb3bf3050?s=128&d=identicon&r=PG", "display_name": "jkgeyti", "link": "https://stackoverflow.com/users/664196/jkgeyti"}, "reply_to_user": {"reputation": 10100, "user_id": 619216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c07104de771c3b6f6c30be8f592ef8f7?s=128&d=identicon&r=PG", "display_name": "BurntSushi5", "link": "https://stackoverflow.com/users/619216/burntsushi5"}, "edited": false, "score": 1, "creation_date": 1422616509, "post_id": 28210260, "comment_id": 44830990, "body": "Ah, didn&#39;t realise you were the author of the rust docopt library. Thanks for your good work - it&#39;s a neat library :)"}, {"owner": {"reputation": 3042, "user_id": 789308, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c02ac9795923a7eca30c73e9bbbabf4e?s=128&d=identicon&r=PG", "display_name": "con-f-use", "link": "https://stackoverflow.com/users/789308/con-f-use"}, "edited": false, "score": 0, "creation_date": 1424868374, "post_id": 28210260, "comment_id": 45725602, "body": "See <a href=\"https://github.com/docopt/docopt.rs/issues/88\" rel=\"nofollow noreferrer\">github.com/docopt/docopt.rs/issues/88</a>"}], "answers": [{"comments": [{"owner": {"reputation": 10100, "user_id": 619216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c07104de771c3b6f6c30be8f592ef8f7?s=128&d=identicon&r=PG", "display_name": "BurntSushi5", "link": "https://stackoverflow.com/users/619216/burntsushi5"}, "reply_to_user": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 0, "creation_date": 1422539267, "post_id": 28214541, "comment_id": 44795888, "body": "Maybe I misinterpreted the question? The OP just wants the string of the argument?"}, {"owner": {"reputation": 2244, "user_id": 664196, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bbfb56212931fc5d7e92867fb3bf3050?s=128&d=identicon&r=PG", "display_name": "jkgeyti", "link": "https://stackoverflow.com/users/664196/jkgeyti"}, "edited": false, "score": 0, "creation_date": 1422544278, "post_id": 28214541, "comment_id": 44799324, "body": "Yes, I think we mean the same thing. I am indeed looking for determine that the options are DIR and FILE. For future readers: Note that I&#39;ve simplified the original example, hence why BurntSushi5&#39;s example does not correspond 100% to the question."}], "tags": [], "owner": {"reputation": 10100, "user_id": 619216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c07104de771c3b6f6c30be8f592ef8f7?s=128&d=identicon&r=PG", "display_name": "BurntSushi5", "link": "https://stackoverflow.com/users/619216/burntsushi5"}, "is_accepted": false, "score": 1, "last_activity_date": 1422533738, "creation_date": 1422533738, "answer_id": 28214541, "question_id": 28210260, "link": "https://stackoverflow.com/questions/28210260/parsing-docopt-argument-types-any-language/28214541#28214541", "title": "Parsing docopt argument types (any language)", "body": "<p>This is pretty easy with <a href=\"https://github.com/docopt/docopt.rs\" rel=\"nofollow\">Rust's Docopt</a>:</p>\n\n<pre><code>#![allow(unstable)]\n\nextern crate docopt;\n\nuse docopt::Docopt;\n\nstatic USAGE: &amp;'static str = \"\nNaval Fate.\n\nUsage:\n    naval_fate ship --dir=FILE [--speed &lt;kn&gt;]\n    naval_fate (-h | --help)\n\nOptions:\n    -h --help     Show this screen.\n    --speed &lt;kn&gt;  Speed in knots [default: 10].\n    --dir=FILE    Moored (anchored) mine.\n\";\n\nfn main() {\n    let args = Docopt::new(USAGE)\n                      .and_then(|d| d.parse())\n                      .unwrap_or_else(|e| e.exit());\n    println!(\"Type of 'ship': {:?}\", args.find(\"ship\"));\n    println!(\"Type of '--dir': {:?}\", args.find(\"--dir\"));\n    println!(\"Type of '--speed': {:?}\", args.find(\"--speed\"));\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>$ ./target/scratch ship --dir /tmp --speed 1234                                        \nType of 'ship': Some(Switch(true))                                                                       \nType of '--dir': Some(Plain(Some(\"/tmp\")))                                                               \nType of '--speed': Some(Plain(Some(\"1234\"))) \n</code></pre>\n\n<p>The key is that the return type of <code>find</code> is <code>Value</code>, which is an algebraic data type: <a href=\"http://burntsushi.net/rustdoc/docopt/enum.Value.html\" rel=\"nofollow\">http://burntsushi.net/rustdoc/docopt/enum.Value.html</a> --- So by construction, you get the \"type\" of the argument for free.</p>\n\n<p>Note that this will work for any \"argument\" in the Docopt usage string, even if it isn't passed into the argument list.</p>\n"}], "owner": {"reputation": 2244, "user_id": 664196, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bbfb56212931fc5d7e92867fb3bf3050?s=128&d=identicon&r=PG", "display_name": "jkgeyti", "link": "https://stackoverflow.com/users/664196/jkgeyti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 767, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422544135, "creation_date": 1422520766, "last_edit_date": 1422544135, "question_id": 28210260, "link": "https://stackoverflow.com/questions/28210260/parsing-docopt-argument-types-any-language", "title": "Parsing docopt argument types (any language)", "body": "<p>I have a use case where users provide a docopt string, and based on it, I generate some code. So I do not know my docopt string up front.</p>\n\n<p>For certain \"argument types\" (not datatypes), I wish to generate various code. </p>\n\n<p>In the following, I will distinguish between \"types\" and \"datatypes\". For the docopt argument <code>--arg=DEGREES</code> and the argv input <code>--arg=10</code>, the \"type\" of <code>--arg</code> is <code>DEGREES</code>, while the datatype is <code>integer</code>. The value is <code>10</code>.</p>\n\n<p>A user may give me the following docopt string:</p>\n\n<pre><code>Naval Fate.\n\nUsage:\n  naval_fate --dir=FILE [--speed=ABC]\n\nOptions:\n  --dir=FILE   Moored (anchored) mine.\n  --speed=ABC  Speed in knots [default: 10].\n</code></pre>\n\n<p>Besides parsing this docopt string as usual, I'm trying to also figure out what \"type\" of argument <code>dir</code> and <code>speed</code> asks for. I want to know that <code>dir</code> is of type <code>FILE</code> and <code>speed</code> is of type <code>ABC</code>.</p>\n\n<p><strong>Example:</strong></p>\n\n<p>Given the above docopt string, and an argv string <code>naval_fate --dir=/tmp --speed 1234</code>, I hope to access not just the value and datatype (<code>&lt;key&gt; =&gt; &lt;value,datatype&gt;</code>), but also the \"config type\" (<code>&lt;key&gt; =&gt; &lt;value,datatype,argtype&gt;</code>, i.e. something along the lines of:</p>\n\n<p><code>dir</code> => val: <code>/tmp</code>, datatype: <code>String</code>, <strong>type: <code>FILE</code></strong><br>\n<code>speed</code> => val: <code>1234</code>, datatype: <code>Integer</code>, <strong>type: <code>ABC</code></strong></p>\n\n<p>Any (managed) implementation of docopt is acceptable, including Python's, though preferably I'm looking for a solution in a compiled language, be it C, Go, Rust etc.</p>\n"}, {"tags": ["facebook", "testing", "go", "mocking"], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 4355808, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/923d0110163e64321ac5fb406bcbdb97?s=128&d=identicon&r=PG&f=1", "display_name": "lucas", "link": "https://stackoverflow.com/users/4355808/lucas"}, "edited": false, "score": 0, "creation_date": 1422753544, "post_id": 28229830, "comment_id": 44874824, "body": "I will get an interface conversion panic if I were to add <code>fbI.Session(&quot;asdf&quot;)</code> to the <code>Facebook</code> function."}, {"owner": {"reputation": 357, "user_id": 4355808, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/923d0110163e64321ac5fb406bcbdb97?s=128&d=identicon&r=PG&f=1", "display_name": "lucas", "link": "https://stackoverflow.com/users/4355808/lucas"}, "edited": false, "score": 0, "creation_date": 1422758848, "post_id": 28229830, "comment_id": 44875646, "body": "the code formatting isn&#39;t very good but here it is. <code>func main() { \tFacebook(&amp;MyFbApp{}) }  func Facebook(fbI IFbApp) { \tfbI.ExchangeToken(&quot;sometokenhere&quot;) \tfbI.Session(&quot;blah&quot;) }</code>"}, {"owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "reply_to_user": {"reputation": 357, "user_id": 4355808, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/923d0110163e64321ac5fb406bcbdb97?s=128&d=identicon&r=PG&f=1", "display_name": "lucas", "link": "https://stackoverflow.com/users/4355808/lucas"}, "edited": false, "score": 0, "creation_date": 1422765268, "post_id": 28229830, "comment_id": 44876654, "body": "@lucas Yes, you are right, this won&#39;t work. Then the solution could be to implement a wrapper for fb.App, see updated answer."}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1422780062, "post_id": 28229830, "comment_id": 44879024, "body": "Plus one. This is an example of the <a href=\"https://en.wikipedia.org/wiki/Facade_pattern\" rel=\"nofollow noreferrer\">fa&#231;ade pattern</a>."}], "tags": [], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "is_accepted": true, "score": 1, "last_activity_date": 1422765234, "last_edit_date": 1422765234, "creation_date": 1422596109, "answer_id": 28229830, "question_id": 28209358, "link": "https://stackoverflow.com/questions/28209358/testing-3rd-party-package-in-golang/28229830#28229830", "title": "Testing 3rd party package in golang", "body": "<p>You can implement a wrapper for fb.App and override Session method to return IFbSession instead of Facebook.Session.</p>\n\n<pre><code>package main\n\nimport fb \"github.com/huandu/facebook\"\n\ntype IFbApp interface {\n    ExchangeToken(string) (string, int, error)\n    Session(string) IFbSession\n}\n\ntype MockFbApp struct {\n    IFbApp\n}\n\nfunc (myFbApp *MockFbApp) ExchangeToken(token string) (string, int, error) {\n    return \"exchangetoken\", 1, nil\n}\n\nfunc (myFbApp *MockFbApp) Session(token string) IFbSession {\n    return &amp;MyFbSession{}\n}\n\ntype IFbSession interface {\n    User() (string, error)\n    Get(string, fb.Params) (fb.Result, error)\n}\n\ntype MyFbSession struct {\n    IFbSession\n}\n\nfunc (myFbSession *MyFbSession) User() (string, error) {\n    return \"userid\", nil\n}\n\nfunc (myFbSession *MyFbSession) Get(path string, params fb.Params) (fb.Result, error) {\n    return fb.Result{}, nil\n}\n\ntype RealApp struct {\n    *fb.App\n}\n\nfunc (myFbApp *RealApp) Session(token string) IFbSession {\n    return myFbApp.App.Session(token)\n}\n\nfunc SomeMethod() {\n    Facebook(&amp;MockFbApp{})\n    Facebook(&amp;RealApp{fb.New(\"appId\", \"appSecret\")})\n}\n\nfunc Facebook(fbI IFbApp) {\n    fbI.ExchangeToken(\"sometokenhere\")\n    fbI.Session(\"session\")\n}\n\nfunc main() {\n    SomeMethod()\n}\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 4355808, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/923d0110163e64321ac5fb406bcbdb97?s=128&d=identicon&r=PG&f=1", "display_name": "lucas", "link": "https://stackoverflow.com/users/4355808/lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 28229830, "answer_count": 1, "score": 1, "last_activity_date": 1422765234, "creation_date": 1422517404, "last_edit_date": 1422545325, "question_id": 28209358, "link": "https://stackoverflow.com/questions/28209358/testing-3rd-party-package-in-golang", "title": "Testing 3rd party package in golang", "body": "<p>I'm new to golang and trying to write a simple learning app using the facebook package from <a href=\"https://github.com/huandu/facebook\" rel=\"nofollow\">https://github.com/huandu/facebook</a>.</p>\n\n<p>I was able to get the package and connect to facebook and hit the facebook API. This is great but testing is my concern.</p>\n\n<p>At first I was simply calling the method and creating a facebook object inside of it. Then after some research I tried passing in the facebook method I wanted to mock. Realizing there were multiple methods I needed, I am convinced that passing an interface is the right way to go.</p>\n\n<p>So I tried creating interfaces that the package would implement.</p>\n\n<pre><code>type IFbApp interface {\n    ExchangeToken(string) (string, int, error)\n    Session(string) IFbSession\n}\n\ntype MyFbApp struct{}\n\nfunc (myFbApp *MyFbApp) ExchangeToken(token string) (string, int, error) {\n    return myFbApp.ExchangeToken(token)\n}\n\nfunc (myFbApp *MyFbApp) Session(token string) IFbSession {\n    return myFbApp.Session(token)\n}\n\ntype IFbSession interface {\n    User() (string, error)\n    Get(string, map[string]interface{}) (map[string]interface{}, error)\n}\n\ntype MyFbSession struct{}\nfunc (myFbSession *MyFbSession) User() (string, error) {\n    return myFbSession.User()\n}\n\nfunc (myFbSession *MyFbSession) Get(path string, params map[string]string) (map[string]string, error) {\n    return myFbSession.Get(path, params)\n}\n\nfunc SomeMethod() {\n    Facebook(fb.New(\"appId\", \"appSecret\")); // fb calls package\n}\n\nfunc Facebook(fbI IFbApp) {\n    fbI.ExchangeToken(\"sometokenhere\");\n}\n</code></pre>\n\n<p>I cannot compile this code since I get an error </p>\n\n<pre><code>cannot use facebook.New(\"appId\", \"appSecret\") (type *facebook.App) as type IFbApp in argument to Facebook:\n    *facebook.App does not implement IFbApp (wrong type for Session method)\n        have Session(string) *facebook.Session\n        want Session(string) IFbSession\n</code></pre>\n\n<p>Switching IFbSession to *facebook.Session would make it compile of course but then I need to mock methods from the Session struct as well.</p>\n\n<p>My plan was to create mock structs that implement my interfaces in my test.go file and pass it to the methods under test. Is this the right way to go?</p>\n\n<p>I'd like to stay pure golang as much as possible and stay away from mocking frameworks.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "filepath"], "comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 3, "creation_date": 1422517399, "post_id": 28209006, "comment_id": 44783329, "body": "Running <code>go fmt</code> on this piece of code would make it a bit easier for us to read it. You can do that in the <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">playground</a> as well.  \u2013 And it would also help to create an MCVE (see <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> )"}, {"owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "reply_to_user": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1422517550, "post_id": 28209006, "comment_id": 44783402, "body": "Sorry for the formatting error. Here it is on the playground <a href=\"https://play.golang.org/p/G8cUb6fZC9\" rel=\"nofollow noreferrer\">play.golang.org/p/G8cUb6fZC9</a>"}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 2, "creation_date": 1422517597, "post_id": 28209006, "comment_id": 44783430, "body": "you could edit your post - that makes it easier for the readers (then we don&#39;t have to follow a link)"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "reply_to_user": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 2, "creation_date": 1422518913, "post_id": 28209006, "comment_id": 44784079, "body": "Deliri, can you make an MCVE as @topskip mentions?  That is, a minimal piece of code that exemplifies the same unexpected behaviour you&#39;re seeing.  For instance, I don&#39;t think all the option parsing, and dealing with &quot;-h&quot; to show help text, is necessary to reproduce the problem.  The less extraneous code one has to read, the easier it is for others to help you.  And that&#39;s in your best interest, isn&#39;t it?"}, {"owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1422519126, "post_id": 28209006, "comment_id": 44784191, "body": "I can definitely do that. The reason I left the whole nine yards is 2 fold. 1) It&#39;s directly from his book, this way we can be assured that there are no silly mistakes.  2) I had a previous experience where I tried to keep the code short but what ended up happening was, I was attacked for wanting answers without providing the full scope of the question. I guess I&#39;m learning what the middle ground looks like."}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 1, "creation_date": 1422519149, "post_id": 28209006, "comment_id": 44784200, "body": "Seems to me that you run main.go using <code>go run main.go</code>. Try to use <code>go build</code> and then run executable. Make sure that <code>british-american.txt</code> file is in the same directory\u044e"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 1, "creation_date": 1422519478, "post_id": 28209006, "comment_id": 44784333, "body": "It works without init function because in that function britishAmerican variable overrides with directory of executable"}], "answers": [{"tags": [], "owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "is_accepted": true, "score": 3, "last_activity_date": 1422521195, "last_edit_date": 1422521195, "creation_date": 1422519444, "answer_id": 28209906, "question_id": 28209006, "link": "https://stackoverflow.com/questions/28209006/filepaths-in-go/28209906#28209906", "title": "FilePaths in Go", "body": "<p>You change the variable <code>britishAmerican</code> in the init function. Without <code>init()</code>, the program looks in the current directory (no path given, only the file name). With <code>init()</code>, it looks in the path where the executable is (<code>os.Args[0]</code>).  And with <code>go run main.go</code>, the directory with the executable is not the current working directory.</p>\n\n<p>You should use <code>go build</code> to build the binary and then run it, or you should tell us what you want to achieve (as written by @RoninDev). </p>\n\n<hr>\n\n<p>The MCVE I've mentioned could look like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"path/filepath\"\n)\n\nvar filename = \"foo.txt\"\n\nfunc init() {\n    // change to true and things break\n    if false {\n        dir, _ := filepath.Split(os.Args[0])\n        filename = filepath.Join(dir, filename)\n    }\n}\n\nfunc main() {\n       // requires a file 'foo.txt' in the current directory\n    _, err := ioutil.ReadFile(filename)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>It can (of course) be even shorter, but this should be enough for the others in the community to see what is going on.</p>\n"}, {"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 2, "last_activity_date": 1422519486, "creation_date": 1422519486, "answer_id": 28209922, "question_id": 28209006, "link": "https://stackoverflow.com/questions/28209006/filepaths-in-go/28209922#28209922", "title": "FilePaths in Go", "body": "<p>It looks to me like the program is expecting a file called <code>british-american.txt</code> in the directory that the executable is in.</p>\n\n<p>That is what the code in <code>init()</code> does - it finds the path the the executable and constructs a path to the dictionary relative to that.</p>\n\n<p>I can see from your error message that you are using <code>go run</code> to run the code.  This makes a temporary executable in <code>/tmp</code> and runs that.  If you leave the <code>init()</code> code in then it will look for the dictionary in the <code>/tmp</code> directory and it won't find it.  If you take the <code>init()</code> code out it will look for the dictionary in the current directory and it will succeed.</p>\n\n<p>If you want to use it as the author intended then use <code>go build</code> to build a binary and then run it - that will work.</p>\n"}], "owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 1, "accepted_answer_id": 28209906, "answer_count": 2, "score": 0, "last_activity_date": 1422523633, "creation_date": 1422515952, "last_edit_date": 1422523633, "question_id": 28209006, "link": "https://stackoverflow.com/questions/28209006/filepaths-in-go", "title": "FilePaths in Go", "body": "<p>So this is the example from Programming in Go by Mark Summerfield.</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"io/ioutil\"\n\"os\"\n\"path/filepath\"\n\"strings\"\n)\n\nvar britishAmerican = \"british-american.txt\"\n\nfunc init() {\n    dir, _ := filepath.Split(os.Args[0])\n    britishAmerican = filepath.Join(dir, britishAmerican)\n}\n\nfunc main() {\n    rawBytes, err := ioutil.ReadFile(britishAmerican)\n    if err != nil {\n        fmt.Println(err)\n    }\n    text := string(rawBytes)\n\n    usForBritish := make(map[string]string)\n\n    lines := strings.Split(text, \"\\n\")\n    fmt.Println(lines)\n    for _, line := range lines {\n        fields := strings.Fields(line)\n        if len(fields) == 2 {\n            usForBritish[fields[0]] = fields[1]\n        }\n    }\n    fmt.Println(usForBritish)\n}\n</code></pre>\n\n<p>When I run this code with the init() func commented out, it works perfectly fine. If I leave it in I get this error:</p>\n\n<pre><code>open /var/folders/l6/rdqtyrfd303dw1cz8qvlfcvc0000gn/T/go-    build652175567/command-line-arguments/_obj/exe/british-american.txt: no     such file or directory exit status 1  \n</code></pre>\n\n<p>My question is, why does the <code>init()</code> func not grab the file from the appropriate directory?</p>\n"}, {"tags": ["go", "glog"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 4, "last_activity_date": 1422511938, "creation_date": 1422511938, "answer_id": 28208046, "question_id": 28207226, "link": "https://stackoverflow.com/questions/28207226/how-do-i-set-the-log-directory-of-glog-from-code/28208046#28208046", "title": "How do I set the log directory of glog from code", "body": "<p>The <a href=\"https://github.com/golang/glog\" rel=\"nofollow\">glog package</a> is a dump of the log package used inside Google. Google configures logging using command line flags and that's what the package supports.</p>\n\n<p>You should look to <a href=\"http://go-search.org/search?q=logging\" rel=\"nofollow\">another log package</a> or fork the package if you want to set the directory from code.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1422528617, "creation_date": 1422528617, "answer_id": 28212826, "question_id": 28207226, "link": "https://stackoverflow.com/questions/28207226/how-do-i-set-the-log-directory-of-glog-from-code/28212826#28212826", "title": "How do I set the log directory of glog from code", "body": "<p>Variable <code>logDir</code> really exist in glog package <a href=\"https://github.com/golang/glog/blob/master/glog_file.go#L41\" rel=\"nofollow\">https://github.com/golang/glog/blob/master/glog_file.go#L41</a>\nIt just not exported. So you can change it in source of your instance of glog. It's little hacky, but not hard.</p>\n"}, {"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1479640881, "post_id": 28214368, "comment_id": 68634893, "body": "I was wondering what these getter and setter methods were for.  Note that with this method (lacking a documentation) you can also print the value <code>glog.Info(&quot;Log level: &quot;, flag.Lookup(&quot;v&quot;).Value)</code>. Thank you very much. I don&#39;t think it&#39;s a hack. It is the intended use."}], "tags": [], "owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "is_accepted": true, "score": 20, "last_activity_date": 1422535449, "last_edit_date": 1422535449, "creation_date": 1422533137, "answer_id": 28214368, "question_id": 28207226, "link": "https://stackoverflow.com/questions/28207226/how-do-i-set-the-log-directory-of-glog-from-code/28214368#28214368", "title": "How do I set the log directory of glog from code", "body": "<p>This is a hack I have seen lying around: set the flags in code.\nAlso very good for setting log levels from code.</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n\n    \"github.com/golang/glog\"\n)\n\nfunc main() {\n    flag.Parse()\n    glog.Info(\"hi_a\")\n    flag.Lookup(\"logtostderr\").Value.Set(\"true\")\n    glog.Info(\"hi_b\")\n\n    flag.Lookup(\"log_dir\").Value.Set(\"/path/to/log/dir\")\n\n    glog.V(4).Info(\"v4a\")\n    flag.Lookup(\"v\").Value.Set(\"10\")\n    glog.V(4).Info(\"v4b\")\n    //etc.    \n}\n\n&gt;&gt;&gt; hi_b\n&gt;&gt;&gt; v4b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 841, "user_id": 5505164, "user_type": "registered", "profile_image": "https://graph.facebook.com/1483647971940832/picture?type=large", "display_name": "Roman Shishkin", "link": "https://stackoverflow.com/users/5505164/roman-shishkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1551051157, "creation_date": 1551051157, "answer_id": 54857621, "question_id": 28207226, "link": "https://stackoverflow.com/questions/28207226/how-do-i-set-the-log-directory-of-glog-from-code/54857621#54857621", "title": "How do I set the log directory of glog from code", "body": "<p>First of all <em>Glog</em> rely on the package <em>Flag</em>. If you will not import it, you will have annoying warning in log message.</p>\n\n<p>If you only need to set parameters one time in initialisation it is very easy.</p>\n\n<pre><code>flag.Set(\"logtostderr\", \"true\")\nflag.Parse()\nglog.Infof(\"starting main program\")\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 4505813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-n3veXotrBmY/AAAAAAAAAAI/AAAAAAAAABY/ghknmXRzyB0/photo.jpg?sz=128", "display_name": "zhou lin", "link": "https://stackoverflow.com/users/4505813/zhou-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10380, "favorite_count": 2, "accepted_answer_id": 28214368, "answer_count": 4, "score": 9, "last_activity_date": 1551051157, "creation_date": 1422507060, "last_edit_date": 1474459562, "question_id": 28207226, "link": "https://stackoverflow.com/questions/28207226/how-do-i-set-the-log-directory-of-glog-from-code", "title": "How do I set the log directory of glog from code", "body": "<p>Does anyone know how to set/modify the log dir in the golang source code?\nI want to set the log dir in the soure code, instead of <code>-log_dir=</code> in the cmdline</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14111, "user_id": 217019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ede807eedb7fe77242664741f91627f7?s=128&d=identicon&r=PG", "display_name": "Mateusz Dymczyk", "link": "https://stackoverflow.com/users/217019/mateusz-dymczyk"}, "edited": false, "score": 2, "creation_date": 1422506541, "post_id": 28207090, "comment_id": 44779405, "body": "unfortunately you&#39;d have to write your own version for uints as far as I&#39;m concerned"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1488147328, "post_id": 28207090, "comment_id": 72090186, "body": "<a href=\"https://mrekucci.blogspot.com/2015/07/dont-abuse-mathmax-mathmin.html\" rel=\"nofollow noreferrer\">Don&#39;t abuse math.Max / math.Min</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "edited": false, "score": 35, "creation_date": 1422507862, "post_id": 28207228, "comment_id": 44779766, "body": "really stupid design about this. A generic max() function is not a luxury to have.....in my opinion. anyway. Thanks James."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "edited": false, "score": 1, "creation_date": 1422508421, "post_id": 28207228, "comment_id": 44779957, "body": "Well when Go gets some form of generics, perhaps we&#39;ll see one."}, {"owner": {"reputation": 867, "user_id": 764516, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e9c6eb568d8f822119773908a236ebbc?s=128&d=identicon&r=PG", "display_name": "thinkhy", "link": "https://stackoverflow.com/users/764516/thinkhy"}, "edited": false, "score": 4, "creation_date": 1461934438, "post_id": 28207228, "comment_id": 61436780, "body": "It&#39;s a shame that Golang as a MODERN programelanguage doesn&#39;t support generics."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 11, "last_activity_date": 1422507083, "creation_date": 1422507083, "answer_id": 28207228, "question_id": 28207090, "link": "https://stackoverflow.com/questions/28207090/golang-what-is-the-right-way-to-use-math-max-on-two-uint-values/28207228#28207228", "title": "golang what is the right way to use math.max on two uint values?", "body": "<p>The main reason <code>math.Max</code> exists is to ensure some of the special cases of IEEE floating point are handled correctly (positive and negative infinity, <code>NaN</code> and signed zeroes).</p>\n\n<p>These issues are not relevant for simple integers, so you may as well just use the obvious implementation.  Something like:</p>\n\n<pre><code>if args.Viewnum+1 &gt; vs.curView.Viewnum {\n    vs.curView.Viewnum = args.Viewnum+1\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 12637653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QphxFOh-dPc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNf6Jw1cTdmELyEbCmdL74Far5jQ/photo.jpg?sz=128", "display_name": "LoveRick", "link": "https://stackoverflow.com/users/12637653/loverick"}, "is_accepted": false, "score": 0, "last_activity_date": 1578144057, "last_edit_date": 1578144057, "creation_date": 1578142650, "answer_id": 59590863, "question_id": 28207090, "link": "https://stackoverflow.com/questions/28207090/golang-what-is-the-right-way-to-use-math-max-on-two-uint-values/59590863#59590863", "title": "golang what is the right way to use math.max on two uint values?", "body": "<p>Though the question is old, maybe <a href=\"https://github.com/adam-lavrik/go-imath\" rel=\"nofollow noreferrer\">this package</a>  will save someone's time and efforts. It is obtainable via <code>go get</code> and importing by URL, as usual.</p>\n\n<p>Usage:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"fmt\"\n    \"&lt;Full URL&gt;/go-imath/ix\" // Functions for int type\n)\n...\nfmt.Println(ix.Max(100, 152)) // Output: 152\nfmt.Println(ix.Maxs(234, 55, 180)) // Output: 234\nfmt.Println(ix.MaxSlice([]int{2, 29, 8, -1})) // Output: 29\n</code></pre>\n"}], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12090, "favorite_count": 1, "accepted_answer_id": 28207228, "answer_count": 2, "score": 10, "last_activity_date": 1578144057, "creation_date": 1422506233, "last_edit_date": 1542139149, "question_id": 28207090, "link": "https://stackoverflow.com/questions/28207090/golang-what-is-the-right-way-to-use-math-max-on-two-uint-values", "title": "golang what is the right way to use math.max on two uint values?", "body": "<p>This is what I do, it is extremely ugly.</p>\n\n<p>What is the right way to use <code>math.Max</code> for 2 uint s?</p>\n\n<pre><code>vs.curView.Viewnum =uint(math.Max(float64(args.Viewnum+1), float64(vs.curView.Viewnum)))\n</code></pre>\n"}, {"tags": ["function", "types", "go"], "answers": [{"comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 1, "creation_date": 1422520433, "post_id": 28204889, "comment_id": 44784781, "body": "More than it being part of the compiler: it&#39;s hard-coded in as part of the language specification.  <a href=\"https://golang.org/ref/spec#Length_and_capacity\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Length_and_capacity</a>  <a href=\"https://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Making_slices_maps_and_channels</a>"}, {"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "edited": false, "score": 2, "creation_date": 1422543090, "post_id": 28204889, "comment_id": 44798467, "body": "len is also the only &quot;function&quot; capable of returning a const (when used on arrays). The spec gives built-ins special powers we mere mortal programmers cannot match."}, {"owner": {"reputation": 9345, "user_id": 4237316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/100004533998341/picture?type=large", "display_name": "Harald Nordgren", "link": "https://stackoverflow.com/users/4237316/harald-nordgren"}, "edited": false, "score": 2, "creation_date": 1493548127, "post_id": 28204889, "comment_id": 74455195, "body": "Is there a link to the exact place where <code>len</code> is actually implemented?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 9345, "user_id": 4237316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/100004533998341/picture?type=large", "display_name": "Harald Nordgren", "link": "https://stackoverflow.com/users/4237316/harald-nordgren"}, "edited": false, "score": 0, "creation_date": 1550990186, "post_id": 28204889, "comment_id": 96471080, "body": "@HaraldNordgren The len function on a slice gets the <a href=\"https://godoc.org/reflect#SliceHeader.Len\" rel=\"nofollow noreferrer\">length value from the slice header</a>.  The function is compiled to a field access."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 16, "last_activity_date": 1422541963, "last_edit_date": 1422541963, "creation_date": 1422490425, "answer_id": 28204889, "question_id": 28204831, "link": "https://stackoverflow.com/questions/28204831/golang-how-do-gos-len-and-make-functions-work/28204889#28204889", "title": "Golang: How do go&#39;s len() and make() functions work?", "body": "<p>The <code>len</code> and <code>make</code> functions are part of the language specification and built-in to the compiler. Runtime support for built-in functions is in the <a href=\"http://golang.org/src/runtime/\" rel=\"noreferrer\">runtime package</a>.</p>\n\n<p>The file <a href=\"https://golang.org/src/builtin/builtin.go\" rel=\"noreferrer\">builtin.go</a> is used for documentation only. It's not compiled.</p>\n"}, {"tags": [], "owner": {"reputation": 11711, "user_id": 1018582, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18789a2f20eee6dfe637fef8bd7ebf5?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1018582/alasdair"}, "is_accepted": false, "score": 1, "last_activity_date": 1422507508, "creation_date": 1422507508, "answer_id": 28207312, "question_id": 28204831, "link": "https://stackoverflow.com/questions/28204831/golang-how-do-gos-len-and-make-functions-work/28207312#28207312", "title": "Golang: How do go&#39;s len() and make() functions work?", "body": "<p>Because of Go's strict types, the compiler always knows what type you are passing to the <code>len</code> function and so it goes to a different function for different types, which can be determined at compile-time. In most cases you are attempting to get the length of a slice, in which case the <code>len</code> function only need return the <code>len</code> field for that slice's struct (since a slice is really a struct); same for a string.</p>\n\n<p>Compilers have all kinds of tricks, the assembly code generated by the compiler rarely follows the exact same logic you typed.</p>\n"}], "owner": {"reputation": 131, "user_id": 3803704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1eKg.jpg?s=128&g=1", "display_name": "Jay Crumb", "link": "https://stackoverflow.com/users/3803704/jay-crumb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4853, "favorite_count": 4, "accepted_answer_id": 28204889, "answer_count": 2, "score": 9, "last_activity_date": 1422541963, "creation_date": 1422490046, "last_edit_date": 1422490255, "question_id": 28204831, "link": "https://stackoverflow.com/questions/28204831/golang-how-do-gos-len-and-make-functions-work", "title": "Golang: How do go&#39;s len() and make() functions work?", "body": "<p>How do go's <code>len()</code> and <code>make()</code> functions work? Since the language lacks support for both generics and function overloading I don't see how <code>func len(v Type) int</code> is possible. The same goes for <code>func make(Type, size IntegerType) Type</code>.</p>\n\n<p>I can't seem to find the function in the go source, the closest I've managed to find is <a href=\"https://golang.org/src/builtin/builtin.go\" rel=\"noreferrer\">this</a></p>\n"}]