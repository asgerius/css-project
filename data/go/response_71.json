[{"tags": ["go", "package"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1463617654, "post_id": 37310980, "comment_id": 62144998, "body": "Read (or re-read) through <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> which will explain everything in more detail."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1463637687, "post_id": 37310980, "comment_id": 62150211, "body": "Please note that the errors read &quot;imported and not used&quot; so the import kinda worked but you did not use any symbol of package pack1. This relates to the next error &quot;undefined: Logger&quot;: If <code>Logger</code> lives in package pack1 than you reference it from any other package as <code>pack1.Logger</code>. Re-read &quot;How to Write Go Code&quot; and take a look at some working packages online."}, {"owner": {"reputation": 690, "user_id": 2642983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iewWA.png?s=128&g=1", "display_name": "Roberto Milani", "link": "https://stackoverflow.com/users/2642983/roberto-milani"}, "edited": false, "score": 0, "creation_date": 1463688405, "post_id": 37310980, "comment_id": 62184198, "body": "Thanks guys for the answer, now I&#39;ve understood how to import packages in the right way! This way it&#39;s also easier! I have one last question: I still can&#39;t compile the project: inside Router.go there&#39;s an instance of Logger so in Router.go I&#39;ve imported the package &quot;pack1&quot; but it says that Logger is undefined :\\ where am I doing wrong?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463689131, "post_id": 37310980, "comment_id": 62184575, "body": "@RobertoMilani: please show an example of your code that causes the error. You either need to qualify the identifier with the package name, or you&#39;re not defining things where you think you are."}, {"owner": {"reputation": 690, "user_id": 2642983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iewWA.png?s=128&g=1", "display_name": "Roberto Milani", "link": "https://stackoverflow.com/users/2642983/roberto-milani"}, "edited": false, "score": 0, "creation_date": 1463689819, "post_id": 37310980, "comment_id": 62184929, "body": "Sure! This is Router.go in package &quot;router&quot; (<a href=\"http://pastebin.com/P9uTRedF\" rel=\"nofollow noreferrer\">pastebin.com/P9uTRedF</a>) and this is Logger in package &quot;pack1&quot; (<a href=\"http://pastebin.com/STWRMZFs\" rel=\"nofollow noreferrer\">pastebin.com/STWRMZFs</a>). Thanks m8"}, {"owner": {"reputation": 690, "user_id": 2642983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iewWA.png?s=128&g=1", "display_name": "Roberto Milani", "link": "https://stackoverflow.com/users/2642983/roberto-milani"}, "edited": false, "score": 0, "creation_date": 1463729968, "post_id": 37310980, "comment_id": 62198357, "body": "Problem solved. I forget to put the package name before the classname. Thanks for all man!"}], "answers": [{"comments": [{"owner": {"reputation": 690, "user_id": 2642983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iewWA.png?s=128&g=1", "display_name": "Roberto Milani", "link": "https://stackoverflow.com/users/2642983/roberto-milani"}, "edited": false, "score": 0, "creation_date": 1463689095, "post_id": 37312084, "comment_id": 62184558, "body": "Thanks man! Now I have understood and all my imports are ok! :) And if from Router.go I call a function that is defined in a .go file inside pack1, what can I do? I&#39;ve imported pack1 from Router.go but when I try to &quot;go install&quot; it says that the function is undefined... :\\ Thanks in advance"}, {"owner": {"reputation": 690, "user_id": 2642983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iewWA.png?s=128&g=1", "display_name": "Roberto Milani", "link": "https://stackoverflow.com/users/2642983/roberto-milani"}, "edited": false, "score": 0, "creation_date": 1463730029, "post_id": 37312084, "comment_id": 62198383, "body": "Problem solved, the package name was missing before when I use a class from a different package."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1463621680, "last_edit_date": 1463621680, "creation_date": 1463617587, "answer_id": 37312084, "question_id": 37310980, "link": "https://stackoverflow.com/questions/37310980/packages-layout-with-relative-paths/37312084#37312084", "title": "Packages layout with relative paths", "body": "<p>The reason you're not supposed to use relative imports is that they don't work inside of <code>$GOPATH</code>. Get rid of the \"relative\" part of your import paths, since all imports are relative to <code>$GOPATH/src</code></p>\n\n<pre><code>import (\n    \"pack1\"\n    \"router\"\n)\n</code></pre>\n\n<p>You will also want to move your <code>Main.go</code> into a package as well, so you you can make full use of the go tools.</p>\n"}, {"tags": [], "owner": {"reputation": 760, "user_id": 2578506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0cbfd564375424ce1304a84c256078?s=128&d=identicon&r=PG", "display_name": "factotum", "link": "https://stackoverflow.com/users/2578506/factotum"}, "is_accepted": false, "score": 0, "last_activity_date": 1463669340, "creation_date": 1463669340, "answer_id": 37326818, "question_id": 37310980, "link": "https://stackoverflow.com/questions/37310980/packages-layout-with-relative-paths/37326818#37326818", "title": "Packages layout with relative paths", "body": "<p>As JimB says, read through the 'How to write go code' link, specifically <a href=\"https://golang.org/doc/code.html#ImportPaths\" rel=\"nofollow\">https://golang.org/doc/code.html#ImportPaths</a> </p>\n\n<ul>\n<li>All packages exist inside a directory tree starting at $GOPATH/src.</li>\n<li>Import path is effectively the full path to the package (from 1)</li>\n<li>There are no sub packages in GO. </li>\n<li>main packages are used to create commands</li>\n</ul>\n\n<p>So in your case, your import paths will be \"pack1\" and \"router\"</p>\n"}], "owner": {"reputation": 690, "user_id": 2642983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iewWA.png?s=128&g=1", "display_name": "Roberto Milani", "link": "https://stackoverflow.com/users/2642983/roberto-milani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1450, "favorite_count": 0, "closed_date": 1582491243, "accepted_answer_id": 37312084, "answer_count": 2, "score": 0, "last_activity_date": 1582491215, "creation_date": 1463609732, "last_edit_date": 1582491215, "question_id": 37310980, "link": "https://stackoverflow.com/questions/37310980/packages-layout-with-relative-paths", "closed_reason": "Duplicate", "title": "Packages layout with relative paths", "body": "<p>I'm learning Go and I've made this example:\n<a href=\"http://thenewstack.io/make-a-restful-json-api-go/\" rel=\"nofollow noreferrer\">http://thenewstack.io/make-a-restful-json-api-go/</a>\nto build a simple REST API.</p>\n\n<p>I've compiled it and all works fine but all sources are in the main package.</p>\n\n<p>Now I want to organize my .go files in packages, so I move them into some folders this way:</p>\n\n<pre><code>GOPATH\\bin\nGOPATH\\pkg\nGOPATH\\src\\pack1\\Handlers.go\nGOPATH\\src\\pack1\\Logger.go\nGOPATH\\src\\pack1\\repo.go\nGOPATH\\src\\pack1\\Todo.go\nGOPATH\\src\\router\\Router.go\nGOPATH\\src\\router\\Routes.go\nGOPATH\\src\\Main.go\n</code></pre>\n\n<p>Main.go uses all the router package so I've put in the import section:\n\"./router\".\nRouter.go uses the pack1 package, so in Router.go I've imported \"../pack1\".\nNow if I try to \"go build Main.go\" I get:</p>\n\n<pre><code>router\\Router.go:6: imported and not used: \"_/D_/GOPATH/src/pack1\"\nrouter\\Router.go:14: undefined: Logger\n</code></pre>\n\n<p>and similar errors, so seems that the import of pack1 package that I've made, it's wrong. Of course in all files belonging to pack1, in the header I've put the \"package pack1\" definition.</p>\n\n<p>I've also read that the relative imports are not suggested in Go and it could be useful to use the remote packages such ad importing \"github.com/myrepo/mypackage\".\nBut I dont want to use remote imports; I want to push all my files in a second moment. </p>\n\n<p>Could you help me to better understand what is the way to have local imports between packages in Go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1463610079, "post_id": 37310931, "comment_id": 62143035, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28227095/go-multiple-value-in-single-value-context\">Go: multiple value in single-value context</a>"}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1463610359, "post_id": 37310931, "comment_id": 62143143, "body": "Nope, in my question I do not want to ignore the err or predefine behavior - I want to apply a modification over one of the returned values ... but the solution is similar, I just need to create helper function. I am sorry - I am new to golang."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1463611243, "creation_date": 1463611243, "answer_id": 37311226, "question_id": 37310931, "link": "https://stackoverflow.com/questions/37310931/golang-can-i-apply-helper-function-to-one-of-the-returned-arguments/37311226#37311226", "title": "golang: Can I apply helper function to one of the returned arguments", "body": "<p>You cannot combine those two statements because the function returns a pair of values and there is no way to state which of them you would like to do the type assertion on. With the assignment it works because the identifiers are ordered as are the the return values, but how do you expect the compiler to infer which value you'd like to execute the type assertion on?</p>\n\n<p>I wouldn't recommend trying to reduce your code too much in Go. It's not really consistent with how the language is designed and I believe that is deliberate. The philosophy is that this is easier to read because there isn't much abstraction and also because you're not given so many options to achieve the same result. Anyway, you wouldn't really be saving much with that type assertion and any function call like this requires a few additional lines of code for error handling. It's pretty much the norm in Go.</p>\n"}, {"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": -1, "last_activity_date": 1463620061, "creation_date": 1463620061, "answer_id": 37312356, "question_id": 37310931, "link": "https://stackoverflow.com/questions/37310931/golang-can-i-apply-helper-function-to-one-of-the-returned-arguments/37312356#37312356", "title": "golang: Can I apply helper function to one of the returned arguments", "body": "<p>a solution in some kind. not reduce the code, but reduce variables in out function scope, by moving it to a anonymous inner function.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype t struct{}\n\nfunc foo()(interface{},error){\n    return &amp;t{},nil\n}\n\nfunc main() {\n    var myT *t\n    myT, err := func() (*t,error){\n        i,e:=foo()\n        return i.(*t),e\n    }()\n    fmt.Println(myT,err)\n}\n</code></pre>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 37311226, "answer_count": 2, "score": -1, "last_activity_date": 1463620061, "creation_date": 1463609439, "question_id": 37310931, "link": "https://stackoverflow.com/questions/37310931/golang-can-i-apply-helper-function-to-one-of-the-returned-arguments", "title": "golang: Can I apply helper function to one of the returned arguments", "body": "<p>Let say that I have </p>\n\n<pre><code>connection := pool.GetConnection().(*DummyConnection)\n</code></pre>\n\n<p>where <code>pool.GetConnection</code> returns <code>interface{}</code> and I would like to cast it to <code>DummyConnection</code>.</p>\n\n<p>I would like to change the GetConnection interface to return error. The code starts looking like this:</p>\n\n<pre><code>connectionInterface, err := pool.GetConnection()\nconnection := connectionInterface.(*DummyConnection)\n</code></pre>\n\n<p>I am wondering, can I avoid the need of helper variable and have these on a single line?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2325, "user_id": 2272638, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c4d7d86231ea02341f3a868d9d3f8c5?s=128&d=identicon&r=PG", "display_name": "dwanderson", "link": "https://stackoverflow.com/users/2272638/dwanderson"}, "edited": false, "score": 0, "creation_date": 1463589799, "post_id": 37305427, "comment_id": 62132790, "body": "Looks like that&#39;s not the way to go about it, according to <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">this blog post</a> - arguments are always computed when it encounters the <code>defer</code> statement. Still thinking if there&#39;s a different way to achieve what you want."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1463590535, "post_id": 37305427, "comment_id": 62133199, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31404471/defer-usage-clarification\">Defer usage clarification</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1463598731, "post_id": 37305699, "comment_id": 62137685, "body": "What happens if the last line where <code>errors.New(&quot;error 2&quot;)</code> is assigned to <code>err</code> is never reached i.e. a panic occurs beforehand and triggers the deferred function before it?"}, {"owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "edited": false, "score": 1, "creation_date": 1463602065, "post_id": 37305699, "comment_id": 62139455, "body": "It would print &quot;error 1&quot; because that&#39;s the last value given before &quot;error 2&quot;.  The defer func is pulling the value for err from the scope of main, so it will use the last value assigned."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1463614369, "post_id": 37305699, "comment_id": 62144219, "body": "Exactly, that&#39;s why I asked. In such case, should the intended error value be injected into the deferred function then?"}, {"owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "edited": false, "score": 0, "creation_date": 1463614627, "post_id": 37305699, "comment_id": 62144266, "body": "That depends on what you&#39;re trying to accomplish.  If you assign the err to the defer func at the point it&#39;s declared then it&#39;s going to use it&#39;s current value see here <a href=\"https://play.golang.org/p/CpOpobmlyp\" rel=\"nofollow noreferrer\">play.golang.org/p/CpOpobmlyp</a>.  So you&#39;d be back to square one in the original question."}], "tags": [], "owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "is_accepted": false, "score": 9, "last_activity_date": 1463590138, "creation_date": 1463590138, "answer_id": 37305699, "question_id": 37305427, "link": "https://stackoverflow.com/questions/37305427/how-to-dynamically-set-a-variable-in-a-defer-call/37305699#37305699", "title": "How to dynamically set a variable in a defer call", "body": "<p>err is already defined when you set the defer so what you what you likely want to do is wrap it in a func like below. Hope this helps.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\nfunc main() {\n    err := errors.New(\"error 1\")\n\n    defer func() {\n      fmt.Println(err)\n    }()\n\n    err = errors.New(\"error 2\")\n}\n</code></pre>\n"}], "owner": {"reputation": 13300, "user_id": 2521225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39c72c6dc4d20a8e736f8ed0d08fa646?s=128&d=identicon&r=PG&f=1", "display_name": "samol", "link": "https://stackoverflow.com/users/2521225/samol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1463590138, "creation_date": 1463589322, "question_id": 37305427, "link": "https://stackoverflow.com/questions/37305427/how-to-dynamically-set-a-variable-in-a-defer-call", "title": "How to dynamically set a variable in a defer call", "body": "<p>Example code:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\nfunc main() {\n    err := errors.New(\"error 1\")\n    defer fmt.Println(err)\n\n    err = errors.New(\"error 2\")\n}\n</code></pre>\n\n<p>In this case, I want fmt.Println to print out error 2.</p>\n"}, {"tags": ["json", "go", "unicode"], "comments": [{"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 3, "creation_date": 1463586309, "post_id": 37304152, "comment_id": 62130555, "body": "Does it truly matter? Both JSON files are valid and equivalent to each other. See <a href=\"http://ideone.com/e8Zipj\" rel=\"nofollow noreferrer\">ideone.com/e8Zipj</a>"}, {"owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1463587979, "post_id": 37304152, "comment_id": 62131671, "body": "@Rob\u1d69 good question, and probably not... Though I think your example only proves that the Python <code>json.loads</code> function loads it into an equivalent object representation. Printing out the raw JSON string certainly will give you different-looking things. I don&#39;t want API clients to notice that we switched representation format, and I wouldn&#39;t want any API clients in the wild to break because of our internal change. Who knows what they&#39;re doing :)"}], "answers": [{"comments": [{"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1463589689, "post_id": 37304153, "comment_id": 62132730, "body": "How about applying <code>QuoteToASCII()</code> after the marshaling?"}, {"owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1463590525, "post_id": 37304153, "comment_id": 62133193, "body": "@AlexanderTrakhimenok Applying <code>QuoteToASCII()</code> after marshaling will result in JSON-quotes also getting escaped, e.g. <code>&quot;{\\&quot;name\\&quot;:\\&quot;\\u4e09\\u676f\\u96de\\&quot;}&quot;</code>"}], "tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": true, "score": 2, "last_activity_date": 1463585639, "creation_date": 1463585639, "answer_id": 37304153, "question_id": 37304152, "link": "https://stackoverflow.com/questions/37304152/escape-unicode-characters-in-go-json-so-the-output-matches-python/37304153#37304153", "title": "Escape unicode characters in Go JSON so the output matches Python", "body": "<p>One solution is to use the <code>strconv.QuoteToASCII</code> method inside of a custom JSON marshaler:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strconv\"\n)\n\ntype Food struct {\n    Name utf8String `json:\"name\"`\n}\n\ntype utf8String string\n\nfunc (s utf8String) MarshalJSON() ([]byte, error) {\n    return []byte(strconv.QuoteToASCII(string(s))), nil\n}\n\nfunc main() {\n    food := Food{Name: utf8String(\"\u4e09\u676f\u96de\")}\n    v, _ := json.Marshal(food)\n    fmt.Println(string(v))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"name\":\"\\u4e09\\u676f\\u96de\"}\n</code></pre>\n\n<p>This has the drawback that you can't use a plain <code>string</code> type in the struct definition, but the final output is ASCII-quoted, just like in Python.</p>\n"}], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2432, "favorite_count": 1, "accepted_answer_id": 37304153, "answer_count": 1, "score": 2, "last_activity_date": 1463586081, "creation_date": 1463585639, "last_edit_date": 1463586081, "question_id": 37304152, "link": "https://stackoverflow.com/questions/37304152/escape-unicode-characters-in-go-json-so-the-output-matches-python", "title": "Escape unicode characters in Go JSON so the output matches Python", "body": "<p>In Python 2.7, if I encode JSON I get unicode-escaped strings:</p>\n\n<pre><code>&gt;&gt;&gt; import json\n&gt;&gt;&gt; s = {\"text\": \"\u4e09\u676f\u96de\"}\n&gt;&gt;&gt; print(json.dumps(s))\n</code></pre>\n\n<p>it gives this output:</p>\n\n<pre><code>{\"text\": \"\\u4e09\\u676f\\u96de\"}\n</code></pre>\n\n<p>But in Go, similar code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Food struct {\n    Name string `json:\"name\"`\n}\n\nfunc main() {\n    food := Food{Name: \"\u4e09\u676f\u96de\"}\n    v, _ := json.Marshal(food)\n    fmt.Println(string(v))\n}\n</code></pre>\n\n<p>Gives this:</p>\n\n<pre><code>{\"name\":\"\u4e09\u676f\u96de\"}\n</code></pre>\n\n<p>The Chinese characters are not escaped. I am porting API endpoints from Python to Go - how can I get it to have the same escaped output as Python?</p>\n\n<p>I tried variations using <code>strconv.QuoteToASCII</code>, but they result in the unicode being double-escaped:</p>\n\n<pre><code>func main() {\n    s := strconv.QuoteToASCII(\"\u4e09\u676f\u96de\")\n    s = strings.Trim(s, \"\\\"\")\n    food := Food{Name: s}\n    v, _ := json.Marshal(food)\n    fmt.Println(string(v))\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>{\"name\":\"\\\\u4e09\\\\u676f\\\\u96de\"}\n</code></pre>\n"}, {"tags": ["memory-management", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 448, "user_id": 6253321, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34792a0922a91eacb20efe6b49db95e4?s=128&d=identicon&r=PG&f=1", "display_name": "cpp beginner", "link": "https://stackoverflow.com/users/6253321/cpp-beginner"}, "edited": false, "score": 1, "creation_date": 1463583245, "post_id": 37302955, "comment_id": 62128272, "body": "My last 2 questions are not particularly clear I agree. I was trying to find out whether it&#39;s idiomatic to put a subslice of a slice in a variable for later use. It&#39;s kind of fragile to do so, because intermediate operations may or may not have changed the slice&#39;s elements."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 2, "last_activity_date": 1463582569, "creation_date": 1463582569, "answer_id": 37302955, "question_id": 37302419, "link": "https://stackoverflow.com/questions/37302419/growing-a-slice-while-keeping-its-subslice-around/37302955#37302955", "title": "Growing a slice while keeping its subslice around", "body": "<p>The doubling of the size of the underlying array is an implementation detail (and is no longer true once the size reaches a certain threshold in the current implementation). So you cannot rely on this to selectively change <code>b[0]</code> or not.</p>\n\n<p>Unfortunately I do not understand your last two questions. Nothing is wrong with subslicing and it does not depend on explicit (<code>a[i:k]</code>) or implicit start or stop indices (<code>a[i:]</code> or <code>a[:k]</code>) as this is totally the same. </p>\n"}, {"tags": [], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "is_accepted": true, "score": 1, "last_activity_date": 1463584797, "creation_date": 1463584797, "answer_id": 37303844, "question_id": 37302419, "link": "https://stackoverflow.com/questions/37302419/growing-a-slice-while-keeping-its-subslice-around/37303844#37303844", "title": "Growing a slice while keeping its subslice around", "body": "<p>You already know the answer.</p>\n\n<ul>\n<li>It is implementation dependent</li>\n<li>It is bad practice to sub-slice to a var if you are changing an underlying array/slice</li>\n<li>You better off to use sub-slicing explicitly whenever needed - it's cheap.</li>\n</ul>\n\n<p>Good question though. Thanks for sharing.</p>\n"}], "owner": {"reputation": 448, "user_id": 6253321, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34792a0922a91eacb20efe6b49db95e4?s=128&d=identicon&r=PG&f=1", "display_name": "cpp beginner", "link": "https://stackoverflow.com/users/6253321/cpp-beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 37303844, "answer_count": 2, "score": 1, "last_activity_date": 1463586091, "creation_date": 1463581304, "last_edit_date": 1463586091, "question_id": 37302419, "link": "https://stackoverflow.com/questions/37302419/growing-a-slice-while-keeping-its-subslice-around", "title": "Growing a slice while keeping its subslice around", "body": "<p>I have been experimenting with slices. Here is an example program</p>\n\n<pre><code>for n := 1; n &lt;= 10; n++ {\n    a := make([]int, 0)\n    for j := 0; j &lt; n; j++ {\n        a = append(a, 0)\n    }\n    b := a[:1]\n    a = append(a, 0)\n    a[0] = 1\n    fmt.Println(n, b[0])\n}\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>1 0\n2 0\n3 1\n4 0\n5 1\n6 1\n7 1\n8 0\n9 1\n10 1\n</code></pre>\n\n<p>I understand what is going on here. The line <code>a = append(a, 0)</code> allocates a new array if the old array has insufficient length, and the new array has twice the length as the original. Therefore if <code>n</code> is a power of 2, the line</p>\n\n<pre><code>a[0] = 1\n</code></pre>\n\n<p>will not change the array backed by <code>b</code> as a new array will have been allocated in the line before.</p>\n\n<p>However I could not find an explicit statement in the documentation that the newly allocated array always has twice the length. Does this mean that my code is implementation dependent? Is it bad practice to store a slice of another slice in a variable in this way, or should I just do <code>a[j:k]</code> every time a subslice is needed?</p>\n"}, {"tags": ["linux", "go", "build", "elf", "32-bit"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1463581092, "post_id": 37302211, "comment_id": 62126583, "body": "<code>GOOS=linux</code> and <code>GOARCH=386</code>."}, {"owner": {"reputation": 1783, "user_id": 111023, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3e1d07835c154af96cf3634020f1b063?s=128&d=identicon&r=PG", "display_name": "duganets", "link": "https://stackoverflow.com/users/111023/duganets"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1463581948, "post_id": 37302211, "comment_id": 62127227, "body": "thank you, misspelling env arg name had led to wrong binary :("}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1573044732, "last_edit_date": 1573044732, "creation_date": 1463582538, "answer_id": 37302937, "question_id": 37302211, "link": "https://stackoverflow.com/questions/37302211/how-can-i-build-for-linux-32-bit-with-go1-6-2/37302937#37302937", "title": "How can I build for linux 32-bit with go1.6.2", "body": "<p><code>GOOS=linux</code> and <code>GOARCH=386</code>.</p>\n\n<p>More examples: architecture:</p>\n\n<pre><code>32-bit -&gt; GOARCH=386\n64-bit -&gt; GOARCH=amd64\n</code></pre>\n\n<p>OS:</p>\n\n<pre><code>Windows -&gt; GOOS=windows\nLinux   -&gt; GOOS=linux \nOS X    -&gt; GOOS=darwin\nFreeBSD -&gt; GOOS=freebsd\n</code></pre>\n\n<p>For the complete list (valid \"individual\" values) refer to <a href=\"https://github.com/golang/go/blob/master/src/go/build/syslist.go\" rel=\"nofollow noreferrer\"><code>go/build/syslist.go</code></a> file:</p>\n\n<pre><code>const goosList = \"android darwin dragonfly freebsd linux nacl netbsd openbsd plan9 solaris windows \"\nconst goarchList = \"386 amd64 amd64p32 arm armbe arm64 arm64be ppc64 ppc64le mips mipsle mips64 mips64le mips64p32 mips64p32le ppc s390 s390x sparc sparc64 \"\n</code></pre>\n\n<p>Note that the above list is an ever-growing list, platforms not supported anymore are not removed (as that list is used for go/build filename matching).</p>\n\n<p>For the current list all supported platforms (GOOS/GOARCH combinations), use the following command:</p>\n\n<pre><code>go tool dist list\n</code></pre>\n\n<p>The valid combinations of <code>GOOS</code> + <code>GOARCH</code> (<a href=\"https://golang.org/doc/install/source#environment\" rel=\"nofollow noreferrer\">source</a>):</p>\n\n<pre><code>$GOOS   $GOARCH\ndarwin  386\ndarwin  amd64\ndarwin  arm\ndarwin  arm64\ndragonfly   amd64\nfreebsd 386\nfreebsd amd64\nfreebsd arm\nlinux   386\nlinux   amd64\nlinux   arm\nlinux   arm64\nlinux   ppc64\nlinux   ppc64le\nlinux   mips64\nlinux   mips64le\nnetbsd  386\nnetbsd  amd64\nnetbsd  arm\nopenbsd 386\nopenbsd amd64\nopenbsd arm\nplan9   386\nplan9   amd64\nsolaris amd64\nwindows 386\nwindows amd64\n</code></pre>\n"}], "owner": {"reputation": 1783, "user_id": 111023, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3e1d07835c154af96cf3634020f1b063?s=128&d=identicon&r=PG", "display_name": "duganets", "link": "https://stackoverflow.com/users/111023/duganets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3777, "favorite_count": 2, "accepted_answer_id": 37302937, "answer_count": 1, "score": 6, "last_activity_date": 1573044732, "creation_date": 1463580760, "last_edit_date": 1463583316, "question_id": 37302211, "link": "https://stackoverflow.com/questions/37302211/how-can-i-build-for-linux-32-bit-with-go1-6-2", "title": "How can I build for linux 32-bit with go1.6.2", "body": "<p>Is there any combination of <code>GOARCH</code> and <code>GOOS</code> values which I can set in order to build ELF 32-bit binary?</p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "edited": false, "score": 0, "creation_date": 1463577766, "post_id": 37300839, "comment_id": 62124110, "body": "Hmm I would not say you missunderstood, maybe I didn&#39;t tell right my problem ;) It&#39;s an API, so my struct is the answer for the client ok? this struct contain another struct which could be any struct type (a User, an Animal, a bank account, etc) so your answer is good for 50% of the problem ;) now, if we take your example, how can I make description as a random type? or interface type? to be able to put either a name or type or size, etc about the animal in question?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "edited": false, "score": 1, "creation_date": 1463577955, "post_id": 37300839, "comment_id": 62124266, "body": "Yes you can, I changed the type of Descr, and it works perfectly fine (see above). This way you can put anything into the field Descr."}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "edited": false, "score": 0, "creation_date": 1463578775, "post_id": 37300839, "comment_id": 62124837, "body": "Perfect ;) Thank !"}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 3, "last_activity_date": 1487938638, "last_edit_date": 1487938638, "creation_date": 1463577446, "answer_id": 37300839, "question_id": 37300503, "link": "https://stackoverflow.com/questions/37300503/struct-with-interface-to-json/37300839#37300839", "title": "Struct with interface to json", "body": "<p>In golang, json.Marshal handles nested structs, slices and maps.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Animal struct {\n    Descr description `json:\"description\"`\n    Age   int         `json:\"age\"`\n}\n\ntype description struct {\n    Name string `json:\"name\"`\n}\n\nfunc main() {\n    d := description{\"Cat\"}\n    a := Animal{Descr: d, Age: 15}\n    data, _ := json.MarshalIndent(a,\"\", \"  \")\n    fmt.Println(string(data))\n}\n</code></pre>\n\n<p>This code prints:</p>\n\n<pre><code>{\n  \"description\": {\n    \"name\": \"Cat\"\n  },\n  \"age\": 15\n}\n</code></pre>\n\n<p>Of course, unmarshalling works the exact same way.\nTell me if I misunderstood the question.</p>\n\n<p><a href=\"https://play.golang.org/p/t2CeHHoX72\" rel=\"nofollow noreferrer\">https://play.golang.org/p/t2CeHHoX72</a></p>\n"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3333, "favorite_count": 0, "accepted_answer_id": 37300839, "answer_count": 1, "score": 0, "last_activity_date": 1578671858, "creation_date": 1463576686, "last_edit_date": 1578671858, "question_id": 37300503, "link": "https://stackoverflow.com/questions/37300503/struct-with-interface-to-json", "title": "Struct with interface to json", "body": "<p>I'm asking myself about an error that I got. I'm making an API which send a response which seems like it:</p>\n\n<pre><code>var StatusBack struct {\n    Description string // to describe the error/the result\n    StatusId int // the status number (500 Internal error, 200 OK...)\n}\n// client get \n{\n    description: \"{surname: \\\"Xthing\\\", firstname: \\\"Mister\\\"}\"\n    status_id: 200\n}\n</code></pre>\n\n<p>So my idea was to make a json into a string with Marshal and then, Marshal a second time the StatusBack struct to send it. However, it doesn't make what I really want which is to get an object which contain another object.  The client only get one object which contain a string..The thing is, I don't send only user as result, so like I show below I think I need an interface</p>\n\n<pre><code>var StatusBack struct {\n    Description string // to describe the error\n    Result &lt;Interface or object, I don t know&gt; // which is the result\n    StatusId int // the status number (500 Internal error, 200 OK...)\n}\n// client get \n{\n    description: \"User information\",\n    result: {\n        surname: \"Xthing\",\n        firstname: \"Mister\"\n    },\n    status_id: 200\n}\n</code></pre>\n\n<p>Like I said before, I not only send user, it could be lot of different object, so how can I achieves it? Does my second idea is better? If yes, how can I code it?</p>\n"}, {"tags": ["go", "error-handling", "interface"], "answers": [{"tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 3, "last_activity_date": 1463573877, "creation_date": 1463573877, "answer_id": 37299399, "question_id": 37298998, "link": "https://stackoverflow.com/questions/37298998/go-multiple-value-in-single-value-context-in-interface/37299399#37299399", "title": "Go. Multiple-value in single-value context in Interface", "body": "<p>The problem is that NewObject has multiple return values and you can't chain or next functions that return multiple values (in the same line).</p>\n\n<p>It's unclear why you are trying to call Facade(...) on a return value that you think should be a Facade, are you doing a type conversion?</p>\n\n<p>Try getting out the value and dealing with the error and then calling the outside function.</p>\n\n<pre><code>type Facade interface {\n    GetOne() int\n}\n\ntype ObjectOne struct{\n    one int\n}\n\nfunc NewObject()(Facade, error){\n    o := &amp;ObjectOne{}\n    return o , errors.New(\"Some funny error\")\n}\n\nfunc(o * ObjectOne)GetOne()int{\n    return 1\n}\n\nfunc SomeWhereInCode(){\n    newFacade , err := NewObject())\n    if err != nil {\n        // handle err or panic\n    }\n    Facade(newFacade)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 4, "last_activity_date": 1463578675, "last_edit_date": 1463578675, "creation_date": 1463574161, "answer_id": 37299523, "question_id": 37298998, "link": "https://stackoverflow.com/questions/37298998/go-multiple-value-in-single-value-context-in-interface/37299523#37299523", "title": "Go. Multiple-value in single-value context in Interface", "body": "<p>In the expression:</p>\n\n<pre><code>newFacade , err := Facade(NewObject())\n</code></pre>\n\n<p><code>Facade(NewObject())</code> is not a constructor but an explicit type conversion. You do not need it at all because <code>NewObject()</code>, being a constructor already, returns a <code>Facade</code> type and an error. So just:</p>\n\n<pre><code>newFacade , err := NewObject()\n</code></pre>\n\n<p>should work seems to me.</p>\n"}], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3045, "favorite_count": 0, "accepted_answer_id": 37299523, "answer_count": 2, "score": -1, "last_activity_date": 1463578675, "creation_date": 1463572899, "last_edit_date": 1495541342, "question_id": 37298998, "link": "https://stackoverflow.com/questions/37298998/go-multiple-value-in-single-value-context-in-interface", "title": "Go. Multiple-value in single-value context in Interface", "body": "<p>I read below topic</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28227095/go-multiple-value-in-single-value-context\">Go: multiple value in single-value context</a></p>\n\n<p>But I don't understand this explain in my case. May be that's way because I want to use <strong>interface</strong></p>\n\n<p>I get error <code>multiple-value NewObject() in single-value context</code> in below case</p>\n\n<pre><code>type Facade interface {\n    GetOne() int\n}\n\ntype ObjectOne struct{\n    one int\n}\n\nfunc NewObject()(Facade, error){\n    o := &amp;ObjectOne{}\n    return o , errors.New(\"Some funny error\")\n}\n\nfunc(o * ObjectOne)GetOne()int{\n    return 1\n}\n\nfunc SomeWhereInCode(){\n    newFacade , err := Facade(NewObject())\n// And here. I get error probbably because Facade constructor return one arguments (interface) and NewObject() return two. How should be ? \n}\n</code></pre>\n\n<p>I also tryed pass <code>error</code> as pointer to <code>ObjectOne</code> but still get error compiler</p>\n\n<pre><code>type Facade interface {\n    GetOne() int\n}\n\ntype ObjectOne struct{\n    one int\n}\n\nfunc NewObject(facadeError* error)(Facade, error){\n    o := &amp;ObjectOne{}\n    *facadeError = errors.New(\"Some funny error\")\n    return o , *facadeError\n}\n\nfunc(o * ObjectOne)GetOne()int{\n    return 1\n}\n\nfunc SomeWhereInCode(){\n    var facadeError = error()\n    newFacade , err := Facade(NewObject(&amp;facadeError))\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1463572669, "post_id": 37298532, "comment_id": 62120283, "body": "Check this out <a href=\"http://stackoverflow.com/questions/19546896/golang-template-how-to-render-templates\" title=\"golang template how to render templates\">stackoverflow.com/questions/19546896/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 599, "user_id": 2417257, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/60113bef0d3c87b2c485ed413b84a34b?s=128&d=identicon&r=PG", "display_name": "Tutompita", "link": "https://stackoverflow.com/users/2417257/tutompita"}, "edited": false, "score": 1, "creation_date": 1463626723, "post_id": 37299111, "comment_id": 62147141, "body": "Thank you for the answer eduncan911. I also find out that if I use <code>{{ template &quot;contents&quot; .tes }}</code>, I should use <code>var x = {{.}};</code> instead of <code>var x = {{.tes}};</code>"}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 3, "last_activity_date": 1463573187, "creation_date": 1463573187, "answer_id": 37299111, "question_id": 37298532, "link": "https://stackoverflow.com/questions/37298532/variable-inside-define-template-in-golang/37299111#37299111", "title": "Variable Inside Define Template in Golang", "body": "<p>In layout.HTML, you need to pass the context.  You do that with a <code>.</code> dot.</p>\n\n<pre><code>    {{ template \"contents\" . }}\n</code></pre>\n\n<p>Alternatively, you can pass the value of whatever var you want:</p>\n\n<pre><code>    {{ template \"contents\" .tes }}\n</code></pre>\n\n<p>...and within the contents template, the dot context will be just the value of <code>.tes</code>.  That helps limit the scope of sub-templates, not having to dot-walk to get to a value.</p>\n"}], "owner": {"reputation": 599, "user_id": 2417257, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/60113bef0d3c87b2c485ed413b84a34b?s=128&d=identicon&r=PG", "display_name": "Tutompita", "link": "https://stackoverflow.com/users/2417257/tutompita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 1, "accepted_answer_id": 37299111, "answer_count": 1, "score": 2, "last_activity_date": 1463626603, "creation_date": 1463571621, "last_edit_date": 1463626603, "question_id": 37298532, "link": "https://stackoverflow.com/questions/37298532/variable-inside-define-template-in-golang", "title": "Variable Inside Define Template in Golang", "body": "<p>I have 3 files here in Golang project, the idea is to render the index.html isnside the body of layout.html. It works.</p>\n\n<p>But when I tried to pass a variable into the <strong>index.html</strong>, the <code>console.log()</code> did not rendered. When I move the <code>console.log()</code> to <strong>layout.html</strong>, I can see the content of the JSON from <code>.tes</code>.</p>\n\n<p>Here are the project files.</p>\n\n<p><strong>layout.html</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n    &lt;title&gt;{{.title}} | {{.project_name}}&lt;/title&gt;\n&lt;/head&gt;\n&lt;body style=\"width:100%; height: 100%; overflow-x: visible\"&gt;\n&lt;div id=\"wrapper\" style=\"width:100%; height:100%; margin: 0 auto\"&gt;\n    {{template \"contents\"}}\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>index.html</strong></p>\n\n<pre><code>{{define \"contents\"}}\n&lt;script&gt;\n    var x = {{.tes}};\n    console.log(x)\n&lt;/script&gt;\n{{end}}\n</code></pre>\n\n<p><strong>router.go</strong></p>\n\n<pre><code>func init() {\n    // handler\n    http.HandleFunc(\"/\", RenderPage)\n}\n\nfunc RenderPage(w http.ResponseWriter, r *http.Request) {\n    tes := map[string]interface{}{\n        \"item\":\"TEST3\",\n        \"count\":4567,\n    }\n    Data := map[string]interface{}{\n        \"title\":\"TEST1\",\n        \"project_name\":\"TEST2\",\n        \"tes\":M.ToJSON(tes),\n    }\n    tmpl, err := template.ParseFiles(\"page/layout.html\", \"page/index.html\")\n    X.CheckError(err)\n    err = tmpl.Execute(w, Data)\n    X.CheckError(err)\n}\n</code></pre>\n"}, {"tags": ["go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 373, "user_id": 1021651, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/065b442c8c05e14fbebc57d7796bd579?s=128&d=identicon&r=PG", "display_name": "Quaso", "link": "https://stackoverflow.com/users/1021651/quaso"}, "edited": false, "score": 0, "creation_date": 1463571156, "post_id": 37298189, "comment_id": 62119238, "body": "Hey. Thanks. Actually what i am trying to achive is, making &quot;r&quot; to have my new interface (n). Not calling a global function."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 373, "user_id": 1021651, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/065b442c8c05e14fbebc57d7796bd579?s=128&d=identicon&r=PG", "display_name": "Quaso", "link": "https://stackoverflow.com/users/1021651/quaso"}, "edited": false, "score": 0, "creation_date": 1463572896, "post_id": 37298189, "comment_id": 62120477, "body": "You already implemented the interface for Rect, you cannot change it. I elaborated my answer a bit."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 4, "last_activity_date": 1463572798, "last_edit_date": 1463572798, "creation_date": 1463570684, "answer_id": 37298189, "question_id": 37298107, "link": "https://stackoverflow.com/questions/37298107/interface-function-call-on-golang/37298189#37298189", "title": "Interface Function Call on GoLang", "body": "<p>There is a misunderstanding of what interfaces are. In go, a type implements an interface if it implements the function defined for the interface. So, in your code, interfaces <code>a.First</code> and <code>main.Second</code> are <strong>equivalent</strong>. A type implements both of them or none at all.</p>\n\n<p>So, the type <code>Rect</code> is both a <code>a.First</code> and a <code>main.Second</code>. The field F inside Rect means that it contains another type that implements First (or Second because they are the same).</p>\n\n<p>When you call <code>r.Area()</code>, go executes the function <code>func (r Rect) Area() uint64</code>. With the line <code>r.F = *n</code>, you assign the interface Second to First (they are equivalent, no problem). However, if you try to call <code>r.F.Area()</code> it will panic because F is not a type that implements First, it <em>is</em> First.</p>\n\n<p>So, you should create another type which implements First then assign it to r. Then you can call <code>r.F.Area()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 845, "user_id": 1493422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f4386def0cbdc13e6f49fc81ddbfb3?s=128&d=identicon&r=PG", "display_name": "Keith Ripley", "link": "https://stackoverflow.com/users/1493422/keith-ripley"}, "is_accepted": false, "score": 2, "last_activity_date": 1463782625, "creation_date": 1463782625, "answer_id": 37356647, "question_id": 37298107, "link": "https://stackoverflow.com/questions/37298107/interface-function-call-on-golang/37356647#37356647", "title": "Interface Function Call on GoLang", "body": "<p>First, look at your code again. As written, <code>a.Rect.Area()</code> returns 1. It always returns 1. Set all the properties you like. It returns 1. Gnash your teeth and curse the gods. It returns 1. Because it's a function that returns 1. That's what it does.</p>\n\n<p>Write it like this:</p>\n\n<pre><code>// Area -\nfunc (r Rect) Area() float64 {\n    return r.F.Area()\n}\n</code></pre>\n\n<p>...and you'll panic because you've got another issue.</p>\n\n<p><code>Area()</code> in main.go doesn't have a receiver. It has nothing to do with interfaces. It's just a function. No objects. No implementing anything. No polymorphism. No nothing.</p>\n\n<p>You've declared <code>n</code> as a pointer to an interface, not an implementation of an interface. It's nil. If you try to dereference it the whole world will come crashing down into the void.</p>\n\n<p>If you want to be able to call <code>n.Area()</code> then make <code>Second</code> a concrete type.</p>\n\n<p>(In main.go)</p>\n\n<pre><code>// Second -\ntype Second struct {}\n\n// Area -\nfunc (s Second) Area() float64 {\n    return 2\n}\n</code></pre>\n\n<p>Do you see the difference? Second is now a <code>struct</code> that <em>implements</em> the interface <code>a.First</code> because it is the receiver of an appropriate <code>Area()</code> method. Thus you will get the expected behavior.</p>\n"}], "owner": {"reputation": 373, "user_id": 1021651, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/065b442c8c05e14fbebc57d7796bd579?s=128&d=identicon&r=PG", "display_name": "Quaso", "link": "https://stackoverflow.com/users/1021651/quaso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4291, "favorite_count": 0, "accepted_answer_id": 37298189, "answer_count": 2, "score": 0, "last_activity_date": 1463782625, "creation_date": 1463570492, "question_id": 37298107, "link": "https://stackoverflow.com/questions/37298107/interface-function-call-on-golang", "title": "Interface Function Call on GoLang", "body": "<p>I am having a problem go interfaces. </p>\n\n<p>Here is my main.go file;</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"bitbucket.org/xyz/trash/a\"\n)\n\n// Second -\ntype Second interface {\n    Area() float64\n}\n\n// Area -\nfunc Area() float64 {\n    return 2\n}\n\n\nfunc main() {\n\n    r := new(a.Rect)\n\n    n := new(Second)\n\n    r.F = *n\n\n    fmt.Println(r.Area()) \n\n}\n</code></pre>\n\n<p>And my other package, a.go;</p>\n\n<pre><code>package a\n\n// First -\ntype First interface {\n    Area() float64\n}\n\n// Rect -\ntype Rect struct {\n    F First \n}\n\n// Area -\nfunc (r Rect) Area() float64 {\n    return 1\n}\n</code></pre>\n\n<p>I am expecting this line</p>\n\n<p>fmt.Println(r.Area()) </p>\n\n<p>to print \"2\", not \"1\". What am i missing?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["go", "deployment", "supervisord", "systemd"], "comments": [{"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1463572330, "post_id": 37297714, "comment_id": 62120041, "body": "Your web app is not blocking. Are you sure your binarie works?"}, {"owner": {"reputation": 320, "user_id": 2463794, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fe837ba7d6df8ed96e69024be294db0f?s=128&d=identicon&r=PG", "display_name": "drakid", "link": "https://stackoverflow.com/users/2463794/drakid"}, "reply_to_user": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1463581183, "post_id": 37297714, "comment_id": 62126660, "body": "When I start my web app manually, it is blocking. Whenever I close SSH, it also stop. That is why I use systemd to run app in background. I updated information when I run manually."}], "answers": [{"comments": [{"owner": {"reputation": 320, "user_id": 2463794, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fe837ba7d6df8ed96e69024be294db0f?s=128&d=identicon&r=PG", "display_name": "drakid", "link": "https://stackoverflow.com/users/2463794/drakid"}, "edited": false, "score": 0, "creation_date": 1463582813, "post_id": 37298773, "comment_id": 62127913, "body": "My web app listens on port 9005. Btw, I tried your suggestion but it doesn&#39;t work."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 320, "user_id": 2463794, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fe837ba7d6df8ed96e69024be294db0f?s=128&d=identicon&r=PG", "display_name": "drakid", "link": "https://stackoverflow.com/users/2463794/drakid"}, "edited": false, "score": 0, "creation_date": 1463668361, "post_id": 37298773, "comment_id": 62171848, "body": "@drakid I have several web apps using gin and systemd, so I think your app is crashing or something, make sure to check <code>journalctl -u goweb</code> and log more stuff to stderr (what the log package does by default)."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 5, "last_activity_date": 1463572272, "creation_date": 1463572272, "answer_id": 37298773, "question_id": 37297714, "link": "https://stackoverflow.com/questions/37297714/why-systemd-cannot-start-golang-web-app-no-answer/37298773#37298773", "title": "why systemd cannot start golang web app, no answer", "body": "<p>I'll take a wild stab and guess your app listens on port 80 and/or 443, so your best bet is to use setcap on it to give it permission.</p>\n\n<p>example: <code>sudo setcap 'cap_net_bind_service=+ep' /u01/backend</code>, this will need to be done every time you compile your app.</p>\n"}, {"tags": [], "owner": {"reputation": 11251, "user_id": 254318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqtBB.jpg?s=128&g=1", "display_name": "Mark Stosberg", "link": "https://stackoverflow.com/users/254318/mark-stosberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1463576478, "creation_date": 1463576478, "answer_id": 37300420, "question_id": 37297714, "link": "https://stackoverflow.com/questions/37297714/why-systemd-cannot-start-golang-web-app-no-answer/37300420#37300420", "title": "why systemd cannot start golang web app, no answer", "body": "<p>Replace your app temporarily with a minimal version that just dumps the environment out. Are the environment for running manually and under <code>systemd</code> sufficiently similar? </p>\n"}, {"comments": [{"owner": {"reputation": 1964, "user_id": 6242722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TQ0Db.png?s=128&g=1", "display_name": "Rijul Sudhir", "link": "https://stackoverflow.com/users/6242722/rijul-sudhir"}, "edited": false, "score": 3, "creation_date": 1514905366, "post_id": 43378715, "comment_id": 83099160, "body": "insert <code>WorkingDirectory=&#47;home&#47;ubuntu&#47;</code> below <code>[service]</code> of systemd service file"}, {"owner": {"reputation": 1265, "user_id": 861131, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/69B2g.png?s=128&g=1", "display_name": "najam", "link": "https://stackoverflow.com/users/861131/najam"}, "reply_to_user": {"reputation": 1964, "user_id": 6242722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TQ0Db.png?s=128&g=1", "display_name": "Rijul Sudhir", "link": "https://stackoverflow.com/users/6242722/rijul-sudhir"}, "edited": false, "score": 0, "creation_date": 1552900309, "post_id": 43378715, "comment_id": 97170825, "body": "you @RijulSudhir are life saver."}], "tags": [], "owner": {"reputation": 43, "user_id": 5721095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxwZ1.jpg?s=128&g=1", "display_name": "comebacknader", "link": "https://stackoverflow.com/users/5721095/comebacknader"}, "is_accepted": false, "score": 4, "last_activity_date": 1492027568, "creation_date": 1492027568, "answer_id": 43378715, "question_id": 37297714, "link": "https://stackoverflow.com/questions/37297714/why-systemd-cannot-start-golang-web-app-no-answer/43378715#43378715", "title": "why systemd cannot start golang web app, no answer", "body": "<p>I know this is old, but saw that there weren't any sufficient answers, so thought I would post. My app was also being run manually, but when using systemd it wouldn't work. I realized it had to do with the filepaths that the Go program would state, such as: </p>\n\n<pre><code>tpl = template.Must(template.ParseGlob(\"templates/*\"))\n</code></pre>\n\n<p>When running the app manually, the templates folder was there relative to my main.go file, but when systemd would run it, the filepath was different (not sure why or how to solve this yet), but for now I just hardcoded an absolute filepath, such as: </p>\n\n<pre><code>tpl = template.Must(template.ParseGlob(\"./home/ubuntu/templates/*\"))\n</code></pre>\n\n<p>Now systemd works. </p>\n\n<p>Hope this helps. If anyone can elaborate on how to come up with a better solution, would totally help me as well! </p>\n"}, {"tags": [], "owner": {"reputation": 733, "user_id": 8380779, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O4uKl34-THU/AAAAAAAAAAI/AAAAAAAAAHc/oTrJsLNQHyg/photo.jpg?sz=128", "display_name": "kenn", "link": "https://stackoverflow.com/users/8380779/kenn"}, "is_accepted": false, "score": 2, "last_activity_date": 1542639502, "last_edit_date": 1542639502, "creation_date": 1542638293, "answer_id": 53376918, "question_id": 37297714, "link": "https://stackoverflow.com/questions/37297714/why-systemd-cannot-start-golang-web-app-no-answer/53376918#53376918", "title": "why systemd cannot start golang web app, no answer", "body": "<p>From @RijulSudhir comment above, insert:</p>\n\n<pre><code>WorkingDirectory=/home/ubuntu/\n</code></pre>\n\n<p>below:</p>\n\n<pre><code>[service]\n</code></pre>\n\n<p>of systemd service file.</p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 9252881, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TMBCOsPGpnM/AAAAAAAAAAI/AAAAAAAAjso/VLlFft4eHFE/photo.jpg?sz=128", "display_name": "Jiulin Teng", "link": "https://stackoverflow.com/users/9252881/jiulin-teng"}, "is_accepted": false, "score": 0, "last_activity_date": 1611683191, "creation_date": 1611683191, "answer_id": 65906475, "question_id": 37297714, "link": "https://stackoverflow.com/questions/37297714/why-systemd-cannot-start-golang-web-app-no-answer/65906475#65906475", "title": "why systemd cannot start golang web app, no answer", "body": "<p>In this specific instance, I guess it's because you don't specify</p>\n<pre><code>ExecStart=/path/to/app\n</code></pre>\n<p>As a result, there's nothing to start.</p>\n"}], "owner": {"reputation": 320, "user_id": 2463794, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fe837ba7d6df8ed96e69024be294db0f?s=128&d=identicon&r=PG", "display_name": "drakid", "link": "https://stackoverflow.com/users/2463794/drakid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2660, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1611683191, "creation_date": 1463569440, "last_edit_date": 1542939273, "question_id": 37297714, "link": "https://stackoverflow.com/questions/37297714/why-systemd-cannot-start-golang-web-app-no-answer", "title": "why systemd cannot start golang web app, no answer", "body": "<p>My golang web app cannot start when I use systemd, but it works fine when manually start. What are problems with my systemd configuration?</p>\n\n<p><strong>goweb.service</strong></p>\n\n<pre><code>$ cat goweb.service \n[Unit]\nDescription=Backend service\nAfter=network.target\n\n[Service]\nUser=myapp\nGroup=myapp\nRestart=on-failure\nExecStart=/u01/backend\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<p><code>backend</code> is a binary file compiled with command: <code>env GOOS=linux GOARCH=amd64 go build -v bitbucket.org/myapp/backend</code></p>\n\n<p><strong>systemd service status</strong></p>\n\n<pre><code>$ sudo service goweb status\nRedirecting to /bin/systemctl status  goweb.service\n\u25cf goweb.service - Backend service\n   Loaded: loaded (/usr/lib/systemd/system/goweb.service; disabled; vendor preset: disabled)\n   Active: inactive (dead)\n\nMay 18 10:55:56 instance-1 systemd[1]: Started Backend service.\nMay 18 10:55:56 instance-1 systemd[1]: Starting Backend service...\n</code></pre>\n\n<p><strong>P/S</strong>: It looks like my web app started, but then stoped immediately.</p>\n\n<p>I try config <code>Type=forking</code>, then service status show as below. Could someone explains why the log <code>Started Backend service.</code> and <code>Starting Backend service...</code> order is reversed.</p>\n\n<pre><code>$ sudo service goweb status\nRedirecting to /bin/systemctl status  goweb.service\n\u25cf goweb.service - Backend service\n   Loaded: loaded (/usr/lib/systemd/system/goweb.service; enabled; vendor preset: disabled)\n   Active: inactive (dead) since Wed 2016-05-18 11:06:02 UTC; 2s ago\n  Process: 25847 ExecStart=/u01/backend (code=exited, status=0/SUCCESS)\n\nMay 18 11:06:02 instance-1 systemd[1]: Starting Backend service...\nMay 18 11:06:02 instance-1 systemd[1]: Started Backend service.\n</code></pre>\n\n<p>Result when I run web app manually (from terminal):</p>\n\n<pre><code>$ /u01/backend\n[GIN-debug] [WARNING] Running in \"debug\" mode. Switch to \"release\" mode in production.\n - using env:   export GIN_MODE=release\n - using code:  gin.SetMode(gin.ReleaseMode)\n\n[GIN-debug] POST   /upload                   --&gt; main.uploadFileHandler (3 handlers)\n[GIN-debug] Environment variable PORT=\"9005\"\n[GIN-debug] Listening and serving HTTP on :9005\n</code></pre>\n\n<hr>\n\n<p><strong>Update</strong>:</p>\n\n<ol>\n<li>I try <a href=\"http://supervisord.org/\" rel=\"nofollow\">supervisord</a> and it works fine (same binary file)</li>\n<li>With <code>systemd</code>, I changed service config to <code>Restart=always</code>,  <code>RestartSec=15</code>. And <code>systemd</code> keeps restarting my web app.</li>\n</ol>\n\n<p>Does anyone know why <code>supervisord</code> work fine but <code>systemd</code> not? I think that <code>systemd</code> would work fine with a basic task like that!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 4, "last_activity_date": 1463736418, "last_edit_date": 1463736418, "creation_date": 1463565656, "answer_id": 37296274, "question_id": 37296163, "link": "https://stackoverflow.com/questions/37296163/golang-directives-at-top-of-file/37296274#37296274", "title": "Golang directives at top of file", "body": "<p>It is part of the official documentation of the <code>build</code> package.</p>\n\n<p>You can find it <a href=\"https://golang.org/pkg/go/build/\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 129, "user_id": 678853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/77192b7b33034a25d30ca2810fcf836a?s=128&d=identicon&r=PG", "display_name": "rgoncalves", "link": "https://stackoverflow.com/users/678853/rgoncalves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463736418, "creation_date": 1463565383, "question_id": 37296163, "link": "https://stackoverflow.com/questions/37296163/golang-directives-at-top-of-file", "title": "Golang directives at top of file", "body": "<p>I've seen this comment at the top of a <strong>go</strong> source file (fixtures.go).</p>\n\n<pre><code>// +build fixtures\n\npackage packagename\n</code></pre>\n\n<p>What does the comment \"+build fixtures\" mean? Is it a kind of directive? I've googled, but couldn't find any answer.</p>\n\n<p>Running \"go test\" in the package, fails due to undefined functions that are defined in the file \"fixtures.go\". If I remove the comment at the top o the file \"+build fixtures\", tests succeed!</p>\n"}, {"tags": ["go", "docker", "docker-compose"], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 2, "last_activity_date": 1463593195, "creation_date": 1463593195, "answer_id": 37306673, "question_id": 37295127, "link": "https://stackoverflow.com/questions/37295127/quick-go-project-build-with-docker-without-checking-in-vendor-libraries/37306673#37306673", "title": "Quick Go project build with Docker without checking in vendor libraries", "body": "<blockquote>\n  <p>Is there a way in between, maybe with caching?</p>\n</blockquote>\n\n<p>Yes, several.  But don't fight the system/preferred method.</p>\n\n<p>Use <code>$GOPATH/src/MyProject/vendor</code> like you are already doing.</p>\n\n<blockquote>\n  <p>adding vendored libraries to source control has the disavantage of libraries not being updated...</p>\n</blockquote>\n\n<p>That all depends on your team's management of your repo.  If everyone ignores the vendor, ya it will get stale.  </p>\n\n<p>Personally I make it a \"1st of the month\" habit of going through and refreshing all dependencies, running our test suites, and if no errors update for QA integration testing on the dev server and keep an eye on the error logs after release.  Tools like <code>godep</code> and <code>gostatus</code> greatly help keep your GOPATH in chrcn with latest, that you can update your vendor folder(s) with quickly.</p>\n\n<p>Just make sure it is a dedicated commit, so it can be reverted in a hurry if an issue creeps up.</p>\n\n<blockquote>\n  <p>also heavily polluting the diff of pull requests</p>\n</blockquote>\n\n<p>First of all, that's just a process task. I enforce rebasing on all pull requests and reject all merges in all repos.  This keeps a very clean git history; but, more to the point, rebasing moves your local commits until after the vendor updates.  Shouldn't ever get a conflict unless someone added the same package.  Which at that point is easy, just take the latest one and be done.</p>\n\n<p>Sound like there are process issues to work out than worrying about /vendor management.</p>\n"}], "owner": {"reputation": 5764, "user_id": 1336532, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93e5830761f6e85757991d5915369349?s=128&d=identicon&r=PG", "display_name": "Mahoni", "link": "https://stackoverflow.com/users/1336532/mahoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 37306673, "answer_count": 1, "score": 2, "last_activity_date": 1463593195, "creation_date": 1463562819, "question_id": 37295127, "link": "https://stackoverflow.com/questions/37295127/quick-go-project-build-with-docker-without-checking-in-vendor-libraries", "title": "Quick Go project build with Docker without checking in vendor libraries", "body": "<p>Currently, we have all vendored libraries in <code>src/vendor</code> which makes <code>docker-compose build</code> quite fast. Although adding vendored libraries to source control has the disavantage of libraries not being updated and also heavily polluting the diff of pull requests.</p>\n\n<p>Is there a way in between, maybe with caching?</p>\n"}, {"tags": ["json", "xml", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1463562468, "post_id": 37294556, "comment_id": 62113264, "body": "Can you post an example JSON containing such XML which cannot be unmarshalled? And also example code how you try to unmarshal it?"}, {"owner": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1463565128, "post_id": 37294556, "comment_id": 62115118, "body": "@icza I cant, this is a very long xml (~2MB) and I honestly dont know where the error in the file is."}, {"owner": {"reputation": 46273, "user_id": 574479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/79f682361ccbe900f8846a1098d13921?s=128&d=identicon&r=PG", "display_name": "biziclop", "link": "https://stackoverflow.com/users/574479/biziclop"}, "edited": false, "score": 2, "creation_date": 1463565379, "post_id": 37294556, "comment_id": 62115296, "body": "@buddy123 Keep chopping the file in half and check which half gives you the error."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1463592604, "last_edit_date": 1463592604, "creation_date": 1463580349, "answer_id": 37302026, "question_id": 37294556, "link": "https://stackoverflow.com/questions/37294556/json-unmarshal-fails-due-to-invalid-characters/37302026#37302026", "title": "Json unmarshal fails due to invalid characters", "body": "<p>The JSON package encodes and decodes []byte values as base-64 encoded strings. If the XML is not base-64 encoded, then change the type to string to avoid the encoding.</p>\n\n<pre><code>type A struct {\n  Xml string `json:\"xml\"`\n}\n</code></pre>\n\n<p>Another solution is to encode the XML as base64 and leave the type as defined in the question.</p>\n\n<p>If base64 encoding is not the issue, then print the offset of the error and check the JSON text at that offset.</p>\n\n<pre><code>err := json.Unmarshal(content, &amp;xml)\nswitch err := err.(type) {\ncase *json.SyntaxError:\n   fmt.Printf(\"syntax error at offset %d: %v\\n\", err.Offset, err)\ncase *json.UnmarshalTypeError:\n   fmt.Printf(\"type error at offset %d: %v\\n\", err.Offset, err)\ncase nil:\n   // no error\ndefault:\n   fmt.Printf(\"error %v\\n\", err)\n}\n</code></pre>\n\n<p>In general, XML text cannot be used as a JSON string without quoting.</p>\n"}, {"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1463601854, "post_id": 37303755, "comment_id": 62139361, "body": "The encoding/json package uses base64 encoding for []byte values.  There&#39;s no need for the XmlB64 type."}], "tags": [], "owner": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "is_accepted": true, "score": 0, "last_activity_date": 1463584542, "creation_date": 1463584542, "answer_id": 37303755, "question_id": 37294556, "link": "https://stackoverflow.com/questions/37294556/json-unmarshal-fails-due-to-invalid-characters/37303755#37303755", "title": "Json unmarshal fails due to invalid characters", "body": "<p>Since JSON cannot contain any control characters, I found the most convenient solution to simply convert the xml data to base64, e.g:</p>\n\n<pre><code>// before sending in javascript\na.xml = new Buffer(a.xml).toString('base64')\n</code></pre>\n\n<p>Then, In golang side:</p>\n\n<pre><code>// Declare a new type for custom unmarshaling\ntype XmlB64 []byte\nfunc (b *XmlB64) UnmarshalJSON(data []byte) error {\n    if b == nil {\n        return fmt.Errorf(\"UnmarshalJSON on nil pointer\")\n    }\n\n    if len(data) == 0 {\n        return nil\n    }\n\n    if x, err := base64.StdEncoding.DecodeString(string(data)); err != nil {\n        return err\n    } else {\n        *b = x\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>After doing that, Unmarshalling base64 content is done without doing anything special in the code. We first change our struct:</p>\n\n<pre><code>type A struct {\n  Xml XmlB64 `json:\"xml\"`\n}\n</code></pre>\n\n<p>Unmarshal:</p>\n\n<pre><code>var xml A\nerr := json.Unmarshal(content, &amp;xml)\n</code></pre>\n"}], "owner": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2520, "favorite_count": 0, "accepted_answer_id": 37303755, "answer_count": 2, "score": 0, "last_activity_date": 1463592604, "creation_date": 1463561273, "last_edit_date": 1463565101, "question_id": 37294556, "link": "https://stackoverflow.com/questions/37294556/json-unmarshal-fails-due-to-invalid-characters", "title": "Json unmarshal fails due to invalid characters", "body": "<p>Im having difficulties to unmarshal json content in golang.\nOne of the fields in my object contains xml content and occasionally it will fail, claiming messages such as: <code>invalid character '\\x..' in string literal</code></p>\n\n<p>I understand that this is as a result of control characters in my xml, but dont know how to handle it.\nI store my documents in mongoosejs and save the xml field as type String\nMy struct Im trying to deserialize to is declared this way:</p>\n\n<pre><code>type A struct {\n  Xml []byte `json:\"xml\"`\n}\n</code></pre>\n\n<p>Unmarshaling is done the following way:</p>\n\n<pre><code>var xml A\nerr := json.Unmarshal(content, &amp;xml)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 435, "user_id": 2702193, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a3f6bf97c0a7c87befa99a1fe1a92c34?s=128&d=identicon&r=PG&f=1", "display_name": "rox", "link": "https://stackoverflow.com/users/2702193/rox"}, "edited": false, "score": 0, "creation_date": 1463560405, "post_id": 37294052, "comment_id": 62111974, "body": "go version go1.6.2 linux/amd64"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1463560511, "post_id": 37294052, "comment_id": 62112039, "body": "works well here. <code>2016-05-18 16:34:55.364568407 +0800 CST 2016-05-18 16:35:01.365609996 +0800 CST &lt;nil&gt; dial tcp: i&#47;o timeout</code>"}, {"owner": {"reputation": 1894, "user_id": 2269979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22a1e835980e29baccf08a62e7ff71?s=128&d=identicon&r=PG", "display_name": "molivier", "link": "https://stackoverflow.com/users/2269979/molivier"}, "edited": false, "score": 1, "creation_date": 1463561660, "post_id": 37294052, "comment_id": 62112767, "body": "Look at : <a href=\"https://github.com/golang/go/blob/495e3c60aa61615dd603050ac47f86468f8222b6/src/net/dial.go#L18\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1463583266, "creation_date": 1463583266, "answer_id": 37303230, "question_id": 37294052, "link": "https://stackoverflow.com/questions/37294052/why-net-dialtimeout-get-timeout-half-of-the-time/37303230#37303230", "title": "Why net.DialTimeout get timeout half of the time?", "body": "<p>Your code is OK, your network/internet connection/route to the internet has problem.<br>\nFor example if a router/device between you and google overloaded (or any problem...) it may drop some packets every some seconds, my guess.  </p>\n\n<p>My test result:</p>\n\n<pre><code>10 192.0109ms 3 &amp;{{0xc082082900}} &lt;nil&gt;\n9 192.0109ms 3 &amp;{{0xc082082780}} &lt;nil&gt;\n8 192.0109ms 3 &amp;{{0xc082082000}} &lt;nil&gt;\n7 197.0112ms 3 &amp;{{0xc082015c80}} &lt;nil&gt;\n6 227.0129ms 3 &amp;{{0xc082082300}} &lt;nil&gt;\n5 372.0212ms 3 &amp;{{0xc082082180}} &lt;nil&gt;\n4 375.0214ms 0 &amp;{{0xc082015e00}} &lt;nil&gt;\n3 375.0214ms 3 &amp;{{0xc082082600}} &lt;nil&gt;\n2 375.0214ms 3 &amp;{{0xc082082480}} &lt;nil&gt;\n1 378.0216ms 3 &amp;{{0xc082082a80}} &lt;nil&gt;\n</code></pre>\n\n<p>then I disabled network connection:</p>\n\n<pre><code>10 1.0000572s 0 &lt;nil&gt; dial tcp: i/o timeout\n9 1.0000572s 3 &lt;nil&gt; dial tcp: i/o timeout\n8 1.0000572s 3 &lt;nil&gt; dial tcp: i/o timeout\n7 1.0000572s 3 &lt;nil&gt; dial tcp: i/o timeout\n6 1.0000572s 4 &lt;nil&gt; dial tcp: i/o timeout\n5 1.0000572s 4 &lt;nil&gt; dial tcp: i/o timeout\n4 1.0000572s 4 &lt;nil&gt; dial tcp: i/o timeout\n3 1.0000572s 4 &lt;nil&gt; dial tcp: i/o timeout\n2 1.0000572s 4 &lt;nil&gt; dial tcp: i/o timeout\n1 1.0000572s 4 &lt;nil&gt; dial tcp: i/o timeout\n</code></pre>\n\n<p>the Test Sample Code with 10 Concurrent tests:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"time\"\n)\n\ntype res struct {\n    d time.Duration\n    t int64\n    n net.Conn\n    e error\n}\n\nfunc check(c chan res) {\n    t := time.Now()\n    conn, err := net.DialTimeout(\"tcp\", \"google.com:80\", 1*time.Second)\n    d := time.Now().Sub(t)\n    c &lt;- res{d, (t.UnixNano() - t0) / time.Millisecond.Nanoseconds(), conn, err}\n}\n\nvar t0 int64 = time.Now().UnixNano()\n\nfunc main() {\n    numberOfJobs := 10\n    c := make(chan res, numberOfJobs)\n    for i := 0; i &lt; numberOfJobs; i++ {\n        go check(c)\n    }\n    for r := range c {\n        fmt.Println(numberOfJobs, r.d, r.t, r.n, r.e)\n        numberOfJobs--\n        if numberOfJobs == 0 {\n            break\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 435, "user_id": 2702193, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a3f6bf97c0a7c87befa99a1fe1a92c34?s=128&d=identicon&r=PG&f=1", "display_name": "rox", "link": "https://stackoverflow.com/users/2702193/rox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7358, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1612505015, "creation_date": 1463559842, "last_edit_date": 1609676008, "question_id": 37294052, "link": "https://stackoverflow.com/questions/37294052/why-net-dialtimeout-get-timeout-half-of-the-time", "title": "Why net.DialTimeout get timeout half of the time?", "body": "<p>This is my test code, I set 6s timeout, but the program execute only for 3s, Why? </p>\n\n<pre><code>package main\n\nimport \"net\"\nimport \"time\"\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(time.Now())\n    conn, err := net.DialTimeout(\"tcp\", \"google.com:80\",6*time.Second) // chinese people can't access google\n    fmt.Println(time.Now())\n    fmt.Println(conn,err)\n}\n</code></pre>\n\n<p>Test result:</p>\n\n<pre><code>2016-05-18 16:21:31.325340213 +0800 CST\n2016-05-18 16:21:34.32909193 +0800 CST\n&lt;nil&gt; dial tcp 59.24.3.173:80: i/o timeout\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "reply_to_user": {"reputation": 15076, "user_id": 2549021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vHZn6.png?s=128&g=1", "display_name": "AKS", "link": "https://stackoverflow.com/users/2549021/aks"}, "edited": false, "score": 2, "creation_date": 1463548008, "post_id": 37290693, "comment_id": 62105662, "body": "<code>strings.TrimSpace()</code>"}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "edited": false, "score": 0, "creation_date": 1463548061, "post_id": 37290693, "comment_id": 62105674, "body": "It&#39;d be cleaner to define a simple function...."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1463549099, "post_id": 37290693, "comment_id": 62106040, "body": "<code>s := strings.TrimSpace(strings.Replace(orig, &quot;  &quot;, &quot; &quot;, -1))</code> seems pretty simple. Space characters are typically just the ASCII space. If you are getting different space characters then you need to handle those explicitly."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1463556257, "post_id": 37290693, "comment_id": 62109448, "body": "Chec <a href=\"https://play.golang.org/p/05EjmqOoQd\" rel=\"nofollow noreferrer\">this code</a>."}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1463556747, "post_id": 37290693, "comment_id": 62109726, "body": "@WiktorStribi\u017cew that looks like a possible fit, I think I had something similar calculated with PHP ... <code>$output=preg_replace(&#39;&#47;^\\p{Z}+|\\p{Z}+$&#47;u&#39;,&#39;&#39;,$input);</code> ... Is that equivalent? Could you post a solution?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1463557653, "post_id": 37290693, "comment_id": 62110252, "body": "That is not equivalent as <code>\\p{Z}</code> does not match vertical whitespace. I am not sure about null characters actually."}], "answers": [{"comments": [{"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "edited": false, "score": 0, "creation_date": 1463550224, "post_id": 37290932, "comment_id": 62106470, "body": "Would this also cover unicode, and any other &quot;invisible&quot; characters, etc.? Ideally hoping to eliminate two seemingly appearing equal strings from matching in most cases."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "edited": false, "score": 0, "creation_date": 1463550894, "post_id": 37290932, "comment_id": 62106709, "body": "I suggest you read about golang strings (<a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">blog.golang.org/strings</a>) then modify this code to replace the exact characters you want to replace. My code is meant to be an example of how to do what you asked, not the exact solution."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": -1, "last_activity_date": 1463549051, "creation_date": 1463549051, "answer_id": 37290932, "question_id": 37290693, "link": "https://stackoverflow.com/questions/37290693/how-to-remove-redundant-spaces-whitespace-from-a-string-in-golang/37290932#37290932", "title": "How to remove redundant spaces/whitespace from a string in Golang?", "body": "<p>Use regexp for this.</p>\n\n<pre><code>func main() {\n    data := []byte(\"   Hello,   World !   \")\n    re := regexp.MustCompile(\"  +\")\n    replaced := re.ReplaceAll(bytes.TrimSpace(data), []byte(\" \"))\n    fmt.Println(string(replaced))\n    // Hello, World !\n}\n</code></pre>\n\n<p>In order to also trim newlines and null characters, you can use the <code>bytes.Trim(src []byte, cutset string)</code> function instead of <code>bytes.TrimSpace</code></p>\n"}, {"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 26, "last_activity_date": 1554799098, "last_edit_date": 1554799098, "creation_date": 1463557880, "answer_id": 37293398, "question_id": 37290693, "link": "https://stackoverflow.com/questions/37290693/how-to-remove-redundant-spaces-whitespace-from-a-string-in-golang/37293398#37293398", "title": "How to remove redundant spaces/whitespace from a string in Golang?", "body": "<p>It seems that you might want to use both <code>\\s</code> shorthand character class and <code>\\p{Zs}</code> Unicode property to match Unicode spaces. However, both steps cannot be done with 1 regex replacement as you need two different replacements, and the <code>ReplaceAllStringFunc</code> only allows a whole match string as argument (I have no idea how to check which group matched).</p>\n\n<p>Thus, I suggest using two regexps:</p>\n\n<ul>\n<li><code>^[\\s\\p{Zs}]+|[\\s\\p{Zs}]+$</code> - to match all leading/trailing whitespace</li>\n<li><code>[\\s\\p{Zs}]{2,}</code>  - to match 2 or more whitespace symbols inside a string</li>\n</ul>\n\n<p>Sample code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    input := \"  \u00a0Text \u00a0\u00a0More here  \u00a0  \"\n    re_leadclose_whtsp := regexp.MustCompile(`^[\\s\\p{Zs}]+|[\\s\\p{Zs}]+$`)\n    re_inside_whtsp := regexp.MustCompile(`[\\s\\p{Zs}]{2,}`)\n    final := re_leadclose_whtsp.ReplaceAllString(input, \"\")\n    final = re_inside_whtsp.ReplaceAllString(final, \" \")\n    fmt.Println(final)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2782, "user_id": 1822711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be72f7002ddb309d9b01bb6aea680b0d?s=128&d=identicon&r=PG", "display_name": "Joe Bergevin", "link": "https://stackoverflow.com/users/1822711/joe-bergevin"}, "edited": false, "score": 3, "creation_date": 1502211553, "post_id": 42251527, "comment_id": 78107609, "body": "great answer if you don&#39;t want to use regex!"}], "tags": [], "owner": {"reputation": 848, "user_id": 908127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee254a88b160a65c40bb13804b1d1a0f?s=128&d=identicon&r=PG", "display_name": "ifross", "link": "https://stackoverflow.com/users/908127/ifross"}, "is_accepted": false, "score": 71, "last_activity_date": 1487167416, "creation_date": 1487167416, "answer_id": 42251527, "question_id": 37290693, "link": "https://stackoverflow.com/questions/37290693/how-to-remove-redundant-spaces-whitespace-from-a-string-in-golang/42251527#42251527", "title": "How to remove redundant spaces/whitespace from a string in Golang?", "body": "<p>You can get quite far just using the <code>strings</code> package as <code>strings.Fields</code> does most of the work for you:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc standardizeSpaces(s string) string {\n    return strings.Join(strings.Fields(s), \" \")\n}\n\nfunc main() {\n    tests := []string{\" Hello,   World  ! \", \"Hello,\\tWorld ! \", \" \\t\\n\\t Hello,\\tWorld\\n!\\n\\t\"}\n    for _, test := range tests {\n        fmt.Println(standardizeSpaces(test))\n    }\n}\n// \"Hello, World !\"\n// \"Hello, World !\"\n// \"Hello, World !\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1604, "user_id": 5030352, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/XfKLZ.jpg?s=128&g=1", "display_name": "empedocle", "link": "https://stackoverflow.com/users/5030352/empedocle"}, "is_accepted": false, "score": 7, "last_activity_date": 1554001723, "creation_date": 1554001723, "answer_id": 55437544, "question_id": 37290693, "link": "https://stackoverflow.com/questions/37290693/how-to-remove-redundant-spaces-whitespace-from-a-string-in-golang/55437544#55437544", "title": "How to remove redundant spaces/whitespace from a string in Golang?", "body": "<p>strings.Fields() splits on any amount of white space, thus:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>strings.Join(strings.Fields(strings.TrimSpace(s)), \" \")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "is_accepted": false, "score": 0, "last_activity_date": 1574007808, "last_edit_date": 1574007808, "creation_date": 1572816249, "answer_id": 58684753, "question_id": 37290693, "link": "https://stackoverflow.com/questions/37290693/how-to-remove-redundant-spaces-whitespace-from-a-string-in-golang/58684753#58684753", "title": "How to remove redundant spaces/whitespace from a string in Golang?", "body": "<p>Avoiding to use time wasting regexp or external library<br>\nI've choose to use plain golang instead of regexp, cause there are special character that are not ASCII in every language.</p>\n\n<p>Go Golang!</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func RemoveDoubleWhiteSpace(str string) string {\n    var b strings.Builder\n    b.Grow(len(str))\n    for i := range str {\n        if !(str[i] == 32 &amp;&amp; (i+1 &lt; len(str) &amp;&amp; str[i+1] == 32)) {\n            b.WriteRune(rune(str[i]))\n        }\n    }\n    return b.String()\n}\n</code></pre>\n\n<p>And the related test</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func TestRemoveDoubleWhiteSpace(t *testing.T) {\n    data := []string{`  test`, `test  `, `te  st`}\n    for _, item := range data {\n        str := RemoveDoubleWhiteSpace(item)\n        t.Log(\"Data -&gt;|\"+item+\"|Found: |\"+str+\"| Len: \", len(str))\n        if len(str) != 5 {\n            t.Fail()\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8404991, "user_type": "registered", "profile_image": "https://graph.facebook.com/1612257838794017/picture?type=large", "display_name": "Siddhartha Dandapat", "link": "https://stackoverflow.com/users/8404991/siddhartha-dandapat"}, "is_accepted": false, "score": 0, "last_activity_date": 1618775346, "last_edit_date": 1618775346, "creation_date": 1618774877, "answer_id": 67152714, "question_id": 37290693, "link": "https://stackoverflow.com/questions/37290693/how-to-remove-redundant-spaces-whitespace-from-a-string-in-golang/67152714#67152714", "title": "How to remove redundant spaces/whitespace from a string in Golang?", "body": "<p>Using single regexp to grab all the space using regexp.MustCompile() and replacing them to single space, and trimming the leading spaces finally.</p>\n<pre><code>    package main\n\n    import (\n        &quot;fmt&quot;\n        &quot;regexp&quot;\n        &quot;strings&quot;\n    )\n    \n    func main() {\n        input := &quot;    Text   More here        &quot;\n        re := regexp.MustCompile(`\\s+`)\n        out := re.ReplaceAllString(input, &quot; &quot;)\n        out = strings.TrimSpace(out)\n        fmt.Println(out)\n    } \n</code></pre>\n<p>Alternatively, using &quot;_&quot; instead of space.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;regexp&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    input := &quot;___Text___More_here______&quot;\n    re := regexp.MustCompile(`_+`)\n    out := re.ReplaceAllString(input, &quot;_&quot;)\n    out = strings.Trim(out, &quot;_&quot;)\n    fmt.Println(out)\n}\n</code></pre>\n"}], "owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23245, "favorite_count": 7, "accepted_answer_id": 37293398, "answer_count": 6, "score": 20, "last_activity_date": 1618775346, "creation_date": 1463547859, "question_id": 37290693, "link": "https://stackoverflow.com/questions/37290693/how-to-remove-redundant-spaces-whitespace-from-a-string-in-golang", "title": "How to remove redundant spaces/whitespace from a string in Golang?", "body": "<p>I was wondering how to remove:</p>\n\n<ul>\n<li>All <strong>leading/trailing</strong> whitespace or new-line characters, null characters, etc.</li>\n<li>Any redundant spaces within a string (ex. \"hello[space][space]world\" would be converted to \"hello[space]world\")</li>\n</ul>\n\n<p>Is this possible with a single Regex, with unicode support for international space characters, etc.?</p>\n"}, {"tags": ["git", "go", "libgit2"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1463555932, "creation_date": 1463555932, "answer_id": 37292720, "question_id": 37289674, "link": "https://stackoverflow.com/questions/37289674/how-to-run-git-log-commands-using-libgit2-in-go/37292720#37292720", "title": "How to run git log commands using libgit2 in GO?", "body": "<p>You could at least emulate a git log by using the <a href=\"https://github.com/libgit2/git2go/pull/29/files\" rel=\"nofollow\"><code>Commit.Parent</code> method</a> which allows to access to the parent of a commit (from <a href=\"https://github.com/libgit2/git2go/blob/8eaae73f85dd3df78df80d2dac066eb0866444ae/commit.go#L57-L65\" rel=\"nofollow\"><code>commit.go</code></a>).</p>\n\n<p>Beside that, I did not see a direct call to git log.</p>\n"}, {"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 3, "last_activity_date": 1463556918, "last_edit_date": 1463556918, "creation_date": 1463556473, "answer_id": 37292888, "question_id": 37289674, "link": "https://stackoverflow.com/questions/37289674/how-to-run-git-log-commands-using-libgit2-in-go/37292888#37292888", "title": "How to run git log commands using libgit2 in GO?", "body": "<p><a href=\"https://godoc.org/github.com/libgit2/git2go#RevWalk\" rel=\"nofollow\">RevWalk</a> is what you are looking for.</p>\n\n<pre><code>repo, err := git.OpenRepository(\"path/to/repository\")\nlog.Println(err)\n\nw, err := repo.Walk() // returns a RevWalk instance for this repo\nlog.Println(err)\n</code></pre>\n\n<p>You can configure the returned <code>RewWalk</code> instance.</p>\n\n<pre><code>err = w.PushHead() // instruct to start from the head commit\nlog.Println(err)\n</code></pre>\n\n<p>If you want to log a different branch you can use <a href=\"https://godoc.org/github.com/libgit2/git2go#RevWalk.PushRef\" rel=\"nofollow\">PushRef</a> instead. There are other configuration options to configure the starting and ending points of the log. Check out documentation for those.</p>\n\n<p>Use the <a href=\"https://godoc.org/github.com/libgit2/git2go#RevWalk.Iterate\" rel=\"nofollow\">Iterate</a> method to go through the commit list. You need to pass it a function that will be called for each commit in the list.</p>\n\n<pre><code>w.Iterate(func(c *git.Commit) bool {\n    fmt.Println(c.Message())\n    return true  // return false when you want to stop iterating\n})\n</code></pre>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 1, "accepted_answer_id": 37292888, "answer_count": 2, "score": 3, "last_activity_date": 1463556918, "creation_date": 1463541549, "question_id": 37289674, "link": "https://stackoverflow.com/questions/37289674/how-to-run-git-log-commands-using-libgit2-in-go", "title": "How to run git log commands using libgit2 in GO?", "body": "<p>I am interested in running git log commands from go. I see that C# version has support for this (<a href=\"https://github.com/libgit2/libgit2sharp/wiki/git-log\" rel=\"nofollow\">https://github.com/libgit2/libgit2sharp/wiki/git-log</a>) . Does the <a href=\"https://github.com/libgit2/git2go\" rel=\"nofollow\">GO version</a> also support for similar git log commands? I did some quick searching for \"query\" and \"filter\" keywords and I did not find anything.</p>\n"}, {"tags": ["go", "operating-system"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1463542823, "post_id": 37289320, "comment_id": 62104093, "body": "implement a <code>io.Writer</code> which write to file and stdout"}], "answers": [{"comments": [{"owner": {"reputation": 2446, "user_id": 5682933, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29d72b97ce20902d21488878741621f3?s=128&d=identicon&r=PG&f=1", "display_name": "Haoyuan Ge", "link": "https://stackoverflow.com/users/5682933/haoyuan-ge"}, "edited": false, "score": 0, "creation_date": 1463549864, "post_id": 37289869, "comment_id": 62106319, "body": "Amazing and elegant!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1463542866, "creation_date": 1463542866, "answer_id": 37289869, "question_id": 37289320, "link": "https://stackoverflow.com/questions/37289320/how-to-print-to-stdout-while-save-the-stdout-to-string-at-the-same-time-in-golan/37289869#37289869", "title": "How to print to stdout while save the stdout to string at the same time in golang?", "body": "<p>Usa a <a href=\"https://golang.org/pkg/io/#MultiWriter\" rel=\"nofollow\">MultiWriter</a>:</p>\n\n<pre><code>cmd := exec.Command(someCommand)\nvar buf bytes.Buffer\ncmd.Stdout = io.MultiWriter(os.Stdout, &amp;buf)\ncmd.Run()\nsave(buf.Bytes())  // Bytes() returns a []byte containing the stdout from the commmand. \n</code></pre>\n"}], "owner": {"reputation": 2446, "user_id": 5682933, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29d72b97ce20902d21488878741621f3?s=128&d=identicon&r=PG&f=1", "display_name": "Haoyuan Ge", "link": "https://stackoverflow.com/users/5682933/haoyuan-ge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 37289869, "answer_count": 1, "score": 1, "last_activity_date": 1463542866, "creation_date": 1463539145, "question_id": 37289320, "link": "https://stackoverflow.com/questions/37289320/how-to-print-to-stdout-while-save-the-stdout-to-string-at-the-same-time-in-golan", "title": "How to print to stdout while save the stdout to string at the same time in golang?", "body": "<p>What I want to do is like:</p>\n\n<pre><code>cmd := exec.Command(someCommand)\ncmd.Stdout = os.Stdout\ncmd.Run()\nsave(os.Stdout)\n</code></pre>\n\n<p>Because this command takes a long time executing, I want to print results on the screen immediately. So I do not want to use <code>result := cmd.Output() fmt.Print(result)</code> to save the output and then print</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 3, "last_activity_date": 1463528767, "creation_date": 1463528767, "answer_id": 37287959, "question_id": 37287893, "link": "https://stackoverflow.com/questions/37287893/how-to-use-a-slice-as-a-stack-in-a-loop/37287959#37287959", "title": "How to use a slice as a stack in a loop", "body": "<p><code>:=</code> only assigns a new value to an existing variable if the variable was declared earlier <em>in the same block</em> and has the correct type. Otherwise, it creates a new variable. Since your loop is a new block, with a new scope, you get a new <code>stack</code>, which is then never used for anything. There's no way to \"halfway\" do a <code>:=</code>, so you simply can't have a one-liner here. You'll have to</p>\n\n<pre><code>var a int\na, stack = stack[len(stack)-1], stack[:len(stack)-1]\n</code></pre>\n\n<p>or else create a type and a method (with the stack as a pointer receiver) so that you can</p>\n\n<pre><code>a := stack.Pop()\n</code></pre>\n"}], "owner": {"reputation": 448, "user_id": 6253321, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34792a0922a91eacb20efe6b49db95e4?s=128&d=identicon&r=PG&f=1", "display_name": "cpp beginner", "link": "https://stackoverflow.com/users/6253321/cpp-beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 37287959, "answer_count": 1, "score": 0, "last_activity_date": 1463528767, "creation_date": 1463528384, "question_id": 37287893, "link": "https://stackoverflow.com/questions/37287893/how-to-use-a-slice-as-a-stack-in-a-loop", "title": "How to use a slice as a stack in a loop", "body": "<p>I am using a slice as a stack.</p>\n\n<p>When I do this</p>\n\n<pre><code>stack := make([]int, 0)\nstack = append(stack, 1, 2, 3, 4, 5)\nfor len(stack) != 0 {\n    var a int\n    a, stack = stack[len(stack) - 1], stack[:len(stack) - 1]\n    fmt.Print(a)\n}\n</code></pre>\n\n<p>I get the output</p>\n\n<pre><code>54321\n</code></pre>\n\n<p>as expected.</p>\n\n<p>When I do this</p>\n\n<pre><code>stack := make([]int, 0)\nstack = append(stack, 1, 2, 3, 4, 5)\na, stack := stack[len(stack) - 1], stack[:len(stack) - 1]\nfmt.Println(a, len(stack))\n</code></pre>\n\n<p>I get the output</p>\n\n<pre><code>5 4\n</code></pre>\n\n<p>as expected. However, when I try to combine these by doing this</p>\n\n<pre><code>stack := make([]int, 0)\nstack = append(stack, 1, 2, 3, 4, 5)\nfor len(stack) != 0 {\n    a, stack := stack[len(stack) - 1], stack[:len(stack) - 1]\n    fmt.Print(a)\n}\n</code></pre>\n\n<p>the result is a compile error</p>\n\n<blockquote>\n  <p>unused variable 'stack'</p>\n</blockquote>\n\n<p>This confuses me. I thought I could use <code>:=</code> as long as at least one of the variables is being declared (in this case <code>a</code>), and that <code>stack</code> would just get reassigned. However I am clearly wrong. Can anybody explain why the line</p>\n\n<pre><code>a, stack := stack[len(stack) - 1], stack[:len(stack) - 1]\n</code></pre>\n\n<p>doesn't work in the loop, and how I can do \"pop\" as a one-liner in a loop?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1463533214, "post_id": 37287567, "comment_id": 62101797, "body": "Recommended questions+answers to learn how to serve static files: 1. <a href=\"http://stackoverflow.com/questions/28899675\">Include js file in Go template</a>; 2. <a href=\"http://stackoverflow.com/questions/28745161\">With golang webserver where does the root of the website map onto the filesystem</a>; 3.<a href=\"http://stackoverflow.com/questions/27945310\">Why do I need to use http.StripPrefix to access my static files?</a>; 4. <a href=\"http://stackoverflow.com/questions/36540610\">How to serve http partial content with Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "edited": false, "score": 0, "creation_date": 1463527494, "post_id": 37287699, "comment_id": 62100517, "body": "How&#39;d you know to call the ServeHTTP method?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "edited": false, "score": 1, "creation_date": 1463529008, "post_id": 37287699, "comment_id": 62100860, "body": "@AlanStorm I highly recommend going through <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a> to get a better understanding of the language."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 3, "last_activity_date": 1463528881, "last_edit_date": 1463528881, "creation_date": 1463526954, "answer_id": 37287699, "question_id": 37287567, "link": "https://stackoverflow.com/questions/37287567/in-go-manually-invoke-an-http-fileserver-and-or-what-is-an-http-handler/37287699#37287699", "title": "In go, Manually Invoke an http.FileServer and/or What is an http Handler", "body": "<p>Use <code>http.FileServer(http.Dir(\"./static/foo\")).ServeHTTP(w, req)</code>.</p>\n\n<p>//edit</p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow\"><code>http.FileServer</code></a> returns an <a href=\"https://golang.org/pkg/net/http/#Handler\" rel=\"nofollow\"><code>http.Handler</code></a> which in turn provides the <code>ServerHTTP</code> method.</p>\n"}], "owner": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "accepted_answer_id": 37287699, "answer_count": 1, "score": 0, "last_activity_date": 1463529053, "creation_date": 1463526101, "last_edit_date": 1463529053, "question_id": 37287567, "link": "https://stackoverflow.com/questions/37287567/in-go-manually-invoke-an-http-fileserver-and-or-what-is-an-http-handler", "title": "In go, Manually Invoke an http.FileServer and/or What is an http Handler", "body": "<p>I'm an experienced programmer, but new to go.  Apologies in advance if this is an obvious question or well tread path.  I'm still getting my bearings in the language and its semantics. </p>\n\n<p>I'm trying to create a web server in go that</p>\n\n<ol>\n<li>Examines the HTTP request</li>\n<li>Based on the results of the request, serves a <strong>specific</strong> static folder</li>\n</ol>\n\n<p>i.e., something where the simplified pseudo code looks like</p>\n\n<pre><code>import (\n    \"io\"\n    \"net/http\"\n    \"fmt\"\n    \"strings\"\n    \"encoding/base64\"\n)\n\nfunc examineRequest(request *http.Request) {\n    //looks at request header\n    if(request headers have one thing){\n        return \"foo\"\n    }\n    return \"bar\"\n}\n\nfunc processRequest(responseWriter http.ResponseWriter, request *http.Request) {\n    folderToServe = examineRequest(request);\n    if folderToServe == \"bar\" {\n        //serve static files from the ./static/bar folder\n\n        //go freaks out if I try these\n        //http.Handle(\"/\", http.FileServer(http.Dir(\"./static/bar\")))      \n        //http.FileServer(http.Dir(\"./static/bar\")()\n\n    }\n    else if folderToServer == \"foo\" {\n        //serve static files from the ./static/foo folder\n\n        //go freaks out if I try these\n        //http.Handle(\"/\", http.FileServer(http.Dir(\"./static/foo\")))      \n        //http.FileServer(http.Dir(\"./static/foo\")()\n    }\n}\n\nfunc main(){\n    http.HandleFunc(\"/\", processRequest)  \n    //http.Handle(\"/\", http.FileServer(http.Dir(\"./static\")))      \n}\n</code></pre>\n\n<p>Experienced go programmers may have already spotted the problem.  I'm performing my examination in processRequest, and because of that, its too late to to call Handle -- however, you can't register more than one handle for the same path in go, and nested handle calls freak go out.</p>\n\n<p>I though the handler might be similar to an anonymous function in other languages and tried call it -- but go did like that either.</p>\n\n<p>So -- is there a way to manually invoke the handler returned from the call to <code>http.FileServer(http.Dir(\"./static\"))</code>?  </p>\n\n<p>Is that even the right question to be asking here?</p>\n\n<p>What exactly is a handler in the context of the http module?</p>\n"}, {"tags": ["go", "import"], "answers": [{"comments": [{"owner": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "edited": false, "score": 0, "creation_date": 1463523470, "post_id": 37286975, "comment_id": 62099285, "body": "Thank you -- I had an (incorrect) assumption that only types and functions were exported -- I didn&#39;t realize plain old variables would be as well!  That makes a lot more sense now."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 2, "last_activity_date": 1463522682, "creation_date": 1463522682, "answer_id": 37286975, "question_id": 37286793, "link": "https://stackoverflow.com/questions/37286793/what-is-stdencoding-in-the-go-base64-package/37286975#37286975", "title": "What is &quot;StdEncoding&quot; in the Go Base64 Package", "body": "<p>To try and answer all of your questions at once... You can find the definition of <code>StdEncoding</code> in the file base64.go it's contained here;</p>\n\n<pre><code>65  // StdEncoding is the standard base64 encoding, as defined in\n66  // RFC 4648.\n67  var StdEncoding = NewEncoding(encodeStd)\n</code></pre>\n\n<p>and up on line 33 that const is defined as such;</p>\n\n<pre><code>33  const encodeStd = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n</code></pre>\n\n<p>So to answer your main question, it is just base64 encoding as defined in RFC 4648. The type is <code>*Encoding</code> and you can even view the implementation of <code>NewEncoding</code> in the same location if you'd like. <a href=\"https://golang.org/src/encoding/base64/base64.go\" rel=\"nofollow\">https://golang.org/src/encoding/base64/base64.go</a></p>\n\n<p>To address some of the auxiliary questions about packages/modules and exporting... In the go docs you'll see everything that is exported and nothing that is unexported (if you look at the actual source you'll usually find a good deal of unexported helper methods). If you were looking at the source you can see this distinction in the names of methods/types/consts ect. The basic rule is, if the identifier starts with a capital letter then it is exported, if it's lower cased then it is not exported. </p>\n\n<p>One other thing worth pointing out is that is that the language is open source. In the docs it will typically list the packages main file (possibly others as well) so you can open it up and have a look. You'll find the code is well commented and usually pretty easy to understand. Often times you'll find answers to questions about how things work internally just by reading the comments in these files.</p>\n"}], "owner": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 37286975, "answer_count": 1, "score": 1, "last_activity_date": 1463522682, "creation_date": 1463521831, "question_id": 37286793, "link": "https://stackoverflow.com/questions/37286793/what-is-stdencoding-in-the-go-base64-package", "title": "What is &quot;StdEncoding&quot; in the Go Base64 Package", "body": "<p>I'm an experienced programmer, but new to go, so apologies in advance for what I'm sure is an easy question. </p>\n\n<p>The <a href=\"https://golang.org/pkg/encoding/base64/\" rel=\"nofollow\">base64 example code</a> on the <code>goland.org</code> site includes the following code.  </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n    msg := \"Hello, \u4e16\u754c\"\n    encoded := base64.StdEncoding.EncodeToString([]byte(msg))\n    fmt.Println(encoded)\n    decoded, err := base64.StdEncoding.DecodeString(encoded)\n    if err != nil {\n        fmt.Println(\"decode error:\", err)\n        return\n    }\n    fmt.Println(string(decoded))\n}\n</code></pre>\n\n<p>I can copy and use this code without issue, but as a new go programmer, I don't understand <em>what</em> that <code>StdEncoding</code> part of the following lines does</p>\n\n<pre><code> decoded, err := base64.StdEncoding.DecodeString(encoded)\n</code></pre>\n\n<p>I understand the above program imports the <code>encode/base64</code> functions into my program.  However, if I <a href=\"https://golang.org/pkg/encoding/base64/#pkg-variables\" rel=\"nofollow\">look at the documentation</a>, the base64 package consists of the following types and functions</p>\n\n<pre><code>func NewDecoder(enc *Encoding, r io.Reader) io.Reader\nfunc NewEncoder(enc *Encoding, w io.Writer) io.WriteCloser\ntype CorruptInputError\n    func (e CorruptInputError) Error() string\ntype Encoding\n    func NewEncoding(encoder string) *Encoding\n    func (enc *Encoding) Decode(dst, src []byte) (n int, err error)\n    func (enc *Encoding) DecodeString(s string) ([]byte, error)\n    func (enc *Encoding) DecodedLen(n int) int\n    func (enc *Encoding) Encode(dst, src []byte)\n    func (enc *Encoding) EncodeToString(src []byte) string\n    func (enc *Encoding) EncodedLen(n int) int\n    func (enc Encoding) WithPadding(padding rune) *Encoding\n</code></pre>\n\n<p>I would expect to see a type of <code>StdEncoding</code> -- but I don't see any mention of a <code>StdEncoding</code> in this list. </p>\n\n<p>So, my immediate question is -- what is <code>StdEncoding</code>?</p>\n\n<p>My higher level question is probably -- what, exactly, is exported from a module for consumption by a user of that module, and how can I, as a go user, browse those exported things. </p>\n\n<p>Bonus points if you can correct any unwitting misuse of terms like module, export, import above and put them into a go context. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 5, "creation_date": 1463518631, "post_id": 37286062, "comment_id": 62097162, "body": "&quot;I have not found where Get() is defined&quot; - but you define it. It&#39;s right there, under the comment that says <code>Defines a method &quot;Get() uint64&quot; for value Binary</code>. Why are you confused?"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 2, "creation_date": 1463518857, "post_id": 37286062, "comment_id": 62097282, "body": "<code>Binary(200)</code> doesn&#39;t call <code>Get</code>, that&#39;s type conversion since <code>Binary</code> is an alias for <code>uint64</code>. <code>Stringer(b)</code> doesn&#39;t call anything, that&#39;s type conversion since <code>Binary</code> implements <code>Stringer</code> interface."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1463519211, "post_id": 37286193, "comment_id": 62097441, "body": "no it doesn&#39;t. <code>fmt.Println(Binary(200))</code> calls the Binary.String method, and prints <code>11001000</code>"}, {"owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463519255, "post_id": 37286193, "comment_id": 62097452, "body": "Doh. you&#39;re right. focused on the get part. I will fix this asap as because of this my answer is dead wrong"}], "tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 0, "last_activity_date": 1463519730, "last_edit_date": 1463519730, "creation_date": 1463518974, "answer_id": 37286193, "question_id": 37286062, "link": "https://stackoverflow.com/questions/37286062/who-is-defining-the-get-method-for-the-type-conversion-golang-itself/37286193#37286193", "title": "Who is defining the Get() Method for the type conversion?? Golang itself?", "body": "<p>Actually, you have created an alias for uint64, so when you cast the number 200, its primitive value is still a uint64, but your custom Binary type allows you to spruce it up with methods that you can define on your custom type. </p>\n\n<p>The Get() method isn't being called when you cast, you're just telling Go runtime to treat this as a Binary type rather than a base uint64. In fact, the Get() method is actually redundant as you could just pass this around as if it were a uint64 and you didn't have the String() method for satisfying the stringer interface the primitive value will be printed out if you did fmt.Println(b)</p>\n\n<pre><code>fmt.Println(200) //prints 200\nfmt.Println(Binary(200)) // also prints 200\n</code></pre>\n\n<p>As JimB said, This won't occur with the String method defined.</p>\n\n<p>To clarify further, the Get method is being utilized by the String() method which is needed for this type to satisfy the Stringer interface requirement. When you use a function or method that utilizes a Stringer, this is where String() and hence Get() are called. If this is still wrong let me know asap in comments</p>\n"}], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1463519730, "creation_date": 1463518390, "question_id": 37286062, "link": "https://stackoverflow.com/questions/37286062/who-is-defining-the-get-method-for-the-type-conversion-golang-itself", "title": "Who is defining the Get() Method for the type conversion?? Golang itself?", "body": "<p>SEE: \n    // Defines a method \"Get() uint64\" for value Binary\n    func (i Binary) Get() uint64 {\n    return uint64(i)\n    }</p>\n\n<p>We define a method Get() and apparently <strong>b := Binary(200)</strong> executes it,\nbut where is the connection between then.  I have not found where Get() is defined and I assume that this definition is overlaying an internal definition, or am I wrong.  </p>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\n// This defines a interface with one method: \"String() string\"\ntype Stringer interface {\n    String() string\n}\n\n// Defines an unsigned 64 bit number\ntype Binary uint64\n\n// Defines a method \"String() string\" for value Binary\nfunc (i Binary) String() string {\n    return strconv.FormatUint(i.Get(), 2)\n}\n\n// Defines a method \"Get() uint64\" for value Binary\nfunc (i Binary) Get() uint64 {\n    return uint64(i)\n}\n\n// Main program\nfunc main() {\n    b := Binary(200) // Create Unsigned value of 200\n\n    s := Stringer(b) // Calls interface \"Stringer\" on \"b\"\n\n    fmt.Println(s.String()) // \"s\" is an Stringer Interface Type\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5881069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKNyT.png?s=128&g=1", "display_name": "Blaize", "link": "https://stackoverflow.com/users/5881069/blaize"}, "edited": false, "score": 0, "creation_date": 1463524566, "post_id": 37286186, "comment_id": 62099681, "body": "I agree #2 doesn&#39;t match the idea.  #1 has promise but breaks all other users of the library.  So perhaps I suggest a new generic handler adder with the interface{} and change the current one to call it.  So now the base form is generic, but the external interface remains the same for people who dont extend the type. <a href=\"https://play.golang.org/p/QIZ90CiHFu\" rel=\"nofollow noreferrer\">play.golang.org/p/QIZ90CiHFu</a>"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 21, "user_id": 5881069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKNyT.png?s=128&g=1", "display_name": "Blaize", "link": "https://stackoverflow.com/users/5881069/blaize"}, "edited": false, "score": 0, "creation_date": 1463526192, "post_id": 37286186, "comment_id": 62100175, "body": "Glad it helped. If your new solution suits your needs, then it&#39;s fine."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 0, "last_activity_date": 1463518950, "creation_date": 1463518950, "answer_id": 37286186, "question_id": 37285439, "link": "https://stackoverflow.com/questions/37285439/how-to-embed-a-type-when-it-has-handler-functions/37286186#37286186", "title": "How to embed a type when it has handler functions?", "body": "<p>You are right, you cannot do that because a mamal is not an Animal. There is no inheritance in go so this is not a solution. But you can achieve this behaviour with interfaces. By the way, your code does not work because you didn't initialize the feeders map, so you will get a problem after compilation.</p>\n\n<p><strong>Solution 1: Use type assertion</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Animal struct {\n    Color   string\n    feeders map[string]feeder\n}\ntype feeder func(interface{}, string) string\n\nfunc (a *Animal) addFeeder(name string, fn feeder) {\n    a.feeders[name] = fn\n}\n\ntype mamal struct {\n    Animal\n    hair string\n}\n\nfunc feedHuman(i interface{}, food string) string {\n    m := i.(mamal)\n    return \"you got \" + m.Color + \" \" + m.hair + \" hair in your \" + food\n}\n\nfunc main() {\n    a := mamal{Animal{feeders: make(map[string]feeder), Color: \"red\"}, \"bushy\"}\n    a.addFeeder(\"man\", feedHuman)\n    fmt.Println(a.feeders[\"man\"](a, \"pineapple\"))\n    // =&gt; you got red bushy hair in your pineapple\n}\n</code></pre>\n\n<p>This is a bit dangerous because if the interface you pass is not a mamal, it will panic.</p>\n\n<p><strong>Second solution: Use a Feeder interface</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Feeder interface {\n    Feed(string) string\n}\n\ntype Animal struct {\n    Color   string\n    feeders map[string]Feeder\n}\n\nfunc (a *Animal) addFeeder(name string, feeder Feeder) {\n    a.feeders[name] = feeder\n}\n\ntype mamal struct {\n    Animal\n    hair string\n}\n\nfunc (m *mamal) Feed(food string) string {\n    return \"you got \" + m.Color + \" \" + m.hair + \" hair in your \" + food\n}\n\nfunc main() {\n    a := &amp;mamal{Animal{Color: \"red\", feeders: make(map[string]Feeder)}, \"bushy\"}\n    a.addFeeder(\"man\", a)\n    fmt.Println(a.feeders[\"man\"].Feed(\"pineapple\"))\n    // you got red bushy hair in your pineapple\n}\n</code></pre>\n\n<p>Though it works just as fine, it limits the number of handlers to one, so I do not think this is what you seek.</p>\n"}], "owner": {"reputation": 21, "user_id": 5881069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKNyT.png?s=128&g=1", "display_name": "Blaize", "link": "https://stackoverflow.com/users/5881069/blaize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1463518950, "creation_date": 1463515997, "question_id": 37285439, "link": "https://stackoverflow.com/questions/37285439/how-to-embed-a-type-when-it-has-handler-functions", "title": "How to embed a type when it has handler functions?", "body": "<p>I'm working with a library that implements a type which accepts handlers and calls them for you when it should.  I'd like to create a supertype that embeds the type and has properties beyond what the embedded type does.\nAnd I'd like to be able to use these properties in a handler.</p>\n\n<p>Using my type as an argument fails the type checking, using the base type in handler decl works, but then I cant access the new fields.  I am new to go, &amp; would love to know how to do this, or what to suggest in changing the library to enable (Interfaces instead of the handler decl?)...</p>\n\n<p>Contrived example:</p>\n\n<pre><code>    package main\n\n    type Animal struct {\n        Color   string\n        feeders map[string]feeder\n    }\n    type feeder func(*Animal, string) string\n\n    func (a *Animal) addFeeder(name string, fn feeder) {\n        a.feeders[name] = fn\n    }\n\n    type mamal struct {\n        Animal\n        hair string\n    }\n\n    func feedHuman(m *mamal, food string) string {\n        return \"you got \" + m.Color + \" \" + m.hair + \" hair in your \" + food\n    }\n\n    func main() {\n        a := mamal{Animal{Color: \"red\"}, \"bushy\"}\n        a.addFeeder(\"man\", feedHuman)\n        // fails to compile feedHuman needs to take *Animal but then cant access hair\"\n    }\n</code></pre>\n"}, {"tags": ["go", "orm", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 7889837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZydeTRQCx28/AAAAAAAAAAI/AAAAAAAAfec/4wx6d_e0UIU/photo.jpg?sz=128", "display_name": "sreekar reddy", "link": "https://stackoverflow.com/users/7889837/sreekar-reddy"}, "is_accepted": false, "score": 1, "last_activity_date": 1503927502, "creation_date": 1503927502, "answer_id": 45920433, "question_id": 37284532, "link": "https://stackoverflow.com/questions/37284532/golang-gorm-and-several-tables-associations/45920433#45920433", "title": "Golang GORM and several tables associations", "body": "<p>Loading the foreign key related tables using ORM is called as <strong>Eager Loading</strong>. EagerLoading is off by default in GORM by using <code>Find()</code>. Better use <code>Preload()</code> for loading the nested data.</p>\n\n<p>Link for official documentation - <a href=\"http://jinzhu.me/gorm/crud.html#preloading-eager-loading\" rel=\"nofollow noreferrer\">http://jinzhu.me/gorm/crud.html#preloading-eager-loading</a></p>\n"}], "owner": {"reputation": 153, "user_id": 4489257, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/755572e35afde5bf222b3096a3b9d36b?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Lis", "link": "https://stackoverflow.com/users/4489257/maxim-lis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1503927502, "creation_date": 1463512603, "last_edit_date": 1467144748, "question_id": 37284532, "link": "https://stackoverflow.com/questions/37284532/golang-gorm-and-several-tables-associations", "title": "Golang GORM and several tables associations", "body": "<p>Structs:</p>\n\n<pre><code>type (\n  User struct{\n    ID int64\n    Name string\n  }\n  Group struct{\n    ID int64\n    Name string\n    Users []User\n  }\n)\n</code></pre>\n\n<p>I Insert width:</p>\n\n<pre><code>users := []User{}\nuser := User{ID: int64(1)}\ngormConn.First(&amp;user) // .Error is nil, user with ID=1 exists\nusers = append(users, user)\n\ngroup := Group{\n  Name: \"Grrr\",\n  Users: users,\n}\ngormConn.Create(&amp;group)\n</code></pre>\n\n<p>But when I call <code>gormConn.Find(&amp;groups)</code>, I will get <code>[{id: 1, name: \"Grrr\", users: null}]</code> instead of <code>[{id: 1, name: \"Grrr\", users: [{id:1, name: \"Usr\"}]}]</code></p>\n\n<p>Also in SQL table <code>groups</code> column <code>users</code> not found.\n(all structs will <code>gormConn.AutoMigrate</code>)</p>\n"}, {"tags": ["go", "kubernetes", "glog"], "answers": [{"comments": [{"owner": {"reputation": 5435, "user_id": 1837431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgWi1.jpg?s=128&g=1", "display_name": "Tim Allclair", "link": "https://stackoverflow.com/users/1837431/tim-allclair"}, "edited": false, "score": 0, "creation_date": 1542828481, "post_id": 37307780, "comment_id": 93712681, "body": "Note that Kubernetes just moved to a fork of glog (k8s.io/klog), in part to address some of these issues."}], "tags": [], "owner": {"reputation": 5435, "user_id": 1837431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgWi1.jpg?s=128&g=1", "display_name": "Tim Allclair", "link": "https://stackoverflow.com/users/1837431/tim-allclair"}, "is_accepted": false, "score": 4, "last_activity_date": 1463597111, "creation_date": 1463597111, "answer_id": 37307780, "question_id": 37284423, "link": "https://stackoverflow.com/questions/37284423/glog-flag-redefined-error/37307780#37307780", "title": "glog flag redefined error", "body": "<p>That error doesn't have to do with conflicting libraries, it is a conflicting flag (<code>log_dir</code>). It means you're adding a \"--log_dir\" flag, and the glog library used by kubernetes also has a <code>log_dir</code> flag. This is a problem with adding flags in libraries during package init. Unfortunately vendoring won't change anything. You might be able to work around this by manipulating the <code>flag.CommandLine</code> global variable to point to a different <code>flag.FlagSet</code> when you import your log library or kubernetes, but that will be tricky since it depends on import ordering.</p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 5459234, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ff9oD0FE-Pc/AAAAAAAAAAI/AAAAAAAAAAo/J_5Ie-DUDXk/photo.jpg?sz=128", "display_name": "Jefferson Girao", "link": "https://stackoverflow.com/users/5459234/jefferson-girao"}, "is_accepted": false, "score": 3, "last_activity_date": 1466535733, "creation_date": 1466535733, "answer_id": 37952580, "question_id": 37284423, "link": "https://stackoverflow.com/questions/37284423/glog-flag-redefined-error/37952580#37952580", "title": "glog flag redefined error", "body": "<p>I faced a similar issue when vendorizing my dependencies using glide. </p>\n\n<p>According to <a href=\"https://github.com/kubernetes/kubernetes/issues/25572\" rel=\"nofollow\">https://github.com/kubernetes/kubernetes/issues/25572</a> kubernetes does not have a glide.lock / glide.yml, dependency flattening does not happen and in the end glog gets defined twice since vendor/k8s.io/kubernetes/vendor is also included. </p>\n\n<p>The workaround from the aformentioned link worked good to me:</p>\n\n<p><code>glide install --strip-vendor --strip-vcs</code></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3141983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dd5a78e4e187f74258a0ae0e03df2c4?s=128&d=identicon&r=PG&f=1", "display_name": "Tong", "link": "https://stackoverflow.com/users/3141983/tong"}, "is_accepted": false, "score": 3, "last_activity_date": 1474472593, "creation_date": 1474472593, "answer_id": 39621063, "question_id": 37284423, "link": "https://stackoverflow.com/questions/37284423/glog-flag-redefined-error/39621063#39621063", "title": "glog flag redefined error", "body": "<p>I use k8s library and faced <code>flag redefined: log_dir</code> problem too.\nI found several packages of kubernetes are not in my vendor.Then I <code>govendor add</code> them, then it was fixed.</p>\n\n<p>I guess two copy of glog was built (one in my vendor folder, one in k8s.io/kubernetes/vendor in my $GOPATH ) when those packages are not found in my vendor folder.</p>\n\n<p>How to find out missing packages? I use stupid way, rename $GOPATH/src/k8s.io to something else and build my project, see what was not found.Then add it~</p>\n"}, {"tags": [], "owner": {"reputation": 1125, "user_id": 1357375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48962bedad55cfb49df3d52521a913d5?s=128&d=identicon&r=PG", "display_name": "Vishal Kanaujia", "link": "https://stackoverflow.com/users/1357375/vishal-kanaujia"}, "is_accepted": false, "score": 1, "last_activity_date": 1553585945, "creation_date": 1553585945, "answer_id": 55351958, "question_id": 37284423, "link": "https://stackoverflow.com/questions/37284423/glog-flag-redefined-error/55351958#55351958", "title": "glog flag redefined error", "body": "<p>I was seeing <code>flag redefined: log_dir</code> error and the stack trace pointed <code>glog/glog_file.go:41 +0xd3</code>. </p>\n\n<p>The root cause of the problem was the <code>GOPATH</code>. </p>\n\n<p>I had two copies of the same repo at different locations. While trying to run tests in one of the copies, the go package was picked from the other repo. So I had two definitions of everything in <code>glog</code>.</p>\n\n<p>I renamed the other repo to a new name, and then it started working. </p>\n\n<p>So, please check your <code>GOPATH</code> and make sure you are not importing libraries from somewhere else.</p>\n"}], "owner": {"reputation": 173, "user_id": 2392336, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XN6Gm.jpg?s=128&g=1", "display_name": "Smithsonian", "link": "https://stackoverflow.com/users/2392336/smithsonian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12198, "favorite_count": 1, "answer_count": 4, "score": 16, "last_activity_date": 1553585945, "creation_date": 1463512216, "question_id": 37284423, "link": "https://stackoverflow.com/questions/37284423/glog-flag-redefined-error", "title": "glog flag redefined error", "body": "<p>I am using glog flag log_dir in my project. Recently I imported kubernetes library and started getting this runtime panic</p>\n\n<p>panic: ./aaa.test flag redefined: log_dir</p>\n\n<pre><code>May 16 23:51:35 ecmdev03-core01 docker[26867]: goroutine 1 [running]:\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: panic(0x15ebc60, 0xc8201aae90)\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /usr/local/go/src/runtime/panic.go:464 +0x3e6\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: flag.(*FlagSet).Var(0xc8200160c0, 0x7f561118c1c0, 0xc8201aae40, 0x1bddd70, 0x7, 0x1d75860, 0x2f)\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /usr/local/go/src/flag/flag.go:776 +0x454\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: flag.(*FlagSet).StringVar(0xc8200160c0, 0xc8201aae40, 0x1bddd70, 0x7, 0x0, 0x0, 0x1d75860, 0x2f)\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /usr/local/go/src/flag/flag.go:679 +0xc7\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: flag.(*FlagSet).String(0xc8200160c0, 0x1bddd70, 0x7, 0x0, 0x0, 0x1d75860, 0x2f, 0xc8201aae30)\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /usr/local/go/src/flag/flag.go:692 +0x83\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: flag.String(0x1bddd70, 0x7, 0x0, 0x0, 0x1d75860, 0x2f, 0xba3950)\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /usr/local/go/src/flag/flag.go:699 +0x5f\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: k8s.io/kubernetes/vendor/github.com/golang/glog.init()\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /src/ecm_infra/go/src/k8s.io/kubernetes/vendor/github.com/golang/glog/glog_file.go:41 +0x13e\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: k8s.io/kubernetes/pkg/labels.init()\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /src/ecm_infra/go/src/k8s.io/kubernetes/pkg/labels/selector.go:810 +0x6b\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: k8s.io/kubernetes/pkg/api/unversioned.init()\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /src/ecm_infra/go/src/k8s.io/kubernetes/pkg/api/unversioned/well_known_labels.go:30 +0x6f\nMay 16 23:51:35 ecmdev03-core01 docker[26867]: k8s.io/kubernetes/pkg/api.init()\nMay 16 23:51:35 ecmdev03-core01 docker[26867]:         /src/ecm_infra/go/src/k8s.io/kubernetes/pkg/api/types.go:2731 +0x64\n</code></pre>\n\n<p>It looks like glog library which is vendored by k8s is conflicting with the one that I am using. Is introducing vendor directory a solution for this problem? Should I use vendoring libraries like glide, govendor, gb etc? If yes, which one is preferred? </p>\n"}, {"tags": ["mongodb", "go", "mgo", "beego"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 1, "creation_date": 1463513062, "post_id": 37284379, "comment_id": 62094311, "body": "Please put the relevant code in the question itself. You can&#39;t expect others go through your entire project&#39;s code."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 1, "creation_date": 1463537463, "post_id": 37284379, "comment_id": 62102799, "body": "This is not very nice to let the viewers go through your github project in order to solve your issue, you should provide a minimal example of the code you think is incriminated."}], "answers": [{"tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 0, "last_activity_date": 1463537346, "creation_date": 1463537346, "answer_id": 37289068, "question_id": 37284379, "link": "https://stackoverflow.com/questions/37284379/getting-fields-blank-in-golang-mgo/37289068#37289068", "title": "getting fields blank in golang mgo", "body": "<p>Read beego's documentation and examples. In order to serve json, you have to add <code>json</code> tags to your model.</p>\n\n<p>If this does not solve your problem, it means beego automatically removes zero value from your structure from being marshalled. In this case, you are more likely to find help from beego's developer rather than from StackOverflow.</p>\n"}], "owner": {"reputation": 45, "user_id": 5336597, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153569973489334/picture?type=large", "display_name": "Sourabh Jain", "link": "https://stackoverflow.com/users/5336597/sourabh-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1463537346, "creation_date": 1463512050, "question_id": 37284379, "link": "https://stackoverflow.com/questions/37284379/getting-fields-blank-in-golang-mgo", "title": "getting fields blank in golang mgo", "body": "<p>I was trying few exapmles using beego with mongo.\nyou can find my source at :\n<a href=\"https://github.com/wsourabh/bapi\" rel=\"nofollow\">https://github.com/wsourabh/bapi</a> </p>\n\n<p>but while calling the \nv1/accounts/:id</p>\n\n<p>I am always getting the response as </p>\n\n<pre><code>curl -v localhost:8080/v1/accounts/0df542560fbfc39a4bdb24d0ca44d37e\n*   Trying 127.0.0.1...\n* Connected to localhost (127.0.0.1) port 8080 (#0)\n&gt; GET /v1/accounts/0df542560fbfc39a4bdb24d0ca44d37e HTTP/1.1\n&gt; Host: localhost:8080\n&gt; User-Agent: curl/7.43.0\n&gt; Accept: */*\n&gt; \n&lt; HTTP/1.1 200 OK\n&lt; Content-Length: 46\n&lt; Content-Type: application/json; charset=utf-8\n&lt; Server: beegoServer:1.6.1\n&lt; Date: Tue, 17 May 2016 18:53:50 GMT\n&lt; \n{\n  \"Id\": \"0df542560fbfc39a4bdb24d0ca44d37e\"\n* Connection #0 to host localhost left intact\n}\n</code></pre>\n\n<p>other fields are coming as blank. can someone guide me how to do it correctly. </p>\n\n<p>I want to have output something like </p>\n\n<pre><code>{\n\"_id\":\"account_id\",\n\"created\":\"created_date\",\n\"updated\":\"updated_date\",\n\"email\": \"wsourabh@aaa.com\"\n\"wcd_guid\" : \"some_id\"\n\"name\":\n    {\n      \"full\" :\"sourabh J\",\n      \"last\" : \"J\",\n      \"first\" :\"sourabh\"\n     }\n\"country\": \"IN\",\n\"status\": \"new\"\n}\n</code></pre>\n\n<p>while enabling the debug for mgo , I am getting the debug log as :</p>\n\n<pre><code>MGO: session.go:3062: Query 0xc820378900 document unmarshaled: &amp;models.Accounts{Id:\"0df542560fbfc39a4bdb24d0ca44d37e\", created:\"\", updated:\"\", email:\"\", wcd_guid:\"\", name:(*models.Name)(nil), country:\"\", status:\"\"}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10797, "user_id": 269106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vQlAg.jpg?s=128&g=1", "display_name": "AlexBrand", "link": "https://stackoverflow.com/users/269106/alexbrand"}, "edited": false, "score": 4, "creation_date": 1463508083, "post_id": 37282960, "comment_id": 62091712, "body": "See <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/PackageManagementTools</a>"}, {"owner": {"reputation": 29935, "user_id": 435605, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/690eec685cbdb79b9f6deee401a61558?s=128&d=identicon&r=PG", "display_name": "AlikElzin-kilaka", "link": "https://stackoverflow.com/users/435605/alikelzin-kilaka"}, "edited": false, "score": 0, "creation_date": 1611620976, "post_id": 37282960, "comment_id": 116506087, "body": "The way to use dependencies in golang/go is by <i>modules</i>. See <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://golang.org/ref/mod\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29935, "user_id": 435605, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/690eec685cbdb79b9f6deee401a61558?s=128&d=identicon&r=PG", "display_name": "AlikElzin-kilaka", "link": "https://stackoverflow.com/users/435605/alikelzin-kilaka"}, "edited": false, "score": 0, "creation_date": 1611620994, "post_id": 37283673, "comment_id": 116506095, "body": "The way to use dependencies in golang/go is by <i>modules</i>. See <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://golang.org/ref/mod\" rel=\"nofollow noreferrer\">this</a>"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 8, "last_activity_date": 1463509465, "creation_date": 1463509465, "answer_id": 37283673, "question_id": 37282960, "link": "https://stackoverflow.com/questions/37282960/does-go-have-a-packaging-system-like-maven-in-java/37283673#37283673", "title": "Does Go have a packaging system like Maven in Java?", "body": "<p>Well, no, it does not.  And it must be understood that <code>go get</code> is not a package manager.</p>\n\n<p>Still, there is a couple of things to learn:</p>\n\n<ul>\n<li><p><a href=\"https://tip.golang.org/doc/faq#get_version\" rel=\"noreferrer\">This</a> FAQ entry.</p></li>\n<li><p>Since version 1.5, Go tooling has rudimentary support for \"vendoring\" &mdash; that is, packaging the required dependencies along with the project.</p>\n\n<p>The support is only in the form of treating a special directory named \"vendor\" at the top level of a project in a special way.\nThe tooling does not provide any sort of managing the contents of that directory.\nCommon approaches to do that include subtree merging and submodules supported by Git (and equivalent facilities of other VC systems) and external tooling (see below).</p>\n\n<p>This suport was made enabled by default in Go 1.6.</p></li>\n<li><p>There's a host of 3rd-party tools implementing packaging for Go using various approaches to carry out this task.</p>\n\n<p>The <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"noreferrer\">seemingly complete list</a> was pointed at by <code>@AlexBrand</code> but since it's hardly reasonable to try each solution there, I'll give an opinionated hint &mdash; based on my own lurking on the Go mailing list &mdash; to look at these tools: <code>gb</code>, <code>glide</code>, <code>govendor</code>, <code>godep</code>.</p></li>\n<li><p>Please also consider reading <a href=\"https://groups.google.com/d/topic/golang-nuts/Uwge8Cexq8Y/discussion\" rel=\"noreferrer\">this thread</a> on the Go mailing list and the resources it links to.</p></li>\n</ul>\n"}], "owner": {"reputation": 6839, "user_id": 90096, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/498c5b4e0507a3388f07ea20f7230ab8?s=128&d=identicon&r=PG", "display_name": "Artem", "link": "https://stackoverflow.com/users/90096/artem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4790, "favorite_count": 1, "closed_date": 1464677074, "accepted_answer_id": 37283673, "answer_count": 1, "score": 9, "last_activity_date": 1463509465, "creation_date": 1463506729, "question_id": 37282960, "link": "https://stackoverflow.com/questions/37282960/does-go-have-a-packaging-system-like-maven-in-java", "closed_reason": "Needs more focus", "title": "Does Go have a packaging system like Maven in Java?", "body": "<p>Does Go language have a packaging system like Maven in Java?\nI'm trying to see how to do dependency management and if there is a way to do it easily.</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "is_accepted": false, "score": 1, "last_activity_date": 1463503629, "last_edit_date": 1463503629, "creation_date": 1463502542, "answer_id": 37281751, "question_id": 37281626, "link": "https://stackoverflow.com/questions/37281626/strange-behavior-when-appending-to-a-2d-slice/37281751#37281751", "title": "Strange behavior when appending to a 2d slice", "body": "<p>What you're doing is appending to the string, instead of appending to the array and thats overflowing the underlying data structure for the slice. Which is why the rest of the array is overwritten with the string you're appending. </p>\n\n<p>To clarify (this may not always be the case):</p>\n\n<p>the array <code>values</code> consists of 3 []byte blocks lined up consecutively. Each []byte block has a fixed length (based on the length of the string within it). So <code>values[0]</code> has a length of 10 (excluding '\\n' or '\\0'). Now if you try to append <code>\"-inserted text-\"</code> to that block, the characters will \"flow\" over into the consecutive block, <code>values[1]</code>, replacing the characters within <code>values[1]</code> with the characters in <code>\"-inserted text-\"</code>. That's why you see parts of those characters within <code>values[1]</code> and <code>values[1]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1463502997, "post_id": 37281790, "comment_id": 62088950, "body": "When you say the storage is shared, what do you mean? Are you referring to the elements of the slice lined up consecutively?"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "reply_to_user": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1463503325, "post_id": 37281790, "comment_id": 62089175, "body": "The valriable <code>str</code> is a byte slice, with some amount of backend storage. Then <code>byte.Slice</code> returns a slice of []byte, all pointing into the same backing storage. So they&#39;re all (initially) pointing into the same shared storage."}, {"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1463504138, "post_id": 37281790, "comment_id": 62089591, "body": "Right. I was able to confirm it."}], "tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": true, "score": 2, "last_activity_date": 1463502642, "creation_date": 1463502642, "answer_id": 37281790, "question_id": 37281626, "link": "https://stackoverflow.com/questions/37281626/strange-behavior-when-appending-to-a-2d-slice/37281790#37281790", "title": "Strange behavior when appending to a 2d slice", "body": "<p>The underlying storage is shared, so to get the effect you want, you would need to store copies of the slices returned from <code>bytes.Split</code>, rather than just the slices returned. When you append to the first slice returned, you're essentially stomping all over the following slices.</p>\n"}], "owner": {"reputation": 4294, "user_id": 3850702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c0806211f48ca91fe8249db6370c98?s=128&d=identicon&r=PG&f=1", "display_name": "Zach", "link": "https://stackoverflow.com/users/3850702/zach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 37281790, "answer_count": 2, "score": 1, "last_activity_date": 1463503629, "creation_date": 1463502120, "question_id": 37281626, "link": "https://stackoverflow.com/questions/37281626/strange-behavior-when-appending-to-a-2d-slice", "title": "Strange behavior when appending to a 2d slice", "body": "<p>I am using a 2D slice of bytes to represent a bunch of lines, but when I append to one of the lines, I get some very strange behavior.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n)\n\nfunc main() {\n    str := []byte(\"first line\\nsecond line\\nthird line\")\n    values := bytes.Split(str, []byte(\"\\n\"))\n\n    fmt.Println(\"Before:\")\n    fmt.Println(string(values[0]))\n    fmt.Println(string(values[1]))\n    fmt.Println(string(values[2]))\n    fmt.Println()\n\n    values[0] = append(values[0], []byte(\"-inserted text-\")...)\n\n    fmt.Println(\"After:\")\n    fmt.Println(string(values[0]))\n    fmt.Println(string(values[1]))\n    fmt.Println(string(values[2]))\n}\n</code></pre>\n\n<p>I would expect the output of this program to be</p>\n\n<pre><code>Before:\nfirst line\nsecond line\nthird line\n\nAfter:\nfirst line-inserted text-\nsecond line\nthird line\n</code></pre>\n\n<p>But instead the output is:</p>\n\n<pre><code>Before:\nfirst line\nsecond line\nthird line\n\nAfter:\nfirst line-inserted text-\ninserted te\nt-ird line\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/iNw6s1S66U\" rel=\"nofollow\">https://play.golang.org/p/iNw6s1S66U</a></p>\n\n<p>Why is this happening and how can I fix it?</p>\n\n<p>Interestingly, this doesn't happen if I don't use split and instead define values like so:</p>\n\n<pre><code>values := [][]byte{[]byte(\"first line\"), []byte(\"second line\"), []byte(\"third line\")}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pEflrhKLd4\" rel=\"nofollow\">https://play.golang.org/p/pEflrhKLd4</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 1, "creation_date": 1463498214, "post_id": 37280034, "comment_id": 62085635, "body": "Is your problem about serializing structs or mapping your database records to structs ? these are 2 separate issues."}, {"owner": {"reputation": 377, "user_id": 2563577, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/m4S4U.jpg?s=128&g=1", "display_name": "SaravanaKumAr", "link": "https://stackoverflow.com/users/2563577/saravanakumar"}, "reply_to_user": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1463498681, "post_id": 37280034, "comment_id": 62085980, "body": "@mpm Mapping database records into struct is my problem. My SQL query is returning two rows. I want to form the JSON as mentioned above format."}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 1, "creation_date": 1463498982, "post_id": 37280034, "comment_id": 62086215, "body": "You&#39;d better off using a library then, there is a bunch of ORMs listed here : <a href=\"https://github.com/avelino/awesome-go#orm\" rel=\"nofollow noreferrer\">github.com/avelino/awesome-go#orm</a> , also this one which claims to be close to sql alchemy <a href=\"https://qb.readme.io/\" rel=\"nofollow noreferrer\">qb.readme.io</a>"}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 2563577, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/m4S4U.jpg?s=128&g=1", "display_name": "SaravanaKumAr", "link": "https://stackoverflow.com/users/2563577/saravanakumar"}, "edited": false, "score": 0, "creation_date": 1463498858, "post_id": 37280167, "comment_id": 62086127, "body": "My problem is database query is returning two rows. Using that I wants to form the above mentioned json."}, {"owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "reply_to_user": {"reputation": 377, "user_id": 2563577, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/m4S4U.jpg?s=128&g=1", "display_name": "SaravanaKumAr", "link": "https://stackoverflow.com/users/2563577/saravanakumar"}, "edited": false, "score": 0, "creation_date": 1463499001, "post_id": 37280167, "comment_id": 62086235, "body": "In what format are the rows returned? If your problem is serialising the data maybe you should try using <a href=\"https://github.com/go-gorp/gorp\" rel=\"nofollow noreferrer\">github.com/go-gorp/gorp</a>"}], "tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": true, "score": 0, "last_activity_date": 1463498248, "creation_date": 1463498248, "answer_id": 37280167, "question_id": 37280034, "link": "https://stackoverflow.com/questions/37280034/assign-db-column-in-golang-struct/37280167#37280167", "title": "Assign DB column in Golang Struct", "body": "<p>You need to specify struct tags in your struct definition:</p>\n\n<pre><code>type Retailers struct {\n  Id int `json:\"id\"`\n  Name string `json:\"name\"`\n  Products []Product `json:\"products\"`\n}\n\ntype Product struct {\n  Id int `json:\"id\"`\n  Description string `json:\"description\"`\n  Url string `json:\"url\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 2563577, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/m4S4U.jpg?s=128&g=1", "display_name": "SaravanaKumAr", "link": "https://stackoverflow.com/users/2563577/saravanakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 1, "accepted_answer_id": 37280167, "answer_count": 1, "score": 0, "last_activity_date": 1463498248, "creation_date": 1463497931, "question_id": 37280034, "link": "https://stackoverflow.com/questions/37280034/assign-db-column-in-golang-struct", "title": "Assign DB column in Golang Struct", "body": "<p>I have two tables like Retailers and products in database. Retailer has many Products. </p>\n\n<p>They following are the structs I have defined in golang.</p>\n\n<pre><code>type Retailers struct {\n  Id int \n  Name string\n  Products []Product\n}\n\ntype Product struct {\n  Id int \n  Description string\n  Url string \n}\n</code></pre>\n\n<p>The following is the query am using to fetch data from Database.</p>\n\n<pre><code>select r.id, r.name, p.id, p.description, p.url from retailers r JOIN products on r.id = r.retailer_id\n</code></pre>\n\n<p>Using the above struct and query I wish to form the json as below</p>\n\n<pre><code>{\n    \"id\": \"DFT\",\n    \"name\": \"Amazon\",\n    \"products\":[\n        {\n            \"id\":\"APP0001\",\n            \"description\":\"Iphone5s\",\n            \"url\":\"www.Iphone5s.com\"\n        },\n        {\n            \"id\":\"APP0002\",\n            \"description\":\"Iphone6s\",\n            \"url\":\"www.Iphone6s.com\"\n        }\n    ]\n}\n</code></pre>\n\n<p>How can I achieve this using golang?  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2790, "user_id": 783797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/648f16148006d110eed43734d315e385?s=128&d=identicon&r=PG", "display_name": "gbin", "link": "https://stackoverflow.com/users/783797/gbin"}, "edited": false, "score": 0, "creation_date": 1463498523, "post_id": 37279890, "comment_id": 62085850, "body": "Hi Kevin ! :) It looks close to this question : <a href=\"http://stackoverflow.com/questions/27976493/golang-static-identifier-resolution\" title=\"golang static identifier resolution\">stackoverflow.com/questions/27976493/&hellip;</a> I hope it helps."}], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 1, "last_activity_date": 1463541459, "creation_date": 1463541459, "answer_id": 37289663, "question_id": 37279890, "link": "https://stackoverflow.com/questions/37279890/determine-whether-dynamically-specified-go-variable-has-specific-type/37289663#37289663", "title": "Determine whether dynamically specified Go variable has specific type", "body": "<p>did some trace and find the way, hoping help</p>\n\n<p><a href=\"https://play.golang.org/p/f4XF8K_FbL\" rel=\"nofollow\">https://play.golang.org/p/f4XF8K_FbL</a></p>\n\n<pre><code>package main\n\nimport (\n    \"go/parser\"\n    \"go/token\"\n    \"os\"\n    \"go/ast\"\n    \"log\"\n    \"net/http\"\n    //\"reflect\"\n)\n\nfunc MyCustomHandler(w http.ResponseWriter, r* http.Request){\n\n}\n\nfunc findHttpHandler(pkg *ast.Package, handlerName string) (*ast.FuncDecl, error) {\n    for _, file := range pkg.Files {\n        for _, decl := range file.Decls {\n            fd, ok := decl.(*ast.FuncDecl)\n            if !ok || fd == nil{\n                continue\n            }\n            if fd.Name.Name != handlerName{\n                continue\n            }\n            if len(fd.Type.Params.List) == 2 {\n                p1 := fd.Type.Params.List[0]\n                p2 := fd.Type.Params.List[1]\n\n                exp, ok := p1.Type.(*ast.SelectorExpr)\n                if !ok{\n                    break;\n                }\n                ident, ok := exp.X.(*ast.Ident)\n                if !ok{\n                    break\n                }\n                if ident.Name!=\"http\" || exp.Sel.Name != \"ResponseWriter\"{\n                    break;\n                }\n\n                exp2, ok := p2.Type.(*ast.StarExpr)\n                if !ok{\n                    break;\n                }\n                exp = exp2.X.(*ast.SelectorExpr)\n                ident, ok = exp.X.(*ast.Ident)\n                if !ok{\n                    break\n                }\n                if ident.Name!=\"http\" || exp.Sel.Name != \"Request\"{\n                    break;\n                }\n                return fd, nil\n            }\n        }\n    }\n    return nil, nil\n}\n\nfunc main() {\n    fs := token.NewFileSet()\n    pkgs, err := parser.ParseDir(fs, os.Args[1], nil, parser.Trace)\n    if err != nil{\n        log.Fatalln(err)\n    }\n    for _,pkg:=range pkgs{\n        d, _ := findHttpHandler(pkg, \"MyCustomHandler\");\n        log.Println(d)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1463541459, "creation_date": 1463497590, "question_id": 37279890, "link": "https://stackoverflow.com/questions/37279890/determine-whether-dynamically-specified-go-variable-has-specific-type", "title": "Determine whether dynamically specified Go variable has specific type", "body": "<p>I'm writing a command line application where a user specifies 1) a directory containing Go files, 2) the name of a variable that should be a <code>http.Handler</code>, e.g.</p>\n\n<pre><code>go run cli.go /path/to/a/go/library MyCustomHandler\n</code></pre>\n\n<p>I'm trying to </p>\n\n<ul>\n<li>parse the files </li>\n<li>find the variable with the given name</li>\n<li>verify that it's a <code>http.Handler</code></li>\n</ul>\n\n<p>I can do the first two no problem - I call <code>parser.ParseDir</code>, then get the package I want as an <code>*ast.Package</code>, then loop over it like this:</p>\n\n<pre><code>func findHttpHandler(pkg *ast.Package, handlerName string) (*ast.FuncDecl, error) {\n    for _, file := range pkg.Files {\n        for _, decl := range file.Decls {\n            gd, ok := decl.(*ast.GenDecl)\n            if !ok || gd.Tok != token.VAR {\n                continue\n            }\n            if len(gd.Specs) != 1 {\n                continue\n            }\n            spec0 := gd.Specs[0]\n            vs, ok := spec0.(*ast.ValueSpec)\n            if !ok {\n                continue\n            }\n            if len(vs.Names) != 1 {\n                continue\n            }\n            ident := vs.Names[0]\n            if ident.Name != handlerName {\n                continue\n            }\n            // ...\n        }\n    }\n}\n</code></pre>\n\n<p>The problem is at this point the <code>ValueSpec.Type</code> is nil, and there doesn't appear to be any way to figure out whether this is a <code>http.Handler</code> or not.</p>\n\n<p>The <code>go/types</code> package has more tools for checking types, but it also looks like you need to do a lot more setup work to get this, essentially parsing and type checking the whole program. Am I going to need to go down this path, or is there an easier way, just using the <code>ast</code> package, or using <code>go build</code> somehow?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "edited": false, "score": 0, "creation_date": 1463543230, "post_id": 37288121, "comment_id": 62104212, "body": "Yeah I know the performance data structure is the array with slices but I&#39;m currently investigating what the language has to offer and how to navigate with those features. I&#39;ll be OK with &quot;code as-is is pretty fine&quot;."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1463529915, "creation_date": 1463529915, "answer_id": 37288121, "question_id": 37279852, "link": "https://stackoverflow.com/questions/37279852/golang-container-list-creating-a-findall-function/37288121#37288121", "title": "Golang container/list creating a FindAll function", "body": "<p>The code as-is is pretty fine, but you should ask your self 2 questions:</p>\n\n<p>1. Why shouldn't you use a typed slice? (interface{} performance is slow compared to the explicit type, although it will greatly improve in Go 1.7)</p>\n\n<p>2. Would it be better to implement your specific type as a linked list?</p>\n\n<p>Something like <a href=\"https://play.golang.org/p/jjZe7AAUFA\" rel=\"nofollow\">this</a> can be much more efficient:</p>\n\n<pre><code>type IntList []int\n\nfunc (l IntList) Filter(fn func(v int) bool) IntList {\n    var o IntList\n    for _, v := range l {\n        if fn(v) {\n            o = append(o, v)\n        }\n    }\n    return o\n}\n</code></pre>\n\n<p>There's almost always a better alternative to <code>container/list</code>, however it all depends on your use case.</p>\n"}], "owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 37288121, "answer_count": 1, "score": 1, "last_activity_date": 1463529915, "creation_date": 1463497503, "question_id": 37279852, "link": "https://stackoverflow.com/questions/37279852/golang-container-list-creating-a-findall-function", "title": "Golang container/list creating a FindAll function", "body": "<p>I was wondering if this is the way to create and pass 'generic'(yeah I know, a sensitive word in GoLang) lists to a FindAll function.</p>\n\n<p>Here's my attempt:</p>\n\n<pre><code>package main\n\nimport (\n    \"container/list\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc FindAll(lst *list.List, p func(interface{}) bool) *list.List {\n    ans := list.New()\n\n    for i := lst.Front(); i != nil; i = i.Next() {\n        if p(i.Value) {\n            ans.PushBack(i.Value)\n        }\n    }\n    return ans\n}\n\nfunc ConvertToInt(p func(int) bool) func(interface{}) bool {\n    return func(v interface{}) bool {\n        if value, ok := v.(int); ok {\n            if p(value) {\n                return true\n            } else {\n                return false\n            }\n        } else {\n            return false\n        }\n    }\n}\n\nfunc IsEven(n int) bool {\n    if n%2 == 0 {\n        return true\n    }\n    return false\n}\n\nfunc ConvertoString(p func(s string) bool) func(interface{}) bool {\n    return func(v interface{}) bool {\n        if value, ok := v.(string); ok {\n            if p(value) {\n                return true\n            } else {\n                return false\n            }\n        } else {\n            return false\n        }\n    }\n}\n\nfunc IsHello(str string) bool {\n    if strings.ToLower(str) == \"hello\" {\n        return true\n    } else {\n        return false\n    }\n}\n\nfunc main() {\n    fmt.Println(\"Find All Programs!\\n\\n\")\n\n    lsti := list.New()\n\n    for i := 0; i &lt; 11; i++ {\n        lsti.PushBack(i)\n    }\n\n    ansIsEven := FindAll(lsti, ConvertToInt(IsEven))\n\n    for i := ansIsEven.Front(); i != nil; i = i.Next() {\n        if value, ok := i.Value.(int); ok {\n            fmt.Printf(\"Found even: %d\\n\", value)\n        } else {\n            fmt.Println(\"Huh! What's that?\")\n        }\n    }\n\n}\n</code></pre>\n\n<p>I've been playing with this for a while and thought I'd better get the advice of the Go experts before I convince myself its correct. </p>\n"}, {"tags": ["go", "udp"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1463491507, "post_id": 37277281, "comment_id": 62080317, "body": "Eh, hacky, but you could do a check on that string and have a function that returns a custom error if you find &quot;use of closed network connection&quot;, or the original err if the string doesn&#39;t match. Then you could check if err != CustomErr {}."}, {"owner": {"reputation": 1030, "user_id": 1108547, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0316db582650c52c8aa85bdf621ae216?s=128&d=identicon&r=PG", "display_name": "Alexander W", "link": "https://stackoverflow.com/users/1108547/alexander-w"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1463491856, "post_id": 37277281, "comment_id": 62080601, "body": "Yeah, we had thought of something similar, but as you said, that is a bit hacky ;)"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 3, "creation_date": 1463492935, "post_id": 37277281, "comment_id": 62081475, "body": "You can&#39;t get aroung the error. You closed connection while read operation is in progress. To determine if that error is ok you need some kind of a flag that tells your code that connection was closed normally and errors in read operations should be ignored. Don&#39;t use timeout in this case. Use the error. Remember, errors are values and should be used that way i.e. should be used in actual program logic."}, {"owner": {"reputation": 1030, "user_id": 1108547, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0316db582650c52c8aa85bdf621ae216?s=128&d=identicon&r=PG", "display_name": "Alexander W", "link": "https://stackoverflow.com/users/1108547/alexander-w"}, "edited": false, "score": 0, "creation_date": 1463493714, "post_id": 37277281, "comment_id": 62082094, "body": "Right now we actually use the error plus a signaling channel (as you wrote) to determine if it is ok to close or if we should continue. But was looking for an alternative, more &quot;robust&quot; way of doing it other than comparing error strings."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1463494088, "post_id": 37277281, "comment_id": 62082417, "body": "Why do you need to compare strings? First, network error contains the reason why it happened. Second, your code knows that you closed connection and it means any error from read operation should be ignored. You don&#39;t need error string in either case."}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1463495738, "post_id": 37277281, "comment_id": 62083674, "body": "@creker we shouldn&#39;t assume that any error handed back from his call is due to a closed UDP connection."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1463500511, "post_id": 37277281, "comment_id": 62087338, "body": "@william.taylor.09, that&#39;s why you have the flag. If it&#39;s set you don&#39;t care about errors. If it isn&#39;t then you can check the error and act accordingly. If you still want to check the error there is <code>net.errClosing</code> package variable. No string comparisons needed"}], "owner": {"reputation": 1030, "user_id": 1108547, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0316db582650c52c8aa85bdf621ae216?s=128&d=identicon&r=PG", "display_name": "Alexander W", "link": "https://stackoverflow.com/users/1108547/alexander-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1187, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1463490952, "creation_date": 1463490952, "question_id": 37277281, "link": "https://stackoverflow.com/questions/37277281/golang-gracefully-stop-readfromudp-when-udp-connection-closes", "title": "Golang - Gracefully stop ReadFromUDP when UDP connection closes", "body": "<p>So, we have a full-duplex system setup that utilizes channels and different goroutines for UDP packet processing (reading, writing, handling). Thus, we block at <code>ReadFromUDP</code> while waiting for incoming packets in a goroutine.</p>\n\n<p>We have this peculiar problem with <code>ReadFromUDP</code> throwing an error (obviously) while waiting for a packet to arrive and the connection is being closed elsewhere.</p>\n\n<p>The error that is printed is the following: </p>\n\n<blockquote>\n  <p>read udp 127.0.0.1:8091: use of closed network connection</p>\n</blockquote>\n\n<p>This is quite reasonable since we actually close the connection in another goroutine via channels.</p>\n\n<p>Is there anyone who knows if there exists a way of not getting that error (other than catching it) when this occurs or if there exists another way to signal <code>ReadFromUDP</code> to stop reading, without using timeouts?</p>\n"}, {"tags": ["ssl", "go"], "answers": [{"comments": [{"owner": {"reputation": 196, "user_id": 397697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xzOXF.jpg?s=128&g=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/397697/mihaim"}, "edited": false, "score": 0, "creation_date": 1463654122, "post_id": 37306916, "comment_id": 62160775, "body": "In the end I realized the the proper solution in my case is to change the certificate with a &quot;valid&quot; one.. so my problem is solved. I will accept you answer, thank you!"}], "tags": [], "owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "is_accepted": true, "score": 2, "last_activity_date": 1463594033, "creation_date": 1463594033, "answer_id": 37306916, "question_id": 37277018, "link": "https://stackoverflow.com/questions/37277018/go-https-request-time-did-not-serialize-back-to-the-original-value/37306916#37306916", "title": "GO https request, time did not serialize back to the original value", "body": "<p>Unfortunately, you've encountered an error that you cannot get around in Go.  This is buried deep in the <a href=\"https://golang.org/src/crypto/tls/handshake_client.go?h=failed%20to%20parse%20certificate%20from%20server\" rel=\"nofollow\">cypto/x509</a> and <a href=\"https://golang.org/src/encoding/asn1/asn1.go?h=parseUTCTime#L315\" rel=\"nofollow\">encoding/asn1</a> packages without a way to ignore.  Specifically, asn1.parseUTCTime is expecting the time format to be \"0601021504Z0700\", but your server is sending \"0601021504+0000\".  Technically, that is a known format but encoding/asn1 does not support it.</p>\n\n<p>There are only 2 solutions that I can come up with that do not require a code change for golang.</p>\n\n<p>1) Edit the encoding/asn1 package in your go src directory and then rebuild all the standard packages with <code>go build -a</code></p>\n\n<p>2) Create your own customer tls, x509 and asn1 packages to use the format your server is sending.</p>\n\n<p>Hope this helps.</p>\n\n<p>P.S. I've opened an issue with the Go developers to see if it can resolved by them at some later point <a href=\"https://github.com/golang/go/issues/15732\" rel=\"nofollow\">Issue Link</a></p>\n\n<p><a href=\"http://www.obj-sys.com/asn1tutorial/node15.html\" rel=\"nofollow\">Possible ASN1 UtcTime Formats.</a></p>\n"}], "owner": {"reputation": 196, "user_id": 397697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xzOXF.jpg?s=128&g=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/397697/mihaim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 1, "accepted_answer_id": 37306916, "answer_count": 1, "score": 5, "last_activity_date": 1463594033, "creation_date": 1463490212, "question_id": 37277018, "link": "https://stackoverflow.com/questions/37277018/go-https-request-time-did-not-serialize-back-to-the-original-value", "title": "GO https request, time did not serialize back to the original value", "body": "<p>I'm starting to learn golang and I'm trying to make a simple http client that will get a list of virtual machines from one of our oVirt clusters. The API that I'm trying to access has a self-signed certificate (auto generated during the cluster installation) and golang's http.client encounters a problem when serializing the time from the certificate. Below you can find the code and the output.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"crypto/tls\"\n)\n\nfunc do_request(url string) ([]byte, error) {\n\n    // ignore self signed certificates\n    transCfg := &amp;http.Transport{\n        TLSClientConfig: &amp;tls.Config {\n            InsecureSkipVerify: true,\n        },\n    }\n\n    // http client \n    client := &amp;http.Client{Transport: transCfg}\n\n    // request with basic auth\n    req, _ := http.NewRequest(\"GET\", url, nil)\n    req.SetBasicAuth(\"user\",\"pass\")\n    resp, err := client.Do(req)\n\n    // error?\n    if err != nil {\n        fmt.Printf(\"Error : %s\", err)\n        return nil, err\n\n    }\n    defer resp.Body.Close()\n\n    body, _ := ioutil.ReadAll(resp.Body)\n    return []byte(body), nil\n}\n\nfunc main() {\n\n    body, _ := do_request(\"https://ovirt.example.com/\")\n    fmt.Println(\"response Status:\", string(body))\n}\n</code></pre>\n\n<p>and the error when I'm trying to compile:</p>\n\n<pre><code>$ go run http-get.go\nError : Get https://ovirt.example.com/: tls: failed to parse certificate from server: asn1: time did not serialize back to the original value and may be invalid: given \"141020123326+0000\", but serialized as \"141020123326Z\"response Status: \n</code></pre>\n\n<p>Is there any way to ignore this verification? I tried making a request using other programming languages (python, ruby) and skipping insecure certificates seems to be enough.</p>\n\n<p>Thank you!</p>\n\n<p>PS: I know the proper solution is to change the certificate with a valid one, but for the moment I cannot do this.</p>\n"}, {"tags": ["regex", "go"], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 77, "last_activity_date": 1463483422, "creation_date": 1463483422, "answer_id": 37274433, "question_id": 37274282, "link": "https://stackoverflow.com/questions/37274282/regex-with-replace-in-golang/37274433#37274433", "title": "Regex with replace in Golang", "body": "<p>You can use capturing groups with alternations matching either string boundaries or a character not <code>_</code> (still using a word boundary):</p>\n\n<pre><code>var re = regexp.MustCompile(`(^|[^_])\\bproducts\\b([^_]|$)`)\ns := re.ReplaceAllString(sample, `$1.$2`)\n</code></pre>\n\n<p>Here is the <a href=\"https://play.golang.org/p/4_KSyonY9y\" rel=\"noreferrer\">Go demo</a> and a <a href=\"https://regex101.com/r/pL0uR0/1\" rel=\"noreferrer\">regex demo</a>.</p>\n\n<p>Notes on the pattern:</p>\n\n<ul>\n<li><code>(^|[^_])</code> - match string start (<code>^</code>) or a character other than <code>_</code></li>\n<li><code>\\bproducts\\b</code> - a whole word \"products\"</li>\n<li><code>([^_]|$)</code> - either a non-<code>_</code> or the end of string.</li>\n</ul>\n\n<p>In the replacement pattern, we use backreferences to restore the characters captured with the parentheses (capturing groups).</p>\n"}], "owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50320, "favorite_count": 7, "accepted_answer_id": 37274433, "answer_count": 1, "score": 48, "last_activity_date": 1463982232, "creation_date": 1463483004, "last_edit_date": 1463982232, "question_id": 37274282, "link": "https://stackoverflow.com/questions/37274282/regex-with-replace-in-golang", "title": "Regex with replace in Golang", "body": "<p>I've used regexp package to replace bellow text </p>\n\n<pre><code>{% macro products_list(products) %}\n{% for product in products %}\nproductsList\n{% endfor %}\n{% endmacro %}\n</code></pre>\n\n<p>but I could not replace \"products\" without replace another words like \"products_list\" and Golang has no a func like <strong>re.ReplaceAllStringSubmatch</strong> to do replace with submatch (there's just FindAllStringSubmatch). I've used <strong>re.ReplaceAllString</strong> to replace \"products\" with .</p>\n\n<pre><code>{% macro ._list(.) %}\n{% for product in . %}\n.List\n{% endfor %}\n{% endmacro %}\n</code></pre>\n\n<p>It's not sth which I want and I need below result:</p>\n\n<pre><code>{% macro products_list (.) %}\n{% for product in . %}\nproductsList\n{% endfor %}\n{% endmacro %}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1463484959, "post_id": 37274450, "comment_id": 62075292, "body": "is it necessary to add bson marshaller? I was able to do mgo queries so far without them. Are there any chances of danger for my already written queries?"}, {"owner": {"reputation": 2243, "user_id": 1994803, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wuOhb.png?s=128&g=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1994803/john-smith"}, "reply_to_user": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1463485417, "post_id": 37274450, "comment_id": 62075687, "body": "In your case it&#39;s probably not, but I would still rather do it. It&#39;s not much of an additional typing, but could help later on."}], "tags": [], "owner": {"reputation": 2243, "user_id": 1994803, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wuOhb.png?s=128&g=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1994803/john-smith"}, "is_accepted": false, "score": 3, "last_activity_date": 1463483496, "creation_date": 1463483496, "answer_id": 37274450, "question_id": 37273345, "link": "https://stackoverflow.com/questions/37273345/data-not-fully-retrieved-while-using-mgo-pipe-function/37274450#37274450", "title": "Data not fully retrieved while using mgo pipe function", "body": "<p>I might be missing something, but why do you need <code>Pipe</code> for this?</p>\n\n<p>You probably could do it easier:</p>\n\n<pre><code>query := bson.M{\"slug\": slug, \"companyusers.username\": username}\n\nerr := c.Find(query).All(&amp;companyResults)\n</code></pre>\n\n<p>I'm fairly certain this would give you the same results.</p>\n\n<p>However, <strong>the main problem</strong> is you didn't give the bson marshaller the fields name. Since the field in your database is <code>companyusers</code> and <code>username</code> you'll have to tell that to the marshaller.</p>\n\n<pre><code>type Company struct {\n    Id              bson.ObjectId `bson:\"_id,omitempty\"`\n    CompanyName     string\n    Slug            string\n    CompanyUsers    []CompanyUser `bson:\"companyuser\"`\n}\ntype CompanyUser    struct {\n    UserName    string `bson:\"username\"`\n    Email       string\n    FullName    string\n}\n</code></pre>\n\n<p>You probably want to fix that for the rest of the fields as well.</p>\n"}, {"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 5, "last_activity_date": 1463484072, "creation_date": 1463484072, "answer_id": 37274668, "question_id": 37273345, "link": "https://stackoverflow.com/questions/37273345/data-not-fully-retrieved-while-using-mgo-pipe-function/37274668#37274668", "title": "Data not fully retrieved while using mgo pipe function", "body": "<p>Try making <code>companyResults</code> a <code>[]map[string]interface{}</code> instead of a <code>[]Company</code> to see what sort of a result you get. This helps to figure out what the structure of <code>companyResults</code> should be.</p>\n\n<pre><code>var companyResults []map[string]interface{}\n</code></pre>\n\n<p>You will see a result like,</p>\n\n<pre><code>[map[companyname:MyCompany slug:companyslug companyusers:map[username:username] _id:test]]\n</code></pre>\n\n<p>See that <code>companyusers</code> is infact a map not an array. This is because your usage of the <code>$unwind</code> stage. It deconstructs the array, outputting one document for each element in the array. See <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/\" rel=\"noreferrer\">docs</a>.</p>\n\n<p>I agree with John Smith's answer, that you do not need pipelines at all. But following should give you the desired result.</p>\n\n<pre><code>type Result struct {\n    Id           string `bson:\"_id,omitempty\"`\n    CompanyName  string\n    Slug         string\n    CompanyUsers CompanyUser\n}\n\nvar companyResults []Result\n</code></pre>\n"}], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 748, "favorite_count": 0, "accepted_answer_id": 37274668, "answer_count": 2, "score": 3, "last_activity_date": 1463484072, "creation_date": 1463480320, "question_id": 37273345, "link": "https://stackoverflow.com/questions/37273345/data-not-fully-retrieved-while-using-mgo-pipe-function", "title": "Data not fully retrieved while using mgo pipe function", "body": "<p>I was using pipe function in mgo to retrieve data. My data structs are as follows.</p>\n\n<pre><code>type Company struct {\n    Id              bson.ObjectId `bson:\"_id,omitempty\"`\n    CompanyName     string\n    Slug            string\n    CompanyUsers    []CompanyUser\n}\ntype CompanyUser    struct {\n    UserName    string\n    Email       string\n    FullName    string\n}\n</code></pre>\n\n<p>I needed to check whether a given \"UserName\" is present under \"CompanyUsers\" in a \"Company\" with a given \"Slug\".</p>\n\n<p>Both Slug and UserName are provided by the User.</p>\n\n<p>Using Pipe function I successfully done the search, but the data is returned with an empty CompanyUsers array.</p>\n\n<p>My query is as follows:</p>\n\n<pre><code>var companyResults []Company\n\npipeline := []bson.M{\n    {\"$match\": bson.M{\"slug\": slug}},\n    {\"$unwind\": \"$companyusers\"},\n    {\"$match\": bson.M{\n        \"companyusers.username\": username,\n    }},\n}\nerr := c.Pipe(pipeline).All(&amp;companyResults)\n</code></pre>\n\n<p>This provides me a search result as follows:</p>\n\n<pre><code>[{ObjectIdHex(\"573aa0fddd731711c94830ca\") MyCompany companyslug [] }]\n</code></pre>\n\n<p>None of the data in CompanyUsers are retrieved. How can I solve this error?</p>\n"}, {"tags": ["function", "go", "variadic"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1487263225, "last_edit_date": 1487263225, "creation_date": 1463474420, "answer_id": 37271129, "question_id": 37270743, "link": "https://stackoverflow.com/questions/37270743/is-it-possible-to-trigger-compile-time-error-with-custom-library-in-golang/37271129#37271129", "title": "Is it possible to trigger compile time error with custom library in golang?", "body": "<p>Calling a function which has variadic parameter and passing no arguments is valid by the language spec. So you can't make it a compile-time error.</p>\n\n<p>However, you may modify the signature of your function to have a non-variadic <em>and</em> a variadic parameter, and then calling it with no arguments would indeed be a compile-time error:</p>\n\n<pre><code>func min(first int, rest ...int) int {\n    m := first\n    for _, v := range rest {\n        if v &lt; m {\n            m = v\n        }\n    }\n    return m\n}\n</code></pre>\n\n<p>This will force callers to pass at least 1 argument, else it will be a compile-time error. This <code>min()</code> function can be called like this:</p>\n\n<pre><code>min(1)\nmin(1, 2)\nmin(1, 2, -3)\n</code></pre>\n\n<p>But attempting to call it without any arguments results in compile-time error:</p>\n\n<pre><code>min() // Error: not enough arguments in call to min\n</code></pre>\n\n<p>If you want the callers to pass at least 2 arguments:</p>\n\n<pre><code>func min(first, second int, rest ...int) int {\n    return 0 // Implement your logic here\n}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>The above example is also more efficient if the caller just wants to pass 1 argument, as variadic parameters are implemented with slices in the background, and if the caller passes only 1 argument, no slice will have to be created, a <code>nil</code> slice will be passed (this can be verified by printing <code>rest == nil</code> \u2013 which will be <code>true</code>).</p>\n\n<p>The potential downside is that if you have a slice, you can't just pass it to the function, but you may do the following:</p>\n\n<pre><code>s := []int{1, 2, -3}\nfmt.Println(min(s[0], s[1:]...))\n</code></pre>\n\n<p>Which is passing the first element, and slicing the slice to pass the rest and using <code>...</code> to pass it as the value for the variadic parameter. Don't forget to check if the slice has at least 1 element, else the above code panics at runtime.</p>\n\n<p>Try the examples on the <a href=\"https://play.golang.org/p/H4jB-LVCPJ\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>If you can't or don't want to modify the signature of your function, your only option is to panic or exit from the app at runtime, but no possibility to fail at compile-time.</p>\n"}], "owner": {"reputation": 1657, "user_id": 1311835, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/816e24723c114551ae2be00ae10fcd3c?s=128&d=identicon&r=PG", "display_name": "rahmat", "link": "https://stackoverflow.com/users/1311835/rahmat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 37271129, "answer_count": 1, "score": 5, "last_activity_date": 1487263225, "creation_date": 1463473235, "last_edit_date": 1463475394, "question_id": 37270743, "link": "https://stackoverflow.com/questions/37270743/is-it-possible-to-trigger-compile-time-error-with-custom-library-in-golang", "title": "Is it possible to trigger compile time error with custom library in golang?", "body": "<p>Let's say, I have <code>min()</code> (just for example) a variadic function to define the smallest value from multiple values provided.</p>\n\n<p>If the caller don't provided any parameter, I want to halt compile process (as this would be the bug in the caller, not error in my function).</p>\n\n<p>How to do that?</p>\n"}, {"tags": ["go", "udp"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1463467491, "post_id": 37268653, "comment_id": 62063966, "body": "My take is that this call merely wraps <code>recv(2)</code> syscall which has the <code>oob</code> parameter no matter which kind of socket it is. On my system, <code>man 2 send</code> says <code>oob</code> is only used with <code>SOCK_STREAM</code>sockets, and UDP are not them."}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 6526794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4sBV.jpg?s=128&g=1", "display_name": "TheHan", "link": "https://stackoverflow.com/users/6526794/thehan"}, "edited": false, "score": 0, "creation_date": 1467182029, "post_id": 38091908, "comment_id": 63619239, "body": "But I have no idea about the para &quot;flags&quot; as far"}], "tags": [], "owner": {"reputation": 48, "user_id": 6526794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G4sBV.jpg?s=128&g=1", "display_name": "TheHan", "link": "https://stackoverflow.com/users/6526794/thehan"}, "is_accepted": true, "score": 0, "last_activity_date": 1467181773, "creation_date": 1467181773, "answer_id": 38091908, "question_id": 37268653, "link": "https://stackoverflow.com/questions/37268653/what-is-oob-in-func-udpconn-readmsgudp/38091908#38091908", "title": "What is oob in func (*UDPConn) ReadMsgUDP?", "body": "<p>Well, as I tried, when you want other infomation(such as pktinfo) to get local address with setting syscall.setsockoption, you will need it. This happens when you don't want connection-oriented UDP.</p>\n"}], "owner": {"reputation": 1853, "user_id": 264442, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7f8a5f6145906fe3e01f9e21ec9aaf22?s=128&d=identicon&r=PG", "display_name": "zjk", "link": "https://stackoverflow.com/users/264442/zjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 2, "accepted_answer_id": 38091908, "answer_count": 1, "score": 2, "last_activity_date": 1467181773, "creation_date": 1463466407, "last_edit_date": 1463467124, "question_id": 37268653, "link": "https://stackoverflow.com/questions/37268653/what-is-oob-in-func-udpconn-readmsgudp", "title": "What is oob in func (*UDPConn) ReadMsgUDP?", "body": "<p><a href=\"http://beej.us/298C/oob_overview.html\" rel=\"nofollow\">This link</a> has information about OOB in TCP.</p>\n\n<blockquote>\n  <p>With out-of-band data we want the byte-stream service layer on the\n  sending side to send this data before any other data that it has\n  buffered. Similarly we want the receiving end to pass this data to its\n  user process ahead of any data that it might have buffered.</p>\n</blockquote>\n\n<p>But what about UDP?</p>\n\n<p>In golang, the <code>ReadMsgUDP</code> function requires an <code>oob</code> byte slice.</p>\n\n<pre><code>func (c *UDPConn) ReadMsgUDP(b, oob []byte) (n, oobn, flags int, addr *UDPAddr, err error)\n</code></pre>\n\n<p>What is the <code>oob</code> for? Are there any use cases in open source code? Or should I use <code>PacketConn</code> instead of <code>UDPConn</code>?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8104, "user_id": 1838205, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aeCc2.jpg?s=128&g=1", "display_name": "itzmebibin", "link": "https://stackoverflow.com/users/1838205/itzmebibin"}, "edited": false, "score": 0, "creation_date": 1463467176, "post_id": 37268692, "comment_id": 62063808, "body": "I have imported <code>go-tigertonic</code> by,  <code>import ( \ttt &quot;github.com&#47;rcrowley&#47;go-tigertonic&quot; )</code>  And then I initialize <code>ResponceErrorWriter</code> in <code>init()</code> like,  <code>tt.ResponseErrorWriter = ResponseErrorWriter{}</code>  Then where I have supposed to implement <code>WriteError</code> ?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 8104, "user_id": 1838205, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aeCc2.jpg?s=128&g=1", "display_name": "itzmebibin", "link": "https://stackoverflow.com/users/1838205/itzmebibin"}, "edited": false, "score": 0, "creation_date": 1463467269, "post_id": 37268692, "comment_id": 62063857, "body": "Have you created an ErrorResponseWriter struct ?"}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 1, "last_activity_date": 1463467178, "last_edit_date": 1463467178, "creation_date": 1463466595, "answer_id": 37268692, "question_id": 37268594, "link": "https://stackoverflow.com/questions/37268594/cannot-use-responseerrorwriter-literal-type-responseerrorwriter-as-type-error/37268692#37268692", "title": "cannot use ResponseErrorWriter literal (type ResponseErrorWriter) as type error in GO", "body": "<p>From the message, <code>ResponseErrorWriter</code> is not a <code>tigertonic.ErrorWriter</code>. Meaning you haven't created <code>type ResponseErrorWriter struct</code> which implements interface <code>tigertonic.ErrorWriter</code>, so what you are trying to do is to initialize a struct which does not match the expected interface.</p>\n\n<p>The message is clear, you need to implement the <code>WriteError</code> method.</p>\n"}, {"comments": [{"owner": {"reputation": 8104, "user_id": 1838205, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aeCc2.jpg?s=128&g=1", "display_name": "itzmebibin", "link": "https://stackoverflow.com/users/1838205/itzmebibin"}, "edited": false, "score": 0, "creation_date": 1463468169, "post_id": 37268881, "comment_id": 62064357, "body": "So where I have supposed to implement <code>ErrorWriter</code> ?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 1, "creation_date": 1463468355, "post_id": 37268881, "comment_id": 62064458, "body": "There is a default ErrorWriter. If you do not want to write them in a specific way, you can let the default and it is just fine. In order to understand how it writes the errors, you can see the source code of this default <code>ErrorWriter</code> here <a href=\"https://github.com/rcrowley/go-tigertonic/blob/master/error.go#L80\" rel=\"nofollow noreferrer\">github.com/rcrowley/go-tigertonic/blob/master/error.go#L80</a>"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1463468695, "post_id": 37268881, "comment_id": 62064654, "body": "Why do you need to override the <code>ErrorWriter</code> from the original code? Do you have any real arguments for this? If not you can use the default <code>ErrorWriter</code> just fine."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1463469322, "last_edit_date": 1463469322, "creation_date": 1463467313, "answer_id": 37268881, "question_id": 37268594, "link": "https://stackoverflow.com/questions/37268594/cannot-use-responseerrorwriter-literal-type-responseerrorwriter-as-type-error/37268881#37268881", "title": "cannot use ResponseErrorWriter literal (type ResponseErrorWriter) as type error in GO", "body": "<p>Your issue relies on the following line from original <a href=\"https://github.com/rcrowley/go-tigertonic/blob/4d66e86f21fd4f5a6e54ed510bc076b9d870be6f/error.go#L74\" rel=\"nofollow\">source code</a> :</p>\n\n<pre><code>var ResponseErrorWriter ErrorWriter = defaultErrorWriter{}\n\ntype ErrorWriter interface {\n    WriteError(r *http.Request, w http.ResponseWriter, err error)\n    WriteJSONError(w http.ResponseWriter, err error)\n    WritePlaintextError(w http.ResponseWriter, err error)\n}\n</code></pre>\n\n<p>Analyzing the above code it's clear that <code>ResponseErrorWriter</code> is defined as <code>ErrorWriter</code> which means that it's type is a custom type which implements the methods declared inside the interface. This means that you have to implement the methods declared as interface. </p>\n\n<p>An interface defines a set of methods (the method set), but these methods do not contain code: they are not implemented (they are abstract). Interfaces in Go are some kind of contracts between the structs and the methods they needs to implement. </p>\n\n<hr>\n\n<p>If you really need to implement your <code>ErrorWriter</code> interface, you need to declare your custom struct, which implements the method defined in the original <code>ErrorWriter</code> interface. Then you need to invoke the methods declared. How do you want to handle the errors it all depends on you. </p>\n\n<p>If you check the source you will see that it implemented in the following way:</p>\n\n<pre><code>func (d defaultErrorWriter) WriteError(r *http.Request, w http.ResponseWriter, err error) {\n    if acceptJSON(r) {\n        d.WriteJSONError(w, err)\n    } else {\n        d.WritePlaintextError(w, err)\n    }\n}\n</code></pre>\n\n<p>The only thing left behind is to define the local struct variable as:</p>\n\n<pre><code>type defaultErrorWriter struct{}\n</code></pre>\n"}], "owner": {"reputation": 8104, "user_id": 1838205, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aeCc2.jpg?s=128&g=1", "display_name": "itzmebibin", "link": "https://stackoverflow.com/users/1838205/itzmebibin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 837, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463469322, "creation_date": 1463466177, "question_id": 37268594, "link": "https://stackoverflow.com/questions/37268594/cannot-use-responseerrorwriter-literal-type-responseerrorwriter-as-type-error", "title": "cannot use ResponseErrorWriter literal (type ResponseErrorWriter) as type error in GO", "body": "<p>In my <code>GO</code> project I am getting an error in <code>server.go</code> file as,</p>\n\n<blockquote>\n  <h1>mygo/testkit/pkg/http/server pkg\\http\\server\\server.go:24: cannot use ResponseErrorWriter literal (type ResponseErrorWriter) as type</h1>\n  \n  <p>tigertonic.ErrorWriter in assignment:\n          ResponseErrorWriter does not implement tigertonic.ErrorWriter (missing WriteError method)</p>\n</blockquote>\n\n<p>Here is my <code>init()</code> function, which gives the error in <code>server.go</code>.</p>\n\n<pre><code>func init() {\n    tt.ResponseErrorWriter = ResponseErrorWriter{}\n    tt.SnakeCaseHTTPEquivErrors = false // Ignored in ResponseErrorWriter anyway.\n}\n</code></pre>\n\n<p>And I am getting the error at this line,</p>\n\n<pre><code>tt.ResponseErrorWriter = ResponseErrorWriter{}\n</code></pre>\n\n<p>What will be the reason for this error? How to solve this? I am new to this GO framework.</p>\n"}, {"tags": ["http", "go", "timeout"], "comments": [{"owner": {"reputation": 742, "user_id": 717318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13e99fc7225ca378040ef36ef1a3049e?s=128&d=identicon&r=PG", "display_name": "Kevin Deenanauth", "link": "https://stackoverflow.com/users/717318/kevin-deenanauth"}, "edited": false, "score": 0, "creation_date": 1463464405, "post_id": 37268031, "comment_id": 62062545, "body": "Does the compile error go away after removing that line? It looks correct to me, but perhaps there&#39;s a hidden or unicode sneaking in there?"}, {"owner": {"reputation": 8104, "user_id": 1838205, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aeCc2.jpg?s=128&g=1", "display_name": "itzmebibin", "link": "https://stackoverflow.com/users/1838205/itzmebibin"}, "reply_to_user": {"reputation": 742, "user_id": 717318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13e99fc7225ca378040ef36ef1a3049e?s=128&d=identicon&r=PG", "display_name": "Kevin Deenanauth", "link": "https://stackoverflow.com/users/717318/kevin-deenanauth"}, "edited": false, "score": 0, "creation_date": 1463464502, "post_id": 37268031, "comment_id": 62062586, "body": "@KevinDeenanauth : If I remove or comment this line, then its not giving any compile error."}, {"owner": {"reputation": 742, "user_id": 717318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13e99fc7225ca378040ef36ef1a3049e?s=128&d=identicon&r=PG", "display_name": "Kevin Deenanauth", "link": "https://stackoverflow.com/users/717318/kevin-deenanauth"}, "edited": false, "score": 0, "creation_date": 1463465238, "post_id": 37268031, "comment_id": 62062876, "body": "No clue - it&#39;s a valid field: <a href=\"https://play.golang.org/p/szXUKuYScx\" rel=\"nofollow noreferrer\">play.golang.org/p/szXUKuYScx</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1463485676, "post_id": 37268031, "comment_id": 62075873, "body": "is defaultExpectContinueTimeout defined correctly, compiler gives such err:  &quot;unknown X field &#39;Y&#39; in struct literal when Y not defined."}, {"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "edited": false, "score": 0, "creation_date": 1463486067, "post_id": 37268031, "comment_id": 62076172, "body": "Are you, by any chance, using gccgo? If so, can you reproduce the problem with gc?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1463500554, "last_edit_date": 1463500554, "creation_date": 1463497199, "answer_id": 37279729, "question_id": 37268031, "link": "https://stackoverflow.com/questions/37268031/unknown-http-transport-field-expectcontinuetimeout-in-struct-literal-in-go/37279729#37279729", "title": "unknown http.Transport field &#39;ExpectContinueTimeout&#39; in struct literal in GO", "body": "<p>The <a href=\"https://godoc.org/net/http#Transport.ExpectContinueTimeout\" rel=\"nofollow\">ExpectContinueTimeout</a> field was added in Go 1.6. Upgrade your version of Go.</p>\n"}], "owner": {"reputation": 8104, "user_id": 1838205, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aeCc2.jpg?s=128&g=1", "display_name": "itzmebibin", "link": "https://stackoverflow.com/users/1838205/itzmebibin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463500554, "creation_date": 1463463789, "question_id": 37268031, "link": "https://stackoverflow.com/questions/37268031/unknown-http-transport-field-expectcontinuetimeout-in-struct-literal-in-go", "title": "unknown http.Transport field &#39;ExpectContinueTimeout&#39; in struct literal in GO", "body": "<p>In my GO project I am getting an error in <code>transport.go</code> file as,</p>\n\n<blockquote>\n  <p>mygo/testkit/pkg/http</p>\n  \n  <h1>mygo/testkit/pkg/http pkg\\http\\transport.go:93: unknown http.Transport field 'ExpectContinueTimeout' in struct literal</h1>\n</blockquote>\n\n<p>Here is my <code>newDefaultTransport()</code> function, which gives the error in <code>transport.go</code>.</p>\n\n<pre><code>func newDefaultTransport() *http.Transport {\n    return &amp;http.Transport{\n\n        DisableCompression: disableCompression,    \n        DisableKeepAlives:   defaultDisableKeepAlives,\n        MaxIdleConnsPerHost: defaultMaxIdleConnsPerHost,\n        ResponseHeaderTimeout: defaultResponseHeaderTimeout,\n\n        ExpectContinueTimeout: defaultExpectContinueTimeout,\n\n        TLSHandshakeTimeout: defaultTLSHandshakeTimeout,\n        TLSClientConfig:     newTLSClientConfig(),    \n        Proxy: http.ProxyFromEnvironment,\n        Dial: func(network, addr string) (net.Conn, error) {\n            return NewTimeoutConnDial(network, addr, TCPDialTimeout, TCPKeepAlive, defaultIdleTimeout)\n        },\n    }\n}\n</code></pre>\n\n<p>And I am getting the error at this line,</p>\n\n<pre><code>ExpectContinueTimeout: defaultExpectContinueTimeout,\n</code></pre>\n\n<p>What will be the reason for this error? How to solve this? I am new to this <code>GO</code> framework.</p>\n"}, {"tags": ["arrays", "matrix", "go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 6, "last_activity_date": 1463465536, "last_edit_date": 1463465536, "creation_date": 1463461958, "answer_id": 37267637, "question_id": 37267549, "link": "https://stackoverflow.com/questions/37267549/how-to-allocate-a-non-constant-sized-2d-array-in-go/37267637#37267637", "title": "How to allocate a non-constant sized 2D array in Go?", "body": "<p>There's no \"one liner\" way to do that. simply do:</p>\n\n<pre><code>matrix := make([][]int, myLength)\nfor i : = 0; i &lt; myLength; i++ {\n   matrix[i] = make([]int, myLength)\n}\n</code></pre>\n"}], "owner": {"reputation": 2449, "user_id": 4313927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/568720341/picture?type=large", "display_name": "Nicky Feller", "link": "https://stackoverflow.com/users/4313927/nicky-feller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "closed_date": 1463463751, "accepted_answer_id": 37267637, "answer_count": 1, "score": 2, "last_activity_date": 1463465536, "creation_date": 1463461479, "last_edit_date": 1495535348, "question_id": 37267549, "link": "https://stackoverflow.com/questions/37267549/how-to-allocate-a-non-constant-sized-2d-array-in-go", "closed_reason": "Duplicate", "title": "How to allocate a non-constant sized 2D array in Go?", "body": "<p>I want to allocate space for a 2 dimensional array and I want to do so in a clean way.</p>\n\n<pre><code>address [10]int\nmyLength := len(address)\n\n// 1. but this not work at all\nmatrix := [myLength][myLength]byte\n\n// 2. and this initializes 10 arrays with length 0\nmatrix := make([][]int, myLength, myLength)\n</code></pre>\n\n<p>I am getting an error for the first attempt:</p>\n\n<blockquote>\n  <p>non-constant array bound l</p>\n</blockquote>\n\n<p>PS not solved by: <a href=\"https://stackoverflow.com/questions/23290858/how-to-allocate-a-non-constant-sized-array-in-go\">How to allocate a non-constant sized array in Go</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 3, "last_activity_date": 1463460283, "last_edit_date": 1495540793, "creation_date": 1463460283, "answer_id": 37267322, "question_id": 37267204, "link": "https://stackoverflow.com/questions/37267204/does-a-function-have-to-satisfy-the-exact-signature-of-a-function-type/37267322#37267322", "title": "Does a function have to satisfy the exact signature of a function type?", "body": "<p>Yes, a function has to satisfy the exact signature of the function type. Similar things come up in other contexts: a more formal way to say it is that generally <a href=\"https://stackoverflow.com/questions/3839335/any-sensible-solution-to-the-lack-of-array-slice-covariance-in-go?rq=1\">types in Go lack covariance</a>. Here, you could wrap <code>json.NewEncoder</code> in a function returning <code>MyEncoder</code>. </p>\n\n<p>I'd use the value type <code>MyEncoder</code> not the pointer <code>*MyEncoder</code> because if you store a pointer <em>inside</em> the interface value then generally you don't also need a pointer <em>to</em> the interface value just to avoid copies; <a href=\"https://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values/23551970#23551970\">here's more on pointers vs. values</a> if it helps.</p>\n"}], "owner": {"reputation": 28653, "user_id": 527288, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9e175031c4adde62f40456f86a5e91b0?s=128&d=identicon&r=PG", "display_name": "Kurtis Nusbaum", "link": "https://stackoverflow.com/users/527288/kurtis-nusbaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 37267322, "answer_count": 1, "score": 1, "last_activity_date": 1463460283, "creation_date": 1463459697, "question_id": 37267204, "link": "https://stackoverflow.com/questions/37267204/does-a-function-have-to-satisfy-the-exact-signature-of-a-function-type", "title": "Does a function have to satisfy the exact signature of a function type?", "body": "<p>Consider the following simple go program</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"encoding/json\"\n    \"os\"\n)\n\ntype MyEncoder interface {\n    Encode(v interface{}) error\n}\n\ntype MyEncoderCreator func(io.Writer) *MyEncoder\n\ntype MyContainer struct {\n    Creator MyEncoderCreator\n}\n\nfunc main() {\n    container := Container{\n        Creator:json.NewEncoder,\n    }\n\n    encoder := container.Creator(os.Stdout)\n    encoder.Encode(map[string]string{\"key\":\"value\"})\n}\n</code></pre>\n\n<p>This program fails to compile with the following error:</p>\n\n<pre><code>./main.go:21: cannot use json.NewEncoder (type func(io.Writer) *json.Encoder) as type MyEncoderCreator in field value\n</code></pre>\n\n<p>Why is this? The <code>json.Encoder</code> struct has a receiver that satisfies the <code>MyEncoder</code> interface. So should the <code>json.NewEncoder</code> function be allowed to assigned to <code>MyContainer.Creator</code>?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "edited": false, "score": 0, "creation_date": 1463458429, "post_id": 37266900, "comment_id": 62060433, "body": "Thanks! But the reason I&#39;m using sudo is because I got permission errors. package github.com/njasm/gosoundcloud: mkdir /home/maker/go/src/github.com: permission denied"}, {"owner": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "edited": false, "score": 0, "creation_date": 1463458561, "post_id": 37266900, "comment_id": 62060467, "body": "chown -R username directory and chmod -R u+rX directory fixed it"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "edited": false, "score": 0, "creation_date": 1463483040, "post_id": 37266900, "comment_id": 62074013, "body": "Odd. perhaps you created that directory with <code>sudo mkdir ...</code>?"}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 2, "last_activity_date": 1463457877, "creation_date": 1463457877, "answer_id": 37266900, "question_id": 37266750, "link": "https://stackoverflow.com/questions/37266750/gopath-not-set-correctly-and-cannot-download/37266900#37266900", "title": "GOPATH not set correctly and cannot download", "body": "<p>Don't use <code>sudo</code>.</p>\n\n<p>Your $GOPATH is pointing to your local use account.  So a guess is that you have $GOPATH set in your <code>.profile</code> or <code>.bashrc</code> file, meaning it is local to your user.</p>\n\n<p>Go is meant to run within your user space, with no sudo for development.  </p>\n\n<p>so...</p>\n\n<pre><code>go get github.com/njasm/gosoundcloud\n</code></pre>\n\n<p>If you installed Go with <code>sudo apt-get install Go</code>, that's fine.  Just make sure your $GOPATH is set properly for your user, and run the command abve without sudo.</p>\n\n<p>Now, if you are trying to install a binary (is gosoundcloud a binary?), then first build it under your account:</p>\n\n<pre><code>go install github.com/njasm/gosoundcloud\n</code></pre>\n\n<p>This puts the binary into <code>$GOPATH/bin</code>.  Then just cp it:</p>\n\n<pre><code>sudo cp /home/maker/go/bin/{binary name} /usr/bin\n</code></pre>\n\n<p>Or alike...</p>\n"}], "owner": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 37266900, "answer_count": 1, "score": 1, "last_activity_date": 1463457877, "creation_date": 1463456890, "question_id": 37266750, "link": "https://stackoverflow.com/questions/37266750/gopath-not-set-correctly-and-cannot-download", "title": "GOPATH not set correctly and cannot download", "body": "<p>Initially the error happens when I want to install with go</p>\n\n<pre><code>sudo go get github.com/njasm/gosoundcloud\npackage github.com/njasm/gosoundcloud: cannot download, $GOPATH not set. For more details see: go help gopath\n</code></pre>\n\n<p>But when I look for the GOPATH</p>\n\n<pre><code>echo $GOPATH\nhome/maker/go\n</code></pre>\n\n<p>I can also build scripts, what is wrong?</p>\n"}, {"tags": ["json", "api", "go", "struct"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 2, "creation_date": 1463452802, "post_id": 37266025, "comment_id": 62059176, "body": "` iterate through the list of Greetings and push them as new Message items into Messages` is not a bad idea."}], "answers": [{"comments": [{"owner": {"reputation": 330, "user_id": 1524867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R1Wat.jpg?s=128&g=1", "display_name": "Drew Ogryzek", "link": "https://stackoverflow.com/users/1524867/drew-ogryzek"}, "edited": false, "score": 0, "creation_date": 1463453518, "post_id": 37266266, "comment_id": 62059319, "body": "Yeah, in my case, the point is that the fields aren&#39;t the same."}, {"owner": {"reputation": 330, "user_id": 1524867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R1Wat.jpg?s=128&g=1", "display_name": "Drew Ogryzek", "link": "https://stackoverflow.com/users/1524867/drew-ogryzek"}, "edited": false, "score": 0, "creation_date": 1463454729, "post_id": 37266266, "comment_id": 62059552, "body": "When we say &quot;tag&quot; are we referring to the json keys? and &quot;field&quot; to the struct fields?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 330, "user_id": 1524867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R1Wat.jpg?s=128&g=1", "display_name": "Drew Ogryzek", "link": "https://stackoverflow.com/users/1524867/drew-ogryzek"}, "edited": false, "score": 0, "creation_date": 1463454855, "post_id": 37266266, "comment_id": 62059582, "body": "Yes, that&#39;s it. <code>json:&quot;abcd&quot;</code> are called tags in Go. And you&#39;re correct about struct fields too."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 1, "last_activity_date": 1463453071, "creation_date": 1463453071, "answer_id": 37266266, "question_id": 37266025, "link": "https://stackoverflow.com/questions/37266025/go-map-nested-structs-to-different-nested-structs-with-the-same-data-through-a-j/37266266#37266266", "title": "Go map nested structs to different nested structs with the same data through a JSON API", "body": "<p>As you noticed, you can't use type []Greeting as type []Message. Because they are not the same type. However, there is a way to convert from one type to another, but it requires <a href=\"https://golang.org/ref/spec#Type_identity\" rel=\"nofollow\">identical</a> types.</p>\n\n<p>For example, the following would work:</p>\n\n<pre><code>type Message struct {\n    From string    `json:\"from\"`\n    To string      `json:\"to\"`\n    Message string `json:\"message\"`\n}\n\ntype Greeting struct {\n    From string    `json:\"from\"`\n    To string      `json:\"to\"`\n    Message string `json:\"message\"`\n}\n\nfunc main() {\n    mess := Message{\"from\", \"to\", \"message\"}\n    fmt.Println(reflect.TypeOf(mess))\n    // &gt; Message\n    greet := Greeting(mess)\n    fmt.Println(reflect.TypeOf(greet))\n    // &gt; Greeting\n}\n</code></pre>\n\n<p>However, it requires that the fields are the same, and the json tags as well.</p>\n\n<p>In your case, iterating through greetings and transforming them into messages will work without problems.</p>\n"}, {"tags": [], "owner": {"reputation": 330, "user_id": 1524867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R1Wat.jpg?s=128&g=1", "display_name": "Drew Ogryzek", "link": "https://stackoverflow.com/users/1524867/drew-ogryzek"}, "is_accepted": true, "score": 0, "last_activity_date": 1463465506, "last_edit_date": 1495542773, "creation_date": 1463454300, "answer_id": 37266417, "question_id": 37266025, "link": "https://stackoverflow.com/questions/37266025/go-map-nested-structs-to-different-nested-structs-with-the-same-data-through-a-j/37266417#37266417", "title": "Go map nested structs to different nested structs with the same data through a JSON API", "body": "<p>Based on <a href=\"https://stackoverflow.com/users/3555300/jiang-yd\">Jiang YD</a>'s comment, I replaced</p>\n\n<pre><code>relationShip := &amp;RelationShip{Messages: greetings.Greetings}\n</code></pre>\n\n<p>with the following:</p>\n\n<pre><code>var relationShip RelationShip\nfor _, g := range greetings.Greetings {\n    relationShip.Messages = append(\n        relationShip.Messages, Message{\n            To: g.To, From: g.From, Message: g.Greeting,\n        },\n    )\n}\n</code></pre>\n\n<p>Which does what I'd like to do. Thanks for the feedback!</p>\n"}], "owner": {"reputation": 330, "user_id": 1524867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R1Wat.jpg?s=128&g=1", "display_name": "Drew Ogryzek", "link": "https://stackoverflow.com/users/1524867/drew-ogryzek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 37266417, "answer_count": 2, "score": 0, "last_activity_date": 1463465506, "creation_date": 1463451152, "question_id": 37266025, "link": "https://stackoverflow.com/questions/37266025/go-map-nested-structs-to-different-nested-structs-with-the-same-data-through-a-j", "title": "Go map nested structs to different nested structs with the same data through a JSON API", "body": "<p>Using Go, I'd like to accept a request with json data and translate it to different structs for the outgoing json request.</p>\n\n<p>Here's an example of what I mean:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n)\n\ntype Greetings struct {\n    Greetings []Greeting `json:\"data\"`\n}\n\ntype Greeting struct {\n    From     string `json:\"from\"`\n    To       string `json:\"to\"`\n    Greeting string `json:\"greeting\"`\n}\n\ntype RelationShip struct {\n    Messages []Message `json:\"data\"`\n}\n\ntype Message struct {\n    From    string `json:\"from\"`\n    To      string `json:\"to\"`\n    Message string `json:\"message\"`\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", Greet)\n    http.ListenAndServe(\":3000\", nil)\n}\n\nfunc Greet(rw http.ResponseWriter, request *http.Request) {\n    decoder := json.NewDecoder(request.Body)\n    var greetings Greetings\n    err := decoder.Decode(&amp;greetings)\n    if err != nil {\n        panic(err)\n    }\n    for _, g := range greetings.Greetings {\n        fmt.Printf(\"%s, to %s from %s.\\n\", g.Greeting, g.To, g.From)\n    }\n\n    relationShip := &amp;RelationShip{Messages: greetings.Greetings}\n    r, err := json.Marshal(&amp;relationShip)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(r))\n}\n</code></pre>\n\n<p>Here's an example curl request</p>\n\n<pre><code>curl -d '{\"data\": [{\"to\":\"drew\",\"from\":\"jo\",\"greeting\":\"Hey\"}, \\\n  {\"to\":\"lori\", \"from\":\"yuri\",\"greeting\":\"what up?\"}]}' \\\n  http://localhost:3000\n</code></pre>\n\n<p>I thought maybe I could get away with something like:</p>\n\n<pre><code>relationShip := &amp;RelationShip{Messages: greetings.Greetings}\n</code></pre>\n\n<p>But it I can't use type []Greeting as type []Message. I'm really new to Go, and statically typed languages in general. Do I iterate through the list of Greetings and push them as new Message items into Messages?</p>\n\n<p><strong>The Point</strong>: I'm writing an API that can take an incoming request, and send it to the correct third party API, which will always care about the same data, but may have different keys. So tips on the actual question, and/or also on a better approach are appreciated and welcome :)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 2, "creation_date": 1463446726, "post_id": 37265376, "comment_id": 62057692, "body": "<code>2^64</code> does not fit into <code>uint64</code>. (has nothing to do with base 2, actually, that would happen with fixed size integers in any base, unless you mean the fact that it becomes a perfect 0, rather than &quot;random overflow&quot;)."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1463446821, "post_id": 37265376, "comment_id": 62057707, "body": "Your code has a bug. Check my answer."}, {"owner": {"reputation": 11001, "user_id": 522412, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/i88kY.png?s=128&g=1", "display_name": "MirekE", "link": "https://stackoverflow.com/users/522412/mireke"}, "edited": false, "score": 0, "creation_date": 1463448725, "post_id": 37265376, "comment_id": 62058188, "body": "You got correct answers from both Thilo and khrm. But your code does not even get there - there is a condition ` if y &gt; 64 return 0`. That&#39;s why your implementation returns 0 if y &gt; 64..."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 11001, "user_id": 522412, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/i88kY.png?s=128&g=1", "display_name": "MirekE", "link": "https://stackoverflow.com/users/522412/mireke"}, "edited": false, "score": 1, "creation_date": 1463450731, "post_id": 37265376, "comment_id": 62058686, "body": "@MirekE I mention that. That condition should be 63 if what he is trying to do is print power of 2. But I thought he is asking why that function should return 0 in case y &gt; 64."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1463451328, "post_id": 37265376, "comment_id": 62058816, "body": "<code>pow</code> looks like it should compute x^y (mod 2^64), but it has weird edge cases (like returning 0 when y &gt; 64, and returning &quot;previous&quot; when result is 0). So I think the correct answer to the question is either that you need to spell out what the function is supposed to do, or that it&#39;s just buggy and you can&#39;t read meaning into the mistakes."}, {"owner": {"reputation": 617, "user_id": 628076, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1wBwL.jpg?s=128&g=1", "display_name": "Efox", "link": "https://stackoverflow.com/users/628076/efox"}, "edited": false, "score": 0, "creation_date": 1463523435, "post_id": 37265376, "comment_id": 62099272, "body": "pow should compute x^y. I am  just trying to trap cases where it returns 0 when it maxes out uint64. I am also at lost when I am expecting a max number of 18446744073709551615."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1463547799, "post_id": 37265376, "comment_id": 62105580, "body": "@Efox If you want to detect overflow, and send 0 in those cases then use snippet that I have written. I am assuming you want to return 0 where there&#39;s overflow."}], "answers": [{"tags": [], "owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "is_accepted": true, "score": 0, "last_activity_date": 1463548009, "last_edit_date": 1463548009, "creation_date": 1463446599, "answer_id": 37265456, "question_id": 37265376, "link": "https://stackoverflow.com/questions/37265376/why-is-the-pow-function-return-0-if-y-exceeds-64/37265456#37265456", "title": "Why is the pow function return 0 if y exceeds 64?", "body": "<p>Your pow shouldn't be based on what is y.  It would be less for bigger number.</p>\n\n<p>Use this:</p>\n\n<p>`</p>\n\n<pre><code>// Assuming that b will never be 0\nfunc mult(a, b uint64) (uint64, bool) {\n    result := a * b\n    return result, (result/b == a)\n}\n\nfunc pow(x uint64, y uint64) uint64 {\nif y == 0 {\n    return 1\n}\nif x == 0 {\n    return 0\n}\nvar result uint64 = 1\nvar counter uint64\nvar previous uint64\nvar ok bool\nfor y &gt; 0 {\n    previous = result\n    result, ok = mult(result, x)\n    if !ok {\n        return 0\n    }\n\n    y = y - 1\n    counter++\n    if result == 0 {\n        return previous\n    }\n}\n    return result\n}\n</code></pre>\n\n<p>Old answer before clarification:</p>\n\n<p>Actually it should be 63. It is because uint64 can have at max can have largest number as 2 ^ (64) -1 (2 raise to the power 64 minux 1). \nSo maximum number that can be generated for 2 power is 2 ^ 63. </p>\n\n<p>You can confirm that by running your code. It would give you same result as for all number greater that 63 if you remove the restriction of y > 64 . (9223372036854775808 or 2^63). That restriction should be y > 63.</p>\n"}], "owner": {"reputation": 617, "user_id": 628076, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1wBwL.jpg?s=128&g=1", "display_name": "Efox", "link": "https://stackoverflow.com/users/628076/efox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 37265456, "answer_count": 1, "score": 1, "last_activity_date": 1463548009, "creation_date": 1463445943, "last_edit_date": 1463451058, "question_id": 37265376, "link": "https://stackoverflow.com/questions/37265376/why-is-the-pow-function-return-0-if-y-exceeds-64", "title": "Why is the pow function return 0 if y exceeds 64?", "body": "<p>Why is the result of pow zero if y is greater than 64?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc pow(x uint64, y uint64) uint64 {\n    if y &gt; 64 {\n        return 0\n    }\n    var result uint64 = 1\n    var counter uint64\n    var previous uint64\n    for y &gt; 0 {\n        previous = result\n        result = result * x\n        y = y - 1\n        counter++\n        if result == 0 {\n            return previous\n        }\n    }\n    return result\n}\n\nfunc main() {\n    result1 := pow(2, 64)\n    fmt.Println(result1)\n    result2 := pow(2, 32)\n    fmt.Println(result2)\n    result3 := pow(2, 3)\n    fmt.Println(result3)\n}\n</code></pre>\n\n<p>I just realized that it is because it is in base 2. What can you say about this? (I am still new to programming and with golang.)</p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 24042, "user_id": 422289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4e5f72d9050f96c79a80795e1dd10b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Tavares", "link": "https://stackoverflow.com/users/422289/chris-tavares"}, "edited": false, "score": 2, "creation_date": 1463441422, "post_id": 37264726, "comment_id": 62056354, "body": "doesn&#39;t the <code>defer logFile.Close()</code> run at the end of the init function? Doesn&#39;t that mean you&#39;re closing the file out from under the logger?"}, {"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "reply_to_user": {"reputation": 24042, "user_id": 422289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4e5f72d9050f96c79a80795e1dd10b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Tavares", "link": "https://stackoverflow.com/users/422289/chris-tavares"}, "edited": false, "score": 0, "creation_date": 1463441687, "post_id": 37264726, "comment_id": 62056422, "body": "@ChrisTavares GAH. So I should run that in <code>main()</code> then?"}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1463442099, "post_id": 37264726, "comment_id": 62056561, "body": "@DougSmith  putting the defer in main and leaving the rest won&#39;t work; moving all of your log config to the top of main works... such as is suggested here <a href=\"https://stackoverflow.com/questions/32619318/logging-to-a-file-in-golang\" title=\"logging to a file in golang\">stackoverflow.com/questions/32619318/&hellip;</a>"}, {"owner": {"reputation": 24042, "user_id": 422289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4e5f72d9050f96c79a80795e1dd10b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Tavares", "link": "https://stackoverflow.com/users/422289/chris-tavares"}, "edited": false, "score": 0, "creation_date": 1463510977, "post_id": 37264726, "comment_id": 62093224, "body": "You could just leave the close out completely - it&#39;s not a file leak since you WANT the file open for the length of the process. When the process exits the file will get closed automatically by the OS."}], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 965724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5395c41b2ec6b180a1e28193596b9f49?s=128&d=identicon&r=PG", "display_name": "mlg", "link": "https://stackoverflow.com/users/965724/mlg"}, "is_accepted": true, "score": 3, "last_activity_date": 1463568248, "last_edit_date": 1463568248, "creation_date": 1463561602, "answer_id": 37294671, "question_id": 37264726, "link": "https://stackoverflow.com/questions/37264726/why-is-the-native-golang-logger-not-logging-when-its-a-global-variable/37294671#37294671", "title": "Why is the native Golang logger not logging when it&#39;s a global variable?", "body": "<p>As Doug already pointed out, the <code>init()</code> function will always be invoked before <code>main()</code>, and sequentially so. That means that when <code>init()</code> finishes, the queued up <code>defer</code>s within <code>init()</code> will execute, in this case closing your log.</p>\n\n<p>In most cases, you are not meant to call <code>log.Close()</code> at all. Note that all <code>Fatal</code> functions on <code>log</code> will <code>os.Exit</code>: </p>\n\n<p><a href=\"https://golang.org/src/log/log.go?s=9087:9131#L295\" rel=\"nofollow\">https://golang.org/src/log/log.go?s=9087:9131#L295</a></p>\n\n<p>And docs on <code>os.Exit</code> explicitly say <code>defer</code>s are not run</p>\n\n<pre><code>// Exit causes the current program to exit with the given status code.\n// Conventionally, code zero indicates success, non-zero an error.\n// The program terminates immediately; deferred functions are not run.\nfunc Exit(code int) {\n</code></pre>\n\n<p>Therefore, you might say the standard lib forces you to not <code>log.Close()</code> in case of a fatal error. Kind of suggests it's not a big deal.</p>\n\n<p>Note that <code>Panic</code> functions, however, will run <code>defer</code>red functions before exiting.</p>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1270, "favorite_count": 0, "accepted_answer_id": 37294671, "answer_count": 1, "score": 1, "last_activity_date": 1463568248, "creation_date": 1463440939, "question_id": 37264726, "link": "https://stackoverflow.com/questions/37264726/why-is-the-native-golang-logger-not-logging-when-its-a-global-variable", "title": "Why is the native Golang logger not logging when it&#39;s a global variable?", "body": "<p>I have some pretty simple code where I'm logging some error info to a file. </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n)\n\nvar testLogger *log.Logger\n\nfunc init() {\n    logFile, openErr1 := os.OpenFile(\"/home/doug/logs/test.log\", os.O_CREATE|os.O_RDWR|os.O_APPEND, 0666)\n\n    if openErr1 != nil {\n        log.Println(\"Uh oh! Could not open log file.\")\n    }\n\n    defer logFile.Close()\n\n    testLogger = log.New(logFile, \"PREFIX\", log.Lshortfile|log.Ldate|log.Ltime)\n}\n\nfunc main() {\n    testLogger.Println(\"meep meep\")\n}\n</code></pre>\n\n<p>However, whenever I open the file after running the program, it is always empty. What am I doing wrong?</p>\n"}, {"tags": ["ssl", "go", "https", "dns"], "comments": [{"owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "edited": false, "score": 0, "creation_date": 1463434108, "post_id": 37263175, "comment_id": 62053773, "body": "Is your server using SNI (<a href=\"https://en.wikipedia.org/wiki/Server_Name_Indication\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Server_Name_Indication</a>)?"}], "answers": [{"comments": [{"owner": {"reputation": 2428, "user_id": 345350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50cb4981bbaa51b1713269a29f78d826?s=128&d=identicon&r=PG", "display_name": "donatJ", "link": "https://stackoverflow.com/users/345350/donatj"}, "edited": false, "score": 0, "creation_date": 1463434819, "post_id": 37263618, "comment_id": 62054117, "body": "That worked <b>perfectly</b> on both the test domain and the real domain.  Thank you!"}], "tags": [], "owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "is_accepted": true, "score": 2, "last_activity_date": 1463434462, "creation_date": 1463434462, "answer_id": 37263618, "question_id": 37263175, "link": "https://stackoverflow.com/questions/37263175/fetch-an-https-asset-from-specific-ip-and-skipping-dns-lookup/37263618#37263618", "title": "Fetch an HTTPS Asset from Specific IP and Skipping DNS lookup", "body": "<p>I'm assuming your server is using SNI like the one used in the example.  Give this a try and see if it works for you.</p>\n\n<pre><code>package main\n\nimport (\n\n    \"crypto/tls\"\n    \"log\"\n    \"net/http\"\n\n)\n\nfunc main() {\n\n    tlsConfig := &amp;tls.Config{\n        ServerName: \"moupon.co\",\n    }\n    tlsConfig.BuildNameToCertificate()\n    transport := &amp;http.Transport{TLSClientConfig: tlsConfig}\n\n    client := &amp;http.Client{Transport: transport}\n    req, err := http.NewRequest(\"GET\", \"https://216.239.32.21/s/img/logo.png\", nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.Host = \"moupon.co\"\n\n    _, err = client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    log.Fatal(\"no errors\")\n}\n</code></pre>\n"}], "owner": {"reputation": 2428, "user_id": 345350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50cb4981bbaa51b1713269a29f78d826?s=128&d=identicon&r=PG", "display_name": "donatJ", "link": "https://stackoverflow.com/users/345350/donatj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 37263618, "answer_count": 1, "score": 2, "last_activity_date": 1463434462, "creation_date": 1463432398, "last_edit_date": 1463432717, "question_id": 37263175, "link": "https://stackoverflow.com/questions/37263175/fetch-an-https-asset-from-specific-ip-and-skipping-dns-lookup", "title": "Fetch an HTTPS Asset from Specific IP and Skipping DNS lookup", "body": "<p>I am working on some code for a device that will not be able to query a DNS. I will only have ports 80 and 443 available.</p>\n\n<p>The following works, but of course hits the DNS. The domain used is my personal domain, not the real domain the problem is for - it\u2019s work related and redacted. This is simply used to illustrate the issue.</p>\n\n<pre><code>package main\n\nimport (\n    \u201clog\u201d\n    \u201cnet/http\u201d\n)\n\nfunc main() {\n    client := &amp;http.Client{}\n    req, err := http.NewRequest(\u201cGET\u201d, \u201chttps://donatstudios.com/images/Spacecat/spacecat.svg\u201d, nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    _, err = client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    log.Fatal(\u201cno errors\u201d)\n}\n</code></pre>\n\n<p>I change the code to hit the specific IP address ala:</p>\n\n<pre><code>package main\n\nimport (\n    \u201clog\u201d\n    \u201cnet/http\u201d\n)\n\nfunc main() {\n    client := &amp;http.Client{}\n    req, err := http.NewRequest(\u201cGET\u201d, \u201chttps://162.243.23.224/images/Spacecat/spacecat.svg\u201d, nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.Host = \u201cdonatstudios.com\u201d\n\n    _, err = client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    log.Fatal(\u201cno errors\u201d)\n}\n</code></pre>\n\n<p>And now receive \u201ccannot validate certificate for 162.243.23.224 because it doesn't contain any IP SANs\u201d</p>\n\n<p>When <strong>not using an https domain</strong> the above code works.</p>\n\n<p>Presumably this is something to do with SSL. #go-nuts told me they believe this to happen before it ever hit the HTTP layer? I\u2019ve been poking this for hours and cannot figure out how to make it work.</p>\n"}, {"tags": ["go", "jenkins", "jenkins-plugins"], "comments": [{"owner": {"reputation": 105809, "user_id": 234938, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e509dcb9852f237fe0412caccc335ac9?s=128&d=identicon&r=PG", "display_name": "Christopher Orr", "link": "https://stackoverflow.com/users/234938/christopher-orr"}, "edited": false, "score": 0, "creation_date": 1463572623, "post_id": 37262712, "comment_id": 62120246, "body": "It sounds like you&#39;re using the Go Plugin for Jenkins, which sets the <code>GOROOT</code> automatically for you. I just tested it with a custom workspace, and it worked fine \u2014 the <code>GOROOT</code> pointed to the Go installation, not the workspace. So as David mentions in his answer, you should ensure that <code>GOROOT</code> isn&#39;t being set elsewhere (e.g. in the global or node configuration, or in your job configuration)."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1463432161, "creation_date": 1463432161, "answer_id": 37263127, "question_id": 37262712, "link": "https://stackoverflow.com/questions/37262712/jenkins-build-setup-for-go-projects/37263127#37263127", "title": "Jenkins build setup for Go Projects", "body": "<p>GOROOT should be the root of your go distribution.  Normally you don't need to set it.</p>\n\n<p>Clear that and try again.  If it still can't find bytes, set GOROOT to to directory where you installed go.   Basically, this is the parent dir to wherever bin/go exists.</p>\n"}, {"tags": [], "owner": {"reputation": 5435, "user_id": 1078503, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/00cb3812de2cb2d15f6e5d14c15e6ed8?s=128&d=identicon&r=PG", "display_name": "leiyonglin", "link": "https://stackoverflow.com/users/1078503/leiyonglin"}, "is_accepted": false, "score": 4, "last_activity_date": 1463482016, "creation_date": 1463482016, "answer_id": 37273939, "question_id": 37262712, "link": "https://stackoverflow.com/questions/37262712/jenkins-build-setup-for-go-projects/37273939#37273939", "title": "Jenkins build setup for Go Projects", "body": "<p>I use jenkin too but write build.sh by myself.\nTo give you a reference:</p>\n\n<p>build.sh</p>\n\n<pre><code>#!/usr/bin/bash\n\nWORKROOT=$(pwd)\ncd ${WORKROOT}\n\n# unzip go environment\ngo_env=\"go1.6.2.linux-amd64.tar.gz\"\nwget -c http://path/to/go/go1.6.2.linux-amd64.tar.gz\ntar -zxf $go_env\nif [ $? -ne 0 ];\nthen\n    echo \"fail in extract go\"\n    exit 1\nfi\necho \"OK for extract go\"\nrm -rf $go_env\n\n# prepare PATH, GOROOT and GOPATH\nexport PATH=$(pwd)/go/bin:$PATH\nexport GOROOT=$(pwd)/go\nexport GOPATH=$(pwd)\n\n# build\ncd path/to/your/project\ngo build\nif [ $? -ne 0 ];\nthen\n    echo \"fail to go build\"\n    exit 1\nfi\necho \"OK for go build\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 6828135, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GbmU-Vhm4Ao/AAAAAAAAAAI/AAAAAAAAtqw/gj2q5kXiVF8/photo.jpg?sz=128", "display_name": "CameronGo", "link": "https://stackoverflow.com/users/6828135/camerongo"}, "is_accepted": true, "score": 5, "last_activity_date": 1499938848, "last_edit_date": 1499938848, "creation_date": 1473796669, "answer_id": 39478056, "question_id": 37262712, "link": "https://stackoverflow.com/questions/37262712/jenkins-build-setup-for-go-projects/39478056#39478056", "title": "Jenkins build setup for Go Projects", "body": "<p>In addition to letting the Go plugin handle your GOROOT, there are some nuances to the GOPATH as well when it comes to getting dependencies.  We are putting our *.go source files in the root of our Git repositories, so they are easily managed via go commands on the Dev desktops.  So, I am using a build script to trick Go into thinking there is a package called main under /src/main via a symlink so that I can use the same script to build all of my go packages and pull the dependencies.  Here is my build script:</p>\n\n<p><code>#!/usr/bin/bash\nexport GOPATH=$WORKSPACE\nmkdir -p $GOPATH/src \nln -f -s $WORKSPACE $GOPATH/src/main\ngo get main\nCGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main main</code></p>\n"}, {"tags": [], "owner": {"reputation": 693, "user_id": 1802697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eH3MJ.jpg?s=128&g=1", "display_name": "Igor Maznitsa", "link": "https://stackoverflow.com/users/1802697/igor-maznitsa"}, "is_accepted": false, "score": 1, "last_activity_date": 1502917950, "creation_date": 1502917950, "answer_id": 45723079, "question_id": 37262712, "link": "https://stackoverflow.com/questions/37262712/jenkins-build-setup-for-go-projects/45723079#45723079", "title": "Jenkins build setup for Go Projects", "body": "<p>because jenkins works very well with maven. you can build golang projects under <a href=\"https://github.com/raydac/mvn-golang\" rel=\"nofollow noreferrer\">jenkins with mvn-golang plugin</a> and also make <a href=\"https://github.com/raydac/mvn-golang/wiki/Test-report-into-Jenkins-readable-format\" rel=\"nofollow noreferrer\">reports compatible with jenkins</a></p>\n"}, {"tags": [], "owner": {"reputation": 7266, "user_id": 1055200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e07717a37e32da4c3af5bbfd4e0e7950?s=128&d=identicon&r=PG", "display_name": "b.b3rn4rd", "link": "https://stackoverflow.com/users/1055200/b-b3rn4rd"}, "is_accepted": false, "score": 1, "last_activity_date": 1521064777, "creation_date": 1521064777, "answer_id": 49288294, "question_id": 37262712, "link": "https://stackoverflow.com/questions/37262712/jenkins-build-setup-for-go-projects/49288294#49288294", "title": "Jenkins build setup for Go Projects", "body": "<p>I would recommend using <a href=\"https://wiki.jenkins.io/display/JENKINS/Go+Plugin\" rel=\"nofollow noreferrer\">Go Plugin</a> for managing golang installations.</p>\n\n<p>Once you got it installed, it's important to understand golang environmental variables and their use, the mains are:</p>\n\n<p><code>$GOROOT</code> specified the location where go is installed</p>\n\n<p><code>$GOPATH</code> determines where your code is located and <code>go get</code> installs packages, by default it's <code>${HOME}/go</code></p>\n\n<pre><code>withEnv([\"GOROOT=${root}\", \"PATH+GO=${root}/bin:${HOME}/go/bin\"]) {\n    sh \"go get gopkg.in/alecthomas/gometalinter.v1\"\n    sh \"gometalinter.v1 --help\"\n}\n</code></pre>\n\n<p>With the setup above, we set <code>GOROOT</code> to our custom <code>go</code> installation and append <code>$PATH</code> with paths to binaries that we downloaded using <code>go get</code> and standard <code>go</code></p>\n"}], "owner": {"reputation": 1172, "user_id": 5523635, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/99addb4800f32a8cdfbcaaa5c66a28df?s=128&d=identicon&r=PG", "display_name": "rameshthoomu", "link": "https://stackoverflow.com/users/5523635/rameshthoomu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13049, "favorite_count": 3, "accepted_answer_id": 39478056, "answer_count": 5, "score": 6, "last_activity_date": 1529453057, "creation_date": 1463430466, "last_edit_date": 1529453057, "question_id": 37262712, "link": "https://stackoverflow.com/questions/37262712/jenkins-build-setup-for-go-projects", "title": "Jenkins build setup for Go Projects", "body": "<p>We are planning to setup Jenkin Build process for Go Projects. I setup Custom Workspace in jenkins and installing go1.6 from \"Global Tool Configuration\".</p>\n\n<p>I am getting error message while executing <code>go build</code>\nBelow is the GOPATH and GOROOT</p>\n\n<pre><code>GOPATH /var/lib/jenkins/workspace/project/go\nGOROOT  /var/lib/jenkins/workspace\n</code></pre>\n\n<hr>\n\n<pre><code>ain.go:20:2: cannot find package \"bytes\" in any of:\n    /var/lib/jenkins/workspace/src/pkg/bytes (from $GOROOT)\n    /var/lib/jenkins/workspace/project/go/src/bytes (from $GOPATH)\n</code></pre>\n\n<p>What I am missing here?.. Thanks for your help..</p>\n"}, {"tags": ["mysql", "google-app-engine", "go", "google-cloud-sql"], "comments": [{"owner": {"reputation": 125, "user_id": 4754999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b89xP.png?s=128&g=1", "display_name": "Kevin Malachowski", "link": "https://stackoverflow.com/users/4754999/kevin-malachowski"}, "edited": false, "score": 0, "creation_date": 1463423095, "post_id": 37259595, "comment_id": 62048083, "body": "I&#39;m hoping you can share more info about your setup. Are you running on App Engine? Are you running first/second generation?"}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "reply_to_user": {"reputation": 125, "user_id": 4754999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b89xP.png?s=128&g=1", "display_name": "Kevin Malachowski", "link": "https://stackoverflow.com/users/4754999/kevin-malachowski"}, "edited": false, "score": 0, "creation_date": 1463447973, "post_id": 37259595, "comment_id": 62058005, "body": "Thanks for the response... solved in the question below. :)"}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "reply_to_user": {"reputation": 125, "user_id": 4754999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b89xP.png?s=128&g=1", "display_name": "Kevin Malachowski", "link": "https://stackoverflow.com/users/4754999/kevin-malachowski"}, "edited": false, "score": 0, "creation_date": 1470900241, "post_id": 37259595, "comment_id": 65139660, "body": "By the way, this was for first generation, but I&#39;m running into this error trying to make it work on second generation: <code>TLS requested but server does not support TLS</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "edited": false, "score": 0, "creation_date": 1463447721, "post_id": 37263923, "comment_id": 62057943, "body": "Ah, got it. I couldn&#39;t find this information anywhere. Database connection finally successful! I will relay this information to Google support."}, {"owner": {"reputation": 8889, "user_id": 28037, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/65c06b3f346fc6eea1fb5e57a3d7451e?s=128&d=identicon&r=PG", "display_name": "culix", "link": "https://stackoverflow.com/users/28037/culix"}, "reply_to_user": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "edited": false, "score": 0, "creation_date": 1463461888, "post_id": 37263923, "comment_id": 62061498, "body": "@BenGuild Great to hear! So did you have custom SSL code in and around your <code>sql.Open()</code> call?"}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "edited": false, "score": 0, "creation_date": 1463462895, "post_id": 37263923, "comment_id": 62061895, "body": "Yes, hence the prompt about the certificate. ;)"}], "tags": [], "owner": {"reputation": 8889, "user_id": 28037, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/65c06b3f346fc6eea1fb5e57a3d7451e?s=128&d=identicon&r=PG", "display_name": "culix", "link": "https://stackoverflow.com/users/28037/culix"}, "is_accepted": true, "score": 4, "last_activity_date": 1463435857, "creation_date": 1463435857, "answer_id": 37263923, "question_id": 37259595, "link": "https://stackoverflow.com/questions/37259595/cannot-connect-to-google-cloud-sql-using-ssl-golang-from-google-app-engine/37263923#37263923", "title": "Cannot connect to Google Cloud SQL using SSL + Golang from Google App Engine", "body": "<p>Are you connecting with SSL? This error message indicates that must set the <code>ServerName</code> property when you register your custom TLSConfig with the mysql driver, <strong>in addition to</strong> specifying the <code>project-id:instance-name</code> inside <code>sql.Open()</code>.</p>\n\n<p>e.g. Use the TLS setup <a href=\"https://godoc.org/github.com/go-sql-driver/mysql#RegisterTLSConfig\" rel=\"nofollow\">from the docs</a>, but add a <code>ServerName</code> in your call to <code>RegisterTLSConfig</code>:</p>\n\n<pre><code>mysql.RegisterTLSConfig(\"custom\", &amp;tls.Config{\n            RootCAs:      rootCertPool,\n            Certificates: clientCert,\n            ServerName:   \"projectName:instanceName\",\n        })\n</code></pre>\n\n<p>Then append <code>?tls=nameOfYourCustomTLSConfig</code></p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"user@cloudsql(project-id:instance-name)/dbname?tls=custom\")\n</code></pre>\n"}], "owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1627, "favorite_count": 0, "accepted_answer_id": 37263923, "answer_count": 1, "score": 3, "last_activity_date": 1549909944, "creation_date": 1463419124, "question_id": 37259595, "link": "https://stackoverflow.com/questions/37259595/cannot-connect-to-google-cloud-sql-using-ssl-golang-from-google-app-engine", "title": "Cannot connect to Google Cloud SQL using SSL + Golang from Google App Engine", "body": "<p>Google says you can connect to Google Cloud SQL using Golang and the <code>go-sql-driver</code> like so:</p>\n\n<pre><code>import \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\ndb, err := sql.Open(\"mysql\", \"user@cloudsql(project-id:instance-name)/dbname\")\n</code></pre>\n\n<p>ref: <a href=\"https://cloud.google.com/appengine/docs/go/cloud-sql/reference\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/cloud-sql/reference</a></p>\n\n<p>... However, this (for me) generates a x509 certificate error:</p>\n\n<blockquote>\n  <p>x509: certificate is valid for projectName:instanceName, not\n  projectName</p>\n</blockquote>\n\n<p>I cannot figure out how to solve this. Adding the instance name again (even though it's already there) in the connection string does not help, nor is correct according to Google's own docs.</p>\n\n<p>Has anyone managed to make this work? What is wrong?</p>\n"}, {"tags": ["class", "go", "polymorphism"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1463425430, "post_id": 37259575, "comment_id": 62049389, "body": "There is no inheritance (and no polymorphism) in Go. Some related / possible duplicates: <a href=\"http://stackoverflow.com/questions/21251242/is-it-possible-to-call-overridden-method-from-parent-struct-in-golang\">one</a>, <a href=\"http://stackoverflow.com/questions/30622605/can-embedded-struct-method-have-knowledge-of-parent-child\">two</a>, <a href=\"http://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method\">three</a>, <a href=\"http://stackoverflow.com/questions/29144622/what-is-the-idiomatic-way-in-go-to-create-a-complex-hierarchy-of-structs\">four</a>."}], "answers": [{"comments": [{"owner": {"reputation": 270, "user_id": 3441492, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0960774e4fb167e4eed558f09a49067c?s=128&d=identicon&r=PG&f=1", "display_name": "How to change username", "link": "https://stackoverflow.com/users/3441492/how-to-change-username"}, "edited": false, "score": 0, "creation_date": 1463425476, "post_id": 37259774, "comment_id": 62049411, "body": "Okay, that&#39;s what I&#39;m trying to implement, may be you can enlight me how I can do this in GO? <a href=\"https://play.golang.org/p/sqF9nxQBBW\" rel=\"nofollow noreferrer\">play.golang.org/p/sqF9nxQBBW</a>  It&#39;s class factory which returns object depends on user input (config file really), then I must fill structure myStruct and save it to database."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 7, "last_activity_date": 1463419832, "creation_date": 1463419832, "answer_id": 37259774, "question_id": 37259575, "link": "https://stackoverflow.com/questions/37259575/polymorphism-in-go-interfaces/37259774#37259774", "title": "Polymorphism in GO interfaces", "body": "<p>No. You're embedding <code>A</code> in <code>B</code>. <code>B</code> has no definition for <code>Discover</code>, therefor the version on <code>A</code> is always invoked. That method has a receiver of type <code>A</code> and <code>A</code> has no awareness of <code>B</code> or the fact that it's embedded in <code>B</code>. Therefor <code>A</code> can only call it's own version of <code>GetTest()</code>.</p>\n\n<p>The only reason <code>B</code> satisfies the discover interface is because it has <code>A</code> embedded. It implements it indirectly. If you want the functionality on <code>B</code>, you have to define it on <code>B</code>. This isn't polymorphism at all, it's composition. <code>B</code> isn't an <code>A</code>, <code>B</code> has an <code>A</code>. If you want polymorphism, you use interfaces and implement them. <code>B</code> is a discoverable, but only because it has an <code>A</code>.</p>\n\n<p>I would assume this is just for the example but you actually have no reason at all to even have this <code>Discovery</code> method. Your interface should just require <code>GetTest</code> instead. Don't confuse embedding with inheritance. There is no inheritance in Go. If you want polymorphic behavior you achieve it by implementing interfaces and you can't cut corners like this because the relationship between an embedded type and the embeddor is not one of inheritance, there is no base class or \"overrides\".</p>\n"}, {"comments": [{"owner": {"reputation": 270, "user_id": 3441492, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0960774e4fb167e4eed558f09a49067c?s=128&d=identicon&r=PG&f=1", "display_name": "How to change username", "link": "https://stackoverflow.com/users/3441492/how-to-change-username"}, "edited": false, "score": 0, "creation_date": 1463425916, "post_id": 37260245, "comment_id": 62049615, "body": "Please look for comment in @evanmcdonnal answer, there&#39;s example what I&#39;m trying to do."}, {"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "reply_to_user": {"reputation": 270, "user_id": 3441492, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0960774e4fb167e4eed558f09a49067c?s=128&d=identicon&r=PG&f=1", "display_name": "How to change username", "link": "https://stackoverflow.com/users/3441492/how-to-change-username"}, "edited": false, "score": 2, "creation_date": 1463429689, "post_id": 37260245, "comment_id": 62051574, "body": "I would refrain from using names like <code>BaseClass</code> and <code>DerivedClass</code> in the code. It makes it much more confusing since there are no such thing as classes and inheritance in Go. If you break your implementation of the different <code>GetValue</code> methods, you can compose a larger <code>struct</code> with them. This would be one way that can mimic your desired behavior."}], "tags": [], "owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1463421498, "creation_date": 1463421498, "answer_id": 37260245, "question_id": 37259575, "link": "https://stackoverflow.com/questions/37259575/polymorphism-in-go-interfaces/37260245#37260245", "title": "Polymorphism in GO interfaces", "body": "<p>To add to @evanmcdonnal's point, embedding is neither inheritance nor polymorphism. Inheritance just happens to be a convenience such that you may get the implementation of an interface for free but in Go, its explicit. Embedding may seem like inheritance but is not, as @evanmcdonnal has pointed out.</p>\n\n<p>Rather, you should separate the concepts polymorphism from inheritance and embedding and inheritance. The comparisons do not carry over from most object oriented languages. As an example, below would be an implementation of polymorphism. Notice that <code>Discover</code> takes an interface and <code>A</code> and <code>B</code> implements the interface, making the function itself polymorphic.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype A struct{}\ntype B struct{}\n\ntype Test interface{\n    GetTest() string\n}\n\nfunc (a *A) GetTest() string {\n    return \"i am in A\"\n}\n\nfunc (b *B) GetTest() string {\n    return \"i am in B\"\n}\n\nfunc Discover(t Test) string {\n    return t.GetTest()\n}\n\nfunc main() {\n    a := &amp;A{}\n    b := &amp;B{}\n\n    fmt.Println(Discover(a))\n    fmt.Println(Discover(b))\n}\n</code></pre>\n"}], "owner": {"reputation": 270, "user_id": 3441492, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0960774e4fb167e4eed558f09a49067c?s=128&d=identicon&r=PG&f=1", "display_name": "How to change username", "link": "https://stackoverflow.com/users/3441492/how-to-change-username"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 37259774, "answer_count": 2, "score": 1, "last_activity_date": 1463421498, "creation_date": 1463419071, "question_id": 37259575, "link": "https://stackoverflow.com/questions/37259575/polymorphism-in-go-interfaces", "title": "Polymorphism in GO interfaces", "body": "<p>I'm trying to reach this way of polymorphism in GO</p>\n\n<pre><code>type Discoverer interface {\n    Discover() string\n}\n\ntype A struct {\n}\n\nfunc (obj A) GetTest() string {\n    return \"im in A\"\n}\n\ntype B struct {\n    A\n}\n\nfunc (obj B) GetTest() string {\n    return \"im in B\"\n}\n\nfunc (obj A) Discover() string {\n    return obj.GetTest()\n}\n\nfunc main() {\n    a := A{}\n    b := B{}\n\n    fmt.Println(a.Discover())\n    fmt.Println(b.Discover())\n}\n</code></pre>\n\n<p>Now I'm getting in output</p>\n\n<pre><code>im in A\nim in A\n</code></pre>\n\n<p>So, my question is: It is possible to see in output </p>\n\n<pre><code>im in A\nim in B\n</code></pre>\n\n<p>Without \"override\" Discover of B?</p>\n\n<pre><code>func (obj B) Discover() string {\n    return obj.GetTest()\n}\n</code></pre>\n\n<p>Why? I've alot of small methods in struct (as classes) and Discover pretty  the same for all structs, so I want to avoid copy&amp;paste Discover in each struct(class)</p>\n\n<p>go playground <a href=\"https://play.golang.org/p/nYc2hc3UbG\" rel=\"nofollow\">https://play.golang.org/p/nYc2hc3UbG</a></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["pointers", "reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "edited": false, "score": 0, "creation_date": 1463558452, "post_id": 37257818, "comment_id": 62110753, "body": "So there is no way to implement <code>Initialize</code> so <code>Initialize(val)</code> works, right?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "edited": false, "score": 1, "creation_date": 1463579931, "post_id": 37257818, "comment_id": 62125719, "body": "Correct.  That&#39;s because arguments are passed by value in Go."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1463413223, "creation_date": 1463413223, "answer_id": 37257818, "question_id": 37257528, "link": "https://stackoverflow.com/questions/37257528/how-to-initialize-an-empty-pointer-by-reflect/37257818#37257818", "title": "How to initialize an empty pointer by reflect", "body": "<p>Here's how to do it:</p>\n\n<pre><code>func Initialize(v interface{}) {\n  rv := reflect.ValueOf(v).Elem()\n  rv.Set(reflect.New(rv.Type().Elem()))\n}\n</code></pre>\n\n<p>This function must be called with a pointer to the value to set:</p>\n\n<pre><code>Initialize(&amp;val)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rcIeNGe3Jb\" rel=\"nofollow\">playground example</a></p>\n\n<p>The code in this answer panics if the argument type is not a pointer to a pointer.  Depending on your use, you might want to check the reflect <a href=\"https://godoc.org/reflect#Value.Kind\" rel=\"nofollow\">value</a> <a href=\"https://godoc.org/reflect#Type.Kind\" rel=\"nofollow\">kind</a> before calling Elem().</p>\n"}], "owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 37257818, "answer_count": 1, "score": 1, "last_activity_date": 1463413223, "creation_date": 1463412324, "question_id": 37257528, "link": "https://stackoverflow.com/questions/37257528/how-to-initialize-an-empty-pointer-by-reflect", "title": "How to initialize an empty pointer by reflect", "body": "<p>This is a very straight forward question.</p>\n\n<p>How do you implement <code>Initialize()</code> below with <code>reflect</code>?\nOr is this possible?</p>\n\n<pre><code>func Initialize(v interface{}) {\n    // ... some reflection code\n}\n\ntype MyType struct {\n    Name string\n}\n\nfunc main() {\n    var val *MyType\n\n    // val is nil before initialize\n    Initialize(val)\n    // val is now &amp;MyType{Name: \"\"}\n\n    // ...\n}\n</code></pre>\n\n<p>```</p>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 0, "creation_date": 1463412719, "post_id": 37257399, "comment_id": 62042218, "body": "Yes, I have thought about this and I expect this is what I will have to do.  I just wondered if there were a way to directly access main&#39;s stdin/stdout."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 9, "last_activity_date": 1463411931, "creation_date": 1463411931, "answer_id": 37257399, "question_id": 37256859, "link": "https://stackoverflow.com/questions/37256859/how-can-i-write-a-go-test-that-writes-to-stdin/37257399#37257399", "title": "How can I write a Go test that writes to stdin?", "body": "<p>Instead of doing everything in <code>main</code> with <code>stdin</code> and <code>stdout</code>, you can define a function that takes an <code>io.Reader</code> and an <code>io.Writer</code> as parameters and does whatever you want it to do. <code>main</code> could then call that function and your test function could test that function directly. </p>\n"}, {"comments": [{"owner": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 0, "creation_date": 1463412572, "post_id": 37257483, "comment_id": 62042109, "body": "I&#39;ve removed the &quot;&gt; &quot; from my output and used your TestInput function. I get a series of approximately 100 repeating failures that look something like this:  === RUN   TestInput --- FAIL: TestInput (5.17s) \techo_test.go:36: Wanted: abc \t\t, Got: --- FAIL: TestInput (5.15s) \t\t\techo_test.go:36: Wanted: abc \t\t\t\t, Got: --- FAIL: TestInput (5.13s) \t\t\t\t\techo_test.go:36: Wanted: abc  ...and so on."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 0, "creation_date": 1463412849, "post_id": 37257483, "comment_id": 62042320, "body": "It works fine for me when removing the &quot;&gt; &quot;. Have you provided the right command to run ?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 0, "creation_date": 1463413412, "post_id": 37257483, "comment_id": 62042681, "body": "Go creates a temporary directory where to run the tests. When I print os.Args[0] this is what I get: <code>&#47;tmp&#47;go-build208836783&#47;command-line-arguments&#47;_test&#47;main.tes&zwnj;&#8203;t</code>. You need to install your program first with <code>go install .&#47;...</code> so it ends in your path, then running the associated command. My main file is elyk/main.go so the command I run is &quot;elyk&quot;"}, {"owner": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 0, "creation_date": 1463413762, "post_id": 37257483, "comment_id": 62042902, "body": "Yes.  So why would it not work with the binary built for the test run?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 0, "creation_date": 1463414311, "post_id": 37257483, "comment_id": 62043279, "body": "When running a <code>go test</code>, go creates a testing binary. It creates a main that runs all tests of the files using goroutines, and compile this. This is not the same as your program. More details on why the test binary is different than the one produced by <code>go install</code> here: <a href=\"https://golang.org/cmd/go/#hdr-Test_packages\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-Test_packages</a>"}, {"owner": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "edited": false, "score": 0, "creation_date": 1463414743, "post_id": 37257483, "comment_id": 62043561, "body": "Thank you for your help."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 4, "last_activity_date": 1463412184, "creation_date": 1463412184, "answer_id": 37257483, "question_id": 37256859, "link": "https://stackoverflow.com/questions/37256859/how-can-i-write-a-go-test-that-writes-to-stdin/37257483#37257483", "title": "How can I write a Go test that writes to stdin?", "body": "<p>Here is an example that writes to stdin and reads from stdout. Note that it does not work because the output contains \"> \" at first. Still, you can modify it to suit your needs.</p>\n\n<pre><code>func TestInput(t *testing.T) {\n    subproc := exec.Command(\"yourCmd\")\n    input := \"abc\\n\"\n    subproc.Stdin = strings.NewReader(input)\n    output, _ := subproc.Output()\n\n    if input != string(output) {\n        t.Errorf(\"Wanted: %v, Got: %v\", input, string(output))\n    }\n    subproc.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 1023522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e4228643e1c535585a4ff998ca02d?s=128&d=identicon&r=PG", "display_name": "Del Putnam", "link": "https://stackoverflow.com/users/1023522/del-putnam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4408, "favorite_count": 1, "accepted_answer_id": 37257483, "answer_count": 2, "score": 6, "last_activity_date": 1463412184, "creation_date": 1463410398, "question_id": 37256859, "link": "https://stackoverflow.com/questions/37256859/how-can-i-write-a-go-test-that-writes-to-stdin", "title": "How can I write a Go test that writes to stdin?", "body": "<p>Say that I have a simple application that reads lines from stdin and simply echoes it back to stdout. For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n    for {\n        fmt.Print(\"&gt; \")\n        bytes, _, err := reader.ReadLine()\n        if err == io.EOF {\n            os.Exit(0)\n        }\n        fmt.Println(string(bytes))\n    }\n}\n</code></pre>\n\n<p>I would like to write a test case that writes to stdin and then compares the output to the input. For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"io\"\n    \"os\"\n    \"os/exec\"\n    \"testing\"\n)\n\nfunc TestInput(t *testing.T) {\n    subproc := exec.Command(os.Args[0])\n    stdin, _ := subproc.StdinPipe()\n    stdout, _ := subproc.StdoutPipe()\n    defer stdin.Close()\n\n    input := \"abc\\n\"\n\n    subproc.Start()\n    io.WriteString(stdin, input)\n    reader := bufio.NewReader(stdout)\n    bytes, _, _ := reader.ReadLine()\n    output := string(bytes)\n    if input != output {\n        t.Errorf(\"Wanted: %v, Got: %v\", input, output)\n    }\n    subproc.Wait()\n}\n</code></pre>\n\n<p>Running <code>go test -v</code> gives me the following:</p>\n\n<pre><code>=== RUN   TestInput\n--- FAIL: TestInput (3.32s)\n    echo_test.go:25: Wanted: abc\n        , Got: --- FAIL: TestInput (3.32s)\nFAIL\nexit status 1\n</code></pre>\n\n<p>I'm obviously doing something incorrect here. How should I go about testing this type of code?</p>\n"}, {"tags": ["string", "algorithm", "loops", "go"], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 6077397, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d456f19ea4fc9981404a2e3dc7245b89?s=128&d=identicon&r=PG&f=1", "display_name": "Alex. b", "link": "https://stackoverflow.com/users/6077397/alex-b"}, "edited": false, "score": 0, "creation_date": 1463406169, "post_id": 37255379, "comment_id": 62037978, "body": "Won&#39;t this be impractical for searching through thousands of files? Or are you sure it&#39;s best solution?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 441, "user_id": 6077397, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d456f19ea4fc9981404a2e3dc7245b89?s=128&d=identicon&r=PG&f=1", "display_name": "Alex. b", "link": "https://stackoverflow.com/users/6077397/alex-b"}, "edited": false, "score": 0, "creation_date": 1463406420, "post_id": 37255379, "comment_id": 62038166, "body": "Another approach is to split the file according to the string you search, and count the number of line breaks in the segments, so you can compute the line numbers. Honestly, I do not know which is the most efficient, it depends on how go handles those operations internally."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 1, "last_activity_date": 1463406079, "creation_date": 1463406079, "answer_id": 37255379, "question_id": 37255304, "link": "https://stackoverflow.com/questions/37255304/golang-find-string-in-file-and-show-line-number/37255379#37255379", "title": "Golang: find string in file and show line number", "body": "<p>Split the file in lines first (can be done using <code>strings.Split</code> or <code>bytes.Split</code>), then iterate through the lines and check each line individually if it contains the wanted string. If yes, then print the line number.</p>\n"}, {"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1463408062, "post_id": 37255484, "comment_id": 62039187, "body": "It is probably better to use <code>scanner.Bytes()</code> and <code>bytes.Contains</code> to avoid conversions from <code>[]byte</code> to <code>string</code>. I&#39;m not sure a worker pool will help in the thousands of files case -- the code will be (or should be) io-bound, and multiple goroutines will mean more disk seeking."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1463408176, "post_id": 37255484, "comment_id": 62039260, "body": "A worker pool would depend on whether you read the files into memory first, how big they are, how many concurrently, etc. Not enough information to go by, but a small worker pool is unlikely to have downsides on even a single SSD."}, {"owner": {"reputation": 1648, "user_id": 9935654, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XdoefqMBYAQ/AAAAAAAAAAI/AAAAAAAAIfg/qFXt_RO4q5s/photo.jpg?sz=128", "display_name": "Carson", "link": "https://stackoverflow.com/users/9935654/carson"}, "edited": false, "score": 0, "creation_date": 1619072797, "post_id": 37255484, "comment_id": 118795095, "body": "If you want to read constant data, then try this <code>bufio.NewScanner(strings.NewReader(`bar foo ...`))</code>   <a href=\"https://golang.org/pkg/strings/#NewReader\" rel=\"nofollow noreferrer\">strings.NewReader</a>"}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 23, "last_activity_date": 1519847809, "last_edit_date": 1519847809, "creation_date": 1463406422, "answer_id": 37255484, "question_id": 37255304, "link": "https://stackoverflow.com/questions/37255304/golang-find-string-in-file-and-show-line-number/37255484#37255484", "title": "Golang: find string in file and show line number", "body": "<p>Use <a href=\"https://golang.org/pkg/bufio/#NewScanner\" rel=\"noreferrer\">scanner</a> to iterate over the file, line-by-line, incrementing your line count on each loop.</p>\n\n<p>e.g.</p>\n\n<pre><code>f, err := os.Open(path)\nif err != nil {\n    return 0, err\n}\ndefer f.Close()\n\n// Splits on newlines by default.\nscanner := bufio.NewScanner(f)\n\nline := 1\n// https://golang.org/pkg/bufio/#Scanner.Scan\nfor scanner.Scan() {\n    if strings.Contains(scanner.Text(), \"yourstring\") {\n        return line, nil\n    }\n\n    line++\n}\n\nif err := scanner.Err(); err != nil {\n    // Handle the error\n}\n</code></pre>\n\n<p>Update: if you need to do this across 'thousands of files' (as per the comment on another answer), then you would wrap this approach in a <a href=\"https://gobyexample.com/worker-pools\" rel=\"noreferrer\">worker pool</a> and run this concurrently.</p>\n"}, {"tags": [], "owner": {"reputation": 411, "user_id": 6205397, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ff2a90faa5b27c204ced0d63900e8ece?s=128&d=identicon&r=PG&f=1", "display_name": "GoGo", "link": "https://stackoverflow.com/users/6205397/gogo"}, "is_accepted": false, "score": 2, "last_activity_date": 1463469100, "creation_date": 1463469100, "answer_id": 37269433, "question_id": 37255304, "link": "https://stackoverflow.com/questions/37255304/golang-find-string-in-file-and-show-line-number/37269433#37269433", "title": "Golang: find string in file and show line number", "body": "<p>Hi Try this out. </p>\n\n<pre><code>    /* ioutil.ReadFile returns []byte, error */\n    data, err := ioutil.ReadFile(\"output.txt\")\n    /* ... omitted error check..and please add ... */\n    /* find index of newline */\n    file := string(data)\n    line := 0\n    /* func Split(s, sep string) []string */\n    temp := strings.Split(file, \"\\n\")\n\n    for _, item := range temp {\n        fmt.Println(\"[\",line,\"]\\t\",item)\n        line++\n    }\n</code></pre>\n\n<p>Basically, it will read file using ioutil package and find out newline from the contents. Strings packages is very useful when you find a certain character or newlines and so on.  Take a look at GO's official webpage for further note and examples. (<a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\">https://golang.org/pkg/strings/#Split</a>). </p>\n\n<p>I made a \"output.txt\" from (<a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\">https://golang.org/pkg/strings/#Split</a>) above and expected output should be </p>\n\n<pre><code>[ 0 ]    \n[ 1 ]    Examples\n[ 2 ]    \n[ 3 ]        Contains\n[ 4 ]        ContainsAny\n[ 5 ]        Count\n[ 6 ]        EqualFold\n[ 7 ]        Fields\n[ 8 ]        FieldsFunc\n[ 9 ]        HasPrefix\n[ 10 ]       HasSuffix\n...\n</code></pre>\n\n<p>Regarding the format, you can modify \n    <code>fmt.Println(\"[\",line,\"]\\t\",item)</code> with fmt.Printf(\n"}], "owner": {"reputation": 441, "user_id": 6077397, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d456f19ea4fc9981404a2e3dc7245b89?s=128&d=identicon&r=PG&f=1", "display_name": "Alex. b", "link": "https://stackoverflow.com/users/6077397/alex-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15422, "favorite_count": 4, "accepted_answer_id": 37255484, "answer_count": 3, "score": 9, "last_activity_date": 1519847809, "creation_date": 1463405897, "question_id": 37255304, "link": "https://stackoverflow.com/questions/37255304/golang-find-string-in-file-and-show-line-number", "title": "Golang: find string in file and show line number", "body": "<pre><code>read, err := ioutil.ReadFile(path)\nif err != nil {\n    return err\n}\n\nif strings.Contains(string(read), \"STRING\") {\n    // display line number?\n    // what if many occurrences of the string\n    // how to display for each the line number?\n}\n</code></pre>\n\n<p>I'm trying to search files for a specific string and display the line number at which the string is located.</p>\n"}, {"tags": ["go", "osx-yosemite", "vendor"], "answers": [{"comments": [{"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1463407502, "post_id": 37253866, "comment_id": 62038828, "body": "Thanks, i got this working. I had looked at a number of examples which seemed to suggest you could drop the /src folder. It clicked with your answer that you can drop src from within the vendor directory but the vendor directory has to be underneath /src. I really hate the way vendoring works in golang, this is a minor improvement. My new setup is to make home/me/projects my gopath, have a src folder under that and then under that I keep all my projects with their own vendor folders with individual dependencies. This seems to work."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1463401718, "last_edit_date": 1463401718, "creation_date": 1463401417, "answer_id": 37253866, "question_id": 37253780, "link": "https://stackoverflow.com/questions/37253780/go-golang-vendor-experiment-failing-on-mac-osx/37253866#37253866", "title": "GO (Golang) vendor experiment failing on mac osx", "body": "<blockquote>\n  <p>it seems to be looking in application/src</p>\n</blockquote>\n\n<p>Yes, go is looking in <code>$GOPATH/src</code>, both for your sources <em>and</em> for <code>vendor</code> sources folders.</p>\n\n<p>Everything should be in <code>$GOPATH/src</code></p>\n\n<p>The <strong><a href=\"https://golang.org/cmd/go/#hdr-Vendor_Directories\" rel=\"nofollow\">vendor folder</a></strong> is meant to be  importable only by code in the directory tree rooted at the parent of \"<code>vendor</code>\".<br>\nBut it is part of your sources, and as such, should be under <code>$GOPATH/src</code>.</p>\n"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 2, "accepted_answer_id": 37253866, "answer_count": 1, "score": 2, "last_activity_date": 1463401718, "creation_date": 1463401158, "question_id": 37253780, "link": "https://stackoverflow.com/questions/37253780/go-golang-vendor-experiment-failing-on-mac-osx", "title": "GO (Golang) vendor experiment failing on mac osx", "body": "<p>Having some trouble getting the go vendor experiment working with go 1.6.2 on osx.</p>\n\n<p>Heres my directory structure:</p>\n\n<pre><code>/project\n    /application\n        main.go\n        other.go\n        /vendor\n            /github.com\n                /vendor_name\n                    /package_name\n</code></pre>\n\n<p>I have my GOPATH set to <code>/Users/me/project/application</code>\nHowever when I try to run any of the go tools (e.g build) it seems to be looking in <code>application/src</code> rather than <code>application/vendor</code>, getting lots of this:</p>\n\n<pre><code>main.go:15:2: cannot find package \"github.com/facebookgo/grace/gracehttp\" in any of:\n    /usr/local/Cellar/go/1.6.2/libexec/src/github.com/facebookgo/grace/gracehttp (from $GOROOT)\n    /Users/me/project/application/src/github.com/facebookgo/grace/gracehttp (from $GOPATH)\n</code></pre>\n\n<p>As you can see for go env output vendor experiment is on by default as it should be it just doesnt seem to work:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/me/project/application\"\nGORACE=\"\"\nGOROOT=\"/usr/local/Cellar/go/1.6.2/libexec\"\nGOTOOLDIR=\"/usr/local/Cellar/go/1.6.2/libexec/pkg/tool/darwin_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Now, the source of the funkiness may be a hangover from previous go installations. I had installed various versions of go over time, some through gvm (go version manager) and some through homebrew. So I have uninstalled gvm and the versions of go it had installed, also unstalled go with homebrew and reinstalled just 1.6.2 using homebrew.</p>\n\n<p>go version output:</p>\n\n<pre><code>go version go1.6.2 darwin/amd64\n</code></pre>\n\n<p>which go:</p>\n\n<pre><code>/usr/local/bin/go\n</code></pre>\n\n<p>Any ideas what may have gone wrong here, or am I perhaps just misunderstanding how vendoring should work? </p>\n\n<p>P.S. Please elt me know if you need more info, happy to provide</p>\n"}, {"tags": ["function", "reflection", "go", "function-pointers"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1463405746, "last_edit_date": 1463405746, "creation_date": 1463405409, "answer_id": 37255140, "question_id": 37253717, "link": "https://stackoverflow.com/questions/37253717/golang-passing-function-arguments-with-arbitrary-interfaces/37255140#37255140", "title": "Golang Passing Function Arguments with Arbitrary Interfaces", "body": "<p>The problem is that <code>WrapperFunc()</code> expects a value of function type:</p>\n\n<pre><code>func(int, int, RequestBody) int\n</code></pre>\n\n<p>And you try to pass <code>add</code> to it which has a function type:</p>\n\n<pre><code>func(int, int, LoginRequest) int\n</code></pre>\n\n<p>2 <a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow\">function types</a> are equal if both have the same parameter and result types. This does not hold in the above mentioned 2 function types: <code>RequestBody</code> and <code>LoginRequest</code> are different types, and so function types having these as (or among) parameters are different types.</p>\n\n<p>You may only pass <code>add</code> to <code>WrapperFunc()</code> if you change its parameters to match the required type:</p>\n\n<pre><code>func add(a, b int, lr RequestBody) int {\n    fmt.Println(lr.GetDescription())\n    return a + b\n}\n</code></pre>\n\n<p>Now <code>add()</code> has the same function type as <code>fn</code> in the parameters of <code>WrapperFunc()</code>, so your code will compile and run.</p>\n\n<p>Output (try it on the <kbd><a href=\"https://play.golang.org/p/XJfbESwsz4\" rel=\"nofollow\">Go Playground</a></kbd>)</p>\n\n<pre><code>cool function\n7\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<p>Now <code>lr</code> parameter in <code>add()</code> is of type <code>RequestBody</code> and not <code>LoginRequest</code>. You may use it like a <code>RequestBody</code>, which is you may call its <code>GetDescription()</code> method. In <code>WrapperFunc()</code> you don't have to change anything, as <code>LoginRequest</code> implements <code>RequestBody</code>, so it is allowed to call <code>fn()</code> with a value of <code>LoginRequest</code>, and an interface value of type <code>RequestBody</code> will automatically, implicitly be created and passed to <code>fn</code> (which is <code>add()</code> in your case).</p>\n\n<p>Note that in <code>add()</code> since parameter is now a <code>RequestBody</code>, you can't refer to fields of <code>LoginRequest</code>. You may if the value implementing the interface is indeed a value of type <code>LoginRequest</code>, in which case you may use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a> to obtain the wrapped <code>LoginRequest</code> value should you need it.</p>\n"}], "owner": {"reputation": 9005, "user_id": 337504, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f365e5b3587387ed67c9c747288874e2?s=128&d=identicon&r=PG", "display_name": "Mustafa", "link": "https://stackoverflow.com/users/337504/mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1885, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1463405746, "creation_date": 1463400933, "question_id": 37253717, "link": "https://stackoverflow.com/questions/37253717/golang-passing-function-arguments-with-arbitrary-interfaces", "title": "Golang Passing Function Arguments with Arbitrary Interfaces", "body": "<p>The following code works nicely:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc WrapperFunc(fn func(int,int) int) int{\n    return fn(3,4)\n}\n\nfunc add(a,b int) int{\n    return a + b\n}\n\nfunc main(){\n    fmt.Println(WrapperFunc(add))\n}\n</code></pre>\n\n<p>I want to pass additional parameters that implements a specific interface.  For instance, I modify the code as follows:</p>\n\n<pre><code>import (\n    \"fmt\"\n)\n\ntype RequestBody interface {\n    GetDescription() string\n}\n\ntype LoginRequest struct {\n    Username string\n    Password string\n}\n\nfunc (lr LoginRequest) GetDescription() string{\n    return \"cool function\"\n}\n\nfunc WrapperFunc(fn func(int, int, RequestBody) int) int {\n    lr := LoginRequest{}\n    return fn(3, 4, lr)\n}\n\nfunc add(a, b int, lr LoginRequest) int {\n    fmt.Println(lr.GetDescription())\n    return a + b\n}\n\nfunc main() {\n    fmt.Println(WrapperFunc(add))\n}\n</code></pre>\n\n<p>It fails with the error below:</p>\n\n<pre><code>cannot use add (type func(int, int, LoginRequest) int) as type func(int, int, RequestBody) int in argument to WrapperFunc\n</code></pre>\n\n<p>However, when I do not implement the <code>GetDescription</code> as below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype RequestBody interface {\n    GetDescription() string\n}\n\ntype LoginRequest struct {\n    Username string\n    Password string\n}\n\nfunc WrapperFunc(fn func(int, int, RequestBody) int) int {\n    lr := LoginRequest{}\n    return fn(3, 4, lr)\n}\n\nfunc add(a, b int, lr LoginRequest) int {\n    return a + b\n}\n\nfunc main() {\n    fmt.Println(WrapperFunc(add))\n}\n</code></pre>\n\n<p>It fails with second error, as interface is not implemented (as expected). </p>\n\n<pre><code>cannot use lr (type LoginRequest) as type RequestBody in argument to fn:\n    LoginRequest does not implement RequestBody (missing GetDescription method)\n cannot use add (type func(int, int, LoginRequest) int) as type func(int, int, RequestBody) int in argument to WrapperFunc\n</code></pre>\n\n<p>So, it understands that, in <code>WrapperFunc</code> body, I can only call <code>fn</code> with <code>int</code>, <code>int</code> and an <code>RequestBody interface</code> that implements the <code>GetDescription</code>, yet I still cannot pass it in the function phase. How can I accomplish this? I want to wrap functions that can have parameters that their type can change.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1463532910, "post_id": 37253400, "comment_id": 62101722, "body": "Did my answer resolve the issue?"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1463603671, "post_id": 37253400, "comment_id": 62140254, "body": "@ Chetan Kumar  Please respond so that other people can benefit."}], "answers": [{"tags": [], "owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "is_accepted": true, "score": 3, "last_activity_date": 1463415509, "creation_date": 1463415509, "answer_id": 37258564, "question_id": 37253400, "link": "https://stackoverflow.com/questions/37253400/how-to-write-a-mongodb-slice-in-golang/37258564#37258564", "title": "How to write a MongoDB $slice in golang", "body": "<p>bson.M is map[string]interface not slice. And you need []interface for \"$slice\".</p>\n\n<pre><code>o1 := bson.M{\"$project\": bson.M{\"user\": bson.M{\"$slice\": []interface{}{\"$user\", 2, 1}}}}\n</code></pre>\n\n<p>If you share some dummy data, input and output, I could help you further.</p>\n"}], "owner": {"reputation": 308, "user_id": 6098460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1182201388457702/picture?type=large", "display_name": "Chetan Kumar", "link": "https://stackoverflow.com/users/6098460/chetan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 1, "accepted_answer_id": 37258564, "answer_count": 1, "score": 1, "last_activity_date": 1463415509, "creation_date": 1463399874, "last_edit_date": 1463409797, "question_id": 37253400, "link": "https://stackoverflow.com/questions/37253400/how-to-write-a-mongodb-slice-in-golang", "title": "How to write a MongoDB $slice in golang", "body": "<p>How do I write $slice MongoDB code in golang? Here is my MongoDB code:</p>\n\n<pre><code>db.userdetail.aggregate([{\"$project\":{\"user\":{\"$slice\":[\"$user\",2,1]}}}]).pretty()\n</code></pre>\n\n<p>I try to write this code in golang:</p>\n\n<pre><code>o1 := bson.M{\n        \"$project\":bson.M{\"user\":bson.M{\"$slice\":bson.M[\"$user\",2,1,],},},\n    }\n</code></pre>\n\n<p>It gives me the following err: <code>syntax error: unexpected comma, expecting ]</code></p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1463398539, "post_id": 37252565, "comment_id": 62033428, "body": "The number of elements in an array goes <i>before</i>, not after, the element type. So that would be <code>type State [5]struct{name string; population string}</code>."}], "answers": [{"tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 2, "last_activity_date": 1463398329, "creation_date": 1463398329, "answer_id": 37252925, "question_id": 37252565, "link": "https://stackoverflow.com/questions/37252565/how-to-create-an-array-of-struct-in-golang-as-we-create-in-c/37252925#37252925", "title": "How to create an array of struct in golang as we create in C", "body": "<p>Given a definition of a <code>Struct</code></p>\n\n<pre><code>type State struct{\n    name string\n    population string\n}\n</code></pre>\n\n<p>You have several ways. You can declare an array of 5 <code>State</code>s</p>\n\n<pre><code>var states [5]State\n</code></pre>\n\n<p>Or you can assign (and autodeclare) in one line</p>\n\n<pre><code>var states = [5]State{}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>states := State{}\n</code></pre>\n\n<p>You may want to start from the <a href=\"https://golang.org/doc/\" rel=\"nofollow\">Go documentation</a>.</p>\n"}], "owner": {"reputation": 1633, "user_id": 1683398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1feeb235dd5c51c93460ded77c6dccf0?s=128&d=identicon&r=PG", "display_name": "Anchal Sarraf", "link": "https://stackoverflow.com/users/1683398/anchal-sarraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2518, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1463399817, "creation_date": 1463397189, "last_edit_date": 1463399817, "question_id": 37252565, "link": "https://stackoverflow.com/questions/37252565/how-to-create-an-array-of-struct-in-golang-as-we-create-in-c", "title": "How to create an array of struct in golang as we create in C", "body": "<p>I want to create an array of <code>struct</code> in golang as we create in C. I am trying to create like this, but is not working.</p>\n\n<pre><code>type State struct{\n    name string\n    population string\n}st[5]\n</code></pre>\n"}, {"tags": ["go", "apache-kafka", "apache-zookeeper", "session-timeout", "zk"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4444006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1007943885/picture?type=large", "display_name": "Ankur Maharjan", "link": "https://stackoverflow.com/users/4444006/ankur-maharjan"}, "edited": false, "score": 0, "creation_date": 1463485998, "post_id": 37262205, "comment_id": 62076121, "body": "Yes, we are using sarama as well you can see logs from sarama in above mentioned logs."}], "tags": [], "owner": {"reputation": 1153, "user_id": 1371064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NnrmE.jpg?s=128&g=1", "display_name": "Carlos Andr&#233;s Garc&#237;a", "link": "https://stackoverflow.com/users/1371064/carlos-andr%c3%a9s-garc%c3%ada"}, "is_accepted": false, "score": 0, "last_activity_date": 1463428571, "creation_date": 1463428571, "answer_id": 37262205, "question_id": 37251905, "link": "https://stackoverflow.com/questions/37251905/authentication-failed-zk-session-timeout-issue/37262205#37262205", "title": "Authentication Failed zk Session Timeout Issue", "body": "<p>I have not used samuel's go-zookeeper. However, you are trying to connect to kafka server and make a connection with. To achieve this,  I have use <a href=\"https://shopify.github.io/sarama\" rel=\"nofollow\">samara </a> which is easy to use and reliable.</p>\n\n<p><a href=\"https://godoc.org/github.com/Shopify/sarama#pkg-examples\" rel=\"nofollow\">Here</a> some examples.</p>\n"}], "owner": {"reputation": 11, "user_id": 4444006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1007943885/picture?type=large", "display_name": "Ankur Maharjan", "link": "https://stackoverflow.com/users/4444006/ankur-maharjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1003, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463428571, "creation_date": 1463395026, "question_id": 37251905, "link": "https://stackoverflow.com/questions/37251905/authentication-failed-zk-session-timeout-issue", "title": "Authentication Failed zk Session Timeout Issue", "body": "<p>I am using <strong>samuel's go-zookeeper</strong> and have been encountering <strong>\"Authentication failed: zk: session has been expired by the server\"</strong> issue. Once this issue is encountered it does retry to reconnect to zookeeper and also get successfully connected. But the problem is it again gets <strong>\"Authentication failed\"</strong> issue or fails to register the consumers. Also, if it does get successfully connected and is Authenticated, consumer never consumes the message as <strong>\"Currently registered consumers: 0\"</strong> and this process continues unless I restart my client manually.</p>\n\n<p>What might be the issue and its solution??</p>\n\n<p>Here is the log:</p>\n\n<pre><code>[Scheduler] 2016/05/15 04:49:20 structs.go:21: Recv loop terminated: err=read tcp 10.244.0.9:41810-&gt;10.0.30.4:2181: i/o timeout\n[Scheduler] 2016/05/15 04:49:24 structs.go:21: Send loop terminated: err=&lt;nil&gt;\n[Scheduler] 2016/05/15 04:49:26 structs.go:21: Connected to 10.0.30.4:2181\n[Scheduler] 2016/05/15 04:49:53 structs.go:21: Authentication failed: read tcp 10.244.0.9:43854-&gt;10.0.30.4:2181: i/o timeout\n[Scheduler] 2016/05/15 04:49:57 structs.go:21: Connected to 10.0.30.4:2181\n[Scheduler] 2016/05/15 04:50:25 structs.go:21: Authentication failed: read tcp 10.244.0.9:43863-&gt;10.0.30.4:2181: i/o timeout\n[Scheduler] 2016/05/15 04:50:32 structs.go:21: Connected to 10.0.30.4:2181\n[Scheduler] 2016/05/15 04:51:06 structs.go:21: Authentication failed: read tcp 10.244.0.9:43873-&gt;10.0.30.4:2181: i/o timeout\n[Scheduler] 2016/05/15 04:51:55 structs.go:21: Connected to 10.0.30.4:2181\n[Scheduler] 2016/05/15 04:52:08 structs.go:21: Authentication failed: zk: session has been expired by the server\n[Sarama] 2016/05/15 04:52:08 [controller/fa956f688354] Triggering rebalance due to consumer list change\n[Scheduler] 2016/05/15 04:52:10 structs.go:21: Connected to 10.0.30.4:2181\n[Scheduler] 2016/05/15 04:52:10 structs.go:21: Authenticated: id=95829041879007139, timeout=4000\n[Sarama] 2016/05/15 04:52:10 [controller/fa956f688354] Currently registered consumers: 0\n[Sarama] 2016/05/15 04:52:10 [controller/fa956f688354] topic :: Started topic consumer\n[Sarama] 2016/05/15 04:52:10 [controller/fa956f688354] topic :: Stopped topic consumer\n[Sarama] 2016/05/15 04:53:22 client/metadata fetching metadata for all topics from broker 10.0.30.4:9092\n[Sarama] 2016/05/15 05:03:23 client/metadata fetching metadata for all topics from broker 10.0.30.4:9092\n.\n.\n.\n[Sarama] 2016/05/15 04:53:22 client/metadata fetching metadata for all topics from broker 10.0.30.4:9092\n</code></pre>\n"}, {"tags": ["go", "refactoring", "runtime"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1463402110, "post_id": 37251108, "comment_id": 62035538, "body": "I use <code>go list -f &quot;{{.ImportPath}} {{.Deps}}&quot; my&#47;program</code> to get all the dependencies, and I go get them in a temporary sub-folder. I use that to vendor dependencies: <a href=\"https://gist.github.com/VonC/51fe08c5bd79334b6e1ccdd498d4d2bc\" rel=\"nofollow noreferrer\">gist.github.com/VonC/51fe08c5bd79334b6e1ccdd498d4d2bc</a>. But that not be what you need or meant by &quot;fetch all source files that where used during compilation&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1463558369, "post_id": 37292875, "comment_id": 62110694, "body": "Nice (upvoted) I am still unsure about the exact issue it is solving though ;)"}, {"owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1463559740, "post_id": 37292875, "comment_id": 62111552, "body": "@VonC. I want to track files that where used during compilation and silently recompile and restart server."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1463559817, "post_id": 37292875, "comment_id": 62111605, "body": "OK, that is clearer now. You can add this as a description to your <a href=\"https://github.com/martende/restartable\" rel=\"nofollow noreferrer\">github.com/martende/restartable</a> repo."}, {"owner": {"reputation": 539, "user_id": 2352611, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0fY8c.jpg?s=128&g=1", "display_name": "Larytet", "link": "https://stackoverflow.com/users/2352611/larytet"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1542433880, "post_id": 37292875, "comment_id": 93575533, "body": "@VonC moduledata allows, for example, to get address of all strings in the executable, enumerate the strings, keep the strings in a hashtable. This can allow to improve performance of the functions which operate with strings."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 539, "user_id": 2352611, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0fY8c.jpg?s=128&g=1", "display_name": "Larytet", "link": "https://stackoverflow.com/users/2352611/larytet"}, "edited": false, "score": 0, "creation_date": 1542434867, "post_id": 37292875, "comment_id": 93575647, "body": "@Larytet OK, and I see it is still being updated: <a href=\"https://github.com/golang/go/commit/350b74bc4b9f37ba29ef02c2f89d687ae8563a05\" rel=\"nofollow noreferrer\">github.com/golang/go/commit/&hellip;</a>"}, {"owner": {"reputation": 539, "user_id": 2352611, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0fY8c.jpg?s=128&g=1", "display_name": "Larytet", "link": "https://stackoverflow.com/users/2352611/larytet"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1556183813, "post_id": 37292875, "comment_id": 98353745, "body": "@VonC, you can find an example of my code here  <a href=\"https://github.com/larytet/binlog/blob/master/binlog_test.go#L86\" rel=\"nofollow noreferrer\">github.com/larytet/binlog/blob/master/binlog_test.go#L86</a>"}], "tags": [], "owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "is_accepted": true, "score": 1, "last_activity_date": 1463559848, "last_edit_date": 1463559848, "creation_date": 1463556438, "answer_id": 37292875, "question_id": 37251108, "link": "https://stackoverflow.com/questions/37251108/golang-fetch-all-all-filepathes-from-compiled-file/37292875#37292875", "title": "golang fetch all all filepathes from compiled file", "body": "<p>Actually I have combined VonC answer and my runtime approcah. </p>\n\n<p>All needed data stored at <code>runtime.firstmoduledata</code> - struct but they are not exported. To read data from there I read my executable file again (implemented only for ELF), find this symbol and do the other part like runtime.Caller() function. This method is not portable and can be broken by changes in runtime library but it works.</p>\n\n<p><code>selfReflect</code> function uses copies of private types from runtime lib </p>\n\n<p><a href=\"https://github.com/martende/restartable/blob/master/restartable.go#L208\" rel=\"nofollow\">https://github.com/martende/restartable/blob/master/restartable.go#L208</a> </p>\n\n<pre><code>func selfReflect(filename string) ([]string,error) {\n    f,err := elf.Open(filename)\n    if err != nil {\n        return nil,err\n    }\n    defer f.Close()\n    syms,err := f.Symbols()\n    if err != nil {\n        return nil,err\n    }\n    var modSym elf.Symbol\n    var modSymFound = false\n    for _,v := range syms {\n        if v.Name == \"runtime.firstmoduledata\" {\n            modSym = v\n            modSymFound = true\n            break\n        }\n    }\n    if ! modSymFound {\n        return nil,errors.New(\"elfparse:nosym\")\n    }\n\n    var datap = (*moduledata)(unsafe.Pointer(uintptr(modSym.Value)))\n\n    files := make([]string,0)\n    for i := range datap.filetab {\n        bp := &amp;datap.pclntable[datap.filetab[i]]\n        file := C.GoString( (*C.char) (unsafe.Pointer(bp))  )\n        if file != \"&lt;autogenerated&gt;\" &amp;&amp; file != \"@\" {\n            if _, err := os.Stat(file); err == nil {\n                files = append(files ,file)\n            }\n        }\n    }\n\n\n    return files,nil\n}\n</code></pre>\n"}], "owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 2, "accepted_answer_id": 37292875, "answer_count": 1, "score": 1, "last_activity_date": 1463559848, "creation_date": 1463392364, "last_edit_date": 1463420654, "question_id": 37251108, "link": "https://stackoverflow.com/questions/37251108/golang-fetch-all-all-filepathes-from-compiled-file", "title": "golang fetch all all filepathes from compiled file", "body": "<p>I am trying to fetch all source files that where used during compilation.\nFunction runtime.Caller() and panic with its stacktrace show this info.</p>\n\n<p>I need something like this</p>\n\n<pre><code>func fetchUsedFiles() []string {\n    ....\n}\nfunc main() {\n    log.Println(\"Used Files\",fetchUsedFiles())\n}\n</code></pre>\n\n<p>UPD:</p>\n\n<p>All what I need is read somehow \"runtime.firstmoduledata\" variable content. But it is not exported variable. </p>\n"}, {"tags": ["windows", "go", "advapi32"], "comments": [{"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1463398521, "post_id": 37250855, "comment_id": 62033418, "body": "From EnumServicesStatusEx doco: <code>lpServices [out, optional] A pointer to the buffer that receives the status information. ... To determine the required size, specify NULL for this parameter and 0 for the cbBufSize parameter. The function will fail and GetLastError will return ERROR_MORE_DATA. The pcbBytesNeeded parameter will receive the required size.</code>. Once you know how large your buffer need to be, call EnumServicesStatusEx again with buffer of that size."}, {"owner": {"reputation": 363, "user_id": 2656351, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2145f303214260c85edc32b3f701dd9d?s=128&d=identicon&r=PG", "display_name": "iamacarpet", "link": "https://stackoverflow.com/users/2656351/iamacarpet"}, "reply_to_user": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1463404689, "post_id": 37250855, "comment_id": 62037008, "body": "Hello @alex, as described above, I don&#39;t know of a way to make Go allocate memory directly. You have to give it a data structure to make it allocate memory, then expose that memory via the unsafe package."}, {"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 1, "creation_date": 1463442301, "post_id": 37250855, "comment_id": 62056614, "body": "you said it yourself: <code>create a slice containing that number of elements, then pass a pointer to the first element to the function</code>. From EnumServicesStatusEx doco: <code>cbBufSize [in] The size of the buffer pointed to by the lpServices parameter, in bytes.</code> So you can create array of cbBufSize bytes, and pass address of first element of that array into EnumServicesStatusEx. See <a href=\"https://github.com/golang/go/blob/master/src/internal/syscall/windows/registry/value.go#L71\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/internal/syscall/window&zwnj;&#8203;s/&hellip;</a> for example. Unlike the example, you should start with passing lpServices=nil as per EnumServicesStatusEx doco."}, {"owner": {"reputation": 363, "user_id": 2656351, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2145f303214260c85edc32b3f701dd9d?s=128&d=identicon&r=PG", "display_name": "iamacarpet", "link": "https://stackoverflow.com/users/2656351/iamacarpet"}, "reply_to_user": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1463474173, "post_id": 37250855, "comment_id": 62068089, "body": "Yes I thought that, but if I created a slice of structs, those structs would contain pointers. The memory allocated would be enough to store the pointer address, but wouldn&#39;t actually allocate any memory for the API call to store the string data the pointer should reference as required by the MSDN docs. Although if the size required is given in bytes, I could create a byte slice that size then try to cast it to the correct type using unsafe. Will have to assume the memory layout will be compatible. I&#39;ll give that a try, thanks!"}, {"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1463527721, "post_id": 37250855, "comment_id": 62100582, "body": "You should allocate byte slice of requested size. It is up to the API that you call to layout everything it needs inside your byte buffer. Your job will be to cast address to your first byte into correct type using unsafe. Just like you said."}], "answers": [{"tags": [], "owner": {"reputation": 363, "user_id": 2656351, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2145f303214260c85edc32b3f701dd9d?s=128&d=identicon&r=PG", "display_name": "iamacarpet", "link": "https://stackoverflow.com/users/2656351/iamacarpet"}, "is_accepted": true, "score": 1, "last_activity_date": 1463758816, "creation_date": 1463758816, "answer_id": 37350591, "question_id": 37250855, "link": "https://stackoverflow.com/questions/37250855/calling-enumservicesstatusex-in-go-memory-allocation/37350591#37350591", "title": "Calling EnumServicesStatusEx in Go, memory allocation?", "body": "<p>After the suggestions from @alex, I've got the following example code working.</p>\n\n<p>Looks like we create a byte slice of the right size then use the unsafe class to cast to our struct type.</p>\n\n<pre><code>    _, _, _ = svcEnumServicesStatusEx.Call(\n        uintptr(handle),\n        uintptr(uint32(SVC_SC_ENUM_PROCESS_INFO)),\n        uintptr(uint32(SVC_SERVICE_WIN32)),\n        uintptr(uint32(SVC_SERVICE_STATE_ALL)),\n        uintptr(0),\n        0,\n        uintptr(unsafe.Pointer(&amp;bytesReq)),\n        uintptr(unsafe.Pointer(&amp;numReturned)),\n        uintptr(unsafe.Pointer(&amp;resumeHandle)),\n        uintptr(0),\n    )\n\n    if bytesReq &gt; 0 {\n        var buf []byte = make([]byte, bytesReq)\n\n        ret, _, _ := svcEnumServicesStatusEx.Call(\n            uintptr(handle),\n            uintptr(uint32(SVC_SC_ENUM_PROCESS_INFO)),\n            uintptr(uint32(SVC_SERVICE_WIN32)),\n            uintptr(uint32(SVC_SERVICE_STATE_ALL)),\n            uintptr(unsafe.Pointer(&amp;buf[0])),\n            uintptr(bytesReq),\n            uintptr(unsafe.Pointer(&amp;bytesReq)),\n            uintptr(unsafe.Pointer(&amp;numReturned)),\n            uintptr(unsafe.Pointer(&amp;resumeHandle)),\n            uintptr(0),\n        )\n\n        if ret &gt; 0 {\n            var sizeTest ENUM_SERVICE_STATUS_PROCESS\n            iter := uintptr(unsafe.Pointer(&amp;buf[0]))\n\n            for i := uint32(0); i &lt; numReturned; i++ {\n                var data *ENUM_SERVICE_STATUS_PROCESS = (*ENUM_SERVICE_STATUS_PROCESS)(unsafe.Pointer(iter))\n\n                fmt.Printf(\"Service Name: %s - Display Name: %s - %#v\\r\\n\", syscall.UTF16ToString((*[4096]uint16)(unsafe.Pointer(data.lpServiceName))[:]), syscall.UTF16ToString((*[4096]uint16)(unsafe.Pointer(data.lpDisplayName))[:]), data.ServiceStatusProcess)\n\n                iter = uintptr(unsafe.Pointer(iter + unsafe.Sizeof(sizeTest)))\n            }\n        } else {\n            return nil, fmt.Errorf(\"Failed to get Service List even with allocated memory.\")\n        }\n    } else {\n        return nil, fmt.Errorf(\"Unable to get size of required memory allocation.\")\n    }\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 2656351, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2145f303214260c85edc32b3f701dd9d?s=128&d=identicon&r=PG", "display_name": "iamacarpet", "link": "https://stackoverflow.com/users/2656351/iamacarpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 37350591, "answer_count": 1, "score": 0, "last_activity_date": 1463758816, "creation_date": 1463391573, "last_edit_date": 1495535318, "question_id": 37250855, "link": "https://stackoverflow.com/questions/37250855/calling-enumservicesstatusex-in-go-memory-allocation", "title": "Calling EnumServicesStatusEx in Go, memory allocation?", "body": "<p>I'm writing an app that interacts with the Windows API from a Windows Service.</p>\n\n<p>After loads of help from @chowey <a href=\"https://stackoverflow.com/questions/35154074/how-do-i-manage-windows-user-accounts-in-go\">here</a>, I sort of got the hang of things and started a basic library which I've put on GitHub <a href=\"https://github.com/iamacarpet/go-win64api\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I've now moved on to \"Services\", with the requirement to list all Windows Services on a machine, start, stop, restart them. The start/stop/restart look pretty straight forward once you've got a service handle to work with, but I'm struggling with getting a list of installed services.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682640(v=vs.85).aspx\" rel=\"nofollow noreferrer\">EnumServicesStatusEx</a> in Advapi32.dll is the function I need to call, but it requires a pointer to pre-allocated memory for an array of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682648(v=vs.85).aspx\" rel=\"nofollow noreferrer\">ENUM_SERVICE_STATUS_PROCESS</a> structs.</p>\n\n<p>You can call the function with a null pointer and it will return the memory allocation size required, but I don't believe there is a way to directly allocate memory in Go.</p>\n\n<p>At first I thought I could get the memory allocation requirement, divide it by the SizeOf the struct using the unsafe package, create a slice containing that number of elements, then pass a pointer to the first element to the function, but it says the memory needs to include space for the string data, which this wouldn't.</p>\n\n<p>Does anyone know how this could be accomplished, pretty please? :).</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1178, "user_id": 4491478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tZqFG.jpg?s=128&g=1", "display_name": "Lution", "link": "https://stackoverflow.com/users/4491478/lution"}, "edited": false, "score": 1, "creation_date": 1463385619, "post_id": 37249043, "comment_id": 62026542, "body": "Thanks, i understand the LIFO thing about defer,  actually i was having difficulty understand the named return value. now i&#39;m clear!"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 4, "creation_date": 1493391221, "post_id": 37249043, "comment_id": 74412252, "body": "<i>&quot;executer after the function returns&quot;</i> is incorrect. The specs quite clearly state that <i>&quot;deferred functions are invoked immediately before the surrounding function returns&quot;</i>, not after. If defers were invoked after the return, they wouldn&#39;t be able to change the return value in the case of <code>func c</code>. The order of execution should then be: <code>i = 1</code> (assign) <code>i++</code> (defer increment) <code>return</code> return 2"}, {"owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1535538546, "post_id": 37249043, "comment_id": 91100026, "body": "@EliasVanOotegem Fixed! :)"}, {"owner": {"reputation": 187, "user_id": 4123705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1548082999d760c20ee34a83488b77e7?s=128&d=identicon&r=PG&f=1", "display_name": "simplytunde", "link": "https://stackoverflow.com/users/4123705/simplytunde"}, "edited": false, "score": 0, "creation_date": 1555629884, "post_id": 37249043, "comment_id": 98185967, "body": "This is one of the interesting go &quot;gotcha&quot; that flew in my face."}], "tags": [], "owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "is_accepted": true, "score": 38, "last_activity_date": 1535538537, "last_edit_date": 1535538537, "creation_date": 1463384846, "answer_id": 37249043, "question_id": 37248898, "link": "https://stackoverflow.com/questions/37248898/how-does-defer-and-named-return-value-work/37249043#37249043", "title": "How does defer and named return value work?", "body": "<blockquote>\n  <p>A defer statement pushes a function call onto a list. The list of saved calls is executed after the surrounding function returns. -- <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"noreferrer\">The Go Blog: Defer, Panic, and Recover</a></p>\n</blockquote>\n\n<p>Another way to understand the above statement:</p>\n\n<blockquote>\n  <p>A defer statements <em>pushes</em> a function call onto a <strong>stack</strong>. The stack of saved calls <em>popped out (LIFO)</em> and deferred functions are invoked immediately before the surrounding function returns.</p>\n</blockquote>\n\n<pre><code> func c() (i int) {\n    defer func() { i++ }()\n    return 1\n}\n</code></pre>\n\n<p>After 1 is returned, the defer <code>func() { i++ }()</code> gets executed. Hence, in order of executions:</p>\n\n<ol>\n<li>i = 1 (return 1)</li>\n<li>i++ (defer func pop out from stack and executed)</li>\n<li>i == 2 (final result of named variable i)</li>\n</ol>\n\n<hr>\n\n<p>For understanding sake:</p>\n\n<pre><code> func c() (i int) {\n    defer func() { fmt.Println(\"third\") }()\n    defer func() { fmt.Println(\"second\") }()\n    defer func() { fmt.Println(\"first\") }()\n\n    return 1\n}\n</code></pre>\n\n<p>Order of executions:</p>\n\n<ol>\n<li>i = 1 (return 1)</li>\n<li>\"first\"</li>\n<li>\"second\"</li>\n<li>\"third\"</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 7, "last_activity_date": 1463395654, "creation_date": 1463395654, "answer_id": 37252098, "question_id": 37248898, "link": "https://stackoverflow.com/questions/37248898/how-does-defer-and-named-return-value-work/37252098#37252098", "title": "How does defer and named return value work?", "body": "<p>According to the Go Specification:</p>\n\n<p><a href=\"https://golang.org/ref/spec#Return_statements\" rel=\"noreferrer\">Return Statements</a>\nA \"return\" statement that specifies results sets the result parameters before any deferred functions are executed.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"noreferrer\">Defer Statements</a>\n\"...deferred functions are invoked immediately before the surrounding function returns...\"</p>\n\n<p>So yes, as you assumed, the named return variable is assigned, then the deferred statement increments it.</p>\n\n<p>I would add that named return parameters can lead to subtle bugs, and generally should be avoided unless there's no alternative.</p>\n"}, {"comments": [{"owner": {"reputation": 929, "user_id": 1093289, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yIIK1.jpg?s=128&g=1", "display_name": "beyondfloatingpoint", "link": "https://stackoverflow.com/users/1093289/beyondfloatingpoint"}, "edited": false, "score": 0, "creation_date": 1536600691, "post_id": 42831915, "comment_id": 91473340, "body": "I guess what you meant was this: <a href=\"https://play.golang.org/p/5zBeF9hoOCn\" rel=\"nofollow noreferrer\">play.golang.org/p/5zBeF9hoOCn</a>. You have to return j in c() function."}], "tags": [], "owner": {"reputation": 148, "user_id": 5528501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5RdA.jpg?s=128&g=1", "display_name": "Ahmed Ozmaan", "link": "https://stackoverflow.com/users/5528501/ahmed-ozmaan"}, "is_accepted": false, "score": 5, "last_activity_date": 1514864014, "last_edit_date": 1514864014, "creation_date": 1489661364, "answer_id": 42831915, "question_id": 37248898, "link": "https://stackoverflow.com/questions/37248898/how-does-defer-and-named-return-value-work/42831915#42831915", "title": "How does defer and named return value work?", "body": "<p>I think the confusion is about function in function how about if you classified like this:</p>\n\n<pre><code>  func main() {\n      fmt.Println(c()) //the result is 5\n  }\n\n  // the c function returned value is named j\n  func c() (j int)  {\n      defer changei(&amp;j)\n      return 6\n  }\n  func changei(j *int) {\n      //now j is 6 because it was assigned by return statement \n      // and if i change guess what?! i changed the returned value\n      *j--;\n  }\n</code></pre>\n\n<p>but if the return value is not named like this:</p>\n\n<pre><code>  func main() {\n      fmt.Println(c()) //the result will become 6\n  }\n\n  // the c function returned value is not named at this time\n  func c() int  {\n      j := 1\n      defer changei(&amp;j)\n      return 6\n  }\n  func changei(j *int) {\n      //now j = 1\n      // and if i change guess what?! it will not effects the returned value\n      *j--;\n  }\n</code></pre>\n\n<p>I hope this will clear the confusion and that is how i did happy Go coding</p>\n"}], "owner": {"reputation": 1178, "user_id": 4491478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tZqFG.jpg?s=128&g=1", "display_name": "Lution", "link": "https://stackoverflow.com/users/4491478/lution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23153, "favorite_count": 8, "accepted_answer_id": 37249043, "answer_count": 3, "score": 41, "last_activity_date": 1565109416, "creation_date": 1463384194, "last_edit_date": 1592644375, "question_id": 37248898, "link": "https://stackoverflow.com/questions/37248898/how-does-defer-and-named-return-value-work", "title": "How does defer and named return value work?", "body": "<p>I just started learning Go and I got confused with one example about using defer to change named return value in the <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"noreferrer\">The Go Blog - Defer, Panic, and Recover</a>.</p>\n<p>The example says:</p>\n<blockquote>\n<ol start=\"3\">\n<li>Deferred functions may read and assign to the returning function's named return values.</li>\n</ol>\n<p>In this example, a deferred function increments the return value i after the surrounding function returns. Thus, this function <strong>returns 2</strong>:</p>\n</blockquote>\n<pre><code>func c() (i int) {\n    defer func() { i++ }()\n    return 1\n}\n</code></pre>\n<p>But as what I have learned from  <a href=\"https://tour.golang.org/basics/7\" rel=\"noreferrer\">A Tour of Go - Named return values</a></p>\n<blockquote>\n<p><strong>A return statement without arguments</strong> returns the named return values. This is known as a &quot;naked&quot; return.</p>\n</blockquote>\n<p>I tested in the following code and in function <code>b</code> it returns 1 because it wasn't the &quot;<em>A return statement without arguments</em>&quot; case mentioned above.</p>\n<pre><code>func a() (i int) { // return 2\n    i = 2\n    return\n}\n\nfunc b() (i int) {  // return 1 \n    i = 2\n    return 1\n}\n</code></pre>\n<p>So my question is in the first example, the surrounding function c has a named return value i, but the function <code>c</code> uses <code>return 1</code> which in the second example we can see it should have return 1 no matter what value <code>i</code> is. But why after <code>i</code> changes in the deferred function the <code>c</code> function returns the value of <code>i</code> instead the value 1?</p>\n<p>As I was typing my question, I might have guessed the answer. Is it because:</p>\n<pre><code>return 1 \n</code></pre>\n<p>is equals to:</p>\n<pre><code>i = 1\nreturn \n</code></pre>\n<p>in a function with a named return value variable <code>i</code>?</p>\n<p>Please help me confirm, thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1463372066, "post_id": 37246473, "comment_id": 62021703, "body": "Your intention isn&#39;t clear. What are you trying to do?"}], "answers": [{"comments": [{"owner": {"reputation": 22034, "user_id": 21699, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1c27bc77c7d5d9506958e3f9164341b7?s=128&d=identicon&r=PG", "display_name": "Tigraine", "link": "https://stackoverflow.com/users/21699/tigraine"}, "edited": false, "score": 6, "creation_date": 1498032872, "post_id": 37246712, "comment_id": 76325225, "body": "Cool. Apparently this only works if both structs have exactly the same structure.."}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1568306014, "post_id": 37246712, "comment_id": 102241611, "body": "..but it doesn&#39;t work to make a copy to the same structure type"}, {"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1568311122, "post_id": 37246712, "comment_id": 102243692, "body": "@CeriseLim&#243;n to copy a struct to another instance, the conversion doesn&#39;t actually do anything, while just assigning the value does it correctly."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1574471481, "post_id": 37246712, "comment_id": 104257411, "body": "@JohnWhite The question asks about different types, and that&#39;s what I answer here.  A conversion is not required when there&#39;s no change in type.  The code in the answer does work when the types are the same.  Conversion to the same type does yield a new value of the type. That&#39;s not useful, but it does do something."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 57, "last_activity_date": 1574471537, "last_edit_date": 1574471537, "creation_date": 1463372879, "answer_id": 37246712, "question_id": 37246473, "link": "https://stackoverflow.com/questions/37246473/copy-one-struct-to-another-where-structs-have-same-members-and-different-types/37246712#37246712", "title": "Copy one struct to another where structs have same members and different types", "body": "<p>Use a <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">conversion</a> to change the type. The following code uses a conversion to copy a value of type <code>Foo</code> to a value of type <code>Bar</code>:</p>\n\n<pre><code>foo := Foo{Id: \"123\", Name: \"Joe\"}\nbar := Bar(foo)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/zhhXOTbk1b\" rel=\"noreferrer\">playground example</a></p>\n\n<p>The <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">conversion</a> only works when the underlying types are identical except for struct tags.</p>\n"}, {"tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": false, "score": 6, "last_activity_date": 1548481354, "last_edit_date": 1548481354, "creation_date": 1548480694, "answer_id": 54375919, "question_id": 37246473, "link": "https://stackoverflow.com/questions/37246473/copy-one-struct-to-another-where-structs-have-same-members-and-different-types/54375919#54375919", "title": "Copy one struct to another where structs have same members and different types", "body": "<p>If you would like to copy or clone to a different struct, I would suggest using <a href=\"https://github.com/ulule/deepcopier\" rel=\"noreferrer\">deepcopier</a> </p>\n\n<p>It provides nice features like skipping, custom mapping, and forcing. below is an example from github:</p>\n\n<p>Install: </p>\n\n<pre><code>go get -u github.com/ulule/deepcopier\n</code></pre>\n\n<p>Example: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/ulule/deepcopier\"\n)\n\n// Model\ntype User struct {\n    // Basic string field\n    Name  string\n    // Deepcopier supports https://golang.org/pkg/database/sql/driver/#Valuer\n    Email sql.NullString\n}\n\nfunc (u *User) MethodThatTakesContext(ctx map[string]interface{}) string {\n    // do whatever you want\n    return \"hello from this method\"\n}\n\n// Resource\ntype UserResource struct {\n    //copy from field \"Name\"\n    DisplayName            string `deepcopier:\"field:Name\"`\n    //this will be skipped in copy \n    SkipMe                 string `deepcopier:\"skip\"`\n    //this should call method named MethodThatTakesContext \n    MethodThatTakesContext string `deepcopier:\"context\"`\n    Email                  string `deepcopier:\"force\"`\n\n}\n\nfunc main() {\n    user := &amp;User{\n        Name: \"gilles\",\n        Email: sql.NullString{\n            Valid: true,\n            String: \"gilles@example.com\",\n        },\n    }\n\n    resource := &amp;UserResource{}\n\n    deepcopier.Copy(user).To(resource)\n    //copied from User's Name field\n    fmt.Println(resource.DisplayName)//output: gilles\n    fmt.Println(resource.Email) //output: gilles@example.com\n    fmt.Println(resource.MethodThatTakesContext) //output: hello from this method\n}\n</code></pre>\n\n<p>Also, some other way you could achieve this is by encoding the source object to JSON and then decode it back to the destination object. </p>\n"}, {"tags": [], "owner": {"reputation": 6899, "user_id": 2023728, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3NzN5.jpg?s=128&g=1", "display_name": "mel3kings", "link": "https://stackoverflow.com/users/2023728/mel3kings"}, "is_accepted": false, "score": 6, "last_activity_date": 1563244290, "creation_date": 1563244290, "answer_id": 57049330, "question_id": 37246473, "link": "https://stackoverflow.com/questions/37246473/copy-one-struct-to-another-where-structs-have-same-members-and-different-types/57049330#57049330", "title": "Copy one struct to another where structs have same members and different types", "body": "<p><a href=\"https://github.com/jinzhu/copier\" rel=\"noreferrer\">https://github.com/jinzhu/copier</a> (same author of gorm) is also quite a good one, I have nested structs and all I do is:</p>\n\n<p><code>copier.Copy(&amp;employees, &amp;user)</code></p>\n\n<p>works great</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1868068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b5a7f495035db81e4864c0b4655fc7?s=128&d=identicon&r=PG", "display_name": "pilathraj", "link": "https://stackoverflow.com/users/1868068/pilathraj"}, "is_accepted": false, "score": 1, "last_activity_date": 1569399032, "creation_date": 1569399032, "answer_id": 58093980, "question_id": 37246473, "link": "https://stackoverflow.com/questions/37246473/copy-one-struct-to-another-where-structs-have-same-members-and-different-types/58093980#58093980", "title": "Copy one struct to another where structs have same members and different types", "body": "<p>If you would like to copy or clone to a different struct, I would suggest using deepcopier</p>\n\n<p>It provides nice features like skipping, custom mapping, and forcing. </p>\n\n<p>You can achieve nested struct copy following way.\nInstall: </p>\n\n<pre><code>go get -u github.com/ulule/deepcopier\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code> package main\n\n    import (\n        \"fmt\"\n        \"strconv\"\n\n        \"github.com/ulule/deepcopier\"\n    )\n\n    //FieldStruct -  Field Struct\n    type FieldStruct struct {\n        Name string `deepcopier:\"field:TargetName\"`\n        Type string `deepcopier:\"field:TargetType\"`\n    }\n\n    //SourceStruct - Source Struct\n    type SourceStruct struct {\n        Name        string   `deepcopier:\"field:TargetName\"`\n        Age         int      `deepcopier:\"field:TargetAge\"`\n        StringArray []string `deepcopier:\"field:TargetStringArray\"`\n        StringToInt string   `deepcopier:\"context\"`\n        Field       FieldStruct\n        Fields      []FieldStruct\n    }\n\n    //TargetFieldStruct -  Field Struct\n    type TargetFieldStruct struct {\n        TargetName string\n        TargetType string\n    }\n\n    //TargetStruct - Target Struct\n    type TargetStruct struct {\n        TargetName        string\n        TargetAge         int\n        TargetStringArray []string\n        TargetInt         int\n        TargetField       TargetFieldStruct\n        TargetFields      []TargetFieldStruct\n    }\n\n    //write methods\n\n    //TargetInt - StringToInt\n    func (s *SourceStruct) TargetInt() int {\n        i, _ := strconv.Atoi(s.StringToInt)\n        return i\n    }\n\n    func main() {\n        s := &amp;SourceStruct{\n            Name:        \"Name\",\n            Age:         12,\n            StringArray: []string{\"1\", \"2\"},\n            StringToInt: \"123\",\n            Field: FieldStruct{\n                Name: \"Field\",\n                Type: \"String\",\n            },\n            Fields: []FieldStruct{\n                FieldStruct{\n                    Name: \"Field1\",\n                    Type: \"String1\",\n                },\n                FieldStruct{\n                    Name: \"Field2\",\n                    Type: \"String2\",\n                },\n            },\n        }\n\n        t := &amp;TargetStruct{}\n\n        //coping data into inner struct\n        deepcopier.Copy(&amp;t.TargetField).From(&amp;s.Field)\n\n        // copied array of Struct\n        for i := range s.Fields {\n            // init a struct\n            t.TargetFields = append(t.TargetFields, TargetFieldStruct{})\n            // coping the data\n            deepcopier.Copy(&amp;t.TargetFields[i]).From(&amp;s.Fields[i])\n        }\n        //Top level copy\n        deepcopier.Copy(t).From(s)\n\n        fmt.Println(t)\n    }\n</code></pre>\n\n<p>Output: \n&amp;{Name 12 [1 2] 123 {Field String} [{Field1 String1} {Field2 String2}]}</p>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 8626433, "user_type": "registered", "profile_image": "https://graph.facebook.com/1276251982503903/picture?type=large", "display_name": "Damitha Dayananda", "link": "https://stackoverflow.com/users/8626433/damitha-dayananda"}, "is_accepted": false, "score": 2, "last_activity_date": 1579065615, "creation_date": 1579065615, "answer_id": 59745518, "question_id": 37246473, "link": "https://stackoverflow.com/questions/37246473/copy-one-struct-to-another-where-structs-have-same-members-and-different-types/59745518#59745518", "title": "Copy one struct to another where structs have same members and different types", "body": "<p>This is another possible answer</p>\n\n<p>type Common struct {\n        Gender int\n        From   string\n        To     string\n    }</p>\n\n<pre><code>type Foo struct {\n    Id    string\n    Name  string\n    Extra Common\n}\n\ntype Bar struct {\n    Id    string\n    Name  string\n    Extra Common\n}\nfoo:=Foo{\n    Id:\"123\",\n    Name:\"damitha\",\n    Extra: struct {\n        Gender int\n        From   string\n        To     string\n    }{Gender:1 , From:\"xx\", To:\"yy\" },\n}\nbar:=*(*Bar)(unsafe.Pointer(&amp;foo))\nfmt.Printf(\"%+v\\n\",bar)\n</code></pre>\n"}], "owner": {"reputation": 2257, "user_id": 2298986, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bf5dcb5d0244dfc6ac3f8c34094c8fd6?s=128&d=identicon&r=PG", "display_name": "jsvisa", "link": "https://stackoverflow.com/users/2298986/jsvisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40256, "favorite_count": 5, "accepted_answer_id": 37246712, "answer_count": 5, "score": 34, "last_activity_date": 1579065615, "creation_date": 1463370907, "last_edit_date": 1568313294, "question_id": 37246473, "link": "https://stackoverflow.com/questions/37246473/copy-one-struct-to-another-where-structs-have-same-members-and-different-types", "title": "Copy one struct to another where structs have same members and different types", "body": "<p>I have two <code>struct</code> having the same members, I want to copy one struct to another, see the pseudo code below:</p>\n\n<pre><code>type Common struct {\n    Gender int\n    From   string\n    To     string\n}\n\ntype Foo struct {\n    Id    string\n    Name  string\n    Extra Common\n}\n\ntype Bar struct {\n    Id    string\n    Name  string\n    Extra Common\n}\n</code></pre>\n\n<p>Then I have <code>foo</code> of struct <code>Foo</code>, and <code>bar</code> of struct <code>Bar</code>, Is there any way to copy <code>bar</code> from <code>foo</code>?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1463367280, "post_id": 37246046, "comment_id": 62020723, "body": "please not ignore error return of <code>Find</code>."}, {"owner": {"reputation": 55, "user_id": 1092310, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/b567daed602cd5093c8d3a9a50105a41?s=128&d=identicon&r=PG", "display_name": "Alexandre Ferreira", "link": "https://stackoverflow.com/users/1092310/alexandre-ferreira"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1463367633, "post_id": 37246046, "comment_id": 62020789, "body": "@JiangYD thanks! I correct these line of code, but, no error has returned!"}, {"owner": {"reputation": 176, "user_id": 6243470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/335981a22c1733a215e5d47f9efd8ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Ami", "link": "https://stackoverflow.com/users/6243470/ami"}, "edited": false, "score": 0, "creation_date": 1495705609, "post_id": 37246046, "comment_id": 75369081, "body": "Try checking mgo logs using these mgo.SetDebug(true) \tmgo.SetLogger(log.New(os.Stdout,&quot;err&quot;,6))"}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 1092310, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/b567daed602cd5093c8d3a9a50105a41?s=128&d=identicon&r=PG", "display_name": "Alexandre Ferreira", "link": "https://stackoverflow.com/users/1092310/alexandre-ferreira"}, "is_accepted": false, "score": 0, "last_activity_date": 1463368393, "last_edit_date": 1463368393, "creation_date": 1463367949, "answer_id": 37246142, "question_id": 37246046, "link": "https://stackoverflow.com/questions/37246046/cant-retrieve-data-from-mongodb-using-mgo/37246142#37246142", "title": "Can&#39;t retrieve data from mongodb using mgo", "body": "<p>Well, it is really weird, but when I rewrite the code, verifying the error from the find method, it works. I just did this:</p>\n\n<pre><code>    var videos []Video\n    err := collVideos.Find(bson.M{\"siteid.name\": profile.Name}).All(&amp;videos)\n    CheckError(err)\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 1092310, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/b567daed602cd5093c8d3a9a50105a41?s=128&d=identicon&r=PG", "display_name": "Alexandre Ferreira", "link": "https://stackoverflow.com/users/1092310/alexandre-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463368393, "creation_date": 1463367146, "question_id": 37246046, "link": "https://stackoverflow.com/questions/37246046/cant-retrieve-data-from-mongodb-using-mgo", "title": "Can&#39;t retrieve data from mongodb using mgo", "body": "<p>I'm really sorry about this topic. I see many others, but anything could help me to solve my problem.</p>\n\n<p>So, I'm using Go + mgo in my backend and the structure that I have to search for is:</p>\n\n<pre><code>type Video struct {\n    ID           bson.ObjectId `bson:\"_id,omitempty\"`\n    Title        string        `bson:\"title\"`\n    Duration     string        `bson:\"duration\"`\n    Url          string        `bson:\"url\"`\n    DefaultThumb string        `bson:\"defaultthumb\"`\n    SiteID       SiteProfile   `bson:\"siteid\"`\n}\n</code></pre>\n\n<p>The table \"videos\" has 2kk+ of information and first, I have to select these videos from his site profile that has stored in this structure:</p>\n\n<pre><code>type SiteProfile struct {\n    ID         bson.ObjectId `bson:\"_id,omitempty\"`\n    Name       string        `bson:\"name\"`\n    Site       string        `bson:\"site\"`\n    ExportUrl  string        `bson:\"exportUrl\"`\n    ExportType string        `bson:\"exportType\"`\n}\n</code></pre>\n\n<p>Then, I'm doing this command to fetch the requests that have same profile, inside a loop of profiles:</p>\n\n<pre><code>    var videos []Video\n    collVideos.Find(bson.M{\"siteid.name\": profile.Name}).All(&amp;videos)\n</code></pre>\n\n<p>In the log messages, I'm getting an empty array and doing the same thing using Robomongo, that is node based, I have these rows listed by they site profile normally. So, does anybody know how can I retrieve these data, searching for the nested object?</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["algorithm", "data-structures", "go", "tree", "radix-tree"], "answers": [{"comments": [{"owner": {"reputation": 1007, "user_id": 5727424, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Djr2s.jpg?s=128&g=1", "display_name": "David Lavieri", "link": "https://stackoverflow.com/users/5727424/david-lavieri"}, "edited": false, "score": 0, "creation_date": 1463392909, "post_id": 37247863, "comment_id": 62030179, "body": "There are not many items in return, it only return <code>(node, error)</code>, if match <code>(node, nil)</code> otherwise <code>(nil,error)</code>. In order to use like a httprouter, I will make an  AutoComplete func or other look ups func"}, {"owner": {"reputation": 1548, "user_id": 980270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/da2801be4550a5a50de5c0ced2592093?s=128&d=identicon&r=PG", "display_name": "TilmannZ", "link": "https://stackoverflow.com/users/980270/tilmannz"}, "edited": false, "score": 0, "creation_date": 1463400767, "post_id": 37247863, "comment_id": 62034763, "body": "I never used golang, but at least in C++/Java, the random generator can be &#39;seeded&#39; with a constant (&#39;0&#39; in the code above?), which makes the test repeatable."}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 0, "last_activity_date": 1463379788, "creation_date": 1463379788, "answer_id": 37247863, "question_id": 37245579, "link": "https://stackoverflow.com/questions/37245579/golang-benchmark-radix-tree-lookup/37247863#37247863", "title": "Golang: benchmark Radix Tree Lookup", "body": "<p>If your benchmark is random, that would make it very difficult to compare the performance between different implementations from one run to the next.</p>\n\n<p>Instead, statically implement a few different benchmark cases that stress different areas of your algorithm. The cases should represent different scenarios, such as the case when there are no matches (as you already have), the case where there are many items in the source data that will be returned in a lookup, the case where there are many items and only 1 item will be returned, etc etc.</p>\n"}], "owner": {"reputation": 1007, "user_id": 5727424, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Djr2s.jpg?s=128&g=1", "display_name": "David Lavieri", "link": "https://stackoverflow.com/users/5727424/david-lavieri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "accepted_answer_id": 37247863, "answer_count": 1, "score": 0, "last_activity_date": 1463379788, "creation_date": 1463363025, "question_id": 37245579, "link": "https://stackoverflow.com/questions/37245579/golang-benchmark-radix-tree-lookup", "title": "Golang: benchmark Radix Tree Lookup", "body": "<p>I've been trying to benchmark a Radix Tree implementation I wrote for sake of practice with Golang.</p>\n\n<p>But I encountered a problem on \"How should I benchmark it?\". In the code below shows two cases or lets say different ways I would like to benchmark the LookUp func.</p>\n\n<ul>\n<li><p>Case 1: Use one single slice of bytes which exist on the tree meaning it will be successful LookUp through all children nodes etc...</p></li>\n<li><p>Case 2: Use a func to generate that random slice from the existing data in the tree meaning it will be successful LookUp as well...</p></li>\n</ul>\n\n<p>I know the time expend will depend on the tree depth... I think Case 2 is close to a real world implementation or not?</p>\n\n<p>QUESTION: Which case is more efficient or useful to benchmark?</p>\n\n<p>Benchmark:</p>\n\n<pre><code>func BenchmarkLookUp(b *testing.B) {\n    radix := New()\n    insertData(radix, sampleData2)\n\n    textToLookUp := randomBytes()\n\n    for i := 0; i &lt; b.N; i++ {\n        radix.LookUp(textToLookUp) // Case 1 \n        //radix.LookUp(randomBytes()) // Case 2\n    }\n}\n\nfunc randomBytes() []byte {\n    strings := sampleData2()\n    return []byte(strings[random(0, len(strings))])\n}\n\nfunc sampleData2() []string {\n    return []string{\n        \"romane\",\n        \"romanus\",\n        \"romulus\",\n        ...\n    }\n}\n</code></pre>\n\n<p>Result Case 1:</p>\n\n<pre><code>PASS\nBenchmarkLookUp-4       10000000               146 ns/op\nok      github.com/falmar/goradix       2.068s\nPASS\nBenchmarkLookUp-4       10000000               149 ns/op\nok      github.com/falmar/goradix       2.244s\n</code></pre>\n\n<p>Result Case 2:</p>\n\n<pre><code>PASS\nBenchmarkLookUp-4        3000000               546 ns/op\nok      github.com/falmar/goradix       3.094s\nPASS\nBenchmarkLookUp-4        3000000               538 ns/op\nok      github.com/falmar/goradix       4.481s\n</code></pre>\n\n<p>Results when there is no match:</p>\n\n<pre><code>PASS\nBenchmarkLookUp-4       10000000               194 ns/op\nok      github.com/falmar/goradix       3.189s\nPASS\nBenchmarkLookUp-4       10000000               191 ns/op\nok      github.com/falmar/goradix       3.243s\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "edited": false, "score": 0, "creation_date": 1463337570, "post_id": 37242201, "comment_id": 62013298, "body": "Where is that coordinates string coming from? How are you printing it out?"}, {"owner": {"reputation": 103, "user_id": 4916032, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/dwcxF.jpg?s=128&g=1", "display_name": "shantibiotic", "link": "https://stackoverflow.com/users/4916032/shantibiotic"}, "reply_to_user": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "edited": false, "score": 0, "creation_date": 1463337796, "post_id": 37242201, "comment_id": 62013388, "body": "@ctcherry i updated the post."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1463358515, "post_id": 37242201, "comment_id": 62019115, "body": "If you want to read up on it head over to <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">golang.org/pkg/fmt</a> and search for &quot;Format errors&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 6136463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oEkuU.jpg?s=128&g=1", "display_name": "Strainger", "link": "https://stackoverflow.com/users/6136463/strainger"}, "is_accepted": true, "score": 9, "last_activity_date": 1463337922, "creation_date": 1463337922, "answer_id": 37242287, "question_id": 37242201, "link": "https://stackoverflow.com/questions/37242201/what-is-s-in-the-output-of-a-float/37242287#37242287", "title": "What is &quot;%!s&quot; in the output of a float?", "body": "<p><a href=\"https://golang.org/pkg/fmt/\">https://golang.org/pkg/fmt/</a></p>\n\n<p><strong>%!s</strong> is basically used in errors to help you identify a problem.</p>\n"}, {"tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": false, "score": 8, "last_activity_date": 1463338219, "creation_date": 1463338219, "answer_id": 37242350, "question_id": 37242201, "link": "https://stackoverflow.com/questions/37242201/what-is-s-in-the-output-of-a-float/37242350#37242350", "title": "What is &quot;%!s&quot; in the output of a float?", "body": "<p>I think this is a matter of using an incorrect format \"verb.\" You need to use <code>%f</code> instead of <code>%s</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var f float64 = 3.14\n    fmt.Printf(\"attempting to print as string: %s \\n\", f)\n    fmt.Printf(\"attempting to print as float: %f\", f)\n}\n</code></pre>\n\n<p>Runnable: <a href=\"https://play.golang.org/p/Pec_QrxBIl\">https://play.golang.org/p/Pec_QrxBIl</a></p>\n"}], "owner": {"reputation": 103, "user_id": 4916032, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/dwcxF.jpg?s=128&g=1", "display_name": "shantibiotic", "link": "https://stackoverflow.com/users/4916032/shantibiotic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1955, "favorite_count": 0, "accepted_answer_id": 37242287, "answer_count": 2, "score": 1, "last_activity_date": 1521791995, "creation_date": 1463337441, "last_edit_date": 1521791995, "question_id": 37242201, "link": "https://stackoverflow.com/questions/37242201/what-is-s-in-the-output-of-a-float", "title": "What is &quot;%!s&quot; in the output of a float?", "body": "<p>I'm getting coordinates (location) as an output of 2 float64 numbers, and it looks like this:</p>\n\n<pre><code>&amp;{%!s(float64=42.539679) %!s(float64=42.601339)}\n</code></pre>\n\n<p>This is the first time I'm seeing anything like that, so what is \"%!s\"? \n\"TypeOf\" says \"%!s(float64=42.539679)\" is float64. So how do I work with this kind of floats? Is there any way to parse it, or somehow to make the %!s(float64=42.539679) look like 42.539679?</p>\n\n<p>UPD: the highlighted line is a *tgbotapi.Location object from Syfaro's telegram bot api.\nThe api has this structure:</p>\n\n<pre><code>type Location struct {\n    Longitude float64 `json:\"longitude\"`\n    Latitude  float64 `json:\"latitude\"`\n}\n</code></pre>\n\n<p>and the Location.Latitude gives me this: \"%!s(float64=42.539679)\" (float64)(?)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 680, "user_id": 3677188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17944f3cb838dc1b4430a584a904d17?s=128&d=identicon&r=PG&f=1", "display_name": "tobiash", "link": "https://stackoverflow.com/users/3677188/tobiash"}, "edited": false, "score": 2, "creation_date": 1463337478, "post_id": 37242009, "comment_id": 62013277, "body": "Embedding a Mutex pointer instead (<code>*sync.Mutex</code>) ?"}, {"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "reply_to_user": {"reputation": 680, "user_id": 3677188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17944f3cb838dc1b4430a584a904d17?s=128&d=identicon&r=PG&f=1", "display_name": "tobiash", "link": "https://stackoverflow.com/users/3677188/tobiash"}, "edited": false, "score": 2, "creation_date": 1463337621, "post_id": 37242009, "comment_id": 62013317, "body": "Yes, but if you look at examples by Andrew Gerrand: <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">blog.golang.org/go-maps-in-action</a>, he did not embedded by pointer."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 12, "creation_date": 1463339083, "post_id": 37242475, "comment_id": 62013836, "body": "One would normally return a <code>*Groups</code> instead of embedding a ponter."}, {"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1463339250, "post_id": 37242475, "comment_id": 62013908, "body": "Yep, this better solution"}, {"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463339853, "post_id": 37242475, "comment_id": 62014126, "body": "@JimB good point. Updated answer to include warning/alternative."}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 17, "last_activity_date": 1463339819, "last_edit_date": 1463339819, "creation_date": 1463338914, "answer_id": 37242475, "question_id": 37242009, "link": "https://stackoverflow.com/questions/37242009/function-returns-lock-by-value/37242475#37242475", "title": "Function returns lock by value", "body": "<p>You need to embed the sync.Mutex as a pointer:</p>\n\n<pre><code>type Groups struct {\n    *sync.Mutex\n    Names []strng\n}\n</code></pre>\n\n<p>Addressing your comment on your question: In the article <a href=\"http://blog.golang.org/go-maps-in-action\" rel=\"noreferrer\">http://blog.golang.org/go-maps-in-action</a> notice Gerrand is not returning the struct from a function but is using it right away, that is why he isn't using a pointer. In your case you are returning it, so you need a pointer so as not to make a copy of the Mutex.</p>\n\n<p>Update: As @JimB points out, it may not be prudent to embed a pointer to <code>sync.Mutex</code>, it might be better to return a pointer to the outer struct and continue to embed the <code>sync.Mutex</code> as a value. Consider what you are trying to accomplish in your specific case.</p>\n"}], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7091, "favorite_count": 2, "accepted_answer_id": 37242475, "answer_count": 1, "score": 9, "last_activity_date": 1537181004, "creation_date": 1463336364, "last_edit_date": 1537181004, "question_id": 37242009, "link": "https://stackoverflow.com/questions/37242009/function-returns-lock-by-value", "title": "Function returns lock by value", "body": "<p>I have the following structure</p>\n\n<pre><code>type Groups struct {\n    sync.Mutex\n    Names []strng\n}\n</code></pre>\n\n<p>and following function</p>\n\n<pre><code>func NewGroups(names ...string) (Groups, error) {\n    // ...\n    return groups, nil\n}\n</code></pre>\n\n<p>When I check for semantic errors with <code>go vet</code>, I am getting this warning:</p>\n\n<pre><code>NewGroups returns Lock by value: Groups\n</code></pre>\n\n<p>As <code>go vet</code> is shouting, it is not good and what problems this code can bring ?\nHow can I fix this ?</p>\n"}, {"tags": ["css", "go", "hugo"], "answers": [{"tags": [], "owner": {"reputation": 4253, "user_id": 972240, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4CIP1.png?s=128&g=1", "display_name": "gevorg", "link": "https://stackoverflow.com/users/972240/gevorg"}, "is_accepted": true, "score": 3, "last_activity_date": 1463332112, "last_edit_date": 1463332112, "creation_date": 1463331254, "answer_id": 37241072, "question_id": 37241028, "link": "https://stackoverflow.com/questions/37241028/hugo-table-of-contents-have-extra-dot-in-front/37241072#37241072", "title": "Hugo Table of Contents have extra dot in front", "body": "<p>Use following css:</p>\n\n<pre><code>#toc ul { \n  list-style-type: none; \n}\n\n#toc ul ul { \n  list-style-type: disc; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 644, "user_id": 813599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f8cb61c7e9679fa6a0269680d90ed07?s=128&d=identicon&r=PG", "display_name": "Beej", "link": "https://stackoverflow.com/users/813599/beej"}, "is_accepted": false, "score": 2, "last_activity_date": 1529375324, "creation_date": 1529375324, "answer_id": 50919835, "question_id": 37241028, "link": "https://stackoverflow.com/questions/37241028/hugo-table-of-contents-have-extra-dot-in-front/50919835#50919835", "title": "Hugo Table of Contents have extra dot in front", "body": "<p>this worked well for my needs</p>\n\n<pre><code>{{ .TableOfContents | replaceRE \"&lt;ul&gt;[[:space:]]*&lt;li&gt;[[:space:]]*&lt;ul&gt;\" \"&lt;ul&gt;\" | replaceRE \"&lt;/ul&gt;[[:space:]]*&lt;/li&gt;[[:space:]]*&lt;/ul&gt;\" \"&lt;/ul&gt;\" |  safeHTML }}\n</code></pre>\n\n<p>along with this css</p>\n\n<pre><code>nav &gt; ul &gt; li {\n  list-style: none;\n}\n</code></pre>\n"}], "owner": {"reputation": 5932, "user_id": 3541205, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6d36383f353f79d903e2e0946b73e8f7?s=128&d=identicon&r=PG", "display_name": "aks", "link": "https://stackoverflow.com/users/3541205/aks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 37241072, "answer_count": 2, "score": 4, "last_activity_date": 1529375324, "creation_date": 1463330999, "question_id": 37241028, "link": "https://stackoverflow.com/questions/37241028/hugo-table-of-contents-have-extra-dot-in-front", "title": "Hugo Table of Contents have extra dot in front", "body": "<p>I am using Hugo static site generator to create a website. I am using this code snippet, as given in docs to create TOC:</p>\n\n<pre><code>&lt;div id=\"toc\" class=\"well col-md-4 col-sm-6\"&gt;\n    {{ .TableOfContents }}\n&lt;/div&gt;\n</code></pre>\n\n<p>This is the generated code:</p>\n\n<pre><code>&lt;div id=\"toc\" class=\"well col-md-4 col-sm-6\"&gt;\n   &lt;nav id=\"TableOfContents\"&gt;\n   &lt;ul&gt;\n      &lt;li&gt;\n         &lt;ul&gt;\n            &lt;li&gt;&lt;a href=\"#step-1-install-hugo:c57cc0038c788519b441e0331c8bebc7\"&gt;Step 1. Install Hugo&lt;/a&gt;&lt;/li&gt;\n            &lt;li&gt;&lt;a href=\"#step-2-build-the-docs:c57cc0038c788519b441e0331c8bebc7\"&gt;Step 2. Build the Docs&lt;/a&gt;&lt;/li&gt;\n            &lt;li&gt;&lt;a href=\"#step-3-change-the-docs-site:c57cc0038c788519b441e0331c8bebc7\"&gt;Step 3. Change the docs site&lt;/a&gt;&lt;/li&gt;\n            &lt;li&gt;&lt;a href=\"#step-4-have-fun:c57cc0038c788519b441e0331c8bebc7\"&gt;Step 4. Have fun&lt;/a&gt;&lt;/li&gt;\n         &lt;/ul&gt;\n      &lt;/li&gt;\n   &lt;/ul&gt;\n   &lt;/nav&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Due to this I am getting a extra bullet. can anyone solve this? or can you suggest CSS to remove bullets just from the first <code>ul</code>.</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1463328787, "post_id": 37240385, "comment_id": 62010215, "body": "grpc streams are streams of Protocol Buffer messages, not raw bytes (as what <code>myOwnService</code> expects). In order for this to work, you need to define how HighRequest gets converted to a byte slice and how a byte slice gets converted to HighReply."}], "answers": [{"comments": [{"owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "edited": false, "score": 0, "creation_date": 1463377659, "post_id": 37245169, "comment_id": 62023290, "body": "Thanks a lot. I&#39;ve understand how you deal with input. But how to redirect output to the stream since it is a bio-direction rpc service."}, {"owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "reply_to_user": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "edited": false, "score": 0, "creation_date": 1463400838, "post_id": 37245169, "comment_id": 62034802, "body": "I was thinking about what you might be trying to do last night, and I realized that maybe you&#39;d want to concatenate all of the input fragments received in your message stream and present them together as the input stream to your <code>myOwnService</code> function. That&#39;s possible, though more complicated than what I showed above."}, {"owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "reply_to_user": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "edited": false, "score": 0, "creation_date": 1463401179, "post_id": 37245169, "comment_id": 62034983, "body": "For output, you could supply a custom <code>io.Writer</code> to <code>myOwnService</code> that buffers some number of bytes, then writes them out in a <code>HighReply</code> message. You would send as many <code>HighReply</code> messages as necessary until there was no more buffered data that <code>myOwnService</code> had written. Again, this is fiddly, but certainly possible. Coaxing out how to transform a message stream to an <code>io.Reader</code> or an <code>io.Writer</code> to a message stream warrant separate questions here."}, {"owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "edited": false, "score": 0, "creation_date": 1463457814, "post_id": 37245169, "comment_id": 62060290, "body": "Now I used a pipe to capture output: <code>r, w, _ := os.Pipe(); myService(in, w)</code>, seems work"}], "tags": [], "owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "is_accepted": false, "score": 1, "last_activity_date": 1463363937, "last_edit_date": 1463363937, "creation_date": 1463358894, "answer_id": 37245169, "question_id": 37240385, "link": "https://stackoverflow.com/questions/37240385/how-do-i-make-a-go-grpc-work-with-standard-io-on-the-server-side/37245169#37245169", "title": "How do I make a Go gRPC work with standard IO on the server side?", "body": "<p>Per <a href=\"http://www.grpc.io/docs/tutorials/basic/go.html#bidirectional-streaming-rpc\" rel=\"nofollow\">the gRPC Basics tutorial section on Bidirectional streaming RPC</a>, each call to your <code>stream</code> parameter's <code>Recv</code> method will give you a decoded <code>HighRequest</code> message, <em>not</em> a byte stream, as you're expecting for your <code>myOwnService</code> function.</p>\n\n<p>Now, if your <code>HighRequest</code> message contains a field of types <code>bytes</code> or <code>string</code>, you may wish to feed that field's content into <code>myOwnService</code> as the <code>stdin</code> parameter by wrapping the raw <code>[]byte</code> value via <a href=\"https://golang.org/pkg/bytes/#NewReader\" rel=\"nofollow\"><code>bytes.NewReader</code></a>.</p>\n\n<p>I see, though, that <code>myOwnService</code> demands an <code>io.ReadCloser</code>. I don't know why you'd expect <code>myOwnService</code> to close its input parameter, but I'll trust you well enough that you need it to then recommend using <a href=\"https://golang.org/pkg/io/ioutil/#NopCloser\" rel=\"nofollow\"><code>ioutil.NopCloser</code></a> to satisfy that demand trivially.</p>\n\n<p>Sketching:</p>\n\n<pre><code>// Next tag: 2\nmessage HighRequest {\n  bytes content = 1;\n}\n\nfunc (s *server) HighFive(stream pb.Greeter_HighFiveServer) error {\n  for req, err := stream.Recv(); {\n    if err != nil {\n      if err == io.EOF {\n        return nil\n      }\n      return err\n    }\n    in := ioutil.NopCloser(bytes.NewReader(req.Content))\n    out := /* ... */\n    if err := myOwnService(in, out); err != nil {\n      return err\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3202, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463386382, "creation_date": 1463327481, "last_edit_date": 1463386382, "question_id": 37240385, "link": "https://stackoverflow.com/questions/37240385/how-do-i-make-a-go-grpc-work-with-standard-io-on-the-server-side", "title": "How do I make a Go gRPC work with standard IO on the server side?", "body": "<p>I am a freshman of gRPC, and here is my problem. I'm trying to write a service to expose <code>myOwnService</code> into a gRPC service per the following service method:</p>\n\n<pre><code>rpc HighFive (stream HighRequest) returns (stream HighReply) {}\n</code></pre>\n\n<p>The server-side code is as follows:</p>\n\n<pre><code>func (s *server) HighFive(stream pb.Greeter_HighFiveServer) error {    \n    // Oops, don't know how to do here ...\n    myOwnService(stdin io.ReadCloser, stdout io.WriteCloser)\n    return nil\n}\n\nfunc myOwnService(stdin io.ReadCloser, stdout io.WriteCloser) error {    \n    // read input from stdin, do something, the  write result to stdout\n    ...\n    return nil\n}\n</code></pre>\n\n<p>As you can see above, I have no idea how to make <code>stream</code> work with <code>io.Reader</code> and <code>io.Writer</code> in my original service, so that the caller of the <code>HighFive</code> gRPC service can read and write data just like calling <code>myOwnService</code> normally.</p>\n\n<p>[Update] My current messages are like this, but you can change them if necessary:</p>\n\n<pre><code>message HighRequest {\n  bytes content  = 1;\n}\n\nmessage HighReply {\n  bytes content  = 1;\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2446, "user_id": 1366749, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1511f0e35161decf1a62a8318b3eb97e?s=128&d=identicon&r=PG", "display_name": "Kevin Bullaughey", "link": "https://stackoverflow.com/users/1366749/kevin-bullaughey"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1463350040, "post_id": 37240065, "comment_id": 62017213, "body": "Hm... <code>grep testing $(ls *.go | grep -v &#39;_test.go&#39;)</code> doesn&#39;t turn up anything. How does go make the decision about whether to compile in <code>*_test.go</code> files?"}, {"owner": {"reputation": 2446, "user_id": 1366749, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1511f0e35161decf1a62a8318b3eb97e?s=128&d=identicon&r=PG", "display_name": "Kevin Bullaughey", "link": "https://stackoverflow.com/users/1366749/kevin-bullaughey"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1463412742, "post_id": 37240065, "comment_id": 62042231, "body": "Ah. You were right. I was referencing testing in a dependency of my package, so my grep didn&#39;t pick it up. Want to submit that as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 7, "last_activity_date": 1463412871, "creation_date": 1463412871, "answer_id": 37257694, "question_id": 37240065, "link": "https://stackoverflow.com/questions/37240065/some-how-all-sorts-of-test-argument-flags-showing-up-in-go-program-usage/37257694#37257694", "title": "Some how all sorts of test argument flags showing up in go program usage", "body": "<p>The <code>testing</code> package's <code>init()</code> adds command line arguments to your app using the flags package.</p>\n\n<p>You are likely referencing <code>testing</code> from some bit of non-testing code.</p>\n"}], "owner": {"reputation": 2446, "user_id": 1366749, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1511f0e35161decf1a62a8318b3eb97e?s=128&d=identicon&r=PG", "display_name": "Kevin Bullaughey", "link": "https://stackoverflow.com/users/1366749/kevin-bullaughey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 37257694, "answer_count": 1, "score": 4, "last_activity_date": 1463412871, "creation_date": 1463325808, "question_id": 37240065, "link": "https://stackoverflow.com/questions/37240065/some-how-all-sorts-of-test-argument-flags-showing-up-in-go-program-usage", "title": "Some how all sorts of test argument flags showing up in go program usage", "body": "<p>I have a small go command line utility that I am building in the usual way:</p>\n\n<pre><code>go build\n</code></pre>\n\n<p>I use the <code>flag</code> package to add command line flags. And all was going swimmingly until I started getting a lot of test flags showing up. Now when I print the usage using <code>flag.Usage</code> I see lots of extra flags:</p>\n\n<pre><code>  -test.bench string\n        regular expression to select benchmarks to run\n  -test.benchmem\n        print memory allocations for benchmarks\n  -test.benchtime duration\n        approximate run time for each benchmark (default 1s)\n  -test.blockprofile string\n        write a goroutine blocking profile to the named file after execution\n  -test.blockprofilerate int\n        if &gt;= 0, calls runtime.SetBlockProfileRate() (default 1)\n</code></pre>\n\n<p>There are a lot more than this. </p>\n\n<p>I am using the main flag set and adding flags with <code>flag.IntVar</code> and the like. </p>\n\n<p>I can't figure out what I did or how this could have been enabled. None of my other programs include these test flags in the default usage message. I appreciate any pointers. </p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1463317463, "post_id": 37238067, "comment_id": 62006129, "body": "An index does not imply that each entry must be unique."}, {"owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1463317884, "post_id": 37238067, "comment_id": 62006269, "body": "Well that makes things easy. Thanks!"}], "owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1463313872, "creation_date": 1463313872, "question_id": 37238067, "link": "https://stackoverflow.com/questions/37238067/using-golang-with-mongodb-how-do-you-do-a-nearsphere-search-without-the-coordin", "title": "Using golang with mongodb how do you do a $nearSphere search without the coordinates as an index", "body": "<p>This works to search a collection based on the radius from a coordinate. The issue is I am forced to create an index for the coordinate for it to work. I want to have multiple elements at the same coordinate. Is there another option than nearSphere that works without a index for coords?</p>\n\n<pre><code>...\nlat := loc.Coordinates[1]\nlong := loc.Coordinates[0]\nscope := 321869 // 100 miles\n\nerr := c.Find(bson.M{\"loc\": bson.M{\"$nearSphere\": bson.M{\"$geometry\": bson.M{\n    \"type\":        \"Point\",\n    \"coordinates\": []float64{long, lat},\n},\n    \"$maxDistance\": scope,\n},\n}}).All(&amp;users)\n\n...\n</code></pre>\n"}, {"tags": ["go", "vendor"], "comments": [{"owner": {"reputation": 1315, "user_id": 4069345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a9f29823840e2542fd1796e6f5b1ea?s=128&d=identicon&r=PG", "display_name": "joelnb", "link": "https://stackoverflow.com/users/4069345/joelnb"}, "edited": false, "score": 0, "creation_date": 1463308994, "post_id": 37237036, "comment_id": 62003459, "body": "What tool are you trying to use to do the vendoring? <code>go get</code> doesn&#39;t natively vendor packages so you will probably want to use one of the tools listed here: <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/PackageManagementTools</a>"}, {"owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "reply_to_user": {"reputation": 1315, "user_id": 4069345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a9f29823840e2542fd1796e6f5b1ea?s=128&d=identicon&r=PG", "display_name": "joelnb", "link": "https://stackoverflow.com/users/4069345/joelnb"}, "edited": false, "score": 0, "creation_date": 1463324725, "post_id": 37237036, "comment_id": 62008707, "body": "OK, I have read it, thanks a lot @joelnb"}], "answers": [{"comments": [{"owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "edited": false, "score": 0, "creation_date": 1463324496, "post_id": 37238226, "comment_id": 62008638, "body": "Anyway, if I not use other <code>Dependency Management Tool</code>, I should use <code>copy</code> method. So the <code>vendor&#47;vendor.json</code> file is used <code>Dependency Management Tool</code>, not used the command of go. In fact, I want to use <code>vendor</code> but not want to use <code>Dependency Management Tool</code>, this need to use <code>copy file</code> method."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "edited": false, "score": 0, "creation_date": 1463358266, "post_id": 37238226, "comment_id": 62019072, "body": "Yes, just copy the file using the same <code>github.com&#47;zenazn&#47;goj</code> path, like <code>vendor&#47;github.com&#47;zenazn&#47;goj</code>"}, {"owner": {"reputation": 9650, "user_id": 16432, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bbbab6ce78c8eefe949983ecb09063c5?s=128&d=identicon&r=PG", "display_name": "Joakim", "link": "https://stackoverflow.com/users/16432/joakim"}, "edited": false, "score": 0, "creation_date": 1472859053, "post_id": 37238226, "comment_id": 65937691, "body": "I am so confused, because every where I read it says go always checks in <code>vendor&#47;</code> first. But that is simply not case for me using go 1.7 on Windows. It totally ignores anything I have in my vendor directory? <code>$GOPATH&#47;src&#47;vendor</code>, if I stand in the <code>src&#47;</code> dir and do <code>go run</code> it simply won&#39;t look there"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 9650, "user_id": 16432, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bbbab6ce78c8eefe949983ecb09063c5?s=128&d=identicon&r=PG", "display_name": "Joakim", "link": "https://stackoverflow.com/users/16432/joakim"}, "edited": false, "score": 1, "creation_date": 1472905956, "post_id": 37238226, "comment_id": 65946650, "body": "@Joakim i am pretty sure the directories in the $GOPATH/src/ folder are treated as projects themselves. In your example, ./src/vendor is treated as a project itself named &quot;vendor&quot;.  Instead, create a project folder,like <code>$GOPATH&#47;src&#47;acmecorp&#47;</code>.  Then, a vendor folder in it, like <code>$GOPATH&#47;src&#47;acmecorp&#47;vendor</code>. Then CD to $GOPATH/src/acmecorp/ and build ur project.  Read up on how to organize your Go code: <a href=\"https://golang.org/doc/code.html#Organization\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#Organization</a>"}, {"owner": {"reputation": 824, "user_id": 733100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954f89b0decc75e8355cf87699ab0e60?s=128&d=identicon&r=PG", "display_name": "64bit_twitchyliquid", "link": "https://stackoverflow.com/users/733100/64bit-twitchyliquid"}, "edited": false, "score": 0, "creation_date": 1479254144, "post_id": 37238226, "comment_id": 68477677, "body": "Just to clarify, does <code>.&#47;vendor&#47;</code> refers to any folder named <code>vendor</code> inside actual package sources (as opposed to in <code>$GOPATH</code> but not in <code>$GOPATH&#47;src&#47;</code>)? Is this recursive? (ie: <code>$GOPATH&#47;src&#47;acmecorp&#47;some_sub_package&#47;vendor</code>) or must be exactly one level down from your &#39;project&#39; (ie: exactly <code>$GOPATH&#47;src&#47;acmecorp&#47;vendor</code>)?"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 824, "user_id": 733100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954f89b0decc75e8355cf87699ab0e60?s=128&d=identicon&r=PG", "display_name": "64bit_twitchyliquid", "link": "https://stackoverflow.com/users/733100/64bit-twitchyliquid"}, "edited": false, "score": 0, "creation_date": 1479275448, "post_id": 37238226, "comment_id": 68483416, "body": "@64bit_twitchyliquid sorry, i&#39;ll edit to clarify when back at laptop tomorrow.  <code>.&#47;vendor&#47;</code> refers to the root of your project - yes, the root of the actual package source. Technically, it is not recursive: you only have 1 at the root location you <code>go get</code> or <code>go install</code> from, meaning if u have multiple <code>go get</code> of multiple sub-packages, then each can have their own ./vendor folder.  Just one per project.  For example, a fatuous CLI installed from <code>$GOPATH&#47;src&#47;github.com&#47;eduncan911&#47;mspec&#47;cmd</code> can have one vendor folder at <code>$GOPATH&#47;src&#47;github.com&#47;eduncan911&#47;mspec&#47;cmd&#47;vendor</code>."}, {"owner": {"reputation": 8871, "user_id": 2295964, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c00fadf5a477a8f770e91fdd7b356e76?s=128&d=identicon&r=PG", "display_name": "Yan Foto", "link": "https://stackoverflow.com/users/2295964/yan-foto"}, "edited": false, "score": 1, "creation_date": 1479315649, "post_id": 37238226, "comment_id": 68508115, "body": "Good point on dependency management overkill! No one even hated :D"}, {"owner": {"reputation": 24853, "user_id": 446681, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cBjgR.jpg?s=128&g=1", "display_name": "Hector Correa", "link": "https://stackoverflow.com/users/446681/hector-correa"}, "edited": false, "score": 1, "creation_date": 1485036262, "post_id": 37238226, "comment_id": 70760044, "body": "When you copy the code of the module to your <code>vendor</code> directory, keep in mind that if the original code was a GitHub repo it will include a <code>.git</code> and <code>.github</code> folder on it. If you commit those directories to your repo and push it to GitHub the code will be registered as a submodule and not be in your GitHub repo. This might be OK if you want a submodule, but if you don&#39;t just delete the <code>.git</code> and <code>.github</code> folders from the <code>vendor</code> directory before you push to GitHub."}, {"owner": {"reputation": 9173, "user_id": 172265, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7d658f2c111ae5d8b48f0f0aa7624372?s=128&d=identicon&r=PG", "display_name": "lang2", "link": "https://stackoverflow.com/users/172265/lang2"}, "edited": false, "score": 1, "creation_date": 1487987297, "post_id": 37238226, "comment_id": 72045812, "body": "Just a note, your own code cannot live outside of the <code>$GOPATH</code> structure for <code>vendor</code> to work."}, {"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1504252053, "post_id": 37238226, "comment_id": 78950808, "body": "What is your source on the first statement? I don&#39;t doubt it, but for reference. :)"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1504266491, "post_id": 37238226, "comment_id": 78959285, "body": "@Jonas My source is me in that statement. :)  If you follow the logic through the source code, and see enough error messages of when something is missing, you derive the facts I state in the answer above."}, {"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 1, "creation_date": 1504269571, "post_id": 37238226, "comment_id": 78961184, "body": "Okay, well, if you want one, seems you can use <a href=\"https://golang.org/src/go/build/build.go?s=9943:9963#L352\" rel=\"nofollow noreferrer\">golang.org/src/go/build/build.go?s=9943:9963#L352</a> which is part of the go build code."}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 83, "last_activity_date": 1477928261, "last_edit_date": 1592644375, "creation_date": 1463314854, "answer_id": 37238226, "question_id": 37237036, "link": "https://stackoverflow.com/questions/37237036/how-should-i-use-vendor-in-go-1-6/37238226#37238226", "title": "How should I use vendor in Go 1.6?", "body": "<p>With Go1.6, vendoring is built in as you read.  What does this mean?  Only one thing to keep in mind:</p>\n<blockquote>\n<p>When using the <code>go</code> tools such as <code>go build</code> or <code>go run</code>, they first check to see if the dependencies are located in <code>./vendor/</code>.  If so, use it.  If not, revert to the <code>$GOPATH/src/</code> directory.</p>\n</blockquote>\n<p>The actual &quot;lookup paths&quot; in Go 1.6 are, in order:</p>\n<pre><code>./vendor/github.com/zenazn/goji\n$GOPATH/src/github.com/zenazn/goji\n$GOROOT/src/github.com/zenazn/goji\n</code></pre>\n<p>With that said, <code>go get</code> will continue to install into you <code>$GOPATH/src</code>; and, <code>go install</code> will install into <code>$GOPATH/bin</code> for binaries or <code>$GOPATH/pkg</code> for package caching.</p>\n<h1>So, how do I use ./vendor?!?!</h1>\n<p>Hehe, armed with the knowledge above, it's pretty simple:</p>\n<pre><code>mkdir -p $GOPATH/src/ou/vendor/github.com/zenazn/goji\ncp -r $GOPATH/src/github.com/zenazn/goji/ $GOPATH/src/ou/vendor/github.com/zenazn/goji\n</code></pre>\n<p>In short, to use vendoring, you copy the files using the same <code>github.com/zenazn/goji</code> full path, into your vendor director.</p>\n<p>Now, the go build/install/run tooling will see and use your vendor folder.</p>\n<h1>An easier way instead of copying everything manually</h1>\n<p>Instead of finding and copying all 25+ vendor items, managing their versions, updating other projects etc...  It would be better to use a <em>dependency management tool</em>.  There are many out there and a little googling will point to you several.</p>\n<p>Let me mention two that works with the vendor folder and doesn't fight you:</p>\n<ul>\n<li>godep</li>\n<li>govendor</li>\n</ul>\n<p>In short, these tools will inspect your <code>ou</code> code, find the remote dependencies, and copy them <em>from</em> your <code>$GOPATH/src</code> <em>to</em> your <code>$GOPATH/src/ou/vendor</code> directory (actually, whatever current directory you are in when you run them).</p>\n<p>For example, say you have all of your dependencies installed and working normally in your <code>$GOPATH/src/ou/</code> project using the normal GOPATH/src/github installation of your dependencies.  Your project runs and your tests validate everything is working with the exact version of the repos you have.  With Godep as an example, you'd run this from your project root folder <code>$GOPATH/src/ou/</code>:</p>\n<pre><code>godep save ./...\n</code></pre>\n<p>This would copy all dependencies your project uses into your ./vendor folder.</p>\n<p>Godep is by far and large the most popular.  They have their own Slack channel on the Gopher Slack group.  And, it's the one I use on my teams.</p>\n<p>Govendor is another alternative I read has a nice sync feature.  I haven't used it though.</p>\n<h1>Over Usage of Dependency Management Tool</h1>\n<p>This is purely opinion, and I'm sure haters will downvote...  But as I need to finish my blog post on the subject, let me mention here that most people worry too much about depdency management in Go.</p>\n<p>Yes, there is a need to lock in a repo to a version you depend on so you can ensure your system builds in production.  Yes there is a need to ensure no breaking changes to a way a dependency is interrupting something.</p>\n<p>Use dependency management for those, absolutely.</p>\n<p>But, there is overuse of simple projects that lock in huge amounts of dependencies when in reality...</p>\n<blockquote>\n<p>You may only need to lock in only 1 dependencies; otherwise, you want the latest version of MySQL drivers and test assertion frameworks for bug fixes.</p>\n</blockquote>\n<p>This is where using the <code>./vendor/</code> folder apart from dependency managrment tools can really shine: you'd only need to copy that repo that need you lock in.</p>\n<p>You selectively pick the one misbehaving repo and put it into your ./vendor/ folder.  By doing this, you are telling your consumers:</p>\n<blockquote>\n<p>Hey, this one repo needs to be held back at this revision.  All others are fine and use the latest of those and update often with <code>go get -u ./...</code>; but, this one failed with newer versions so don't upgrade this one repo.</p>\n</blockquote>\n<p>But if blanketly saving all your dependencies with a dependency management tool, you are basically telling your consumers:</p>\n<blockquote>\n<p>There may or may not be a problem with one or more repos out of the 20 in the vendor folder.  You may or may not be able to update them.  You may or may not be able to get the latest MySQL driver.  We simply don't know which may or may not be causing problems and just locked in something that worked at the time that I ran <code>godep save</code>.  So yeah, upgrade at your own risk.</p>\n</blockquote>\n<p>Personally, I have ran into this several times.  A dependency was updated with a breaking change, and we have dozens of repos dependent on it.  Vendoring just that one repo in /vendor allows us to use that one version of dependency, while <code>go get ./...</code> continues to run normally for all other repos to get the latest.  We run with the latest bug fixes in PSQL and MySQL and others (there are constant fixes for these!) and so on.</p>\n"}], "owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36564, "favorite_count": 23, "accepted_answer_id": 37238226, "answer_count": 1, "score": 33, "last_activity_date": 1477928261, "creation_date": 1463307458, "last_edit_date": 1495541430, "question_id": 37237036, "link": "https://stackoverflow.com/questions/37237036/how-should-i-use-vendor-in-go-1-6", "title": "How should I use vendor in Go 1.6?", "body": "<p>First I have read this answer: <a href=\"https://stackoverflow.com/questions/35999046/vendoring-in-go-1-6\">Vendoring in Go 1.6</a>, then I use it as my example.</p>\n\n<p>My gopath is <code>GOPATH=\"/Users/thinkerou/xyz/\"</code>, and the follow like:</p>\n\n<pre><code>thinkerou@MacBook-Pro-thinkerou:~/xyz/src/ou$ pwd\n/Users/baidu/xyz/src/ou\nthinkerou@MacBook-Pro-thinkerou:~/xyz/src/ou$ ls\nmain.go vendor\n</code></pre>\n\n<p>Now, I use <code>go get</code>, then becomes this:</p>\n\n<pre><code>thinkerou@MacBook-Pro-thinkerou:~/xyz/src/ou$ ls\nmain.go vendor\nthinkerou@MacBook-Pro-thinkerou:~/xyz/src/ou$ cd vendor/\nthinkerou@MacBook-Pro-thinkerou:~/xyz/src/ou/vendor$ ls\nvendor.json\nthinkerou@MacBook-Pro-thinkerou:~/xyz/src/ou/vendor$ cd ../..\nthinkerou@MacBook-Pro-thinkerou:~/xyz/src$ ls\ngithub.com ou\nthinkerou@MacBook-Pro-thinkerou:~/xyz/src$ cd github.com/\nthinkerou@MacBook-Pro-thinkerou:~/xyz/src/github.com$ ls\nzenazn\n</code></pre>\n\n<p><code>vendor.json</code> is this:</p>\n\n<pre><code>{\n    \"comment\": \"\",\n    \"package\": [\n        {\n            \"path\": \"github.com/zenazn/goji\"\n        }\n    ]\n}\n</code></pre>\n\n<p>then, I should use what commands? why have no use <code>vendor</code>? My go version is 1.6.2.</p>\n"}, {"tags": ["sqlite", "go", "gorilla", "go-gorm"], "comments": [{"owner": {"reputation": 1, "user_id": 6170556, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GeYhRcdDLMw/AAAAAAAAAAI/AAAAAAAAABA/7EB8xlTGhvw/photo.jpg?sz=128", "display_name": "Braden Jagman", "link": "https://stackoverflow.com/users/6170556/braden-jagman"}, "edited": false, "score": 0, "creation_date": 1463302314, "post_id": 37236071, "comment_id": 62001628, "body": "Solved it! Answer was under <a href=\"http://jinzhu.me/gorm/curd.html#preloading-eager-loading\" rel=\"nofollow noreferrer\">Nested Preloading</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6170556, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GeYhRcdDLMw/AAAAAAAAAAI/AAAAAAAAABA/7EB8xlTGhvw/photo.jpg?sz=128", "display_name": "Braden Jagman", "link": "https://stackoverflow.com/users/6170556/braden-jagman"}, "is_accepted": true, "score": 0, "last_activity_date": 1463302408, "creation_date": 1463302408, "answer_id": 37236275, "question_id": 37236071, "link": "https://stackoverflow.com/questions/37236071/display-foreign-keys-of-foreign-keys-in-go-gorm/37236275#37236275", "title": "Display Foreign Keys of Foreign Keys in Go GORM", "body": "<p>Solved it! Answer was under <a href=\"http://jinzhu.me/gorm/curd.html#preloading-eager-loading\" rel=\"nofollow\">Nested Preloading</a> <em>smacks forehead</em></p>\n"}], "owner": {"reputation": 1, "user_id": 6170556, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GeYhRcdDLMw/AAAAAAAAAAI/AAAAAAAAABA/7EB8xlTGhvw/photo.jpg?sz=128", "display_name": "Braden Jagman", "link": "https://stackoverflow.com/users/6170556/braden-jagman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 37236275, "answer_count": 1, "score": 0, "last_activity_date": 1463302408, "creation_date": 1463300924, "last_edit_date": 1495542254, "question_id": 37236071, "link": "https://stackoverflow.com/questions/37236071/display-foreign-keys-of-foreign-keys-in-go-gorm", "title": "Display Foreign Keys of Foreign Keys in Go GORM", "body": "<p>I was able to partially solve this with <a href=\"https://stackoverflow.com/questions/29435783/gorm-golang-orm-associations\">this case</a></p>\n\n<p>Unfortunately, the Preload() function doesn't seem to work with delving further down in the related object set. </p>\n\n<p>To clarify, I have the following models:</p>\n\n<pre><code>    type Room struct {\n        gorm.Model\n        Name    string\n        Games   []Game `gorm:\"ForeignKey:RoomID\"`\n    }\n\n    type Game struct {\n        gorm.Model\n        RoomID   int `gorm:\"index\"`\n        Players  []Player `gorm:\"ForeignKey:GameID\"`\n    }\n\n    type Player struct {\n        gorm.Model\n        Name   string\n        GameID int `gorm:\"index\"`\n    }\n</code></pre>\n\n<p>When I create a new object with a new Room, Game, and Player object created I get the following data returned (json encoded):</p>\n\n<pre><code>    {\"Value\":{\"ID\":26,\"CreatedAt\":\"2016-05-15T01:21:22.426234189-07:00\",\"UpdatedAt\":\"2016-05-15T01:21:22.426234189-07:00\",\"DeletedAt\":null,\"Name\":\"foo\",\"Games\":[{\"ID\":17,\"CreatedAt\":\"2016-05-15T01:21:22.427026134-07:00\",\"UpdatedAt\":\"2016-05-15T01:21:22.427026134-07:00\",\"DeletedAt\":null,\"RoomID\":26,\"Turns\":null,\"Players\":[{\"ID\":4,\"CreatedAt\":\"2016-05-15T01:21:22.427560561-07:00\",\"UpdatedAt\":\"2016-05-15T01:21:22.427560561-07:00\",\"DeletedAt\":null,\"Name\":\"TestPlayer\",\"GameID\":17}],\"Counter\":1,\"Assigned\":false}],\"Testing\":false},\"Error\":null,\"RowsAffected\":1}\n</code></pre>\n\n<p>But if I try to query the structure with a preload() function, I get the following:</p>\n\n<pre><code>    {\"Value\":{\"ID\":26,\"CreatedAt\":\"2016-05-15T01:21:22.426234189-07:00\",\"UpdatedAt\":\"2016-05-15T01:21:22.426234189-07:00\",\"DeletedAt\":null,\"Name\":\"foo\",\"Games\":[{\"ID\":17,\"CreatedAt\":\"2016-05-15T01:21:22.427026134-07:00\",\"UpdatedAt\":\"2016-05-15T01:21:22.427026134-07:00\",\"DeletedAt\":null,\"RoomID\":26,\"Turns\":null,\"Players\":null,\"Counter\":1,\"Assigned\":false}],\"Testing\":false},\"Error\":null,\"RowsAffected\":1}\n</code></pre>\n\n<p>Note that the Players section is now null. Here's my room registration and room query functions:</p>\n\n<pre><code>    func RegisterRoom(w http.ResponseWriter, r *http.Request) {\n        err := r.ParseForm()\n\n        if err != nil {\n            // Handle error\n        }\n        // r.PostForm is a map of our POST form values\n        room := Room{\n            Name: r.PostFormValue(\"label\"),\n            Games: []Game{{\n                Counter: 1,\n                Players: []Player{{Name: r.PostFormValue(\"username\")}},\n            }},\n        }\n        t := db.Create(&amp;room)\n        if err := json.NewEncoder(w).Encode(t); err != nil {\n            panic(err)\n        }\n    }\n\nfunc RoomShow(w http.ResponseWriter, r *http.Request) {\n    var rm Room\n    vars := mux.Vars(r)\n    roomId := vars[\"roomId\"]\n    id, _ := strconv.Atoi(roomId)\n    room := db.Preload(\"Games\").First(&amp;rm, id)\n    result := db.Find(&amp;room)\n    json.NewEncoder(w).Encode(result)\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "soundcloud"], "answers": [{"comments": [{"owner": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "edited": false, "score": 0, "creation_date": 1463276107, "post_id": 37233575, "comment_id": 61996726, "body": "Not really, to get the data it shouldn&#39;t be necessary to login with the api. Here&#39;s a link to the library <a href=\"https://godoc.org/github.com/njasm/gosoundcloud\" rel=\"nofollow noreferrer\">godoc.org/github.com/njasm/gosoundcloud</a>"}, {"owner": {"reputation": 2243, "user_id": 1994803, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wuOhb.png?s=128&g=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1994803/john-smith"}, "reply_to_user": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "edited": false, "score": 1, "creation_date": 1463276541, "post_id": 37233575, "comment_id": 61996798, "body": "Well, I just tried out your exact example and it fails with the same nil pointer error. After getting the token with <code>PasswordCredentialsToken</code> everything worked fine. I&#39;ve checked the example at <a href=\"https://github.com/njasm/gosoundcloud\" rel=\"nofollow noreferrer\">github.com/njasm/gosoundcloud</a>"}, {"owner": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "edited": false, "score": 0, "creation_date": 1463276808, "post_id": 37233575, "comment_id": 61996827, "body": "I plugged in your code and it tells me err not defined, I&#39;m relatively new at Go. How did you handled the error?"}, {"owner": {"reputation": 2243, "user_id": 1994803, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wuOhb.png?s=128&g=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1994803/john-smith"}, "reply_to_user": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "edited": false, "score": 0, "creation_date": 1463276910, "post_id": 37233575, "comment_id": 61996843, "body": "Well... if there is no error then there is no error! :) In theory your code shouldn&#39;t panic now, have you tried it? Edit: if you plugged in the same exact code, then <code>err</code> is only defined within the if&#39;s scope."}, {"owner": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "edited": false, "score": 0, "creation_date": 1463277064, "post_id": 37233575, "comment_id": 61996876, "body": "Yes John! I tried it before commenting, I got at line 12 undefined: err"}], "tags": [], "owner": {"reputation": 2243, "user_id": 1994803, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wuOhb.png?s=128&g=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1994803/john-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1463275605, "creation_date": 1463275605, "answer_id": 37233575, "question_id": 37233464, "link": "https://stackoverflow.com/questions/37233464/panic-runtime-error-invalid-memory-address-or-nil-pointer-dereference/37233575#37233575", "title": "panic: runtime error: invalid memory address or nil pointer dereference", "body": "<p>I've never used this lib before, but it looks like you forgot to authenticate yourself.</p>\n\n<pre><code>s, _ := gosoundcloud.NewSoundcloudApi(\"Client_Id\", \"Client_Secret\", nil)\nif err = s.PasswordCredentialsToken(\"your_email@something.com\", \"your_password\"); err != nil {\n    // handle err\n}\n</code></pre>\n\n<p>Something like this maybe?</p>\n"}], "owner": {"reputation": 1194, "user_id": 4135058, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/55f736d900d8dcc786419c14300dcf96?s=128&d=identicon&r=PG&f=1", "display_name": "Juanvulcano", "link": "https://stackoverflow.com/users/4135058/juanvulcano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2012, "favorite_count": 0, "accepted_answer_id": 37233575, "answer_count": 1, "score": 0, "last_activity_date": 1463335792, "creation_date": 1463274587, "last_edit_date": 1463335792, "question_id": 37233464, "link": "https://stackoverflow.com/questions/37233464/panic-runtime-error-invalid-memory-address-or-nil-pointer-dereference", "title": "panic: runtime error: invalid memory address or nil pointer dereference", "body": "<p>I'm currently working with a Soundcloud wrapper for Go, I want to print the user's followers but it is the first time I face pointer issues.</p>\n\n<p>After building error</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x10 pc=0xc9c26]\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/njasm/gosoundcloud\"\n)\n\n\nfunc main() {\n    //  callback url is optional - nil in example\n    s, _ := gosoundcloud.NewSoundcloudApi(\"Client_Id\", \"Client_Secret\", nil)\n    var userID uint64 = 1\n    member, err := s.GetUser(userID)\n    if err != nil {\n               panic(err)\n     }\n    fmt.Println(member.Followers)\n}\n</code></pre>\n\n<p>After building</p>\n\n<pre><code>goroutine 1 [running]:\npanic(0x3508c0, 0xc82000a0b0)\n    /usr/local/go/src/runtime/panic.go:481 +0x3e6\nnet/http.(*Client).doFollowingRedirects(0x0, 0xc8200d0000, 0x4611c8, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/http/client.go:429 +0x66\nnet/http.(*Client).Do(0x0, 0xc8200d0000, 0x8, 0x0, 0x0)\n    /usr/local/go/src/net/http/client.go:188 +0xff\ngithub.com/njasm/gosoundcloud.(*SoundcloudApi).do(0xc8200c8720, 0xc8200d0000, 0xc820012f00, 0x0, 0x0)\n    /Users/ManuelDao/Documents/GoBot/src/github.com/njasm/gosoundcloud/soundcloud.go:217 +0x4b\ngithub.com/njasm/gosoundcloud.(*SoundcloudApi).Get(0xc8200c8720, 0xc820012f00, 0x22, 0x0, 0x1, 0x0, 0x0)\n    /Users/ManuelDao/Documents/GoBot/src/github.com/njasm/gosoundcloud/soundcloud.go:92 +0xe1\ngithub.com/njasm/gosoundcloud.(*SoundcloudApi).GetUser(0xc8200c8720, 0x1, 0x417a80, 0x0, 0x0)\n        /Users/ManuelDao/Documents/GoBot/src/github.com/njasm/gosoundcloud/soundcloud.go:276 +0xc6\nmain.main()\n        /Users/ManuelDao/Documents/GoBot/src/GoBot/GoBot.go:24 +0x70\nexit status 2\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "edited": false, "score": 0, "creation_date": 1463313902, "post_id": 37233366, "comment_id": 62004928, "body": "I tried that and now I get.  http: panic serving [::1]:59541: assignment to entry in nil map"}, {"owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "edited": false, "score": 1, "creation_date": 1463315715, "post_id": 37233366, "comment_id": 62005518, "body": "Never mind the issue was down the line in the HTTP response. You are correct that resolved the issue. Thank you for the help!"}], "tags": [], "owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "is_accepted": true, "score": 15, "last_activity_date": 1463273736, "creation_date": 1463273736, "answer_id": 37233366, "question_id": 37231760, "link": "https://stackoverflow.com/questions/37231760/golang-mongodb-having-issues-using-in-to-find-all-elements-with-one-string-in/37233366#37233366", "title": "Golang,MongoDB, Having issues using $in to find all elements with one string in there array property", "body": "<p>You are using \"$in\" wrong. You aren't initialising inner map. You are supposed to use it like this:</p>\n\n<pre><code>err := c.Find(bson.M{\"friends\": bson.M{\"$in\": arr}}).All(&amp;users)\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4737, "favorite_count": 0, "accepted_answer_id": 37233366, "answer_count": 1, "score": 5, "last_activity_date": 1463317239, "creation_date": 1463259163, "question_id": 37231760, "link": "https://stackoverflow.com/questions/37231760/golang-mongodb-having-issues-using-in-to-find-all-elements-with-one-string-in", "title": "Golang,MongoDB, Having issues using $in to find all elements with one string in there array property", "body": "<p>I am trying to find all users in a MongoDB collection that contains a  username string in the friends array. I am using Golang with the mgo driver. </p>\n\n<pre><code>   type User struct {\n    ...\n        Friends        []string    `json: friends bson:\"friends,omitempty\"` \n    ...\n    }\n\n    ...\n    // username is a string\n    arr := []string{username}\n\n    err := c.Find(bson.M{\"friends\": {\"$in\": arr}}).All(&amp;users)\n    ...\n</code></pre>\n\n<p>I get this error:\nhttp: panic serving [::1]:56358: assignment to entry in nil map</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["web-services", "go", "gorilla"], "comments": [{"owner": {"reputation": 963, "user_id": 385280, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/82d083ee140420fe7acde11d5109a311?s=128&d=identicon&r=PG", "display_name": "Venkat", "link": "https://stackoverflow.com/users/385280/venkat"}, "edited": false, "score": 1, "creation_date": 1463244774, "post_id": 37228632, "comment_id": 61988602, "body": "What is the requirement that you&#39;re trying to solve by finding this?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1463288991, "post_id": 37228632, "comment_id": 61998865, "body": "With gorilla/mux: you can use <a href=\"https://godoc.org/github.com/gorilla/mux#Router.Walk\" rel=\"nofollow noreferrer\"><code>router.Walk</code></a> to walk the router, and then call <a href=\"https://godoc.org/github.com/gorilla/mux#Route.GetPathTemplate\" rel=\"nofollow noreferrer\"><code>route.GetPathTemplate</code></a> to get the pattern for that route."}], "answers": [{"comments": [{"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 1, "creation_date": 1463393315, "post_id": 37244145, "comment_id": 62030386, "body": "Thank you but it just return a list of routes how can I return params like /:id ? Please check my question again I edited it"}, {"owner": {"reputation": 882, "user_id": 3984522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6D9an.jpg?s=128&g=1", "display_name": "hsrv", "link": "https://stackoverflow.com/users/3984522/hsrv"}, "reply_to_user": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 0, "creation_date": 1463426655, "post_id": 37244145, "comment_id": 62049991, "body": "I&#39;ve updated the answer, please, check it if it&#39;s helpful"}], "tags": [], "owner": {"reputation": 882, "user_id": 3984522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6D9an.jpg?s=128&g=1", "display_name": "hsrv", "link": "https://stackoverflow.com/users/3984522/hsrv"}, "is_accepted": true, "score": 7, "last_activity_date": 1463403325, "last_edit_date": 1463403325, "creation_date": 1463349769, "answer_id": 37244145, "question_id": 37228632, "link": "https://stackoverflow.com/questions/37228632/get-a-list-of-routes-and-params-in-golang-http-or-gorilla-package/37244145#37244145", "title": "Get a list of routes and params in Golang HTTP or Gorilla package", "body": "<p>You could use <code>http.DefaultServeMux</code> (type <a href=\"https://golang.org/src/net/http/server.go?s=53067:53192#L1780\" rel=\"noreferrer\">ServeMux</a>) and examine it. With <code>reflect</code> package you can <code>ValueOf</code> the default multiplexer and extract <code>m</code> attribute which is a map of your routes.</p>\n\n<pre><code>v := reflect.ValueOf(http.DefaultServeMux).Elem()\nfmt.Printf(\"routes: %v\\n\", v.FieldByName(\"m\"))\n</code></pre>\n\n<p><strong>upd</strong>:</p>\n\n<p>if you use <code>net/http</code> than you should implement extracting params before any request is actually done by yourself; otherwise you have access to params with <code>r.URL.Query()</code></p>\n\n<p>if you use <code>gorilla/mux</code> than as <em>elithrar</em> mentioned you should use <code>Walk</code>:</p>\n\n<p><em>func main</em>: </p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/path/{param1}\", handler)\n\nerr := r.Walk(gorillaWalkFn)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p><em>func gorillaWalkFn</em>:</p>\n\n<pre><code>func gorillaWalkFn(route *mux.Route, router *mux.Router, ancestors []*mux.Route) error {\n    path, err := route.GetPathTemplate()\n    return nil\n}\n</code></pre>\n\n<p>the <code>path</code> variable contains your template:</p>\n\n<p>\"/path/{param1}\"</p>\n\n<p>but you should extract params manually.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6337972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e155e181ffe0ba72262d83f4a2381f?s=128&d=identicon&r=PG&f=1", "display_name": "never do", "link": "https://stackoverflow.com/users/6337972/never-do"}, "is_accepted": false, "score": 3, "last_activity_date": 1463375088, "creation_date": 1463375088, "answer_id": 37247014, "question_id": 37228632, "link": "https://stackoverflow.com/questions/37228632/get-a-list-of-routes-and-params-in-golang-http-or-gorilla-package/37247014#37247014", "title": "Get a list of routes and params in Golang HTTP or Gorilla package", "body": "<p>You can see list of routes in HTTP package. </p>\n\n<pre><code>http.HandleFunc(\"/favicon.ico\", func(res http.ResponseWriter, req *http.Request) {\n    http.ServeFile(res, req, \"favicon.ico\")\n})\nhttp.HandleFunc(`/check`, func(res http.ResponseWriter, req *http.Request) {\n    res.Write([]byte(\"Regexp works :)\"))\n})\n\nhttpMux := reflect.ValueOf(http.DefaultServeMux).Elem()\nfinList := httpMux.FieldByIndex([]int{1})\nfmt.Println(finList)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1561465501, "creation_date": 1561465501, "answer_id": 56754017, "question_id": 37228632, "link": "https://stackoverflow.com/questions/37228632/get-a-list-of-routes-and-params-in-golang-http-or-gorilla-package/56754017#56754017", "title": "Get a list of routes and params in Golang HTTP or Gorilla package", "body": "<p>An answer to improve i guess. </p>\n\n<p>it provides the missing piece of code to extract parameters from the route path template string.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\nvar pathTemplateRegex = regexp.MustCompile(`\\{(\\\\?[^}])+\\}`)\n\nfunc getRouteParams(router *mux.Router, route string) []string {\n    r := router.Get(route)\n    if r == nil {\n        return nil\n    }\n    t, _ := r.GetPathTemplate()\n    params := pathTemplateRegex.FindAllString(t, -1)\n    for i, p := range params {\n        p = strings.TrimPrefix(p, \"{\")\n        p = strings.TrimSuffix(p, \"}\")\n        if strings.ContainsAny(p, \":\") {\n            p = strings.Split(p, \":\")[0]\n        }\n        params[i] = p\n    }\n    return params\n}\n</code></pre>\n"}], "owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4552, "favorite_count": 5, "accepted_answer_id": 37244145, "answer_count": 3, "score": 2, "last_activity_date": 1561465501, "creation_date": 1463240431, "last_edit_date": 1463393189, "question_id": 37228632, "link": "https://stackoverflow.com/questions/37228632/get-a-list-of-routes-and-params-in-golang-http-or-gorilla-package", "title": "Get a list of routes and params in Golang HTTP or Gorilla package", "body": "<p>When I write a simple web application like this:</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/about\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>How can I find the list of routes and params which I defined in my web app?\ne.g find \"/about\" in this example.</p>\n\n<p><strong>EDIT 1:</strong>\nHow can get this one params and route? </p>\n\n<pre><code>gorilla.HandleFunc(`/check/{id:[0-9]+}`, func(res http.ResponseWriter, req *http.Request) {\n    res.Write([]byte(\"Regexp works :)\"))\n})\n</code></pre>\n"}, {"tags": ["go", "package"], "answers": [{"tags": [], "owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "is_accepted": false, "score": 0, "last_activity_date": 1463239252, "last_edit_date": 1463239252, "creation_date": 1463238981, "answer_id": 37228353, "question_id": 37227996, "link": "https://stackoverflow.com/questions/37227996/pull-a-copy-of-a-single-go-standard-package-for-modification/37228353#37228353", "title": "Pull a copy of a single go standard package for modification", "body": "<p>As Godoc says</p>\n\n<blockquote>\n<pre><code>get         download and install packages and dependencies\n</code></pre>\n</blockquote>\n\n<p>You just can get packages and dependencies. But you want to get a folder! You can download its zip file from github and copy it to that destination. If you want to see the errors you can use the error type.</p>\n\n<p>e.g sql.Open returns *sql.DB, error</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"astaxie:astaxie@/test?charset=utf8\")\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1463246386, "creation_date": 1463246386, "answer_id": 37229678, "question_id": 37227996, "link": "https://stackoverflow.com/questions/37227996/pull-a-copy-of-a-single-go-standard-package-for-modification/37229678#37229678", "title": "Pull a copy of a single go standard package for modification", "body": "<p>You can either build Go from source, and then modify the standard library in place, or you can vendor that particular package. </p>\n\n<p>If you have Go installed from source, after editing the package you can install the new version just like any other package with <code>go install database/sql</code></p>\n\n<p>If you copy the <code>database/sql</code> package into a <code>vendor</code> directory, that copy will be built and imported in place of the version from the standard library. </p>\n"}], "owner": {"reputation": 143, "user_id": 4398524, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cJJWF3Vsajc/AAAAAAAAAAI/AAAAAAAAAAA/LgmVS1-OBRE/photo.jpg?sz=128", "display_name": "Greg C", "link": "https://stackoverflow.com/users/4398524/greg-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "accepted_answer_id": 37229678, "answer_count": 2, "score": 2, "last_activity_date": 1463246386, "creation_date": 1463236948, "last_edit_date": 1463238522, "question_id": 37227996, "link": "https://stackoverflow.com/questions/37227996/pull-a-copy-of-a-single-go-standard-package-for-modification", "title": "Pull a copy of a single go standard package for modification", "body": "<p>I have an idea for a minor addition I would like to make to the database/sql go package. I would like to try my change out to see how it works. </p>\n\n<p>I thought that I would be able to execute this command to get a copy of the source in database/sql that I could play with:</p>\n\n<pre><code>go get github.com/golang/go/tree/master/src/database/sql\n</code></pre>\n\n<p>Then, I was going to change my import statement from </p>\n\n<pre><code>import \"database/sql\"\n</code></pre>\n\n<p>to </p>\n\n<pre><code>import \"github.com/golang/go/tree/master/src/database/sql\"\n</code></pre>\n\n<p>and put a debugging Printf in my local copy of the code to confirm that the new code I just pulled was being executed rather than the code in /usr/local/go. </p>\n\n<p>When I try the \"go get\" command above, I get this error message:</p>\n\n<pre><code>$ go get github.com/golang/go/tree/master/src/database/sql\npackage github.com/golang/go/tree/master/src/database/sql: cannot find package \"github.com/golang/go/tree/master/src/database/sql\" in any of:\n    /usr/local/go/src/github.com/golang/go/tree/master/src/database/sql (from $GOROOT)\n    /Users/me/go/src/github.com/golang/go/tree/master/src/database/sql (from $GOPATH)\n$ echo $GOPATH\n/Users/me/go\n$\n</code></pre>\n\n<p>Why doesn't this work?</p>\n\n<p>I also tried doing this with the source at </p>\n\n<pre><code>https://go.googlesource.com/go/+/release-branch.go1.6/src/database/sql\n</code></pre>\n\n<p>That didn't work either. Then I tried downloading the tgz of the source from the link above, and untarring those files in my own $GOPATH/src/github.com/database/sql folder, then go building them there. That produced a sql.a that ran, but didn't work.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "is_accepted": true, "score": 0, "last_activity_date": 1463244577, "creation_date": 1463244577, "answer_id": 37229361, "question_id": 37227481, "link": "https://stackoverflow.com/questions/37227481/is-windows-cmd-will-filter-some-special-symbols/37229361#37229361", "title": "Is windows cmd will filter some special symbols?", "body": "<p>I dont have a Windows machine but it works in linux shell. Also you can check this one <code>-i \"github.com/jquery/jquery^2.2.3\"</code></p>\n"}], "owner": {"reputation": 411, "user_id": 4737876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tygIZ.jpg?s=128&g=1", "display_name": "Muge", "link": "https://stackoverflow.com/users/4737876/muge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 37229361, "answer_count": 1, "score": -3, "last_activity_date": 1463244577, "creation_date": 1463233926, "question_id": 37227481, "link": "https://stackoverflow.com/questions/37227481/is-windows-cmd-will-filter-some-special-symbols", "title": "Is windows cmd will filter some special symbols?", "body": "<p>I tried to resolve command line arguments that may be a string with some special symbols, such as <code>-i github.com/jquery/jquery^2.2.3</code>, but os.Args got the no <code>^</code> string, I don't known why process filter this symbol.</p>\n"}, {"tags": ["rest", "go"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1463230742, "post_id": 37225254, "comment_id": 61983771, "body": "IMHO, it&#39;s useful to have the modification time data around (at least it serves you later when you need to know the timestamp at when the file is copied). I would probably think about how to include the legacy timestamp as an additional data. Perhaps appending it to the file and hash it or something similar."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463325479, "post_id": 37225254, "comment_id": 62008999, "body": "it&#39;s up to you to transfer the time stamps and set the times you want on the file. There&#39;s no part of the http protocol or the &quot;net/http&quot; package to do this for you"}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1463438263, "post_id": 37225254, "comment_id": 62055401, "body": "An <code>io.Reader</code> is not a file and doesn&#39;t have any sort of timestamp associated with it. An interface is not the things that implement it."}], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1463230878, "creation_date": 1463220217, "last_edit_date": 1463230878, "question_id": 37225254, "link": "https://stackoverflow.com/questions/37225254/how-to-preserve-the-timestamp-of-an-io-reader-when-copying-a-file-by-using-a-res", "title": "How to preserve the timestamp of an io.Reader when copying a file by using a REST service in go?", "body": "<p>I am writing some microservices in Go which handle different files. </p>\n\n<p>I want to transfer files from one service, the client, to another, the server, via PUT method. The service works, but there is a small point which is not elegant. The files I transfer are getting a new modification date, when I write them on the file system of the server.</p>\n\n<p>At the moment I handle the <code>http.Request</code> at the server like this:</p>\n\n<ul>\n<li>ensure that there is a file at the server</li>\n<li>copy the body from the request to the server <code>io.Copy(myfile, r.Body)</code></li>\n</ul>\n\n<p>When I do that the file has the last modification date from now(). To solve this problem I could transfer a timestamp of the original file and set it via <code>io.Chtimes()</code>. But the request.Body implements an <code>io.ReadCloser</code> interface, so I think there must be a more elegant way to implement the writing of the file onto the server. Is there a function, which takes an <code>io.Reader</code> which preserves the timestamp of the file?\nIf not, is there a solution for REST services for this problem?</p>\n"}, {"tags": ["go", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 2197615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1NYq.jpg?s=128&g=1", "display_name": "navono", "link": "https://stackoverflow.com/users/2197615/navono"}, "edited": false, "score": 0, "creation_date": 1572587693, "post_id": 37226029, "comment_id": 103613422, "body": "error: no such table <code>db1.SomeTable</code>. which <code>SomeTable</code> is actual table name."}, {"owner": {"reputation": 112, "user_id": 2197615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1NYq.jpg?s=128&g=1", "display_name": "navono", "link": "https://stackoverflow.com/users/2197615/navono"}, "edited": false, "score": 0, "creation_date": 1572589241, "post_id": 37226029, "comment_id": 103613753, "body": "If excution <code>join</code> query is db1, there is no need to set db name in <code>from</code>, just use table name like this:select *      from SomeTable a      inner join db2.SomeTable b on b.SomeColumn = a.SomeColumn;"}], "tags": [], "owner": {"reputation": 2532, "user_id": 809198, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f9aa79f93a3c988f32b7fa40d097c6be?s=128&d=identicon&r=PG", "display_name": "Chris Townsend", "link": "https://stackoverflow.com/users/809198/chris-townsend"}, "is_accepted": true, "score": 6, "last_activity_date": 1463226941, "last_edit_date": 1463226941, "creation_date": 1463225064, "answer_id": 37226029, "question_id": 37224993, "link": "https://stackoverflow.com/questions/37224993/can-you-use-sqlite-attach-and-detach-in-golang/37226029#37226029", "title": "Can you use SQLite ATTACH and DETACH in Golang", "body": "<p>You can attach a database, you would do it in SQL after opening the first database (omit error check for brevity):</p>\n\n<pre><code>db1, err := sql.Open(\"sqlite3\", \"./db1.db\")\ndefer db1.Close()\n\ns := \"attach database '/path/to/db2.db' as db2;\"\n\n_, err = db.Exec(s)\n\ns = `select *\n     from db1.SomeTable a\n     inner join db2.SomeTable b on b.SomeColumn = a.SomeColumn; `\n\nresults, err := db.Query(s)\ndefer results.Close()\n\n//process results ...\n\n_, err = db.Exec(\"detach database db2;\")\n</code></pre>\n"}], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 37226029, "answer_count": 1, "score": 3, "last_activity_date": 1463226941, "creation_date": 1463218162, "question_id": 37224993, "link": "https://stackoverflow.com/questions/37224993/can-you-use-sqlite-attach-and-detach-in-golang", "title": "Can you use SQLite ATTACH and DETACH in Golang", "body": "<p>I am using <a href=\"https://github.com/mattn/go-sqlite3\" rel=\"nofollow\">https://github.com/mattn/go-sqlite3</a> in a Golang application. I need to use multiple databases, and was wondering whether I can use ATTACH and DETACH in Golang (<a href=\"http://sqlite.org/lang_attach.html\" rel=\"nofollow\">http://sqlite.org/lang_attach.html</a>).</p>\n\n<p>I don't have any code right now, because I don't know how else to tackle this problem except creating two database connections and joining data in the application:</p>\n\n<pre><code>db1, err := sql.Open(\"sqlite3\", \"./db1.db\")\n\ndb2, err := sql.Open(\"sqlite3\", \"./db2.db\")\n\n// query db1 and db2\n// put into map\n// join data\n</code></pre>\n\n<p>It would be much easier if you could use:</p>\n\n<pre><code>attach database database1.db as db1;\nattach database database2.db as db2;\n\nselect\n  *\nfrom\n  db1.SomeTable a\n    inner join \n  db2.SomeTable b on b.SomeColumn = a.SomeColumn;\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 0, "creation_date": 1463220403, "post_id": 37224432, "comment_id": 61980649, "body": "after open, make a ping to check if database is connected : err := db.Ping()"}], "answers": [{"tags": [], "owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "is_accepted": true, "score": 0, "last_activity_date": 1463233984, "creation_date": 1463233984, "answer_id": 37227496, "question_id": 37224432, "link": "https://stackoverflow.com/questions/37224432/data-cant-be-saved-in-my-database/37227496#37227496", "title": "Data can&#39;t be saved in my database", "body": "<p>You are passing a slice of strings to something that does not handle it. Try extracting <code>title</code> and <code>main</code> by using <code>r.Form.Get</code> instead and then pass those to your prepared statement.</p>\n"}], "owner": {"reputation": 67, "user_id": 6249605, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YhpGs.jpg?s=128&g=1", "display_name": "Mario Hu", "link": "https://stackoverflow.com/users/6249605/mario-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 37227496, "answer_count": 1, "score": 0, "last_activity_date": 1463233984, "creation_date": 1463214444, "last_edit_date": 1463219273, "question_id": 37224432, "link": "https://stackoverflow.com/questions/37224432/data-cant-be-saved-in-my-database", "title": "Data can&#39;t be saved in my database", "body": "<p>I have my website and it can write something . Then my service can get this data and save in my database, but it is not working for me. I tried some steps and it seems that can transmission string to dab(),but it can't save anything in my database.</p>\n\n<p>Error log:</p>\n\n<pre><code>2016/05/14 08:02:08 http: panic serving 14.146.246.141:64540: sql: converting argument #0's type: unsupported type \n[]string, a slice\ngoroutine 5 [running]:\nnet/http.(*conn).serve.func1(0xc8200b4f20, 0x7f8b9f86c6c8, 0xc820024038)\n    /usr/lib/golang/src/net/http/server.go:1287 +0xb5\nmain.checkErr(0x7f8b9f867028, 0xc82000b4a0)\n    /home/Mario/a.go:50 +0x4b\nmain.dab(0xc82000b360, 0x1, 0x1, 0xc82000b370, 0x1, 0x1)\n    /home/Mario/a.go:41 +0x306\nmain.handle(0x7f8b9f86c848, 0xc8200b5550, 0xc8200de2a0)\n    /home/Mario/a.go:28 +0x4a7\nnet/http.HandlerFunc.ServeHTTP(0x876a90, 0x7f8b9f86c848, 0xc8200b5550, 0xc8200de2a0)\n    /usr/lib/golang/src/net/http/server.go:1422 +0x3a\nnet/http.(*ServeMux).ServeHTTP(0xc820012930, 0x7f8b9f86c848, 0xc8200b5550, 0xc8200de2a0)\n    /usr/lib/golang/src/net/http/server.go:1699 +0x17d\nnet/http.serverHandler.ServeHTTP(0xc820016120, 0x7f8b9f86c848, 0xc8200b5550, 0xc8200de2a0)\n    /usr/lib/golang/src/net/http/server.go:1862 +0x19e\nnet/http.(*conn).serve(0xc8200b4f20)\n    /usr/lib/golang/src/net/http/server.go:1361 +0xbee\ncreated by net/http.(*Server).Serve\n    /usr/lib/golang/src/net/http/server.go:1910 +0x3f6\n</code></pre>\n\n<p>Code snippet:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"log\"\n    \"fmt\"\n    \"html/template\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"database/sql\"\n)\n\nfunc Mai(w http.ResponseWriter, r *http.Request){\n        t, _ := template.ParseFiles(\"a.js\")\n        t.Execute(w, nil)\n}\n\nfunc FormServer(w http.ResponseWriter, r *http.Request){\n        t, _ := template.ParseFiles(\"an.html\")\n        t.Execute(w, nil)\n}\n\nfunc handle(w http.ResponseWriter, r *http.Request){\n        r.ParseForm()\n        fmt.Println(\"title:\", r.Form[\"title\"])\n        fmt.Println(\"main:\", r.Form[\"main\"])\n        a := r.Form[\"title\"]\n        b := r.Form[\"main\"]\n        dab(a , b)\n        // t, _ := template.ParseFiles(\"finish.html\")\n        // t.Execute(w, nil)\n}\n\nfunc dab(a , b []string){\n    db, err := sql.Open(\"mysql\", \"root:123456@/xiaoyou?charset=utf8\")\n    checkErr(err)\n    stmt, err := db.Prepare(\"INSERT talk SET title=?,main=?\")\n    checkErr(err)\n    res, err := stmt.Exec(a , b)\n    checkErr(err)\n    id, err := res.LastInsertId()\n    checkErr(err)\n    fmt.Println(id)\n    db.Close()\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc main() {\n    http.HandleFunc(\"/\",Mai)\n    http.HandleFunc(\"/login\", FormServer)\n    http.HandleFunc(\"/submit\",handle)\n    err := http.ListenAndServe(\":80\", nil)\n    if err != nil {\n        log.Fatal(\"ListenAndServe:\",err)\n    }\n}\n</code></pre>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "edited": false, "score": 0, "creation_date": 1463211910, "post_id": 37224017, "comment_id": 61978251, "body": "You&#39;re correct, and that is the problem Im facing. If I specify <code>xml:&quot;Person&gt;FullName&quot;</code>, The result will be <code>Jerome Anthony</code>, while if I specify <code>xml:&quot;a&gt;Person&gt;FullName&quot;</code>, The result will be <code>Christina</code>. I want to consolidate both to the same value. I want to do similar to xpath, where you can build an expression that says &quot;Give me any node, no matter the nesting level, that is named <code>FullName</code>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "edited": false, "score": 0, "creation_date": 1463215893, "post_id": 37224017, "comment_id": 61979324, "body": "@buddy123, you could do <a href=\"https://godoc.org/?q=xpath\" rel=\"nofollow noreferrer\">just</a> <a href=\"https://godoc.org/?q=etree\" rel=\"nofollow noreferrer\">that</a>."}], "tags": [], "owner": {"reputation": 13962, "user_id": 52573, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f46863ecd43e4ac1a482558a8a13683d?s=128&d=identicon&r=PG", "display_name": "nes1983", "link": "https://stackoverflow.com/users/52573/nes1983"}, "is_accepted": false, "score": 0, "last_activity_date": 1463211467, "creation_date": 1463211467, "answer_id": 37224017, "question_id": 37223797, "link": "https://stackoverflow.com/questions/37223797/unmarshaling-matched-nodes-at-any-level-in-the-xml/37224017#37224017", "title": "Unmarshaling matched nodes at any level in the xml", "body": "<p>It seems to me that People has no child named FullName. It has, however, a child named \"a\" that has a child named FullName.</p>\n\n<p>There's a working example right in the documentation: <a href=\"https://golang.org/pkg/encoding/xml/#example_Unmarshal\" rel=\"nofollow\">https://golang.org/pkg/encoding/xml/#example_Unmarshal</a>. </p>\n"}], "owner": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1463211467, "creation_date": 1463210063, "question_id": 37223797, "link": "https://stackoverflow.com/questions/37223797/unmarshaling-matched-nodes-at-any-level-in-the-xml", "title": "Unmarshaling matched nodes at any level in the xml", "body": "<p>Im trying to unmarshal an xml and extract specific nodes out of it, which can be at several different levels. \nFor example, such Xml is valid:</p>\n\n<pre><code>&lt;People&gt;\n            &lt;Person&gt;\n                &lt;FullName&gt;Jerome Anthony&lt;/FullName&gt;\n            &lt;/Person&gt;\n            &lt;a&gt;\n            &lt;Person&gt;\n            &lt;FullName&gt;Christina&lt;/FullName&gt;\n            &lt;/Person&gt;\n        &lt;/a&gt;\n        &lt;/People&gt;\n</code></pre>\n\n<p>I would like to extract all FullName from this xml, regardless of their nesting level.\nExample code  I tried, which is not working:</p>\n\n<pre><code>type People struct {\n    Names []string `xml:\"FullName\"`\n}\nv := People{Names: []string{}}\n    err := xml.Unmarshal([]byte(data), &amp;v)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        return\n    }\n    fmt.Printf(\"Names of people: %q\", v)\n</code></pre>\n\n<p>Remark: This is a simple example for unmarshaling strings, effectively I would like to also unmarshal complex structures.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1463204097, "post_id": 37222911, "comment_id": 61976191, "body": "If a newbie to go, do <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">some reading</a> and take the <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">Go Tour to learn how to code in Go</a>."}, {"owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1463204839, "post_id": 37222911, "comment_id": 61976336, "body": "I made some changes and updated the same."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1463205103, "post_id": 37222911, "comment_id": 61976406, "body": "Please see my edited answer."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 3, "creation_date": 1463205538, "post_id": 37222911, "comment_id": 61976501, "body": "If you narrowed the problem down (by removing struct fields one at a time until you have a minimal problem), you&#39;ll find it&#39;s a dupe of this: <a href=\"http://stackoverflow.com/questions/26866879/initialize-nested-struct-definition-in-golang\" title=\"initialize nested struct definition in golang\">stackoverflow.com/questions/26866879/&hellip;</a>"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1463205633, "post_id": 37222911, "comment_id": 61976528, "body": "This is a minimal repro for this problem: <a href=\"https://play.golang.org/p/tybBTTp5Vj\" rel=\"nofollow noreferrer\">play.golang.org/p/tybBTTp5Vj</a>"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1463204267, "post_id": 37222966, "comment_id": 61976221, "body": "I did that. And i am still getting the exact same errors."}, {"owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1463205206, "post_id": 37222966, "comment_id": 61976431, "body": "I already did this and updated my original post. It now shows a &quot;missing type in composite literal&quot; error."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1463205335, "post_id": 37222966, "comment_id": 61976452, "body": "Please be more specific with the error. Does it tells the line with problem?"}, {"owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1463205493, "post_id": 37222966, "comment_id": 61976488, "body": "It occurs in the line in which i give the value for URL."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1463205716, "post_id": 37222966, "comment_id": 61976552, "body": "You code runs fine on my end without error. Are you sure in your code your <code>URL</code> type is string? &quot;missing type in composite literal&quot; error occurs when one does not specify the type in the literal construction which normally happens with slices, map, structs."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1463246364, "post_id": 37222966, "comment_id": 61989162, "body": "@RJP Older versions of go required you to name the subtypes in literals.  I&#39;m guessing you are using go 1.4.something from your linux distro?"}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 3, "last_activity_date": 1463207143, "last_edit_date": 1463207143, "creation_date": 1463203867, "answer_id": 37222966, "question_id": 37222911, "link": "https://stackoverflow.com/questions/37222911/syntax-error-in-golang/37222966#37222966", "title": "Syntax Error in Golang", "body": "<p>When you use an anonymous struct like this:</p>\n\n<pre><code>type AutoGenerate struct {\n        Request: struct {\n                URL    string\n                Method string\n        }\n}\n</code></pre>\n\n<p>This whole chunk is the type name</p>\n\n<pre><code>struct {\n        URL string\n        Method string\n}\n</code></pre>\n\n<p>In another word, you'll have to initiate this way</p>\n\n<pre><code>data := AutoGenerate{\n        Request: struct {\n                URL    string\n                Method string\n        }{\n                URL: \"http://somedomain.com/\",\n                Method: \"GET\",\n        },\n}\n</code></pre>\n\n<p>Thus, in your case, it is better to separate each struct into a named one:</p>\n\n<pre><code>type Request struct {\n         URL    string\n         Method string\n}\n\ntype AutoGenerate struct {\n        Request Request\n}\n</code></pre>\n\n<p>Please see <a href=\"https://play.golang.org/p/kZDN2yhlkz\" rel=\"nofollow\">https://play.golang.org/p/kZDN2yhlkz</a> of the chaos it will become with anonymous structs.</p>\n"}, {"tags": [], "owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "is_accepted": false, "score": 0, "last_activity_date": 1463208342, "creation_date": 1463208342, "answer_id": 37223561, "question_id": 37222911, "link": "https://stackoverflow.com/questions/37222911/syntax-error-in-golang/37223561#37223561", "title": "Syntax Error in Golang", "body": "<p>Okay, after referring to the links posted by Paul and PieOhPah this is how i created my struct :</p>\n\n<pre><code>type AutoGenerated struct {\n    ID int64 `json:\"id\"`\n    SuccessHTTPResponseCode int `json:\"success_http_response_code\"`\n    MaxRetries int `json:\"max_retries\"`\n    CallbackWebhookURL string `json:\"callback_webhook_url\"`\n    Request `json:\"request\"`\n}\ntype Request struct{\n  URL string `json:\"url\"`\n  Method string `json:\"method\"`\n  HTTPHeaders `json:\"http_headers\"`\n  Body `json:\"body\"`\n}\ntype HTTPHeaders struct{\n  ContentType string `json:\"content-Type\"`\n  Accept string `json:\"accept\"`\n}\ntype Body struct{\n    Foo string `json:\"foo\"`\n}\n</code></pre>\n\n<p>Here is the function in which I initialize and Marshal it:</p>\n\n<pre><code>func createBSON() []byte {\ndata1:= AutoGenerated{\n    ID: 1462406556741,\n    SuccessHTTPResponseCode: 200,\n    MaxRetries: 3,\n    CallbackWebhookURL: \"http://requestb.in/vh61ztvh\",\n    Request: Request{\n        URL: \"http://requestb.in/vh61ztvh\",\n        Method: \"POST\",\n        HTTPHeaders: HTTPHeaders {\n            ContentType: \"Application/json\",\n          Accept: \"Application/json\",\n        },\n        Body : Body {\n            Foo: \"bar\",\n        },\n    },\n\n}\n    fmt.Print(data1)\n    sample,err:=json.Marshal(data1)\n    s := string(sample)\n    fmt.Println(s)\n    return sample\n}\n</code></pre>\n\n<p>I posted this hoping this it will be useful for others who encounter deeply nested structs in Go. </p>\n"}], "owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1463208342, "creation_date": 1463203481, "last_edit_date": 1463205467, "question_id": 37222911, "link": "https://stackoverflow.com/questions/37222911/syntax-error-in-golang", "title": "Syntax Error in Golang", "body": "<p>I am marshaling values into a struct from JSON. This is my struct:</p>\n\n<pre><code>type AutoGenerated struct {\n    ID int64 `json:\"id\"`\n    SuccessHTTPResponseCode int `json:\"success_http_response_code\"`\n    MaxRetries int `json:\"max_retries\"`\n    CallbackWebhookURL string `json:\"callback_webhook_url\"`\n    Request struct {\n        URL string `json:\"url\"`   (error occurs here)\n        Method string `json:\"method\"`\n        HTTPHeaders struct {\n            ContentType string `json:\"content-Type\"`\n            Accept string `json:\"accept\"`\n        } `json:\"http_headers\"`\n        Body struct {\n            Foo string `json:\"foo\"`\n        } `json:\"body\"`\n    } `json:\"request\"`\n}\n</code></pre>\n\n<p>Below is the function where I marshal it:</p>\n\n<pre><code>func createBSON() []byte {\n      data1:= AutoGenerated{\n      ID: 1462406556741,\n      SuccessHTTPResponseCode: 200,\n      MaxRetries: 3,\n      CallbackWebhookURL: \"http://requestb.in/vh61ztvh\",\n      Request: {\n          URL: \"http://requestb.in/vh61ztvh\",\n          Method: \"POST\",\n          HTTPHeaders: {\n              ContentType: \"Application/json\",\n            Accept: \"Application/json\",\n          },\n          Body : {\n              Foo: \"bar\",\n          },\n      },\n\n}\n    sample,err:=json.Marshal(data1)\n    check(err)\n    fmt.Print(sample)\n    return sample\n}\n</code></pre>\n\n<p>I made a couple of changes and the above is my updated function.\nI am getting the following error:</p>\n\n<pre><code>  missing type in composite literal\n</code></pre>\n\n<p>I am kind of new to Golang. I can't figure out what this error is. Any help would be appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1463203393, "post_id": 37222503, "comment_id": 61976030, "body": "Did you code in Java before? Your code makes Go looks like Java for some reason. Please try to separate lines even though you can get away with <code>;</code>"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1463203647, "post_id": 37222503, "comment_id": 61976088, "body": "I&#39;d recommend reading a bit on <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">Go pipeline pattern</a> to write cleaner synchronization between stages and channels."}, {"owner": {"reputation": 9, "user_id": 4942547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593ea5ca2f08d531b6e8a72523d3f85e?s=128&d=identicon&r=PG&f=1", "display_name": "yoga adya pratama", "link": "https://stackoverflow.com/users/4942547/yoga-adya-pratama"}, "reply_to_user": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1463205258, "post_id": 37222503, "comment_id": 61976440, "body": "@PieOhPah, thanks for the advice and ill have a look !"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4942547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593ea5ca2f08d531b6e8a72523d3f85e?s=128&d=identicon&r=PG&f=1", "display_name": "yoga adya pratama", "link": "https://stackoverflow.com/users/4942547/yoga-adya-pratama"}, "edited": false, "score": 0, "creation_date": 1463205064, "post_id": 37222753, "comment_id": 61976394, "body": "where did you put the fromPipeline[1] &lt;- 2 ? i tried put it in the &#39;retiredOpCode&#39; but it still not working"}, {"owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "reply_to_user": {"reputation": 9, "user_id": 4942547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593ea5ca2f08d531b6e8a72523d3f85e?s=128&d=identicon&r=PG&f=1", "display_name": "yoga adya pratama", "link": "https://stackoverflow.com/users/4942547/yoga-adya-pratama"}, "edited": false, "score": 0, "creation_date": 1463270795, "post_id": 37222753, "comment_id": 61995872, "body": "I just put it in right after the fmt.Println() at the end of the for loop in main()."}], "tags": [], "owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "is_accepted": false, "score": 1, "last_activity_date": 1463202138, "creation_date": 1463202138, "answer_id": 37222753, "question_id": 37222503, "link": "https://stackoverflow.com/questions/37222503/golang-printf-shows-nothing-even-after-using-time-sleep/37222753#37222753", "title": "GoLang printf shows nothing, even after using time.Sleep", "body": "<p>You never put anything into the <code>fromPipeline</code>.</p>\n\n<p>If I add the line <code>fromPipeline[1] &lt;- 2</code> anywhere, I'll see <code>Complete : 2  By Pipeline : 1</code> printed out as <code>retiredOpCode</code> does its work.</p>\n"}], "owner": {"reputation": 9, "user_id": 4942547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593ea5ca2f08d531b6e8a72523d3f85e?s=128&d=identicon&r=PG&f=1", "display_name": "yoga adya pratama", "link": "https://stackoverflow.com/users/4942547/yoga-adya-pratama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "closed_date": 1463221482, "answer_count": 1, "score": 0, "last_activity_date": 1463202138, "creation_date": 1463199885, "question_id": 37222503, "link": "https://stackoverflow.com/questions/37222503/golang-printf-shows-nothing-even-after-using-time-sleep", "closed_reason": "Duplicate", "title": "GoLang printf shows nothing, even after using time.Sleep", "body": "<p>I've been wondering why the fmt.Print in the retiredOpCode function is not working. Though, the fmt.Print in the dispatchOpCode function working fine.\nThe code below is the complete code (You can try to run from the go playground) and the fmt.Print in dispatchOpCode function is working.</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n    \"time\"\n    \"math/rand\")\n\nvar maxPipeline = 3     //Max Pipeline\nvar maxNumber = 5       //Max Number which will be randomed\nconst totalNumber = 10  //Total number will be randomed\n//========================================================================\n// FUNCTION TO DELAY THE TIME (TO PREVENT GO FROM EXIST AFTER GO ROUTINE)\n//========================================================================\nfunc delayTime(multiplier time.Duration){\n    time.Sleep(time.Millisecond * multiplier)\n}\n//========================================================================\n//                          GENERATE THE OPCODES\n//========================================================================\nfunc generateOpCode(opCode chan int){\n    opCode &lt;- rand.Intn(maxNumber) + 1  //Generate the random number with consistent sequence\n}\n//========================================================================\n//                          DISPATCH THE OPCODE\n//========================================================================\nfunc dispatchOpCode(opCode chan int, toPipeline []chan int, nextPipeline []chan bool){\n    tempPipeline := 0   //Temporary for choosing which pipeline\n    select{     //Assign the OP Code to the ready pipeline, and pass the OP Code to the selected pipeline\n        case &lt;- nextPipeline[0] : toPipeline[0] = opCode ; tempPipeline = 0\n        case &lt;- nextPipeline[1] : toPipeline[1] = opCode ; tempPipeline = 1\n        case &lt;- nextPipeline[2] : toPipeline[2] = opCode ; tempPipeline = 2\n    }\n    fmt.Println(\"Op Code :\",&lt;-opCode,\" To Pipeline :\",tempPipeline)\n}\n//========================================================================\n//               PROCESS THE PIPELINE TO RETIRE FUNCTION\n//========================================================================\nfunc pipelineProcess(fromDispatcher chan int, retireOpCode chan int,nextPipeline chan bool){\n    retireOpCode = fromDispatcher   //Pass the opCode to the retire Op Code\n    nextPipeline &lt;- true            //Tell the pipeline used it's finished\n}\n//========================================================================\n//                          RETIRE THE OP CODE\n//========================================================================\nfunc retiredOpCode(fromPipeline []chan int){\n    tempPipeline := 0   //Temporary for choosing which pipeline used\n    select{     //Read the retired code from selected pipeline and assign the used pipeline\n        case opCodes :=&lt;- fromPipeline[0] : tempPipeline = 0 ; fmt.Println(\"Complete :\",opCodes,\" By Pipeline :\",tempPipeline)\n        case opCodes :=&lt;- fromPipeline[1] : tempPipeline = 1 ; fmt.Println(\"Complete :\",opCodes,\" By Pipeline :\",tempPipeline)\n        case opCodes :=&lt;- fromPipeline[2] : tempPipeline = 2 ; fmt.Println(\"Complete :\",opCodes,\" By Pipeline :\",tempPipeline)\n    }\n\n}\n//========================================================================\n//                              MAIN FUNCTION\n//========================================================================\nfunc main(){\n    //=============== Create Channels ===============\n    opCode := make(chan int,1)\n    toPipeline := make([]chan int, maxPipeline)\n    for i:= range toPipeline{\n        toPipeline[i] = make(chan int)\n    }\n    fromPipeline := make([]chan int, maxPipeline)\n    for i:= range fromPipeline{\n        fromPipeline[i] = make(chan int)\n    }\n    nextPipeline := make([]chan bool, maxPipeline)\n    for i:= range nextPipeline{\n        nextPipeline[i] = make(chan bool)\n    }\n    //=============== Main Go Routine ===============\n    for j:=0;j&lt;totalNumber;j++{\n        go generateOpCode(opCode)\n        go dispatchOpCode(opCode, toPipeline, nextPipeline)\n        for i:=0;i&lt;maxPipeline;i++{\n            go pipelineProcess(toPipeline[i],fromPipeline[i],nextPipeline[i])\n        }\n        go retiredOpCode(fromPipeline)\n        go fmt.Println(\"=========================================\")\n    }\n    delayTime(1000)\n}\n</code></pre>\n\n<p>To be honest, i don't really know why the Print is not working. For example the print in the dispatchOpCode, it won't work if i change the Main Go Routine into this : </p>\n\n<pre><code>for j:=0;j&lt;totalNumber;j++{\n        go generateOpCode(opCode)\n        go dispatchOpCode(opCode, toPipeline, nextPipeline)\n        go fmt.Println(\"=========================================\")\n    }\n</code></pre>\n\n<p>Does anyone know why it doesn't work ? or explain about this with the corrected code ? Thank you !</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": true, "score": 12, "last_activity_date": 1476944714, "last_edit_date": 1476944714, "creation_date": 1463192329, "answer_id": 37221785, "question_id": 37221456, "link": "https://stackoverflow.com/questions/37221456/why-can-i-assign-a-value-of-different-type-to-a-variable/37221785#37221785", "title": "Why can I assign a value of different type to a variable?", "body": "<p>I'll refer you to the <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow\">spec</a> and excerpt the most meaningful lines here:</p>\n\n<blockquote>\n  <p>A value x is assignable to a variable of type T (\"x is assignable to T\") in any of these cases:</p>\n  \n  <p>...</p>\n  \n  <ul>\n  <li>x's type V and T have identical underlying types and at least one of V or T is not a named type. </li>\n  </ul>\n</blockquote>\n\n<p>In your example the underlying type is <code>[]int</code> for each case and <code>[]int</code> is not a named type but a slice. An <code>int</code> would actually constitute a named type (predeclared in the universe block) and would have itself as an underlying type, but <code>[]int</code> is not a named type as detailed <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>Named instances of the boolean, numeric, and string types are\n  predeclared. Composite types\u2014array, struct, pointer, function,\n  interface, slice, map, and channel types\u2014may be constructed using type\n  literals.</p>\n  \n  <p>Each type T has an underlying type: If T is one of the predeclared\n  boolean, numeric, or string types, or a type literal, the\n  corresponding underlying type is T itself. Otherwise, T's underlying\n  type is the underlying type of the type to which T refers in its type\n  declaration.</p>\n</blockquote>\n\n<p>Therefore if you tried making <code>type X int</code> you would <em>not</em> be able to assign it to <code>var v int</code> as <code>int</code> is a named type and would not satisfy the assignability criteria given in the spec.</p>\n"}], "owner": {"reputation": 26911, "user_id": 225262, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/10f7602ff38f6486cb1580052746fc05?s=128&d=identicon&r=PG", "display_name": "satoru", "link": "https://stackoverflow.com/users/225262/satoru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 2, "accepted_answer_id": 37221785, "answer_count": 1, "score": 13, "last_activity_date": 1476944714, "creation_date": 1463188687, "question_id": 37221456, "link": "https://stackoverflow.com/questions/37221456/why-can-i-assign-a-value-of-different-type-to-a-variable", "title": "Why can I assign a value of different type to a variable?", "body": "<p>In the book \"Go in Action\", the author wrote \"Values of two different types can\u2019t be assigned to each other, even if they\u2019re compatible\".</p>\n\n<p>For example, we can't assign <code>Duration</code> to <code>int64</code> or <code>int64</code> to <code>Duration</code>.</p>\n\n<p>But this is not always true, the following assignment would work like the <code>X</code> value is converted back to <code>[]int</code> automatically:</p>\n\n<pre><code>type X []int\nvar v []int = X([]int{1, 2, 3})\n</code></pre>\n\n<p>What's the difference between these two situations?</p>\n"}, {"tags": ["go", "cassandra"], "answers": [{"comments": [{"owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "edited": false, "score": 0, "creation_date": 1463196142, "post_id": 37222132, "comment_id": 61974777, "body": "No I figured it out. For some reason csession is not seen by the other functions. So I moved csession inside main, and then pass the pointer as a paramenter to the other functions."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "edited": false, "score": 0, "creation_date": 1463196311, "post_id": 37222132, "comment_id": 61974801, "body": "<code>csession</code> should be visible anywhere in the package."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1463198369, "last_edit_date": 1463198369, "creation_date": 1463196006, "answer_id": 37222132, "question_id": 37221249, "link": "https://stackoverflow.com/questions/37221249/insert-in-cassandra-is-returning-null-pointer-error/37222132#37222132", "title": "Insert in Cassandra is returning null pointer error", "body": "<p>I don't think you want <code>defer csession.Close()</code> where it is. <code>csession.Close()</code> will be called when <code>IntializeCassandra</code>is about to return, so that will happen immediately.</p>\n\n<p>EDIT: I just realized there's another big problem with this code. <code>csession, _ := cluster.CreateSession()</code> creates a local variable named <code>csession</code> which shadows the global variable. You should use <code>=</code> instead of <code>:=</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "is_accepted": false, "score": 0, "last_activity_date": 1463197103, "last_edit_date": 1463197103, "creation_date": 1463196549, "answer_id": 37222196, "question_id": 37221249, "link": "https://stackoverflow.com/questions/37221249/insert-in-cassandra-is-returning-null-pointer-error/37222196#37222196", "title": "Insert in Cassandra is returning null pointer error", "body": "<p>There are two problems with code:\nYou should check for error here. If it fails, the don't proceed</p>\n\n<pre><code>csession, err := cluster.CreateSession()\nif err != nil {\n     log.Fatal(err)\n}\n</code></pre>\n\n<p>Also you don't need defer session.Close() or session.Close() as it will invalidate and close your connection. Write defer session.Close() in main after returning session from IntializeCassandra to main(). Also you should have a global variable called Csession which can be used anywhere</p>\n"}], "owner": {"reputation": 5898, "user_id": 817659, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dc6960319324ecebe786580dfca13f07?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/817659/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1463198369, "creation_date": 1463186532, "last_edit_date": 1463190719, "question_id": 37221249, "link": "https://stackoverflow.com/questions/37221249/insert-in-cassandra-is-returning-null-pointer-error", "title": "Insert in Cassandra is returning null pointer error", "body": "<p>Using Cassandra as follows to insert data, I am worried that the stuff that is initialized in <code>IntializeCassandra</code> is no longer around? </p>\n\n<pre><code>var csession gocql.Session \n\nfunc IntializeCassandra(){\n    fmt.Println(\"Intializing Cassandra\")\n    cluster := gocql.NewCluster(\"10.0.0.60\")\n    cluster.Keyspace = \"tickdata\"\n    cluster.Consistency = gocql.Quorum\n    csession, _ := cluster.CreateSession()\n    defer csession.Close()\n}\n\nfunc main() {\n    IntializeCassandra()\n}\n</code></pre>\n\n<p>Later in a function callback, when I try to insert the data into cassandra, I get a null pointer error</p>\n\n<pre><code>func msgHandler(src *net.UDPAddr, n int, b []byte) {\n    t := time.Now().UTC()\n    tformat := t.Format(\"2006-01-02 15:04:05\")\n    md := &amp;MarketData.MD{}\n    proto.Unmarshal(b[:n], md)\n    log.Printf(\"%d %d %d %d %s %.5f %.5f\", md.Firm, md.Symbol, md.Expiry, md.Id, tformat, md.Bid, md.Ask)\n    if err := csession.Query(`INSERT INTO timeseries (firm, symbol, expiry, quote_id, time, bid, ask) VALUES (?, ?, ?, ?, ?, ?, ?)`,\n         md.Firm, md.Symbol, md.Expiry, md.Id, tformat, md.Bid, md.Ask).Exec(); err != nil {\n         log.Fatal(err)\n    }\n\n\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x594687]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 72581, "user_id": 44852, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JbQbc.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/44852/tarik"}, "edited": false, "score": 0, "creation_date": 1463184803, "post_id": 37221028, "comment_id": 61972879, "body": "But for some reason I feel like this answer is lacking. For instance, what happens when I use it on a struct? And not sure what it returning pointer using new has anything to do with my question? Sorry, perhaps I am not getting it yet."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 72581, "user_id": 44852, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JbQbc.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/44852/tarik"}, "edited": false, "score": 0, "creation_date": 1463186874, "post_id": 37221028, "comment_id": 61973256, "body": "@Tarik new returns a pointer, that is its function, it&#39;s the equivalent of <code>&amp;type{}</code>. You can&#39;t use make on a struct."}, {"owner": {"reputation": 72581, "user_id": 44852, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JbQbc.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/44852/tarik"}, "edited": false, "score": 0, "creation_date": 1463202252, "post_id": 37221028, "comment_id": 61975782, "body": "Thanks for your answer. It led me to the one I figured finally."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 5, "last_activity_date": 1463184353, "creation_date": 1463184353, "answer_id": 37221028, "question_id": 37220877, "link": "https://stackoverflow.com/questions/37220877/difference-between-initialization-and-zeroing-and-new-and-make-in-golang/37221028#37221028", "title": "Difference between initialization and zeroing, and new() and make() in GoLang", "body": "<p><code>new</code> returns a pointer to the type, and it's the only way to return a pointer to a native type in one step (aka int, float, complex):</p>\n\n<pre><code>intPtr := new(int)\n// or\nvar i int\nintPtr := &amp;i\n</code></pre>\n\n<p><code>make</code> is for initializing channels, slices and maps.</p>\n\n<p>All variables are zeroed on creation, regardless of how you create them. </p>\n\n<p>The spec about make: <a href=\"https://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"noreferrer\">https://golang.org/ref/spec#Making_slices_maps_and_channels</a></p>\n\n<p>The spec about zero value: <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">https://golang.org/ref/spec#The_zero_value</a></p>\n"}, {"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 2, "creation_date": 1463247028, "post_id": 37222760, "comment_id": 61989366, "body": "new does NOT zero anything, it simply returns a pointer to the type, all types are zeroed by default: <code>var t Type</code> is zeroed, <code>t := &amp;Type{}</code> or <code>var t Type; ptr := &amp;t</code> is the same as <code>t := new(Type)</code>, but the type is zeroed before new returns the pointer."}, {"owner": {"reputation": 72581, "user_id": 44852, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JbQbc.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/44852/tarik"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1518503338, "post_id": 37222760, "comment_id": 84521821, "body": "@OneOfOne: After some time, your comment started making sense :) Thanks."}], "tags": [], "owner": {"reputation": 72581, "user_id": 44852, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JbQbc.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/44852/tarik"}, "is_accepted": true, "score": 10, "last_activity_date": 1463203956, "last_edit_date": 1463203956, "creation_date": 1463202194, "answer_id": 37222760, "question_id": 37220877, "link": "https://stackoverflow.com/questions/37220877/difference-between-initialization-and-zeroing-and-new-and-make-in-golang/37222760#37222760", "title": "Difference between initialization and zeroing, and new() and make() in GoLang", "body": "<p>I think I have figured it and decided to share what I figured so far. </p>\n\n<h2><code>make()</code> vs. <code>new()</code></h2>\n\n<p>I think I now understand the difference between <code>make()</code> and <code>new()</code>. At first, it was little confusing, but here what I got:</p>\n\n<p><code>new</code> is simply like <code>new</code> in C# or Java, but since there is no constructor in Go, all the fields (like in Java and C# terminology) will be zeroed. Zeroing means more like defaulting the fields. So if the field type is <code>int</code>, then it will be <code>0</code>, or if it is a <code>struct</code>, then it will be defaulted to <code>nil</code>, and <code>\"\"</code> for <code>string</code> types. It is actually similar to C# and Java when there is only parameterless constructor available and you are not setting the members to something else manually.</p>\n\n<p>However, types like <code>map</code>, <code>slice</code>, and <code>channel</code>s are different. They are different because they are actually wrapper types that wrap an array type to hold the values behind the scenes. So something like <code>List&lt;T&gt;</code> or <code>ArrayList</code> in C# and Java. But using <code>new</code> is not enough in this situation, because the underlying array should be initialized to an empty array to be usable. Because you cannot add or remove from a field of type array which is <code>nil</code> (or <code>null</code>). Therefore, they provided a <code>make()</code> method to help you to initialize <code>slices</code> and such.</p>\n\n<p>So what happens when you use <code>new()</code> over slices, for instance? Simple: Since the underlying array will be <code>nil</code>, the slice will be pointing at a <code>nil</code> array.</p>\n\n<p>So <code>new()</code> would look like the following C#/Java code:</p>\n\n<pre><code>public class Person{\n   public string Name;\n   public int Age;\n   public Address HomeAddress;\n}\n\nvar person = new Person();\nConsole.WriteLine(person.Name); // \"\"\nConsole.WriteLine(person.Age); // 0\nConsole.WriteLine(person.HomeAddress); // null\n</code></pre>\n\n<p><code>make()</code>, on the other hand, would look like this for <code>slice</code>,<code>map</code>, and <code>channel</code>s:</p>\n\n<pre><code>public class PersonList{\n   // We are initializing the array so that we can use it.\n   // Its capacity can increase.\n   private Person[] _personList = new Person[100];\n   public void Add(Person p){}\n   public void Remove(Person p){}\n   public Person Get(int index){}\n}\n</code></pre>\n\n<h2>Initialization vs. Zeroing</h2>\n\n<p>Simply speaking, zeroing is a form of initialization. At first, I thought they were different but they are not. Initialization is a more general term, whereas if you are set the fields (properties, etc.) of a struct or a variable to its type default such as <code>0</code>, <code>nil</code>, <code>\"\"</code>, <code>false</code>, etc., then this is called zeroing. However, you can, for instance, use <a href=\"https://golang.org/doc/effective_go.html#composite_literals\" rel=\"noreferrer\">Composite Literals</a> like <code>hello := Hello{name=\"world\"}</code>, which is similar to <code>var hello = new Hello() {Name = \"World\"}</code> in C#, then you initialize your <code>Hello</code> object with a <code>name</code> field set to <code>world</code>.</p>\n\n<p>In C#, at the time you say <code>new List&lt;string&gt;()</code>, [the underlying array field is initialized to a new array], and <code>make)</code> is performing a similar operation behind the scenes but as a language construct (built in the language itself):</p>\n\n<p>(<a href=\"http://referencesource.microsoft.com/#mscorlib/system/collections/generic/list.cs,cf7f4095e4de7646\" rel=\"noreferrer\">http://referencesource.microsoft.com/#mscorlib/system/collections/generic/list.cs,cf7f4095e4de7646</a>):</p>\n\n<p><a href=\"https://i.stack.imgur.com/roasO.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/roasO.png\" alt=\"enter image description here\"></a></p>\n\n<p>So <code>new</code> does zeroing and returns a pointer back. Whereas <code>make()</code> initializes to underlying array to an array with default values for each element and returns the value itself rather than a pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 308, "user_id": 5309272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvVBS.jpg?s=128&g=1", "display_name": "Rishabh Rawat", "link": "https://stackoverflow.com/users/5309272/rishabh-rawat"}, "is_accepted": false, "score": 1, "last_activity_date": 1593549801, "creation_date": 1593549801, "answer_id": 62665850, "question_id": 37220877, "link": "https://stackoverflow.com/questions/37220877/difference-between-initialization-and-zeroing-and-new-and-make-in-golang/62665850#62665850", "title": "Difference between initialization and zeroing, and new() and make() in GoLang", "body": "<p><code>new(T)</code> allocates zeroed storage for a new item of type T and returns its address, a value of type *T: it returns a pointer to a newly allocated zero value of type T, ready for use; it applies to value types like arrays and structs. It is\nequivalent to &amp;T{ }</p>\n<p><code>make(T)</code> returns an initialized value of type T; it applies only to the 3 built-in\nreference types: slices, maps, and channels.</p>\n<pre><code>var p *[]int = new([]int) // *p == nil; with len and cap 0\n//or    \np := new([]int)\n\nvar v []int = make([]int, 10, 50)\n//or\nv := make([]int, 10, 50)\n\n//This allocates an array of 50 ints and then creates a slice v with length 10 and capacity 50 pointing\n//to the first 10 elements of the array\n</code></pre>\n"}], "owner": {"reputation": 72581, "user_id": 44852, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JbQbc.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/44852/tarik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2251, "favorite_count": 2, "accepted_answer_id": 37222760, "answer_count": 3, "score": 9, "last_activity_date": 1593549801, "creation_date": 1463182992, "last_edit_date": 1463204021, "question_id": 37220877, "link": "https://stackoverflow.com/questions/37220877/difference-between-initialization-and-zeroing-and-new-and-make-in-golang", "title": "Difference between initialization and zeroing, and new() and make() in GoLang", "body": "<p>I am coming from C# background, and I am little confused with the way of GoLang initialization and zeroing definitions. I think you can guess that this confusion arises from <code>make()</code> and <code>new()</code> functions in Go. What should I expect happening internally when these methods run? What happens when initialization and zeroing happens? </p>\n\n<p>I know that there is an <code>init()</code> function in GoLang that is used to initialize packages. But I think it is different than this. </p>\n\n<p>Anyways, what is the difference between them?</p>\n\n<h1>Update</h1>\n\n<p>I answered my own question, please check it to see my answer.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1463171791, "post_id": 37218930, "comment_id": 61968923, "body": "packes are referenced by import path, and the go tools work with packages."}], "answers": [{"tags": [], "owner": {"reputation": 742, "user_id": 717318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13e99fc7225ca378040ef36ef1a3049e?s=128&d=identicon&r=PG", "display_name": "Kevin Deenanauth", "link": "https://stackoverflow.com/users/717318/kevin-deenanauth"}, "is_accepted": true, "score": 7, "last_activity_date": 1463174187, "creation_date": 1463174187, "answer_id": 37219455, "question_id": 37218930, "link": "https://stackoverflow.com/questions/37218930/why-cant-go-build-from-absolute-path/37219455#37219455", "title": "Why can&#39;t go build from absolute path?", "body": "<p>JimB is correct, packages are relative to the import path. There is no capability to import 'absolutely'.</p>\n\n<p>While it is not spelled out specifically in the spec, it does allude to it at <a href=\"https://golang.org/ref/spec#ImportPath\" rel=\"noreferrer\">https://golang.org/ref/spec#ImportPath</a>:</p>\n\n<blockquote>\n  <p>The interpretation of the ImportPath is implementation-dependent but it is typically a substring of the full file name of the compiled package and may be relative to a repository of installed packages.</p>\n</blockquote>\n\n<p>There are variations on relative importing and vendoring that might work for you (see GO 1.5 vendoring experiment, now available in 1.6 <a href=\"https://docs.google.com/document/d/1Bz5-UB7g2uPBdOx-rw5t9MxJwkfpx90cqG9AFL0JAYo/edit?pref=2&amp;pli=1\" rel=\"noreferrer\">https://docs.google.com/document/d/1Bz5-UB7g2uPBdOx-rw5t9MxJwkfpx90cqG9AFL0JAYo/edit?pref=2&amp;pli=1</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 454, "user_id": 2951942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d7798ac2262adeeed8f1399f7b08ac7f?s=128&d=identicon&r=PG", "display_name": "Kareem", "link": "https://stackoverflow.com/users/2951942/kareem"}, "is_accepted": false, "score": 3, "last_activity_date": 1527434068, "creation_date": 1527434068, "answer_id": 50553582, "question_id": 37218930, "link": "https://stackoverflow.com/questions/37218930/why-cant-go-build-from-absolute-path/50553582#50553582", "title": "Why can&#39;t go build from absolute path?", "body": "<p>I came here to find an answer to the same question, as I was doing the same thing and found there are two ways to do this... </p>\n\n<p>so I thought I would share:</p>\n\n<p>Run from within the package directory:</p>\n\n<pre><code>cd $GOPATH/src/github.com/docker/swarm\ngo install .\n</code></pre>\n\n<p>and as a relative repo:</p>\n\n<pre><code>go install github.com/docker/swarm\n</code></pre>\n\n<p>There are some details in the official go docs <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 2230, "user_id": 1503683, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VWIKJ.jpg?s=128&g=1", "display_name": "PierreF", "link": "https://stackoverflow.com/users/1503683/pierref"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17812, "favorite_count": 2, "accepted_answer_id": 37219455, "answer_count": 2, "score": 18, "last_activity_date": 1527434068, "creation_date": 1463171649, "last_edit_date": 1463171799, "question_id": 37218930, "link": "https://stackoverflow.com/questions/37218930/why-cant-go-build-from-absolute-path", "title": "Why can&#39;t go build from absolute path?", "body": "<p>For some reason, I want to build a go project (docker swarm) from source, following the <a href=\"https://github.com/docker/swarm/blob/master/CONTRIBUTING.md\" rel=\"noreferrer\">official doc</a>. </p>\n\n<p>It works well if I do:</p>\n\n<pre><code>...\ncd $GOPATH/src/github.com/docker/swarm\ngo install .\n</code></pre>\n\n<p>But it fails if I try to \"one-line\" it and avoid <code>cd</code>:</p>\n\n<pre><code>go install $GOPATH/src/github.com/docker/swarm\n\nERROR: can't load package: \npackage &lt;my go path&gt;/src/github.com/docker/swarm: \nimport \"&lt;my go path&gt;/src/github.com/docker/swarm\": \ncannot import absolute path\n</code></pre>\n\n<p>Why can't go deal with this absolute path?</p>\n"}, {"tags": ["go", "compilation", "travis-ci"], "answers": [{"tags": [], "owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "is_accepted": true, "score": 1, "last_activity_date": 1463191900, "creation_date": 1463191900, "answer_id": 37221740, "question_id": 37218885, "link": "https://stackoverflow.com/questions/37218885/travis-ci-go-cant-build/37221740#37221740", "title": "Travis CI + Go: can&#39;t build", "body": "<p>Looking at <a href=\"https://github.com/weldpua2008/deployer\" rel=\"nofollow\">https://github.com/weldpua2008/deployer</a>, it does have a <code>deployer</code> directory at the root. When you issue <code>go build  example/myproduct/deployer/deployer.go</code> it tries to create a file called <code>deployer</code> but fails because the directory already exists.</p>\n"}], "owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 37221740, "answer_count": 1, "score": 1, "last_activity_date": 1463191900, "creation_date": 1463171406, "question_id": 37218885, "link": "https://stackoverflow.com/questions/37218885/travis-ci-go-cant-build", "title": "Travis CI + Go: can&#39;t build", "body": "<p>My <a href=\"https://github.com/weldpua2008/deployer/blob/master/.travis.yml\" rel=\"nofollow\">.travis.yml</a> is:</p>\n\n<pre><code>language: go\ngo:\n  - 1.5\ninstall:\n  - go get github.com/tools/godep\n  - godep restore\nbranches:\n  only:\n  - master\nscript:\n  - go build  example/myproduct/deployer/deployer.go\nnotifications:\n  email: false\n</code></pre>\n\n<p>And <a href=\"https://travis-ci.org/weldpua2008/deployer/builds/130099695\" rel=\"nofollow\">it failed</a> with this error:</p>\n\n<pre><code>go build  example/myproduct/deployer/deployer.go    \ngo install command-line-arguments: build output \"deployer\" already exists and is a directory    \nThe command \"go build  example/myproduct/deployer/deployer.go\" exited with 1.    \nDone. Your build exited with 1.\n</code></pre>\n\n<p>I have <a href=\"https://github.com/weldpua2008/deployer/blob/master/Vagrantfile#L7\" rel=\"nofollow\">VagrantFile where it's ok</a>:</p>\n\n<pre><code>go get github.com/tools/godep\ncd /opt/gopath/src/github.com/dorzheh/deployer\ngodep restore\nln -s  /opt/gopath/src/github.com/dorzheh/deployer/example/myproduct/ /home/vagrant/example\ncd /home/vagrant/\ngo build  /home/vagrant/example/deployer/deployer.go\n</code></pre>\n"}, {"tags": ["go", "speech-recognition", "speech-to-text", "speech"], "comments": [{"owner": {"reputation": 1616, "user_id": 1004331, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/84dd3640fe566a329afec588448da697?s=128&d=identicon&r=PG", "display_name": "astromme", "link": "https://stackoverflow.com/users/1004331/astromme"}, "edited": false, "score": 0, "creation_date": 1483207656, "post_id": 37218558, "comment_id": 70024591, "body": "I&#39;m researching the same thing. One option is to roll your own neural network using something like tensorflow and following this paper: <a href=\"https://papers.nips.cc/paper/3674-unsupervised-feature-learning-for-audio-classification-using-convolutional-deep-belief-networks.pdf\" rel=\"nofollow noreferrer\">papers.nips.cc/paper/&hellip;</a>"}, {"owner": {"reputation": 1616, "user_id": 1004331, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/84dd3640fe566a329afec588448da697?s=128&d=identicon&r=PG", "display_name": "astromme", "link": "https://stackoverflow.com/users/1004331/astromme"}, "edited": false, "score": 0, "creation_date": 1483208053, "post_id": 37218558, "comment_id": 70024681, "body": "A python solution would be <a href=\"https://github.com/tyiannak/pyAudioAnalysis/\" rel=\"nofollow noreferrer\">github.com/tyiannak/pyAudioAnalysis</a>"}], "owner": {"reputation": 5427, "user_id": 721386, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/990a96e6875ad1319af43b61b8d090b7?s=128&d=identicon&r=PG", "display_name": "Dustin", "link": "https://stackoverflow.com/users/721386/dustin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1463169999, "creation_date": 1463169999, "question_id": 37218558, "link": "https://stackoverflow.com/questions/37218558/speech-hotword-to-active-listening-with-google-speech-api", "title": "Speech hotword to active listening with Google Speech API", "body": "<p>I'm currently in the works of building a small app with <a href=\"https://cloud.google.com/speech/\" rel=\"nofollow\">Googles Speech API Alpha</a> and am trying to find a solid solution for creating a \"hotword\". Essentially I don't to be constantly sending recorded data to Google to wait for a hotword, nor do I want to have to physically press a button to active listening. Are there any offline speech to text solutions that can be usable to listen for that single word before it starts recording data to send to Google?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1463163894, "post_id": 37216896, "comment_id": 61964931, "body": "I am not using any of them. How would I use them in this case?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463163902, "post_id": 37216896, "comment_id": 61964937, "body": "You&#39;re marshaling the raw bytes returned from redis. You don&#39;t need to marshal what is already json."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463164762, "post_id": 37216896, "comment_id": 61965404, "body": "Then how can I output an array of those json strings in the response? I can&#39;t help thinking that I have to convert those interface types and do some looping."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463164930, "post_id": 37216896, "comment_id": 61965477, "body": "I updated my post, it worked in the end but I don&#39;t think this is a good idea what I&#39;m doing with all the conversions. Do you know of any better way?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463165124, "post_id": 37216896, "comment_id": 61965593, "body": "Or just use the <a href=\"https://godoc.org/github.com/garyburd/redigo/redis#Strings\" rel=\"nofollow noreferrer\"><code>redis.Strings</code></a> convenience function to do it for you"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463165317, "post_id": 37216896, "comment_id": 61965695, "body": "Then I get: redigo: unexpected type for String, got type []interface {}"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1463165404, "post_id": 37216896, "comment_id": 61965739, "body": "Oh sorry, Strings and not string. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1463206173, "post_id": 37217769, "comment_id": 61976657, "body": "Thanks that was cleaner."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1463167140, "creation_date": 1463167140, "answer_id": 37217769, "question_id": 37216896, "link": "https://stackoverflow.com/questions/37216896/getting-weird-results-when-json-marshalling-interface-byte-slices/37217769#37217769", "title": "Getting weird results when JSON marshalling interface byte slices", "body": "<p>The function <code>ByUserId</code> can be written as:</p>\n\n<pre><code>func ByUserId(userId int64, pool *redis.Pool) ([]string, error) {\n  key := fmt.Sprintf(\"user:%d:notification\", userId)\n  c := pool.Get()\n  defer c.Close()\n  return redis.Strings(c.Do(\"ZREVRANGE\", key, 0, -1))\n}\n</code></pre>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 37217769, "answer_count": 1, "score": 1, "last_activity_date": 1463167140, "creation_date": 1463163728, "last_edit_date": 1463164893, "question_id": 37216896, "link": "https://stackoverflow.com/questions/37216896/getting-weird-results-when-json-marshalling-interface-byte-slices", "title": "Getting weird results when JSON marshalling interface byte slices", "body": "<p>I am working with Redigo Redis library and trying to json.Marshal the result I get from a sorted set but I get results such as this:</p>\n\n<pre><code>\"eyJmcm9tSWQiOjEsInRvSWQiOjUsInR5cGUiOjMsInBvc3RJZCI6MSwiY29tbWVudElkIjo0NCwiY3JlYXRlZFRpbWUiOjE0NjMxNTY0ODQsImlzVmlld2VkIjpmYWxzZSwidXNlcm5hbWUiOiJBZG1pbiIsImltYWdlIjoiaHc2ZE5EQlQtMzZ4MzYuanBnIn0=\"\n</code></pre>\n\n<p>When I should be getting this:</p>\n\n<pre><code>\"{\"fromId\":5,\"toId\":1,\"type\":3,\"postId\":4,\"commentId\":49,\"createdTime\":1463161736,\"isViewed\":false,\"username\":\"Alexander\",\"image\":\"JZIfHp8i-36x36.png\"}\"\n</code></pre>\n\n<p>I have a Notification struct</p>\n\n<pre><code>type Notification struct {\n    FromId int64 `json:\"fromId\"`\n    ToId   int64 `json:\"toId\"`\n    OfType int64 `json:\"type\"`\n\n    PostId       int64  `json:\"postId\"`\n    CommentId    int64  `json:\"commentId\"`\n    CreatedTime  int64  `json:\"createdTime\"`\n    IsViewed     bool   `json:\"isViewed\"`\n    FromUsername string `json:\"username\"`\n    FromImage    string `json:\"image\"`\n}\n\nfunc New() *Notification {\n    return &amp;Notification{\n        CreatedTime: time.Now().Unix(),\n    }\n}\n</code></pre>\n\n<p>It has a method that saves a string of json into a Redis sorted set.</p>\n\n<pre><code>func (n *Notification) Create(pool *redis.Pool, multicast chan&lt;- []byte) error {\n    var err error\n    n.FromUsername, err = validation.FilterUsername(n.FromUsername)\n    if err != nil {\n        return err\n    }\n    // We can use the same validation as for a username here.\n    n.FromImage, err = validation.FilterUsername(n.FromImage)\n    if err != nil {\n        return err\n    }\n    key := fmt.Sprintf(\"user:%d:notification\", n.ToId)\n    b, err := json.Marshal(n)\n    if err != nil {\n        return err\n    }\n    c := pool.Get()\n    defer c.Close()\n    c.Send(\"ZADD\", key, n.CreatedTime, string(b))\n    // Limiting to the top ranked 50 items.\n    c.Send(\"ZREMRANGEBYRANK\", key, 0, -50)\n    if err := c.Flush(); err != nil {\n        return err\n    }\n    multicast &lt;- b\n    return nil\n}\n</code></pre>\n\n<p>This works all good. But then I want to fetch those results and send then to the client side as an array of json formatted strings. The same json formatted strings that I save in the sorted set.</p>\n\n<p>I am doing something simple like this.</p>\n\n<pre><code>func ByUserId(userId int64, pool *redis.Pool) (interface{}, error) {\n    key := fmt.Sprintf(\"user:%d:notification\", userId)\n    c := pool.Get()\n    defer c.Close()\n    c.Send(\"ZREVRANGE\", key, 0, -1)\n    c.Flush()\n    return c.Receive()\n}\n</code></pre>\n\n<p>But it does not work.</p>\n\n<p>When I json.Marshal the result I get an array of strings like this:</p>\n\n<pre><code>\"eyJmcm9tSWQiOjEsInRvSWQiOjUsInR5cGUiOjMsInBvc3RJZCI6MSwiY29tbWVudElkIjo0NCwiY3JlYXRlZFRpbWUiOjE0NjMxNTY0ODQsImlzVmlld2VkIjpmYWxzZSwidXNlcm5hbWUiOiJBZG1pbiIsImltYWdlIjoiaHc2ZE5EQlQtMzZ4MzYuanBnIn0=\"\n</code></pre>\n\n<p>If I spew.Dump() the results I get this output:</p>\n\n<pre><code>([]interface {}) (len=1 cap=1) {\n ([]uint8) (len=149 cap=149) {\n  00000000  7b 22 66 72 6f 6d 49 64  22 3a 35 2c 22 74 6f 49  |{\"fromId\":5,\"toI|\n  00000010  64 22 3a 31 2c 22 74 79  70 65 22 3a 33 2c 22 70  |d\":1,\"type\":3,\"p|\n  00000020  6f 73 74 49 64 22 3a 34  2c 22 63 6f 6d 6d 65 6e  |ostId\":4,\"commen|\n  00000030  74 49 64 22 3a 34 39 2c  22 63 72 65 61 74 65 64  |tId\":49,\"created|\n  00000040  54 69 6d 65 22 3a 31 34  36 33 31 36 31 37 33 36  |Time\":1463161736|\n  00000050  2c 22 69 73 56 69 65 77  65 64 22 3a 66 61 6c 73  |,\"isViewed\":fals|\n  00000060  65 2c 22 75 73 65 72 6e  61 6d 65 22 3a 22 53 74  |e,\"username\":\"Al|\n  00000070  61 72 64 75 73 6b 22 2c  22 69 6d 61 67 65 22 3a  |exander\",\"image\":|\n  00000080  22 4a 5a 49 66 48 70 38  69 2d 33 36 78 33 36 2e  |\"JZIfHp8i-36x36.|\n  00000090  70 6e 67 22 7d                                    |png\"}|\n }\n}\n</code></pre>\n\n<p>What can I do?</p>\n\n<p>EDIT:</p>\n\n<p>This is what I did in the end but it feels like alot of unnecessary conversion.</p>\n\n<pre><code>func ByUserId(userId int64, pool *redis.Pool) ([]string, error) {\n    key := fmt.Sprintf(\"user:%d:notification\", userId)\n    c := pool.Get()\n    defer c.Close()\n    c.Send(\"ZREVRANGE\", key, 0, -1)\n    c.Flush()\n    reply, err := c.Receive()\n    if err != nil {\n        return nil, nil\n    }\n    arr, ok := reply.([]interface{})\n    if !ok {\n        return nil, err\n    }\n    ss := []string{}\n    for _, v := range arr {\n        b, ok := v.([]byte)\n        if !ok {\n            return nil, nil\n        }\n        ss = append(ss, string(b))\n    }\n    return ss, nil\n}\n</code></pre>\n\n<p>And on the handle:</p>\n\n<pre><code>func notifications(w http.ResponseWriter, r *http.Request, _ httprouter.Params) error {\n    userId, err := user.LoggedIn(r)\n    if err != nil {\n        return unauthorized\n    }\n    jsonResp := make(map[string]interface{})\n    jsonResp[\"notifications\"], err = notification.ByUserId(userId, redisPool)\n    if err != nil {\n        return err\n    }\n    jsonResp[\"success\"] = true\n    b, err := json.Marshal(jsonResp)\n    if err != nil {\n        return err\n    }\n    w.Write(b)\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594258395, "post_id": 37210379, "comment_id": 111065748, "body": "<code>byte(i)</code> or <code>[]byte(string(i))</code> to set an int to a byte. See <a href=\"https://stackoverflow.com/a/62737936/12817546\">stackoverflow.com/a/62737936/12817546</a>. <code>strconv.Atoi(s)</code> and <code>byte(i)</code> to set a string to a byte. See <a href=\"https://stackoverflow.com/a/62740786/12817546\">stackoverflow.com/a/62740786/12817546</a>. <code>int(b)</code> or <code>int(b[0])</code> to set a byte to an int. See <a href=\"https://stackoverflow.com/a/62725637/12817546\">stackoverflow.com/a/62725637/12817546</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "is_accepted": true, "score": 16, "last_activity_date": 1463149378, "last_edit_date": 1463149378, "creation_date": 1463143826, "answer_id": 37210523, "question_id": 37210379, "link": "https://stackoverflow.com/questions/37210379/convert-int-to-a-single-byte-in-go/37210523#37210523", "title": "Convert int to a single byte in Go", "body": "<p>You can just convert an int to a byte: <a href=\"https://play.golang.org/p/w0uBGiYOKP\" rel=\"noreferrer\">https://play.golang.org/p/w0uBGiYOKP</a></p>\n\n\n\n<pre><code>val := \"7\"\ni, _ := strconv.Atoi(val)\nbyteI := byte(i)\nfmt.Printf(\"%v (%T)\", byteI, byteI)\n</code></pre>\n\n<blockquote>\n  <p>compiler complains that i can't do i.(byte)</p>\n</blockquote>\n\n<p>Of course, because that is a type assertion, it <em>will</em> fail if <code>i</code> is not of the given type (<code>byte</code> in your example) or it's not an interface.</p>\n"}, {"tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": false, "score": 4, "last_activity_date": 1463144355, "last_edit_date": 1463144355, "creation_date": 1463144009, "answer_id": 37210583, "question_id": 37210379, "link": "https://stackoverflow.com/questions/37210379/convert-int-to-a-single-byte-in-go/37210583#37210583", "title": "Convert int to a single byte in Go", "body": "<p>In order to use a type assertion (which you're doing), you need to have an interface on the left. You're likely receiving an error along the lines of \"non-interface type byte on left\"-- which is true, because you already know the type. Instead, you should be casting.</p>\n\n<p>You'll want to use byte(i) instead of i.(byte):</p>\n\n<pre><code>i := 12\nc := byte(i)\nfmt.Println(c) //12\n</code></pre>\n\n<p>Be careful when you have an int that exceeds the max int a byte can hold; you will end up overflowing the byte. In this case, if it's over 255 (the most a single byte can hold), you'll overflow.</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 9201650, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fIQRE5tlfKk/AAAAAAAAAAI/AAAAAAAAAp0/O-mnXghzfGc/photo.jpg?sz=128", "display_name": "Inasa Xia", "link": "https://stackoverflow.com/users/9201650/inasa-xia"}, "is_accepted": false, "score": 0, "last_activity_date": 1594955747, "creation_date": 1594955747, "answer_id": 62946544, "question_id": 37210379, "link": "https://stackoverflow.com/questions/37210379/convert-int-to-a-single-byte-in-go/62946544#62946544", "title": "Convert int to a single byte in Go", "body": "<pre class=\"lang-golang prettyprint-override\"><code>    str := &quot;Hello&quot;\n    var b byte\n    for i,_ := range str{\n        b = str[i]\n        fmt.Println(b)\n    }\n</code></pre>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17322, "favorite_count": 1, "accepted_answer_id": 37210523, "answer_count": 3, "score": 4, "last_activity_date": 1594955747, "creation_date": 1463143358, "last_edit_date": 1463339452, "question_id": 37210379, "link": "https://stackoverflow.com/questions/37210379/convert-int-to-a-single-byte-in-go", "title": "Convert int to a single byte in Go", "body": "<p><a href=\"https://github.com/tarm/serial/blob/master/serial.go#L103\" rel=\"nofollow\">https://github.com/tarm/serial/blob/master/serial.go#L103</a></p>\n\n<pre><code>type StopBits byte\ntype Parity byte\n\ntype Config struct {\n    Name        string\n    Baud        int\n    ReadTimeout time.Duration\n    Size byte\n    Parity Parity\n    StopBits StopBits\n}\n</code></pre>\n\n<p>I am trying to flag the command line and fill in the config struct but i can't figure out how to go from int or string to a single byte?</p>\n\n<p>example size 7</p>\n\n<p>Tried</p>\n\n<pre><code>mysize := \"7\"\nmysize[0]\n</code></pre>\n\n<p>but then tarm/serial tells me invalid input error in the serial.Config </p>\n\n<pre><code>i, err := strconv.Atoi(\"7\")\n</code></pre>\n\n<p>compiler complains that i can't do <code>i.(byte)</code></p>\n\n<p>The only way I can make it work is to hardcode <code>size: 7</code> in the config struct.</p>\n"}, {"tags": ["java", "scala", "encryption", "go", "aes"], "comments": [{"owner": {"reputation": 742, "user_id": 717318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13e99fc7225ca378040ef36ef1a3049e?s=128&d=identicon&r=PG", "display_name": "Kevin Deenanauth", "link": "https://stackoverflow.com/users/717318/kevin-deenanauth"}, "edited": false, "score": 1, "creation_date": 1463157335, "post_id": 37210227, "comment_id": 61961480, "body": "Reproduced your code here: <a href=\"https://glot.io/snippets/een965dgb3\" rel=\"nofollow noreferrer\">glot.io/snippets/een965dgb3</a> but still haven&#39;t gotten a java solution working"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 1, "creation_date": 1463160920, "post_id": 37210227, "comment_id": 61963418, "body": "Where is the Java code? Note that CFB mode is used in streaming context: <code>XORKeyStream</code>."}, {"owner": {"reputation": 24358, "user_id": 148869, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FJJTd.jpg?s=128&g=1", "display_name": "SunnyShah", "link": "https://stackoverflow.com/users/148869/sunnyshah"}, "edited": false, "score": 0, "creation_date": 1504413092, "post_id": 37210227, "comment_id": 79000229, "body": "@Ripul Did you find the solution?"}], "answers": [{"comments": [{"owner": {"reputation": 24358, "user_id": 148869, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FJJTd.jpg?s=128&g=1", "display_name": "SunnyShah", "link": "https://stackoverflow.com/users/148869/sunnyshah"}, "edited": false, "score": 0, "creation_date": 1504463691, "post_id": 46023797, "comment_id": 79012747, "body": "Awesome, Thanks a lot!"}, {"owner": {"reputation": 1119, "user_id": 4932661, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qbwhz.jpg?s=128&g=1", "display_name": "Asad", "link": "https://stackoverflow.com/users/4932661/asad"}, "edited": false, "score": 0, "creation_date": 1552320950, "post_id": 46023797, "comment_id": 96955211, "body": "@Hugues Very useful, can you submit the encryption code of java? I mean encrypt from java and decrypt on golang? thanks."}], "tags": [], "owner": {"reputation": 17278, "user_id": 6730571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/63g7E.jpg?s=128&g=1", "display_name": "Hugues M.", "link": "https://stackoverflow.com/users/6730571/hugues-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1504455909, "last_edit_date": 1504455909, "creation_date": 1504444613, "answer_id": 46023797, "question_id": 37210227, "link": "https://stackoverflow.com/questions/37210227/aes-encryption-in-golang-and-decryption-in-java/46023797#46023797", "title": "AES Encryption in Golang and Decryption in Java", "body": "<p>Java decoder (see also <a href=\"https://www.jdoodle.com/a/6iT\" rel=\"nofollow noreferrer\">online runnable demo</a>, open and click \"Execute\"):</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>String decode(String base64Text, byte[] key) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidAlgorithmParameterException, InvalidKeyException, BadPaddingException, IllegalBlockSizeException {\n    byte[] inputArr = Base64.getUrlDecoder().decode(base64Text);\n    SecretKeySpec skSpec = new SecretKeySpec(key, \"AES\");\n    Cipher cipher = Cipher.getInstance(\"AES/CFB/NoPadding\");\n    int blockSize = cipher.getBlockSize();\n    IvParameterSpec iv = new IvParameterSpec(Arrays.copyOf(inputArr, blockSize));\n    byte[] dataToDecrypt = Arrays.copyOfRange(inputArr, blockSize, inputArr.length);\n    cipher.init(Cipher.DECRYPT_MODE, skSpec, iv);\n    byte[] result = cipher.doFinal(dataToDecrypt);\n    return new String(result, StandardCharsets.UTF_8);\n}\n</code></pre>\n\n<p>Kevin in comments has offered <a href=\"https://glot.io/snippets/een965dgb3\" rel=\"nofollow noreferrer\">this demo</a> of the original Go encoder, where we can see the result of:</p>\n\n<pre><code>encrypt([]byte(\"0123456789abcdef\"), \"test text 123\")\n</code></pre>\n\n<p>is <code>c1bpFhxn74yzHQs-vgLcW6E5yL8zJfgceEQgYl0=</code>.</p>\n\n<p>Let's see how the Java decoder above deals with that input:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>String text = \"c1bpFhxn74yzHQs-vgLcW6E5yL8zJfgceEQgYl0=\";\nbyte[] key = \"0123456789abcdef\".getBytes();\nSystem.out.println(decode(text, key));\n</code></pre>\n\n<p>Prints <code>test text 123</code> \u2714</p>\n\n<hr>\n\n<p>Scala version (<a href=\"https://jdoodle.com/a/6j6\" rel=\"nofollow noreferrer\">online runnable demo</a>):</p>\n\n<pre class=\"lang-scala prettyprint-override\"><code>def decode(input:String, key:String) = {\n    val cipher = Cipher.getInstance(\"AES/CFB/NoPadding\")\n    val blockSize = cipher.getBlockSize()\n    val keyBytes = key.getBytes()\n    val inputArr = Base64.getUrlDecoder().decode(input)\n    val skSpec = new SecretKeySpec(keyBytes, \"AES\")\n    val iv = new IvParameterSpec(inputArr.slice(0, blockSize).toArray)\n    val dataToDecrypt = inputArr.slice(blockSize, inputArr.size)\n    cipher.init(Cipher.DECRYPT_MODE, skSpec, iv)\n    new String(cipher.doFinal(dataToDecrypt.toArray))\n}\n\ndef main(args: Array[String]) {\n    print(decode(\"c1bpFhxn74yzHQs-vgLcW6E5yL8zJfgceEQgYl0=\", \"0123456789abcdef\"));\n}\n</code></pre>\n\n<p>I think the only error in the Scala version is using <code>Hex.decodeHex</code>. You need a Base64 decoder that uses the URL-safe alphabet as described in RFC 4648, which <code>java.util.Base64</code> offers (since Java 8) with its <code>getUrlDecoder()</code>.</p>\n"}], "owner": {"reputation": 1121, "user_id": 1121810, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ef0daa890a818e150021b5b36d93a35e?s=128&d=identicon&r=PG", "display_name": "Ripul", "link": "https://stackoverflow.com/users/1121810/ripul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2497, "favorite_count": 5, "answer_count": 1, "score": 5, "last_activity_date": 1504455909, "creation_date": 1463142917, "last_edit_date": 1504413227, "question_id": 37210227, "link": "https://stackoverflow.com/questions/37210227/aes-encryption-in-golang-and-decryption-in-java", "title": "AES Encryption in Golang and Decryption in Java", "body": "<p>I have the following AES Encryption function written in Golang.</p>\n\n<pre><code>func encrypt(key []byte, text string) string {\n    plaintext := []byte(text)\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    ciphertext := make([]byte, aes.BlockSize+len(plaintext))\n    iv := ciphertext[:aes.BlockSize]\n    if _, err := io.ReadFull(rand.Reader, iv); err != nil {\n        panic(err)\n    }\n\n    stream := cipher.NewCFBEncrypter(block, iv)\n    stream.XORKeyStream(ciphertext[aes.BlockSize:], plaintext)\n\n    return base64.URLEncoding.EncodeToString(ciphertext)\n}\n</code></pre>\n\n<p>I am struggling to understand the flow to decrypt the generated text using Java. Any help will be highly appreciated!</p>\n\n<p>Here is the Scala code, Not sure what's the problem with it.</p>\n\n<pre><code>def decode(input:String) = {\n    val keyBytes = Hex.decodeHex(\"someKey\".toCharArray)\n    val inputWithoutPadding = input.substring(0,input.size - 2)\n    val inputArr:Seq[Byte] = Hex.decodeHex(inputWithoutPadding.toCharArray)\n\n    val skSpec = new SecretKeySpec(keyBytes, \"AES\")\n    val iv = new IvParameterSpec(inputArr.slice(0,16).toArray)\n    val dataToDecrypt = inputArr.slice(16,inputArr.size)\n\n    val cipher = Cipher.getInstance(\"AES/CFB/NoPadding\")\n    cipher.init(Cipher.DECRYPT_MODE, skSpec, iv)\n    cipher.doFinal(dataToDecrypt.toArray)\n}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": false, "score": 1, "last_activity_date": 1463151377, "last_edit_date": 1463151377, "creation_date": 1463145571, "answer_id": 37211133, "question_id": 37210109, "link": "https://stackoverflow.com/questions/37210109/how-to-avoid-deadlock-in-this-golang-program/37211133#37211133", "title": "How to avoid deadlock in this golang program?", "body": "<p>You have an unbuffered channel. According to the <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow\">docs</a>:</p>\n\n<blockquote>\n  <p>If the channel is unbuffered, the sender blocks until the receiver has\n  received the value. If the channel has a buffer, the sender blocks\n  only until the value has been copied to the buffer</p>\n</blockquote>\n\n<p>By changing the channel to being buffered, we can avoid deadlock.</p>\n\n<pre><code>c := make(chan int, 10) // holds 10 ints\n</code></pre>\n\n<p>I also suggest reading <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#channels</a>, it's got some good stuff in there related to channels.</p>\n"}, {"comments": [{"owner": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "edited": false, "score": 1, "creation_date": 1472662531, "post_id": 37211325, "comment_id": 65845941, "body": "This is one of the most useful answers I&#39;ve read in some time. Just to make sure I&#39;m following: the &quot;fix&quot; works because it keeps the receiver channel going even after a time out. So <code>wg.Done()</code> (and terminating the <code>main</code> go routine) will only ever happen if something was read in from <code>c</code>, right?"}, {"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "reply_to_user": {"reputation": 1618, "user_id": 1791856, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f123ff5b9de91e4b6a2fc52f2e28daa5?s=128&d=identicon&r=PG", "display_name": "Alex Moore-Niemi", "link": "https://stackoverflow.com/users/1791856/alex-moore-niemi"}, "edited": false, "score": 1, "creation_date": 1472663088, "post_id": 37211325, "comment_id": 65846239, "body": "Right, but to clear up a bit, it keeps the <b>goroutine</b> running."}], "tags": [], "owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "is_accepted": false, "score": 13, "last_activity_date": 1586829289, "last_edit_date": 1586829289, "creation_date": 1463146146, "answer_id": 37211325, "question_id": 37210109, "link": "https://stackoverflow.com/questions/37210109/how-to-avoid-deadlock-in-this-golang-program/37211325#37211325", "title": "How to avoid deadlock in this golang program?", "body": "<p>So, lets look at what's really going on in your source. You have <em>two</em> goroutines (there's more than two, but we're going to focus on the explicit ones), <code>main</code> and <code>readFromChannel</code>. </p>\n\n<p>Lets look at what <code>readFromChannel</code> does:</p>\n\n<pre><code>if channel `c` is not empty before `ti` has expired, print its contents and return, after signalling its completion to wait group.\nif `ti` has expired before `c` is not empty, print \"TIMED OUT\" and return, after signalling its completion to wait group.\n</code></pre>\n\n<p>now Main:</p>\n\n<pre><code>adds to waitgroup \nmake a channel `c`\nstart a goroutine `readFromChannel`\nsleep for 5 seconds\nsend 10 to channel `c`\ncall wait for waitgroup\n</code></pre>\n\n<p>Now, lets go through the flow of execution for your code, concurrently (your code may/ may not execute in this order every time, keep that in mind)</p>\n\n<pre><code>1) wg.Add(1)\n2) c := make(chan int)\n3) go readFromChannel(c, time.After(time.Duration(2)*time.Second))\n#timer ti starts#\n4) time.Sleep(time.Duration(5) * time.Second)\n#MAIN Goroutine begins sleep\n#timer ti expires#\n5) case &lt;-ti:\n6) fmt.Println(\"TIMED OUT\")\n7) wg.Done()\n# readFromChannel Goroutine returns #\n#MAIN Goroutine exits sleep#\n8) c&lt;-10\n9) ......#DEADLOCK#\n</code></pre>\n\n<p>Now you can guess why you got a deadlock. In go, non buffered channels <strong>will block</strong> until something happens on the other end of the channel, regardless of whether you're sending or receiving. So <code>c &lt;- 10</code> will block until something reads from the other end of <code>c</code>, but the goroutine you had for that has dropped out of the picture 2 seconds ago. Therefore, <code>c</code> blocks forever, and since <code>main</code> is the last goroutine left, you get a Deadlock.</p>\n\n<p>How to prevent it? When using channels, ensure that there's always a <code>receive</code> at the other end of the channel for every <code>send</code>. </p>\n\n<p>Using a buffered channel in this scenario can serve as a quick fix, but may fuel potential gotchas in larger repositories. For example, assuming you wrote more data to <code>c</code> afterward and ran <code>go readFromChannel(c, time.After(time.Duration(2)*time.Second))</code> a second time. You might see: </p>\n\n<pre><code>Read D1\nRead D2\n</code></pre>\n\n<p>or</p>\n\n<pre><code>TIMED OUT\nRead D1\n</code></pre>\n\n<p>solely based on chance. That's probably not the behavior you'd want.</p>\n\n<p>Here's how I'd resolve the deadlock:</p>\n\n<pre><code>func main() {\n    wg.Add(1)\n    c := make(chan int)\n    go readFromChannel(c, time.After(time.Duration(2)*time.Second))\n    time.Sleep(time.Duration(5) * time.Second)\n    c &lt;- 10\n    wg.Wait()\n}\n\nfunc readFromChannel(c chan int, ti &lt;-chan time.Time) {\n        // the forloop will run forever\n    loop: // **\n    for {\n        select {\n            case x := &lt;-c:\n                    fmt.Println(\"Read\", x)\n                    break loop // breaks out of the for loop and the select **\n            case &lt;-ti:\n                    fmt.Println(\"TIMED OUT\")\n            }\n    }\n    wg.Done()\n} \n</code></pre>\n\n<p>** <a href=\"https://stackoverflow.com/a/11105482/3044418\">see this answer for details</a></p>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 0, "last_activity_date": 1463146376, "creation_date": 1463146376, "answer_id": 37211409, "question_id": 37210109, "link": "https://stackoverflow.com/questions/37210109/how-to-avoid-deadlock-in-this-golang-program/37211409#37211409", "title": "How to avoid deadlock in this golang program?", "body": "<p>Your problem is that you are using <code>select</code> statement but you are not using inside a goroutine.</p>\n\n<pre><code>go func() {\n    for {\n        select {\n        case x := &lt;-c:\n            fmt.Println(\"Read\", x)\n        case &lt;-ti:\n            fmt.Println(\"TIMED OUT\")\n        }\n    }\n}()\n</code></pre>\n\n<p>Getting the values out of different concurrently executing goroutines can be accomplished with the select keyword, which closely resembles the switch control statement and is sometimes called the <em>communications switch</em>.</p>\n\n<p>Using a send operation in a select statement with a default case guarantees that the send will be non-blocking! If there are no cases, the select blocks execution forever.</p>\n\n<p><a href=\"https://play.golang.org/p/Ai1ggveb4s\" rel=\"nofollow\">https://play.golang.org/p/Ai1ggveb4s</a></p>\n"}, {"tags": [], "owner": {"reputation": 1273, "user_id": 2436902, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/iGuzl.jpg?s=128&g=1", "display_name": "Matt Fiocca", "link": "https://stackoverflow.com/users/2436902/matt-fiocca"}, "is_accepted": false, "score": 0, "last_activity_date": 1476729385, "creation_date": 1476729385, "answer_id": 40093374, "question_id": 37210109, "link": "https://stackoverflow.com/questions/37210109/how-to-avoid-deadlock-in-this-golang-program/40093374#40093374", "title": "How to avoid deadlock in this golang program?", "body": "<p>This is an older question, but i'm diving deep into learning channels myself and found this here.</p>\n\n<p>I think you just need to close the channel after your done sending on it?</p>\n\n<p>Code:</p>\n\n<pre><code>func main() {\n    wg.Add(1)\n    c := make(chan int)\n    go readFromChannel(c, time.After(time.Duration(2)*time.Second))\n    time.Sleep(time.Duration(5) * time.Second)\n    c &lt;- 10\n    close(c) // &lt;- CLOSE IT HERE\n    wg.Wait()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "edited": false, "score": 2, "creation_date": 1527828213, "post_id": 50636153, "comment_id": 88282297, "body": "This could do with some explanation of what you have done/how this is different from the original"}], "tags": [], "owner": {"reputation": 1, "user_id": 8293856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddb4b47a463cf9acf4fc822a100b344d?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Sharan", "link": "https://stackoverflow.com/users/8293856/abhishek-sharan"}, "is_accepted": false, "score": -1, "last_activity_date": 1527827698, "creation_date": 1527827698, "answer_id": 50636153, "question_id": 37210109, "link": "https://stackoverflow.com/questions/37210109/how-to-avoid-deadlock-in-this-golang-program/50636153#50636153", "title": "How to avoid deadlock in this golang program?", "body": "<pre><code>func main() {\n\n    wg.Add(1)\n    c := make(chan int)\n    go func() {\n        c &lt;- 10\n\n    }()\n    go readFromChannel(c, time.After(time.Duration(2)*time.Second))\n    time.Sleep(time.Duration(5) * time.Second)\n\n    wg.Wait()\n\n}//This will read without deadlock\n\nfunc main() {\n    wg.Add(1)\n    c := make(chan int)\n\n    go readFromChannel(c, time.After(time.Duration(2)*time.Second))\n    time.Sleep(time.Duration(5) * time.Second)\n\n    go func() {\n        c &lt;- 10\n\n    }()\n    wg.Wait()\n\n}//Time out without deadlock\n</code></pre>\n"}], "owner": {"reputation": 14871, "user_id": 68287, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4ceb58cf5b018085915f8f446b76665d?s=128&d=identicon&r=PG&f=1", "display_name": "Embedd_0913", "link": "https://stackoverflow.com/users/68287/embedd-0913"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7173, "favorite_count": 2, "answer_count": 5, "score": 7, "last_activity_date": 1586829289, "creation_date": 1463142580, "last_edit_date": 1463144120, "question_id": 37210109, "link": "https://stackoverflow.com/questions/37210109/how-to-avoid-deadlock-in-this-golang-program", "title": "How to avoid deadlock in this golang program?", "body": "<p>Here is my program which is producing deadlock, how do I avoid it and what is the recommended pattern to handle this kind of situation.</p>\n\n<p>The problem is after timeout how do I detect that there is no reader on my channel ? </p>\n\n<pre><code>var wg sync.WaitGroup\n\nfunc main() {   \n    wg.Add(1)\n    c := make(chan int)\n    go readFromChannel(c, time.After(time.Duration(2)*time.Second))\n    time.Sleep(time.Duration(5) * time.Second)\n    c &lt;- 10\n    wg.Wait()\n}\n\nfunc readFromChannel(c chan int, ti &lt;-chan time.Time) {\n    select {\n    case x := &lt;-c:\n        fmt.Println(\"Read\", x)\n    case &lt;-ti:\n        fmt.Println(\"TIMED OUT\")\n    }\n    wg.Done()\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1463141701, "post_id": 37209559, "comment_id": 61950669, "body": "Unless you see some large benefit from having the function add the file extension you could get rid of <code>(f *CppRead) Open</code> and <code>(f *CppWrite) Open</code> and just use <code>CppOpen(cpp, &quot;main.cpp&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 2340525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e66e3792dc186f8b22b9c85aa065f30?s=128&d=identicon&r=PG", "display_name": "pioh", "link": "https://stackoverflow.com/users/2340525/pioh"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1463142652, "post_id": 37209559, "comment_id": 61951288, "body": "It&#39;s just a minimal example, in a real program it makes more useful work."}], "answers": [{"tags": [], "owner": {"reputation": 2917, "user_id": 940939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f04fbc97c3735bb1e24b90e1aa336aae?s=128&d=identicon&r=PG", "display_name": "Massimo Zerbini", "link": "https://stackoverflow.com/users/940939/massimo-zerbini"}, "is_accepted": false, "score": 2, "last_activity_date": 1463150041, "last_edit_date": 1463150041, "creation_date": 1463149588, "answer_id": 37212606, "question_id": 37209559, "link": "https://stackoverflow.com/questions/37209559/go-how-can-i-define-a-one-function-for-similar-structures/37212606#37212606", "title": "Go: How can I define a one function for similar structures", "body": "<p>Go does not have pure object inheritance, I think you can only put the common business logic in a private package function and call the function in the two implementations of the method Open.</p>\n\n<pre><code>func changeFileName(name string) { return name + \".cpp\" }\nfunc (f *CppRead) Open(name string)   { f.FileRead.Open(changeFileName(name)) }\nfunc (f *CppWrite) Open(name string)  { f.FileWrite.Open((changeFileName(name))) }\n</code></pre>\n\n<p>This is a very simple example, the business logic could be more complex.</p>\n"}], "owner": {"reputation": 11, "user_id": 2340525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e66e3792dc186f8b22b9c85aa065f30?s=128&d=identicon&r=PG", "display_name": "pioh", "link": "https://stackoverflow.com/users/2340525/pioh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463150041, "creation_date": 1463140906, "question_id": 37209559, "link": "https://stackoverflow.com/questions/37209559/go-how-can-i-define-a-one-function-for-similar-structures", "title": "Go: How can I define a one function for similar structures", "body": "<p>I have this</p>\n\n<pre><code>type File struct{}\n\ntype FileRead struct {\n    File\n}\ntype FileWrite struct {\n    File\n}\ntype CppRead struct {\n    FileRead\n}\ntype CppWrite struct {\n    FileWrite\n}\n\nfunc (f *File) Open(name string, mod string) {\n    fmt.Println(\"open\", name, mod)\n}\nfunc (f *FileRead) Open(name string)  { f.File.Open(name, \"read\") }\nfunc (f *FileWrite) Open(name string) { f.File.Open(name, \"write\") }\nfunc (f *CppRead) Open(name string)   { f.FileRead.Open(name + \".cpp\") }\nfunc (f *CppWrite) Open(name string)  { f.FileWrite.Open(name + \".cpp\") }\n\nfunc main(){\n    cpp := &amp;CppWrite{}\n    cpp.Open(\"main\")\n}\n</code></pre>\n\n<p>I don't like it because there are two functions that doing the same thing:</p>\n\n<pre><code>func (f *CppRead) Open(name string)\nfunc (f *CppWrite) Open(name string)\n</code></pre>\n\n<p>I can rewrite them as</p>\n\n<pre><code>func (f *CppRead) CppOpen(name string)   { f.Open(name + \".cpp\") }\nfunc (f *CppWrite)CppOpen(name string)   { f.Open(name + \".cpp\") }\n</code></pre>\n\n<p>So they become more similar, but still there are two</p>\n\n<p>I know that i can use an interface</p>\n\n<pre><code>type FileRWOpener interface {\n    Open(string)\n}\nfunc CppOpen(file FileRWOpener, name string) {\n    file.Open(name + \".cpp\")\n}\nfunc main() {\n    cpp := &amp;CppWrite{}\n    CppOpen(cpp, \"main\")\n}\n</code></pre>\n\n<p>But i want to use it as</p>\n\n<pre><code>cpp.Open(\"name\") // not CppOpen(cpp, \"main\")\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 109227, "user_id": 641955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Hg2nO.jpg?s=128&g=1", "display_name": "janos", "link": "https://stackoverflow.com/users/641955/janos"}, "is_accepted": true, "score": 3, "last_activity_date": 1463133205, "creation_date": 1463133205, "answer_id": 37206834, "question_id": 37205971, "link": "https://stackoverflow.com/questions/37205971/reader-readline-doesnt-advance-after-a-scanner-scan-call/37206834#37206834", "title": "reader.ReadLine() doesn&#39;t advance after a scanner.Scan() call", "body": "<p>When you do this inside the <code>for</code> loop:</p>\n\n<blockquote>\n<pre><code>buffer.Write(part)\nnewLine := buffer.String()\nfmt.Println(\"newLine=\" + newLine)\n</code></pre>\n</blockquote>\n\n<p>The next line gets appended to <code>buffer</code>.\nThat is,\nbefore the loop begins, <code>buffer</code> contains <code>2 3</code>,\nand then after reading <code>1.0 2.0 3.0</code>,\nit gets appended to buffer,\nso the content becomes <code>2 31.0 2.0 3.0</code>,\nwhich you store in <code>newLine</code>.\nThat's where things start to go sideways.</p>\n\n<p>You probably want to clear the <code>buffer</code> before reading each new line:</p>\n\n<pre><code>buffer.Reset()\nbuffer.Write(part)\nnewLine := buffer.String()\nfmt.Println(\"newLine=\" + newLine)\n</code></pre>\n\n<p>But then you will have further problems still, here:</p>\n\n<pre><code>    if scanner.Scan() {\n        classLabel, err = strconv.Atoi(scanner.Text())\n        if err != nil {\n            return result, err\n        }\n    }\n</code></pre>\n\n<p>Since the line contains <code>1.0 2.0 3.0</code>, the <code>strconf.Atoi</code> is going to fail.\nI don't understand the purpose of this snippet,\nperhaps you can delete it (or comment out).</p>\n\n<p>With the above fixed, you will still have one more problem, on this line:</p>\n\n<blockquote>\n<pre><code>          attributes = append(attributes, attribute)\n</code></pre>\n</blockquote>\n\n<p>Since <code>attributes</code> is never reset, it keeps growing.\nThat is, after the first line, it will contain <code>1 2 3</code>,\nand after the second line it will contain <code>1 2 3 -1 -2 -3</code>.\nYou could correct that by moving the declaration of <code>attributes</code> without the outer loop, like this:</p>\n\n<pre><code>    var attributes []float64\n    for i := 0; i &lt; attributeNum; i++ {\n        var attribute float64\n        if scanner.Scan() {\n            attribute, err = strconv.ParseFloat(scanner.Text(), 64)\n            if err != nil {\n                return result, err\n            }\n            attributes = append(attributes, attribute)\n            fmt.Println(\"attribute=\" + strconv.FormatFloat(attribute, 'f', -1, 64))\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 37206834, "answer_count": 1, "score": 2, "last_activity_date": 1463133882, "creation_date": 1463130908, "question_id": 37205971, "link": "https://stackoverflow.com/questions/37205971/reader-readline-doesnt-advance-after-a-scanner-scan-call", "title": "reader.ReadLine() doesn&#39;t advance after a scanner.Scan() call", "body": "<p>The code below reads its values from this file:</p>\n\n<pre><code>2 3\\n\n1.0 2.0 3.0\\n\n-1.0 -2.0 -3.0\\n\n</code></pre>\n\n<p>And should print:\n<code>[ {1 2 3}, {-1 -2 -3} ]</code></p>\n\n<p>But instead I get this:</p>\n\n<p><code>[{2 [31 2 3]} {0 []}] strconv.ParseFloat: parsing \"3.0-1.0\": invalid syntax</code></p>\n\n<p>It seems that the <code>reader.ReadLine()</code> stays at the same location. Is there a simpler way to scan lines, then values inside each line?</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype Example struct {\n    classLabel int\n    attributes []float64\n}\n\nfunc NewExample(classLabel int, attributes []float64) *Example {\n    return &amp;Example{classLabel, attributes}\n}\n\nfunc readFile(path string) ([]Example, error) {\n\n    var (\n        result       []Example\n        err          error\n        file         *os.File\n        part         []byte\n        size         int\n        attributeNum int\n    )\n\n    if file, err = os.Open(path); err != nil {\n        return result, err\n    }\n    defer file.Close()\n\n    reader := bufio.NewReader(file)\n    buffer := bytes.NewBuffer(make([]byte, 0))\n\n    if part, _, err = reader.ReadLine(); err != nil {\n        return result, err\n    }\n    buffer.Write(part)\n    newLine := buffer.String()\n    fmt.Println(\"newLine=\" + newLine)\n\n    r := strings.NewReader(newLine)\n    scanner := bufio.NewScanner(r)\n    scanner.Split(bufio.ScanWords)\n\n    if scanner.Scan() {\n        size, err = strconv.Atoi(scanner.Text())\n        if err != nil {\n            return result, err\n        }\n    }\n    fmt.Println(\"size=\" + strconv.Itoa(size))\n\n    if scanner.Scan() {\n        attributeNum, err = strconv.Atoi(scanner.Text())\n        if err != nil {\n            return result, err\n        }\n    }\n    fmt.Println(\"attributeNum=\" + strconv.Itoa(attributeNum))\n\n    result = make([]Example, size)\n\n    var classLabel int\n    var attributes []float64\n\n    for k := 0; k &lt; size; k++ {\n        if part, _, err = reader.ReadLine(); err != nil {\n            return result, err\n        }\n        buffer.Write(part)\n        newLine := buffer.String()\n        fmt.Println(\"newLine=\" + newLine)\n\n        r := strings.NewReader(newLine)\n        scanner := bufio.NewScanner(r)\n        scanner.Split(bufio.ScanWords)\n\n        if scanner.Scan() {\n            classLabel, err = strconv.Atoi(scanner.Text())\n            if err != nil {\n                return result, err\n            }\n        }\n        fmt.Println(\"classLabel=\" + strconv.Itoa(classLabel))\n\n        for i := 0; i &lt; attributeNum; i++ {\n            var attribute float64\n            if scanner.Scan() {\n                attribute, err = strconv.ParseFloat(scanner.Text(), 64)\n                if err != nil {\n                    return result, err\n                }\n                attributes = append(attributes, attribute)\n                fmt.Println(\"attribute=\" + strconv.FormatFloat(attribute, 'f', -1, 64))\n            }\n        }\n        result[k] = *NewExample(classLabel, attributes)\n    }\n\n    return result, scanner.Err()\n}\n\nfunc main() {\n    example, err := readFile(\"test.txt\")\n    fmt.Println(example, err)\n}\n</code></pre>\n"}, {"tags": ["authentication", "go", "oauth", "oauth-2.0", "openid-connect"], "comments": [{"owner": {"reputation": 9139, "user_id": 927408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b569692de127b2f110ac8c44eae5c06?s=128&d=identicon&r=PG", "display_name": "J&#248;rgen R", "link": "https://stackoverflow.com/users/927408/j%c3%b8rgen-r"}, "edited": false, "score": 1, "creation_date": 1463125275, "post_id": 37203987, "comment_id": 61939735, "body": "This question is <a href=\"http://stackoverflow.com/help/on-topic\">too broad</a>. There are either too many possible answers, or good answers would be too long for this format. Please add details to narrow the answer set or to isolate an issue that can be answered in a few paragraphs."}, {"owner": {"reputation": 2973, "user_id": 1599825, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/TJpwJ.jpg?s=128&g=1", "display_name": "Robins Gupta", "link": "https://stackoverflow.com/users/1599825/robins-gupta"}, "reply_to_user": {"reputation": 9139, "user_id": 927408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b569692de127b2f110ac8c44eae5c06?s=128&d=identicon&r=PG", "display_name": "J&#248;rgen R", "link": "https://stackoverflow.com/users/927408/j%c3%b8rgen-r"}, "edited": false, "score": 0, "creation_date": 1463125539, "post_id": 37203987, "comment_id": 61939933, "body": "@jurgemaister I am editing and adding details  this will make easily for you to answer."}, {"owner": {"reputation": 2973, "user_id": 1599825, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/TJpwJ.jpg?s=128&g=1", "display_name": "Robins Gupta", "link": "https://stackoverflow.com/users/1599825/robins-gupta"}, "reply_to_user": {"reputation": 9139, "user_id": 927408, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b569692de127b2f110ac8c44eae5c06?s=128&d=identicon&r=PG", "display_name": "J&#248;rgen R", "link": "https://stackoverflow.com/users/927408/j%c3%b8rgen-r"}, "edited": false, "score": 0, "creation_date": 1463128767, "post_id": 37203987, "comment_id": 61941905, "body": "@jurgemaister I have edited please check it now"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1463128918, "post_id": 37203987, "comment_id": 61942005, "body": "only I can say, your Approach should work."}, {"owner": {"reputation": 2973, "user_id": 1599825, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/TJpwJ.jpg?s=128&g=1", "display_name": "Robins Gupta", "link": "https://stackoverflow.com/users/1599825/robins-gupta"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1463136184, "post_id": 37203987, "comment_id": 61946931, "body": "@JiangYD is there any better approach other than this?"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1463142168, "post_id": 37203987, "comment_id": 61950964, "body": "<i>better</i> is a subjective term.  there are many other options, and as @JiangYD said, the only thing we can say to a question this broad is, &quot;your approach should work, as one option&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 21955, "user_id": 639295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qbykb.jpg?s=128&g=1", "display_name": "aychedee", "link": "https://stackoverflow.com/users/639295/aychedee"}, "is_accepted": true, "score": 1, "last_activity_date": 1463152255, "creation_date": 1463152255, "answer_id": 37213577, "question_id": 37203987, "link": "https://stackoverflow.com/questions/37203987/a-single-sign-on-authentication-in-golang/37213577#37213577", "title": "A single sign on authentication in golang", "body": "<p>While your solution will certainly work. It could make writing the browser/mobile/general <strong>frontend</strong> part of your application more complex. And possibly slower. </p>\n\n<p>For example you might end up effectively JOINing data in the frontend. You make one request to service A, then use the information returned there to make additional requests to service B. This is a bad experience for the user. </p>\n\n<p>Once new concept that companies like Netflix and Soundcloud are pioneering is the <a href=\"http://samnewman.io/patterns/architectural/bff/\" rel=\"nofollow\">backend for frontend pattern</a>. Which is a server side adaptor for each type of frontend device that can handle authentication and aggregate the connections to the down stream services.  </p>\n"}], "owner": {"reputation": 2973, "user_id": 1599825, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/TJpwJ.jpg?s=128&g=1", "display_name": "Robins Gupta", "link": "https://stackoverflow.com/users/1599825/robins-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4394, "favorite_count": 1, "accepted_answer_id": 37213577, "answer_count": 1, "score": 3, "last_activity_date": 1463207906, "creation_date": 1463124958, "last_edit_date": 1463207906, "question_id": 37203987, "link": "https://stackoverflow.com/questions/37203987/a-single-sign-on-authentication-in-golang", "title": "A single sign on authentication in golang", "body": "<p>I am trying to build a multi-tenant architecture in <code>golang</code> where there will be different services like <code>Service-A</code> and <code>Service-B</code> each service will run on a different server and I want the user to have a <code>single sign-in</code>  solution and get authenticated in all the services offered. </p>\n\n<p>Just like what <code>Amazon AWS or Google</code> does like it has many different services like <code>Amazon Cloud Front</code>, <code>Amazon EC2</code>, <code>Amazon S3</code> and all services are authenticated through a single login and logout from one service result in<code>log out from all connected services</code>.</p>\n\n<p>I am trying to implement this in <code>golang</code>, so far I found out <code>Open-id Connect</code> <a href=\"https://github.com/coreos/dex\" rel=\"nofollow\">coreos/dex</a> \nbut it lacks docs explaining its API and Architecture.</p>\n\n<p><strong>What would be the best architecture to design such authentication system?</strong></p>\n\n<p>I think using <code>JWT token</code> I can achieve it. <code>Is this architecture will be secure or there any better solution for this</code>?</p>\n\n<blockquote>\n  <p>My Approach</p>\n</blockquote>\n\n<pre><code>                          -----------------        \n                          |               |    shared\n                          |               |   env file\n                          |SERVICES A     |---------------|       \n           AUTH HEADER    |               |               |\n           JWT TOKEN      |               |               |\n        |---------------&gt; -----------------               |                     \n    ---------            ------------------   shared      |\n    |       |            |    SERVICE B   |  env file     |                    \n    |Login  | -----------|                |-----------    |               \n    |Browser|            |                |          |    |  \n    ---------            ------------------          |    |\n        | |                                          |    |   \n   Login| |\"JWT_TOKEN RESPONSE\"                      |    |   \n        | |                                          |    |   \n    --------------   enviroment file                ------------   \n    |            |----------------------------------|          |\n    | Main Server|                                  |          |\n    |            |                                  |JWT_SECRET|    \n    --------------                                  |=\"secret\" |          \n                                                    ------------\n</code></pre>\n"}, {"tags": ["go", "openssl", "rsa", "sign"], "answers": [{"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1463142309, "post_id": 37209970, "comment_id": 61951054, "body": "just note, not all <code>echo</code>  implementations support the <code>-n</code> switch."}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 3, "last_activity_date": 1463142183, "creation_date": 1463142183, "answer_id": 37209970, "question_id": 37202268, "link": "https://stackoverflow.com/questions/37202268/why-are-the-rsa-signatures-i-generate-with-openssl-and-golang-different/37209970#37209970", "title": "Why are the RSA signatures I generate with openssl and golang different?", "body": "<p>The <code>echo</code> command prints a string with a trailing newline (<code>\\n</code> or <code>0a</code>):</p>\n\n<pre><code>&gt; echo 'Test.' | hexdump -C\n00000000  54 65 73 74 2e 0a                                 |Test..|\n00000006\n</code></pre>\n\n<p>So in your case, you're signing <code>Test.\\n</code> the first time, and <code>Test.</code> the second time in your Go program. Use <code>echo</code>'s <code>-n</code> switch to suppress the trailing newline:</p>\n\n<pre><code>&gt; echo -n 'Test.' | hexdump -C\n00000000  54 65 73 74 2e                                    |Test.|\n00000005\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6328407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ad327dc68666249652d69e7027d757?s=128&d=identicon&r=PG&f=1", "display_name": "Q.Bo", "link": "https://stackoverflow.com/users/6328407/q-bo"}, "edited": false, "score": 0, "creation_date": 1463224341, "post_id": 37210758, "comment_id": 61981812, "body": "With your help, my problem has been resolved, thank you very much.Another question,I get the string &quot;Test.\\n&quot; using the following comman: <code>$ openssl rsautl -verify -inkey pub.key -pubin -in signature</code> <code>$ Test.</code> Bug in Golang,I only found a function VerifyPKCS1v15 to verify the signature,but before call the function, I must have known this string &quot;Test.\\n&quot;,in order to generate argument **hashed88. <code>func VerifyPKCS1v15(pub *PublicKey, hash crypto.Hash, hashed []byte, sig []byte)</code> Can I get the string &quot;Test.\\n&quot; from public Key and signatrue,just like the openssl command?"}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 9, "last_activity_date": 1469917256, "last_edit_date": 1495540388, "creation_date": 1463144478, "answer_id": 37210758, "question_id": 37202268, "link": "https://stackoverflow.com/questions/37202268/why-are-the-rsa-signatures-i-generate-with-openssl-and-golang-different/37210758#37210758", "title": "Why are the RSA signatures I generate with openssl and golang different?", "body": "<p>In addition to the newline added by <code>echo</code> described in <a href=\"https://stackoverflow.com/a/37209970/214790\">helmbert\u2019s answer</a>, the OpenSSL <code>rsautl</code> command operates directly on the supplied data, while the Go code first hashes the data with SHA256 and then signs the resulting digest.</p>\n\n<p>To perform the same as the Go code with OpenSSL, you can use the <a href=\"https://www.openssl.org/docs/manmaster/apps/dgst.html\" rel=\"noreferrer\"><code>dgst</code> command</a> with the <code>-sign</code> option (note I\u2019ve included the <code>-n</code> option to <code>echo</code> here too):</p>\n\n<pre><code>$ echo -n \"Test.\" | openssl dgst -sha256 -sign private.key -hex\n52e1cce3810c1a89693cf6965d1035618820a9e3a7b95203d885c4153dc3f7424b98e3ba628a186f1074d672bb59a1c0788a9c2064951ca2326eb1bf8e3e49e9\n</code></pre>\n\n<p>To go the other way and sign the raw message without hashing in Go code, you can pass <code>0</code> as the value of the <code>hash</code> argument to <a href=\"https://golang.org/pkg/crypto/rsa/#SignPKCS1v15\" rel=\"noreferrer\"><code>rsa.SignPKCS1v15</code></a>:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>indata := []byte(\"Test.\")\n\ns, err := rsa.SignPKCS1v15(nil, privKey, 0, indata)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 4257977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c7ed74a4fd0102185c19697de5cc7a?s=128&d=identicon&r=PG&f=1", "display_name": "xichen", "link": "https://stackoverflow.com/users/4257977/xichen"}, "is_accepted": false, "score": 2, "last_activity_date": 1529905625, "creation_date": 1529905625, "answer_id": 51016981, "question_id": 37202268, "link": "https://stackoverflow.com/questions/37202268/why-are-the-rsa-signatures-i-generate-with-openssl-and-golang-different/51016981#51016981", "title": "Why are the RSA signatures I generate with openssl and golang different?", "body": "<p>This is a very useful link. </p>\n\n<pre><code>// Sign secret with rsa with PKCS 1.5 as the padding algorithm\n// The result should be exactly same as \"openssl rsautl -sign -inkey \"YOUR_RSA_PRIVATE_KEY\" -in \"YOUR_PLAIN_TEXT\"\"\nsigner, err := rsa.SignPKCS1v15(rand.Reader, rsaPrivateKey.(*rsa.PrivateKey), crypto.Hash(0), []byte(message))\n</code></pre>\n\n<p><a href=\"https://github.com/bitmartexchange/bitmart-go-api/blob/master/bm_client.go\" rel=\"nofollow noreferrer\">https://github.com/bitmartexchange/bitmart-go-api/blob/master/bm_client.go</a></p>\n"}], "owner": {"reputation": 23, "user_id": 6328407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ad327dc68666249652d69e7027d757?s=128&d=identicon&r=PG&f=1", "display_name": "Q.Bo", "link": "https://stackoverflow.com/users/6328407/q-bo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2806, "favorite_count": 1, "accepted_answer_id": 37210758, "answer_count": 3, "score": 1, "last_activity_date": 1529905625, "creation_date": 1463119313, "last_edit_date": 1463121060, "question_id": 37202268, "link": "https://stackoverflow.com/questions/37202268/why-are-the-rsa-signatures-i-generate-with-openssl-and-golang-different", "title": "Why are the RSA signatures I generate with openssl and golang different?", "body": "<p>I use openssl command to sign the message \"Test.\", output with hexdump</p>\n\n<pre><code># echo \"Test.\" | openssl rsautl -inkey privite.key -sign -hexdump\n0000 - 09 1b ce e2 4b 69 86 be-d7 b1 fb f0 ec e4 53 0e   ....Ki........S.\n0010 - ef 9c a4 7b db d3 21 d5-3e 78 23 61 89 34 7e bc   ...{..!.&gt;x#a.4~.\n0020 - e9 1e 5a e9 f4 40 e6 53-07 e4 dd 1a fe 31 ec 42   ..Z..@.S.....1.B\n0030 - 98 a5 07 d4 7e d9 f4 01-2f ba a3 65 18 b7 69 a4   ....~.../..e..i. \n</code></pre>\n\n<p>The hex string is 091bcee24b69...</p>\n\n<p>My private.Key</p>\n\n<pre><code># cat private.Key\n-----BEGIN RSA PRIVATE KEY-----\nMIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0\nfd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu\n/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu\nRTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/\nEO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A\nIU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS\ntAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V\n-----END RSA PRIVATE KEY-----\n</code></pre>\n\n<p>Generate signature with Golang</p>\n\n<pre><code>var prvKeyPem = `-----BEGIN RSA PRIVATE KEY-----\nMIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0\nfd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu\n/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu\nRTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/\nEO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A\nIU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS\ntAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V\n-----END RSA PRIVATE KEY-----`\n\nfunc GenerateSignature() {\n    block, _ := pem.Decode([]byte(prvKeyPem))\n    if block == nil {\n        panic(\"failed to parse root certificate PEM\")\n    }\n    privKey, err := x509.ParsePKCS1PrivateKey(block.Bytes) //x509.ParseCertificate(block.Bytes)\n    if err != nil {\n        panic(\"failed to parse certificate: \" + err.Error())\n    }\n    indata := \"Test.\"\n    h := sha256.New()\n    h.Write([]byte(indata))\n    digest := h.Sum(nil)\n\n    s, err := rsa.SignPKCS1v15(rand.Reader, privKey, crypto.SHA256, digest)\n    if err != nil {\n        panic(\"failed to sign:\" + err.Error())\n    }\n    fmt.Printf(\"%x\\n\", s)\n}\n\nfunc main() {\n    GenerateSignature()\n}\n</code></pre>\n\n<p>go run this code, following is output:\n52e1cce3810c1a89693cf6965d1035618820a9e3a7b95203d885c4153dc3f7424b98e3ba628a186f1074d672bb59a1c0788a9c2064951ca2326eb1bf8e3e49e9</p>\n\n<p>But I think it should be:</p>\n\n<p>091bcee24b69...  </p>\n\n<p><strong>Where is my wrong? Thanks</strong></p>\n"}, {"tags": ["go", "revel", "object-composition"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1463126455, "post_id": 37202059, "comment_id": 61940503, "body": "There is no inheritance in Go. Some related / possible duplicates: <a href=\"http://stackoverflow.com/questions/21251242/is-it-possible-to-call-overridden-method-from-parent-struct-in-golang\">one</a>, <a href=\"http://stackoverflow.com/questions/30622605/can-embedded-struct-method-have-knowledge-of-parent-child\">two</a>, <a href=\"http://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method\">three</a>, <a href=\"http://stackoverflow.com/questions/29144622/what-is-the-idiomatic-way-in-go-to-create-a-complex-hierarchy-of-structs\">four</a>."}], "answers": [{"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 2, "last_activity_date": 1463126430, "creation_date": 1463126430, "answer_id": 37204464, "question_id": 37202059, "link": "https://stackoverflow.com/questions/37202059/make-object-accessible-in-inherited-method-in-golang/37204464#37204464", "title": "Make object accessible in inherited method in golang", "body": "<p>First of all, there is an error in your code. Until you have not created another type defined as <code>String</code> you have to correct it to <code>string</code>.</p>\n\n<p>Then in Go you can use composite structs, which means you can access a struct field included in another struct directly, as you already did.</p>\n\n<p>This means that you can invoke a method on a method receiver which does have the struct fields declared. To correct your example, if i'm understand correctly your question:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    Number int\n}\n\ntype B struct{\n    A\n    name string\n}\n\nfunc main() {\n    b := &amp;B{A{1}, \"George\"}\n    b.GetValues()\n}\n\nfunc (b B) GetValues() {    \n    fmt.Println(b.Number)\n    fmt.Println(b.name)\n}\n</code></pre>\n\n<p>In the example below because <code>struct A</code> is included in <code>struct B</code> this means you can invoke a struct field declared in <code>struct A</code> in the GetValues method. This is because <code>struct B</code> inherits the <code>struct A</code> fields.</p>\n\n<p><a href=\"https://play.golang.org/p/B-XJc6jddE\" rel=\"nofollow\">https://play.golang.org/p/B-XJc6jddE</a></p>\n"}], "owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 37204464, "answer_count": 1, "score": 0, "last_activity_date": 1463126430, "creation_date": 1463118330, "question_id": 37202059, "link": "https://stackoverflow.com/questions/37202059/make-object-accessible-in-inherited-method-in-golang", "title": "Make object accessible in inherited method in golang", "body": "<p>I am trying to implement inheritence in golang.\nBelow is example:</p>\n\n<pre><code>type A struct {\n  Number int\n}\n\ntype B struct{\n  A\n  name String\n}\n\nfunc (a A) GetNumber() {\n    // Here I want to use instance of B\n    fmt.Println(a) // but this is giving me instance of A\n}\n</code></pre>\n\n<p>Is it possible to get instance of B in function of A if A is being inherited by B?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 742, "user_id": 717318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13e99fc7225ca378040ef36ef1a3049e?s=128&d=identicon&r=PG", "display_name": "Kevin Deenanauth", "link": "https://stackoverflow.com/users/717318/kevin-deenanauth"}, "is_accepted": false, "score": 0, "last_activity_date": 1463119931, "creation_date": 1463119931, "answer_id": 37202412, "question_id": 37201548, "link": "https://stackoverflow.com/questions/37201548/how-to-get-the-most-recent-compilation-time-and-date-of-the-current-source-file/37202412#37202412", "title": "How to get the most recent compilation time and date of the current source file in Golang?", "body": "<p>Use go:generate. As part of your build process you'll have to run <code>go generate</code> prior to running your program. You can encapsulate this in a shared function to use across files.    </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"strconv\"\n    \"time\"\n    \"strings\"\n)\n\n//go:generate sh -c \"date +'%s' &gt; main_timestamp.go.txt\"\n\nfunc main() {\n    txt, err := ioutil.ReadFile(\"main_timestamp.go.txt\")\n    if err == nil {\n        i, err := strconv.ParseInt(strings.TrimSpace(string(txt)), 10, 64)\n        if err == nil {\n            t := time.Unix(i, 0)\n            fmt.Printf(\"%s\", t)\n        } else {\n            fmt.Printf(\"error parsing file %s\", err)\n        }\n    } else {\n        fmt.Printf(\"error reading file %s\", err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 742, "user_id": 717318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13e99fc7225ca378040ef36ef1a3049e?s=128&d=identicon&r=PG", "display_name": "Kevin Deenanauth", "link": "https://stackoverflow.com/users/717318/kevin-deenanauth"}, "is_accepted": true, "score": 5, "last_activity_date": 1463694588, "creation_date": 1463694588, "answer_id": 37334637, "question_id": 37201548, "link": "https://stackoverflow.com/questions/37201548/how-to-get-the-most-recent-compilation-time-and-date-of-the-current-source-file/37334637#37334637", "title": "How to get the most recent compilation time and date of the current source file in Golang?", "body": "<p>Found another method of using an option on the <a href=\"https://golang.org/cmd/link/\" rel=\"noreferrer\">go linker</a> to assign a string:</p>\n\n<blockquote>\n  <p>-X importpath.name=value</p>\n  \n  <p>Set the value of the string variable in importpath named name to value.\n      Note that before Go 1.5 this option took two separate arguments.\n      Now it takes one argument split on the first = sign.</p>\n</blockquote>\n\n<p>Code sample:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar compileDate string\n\nfunc main() {\n   fmt.Println(compileDate )\n}\n</code></pre>\n\n<p>When building:</p>\n\n<pre><code>go build -ldflags \"-X main.compileDate=`date -u +.%Y%m%d.%H%M%S`\" main.go\n</code></pre>\n\n<p>The advantage of this method, is it can be more OS agnostic through build scripts without littering your code with <code>go:generate</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6346338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e58edfa222f8c3645e664e0be1d6c45c?s=128&d=identicon&r=PG", "display_name": "Thomas H&#246;henleitner", "link": "https://stackoverflow.com/users/6346338/thomas-h%c3%b6henleitner"}, "is_accepted": false, "score": 0, "last_activity_date": 1587256032, "creation_date": 1587256032, "answer_id": 61298050, "question_id": 37201548, "link": "https://stackoverflow.com/questions/37201548/how-to-get-the-most-recent-compilation-time-and-date-of-the-current-source-file/61298050#61298050", "title": "How to get the most recent compilation time and date of the current source file in Golang?", "body": "<p>It is not the compilation time but the executable modification time what is nearly the same during development time. Of course it can get faulty when the executable is copied but may be it helps someone:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nvar (\n    linkTime string\n)\n\nfunc main() {\n    fi, _ := os.Stat(os.Args[0])\n    linkTime = fi.ModTime().String()\n    fmt.Println(linkTime)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EH1B9NBnqQB\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 37334637, "answer_count": 3, "score": 2, "last_activity_date": 1587256032, "creation_date": 1463115374, "last_edit_date": 1473338175, "question_id": 37201548, "link": "https://stackoverflow.com/questions/37201548/how-to-get-the-most-recent-compilation-time-and-date-of-the-current-source-file", "title": "How to get the most recent compilation time and date of the current source file in Golang?", "body": "<p>This code returns the most recent compilation time and date  of the current source file:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\n/*\n#include&lt;stdint.h&gt;\n#include&lt;string.h&gt;\nvoid getCompileDateTime(uint8_t  dt[12],uint8_t tm[9]){\n  strcpy(dt, __DATE__); //Mmm dd yyyy\n  strcpy(tm,__TIME__);  //hh:mm:ss\n}\n*/\nimport \"C\"\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    dt := make([]byte, 12)\n    tm := make([]byte, 10)\n    C.getCompileDateTime((*C.uint8_t)(unsafe.Pointer(&amp;dt[0])), (*C.uint8_t)(unsafe.Pointer(&amp;tm[0])))\n    dts, tms := string(dt), string(tm)\n    fmt.Println(dts, tms)\n}\n</code></pre>\n\n<p>Is there pure Golang way to this or this is the only way?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 32568, "user_id": 142446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e8190d89907e24bf6b4438eaef71af4?s=128&d=identicon&r=PG", "display_name": "Brett Kail", "link": "https://stackoverflow.com/users/142446/brett-kail"}, "is_accepted": true, "score": 5, "last_activity_date": 1463110565, "creation_date": 1463110565, "answer_id": 37200818, "question_id": 37200778, "link": "https://stackoverflow.com/questions/37200778/go-i-want-to-make-a-2d-array-of-a-struct-but-i-am-getting-an-error/37200818#37200818", "title": "Go I want to make a 2d array of a struct, but I am getting an error", "body": "<p>Use <code>squares := [4][4]Square{}</code> to complete the composite literal, or use <code>var squares [4][4]Square</code> to declare the variable.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1463112206, "last_edit_date": 1463112206, "creation_date": 1463111894, "answer_id": 37200998, "question_id": 37200778, "link": "https://stackoverflow.com/questions/37200778/go-i-want-to-make-a-2d-array-of-a-struct-but-i-am-getting-an-error/37200998#37200998", "title": "Go I want to make a 2d array of a struct, but I am getting an error", "body": "<p>2d array and initialization:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Square struct {\n    num int //Holds the number. 0 is empty\n}\n\nfunc main() {\n    squares0 := [4][4]Square{} // init to zeros\n    fmt.Println(squares0)\n\n    var squares [4][4]Square // init to zeros\n    fmt.Println(squares)\n\n    squares2 := [4][4]Square{{}, {}, {}, {}} // init to zeros\n    fmt.Println(squares2)\n\n    squares3 := [4][4]Square{\n        {{1}, {2}, {3}, {4}},\n        {{5}, {6}, {7}, {8}},\n        {{9}, {10}, {11}, {12}},\n        {{13}, {14}, {15}, {16}}}\n    fmt.Println(squares3)\n\n    for i := 0; i &lt; 4; i++ {\n        for j := 0; j &lt; 4; j++ {\n            squares[i][j].num = (i+1)*10 + j + 1\n        }\n    }\n    fmt.Println(squares)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[[{0} {0} {0} {0}] [{0} {0} {0} {0}] [{0} {0} {0} {0}] [{0} {0} {0} {0}]]\n[[{0} {0} {0} {0}] [{0} {0} {0} {0}] [{0} {0} {0} {0}] [{0} {0} {0} {0}]]\n[[{0} {0} {0} {0}] [{0} {0} {0} {0}] [{0} {0} {0} {0}] [{0} {0} {0} {0}]]\n[[{1} {2} {3} {4}] [{5} {6} {7} {8}] [{9} {10} {11} {12}] [{13} {14} {15} {16}]]\n[[{11} {12} {13} {14}] [{21} {22} {23} {24}] [{31} {32} {33} {34}] [{41} {42} {43} {44}]]\n</code></pre>\n"}], "owner": {"reputation": 2747, "user_id": 3521420, "user_type": "registered", "profile_image": "https://graph.facebook.com/1054781629/picture?type=large", "display_name": "Jonathan Allen Grant", "link": "https://stackoverflow.com/users/3521420/jonathan-allen-grant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1133, "favorite_count": 1, "accepted_answer_id": 37200818, "answer_count": 2, "score": 1, "last_activity_date": 1463112206, "creation_date": 1463110277, "question_id": 37200778, "link": "https://stackoverflow.com/questions/37200778/go-i-want-to-make-a-2d-array-of-a-struct-but-i-am-getting-an-error", "title": "Go I want to make a 2d array of a struct, but I am getting an error", "body": "<p>Here is my code:</p>\n\n<pre><code>type Square struct {\n    num int //Holds the number. 0 is empty\n}\n\nfunc somefunc() {\n    squares := [4][4]Square\n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code>type [4][4]Square is not an expression\n</code></pre>\n"}, {"tags": ["go", "knn"], "comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1463109244, "post_id": 37200581, "comment_id": 61933389, "body": "Is this what you are looking for: <a href=\"https://github.com/sjwhitworth/golearn/tree/master/\" rel=\"nofollow noreferrer\">github.com/sjwhitworth/golearn/tree/master</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "is_accepted": true, "score": 4, "last_activity_date": 1463155078, "creation_date": 1463155078, "answer_id": 37214477, "question_id": 37200581, "link": "https://stackoverflow.com/questions/37200581/knn-algorithm-in-golang/37214477#37214477", "title": "Knn algorithm in golang", "body": "<p>Yes, it makes sense. It depends whether your whole stack is in golang or not. Otherwise, golang doesn't contribute much for ml.</p>\n\n<p>Yes, there are multiple packages for it:</p>\n\n<ol>\n<li><a href=\"https://github.com/sjwhitworth/golearn/tree/master/knn\" rel=\"nofollow\">https://github.com/sjwhitworth/golearn/tree/master/knn</a></li>\n<li><a href=\"https://github.com/amitkgupta/nearest_neighbour\" rel=\"nofollow\">https://github.com/amitkgupta/nearest_neighbour</a></li>\n<li><a href=\"https://github.com/Jragonmiris/knn\" rel=\"nofollow\">https://github.com/Jragonmiris/knn</a></li>\n<li><a href=\"https://github.com/Akiira/Go-knn\" rel=\"nofollow\">https://github.com/Akiira/Go-knn</a></li>\n<li><a href=\"https://github.com/CuriousCain/kNN-Iris-set\" rel=\"nofollow\">https://github.com/CuriousCain/kNN-Iris-set</a></li>\n</ol>\n\n<p>Some of them you will need to modify. In future for ml need, refer this repo: <a href=\"https://github.com/josephmisiti/awesome-machine-learning\" rel=\"nofollow\">https://github.com/josephmisiti/awesome-machine-learning</a></p>\n"}], "owner": {"reputation": 43, "user_id": 6246000, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DPRL7hLiw6M/AAAAAAAAAAI/AAAAAAAACa0/qXGaGbBeCBc/photo.jpg?sz=128", "display_name": "Mert Demirok", "link": "https://stackoverflow.com/users/6246000/mert-demirok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1453, "favorite_count": 0, "accepted_answer_id": 37214477, "answer_count": 1, "score": 1, "last_activity_date": 1463155078, "creation_date": 1463108724, "last_edit_date": 1463109305, "question_id": 37200581, "link": "https://stackoverflow.com/questions/37200581/knn-algorithm-in-golang", "title": "Knn algorithm in golang", "body": "<h2>Writing KNN algorithm in golang</h2>\n\n<p>Does it make sense? or Is there a package for it?</p>\n\n<p>for exemple in java:  </p>\n\n<p><a href=\"https://github.com/alexksikes/ML/blob/master/knn/kNN.java\" rel=\"nofollow\">https://github.com/alexksikes/ML/blob/master/knn/kNN.java</a></p>\n"}]