[{"tags": ["docker", "go", "dockerfile"], "answers": [{"comments": [{"owner": {"reputation": 7629, "user_id": 2335820, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sLTHB.jpg?s=128&g=1", "display_name": "Kimmo Hintikka", "link": "https://stackoverflow.com/users/2335820/kimmo-hintikka"}, "edited": false, "score": 1, "creation_date": 1502917404, "post_id": 45722910, "comment_id": 78403812, "body": "Thanks a lot, John! Good explanation, especially your hint on certs, I am pretty sure I am going to need them in the future."}, {"owner": {"reputation": 459, "user_id": 2510591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4b15506108e1cf337adccce77602d51?s=128&d=identicon&r=PG", "display_name": "joseluisq", "link": "https://stackoverflow.com/users/2510591/joseluisq"}, "edited": false, "score": 0, "creation_date": 1548749859, "post_id": 45722910, "comment_id": 95642982, "body": "Just for complementing the @john-chadwick answer, this post  <a href=\"https://www.mgasch.com/post/scratch/\" rel=\"nofollow noreferrer\">mgasch.com/post/scratch</a> by Michael Gasch It can give more better understanding about <code>FROM scratch</code> means, it&#39;s worth reading."}], "tags": [], "owner": {"reputation": 3023, "user_id": 610744, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9296e8c2cc747d7ca3a873a02c21a75b?s=128&d=identicon&r=PG", "display_name": "John Chadwick", "link": "https://stackoverflow.com/users/610744/john-chadwick"}, "is_accepted": true, "score": 11, "last_activity_date": 1502917411, "last_edit_date": 1502917411, "creation_date": 1502917170, "answer_id": 45722910, "question_id": 45722785, "link": "https://stackoverflow.com/questions/45722785/what-docker-scratch-contains-by-default/45722910#45722910", "title": "What Docker scratch contains by default?", "body": "<p>The scratch image contains nothing. No files. But actually, that can work to your advantage. It turns out, Go binaries built with <code>CGO_ENABLED=0</code> require absolutely nothing, other than what they use. There are a couple things to keep in mind:</p>\n\n<ul>\n<li>With <code>CGO_ENABLED=0</code>, you can't use any C code. Actually not too hard.</li>\n<li>With <code>CGO_ENABLED=0</code>, your app will not use the system DNS resolver. I don't think it does by default anyways because it's blocking and Go's native DNS resolver is non-blocking.</li>\n<li>Your app may depend on some things that are not present:\n\n<ul>\n<li>Apps that make HTTPS calls (as in, to other services, i.e. Amazon S3, or the Stripe API) will need ca-certs in order to confirm HTTPS certificate authenticity. This also has to be updated over time. This is not needed for serving HTTPS content.</li>\n<li>Apps that need timezone awareness will need the timezone info files.</li>\n</ul></li>\n</ul>\n\n<p>A nice alternative to <code>FROM scratch</code> is <code>FROM alpine</code>, which will include a base Alpine image - which is very tiny (5 MiB I believe) and includes musl libc, which is compatible with Go and will allow you to link to C libraries as well as compile without setting <code>CGO_ENABLED=0</code>. You can also leverage the fact that alpine is regularly updated, using its tzinfo and ca-certs.</p>\n\n<p>(It's worth noting that the overhead of Docker layers is amortized a bit because of Docker's deduplication, though of course that is negated by how often your base image is updated. Still, it helps sell the idea of using the quite small Alpine image.)</p>\n\n<p>You may not need tzinfo or ca-certs now, but it's better to be safe than sorry; you can accidentally add a dependency without realizing it breaks your build. So I recommend using <code>alpine</code> as your base. <code>alpine:latest</code> should be fine.</p>\n\n<p>Bonus: If you want the advantages of reproducible builds inside Docker, but with small image sizes, you can use the new Docker multi-stage builds available in Docker 17.06+.</p>\n\n<p>It works a bit like this:</p>\n\n<pre><code>FROM golang:alpine\nADD . /go/src/github.com/some/gorepo  # may need some go getting if you don't vendor\nRUN go build -o /app github.com/some/gorepo\n\nFROM scratch  # or alpine\nCOPY --from=0 /app /app\nENTRYPOINT [\"/app\"]\n</code></pre>\n\n<p>(I apologize if I've made any mistakes, I'm typing that from memory.)</p>\n\n<p>Note that when using <code>FROM scratch</code> you must use the exec form of <code>ENTRYPOINT</code>, because the shell form won't work (it depends on the Docker image having <code>/bin/sh</code>, which it won't.) This will work fine in Alpine.</p>\n"}], "owner": {"reputation": 7629, "user_id": 2335820, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sLTHB.jpg?s=128&g=1", "display_name": "Kimmo Hintikka", "link": "https://stackoverflow.com/users/2335820/kimmo-hintikka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 936, "favorite_count": 3, "accepted_answer_id": 45722910, "answer_count": 1, "score": 3, "last_activity_date": 1502961121, "creation_date": 1502916638, "last_edit_date": 1502961121, "question_id": 45722785, "link": "https://stackoverflow.com/questions/45722785/what-docker-scratch-contains-by-default", "title": "What Docker scratch contains by default?", "body": "<p>There is an option to use <code>FROM scratch</code> for me it looks like a really attractive way of building my Go containers. </p>\n\n<p>My question is what does it still have natively to run binaries do I need to add anything in order to reliably run Go binaries? Compiled Go binary seems to run it at least on my laptop.</p>\n\n<p>My goal is to keep image size to a minimum both for security and infra management reasons. In an optimal situation, my container would not be able to execute binaries or shell commands outside of build phase. </p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1502912060, "post_id": 45721558, "comment_id": 78401375, "body": "Note that this test also doesn&#39;t prove your implementation is actually correct; only that decode/encode match. If they&#39;re both wrong in the same way, the test will pass. You need to test against canonical values to prove correctness."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 5, "creation_date": 1502912547, "post_id": 45721558, "comment_id": 78401599, "body": "If your encode/decode can do 1 billion conversions in a second on one CPU (which is extremely optimistic), you&#39;d need 60 CPUs to finish this task in 10 years. And that&#39;s assuming no overhead from goroutines and channels."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1502954448, "post_id": 45721558, "comment_id": 78415318, "body": "@PaulHankin you are totally right, but my idea is trying to understand how to solve this like when dealing with prime numbers by using channels goroutines despite takes years I want to learn more about how this could be optimized."}], "answers": [{"comments": [{"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1502913862, "post_id": 45721697, "comment_id": 78402207, "body": "Thanks for pointing  T.Parrallel, but could you please fix the example to make it work, if I am right <code>t.Run()</code> is missing a <code>)</code> second Itoa seems not to work for <code>uint64</code>: <code>cannot use i (type uint64) as type int in argument to strconv.Itoa</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1502916416, "post_id": 45721697, "comment_id": 78403392, "body": "Corrected code sample, but it seems like you get the idea."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1502955097, "post_id": 45721697, "comment_id": 78415706, "body": "Any idea of why when running in parallel takes more time (is slower) than when not running in t.Parallel() ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1502975361, "post_id": 45721697, "comment_id": 78429735, "body": "There&#39;s overhead involved in parallel processing which, depending on the operation being paralellized, the hardware, the operating system, etc., could result in slower total execution time."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1502916400, "last_edit_date": 1502916400, "creation_date": 1502912315, "answer_id": 45721697, "question_id": 45721558, "link": "https://stackoverflow.com/questions/45721558/how-to-iterate-int-range-concurrently/45721697#45721697", "title": "How to iterate int range concurrently", "body": "<p>This functionality is built into the Go <code>testing</code> package, in the form of <a href=\"https://golang.org/pkg/testing/#T.Parallel\" rel=\"nofollow noreferrer\"><code>T.Parallel</code></a>:</p>\n\n<pre><code>func TestEncode(t *testing.T) {\n    var i uint64\n    for i = 0; i &lt;= (1&lt;&lt;64 - 1); i++ {\n        t.Run(fmt.Sprintf(\"%d\",i), func(t *testing.T) {\n            j := i            // Copy to local var - important\n            t.Parallel()      // Mark test as parallelizable\n            b58 := Encode(j)\n            num := Decode(b58)\n            if num != j {\n                t.Fatalf(\"Expecting %d for %s\", j, b58)\n            }\n        })\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": true, "score": 0, "last_activity_date": 1503167517, "creation_date": 1503167517, "answer_id": 45775063, "question_id": 45721558, "link": "https://stackoverflow.com/questions/45721558/how-to-iterate-int-range-concurrently/45775063#45775063", "title": "How to iterate int range concurrently", "body": "<p>I came up with this solutions:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"github.com/nbari/base58\"\n)\n\nfunc encode(i uint64) {\n    x := base58.Encode(i)\n    fmt.Printf(\"%d = %s\\n\", i, x)\n    time.Sleep(time.Second)\n}\n\nfunc main() {\n    concurrency := 4\n    sem := make(chan struct{}, concurrency)\n    for i, val := uint64(0), uint64(1&lt;&lt;16); i &lt;= val; i++ {\n        sem &lt;- struct{}{}\n        go func(i uint64) {\n            defer func() { &lt;-sem }()\n            encode(i)\n        }(i)\n    }\n    for i := 0; i &lt; cap(sem); i++ {\n        sem &lt;- struct{}{}\n    }\n}\n</code></pre>\n\n<p>Basically, start 4 workers and calls the encode function, to notice/understand more this behavior a sleep is added so that the data can be printed in chunks of 4.</p>\n\n<p>Also, these answers helped me to better understand concurrency understanding: <a href=\"https://stackoverflow.com/a/18405460/1135424\">https://stackoverflow.com/a/18405460/1135424</a></p>\n\n<p>If there is a better way please let me know.</p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 45775063, "answer_count": 2, "score": -2, "last_activity_date": 1503167517, "creation_date": 1502911768, "last_edit_date": 1502957446, "question_id": 45721558, "link": "https://stackoverflow.com/questions/45721558/how-to-iterate-int-range-concurrently", "title": "How to iterate int range concurrently", "body": "<p>For purely educational purposes I created a <a href=\"https://github.com/nbari/base58\" rel=\"nofollow noreferrer\">base58</a> package. It will encode/decode a <code>uint64</code> using the <a href=\"https://en.bitcoin.it/wiki/Base58Check_encoding\" rel=\"nofollow noreferrer\">bitcoin base58 symbol chart</a>, for example:</p>\n\n<pre><code>b58 := Encode(100)  // return 2j\n\nnum := Decode(\"2j\") // return 100\n</code></pre>\n\n<p>While creating the first tests I came with <a href=\"https://github.com/nbari/base58/blob/master/base58_test.go\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>func TestEncode(t *testing.T) {\n    var i uint64\n    for i = 0; i &lt;= (1&lt;&lt;64 - 1); i++ {\n        b58 := Encode(i)\n        num := Decode(b58)\n        if num != i {\n            t.Fatalf(\"Expecting %d for %s\", i, b58)\n        }\n    }\n}\n</code></pre>\n\n<p>This \"naive\" implementation, tries to convert all the range from uint64 (From 0 to 18,446,744,073,709,551,615) to base58 and later back to uint64 but takes too much time.</p>\n\n<p>To better understand how <a href=\"https://golang.org/\" rel=\"nofollow noreferrer\">go</a> handles concurrency I would like to know how to use channels or <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow noreferrer\">goroutines</a> and perform the iteration across the full uint64 range in the most efficient way?</p>\n\n<p>Could data be processed by chunks and in parallel, if yes how to accomplish this?</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>UPDATE</strong>: </p>\n\n<p>Like mention in the answer by <a href=\"https://stackoverflow.com/a/45721697/1135424\">@Adrien</a>, one-way is to use <a href=\"https://golang.org/pkg/testing/#T.Parallel\" rel=\"nofollow noreferrer\">t.Parallel()</a> but that applies only when testing the package, In any case, by implementing it I found that is noticeably slower, it runs in parallel but there is no speed gain.</p>\n\n<p>I understand that doing the full <code>uint64</code> may take years but what I want to find/now is how could a channel or goroutine, may help to speed up the process (testing with small range <code>1&lt;&lt;16</code>) probably by using something like this <a href=\"https://play.golang.org/p/9U22NfrXeq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9U22NfrXeq</a> just as an example.</p>\n\n<p>The question is not about how to test the package is about what algorithm, technic could be used to iterate faster by using concurrency.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502911680, "post_id": 45721470, "comment_id": 78401174, "body": "Why would <code>&quot;Value&quot;: null</code> result in an error? <code>null</code> is a perfectly valid value for a pointer field, and correctly deserializes to <code>nil</code>, which is Go&#39;s <code>null</code>."}, {"owner": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502912463, "post_id": 45721470, "comment_id": 78401564, "body": "I am writing rest-api. This is one of the requirements."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502912942, "post_id": 45721470, "comment_id": 78401761, "body": "@Ilya: this seems like an odd requirement for an API, <code>null</code> and unset are often the same thing."}, {"owner": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502913442, "post_id": 45721470, "comment_id": 78402014, "body": "@JimB: This is the API for the competition. I can not do anything about it. As I understand, such a request ( curl -i <a href=\"http://localhost:80/items/1\" rel=\"nofollow noreferrer\">localhost:80/items/1</a> -d &#39;{  &quot;value&quot;: null}&#39; ) says that you need to reset the value, which means that the request is not correct and the service should return an error."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502911912, "post_id": 45721570, "comment_id": 78401306, "body": "I don&#39;t think this works, per the question, they want the zero value to be <code>nil</code> but <code>null</code> value to result in an error, per the &quot;I want&quot; section in the question."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "edited": false, "score": 0, "creation_date": 1502914006, "post_id": 45721570, "comment_id": 78402284, "body": "@Ilya: I&#39;ve updated with a map example, which shows how to differentiate &quot;unset&quot; vs &quot;null&quot;"}, {"owner": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "edited": false, "score": 0, "creation_date": 1502914463, "post_id": 45721570, "comment_id": 78402526, "body": "@JimB: Thank you very much! But it seems this will seriously slow down the processing of the request."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "edited": false, "score": 0, "creation_date": 1502914594, "post_id": 45721570, "comment_id": 78402603, "body": "@Ilya: have you tested how much it will slow it down? It will add some allocations, but encoding/json isn&#39;t particularly fast. If you want performance, you will need a different package, or write one to handle this specific case."}, {"owner": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "edited": false, "score": 0, "creation_date": 1502915442, "post_id": 45721570, "comment_id": 78402974, "body": "@JimB: It slowed down 2.5 times. Can you advise something?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "edited": false, "score": 1, "creation_date": 1502916928, "post_id": 45721570, "comment_id": 78403621, "body": "@Ilya: 2.5 times what? If it&#39;s still running in microseconds, that&#39;s not much compared to an actual http request. As I mentioned, if you need more performance, feel free to write your own decoder to handle this specific case. It seems this may be the purpose of this example in the game, and I don&#39;t have time right now to write your competition entry for you."}, {"owner": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "edited": false, "score": 0, "creation_date": 1502921544, "post_id": 45721570, "comment_id": 78405365, "body": "@JimB: I did a cycle of 100,000 operations. The original version is executed for 500ms, and the version with a string map is executed for 1300ms. Nevermind. Can you explain this line <code>f, ok := val.(float64)</code>? It seemed to me that I should use something like this <code>f, ok := strconv.Atoi(val.(string))</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "edited": false, "score": 0, "creation_date": 1502933721, "post_id": 45721570, "comment_id": 78408230, "body": "@Ilya: A JSON number is a double precision float, so the default type is <code>float64</code>. You can&#39;t assert it as a string when it&#39;s not a string. If the number were stored in a quoted string in the JSON, then yes you would have to assert it as a string and convert it to an integer."}, {"owner": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "edited": false, "score": 0, "creation_date": 1502938852, "post_id": 45721570, "comment_id": 78409366, "body": "@JimB: Thank you! I thought that all the values are represented by string. My mistake, I&#39;m inattentive."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1502913792, "last_edit_date": 1502913792, "creation_date": 1502911797, "answer_id": 45721570, "question_id": 45721470, "link": "https://stackoverflow.com/questions/45721470/how-can-i-know-that-the-field-is-set-to-null/45721570#45721570", "title": "How can I know that the field is set to null?", "body": "<p>If you want to control how a type is unmarshaled, you can implement <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\"><code>json.Unmarshaler</code></a></p>\n\n<p>Since a map allows you to tell the difference between an unset value, and a <code>null</code> value, unmarshaling first into a generic <code>map[string]interface{}</code> will allow you to inspect the values without tokenizing the JSON. </p>\n\n<pre><code>type Item struct {\n    Value *int\n}\n\n\nfunc (i *Item) UnmarshalJSON(b []byte) error {\n    tmp := make(map[string]interface{})\n\n    err := json.Unmarshal(b, &amp;tmp)\n    if err != nil {\n        return err\n    }\n\n    val, ok := tmp[\"Value\"]\n    if ok &amp;&amp; val == nil {\n        return errors.New(\"Value cannot be nil\")\n\n    }\n    if !ok {\n        return nil\n    }\n\n    f, ok := val.(float64)\n    if !ok {\n        return fmt.Errorf(\"unexpected type %T for Value\", val)\n    }\n\n    n := int(f)\n    i.Value = &amp;n\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/MNDsQpfEJA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MNDsQpfEJA</a></p>\n"}], "owner": {"reputation": 31, "user_id": 2108394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728a94a27a28e5a1e37f461d0610331d?s=128&d=identicon&r=PG", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2108394/ilya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 45721570, "answer_count": 1, "score": 1, "last_activity_date": 1502913792, "creation_date": 1502911468, "last_edit_date": 1502913754, "question_id": 45721470, "link": "https://stackoverflow.com/questions/45721470/how-can-i-know-that-the-field-is-set-to-null", "title": "How can I know that the field is set to null?", "body": "<p>I want to output an error if the field in json contains a value of null. How can I do it? I have tried \"encoding/json\". Maybe I need another library.</p>\n\n<p>Code example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype Item struct {\n    Value  *int\n}\n\n\nfunc main() {\n    var jsonBlob = `[\n        {},\n        {\"Value\": null},\n        {\"Value\": 0},\n        {\"Value\": 1}\n    ]`\n    var items []Item\n\n    err := json.NewDecoder(strings.NewReader(jsonBlob)).Decode(&amp;items)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    for _, a := range items {\n        if a.Value != nil {\n            fmt.Println(*a.Value)\n        } else {\n            fmt.Println(a.Value)\n        }\n    }\n}\n</code></pre>\n\n<p>I got:</p>\n\n<pre><code>&lt;nil&gt;\n&lt;nil&gt;\n0\n1\n</code></pre>\n\n<p>I want:</p>\n\n<pre><code>&lt;nil&gt;\n&lt;error&gt;\n0\n1\n</code></pre>\n\n<p>Please help. Many thanks!</p>\n"}, {"tags": ["go", "closures", "anonymous-function"], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1502909814, "post_id": 45720503, "comment_id": 78400315, "body": "Agreed. As much as I&#39;d like to upvote this, it isn&#39;t technically an answer to the question, so I&#39;ll have to stick with a positive comment ;)"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1502907567, "creation_date": 1502907567, "answer_id": 45720503, "question_id": 45720344, "link": "https://stackoverflow.com/questions/45720344/go-resetting-closure-variable/45720503#45720503", "title": "Go resetting closure variable", "body": "<p>There is no point in doing <code>i := *new(int)</code>. That line says:</p>\n\n<ol>\n<li>Allocate a new <code>int</code></li>\n<li>Create a pointer to it</li>\n<li>Dereference the pointer</li>\n<li>Assign the value to <code>i</code></li>\n</ol>\n\n<p>This is no different from <code>i := 0</code> or <code>var int i</code>, but there's the extra step in the middle of creating, dereferencing, and discarding the pointer that never gets used.</p>\n\n<p>If you want a pointer to an int, use <code>i := new(int)</code>. <code>*new</code> anywhere is a pointless invocation and a code smell.</p>\n"}, {"tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 2, "last_activity_date": 1502907598, "creation_date": 1502907598, "answer_id": 45720511, "question_id": 45720344, "link": "https://stackoverflow.com/questions/45720344/go-resetting-closure-variable/45720511#45720511", "title": "Go resetting closure variable", "body": "<p>No it doesn't. That's the point of the closure. You are initializing an integer variable and storing it on the heap for use by the function the <code>intSeq()</code> function returns. There is no variable initialization happening in the <code>nextInt()</code> function</p>\n\n<p>You will get a new function that uses a new sequence counter starting at 0 for each call to <code>intSeq()</code></p>\n\n<p>Edit: to add to this this is a bad way to get the current behavior. A better way would be to create a new <code>sequence</code> type that contains the method <code>nextInt() int</code>. E.g.:</p>\n\n<pre><code>type Sequence struct {\n    counter int\n}\n\nfunc (s *Sequence) nextInt() int {\n    s.counter++\n    return s.counter\n}\n\nfunc main() {\n    intSeq := new(Sequence)\n    fmt.Println(intSeq.nextInt())\n    fmt.Println(intSeq.nextInt())\n    fmt.Println(intSeq.nextInt())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 3, "last_activity_date": 1502907891, "creation_date": 1502907891, "answer_id": 45720585, "question_id": 45720344, "link": "https://stackoverflow.com/questions/45720344/go-resetting-closure-variable/45720585#45720585", "title": "Go resetting closure variable", "body": "<p>Take a look at how you implemented <code>intSeq</code>.</p>\n\n<pre><code>func intSeq() func() int {\n    i := *new(int)\n    return func() int {\n        i += 1\n        return i\n    }\n}\n</code></pre>\n\n<p>The initialization of <code>i</code> is outside of the function it returns.</p>\n\n<p>So the only time a new pointer is allocated is when you actually call <code>intSeq</code>.</p>\n\n<p>Since you are doing that just two times, that's how many different pointers you got.</p>\n\n<p>That explains why the value is not reset when you just call <code>nextInt</code> (note that executing <code>nextInt</code> means just executing the function returned, which looks like:</p>\n\n<pre><code>func() int {\n   i += 1\n   return i\n}\n</code></pre>\n\n<p>That would not reset the value of <code>i</code> but rather keep incrementing it (until you create a new one by calling <code>intSeq</code> again).</p>\n\n<p>I hope that clarifies.</p>\n"}], "owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1502907891, "creation_date": 1502906918, "question_id": 45720344, "link": "https://stackoverflow.com/questions/45720344/go-resetting-closure-variable", "title": "Go resetting closure variable", "body": "<p>I came upon an example of closures in Go here:\n<a href=\"https://gobyexample.com/closures\" rel=\"nofollow noreferrer\">https://gobyexample.com/closures</a></p>\n\n<p>It gives a pretty straight-forward example of closure scoping in Go. I changed how i is initialized from \"i := 0\" to \"i := *new(int)\".</p>\n\n<pre><code>func intSeq() func() int {\n    i := *new(int)\n    return func() int {\n        i += 1\n        return i\n    }\n}\n\nfunc main() {\n\n    // We call `intSeq`, assigning the result (a function)\n    // to `nextInt`. This function value captures its\n    // own `i` value, which will be updated each time\n    // we call `nextInt`.\n    nextInt := intSeq()\n\n    // See the effect of the closure by calling `nextInt`\n    // a few times.\n    fmt.Println(nextInt())\n    fmt.Println(nextInt())\n    fmt.Println(nextInt())\n\n    // To confirm that the state is unique to that\n    // particular function, create and test a new one.\n    newInts := intSeq()\n    fmt.Println(newInts())\n}\n</code></pre>\n\n<p>The output of this is still 1, 2, 3, 1. Does the variable 'i' in intSeq() not get reallocated everytime nextInt() in main() is called?</p>\n"}, {"tags": ["json", "go", "hashmap", "slice"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1502903407, "creation_date": 1502903407, "answer_id": 45719395, "question_id": 45719297, "link": "https://stackoverflow.com/questions/45719297/golang-json-to-slice-of-maps-of-maps-themselves-containing-slices-without-types/45719395#45719395", "title": "Golang JSON to Slice of Maps of Maps themselves Containing Slices (without Types)", "body": "<p>Both your JSON input, and your \"manual\" example are using maps of slices, not slices of maps.  Change your target type to <code>map[string][]string</code> and you should be good to go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\nvar file = []byte(`{\n    \"recordType1\": [\n        \"field1\", \"field2\", \"field3\", \"field4\", \"field5\"\n    ],\n    \"recordType2\": [\n        \"field1\", \"field2\", \"field3\", \"field4\", \"field5\", \"field6\", \"field7\"\n    ]\n}`)\n\nfunc main() {\n    output := map[string][]string{}\n    if err := json.Unmarshal(file, &amp;output); err != nil {\n        panic(err)\n    }\n    fmt.Println(output)\n}\n</code></pre>\n\n<p>Produces the following output:</p>\n\n<pre><code>map[recordType1:[field1 field2 field3 field4 field5] recordType2:[field1 field2 field3 field4 field5 field6 field7]]\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/q7noWrlzy9\" rel=\"nofollow noreferrer\">Playground link</a>.</p>\n"}], "owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "accepted_answer_id": 45719395, "answer_count": 1, "score": 2, "last_activity_date": 1502903414, "creation_date": 1502903088, "last_edit_date": 1502903414, "question_id": 45719297, "link": "https://stackoverflow.com/questions/45719297/golang-json-to-slice-of-maps-of-maps-themselves-containing-slices-without-types", "title": "Golang JSON to Slice of Maps of Maps themselves Containing Slices (without Types)", "body": "<p>I have a <code>config.json</code> with the following format:</p>\n\n<pre><code>{\n    \"recordType1\": [\n        \"field1\", \"field2\", \"field3\", \"field4\", \"field5\"\n    ],\n    \"recordType2\": [\n        \"field1\", \"field2\", \"field3\", \"field4\", \"field5\", \"field6\", \"field7\"\n    ]\n}\n</code></pre>\n\n<p>If possible, I'd like to convert this to a slice of maps, where each map is itself is a single 'key', and the 'value' is a slice.</p>\n\n<p>I can accomplish this manually like:</p>\n\n<pre><code>package main\n\nimport (\"fmt\")\n\nfunc main() {\n        m := make(map[string][]string, 0)\n        m2 := make(map[string][]string, 0)\n        sliceOfMaps := make([]map[string][]string, 0)\n\n        m[\"recordType1\"] = []string{\"field1\", \"field2\", \"field3\"}\n        m2[\"recordType2\"] = []string{\"field1\", \"field2\", \"field3\", \"field4\", \"field5\"}\n        sliceOfMaps = append(sliceOfMaps, m, m2)\n\n        fmt.Println(m)\n        fmt.Println(m2)\n        fmt.Println(sliceOfMaps)\n}\n</code></pre>\n\n<p>Instead, I'd like to invoke <code>json.Unmarshal</code> on the contents of <code>config.json</code> to parse that json into the very same structure.</p>\n\n<p>What I've tried so far:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n    \"io/ioutil\"\n    \"log\"\n)\n\n\n    func main() {\n        file, err := ioutil.ReadFile(\"config/config.json\")\n        if err != nil {\n                log.Fatal(\"Err Reading File:\", err)\n        }\n\n        var sliceOfMaps []map[string][]string\n        sliceOfMaps = make([]map[string][]string, 0)\n\n        err = json.Unmarshal(file, &amp;sliceOfMaps)\n        if err != nil {\n                log.Fatal(\"Err Parsing JSON\", err)\n        }\n\n        fmt.Println(sliceOfMaps)\n    }\n</code></pre>\n\n<p>This produces error:</p>\n\n<pre><code>Err Parsing JSONjson: cannot unmarshal object into Go value of type []map[string][]string\n</code></pre>\n\n<p>Any assistance is greatly appreciated, clarifying questions welcome. Thanks.</p>\n"}, {"tags": ["heroku", "go"], "comments": [{"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1502908264, "post_id": 45719151, "comment_id": 78399607, "body": "Does your file server have a web interface? Heroku expects your application to bind to port 80 and respond to HTTP requests."}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1502908344, "post_id": 45719151, "comment_id": 78399634, "body": "What filesystem does your file server use? Note that Herku&#39;s filesystem <a href=\"https://devcenter.heroku.com/articles/dynos#ephemeral-filesystem\" rel=\"nofollow noreferrer\">is ephemeral</a>; anything you write to disk will be lost every time your Dyno restarts, which happens at least once per day."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7311047"}, "reply_to_user": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1502908946, "post_id": 45719151, "comment_id": 78399919, "body": "Ohh I didn&#39;t know I need a web-interface... I will add it to the the app.. I&#39;m currently playing aorund with this app a litlle bit I shall code a simple responsive web app but it must be served with go... I currently have now root server so I thought using heroku would be an easy and fast way to archieve this.. I don&#39;t have a credit card so I can&#39;t register for services like Azure or AWS...  I just wanted an easy and free go based way to serve static content for testing and rewieving.. Thnks for the help Chris!"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1502950124, "post_id": 45719151, "comment_id": 78412846, "body": "You do not necessarily need a web interface, iirc. You just need to bind to port 80 and respond with a http.StatusOK for <code>&#47;</code>"}], "owner": {"user_type": "does_not_exist", "display_name": "user7311047"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502902565, "creation_date": 1502902565, "question_id": 45719151, "link": "https://stackoverflow.com/questions/45719151/howto-deploy-an-static-fileserver-built-with-go-to-heroku", "title": "Howto deploy an static fileserver built with Go to Heroku?", "body": "<p>I wanted to deploy an simple static file serevr I built to Heroku but it seems as soons as it is deployed to heroku is crashes immediatly...</p>\n\n<p>I never pushed an Go App to Heroku and I bet my ports config isw wrong...</p>\n\n<p>What confuses me is that it passes th build process and it crashes immeditiatly...</p>\n\n<p>I also uploaded the source code to Github: <a href=\"https://github.com/norbertfuhs/heroku-go-sample-app\" rel=\"nofollow noreferrer\">Sourcecode</a></p>\n\n<p>I bet there are many errors in the code or something I didn't get right with port forwarding at Heroku but any advices or hints would be great!</p>\n"}, {"tags": ["sockets", "http", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1502900985, "post_id": 45718681, "comment_id": 78395629, "body": "The error message is telling you that WriteHeader is called more than once (either directly or indirectly by a call to Write).  The header can only be written to the network once. Both snippets have a call to WriteHeader..."}, {"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1502901097, "post_id": 45718681, "comment_id": 78395697, "body": "okay so the reason it&#39;s so sporadic is that the error would only occur if this was executed: <a href=\"https://github.com/northwesternmutual/kanali/blob/master/steps/writeresponse.go#L66-L68\" rel=\"nofollow noreferrer\">github.com/northwesternmutual/kanali/blob/master/steps/&hellip;</a>"}, {"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1502901180, "post_id": 45718681, "comment_id": 78395733, "body": "@CeriseLim&#243;n if you turn your comment into an answer, I&#39;ll mark it as the correct answer :)"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1502901210, "creation_date": 1502901210, "answer_id": 45718815, "question_id": 45718681, "link": "https://stackoverflow.com/questions/45718681/very-sporadic-go-http-error-multiple-response-writeheader-calls/45718815#45718815", "title": "Very Sporadic Go HTTP Error: multiple response.WriteHeader calls", "body": "<p>The error message is telling you that WriteHeader is called more than once (either directly or indirectly by a call to Write). The header can only be written to the network once. Both snippets have a call to WriteHeader.</p>\n"}], "owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 1, "accepted_answer_id": 45718815, "answer_count": 1, "score": 0, "last_activity_date": 1502901210, "creation_date": 1502900764, "last_edit_date": 1502901010, "question_id": 45718681, "link": "https://stackoverflow.com/questions/45718681/very-sporadic-go-http-error-multiple-response-writeheader-calls", "title": "Very Sporadic Go HTTP Error: multiple response.WriteHeader calls", "body": "<p>I wrote <a href=\"https://github.com/northwesternmutual/kanali\" rel=\"nofollow noreferrer\">Kanali</a> which is an open source Kubernetes Ingress/API management tool and for about <strong>1/200k</strong> requests I receive the following fatal error:</p>\n\n<pre><code>2017/08/16 12:40:57 http: multiple response.WriteHeader calls\n{\"level\":\"error\",\"method\":\"GET\",\"msg\":\"unknown error\",\"time\":\"2017-08-16T12:40:57Z\",\"uri\":\"/ommitted/path\"}\n{\"level\":\"fatal\",\"msg\":\"write tcp4 192.168.2.160:8443-\\u003e192.168.4.0:54554: write: broken pipe\",\"time\":\"2017-08-16T12:40:57Z\"}\n</code></pre>\n\n<p>I'm having a really hard time reproducing it but here is the relevant code. Kanali is a large project but the td;lr is that after this first code snippet is executed, the second code snipped is executed which handles errors.</p>\n\n<pre><code>func (step WriteResponseStep) Do(ctx context.Context, m *metrics.Metrics, c *controller.Controller, w http.ResponseWriter, r *http.Request, resp *http.Response, trace opentracing.Span) error {\n    for k, v := range resp.Header {\n        for _, value := range v {\n            w.Header().Set(k, value)\n        }\n    }\n    closer, str, err := utils.DupReaderAndString(resp.Body)\n    if err != nil {\n        logrus.Errorf(\"error copying response body, response may not be as expected: %s\", err.Error())\n    }\n    trace.SetTag(\"http.status_code\", resp.StatusCode)\n    trace.SetTag(\"http.response_body\", str)\n    w.WriteHeader(resp.StatusCode)\n    if _, err := io.Copy(w, closer); err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>later in the code...</p>\n\n<pre><code>if err != nil {\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n    switch e := err.(type) {\n    case utils.Error:\n        logrus.WithFields(logrus.Fields{\n            \"method\": r.Method,\n            \"uri\":    r.RequestURI,\n        }).Error(e.Error())\n\n        errStatus, err := json.Marshal(utils.JSONErr{Code: e.Status(), Msg: e.Error()})\n        if err != nil {\n            logrus.Warnf(\"could not marsah request headers into JSON - tracing data maybe not be as expected\")\n        }\n        w.WriteHeader(e.Status())\n        if err := json.NewEncoder(w).Encode(utils.JSONErr{Code: e.Status(), Msg: e.Error()}); err != nil {\n            logrus.Fatal(err.Error())\n        }\n    default:\n        logrus.WithFields(logrus.Fields{\n            \"method\": r.Method,\n            \"uri\":    r.RequestURI,\n        }).Error(\"unknown error\")\n        errStatus, err := json.Marshal(utils.JSONErr{Code: http.StatusInternalServerError, Msg: \"unknown error\"})\n        if err != nil {\n            logrus.Warnf(\"could not marsah request headers into JSON - tracing data maybe not be as expected\")\n        }\n        w.WriteHeader(http.StatusInternalServerError)\n        if err := json.NewEncoder(w).Encode(utils.JSONErr{Code: http.StatusInternalServerError, Msg: \"unknown error\"}); err != nil {\n            logrus.Fatal(err.Error())\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1502902065, "post_id": 45718580, "comment_id": 78396225, "body": "What would you expect in the result when the new game is <code>Game{ID: 1, Players: []Player{{&quot;foo&quot;, []{5.0},{&quot;bar&quot;, []{6.7}}}}</code> ?"}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1502902492, "post_id": 45718580, "comment_id": 78396442, "body": "I thought so =( upsert is not going to work for sub-documents. See <a href=\"https://stackoverflow.com/questions/23470658/mongodb-upsert-sub-document\" title=\"mongodb upsert sub document\">stackoverflow.com/questions/23470658/&hellip;</a>"}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1502902757, "post_id": 45718580, "comment_id": 78396601, "body": "Could you add the query you have used to the question? I am extremely curious, as you are pushing to sub-sub-document."}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1502905148, "post_id": 45718580, "comment_id": 78398005, "body": "Thanks for the update. Just to confirm we are on the same page, the plain upsert query finds a game with id 1, and updates <b>first</b> player with players.game_id = 1, and <b>fails</b> if there is no such player, or no such game. Are you happy with this behaviour and just want to code it in go? The upsert part makes no sense in such scenario, so I wanted to confirm it."}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1502906164, "post_id": 45718580, "comment_id": 78398532, "body": "Hmm, not sure if get the last comment. I appreciate your are reducing the problem to mvce, but I think you stripped too much.   To make it clear: with current editions new players cannot be added to the game with a single upsert of stats. Neither you can update multiple existing players in a game with single query."}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1502964154, "post_id": 45718580, "comment_id": 78421744, "body": "okay mate, I have added an answer of how to customise the behaviour. My point I was trying to make in the comments above is that the real problem lies in  <i>&quot;It doesn&#39;t matter which Mongo commands I&#39;m going to use. I&#39;ll figure it out somehow.&quot;</i> - there is no such command. Unfortunately."}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1502966254, "post_id": 45718580, "comment_id": 78423242, "body": "No, not with current data structure. It does not support such operations. Sorry."}], "answers": [{"comments": [{"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "reply_to_user": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1502966094, "post_id": 45732044, "comment_id": 78423120, "body": "told ya =(, anyway I have updated the answer, to make it clear how the &quot;customisation&quot; works."}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "reply_to_user": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1502972275, "post_id": 45732044, "comment_id": 78427419, "body": "I didn&#39;t get this part tbh. Not sure where complexity and errors popped up from, but if you want to make it programatically, just marshal the embedded Game and unmarshal it to bson.M type. Then you can manipulate with the map as you wish. Be aware of consequences tho. With hardcoded bson you catch all errors on compilation. Shifting it to runtime you actually increase code complexity and have to catch errors runtime."}], "tags": [], "owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "is_accepted": true, "score": 2, "last_activity_date": 1502965900, "last_edit_date": 1502965900, "creation_date": 1502963937, "answer_id": 45732044, "question_id": 45718580, "link": "https://stackoverflow.com/questions/45718580/customize-mgo-upsert-operation/45732044#45732044", "title": "Customize mgo upsert operation", "body": "<p>To answer the \"<strong>My Real Question: How can I customize the behaviour of mgo before upsert?</strong>\" - you can customise bson marshalling by defining <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Getter\" rel=\"nofollow noreferrer\">bson Getter</a> to the model. </p>\n\n<p>To illustrate how it works, lets simplify the model to avoid nested documents:</p>\n\n<pre><code>type Game struct {\n    ID int `bson:\"_id\"`\n    Name string\n    Stats [] float64\n}\n</code></pre>\n\n<p>With newGame as following:</p>\n\n<pre><code>newGame := Game{\n    ID: 1,\n    Name: \"foo\",\n    Stats: []{5.0}\n}\n</code></pre>\n\n<p>The update <code>col.UpsertId(newGame.ID, newGame)</code> by default marshals <code>newGame</code> into JSON, producing mongo query like:</p>\n\n<pre><code>update({_id:1}, {name: \"foo\", stats: [5]}, {upsert: true});\n</code></pre>\n\n<p>To make use of <code>$set</code>, <code>$push</code> etc, you can define a custom bson getter. E.g.</p>\n\n<pre><code>func (g Game) GetBSON() (interface{}, error) {\n    return bson.M{\n        \"$set\": bson.M{\"name\": g.Name}, \n        \"$push\": bson.M{\"stats\": bson.M{\"$each\": g.Stats}},\n    }, nil\n}\n</code></pre>\n\n<p>So the update <code>col.UpsertId(newGame.ID, newGame)</code> will produce a mongodb query </p>\n\n<pre><code>update({_id:1}, {$set: {name: \"foo\"}, $push: {stats: {$each: [5]}}}, {upsert: true});\n</code></pre>\n\n<p>To make it crystal clear - the custom marshaler will be used in all mgo queries, so you probably don't want to define it directly to the model, but to its derivative to use in upsert operations only:</p>\n\n<pre><code>type UpdatedGame struct {\n    Game\n}\n\nfunc (g UpdatedGame) GetBSON() (interface{}, error) {\n    return bson.M{....}\n}\n\n.....\n\nnewGame := Game{\n    ID: 1,\n    Name: \"foo\",\n    Stats: []{5.0}\n}\n\ncol.UpsertId(newGame.ID, UpdatedGame{newGame})\n</code></pre>\n"}], "owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "accepted_answer_id": 45732044, "answer_count": 1, "score": 1, "last_activity_date": 1502965900, "creation_date": 1502900353, "last_edit_date": 1502904592, "question_id": 45718580, "link": "https://stackoverflow.com/questions/45718580/customize-mgo-upsert-operation", "title": "Customize mgo upsert operation", "body": "<p>I've a game analytics rest API which stores the average performance statistics of the players. When a new statistic arrives, I want to update the existing game record in Mongodb by merging the new delta onto the existing document. I'm storing the past analytics data as well. So that, I can return data like the player's stats are decreasing or increasing since the game's last update.</p>\n\n<p><strong>The problem is:</strong> When I want to upsert my new game data into Mongodb with mgo, it overwrites all of a player's stats array. Actually, this is expected. I know how to fix it if I can modify my document that mgo tries to upsert into Mongodb.</p>\n\n<p><strong>Question:</strong> How can I customize mgo upsert behaviour? So that I can add a <code>$push</code> operator in front of <code>Player.Stats</code> to prevent Mongodb erasing the <code>stats</code> array inside the document.</p>\n\n<p><strong>My Real Question:</strong> It doesn't matter which Mongo commands I'm going to use. I'll figure it out somehow. What I actually want to know is: How can I customize the behaviour of mgo before upsert?</p>\n\n<p><strong>Some Solutions:</strong> I've tried some solutions myself before. Like, encoding/decoding <code>Game</code> struct into <code>bson.M</code> to customize it. However, I found it cumbersome and messy. If there's no other way, I'd use it.</p>\n\n<p><strong>Blocks:</strong> I don't want to hand-write all of my structs fields with <code>bson.M</code>, just to use a <code>$push</code> operator on one field. Because there are dozens of fields, that would be error-prone and will increase my code complexity.</p>\n\n<hr>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>// Assume that, this is an existing game in Mongodb:\nexistingGame := Game{\n    ID: 1,\n    Name: \"Existing game\",\n    // The game has just one player\n    Players: []Player{\n        // The player has some stats. The newest one is 2.0.\n        {1, \"foo\", []{3.5, 2.0}},\n    }\n}\n\n// This is a new request coming to my API\n// I want to upsert this into the existing Game\nnewGame := Game{\n    ID: 1,\n    Players: []Player{\n        // As expectedly, this will reset player foo's stats to 5.0\n        //\n        // After upserting, I want it to be as: \n        //\n        // []{3.5, 2.0, 5.0}\n        //\n        // in Mongodb\n        {1, \"foo\", []{5.0}},\n    }\n}\n\n// Example 2:\n// If new Game request like this:\nnewGame := Game{ID: 1, Players: []Player{{1, \"foo\", []{5.0},{1, \"bar\", []{6.7}}}}\n// I'm expecting this result:\nGame{ID: 1, Players: []Player{{1, \"foo\", []{3.5, 2.0, 5.0},{1, \"bar\", []{6.7}}}}\n\nfunc (db *Store) Merge(newGame *Game) error {\n    sess := db.session.Copy()\n    defer sess.Close()\n\n    col := sess.DB(\"foo\").C(\"games\")\n    // I want to modify newGame here to add a $push operator\n    // into a new `bson.M` or `bson.D` to make mgo to upsert\n    // my new delta without resetting the player stats\n    _, err := col.UpsertId(newGame.ID, newGame)\n\n    return err\n}\n\ntype Game struct {\n    ID int `bson:\"_id\"`\n    Name string\n    Players []Player `bson:\",omitempty\"`\n    // ...I omitted other details for simplicity here...\n}\n\ntype Player struct {\n    // This connects the player to the game\n    GameID int `bson:\"game_id\"`\n    Name string\n    // I want to keep the previous values of stats\n    // So, that's why I'm using an array here\n    Stats []float64\n    // ...\n}\n</code></pre>\n\n<p>I tried this Mongodb command in the console to update the specific game's player:</p>\n\n<pre><code>db.competitions.update({\n   _id: 1,\n   \"players.game_id\": 1\n}, {\n   $push: { \n       \"players.$.stats\": 3\n   }\n}, {\n   upsert: true\n})\n</code></pre>\n"}, {"tags": ["go", "windows-services"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1502887141, "post_id": 45713666, "comment_id": 78385584, "body": "Does your Execute function have an empty body? If so, you need to send status updates to the system via the <code>changes</code> channel. Use the <a href=\"https://github.com/golang/sys/tree/master/windows/svc/example\" rel=\"nofollow noreferrer\">svc service example</a> as a base for your service."}, {"owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1502887968, "post_id": 45713666, "comment_id": 78386210, "body": "no it does not, it sends data to SCM, my bad, i will add that code"}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1502960927, "post_id": 45713666, "comment_id": 78419344, "body": "Can you show <code>main.go</code> file and how you build it?"}, {"owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "edited": false, "score": 0, "creation_date": 1503408752, "post_id": 45713666, "comment_id": 78595702, "body": "When I change the &quot;Log On As&quot; attribute of the Service to &quot;administrator&quot;, the Service starts on windows reboot, It does not start for &quot;Local System&quot; or &quot;Local Service&quot;. I know its not a good practice to have Service &quot;RunAsAdministrator&quot;, what could be the issue here, why wont it accept &quot;LocalSystem&quot; user."}], "answers": [{"tags": [], "owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "is_accepted": true, "score": 0, "last_activity_date": 1503757675, "last_edit_date": 1503757675, "creation_date": 1503485979, "answer_id": 45837827, "question_id": 45713666, "link": "https://stackoverflow.com/questions/45713666/service-is-not-starting-in-windows/45837827#45837827", "title": "Service is not starting in Windows", "body": "<p>I have the GO exe deployed in Program Files, I changed the LogOnAs attribute of Windows Service to \"Local Service\" and gave \"Local Service\" complete Access to the installation folder in \"Folder Security\". </p>\n\n<p>This seems to fix the issue for windows10. The service starts on windows restart, But this fix still does not work for windows 7 and windows8.</p>\n\n<p>Edit:</p>\n\n<p>Making the service \"Automatic Delayed\" works, however you have to wait for the service start after boot which takes 2-3 minutes.</p>\n\n<p>The answer mentioned here helped: <a href=\"https://serverfault.com/questions/697608/automatic-windows-service-not-starting/697852#697852?newreg=788f7ab0bb084fec85d1ce2e51bf8317\">https://serverfault.com/questions/697608/automatic-windows-service-not-starting/697852#697852?newreg=788f7ab0bb084fec85d1ce2e51bf8317</a></p>\n"}], "owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 1, "accepted_answer_id": 45837827, "answer_count": 1, "score": 1, "last_activity_date": 1585331671, "creation_date": 1502886795, "last_edit_date": 1585331671, "question_id": 45713666, "link": "https://stackoverflow.com/questions/45713666/service-is-not-starting-in-windows", "title": "Service is not starting in Windows", "body": "<p>I have created an executable in Go and I am running it as a windows service.</p>\n\n<p>I am using golang.org/x/sys/windows/svc package, and provide it with the Execute method which gets called by the SCM</p>\n\n<pre><code>run := svc.Run\n_ = run(svcName, &amp;myservice{})\n\nfunc (m *myservice) Execute(args []string, r &lt;-chan svc.ChangeRequest, changes chan&lt;- svc.Status) (ssec bool, errno uint32) {\n\n    changes &lt;- svc.Status{State: svc.StartPending}\n\n    go mainmethod()\n\n    changes &lt;- svc.Status{State: svc.Running, Accepts: cmdsAccepted}\n\n\n}\n</code></pre>\n\n<p>The service works most of the time but the problem is that whenever I restart my system, the service gives me a Error 1053 : \"The service did not respond to start or control request in a timely fashion\" error and does not start, </p>\n\n<p>After adding the log statements in my run and Execute methods, I figured out that when the service starts without error the logs get printed, but when the services gives a 1053 error the SCM does not even invoke my exe, since none of the log statements get printed.\nHas anyone tried creating a windows service in a similar way? Is it a problem with implementation or the windows svc package?</p>\n"}, {"tags": ["php", "encryption", "go", "aes"], "comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1502894171, "post_id": 45712450, "comment_id": 78390935, "body": "Of course the best solution is to change the Rijndael block size to 128-bits on the other side and eliminate interoperability issues now and in the future."}, {"owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1502895163, "post_id": 45712450, "comment_id": 78391681, "body": "That would be ideal, but unfortunately I can&#39;t do that because I don&#39;t have control of the other side (and there is no easy way for me to gain it)."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 5, "creation_date": 1502914043, "post_id": 45712450, "comment_id": 78402312, "body": "Rijndael-256, as quite clearly stated, isn&#39;t AES. It&#39;s Rijndael. You need an implementation of this for your go code. The reason you need a 32 byte IV is because the block size of Rijndael-256 is 256 bits."}], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 1794868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d38735ace6812249cebf3bcc4605b9f?s=128&d=identicon&r=PG", "display_name": "itscaro", "link": "https://stackoverflow.com/users/1794868/itscaro"}, "is_accepted": false, "score": 2, "last_activity_date": 1513692077, "creation_date": 1513692077, "answer_id": 47888640, "question_id": 45712450, "link": "https://stackoverflow.com/questions/45712450/decrypting-using-go-a-string-encrypted-in-php-using-mcrypt-rijndael-256/47888640#47888640", "title": "Decrypting using Go a string encrypted in php using MCRYPT_RIJNDAEL_256", "body": "<p>Since in Golang you have only built-in standard AES crypto, you need to implement the Rijndael crypto yourself.</p>\n\n<p>I found one here: <a href=\"https://github.com/celso-wo/rijndael256/blob/master/rijndael256.go\" rel=\"nofollow noreferrer\">https://github.com/celso-wo/rijndael256/blob/master/rijndael256.go</a></p>\n"}], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 2, "answer_count": 1, "score": 9, "last_activity_date": 1513692077, "creation_date": 1502883189, "last_edit_date": 1513170416, "question_id": 45712450, "link": "https://stackoverflow.com/questions/45712450/decrypting-using-go-a-string-encrypted-in-php-using-mcrypt-rijndael-256", "title": "Decrypting using Go a string encrypted in php using MCRYPT_RIJNDAEL_256", "body": "<p>In PHP, <code>mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC);</code> returns a value of 32, thus apparently saying that AES-256 wants an Initialization Vector of 32 bytes. But this is deceiving, as said in the <a href=\"http://php.net/manual/it/function.mcrypt-encrypt.php#117667\" rel=\"nofollow noreferrer\">comments for <code>mcrypt_encrypt</code></a>:</p>\n\n<blockquote>\n  <p>Also, <code>MCRYPT_RIJNDAEL_256</code> is not AES-256, it's a different variant of the Rijndael block cipher. If you want AES-256 in mcrypt, you have to use <code>MCRYPT_RIJNDAEL_128</code> with a 32-byte key. OpenSSL makes it more obvious which mode you are using (i.e. 'aes-128-cbc' vs 'aes-256-ctr').</p>\n</blockquote>\n\n<p>So of course, with an IV of 32 bytes, the following example does not work in Go (it causes a panic).</p>\n\n<pre><code>score := decodePost(c.PostForm(\"score\"))\niv := decodePost(c.PostForm(\"iv\"))\n\naesKey := getAESKey()\nbaseAES, err := aes.NewCipher([]byte(aesKey))\nif err != nil {\n    c.AbortWithError(500, err)\n    return\n}\nblock := cipher.NewCBCDecrypter(baseAES, []byte(iv))\nblock.CryptBlocks(score, score)\n</code></pre>\n\n<p>Quoting from the docs of <code>crypto/cipher</code>:</p>\n\n<blockquote>\n  <p>The length of iv must be the same as the Block's block size and must match the iv used to encrypt the data.</p>\n</blockquote>\n\n<p>(And of course, the <a href=\"https://golang.org/pkg/crypto/aes/#pkg-constants\" rel=\"nofollow noreferrer\">AES block size in Go is 16 bytes</a>).</p>\n\n<p>So, finally, how can I decrypt such string in Go?</p>\n"}, {"tags": ["go", "websocket", "gorilla"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1502883774, "post_id": 45712108, "comment_id": 78383116, "body": "Think about what a &quot;request sessions&quot; could mean technically for server and client/browser side and what you would do to &quot;identify&quot; a user. Then it will become clear that the answer is no."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1502887160, "last_edit_date": 1502887160, "creation_date": 1502884479, "answer_id": 45712878, "question_id": 45712108, "link": "https://stackoverflow.com/questions/45712108/is-it-possible-to-access-http-request-from-a-websocket-connection/45712878#45712878", "title": "Is it possible to access HTTP request from a websocket connection?", "body": "<p>With the Gorilla websocket package, the application writes an HTTP handler and calls the <code>upgrader.Upgrade</code> method to get a connection. Here's an example:</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    conn, err := upgrader.Upgrade(w, r, nil)\n    if err != nil {\n        log.Println(err)\n        return\n    }\n    ... Use conn to send and receive messages.\n}\n</code></pre>\n\n<p>The application has access to the <code>*http.Request</code> in the HTTP handler function and can use the request as normal.</p>\n"}], "owner": {"reputation": 57, "user_id": 3565093, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Llcy1.jpg?s=128&g=1", "display_name": "ma3x", "link": "https://stackoverflow.com/users/3565093/ma3x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502887160, "creation_date": 1502882223, "question_id": 45712108, "link": "https://stackoverflow.com/questions/45712108/is-it-possible-to-access-http-request-from-a-websocket-connection", "title": "Is it possible to access HTTP request from a websocket connection?", "body": "<p>I'm using gorilla websocket. Is it possible to access HTTP request from <code>*websocket.Conn</code>?</p>\n\n<p>I want to access request sessions to identify user. Is there a way to do that other than generating a token on websocket registration and using that in further interactions?</p>\n"}, {"tags": ["testing", "go", "synchronization", "mutex", "parallel-testing"], "comments": [{"owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "edited": false, "score": 2, "creation_date": 1502885379, "post_id": 45711053, "comment_id": 78384203, "body": "That&#39;s one of the reasons why global variables aren&#39;t recommended... :)"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1502885375, "creation_date": 1502885375, "answer_id": 45713197, "question_id": 45711053, "link": "https://stackoverflow.com/questions/45711053/what-is-the-best-way-to-synchronize-tests-in-different-packages-which-involve-wi/45713197#45713197", "title": "What is the best way to synchronize tests in different packages which involve with a global variable?", "body": "<p>This question is impossibly broad. <a href=\"http://amzn.to/2fJWWcO\" rel=\"nofollow noreferrer\">Entire books</a> have been written on the topic.</p>\n\n<p>But since you asked specifically about global variables, the simplest answer is:  Don't use global variables.</p>\n\n<p>We're always taught that global variables are an anti-pattern. Testing is one of the main reasons that global variables and singletons is an anti-pattern.</p>\n\n<p>If possible, refactor your global state to <em>at least allow</em> an instance variable, rather than a global.  Then you can pass that instance into your functions for testing.</p>\n\n<p>As a simplified example, suppose you have the following global variable, and a function which uses it:</p>\n\n<pre><code>var globalFoo = 123\n\nfunc doFoo() string {\n    return fmt.Sprintf(\"foo = %d\", globalFoo)\n}\n</code></pre>\n\n<p>Modify your function to take your variable as an argument:</p>\n\n<pre><code>func doFoo(foo int) string {\n    return fmt.Sprintf(\"foo = %d\", foo)\n}\n</code></pre>\n\n<p>This can be more complicated if your global state is a database connection, or a large number of variables, but the principle is the same: Don't use globals; pass variables instead.</p>\n\n<p>In a legacy codebase, one method to allow testing, without changing your function signatures, is to create simple wrapping functions:</p>\n\n<pre><code>func doFoo() string {\n    return realDoFoo(globalFoo)\n}\n\nfunc realDoFoo(foo int) string {\n    fmt.Sprintf(\"foo = %s\", foo)\n}\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 627910, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dbbcaccdf27384834b214f46e002fa1c?s=128&d=identicon&r=PG", "display_name": "Bo Ye", "link": "https://stackoverflow.com/users/627910/bo-ye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502885375, "creation_date": 1502879134, "last_edit_date": 1502885023, "question_id": 45711053, "link": "https://stackoverflow.com/questions/45711053/what-is-the-best-way-to-synchronize-tests-in-different-packages-which-involve-wi", "title": "What is the best way to synchronize tests in different packages which involve with a global variable?", "body": "<p>I'm working on a go project, my task is writing some tests for a package. The tests need to access a global variable in a different package. This global variable might be setup/access in different packages' testing. Because by default go testing runs in parallel for different packages. Therefore, setup/access to this variable might create race conditions. </p>\n\n<p>The easiest way to synchronize is to create a shared <strong>sync.Mutex</strong> which spans in the different packages. Having said that, I tried to put this <strong>sync.Mutex</strong> in the xxx_test.go of xxx.go in which the global variable is declared, unfortunately, another package was not able to access this Mutex due to scope limitation. Eventually, I figured out I have to put this <strong>sync.Mutex</strong> to a utility package which is dedicated to testing, then different packages can access this Mutex to achieve sync purpose for that global variable.</p>\n\n<p>I'm new to go lang. I just felt it's awkward that I need to create a utility package to just achieve sync purpose in the testing, on the other hand, if another developer does some testing in another package, he/she probably doesn't know where to find this <strong>sync.Mutex</strong>. Is there any better way to achieve this sync purpose with an elegant solution. </p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["go", "base64"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1502879037, "post_id": 45710875, "comment_id": 78379923, "body": "Have a look at the <a href=\"https://github.com/vincent-petithory/dataurl\" rel=\"nofollow noreferrer\"><code>dataturl</code> package</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1502885554, "post_id": 45710875, "comment_id": 78384328, "body": "There is no file extension there, so how can it be extracted?"}], "answers": [{"tags": [], "owner": {"reputation": 1044, "user_id": 1949322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b49c06625a28488b90d2b7f960163f?s=128&d=identicon&r=PG", "display_name": "WaltPurvis", "link": "https://stackoverflow.com/users/1949322/waltpurvis"}, "is_accepted": false, "score": 2, "last_activity_date": 1502889037, "creation_date": 1502889037, "answer_id": 45714513, "question_id": 45710875, "link": "https://stackoverflow.com/questions/45710875/how-to-extract-file-extension-from-base64-encoded-file-in-golang/45714513#45714513", "title": "How to extract file extension from base64 encoded file in golang?", "body": "<p>It's simple enough to use string/byte functions to extract the mime type \u2014 i.e., the part between <code>data:</code> and <code>;base64</code>.</p>\n\n<p>Then you can use the standard mime package to get the extension from the type:<br>\n<a href=\"https://golang.org/pkg/mime/#ExtensionsByType\" rel=\"nofollow noreferrer\">https://golang.org/pkg/mime/#ExtensionsByType</a></p>\n"}, {"tags": [], "owner": {"reputation": 4804, "user_id": 1029506, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/nvmyN.jpg?s=128&g=1", "display_name": "Manish Jangir", "link": "https://stackoverflow.com/users/1029506/manish-jangir"}, "is_accepted": false, "score": 0, "last_activity_date": 1543861897, "creation_date": 1543861897, "answer_id": 53599747, "question_id": 45710875, "link": "https://stackoverflow.com/questions/45710875/how-to-extract-file-extension-from-base64-encoded-file-in-golang/53599747#53599747", "title": "How to extract file extension from base64 encoded file in golang?", "body": "<p>There is a good golang package seems to be there on github <a href=\"https://github.com/vincent-petithory/dataurl\" rel=\"nofollow noreferrer\">https://github.com/vincent-petithory/dataurl</a> that gives whole information about a base64 image URI string.</p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2093, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1543861897, "creation_date": 1502878591, "last_edit_date": 1502898322, "question_id": 45710875, "link": "https://stackoverflow.com/questions/45710875/how-to-extract-file-extension-from-base64-encoded-file-in-golang", "title": "How to extract file extension from base64 encoded file in golang?", "body": "<p>I want to allow users to upload files as base64 encoded. \nThe results are like:</p>\n\n<pre><code>data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kA...\n</code></pre>\n\n<p>or </p>\n\n<pre><code>  data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfAAAAAXNSR0IArs4c6QAAAARnQU...\n</code></pre>\n\n<p>So I'm wondering what is the idomatic way to extract the file extension from the encoded file strings?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 19, "last_activity_date": 1502877356, "creation_date": 1502877356, "answer_id": 45710447, "question_id": 45710188, "link": "https://stackoverflow.com/questions/45710188/assign-default-value-for-struct-field/45710447#45710447", "title": "Assign default value for struct field", "body": "<p>This is not possible. The best you can do is use a constructor method:</p>\n\n<pre><code>type abc struct {\n    prop1 int\n    prop2 int  // default value: 0\n}\n\nfunc New(prop1 int) abc {\n    return abc{\n        prop1: prop1,\n        prop2: someDefaultValue,\n    }\n}\n</code></pre>\n\n<p>But also note that all values in Go <em>automatically</em> default to their zero value. The zero value for an <code>int</code> is already <code>0</code>. So if the default value you want is literally <code>0</code>, you already get that for free.  You only need a constructor if you want some default value other than the zero value for a type.</p>\n"}], "owner": {"reputation": 1347, "user_id": 4622470, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6015804f9937b6231b4b0022d70b5ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohanil", "link": "https://stackoverflow.com/users/4622470/rohanil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27214, "favorite_count": 1, "closed_date": 1502877826, "accepted_answer_id": 45710447, "answer_count": 1, "score": 7, "last_activity_date": 1574545803, "creation_date": 1502876601, "last_edit_date": 1574545803, "question_id": 45710188, "link": "https://stackoverflow.com/questions/45710188/assign-default-value-for-struct-field", "closed_reason": "Duplicate", "title": "Assign default value for struct field", "body": "<p>I want to assign default value for struct field in Go. I am not sure if it is possible but while creating/initializing object of the struct, if I don't assign any value to the field, I want it to be assigned from default value. Any idea how to achieve it?</p>\n\n<pre><code>type abc struct {\n    prop1 int\n    prop2 int  // default value: 0\n}\nobj := abc{prop1: 5}\n// here I want obj.prop2 to be 0\n</code></pre>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 33032, "user_id": 6603816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ecdaa8afcbc3d826ef9beac53b2a1f?s=128&d=identicon&r=PG&f=1", "display_name": "yamenk", "link": "https://stackoverflow.com/users/6603816/yamenk"}, "edited": false, "score": 0, "creation_date": 1502876284, "post_id": 45709952, "comment_id": 78378084, "body": "try to run docker container attach &lt;container-name&gt;"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1502877483, "post_id": 45709952, "comment_id": 78378932, "body": "Don&#39;t ignore errors. There&#39;s an excellent chance the error you&#39;re ignoring would tell you what&#39;s wrong."}, {"owner": {"reputation": 1, "user_id": 8471585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3898b93f85efddec08c59b763d28c22b?s=128&d=identicon&r=PG&f=1", "display_name": "atakancicek", "link": "https://stackoverflow.com/users/8471585/atakancicek"}, "edited": false, "score": 1, "creation_date": 1502881500, "post_id": 45709952, "comment_id": 78381668, "body": "You were right it gives an EOF error."}], "owner": {"reputation": 1, "user_id": 8471585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3898b93f85efddec08c59b763d28c22b?s=128&d=identicon&r=PG&f=1", "display_name": "atakancicek", "link": "https://stackoverflow.com/users/8471585/atakancicek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502877460, "creation_date": 1502875887, "last_edit_date": 1502877460, "question_id": 45709952, "link": "https://stackoverflow.com/questions/45709952/continuous-empty-console-input-in-docker", "title": "Continuous empty console input in Docker", "body": "<p>I'm trying to run a Go console program in Docker. Everything works fine except the part where I take console input. The part that doesn't work is this:</p>\n\n<pre><code>func ListenTerminalInput() {\n    reader := bufio.NewReader(os.Stdin)\n    in := \"\"\n    for in != \"exit\" {\n        in, _ = reader.ReadString('\\n')\n        in = strings.Replace(in, \"\\n\", \"\", -1)\n        in = strings.ToLower(in)\n        switch in {\n        case \"exit\":\n            continue\n        case \"status\":\n            PrintStatus()\n            continue\n        case \"servers\":\n            PrintServers()\n            continue\n        case \"clients\":\n            PrintClients()\n            continue\n        case \"help\":\n            PrintHelp()\n            continue\n\n        default:\n            fmt.Println(\"Please make a valid choice. Type \\\"help\\\" for help.\")\n        }\n    }\n}\n</code></pre>\n\n<p>This code writes default statement to the console as fast as for loop executes. It only does this when it is execute in Docker container, if I execute it outside the container it works fine.</p>\n\n<p>Here is my Dockerfile</p>\n\n<pre><code>FROM golang:1.9\n\nMAINTAINER H\u00fcseyin Atakan \u00c7i\u00e7ek\n\nEXPOSE 56566\nEXPOSE 56567\n\nVOLUME /shared\n\nWORKDIR /shared\n\nCMD [\"go\", \"run\", \"server.go\"]m\n</code></pre>\n\n<p>Here is my docker-compose.yml</p>\n\n<pre><code>   version: '3'\n   services:\n\n     server:\n       image: goserver\n       ports:\n        - \"56566:56566\"\n        - \"56567:56567\"\n       volumes:\n         - ./shared:/shared\n</code></pre>\n\n<p>Here is the output I get when I run it in Docker</p>\n\n<p><a href=\"https://i.stack.imgur.com/0w7Dn.jpg\" rel=\"nofollow noreferrer\">Docker execution console output</a></p>\n\n<p>Here is the output I get when I run it outside Docker</p>\n\n<p><a href=\"https://i.stack.imgur.com/IRJK0.jpg\" rel=\"nofollow noreferrer\">Normal execution console output</a></p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 31, "user_id": 6127610, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/99c88f2a24ab189937588a8819a58b91?s=128&d=identicon&r=PG", "display_name": "rfyiamcool", "link": "https://stackoverflow.com/users/6127610/rfyiamcool"}, "edited": false, "score": 0, "creation_date": 1502870109, "post_id": 45707915, "comment_id": 78373959, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35315176/redis-lua-script-not-working\">Redis lua script not working</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1502884612, "creation_date": 1502884612, "answer_id": 45712927, "question_id": 45707915, "link": "https://stackoverflow.com/questions/45707915/why-does-redigo-return-err-unknown-command-evalsha/45712927#45712927", "title": "Why does redigo return ERR unknown command &#39;EVALSHA&#39;", "body": "<p>You are using an old version of Redis. Upgrade to version 2.6 or later.</p>\n"}], "owner": {"reputation": 31, "user_id": 6127610, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/99c88f2a24ab189937588a8819a58b91?s=128&d=identicon&r=PG", "display_name": "rfyiamcool", "link": "https://stackoverflow.com/users/6127610/rfyiamcool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549100712, "creation_date": 1502869695, "last_edit_date": 1549100712, "question_id": 45707915, "link": "https://stackoverflow.com/questions/45707915/why-does-redigo-return-err-unknown-command-evalsha", "title": "Why does redigo return ERR unknown command &#39;EVALSHA&#39;", "body": "<p><a href=\"https://github.com/garyburd/redigo\" rel=\"nofollow noreferrer\">https://github.com/garyburd/redigo</a></p>\n\n<p><strong>Why does redigo return error message?</strong></p>\n\n<p>error message:</p>\n\n<pre><code>ERR unknown command 'EVALSHA'\nERR unknown command 'EVALSHA'\n</code></pre>\n\n<p>code:</p>\n\n<pre><code>const lockScript = `\nlocal v = redis.call(\"GET\", KEYS[1])\nif v == false or v == ARGV[1]\nthen\n    return redis.call(\"SET\", KEYS[1], ARGV[1], \"EX\", ARGV[2]) and 1\nelse\n    return 0\nend\n`\n\nfunc CounterRegScript() {\n    rc := RedisClient.Get()\n    defer rc.Close()\n\n    script := redis.NewScript(1, lockScript)\n    resp, err := script.Do(rc, \"xiaorui.cc\", \"nima\", int64(3))\n    fmt.Println(resp)\n    fmt.Println(err)\n}\n</code></pre>\n"}, {"tags": ["go", "goland"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1502868328, "post_id": 45707324, "comment_id": 78372856, "body": "Read the message carefully: These are different types. One is from package <code>...&#47;furtif&#47;vendor...</code>, the other from <code>...&#47;security&#47;vendor&#47;...</code>. Fix your vendoring."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1502890249, "post_id": 45707522, "comment_id": 78387993, "body": "It&#39;s not the import statements at issue. It&#39;s that there are two separately-vendored copies of the same library in the GOPATH - seems like they&#39;ve imported a library that uses vendoring which is, as always, a Bad Thing\u2122."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 1, "last_activity_date": 1502868585, "creation_date": 1502868585, "answer_id": 45707522, "question_id": 45707324, "link": "https://stackoverflow.com/questions/45707324/inconsistent-type-in-golang-cannot-use-type-as-type/45707522#45707522", "title": "Inconsistent type in golang, cannot use &lt;Type&gt; as &lt;Type&gt;", "body": "<p>You need to fix your import statements to properly point the import types from where they should belong to. Read the error message.</p>\n"}, {"tags": [], "owner": {"reputation": 225, "user_id": 4321151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H3dyj.jpg?s=128&g=1", "display_name": "Gokul Raj Kumar", "link": "https://stackoverflow.com/users/4321151/gokul-raj-kumar"}, "is_accepted": false, "score": 3, "last_activity_date": 1535460050, "creation_date": 1535460050, "answer_id": 52058179, "question_id": 45707324, "link": "https://stackoverflow.com/questions/45707324/inconsistent-type-in-golang-cannot-use-type-as-type/52058179#52058179", "title": "Inconsistent type in golang, cannot use &lt;Type&gt; as &lt;Type&gt;", "body": "<p>The issue is due to the same library imported in two different vendor folders.\nIf you are trying to use the application 2 only as a library, removing the vendor folder in the application 2 will solve this issue.</p>\n"}, {"tags": [], "owner": {"reputation": 664, "user_id": 3345171, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f5dee6cc914cf94974a97b729d87a978?s=128&d=identicon&r=PG&f=1", "display_name": "ozzieisaacs", "link": "https://stackoverflow.com/users/3345171/ozzieisaacs"}, "is_accepted": false, "score": -1, "last_activity_date": 1541000078, "creation_date": 1541000078, "answer_id": 53087070, "question_id": 45707324, "link": "https://stackoverflow.com/questions/45707324/inconsistent-type-in-golang-cannot-use-type-as-type/53087070#53087070", "title": "Inconsistent type in golang, cannot use &lt;Type&gt; as &lt;Type&gt;", "body": "<p>This error happened to me because I had a type declared more than once across the same package.</p>\n"}], "owner": {"reputation": 750, "user_id": 2690165, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/f0fab7c7aace5c1103b6cc490206c8e0?s=128&d=identicon&r=PG&f=1", "display_name": "Lucian", "link": "https://stackoverflow.com/users/2690165/lucian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7124, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1541000078, "creation_date": 1502867898, "question_id": 45707324, "link": "https://stackoverflow.com/questions/45707324/inconsistent-type-in-golang-cannot-use-type-as-type", "title": "Inconsistent type in golang, cannot use &lt;Type&gt; as &lt;Type&gt;", "body": "<p>I am writing an application in Go that uses a Logger object type.\n<br>In it I use another application that uses the same logger object type:\n<BR>App1:</p>\n\n<pre><code>import \"gitlab.sio.com/go/zlog\"\n\nvar logger = zlog.New(append(opts,\n    zlog.App(c.Name, typ, version),\n    zlog.Env(c.Environment),\n)...)\n....\nrouter.GET(\"/get\", GetHandler(logger))\n....\nfunc GetHandler(logger *zlog.Logger){\n    ....\n    mdl, _ := security.New(*logger)\n    ....\n}\n</code></pre>\n\n<p>App2(security.New from security lib):</p>\n\n<pre><code>package security\n\nimport \"gitlab.sio.com/go/zlog\"\n\nMiddleware struct {\n    log             zlog.Logger\n}\n\nfunc New(log zlog.Logger){\n...\nmdw := Middleware{}\nmdw.log = log\n}\n</code></pre>\n\n<p>The error what I'm getting at line </p>\n\n<blockquote>\n  <p>mdl, _ := security.New(*logger)</p>\n</blockquote>\n\n<p>is:</p>\n\n<blockquote>\n  <p>cannot use *logger (type \"gitlab.sio.com/go/furtif/vendor/gitlab.sio.com/go/zlog\".Logger) as type \"gitlab.sio.com/go/security/vendor/gitlab.sio.com/go/zlog\".Logger in argument to security.New</p>\n</blockquote>\n"}, {"tags": ["php", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1502864141, "post_id": 45705930, "comment_id": 78370524, "body": "Assert the actual type and you are done. Work through <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">tour.golang.org/methods/15</a> and the following. Use the <code>%T</code> verb of Printf to see the actual type if undocumented."}, {"owner": {"reputation": 466, "user_id": 8307258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L8i2o.jpg?s=128&g=1", "display_name": "Rados\u0142aw Za\u0142uska", "link": "https://stackoverflow.com/users/8307258/rados%c5%82aw-za%c5%82uska"}, "edited": false, "score": 0, "creation_date": 1502864337, "post_id": 45705930, "comment_id": 78370610, "body": "This can help <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#type_switch</a>"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1502864809, "post_id": 45705930, "comment_id": 78370815, "body": "Actual example of decoding various types can be found at <a href=\"https://github.com/yvasiyarov/php_session_decoder/blob/master/php_serialize/unserialize_test.go\" rel=\"nofollow noreferrer\">https://github.com/yvasiyarov/php_session_decoder/blob/maste&zwnj;&#8203;r/php_serialize/unse&zwnj;&#8203;rialize_test.go</a>."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7675536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78df3de8e5e23456cc361f0bfa7fa7d8?s=128&d=identicon&r=PG&f=1", "display_name": "Poisoner", "link": "https://stackoverflow.com/users/7675536/poisoner"}, "edited": false, "score": 0, "creation_date": 1502893521, "post_id": 45709646, "comment_id": 78390457, "body": "thank you, your answer is good .It helped me understand type assert better"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 1, "last_activity_date": 1502875076, "creation_date": 1502875076, "answer_id": 45709646, "question_id": 45705930, "link": "https://stackoverflow.com/questions/45705930/how-to-get-values-from-a-interface-in-golang/45709646#45709646", "title": "how to get values from a interface in golang", "body": "<p>Here some ways to access the data:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/yvasiyarov/php_session_decoder/php_serialize\"\n)\n\nfunc main() {\n    // this string is generated from php code\n    str := `a:3:{s:4:\"name\";s:3:\"tom\";s:3:\"age\";s:2:\"23\";s:7:\"friends\";a:2:{i:0;a:1:{s:4:\"name\";s:5:\"jerry\";}i:1;a:1:{s:4:\"name\";s:4:\"jack\";}}}`\n\n    decoder := php_serialize.NewUnSerializer(str)\n\n    result, err := decoder.Decode()\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(result)\n\n    // simple assert\n    t := result.(php_serialize.PhpArray)\n    // use php_seriale build in function to get string\n    strVal := php_serialize.PhpValueString(t[\"name\"])\n    fmt.Println(strVal)\n\n    // type switch in case of different valid types\n    switch t := result.(type) {\n    default:\n        fmt.Printf(\"unexpected type %T\\n\", t) // %T prints whatever type t has\n    case php_serialize.PhpArray:\n        fmt.Println(t)\n        fmt.Println(t[\"name\"])\n        fmt.Println(t[\"age\"])\n\n        // should be done recursively...\n        switch f := t[\"friends\"].(type) {\n        default:\n            fmt.Printf(\"unexpected type %T\\n\", f) // %T prints whatever type t has\n        case php_serialize.PhpArray:\n            fmt.Println(f)\n            fmt.Println(f[0])\n            fmt.Println(f[1])\n        }\n    }\n}\n</code></pre>\n\n<p>I hope this gives you some ideas.</p>\n\n<h3>Basic concept</h3>\n\n<ul>\n<li><code>php_serialize</code> has built in functions to convert primitives.</li>\n<li>Variable structures are represented with built in types which need to be used to access the structure.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 473, "user_id": 3314232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3Bym.jpg?s=128&g=1", "display_name": "Saeed Falsafin", "link": "https://stackoverflow.com/users/3314232/saeed-falsafin"}, "is_accepted": false, "score": 4, "last_activity_date": 1502875131, "creation_date": 1502875131, "answer_id": 45709662, "question_id": 45705930, "link": "https://stackoverflow.com/questions/45705930/how-to-get-values-from-a-interface-in-golang/45709662#45709662", "title": "how to get values from a interface in golang", "body": "<p>You must assert the <code>result</code> to <code>map[string]interface</code>:</p>\n\n<pre><code>mResult := result.(map[string]interface{})\nfmt.Println(mResult[\"name\"])\n</code></pre>\n\n<p>And once more assertion for <code>friends</code>: </p>\n\n<pre><code>mFriends := mResult[\"friends\"].(map[int]map[string]interface{}) \n</code></pre>\n\n<p>Then use it: <code>mFriends[0][\"name\"]</code></p>\n"}], "owner": {"reputation": 51, "user_id": 7675536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78df3de8e5e23456cc361f0bfa7fa7d8?s=128&d=identicon&r=PG&f=1", "display_name": "Poisoner", "link": "https://stackoverflow.com/users/7675536/poisoner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2753, "favorite_count": 2, "accepted_answer_id": 45709646, "answer_count": 2, "score": 3, "last_activity_date": 1502875131, "creation_date": 1502862590, "last_edit_date": 1502871967, "question_id": 45705930, "link": "https://stackoverflow.com/questions/45705930/how-to-get-values-from-a-interface-in-golang", "title": "how to get values from a interface in golang", "body": "<p>I need to get values from a serialized string which generated from php code</p>\n\n<p>So I use a package named:<code>php_serialize</code> to unserialize the string and then got a result of <code>interface{}</code> type .</p>\n\n<p>But I have no idea how to get values inside the result.</p>\n\n<p>This is code:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/yvasiyarov/php_session_decoder/php_serialize\"\n    \"fmt\"\n)\n\nfunc main() {\n    // this string is generated from php code\n    str := `a:3:{s:4:\"name\";s:3:\"tom\";s:3:\"age\";s:2:\"23\";s:7:\"friends\";a:2:{i:0;a:1:{s:4:\"name\";s:5:\"jerry\";}i:1;a:1:{s:4:\"name\";s:4:\"jack\";}}}`\n\n    decoder := php_serialize.NewUnSerializer(str)\n\n    if result, err := decoder.Decode(); err != nil {\n        panic(err)\n    } else {\n        fmt.Println(result)\n    }\n}\n</code></pre>\n\n<p>The print result is :</p>\n\n<pre><code>map[name:tom age:23 friends:map[0:map[name:jerry] 1:map[name:jack]]]\n</code></pre>\n\n<p>This result is a <code>php_serialize.PhpValue</code> type, which is <code>interface{}</code> type</p>\n\n<p>The next step is how to get values inside the result?</p>\n\n<p>such as get the <code>age</code> field and value</p>\n"}, {"tags": ["arrays", "go", "struct", "slice"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1502872069, "post_id": 45705921, "comment_id": 78375196, "body": "Iteration is the only possibility."}], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 4257143, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q195EKev0qQ/AAAAAAAAAAI/AAAAAAAAAxM/R2bEEt98Yrc/photo.jpg?sz=128", "display_name": "Doug Henderson", "link": "https://stackoverflow.com/users/4257143/doug-henderson"}, "edited": false, "score": 0, "creation_date": 1503004908, "post_id": 45706182, "comment_id": 78447728, "body": "I have used a package from github called deep or Deep which has a method similar to reflect.DeepEqual(), which also identifies the first non-equal component."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1502863656, "creation_date": 1502863656, "answer_id": 45706182, "question_id": 45705921, "link": "https://stackoverflow.com/questions/45705921/check-empty-struct-that-have-array-fields/45706182#45706182", "title": "Check empty struct that have array fields", "body": "<p>Those are <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">slices</a>, not <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">arrays</a>. It's important to emphasize as arrays are comparable but slices are not. See <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">Spec: Comparision operators</a>. And since slices are not comparable, structs composed of them (structs with fields having slice types) are also not comparable.</p>\n\n<p>You may use <a href=\"https://golang.org/pkg/reflect/#DeepEqual\" rel=\"nofollow noreferrer\"><code>reflect.DeepEqual()</code></a> for this. Example:</p>\n\n<pre><code>type Foo struct {\n    A []int\n    B []string\n}\n\nf := Foo{}\nfmt.Println(\"Zero:\", reflect.DeepEqual(f, Foo{}))\nf.A = []int{1}\nfmt.Println(\"Zero:\", reflect.DeepEqual(f, Foo{}))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/qQSydTe4uk\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Zero: true\nZero: false\n</code></pre>\n"}], "owner": {"reputation": 473, "user_id": 3314232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3Bym.jpg?s=128&g=1", "display_name": "Saeed Falsafin", "link": "https://stackoverflow.com/users/3314232/saeed-falsafin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 919, "favorite_count": 0, "accepted_answer_id": 45706182, "answer_count": 1, "score": 2, "last_activity_date": 1611738481, "creation_date": 1502862543, "last_edit_date": 1611738481, "question_id": 45705921, "link": "https://stackoverflow.com/questions/45705921/check-empty-struct-that-have-array-fields", "title": "Check empty struct that have array fields", "body": "<p>I have a nested (not embedded) struct for which some of field types are arrays.</p>\n\n<p>How can I check if an instance of this struct is empty? (not using iteration!!)</p>\n\n<p>Note that there can't use <code>StructIns == (Struct{})</code> or by an empty instance! This code have this error:</p>\n\n<p><code>invalid operation: user == model.User literal (struct containing model.Configs cannot be compared)</code></p>\n\n<p>user.Configs.TspConfigs:</p>\n\n<pre><code>type TspConfigs struct {\n    Flights     []Flights   `form:\"flights\" json:\"flights\"`\n    Tours       []Tours     `form:\"tours\" json:\"tours\"`\n    Insurances  []Insurances`form:\"insurances\" json:\"insurances\"`\n    Hotels      []Hotels    `form:\"hotels\" json:\"hotels\"`\n}\n</code></pre>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1502865845, "post_id": 45705416, "comment_id": 78371357, "body": "Take a look at <a href=\"https://stackoverflow.com/questions/128035/how-do-i-pull-from-a-git-repository-through-an-http-proxy\">https://stackoverflow.com/questions/128035/how-do-i-pull-fro&zwnj;&#8203;m-a-git-repository-t&zwnj;&#8203;hrough-an-http-proxy</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 137, "user_id": 4412626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2abd6052249d23b37122aef8bc311b31?s=128&d=identicon&r=PG&f=1", "display_name": "\u042e\u0440\u0438\u0439 \u0428\u0438\u043f\u043e\u0432\u0430\u043b\u043e\u0432", "link": "https://stackoverflow.com/users/4412626/%d0%ae%d1%80%d0%b8%d0%b9-%d0%a8%d0%b8%d0%bf%d0%be%d0%b2%d0%b0%d0%bb%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1502873637, "post_id": 45705533, "comment_id": 78376212, "body": "@\u042e\u0440\u0438\u0439\u0428\u0438\u043f\u043e\u0432\u0430\u043b\u043e\u0432 Did you set the environment variable <code>HTTP_PROXY&#47;HTTPS_PROXY</code>? Did you use an http URL for the proxy?"}, {"owner": {"reputation": 137, "user_id": 4412626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2abd6052249d23b37122aef8bc311b31?s=128&d=identicon&r=PG&f=1", "display_name": "\u042e\u0440\u0438\u0439 \u0428\u0438\u043f\u043e\u0432\u0430\u043b\u043e\u0432", "link": "https://stackoverflow.com/users/4412626/%d0%ae%d1%80%d0%b8%d0%b9-%d0%a8%d0%b8%d0%bf%d0%be%d0%b2%d0%b0%d0%bb%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1502880742, "post_id": 45705533, "comment_id": 78381084, "body": "C:\\Users\\YShipovalov\\Projects\\src\\helloworld&gt;go run main.go ..\\github.com\\gin-gonic\\gin\\binding\\default_validator.go:11:&zwnj;&#8203;2: cannot find packa ge &quot;gopkg.in/go-playground/validator.v8&quot; in any of:         C:\\Users\\YShipovalov\\Projects\\src\\github.com\\gin-gonic\\gin\\v&zwnj;&#8203;endor\\gopkg. in\\go-playground\\validator.v8 (vendor tree) after run main.go. All packages are downloaded in GOPATH"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 137, "user_id": 4412626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2abd6052249d23b37122aef8bc311b31?s=128&d=identicon&r=PG&f=1", "display_name": "\u042e\u0440\u0438\u0439 \u0428\u0438\u043f\u043e\u0432\u0430\u043b\u043e\u0432", "link": "https://stackoverflow.com/users/4412626/%d0%ae%d1%80%d0%b8%d0%b9-%d0%a8%d0%b8%d0%bf%d0%be%d0%b2%d0%b0%d0%bb%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1502881191, "post_id": 45705533, "comment_id": 78381447, "body": "@\u042e\u0440\u0438\u0439\u0428\u0438\u043f\u043e\u0432\u0430\u043b\u043e\u0432 So the go get has worked? (sice you do have a github.com\\gin-gonic\\gin). Can you try glide or govendor (<a href=\"https://github.com/gin-gonic/gin/issues/757#issuecomment-265369437\" rel=\"nofollow noreferrer\">github.com/gin-gonic/gin/issues/757#issuecomment-265369437</a>) in order to make sure gin has all its dependencies?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1502873604, "last_edit_date": 1502873604, "creation_date": 1502860412, "answer_id": 45705533, "question_id": 45705416, "link": "https://stackoverflow.com/questions/45705416/how-can-i-get-remote-package-for-go/45705533#45705533", "title": "How can I get remote package for Go?", "body": "<p>Try with:</p>\n\n<pre><code>  go get gopkg.in/gin-gonic/gin.v1\n</code></pre>\n\n<p>That will import a fixed version of that framework.</p>\n\n<p>See for instance \"<a href=\"https://medium.com/@thedevsaddam/build-restful-api-service-in-golang-using-gin-gonic-framework-85b1a6e176f3\" rel=\"nofollow noreferrer\">Build RESTful API service in golang using gin-gonic framework</a>\"</p>\n\n<p>But if you have proxy issue, that import should fail too.<br>\nAs seen in \"<a href=\"https://semaphoreci.com/community/tutorials/building-go-web-applications-and-microservices-using-gin\" rel=\"nofollow noreferrer\">Building Go Web Applications and Microservices Using Gin</a>\", go <code>get -u github.com/gin-gonic/gin</code> should work too.</p>\n\n<p>Try removing proxy directive in your <code>.gitconfig</code>.</p>\n\n<p>Try instead setting <code>HTTP_PROXY/HTTPS_PROXY</code> (make sure to use http url in both cases for the variables, as I illustrate in \"<a href=\"https://stackoverflow.com/a/15169210/6309\">this answer</a>\")</p>\n"}, {"tags": [], "owner": {"reputation": 473, "user_id": 3314232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3Bym.jpg?s=128&g=1", "display_name": "Saeed Falsafin", "link": "https://stackoverflow.com/users/3314232/saeed-falsafin"}, "is_accepted": false, "score": 0, "last_activity_date": 1502861037, "creation_date": 1502861037, "answer_id": 45705652, "question_id": 45705416, "link": "https://stackoverflow.com/questions/45705416/how-can-i-get-remote-package-for-go/45705652#45705652", "title": "How can I get remote package for Go?", "body": "<p>Fixed version is not that important!\nThe:\n<code>\n$ go get github.com/gin-gonic/gin\n</code>\nShould work correctly!! \nFixed version is for when you want n specific version!</p>\n"}], "owner": {"reputation": 137, "user_id": 4412626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2abd6052249d23b37122aef8bc311b31?s=128&d=identicon&r=PG&f=1", "display_name": "\u042e\u0440\u0438\u0439 \u0428\u0438\u043f\u043e\u0432\u0430\u043b\u043e\u0432", "link": "https://stackoverflow.com/users/4412626/%d0%ae%d1%80%d0%b8%d0%b9-%d0%a8%d0%b8%d0%bf%d0%be%d0%b2%d0%b0%d0%bb%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1502873604, "creation_date": 1502859708, "last_edit_date": 1502872122, "question_id": 45705416, "link": "https://stackoverflow.com/questions/45705416/how-can-i-get-remote-package-for-go", "title": "How can I get remote package for Go?", "body": "<p>I have problem with importing gin package into my Go project.</p>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    r := gin.Default()\n    r.GET(\"/ping\", func(c *gin.Context) {\n        c.JSON(200, gin.H{\n            \"message\": \"pong\",\n        })\n    })\n    r.Run() // listen and serve on 0.0.0.0:8080\n}\n</code></pre>\n\n<p>I'm using <code>go get</code> command to install gin package, but it doesn't work.</p>\n\n<pre><code>C:\\Users\\YShipovalov\\Desktop\\Golang\\helloworld&gt;go get -v github.com/gin-gonic/gi\nn\nFetching https://gopkg.in/go-playground/validator.v8?go-get=1\nhttps fetch failed: Get https://gopkg.in/go-playground/validator.v8?go-get=1: di\nal tcp 45.33.37.13:443: connectex: No connection could be made because the targe\nt machine actively refused it.\npackage gopkg.in/go-playground/validator.v8: unrecognized import path \"gopkg.in/\ngo-playground/validator.v8\" (https fetch: Get https://gopkg.in/go-playground/val\nidator.v8?go-get=1: dial tcp 45.33.37.13:443: connectex: No connection could be\nmade because the target machine actively refused it.)\nFetching https://gopkg.in/yaml.v2?go-get=1\nhttps fetch failed: Get https://gopkg.in/yaml.v2?go-get=1: dial tcp 45.33.37.13:\n443: connectex: No connection could be made because the target machine actively\nrefused it.\npackage gopkg.in/yaml.v2: unrecognized import path \"gopkg.in/yaml.v2\" (https fet\nch: Get https://gopkg.in/yaml.v2?go-get=1: dial tcp 45.33.37.13:443: connectex:\nNo connection could be made because the target machine actively refused it.)\n</code></pre>\n\n<p>I have set proxy settings in git,so can this be a problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "edited": false, "score": 0, "creation_date": 1502857217, "post_id": 45705032, "comment_id": 78368186, "body": "What is the difference between expected and real output here? BTW, if the go routines are not synchronized their print output may get jumbled."}, {"owner": {"reputation": 17, "user_id": 8362528, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9f912bf4957525ee6253cf18d46b138?s=128&d=identicon&r=PG&f=1", "display_name": "Weiwei", "link": "https://stackoverflow.com/users/8362528/weiwei"}, "reply_to_user": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "edited": false, "score": 0, "creation_date": 1502857760, "post_id": 45705032, "comment_id": 78368335, "body": "I had edit my output statement. I knew no synchronized output will jumbled but is accepted if it look like this.       0 [71 40348270 6 win888e 6 1 N 127.0.0.1]   2017-08-16 12:00:40   4 [71 40348270 6 win888e 6 1 N 127.0.0.1]   2017-08-16 12:00:40   1 [71 40348270 6 win888e 6 1 N 127.0.0.1]   2017-08-16 12:00:40"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1502857954, "post_id": 45705032, "comment_id": 78368384, "body": "<a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow noreferrer\">golang.org/doc/faq#closures_and_goroutines</a>"}, {"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 1, "creation_date": 1502858350, "post_id": 45705032, "comment_id": 78368520, "body": "If you are hoping that all the gouroutines will run at (and hence, output) the same time, you need to read <a href=\"https://blog.golang.org/concurrency-is-not-parallelism\" rel=\"nofollow noreferrer\">concurrency is not parallelism</a>"}, {"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "edited": false, "score": 1, "creation_date": 1502860968, "post_id": 45705032, "comment_id": 78369284, "body": "@Weiwei one more problem I see is that more than one go routine may end  up reading same value of k and v. To avoid that, you should pass k and v as parameters to the groutine function."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1502872195, "post_id": 45705032, "comment_id": 78375270, "body": "Note that <code>runtime.GOMAXPROCS(runtime.NumCPU())</code> is unnecessary in modern versions of Go, as that is already the default."}], "answers": [{"comments": [{"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 0, "creation_date": 1502866999, "post_id": 45706177, "comment_id": 78372022, "body": "He used a non-blocking buffered channel."}, {"owner": {"reputation": 1046, "user_id": 1212463, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2f71fd74e5a4d487a4db70e4039d655b?s=128&d=identicon&r=PG", "display_name": "lmazgon", "link": "https://stackoverflow.com/users/1212463/lmazgon"}, "reply_to_user": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 2, "creation_date": 1502867380, "post_id": 45706177, "comment_id": 78372247, "body": "@ivan.sim It doesn&#39;t matter if it&#39;s buffered. The channel is empty when he&#39;s trying to read from it, so the execution waits until something is sent to the channel."}, {"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "reply_to_user": {"reputation": 1046, "user_id": 1212463, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2f71fd74e5a4d487a4db70e4039d655b?s=128&d=identicon&r=PG", "display_name": "lmazgon", "link": "https://stackoverflow.com/users/1212463/lmazgon"}, "edited": false, "score": 0, "creation_date": 1502867868, "post_id": 45706177, "comment_id": 78372581, "body": "@lmazgon yes, you are right. The receiver will remain blocked."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502891108, "post_id": 45706177, "comment_id": 78388639, "body": "Yeah, this answer hits the nail on the head. Not sure why asker expected any different behavior - it appears to be written deliberately to behave as it does."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1502867231, "last_edit_date": 1502867231, "creation_date": 1502863640, "answer_id": 45706177, "question_id": 45705032, "link": "https://stackoverflow.com/questions/45705032/trouble-about-goroutine-concurrent/45706177#45706177", "title": "Trouble about goroutine concurrent", "body": "<p>Essentially, you have:</p>\n\n<pre><code>var cBD = make(chan batchD, 6)\nfor k := range data {\n    go func() {\n        time.Sleep(1 * time.Second)\n        fmt.Println(time.Now().Format(\"2006-01-02 15:04:05\"))\n        cBD &lt;- data[k]\n    }()\n    &lt;-cBD\n}\n</code></pre>\n\n<p>Each loop starts a goroutine. The loop then waits, via the channel receive <code>&lt;-cBD</code>, until the goroutine sends to the channel, via <code>cBD &lt;- data[k]</code>, one second later. For example,</p>\n\n<pre><code>2017-08-16 02:52:46\n2017-08-16 02:52:47\n2017-08-16 02:52:48\n2017-08-16 02:52:49\n2017-08-16 02:52:50\n2017-08-16 02:52:51\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8362528, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9f912bf4957525ee6253cf18d46b138?s=128&d=identicon&r=PG&f=1", "display_name": "Weiwei", "link": "https://stackoverflow.com/users/8362528/weiwei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1502872146, "creation_date": 1502856946, "last_edit_date": 1502872146, "question_id": 45705032, "link": "https://stackoverflow.com/questions/45705032/trouble-about-goroutine-concurrent", "title": "Trouble about goroutine concurrent", "body": "<p>I got some trouble about goroutine concurrent. In my expect, it should run asynchronously and print out almost at same time but what it really did was running with waiting</p>\n\n<h3>MyTestCode</h3>\n\n<pre><code>package main\n\ntype batchD []string\nvar cBD = make(chan batchD, 6)\n\nfunc main() {\n    runtime.GOMAXPROCS(runtime.NumCPU())\n\n    data := [][]string{}\n    data = append(data, []string{\"71\", \"40348270\", \"6\", \"win888e\", \"6\", \"1\", \"N\", \"127.0.0.1\"})\n    data = append(data, []string{\"71\", \"40348270\", \"6\", \"win888e\", \"6\", \"1\", \"N\", \"127.0.0.1\"})\n    data = append(data, []string{\"71\", \"40348270\", \"6\", \"win888e\", \"6\", \"1\", \"N\", \"127.0.0.1\"})\n    data = append(data, []string{\"71\", \"129499244\", \"6\", \"win888e\", \"6\", \"1\", \"N\", \"127.0.0.1\"})\n    data = append(data, []string{\"71\", \"40348270\", \"6\", \"win888e\", \"6\", \"1\", \"N\", \"127.0.0.1\"})\n    data = append(data, []string{\"71\", \"40348270\", \"6\", \"win888e\", \"6\", \"1\", \"N\", \"127.0.0.1\"})\n\n    for k,v := range data {\n        go func() {\n            fmt.Println(k,v)\n            //batchD{}.BatchDeposit(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7])\n            delay()\n            cBD &lt;- data[k]\n        }()\n        &lt;-cBD\n    }\n}\n\nfunc delay() {\n    time.Sleep(1 * time.Second)\n    t := Basic.NowTime(\"Taipei\")\n    fmt.Println(t)\n}\n</code></pre>\n\n<h3>Output I got</h3>\n\n<pre><code>0 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:40  \n1 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:41  \n2 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:42  \n3 [71 129499244 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:43  \n4 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:44  \n5 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:45  \n</code></pre>\n\n<h3>Output I Expected</h3>\n\n<pre><code>0 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:40  \n1 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:40  \n2 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:40  \n3 [71 129499244 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:40  \n4 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:40  \n5 [71 40348270 6 win888e 6 1 N 127.0.0.1]  \n2017-08-16 12:00:40  \n</code></pre>\n\n<p>Any suggestions or tips will helps. Thanks.</p>\n"}, {"tags": ["mongodb", "go", "ssh", "portforwarding", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1502906984, "post_id": 45708764, "comment_id": 78398976, "body": "I want the changes to be made inside the code rather than changing the /etc/hosts file so that whoever runs this code, doesnt have to manually make changes to any file."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1502908617, "post_id": 45708764, "comment_id": 78399771, "body": "I don&#39;t understand what you&#39;re wanting. You want to use a domain name, but you also want to hard-code the IP address?  It feels like you&#39;re asking for contradictory things."}, {"owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1502911048, "post_id": 45708764, "comment_id": 78400890, "body": "No. That&#39;s not what I want. What I meant is that, if I run this code( with domain name and not ip address) on any machine, that machine should resolve the domain name automatically and there shouldn&#39;t be any manual configuration needed."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1502912732, "post_id": 45708764, "comment_id": 78401673, "body": "@user1851006: So you want your Go program to magically configure DNS for you?"}, {"owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1502917151, "post_id": 45708764, "comment_id": 78403706, "body": "yes. I am wondering if the net package of golang has such feature."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": -1, "last_activity_date": 1502872477, "creation_date": 1502872477, "answer_id": 45708764, "question_id": 45702760, "link": "https://stackoverflow.com/questions/45702760/how-to-resolve-domain-names-of-remote-servers-while-ssh-port-forwarding/45708764#45708764", "title": "How to resolve domain names of remote servers while ssh port-forwarding", "body": "<p>Configure name resolution to work on your machine.  This could mean adding test entries to <code>/etc/hosts</code> (if you're using *nix). Or you could add an entry for your production DNS server to <code>/etc/resolv.conf</code> (again, assuming *nix).</p>\n"}], "owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502872477, "creation_date": 1502838078, "last_edit_date": 1502872430, "question_id": 45702760, "link": "https://stackoverflow.com/questions/45702760/how-to-resolve-domain-names-of-remote-servers-while-ssh-port-forwarding", "title": "How to resolve domain names of remote servers while ssh port-forwarding", "body": "<p>I am trying to connect to remote mongodb servers using port forwarding. In mgo.DialInfo, the dial server will return a connection (of type <code>*net.Conn</code>) to the intermediary host and the <code>Addrs</code> would be a string of remote mongodb servers' addresses (a set of seed servers). My question is, if I give the remote IP addresses of these servers, the program works fine and I am able to connect to the remote mongodb servers but since, the IP addresses can change I want to give the domain names of the servers, say <em>mongodbserver1</em> and <em>mongodbserver2</em> and when I give that, the program hangs. As far as I understood, the program is trying to resolve the domain names on my local machine which won't work and they need to be resolved on the intermediary host. I want to know how I can do that. </p>\n\n<p>In terms of code, the following works fine,</p>\n\n<pre><code>dialinfo := mgo.DialInfo{\n    Addrs:    {\"1.2.3.45\",\"1.2.3.56\"}\n    Database: Mongo1,\n    Username: User,\n    Password: Pwd,\n    Timeout:  60 * time.Second,\n    DialServer: func(addr *mgo.ServerAddr) (net.Conn, error) {\n        conn, err := connectToCluster(\"172.12.13.145\")\n        if err != nil {\n            fmt.Println(\"couldn't connect to the cluster, trying again..\")\n            return nil, err\n        }\n        remote, err := conn.Dial(\"tcp\", addr.String())\n        if err != nil {\n            fmt.Println(\"couldn't connect to the mongodb server:\", addr.String())\n        }\n        return remote, err\n    },\n}\nsession, err = mgo.DialWithInfo(dialinfo)\n</code></pre>\n\n<p>but the one below doesn't work</p>\n\n<pre><code>  dialinfo := mgo.DialInfo{\n    Addrs:    {\"mongodbserver1\",\"mongodbserver2\"}\n    Database: Mongo1,\n    Username: User,\n    Password: Pwd,\n    Timeout:  60 * time.Second,\n    DialServer: func(addr *mgo.ServerAddr) (net.Conn, error) {\n        conn, err := connectToCluster(\"172.12.13.145\")\n        if err != nil {\n            fmt.Println(\"couldn't connect to the cluster, trying again..\")\n            return nil, err\n        }\n        remote, err := conn.Dial(\"tcp\", addr.String())\n        if err != nil {\n            fmt.Println(\"couldn't connect to the mongodb server:\", addr.String())\n        }\n        return remote, err\n    },\n}\nsession, err = mgo.DialWithInfo(dialinfo)\n</code></pre>\n"}, {"tags": ["macos", "http", "go", "cross-compiling", "vpn"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1502838059, "post_id": 45702591, "comment_id": 78363841, "body": "Go <i>might</i> be using your system&#39;s built-in DNS resolution code when compiling locally, but Go&#39;s built-in resolver when cross-compiled. If a local build is also slow if built with CGO_ENABLED=0 passed to <code>go build</code>, that might be it. <a href=\"https://github.com/golang/go/issues/16345\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/16345</a> has more. I&#39;m not sure how you either make the cgo native resolver work cross-platform (probably need to at least install some compilers) or get the resolver in Go to work well under your Darwin VPN setup."}, {"owner": {"reputation": 36, "user_id": 7711880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4746cb210c29c30a3f46ac054f75dc51?s=128&d=identicon&r=PG&f=1", "display_name": "jessesuen", "link": "https://stackoverflow.com/users/7711880/jessesuen"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1502838951, "post_id": 45702591, "comment_id": 78364045, "body": "Thanks @twotwotwo, I think you nailed it. If I set CGO_ENABLED=0 and build natively, it slows it down to the same timings as the cross-compiled version."}, {"owner": {"reputation": 36, "user_id": 7711880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4746cb210c29c30a3f46ac054f75dc51?s=128&d=identicon&r=PG&f=1", "display_name": "jessesuen", "link": "https://stackoverflow.com/users/7711880/jessesuen"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1502839640, "post_id": 45702591, "comment_id": 78364186, "body": "@twotwotwo, feel free to copy &amp; paste your comment as the answer so I can mark it accepted. Thanks for the explanation!"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1502840016, "post_id": 45702591, "comment_id": 78364291, "body": "Tweaked to work in that you&#39;d actually tried it and posted as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 0, "last_activity_date": 1502839996, "creation_date": 1502839996, "answer_id": 45703012, "question_id": 45702591, "link": "https://stackoverflow.com/questions/45702591/golang-cross-compiled-osx-binary-hangs-while-vpned-in-net-http-get/45703012#45703012", "title": "Golang cross-compiled OSX binary hangs while VPN&#39;ed in net/http.Get()", "body": "<p>It looks like Go is using system's native DNS resolution code (via a C library) when compiling locally, but Go's own resolver written in Go when cross-compiled. As confirmation, sounds like it's slow when <code>CGO_ENABLED=0</code>. Although it isn't specifically about what you're experiencing here, <a href=\"https://github.com/golang/go/issues/16345\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/16345</a> came up in a quick search and refers to how CGO_ENABLED determines which resolver runs.</p>\n\n<p>I'm not sure, though, how you either compile a binary you want to use the cgo native resolver cross-platform (probably need to at least install C cross-compilers) or get the resolver in Go to work well under your Darwin VPN setup. </p>\n"}], "owner": {"reputation": 36, "user_id": 7711880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4746cb210c29c30a3f46ac054f75dc51?s=128&d=identicon&r=PG&f=1", "display_name": "jessesuen", "link": "https://stackoverflow.com/users/7711880/jessesuen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 45703012, "answer_count": 1, "score": 0, "last_activity_date": 1502839996, "creation_date": 1502836780, "last_edit_date": 1502837770, "question_id": 45702591, "link": "https://stackoverflow.com/questions/45702591/golang-cross-compiled-osx-binary-hangs-while-vpned-in-net-http-get", "title": "Golang cross-compiled OSX binary hangs while VPN&#39;ed in net/http.Get()", "body": "<p>I created a simple go program which performs a HTTP GET request and prints the elapsed time taken to perform the request:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n    http.Get(\"https://google.com\")\n    log.Printf(\"Elapsed: %v\", time.Since(start))\n}\n</code></pre>\n\n<p>When building this natively on OSX (Sierra 10.12.1), the elapsed time to perform the request is reasonable (&lt;500ms). </p>\n\n<pre><code>$ for i in `seq 1 10`; do ./httpgettest ; done\n2017/08/15 14:20:44 Elapsed: 525.989928ms\n2017/08/15 14:20:45 Elapsed: 479.785494ms\n2017/08/15 14:20:45 Elapsed: 477.800294ms\n2017/08/15 14:20:46 Elapsed: 494.060461ms\n2017/08/15 14:20:46 Elapsed: 477.368627ms\n2017/08/15 14:20:47 Elapsed: 454.152783ms\n2017/08/15 14:20:47 Elapsed: 463.760254ms\n2017/08/15 14:20:48 Elapsed: 470.52473ms\n2017/08/15 14:20:48 Elapsed: 461.632058ms\n2017/08/15 14:20:49 Elapsed: 465.769262ms\n</code></pre>\n\n<p>I then cross-compile the same program from the golang Linux docker container:</p>\n\n<pre><code>GOOS=darwin GOARCH=amd64 go build -v -o httpgettest-xcompiled\n</code></pre>\n\n<p>However when executing the resulting binary while VPNed, the elapsed time is always 10+ seconds:</p>\n\n<pre><code>$ for i in `seq 1 10`; do ./httpgettest-xcompiled ; done\n2017/08/15 14:19:43 Elapsed: 10.532037349s\n2017/08/15 14:19:54 Elapsed: 10.525551121s\n2017/08/15 14:20:04 Elapsed: 10.572715005s\n2017/08/15 14:20:15 Elapsed: 10.532407157s\n2017/08/15 14:20:25 Elapsed: 10.54083169s\n2017/08/15 14:20:36 Elapsed: 10.625399239s\n2017/08/15 14:20:46 Elapsed: 10.539333467s\n2017/08/15 14:20:57 Elapsed: 10.533211943s\n2017/08/15 14:21:07 Elapsed: 10.539430574s\n2017/08/15 14:21:18 Elapsed: 10.527510134s\n</code></pre>\n\n<p>As soon as I disconnect from the VPN, the numbers drop down.</p>\n\n<p>Can someone explain how the cross compiled binary is slow while VPNed but the mac native compiled version is always performant? This is reproducible using the golang 1.7.6, 1.8.3 and 1.9 docker containers.</p>\n\n<p>I use Tunnelblick to connect to a OpenVPN server.</p>\n"}, {"tags": ["javascript", "go", "websocket"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 5, "creation_date": 1502829643, "post_id": 45700976, "comment_id": 78360699, "body": "Have you tried? Can you post a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, verifiable example</a> and explain how it did not work as intended?"}, {"owner": {"reputation": 415, "user_id": 6021348, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/ddc2ecdf76091c717de352c775ee9e55?s=128&d=identicon&r=PG&f=1", "display_name": "amanda45", "link": "https://stackoverflow.com/users/6021348/amanda45"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502834451, "post_id": 45700976, "comment_id": 78362770, "body": "@Adrian-I have the sample Chat application. Not sure how to only send the msg to certain users. Right now the msg gets sent to all clients connected."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1502872538, "post_id": 45700976, "comment_id": 78375516, "body": "So where&#39;s your code?"}], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 6021348, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/ddc2ecdf76091c717de352c775ee9e55?s=128&d=identicon&r=PG&f=1", "display_name": "amanda45", "link": "https://stackoverflow.com/users/6021348/amanda45"}, "edited": false, "score": 0, "creation_date": 1502893503, "post_id": 45708912, "comment_id": 78390438, "body": "@TehSphinX- How Do i sent the Client.ID when the connection is created? I need the Client.ID to match a session value"}, {"owner": {"reputation": 415, "user_id": 6021348, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/ddc2ecdf76091c717de352c775ee9e55?s=128&d=identicon&r=PG&f=1", "display_name": "amanda45", "link": "https://stackoverflow.com/users/6021348/amanda45"}, "edited": false, "score": 0, "creation_date": 1502894064, "post_id": 45708912, "comment_id": 78390847, "body": "can I send the session Id in my cookie when I connect? so the map can be map[SessionID]client ?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 415, "user_id": 6021348, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/ddc2ecdf76091c717de352c775ee9e55?s=128&d=identicon&r=PG&f=1", "display_name": "amanda45", "link": "https://stackoverflow.com/users/6021348/amanda45"}, "edited": false, "score": 0, "creation_date": 1502896790, "post_id": 45708912, "comment_id": 78392813, "body": "SessionID (or ClientID) comes from the server, not the client. When a new Client connects the server should assign it a unique ID. You might be ably to use some SessionID that is already created by whatever server you use."}, {"owner": {"reputation": 415, "user_id": 6021348, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/ddc2ecdf76091c717de352c775ee9e55?s=128&d=identicon&r=PG&f=1", "display_name": "amanda45", "link": "https://stackoverflow.com/users/6021348/amanda45"}, "edited": false, "score": 0, "creation_date": 1502897625, "post_id": 45708912, "comment_id": 78393412, "body": "@TehSphinX-How do I determine what websocket belongs to what user so I can assign the websocket the sessionID"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 415, "user_id": 6021348, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/ddc2ecdf76091c717de352c775ee9e55?s=128&d=identicon&r=PG&f=1", "display_name": "amanda45", "link": "https://stackoverflow.com/users/6021348/amanda45"}, "edited": false, "score": 0, "creation_date": 1502898410, "post_id": 45708912, "comment_id": 78393995, "body": "To answer this one would have to know your use case and your setup, what do you want to achieve? etc. If every client has a username the first thing they could send after connecting is their username. Since each connection is handled in a separate goroutine you can assign the username to your client. Maybe register the client to the global map only if the username arrived -- with username as key. (Make sure you use some protection for global map or use <code>syncmap.Map{}</code>)."}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1502872947, "creation_date": 1502872947, "answer_id": 45708912, "question_id": 45700976, "link": "https://stackoverflow.com/questions/45700976/realtime-push-notification-golang/45708912#45708912", "title": "Realtime push notification golang", "body": "<p>From the sample you mentioned:</p>\n\n<pre><code>    case message := &lt;-h.broadcast:\n        for client := range h.clients {\n            select {\n            case client.send &lt;- message:\n            default:\n                close(client.send)\n                delete(h.clients, client)\n            }\n        }\n    }\n</code></pre>\n\n<p>This is the case where a message is broadcasted to all clients. As you can see it loops over all registered clients and sends the message to every single one of them.</p>\n\n<p>To preserve this functionality we will simply add another case: send to a single client.</p>\n\n<pre><code>    case message := &lt;-h.clientMessage:\n        for client := range h.clients {\n            if message.ClientID == client.ID {\n                select {\n                case client.send &lt;- message:\n                default:\n                    close(client.send)\n                    delete(h.clients, client)\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>This should give you an idea. The rest I leave up to you.</p>\n\n<p>Note: my sample code can be optimised by e.g. using a <code>map[clientID]Client</code> to access the client directly.</p>\n"}], "owner": {"reputation": 415, "user_id": 6021348, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/ddc2ecdf76091c717de352c775ee9e55?s=128&d=identicon&r=PG&f=1", "display_name": "amanda45", "link": "https://stackoverflow.com/users/6021348/amanda45"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2162, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1502872947, "creation_date": 1502828663, "question_id": 45700976, "link": "https://stackoverflow.com/questions/45700976/realtime-push-notification-golang", "title": "Realtime push notification golang", "body": "<p>I want to implement a real time notification feature in my web application. I am following this example \"<a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"nofollow noreferrer\">https://github.com/gorilla/websocket/tree/master/examples/chat</a>\". I need the server (hub) to get messages, it needs to push those messages to individual clients based on some form of ID. how can I do this? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 11, "user_id": 7875063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9f42ed0276e92590212baedd16cc972?s=128&d=identicon&r=PG&f=1", "display_name": "alxprogrmz", "link": "https://stackoverflow.com/users/7875063/alxprogrmz"}, "edited": false, "score": 0, "creation_date": 1502825787, "post_id": 45700232, "comment_id": 78358786, "body": "Tried to get users enter number one through 12. But program accepts any number."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1502826831, "post_id": 45700232, "comment_id": 78359273, "body": "Your if condition doesn&#39;t match your posted requirements (should be <code>if intN &gt; 0 &amp;&amp; intN &lt;= 12</code>). Other than that, this appears to work."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1502826852, "post_id": 45700232, "comment_id": 78359288, "body": "Because it&#39;s one more construct to remember for no real benefit. You already setup your pre-condition anyway, so just use the for clause: <a href=\"https://play.golang.org/p/DLtmLd6gGE\" rel=\"nofollow noreferrer\">play.golang.org/p/DLtmLd6gGE</a>"}, {"owner": {"reputation": 11, "user_id": 7875063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9f42ed0276e92590212baedd16cc972?s=128&d=identicon&r=PG&f=1", "display_name": "alxprogrmz", "link": "https://stackoverflow.com/users/7875063/alxprogrmz"}, "edited": false, "score": 1, "creation_date": 1502827672, "post_id": 45700232, "comment_id": 78359736, "body": "Gavin ---I tried to edit my code to add the greater than or equal than. The programs still accepts the twelve. Why do I not get Go programming when I already read three textbook of C programming language and moved to Go. because it is simple and easy to use. I suck in programming but will not give up."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7875063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9f42ed0276e92590212baedd16cc972?s=128&d=identicon&r=PG&f=1", "display_name": "alxprogrmz", "link": "https://stackoverflow.com/users/7875063/alxprogrmz"}, "edited": false, "score": 1, "creation_date": 1503010026, "post_id": 45709116, "comment_id": 78449510, "body": "TehSphinx == Thank you very much!!!"}, {"owner": {"reputation": 11, "user_id": 7875063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9f42ed0276e92590212baedd16cc972?s=128&d=identicon&r=PG&f=1", "display_name": "alxprogrmz", "link": "https://stackoverflow.com/users/7875063/alxprogrmz"}, "edited": false, "score": 0, "creation_date": 1503183299, "post_id": 45709116, "comment_id": 78511661, "body": "TehSphinx-- I will. Once again thank you."}, {"owner": {"reputation": 723, "user_id": 2928038, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/dfffe2f1c1da6d3d3acbbf02e8f65fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PKV", "link": "https://stackoverflow.com/users/2928038/pkv"}, "edited": false, "score": 0, "creation_date": 1593397173, "post_id": 45709116, "comment_id": 110756933, "body": "i think answer is good! just curious if golang can get rid of \u201cwhile\u201d loop as it\u2019s covered in \u201cfor\u201d loop, why it didn\u2019t get rid of \u201cswitch\u201d as it would be covered with \u201cif/else if/else\u201d? is there any scenario not covered by using \u201cif\u201d?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1594656438, "post_id": 45709116, "comment_id": 111194865, "body": "A switch is easier to read if there are lots of cases. Actually, a large part of the Go community tries to use <code>else</code> as little as possible. So... we are kind of getting rid of <code>else</code> -- not in the language, but in the code we write."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1594656541, "post_id": 45709116, "comment_id": 111194912, "body": "The rule about <code>if&#47;else</code> vs <code>switch</code> is: use <code>switch</code> if there are 3 or more cases, use <code>if</code> where there is only one case. With 2 cases you are free to do what you like :D"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1502873606, "creation_date": 1502873606, "answer_id": 45709116, "question_id": 45700232, "link": "https://stackoverflow.com/questions/45700232/why-is-there-no-do-while-loop-in-go-programming-tried-to-get-users-enter-num-1/45709116#45709116", "title": "Why is there no do while loop in Go programming? Tried to get users enter num 1 through 12?", "body": "<p>Here is your \"while\" loop. Go simply doesn't have a while loop because it's <code>for</code> loop already covers that.</p>\n\n<pre><code>for !(intN &gt; 0 &amp;&amp; intN &lt;= 12) {\n    fmt.Println(\"Enter a number (0 &lt; N &lt;= 12): \")\n    fmt.Scanf(\"%d\", &amp;intN)\n}\n</code></pre>\n\n<p>Not sure if you wanted the 12 included or not (the print statement suggests it should be included, so I did include it).</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 11, "user_id": 7875063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9f42ed0276e92590212baedd16cc972?s=128&d=identicon&r=PG&f=1", "display_name": "alxprogrmz", "link": "https://stackoverflow.com/users/7875063/alxprogrmz"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 0, "closed_date": 1504421210, "accepted_answer_id": 45709116, "answer_count": 1, "score": -6, "last_activity_date": 1502873606, "creation_date": 1502825738, "last_edit_date": 1502825784, "question_id": 45700232, "link": "https://stackoverflow.com/questions/45700232/why-is-there-no-do-while-loop-in-go-programming-tried-to-get-users-enter-num-1", "closed_reason": "Opinion-based", "title": "Why is there no do while loop in Go programming? Tried to get users enter num 1 through 12?", "body": "<pre><code>package main\nimport (\n    \"fmt\" \n)\n\nfunc main() {\n    var intN, intCounter int32\n    var ulngFact int32\n\n    for {\n        fmt.Println(\"Enter a number (0 &lt; N &lt;= 12): \")//A do while loop\n        fmt.Scanf(\"%d\", &amp;intN)                      // Until user enters\n        if intN &gt; 0 &amp;&amp; intN &lt; 12 {                  // a num 1 through 12\n                break;\n        }\n    }\n    ulngFact = 1\n    for intCounter = 1; intCounter &lt;= intN; intCounter++{\n            ulngFact = ulngFact * intCounter\n    }\n\n    fmt.Printf(\"Required factorial is %d\\n\", ulngFact)\n    fmt.Printf(\"Thank you.\\n\") }\n</code></pre>\n"}, {"tags": ["go", "concurrency", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 5, "last_activity_date": 1502820004, "creation_date": 1502820004, "answer_id": 45698725, "question_id": 45698651, "link": "https://stackoverflow.com/questions/45698651/go-routines-sometimes-work-sometimes-gives-close-channel-error/45698725#45698725", "title": "Go Routines sometimes work, sometimes gives close channel error", "body": "<p>This one is easy. This is why you never use WaitGroup's Add in a goroutine. Always call it before starting a goroutine.</p>\n\n<p>The problem is that you stack up a bunch of goroutine's and then call Wait immediately. Go does not promise to run your goroutines at any particular time, just like POSIX or Windows threads are not guaranteed.</p>\n\n<p>So, in this case, you gave the scheduler a bunch of goroutines to run in the future, but it decided to finish your code first. So it ran <code>wg.Wait()</code> and <code>close(out)</code> before ever doing <code>wg.Add()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 3, "last_activity_date": 1502820028, "creation_date": 1502820028, "answer_id": 45698732, "question_id": 45698651, "link": "https://stackoverflow.com/questions/45698651/go-routines-sometimes-work-sometimes-gives-close-channel-error/45698732#45698732", "title": "Go Routines sometimes work, sometimes gives close channel error", "body": "<p>You want to call <code>wg.Add</code> <em>outside the goroutine it's for</em> - i.e.:</p>\n\n<pre><code>for i:=0;i&lt;5;i++{\n    wg.Add(1)    // Here, not inside Worker()\n    go Worker(in,out,&amp;wg)\n}\n</code></pre>\n\n<p>Otherwise, it can add all the workers, hit the <code>wg.Wait</code> before any workers have called <code>wg.Add</code>, which will return immediately, then close the channel.</p>\n"}], "owner": {"reputation": 13, "user_id": 8468505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa09b61b0f1e8f5291be1124ff73239a?s=128&d=identicon&r=PG&f=1", "display_name": "Jitorew", "link": "https://stackoverflow.com/users/8468505/jitorew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 45698725, "answer_count": 2, "score": 1, "last_activity_date": 1502820028, "creation_date": 1502819706, "question_id": 45698651, "link": "https://stackoverflow.com/questions/45698651/go-routines-sometimes-work-sometimes-gives-close-channel-error", "title": "Go Routines sometimes work, sometimes gives close channel error", "body": "<p>I'm new to Go and I'm trying to learn about the concurrency patterns. When I run the following code, I sometimes get the expected results (a full array of numbers from 0 to 9999). Other times I just get a \"That's it\" message with the time displayed. And sometimes I just get a \"Sending on closed channel\" error. What could be going wrong here?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"sync\"\n)\n\nfunc JobsDispatcher(in chan int, data []int){\n    for _, value := range data{\n        in&lt;-value\n    }\n    close(in)\n}\n\nfunc Worker(in chan int, out chan int, wg *sync.WaitGroup){\n    wg.Add(1)\n    for{\n        inMsg, ok := &lt;-in\n        if !ok{\n            wg.Done()\n            return\n        }\n        out &lt;- inMsg\n    }\n\n}\n\nfunc PrintInt(out chan int){\n    for {\n        outMsg, ok := &lt;-out\n        if !ok{\n            fmt.Println(\"\")\n            fmt.Println(\"That's it\")\n            return\n        }\n        fmt.Println(outMsg)\n    }\n}\n\nfunc ParallelPrint(data []int){\n    var wg sync.WaitGroup\n\n    in := make(chan int)\n    out := make(chan int)\n\n    parallelStartTime := time.Now()\n\n    go JobsDispatcher(in, data)\n\n    for i:=0;i&lt;5;i++{\n        go Worker(in,out,&amp;wg)\n    }\n\n\n    go func(){\n        wg.Wait()\n        close(out)\n    }()\n    PrintInt(out)\n\n    fmt.Println(time.Since(parallelStartTime))\n\n}\n\nfunc main(){\n    data := make([]int,0)\n    for i:=0;i&lt;10000;i++{\n        data = append(data, i)\n    }\n\n    ParallelPrint(data)\n}\n</code></pre>\n"}, {"tags": ["bash", "go", "command-line"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1502819589, "creation_date": 1502819589, "answer_id": 45698612, "question_id": 45698552, "link": "https://stackoverflow.com/questions/45698552/run-shell-command-with-redirecting-of-an-output-from-a-subshell-statement-with/45698612#45698612", "title": "Run shell command with &quot;redirecting of an output from a subshell&quot; statement within go", "body": "<p>You're almost there - I think the confusion is you're using piping <em>to call bash</em>, which means you actually need to call bash <em>using bash</em>:</p>\n\n<pre><code>exec.Command(\"bash\", \"-c\", `bash --rcfile &lt;(echo \"export PS1='&gt; ' &amp;&amp; ls\")`)\n</code></pre>\n"}], "owner": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 1, "accepted_answer_id": 45698612, "answer_count": 1, "score": 2, "last_activity_date": 1502820043, "creation_date": 1502819356, "last_edit_date": 1502820043, "question_id": 45698552, "link": "https://stackoverflow.com/questions/45698552/run-shell-command-with-redirecting-of-an-output-from-a-subshell-statement-with", "title": "Run shell command with &quot;redirecting of an output from a subshell&quot; statement within go", "body": "<p>According to <a href=\"https://stackoverflow.com/questions/7192575/run-bash-command-in-new-shell-and-stay-in-new-shell-after-this-command-executes\">run bash command in new shell and stay in new shell after this command executes</a>, how can I run command:</p>\n\n<pre><code>bash --rcfile &lt;(echo \"export PS1='&gt; ' &amp;&amp; ls\")\n</code></pre>\n\n<p>within golang? I've tried many combinations of <code>exec.Command()</code> but they did't work. For example:</p>\n\n<pre><code>exec.Command(\"bash\", \"--rcfile\", `&lt;(\"echo 'ls'\")`)\n</code></pre>\n\n<p>I've also read this <a href=\"https://github.com/golang/go/issues/11866\" rel=\"nofollow noreferrer\">os, os/exec: using redirection symbol '&lt;' '>' failed</a>, but I think maybe my case is a bit more complicated.</p>\n"}, {"tags": ["if-statement", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1502819421, "post_id": 45698298, "comment_id": 78355479, "body": "Tip: Consult the spec, it is readable. <a href=\"https://golang.org/ref/spec#Logical_operators\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Logical_operators</a>"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 3, "last_activity_date": 1502818708, "creation_date": 1502818708, "answer_id": 45698385, "question_id": 45698298, "link": "https://stackoverflow.com/questions/45698298/does-go-excecute-all-conditions-in-if-statement/45698385#45698385", "title": "does go excecute all conditions in if statement?", "body": "<p>No. Go uses standard conditional shortcut logic - the first <code>false</code> result in a string of <code>&amp;&amp;</code> conditions will stop evaluation of further conditions (because it cannot yield a <code>true</code> result no matter what the other conditions are). Likewise, the first <code>true</code> result in a string of <code>||</code> conditions will stop evaluation because it cannot yield a <code>false</code> result no matter what the other conditions are.</p>\n"}, {"tags": [], "owner": {"reputation": 1786, "user_id": 4099287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OMz777BPLQI/AAAAAAAAAAI/AAAAAAAAFcM/tV8IW2TybOw/photo.jpg?sz=128", "display_name": "Kevin M Granger", "link": "https://stackoverflow.com/users/4099287/kevin-m-granger"}, "is_accepted": true, "score": 9, "last_activity_date": 1502818984, "creation_date": 1502818984, "answer_id": 45698461, "question_id": 45698298, "link": "https://stackoverflow.com/questions/45698298/does-go-excecute-all-conditions-in-if-statement/45698461#45698461", "title": "does go excecute all conditions in if statement?", "body": "<p>What you are asking about is called <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"noreferrer\">Short Circuiting,</a> and yes, Go does it.</p>\n\n<p>In the <a href=\"https://golang.org/ref/spec#Logical_operators\" rel=\"noreferrer\">language spec,</a> it says that</p>\n\n<blockquote>\n  <p>Logical operators apply to boolean values and yield a result of the same type as the operands. The right operand is evaluated conditionally.</p>\n</blockquote>\n\n<p>This means that, in your case, if <code>function1</code> returned false, <code>function2</code> would not be called.</p>\n\n<p>See an example for <a href=\"https://play.golang.org/p/RAMY4386Ct\" rel=\"noreferrer\"><code>&amp;&amp;</code> here</a> and for <a href=\"https://play.golang.org/p/vCU3K-J2t6\" rel=\"noreferrer\"><code>||</code> here.</a></p>\n"}], "owner": {"reputation": 105, "user_id": 5799890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062f975bcfb215c6ebaf5bdbc1871792?s=128&d=identicon&r=PG&f=1", "display_name": "J. Aarts", "link": "https://stackoverflow.com/users/5799890/j-aarts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1513, "favorite_count": 0, "accepted_answer_id": 45698461, "answer_count": 2, "score": 2, "last_activity_date": 1502818984, "creation_date": 1502818410, "question_id": 45698298, "link": "https://stackoverflow.com/questions/45698298/does-go-excecute-all-conditions-in-if-statement", "title": "does go excecute all conditions in if statement?", "body": "<p>Example:</p>\n\n<p><code>if function1(input) &amp;&amp; function2(input) {}</code></p>\n\n<p>In this case would <code>function2(input)</code> be executed if <code>function1(input)</code> returns false? </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 8468463, "user_type": "registered", "profile_image": "https://graph.facebook.com/780299488816840/picture?type=large", "display_name": "Vasili Vasilyeu", "link": "https://stackoverflow.com/users/8468463/vasili-vasilyeu"}, "is_accepted": true, "score": 1, "last_activity_date": 1502818538, "creation_date": 1502818538, "answer_id": 45698330, "question_id": 45697851, "link": "https://stackoverflow.com/questions/45697851/calling-rows-err-in-a-multiple-result-set-query-with-rows-nextresultset/45698330#45698330", "title": "Calling rows.Err() in a multiple result set query with rows.NextResultSet()", "body": "<p>You can find from source code of <code>Next</code> or <code>Err</code> or <code>NextResultSet</code> function that there is <code>lasterr</code> member of <code>Rows</code> structure which can be set by several ways and <code>Err</code> always return it if it isn't <code>EOF</code>.</p>\n\n<p>Those ways are:</p>\n\n<ol>\n<li><code>Next</code> gets some error, sets <code>lasterr</code> and always returns <code>false</code> (so <code>for rows.Next() {...</code> doesn't iterate more and it is enough to check <code>rows.Err()</code> only after the loop.</li>\n<li><code>NextResultSet</code> also sets <code>lasterr</code> whenever it gets error and also returns <code>false</code>.</li>\n</ol>\n\n<p>So answer is yes, it should. Because if <code>NextResultSet</code> after <code>Next</code> returns <code>false</code> its error replaces error from <code>Next</code>.</p>\n"}], "owner": {"reputation": 2577, "user_id": 3512709, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sA5RZ.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3512709/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 45698330, "answer_count": 1, "score": 0, "last_activity_date": 1502818538, "creation_date": 1502816773, "question_id": 45697851, "link": "https://stackoverflow.com/questions/45697851/calling-rows-err-in-a-multiple-result-set-query-with-rows-nextresultset", "title": "Calling rows.Err() in a multiple result set query with rows.NextResultSet()", "body": "<p>I'm building a query with multiple result sets, following the example given, <a href=\"https://golang.org/src/database/sql/example_test.go\" rel=\"nofollow noreferrer\">here</a>. Important bits copied below for convenience.</p>\n\n<p>My question is, should <code>rows.Err()</code> be called after each <code>for rows.Next() {...}</code> loop, rather than once at the very end as shown in the example? Why / why not? My understanding is that <code>rows.Err()</code> will catch errors, <a href=\"https://golang.org/pkg/database/sql/#Rows.Err\" rel=\"nofollow noreferrer\">\"... encountered during iteration\"</a>, whereas <code>rows.NextResultSet()</code> will catch, <a href=\"https://golang.org/pkg/database/sql/#Rows.NextResultSet\" rel=\"nofollow noreferrer\">\"... [errors] advancing to [the next result set]\"</a>. Seems like I would want to catch errors during each iteration, no? Thanks!</p>\n\n<pre><code>rows, err := db.Query(q, age)\nif err != nil {\n    log.Fatal(err)\n}\ndefer rows.Close()\n\nfor rows.Next() {\n    var (\n        id   int64\n        name string\n    )\n    if err := rows.Scan(&amp;id, &amp;name); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"id %d name is %s\\n\", id, name)\n}\nif !rows.NextResultSet() {\n    log.Fatal(\"expected more result sets\", rows.Err())\n}\nvar roleMap = map[int64]string{\n    1: \"user\",\n    2: \"admin\",\n    3: \"gopher\",\n}\nfor rows.Next() {\n    var (\n        id   int64\n        role int64\n    )\n    if err := rows.Scan(&amp;id, &amp;role); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"id %d has role %s\\n\", id, roleMap[role])\n}\nif err := rows.Err(); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1502816583, "post_id": 45697430, "comment_id": 78354007, "body": "What&#39;s the purpose of having the <code>New()</code> method on the interface? It doesn&#39;t make a whole lot of sense, and it&#39;s what your error stems from."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1502819535, "post_id": 45697430, "comment_id": 78355551, "body": "Don&#39;t try to reproduce classical OOP in Go. You&#39;ll hurt yourself."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1502818921, "post_id": 45698034, "comment_id": 78355196, "body": "And having a &quot;constructor&quot; in an interface is highly counter-intuitive, because you expect to execute the methods on an instance. Calling a constructor on an existing instance is nonsensical."}], "tags": [], "owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "is_accepted": false, "score": 2, "last_activity_date": 1502827462, "last_edit_date": 1502827462, "creation_date": 1502817393, "answer_id": 45698034, "question_id": 45697430, "link": "https://stackoverflow.com/questions/45697430/how-use-interface-in-function-where-argument-is-another-interface-that-have-sa/45698034#45698034", "title": "How use interface in function, where argument is another interface, that have same list of functions?", "body": "<p>If you wanted to able to use interface <code>A</code> anywhere that interface <code>B</code> is accepted, <code>A</code> has to implement <strong>all</strong> the methods defined in <code>B</code>. So that includes <code>New() B</code> and <code>B()</code>.</p>\n\n<p>Essentially, you can embed <code>B</code> in <code>A</code> like this:</p>\n\n<pre><code>type A interface {\n  NewA() A\n  C()\n  B\n}\n</code></pre>\n\n<p>You can find a working example <a href=\"https://play.golang.org/p/qmtMxRBnsn\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Notice that in my example, I still have to implement all the methods of both <code>A</code> and <code>B</code> in the <code>AS</code> struct.</p>\n\n<p>I also have to rename the 2 <code>New()</code> functions. In Go, you can't have 2 functions in the same package with the same name, even though their return values are different.</p>\n\n<p>In general, you don't need to provide constructors in interface, because structs can be created without them.</p>\n"}], "owner": {"reputation": 91, "user_id": 5100374, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/M22Xo.jpg?s=128&g=1", "display_name": "arzonus", "link": "https://stackoverflow.com/users/5100374/arzonus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1502827462, "creation_date": 1502815251, "question_id": 45697430, "link": "https://stackoverflow.com/questions/45697430/how-use-interface-in-function-where-argument-is-another-interface-that-have-sa", "title": "How use interface in function, where argument is another interface, that have same list of functions?", "body": "<p>I have trouble with interfaces in function arguments.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A interface {\n    New() A\n    B()\n    C()\n}\n\ntype B interface {\n    New() B\n    B()\n}\n\ntype AS struct {}\nfunc (AS) New() A {\n    return AS{}\n}\n\nfunc (AS) B() {}\nfunc (AS) C() {}\n\nfunc Hello(b B) {\n    b.New()\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n\n    as := AS{}\n    a := A(as)\n    Hello(a)\n}\n</code></pre>\n\n<p>I've got this error:</p>\n\n<pre><code>tmp/sandbox293137995/main.go:35: cannot use a (type A) as type B in argument to Hello:\nA does not implement B (wrong type for New method)\n    have New() A\n    want New() B\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/dwNWx2kqy2\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>How can I refactor this code, if I want use interface A in function Hello?\nThanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 3, "creation_date": 1502812712, "post_id": 45696665, "comment_id": 78351688, "body": "of course not, use <code>mutex</code> or <code>channel</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1502813061, "post_id": 45696665, "comment_id": 78351912, "body": "As is stated in every related question, no values in Go are safe for concurrent reads and writes. You always need to serialize access."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1502812619, "creation_date": 1502812619, "answer_id": 45696673, "question_id": 45696665, "link": "https://stackoverflow.com/questions/45696665/is-it-safe-for-one-goroutine-to-read-from-a-struct-while-another-goroutine-is-mo/45696673#45696673", "title": "Is it safe for one goroutine to read from a struct while another goroutine is modifying it?", "body": "<p>No, that is the very definition of not safe, and would be caught by the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">race detector</a> if you tested it. You will absolutely need to synchronize access, for example using <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\"><code>sync.Mutex</code> or <code>sync.RWMutex</code></a>.</p>\n\n<p>If it is not critical to always have the latest values, you can also allow each goroutine to cache a <em>copy</em> of the struct, and then regularly update their copy from the \"master\" copy every so often. If there is frequent access to the struct, this can help avoid some performance issues due to lock contention.</p>\n"}], "owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 45696673, "answer_count": 1, "score": -3, "last_activity_date": 1502812619, "creation_date": 1502812564, "question_id": 45696665, "link": "https://stackoverflow.com/questions/45696665/is-it-safe-for-one-goroutine-to-read-from-a-struct-while-another-goroutine-is-mo", "title": "Is it safe for one goroutine to read from a struct while another goroutine is modifying it?", "body": "<p>More specifically, in my case I have a webserver and a globally-accesible struct that the web server uses to generate a page. I have another Goroutine that's always updating that struct with new values periodically. Will this cause issues? Do I need to implement a mechanism to ensure it's not reading while it's being updated?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1502806815, "post_id": 45694512, "comment_id": 78347632, "body": "Chances are you&#39;re never going to see an array of <code>interface{}</code>, so you would need to copy the elements anyway. You also can&#39;t slice an array value if it&#39;s not addressable, so it would need to pass a pointer to an array of <code>interface{}</code>, which you&#39;re even less likely to encounter. Since Go types are invariant, and it&#39;s likely you need to copy the values anyway, what is the actual problem you&#39;re trying to solve?"}, {"owner": {"reputation": 13, "user_id": 8467371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ba5e1a192a285db105acf63d802886?s=128&d=identicon&r=PG", "display_name": "Pavlo Dzikovsky", "link": "https://stackoverflow.com/users/8467371/pavlo-dzikovsky"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502954313, "post_id": 45694512, "comment_id": 78415231, "body": "It&#39;s only private style taken from scripting programming. When I am parsing JSON I want implicitly convert some values to arrays. For example:      {        &quot;a&quot; : [1, 2, 3]    // it&#39;s ok        &quot;b&quot;: 1               // it must be converted to [1]        &quot;c&quot;: {}               // it must be converted to [{}]     }  So I need universal function to convert anything to slice. I understand that Golang isn&#39;t JS, Python or Perl but is&#39;s only first my Golang samples."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8467371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ba5e1a192a285db105acf63d802886?s=128&d=identicon&r=PG", "display_name": "Pavlo Dzikovsky", "link": "https://stackoverflow.com/users/8467371/pavlo-dzikovsky"}, "edited": false, "score": 0, "creation_date": 1502881766, "post_id": 45695868, "comment_id": 78381833, "body": "So having an array I cant get its slice directly and must create a copy. It&#39;s pity but I understand the trouble."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1502810056, "creation_date": 1502810056, "answer_id": 45695868, "question_id": 45694512, "link": "https://stackoverflow.com/questions/45694512/is-it-possible-to-use-reflected-array-type-in-golang-type-assertions/45695868#45695868", "title": "Is it possible to use reflected array type in Golang type assertions?", "body": "<p>An explicit type is required in a type assertion. The type cannot be constructed through reflection.</p>\n\n<p>Unless the argument is a []interface{}, the slice or array must be copied to produce a []interface{}.</p>\n\n<p>Try this:</p>\n\n<pre><code>func AnythingToSlice(a interface{}) []interface{} {\n    v := reflect.ValueOf(a)\n    switch v.Kind() {\n    case reflect.Slice, reflect.Array:\n        result := make([]interface{}, v.Len())\n        for i := 0; i &lt; v.Len(); i++ {\n            result[i] = v.Index(i).Interface()\n        }\n        return result\n    default:\n        panic(\"not supported\")\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/3bXxnHOK8_\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3bXxnHOK8_</a></p>\n"}], "owner": {"reputation": 13, "user_id": 8467371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ba5e1a192a285db105acf63d802886?s=128&d=identicon&r=PG", "display_name": "Pavlo Dzikovsky", "link": "https://stackoverflow.com/users/8467371/pavlo-dzikovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 1, "accepted_answer_id": 45695868, "answer_count": 1, "score": 1, "last_activity_date": 1502881895, "creation_date": 1502805808, "last_edit_date": 1502881895, "question_id": 45694512, "link": "https://stackoverflow.com/questions/45694512/is-it-possible-to-use-reflected-array-type-in-golang-type-assertions", "title": "Is it possible to use reflected array type in Golang type assertions?", "body": "<p>I need to check if interface{} is an array and create corresponding slice if it is. Unfortunately I do not know array length in advance.</p>\n\n<p>For example:</p>\n\n<pre><code>import (\n  \"reflect\"\n)\nfunc AnythingToSlice(a interface{}) []interface{} {\n  rt := reflect.TypeOf(a)\n  switch rt.Kind() {\n  case reflect.Slice:\n    slice, ok := a.([]interface{})\n    if ok {\n      return slice\n    }\n    // it works\n\n  case reflect.Array:\n    // return a[:]\n    // it doesn't work: cannot slice a (type interface {})   \n    //\n    array, ok := a.([reflect.ValueOf(a).Len()]interface{})\n    // :-((( non-constant array bound reflect.ValueOf(a).Len()\n    if ok {\n       return array[:]\n    }\n\n  }\n  return []interface{}(a)\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes", "kubernetes-helm"], "comments": [{"owner": {"reputation": 2070, "user_id": 378704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5318a95a23ff8a67c0edc171412c83a?s=128&d=identicon&r=PG", "display_name": "kiran.koduru", "link": "https://stackoverflow.com/users/378704/kiran-koduru"}, "edited": false, "score": 0, "creation_date": 1502808664, "post_id": 45692719, "comment_id": 78348900, "body": "If <a href=\"https://github.com/kubernetes/helm/blob/master/cmd/helm/helm.go\" rel=\"nofollow noreferrer\">this</a> is the file you are talking about then maybe you could run it via command line with the <code>-h</code> option and explore the implementations from the source itself?"}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 9353289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7zRvzDBVsKY/AAAAAAAAAAI/AAAAAAAALJU/mLo07MckG9M/photo.jpg?sz=128", "display_name": "Sufiyan Parkar", "link": "https://stackoverflow.com/users/9353289/sufiyan-parkar"}, "is_accepted": false, "score": 2, "last_activity_date": 1559551738, "creation_date": 1559551738, "answer_id": 56423920, "question_id": 45692719, "link": "https://stackoverflow.com/questions/45692719/samples-on-kubernetes-helm-golang-client/56423920#56423920", "title": "Samples on kubernetes helm golang client", "body": "<p><em>I was looking for the same answer, since I do know the solution now, sharing it here.</em></p>\n\n<p>What you are looking for is to write a wrapper around helm library.</p>\n\n<p>First you need a client which speaks to the tiller of your cluster. For that you need to create a tunnel to the tiller from your localhost. Use <a href=\"https://github.com/helm/helm/blob/master/cmd/helm/helm.go\" rel=\"nofollow noreferrer\">this</a> (its the same link as kiran shared.) <br></p>\n\n<ol>\n<li>Setup the Helm environement variables <a href=\"https://github.com/helm/helm/blob/master/cmd/helm/helm.go#L87\" rel=\"nofollow noreferrer\">look here</a></li>\n<li>Use <a href=\"https://github.com/helm/helm/blob/master/cmd/helm/helm.go#L271\" rel=\"nofollow noreferrer\">this</a> next. It will return a helm client. (you might need to write a wrapper around it to work with your setup of clusters)</li>\n</ol>\n\n<p>After you get the <code>*helm.Client</code> handle, you can use helm's client API given <a href=\"https://github.com/helm/helm/blob/master/pkg/kube/client.go\" rel=\"nofollow noreferrer\">here</a>. You just have to use the one you need with the appropriate values.</p>\n\n<p>You might need some utility functions defined <a href=\"https://github.com/helm/helm/blob/master/pkg/chartutil/load.go\" rel=\"nofollow noreferrer\">here</a>, like loading a chart as a folder/archive/file.</p>\n\n<p>If you want to do something more, you pretty much locate the method in the <a href=\"https://godoc.org/k8s.io/helm\" rel=\"nofollow noreferrer\">doc</a> and call it using the client.</p>\n"}, {"comments": [{"owner": {"reputation": 188, "user_id": 9749861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9dabca17e5dcffafb873bb17b4527c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Z.", "link": "https://stackoverflow.com/users/9749861/b-z"}, "edited": false, "score": 1, "creation_date": 1579721203, "post_id": 58484774, "comment_id": 105864692, "body": "one key thing missing in the answer is: <code>host := fmt.Sprintf(&quot;127.0.0.1:%d&quot;, tillerTunnel.Local)</code>. See <a href=\"https://github.com/helm/helm/issues/3663#issuecomment-451501588\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 188, "user_id": 9749861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9dabca17e5dcffafb873bb17b4527c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Z.", "link": "https://stackoverflow.com/users/9749861/b-z"}, "edited": false, "score": 0, "creation_date": 1579722155, "post_id": 58484774, "comment_id": 105865116, "body": "Of course, if trying to access Tiller from within the cluster, there is no need to do port forwarding. Just use, by default, <code>host := &quot;tiller-deploy.kube-system.svc:44134&quot;</code>"}, {"owner": {"reputation": 1905, "user_id": 1889864, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/4c6faaccb517f6825e732e7bc0898625?s=128&d=identicon&r=PG", "display_name": "teone", "link": "https://stackoverflow.com/users/1889864/teone"}, "edited": false, "score": 0, "creation_date": 1588027766, "post_id": 58484774, "comment_id": 108737543, "body": "Any hint on how to install a release?"}, {"owner": {"reputation": 174, "user_id": 4779803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8fCQp.jpg?s=128&g=1", "display_name": "Luffy", "link": "https://stackoverflow.com/users/4779803/luffy"}, "edited": false, "score": 0, "creation_date": 1599548764, "post_id": 58484774, "comment_id": 112799113, "body": "@rabenhorst How to get the list of charts deployed? I want to store the chart details like Name, Revision, Chart, etc. I am using HELM3 for chart deployment."}, {"owner": {"reputation": 53, "user_id": 6534326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6816352259ddb7e37ec8281b917d97?s=128&d=identicon&r=PG&f=1", "display_name": "rabenhorst", "link": "https://stackoverflow.com/users/6534326/rabenhorst"}, "reply_to_user": {"reputation": 174, "user_id": 4779803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8fCQp.jpg?s=128&g=1", "display_name": "Luffy", "link": "https://stackoverflow.com/users/4779803/luffy"}, "edited": false, "score": 0, "creation_date": 1599642849, "post_id": 58484774, "comment_id": 112833637, "body": "@Luffy this whole thread is about helm2 which uses tiller as a cluster side component. Maybe you can take a look on how the official helm3 CLI is doing it: <a href=\"https://github.com/helm/helm/blob/master/pkg/action/list.go\" rel=\"nofollow noreferrer\">github.com/helm/helm/blob/master/pkg/action/list.go</a>"}], "tags": [], "owner": {"reputation": 53, "user_id": 6534326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6816352259ddb7e37ec8281b917d97?s=128&d=identicon&r=PG&f=1", "display_name": "rabenhorst", "link": "https://stackoverflow.com/users/6534326/rabenhorst"}, "is_accepted": false, "score": 3, "last_activity_date": 1571655103, "creation_date": 1571655103, "answer_id": 58484774, "question_id": 45692719, "link": "https://stackoverflow.com/questions/45692719/samples-on-kubernetes-helm-golang-client/58484774#58484774", "title": "Samples on kubernetes helm golang client", "body": "<p>Since it took me some time to get this working here is a minimal example (no error handling, left details about kube config, ...) for listing release names:</p>\n\n<pre><code>package main\n\nimport (\n  \"k8s.io/client-go/kubernetes\"\n  \"k8s.io/helm/pkg/helm\"\n  \"k8s.io/helm/pkg/helm/portforwarder\"\n)\n\nfunc main() {\n  # omit getting kubeConfig, see: https://github.com/kubernetes/client-go/tree/master/examples\n\n  # get kubernetes client\n  client, _ := kubernetes.NewForConfig(kubeConfig)\n\n  # port forward tiller\n  tillerTunnel, _ := portforwarder.New(\"kube-system\", client, config)\n\n  # new helm client\n  helmClient := helm.NewClient(helm.Host(host))\n\n  # list/print releases\n  resp, _ := helmClient.ListReleases()\n  for _, release := range resp.Releases {\n    fmt.Println(release.GetName())\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1519, "user_id": 2972348, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6f9edd3f6213aca1c54edefed5796033?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Khare", "link": "https://stackoverflow.com/users/2972348/ishan-khare"}, "edited": false, "score": 0, "creation_date": 1585153611, "post_id": 60077666, "comment_id": 107665013, "body": "there is no <code>Init</code> method defined on the Configuration type according to the docs."}, {"owner": {"reputation": 1519, "user_id": 2972348, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6f9edd3f6213aca1c54edefed5796033?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Khare", "link": "https://stackoverflow.com/users/2972348/ishan-khare"}, "edited": false, "score": 0, "creation_date": 1585153763, "post_id": 60077666, "comment_id": 107665096, "body": "Also how would a create a configuration from cluster certificates instead of the kubeconfig on filesystem?"}, {"owner": {"reputation": 164, "user_id": 6712353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SmJLgOnYJAs/AAAAAAAAAAI/AAAAAAAAAjw/2evNErmZ2JI/photo.jpg?sz=128", "display_name": "Aisuko", "link": "https://stackoverflow.com/users/6712353/aisuko"}, "edited": false, "score": 0, "creation_date": 1586618414, "post_id": 60077666, "comment_id": 108195163, "body": "Is there any solution we can transfer the parameters like <code>--set</code> <code>--set-file</code> of <code>helm install</code>?"}, {"owner": {"reputation": 410, "user_id": 3588442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m3TFr.jpg?s=128&g=1", "display_name": "LemurPwned", "link": "https://stackoverflow.com/users/3588442/lemurpwned"}, "reply_to_user": {"reputation": 164, "user_id": 6712353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SmJLgOnYJAs/AAAAAAAAAAI/AAAAAAAAAjw/2evNErmZ2JI/photo.jpg?sz=128", "display_name": "Aisuko", "link": "https://stackoverflow.com/users/6712353/aisuko"}, "edited": false, "score": 0, "creation_date": 1595928578, "post_id": 60077666, "comment_id": 111636373, "body": "@Aisuko take a look at my response below. You may pass the params to the <code>Run</code> functions via <code>map[string]interface{}</code> and if these are your installation values."}, {"owner": {"reputation": 174, "user_id": 4779803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8fCQp.jpg?s=128&g=1", "display_name": "Luffy", "link": "https://stackoverflow.com/users/4779803/luffy"}, "edited": false, "score": 0, "creation_date": 1599548830, "post_id": 60077666, "comment_id": 112799141, "body": "@turkenh How to get the list of charts deployed? I want to store the chart details like Name, Revision, Chart, etc. I am using HELM3 for chart deployment."}, {"owner": {"reputation": 1967, "user_id": 4124416, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JPPQT.png?s=128&g=1", "display_name": "turkenh", "link": "https://stackoverflow.com/users/4124416/turkenh"}, "reply_to_user": {"reputation": 174, "user_id": 4779803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8fCQp.jpg?s=128&g=1", "display_name": "Luffy", "link": "https://stackoverflow.com/users/4779803/luffy"}, "edited": false, "score": 0, "creation_date": 1599557409, "post_id": 60077666, "comment_id": 112803247, "body": "@Luffy you should use <a href=\"https://github.com/helm/helm/blob/266c74f390c6dcd08ffbbe942df99d5557632806/pkg/action/list.go#L143\" rel=\"nofollow noreferrer\">list action</a>. <a href=\"https://github.com/crossplane-contrib/provider-helm/blob/d335be22603378fbd2bcf97fdee149fcb0b9eb65/pkg/clients/helm/client.go\" rel=\"nofollow noreferrer\">Here</a> you can find how an action could be used in go, even we didn&#39;t need list action yet."}], "tags": [], "owner": {"reputation": 1967, "user_id": 4124416, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JPPQT.png?s=128&g=1", "display_name": "turkenh", "link": "https://stackoverflow.com/users/4124416/turkenh"}, "is_accepted": false, "score": 11, "last_activity_date": 1580911791, "creation_date": 1580911791, "answer_id": 60077666, "question_id": 45692719, "link": "https://stackoverflow.com/questions/45692719/samples-on-kubernetes-helm-golang-client/60077666#60077666", "title": "Samples on kubernetes helm golang client", "body": "<p><strong>FOR HELM3</strong></p>\n\n<p>As other answers pointed, with Helm 2, you need to talk with tiller which complicates stuff.</p>\n\n<p>It is way more clean with Helm 3 since tiller was removed and helm client directly communicates with Kubernetes API Server. </p>\n\n<p>Here is an example code to install a helm chart programmatically with helm3:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n\n    \"helm.sh/helm/v3/pkg/action\"\n    \"helm.sh/helm/v3/pkg/chart/loader\"\n    \"helm.sh/helm/v3/pkg/kube\"\n    _ \"k8s.io/client-go/plugin/pkg/client/auth\"\n)\n\nfunc main() {\n    chartPath := \"/tmp/my-chart-0.1.0.tgz\"\n    chart, err := loader.Load(chartPath)\n    if err != nil {\n        panic(err)\n    }\n\n    kubeconfigPath := \"/tmp/my-kubeconfig\"\n    releaseName := \"my-release\"\n    releaseNamespace := \"default\"\n    actionConfig := new(action.Configuration)\n    if err := actionConfig.Init(kube.GetConfig(kubeconfigPath, \"\", releaseNamespace), releaseNamespace, os.Getenv(\"HELM_DRIVER\"), func(format string, v ...interface{}) {\n        fmt.Sprintf(format, v)\n    }); err != nil {\n        panic(err)\n    }\n\n    iCli := action.NewInstall(actionConfig)\n    iCli.Namespace = releaseNamespace\n    iCli.ReleaseName = releaseName\n    rel, err := iCli.Run(chart, nil)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"Successfully installed release: \", rel.Name)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 410, "user_id": 3588442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m3TFr.jpg?s=128&g=1", "display_name": "LemurPwned", "link": "https://stackoverflow.com/users/3588442/lemurpwned"}, "is_accepted": false, "score": 3, "last_activity_date": 1595856134, "creation_date": 1595856134, "answer_id": 63116263, "question_id": 45692719, "link": "https://stackoverflow.com/questions/45692719/samples-on-kubernetes-helm-golang-client/63116263#63116263", "title": "Samples on kubernetes helm golang client", "body": "<p>I was long trying to set up Helm installation with <code>--set</code> values, and I found that the best place to look currently available functionality is <a href=\"https://helm.sh/docs/topics/advanced/#simple-example\" rel=\"nofollow noreferrer\">official helm documentation example</a> and <a href=\"https://pkg.go.dev/helm.sh/helm/\" rel=\"nofollow noreferrer\">official Go docs for the client</a>.</p>\n<p>This only pertains to <strong>Helm 3</strong>.</p>\n<p>Here's an example I managed to get working by using the resources linked above.</p>\n<p>I haven't found a more elegant way to define values rather than recursively asking for the <code>map[string]interface{}</code>, so if anyone knows a better way, please let me know.</p>\n<p>Values should be roughly equivalent to:<br />\n<code>helm install myRelease /mypath --set redis.sentinel.masterName=BigMaster,redis.sentinel.pass=&quot;random&quot; ... etc</code></p>\n<p>Notice the use of <code>settings.RESTClientGetter()</code>, rather than <code>kube.Get</code>, as in other answers. I found <code>kube.Get</code> to be causing nasty conflicts with k8s clients.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    &quot;log&quot;\n    &quot;os&quot;\n\n    &quot;helm.sh/helm/v3/pkg/action&quot;\n    &quot;helm.sh/helm/v3/pkg/chart/loader&quot;\n    &quot;helm.sh/helm/v3/pkg/cli&quot;\n    &quot;helm.sh/helm/v3/pkg/release&quot;\n)\n\nfunc main(){\n    chartPath := &quot;/mypath&quot;\n    namespace := &quot;default&quot;\n    releaseName := &quot;myRelease&quot;\n\n    settings := cli.New()\n\n    actionConfig := new(action.Configuration)\n    // You can pass an empty string instead of settings.Namespace() to list\n    // all namespaces\n    if err := actionConfig.Init(settings.RESTClientGetter(), namespace,\n        os.Getenv(&quot;HELM_DRIVER&quot;), log.Printf); err != nil {\n        log.Printf(&quot;%+v&quot;, err)\n        os.Exit(1)\n    }\n\n    // define values\n    vals := map[string]interface{}{\n        &quot;redis&quot;: map[string]interface{}{\n            &quot;sentinel&quot;: map[string]interface{}{\n                &quot;masterName&quot;: &quot;BigMaster&quot;,\n                &quot;pass&quot;:       &quot;random&quot;,\n                &quot;addr&quot;:       &quot;localhost&quot;,\n                &quot;port&quot;:       &quot;26379&quot;,\n            },\n        },\n    }\n\n    // load chart from the path \n    chart, err := loader.Load(chartPath)\n    if err != nil {\n        panic(err)\n    }\n\n    client := action.NewInstall(actionConfig)\n    client.Namespace = namespace\n    client.ReleaseName = releaseName\n    // client.DryRun = true - very handy!\n\n\n    // install the chart here\n    rel, err := client.Run(chart, vals)\n    if err != nil {\n        panic(err)\n    }\n\n    log.Printf(&quot;Installed Chart from path: %s in namespace: %s\\n&quot;, rel.Name, rel.Namespace)\n    // this will confirm the values set during installation\n    log.Println(rel.Config)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 358, "user_id": 1853171, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/oxsRS.jpg?s=128&g=1", "display_name": "Mehran Akhavan", "link": "https://stackoverflow.com/users/1853171/mehran-akhavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7032, "favorite_count": 4, "answer_count": 4, "score": 8, "last_activity_date": 1595856134, "creation_date": 1502799547, "question_id": 45692719, "link": "https://stackoverflow.com/questions/45692719/samples-on-kubernetes-helm-golang-client", "title": "Samples on kubernetes helm golang client", "body": "<p>I want to create a service on kubernetes which manages helm charts on the cluster. It installs charts from a private chart repository. Since I didn't find any documents on how to use helm client api, I was looking for some samples or guidelines for creating a service on top of helm client.</p>\n"}, {"tags": ["go", "mgo", "go-gin"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1502791678, "post_id": 45690659, "comment_id": 78338886, "body": "<code>c.PostForm(key)</code> - what type does this return?"}, {"owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1502792184, "post_id": 45690659, "comment_id": 78339140, "body": "This returns the string value, thats way it saved in string format."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1502792235, "post_id": 45690659, "comment_id": 78339167, "body": "So then it&#39;s not &quot;data saved in database is incorrect with golang?&quot; then :-) It&#39;s that you retrieve &quot;incorrect&quot; data in the very first place"}, {"owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1502792894, "post_id": 45690659, "comment_id": 78339503, "body": "@zerkms I have updated the question, please check"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "edited": false, "score": 0, "creation_date": 1502791977, "post_id": 45690754, "comment_id": 78339040, "body": "thanks for your reply. But if I have lets say 15 fields and 5 of them are integer then 5 time I need to add condition within the loop. That is not the correct way for me because my data supposed to be big during runtime. So Is there a another way to handle this in golang?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1502793125, "last_edit_date": 1502793125, "creation_date": 1502791674, "answer_id": 45690754, "question_id": 45690659, "link": "https://stackoverflow.com/questions/45690659/what-is-the-correct-way-to-save-post-data-with-integer-and-string-values-in-th/45690754#45690754", "title": "What is the correct way to save post data (with integer and string values) in the database golang?", "body": "<p>If you look at your saved document, you can see it's <code>_id</code> property is already a number (and not a string), so yes, this is definitely possible.</p>\n\n<p>The reason why you end up with a <code>customer_id</code> property being of type <code>string</code> is because the document you save (<code>conditions</code> variable) holds a <code>string</code> value for <code>customer_id</code> property. And it is of type <code>string</code> because you filled it with the return value of <a href=\"http://godoc.org/github.com/gin-gonic/gin#Context.PostForm\" rel=\"nofollow noreferrer\"><code>Context.PostForm()</code></a> which returns a form value as a <code>string</code>.</p>\n\n<p>If you want it to be an integer in the database, convert it to a Go integer before setting it in <code>conditions</code>. For that you may use <a href=\"https://golang.org/pkg/strconv/#Atoi\" rel=\"nofollow noreferrer\"><code>strconv.Atoi()</code></a> for example.</p>\n\n<pre><code>for key, _ := range c.Request.PostForm {\n    value := c.PostForm(key)\n    if key == \"customer_id\" {\n        if id, err := strconv.Atoi(value); err != nil {\n            // Not a valid number, handle error\n        } else {\n            conditions[key] = id\n        }\n    } else {\n        if key != \"id\"{\n            conditions[key] = value\n        }\n    }\n}\n</code></pre>\n\n<p>You have to define <em>somehow</em> which fields are supposed to hold integer values. I just showed a way to do that with a single field. If you have multiple of them, you may list them in a slice, and use a single <code>for</code> loop to detect / handle all; or even better, put them in a map that acts as a set, and you can detect these fields without a <code>for</code> loop.</p>\n\n<p>Another option would be to create a <code>struct</code> type modeling your form input data, and use a library like <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"nofollow noreferrer\">Gorilla's schema</a> to unmarshal into that struct in a type-aware manner.</p>\n"}], "owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 45690754, "answer_count": 1, "score": -1, "last_activity_date": 1597438807, "creation_date": 1502791339, "last_edit_date": 1597438807, "question_id": 45690659, "link": "https://stackoverflow.com/questions/45690659/what-is-the-correct-way-to-save-post-data-with-integer-and-string-values-in-th", "title": "What is the correct way to save post data (with integer and string values) in the database golang?", "body": "<p>I've the following golang code:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    router := gin.Default()\n    router.POST(\"/save-address\", SaveAddress)\n    router.Run()\n}\n\nfunc SaveAddress(c *gin.Context){\n    var err error\n    conditions := bson.M{}\n    c.Request.ParseForm()\n    for key, _ := range c.Request.PostForm {\n        if key != \"id\"{\n            conditions[key] = c.PostForm(key)\n        }\n    }\n    conditions[\"_id\"] = 1\n    mongoSession := ConnectDb()\n\n    sessionCopy := mongoSession.Copy()\n    defer sessionCopy.Close()\n\n    getCollection := mongoSession.DB(\"bformssettings\").C(\"address\")\n    err = getCollection.Insert(conditions)\n    if err != nil{\n        println(err)\n    }else{\n        println(\"Data saved successfully!!!\")\n    }\n}\nfunc ConnectDb() (mongoSession *mgo.Session) {\n    mongoDBDialInfo := &amp;mgo.DialInfo{\n        Addrs:    []string{\"localhost:27017\"},\n        Timeout:  60 * time.Second,\n        Database: \"bformssettings\",\n    }\n\n    mongoSession, err := mgo.DialWithInfo(mongoDBDialInfo)\n    if err != nil {\n        log.Fatalf(\"CreateSession: %s\\n\", err)\n    }\n\n    mongoSession.SetMode(mgo.Monotonic, true)\n\n    return mongoSession\n}\n</code></pre>\n\n<p>When I run the code, data of the following format will be saved in the database:</p>\n\n<pre><code>{ \"_id\" : 1, \"customer_id\" : \"3\", \"address\" : \"Chicago, IL\", \"city\" : \"Chicago\", \"state\" : \"IL\", \"zipcode\" : \"60647\" }\n</code></pre>\n\n<p><strong>Problem:</strong></p>\n\n<p><code>customer_id</code> is an integer value, <strong>but</strong> it will be saved as string in the database.</p>\n\n<p><strong>Possible workaround:</strong></p>\n\n<p>It is possible to reconvert the string representation of <code>id</code> back to integer before saving it in the database.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Is there another way to save data as it is? E.g. to save integer values as integer values?</p>\n"}, {"tags": ["pointers", "dictionary", "go"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1502793079, "post_id": 45690134, "comment_id": 78339599, "body": "The code in your question is different from the code in the playground. Which one are you asking about?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1502789623, "creation_date": 1502789623, "answer_id": 45690222, "question_id": 45690134, "link": "https://stackoverflow.com/questions/45690134/deleting-pointer-value-doesnt-panic/45690222#45690222", "title": "Deleting pointer value doesn&#39;t panic", "body": "<p>The use of the builtin <a href=\"https://golang.org/pkg/builtin/#delete\" rel=\"noreferrer\"><code>delete()</code></a> removes an entry from a map. It does not delete / deallocate the memory pointed by the value associated with the removed key.</p>\n\n<p>In Go you can't manage memory like this, Go is a garbage collected language and freeing memory is the duty and responsibility of the garbage collector.</p>\n\n<p>Your code doesn't panic because you have a (valid) pointer to a value of type <code>Person</code>, and as long as you have it, that person will not become invalid (its memory will not be freed).</p>\n\n<p>When you change your code to <code>people[0].Name</code>, then you are indexing a map with a key which is not in the map (because you just removed it with <code>delete()</code>), so the result of the <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">index expression</a> will be the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">zero value</a> of the value type of the map, which is <code>nil</code> for the <code>*Person</code> type. And attempting to refer to the <code>Name</code> field of a <code>nil</code> struct pointer will cause a runtime panic.</p>\n"}], "owner": {"reputation": 325, "user_id": 3196293, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1040298947/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/3196293/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502790371, "creation_date": 1502789311, "last_edit_date": 1502790371, "question_id": 45690134, "link": "https://stackoverflow.com/questions/45690134/deleting-pointer-value-doesnt-panic", "title": "Deleting pointer value doesn&#39;t panic", "body": "<p>Why doesn't the following code panic? <code>test</code> is definitely a pointer. With <code>fmt.Println(people[0].Name)</code> instead of <code>fmt.Println(test.Name)</code> it does panic. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    type Person struct {\n        Id   int\n        Name string\n    }\n\n    people := make(map[int]*Person)\n\n    people[1] = &amp;Person{0, \"Name\"}\n    fmt.Println(people[0].Name)\n\n    test := people[0]\n    test.Name = \"Name2\"\n    fmt.Println(test.Name)\n\n    people[0].Name = \"Name3\"\n    fmt.Println(test.Name)\n\n    delete(people, 0)\n\n    fmt.Println(test.Name)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/RykMy8f1By\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 0, "creation_date": 1502785899, "post_id": 45689020, "comment_id": 78335977, "body": "You need to check the result reported by <code>gorm</code> error. <code>err := ur.db.Find(&amp;users).Error</code>"}, {"owner": {"reputation": 163, "user_id": 6485236, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8ac0d5b3298a8f80fa98d4f6c968311d?s=128&d=identicon&r=PG&f=1", "display_name": "Code On", "link": "https://stackoverflow.com/users/6485236/code-on"}, "reply_to_user": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 0, "creation_date": 1502786511, "post_id": 45689020, "comment_id": 78336297, "body": "@BogdanIulianBursuc no error, I already checked it twice"}, {"owner": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 0, "creation_date": 1502788003, "post_id": 45689020, "comment_id": 78337134, "body": "You could try enabling debug for that query and see what <code>gorm</code> is trying to create as SQL: <code>ur.db.Debug().Find(&amp;users)</code>"}, {"owner": {"reputation": 163, "user_id": 6485236, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8ac0d5b3298a8f80fa98d4f6c968311d?s=128&d=identicon&r=PG&f=1", "display_name": "Code On", "link": "https://stackoverflow.com/users/6485236/code-on"}, "reply_to_user": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 0, "creation_date": 1502788188, "post_id": 45689020, "comment_id": 78337253, "body": "@BogdanIulianBursuc thankyou, so the query try to select where deleted_at is null, and my deleted_at value is not null. thankyou"}, {"owner": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 0, "creation_date": 1502797086, "post_id": 45689020, "comment_id": 78341671, "body": "Maybe you use the SoftDelete functionality? Read here: <a href=\"http://jinzhu.me/gorm/crud.html#delete\" rel=\"nofollow noreferrer\">jinzhu.me/gorm/crud.html#delete</a>"}, {"owner": {"reputation": 163, "user_id": 6485236, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8ac0d5b3298a8f80fa98d4f6c968311d?s=128&d=identicon&r=PG&f=1", "display_name": "Code On", "link": "https://stackoverflow.com/users/6485236/code-on"}, "reply_to_user": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 0, "creation_date": 1502803874, "post_id": 45689020, "comment_id": 78345678, "body": "yes I use it, thankyou so much bro"}], "answers": [{"tags": [], "owner": {"reputation": 1036, "user_id": 528858, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/4e136b95765b75644e7845b71ff8b865?s=128&d=identicon&r=PG", "display_name": "\u0416\u0430\u0441\u0443\u043b\u0430\u043d \u0411\u0435\u0440\u0434\u0438\u0431\u0435\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/528858/%d0%96%d0%b0%d1%81%d1%83%d0%bb%d0%b0%d0%bd-%d0%91%d0%b5%d1%80%d0%b4%d0%b8%d0%b1%d0%b5%d0%ba%d0%be%d0%b2"}, "is_accepted": false, "score": 0, "last_activity_date": 1610600646, "creation_date": 1610600646, "answer_id": 65713680, "question_id": 45689020, "link": "https://stackoverflow.com/questions/45689020/golang-gin-framework-gorm-query-didnt-work/65713680#65713680", "title": "Golang (GIN Framework) : GORM Query didnt work", "body": "<p>If your code has database connection error try to add some logger. I usually use <a href=\"https://github.com/sirupsen/logrus\" rel=\"nofollow noreferrer\">logrus</a> logger:</p>\n<pre><code>newLogger := logger.New(\n    config.Log,\n    logger.Config{\n        SlowThreshold: time.Second,\n        LogLevel:      logger.Error,\n        Colorful:      false,\n    },\n)\n</code></pre>\n<p>and configure logger with gorm connection line</p>\n<pre><code>database, err := gorm.Open(&quot;root:root@/insp?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;, &amp;gorm.Config{Logger: newLogger})\n</code></pre>\n<p>On production version I recommended use Error log level, but in debug mode you can use Info log level to see SQL queries to db.</p>\n<p>And I think I am using newer version than Question author. Sorry if that.</p>\n"}], "owner": {"reputation": 163, "user_id": 6485236, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8ac0d5b3298a8f80fa98d4f6c968311d?s=128&d=identicon&r=PG&f=1", "display_name": "Code On", "link": "https://stackoverflow.com/users/6485236/code-on"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1610600646, "creation_date": 1502785184, "last_edit_date": 1502787063, "question_id": 45689020, "link": "https://stackoverflow.com/questions/45689020/golang-gin-framework-gorm-query-didnt-work", "title": "Golang (GIN Framework) : GORM Query didnt work", "body": "<p>Sorry for asking such a dumb question.\nI just learn golang several days ago.</p>\n\n<p>And I want to build API Services with GIN Framework.\nI use Jinzhu gorm for query mysql database.</p>\n\n<p>The problem is, my query result always null.</p>\n\n<p>This is my code:</p>\n\n<p>Model folder:</p>\n\n<pre><code>package models\n\nimport \"github.com/jinzhu/gorm\"\n\ntype (\n    User struct {\n        gorm.Model\n        Name    string `json:\"name\"`\n        Phone   string `json:\"phone\"`\n        Address string `json:\"address\"`\n        Age     int    `json:\"age\"`\n        Gender  string `json:\"gender\"`\n    }\n)\n</code></pre>\n\n<p>Resource folder:</p>\n\n<pre><code>package resources\n\nimport (\n\n    // Standard library packages\n    \"net/http\"\n\n    // Third party packages\n    \"../models\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/jinzhu/gorm\"\n)\n\ntype (\n    UserResource struct {\n        db *gorm.DB\n    }\n)\n\nfunc NewUserResource(s *gorm.DB) *UserResource {\n    return &amp;UserResource{s}\n}\n\nfunc (ur UserResource) Index(c *gin.Context) {\n    var users []models.User\n\n    ur.db.Find(&amp;users)\n    if len(users) &lt;= 0 {\n        c.JSON(http.StatusNotFound, gin.H{\"status\": http.StatusNotFound, \"error\": \"not found\"})\n        return\n    }\n\n    c.JSON(http.StatusOK, gin.H{\"status\": http.StatusOK, \"data\": users})\n}\n</code></pre>\n\n<p>And the last is controller folder:</p>\n\n<pre><code>package controllers\n\nimport (\n    \"../resources\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/mysql\"\n)\n\ntype UserService struct {\n}\n\nfunc Database() *gorm.DB {\n    //open a db connection\n    db, err := gorm.Open(\"mysql\", \"root:root@/insp?charset=utf8&amp;parseTime=True&amp;loc=Local\")\n    if err != nil {\n        panic(\"failed to connect database\")\n    }\n\n    return db\n}\n\nfunc (s *UserService) Run() {\n    // Instantiate a new router\n    router := gin.Default()\n    v1 := router.Group(\"/api/v1/users\")\n    {\n        db := Database()\n        us := resources.NewUserResource(db)\n        v1.GET(\"/\", us.Index)\n    }\n    router.Run(\":9090\")\n}\n</code></pre>\n\n<p>everytime I hit the endpoint to get list of users, the result always return user not found.</p>\n\n<p>But When I change into Raw query, it works well </p>\n\n<pre><code>ur.db.Raw(\"SELECT * FROM users\").Scan(&amp;users)\n</code></pre>\n\n<p>I already try to read the GORM docs.</p>\n\n<p>anyone know how to fix it?</p>\n\n<p>Thanks for advice</p>\n"}, {"tags": ["go", "pprof"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1502801648, "post_id": 45688961, "comment_id": 78344225, "body": "pprof depends on the binary used to generate the profile."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1502802952, "post_id": 45688961, "comment_id": 78345100, "body": "Yes. I taken pprof data and binaries from Linux servers and profiled them on macOS many times."}, {"owner": {"reputation": 295, "user_id": 5808696, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8c890a9b7033dcd196b0e007cb9aa854?s=128&d=identicon&r=PG&f=1", "display_name": "caibirdme", "link": "https://stackoverflow.com/users/5808696/caibirdme"}, "edited": false, "score": 0, "creation_date": 1502852999, "post_id": 45688961, "comment_id": 78367197, "body": "Thx a lot,it works"}], "answers": [{"tags": [], "owner": {"reputation": 295, "user_id": 5808696, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8c890a9b7033dcd196b0e007cb9aa854?s=128&d=identicon&r=PG&f=1", "display_name": "caibirdme", "link": "https://stackoverflow.com/users/5808696/caibirdme"}, "is_accepted": false, "score": 0, "last_activity_date": 1502852969, "creation_date": 1502852969, "answer_id": 45704504, "question_id": 45688961, "link": "https://stackoverflow.com/questions/45688961/go-pprof-doesnt-work-in-different-platform/45704504#45704504", "title": "go pprof doesn&#39;t work in different platform", "body": "<p>as Adrian said, the binary is required for running pprof. So download the binary from server,put it into the same path on server, and it works</p>\n"}], "owner": {"reputation": 295, "user_id": 5808696, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8c890a9b7033dcd196b0e007cb9aa854?s=128&d=identicon&r=PG&f=1", "display_name": "caibirdme", "link": "https://stackoverflow.com/users/5808696/caibirdme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502852969, "creation_date": 1502784975, "question_id": 45688961, "link": "https://stackoverflow.com/questions/45688961/go-pprof-doesnt-work-in-different-platform", "title": "go pprof doesn&#39;t work in different platform", "body": "<p>My application is running on CentOS\uff0cand when I run <code>curl localhost:port/debug/pprof/profile &gt; some.pprof</code>\uff0cand run <code>go tool pprof some.pprof</code>, it works. But When I use <code>scp</code> copying the <code>some.pprof</code> file to my mac and run <code>go tool pprof some.pprof</code>,it doesn't work any more,command <code>top</code> display only 1 line in which flat and sum both are 100% and the last row is the name of my application rather than the name of methods invoked.\nIsn't the pprof file cross platform or something I've misused?</p>\n"}, {"tags": ["go", "cgo", "pprof"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1502802847, "post_id": 45687182, "comment_id": 78345018, "body": "No, <code>runtime&#47;pprof</code> can&#39;t record profile data from C code."}], "owner": {"reputation": 53, "user_id": 8171052, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tLld_9UfDqo/AAAAAAAAAAI/AAAAAAAAAH8/1YpKPJuq-fc/photo.jpg?sz=128", "display_name": "Leon Zhang", "link": "https://stackoverflow.com/users/8171052/leon-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 626, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1502776473, "creation_date": 1502776473, "question_id": 45687182, "link": "https://stackoverflow.com/questions/45687182/golang-pprof-for-c-library-code", "title": "golang pprof for c library code", "body": "<p>I have been trying to profile my golang application with pprof, but it seems that the details of my c code(linked as static library) is missed in the output result.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1uwqH.png\" rel=\"nofollow noreferrer\">flame graph</a></p>\n\n<p>From the frame graph you can see all the c code time consuming is reported within \"runtime._ExternalCode\", no details at all. And I am very sure my static library is compiled with debug enable.</p>\n\n<p>So Is there any way to make the pprof get the details(like stack trace) of 3rd party c code? Or Is there any other golang profiling tool to do this?</p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 13599, "user_id": 1739852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f706bb09511d498a29b2c2264dc37f9f?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1739852/james"}, "edited": false, "score": 0, "creation_date": 1502771695, "post_id": 45686466, "comment_id": 78330570, "body": "Thanks Vikram, your explanation helped a lot. I&#39;ve recently shifted to Go from PHP and am still wrapping my head around it."}, {"owner": {"reputation": 323, "user_id": 6621535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hxqL.png?s=128&g=1", "display_name": "Vikram", "link": "https://stackoverflow.com/users/6621535/vikram"}, "reply_to_user": {"reputation": 13599, "user_id": 1739852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f706bb09511d498a29b2c2264dc37f9f?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1739852/james"}, "edited": false, "score": 0, "creation_date": 1502771800, "post_id": 45686466, "comment_id": 78330598, "body": "I&#39;m glad it helped!"}], "tags": [], "owner": {"reputation": 323, "user_id": 6621535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hxqL.png?s=128&g=1", "display_name": "Vikram", "link": "https://stackoverflow.com/users/6621535/vikram"}, "is_accepted": true, "score": 2, "last_activity_date": 1502770986, "creation_date": 1502770986, "answer_id": 45686466, "question_id": 45686269, "link": "https://stackoverflow.com/questions/45686269/loop-over-nested-json-elements-in-go/45686466#45686466", "title": "Loop over nested JSON elements in Go", "body": "<p>The error you are getting is due to the way you are defining your <code>OrderAddresses</code> struct. Instead of</p>\n\n<pre><code>type OrderAddresses []struct {\n</code></pre>\n\n<p>If you use</p>\n\n<pre><code>type OrderAddresses struct {\n</code></pre>\n\n<p>without the braces, your compile error should go away. </p>\n\n<p>That being said, I'm not sure if your json will parse as you expect given the blob I'm looking at. It appears that <code>addresses</code> in the json blob is an array. This means that instead of representing it as</p>\n\n<pre><code>Addresses map[string]OrderAddresses `json:\"addresses\"`\n</code></pre>\n\n<p>You should simply make it a slice of <code>OrderAddresses</code></p>\n\n<pre><code>Addresses []OrderAddresses `json:\"addresses\"`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "is_accepted": false, "score": 1, "last_activity_date": 1502772145, "last_edit_date": 1502772145, "creation_date": 1502771013, "answer_id": 45686471, "question_id": 45686269, "link": "https://stackoverflow.com/questions/45686269/loop-over-nested-json-elements-in-go/45686471#45686471", "title": "Loop over nested JSON elements in Go", "body": "<p>The reason you are getting the <code>orderaddress.Region undefined</code> error is because the <code>orderaddress</code> in your <code>for</code> loop is an array, based on your <code>OrderAddresses</code> type. Obviously, an array doesn't have fields or methods named <code>Region</code>. </p>\n\n<p>If you want to examine what <code>orderaddress</code> in your <code>for</code> loop looks like, you can <code>range</code> over it like this:</p>\n\n<pre><code>for _, orderaddress := range order.Addresses {\n  for _, addressData := range orderaddress{\n      fmt.Printf(\"%+v\\n\", addressData)\n  }\n}\n</code></pre>\n\n<p>I have created an example <a href=\"https://play.golang.org/p/jcTc05sMfz\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>That said, in your JSON data, the <code>addresses</code> field is an array, not a map. So the <code>Addresses</code> field in your <code>Order</code> struct must be an array too. Then your <code>OrderAddresses</code> should just be a struct, not a slice of struct.</p>\n"}], "owner": {"reputation": 13599, "user_id": 1739852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f706bb09511d498a29b2c2264dc37f9f?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1739852/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 45686466, "answer_count": 2, "score": 0, "last_activity_date": 1502772145, "creation_date": 1502769493, "question_id": 45686269, "link": "https://stackoverflow.com/questions/45686269/loop-over-nested-json-elements-in-go", "title": "Loop over nested JSON elements in Go", "body": "<p>I am receiving a JSON response from an API that contains one or more \"entities\". The JSON looks like this:</p>\n\n<pre><code>{\n    \"3211\": {\n        \"entity_id\": \"3211\",\n        \"status\": \"complete\",\n        \"coupon_code\": \"COUPON\",\n        \"shipping_description\": \"Shipping - AU Courier\",\n        \"customer_id\": \"2775\",\n        \"base_discount_amount\": \"-50.0000\",\n        \"base_grand_total\": \"149.0000\",\n        \"base_shipping_amount\": \"0.0000\",\n        \"base_shipping_tax_amount\": \"0.0000\",\n        \"base_subtotal\": \"199.0000\",\n        \"base_tax_amount\": \"0.0000\",\n        \"base_total_paid\": \"149.0000\",\n        \"base_total_refunded\": null,\n        \"discount_amount\": \"-50.0000\",\n        \"grand_total\": \"149.0000\",\n        \"shipping_amount\": \"0.0000\",\n        \"shipping_tax_amount\": \"0.0000\",\n        \"store_to_order_rate\": \"1.0000\",\n        \"subtotal\": \"199.0000\",\n        \"tax_amount\": \"0.0000\",\n        \"total_paid\": \"149.0000\",\n        \"total_refunded\": null,\n        \"base_shipping_discount_amount\": \"0.0000\",\n        \"base_subtotal_incl_tax\": \"199.0000\",\n        \"base_total_due\": \"0.0000\",\n        \"shipping_discount_amount\": \"0.0000\",\n        \"subtotal_incl_tax\": \"199.0000\",\n        \"total_due\": \"0.0000\",\n        \"increment_id\": \"200000423\",\n        \"base_currency_code\": \"AUD\",\n        \"discount_description\": \"COUPON\",\n        \"remote_ip\": \"123.123.123.123\",\n        \"store_currency_code\": \"AUD\",\n        \"store_name\": \"Australia\",\n        \"created_at\": \"2017-07-17 03:07:40\",\n        \"shipping_incl_tax\": \"0.0000\",\n        \"payment_method\": \"ewayrapid_ewayone\",\n        \"gift_message_from\": null,\n        \"gift_message_to\": null,\n        \"gift_message_body\": null,\n        \"tax_name\": null,\n        \"tax_rate\": null,\n        \"addresses\": [\n            {\n                \"region\": \"South Australia\",\n                \"postcode\": \"5000\",\n                \"lastname\": \"Doe\",\n                \"street\": \"Level 6\\n25 Example Street\",\n                \"city\": \"Adelaide\",\n                \"email\": \"example@email.com\",\n                \"telephone\": \"+61 123 456 789\",\n                \"country_id\": \"AU\",\n                \"firstname\": \"John\",\n                \"address_type\": \"billing\",\n                \"prefix\": null,\n                \"middlename\": null,\n                \"suffix\": null,\n                \"company\": null\n            },\n            {\n                \"region\": \"South Australia\",\n                \"postcode\": \"5000\",\n                \"lastname\": \"Doe\",\n                \"street\": \"Level 6\\n25 Example Street\",\n                \"city\": \"Adelaide\",\n                \"email\": \"example@email.com\",\n                \"telephone\": \"+61 123 456 789\",\n                \"country_id\": \"AU\",\n                \"firstname\": \"John\",\n                \"address_type\": \"shipping\",\n                \"prefix\": null,\n                \"middlename\": null,\n                \"suffix\": null,\n                \"company\": null\n            }\n        ]\n    }\n}\n</code></pre>\n\n<p>I have written the following <code>struct</code> types:</p>\n\n<pre><code>type Orders map[string]Order\ntype Order struct {\n    EntityID                   string                    `json:\"entity_id\"`\n    Status                     string                    `json:\"status\"`\n    CouponCode                 string                    `json:\"coupon_code\"`\n    ShippingDescription        string                    `json:\"shipping_description\"`\n    CustomerID                 string                    `json:\"customer_id\"`\n    BaseDiscountAmount         string                    `json:\"base_discount_amount\"`\n    BaseGrandTotal             string                    `json:\"base_grand_total\"`\n    BaseShippingAmount         string                    `json:\"base_shipping_amount\"`\n    BaseShippingTaxAmount      string                    `json:\"base_shipping_tax_amount\"`\n    BaseSubtotal               string                    `json:\"base_subtotal\"`\n    BaseTaxAmount              string                    `json:\"base_tax_amount\"`\n    BaseTotalPaid              string                    `json:\"base_total_paid\"`\n    BaseTotalRefunded          string                    `json:\"base_total_refunded\"`\n    DiscountAmount             string                    `json:\"discount_amount\"`\n    GrandTotal                 string                    `json:\"grand_total\"`\n    ShippingAmount             string                    `json:\"shipping_amount\"`\n    ShippingTaxAmount          string                    `json:\"shipping_tax_amount\"`\n    StoreToOrderRate           string                    `json:\"store_to_order_rate\"`\n    Subtotal                   string                    `json:\"subtotal\"`\n    TaxAmount                  string                    `json:\"tax_amount\"`\n    TotalPaid                  string                    `json:\"total_paid\"`\n    TotalRefunded              string                    `json:\"total_refunded\"`\n    BaseShippingDiscountAmount string                    `json:\"base_shipping_discount_amount\"`\n    BaseSubtotalInclTax        string                    `json:\"base_subtotal_incl_tax\"`\n    BaseTotalDue               string                    `json:\"base_total_due\"`\n    ShippingDiscountAmount     string                    `json:\"shipping_discount_amount\"`\n    SubtotalInclTax            string                    `json:\"subtotal_incl_tax\"`\n    TotalDue                   string                    `json:\"total_due\"`\n    IncrementID                string                    `json:\"increment_id\"`\n    BaseCurrencyCode           string                    `json:\"base_currency_code\"`\n    DiscountDescription        string                    `json:\"discount_description\"`\n    RemoteIP                   string                    `json:\"remote_ip\"`\n    StoreCurrencyCode          string                    `json:\"store_currency_code\"`\n    StoreName                  string                    `json:\"store_name\"`\n    CreatedAt                  string                    `json:\"created_at\"`\n    ShippingInclTax            string                    `json:\"shipping_incl_tax\"`\n    PaymentMethod              string                    `json:\"payment_method\"`\n    TaxName                    string                    `json:\"tax_name\"`\n    TaxRate                    string                    `json:\"tax_rate\"`\n    Addresses                  map[string]OrderAddresses `json:\"addresses\"`\n}\n\ntype OrderAddresses []struct {\n    Region      string  `json:\"region\"`\n    Postcode    string  `json:\"postcode\"`\n    Lastname    string  `json:\"lastname\"`\n    Street      string  `json:\"street\"`\n    City        string  `json:\"city\"`\n    Email       string  `json:\"email\"`\n    Telephone   string  `json:\"telephone\"`\n    CountryID   string  `json:\"country_id\"`\n    Firstname   string  `json:\"firstname\"`\n    AddressType string  `json:\"address_type\"`\n    Prefix      *string `json:\"prefix\"`\n    Middlename  *string `json:\"middlename\"`\n    Suffix      *string `json:\"suffix\"`\n    Company     *string `json:\"company\"`\n}\n</code></pre>\n\n<p>I am then trying to process it like so (the <code>getFromOrdersAPI(page)</code> function returns the JSON mentioned above in the <code>Orders</code> type):</p>\n\n<pre><code>for page := 1; page &lt; 3; page++ {\n    orders := getFromOrdersAPI(page)\n    for _, order := range orders {\n        //Process all the order items except addresses\n        fmt.Println(\"Processing entity:\", orders.EntityID)\n\n        for _, orderaddress := range order.Addresses {\n            //Trying to access address values - example below\n            fmt.Println(orderaddress.Region)\n        }\n    }\n}\n</code></pre>\n\n<p>When running this, I get the error:</p>\n\n<blockquote>\n  <p>orderaddress.Region undefined (type OrderAddresses has no field or method Region)</p>\n</blockquote>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1502769376, "post_id": 45686163, "comment_id": 78330131, "body": "You could do it with ParseInt / ParseFloat like you said, or you could write a pretty simple regex to do the job."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1502794984, "post_id": 45686163, "comment_id": 78340593, "body": "Also worth considering <code>strconv.ParseFloat</code> will allow scientific notation which might be undesirable for your case: <a href=\"https://play.golang.org/p/uEaeWzucOq\" rel=\"nofollow noreferrer\">play.golang.org/p/uEaeWzucOq</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "is_accepted": false, "score": 2, "last_activity_date": 1502770140, "last_edit_date": 1502770140, "creation_date": 1502769496, "answer_id": 45686270, "question_id": 45686163, "link": "https://stackoverflow.com/questions/45686163/how-to-write-isnumeric-function-in-golang/45686270#45686270", "title": "How to write isNumeric function in Golang?", "body": "<p>You can use the <code>strconv.Atoi</code> function for check integer values, and the <code>strconv.ParseFloat</code> for float values. Below is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    v1 := \"14\"\n\n    if _, err := strconv.Atoi(v1); err == nil {\n        fmt.Printf(\"%q looks like a number.\\n\", v1)\n    } else {\n        fmt.Printf(\"%q is not a number.\\n\", v1)\n    }\n\n    v2 := \"1.4\"\n    if _, err := strconv.ParseFloat(v2, 64); err == nil {\n        fmt.Printf(\"%q looks like a float.\\n\", v2)\n    } else {\n        fmt.Printf(\"%q is not a float.\\n\", v2)\n    }\n}\n\n/* Output:\n\"14\" looks like a number.\n\"1.4\" looks like a float.\n*/\n</code></pre>\n\n<p>You can check it on the <a href=\"https://play.golang.org/p/zbK2f21sTF\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1044, "user_id": 1949322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b49c06625a28488b90d2b7f960163f?s=128&d=identicon&r=PG", "display_name": "WaltPurvis", "link": "https://stackoverflow.com/users/1949322/waltpurvis"}, "is_accepted": true, "score": 17, "last_activity_date": 1502770915, "creation_date": 1502770915, "answer_id": 45686455, "question_id": 45686163, "link": "https://stackoverflow.com/questions/45686163/how-to-write-isnumeric-function-in-golang/45686455#45686455", "title": "How to write isNumeric function in Golang?", "body": "<blockquote>\n  <p>I was thinking of using strconv ParseInt and ParseFloat but not sure\n  if that is the right way.</p>\n</blockquote>\n\n<p>Well, it's certainly <em>a</em> right way.</p>\n\n<p>You don't need to use ParseInt, though. ParseFloat will do the job.</p>\n\n<pre><code>func isNumeric(s string) bool {\n    _, err := strconv.ParseFloat(s, 64)\n    return err == nil\n}\n</code></pre>\n\n<p>See an example here: <a href=\"https://play.golang.org/p/D53HRS-KIL\" rel=\"noreferrer\">https://play.golang.org/p/D53HRS-KIL</a></p>\n"}, {"comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1502781739, "post_id": 45688079, "comment_id": 78333998, "body": "If you benchmark something best use <a href=\"https://golang.org/pkg/testing/#pkg-overview\" rel=\"nofollow noreferrer\">go&#39;s build in benchmarking</a>"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1502782469, "post_id": 45688079, "comment_id": 78334296, "body": "@TehSphinX thanks for your comment, here it is obvious for me that <code>isNumDot</code> is faster than <code>isNumeric</code> because  <code>strconv.ParseFloat</code> doing more extra works &quot;converts the string  to a floating-point number&quot;."}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 6, "last_activity_date": 1597255119, "last_edit_date": 1597255119, "creation_date": 1502781312, "answer_id": 45688079, "question_id": 45686163, "link": "https://stackoverflow.com/questions/45686163/how-to-write-isnumeric-function-in-golang/45688079#45688079", "title": "How to write isNumeric function in Golang?", "body": "<p>If you need to convert the string to a floating-point number <code>strconv.ParseFloat</code> is the first choice.<br />\nHere you just need to know that there is only <code>&quot;0123456789&quot;</code> and maximum one <code>'.'</code> in your string, here for me <code>isNumDot</code> is <code>12x</code> faster than <code>isNumeric</code>, see:<br />\nConsider this (1.7 seconds) - optimized for performance:</p>\n<pre><code>func isNumDot(s string) bool {\n    dotFound := false\n    for _, v := range s {\n        if v == '.' {\n            if dotFound {\n                return false\n            }\n            dotFound = true\n        } else if v &lt; '0' || v &gt; '9' {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n<p>and this (21.7 seconds - doing more extra works &quot;converts the string to a floating-point number&quot;):</p>\n<pre><code>func isNumeric(s string) bool {\n    _, err := strconv.ParseFloat(s, 64)\n    return err == nil\n}\n</code></pre>\n<hr />\n<p>Try it:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;strconv&quot;\n    &quot;time&quot;\n)\n\nfunc isNumDot(s string) bool {\n    dotFound := false\n    for _, v := range s {\n        if v == '.' {\n            if dotFound {\n                return false\n            }\n            dotFound = true\n        } else if v &lt; '0' || v &gt; '9' {\n            return false\n        }\n    }\n    return true\n}\n\nfunc isNumeric(s string) bool {\n    _, err := strconv.ParseFloat(s, 64)\n    return err == nil\n}\n\nfunc main() {\n    fmt.Println(isNumDot(&quot;240&quot;))     //true\n    fmt.Println(isNumDot(&quot;abcd123&quot;)) //false\n    fmt.Println(isNumDot(&quot;0.4.&quot;))    //false\n    fmt.Println(isNumDot(&quot;240 &quot;))    //false\n    benchmark(isNumDot)\n    benchmark(isNumeric)\n}\n\nfunc benchmark(f func(string) bool) {\n    var res bool\n    t := time.Now()\n    for i := 0; i &lt; 100000000; i++ {\n        res = f(&quot;a 240&quot;) || f(&quot;abcd123&quot;) || f(&quot;0.4.&quot;) || f(&quot;240 &quot;)\n    }\n    fmt.Println(time.Since(t))\n    fmt.Println(res)\n}\n</code></pre>\n<p>output:</p>\n<pre><code>true\nfalse\nfalse\nfalse\n1.7822s\nfalse\n21.723s\nfalse\n</code></pre>\n<hr />\n<p>Using the benchmark (<code>isNumDot</code> is faster than <code>isNumeric</code>):</p>\n<pre><code>BenchmarkIsNumDot-8     34117197            31.2 ns/op         0 B/op          0 allocs/op\nBenchmarkIsNumeric-8     1931089           630 ns/op         192 B/op          4 allocs/op\n\n// r = isNumDot(&quot;2.22&quot;)\nBenchmarkIsNumDot-8     102849996           11.4 ns/op         0 B/op          0 allocs/op\nBenchmarkIsNumeric-8    21994874            48.5 ns/op         0 B/op          0 allocs/op\n\n// r = isNumDot(&quot;a 240&quot;)\nBenchmarkIsNumDot-8     256610877            4.58 ns/op        0 B/op          0 allocs/op\nBenchmarkIsNumeric-8     8962381           140 ns/op          48 B/op          1 allocs/op\n</code></pre>\n<p>The benchmark:</p>\n<pre><code>package main\n\nimport (\n    &quot;testing&quot;\n)\n\nvar r bool\n\nfunc BenchmarkIsNumDot(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        r = isNumDot(&quot;a 240&quot;) || isNumDot(&quot;abcd123&quot;) || isNumDot(&quot;0.4.&quot;) || isNumDot(&quot;240 &quot;)\n    }\n}\n\nfunc BenchmarkIsNumeric(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        r = isNumeric(&quot;a 240&quot;) || isNumeric(&quot;abcd123&quot;) || isNumeric(&quot;0.4.&quot;) || isNumeric(&quot;240 &quot;)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1502805132, "creation_date": 1502805132, "answer_id": 45694318, "question_id": 45686163, "link": "https://stackoverflow.com/questions/45686163/how-to-write-isnumeric-function-in-golang/45694318#45694318", "title": "How to write isNumeric function in Golang?", "body": "<p>All the answers are valid, but there's another option not yet suggested:</p>\n\n<pre><code>re := regexp.MustCompile(`^[0-9]+(\\.[0-9]+)?$`)\nisNum := re.Match([]byte(\"ab123\"))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/FaiGlmH6Pw\" rel=\"nofollow noreferrer\">Playground demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 170, "user_id": 7414735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UoBCR.jpg?s=128&g=1", "display_name": "Vector", "link": "https://stackoverflow.com/users/7414735/vector"}, "is_accepted": false, "score": 3, "last_activity_date": 1554870883, "creation_date": 1554870883, "answer_id": 55604797, "question_id": 45686163, "link": "https://stackoverflow.com/questions/45686163/how-to-write-isnumeric-function-in-golang/55604797#55604797", "title": "How to write isNumeric function in Golang?", "body": "<p>I tried to comment on Adrian's answer but I guess I don't have enough reputation points. Building on his excellent response, here is a variation using PCRE. Some brief explanation on the symbols if you are unfamiliar with regular expressions:</p>\n\n<p>\"^\" matches the start of input (i.e. beginning of your string)</p>\n\n<p>\"$\" matches the end of input (i.e. the end of your string)</p>\n\n<p>\"()\" are grouping operators</p>\n\n<p>\"*\" matches 0 or more</p>\n\n<p>\"+\" matches 1 or more</p>\n\n<p>\"?\" matches exactly 0 or 1</p>\n\n<p>\"\\d\" is a character class which represents the character values 0 through 9</p>\n\n<p>So, the following would require at least a leading 0, permit \"0.\", and everything else that is normally identified as a floating point value. You can experiment with this a bit.</p>\n\n<pre><code>func isFloat(s string) bool {\n    return regexp.MatchString(`^\\d+(\\.\\d*)?$`, s)\n}\n</code></pre>\n\n<p>Naturally, if you are calling this function to validate data, it should be cleaned:</p>\n\n<pre><code>str := strings.TrimSpace(someString)\nif isFloat(str) {\n  ...\n}\n</code></pre>\n\n<p>That only works on ASCII characters. If you are dealing with UTF8 or another multi-byte character set (MBCS), it can be done with regexp but more work would be required and perhaps another approach altogether.</p>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 214652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a8b303d9c8b3ad795985da7f4121da?s=128&d=identicon&r=PG", "display_name": "Tim Crone", "link": "https://stackoverflow.com/users/214652/tim-crone"}, "is_accepted": false, "score": 0, "last_activity_date": 1617219725, "creation_date": 1617219725, "answer_id": 66894313, "question_id": 45686163, "link": "https://stackoverflow.com/questions/45686163/how-to-write-isnumeric-function-in-golang/66894313#66894313", "title": "How to write isNumeric function in Golang?", "body": "<p>I hit this in a high-throughput system today and did a benchmark of the three suggestions.  Results:</p>\n<p>BenchmarkNumDot-4: 657966132: 18.2 ns/op<br />\nBenchmarkNumeric-4: 49575919: 226 ns/op<br />\nBenchmarkRegexp-4: 18817201: 628 ns/op</p>\n<p>Code follows since the playground does not support benchmarking.</p>\n<pre><code>package main\n\nimport (\n    &quot;regexp&quot;\n    &quot;strconv&quot;\n    &quot;testing&quot;\n)\n\n\nfunc BenchmarkNumDot(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        isNumDot(&quot;abc&quot;)\n    isNumDot(&quot;123&quot;)\n    isNumDot(&quot;12.34&quot;)\n    isNumDot(&quot;1.2.3.4&quot;)\n    }\n}\n\nfunc BenchmarkNumeric(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        isNumeric(&quot;abc&quot;)\n    isNumeric(&quot;123&quot;)\n    isNumeric(&quot;12.34&quot;)\n    isNumeric(&quot;1.2.3.4&quot;)\n    }\n}\n\nfunc BenchmarkRegexp(b *testing.B) {\n    re := regexp.MustCompile(`^[0-9]+(\\.[0-9]+)?$`)\n\n    for i := 0; i &lt; b.N; i++ {\n        isNumReg(&quot;abc&quot;, re)\n        isNumReg(&quot;123&quot;, re)\n        isNumReg(&quot;12.34&quot;, re)\n        isNumReg(&quot;1.2.3.4&quot;, re)\n    }\n}\n\nfunc isNumDot(s string) bool {\n    dotFound := false\n    for _, v := range s {\n        if v == '.' {\n            if dotFound {\n                return false\n            }\n            dotFound = true\n        } else if v &lt; '0' || v &gt; '9' {\n            return false\n        }\n    }\n    return true\n}\n\nfunc isNumeric(s string) bool {\n    _, err := strconv.ParseFloat(s, 64)\n    return err == nil\n}\n\nfunc isNumReg(s string, re *regexp.Regexp) bool {\n    return re.Match([]byte(s))\n}\n</code></pre>\n"}], "owner": {"reputation": 1705, "user_id": 2754724, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0db5a1fac483a5c97d7084b35483c8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Crusaderpyro", "link": "https://stackoverflow.com/users/2754724/crusaderpyro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12412, "favorite_count": 0, "accepted_answer_id": 45686455, "answer_count": 6, "score": 4, "last_activity_date": 1617219725, "creation_date": 1502768442, "last_edit_date": 1542563718, "question_id": 45686163, "link": "https://stackoverflow.com/questions/45686163/how-to-write-isnumeric-function-in-golang", "title": "How to write isNumeric function in Golang?", "body": "<p>I want to check if a string is numeric. </p>\n\n<p>For example:</p>\n\n<ul>\n<li><code>\"abcd123\"</code> should return <code>false</code>. </li>\n<li><code>\"1.4\"</code> or <code>\"240\"</code> should return <code>true</code>. </li>\n</ul>\n\n<p>I thought about using <code>ParseInt</code> and <code>ParseFloat</code> (from the <code>strconv</code> package), but am not sure if that is the right way.</p>\n"}, {"tags": ["templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1502823319, "post_id": 45686610, "comment_id": 78357582, "body": "Thank you, the approach seems a quite bit better, but I am not sure if I like the &quot;if,else,else,else&quot; type structure."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 3, "last_activity_date": 1502772180, "creation_date": 1502772180, "answer_id": 45686610, "question_id": 45685547, "link": "https://stackoverflow.com/questions/45685547/how-to-return-a-html-template-from-a-template-funcmap/45686610#45686610", "title": "How to return a HTML template from a template.FuncMap?", "body": "<p>You should separate the <em>logic</em> (function) from <em>presentation</em> (template). \nThe function registered in <code>template.FuncMap</code> should not depends on template as its input to produce an output. If you want to return HTML template as the function output, you should generate it manually (using <code>fmt.Sprintf</code>, etc.). </p>\n\n<p>In your case, you can simply register a function to check the media type, then generate different output using template's <a href=\"https://golang.org/pkg/text/template/#hdr-Actions\" rel=\"nofollow noreferrer\"><code>{{if}}</code></a>  action. The function may looks like:</p>\n\n<pre><code>func matchType(ext, s string) bool {\n    return strings.ToLower(ext) == strings.ToLower(path.Ext(s))\n}\n</code></pre>\n\n<p>and the template looks like:</p>\n\n<pre><code>{{ range .Media }}&lt;p&gt;\n    {{if . | matchType \".jpg\"}}&lt;img src={{.}}&gt;\n    {{else if . | matchType \".mp4\"}}&lt;video controls src={{.}}&gt;&lt;/video&gt;\n    {{else}}{{.}}\n    {{end}}&lt;/p&gt;\n{{ end }}\n</code></pre>\n\n<p>A working example based on your reduced example: <a href=\"https://play.golang.org/p/U64_7UHZQU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/U64_7UHZQU</a></p>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 45686610, "answer_count": 1, "score": 1, "last_activity_date": 1502772180, "creation_date": 1502762973, "question_id": 45685547, "link": "https://stackoverflow.com/questions/45685547/how-to-return-a-html-template-from-a-template-funcmap", "title": "How to return a HTML template from a template.FuncMap?", "body": "<p>I asked this question upon <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/CUbdaHkESJk\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/CUbdaHkESJk</a> but received no replies.</p>\n\n<p>I'm writing a <a href=\"https://github.com/kaihendry/lk\" rel=\"nofollow noreferrer\">Web based media viewer</a> and I've hit a snag about how to mark up different media.</p>\n\n<p>My current code here: <a href=\"https://github.com/kaihendry/lk/blob/5de96f9fe012e9894deef7b9924f96dd8d9c806c/main.go#L181\" rel=\"nofollow noreferrer\">https://github.com/kaihendry/lk/blob/5de96f9fe012e9894deef7b9924f96dd8d9c806c/main.go#L181</a>\nis certainly wrong. I am puzzled how to use a template here in light of <a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow noreferrer\">https://golang.org/pkg/html/template/#Template.Execute</a></p>\n\n<p>All the examples I see of using template.FuncMap just use strings...</p>\n\n<p>Reduced example: <a href=\"https://play.golang.org/p/mAue8SDDw6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mAue8SDDw6</a></p>\n\n<p>Ideally I would use html templates here and not fmt.Sprintf. Yes, I realise I am not HTML escaping the filename which is wrong, but I am not sure how to use HTML templates again from this function.</p>\n\n<p>Thanks in advance for any guidance,</p>\n"}, {"tags": ["go", "syntax", "terminal", "ffmpeg", "syntax-error"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1502763191, "post_id": 45685483, "comment_id": 78328891, "body": "<a href=\"https://golang.org/pkg/os/exec/#Command\" rel=\"nofollow noreferrer\"><code>exec.Command</code></a> returns a <code>*Cmd</code>, not an error."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6460561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7779c94d185262f8c60a1bd7e8a581bb?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6460561/ryan"}, "edited": false, "score": 0, "creation_date": 1502916027, "post_id": 45688183, "comment_id": 78403205, "body": "awesome that solved my problem. what is the function for the &quot;&amp;&quot; in <code>&amp;out</code>?  is that because it is declared as a var?"}, {"owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "reply_to_user": {"reputation": 21, "user_id": 6460561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7779c94d185262f8c60a1bd7e8a581bb?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6460561/ryan"}, "edited": false, "score": 0, "creation_date": 1502960936, "post_id": 45688183, "comment_id": 78419350, "body": "cmd.Stdout is io.Writer. It can be anything that implements Write method. out is bytes.Buffer object - that has this method and can be used for such purposes."}], "tags": [], "owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "is_accepted": false, "score": 3, "last_activity_date": 1502790688, "last_edit_date": 1502790688, "creation_date": 1502781813, "answer_id": 45688183, "question_id": 45685483, "link": "https://stackoverflow.com/questions/45685483/golang-exec-command-error-ffmpeg-command-through-golang/45688183#45688183", "title": "Golang exec.Command() error - ffmpeg command through golang", "body": "<p>as @JimB says, exec.Command does not return an error.\nHere is changed code from example <a href=\"https://golang.org/pkg/os/exec/#Command\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/#Command</a></p>\n\n<p>By the way you dont need to use <code>\"\\\"video-1.ts\\\"\"</code> - your quotes is shell feature.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmdArguments := []string{\"-i\", \"video-1.ts\", \"-c:v\", \"libx264\",\n     \"-crf\", \"20\", \"-c:a\", \"aac\", \"-strict\", \"-2\", \"video1-fix.ts\"}\n\n    cmd := exec.Command(\"tr\", cmdArguments...)\n\n    var out bytes.Buffer\n    cmd.Stdout = &amp;out\n    err := cmd.Run()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"command output: %q\\n\", out.String())\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6460561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7779c94d185262f8c60a1bd7e8a581bb?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6460561/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2208, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1502790688, "creation_date": 1502762348, "question_id": 45685483, "link": "https://stackoverflow.com/questions/45685483/golang-exec-command-error-ffmpeg-command-through-golang", "title": "Golang exec.Command() error - ffmpeg command through golang", "body": "<p>Currently working with this ffmpeg command to edit video </p>\n\n<pre><code>ffmpeg -i \"video1.ts\" -c:v libx264 -crf 20 -c:a aac -strict -2 \"video1-fix.ts\"\n</code></pre>\n\n<p>When I enter it in the terminal, it works. However when I try to use the Golang exec.Command() func, I get err response of </p>\n\n<pre><code>&amp;{/usr/local/bin/ffmpeg [ffmpeg -i \"video1.ts\" -c:v libx264 -crf 20 -c:a aac -strict -2 \"video1-fix.ts\"] []  &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; [] &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; false [] [] [] [] &lt;nil&gt; &lt;nil&gt;}\n</code></pre>\n\n<p>Here below is my code</p>\n\n<pre><code>cmdArguments := []string{\"-i\", \"\\\"video-1.ts\\\"\", \"-c:v\", \"libx264\",\n         \"-crf\", \"20\", \"-c:a\", \"aac\", \"-strict\", \"-2\", \"\\\"video1-fix.ts\\\"\"}\n\nerr := exec.Command(\"ffmpeg\", cmdArguments...)\nfmt.Println(err)\n</code></pre>\n\n<p>Am i missing something from my command syntax? Not sure why it is not loading the videos</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1502768111, "post_id": 45685383, "comment_id": 78329870, "body": "Your Result type is &quot;unidiomatic&quot; (an euphemism for &quot;dead ugly&quot;). Don&#39;t do such things. Redesign, refactor."}], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 2, "last_activity_date": 1502763003, "creation_date": 1502763003, "answer_id": 45685551, "question_id": 45685383, "link": "https://stackoverflow.com/questions/45685383/golang-convert-mapstringinterface-to-slice-or-array-of-other-type/45685551#45685551", "title": "Golang convert map[string]*[]interface{} to slice or array of other type", "body": "<p>Here are some comments on your code besides the conversion (which is also addressed at the end).</p>\n\n<ul>\n<li>There is no real need of using a pointer to a slice in this case, since slices are just header values pointing to the underlying array. So slice values would work as references to the underlying array.</li>\n<li>Since an <code>interface{}</code> variable can reference values of any kind (including slices), there is no need to use a slice of <code>interface{}</code> in <code>Result</code>, you can just define it as <code>type Results map[string]interface{}</code>.</li>\n</ul>\n\n<p>Having said this, here's how the modified code would look like:</p>\n\n<pre><code>var users []User\nusers = getUsers()\n\nresults := Results{}\nresults[\"users\"] = users\n\nfmt.Println(results)\n\nvar userResults []User\nuserResults = results[\"users\"].([]User)\n\nfmt.Println(userResults)\n</code></pre>\n\n<p>You can find the complete code in this playground:</p>\n\n<p><a href=\"https://play.golang.org/p/zL4IkWy97j\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zL4IkWy97j</a></p>\n"}], "owner": {"reputation": 7606, "user_id": 180253, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df46030788b7cc95cadb9778a2b9e7dd?s=128&d=identicon&r=PG", "display_name": "TheJediCowboy", "link": "https://stackoverflow.com/users/180253/thejedicowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1853, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1502763003, "creation_date": 1502761392, "question_id": 45685383, "link": "https://stackoverflow.com/questions/45685383/golang-convert-mapstringinterface-to-slice-or-array-of-other-type", "title": "Golang convert map[string]*[]interface{} to slice or array of other type", "body": "<p>I have the following</p>\n\n<pre><code>type Results map[string]*[]interface{}\n\nvar users *[]models.User\nusers = getUsers(...)\n\nresults := Results{}\nresults[\"users\"] = users\n</code></pre>\n\n<p>Later, id like to be able to grab <code>users</code> from this map and cast it to <code>*[]models.User</code></p>\n\n<p>I am having a hard time figuring out the right way to do this. Id like to do the following, but it obviously does not work.</p>\n\n<pre><code>var userResults *[]models.User\nuserResults = (*results[\"users\").(*[]models.User)\n</code></pre>\n\n<p>Any idea on how to do this?</p>\n"}, {"tags": ["loops", "go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 1, "last_activity_date": 1502761505, "creation_date": 1502761505, "answer_id": 45685393, "question_id": 45685024, "link": "https://stackoverflow.com/questions/45685024/pass-a-result-from-goroutine-to-a-variable-inside-the-loop/45685393#45685393", "title": "Pass a result from goroutine to a variable inside the loop", "body": "<p>To do it using channels you'll have to refactor your code quite a bit.</p>\n\n<p>Smallest change would be to do the assignment in the goroutine:</p>\n\n<pre><code>go func(){\n    person.WillDieAt = slowExternalFunction(i)\n}()\n</code></pre>\n\n<p>However, to make this work we'd need to make some other changes as well:</p>\n\n<ul>\n<li>Use an array of pointers so that you can add the person before the assignment finishes.</li>\n<li>Implement a wait group so that you wait for all goroutines to finish before printing the results.</li>\n</ul>\n\n<p>Here's the complete <code>main</code> function with the changes:</p>\n\n<pre><code>func main() {\n    var persons []*Person\n    var wg sync.WaitGroup\n\n    for i := 0; i &lt;= 100; i++{\n        person := &amp;Person{}\n        person.Id = i\n        person.Name = fastInternalFunction(i)\n        wg.Add(1)\n        go func(){\n            person.WillDieAt = slowExternalFunction(i)\n            wg.Done()\n        }()\n\n        persons = append(persons,person)\n    }\n    wg.Wait()\n    for _, person := range persons {\n        fmt.Printf(\"%v \", person )\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/8GWYD29inC\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8GWYD29inC</a></p>\n"}], "owner": {"reputation": 33, "user_id": 8464638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7f024a285a0951332f8b8ce3718488e?s=128&d=identicon&r=PG&f=1", "display_name": "Lock-o-motiffe", "link": "https://stackoverflow.com/users/8464638/lock-o-motiffe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 1, "accepted_answer_id": 45685393, "answer_count": 1, "score": 0, "last_activity_date": 1502813497, "creation_date": 1502758148, "last_edit_date": 1502813497, "question_id": 45685024, "link": "https://stackoverflow.com/questions/45685024/pass-a-result-from-goroutine-to-a-variable-inside-the-loop", "title": "Pass a result from goroutine to a variable inside the loop", "body": "<p>At the code below how to assign a result from <strong>slowExternalFunction</strong> to a proper <strong>person</strong>? It can be done via channels and just for clarity I defined that <strong>slowExternalFunction</strong> returns <strong>int</strong>.</p>\n\n<pre><code>type Person struct {\n    Id        int\n    Name      string\n    WillDieAt int\n}\n\nfunc slowExternalAPI(i int) int {\n    time.Sleep(10)\n    willDieAt := i + 2040\n    return willDieAt \n}\n\nfunc fastInternalFunction(i int) string {\n    time.Sleep(1)\n    return fmt.Sprintf(\"Ivan %v\", i)\n}\n\nfunc main() {\n    var persons []Person\n\n    for i := 0; i &lt;= 100; i++ {\n        var person Person\n        person.Id = i\n        person.Name = fastInternalFunction(i)\n        go slowExternalAPI(i)\n        person.WillDieAt = 2050 //should be willDieAt from the slowExternalAPI\n        persons = append(persons, person)\n    }\n    fmt.Printf(\"%v\", persons)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BRBgtH5ryo\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BRBgtH5ryo</a></p>\n"}, {"tags": ["go", "gopath"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1502776178, "post_id": 45684996, "comment_id": 78331794, "body": "Why would it have anything to do with any programming paradigm? It doesn&#39;t even have anything to do with <i>programming</i> except in the most boring sense."}], "answers": [{"tags": [], "owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "is_accepted": true, "score": 1, "last_activity_date": 1502759032, "creation_date": 1502759032, "answer_id": 45685121, "question_id": 45684996, "link": "https://stackoverflow.com/questions/45684996/what-is-the-programming-paradigm-behind-the-gopath-what-does-it-do/45685121#45685121", "title": "What is the programming paradigm behind the $GOPATH, what does it do?", "body": "<p><code>GOPATH</code> is a variable that indicates where the dependencies of your application are installed. It is basically a path to a directory where you store the packages your application might use.</p>\n\n<p>Any application of a reasonable size has dependencies. In golang, these come in the form of packages. At compile time, the location of the dependencies (i.e. packages you use) needs to be known such that your executable can be built.</p>\n\n<p>They can either be stored at a fixed, predefined location or make somehow the user be able to specify the location himself. The first approach has a lot of downsides (for example, it would be impossible to support operating systems with different directory structure). Thus, the designers of the go tool decided to make it user configurable by the means of this variable. This also gives the user much more flexibility, such as the ability to group the dependencies for different projects in different directories.</p>\n\n<p>The usage of a environment variable (as <code>GOPATH</code>) is not limited to golang. Java has its <code>CLASSPATH</code>, Python its <code>PYTHONPATH</code> and so on (each of them with their quirks, but with the same basic role).</p>\n"}, {"comments": [{"owner": {"reputation": 2595, "user_id": 3787253, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/U9bkB.jpg?s=128&g=1", "display_name": "smatthewenglish", "link": "https://stackoverflow.com/users/3787253/smatthewenglish"}, "edited": false, "score": 0, "creation_date": 1502801779, "post_id": 45688119, "comment_id": 78344310, "body": "yeah but in python or w/e you don&#39;t need to specify it in the same way that you do with golang, you know what I mean? I don&#39;t have the right words to describe maybe"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2595, "user_id": 3787253, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/U9bkB.jpg?s=128&g=1", "display_name": "smatthewenglish", "link": "https://stackoverflow.com/users/3787253/smatthewenglish"}, "edited": false, "score": 0, "creation_date": 1502805772, "post_id": 45688119, "comment_id": 78346936, "body": "I don&#39;t know what you mean. In every case, the environment variable must be set, or you can&#39;t use the language properly. Go is no different."}, {"owner": {"reputation": 2595, "user_id": 3787253, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/U9bkB.jpg?s=128&g=1", "display_name": "smatthewenglish", "link": "https://stackoverflow.com/users/3787253/smatthewenglish"}, "edited": false, "score": 0, "creation_date": 1502805906, "post_id": 45688119, "comment_id": 78347027, "body": "yeah but I&#39;ve never had to be in my &quot;python path&quot; to make sure something worked properly before"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1502781547, "creation_date": 1502781547, "answer_id": 45688119, "question_id": 45684996, "link": "https://stackoverflow.com/questions/45684996/what-is-the-programming-paradigm-behind-the-gopath-what-does-it-do/45688119#45688119", "title": "What is the programming paradigm behind the $GOPATH, what does it do?", "body": "<p>It's an \"include path\".  Practically every (modern) language uses one.</p>\n\n<p>For C/C++, it's the combination of the <code>LIB</code> and <code>INC</code> environment variables (at least in Unix/Makefile environments).</p>\n\n<p>For Perl (5) it's the <code>PERLLIB</code> or <code>PERL5LIB</code> environment variables.</p>\n\n<p>For Python it's the <code>PYTHONHOME</code> environment variable.</p>\n\n<p>For Node.js it's the <code>NODE_PATH</code> variable.</p>\n\n<p>Etc, etc.</p>\n"}], "owner": {"reputation": 2595, "user_id": 3787253, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/U9bkB.jpg?s=128&g=1", "display_name": "smatthewenglish", "link": "https://stackoverflow.com/users/3787253/smatthewenglish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "closed_date": 1502806996, "accepted_answer_id": 45685121, "answer_count": 2, "score": -2, "last_activity_date": 1504778312, "creation_date": 1502757829, "last_edit_date": 1504778312, "question_id": 45684996, "link": "https://stackoverflow.com/questions/45684996/what-is-the-programming-paradigm-behind-the-gopath-what-does-it-do", "closed_reason": "Opinion-based", "title": "What is the programming paradigm behind the $GOPATH, what does it do?", "body": "<p>As someone new to Golang, I'm somewhat perplexed by the notion of the <code>$GOPATH</code>.</p>\n\n<p>The only thing in my experience that it reminds me of is the \"<em>System Folder Path</em>\" (<code>C:\\Windows</code>, <code>C:\\Program Files</code>) on Microsoft Windows machines- is it somehow conceptually related to this? </p>\n\n<p>I've seem a description of it <a href=\"https://github.com/golang/go/wiki/GOPATH\" rel=\"nofollow noreferrer\">from the go team</a>, but it's too practical, it talks about <em>what</em> it is, as opposed to <strong>why</strong> it is.</p>\n\n<p>So then, why is it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1502746653, "post_id": 45683375, "comment_id": 78324881, "body": "<code>enterChan</code> is not buffered so every write to it is blocking until something reads from it."}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1502749440, "post_id": 45683375, "comment_id": 78325846, "body": "You were trying to send <code>next</code> on <code>enterChan</code> from the same goroutine that is supposed to receive it in another iteration of the for loop."}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 5181137, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DhjdVm6mRaM/AAAAAAAAAAI/AAAAAAAACHo/N-7faGgSj7g/photo.jpg?sz=128", "display_name": "Sai Ravi Teja K", "link": "https://stackoverflow.com/users/5181137/sai-ravi-teja-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1574833286, "creation_date": 1574833286, "answer_id": 59063729, "question_id": 45683375, "link": "https://stackoverflow.com/questions/45683375/golang-deadlock-that-i-resolved-by-luck-need-explanation/59063729#59063729", "title": "Golang deadlock that I resolved by luck, need explanation", "body": "<p>As explained by @dev.bmax, <strong>enterChan</strong> is not a buffered channel and you are trying to send data to a channel that is not being read. For example, below code results in a deadlock error:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n)\n\n\nfunc main() {\n    stream := make(chan int)\n    &lt;-stream\n    stream&lt;-1\n\n    fmt.Println(\"Yayyy!! no deadlock!\")\n}\n</code></pre>\n\n<p>you can run the above code <a href=\"https://play.golang.org/p/4-GVDB59Hwu\" rel=\"nofollow noreferrer\">here</a> and check that it has deadlock. But if I change it to this:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n)\n\n\nfunc main() {\n    stream := make(chan int)\n    go func(){&lt;-stream}()\n    stream&lt;-1\n    fmt.Println(\"Yayyy!! no deadlock!\")\n}\n</code></pre>\n\n<p>we have no deadlock. Because we started another GoRoutine which is reading from the channel while the main GoRoutine is pushing data to channel. Hope this helps!</p>\n"}], "owner": {"reputation": 43, "user_id": 984174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934a2d01cda1c3f72fd5ce387aa9f354?s=128&d=identicon&r=PG", "display_name": "CptPingu", "link": "https://stackoverflow.com/users/984174/cptpingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574833286, "creation_date": 1502746364, "question_id": 45683375, "link": "https://stackoverflow.com/questions/45683375/golang-deadlock-that-i-resolved-by-luck-need-explanation", "title": "Golang deadlock that I resolved by luck, need explanation", "body": "<p>I'm trying to understand go channel and go routine. To do so, I'm doing online exercises. I found one here: <a href=\"http://whipperstacker.com/2015/10/05/3-trivial-concurrency-exercises-for-the-confused-newbie-gopher/\" rel=\"nofollow noreferrer\">http://whipperstacker.com/2015/10/05/3-trivial-concurrency-exercises-for-the-confused-newbie-gopher/</a></p>\n\n<p>I resolved the 3rd one (named \"Internet cafe\").\nBut there's something I resolved by \"luck\", and it's bother me because I don't understand my issue and why my \"hack\" fixed it.</p>\n\n<p>In my code below, I replace \"enterChan &lt;- next\" by \"go func() { enterChan &lt;- next }()\", and it solved my deadlock.</p>\n\n<p>Can someone explain to me why it deadlock before, and why it works with this hack ? Is it a proper solution, or an ugly one ?</p>\n\n<p>Don't hesitate to criticize my code, I'm searching to improve :)</p>\n\n<p>Many thanks!</p>\n\n<p>This is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"strconv\"\n    \"time\"\n)\n\nconst (\n    maxNumberOfUser = 8\n)\n\nfunc useComputer(tourist string, leaverChan chan string) {\n    seed := rand.NewSource(time.Now().UnixNano())\n    random := rand.New(seed)\n    fmt.Println(tourist, \"is online\")\n    d := random.Intn(120-15) + 15\n    time.Sleep(time.Duration(d) * time.Millisecond * 10)\n    fmt.Println(tourist, \"is done, having spent\", d, \"minutes online.\")\n    leaverChan &lt;- tourist\n}\n\nfunc manageUsers(enterChan, leaverChan chan string, stopChan chan struct{}) {\n    nbUsed := 0\n    queue := make([]string, 0)\n    for {\n        select {\n        case tourist := &lt;-enterChan:\n            if nbUsed &lt; maxNumberOfUser {\n                nbUsed++\n                go useComputer(tourist, leaverChan)\n            } else {\n                fmt.Println(tourist, \"waiting for turn.\")\n                queue = append(queue, tourist)\n            }\n        case tourist := &lt;-leaverChan:\n            nbUsed--\n            fmt.Println(tourist, \"is leaving, number of free place is now:\", maxNumberOfUser-nbUsed)\n            if len(queue) &gt; 0 {\n                next := queue[0]\n                queue = queue[1:]\n                go func() {\n                    enterChan &lt;- next\n                }()\n            } else if nbUsed == 0 {\n                close(stopChan)\n                return\n            }\n\n        }\n    }\n}\n\nfunc main() {\n    enterChan := make(chan string)\n    leaverChan := make(chan string)\n    stopChan := make(chan struct{})\n    go manageUsers(enterChan, leaverChan, stopChan)\n\n    for i := 1; i &lt;= 25; i++ {\n        enterChan &lt;- \"Tourist \" + strconv.Itoa(i)\n    }\n    &lt;-stopChan\n    fmt.Println(\"The place is empty, let's close up and go to the beach!\")\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 2, "creation_date": 1502746089, "post_id": 45683207, "comment_id": 78324608, "body": "The compiler could in some cases, <i>but that would mask bugs</i>. Forcing the developer to be explicit about their intent provides clues that allow better feedback."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1502746102, "post_id": 45683207, "comment_id": 78324615, "body": "Compiler could not do that in every single case reliable for sure. <a href=\"https://play.golang.org/p/x7XmY6_-3X\" rel=\"nofollow noreferrer\">play.golang.org/p/x7XmY6_-3X</a> You cannot tell whether <code>:=</code> or <code>=</code> is intended."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1502746279, "post_id": 45683207, "comment_id": 78324706, "body": "(And in general, &quot;why did the designers of language X decide to do Y?&quot; questions either have a canonical answer somewhere (because said designer wrote up a rationale) -- in which case it can be found by Google -- or they don&#39;t, in which case questions on the subject turn into a bunch of speculation, guesswork, and opinions. Speculation and opinion tend to be frowned on here, at least when the latter can&#39;t be backed by something concrete)."}, {"owner": {"reputation": 51, "user_id": 5670576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mNkD7.jpg?s=128&g=1", "display_name": "Rkk", "link": "https://stackoverflow.com/users/5670576/rkk"}, "edited": false, "score": 0, "creation_date": 1502746777, "post_id": 45683207, "comment_id": 78324939, "body": "Yes zerkms you are right. Why don&#39;t you write your answer elaborating the example so I can select your answer? I would remove and add the : in the func so you can show that the results are different."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5670576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mNkD7.jpg?s=128&g=1", "display_name": "Rkk", "link": "https://stackoverflow.com/users/5670576/rkk"}, "edited": false, "score": 0, "creation_date": 1502747009, "post_id": 45683350, "comment_id": 78325029, "body": "I like zerkms comment more but since he hasn&#39;t posted an answer yet I&#39;ll set yours as the answer since it is also correct."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 51, "user_id": 5670576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mNkD7.jpg?s=128&g=1", "display_name": "Rkk", "link": "https://stackoverflow.com/users/5670576/rkk"}, "edited": false, "score": 1, "creation_date": 1502747074, "post_id": 45683350, "comment_id": 78325059, "body": "It&#39;s the same answer, but demonstrated instead of explained. That play example is what I&#39;m talking about w/r/t shadowing variables from an outer scope."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1502749780, "post_id": 45683350, "comment_id": 78325959, "body": "It is the &quot;same&quot; answer indeed (a better one tbh: with more details)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502750691, "post_id": 45683350, "comment_id": 78326232, "body": "I don&#39;t know if it&#39;s better, I usually prefer explanation + example but didn&#39;t have time."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1502746276, "creation_date": 1502746276, "answer_id": 45683350, "question_id": 45683207, "link": "https://stackoverflow.com/questions/45683207/why-do-we-need-the-symbol-in-golang/45683350#45683350", "title": "Why do we need the := symbol in golang?", "body": "<p>Because you can shadow outer-scope variables in an inner scope, such as a closure or loop; the compiler cannot infer purely based on whether the variable existed before or not. Having to explicitly define variables also helps to reduce defects which are commonplace in languages like PHP and JavaScript that allow you to just <code>foo = bar</code> without any consideration of whether <code>foo</code> has been defined. That kind of loose compilation paves over common mistakes <em>like typos</em> such that they're no longer caught at compile time, they show up as \"weird behavior\" at runtime, which is much, much harder to track down and fix.</p>\n"}], "owner": {"reputation": 51, "user_id": 5670576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mNkD7.jpg?s=128&g=1", "display_name": "Rkk", "link": "https://stackoverflow.com/users/5670576/rkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 1, "accepted_answer_id": 45683350, "answer_count": 1, "score": -2, "last_activity_date": 1502746276, "creation_date": 1502745587, "last_edit_date": 1502745930, "question_id": 45683207, "link": "https://stackoverflow.com/questions/45683207/why-do-we-need-the-symbol-in-golang", "title": "Why do we need the := symbol in golang?", "body": "<p>I do understand the difference between <code>=</code> and <code>:=</code> in <strong>golang</strong>, my question is why do we actually need the <code>:=</code>? Couldn't the compiler figure out on its own that a variable was not yet defined? Is it just about readability?</p>\n"}, {"tags": ["go", "assert"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1502768300, "post_id": 45683134, "comment_id": 78329898, "body": "If you really want this: Why not write your own assert function? Why rely on external packages?"}], "answers": [{"tags": [], "owner": {"reputation": 881, "user_id": 8418376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5e4f13b4b83a158ad310ff6516811d?s=128&d=identicon&r=PG", "display_name": "Arminius", "link": "https://stackoverflow.com/users/8418376/arminius"}, "is_accepted": true, "score": 2, "last_activity_date": 1502745851, "creation_date": 1502745851, "answer_id": 45683256, "question_id": 45683134, "link": "https://stackoverflow.com/questions/45683134/assertion-in-non-test-function-in-go/45683256#45683256", "title": "Assertion in non-test function in Go", "body": "<p>Go does not provide assertions. There is a section in the language FAQ from the Go team here: <a href=\"https://golang.org/doc/faq#assertions\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#assertions</a>\nIf you really into it, you can just write a normal function that accepts two values and does something if they evaluate to equal or not equal, as you desire. </p>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1320, "favorite_count": 0, "accepted_answer_id": 45683256, "answer_count": 1, "score": 0, "last_activity_date": 1502745851, "creation_date": 1502745226, "question_id": 45683134, "link": "https://stackoverflow.com/questions/45683134/assertion-in-non-test-function-in-go", "title": "Assertion in non-test function in Go", "body": "<p>I want to use assertion in a function, but it is not a test function. It is just a normal function, and I want to use something like <code>assert.Equal(param1, some_constant)</code>. I came across the following package: <a href=\"https://godoc.org/github.com/stretchr/testify/assert\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/stretchr/testify/assert</a>\nThough, it appears that it also requires the <code>testing</code> package, and to give to a function a parameter of type <code>*testing.T</code>. Is there any other assert function in Go, where I can directly call the <code>assert</code> function without actually relying on any other testing package or parameter?</p>\n"}, {"tags": ["xml", "go", "xml-parsing"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1502744044, "post_id": 45682512, "comment_id": 78323699, "body": "In general the best way to parse large XMLs as streams is to use <code>xml.Decoder</code> and the Token/RawToken functions. It amounts to lots of code but it&#39;s way more efficient if you have, say a 5GB stream of XML from wikipedia dumps."}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1502744339, "post_id": 45682512, "comment_id": 78323861, "body": "Yes, I&#39;ve seen an article: <a href=\"http://blog.davidsingleton.org/parsing-huge-xml-files-with-go/\" rel=\"nofollow noreferrer\">blog.davidsingleton.org/parsing-huge-xml-files-with-go</a> that explains this but in that case the element &lt;page&gt; is small and does not have so many ignored elements. In my case, the IgnoreElement is really huge and I want to know if the xml.Decoder can do this well."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1502744535, "post_id": 45682512, "comment_id": 78323955, "body": "Even if the <code>IgnoreElement</code> is large, you can just burn through input until you finally get the closing tag token."}, {"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "edited": false, "score": 0, "creation_date": 1502744723, "post_id": 45682512, "comment_id": 78324049, "body": "But when I call DecodeElement() I use ElementOne as starter element because I need the Blah attribute. I think in this case DecodeElement is like Unmarshal"}], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "edited": false, "score": 0, "creation_date": 1502745485, "post_id": 45683067, "comment_id": 78324362, "body": "Isn&#39;t Unmarshal slow for huge XMLs? What is the advantage of using DecodeElement?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "edited": false, "score": 0, "creation_date": 1502745599, "post_id": 45683067, "comment_id": 78324409, "body": "I have updated the link, sorry for incorrect link earlier."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 4, "last_activity_date": 1502744938, "creation_date": 1502744938, "answer_id": 45683067, "question_id": 45682512, "link": "https://stackoverflow.com/questions/45682512/how-to-parser-huge-xml-in-go-ignoring-nested-elements/45683067#45683067", "title": "How to parser huge xml in GO ignoring nested elements?", "body": "<p>Typically it is best to use XML decoder for large XML, it uses the stream and Go with selective binding (like <code>WantThisElement&gt;Bar</code>) then XML decoder follows that path.</p>\n\n<p>Let's use XML content from your question to create an example.</p>\n\n<p>XML Content:</p>\n\n<pre><code>&lt;Report&gt;\n    &lt;ElementOne Blah=\"bleh\"&gt;\n        &lt;IgnoreElement&gt;\n            &lt;Foo&gt;\n                &lt;FooValue&gt;example foo value&lt;/FooValue&gt;\n            &lt;/Foo&gt;\n        &lt;/IgnoreElement&gt;\n\n        &lt;WantThisElement&gt;\n            &lt;Bar Baz=\"test\"&gt;\n                 &lt;BarValue&gt;example bar value 1&lt;/BarValue&gt;\n            &lt;/Bar&gt;\n            &lt;Bar Baz=\"test2\"&gt;\n                &lt;BarValue&gt;example bar value 2&lt;/BarValue&gt;\n            &lt;/Bar&gt;\n        &lt;/WantThisElement&gt;\n    &lt;/ElementOne&gt;\n&lt;/Report&gt;\n</code></pre>\n\n<p>Structures:</p>\n\n<pre><code>type Report struct {\n    XMLName    xml.Name `xml:\"Report\"`\n    ElementOne ElementOne\n}\n\ntype ElementOne struct {\n    XMLName xml.Name `xml:\"ElementOne\"`\n    Blah    string   `xml:\"Blah,attr\"`\n    Bar     []Bar    `xml:\"WantThisElement&gt;Bar\"`\n}\n\ntype Bar struct {\n    XMLName  xml.Name `xml:\"Bar\"`\n    Baz      string   `xml:\"Baz,attr\"`\n    BarValue string   `xml:\"BarValue\"`\n}\n</code></pre>\n\n<p>Play Link: <a href=\"https://play.golang.org/p/26xDkojeUp\" rel=\"nofollow noreferrer\">https://play.golang.org/p/26xDkojeUp</a></p>\n"}], "owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 0, "accepted_answer_id": 45683067, "answer_count": 1, "score": 1, "last_activity_date": 1502744938, "creation_date": 1502742275, "question_id": 45682512, "link": "https://stackoverflow.com/questions/45682512/how-to-parser-huge-xml-in-go-ignoring-nested-elements", "title": "How to parser huge xml in GO ignoring nested elements?", "body": "<p>I have this XML, for example:  </p>\n\n<pre><code>     &lt;Report&gt;\n        ...\n        &lt;ElementOne Blah=\"bleh\"&gt;\n            &lt;IgnoreElement&gt;\n                &lt;Foo&gt;\n                   ...\n                &lt;/Foo&gt;\n            &lt;/IgnoreElement&gt;\n\n            &lt;WantThisElement&gt;\n                &lt;Bar Baz=\"test\"&gt;\n                   ...\n                &lt;/Bar&gt;\n                &lt;Bar Baz=\"test2\"&gt;\n                   ...\n                &lt;/Bar&gt;\n            &lt;/WantThisElement&gt;\n        &lt;/ElementOne&gt;\n        ...\n    &lt;/Report&gt;\n</code></pre>\n\n<p>And I'm parsing this with encode/xml:</p>\n\n<pre><code>    ... \n    decoder := xml.NewDecoder(resp.Body)\n    Mystruct := MyStruct{}\n    for {\n    t, _ := decoder.Token()\n\n    if t == nil {\n        break\n    }\n    switch se := t.(type) {\n    case xml.StartElement:\n        if se.Name.Local == \"ElementOne\" {\n            decoder.DecodeElement(&amp;Mystruct, &amp;se)\n        }\n    }\n    ...\n\n\n\n   type MyStruct struct{\n        Blah string\n        Bar []Bar\n   }\n   type Bar struct{\n        Baz string\n        ...\n   }\n</code></pre>\n\n<p>I'm not sure if it is the best way to do it and I don't know if the decoder.DecodeElement(...) ignoring the nested elements that I don't want to parse. I want to increase perfomance with low memory cost. What the best way to parser these huge XML files?</p>\n"}, {"tags": ["unit-testing", "go", "request"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 5, "last_activity_date": 1502742421, "creation_date": 1502742421, "answer_id": 45682537, "question_id": 45682353, "link": "https://stackoverflow.com/questions/45682353/httptest-newrequest-vs-http-newrequest-which-one-to-use-in-tests-and-why/45682537#45682537", "title": "httptest.NewRequest vs http.NewRequest: which one to use in tests and why?", "body": "<p>As indicated in the documentation, <a href=\"https://golang.org/pkg/net/http/httptest/#NewRequest\" rel=\"noreferrer\"><code>httptest.NewRequest</code></a> \"returns a new incoming server Request, suitable for passing to an http.Handler for testing\", while <a href=\"https://golang.org/pkg/net/http/#NewRequest\" rel=\"noreferrer\"><code>http.NewRequest</code></a> \"returns a Request suitable for use with Client.Do or Transport.RoundTrip.\" So, if you're passing the request directly to the handler in a unit test, use <code>httptest.NewRequest</code>, and if you're executing a full round-trip using <code>http.Client</code>, use <code>http.NewRequest</code>.</p>\n"}], "owner": {"reputation": 929, "user_id": 3677182, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/I7VoK.jpg?s=128&g=1", "display_name": "alisa", "link": "https://stackoverflow.com/users/3677182/alisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "accepted_answer_id": 45682537, "answer_count": 1, "score": 1, "last_activity_date": 1502744000, "creation_date": 1502741554, "last_edit_date": 1502744000, "question_id": 45682353, "link": "https://stackoverflow.com/questions/45682353/httptest-newrequest-vs-http-newrequest-which-one-to-use-in-tests-and-why", "title": "httptest.NewRequest vs http.NewRequest: which one to use in tests and why?", "body": "<p>Golang has these two similar libs <code>http</code> and <code>httptest</code> and they both have the <code>NewRequest</code> func.  </p>\n\n<p>Why do we even need the <code>httptest.NewRequest</code> if <code>http.NewRequest</code> does it all?  </p>\n\n<p>If I need to create a multipart/multiform request for my tests, which one do I need to use?  </p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 4, "creation_date": 1502731094, "post_id": 45679537, "comment_id": 78317063, "body": "try stmt.QueryRow(order.CustomerID) instead, then grab the id off the row.  see <a href=\"https://golang.org/pkg/database/sql/#Stmt.QueryRow\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#Stmt.QueryRow</a>"}, {"owner": {"reputation": 710, "user_id": 1196458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db3c38d93e0be82180a58384eefe8fd?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur Srivastava", "link": "https://stackoverflow.com/users/1196458/ankur-srivastava"}, "edited": false, "score": 0, "creation_date": 1502731912, "post_id": 45679537, "comment_id": 78317476, "body": "you can use id as serial and then directly call a query from your code using max(id), which will give you last inserted row.In postgres, serial is same as sequence."}, {"owner": {"reputation": 933, "user_id": 2955815, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/de2492fe7f50ed8baa62225dff1dd06a?s=128&d=identicon&r=PG&f=1", "display_name": "oldsport", "link": "https://stackoverflow.com/users/2955815/oldsport"}, "reply_to_user": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1502732430, "post_id": 45679537, "comment_id": 78317729, "body": "@saarrrr: thx that helped! I will update my question based with a working solution based on your hint."}, {"owner": {"reputation": 6986, "user_id": 508908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f92624879fdb88f15c0df59bee4b9f?s=128&d=identicon&r=PG", "display_name": "Scott Marlowe", "link": "https://stackoverflow.com/users/508908/scott-marlowe"}, "edited": false, "score": 0, "creation_date": 1502744873, "post_id": 45679537, "comment_id": 78324104, "body": "THIS IS NOT SAFE. If another query inserts and commits you will get ITS id not yours."}], "answers": [{"tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": false, "score": 3, "last_activity_date": 1502850462, "creation_date": 1502850462, "answer_id": 45704195, "question_id": 45679537, "link": "https://stackoverflow.com/questions/45679537/need-the-id-of-the-current-row-inserted-within-a-transaction/45704195#45704195", "title": "Need the ID of the current row inserted within a transaction", "body": "<p>This happens because the postgresql driver you are using for go doesn't supports the <code>LastInsertedId()</code> function. You didn't say which driver you are using but I have had this issue working with <code>github.com/lib/pq</code>.</p>\n\n<p>The answer to this is to use <code>QueryRow</code> insted of <code>Exec</code> in your original example. Just make sure you are using <code>RETURNING ID</code> on your query and treat it as if it was a select.</p>\n\n<p>Here is an example (I didn't test this and I might be missing something but you get the idea):</p>\n\n<pre><code>func createOrder(w http.ResponseWriter, r *http.Request) (orderID int) {\n\n    // Begin.\n    tx, err := db.Begin()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Db query.\n    sqlQuery := `INSERT INTO ORDER_CUSTOMER\n        (CUSTOMER_ID)\n        VALUES ($1)\n        RETURNING ID`\n\n    // Prepare.\n    stmt, err := tx.Prepare(sqlQuery)\n    if err != nil {\n        log.Fatal(err)\n        return\n    }\n\n    // Defer Close.\n    defer stmt.Close()\n\n    customerEmail := validateSession(r)\n    ID := getIDFromCustomer(customerEmail)\n    order := order{}\n    order.CustomerID = ID\n\n    // Exec.\n    var orderID int // Or whatever type you are using\n    err := stmt.QueryRow(order.CustomerID).Scan(&amp;orderID)\n\n    // Rollback.\n    if err != nil {\n        //if something goes wrong set the orderID to 0 as in your original code\n        orderID = 0\n        tx.Rollback()\n        e := errors.New(err.Error())\n        msg.Warning = e.Error()\n        tpl.ExecuteTemplate(w, \"menu.gohtml\", msg)\n        return\n    }\n\n    // Commit.\n    tx.Commit()\n\n    return orderID\n} // createOrder\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 2955815, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/de2492fe7f50ed8baa62225dff1dd06a?s=128&d=identicon&r=PG&f=1", "display_name": "oldsport", "link": "https://stackoverflow.com/users/2955815/oldsport"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1580, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1563310570, "creation_date": 1502730391, "last_edit_date": 1502743379, "question_id": 45679537, "link": "https://stackoverflow.com/questions/45679537/need-the-id-of-the-current-row-inserted-within-a-transaction", "title": "Need the ID of the current row inserted within a transaction", "body": "<p>Within a <strong>transaction</strong> I'm <strong>inserting a row</strong>.</p>\n\n<p>How can I <strong>access and return the ID of the inserted row</strong>.\nAs you can see in the code below(<strong>See under comment // Return last Inserted ID.</strong>) I tried to use the <strong>LastInsertedId()</strong> function, but it gives me an error back.</p>\n\n<p>Btw, I'm using Postgres.</p>\n\n<p>What am I missing here?\nThx!</p>\n\n<pre><code>/**\n * Creates order and returns its ID.\n */\nfunc createOrder(w http.ResponseWriter, r *http.Request) (orderID int) {\n\n    // Begin.\n    tx, err := db.Begin()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Db query.\n    sqlQuery := `INSERT INTO ORDER_CUSTOMER\n        (CUSTOMER_ID)\n        VALUES ($1)\n        RETURNING ID`\n\n    // Prepare.\n    stmt, err := tx.Prepare(sqlQuery)\n    if err != nil {\n        log.Fatal(err)\n        return\n    }\n\n    // Defer Close.\n    defer stmt.Close()\n\n    customerEmail := validateSession(r)\n    ID := getIDFromCustomer(customerEmail)\n    order := order{}\n    order.CustomerID = ID\n\n    // Exec.\n    ret, err := stmt.Exec(order.CustomerID)\n\n    // Rollback.\n    if err != nil {\n        tx.Rollback()\n        e := errors.New(err.Error())\n        msg.Warning = e.Error()\n        tpl.ExecuteTemplate(w, \"menu.gohtml\", msg)\n        return\n    }\n\n    // Return last Inserted ID.\n    lastID, err := ret.LastInsertId()\n    if err != nil {\n        orderID = 0\n    } else {\n        orderID = int(lastID)\n    }\n\n    // Commit.\n    tx.Commit()\n\n    return orderID\n} // createOrder\n</code></pre>\n\n<p>Here is a working solution for now, further improvement is welcomed.</p>\n\n<pre><code>/**\n * Creates order and returns its ID.\n */\nfunc createOrder(w http.ResponseWriter, r *http.Request) (orderID int) {\n\n    // Begin.\n    tx, err := db.Begin()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Db query.\n    sqlQuery := `INSERT INTO ORDER_CUSTOMER\n        (CUSTOMER_ID)\n        VALUES ($1)\n        RETURNING ID`\n\n    // Prepare.\n    stmt, err := tx.Prepare(sqlQuery)\n    if err != nil {\n        log.Fatal(err)\n        return\n    }\n\n    // Defer Close.\n    defer stmt.Close()\n\n    customerEmail := validateSession(r)\n    ID := getIDFromCustomer(customerEmail)\n    order := order{}\n    order.CustomerID = ID\n\n    // Exec.\n    _, err = stmt.Exec(order.CustomerID)\n\n    // Rollback.\n    if err != nil {\n        tx.Rollback()\n        e := errors.New(err.Error())\n        msg.Warning = e.Error()\n        tpl.ExecuteTemplate(w, \"menu.gohtml\", msg)\n        return\n    }\n\n    // Return last Inserted ID.\n    //lastID, err := ret.LastInsertId()\n    err = stmt.QueryRow(order.CustomerID).Scan(&amp;orderID)\n    if err != nil {\n        orderID = 0\n    }\n\n    // Commit.\n    tx.Commit()\n\n    return orderID\n} // createOrder\n</code></pre>\n"}, {"tags": ["string", "go", "time"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1502743742, "post_id": 45679529, "comment_id": 78323538, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24987131/how-to-parse-unix-timestamp-in-golang\">How to parse unix timestamp in golang</a>"}], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 3202399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Vwd26.jpg?s=128&g=1", "display_name": "Indrid", "link": "https://stackoverflow.com/users/3202399/indrid"}, "edited": false, "score": 0, "creation_date": 1502779390, "post_id": 45679626, "comment_id": 78332946, "body": "Thank you! Turns out that what I thought was UnixNano is actually Epoch Millis. I made a helper function to convert epoch millis to a couple of different formatted strings and return the required one."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 425, "user_id": 3202399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Vwd26.jpg?s=128&g=1", "display_name": "Indrid", "link": "https://stackoverflow.com/users/3202399/indrid"}, "edited": false, "score": 0, "creation_date": 1502815861, "post_id": 45679626, "comment_id": 78353571, "body": "@user3202399 np! please accept the answer if you found it helpful."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 9, "last_activity_date": 1502731195, "last_edit_date": 1502731195, "creation_date": 1502730819, "answer_id": 45679626, "question_id": 45679529, "link": "https://stackoverflow.com/questions/45679529/go-convert-int64-from-unixnano-to-location-time-string/45679626#45679626", "title": "Go convert int64 (from UnixNano) to location time string", "body": "<p>Rather than converting this to a string, you'll want to convert it to a <code>time.Time</code> and from there to a string. You can use the handy <code>Unix</code> method to get a <code>Time</code> object back for that time stamp.</p>\n\n<pre><code>import \"time\"\nimport \"fmt\"\n\nt := time.Unix(0, 1502712864232)\nfmt.Println(t.Format(\"02/01/2006, 15:04:05\"))\n</code></pre>\n\n<p>Edit: added format to the println - note, testing your unix stamp in go playground, that value is neither nano seconds nor seconds, in both cases the time value produced is way off of what it should be. The code above still demonstrates the basic idea of what you want to do but it seems an additional step is necessary or the sample <code>int64</code> you gave just does not correspond to the string you provided.</p>\n\n<p>relevant docs:</p>\n\n<p><a href=\"https://golang.org/pkg/time/#Unix\" rel=\"noreferrer\">https://golang.org/pkg/time/#Unix</a></p>\n\n<p><a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\">https://golang.org/pkg/fmt/</a></p>\n"}], "owner": {"reputation": 425, "user_id": 3202399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Vwd26.jpg?s=128&g=1", "display_name": "Indrid", "link": "https://stackoverflow.com/users/3202399/indrid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10064, "favorite_count": 2, "accepted_answer_id": 45679626, "answer_count": 1, "score": 1, "last_activity_date": 1502780584, "creation_date": 1502730361, "last_edit_date": 1502780584, "question_id": 45679529, "link": "https://stackoverflow.com/questions/45679529/go-convert-int64-from-unixnano-to-location-time-string", "title": "Go convert int64 (from UnixNano) to location time string", "body": "<p>I have an int64 like: </p>\n\n<blockquote>\n  <p>1502712864232</p>\n</blockquote>\n\n<p>Which is the result of a REST GET to a service. I can convert it to a string easily enough. It is a Unixnano timestamp. </p>\n\n<p>What I really need is to convert it to a <strong>string</strong> which is related to a timezone like \"Europe/London\". Such as:-</p>\n\n<blockquote>\n  <p>\"14/08/2017, 13:14:24\"</p>\n</blockquote>\n\n<p>Such as produced by this handy utility:\n<a href=\"http://www.freeformatter.com/epoch-timestamp-to-date-converter.html\" rel=\"nofollow noreferrer\">http://www.freeformatter.com/epoch-timestamp-to-date-converter.html</a></p>\n\n<p>Would very much appreciate any assistance.</p>\n\n<p>==> Update.</p>\n\n<p>Thanks to @evanmcdonnal for such a useful answer. Much appreciated.\nTurns out that the data I had was not UnixNano at all (sorry) it was milliseconds from Epoch. Source is a Jenkins timestamp....</p>\n\n<p>So... I wrote the following helper function to get what I need:</p>\n\n<pre><code>// Arg 1 is an int64 representing the millis since Epoch\n// Arg 2 is a timezome. Eg: \"Europe/London\"\n// Arg 3 is an int relating to the formatting of the returned string\n// Needs the time package. Obviously.\n\nfunc getFormattedTimeFromEpochMillis(z int64, zone string, style int) string {\n    var x string\n    secondsSinceEpoch := z / 1000\n    unixTime := time.Unix(secondsSinceEpoch, 0)\n    timeZoneLocation, err := time.LoadLocation(zone)\n    if err != nil {\n        fmt.Println(\"Error loading timezone:\", err)\n    }\n\n    timeInZone := unixTime.In(timeZoneLocation)\n\n    switch style {\n        case 1:\n            timeInZoneStyleOne := timeInZone.Format(\"Mon Jan 2 15:04:05\")\n            //Mon Aug 14 13:36:02\n            return timeInZoneStyleOne\n        case 2:\n            timeInZoneStyleTwo := timeInZone.Format(\"02-01-2006 15:04:05\")\n            //14-08-2017 13:36:02\n            return timeInZoneStyleTwo\n        case 3:\n            timeInZoneStyleThree := timeInZone.Format(\"2006-02-01 15:04:05\")\n            //2017-14-08 13:36:02\n            return timeInZoneStyleThree\n    }\n    return x\n}\n</code></pre>\n"}, {"tags": ["json", "go", "reflection", "unmarshalling"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1502740173, "post_id": 45679408, "comment_id": 78321812, "body": "Just because it&#39;s something that really hurt my eyes: why do you have a var called <code>new</code>? And what&#39;s the point of your using <code>new(Employee)</code> over the more flexible <code>&amp;Employee{}</code>?"}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1570376893, "post_id": 45679408, "comment_id": 102886406, "body": "new(Something) is better than &amp;Something{}. It is consistent with non-struct types + it is for that job."}], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 12, "last_activity_date": 1502738893, "last_edit_date": 1502738893, "creation_date": 1502732627, "answer_id": 45680060, "question_id": 45679408, "link": "https://stackoverflow.com/questions/45679408/unmarshal-json-to-reflected-struct/45680060#45680060", "title": "Unmarshal json to reflected struct", "body": "<p>The problem here is that if you omit the type assertion here:</p>\n\n<pre><code>new := v.Elem().Interface()\n</code></pre>\n\n<p>The <code>new</code> is inferred to have a <code>interface{}</code> type.</p>\n\n<p>Then when you take the address to unmarshal, the type of <code>&amp;new</code> is <code>*interface{}</code> (pointer to interface{}) and unmarshal does not work as you expect.</p>\n\n<p>You can avoid the type assertion if instead of getting the <code>Elem()</code> you work directly with the pointer reference.</p>\n\n<pre><code>func main() {\n  //Original struct\n  orig := new(Employee)\n\n  t := reflect.TypeOf(orig)\n  v := reflect.New(t.Elem())\n\n  // reflected pointer\n  newP := v.Interface()\n\n  // Unmarshal to reflected struct pointer\n  json.Unmarshal([]byte(\"{\\\"firstname\\\": \\\"bender\\\"}\"), newP)\n\n  fmt.Printf(\"%+v\\n\", newP)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/lTBU-1PqM4\" rel=\"noreferrer\">https://play.golang.org/p/lTBU-1PqM4</a></p>\n"}, {"tags": [], "owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "is_accepted": false, "score": 0, "last_activity_date": 1502735188, "creation_date": 1502735188, "answer_id": 45680715, "question_id": 45679408, "link": "https://stackoverflow.com/questions/45679408/unmarshal-json-to-reflected-struct/45680715#45680715", "title": "Unmarshal json to reflected struct", "body": "<p>If you don't know the type at all, you can Unmarshal the JSON string into an interface{}. If you then need to work with the Unmarshaled data, you can convert it to the desired type.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n    \"unsafe\"\n)\n\ntype Employee struct {\n    Firstname string `json:\"firstName\"`\n}\n\nfunc deserialize(jsonData string) interface{} {\n    var obj interface{}\n\n    if err := json.Unmarshal([]byte(jsonData), &amp;obj); err != nil {\n        panic(err)\n    }\n\n    return obj\n}\n\nfunc NewEmployee(objData map[string]interface{}) *Employee {\n    s := (*Employee)(nil)\n    t := reflect.TypeOf(s).Elem()\n    employeePtr := reflect.New(t)\n    employee := (*Employee)(unsafe.Pointer(employeePtr.Pointer()))\n    employee.Firstname = objData[\"firstName\"].(string)\n\n    return employee\n}\n\nfunc main() {\n    jsonData := \"{\\\"firstName\\\": \\\"John\\\"}\"\n\n    obj := deserialize(jsonData)\n\n    objData := obj.(map[string]interface{})\n    employee := NewEmployee(objData)\n\n    fmt.Printf(\"%s\\n\", employee.Firstname)\n}\n</code></pre>\n\n<p>You can check it on the <a href=\"https://play.golang.org/p/B0bgfB4-uv\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 859, "user_id": 1310337, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/88a0420264395cc41f0bc15bd0f7ff78?s=128&d=identicon&r=PG", "display_name": "Slemgrim", "link": "https://stackoverflow.com/users/1310337/slemgrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3244, "favorite_count": 0, "accepted_answer_id": 45680060, "answer_count": 2, "score": 9, "last_activity_date": 1502738893, "creation_date": 1502729859, "last_edit_date": 1502730990, "question_id": 45679408, "link": "https://stackoverflow.com/questions/45679408/unmarshal-json-to-reflected-struct", "title": "Unmarshal json to reflected struct", "body": "<p>Is it possible to unmarshal JSON into a struct made from reflection without hardcoding the original type?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n  \"fmt\"\n  \"encoding/json\"\n  \"reflect\"\n)\n\ntype Employee struct {\n  Firstname string     `json:\"firstname\"`\n}\n\nfunc main() {\n  //Original struct\n  orig := new(Employee)\n\n  t := reflect.TypeOf(orig)\n  v := reflect.New(t.Elem())\n\n  //Reflected struct\n  new := v.Elem().Interface().(Employee)\n\n  // Unmarshal to reflected struct\n  json.Unmarshal([]byte(\"{\\\"firstname\\\": \\\"bender\\\"}\"), &amp;new)\n\n  fmt.Printf(\"%+v\\n\", new)\n}\n</code></pre>\n\n<p>I used a cast to <code>Employee</code> in this example. But what if i don't know the type? </p>\n\n<p>When i just use <code>v</code> for the unmarhaling the struct will be zeroed. </p>\n\n<pre><code>json.Unmarshal([]byte(\"{\\\"firstname\\\": \\\"bender\\\"}\"), v)\n</code></pre>\n\n<p>When I omit the cast I get a map. which is understandable</p>\n\n<pre><code>json.Unmarshal([]byte(\"{\\\"firstname\\\": \\\"bender\\\"}\"), v.Elem().Interface())\n</code></pre>\n"}, {"tags": ["unit-testing", "go", "virtual-machine", "ethereum"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 3, "creation_date": 1502722760, "post_id": 45677254, "comment_id": 78312338, "body": "Check out the &#39;Benchmarks&#39; section for the <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">testing package</a>."}, {"owner": {"reputation": 2595, "user_id": 3787253, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/U9bkB.jpg?s=128&g=1", "display_name": "smatthewenglish", "link": "https://stackoverflow.com/users/3787253/smatthewenglish"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1502722941, "post_id": 45677254, "comment_id": 78312448, "body": "cool, thank you for your advice. I&#39;ve been trying to grok that exact thing just now actually. Do you know what it might look like in this case? even in pseudocode for example"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1502734481, "post_id": 45677254, "comment_id": 78318747, "body": "You will just need a <code>BenchmarkOpAdd</code> function where you setup your parameters to pass <code>opAdd</code> and then loop <code>b.N</code> times (as they do in the examples for the package linked earlier), calling opAdd in each iteration. If you want to test different conditions, just make separate <code>BenchmarkOpAddWithCertainCondition</code> functions and setup your parameters appropriately."}, {"owner": {"reputation": 57337, "user_id": 69742, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6fc5e3f98fb1113576b50672ae42c05c?s=128&d=identicon&r=PG", "display_name": "Earlz", "link": "https://stackoverflow.com/users/69742/earlz"}, "edited": false, "score": 0, "creation_date": 1502753663, "post_id": 45677254, "comment_id": 78326998, "body": "You might try posting this on <a href=\"https://ethereum.stackexchange.com\">ethereum.stackexchange.com</a>"}], "owner": {"reputation": 2595, "user_id": 3787253, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/U9bkB.jpg?s=128&g=1", "display_name": "smatthewenglish", "link": "https://stackoverflow.com/users/3787253/smatthewenglish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1563621926, "creation_date": 1502722188, "last_edit_date": 1563621926, "question_id": 45677254, "link": "https://stackoverflow.com/questions/45677254/write-simple-unit-test-for-isolated-function-in-golang-ethereum-virtual-machine", "title": "Write simple unit test for isolated function in Golang, ethereum virtual machine", "body": "<p>In this situation there isn't one correct answer, or expected result, that I can check for, I'm looking to evaluate the execution time of a function under different conditions, is that still a unit-test? </p>\n\n<hr>\n\n<p>There's a function embedded in a project I'm working on that executes an addition operation (opAdd) on a virtual machine (the Ethereum VM), the file can be found <a href=\"https://github.com/ethereum/go-ethereum/blob/master/core/vm/instructions.go\" rel=\"nofollow noreferrer\">on the project GitHub page</a>.</p>\n\n<p>This is the specific function responsible for the task: </p>\n\n<pre><code>func opAdd(pc *uint64, evm *EVM, contract *Contract, memory *Memory, stack *Stack) ([]byte, error) {\n    x, y := stack.pop(), stack.pop()\n    stack.push(math.U256(x.Add(x, y)))\n\n    evm.interpreter.intPool.put(y)\n\n    return nil, nil\n}\n</code></pre>\n\n<p>What I'd like to do is create a \"<em>unit-test</em>\" of sorts to evaluate the execution speed of this operation. To assess this I've modified the function accordingly: </p>\n\n<pre><code>func opAdd(pc *uint64, evm *EVM, contract *Contract, memory *Memory, stack *Stack) ([]byte, error) {\n\n    // begin execution time tracking\n    var startTime = time.Now().UnixNano();\n\n    x, y := stack.pop(), stack.pop()\n    stack.push(math.U256(x.Add(x, y)))\n\n    evm.interpreter.intPool.put(y)\n\n    // log ellapsed execution time\n    fmt.Println(\"execute opAdd consume = \",(time.Now().UnixNano() - startTime))\n\n    return nil, nil\n}\n</code></pre>\n\n<p>However, what is missing is the ability to call this function in isolation, and feed it varying amounts of data such that I could evaluate the behaviour of this code under different conditions. </p>\n\n<p>For instance I'd like to see how long it takes to execute with gigabytes, megabytes, etc.</p>\n\n<p>There is some code to check the functioning of the vm <a href=\"https://github.com/ethereum/go-ethereum/blob/master/tests/vm_test.go\" rel=\"nofollow noreferrer\">here</a>, but it's too complicated for me to understand - I'm new to Golang. </p>\n\n<p>What I'd like to do is write the simplest program possible that could invoke this function, taking as a parameter a varying amount of input data to process. Towards this end I've examined <a href=\"https://blog.alexellis.io/golang-writing-unit-tests/\" rel=\"nofollow noreferrer\">multiple resources</a>, but if an experienced gopher could point me in the right direction it would be immeasurably valuable to advancing my understanding of how to construct practical unit tests. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1502778414, "post_id": 45677031, "comment_id": 78332593, "body": "Try <code>dB.Debug().Model(&amp;pizza_model).Related(&amp;p_sizes_prices_model&zwnj;&#8203;).Where(&quot;pizza_id = ?&quot;, THE_PIZZA_ID)</code>. You also can use struct or map, take a look at <a href=\"http://jinzhu.me/gorm/crud.html#query\" rel=\"nofollow noreferrer\">http://jinzhu.me/gorm/crud.html#query</a>."}, {"owner": {"reputation": 1017, "user_id": 4232577, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a5a00cebae51f88c74b381d3489dc5d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Mikuli\u0107", "link": "https://stackoverflow.com/users/4232577/marko-mikuli%c4%87"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1502784432, "post_id": 45677031, "comment_id": 78335209, "body": "@putu Doesn&#39;t change pizza_id :/"}], "owner": {"reputation": 1017, "user_id": 4232577, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a5a00cebae51f88c74b381d3489dc5d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Mikuli\u0107", "link": "https://stackoverflow.com/users/4232577/marko-mikuli%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1502721488, "creation_date": 1502721488, "question_id": 45677031, "link": "https://stackoverflow.com/questions/45677031/gorm-cannot-pass-foreign-key-to-query", "title": "GORM Cannot pass foreign key to query", "body": "<p>I am usin jinzhu GORM package for connecting to the DB, etc.</p>\n\n<p>This is my code</p>\n\n<pre><code>package pizzas\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    \"github.com/gin-gonic/gin\"\n    \"speedy-gonzales/db\"\n    \"net/http\"\n)\n\ntype Pizza struct {\n    gorm.Model\n    Name                string `gorm:\"not null\"`\n    Image               string `sql:\"type:text\"`\n    PSizesAndPrices     []PizzaPriceSize\n}\n\ntype PizzaPriceSize struct {\n    gorm.Model\n    SizeTitle       string      `gorm:\"column:size_title;type:varchar(50);not null'\"`\n    PriceEur        int         `gorm:\"column:price_eur\"`\n    PriceBam        int         `gorm:\"column:price_bam\"`\n    PizzaID         uint        `gorm:\"index\"`\n}\n\nfunc (PizzaPriceSize) TableName() string {\n    return \"pizza_price_sizes\"\n}\n\nfunc FetchPizzasWithSizes(c *gin.Context) {\n    var pizza_model []Pizza\n\n    var p_sizes_prices_model []PizzaPriceSize\n\n\n    dB := db.DbConnect()\n    dB.Debug().Model(&amp;pizza_model).Related(&amp;p_sizes_prices_model)\n\n    c.JSON(http.StatusOK, gin.H{\n        \"status\": http.StatusOK,\n        \"message\": p_sizes_prices_model,\n    })\n    return\n}\n</code></pre>\n\n<p>When I run the app this is what I get from debug console:\nSELECT * FROM <code>pizza_price_sizes</code>  WHERE <code>pizza_price_sizes</code>.<code>deleted_at</code> IS NULL AND ((<code>pizza_id</code> = '0'))  </p>\n\n<p>My question is how can I pass pizza_id to this query?</p>\n"}, {"tags": ["go", "mutex", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 2, "last_activity_date": 1502716548, "last_edit_date": 1502716548, "creation_date": 1502715961, "answer_id": 45675207, "question_id": 45675092, "link": "https://stackoverflow.com/questions/45675092/local-mutex-in-simplequery-in-socket-go/45675207#45675207", "title": "local mutex in SimpleQuery in socket.go", "body": "<p>They are synching the <code>SimpleQuery</code> with the <code>replyFunc</code>.</p>\n\n<ul>\n<li><code>wait</code> is used to wait until <code>replyFunc</code> is really done.</li>\n<li><code>change</code> is used to lock access to <code>replyData</code> and <code>replyErr</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1502716512, "last_edit_date": 1502716512, "creation_date": 1502715961, "answer_id": 45675210, "question_id": 45675092, "link": "https://stackoverflow.com/questions/45675092/local-mutex-in-simplequery-in-socket-go/45675210#45675210", "title": "local mutex in SimpleQuery in socket.go", "body": "<p>The mutexes are protecting data structures, they are both captured in the closure given to the <code>replyFunc</code> callback.</p>\n\n<p>The <code>wait</code> mutex blocks until the callback returns, and the <code>change</code> mutex protects the <code>replyData</code> and <code>replyErr</code> values.</p>\n\n<p>The commit that added those only says:</p>\n\n<blockquote>\n  <p>Make SimpleQuery race safe, irrespective of what the server does.</p>\n</blockquote>\n\n<p>So this may be extra protection against some unintended or legacy behavior, which is why it's using multiple mutexes rather than a single primitive to synchronize the operation. </p>\n"}], "owner": {"reputation": 13, "user_id": 8462220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/722a83c78a58d1b2557cbea640957473?s=128&d=identicon&r=PG&f=1", "display_name": "wiredprogramer", "link": "https://stackoverflow.com/users/8462220/wiredprogramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 45675210, "answer_count": 2, "score": 1, "last_activity_date": 1502716548, "creation_date": 1502715550, "question_id": 45675092, "link": "https://stackoverflow.com/questions/45675092/local-mutex-in-simplequery-in-socket-go", "title": "local mutex in SimpleQuery in socket.go", "body": "<p>I tried to read code of mgo, and the function SimpleQuery in socket.go confused me. In this function, there are two local mutex:\n<a href=\"https://github.com/go-mgo/mgo/blob/v2-unstable/socket.go\" rel=\"nofollow noreferrer\">https://github.com/go-mgo/mgo/blob/v2-unstable/socket.go</a></p>\n\n<pre><code>func (socket *mongoSocket) SimpleQuery(op *queryOp) (data []byte, err error) {\n    var wait, change sync.Mutex\n    var replyDone bool\n    var replyData []byte\n    var replyErr error\n    wait.Lock()\n    op.replyFunc = func(err error, reply *replyOp, docNum int, docData []byte) {\n        change.Lock()\n        if !replyDone {\n            replyDone = true\n            replyErr = err\n            if err == nil {\n                replyData = docData\n            }\n        }\n        change.Unlock()\n        wait.Unlock()\n    }\n    err = socket.Query(op)\n    if err != nil {\n        return nil, err\n    }\n    wait.Lock()\n    change.Lock()\n    data = replyData\n    err = replyErr\n    change.Unlock()\n    return data, err\n}\n</code></pre>\n\n<p>As my understanding, for each call, there will be a new local mutex, so, it's actually protecting anything, why they put the mutex here?</p>\n"}, {"tags": ["go", "apache-zookeeper", "mesos", "mesosphere", "eremetic"], "answers": [{"tags": [], "owner": {"reputation": 8437, "user_id": 3314107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9bdb9cc374e313876de99a99d191ecd6?s=128&d=identicon&r=PG", "display_name": "stefanobaghino", "link": "https://stackoverflow.com/users/3314107/stefanobaghino"}, "is_accepted": true, "score": 0, "last_activity_date": 1502806307, "creation_date": 1502806307, "answer_id": 45694652, "question_id": 45674899, "link": "https://stackoverflow.com/questions/45674899/mesos-framework-stays-inactive-due-to-authentication-failed-eof/45694652#45694652", "title": "Mesos framework stays inactive due to &quot;Authentication failed: EOF&quot;", "body": "<p>It turned out to be a configuration problem. The master URL was simply wrong and this is how the error was reported.</p>\n"}], "owner": {"reputation": 8437, "user_id": 3314107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9bdb9cc374e313876de99a99d191ecd6?s=128&d=identicon&r=PG", "display_name": "stefanobaghino", "link": "https://stackoverflow.com/users/3314107/stefanobaghino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 45694652, "answer_count": 1, "score": 0, "last_activity_date": 1502806307, "creation_date": 1502714846, "last_edit_date": 1502717277, "question_id": 45674899, "link": "https://stackoverflow.com/questions/45674899/mesos-framework-stays-inactive-due-to-authentication-failed-eof", "title": "Mesos framework stays inactive due to &quot;Authentication failed: EOF&quot;", "body": "<p>I'm currently trying to deploy <a href=\"https://www.github.com/eremetic-framework/eremetic\" rel=\"nofollow noreferrer\">Eremetic</a> (version 0.28.0) on top of Marathon using the <a href=\"https://github.com/eremetic-framework/eremetic/blob/v0.28.0/misc/eremetic.json\" rel=\"nofollow noreferrer\">configuration provided as an example</a>. I actually have been able to deploy it once, but suddenly, after trying to redeploy it, the framework stays inactive.</p>\n\n<p>By inspecting the logs I noticed a constant attempt to connect to some service that apparently never succeeds because of some authentication problem. </p>\n\n<pre><code>2017/08/14 12:30:45 Connected to [REDACTED_MESOS_MASTER_ADDRESS]\n2017/08/14 12:30:45 Authentication failed: EOF\n</code></pre>\n\n<p>It looks like the service returning an error is ZooKeeper and more precisely it looks like the error can be traced back to <a href=\"https://github.com/samuel/go-zookeeper/blob/master/zk/conn.go#L433\" rel=\"nofollow noreferrer\">this line</a> in the Go ZooKeeper library. ZooKeeper however seems to work: I've tried to query it directly with <code>zkCli</code> and to run a small Spark job (where the Mesos master is given with <code>zk://</code> URL) and everything seems to work.</p>\n\n<p>Unfortunately I'm not able to diagnose the problem further, what could it be?</p>\n"}, {"tags": ["go", "mingw", "static-libraries", "cross-compiling", "openal"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1502713348, "post_id": 45674197, "comment_id": 78306217, "body": "What does <code>ldd yourbinary.exe</code> say?"}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1502713748, "post_id": 45674197, "comment_id": 78306442, "body": "@Ainar-G Ok so I&#39;ve kept three executables when I did testing earlier. First is static with audio, second is dynamic with audio, third is no audio. When I run ldd on all three of them, it returns <code>not a dynamic executable</code> :/"}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1502713965, "post_id": 45674197, "comment_id": 78306585, "body": "When I run it on my linux binary it returns quite a few including <code>libopenal.so.1</code>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1502719044, "post_id": 45674197, "comment_id": 78310011, "body": "Are you sure you&#39;re not mixing them up? If ldd says that the binary is static, but it fails to load, it sounds very strange."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1503422624, "post_id": 45674197, "comment_id": 78605313, "body": "Probably related: <a href=\"https://stackoverflow.com/questions/30150217/sfml-not-linking-statically-to-openal32-links-statically-to-all-other-dependenc\" title=\"sfml not linking statically to openal32 links statically to all other dependenc\">stackoverflow.com/questions/30150217/&hellip;</a> It looks like you just shouldn&#39;t statically link it."}, {"owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1503494792, "post_id": 45674197, "comment_id": 78639536, "body": "@HolyBlackCat 100% correct. I also spotted that one and decided to play it safe by building a dll and sending it with the executable. I&#39;m leaving this question open to help anyone else trying the same thing. Thanks."}], "owner": {"reputation": 906, "user_id": 4214582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GRB3X.png?s=128&g=1", "display_name": "Fanus du Toit", "link": "https://stackoverflow.com/users/4214582/fanus-du-toit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1689, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1502712424, "creation_date": 1502712424, "question_id": 45674197, "link": "https://stackoverflow.com/questions/45674197/build-go-binary-with-static-library", "title": "Build go binary with static library", "body": "<p>I'm trying to cross compile (from Arch Linux to Windows) a go binary with the openal library statically linked.</p>\n\n<p>I use MinGW to cross compile to Windows and to MinGW package I have install and intend to use to link the static libary is <code>mingw-w64-openal</code>.</p>\n\n<p>My build command looks like this:\n<code>\nCC='i686-w64-mingw32-gcc -fno-stack-protector -D_FORTIFY_SOURCE=0 -lssp' GOOS=windows CGO_ENABLED=1 GOARCH=386 go build --ldflags '--extldflags \"-static\"' -v -o bin/game.exe -tags='deploy' game.go\n</code></p>\n\n<p>The .go files (linked below) that is using the library has the following cgo code to lookup the static library for MinGW to use:\n<code>#cgo windows  LDFLAGS: /usr/i686-w64-mingw32/lib/libOpenAL32.dll.a</code></p>\n\n<p>I get no errors during compilation but when I try run the binary file on windows I get the typical <code>The program can't start because OpenAL32.dll is missing</code> error. I want a completely portable executable so redistributing the .dll with the executable won't do.</p>\n\n<p><strong>The go openal package that I've modified to compile to windows:</strong></p>\n\n<p><a href=\"https://github.com/golang/mobile/blob/master/exp/audio/al/al_notandroid.go\" rel=\"nofollow noreferrer\">https://github.com/golang/mobile/blob/master/exp/audio/al/al_notandroid.go</a>\n<a href=\"https://github.com/golang/mobile/blob/master/exp/audio/al/alc_notandroid.go\" rel=\"nofollow noreferrer\">https://github.com/golang/mobile/blob/master/exp/audio/al/alc_notandroid.go</a></p>\n"}, {"tags": ["go", "cryptography"], "comments": [{"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1502690920, "post_id": 45668137, "comment_id": 78294032, "body": "I don&#39;t think this optimal Ate pairing provides an efficient hash function from G1 to G2."}], "answers": [{"tags": [], "owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "is_accepted": false, "score": 0, "last_activity_date": 1502767881, "creation_date": 1502767881, "answer_id": 45686099, "question_id": 45668137, "link": "https://stackoverflow.com/questions/45668137/how-to-compute-eg1x-g1x-with-golang-org-x-crypto-bn256/45686099#45686099", "title": "How to compute e(g1^x,g1^x) with golang.org/x/crypto/bn256?", "body": "<p>I use <a href=\"https://github.com/Nik-U/pbc\" rel=\"nofollow noreferrer\">this</a> insteadly.</p>\n\n<p>It is a golang wrapper around pbc library.</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 7511280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EJmmaBy1yBA/AAAAAAAAAAI/AAAAAAAABf8/An60U09yynQ/photo.jpg?sz=128", "display_name": "Suvi", "link": "https://stackoverflow.com/users/7511280/suvi"}, "is_accepted": true, "score": 0, "last_activity_date": 1612810024, "creation_date": 1612810024, "answer_id": 66107537, "question_id": 45668137, "link": "https://stackoverflow.com/questions/45668137/how-to-compute-eg1x-g1x-with-golang-org-x-crypto-bn256/66107537#66107537", "title": "How to compute e(g1^x,g1^x) with golang.org/x/crypto/bn256?", "body": "<p>bn256 does not let you do symmetric pairing with pair(G1,G2).</p>\n<p>One way to go about it is to raise the destination group element to the desired exponent.</p>\n"}], "owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 66107537, "answer_count": 2, "score": 0, "last_activity_date": 1612810024, "creation_date": 1502689832, "question_id": 45668137, "link": "https://stackoverflow.com/questions/45668137/how-to-compute-eg1x-g1x-with-golang-org-x-crypto-bn256", "title": "How to compute e(g1^x,g1^x) with golang.org/x/crypto/bn256?", "body": "<p>The golang package <a href=\"https://godoc.org/golang.org/x/crypto/bn256\" rel=\"nofollow noreferrer\">bn256</a> can do this: e(g_1^x,g_2^y), but I want to compute e(g_1^x,g_1^y).</p>\n\n<p>Is there any way to transfer a point on g1 to g2?</p>\n"}, {"tags": ["node.js", "go"], "comments": [{"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 2, "creation_date": 1502688735, "post_id": 45667923, "comment_id": 78293314, "body": "refer to <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/PackageManagementTools</a>"}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 2, "creation_date": 1502694046, "post_id": 45667923, "comment_id": 78295284, "body": "go get -v -t ./... Will recursively install all imports and yes that&#39;s three dots in a row no space after first dot"}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 529321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e974ce23b1f3016285b373fcba49c310?s=128&d=identicon&r=PG", "display_name": "skomp", "link": "https://stackoverflow.com/users/529321/skomp"}, "edited": false, "score": 0, "creation_date": 1520842591, "post_id": 45668247, "comment_id": 85464670, "body": "Just for completeness: by now I switched to <code>dep</code> which generates a <code>toml</code> file when initialized and a lock file. these get checked into git, works like a charm, also for libraries."}], "tags": [], "owner": {"reputation": 341, "user_id": 529321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e974ce23b1f3016285b373fcba49c310?s=128&d=identicon&r=PG", "display_name": "skomp", "link": "https://stackoverflow.com/users/529321/skomp"}, "is_accepted": false, "score": 1, "last_activity_date": 1502700230, "last_edit_date": 1502700230, "creation_date": 1502690432, "answer_id": 45668247, "question_id": 45667923, "link": "https://stackoverflow.com/questions/45667923/package-json-equivalent-in-golang/45668247#45668247", "title": "package.json equivalent in Golang", "body": "<p>Basically you should take a look at vendoring. There exist tools that help you with versioning. Personally, I use vendetta which is just a little tool that \"go gets\" the referenced packages as git submodules into the vendor folder. So if anyone checks out my repo they simply do <code>git submodule update --init --recursive</code>. The package version can be specified as a git commit id in the respective submodule.</p>\n\n<p>There also exist tools where you maintain the deps in a file, check out <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 0, "creation_date": 1519042047, "post_id": 45675547, "comment_id": 84734754, "body": "<a href=\"https://github.com/FrickeFresh/awesome\" rel=\"nofollow noreferrer\">github.com/FrickeFresh/awesome</a>  --&gt; Page Not Found 404 Please edit your Answer with Correct Link"}], "tags": [], "owner": {"reputation": 1044, "user_id": 1949322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b49c06625a28488b90d2b7f960163f?s=128&d=identicon&r=PG", "display_name": "WaltPurvis", "link": "https://stackoverflow.com/users/1949322/waltpurvis"}, "is_accepted": false, "score": 5, "last_activity_date": 1502717031, "creation_date": 1502717031, "answer_id": 45675547, "question_id": 45667923, "link": "https://stackoverflow.com/questions/45667923/package-json-equivalent-in-golang/45675547#45675547", "title": "package.json equivalent in Golang", "body": "<blockquote>\n  <p>What is the equivalent of this with Go? I have a few imports and don't want people to have to manually install it if they use my package.</p>\n</blockquote>\n\n<p>You don't have to do anything. People will not have to manually install the packages you import. When someone does</p>\n\n<pre><code>go get github.com/FrickeFresh/awesome\n</code></pre>\n\n<p>all of the dependencies you import in your awesome package will be downloaded automatically as needed.</p>\n\n<p>Go get skips testing files by default, but a user can download those too by including -t:</p>\n\n<pre><code>go get -t github.com/FrickeFresh/awesome\n</code></pre>\n\n<p>But that's not something you need to worry about.</p>\n\n<p>If you want to delve into vendoring specific versions of dependencies, there are a number of articles/tools available. The <em>official</em> tool is dep:</p>\n\n<p><a href=\"https://github.com/golang/dep\" rel=\"noreferrer\">https://github.com/golang/dep</a></p>\n"}], "owner": {"reputation": 1478, "user_id": 5090886, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dbrza.jpg?s=128&g=1", "display_name": "FrickeFresh", "link": "https://stackoverflow.com/users/5090886/frickefresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4112, "favorite_count": 0, "answer_count": 2, "score": 9, "last_activity_date": 1502717031, "creation_date": 1502688492, "question_id": 45667923, "link": "https://stackoverflow.com/questions/45667923/package-json-equivalent-in-golang", "title": "package.json equivalent in Golang", "body": "<p>I am coming over to Go from Node.js and I am used to adding all my modules and then people just have to go <code>npm install</code> when cloning my package.</p>\n\n<p>What is the equivalent of this with Go? I have a few imports and don't want people to have to manually install it if they use my package.</p>\n\n<p>I also not sure if I create a simple Go application with just a <code>package main</code> if that allows people to just <code>go get</code>. I have really picked up on the Go way of repo sharing like Node.js</p>\n"}, {"tags": ["go", "methods", "packages"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1502678588, "post_id": 45666430, "comment_id": 78291145, "body": "What one is supposed to see from your code? All 4 things run approximately the same time here."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 3, "creation_date": 1502687775, "post_id": 45666430, "comment_id": 78293038, "body": "Can you convert the code to the minimal required to illustrate the issue and share , may be a <a href=\"https://play.golang.org\" rel=\"nofollow noreferrer\">play.golang.org</a> would do"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 2, "creation_date": 1502704846, "post_id": 45666430, "comment_id": 78301290, "body": "Have you tried looking at the dissassembly? Also: Your methods take a pointer receiver, the functions take a value argument. The method is passed a pointer, the functions are passed the full object. Unless the compiler optimizes that difference out (which I don&#39;t think it does), that would explain the difference in performance"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1502716317, "post_id": 45666430, "comment_id": 78308077, "body": "Don&#39;t just link to external resources, and please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to demonstrate the issue. Also, what is an &quot;embedded alias&quot;?"}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "edited": false, "score": 0, "creation_date": 1502732476, "post_id": 45666430, "comment_id": 78317759, "body": "Unfortunately, because three packages are required to create the test, playground is not an option. I tried to create a gist, but couldn&#39;t figure out how to put models and datactrl in sub-directories.  I have modified the question to show the minimum code needed and a screen shot to demonstrate the issue."}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1502732629, "post_id": 45666430, "comment_id": 78317830, "body": "@zerkms Please see the screen shot included with the edited question."}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1502732790, "post_id": 45666430, "comment_id": 78317908, "body": "@EliasVanOotegem Van Oote My understanding is that structs are always passed as a pointer. That said, to create the effect of passing by value, the pointer points to a copy of the struct. That, of course, takes time."}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "edited": false, "score": 0, "creation_date": 1502732907, "post_id": 45666430, "comment_id": 78317959, "body": "Note that the results shown compare methods to methods, which eliminates the issue of extra time needed to the struct passed to the functions."}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502733018, "post_id": 45666430, "comment_id": 78318014, "body": "@JimB The terms alias and embedded in this context come from other stack overflow answers that showed me how to add methods to a struct defined in another package."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502735090, "post_id": 45666430, "comment_id": 78319045, "body": "@emadera52: &quot;Aliases&quot; are a specific concept, and the feature is only being added in the upcoming 1.9 release. Structs are <i>not</i> always passed as a pointer, I&#39;m not sure how you could come to that conclusion. Everything is passed by value, be it a struct or a pointer (or a slice, array, map, etc)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502736379, "post_id": 45666430, "comment_id": 78319757, "body": "For reference, methods and functions are called in the exact same manner. You can even call a method explicitly as a function via <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\"><code>method expression</code></a>. The difference in your two remaining cases is that is that each call in <code>meth</code> has 1 alloc, while each call in <code>method</code> has 2. You can get a better sense of timing and allocations by using the builtin benchmarking facilities, rather than timing these on your own."}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502737560, "post_id": 45666430, "comment_id": 78320413, "body": "@JimB Thanks for your comments. I think the last one answers my question as to why <b>meth</b> is faster than <b>method</b>. The extra alloc required by <b>method</b> is the likely culprit."}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502737798, "post_id": 45666430, "comment_id": 78320559, "body": "@JimB With regard to passing by reference or value, I&#39;m an old fart. A relic from the days when passing by value meant passing on the stack, or better yet, in a register. I accept that in Go terminology there is no such restriction. Times have changed, and for the better I would agree."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1502739428, "post_id": 45666430, "comment_id": 78321425, "body": "@emadera52 I don&#39;t know how/where you got the idea from that structs are always passed via pointers (ie indirection). Especially if the receiver is being passed a pointer to a <i>copy</i>. That&#39;s extremely wasteful. Nonetheless, I had a quick look at the golang specs and it simply states that <i>&quot;In a function call, [...], the parameters of the call are passed by value to the function and the called function begins execution. The return parameters of the function are passed by value back to the calling function when the function returns.&quot;</i>"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1502739594, "post_id": 45666430, "comment_id": 78321527, "body": "These values can be anything from a pointer to a full struct. Although I haven&#39;t looked into it in a while, but I wouldn&#39;t be surprised if golang were to use some static analysis while compiling, and only pass a copy if the caller writes to the struct. That said, the go compiler is -compared to things like the gcc compilers- quite young. It probably doesn&#39;t perform the same kind of complex optimisations as a 20+ year old C compiler does"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1502740017, "post_id": 45666430, "comment_id": 78321732, "body": "I also found <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/INedfATw74A\" rel=\"nofollow noreferrer\">this google group discussion</a> Where Rob Pike spells it out quite clearly: <i>&quot;In Go, everything is passed by value. Everything. &quot;</i>. That&#39;s exactly the same as it would be in C"}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1502774607, "post_id": 45666430, "comment_id": 78331300, "body": "@EliasVanOotegem That all makes perfect sense given that a pointer is a value. As you know, in C, the programmer is responsible for deciding when to pass a pointer vs when pass a value. If the choice is pointer, allocating memory and creating the value in memory, as well as releasing the memory are all done implicitly. Go hides some of that complexity, but apparently not as much as I thought. Thanks for your input. So much to learn, so little time."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502744002, "post_id": 45681719, "comment_id": 78323678, "body": "<code>methods, defined in the same package as the struct they become part of, require an extra memory allocation</code> - no that&#39;s not the reason for the extra allocation. The &quot;method&quot; test creates a new value every time, while the &quot;meth&quot; test writes a value to the same location pre-allocated in <code>Rcd</code> every time. You can test this by looking at the address of the return pointer in each case."}, {"owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502774165, "post_id": 45681719, "comment_id": 78331181, "body": "Interesting. Does that mean that &quot;method&quot; could, in theory, be modified to do the same thing. In practice, the value (to me) of &quot;meth&quot; is in being able to define methods on a struct defined in a different package. I see now that cutting the time by 25% is insignificant because a method call is so fast to begin with. Thanks for taking time to look into the matter."}], "tags": [], "owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "is_accepted": false, "score": -1, "last_activity_date": 1502738945, "creation_date": 1502738945, "answer_id": 45681719, "question_id": 45666430, "link": "https://stackoverflow.com/questions/45666430/is-using-an-embedded-alias-to-define-methods-on-a-struct-in-a-different-package/45681719#45681719", "title": "Is using an embedded alias to define methods on a struct in a different package efficient?", "body": "<p>Actually @JimB answered my question, but it is in a comment regarding the question. </p>\n\n<p>The answer appears to be that typical methods, defined in the same package as the struct they become part of, require an extra memory allocation. What I've referred to as <strong>remote</strong> method definitions get a tiny edge as a result. </p>\n\n<p>Keep in mind that the edge may not be worth doing something that requires a lot of comments to clarify what's going on. On the other hand, if you need/want to separate data manipulation from data definition, <strong>remote</strong> methods will allow you to do that, and you save what amounts to a few microseconds on every call as an added bonus. :)</p>\n\n<p>His suggestion to use Go's Benchmark facility, built in with testing, sounds like a good one. I'll be looking into it myself.</p>\n"}], "owner": {"reputation": 3, "user_id": 4052562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqr7I.jpg?s=128&g=1", "display_name": "emadera52", "link": "https://stackoverflow.com/users/4052562/emadera52"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1502738945, "creation_date": 1502674973, "last_edit_date": 1502732336, "question_id": 45666430, "link": "https://stackoverflow.com/questions/45666430/is-using-an-embedded-alias-to-define-methods-on-a-struct-in-a-different-package", "title": "Is using an embedded alias to define methods on a struct in a different package efficient?", "body": "<p>Unless my tests are wrong, all other options, including using plain functions take roughly 35% longer than defining methods in a different package using an embedded alias. I've probably done something wrong, and I'd love to know what it is. For complete details see <a href=\"https://github.com/emadera52/mvsf\" rel=\"nofollow noreferrer\">this repository</a>. </p>\n\n<p>[EDIT] Thanks for the comments/suggestions. The following shows only code related to comparing \"method\" to \"meth\". The former uses typical methods defined in the models package along with the struct. The \"meth\" option defines methods using an embedded alias defined in the datactrl package. The first code example includes the struct definition and an exported default instance of the struct used in the tests.</p>\n\n<p><strong>from package models, file models.go</strong></p>\n\n<pre><code>type CmntData struct {\n    ID          int\n    Slug        string\n    Title       string\n    PageID      int\n    Text        string\n    DateCreated time.Time\n    CreatedBy   int\n}\n\nvar DefaultCD = CmntData{ID: 100, Title: \"Demo Comment\",\nText: \"This is a test comment\", PageID: 1000, CreatedBy: 4242}\n\n\n// Local methods called by the \"method\" test\n\nfunc (cd *CmntData) NewComment(ncd CmntData) *CmntData {\n\n    ncd.DateCreated = time.Now()\n\n    return &amp;ncd\n}\n\nfunc (cd *CmntData) DefaultComment(cnt int) *CmntData {\n\n    dcd := DefaultCD\n    dcd.Slug = \"demo-comment-\" + strconv.Itoa(cnt + 1)\n\n    return cd.NewComment(dcd)\n}\n</code></pre>\n\n<p><strong>from package datactrl, file comments.go</strong></p>\n\n<pre><code>// Types and method definitions used to add methods to models.CmntData\n\ntype roCmntData struct {\n    ModelCD models.CmntData\n}\n\ntype roCD struct{}\n\n// roComment allows us to effectively add methods to models.CmntData.\n// Data and \"local\" methods defined for models.CmntData are accessible.\ntype roComment struct {\n    *roCmntData  // Provides access to models.CmntData\n    *roCD        // Required to make the magic happen\n}\n\n// Other packages must use Rcd to access methods added to models.CmntData\nvar Rcd = roComment {\n    roCmntData: &amp;roCmntData{},\n    roCD: &amp;roCD{},\n}\n\n// Remote methods called by the \"meth\" test\n\nfunc (cd *roComment) NewComment(ncd models.CmntData) *models.CmntData {\n\n    cd.roCmntData.ModelCD = ncd\n    cd.ModelCD.DateCreated = time.Now()\n\n    return &amp;cd.ModelCD\n}\n\nfunc (cd *roComment) DefaultComment(cnt int) *models.CmntData {\n\n    dcd := models.DefaultCD\n    dcd.Slug = \"demo-comment-\" + strconv.Itoa(cnt + 1)\n\n    return cd.NewComment(dcd)\n}\n</code></pre>\n\n<p><strong>from package main, file main.go</strong></p>\n\n<pre><code>if cmd == \"method\" {\n    tstart := time.Now()\n    dcd := models.CmntData{}\n    for i := 0; i &lt; limit; i++ {\n        defCD = dcd.DefaultComment(i)\n    }\n    tfinish := time.Now()\n    elapsed = tfinish.Sub(tstart)\n}\n\nif cmd == \"meth\" {\n    tstart := time.Now()\n\n    // datactrl.Rcd provides access to remote models.CmntData methods\n    dcd := &amp;datactrl.Rcd \n    for i := 0; i &lt; limit; i++ {\n        defCD = dcd.DefaultComment(i)\n    }\n    tfinish := time.Now()\n    elapsed = tfinish.Sub(tstart)\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eh4W3.png\" rel=\"nofollow noreferrer\">Screen shot of results</a> taking the average of 40 loops, where each loop returns the average of one million test runs. For the record, both \"func\" and \"function\" tests complete within 2ms of the result posted by \"method\".</p>\n"}, {"tags": ["http", "go", "http-headers", "http-authentication"], "answers": [{"comments": [{"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1502675773, "post_id": 45666405, "comment_id": 78290620, "body": "Good to know. That answers the missing realm on some browsers. Do you know anything about changing the default message that appears on all browsers?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 4, "creation_date": 1502717712, "post_id": 45666405, "comment_id": 78308996, "body": "@Godfrey: the authentication dialog is created by the browser, you can&#39;t modify that from your code on the server."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 7, "last_activity_date": 1502674675, "creation_date": 1502674675, "answer_id": 45666405, "question_id": 45666306, "link": "https://stackoverflow.com/questions/45666306/change-basic-http-authentication-realm-and-login-dialog-message/45666405#45666405", "title": "Change Basic HTTP Authentication realm and login dialog message", "body": "<p>This is not related to Go but actually to browser behaviour when receiving that header.</p>\n\n<p>It seems Chrome/Chromium has a known issue with this related to the feature not considered secure by the development team, so I don't think you'd be able to fix it on your side unless you resort to some other authentication mechanism.</p>\n\n<p>See here for more details:</p>\n\n<p><a href=\"https://bugs.chromium.org/p/chromium/issues/detail?id=544244#c32\" rel=\"noreferrer\">https://bugs.chromium.org/p/chromium/issues/detail?id=544244#c32</a></p>\n"}, {"tags": [], "owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "is_accepted": true, "score": 3, "last_activity_date": 1502937974, "last_edit_date": 1592644375, "creation_date": 1502937974, "answer_id": 45725831, "question_id": 45666306, "link": "https://stackoverflow.com/questions/45666306/change-basic-http-authentication-realm-and-login-dialog-message/45725831#45725831", "title": "Change Basic HTTP Authentication realm and login dialog message", "body": "<p>Thanks for the responses but they were not satisfactory. I had to do some reading on this topic.</p>\n<p><strong>The correct answer is that the login prompt/dialog is a response built into the user-agent/browser and cannot be changed by the server. This also explains why some browsers show realm while others don't.</strong></p>\n<p>According to Wikipedia Basic access authentication all the server does is:</p>\n<blockquote>\n<p>When the server wants the user agent to authenticate itself towards the server, it must respond appropriately to unauthenticated requests.</p>\n<p>Unauthenticated requests should return a response whose header contains a HTTP 401 Unauthorized status[4] and a WWW-Authenticate field.[5]</p>\n<p>The WWW-Authenticate field for basic authentication (used most often) is constructed as following:</p>\n<p>WWW-Authenticate: Basic realm=&quot;User Visible Realm&quot;</p>\n</blockquote>\n"}], "owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4678, "favorite_count": 2, "accepted_answer_id": 45725831, "answer_count": 2, "score": 3, "last_activity_date": 1502938218, "creation_date": 1502673771, "last_edit_date": 1502938218, "question_id": 45666306, "link": "https://stackoverflow.com/questions/45666306/change-basic-http-authentication-realm-and-login-dialog-message", "title": "Change Basic HTTP Authentication realm and login dialog message", "body": "<p>I want to change the message that pops up during implementation of Basic Auth.The current default message is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZMBql.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/ZMBql.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>Server requires a username and password.</p>\n</blockquote>\n\n<p>Something that would be more accurate for me is :</p>\n\n<blockquote>\n  <p>Server requires an Email and Password.</p>\n</blockquote>\n\n<p>My problem is that i can't find or don't know where this message is set and if it can be changed. Most of the questions online are about Basic Auth implemention but this is not my problem -- i can implement it very fine. I just need a more accurate response for the user.</p>\n\n<p>Here is how i force an authentication window using echo:</p>\n\n<pre><code>c.Response().Header().Set(echo.HeaderWWWAuthenticate, `Basic realm=\"Your Email is your Username\"`)\nreturn echo.ErrUnauthorized\n</code></pre>\n\n<p>NB: Only Firefox shows the realm message. Both Chrome and Opera do not.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 0, "creation_date": 1502699559, "post_id": 45666636, "comment_id": 78298102, "body": "If I create an importer and exporter, how will I be able to access my config struct, that was created in main?"}, {"owner": {"reputation": 19745, "user_id": 574632, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bb13b2bbc97ce81108b09be9a41120a1?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/574632/steve"}, "reply_to_user": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 1, "creation_date": 1502710754, "post_id": 45666636, "comment_id": 78304642, "body": "@Mads i would have thought only the code that initializes the structs needs access to the config, not the structs themselves"}, {"owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "reply_to_user": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 0, "creation_date": 1502714708, "post_id": 45666636, "comment_id": 78307056, "body": "@Mads You can always inject the dependency. So instead of having <code>func NewCSVImporter() *CSVImporter</code>, you can have <code>func NewCSVImporter(config *ConfigFile) *CSVImporter</code>."}, {"owner": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 0, "creation_date": 1502715700, "post_id": 45666636, "comment_id": 78307685, "body": "@mscheker Yes, dependecy injection must be way to go. But having defined my <code>ConfigFile</code> struct in the top of my main package, will I be able to access it <code>package importer</code>? I guess in my type <code>CSVimporter</code> struct, I&#39;ll have a member <code>conf *ConfigFile</code>, that&#39;ll get set when calling <code>NewCSVImporter(config *ConfigFile)</code>."}, {"owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "reply_to_user": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 0, "creation_date": 1502715879, "post_id": 45666636, "comment_id": 78307810, "body": "@Mads Do you have to define <code>ConfigFile</code> in the <code>main</code> package? It seems that you&#39;re better off having a <code>config</code> package and sharing the package across your importers and exporters."}, {"owner": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 0, "creation_date": 1502716090, "post_id": 45666636, "comment_id": 78307934, "body": "@mscheker, no i can define a separate config package. That would do the work, afaik. But when I thought about it before, it just seemed a bit strange to have a package for just handling a config file. But maybe I haven&#39;t understood Go&#39;s concept of packages yet."}, {"owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "reply_to_user": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 0, "creation_date": 1502716394, "post_id": 45666636, "comment_id": 78308120, "body": "@Mads Well, here&#39;s the thing. Do you even need the <code>ConfigFile</code> struct to begin with? Couldn&#39;t you just abstract that into the corresponding importer/exporter? Just an idea."}, {"owner": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 0, "creation_date": 1502716880, "post_id": 45666636, "comment_id": 78308446, "body": "@mscheker, What exactly do you mean by abstracting it into the importer/exporter? I wouldn&#39;t mind getting rid of the <code>ConfigFile</code> struct, but my config file itself, is fairly large, because I have some settings for each type of importer and exporter."}, {"owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "reply_to_user": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "edited": false, "score": 0, "creation_date": 1502716936, "post_id": 45666636, "comment_id": 78308481, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/151888/discussion-between-mscheker-and-mads\">continue this discussion in chat</a>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502719061, "post_id": 45666636, "comment_id": 78310021, "body": "The file structure example in the answer doesn&#39;t actually seem to have anything to do with the question (it&#39;s not a q about GOPATH structure, it&#39;s about project structure). The rest of the answer is relevant though so not going to downvote for that."}, {"owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502723623, "post_id": 45666636, "comment_id": 78312908, "body": "@Adrian Updated my answer to reflect the suggested project structure discussed with OP."}], "tags": [], "owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "is_accepted": true, "score": 2, "last_activity_date": 1502723593, "last_edit_date": 1502723593, "creation_date": 1502677117, "answer_id": 45666636, "question_id": 45665698, "link": "https://stackoverflow.com/questions/45665698/go-app-file-package-structure/45666636#45666636", "title": "Go app file/package structure", "body": "<p>Take a look at <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a></p>\n\n<p>From the documentation, this is how a workspace should look in practice:</p>\n\n<pre><code>bin/\n    hello                          # command executable\n    outyet                         # command executable\npkg/\n    linux_amd64/\n        github.com/golang/example/\n            stringutil.a           # package object\nsrc/\n    github.com/golang/example/\n        .git/                      # Git repository metadata\n    hello/\n        hello.go               # command source\n    outyet/\n        main.go                # command source\n        main_test.go           # test source\n    stringutil/\n        reverse.go             # package source\n        reverse_test.go        # test source\n    golang.org/x/image/\n        .git/                      # Git repository metadata\n    bmp/\n        reader.go              # package source\n        writer.go              # package source\n    ... (many more repositories and packages omitted) ...\n</code></pre>\n\n<p>I would probably create a CSV and an XML package, and put their corresponding importers/exporters there, or have an importer and an exporter package.</p>\n\n<h2>Update:</h2>\n\n<p>Suggested project structure -</p>\n\n<pre><code>app\n|- main.go\n|- config\n    |- config.go\n|- importer\n    |- importer.go\n    |- csv.go\n    |- xml.go\n|- exporter\n    |- exporter.go\n    |- csv.go\n    |- xml.go\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 948383, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/40d0367c1bec78fc750f133415c7eff0?s=128&d=identicon&r=PG", "display_name": "madshov", "link": "https://stackoverflow.com/users/948383/madshov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 45666636, "answer_count": 1, "score": 1, "last_activity_date": 1502723593, "creation_date": 1502666440, "question_id": 45665698, "link": "https://stackoverflow.com/questions/45665698/go-app-file-package-structure", "title": "Go app file/package structure", "body": "<p>I'm building a CLI app that imports some data (e.g. from a db or CSV, XML) and exports it to some other format (e.g. to a db or file). An importer and exporter is specified when the app is started as input parameters to the app.\nI'm looking for some inspiration on how to structure the files/packages. </p>\n\n<p>At the moment, I have separated each importer and exporter in its own file. Each importer satisfies a general importer interface:</p>\n\n<pre><code>type Importer interface {\n    Import() ([]*data, error)\n    PreProcess() error\n    PostProcess() error\n}\n</code></pre>\n\n<p>So, for instance, <code>CSVImporter</code> would implement these 3 functions. Likewise for the exporters. Currently all importers and exporters are part of the main package together with the main file. I think this makes the most sense, as they are part of the app, and should not be used in other projects. Also, since I have a lot of config settings (some general and some for each importer and exporter), that are unmarshalled in the beginning of my main package, I believe my importers and exporters should be part of the same package, in order for me to use the settings there.</p>\n\n<pre><code>package main\n\ntype ConfigFile struct {\n    Environment    string\n    Resources      *Resources\n    Importers      *Importers\n    Exporters      *Exporters\n    ...\n}\n\nfunc main() {\n    cfg ConfigFile\n\n\n    // Load config file settings\n    err := viper.Unmarshal(&amp;cfg)\n\n    var i StockImporter\n    var e StockExporter\n\n    // Create selected importer.\n    switch viper.GetString(\"importer\") {\n         case \"csv-importer\":\n         i = NewCSVImporter()\n         ...\n    }\n}\n</code></pre>\n\n<p>My current file structure looks like the following:</p>\n\n<pre><code>app\n|- main.go\n|- importer.go\n|- csvimporter.go\n|- xmlimporter.go\n|- exporter.go\n|- csvexporter.go\n| - lib\n    | - db.go\n</code></pre>\n\n<p>I hope my current structure is described clearly. My question is: Are there better ways to structure my app? Specifically, I dont like having all the files in the same dir as main. Any suggestions?\nThanks</p>\n"}, {"tags": ["go", "sqlx"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1502669522, "post_id": 45665502, "comment_id": 78289556, "body": "You need reflection to achieve generic function."}, {"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 0, "creation_date": 1502681777, "post_id": 45665502, "comment_id": 78291716, "body": "Why accept an <code>interface{}</code> type, and then return a <code>[]interface{}</code>? Instead of creating an <code>[]Account</code> in your function, just create a <code>[]interface{}</code>, <code>append</code> to it and return it."}], "answers": [{"tags": [], "owner": {"reputation": 1167, "user_id": 5395709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzXBY.jpg?s=128&g=1", "display_name": "mscheker", "link": "https://stackoverflow.com/users/5395709/mscheker"}, "is_accepted": false, "score": 0, "last_activity_date": 1502719202, "last_edit_date": 1502719202, "creation_date": 1502678389, "answer_id": 45666749, "question_id": 45665502, "link": "https://stackoverflow.com/questions/45665502/making-a-copy-of-interface-argument-with-underlying-type/45666749#45666749", "title": "Making a copy of interface{} argument with underlying type", "body": "<p>Couldn't you make your structs polymorphic and have them implement a single interface? Then your function can return a slice of said interface? This way you wouldn't have to use reflection. I was thinking something along these lines:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Account interface {\n    GetDetails() string\n}\n\ntype PersonAccount struct {\n    Name string\n}\n\nfunc NewPersonAccount(name string) Account {\n    return &amp;PersonAccount{\n        Name: name,\n    }\n}\n\nfunc (account *PersonAccount) GetDetails() string {\n    return account.Name\n}\n\ntype BillingAccount struct {\n    AccountNumber string\n}\n\nfunc NewBillingAccount(accountNumber string) Account {\n    return &amp;BillingAccount{\n        AccountNumber: accountNumber,\n    }\n}\n\nfunc (account *BillingAccount) GetDetails() string {\n    return account.AccountNumber\n}\n\nfunc getAllAccounts() []Account {\n    accounts := make([]Account, 0)\n    accounts = append(accounts, NewPersonAccount(\"John Doe\"))\n    accounts = append(accounts, NewBillingAccount(\"1234-5678\"))\n\n    return accounts\n}\n\nfunc main() {\n    accounts := getAllAccounts()\n\n    for _, account := range accounts {\n        fmt.Println(account.GetDetails())\n    }\n}\n\n/* Output:\nJohn Doe\n1234-5678\n*/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": false, "score": 0, "last_activity_date": 1502685001, "last_edit_date": 1502685001, "creation_date": 1502684281, "answer_id": 45667409, "question_id": 45665502, "link": "https://stackoverflow.com/questions/45665502/making-a-copy-of-interface-argument-with-underlying-type/45667409#45667409", "title": "Making a copy of interface{} argument with underlying type", "body": "<p>First, there seems to be a difference between what you mention in your description as of now </p>\n\n<blockquote>\n  <p>but I have a requirement to build a generic function that accepts\n  interface{} and returns a []interface{}.</p>\n</blockquote>\n\n<p>and what your code does (it accepts a slice of an interface and not an interface). </p>\n\n<p>You may not need to accept a slice of interfaces in the function parameters as your code currently does, can just accept an interface, so your function can look like :</p>\n\n<pre><code>func selectAccounts(ext sqlx.Ext, query string, args interface{}) ([]Account, error) {\n</code></pre>\n\n<p>You can return an slice of interface and have any type inside of it. Please take a look at this <a href=\"https://play.golang.org/p/NcLxhsiqK8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/NcLxhsiqK8</a> </p>\n\n<p>As @ivan.sim mentions, you can just append <code>Account</code> to the interface slice instead of creating the slice <code>Accounts</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8149829"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502719202, "creation_date": 1502664075, "question_id": 45665502, "link": "https://stackoverflow.com/questions/45665502/making-a-copy-of-interface-argument-with-underlying-type", "title": "Making a copy of interface{} argument with underlying type", "body": "<p>I am populating lists of structs from a postgres database using the native sql library and jmoiron/sqlx. I currently have separate functions for different types, for example:</p>\n\n<pre><code>func selectAccounts(ext sqlx.Ext, query string, args []interface{}) ([]Account, error) {\n    var accts []Account\n    rows, err := ext.Queryx(query, args...)\n    if err != nil {\n        return nil, err\n    }\n    defer rows.Close()\n\n    for rows.Next() {\n        var a Account\n        if err = rows.StructScan(&amp;a); err != nil {\n            return nil, err\n        }\n        accts = append(accts, a)\n    }\n    err = rows.Err()\n    return accts, err\n}\n</code></pre>\n\n<p>... but I have a requirement to build a generic function that accepts interface{} and returns a []interface{}. I am finding the process of replacing the line <code>var a Account</code> above is difficult, as it requires making a copies of the passed in interface{} type while replicating its underlying type. Should I resign myself to the fact that I need to be using reflection, or is there another way to go about doing this?</p>\n"}, {"tags": ["go", "bitcoin"], "comments": [{"owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1502656007, "post_id": 45663254, "comment_id": 78286832, "body": "How are you creating your amount? It could just be that you goofed a conversion somewhere."}, {"owner": {"reputation": 329, "user_id": 2434102, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c055d9376881df4fc2945e866a8ae4cd?s=128&d=identicon&r=PG", "display_name": "Amidii", "link": "https://stackoverflow.com/users/2434102/amidii"}, "reply_to_user": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1502659700, "post_id": 45663254, "comment_id": 78287763, "body": "Updated first post with amounts. Fee works fine when using SendFrom() but when using CreateRawTransaction SetTxFee seems not to be working at all."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1504039707, "post_id": 45663254, "comment_id": 78854709, "body": "Looks like that library has been refactored. You may or may not want to update. The new godoc is located here (<a href=\"https://godoc.org/github.com/btcsuite/btcd/rpcclient\" rel=\"nofollow noreferrer\">godoc.org/github.com/btcsuite/btcd/rpcclient</a>) and you&#39;ll need to <code>go get</code> the new lib."}], "answers": [{"tags": [], "owner": {"reputation": 5043, "user_id": 8829161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6bfd06cafbd87e082480d82ecbf77298?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/8829161/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1517136117, "creation_date": 1517136117, "answer_id": 48485437, "question_id": 45663254, "link": "https://stackoverflow.com/questions/45663254/how-to-set-fee-in-raw-bitcoin-transaction-using-btcutil/48485437#48485437", "title": "How to set fee in raw bitcoin transaction using btcutil", "body": "<p><code>settxfee</code> is not for <code>createrawtransaction</code> command.</p>\n\n<p>if you have one input with 1 BTC and you would send 0.9 BTC so remaining amount is the transaction fee. </p>\n\n<p>if you don't want to set transaction fee for 0.1 BTC you could send 0.09 to change address and leave that 0.01 and it's your transaction fee.</p>\n"}], "owner": {"reputation": 329, "user_id": 2434102, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c055d9376881df4fc2945e866a8ae4cd?s=128&d=identicon&r=PG", "display_name": "Amidii", "link": "https://stackoverflow.com/users/2434102/amidii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1086, "favorite_count": 2, "answer_count": 1, "score": 12, "last_activity_date": 1517136117, "creation_date": 1502646790, "last_edit_date": 1510926937, "question_id": 45663254, "link": "https://stackoverflow.com/questions/45663254/how-to-set-fee-in-raw-bitcoin-transaction-using-btcutil", "title": "How to set fee in raw bitcoin transaction using btcutil", "body": "<p>According to the docs (<a href=\"http://godoc.org/github.com/btcsuite/btcrpcclient\" rel=\"noreferrer\">http://godoc.org/github.com/btcsuite/btcrpcclient</a>) the fee can be set by using</p>\n\n<pre><code>SetTxFee(fee btcutil.Amount) // hard coded0.0006 BTC\n</code></pre>\n\n<p>I set the fee to 0.0000016 bitcoin/kilobyte and do as follow:</p>\n\n<ol>\n<li>ListUnspent</li>\n<li>SetTxFee</li>\n<li>CreateRawTransaction</li>\n<li>SignRawTransaction</li>\n<li>SendRawTransaction</li>\n</ol>\n\n<p>But when i try to send transaction i get</p>\n\n<pre><code>-26: 256: absurdly-high-fee\n</code></pre>\n\n<p>Is there any other way to set the fee using this library?</p>\n\n<p><strong>Debug.log</strong></p>\n\n<pre><code>ThreadRPCServer method=listunspent\nThreadRPCServer method=settxfee\nThreadRPCServer method=createrawtransaction\nThreadRPCServer method=signrawtransaction    \nThreadRPCServer method=sendrawtransaction\n</code></pre>\n\n<p><strong>Amounts:</strong></p>\n\n<pre><code>amounts := map[btcutil.Address]btcutil.Amount{\n     destAddress: destAmount,\n}\n</code></pre>\n\n<p><strong><em>UPDATE</em></strong>\nIt seems like it tries to send whole sum of the transaction, not the amount i want it to send.</p>\n\n<p>If transaction in to A is 1 BTC and i want to send 0.3 BTC to another address, how to achieve this when setting amounts?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1502642695, "post_id": 45662612, "comment_id": 78282869, "body": "what is your compile command and <code>gopath</code>"}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1502642730, "post_id": 45662612, "comment_id": 78282880, "body": "<code>go run main.go</code>"}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1502642918, "post_id": 45662612, "comment_id": 78282937, "body": "<code>echo %GOPATH%</code> &gt; <code>C:\\Users\\demas1252\\go</code>"}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1502643199, "post_id": 45662612, "comment_id": 78283023, "body": "try <code>go run *.go</code>"}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1502643244, "post_id": 45662612, "comment_id": 78283038, "body": "get <code>GetFileAttributesEx *.go: The filename, directory name, or volume label syntax is incorrect.</code>"}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 1, "creation_date": 1502643296, "post_id": 45662612, "comment_id": 78283056, "body": "<code>go run room.go main.go</code>,  Windows CMD can&#39;t expand <code>*</code>"}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1502643421, "post_id": 45662612, "comment_id": 78283096, "body": "All works fine in this case. But may be there is more correct way to run and build program ?"}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1502643650, "post_id": 45662612, "comment_id": 78283166, "body": "it seems not a good practice to split main package into multiple files. package \u201cmain\u201d tells the Go compiler that the package should compile as an executable program instead of a shared library"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1502647731, "post_id": 45662612, "comment_id": 78284420, "body": "<code>go run ...</code> is <i>not</i> compiling your program. Use <code>go build</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1502643602, "creation_date": 1502643602, "answer_id": 45662780, "question_id": 45662612, "link": "https://stackoverflow.com/questions/45662612/function-visibility-in-the-same-package/45662780#45662780", "title": "function visibility in the same package", "body": "<p><code>go run *.go</code> will work in unix like system, and in Windows try to list all files in <code>main</code> package</p>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 45662780, "answer_count": 1, "score": -1, "last_activity_date": 1502643602, "creation_date": 1502642456, "question_id": 45662612, "link": "https://stackoverflow.com/questions/45662612/function-visibility-in-the-same-package", "title": "function visibility in the same package", "body": "<p>If I understand correctly - all the source files of a package live at the same scope.</p>\n\n<p>I have two files - room.go:</p>\n\n<pre><code>package main\n\nfunc newRoom() *room {\n    return &amp;room{\n        forward: make(chan []byte),\n        join:    make(chan *client),\n        leave:   make(chan *client),\n        clients: make(map[*client]bool),\n        tracer:  trace.Off(),\n    }\n}\n</code></pre>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nfunc main() {    \n    r := newRoom()\n</code></pre>\n\n<p>When I am compiling the code I get the error:</p>\n\n<pre><code>.\\main.go:34: undefined: newRoom\n</code></pre>\n\n<p>Why ?</p>\n\n<p>Full code is here <a href=\"https://github.com/matryer/goblueprints/tree/master/chapter1/chat\" rel=\"nofollow noreferrer\">https://github.com/matryer/goblueprints/tree/master/chapter1/chat</a></p>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1502637229, "post_id": 45661466, "comment_id": 78281303, "body": "<a href=\"https://github.com/chzyer/readline\" rel=\"nofollow noreferrer\">A possibly limited implementation of GNU Readline exists</a> if you just want to use that, or you can <a href=\"https://github.com/peterh/liner\" rel=\"nofollow noreferrer\">try an alternative</a> that provides some similar functionality."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1502646924, "post_id": 45661466, "comment_id": 78284166, "body": "maybe this can help: <a href=\"https://stackoverflow.com/a/20895629/1135424\">stackoverflow.com/a/20895629/1135424</a>"}, {"owner": {"reputation": 783, "user_id": 1257342, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/ce96ee777f6ab64a77ba32469288c69b?s=128&d=identicon&r=PG", "display_name": "gchain", "link": "https://stackoverflow.com/users/1257342/gchain"}, "edited": false, "score": 0, "creation_date": 1609770771, "post_id": 45661466, "comment_id": 115918625, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/20895552/how-to-read-from-standard-input-in-the-console\">How to read from standard input in the console?</a>"}], "owner": {"reputation": 501, "user_id": 1205077, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a6decbed7685eac78e41bc8b40327e55?s=128&d=identicon&r=PG", "display_name": "O\u011fuzhan Top&#231;u", "link": "https://stackoverflow.com/users/1205077/o%c4%9fuzhan-top%c3%a7u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502635699, "creation_date": 1502634854, "last_edit_date": 1502635699, "question_id": 45661466, "link": "https://stackoverflow.com/questions/45661466/equivalent-of-readline-get-line-buffer-in-golang", "title": "equivalent of readline.get_line_buffer in golang", "body": "<p>I am trying to implement <a href=\"https://github.com/n1nj4sec/pupy/blob/e40fecfb1dcc5812f433e212bee827a667cc8b81/pupy/pupylib/PupyCmd.py#L395\" rel=\"nofollow noreferrer\">this</a> behaviour in my golang CLI based program.\nThe behaviour is simple, I just want to print something to console while user is typing something.</p>\n\n<p>This is the code I have written. </p>\n\n<pre><code>// %a code that reads the user input in a different thread% \nfmt.Print(\"\\r[*] this is a message.\") // erases the current line then prints the message\nfmt.Print(\"\\n\\r\") // creates new empty line\nfmt.Print(\"&gt;&gt;&gt; \" + %CURRENT_STDIN_LINE_BUFFER%) // prints the prompt \"&gt;&gt;&gt;\" then writes the user input \n</code></pre>\n\n<p>The only missing thing is equilavent of readline.get_line_buffer() python function in golang.</p>\n"}, {"tags": ["go", "callback", "goroutine"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1502631542, "post_id": 45660762, "comment_id": 78279603, "body": "Why no just  go func() {  defer wg.Done()"}, {"owner": {"reputation": 371, "user_id": 3808149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67ab5cb0d83a576fde4f1f9f94a8a050?s=128&d=identicon&r=PG&f=1", "display_name": "gumchew", "link": "https://stackoverflow.com/users/3808149/gumchew"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1502632007, "post_id": 45660762, "comment_id": 78279728, "body": "this is absolutely nuts. Thank you.. Silly mistake on my part. My original code had <code>go func() { defer wg.Done() .......</code> but in the middle of refactoring, i made some silly assumptions."}], "answers": [{"tags": [], "owner": {"reputation": 144, "user_id": 8075949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeTbN.png?s=128&g=1", "display_name": "nk2ge5k", "link": "https://stackoverflow.com/users/8075949/nk2ge5k"}, "is_accepted": true, "score": 3, "last_activity_date": 1502631814, "creation_date": 1502631814, "answer_id": 45661001, "question_id": 45660762, "link": "https://stackoverflow.com/questions/45660762/goroutines-callbacks-and-sync-waitgroup/45661001#45661001", "title": "Goroutines, Callbacks and sync.WaitGroup", "body": "<p>May be like this?</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"time\"\n\n    \"github.com/davecgh/go-spew/spew\"\n)\n\nfunc callbackWithTimeout(cbFunc func() ([]byte, error), timeout time.Duration) {\n    time.Sleep(timeout)\n    d, e := cbFunc()\n    spew.Dump(d)\n    spew.Dump(e)\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n\n    wg.Add(1)\n\n    go func() {\n        defer wg.Done() // move it here\n        cbFunc := func() ([]byte, error) {\n            //I feel like I should be able to defer here instead\n            return nil, nil\n        }\n        callbackWithTimeout(cbFunc, time.Duration(4*time.Second))\n    }()\n\n    println(\"some line\")\n\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 3808149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67ab5cb0d83a576fde4f1f9f94a8a050?s=128&d=identicon&r=PG&f=1", "display_name": "gumchew", "link": "https://stackoverflow.com/users/3808149/gumchew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "accepted_answer_id": 45661001, "answer_count": 1, "score": 2, "last_activity_date": 1502632221, "creation_date": 1502630223, "last_edit_date": 1502632221, "question_id": 45660762, "link": "https://stackoverflow.com/questions/45660762/goroutines-callbacks-and-sync-waitgroup", "title": "Goroutines, Callbacks and sync.WaitGroup", "body": "<p>With the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/davecgh/go-spew/spew\"\n    \"sync\"\n    \"time\"\n)\nfunc callbackWithTimeout(cbFunc func() ([]byte, error), timeout time.Duration) {\n    defer wg.Done() //I don't want this function to know about sync.WaitGroup\n    time.Sleep(timeout)\n    d, e := cbFunc()\n    spew.Dump(d)\n    spew.Dump(e)\n}\nvar wg sync.WaitGroup\nfunc main() {\n    wg.Add(1)\n    go func() {\n        cbFunc := func() ([]byte, error) {\n            //I feel like I should be able to defer here instead\n            return nil, nil\n        }\n        callbackWithTimeout(cbFunc, time.Duration(4*time.Second))\n    }()\n    println(\"some line\")\n    wg.Wait()\n}\n</code></pre>\n\n<p>In function <code>callbackWithTimeout</code>, I don't want to use <code>defer wg.Done()</code> because it's not <code>callbackWithTimeout()</code>'s concern to <code>wg.Done()</code>. How do I go about implementing such a thing? i.e., remove any <code>sync.WaitGroup</code> in <code>callbackWithTimeout</code>? I have a bit of problem understanding the separation of concerns here as a callback'er function should not have to know about waitgroups but in this case it seems, I have no other choice?</p>\n\n<p><em>I feel like it should be a caller's responsibility</em> to <code>wg.Done()</code> (which in this case is the <code>cbFunc</code>) but lack any concise reference to documentation or ideas on how to implement it in Go because by definition, all a callback function does is call the function back. So, where I am doing it wrong?</p>\n\n<hr>\n\n<p>Silly assumptions were made by yours truly during refactoring. Working code below. Many thanks.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"github.com/davecgh/go-spew/spew\"\n    \"sync\"\n    \"time\"\n)\n\nfunc callbackWithTimeout(cbFunc func() ([]byte, error), timeout time.Duration) {\n    time.Sleep(timeout)\n    d, e := cbFunc()\n    spew.Dump(d)\n    spew.Dump(e)\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        callbackWithTimeout(func() ([]byte, error) {\n            b := []byte{1, 2, 3, 4}\n            e := errors.New(\"error123\")\n            return b, e\n        }, time.Duration(2*time.Second))\n    }()\n    println(\"some line\")\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": ["java", "go", "serialization", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "is_accepted": false, "score": 2, "last_activity_date": 1502620736, "last_edit_date": 1502620736, "creation_date": 1502619645, "answer_id": 45659317, "question_id": 45659153, "link": "https://stackoverflow.com/questions/45659153/persisting-protobuf-messages-to-database/45659317#45659317", "title": "Persisting Protobuf messages to Database", "body": "<p>Your ORM is dealing with objects, by definition.  It should not know or care about serialization on the network.  I'd suggest deserializing the protobuf message into objects that your ORM is used to and letting it persist them.  There's no good reason to couple your persistence tier to the network protocol.</p>\n\n<p>It might make sense to store the protobuf serialization directly if you get rid of JPA and go with a document based solution.  </p>\n\n<p>You have to decide how much value JPA is providing for you.</p>\n"}, {"comments": [{"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 2, "creation_date": 1502620642, "post_id": 45659349, "comment_id": 78276690, "body": "There&#39;s no reason to use an ORM if you go in this direction.  As you&#39;ve already pointed out, this is perfect for a NoSQL document persistence technology, but it makes no sense at all for JPA persistence using Java objects."}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1502620795, "post_id": 45659349, "comment_id": 78276723, "body": "@duffymo You are right as long as the messages are the only objects stored in the database."}, {"owner": {"reputation": 5469, "user_id": 598940, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/3665d076aec49bf74e33d162bde6a710?s=128&d=identicon&r=PG", "display_name": "Alec", "link": "https://stackoverflow.com/users/598940/alec"}, "edited": false, "score": 1, "creation_date": 1574872560, "post_id": 45659349, "comment_id": 104386898, "body": "This solution ignores any relationships in the data, though."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 2, "last_activity_date": 1502620871, "last_edit_date": 1502620871, "creation_date": 1502619873, "answer_id": 45659349, "question_id": 45659153, "link": "https://stackoverflow.com/questions/45659153/persisting-protobuf-messages-to-database/45659349#45659349", "title": "Persisting Protobuf messages to Database", "body": "<p>There is a not-straightforward solution to this problem. </p>\n\n<p>Protobuf 3 standardises <a href=\"https://developers.google.com/protocol-buffers/docs/proto3#json\" rel=\"nofollow noreferrer\">JSON mapping</a> for the messages. Once you serialise your message to JSON, you have multiple options for storing it in a database. </p>\n\n<p>The following (and many more) databases can store JSON data:</p>\n\n<ul>\n<li>MariaDB</li>\n<li>PostgreSQL</li>\n<li>MongoDB</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 2915955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14406e967db3b5e5f659bccfb3fa062?s=128&d=identicon&r=PG&f=1", "display_name": "sebastienhamel", "link": "https://stackoverflow.com/users/2915955/sebastienhamel"}, "is_accepted": false, "score": 0, "last_activity_date": 1611287120, "creation_date": 1611287120, "answer_id": 65839012, "question_id": 45659153, "link": "https://stackoverflow.com/questions/45659153/persisting-protobuf-messages-to-database/65839012#65839012", "title": "Persisting Protobuf messages to Database", "body": "<p>Although this question is quite old, things have happened since then and the <a href=\"https://foundationdb.github.io/fdb-record-layer/\" rel=\"nofollow noreferrer\">FoundationDB Record Layer</a>, released by Apple in 2018, stores Protocol Buffer natively.</p>\n"}], "owner": {"reputation": 2053, "user_id": 3734595, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/8e9c5c21bb867834bf0f3be8a7ce4b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Ysak", "link": "https://stackoverflow.com/users/3734595/ysak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8846, "favorite_count": 3, "answer_count": 3, "score": 11, "last_activity_date": 1611287120, "creation_date": 1502618364, "question_id": 45659153, "link": "https://stackoverflow.com/questions/45659153/persisting-protobuf-messages-to-database", "title": "Persisting Protobuf messages to Database", "body": "<p>What is the right way to persist data defined using protobuf3. I am using golang and Java, both place with support of ORMs. In java with Hibernate and golang with gorm. Both place i need to convert the Generated code to corresponding Entity model. I feel that is more pain full to maintain same object structure in order to be understandable by ORM. Is there any Database which i can use along with protobuf objects as is. Or i can define the relations between objects in the protobuf itself.</p>\n\n<p>Any helps really appreciated.</p>\n"}, {"tags": ["unit-testing", "testing", "go", "integration-testing"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1502617360, "post_id": 45658938, "comment_id": 78275946, "body": "<a href=\"http://blog.thecodewhisperer.com/permalink/integrated-tests-are-a-scam\" rel=\"nofollow noreferrer\">blog.thecodewhisperer.com/permalink/integrated-tests-are-a-s&zwnj;&#8203;cam</a>"}], "answers": [{"tags": [], "owner": {"reputation": 553, "user_id": 5483488, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/4ZHg7.jpg?s=128&g=1", "display_name": "Jake Lacey", "link": "https://stackoverflow.com/users/5483488/jake-lacey"}, "is_accepted": false, "score": 0, "last_activity_date": 1535757463, "last_edit_date": 1535757463, "creation_date": 1503308927, "answer_id": 45794061, "question_id": 45658938, "link": "https://stackoverflow.com/questions/45658938/golang-should-this-be-an-integration-testing/45794061#45794061", "title": "golang should this be an integration testing?", "body": "<p>I just thought after watching the video &amp; pondering this for a little bit and if nobody answered I would answer my own question.</p>\n\n<p>This video resulted me in not writing any integration tests, rather writing unit tests. and creating stubs which allowed me to modify the way the interface behaved allowing me to tests when the database behaves correctly and incorrectly.</p>\n\n<p>If you can think of a better way of describing what I said then please do :)</p>\n"}], "owner": {"reputation": 553, "user_id": 5483488, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/4ZHg7.jpg?s=128&g=1", "display_name": "Jake Lacey", "link": "https://stackoverflow.com/users/5483488/jake-lacey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1535757463, "creation_date": 1502616679, "question_id": 45658938, "link": "https://stackoverflow.com/questions/45658938/golang-should-this-be-an-integration-testing", "title": "golang should this be an integration testing?", "body": "<p>I have a method which implements the a database interface, that method inserts an 'object' into the database.</p>\n\n<pre><code>type database interface {\n    createLog(logDoc) (bool, error)\n}\n\n\ntype mongo struct {\n    database   string\n    collection string\n}\n\nfunc (m mongo) createLog(l logDoc) (bool, error) {\n\n    s, err := mgo.Dial(\"mongo\")\n\n    defer s.Close()\n\n    if err != nil {\n        return false, err\n    }\n\n     err = s.DB(m.database).C(m.collection).Insert(l)\n     if err != nil {\n        return false, err\n     }\n\n     return true, nil\n}\n</code></pre>\n\n<p>I want to be able to test the createLog method, how can I do this? should it be an integration test? if so what would be the your approach?</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1502597406, "creation_date": 1502597406, "answer_id": 45656975, "question_id": 45656937, "link": "https://stackoverflow.com/questions/45656937/implicit-interface-call-function/45656975#45656975", "title": "Implicit interface call function", "body": "<p><code>http.Dir(\"/tmp\")</code> is actually a type conversion where you convert the string <code>/tmp</code> into the <code>http.Dir</code> type. Looking at the <a href=\"https://golang.org/pkg/net/http/#Dir\" rel=\"nofollow noreferrer\">docs</a>, you will see that <code>http.Dir</code> is actually a string type. Hence, this type conversion works. </p>\n\n<p>In addition, the <code>http.Dir</code> type also implements the <code>func Open(name string) (File, error)</code> function. Hence, it can be used anywhere where a <a href=\"https://golang.org/pkg/net/http/#FileSystem\" rel=\"nofollow noreferrer\"><code>FileSystem</code></a> interface is used.</p>\n\n<p>You can also check out the <a href=\"https://golang.org/pkg/net/http/#ServeFile\" rel=\"nofollow noreferrer\"><code>func ServeFile(w ResponseWriter, r *Request, name string)</code></a> function in the <code>net/http</code> package.</p>\n"}], "owner": {"reputation": 1335, "user_id": 1896517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f0bdb1f3bf9cc6469bb61606284cbabf?s=128&d=identicon&r=PG", "display_name": "rvillablanca", "link": "https://stackoverflow.com/users/1896517/rvillablanca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 45656975, "answer_count": 1, "score": 0, "last_activity_date": 1502597406, "creation_date": 1502596992, "question_id": 45656937, "link": "https://stackoverflow.com/questions/45656937/implicit-interface-call-function", "title": "Implicit interface call function", "body": "<p>Looking for some examples to server static files with <code>net/http</code> package in Golang, I found the type <code>Dir</code> which implements <code>FileSystem</code> interface.</p>\n\n<p>Some examples show You can server static files with the following:</p>\n\n<pre><code>http.Handle(\"/\", http.FileServer(http.Dir(\"/tmp\")))\n</code></pre>\n\n<p>What exactly is <code>http.Dir(\"/tmp\")</code> ? It looks like a constructor function for <code>FileSystem</code>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1502747883, "post_id": 45656090, "comment_id": 78325331, "body": "Is this a limitation of a third party library?"}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 1, "last_activity_date": 1502585785, "creation_date": 1502585785, "answer_id": 45656177, "question_id": 45656090, "link": "https://stackoverflow.com/questions/45656090/how-do-i-create-an-instance-of-os-file-from-a-string/45656177#45656177", "title": "How do I create an instance of *os.File from a string?", "body": "<p>You can't create <code>*os.File</code> from string. If you can't use <code>io.Reader</code>, best bet is to write the string into temporary file and then use <code>os.Open</code> to get the <code>*os.File</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": false, "score": 4, "last_activity_date": 1502586017, "creation_date": 1502586017, "answer_id": 45656195, "question_id": 45656090, "link": "https://stackoverflow.com/questions/45656090/how-do-i-create-an-instance-of-os-file-from-a-string/45656195#45656195", "title": "How do I create an instance of *os.File from a string?", "body": "<p>Short answer is that you can't. For this reason, it is generally not recommended in Go to write functions that take an os.File unless you are actually doing a manual syscall or something else that would require an os.File. Instead, your functions should accept an io.Reader or another interface (perhaps containing io.Seeker) depending on what is needed.</p>\n\n<p>If you can modify the place that needs an os.File, that is your best bet. If you cannot and it really only needs a reader, you could use <a href=\"https://golang.org/pkg/os/#Pipe\" rel=\"nofollow noreferrer\">os.Pipe</a>.</p>\n\n<p>With more context, I might be able to give a better recommendation.</p>\n"}], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502586017, "creation_date": 1502584458, "question_id": 45656090, "link": "https://stackoverflow.com/questions/45656090/how-do-i-create-an-instance-of-os-file-from-a-string", "title": "How do I create an instance of *os.File from a string?", "body": "<p>I have a string that I need to be a read only file pointer (<code>*os.File</code>). I cannot use <code>strings.NewReader</code> because the function only accepts <code>*os.File</code>. Is this possible?</p>\n\n<p>I realise I could write the string directly to a file and then open it again. But I would like to avoid this step.</p>\n"}, {"tags": ["go", "xml-signature"], "comments": [{"owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "edited": false, "score": 0, "creation_date": 1502912656, "post_id": 45655516, "comment_id": 78401645, "body": "Can you confirm that the contents of <code>saml.crt</code> are identical to those of the PEM block you&#39;ve put on pastebin? If I validate using <code>goxmldsig</code>, it goes through as expected."}, {"owner": {"reputation": 660, "user_id": 580382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/eUpm4.jpg?s=128&g=1", "display_name": "smokedice", "link": "https://stackoverflow.com/users/580382/smokedice"}, "reply_to_user": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "edited": false, "score": 0, "creation_date": 1502995406, "post_id": 45655516, "comment_id": 78442932, "body": "@fuglede yes they are the same"}], "answers": [{"comments": [{"owner": {"reputation": 660, "user_id": 580382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/eUpm4.jpg?s=128&g=1", "display_name": "smokedice", "link": "https://stackoverflow.com/users/580382/smokedice"}, "edited": false, "score": 0, "creation_date": 1503006963, "post_id": 45725592, "comment_id": 78448533, "body": "very well spotted! Would you know why this happens? The example came from the <a href=\"https://wiki.shibboleth.net/confluence/display/SHIB2/MetadataExample\" rel=\"nofollow noreferrer\">shibboleth</a> website &amp; the xml:lang attributes are also described in the offical XSD."}, {"owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "reply_to_user": {"reputation": 660, "user_id": 580382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/eUpm4.jpg?s=128&g=1", "display_name": "smokedice", "link": "https://stackoverflow.com/users/580382/smokedice"}, "edited": false, "score": 0, "creation_date": 1503019462, "post_id": 45725592, "comment_id": 78451678, "body": "@smokedice: I am not sure why this happens. It looks like a problem in github.com/russellhaering/goxmldsig. Might be worth reporting an issue there for them to investigate."}, {"owner": {"reputation": 660, "user_id": 580382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/eUpm4.jpg?s=128&g=1", "display_name": "smokedice", "link": "https://stackoverflow.com/users/580382/smokedice"}, "edited": false, "score": 1, "creation_date": 1503046578, "post_id": 45725592, "comment_id": 78462059, "body": "for the reader: <a href=\"https://github.com/russellhaering/goxmldsig/issues/28\" rel=\"nofollow noreferrer\">github issue</a>"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 1, "last_activity_date": 1502936026, "creation_date": 1502936026, "answer_id": 45725592, "question_id": 45655516, "link": "https://stackoverflow.com/questions/45655516/golang-goxmldig-signature-verification-failed/45725592#45725592", "title": "golang/goxmldig - Signature Verification Failed", "body": "<p>It seems the problem is related to including this attribute in some of your elements:</p>\n\n<pre><code>xml:lang=\"en\"\n</code></pre>\n\n<p>For example in:</p>\n\n<pre><code>&lt;OrganizationName xml:lang=\"en\"&gt;Your Identities&lt;/OrganizationName&gt;\n</code></pre>\n\n<p>If you remove the <code>xml:lang=\"en\"</code> for all elements, the generated signature turns to be valid and correctly verified.</p>\n\n<p>As far as I can see, when you include that attribute, the elements written on the actual XML document seem to turn into this:</p>\n\n<pre><code>&lt;OrganizationName xmlns:xml=\"http://www.w3.org/XML/1998/namespace\" xml:lang=\"en\"&gt;Your Identities&lt;/OrganizationName&gt;\n</code></pre>\n\n<p>And that makes the signature invalid.</p>\n"}], "owner": {"reputation": 660, "user_id": 580382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/eUpm4.jpg?s=128&g=1", "display_name": "smokedice", "link": "https://stackoverflow.com/users/580382/smokedice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 1, "accepted_answer_id": 45725592, "answer_count": 1, "score": 3, "last_activity_date": 1502936026, "creation_date": 1502577484, "last_edit_date": 1502927412, "question_id": 45655516, "link": "https://stackoverflow.com/questions/45655516/golang-goxmldig-signature-verification-failed", "title": "golang/goxmldig - Signature Verification Failed", "body": "<p>I have attempted to sign a entities descriptor file, but the signature is always incorrect. xmlsectool states that the signature is expected digest is not the same as the actual digest.</p>\n\n<pre><code>xmlsectool-2.0.0/xmlsectool.sh --verifySignature --certificate saml.crt --inFile example.xml\nINFO  XMLSecTool - Reading XML document from file 'example.xml'\nINFO  XMLSecTool - XML document parsed and is well-formed.\nWARN  Reference - Verification failed for URI \"#id1234\"\nWARN  Reference - Expected Digest: D+SEh34cA7/atdQ8ojV9rzUcJcJSAslFZ0aOIwplGfI=\nWARN  Reference - Actual Digest: EYun0wngsN35ci20wRziCXs0Io7J4bZN+NYRnnTR5QM=\nERROR XMLSecTool - XML document signature verification failed\n</code></pre>\n\n<p>I followed the README example on <a href=\"https://github.com/russellhaering/goxmldsig\" rel=\"nofollow noreferrer\">goxmldsig</a> to create the following code. The full example is on <a href=\"https://pastebin.com/ZFrh4qZr\" rel=\"nofollow noreferrer\">pastebin</a>(stackoverflow wouldn't let me post it here).</p>\n\n<pre><code>xmlBytes := []byte(`&lt;&gt;&lt;/&gt;`)\nkeyPair, err := tls.X509KeyPair(certBytes, keyBytes)\nfailOnError(err, \"invalided to load keypair\")\n\nkeyStore := dsig.TLSCertKeyStore(keyPair)\n\nsigningContext := dsig.NewDefaultSigningContext(keyStore)\nsigningContext.Canonicalizer = dsig.MakeC14N10ExclusiveCanonicalizerWithPrefixList(\"\")\nerr = signingContext.SetSignatureMethod(dsig.RSASHA256SignatureMethod)\nfailOnError(err, \"failed to set signature method\")\n\nreadXMLDoc := etree.NewDocument()\nerr = readXMLDoc.ReadFromBytes(xmlBytes)\nfailOnError(err, \"cannot parse xml\")\n\nelementToSign := readXMLDoc.Root()\nelementToSign.CreateAttr(\"ID\", \"id1234\")\n\nsignedElement, err := signingContext.SignEnveloped(elementToSign)\nfailOnError(err, \"failed to sign envelop\")\n\nvar signedAssertionBuf []byte\n{\n    readXMLDoc.SetRoot(signedElement)\n    signedAssertionBuf, err = readXMLDoc.WriteToBytes()\n    failOnError(err, \"failed to convert doc to bytes\")\n}\n\nioutil.WriteFile(\"/tmp/test/example.xml\", signedAssertionBuf, 0775)\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1502588437, "post_id": 45654437, "comment_id": 78270866, "body": "Side note: GAE SDK != GCloud SDK, see <a href=\"https://stackoverflow.com/questions/33769879/what-is-the-relationship-between-googles-app-engine-sdk-and-cloud-sdk/33770297#33770297\" title=\"what is the relationship between googles app engine sdk and cloud sdk\">stackoverflow.com/questions/33769879/&hellip;</a>."}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1502588545, "post_id": 45654437, "comment_id": 78270877, "body": "By <code>AppEngine SDK</code> do you actually mean the GAE SDK (see comment above) or the GCloud SDK&#39;s <code>app-engine-go</code> component?"}, {"owner": {"reputation": 107, "user_id": 7836768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550083c73775e651fe894122315a87df?s=128&d=identicon&r=PG&f=1", "display_name": "Kieran W.", "link": "https://stackoverflow.com/users/7836768/kieran-w"}, "reply_to_user": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1502617311, "post_id": 45654437, "comment_id": 78275935, "body": "I realise they are not the same. I first installed the GCloud SDK, and then installed the <code>app-engine-go</code> component, which is the one I&#39;m trying to understand, as it apparently installs the <code>app-engine-go</code> component under <code>&#47;usr&#47;local&#47;google-gcloud-sdk</code> and NOT under <code>&#47;Users&#47;kieran&#47;google-cloud-sdk</code> which is what GCloud SDK has added to the PATH."}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1502682474, "post_id": 45654437, "comment_id": 78291838, "body": "You <i>might</i> have 2 SDKs installed, in different paths. Check <code>which gcloud</code> to see which one were you actually using."}], "owner": {"reputation": 107, "user_id": 7836768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550083c73775e651fe894122315a87df?s=128&d=identicon&r=PG&f=1", "display_name": "Kieran W.", "link": "https://stackoverflow.com/users/7836768/kieran-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502568248, "creation_date": 1502568248, "question_id": 45654437, "link": "https://stackoverflow.com/questions/45654437/total-confusion-about-which-path-to-use-for-golang-appengine-sdk", "title": "Total confusion about which path to use for GoLang AppEngine SDK", "body": "<p>I'm having trouble referencing the AppEngine SDK.</p>\n\n<p>After installing Google Cloud SDK, I'm using:</p>\n\n<pre><code>gcloud components install app-engine-go\n</code></pre>\n\n<p>to install the most recent version of the AppEngine SDK for Go, and afterwards I'm seeing 2 directories:</p>\n\n<p><code>/usr/local/google-cloud-sdk\n/Users/kieran/google-cloud-sdk</code></p>\n\n<p>The first contains the AppEngine SDK files, the second does not.</p>\n\n<p>In the PATH I'm seeing:</p>\n\n<p><code># The next line updates PATH for the Google Cloud SDK.\nif [ -f \u2018/Users/kieran/google-cloud-sdk/path.bash.inc' ]; then source '/Users/kieran/google-cloud-sdk/path.bash.inc'; fi</code></p>\n\n<p><code># The next line enables shell command completion for gcloud.\nif [ -f '/Users/kieran/google-cloud-sdk/completion.bash.inc' ]; then source '/Users/kieran/google-cloud-sdk/completion.bash.inc'; fi</code></p>\n\n<p>Why is the gcloud installer adding a reference in the PATH to the google-cloud-sdk that does not contain the AppEngine SDK ?</p>\n\n<p>I have read many different articles on here but they all mention a manually downloaded AppEngine SDK, and according to other articles even using \"google.golang.org/appengine\" is not good enough as it's not always the latest version.</p>\n\n<p>How do I reference the AppEngine SDK that was downloaded by the glcoud installer? With 2 different SDK paths I'm totally confused about which one to use, and even how to reference it in code. I would assume that \"appengine\" would be sufficient, but that isn't working.</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1502574823, "post_id": 45654383, "comment_id": 78268715, "body": "I hope that private key is not used in production..."}, {"owner": {"reputation": 660, "user_id": 580382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/eUpm4.jpg?s=128&g=1", "display_name": "smokedice", "link": "https://stackoverflow.com/users/580382/smokedice"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 1, "creation_date": 1502910211, "post_id": 45654383, "comment_id": 78400482, "body": "Nope, it is a test key :)"}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 3, "last_activity_date": 1502576087, "creation_date": 1502576087, "answer_id": 45655373, "question_id": 45654383, "link": "https://stackoverflow.com/questions/45654383/invalid-xmlns-value-after-marshalling-xml-when-using-goxmldsig/45655373#45655373", "title": "Invalid xmlns value after marshalling XML when using goxmldsig", "body": "<p>Your namespace is not correctly set. See also <a href=\"https://www.w3.org/XML/1998/namespace\" rel=\"nofollow noreferrer\">xml namespace</a></p>\n\n<p>Add the namespace here:</p>\n\n<pre><code>elementToSign := &amp;etree.Element{\n    Tag: \"ExampleElement\",\n    Space: \"xml\",\n}\nelementToSign.CreateAttr(\"ID\", \"id1234\")\n</code></pre>\n\n<p>With the added line it will pass validation. Tested with <a href=\"https://www.w3schools.com/xml/xml_validator.asp\" rel=\"nofollow noreferrer\">XML Validator</a></p>\n"}], "owner": {"reputation": 660, "user_id": 580382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/eUpm4.jpg?s=128&g=1", "display_name": "smokedice", "link": "https://stackoverflow.com/users/580382/smokedice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 45655373, "answer_count": 1, "score": 1, "last_activity_date": 1502576087, "creation_date": 1502567815, "question_id": 45654383, "link": "https://stackoverflow.com/questions/45654383/invalid-xmlns-value-after-marshalling-xml-when-using-goxmldsig", "title": "Invalid xmlns value after marshalling XML when using goxmldsig", "body": "<p>The code below weirdly adds an xmlns attribute to the root element when marshalling the XML. From what I have read the xmlns attribute should not be explicitly set. But the resulting XML includes the xmlns attribute:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ExampleElement xmlns=\"http://www.w3.org/XML/1998/namespace\" ID=\"id1234\"&gt;\n...\n</code></pre>\n\n<p>When attempting to validate the XML signature with XMLSecTool I receive the following error:</p>\n\n<blockquote>\n  <p>org.xml.sax.SAXParseException: The prefix \"xml\" cannot be bound to any\n  namespace other than its usual namespace; neither can the namespace\n  for \"xml\" be bound to any prefix other than \"xml\".</p>\n</blockquote>\n\n<p>Is there a valid xmlns attribute value I can use or am I using the libraries incorrectly?</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/rsa\"\n    \"crypto/tls\"\n    \"io/ioutil\"\n    \"log\"\n\n    \"github.com/beevik/etree\"\n    \"github.com/russellhaering/goxmldsig\"\n)\n\ntype X509KeyStore struct {\n    PrivateKey *rsa.PrivateKey\n    Cert       []byte\n}\n\nfunc (ks X509KeyStore) GetKeyPair() (*rsa.PrivateKey, []byte, error) {\n    return ks.PrivateKey, ks.Cert, nil\n}\n\nfunc failOnError(err error, msg string) {\n    if err != nil {\n        log.Fatalf(\"%s: %s\", msg, err)\n    }\n}\n\nfunc main() {\n    certBytes := []byte(`-----BEGIN CERTIFICATE-----\nMIID3TCCAsWgAwIBAgIJAKMxnSbqmztEMA0GCSqGSIb3DQEBCwUAMIGEMQswCQYD\nVQQGEwJHQjETMBEGA1UECAwKQmlybWluZ2hhbTETMBEGA1UEBwwKQmlybWluZ2hh\nbTEOMAwGA1UECgwFVGFsaXMxDjAMBgNVBAsMBVRhbGlzMQ4wDAYDVQQDDAVUYWxp\nczEbMBkGCSqGSIb3DQEJARYMbXdAdGFsaXMuY29tMB4XDTE3MDgwODIxNTA0NFoX\nDTI3MDgwNjIxNTA0NFowgYQxCzAJBgNVBAYTAkdCMRMwEQYDVQQIDApCaXJtaW5n\naGFtMRMwEQYDVQQHDApCaXJtaW5naGFtMQ4wDAYDVQQKDAVUYWxpczEOMAwGA1UE\nCwwFVGFsaXMxDjAMBgNVBAMMBVRhbGlzMRswGQYJKoZIhvcNAQkBFgxtd0B0YWxp\ncy5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCfyQiwTxAbc6HJ\n6aB6NrmDYoVUBqWZ4njZyQqnhf0ZvpqGh8ppMiXjiuJjn72pJYHnOqRQNgJDNhAZ\nX5KtJ/YI4XbOruJU3TWX/KnGn7l8TJ5FFmnJWHohJ0f9/+uVv0hivRkSVUwh+q2e\nTpKNypNu2Kf8iiGW3dMOY1CYWxWnksM1xoaWKV3mWgMqRqcj4kyLT1t8UctOhKhg\nm04HPNTeFCkcmH3IuIiVAi3uVU+zDKec8+cxSHHmnm0iphm8jpT0OjNSGWt7F7+N\nNhIa2FOI+Lz6t+VU0WToWnB16qJIhMGcIGPZR7fp/di/0h9Huc+GJBNfbgdVEYiv\n7DuF28zzAgMBAAGjUDBOMB0GA1UdDgQWBBRjnMEGZsZR+cSX5/UJcwAZULsKijAf\nBgNVHSMEGDAWgBRjnMEGZsZR+cSX5/UJcwAZULsKijAMBgNVHRMEBTADAQH/MA0G\nCSqGSIb3DQEBCwUAA4IBAQBNrPOgLt1bZPO8283HddeASfzoVK40qqBP0HgLihja\nVvABPRkE2046lka6MSDXJTpbg9rMT/JDplWea4gCroD+UX79W/r2WBEHgJ63piq+\nwVFoxB4S8IgbQi2N5CEM/yLexWq9O2YDl7gemRc1EES01x64YBlBgHGpMvc6NyjD\necMdTmUAXgNTTGKlpistVRtArQHaqw3FJE3LfoyEx9fP0joA7Q5U7Z6pvveYXEHl\nfSoCeI4UUPOlAGBOR5VWnDYuS+FwB9RIcegycxB12Sd+RLxojpFg6VSk2SSiG9/4\nu02uKxgXiZ7/41lHjoTHS9BOoPOT0ZD8C7Goeg8OAMgs\n-----END CERTIFICATE-----`)\n\n    keyBytes := []byte(`-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAn8kIsE8QG3Ohyemgeja5g2KFVAalmeJ42ckKp4X9Gb6ahofK\naTIl44riY5+9qSWB5zqkUDYCQzYQGV+SrSf2COF2zq7iVN01l/ypxp+5fEyeRRZp\nyVh6ISdH/f/rlb9IYr0ZElVMIfqtnk6SjcqTbtin/Iohlt3TDmNQmFsVp5LDNcaG\nlild5loDKkanI+JMi09bfFHLToSoYJtOBzzU3hQpHJh9yLiIlQIt7lVPswynnPPn\nMUhx5p5tIqYZvI6U9DozUhlrexe/jTYSGthTiPi8+rflVNFk6FpwdeqiSITBnCBj\n2Ue36f3Yv9IfR7nPhiQTX24HVRGIr+w7hdvM8wIDAQABAoIBADrEjdWKvrnaBZ9l\ntgg9KG4SRkdpSm8WxKwVLT4AId7eI6dnOiMGtrjB1BIgJnmXufd5sgVuV9awg6tR\nY3kcQXlys2fBGq1rztJfs3HCPU5iP7PZUn8jc4fOEsRw5AznlY/7TMVZae71a/XV\noEFWSHN0bBSOGVyLqZyZGoNuvMAsvZ7ObmfAddLQerPV0nOvv9X332wgo2a+8rnb\nNHqcZOLdmGjJRkBbAd0IHFciynb1YlhHIEObmZzD8LVFV0UxhhPDHbRwmrj1T2+j\nu9U3rBduJKG+mQxelLOLUB6CNbvcyNtj3wAnyq6IVA9qb/CLXJbEhTgnvNTLnYA3\nFJxZysECgYEAzw67MVhQY1VZnN49NiXhhl6ypVIlp3fKOUMMZVgiUeSDPSs4Un9q\nABoFBHT9x/Rs6repl/Yr6V3o8uWz/7V7yArom9/yhErunW8bORfiGVUqibYIKi51\nqNJMpamQGI/Uw2AbKCjKhpnCcRjt0YTfuTWXxAxOPYNJZqXEvUaUoNUCgYEAxY3P\nH07aR2zTDfjvddG2eieaMLoaTWSuGTUH1P7KplQHEsoE135PyLayzYy5I2HX+JDn\nfUDDWXWeI4+NdGdUnRrXOedr/Rewu8RZFxxqBV0TJhmTJzGpoun08YXkj7CBCs60\nfaohJS5iSpi39XNf2k5/RJHGm2FePfPYQR7sWqcCgYEAx6LYcZdIyr18DXdpZU/Y\nxgmADU3K6FDjNZqj1QLI9FRzBQMq5r/aoAZ2V/nExomwig5TAiVj6TmWZLt8dUux\n8QozhDbESTFGJ5z8jmusn+gxf113OdRZtVAufnuiZ0wmQ8nh5TKPMoAFra3vfley\nrYwyq9+BgGWY29NwgV4P55ECgYB5ThRqkw6xYP9PyxWu8PDtnTeux/eyoinNTKTc\ngv+Ilnwpa2cBs4vmIVk1oj1knoXxGXkrjgLmAbTy/QjM+04Xkg2qfpHuvQdGpNBX\nwpjPZlGFyZp0LKiPYr2HOMIaATWbn0VxDHCB1jOAvrnmu8uVzzGStziO3IDz5bFa\ne1SCbQKBgGNUKKppH7BYDMrb+dqRsB6YI5mFlHZoDhVWkPgDba8klp/NvhTI8ACu\nURVaPLlgTRdiG2Q5NVDYPpTrhsCbKwE6HeshNKqhL/VsrK77/oSpSQHeLf88oBV2\nrDFpN/In31Wp6c+C4crPQNSWZ9jMohHQkCFOUAyBc6UzcqCa4vqd\n-----END RSA PRIVATE KEY-----`)\n\n    keyPair, err := tls.X509KeyPair(certBytes, keyBytes)\n    if err != nil {\n        failOnError(err, \"invalided to load keypair\")\n    }\n    keyStore := dsig.TLSCertKeyStore(keyPair)\n\n    signingContext := dsig.NewDefaultSigningContext(keyStore)\n    signingContext.Canonicalizer = dsig.MakeC14N10ExclusiveCanonicalizerWithPrefixList(\"xml\")\n    if err = signingContext.SetSignatureMethod(dsig.RSASHA256SignatureMethod); err != nil {\n        failOnError(err, \"failed to set signature method\")\n    }\n\n    elementToSign := &amp;etree.Element{\n        Tag: \"ExampleElement\",\n    }\n    elementToSign.CreateAttr(\"ID\", \"id1234\")\n\n    signedAssertionEl, err := signingContext.SignEnveloped(elementToSign)\n    if err != nil {\n        failOnError(err, \"failed to sign envelop\")\n    }\n\n    var signedAssertionBuf []byte\n    {\n        doc := etree.NewDocument()\n        doc.CreateProcInst(\"xml\", `version=\"1.0\" encoding=\"UTF-8\"`)\n        doc.SetRoot(signedAssertionEl)\n        signedAssertionBuf, err = doc.WriteToBytes()\n        if err != nil {\n            failOnError(err, \"failed to convert doc to bytes\")\n        }\n    }\n\n    ioutil.WriteFile(\"/tmp/test/example.xml\", signedAssertionBuf, 0775)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1502569593, "post_id": 45653994, "comment_id": 78267375, "body": "Would it make sense to have a return statement like <code>return con.Close()</code> when an error maybe returned by Close()?  defer con.Close() would not allow any sort of error handling right."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1502569858, "post_id": 45653994, "comment_id": 78267446, "body": "@AnkitDeshpande Well, from your question, I would assume you would be done with the connection sometime before your long function finishes, at which point you would want to close the connection and release it to the pool. Given this assumption, wouldn&#39;t you rather just capture the err and test it like normal before continuing the function and only return if an error actually exists?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1502573192, "post_id": 45653994, "comment_id": 78268320, "body": "@AnkitDeshpande: You <i>can</i> return values from <code>defer</code> by using named return parameters and setting them in the defer function."}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 2, "last_activity_date": 1502565703, "last_edit_date": 1502565703, "creation_date": 1502565112, "answer_id": 45653994, "question_id": 45653916, "link": "https://stackoverflow.com/questions/45653916/defer-usage-in-case-of-long-running-functions/45653994#45653994", "title": "defer: usage in case of long running functions?", "body": "<p>In most cases <code>Close()</code> methods are idempotent and can be called more than once safely. You <code>defer con.Close()</code> in case of an error and/or early function return, but you are perfectly fine to explicitly call <code>Close()</code> as soon as you are done with it. So yes, it is best practice to use both when you have some long function.</p>\n"}, {"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 4, "last_activity_date": 1502566124, "creation_date": 1502566124, "answer_id": 45654144, "question_id": 45653916, "link": "https://stackoverflow.com/questions/45653916/defer-usage-in-case-of-long-running-functions/45654144#45654144", "title": "defer: usage in case of long running functions?", "body": "<p>My suggestion would be to refactor your code. This way a <code>defer</code> closes the connection <strong>before</strong> you process the result:</p>\n\n<pre><code>func dbQuery() error {\n    result, err := getResult()\n    if err != nil {\n        return err\n    }\n    // Processing the result takes a long time\n\n    return nil\n}\n\nfunc getResult() (*Rows, error) {\n    con := db.getConn()\n    defer con.close() // or con.close()\n\n    result, err := con.Query()\n    if err != nil {\n        return nil, err\n    }\n\n    return result, err\n}\n</code></pre>\n"}], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 45654144, "answer_count": 2, "score": 0, "last_activity_date": 1502567552, "creation_date": 1502564655, "question_id": 45653916, "link": "https://stackoverflow.com/questions/45653916/defer-usage-in-case-of-long-running-functions", "title": "defer: usage in case of long running functions?", "body": "<p>Here is a sample function that takes a connection to the database from the connection pool and does a query and processes the result returned.</p>\n\n<pre><code>func dbQuery() error {\n    con := db.getConn()\n    result, err := con.Query()\n    if err != nil {\n       return err\n    }\n    defer con.close() // or con.close()\n    // Processing the result takes a long time\n\n\n    return nil\n}\n</code></pre>\n\n<p>Processing the result in this case takes a long time and close is not called for the connection, which means it is not returned to the connection pool.<br> Is it ok to directly call con.close() in cases like this when we know the resources are held for a long time even when they are not needed?</p>\n"}, {"tags": ["json", "go", "multidimensional-array"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1502562460, "post_id": 45653222, "comment_id": 78265384, "body": "<a href=\"https://gobyexample.com/json\" rel=\"nofollow noreferrer\">gobyexample.com/json</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1502611866, "post_id": 45653222, "comment_id": 78274727, "body": "You can structure it however you want. What problem are you trying to solve?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8379039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5585DI5xOo8/AAAAAAAAAAI/AAAAAAAACXY/1n50_01F2kY/photo.jpg?sz=128", "display_name": "Pablo Romero", "link": "https://stackoverflow.com/users/8379039/pablo-romero"}, "edited": false, "score": 0, "creation_date": 1502720355, "post_id": 45654290, "comment_id": 78310916, "body": "I did not know how to access the data and thought it had to be done through a structure. Your answer helped me with what I was looking for  fmt.Println(f[0][0][&quot;client&quot;])      -----&gt;  321 fmt.Println(f[1][0][&quot;number&quot;])  -----&gt;3123  Thank&#39;s a lot!"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1502567239, "creation_date": 1502567239, "answer_id": 45654290, "question_id": 45653222, "link": "https://stackoverflow.com/questions/45653222/how-can-i-structure-the-interface/45654290#45654290", "title": "How can I structure the interface?", "body": "<p>Is this what you are looking for?</p>\n\n<p>You can test the code <a href=\"https://play.golang.org/p/Qx3hkUR6vu\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n    // test input (json.Unmarshal expects []byte)\n    b := []byte(\"[[{\\\"client\\\": \\\" 321\\\"}], [{\\\"number\\\": \\\"3123\\\"}]]\")\n\n    // declare the target variable in the correct format\n    var f [][]map[string]string\n\n    // unmarshal the json\n    err := json.Unmarshal(b, &amp;f)\n    if err != nil {\n        // handle error\n        log.Fatal(err)\n    }\n\n    // output result\n    fmt.Println(f)\n}\n</code></pre>\n\n<p>For details see the comments in the code. Feel free to ask.</p>\n"}], "owner": {"reputation": 21, "user_id": 8379039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5585DI5xOo8/AAAAAAAAAAI/AAAAAAAACXY/1n50_01F2kY/photo.jpg?sz=128", "display_name": "Pablo Romero", "link": "https://stackoverflow.com/users/8379039/pablo-romero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1502655586, "accepted_answer_id": 45654290, "answer_count": 1, "score": -5, "last_activity_date": 1502569915, "creation_date": 1502560179, "last_edit_date": 1502569915, "question_id": 45653222, "link": "https://stackoverflow.com/questions/45653222/how-can-i-structure-the-interface", "closed_reason": "Needs details or clarity", "title": "How can I structure the interface?", "body": "<p>I have this json array and I need to extract the data:</p>\n\n<pre><code>b := [[{\"client\": \" 321\"}], [{\"number\": \"3123\"}]]\n</code></pre>\n\n<p>How can I structure the interface?</p>\n\n<pre><code>var f interface{}\nerr := json.Unmarshal(b, &amp;f)\n\nf = map[string]interface{}{\n\n----&gt; ?\n\n}\n</code></pre>\n"}, {"tags": ["xml", "go", "xml-parsing", "unmarshalling"], "comments": [{"owner": {"reputation": 6303, "user_id": 4680436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yAD2X.jpg?s=128&g=1", "display_name": "aristotll", "link": "https://stackoverflow.com/users/4680436/aristotll"}, "edited": false, "score": 2, "creation_date": 1502556846, "post_id": 45652717, "comment_id": 78263700, "body": "Use  <code>&amp;gt;</code> or <code>&amp;lt;</code>"}, {"owner": {"reputation": 13, "user_id": 8455464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e968b2276381590b7f60346efb85ce?s=128&d=identicon&r=PG&f=1", "display_name": "dkh", "link": "https://stackoverflow.com/users/8455464/dkh"}, "reply_to_user": {"reputation": 6303, "user_id": 4680436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yAD2X.jpg?s=128&g=1", "display_name": "aristotll", "link": "https://stackoverflow.com/users/4680436/aristotll"}, "edited": false, "score": 0, "creation_date": 1502557132, "post_id": 45652717, "comment_id": 78263772, "body": "The problem is I can&#39;t change the strings.. Is it possible? or i need to rebuild the strings i got?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 2, "creation_date": 1502560010, "post_id": 45652717, "comment_id": 78264646, "body": "If you can&#39;t change the strings, then you have XML that isn&#39;t well-formed (and won&#39;t parse properly). XML is very strict about how parsing works. The <code>&lt;</code> and <code>&amp;</code> characters (at minimum) should have been escaped as <code>&amp;lt;</code> and <code>&amp;amp;</code> in the string respectively. You can also wrap it in a <code>CDATA</code> section, like <code>&lt;![CDATA[Fresh Fruit &lt;Fruit Shop&gt;]]&gt;</code>, though escaping the <code>&lt;</code> and <code>&amp;</code> (and related chars) is often preferred, unless you want <code>CDATA</code> sections in every shop name for the relatively few instances such chars. If HTML compatibility matters, you might also prefer <code>&amp;#x27;</code> instead of <code>&amp;apos;</code>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1502562567, "post_id": 45652717, "comment_id": 78265417, "body": "<a href=\"https://godoc.org/encoding/xml#EscapeText\" rel=\"nofollow noreferrer\">godoc.org/encoding/xml#EscapeText</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8455464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e968b2276381590b7f60346efb85ce?s=128&d=identicon&r=PG&f=1", "display_name": "dkh", "link": "https://stackoverflow.com/users/8455464/dkh"}, "edited": false, "score": 0, "creation_date": 1502602472, "post_id": 45655153, "comment_id": 78272717, "body": "So, I need to rebuild the string. Well, It&#39;s work for now... Thanksss"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 1, "last_activity_date": 1502574659, "last_edit_date": 1502574659, "creation_date": 1502573916, "answer_id": 45655153, "question_id": 45652717, "link": "https://stackoverflow.com/questions/45652717/how-to-get-and-in-xml-string/45655153#45655153", "title": "How to get &#39;&lt;&#39; and &#39;&gt;&#39; in XML string?", "body": "<p>The input you have is definitely invalid XML. There is a bug in the creation routine of the XML.</p>\n\n<h3>Idea</h3>\n\n<p>Since you say you have to deal with it the way it is... here a suggestion:</p>\n\n<ol>\n<li>replace all closing tags via regex to something you will basically never have in your input (e.g. <code>@#lt#@/tagname@#gt#@</code>). While doing that save all the distinct tag names to a slice.</li>\n<li>With the slice of tag names replace the start tags</li>\n<li>Now escape all remaining <code>&lt;</code> and <code>&gt;</code></li>\n<li>Last but not least replace the original tags back: <code>@#lt#@</code> to <code>&lt;</code> and <code>@#gt#@</code> to <code>&gt;</code></li>\n</ol>\n\n<p>Now you should have valid xml that is parseable.</p>\n\n<h3>Proof of Concept</h3>\n\n<p><a href=\"https://play.golang.org/p/Ht_Igi67kX\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"log\"\n    \"regexp\"\n    \"sort\"\n)\n\nvar (\n    rlt = []byte(\"@#lt#@\")\n    rgt = []byte(\"@#gt#@\")\n    lt  = []byte(\"&amp;lt;\")\n    gt  = []byte(\"&amp;gt;\")\n)\n\n// used for sorting strings by length\ntype ByLength []string\n\nfunc (s ByLength) Len() int {\n    return len(s)\n}\nfunc (s ByLength) Swap(i, j int) {\n    s[i], s[j] = s[j], s[i]\n}\nfunc (s ByLength) Less(i, j int) bool {\n    return len(s[i]) &lt; len(s[j])\n}\n\nfunc main() {\n    s := `&lt;Shop&gt;\n    &lt;ShopName&gt;Fresh Fruit &lt;Fruit Shop&gt;&lt;/ShopName&gt;\n    &lt;ShopName attr=\"val1\"&gt;Fresh Fruit &lt;Shop test&gt;&lt;/ShopName&gt;\n&lt;/Shop&gt;`\n\n    r1, err := regexp.Compile(\"&lt;/([^&lt;&gt;]*)&gt;\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    names := []string{}\n    out := r1.ReplaceAllFunc([]byte(s), func(b []byte) []byte {\n        name := b[2 : len(b)-1]\n\n        // TODO: only append name if not already in list\n        names = append(names, string(name))\n\n        // probably optimizable\n        bytes := make([]byte, 0, len(name)+12)\n        bytes = append(bytes, rlt...)\n        bytes = append(bytes, name...)\n        bytes = append(bytes, rgt...)\n        return bytes\n    })\n\n    // sort names descending by length otherwise we risk replacing parts of names like with &lt;Shop and &lt;ShopName\n    sort.Sort(sort.Reverse(ByLength(names)))\n\n    for _, name := range names {\n        // replace only exact start tags\n        out = bytes.Replace(out, []byte(fmt.Sprintf(\"&lt;%s&gt;\", name)), []byte(fmt.Sprintf(\"@#lt#@%s@#gt#@\", name)), -1)\n\n        // replace start tags with attributes\n        r3, err := regexp.Compile(fmt.Sprintf(\"&lt;%s( [^&lt;&gt;=]+=\\\"[^&lt;&gt;]+)&gt;\", name))\n        if err != nil {\n            // handle error\n        }\n        out = r3.ReplaceAll(out, []byte(fmt.Sprintf(\"@#lt#@%s$1@#gt#@\", name)))\n    }\n\n    out = bytes.Replace(out, []byte{'&lt;'}, lt, -1)\n    out = bytes.Replace(out, []byte{'&gt;'}, gt, -1)\n\n    out = bytes.Replace(out, rlt, []byte{'&lt;'}, -1)\n    out = bytes.Replace(out, rgt, []byte{'&gt;'}, -1)\n\n    fmt.Println(string(out))\n}\n</code></pre>\n\n<h3>Notes</h3>\n\n<ol>\n<li>this is a proof of concept. This is not optimised for performance.</li>\n<li>you might still run into content that might not be escaped properly. Then you will need to further optimise. If there is something like this in the content it will be falsely considered a tag: <code>&lt;tagname&gt;</code> or <code>&lt;tagname something =\"something&gt;</code>. Therefore expect some xml to still to be invalid. Log invalid xml so you can improve the algorithm.</li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 8455464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e968b2276381590b7f60346efb85ce?s=128&d=identicon&r=PG&f=1", "display_name": "dkh", "link": "https://stackoverflow.com/users/8455464/dkh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 45655153, "answer_count": 1, "score": 1, "last_activity_date": 1502574659, "creation_date": 1502556633, "last_edit_date": 1502569943, "question_id": 45652717, "link": "https://stackoverflow.com/questions/45652717/how-to-get-and-in-xml-string", "title": "How to get &#39;&lt;&#39; and &#39;&gt;&#39; in XML string?", "body": "<p>Is it posible to get '&lt;' and '>' value in this XML string? I have problem with unmarshal, and I can't change the strings. Is there anyone who can help me in this? Here my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nfunc main() {\n    type Example struct {\n        XMLName xml.Name `xml:\"Shop\"`\n        ShopName  string `xml:\"ShopName\"`\n    }\n\n    myString1 := `&lt;Shop&gt; \n        &lt;ShopName&gt;Fresh Fruit &lt;Fruit Shop&gt;&lt;/ShopName&gt;\n    &lt;/Shop&gt;`\n\n    myString2 :=`&lt;Shop&gt; \n        &lt;ShopName&gt;Fresh Fruit &lt; Fruit Shop &gt;&lt;/ShopName&gt;\n    &lt;/Shop&gt;`\n\n    //example 1\n    var example1 Example\n    err := xml.Unmarshal([]byte(myString1), &amp;example1)\n    if err != nil {\n        fmt.Println(\"error: %example1\", err)\n    }else{\n        fmt.Println(example1.ShopName)\n    }       \n\n    //example 2\n    var example2 Example\n    err = xml.Unmarshal([]byte(myString2), &amp;example2)\n    if err != nil {\n        fmt.Printf(\"error: %example2\", err)\n        return\n    }else{\n        fmt.Println(example2.ShopName)\n    }\n}\n</code></pre>\n\n<p>I get an error bellow:</p>\n\n<pre><code>error: %example1 XML syntax error on line 2: attribute name without = in element\nerror: &amp;{%!e(string=expected element name after &lt;) %!e(int=2)}xample2\n</code></pre>\n\n<p>What I want to get:</p>\n\n<pre><code>Fresh Fruit &lt;Fruit Shop&gt;\nFresh Fruit &lt; Fruit Shop &gt;\n</code></pre>\n"}, {"tags": ["go", "go-interface"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 2, "creation_date": 1502562874, "post_id": 45652560, "comment_id": 78265538, "body": "So you aren&#39;t asking how to make it work, you are asking <b>why</b> it doesn&#39;t work? (btw <code>var foo Foo = &amp;Bar{}</code> works)"}], "answers": [{"comments": [{"owner": {"reputation": 1373, "user_id": 3012814, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/adc610ef7569a6cf322849d74eef8c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi2020", "link": "https://stackoverflow.com/users/3012814/sebi2020"}, "edited": false, "score": 0, "creation_date": 1586011901, "post_id": 45653717, "comment_id": 107970512, "body": "Nothing of this fails. I&#39;ve tested the code and it works like a charm."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 1373, "user_id": 3012814, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/adc610ef7569a6cf322849d74eef8c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi2020", "link": "https://stackoverflow.com/users/3012814/sebi2020"}, "edited": false, "score": 0, "creation_date": 1586106862, "post_id": 45653717, "comment_id": 107998699, "body": "@Sebi2020 Uncomment line 18 and try again. It doesn&#39;t compile."}, {"owner": {"reputation": 1373, "user_id": 3012814, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/adc610ef7569a6cf322849d74eef8c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi2020", "link": "https://stackoverflow.com/users/3012814/sebi2020"}, "edited": false, "score": 0, "creation_date": 1586123305, "post_id": 45653717, "comment_id": 108004975, "body": "Oh sorry, my fault."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 1373, "user_id": 3012814, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/adc610ef7569a6cf322849d74eef8c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi2020", "link": "https://stackoverflow.com/users/3012814/sebi2020"}, "edited": false, "score": 0, "creation_date": 1586123547, "post_id": 45653717, "comment_id": 108005048, "body": "@Sebi2020 No worries. I probably should have left the example as uncommented so it was more clear where it would fail. Mixed feelings giving out a broken example though, haha. Guess that&#39;s the focus of this particular Q/A though."}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 3, "last_activity_date": 1502567251, "last_edit_date": 1502567251, "creation_date": 1502563365, "answer_id": 45653717, "question_id": 45652560, "link": "https://stackoverflow.com/questions/45652560/interfaces-and-pointer-receivers/45653717#45653717", "title": "Interfaces and pointer receivers", "body": "<p>The explanation lies in the fact that when dealing with the concrete struct itself, it has the proper information to handle this automatically. You can read <a href=\"https://gobyexample.com/methods\" rel=\"nofollow noreferrer\" title=\"here\">in the tour here</a> that:</p>\n\n<blockquote>\n  <p>Go automatically handles conversion between values and pointers for\n  method calls.</p>\n</blockquote>\n\n<p>But when you are dealing with an <code>interface{}</code> type, it has less information on what is actually contained in the variable. It just knows there is a <code>foo()</code> method. But there is a subtlety here that requires extra explanation so here is an example.</p>\n\n<p><a href=\"https://play.golang.org/p/Y0fJcAISw1\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Y0fJcAISw1</a></p>\n\n<pre><code>type Foo interface {\n    foo()\n}\ntype Bar struct {}\nfunc (b *Bar) foo() {}\n\ntype Baz struct {}\nfunc (b Baz) foo() {}\n\nfunc main() {\n    b := Bar{}\n    b.foo()\n\n    var v Foo = &amp;Bar{}\n    // v = Bar{} // fails\n    v.foo()\n\n    v = Baz{}\n    v.foo()\n    v = &amp;Baz{} // works too\n    v.foo()\n}\n</code></pre>\n\n<p>Notice that <code>&amp;Baz{}</code> works even though it has a value receiver, but not the reverse. The reason being that a <code>*Baz</code> points to exactly <strong>one</strong> <code>Baz</code>, both of which exist (the pointer and the value), so the value is easily obtained. When you try to do <code>v = Bar{}</code>, the value exists, but the pointer does not, and Go will not automatically create one for an <code>interface{}</code> value.</p>\n\n<p>This is all explained in detail under the <strong>Pointers and interfaces</strong> heading <a href=\"http://jordanorelli.com/post/32665860244/how-to-use-interfaces-in-go\" rel=\"nofollow noreferrer\">in this blog post</a></p>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1502565528, "post_id": 45653986, "comment_id": 78266371, "body": "Your answer uses more a definitive source than mine. Hope yours ends up accepted. Cheers!"}, {"owner": {"reputation": 71, "user_id": 6021980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33eaa37f14ba590b0832cef93f66509?s=128&d=identicon&r=PG", "display_name": "Elvis Attro", "link": "https://stackoverflow.com/users/6021980/elvis-attro"}, "edited": false, "score": 0, "creation_date": 1611190295, "post_id": 45653986, "comment_id": 116374365, "body": "This should definitely be the accepted answer!"}], "tags": [], "owner": {"reputation": 1836, "user_id": 1574034, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e5ec2a91be754c20903349048d16ed2a?s=128&d=identicon&r=PG", "display_name": "Naveen Ramanathan", "link": "https://stackoverflow.com/users/1574034/naveen-ramanathan"}, "is_accepted": false, "score": 15, "last_activity_date": 1502565389, "last_edit_date": 1502565389, "creation_date": 1502565071, "answer_id": 45653986, "question_id": 45652560, "link": "https://stackoverflow.com/questions/45652560/interfaces-and-pointer-receivers/45653986#45653986", "title": "Interfaces and pointer receivers", "body": "<p>Short answer <code>var foo Foo = Bar{}</code> is not working because the concrete value stored in an interface is not addressable.</p>\n\n<p><strong>Longer Version</strong></p>\n\n<p>Please read <a href=\"https://github.com/golang/go/wiki/MethodSets\" rel=\"noreferrer\">https://github.com/golang/go/wiki/MethodSets</a></p>\n\n<blockquote>\n  <p>It is legal to call a pointer-valued method on anything that is\n  already a pointer or whose address can be taken. It is legal to call a\n  value method on anything which is a value or whose value can be\n  dereferenced.</p>\n</blockquote>\n\n<p>With respect to the above explanation, your code</p>\n\n<pre><code>b := Bar{}\nb.foo()\n</code></pre>\n\n<p>works because <code>b</code> is addressable.</p>\n\n<blockquote>\n  <p>The concrete value stored in an interface is not addressable.\n  Therefore, when you call a method on an interface, it must either have\n  an identical receiver type or it must be directly discernible from the\n  concrete type: pointer- and value-receiver methods can be called with\n  pointers and values respectively, as you would expect. Value-receiver\n  methods can be called with pointer values because they can be\n  dereferenced first. Pointer-receiver methods cannot be called with\n  values, however, because the value stored inside an interface has no\n  address. When assigning a value to an interface, the compiler ensures\n  that all possible interface methods can actually be called on that\n  value, and thus trying to make an improper assignment will fail on\n  compilation.</p>\n</blockquote>\n\n<p>According to the above explanation the concrete value stored in an interface is not addressable and hence the code,</p>\n\n<pre><code>var foo Foo = Bar{}\n</code></pre>\n\n<p>will not work because the concrete value stored in an interface, in this case <code>Bar{}</code>, is not addressable. </p>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1502567097, "post_id": 45654151, "comment_id": 78266802, "body": "I&#39;m not being demeaning to your answer at all, or suggesting a change, but this is probably way above someone referring to themselves as a newbie gopher. I love that we now have 3 answers of varying depths of explanation."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 2, "last_activity_date": 1502566152, "creation_date": 1502566152, "answer_id": 45654151, "question_id": 45652560, "link": "https://stackoverflow.com/questions/45652560/interfaces-and-pointer-receivers/45654151#45654151", "title": "Interfaces and pointer receivers", "body": "<p>Half of your question depends on whether your value is addressable or not:</p>\n\n<blockquote>\n  <p>For an operand <code>x</code> of type <code>T</code>, the address operation <code>&amp;x</code> generates a\n  pointer of type <code>*T</code> to <code>x</code>. The operand must be addressable, that is,\n  either:</p>\n  \n  <ul>\n  <li>a variable,</li>\n  <li>pointer indirection, or</li>\n  <li>slice indexing operation; or</li>\n  <li>a field selector of an addressable struct operand; or</li>\n  <li>an array indexing operation of an addressable array.</li>\n  </ul>\n  \n  <p>As an exception to the addressability requirement, <code>x</code> may also be a\n  (possibly parenthesized) composite literal.</p>\n  \n  <p>&mdash; <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">Address operators</a></p>\n</blockquote>\n\n<p><code>Bar{}</code> is a composite literal, thus it is not addressable. You may type <code>&amp;Bar{}</code> to create an object of type <code>*Bar</code>, but that is listed as \"an exception to the addressability requirement\", reinforcing the idea that <code>Bar{}</code> is not addressable in itself.</p>\n\n<p>Variable <code>b</code> of type <code>Bar</code> can invoke <code>b.foo()</code> despite <code>Bar.foo()</code> requiring a pointer receiver for a good reason:</p>\n\n<blockquote>\n  <p>A method call <code>x.m()</code> is valid if the method set of (the type of) <code>x</code>\n  contains <code>m</code> and the argument list can be assigned to the parameter\n  list of <code>m</code>. <strong>If <code>x</code> is addressable and <code>&amp;x</code>'s method set contains <code>m</code>,\n  <code>x.m()</code> is shorthand for <code>(&amp;x).m()</code></strong></p>\n  \n  <p>&mdash; <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Calls</a></p>\n</blockquote>\n\n<p>However, that does not mean <code>Bar.foo()</code> is in the method set of <code>b</code>. This is because <code>b</code> has type <code>Bar</code> while <code>Bar.foo()</code> receives a value of type <code>*Bar</code>:</p>\n\n<blockquote>\n  <p>A type may have a method set associated with it. The method set of an\n  interface type is its interface. The method set of any other type <code>T</code>\n  consists of all methods declared with receiver type <code>T</code>. The method\n  set of the corresponding pointer type <code>*T</code> is the set of all methods\n  declared with receiver <code>*T</code> or <code>T</code> (that is, it also contains the\n  method set of <code>T</code>).</p>\n  \n  <p>&mdash; from <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">Method sets</a></p>\n</blockquote>\n\n<p>Because the method sets of <code>b</code> and the <code>Foo</code> interface differ, you cannot use  <code>var foo Foo = b</code>, despite <code>b.foo()</code> being converted to <code>(&amp;b).foo()</code> by the compiler. Otherwise, <code>var foo Foo = Bar{}</code> would work. You may, however, use either of the following since <code>Bar.foo()</code> receives a <code>*Bar</code>:</p>\n\n<pre><code>var foo Foo = &amp;b\nvar foo Foo = &amp;Bar{}\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 8455466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4686ebd9a59c623e5520001c7d2b9d70?s=128&d=identicon&r=PG&f=1", "display_name": "gopher", "link": "https://stackoverflow.com/users/8455466/gopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6486, "favorite_count": 3, "answer_count": 3, "score": 12, "last_activity_date": 1502570064, "creation_date": 1502555558, "last_edit_date": 1502570064, "question_id": 45652560, "link": "https://stackoverflow.com/questions/45652560/interfaces-and-pointer-receivers", "title": "Interfaces and pointer receivers", "body": "<p>I am newbie gopher and trying to get my head around the pointer receivers and interfaces. </p>\n\n<pre><code>type Foo interface {\n    foo()\n}\ntype Bar struct {}\nfunc (b *Bar) foo() {}\n</code></pre>\n\n<p>based on the above definitions..</p>\n\n<pre><code>--- Allowed ---------\nb := Bar{}\nb.foo()\n\n--- Not allowed ----- \n\nvar foo Foo = Bar{}\n</code></pre>\n\n<p>Get compiler error:\ncannot use Bar literal (type Bar) as type Foo in assignment:\n    Bar does not implement Foo (foo method has pointer receiver)</p>\n\n<p>I understand that compiler is doing some pointer conversion and de-referencing on our behalf in the first scenario. Why doesn't it do the same thing in the second scenario ?</p>\n"}, {"tags": ["go", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "is_accepted": false, "score": 1, "last_activity_date": 1502552868, "creation_date": 1502552868, "answer_id": 45652147, "question_id": 45651811, "link": "https://stackoverflow.com/questions/45651811/why-use-grpclog-package/45652147#45652147", "title": "Why use grpclog package", "body": "<p>This package forces the logger to only go to verbose level 2 per <a href=\"https://godoc.org/google.golang.org/grpc/grpclog\" rel=\"nofollow noreferrer\">grpclog</a></p>\n\n<pre><code>// All logs in transport package only go to verbose level 2.\n// All logs in other packages in grpc are logged in spite of the verbosity level.\n</code></pre>\n"}], "owner": {"reputation": 722, "user_id": 3072751, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/8J58M.jpg?s=128&g=1", "display_name": "thurt", "link": "https://stackoverflow.com/users/3072751/thurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1502552868, "creation_date": 1502551050, "question_id": 45651811, "link": "https://stackoverflow.com/questions/45651811/why-use-grpclog-package", "title": "Why use grpclog package", "body": "<p>I'm looking at  the grpc example for go <a href=\"https://grpc.io/docs/tutorials/basic/go.html\" rel=\"nofollow noreferrer\">https://grpc.io/docs/tutorials/basic/go.html</a>\nI\u2019m wondering whats the purpose of grpclog package? the example client/server code uses grpclog.Printf, grpclog.Fatalf. why not just use fmt.Printf &amp; log.Fatalf?</p>\n"}, {"tags": ["go", "threadpool", "channel", "worker"], "answers": [{"comments": [{"owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1502549523, "post_id": 45651488, "comment_id": 78261435, "body": "Ahhhh. I knew I was missing something. Appreciate your input ! This seems a little convoluted (am sure it works just fine). Is there a better more straightforward way to implement worker thread pools ?"}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "reply_to_user": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1502550082, "post_id": 45651488, "comment_id": 78261604, "body": "Frankly speaking, I can&#39;t get a more straightforward way. But, the implementation in the example is really a &#39;Go&#39; way"}], "tags": [], "owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1502549013, "creation_date": 1502549013, "answer_id": 45651488, "question_id": 45651387, "link": "https://stackoverflow.com/questions/45651387/worker-thread-pool/45651488#45651488", "title": "Worker thread pool", "body": "<p>if you read the code of worker carefully, you will notice</p>\n\n<pre><code>w.WorkerPool &lt;- w.JobChannel\n</code></pre>\n\n<p>each time a loop begin, the channel of worker itself has been put back</p>\n\n<p>I copy the whole function below:</p>\n\n<pre><code>func (w Worker) Start() {\n    go func() {\n        for {\n            // register the current worker into the worker queue.\n            w.WorkerPool &lt;- w.JobChannel\n\n            select {\n            case job := &lt;-w.JobChannel:\n                // we have received a work request.\n                if err := job.Payload.UploadToS3(); err != nil {\n                    log.Errorf(\"Error uploading to S3: %s\", err.Error())\n                }\n\n            case &lt;-w.quit:\n                // we have received a signal to stop\n                return\n            }\n        }\n    }()\n}\n</code></pre>\n"}], "owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1155, "favorite_count": 0, "accepted_answer_id": 45651488, "answer_count": 1, "score": 1, "last_activity_date": 1545996302, "creation_date": 1502548224, "last_edit_date": 1502570038, "question_id": 45651387, "link": "https://stackoverflow.com/questions/45651387/worker-thread-pool", "title": "Worker thread pool", "body": "<p>In the example provided at <a href=\"http://marcio.io/2015/07/handling-1-million-requests-per-minute-with-golang/\" rel=\"nofollow noreferrer\">http://marcio.io/2015/07/handling-1-million-requests-per-minute-with-golang/</a> which has been cited in a lot of places.</p>\n\n<pre><code>func (d *Dispatcher) dispatch() {\nfor {\n    select {\n    case job := &lt;-JobQueue:\n        // a job request has been received\n        go func(job Job) {\n            // try to obtain a worker job channel that is available.\n            // this will block until a worker is idle\n            jobChannel := &lt;-d.WorkerPool\n\n            // dispatch the job to the worker job channel\n            jobChannel &lt;- job\n         }(job)\n    }\n}\n}\n</code></pre>\n\n<p>Wouldn't the worker pool (chan chan job) get depleted after <code>MaxWorker</code> number of jobs have been serviced by the dispatch? Since <code>&lt;-d.WorkerPool</code> is pulling from the channel and job channels are not being replenished after the first type <code>dispatcher.Run()</code> is invoked the first time? Or am I missing/misreading something ? How is the WorkerPool getting replenished with available job channels ?</p>\n\n<pre><code>go func(job Job) {\n            // try to obtain a worker job channel that is available.\n            // this will block until a worker is idle\n            jobChannel := &lt;-d.WorkerPool\n\n            // dispatch the job to the worker job channel\n            jobChannel &lt;- job\n        }(job)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1502567271, "post_id": 45651002, "comment_id": 78266856, "body": "Work through the Tour of Go and focus on <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/1</a> ff."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6083474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787b24d2809674447f8b5983d5e47837?s=128&d=identicon&r=PG&f=1", "display_name": "luoyhang003", "link": "https://stackoverflow.com/users/6083474/luoyhang003"}, "edited": false, "score": 0, "creation_date": 1502545843, "post_id": 45651036, "comment_id": 78260394, "body": "if there is a fucntion: func (u user) notify{......}, <code>mike.notify()</code>and<code>lisa.notify()</code>and<code>(*lisa).notify()</code>are the same?"}, {"owner": {"reputation": 5723, "user_id": 3861083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt392.jpg?s=128&g=1", "display_name": "Fabian Lauer", "link": "https://stackoverflow.com/users/3861083/fabian-lauer"}, "reply_to_user": {"reputation": 7, "user_id": 6083474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787b24d2809674447f8b5983d5e47837?s=128&d=identicon&r=PG&f=1", "display_name": "luoyhang003", "link": "https://stackoverflow.com/users/6083474/luoyhang003"}, "edited": false, "score": 1, "creation_date": 1502551498, "post_id": 45651036, "comment_id": 78262089, "body": "@luoyhang003 Yup, &quot;automatic dereferencing&quot;: <a href=\"https://stackoverflow.com/a/13533822/3861083\">stackoverflow.com/a/13533822/3861083</a>"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 1, "last_activity_date": 1502545861, "last_edit_date": 1502545861, "creation_date": 1502545787, "answer_id": 45651036, "question_id": 45651002, "link": "https://stackoverflow.com/questions/45651002/what-is-the-difference-between-the-following-two-ways-to-initialize-the-user-var/45651036#45651036", "title": "What is the difference between the following two ways to initialize the user variable?", "body": "<p>Variable <code>mike</code> is a variable of type <code>user</code> while <code>lisa</code> is a pointer, the type is <code>*user</code>.</p>\n\n<p>Expression <code>&amp;user{\u2026}</code> means <em>take a pointer to a new user object</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 1769, "user_id": 3151330, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/osBeZ.jpg?s=128&g=1", "display_name": "manikawnth", "link": "https://stackoverflow.com/users/3151330/manikawnth"}, "is_accepted": false, "score": 0, "last_activity_date": 1502549713, "creation_date": 1502549713, "answer_id": 45651591, "question_id": 45651002, "link": "https://stackoverflow.com/questions/45651002/what-is-the-difference-between-the-following-two-ways-to-initialize-the-user-var/45651591#45651591", "title": "What is the difference between the following two ways to initialize the user variable?", "body": "<p>There is no difference in initializing the instance user struct.<br />\nThere's a big difference in how it is accessed in the target variable.</p>\n\n<ol>\n<li>Case 1, it copies the user struct value into the mike variable</li>\n<li>Case 2, it refers the user struct value using the lisa variable</li>\n</ol>\n\n<p>See this snippet:</p>\n\n<pre><code>type user struct {\n    name  string\n    email string\n}\n\nsomeuser := user{\"mike\", \"a@a.com\"}\nmike := someuser\nlisa := &amp;someuser\n\nsomeuser.name = \"hello\"\nfmt.Println(mike.name)    //name is not changed since user struct is copied\nfmt.Println(lisa.name)    //name is changed since user struct is referred\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6083474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787b24d2809674447f8b5983d5e47837?s=128&d=identicon&r=PG&f=1", "display_name": "luoyhang003", "link": "https://stackoverflow.com/users/6083474/luoyhang003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1502570019, "creation_date": 1502545578, "last_edit_date": 1502570019, "question_id": 45651002, "link": "https://stackoverflow.com/questions/45651002/what-is-the-difference-between-the-following-two-ways-to-initialize-the-user-var", "title": "What is the difference between the following two ways to initialize the user variable?", "body": "<p>I am a starter in Golang. This question may be very easy but it really confused me.</p>\n\n<p>if there is a User struct:</p>\n\n<pre><code>type user struct{\n    name string\n    email string\n}\n</code></pre>\n\n<p>What is the difference between the following two ways to initialize the user variable?</p>\n\n<pre><code>mike := user{\"mike\", \"mike@email.com\"}\nlisa := &amp;user{\"lisa\", \"lisa@email.com\"}\n</code></pre>\n"}, {"tags": ["go", "struct", "crud"], "answers": [{"comments": [{"owner": {"reputation": 512, "user_id": 1813664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hfn2Z.jpg?s=128&g=1", "display_name": "mkatanski", "link": "https://stackoverflow.com/users/1813664/mkatanski"}, "edited": false, "score": 0, "creation_date": 1502577048, "post_id": 45655266, "comment_id": 78269163, "body": "Hmm, thats a nice idea. Didn&#39;t thought about creating new type, but how can I pass it to the <code>GetList</code> method? In my example there is res of type <code>interface{}</code>. I cant make it <code>[]interface{}</code> and also cant check for example length of the result as it is not slice or array"}, {"owner": {"reputation": 512, "user_id": 1813664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hfn2Z.jpg?s=128&g=1", "display_name": "mkatanski", "link": "https://stackoverflow.com/users/1813664/mkatanski"}, "edited": false, "score": 0, "creation_date": 1502577374, "post_id": 45655266, "comment_id": 78269231, "body": "Ok, it is working ! I just made the <code>interface{}</code> type which holds given slice type. Removed also checking the length of slice. It cant be done this way. Probably I have to unmarshall it. Thanks for great answer !!"}], "tags": [], "owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1502575654, "last_edit_date": 1502575654, "creation_date": 1502575023, "answer_id": 45655266, "question_id": 45650875, "link": "https://stackoverflow.com/questions/45650875/generic-method-for-retrieving-list-of-models-structs/45655266#45655266", "title": "Generic method for retrieving list of models (structs)", "body": "<p>You can declare new types which represent slice of your models. For example,</p>\n\n<pre><code>type ModelAList []ModelA\ntype ModelBList []ModelB\n</code></pre>\n\n<p>Then when you pass variables of these new types into your <code>r.GetDocumentBySlug()</code>, the functions in the <code>encoding/json</code> package will unmarshal the slices accordingly.</p>\n\n<p>You can find working examples <a href=\"https://play.golang.org/p/MRz2vLJHGp\" rel=\"nofollow noreferrer\">here (marshaling)</a> and <a href=\"https://play.golang.org/p/H5ODIZIdWJ\" rel=\"nofollow noreferrer\">here (unmarshaling)</a>.</p>\n"}], "owner": {"reputation": 512, "user_id": 1813664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hfn2Z.jpg?s=128&g=1", "display_name": "mkatanski", "link": "https://stackoverflow.com/users/1813664/mkatanski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 45655266, "answer_count": 1, "score": 0, "last_activity_date": 1502575654, "creation_date": 1502544615, "last_edit_date": 1502570108, "question_id": 45650875, "link": "https://stackoverflow.com/questions/45650875/generic-method-for-retrieving-list-of-models-structs", "title": "Generic method for retrieving list of models (structs)", "body": "<p>I'm trying to create basic CRUD for my service. It is based on data models created in structs. The problem is that I really dont want to repeat code for CRUD methods. For example I have ModelA and ModelB defined as structs:</p>\n\n<pre><code>type ModelA struct {\n    ID              bson.ObjectId     `json:\"ID,omitempty\" bson:\"_id,omitempty\"`\n    Slug            string            `json:\"slug\" bson:\"slug,omitempty\"`\n    Creator         string            `json:\"-\" bson:\"creator,omitempty\"`\n    DefaultLanguage string            `json:\"defaultLanguage\" bson:\"defaultLanguage,omitempty\"`\n}\n\ntype ModelB struct {\n    ID              bson.ObjectId     `json:\"ID,omitempty\" bson:\"_id,omitempty\"`\n    Type            string            `json:\"type\" bson:\"type,omitempty\"`\n}\n</code></pre>\n\n<p>What I want is to make generic method which retrieves an array of given model. It is important for me to use models. I can do it quick with pure <code>interface{}</code> types but will loose model functionality, for example hiding some properties in JSON output (ex. <code>ModelA.Creator</code>).</p>\n\n<p>So far I've created generic methods for creating new data and retrieving single model. Here is example code:</p>\n\n<pre><code>// GET: /modelsa/{:slug}\nfunc (r *Routes) GetModelA(w rest.ResponseWriter, req *rest.Request) {\n    // set model as ModelA\n    var model models.ModelA\n    r.GetBySlug(w, req, &amp;model, \"models\")\n}\n\n// GET: /modelsb/{:slug}\nfunc (r *Routes) GetModelB(w rest.ResponseWriter, req *rest.Request) {\n    // set model as ModelB\n    var model models.ModelB\n    r.GetBySlug(w, req, &amp;model, \"models\")\n}\n\nfunc (r *Routes) GetBySlug(w rest.ResponseWriter, req *rest.Request, m interface{}, collection string) {\n    slug := req.PathParam(\"slug\")\n\n    if err := r.GetDocumentBySlug(slug, collection, m, w, req); err != nil {\n        rest.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    w.WriteJson(m)\n}\n</code></pre>\n\n<p><code>GetModelA</code> and <code>GetModelB</code> are route handlers which uses generic method <code>GetBySlug</code> that returns a JSON formatted by given model.</p>\n\n<p>I want to do the same but with the array of given models. So far I ve got problem to cast the result into the struct:</p>\n\n<pre><code>// GET /modelsa/\nfunc (r *Routes) GetModels(w rest.ResponseWriter, req *rest.Request) {\n    // I think in this case I don't have to pass an array of struct\n    // because the given struct is only reference. It could be:\n    // var result models.ModelA as well. Converting it into array could \n    // be done in GetList() method\n    var result []models.ModelA\n    r.GetList(w, req, &amp;result, \"models\")\n}\n\nfunc (r *Routes) GetList(w rest.ResponseWriter, req *rest.Request, res interface{}, col string) {\n\n}\n</code></pre>\n\n<p>I cant set <code>res</code> argument as an array of interface{}. Also I if i try to cast result to the <code>[]interface{}</code> within <code>GetList()</code> method, I cant then cast it to the <code>res</code> argument as it is not an array.</p>\n\n<p>Is there a nice way to do this? Maybe I think wrong and should redesign the methods? Any advice would be appreciated.</p>\n"}, {"tags": ["git", "go", "cygwin"], "comments": [{"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "edited": false, "score": 0, "creation_date": 1502544019, "post_id": 45648448, "comment_id": 78259853, "body": "<code>go</code> is not a cygwin program, so no surprise it does not understand POSIX path. Have you tried to run it from <code>CMD</code> ?"}, {"owner": {"reputation": 606, "user_id": 4257143, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q195EKev0qQ/AAAAAAAAAAI/AAAAAAAAAxM/R2bEEt98Yrc/photo.jpg?sz=128", "display_name": "Doug Henderson", "link": "https://stackoverflow.com/users/4257143/doug-henderson"}, "edited": false, "score": 0, "creation_date": 1502694179, "post_id": 45648448, "comment_id": 78295343, "body": "And you will need a windows or msys/mingw32 version of <code>git</code>. The cygwin and the windows versions of <code>git</code> can be made compatible using <code>git config</code> but you will still have problems with paths."}], "answers": [{"comments": [{"owner": {"reputation": 571, "user_id": 666886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b2ddab2e770f3c687da7fdbe8b014e?s=128&d=identicon&r=PG", "display_name": "philwalk", "link": "https://stackoverflow.com/users/666886/philwalk"}, "edited": false, "score": 0, "creation_date": 1529706872, "post_id": 46675855, "comment_id": 88986998, "body": "can you please amplify what you mean by &quot;in the git cmd&quot;?  thanks, the above doesn&#39;t fix the problem for me."}, {"owner": {"reputation": 55, "user_id": 11898878, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KKfAm-JPmj4/AAAAAAAAAAI/AAAAAAAAAAk/F99sJ0yJSpI/photo.jpg?sz=128", "display_name": "Taylor Belland", "link": "https://stackoverflow.com/users/11898878/taylor-belland"}, "edited": false, "score": 0, "creation_date": 1566705481, "post_id": 46675855, "comment_id": 101737563, "body": "I&#39;m guessing they mean using this program, <a href=\"https://gitforwindows.org/\" rel=\"nofollow noreferrer\">gitforwindows.org</a> Which comes with its own shell."}], "tags": [], "owner": {"reputation": 1, "user_id": 2836287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232bfa9699f7bcb0177c96a630cb4fdb?s=128&d=identicon&r=PG&f=1", "display_name": "user2836287", "link": "https://stackoverflow.com/users/2836287/user2836287"}, "is_accepted": false, "score": 0, "last_activity_date": 1507668877, "creation_date": 1507668877, "answer_id": 46675855, "question_id": 45648448, "link": "https://stackoverflow.com/questions/45648448/cygwin-uses-relative-and-absolute-path-for-environment-variables/46675855#46675855", "title": "Cygwin uses relative and absolute path for environment variables", "body": "<p>I think this comes if you have git both installed locally and in cygwin. For me it helped running the <code>go get</code> command in the git cmd</p>\n"}, {"tags": [], "owner": {"reputation": 2193, "user_id": 2856202, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AHuOz.png?s=128&g=1", "display_name": "eigenfield", "link": "https://stackoverflow.com/users/2856202/eigenfield"}, "is_accepted": false, "score": 0, "last_activity_date": 1535123742, "creation_date": 1535123742, "answer_id": 52007387, "question_id": 45648448, "link": "https://stackoverflow.com/questions/45648448/cygwin-uses-relative-and-absolute-path-for-environment-variables/52007387#52007387", "title": "Cygwin uses relative and absolute path for environment variables", "body": "<p>Although by using Windows' git-bash.exe is a work around, yet some might find it fundamental to stay in their cygwin environment. To make it work in cygwin, do this:</p>\n\n<p>Instead of:</p>\n\n<pre><code>go get -u -v github.com/golang/example/hello\n</code></pre>\n\n<p>You need to instead do it by:</p>\n\n<pre><code>git clone https://github.com/golang/example $(cygpath -u $GOPATH)/src/github.com/golang/example\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1585418943, "last_edit_date": 1585418943, "creation_date": 1548111018, "answer_id": 54298834, "question_id": 45648448, "link": "https://stackoverflow.com/questions/45648448/cygwin-uses-relative-and-absolute-path-for-environment-variables/54298834#54298834", "title": "Cygwin uses relative and absolute path for environment variables", "body": "<p>Try the same command with Git 2.21 (Q1 2019) installed.  </p>\n\n<p>See <a href=\"https://github.com/git/git/commit/1cadad6f658bfb3ab54b25dd04bac372253473b6\" rel=\"nofollow noreferrer\">commit 1cadad6</a> (15 Dec 2018) by <a href=\"https://github.com/tboegi\" rel=\"nofollow noreferrer\">Torsten B\u00f6gershausen (<code>tboegi</code>)</a>.<br>\nHelped-by: <a href=\"https://github.com/dscho\" rel=\"nofollow noreferrer\">Johannes Schindelin (<code>dscho</code>)</a>.<br>\n<sup>(Merged by <a href=\"https://github.com/gitster\" rel=\"nofollow noreferrer\">Junio C Hamano -- <code>gitster</code> --</a> in <a href=\"https://github.com/git/git/commit/25d90d1cb72ce51407324259516843406142fe89\" rel=\"nofollow noreferrer\">commit 25d90d1</a>, 14 Jan 2019)</sup>  </p>\n\n<blockquote>\n  <h2><code>git clone &lt;url&gt; C:\\cygwin\\home\\USER\\repo</code> is working (again)</h2>\n  \n  <p>A regression for cygwin users was introduced with <a href=\"https://github.com/git/git/commit/05b458c104708141d2fad211d79703b3b99cc5a8\" rel=\"nofollow noreferrer\">commit 05b458c, Git v2.12.0-rc0, Dec. 2012</a>, \"<code>real_path</code>: resolve symlinks by hand\".</p>\n</blockquote>\n\n<p>(See \"<a href=\"https://stackoverflow.com/a/41788645/6309\">How to <code>git grep</code> the main repository and all its submodules?</a>\" for more on that original commit)</p>\n\n<blockquote>\n  <p>In the the commit message we read:</p>\n  \n  <blockquote>\n    <p>The current implementation of real_path uses <code>chdir()</code> in order to resolve symlinks.  Unfortunately this isn't thread-safe as <code>chdir()</code> affects a process as a whole...</p>\n  </blockquote>\n  \n  <p>The old (and non-thread-save) OS calls <code>chdir()</code>/<code>pwd()</code> had been replaced by a string operation.<br>\n  The cygwin layer \"knows\" that \"<code>C:\\cygwin</code>\" is an absolute path, but the new string operation does not.</p>\n\n<pre><code>\"git clone &lt;url&gt; C:\\cygwin\\home\\USER\\repo\" fails like this:\nfatal: Invalid path '/home/USER/repo/C:\\cygwin\\home\\USER\\repo'\n</code></pre>\n</blockquote>\n\n<p>(which is an error message similar to what the OP mentions)</p>\n\n<blockquote>\n  <p>The solution is to implement <code>has_dos_drive_prefix()</code>, <code>skip_dos_drive_prefix()</code> <code>is_dir_sep()</code>, <code>offset_1st_component()</code> and <code>convert_slashes()</code> for cygwin\n  in the same way as it is done in 'Git for Windows' in <code>compat/mingw.[ch]</code>.</p>\n  \n  <p>Extract the needed code into <code>compat/win32/path-utils.[ch]</code> and use it for cygwin as well.</p>\n</blockquote>\n\n<hr>\n\n<p>Note: Git 2.22 (Q2 2019) further improves the command, as an earlier update for MinGW and Cygwin accidentally broke MSVC build, which has been fixed.</p>\n\n<p>See <a href=\"https://github.com/git/git/commit/22c3634c0f92662f995e1e97db7f65bb39352080\" rel=\"nofollow noreferrer\">commit 22c3634</a> (08 Apr 2019) by <a href=\"https://github.com/apotek\" rel=\"nofollow noreferrer\">Sven Strickroth (<code>apotek</code>)</a>.<br>\n<sup>(Merged by <a href=\"https://github.com/gitster\" rel=\"nofollow noreferrer\">Junio C Hamano -- <code>gitster</code> --</a> in <a href=\"https://github.com/git/git/commit/70542df56618f2766064384f7741c7e25bac1cfd\" rel=\"nofollow noreferrer\">commit 70542df</a>, 08 May 2019)</sup>  </p>\n\n<blockquote>\n  <h2>MSVC: include compat/win32/path-utils.h for MSVC, too, for real_path()</h2>\n  \n  <p>A path such as '<code>c:/somepath/submodule/../.git/modules/submodule</code>' wasn't\n  resolved correctly any more, because the *nix variant of <code>offset_1st_component</code> is used instead of the Win32 specific version.</p>\n  \n  <p>Regression was introduced in <a href=\"https://github.com/git/git/commit/1cadad6f658bfb3ab54b25dd04bac372253473b6\" rel=\"nofollow noreferrer\">commit 1cadad6</a> when <code>mingw_offset_1st_component</code> was moved from <code>mingw.c</code>, which is included by <code>msvc.c</code> to a separate file.<br>\n  Then, the new file \"<code>compat/win32/path-utils.h</code>\" was only included for the <code>__CYGWIN__</code> and <code>__MINGW32__</code> cases in <code>git-compat-util.h</code>, the case for <code>_MSC_VER</code> was missing.</p>\n</blockquote>\n\n<p>And:</p>\n\n<blockquote>\n  <h2><code>git clone &lt;url&gt; C:\\cygwin\\home\\USER\\repo</code> is working (again)</h2>\n  \n  <p>A regression for cygwin users was introduced with <a href=\"https://github.com/git/git/commit/05b458c104708141d2fad211d79703b3b99cc5a8\" rel=\"nofollow noreferrer\">commit 05b458c</a>, \"real_path: resolve symlinks by hand\", Dec. 2016, Git v2.12.0-rc0.</p>\n  \n  <p>In the the commit message we read:</p>\n  \n  <blockquote>\n    <p>The current implementation of real_path uses chdir() in order to resolve symlinks.<br>\n    Unfortunately this isn't thread-safe as chdir() affects a process as a whole...</p>\n  </blockquote>\n  \n  <p>The old (and non-thread-save) OS calls <code>chdir()</code>/<code>pwd()</code> had been\n  replaced by a string operation.<br>\n  The cygwin layer \"knows\" that \"<code>C:\\cygwin</code>\" is an absolute path,\n  but the new string operation does not.</p>\n  \n  <p>\"<code>git clone &lt;url&gt; C:\\cygwin\\home\\USER\\repo</code>\" fails like this:</p>\n\n<pre><code>fatal: Invalid path '/home/USER/repo/C:\\cygwin\\home\\USER\\repo'\n</code></pre>\n  \n  <p>The solution is to implement <code>has_dos_drive_prefix()</code>, <code>skip_dos_drive_prefix()</code> <code>is_dir_sep()</code>, <code>offset_1st_component()</code> and <code>convert_slashes()</code> for cygwin\n  in the same way as it is done in 'Git for Windows' in <code>compat/mingw.[ch]</code></p>\n  \n  <p>Extract the needed code into <code>compat/win32/path-utils.[ch]</code> and use it\n  for cygwin as well.</p>\n</blockquote>\n\n<hr>\n\n<p>Note: The <code>real_path()</code> convenience function can easily be misused; with a bit of code refactoring in the callers' side, its use has been eliminated, with Git 2.27 (Q2 2020).</p>\n\n<p>See <a href=\"https://github.com/git/git/commit/49d3c4b481f12c2ec655a71d5a5b9259a398d059\" rel=\"nofollow noreferrer\">commit 49d3c4b</a>, <a href=\"https://github.com/git/git/commit/4530a85b4c34f009b5f190eb2dc8367801de5028\" rel=\"nofollow noreferrer\">commit 4530a85</a>, <a href=\"https://github.com/git/git/commit/3d7747e318532a36a263c61cdf92f2decb6424ff\" rel=\"nofollow noreferrer\">commit 3d7747e</a> (10 Mar 2020), and <a href=\"https://github.com/git/git/commit/0915a5b4cdf00a8c6c755b77b854725a183993b4\" rel=\"nofollow noreferrer\">commit 0915a5b</a> (06 Mar 2020) by <a href=\"https://github.com/SyntevoAlex\" rel=\"nofollow noreferrer\">Alexandr Miloslavskiy (<code>SyntevoAlex</code>)</a>.<br>\n<sup>(Merged by <a href=\"https://github.com/gitster\" rel=\"nofollow noreferrer\">Junio C Hamano -- <code>gitster</code> --</a> in <a href=\"https://github.com/git/git/commit/4d0e8996ec54e53149c2f24075eb64921ca61812\" rel=\"nofollow noreferrer\">commit 4d0e899</a>, 25 Mar 2020)</sup>  </p>\n\n<blockquote>\n  <h2><a href=\"https://github.com/git/git/commit/3d7747e318532a36a263c61cdf92f2decb6424ff\" rel=\"nofollow noreferrer\"><code>real_path</code></a>: remove unsafe API</h2>\n  \n  <p><sup>Signed-off-by: Alexandr Miloslavskiy</sup></p>\n  \n  <p>Returning a shared buffer invites very subtle bugs due to reentrancy or multi-threading, as demonstrated by the previous patch.</p>\n  \n  <p>There was an <a href=\"https://lore.kernel.org/git/1480964316-99305-1-git-send-email-bmwill@google.com/\" rel=\"nofollow noreferrer\">unfinished effort to abolish this</a>.</p>\n  \n  <p>Let's finally rid of <code>real_path()</code>, using <code>strbuf_realpath()</code> instead.</p>\n  \n  <p>This patch uses a local <code>strbuf</code> for most places where <code>real_path()</code> was previously called.</p>\n  \n  <p>However, two places return the value of <code>real_path()</code> to the caller. For them, a <code>static</code> local <code>strbuf</code> was added, effectively pushing the problem one level higher:</p>\n\n<pre><code>read_gitfile_gently()\nget_superproject_working_tree()\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 765, "user_id": 1177899, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a9edc8c24c7bdd1d25ba20f81740bde8?s=128&d=identicon&r=PG", "display_name": "The Code Buccaneer", "link": "https://stackoverflow.com/users/1177899/the-code-buccaneer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 1, "answer_count": 3, "score": 9, "last_activity_date": 1585418943, "creation_date": 1502528459, "last_edit_date": 1536814288, "question_id": 45648448, "link": "https://stackoverflow.com/questions/45648448/cygwin-uses-relative-and-absolute-path-for-environment-variables", "title": "Cygwin uses relative and absolute path for environment variables", "body": "<p>When I use the below command in Cygwin:</p>\n\n<pre><code>$ go get github.com/gorilla/mux\n</code></pre>\n\n<p>I receive the below error:</p>\n\n<pre><code># cd .; git clone https://github.com/gorilla/mux C:\\cygwin64\\home\\USER\\Go\\src\\github.com\\gorilla\\mux\nCloning into 'C:\\cygwin64\\home\\USER\\Go\\src\\github.com\\gorilla\\mux'...\nfatal: Invalid path '/home/USER/C:\\cygwin64\\home\\USER\\Go\\src\\github.com\\gorilla\\mux': No such file or directory\npackage github.com/gorilla/mux: exit status 128\n</code></pre>\n\n<p>When I use the command:</p>\n\n<pre><code>cd $GOPATH\n</code></pre>\n\n<p>The correct folder opens.</p>\n\n<p>Does anyone how I can solve this?</p>\n"}, {"tags": ["database", "postgresql", "go", "sqlx"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 3, "last_activity_date": 1502531395, "creation_date": 1502531395, "answer_id": 45648864, "question_id": 45648262, "link": "https://stackoverflow.com/questions/45648262/can-you-retrieve-a-list-of-updated-rows-when-running-an-update-query-using-the-g/45648864#45648864", "title": "Can you retrieve a list of updated rows when running an UPDATE query using the Go sqlx package with Postgres?", "body": "<p>Use <a href=\"https://www.postgresql.org/docs/9.1/static/sql-update.html\" rel=\"nofollow noreferrer\">PostgreSQL's <code>RETURNING</code> clause</a> and <code>db.Query/db.Select</code> variants instead of <code>Exec</code>, e.g. </p>\n\n<pre><code>//get the primary key of updated rows\ndb := s.getDB(tx)\n\nresults := []int{}\nerr = db.Select(&amp;results, \"UPDATE mytable SET var_name = 0 WHERE var_name = 1 RETURNING id\")\n</code></pre>\n\n<p>To retrieve more than one columns, just list the column names after <code>RETURNING</code>, e.g.</p>\n\n<pre><code>rows, err := db.Queryx(\"UPDATE mytable SET var_name = 0 WHERE var_name = 1 RETURNING id,var_name,other_columns\")\nfor rows.Next() {\n    //do something with the result\n}\n</code></pre>\n"}], "owner": {"reputation": 712, "user_id": 6905609, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-pijalSU6uPM/AAAAAAAAAAI/AAAAAAAAAAo/CozZmL4o2KA/photo.jpg?sz=128", "display_name": "Ismail Khan", "link": "https://stackoverflow.com/users/6905609/ismail-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 780, "favorite_count": 0, "accepted_answer_id": 45648864, "answer_count": 1, "score": 2, "last_activity_date": 1502531395, "creation_date": 1502527030, "question_id": 45648262, "link": "https://stackoverflow.com/questions/45648262/can-you-retrieve-a-list-of-updated-rows-when-running-an-update-query-using-the-g", "title": "Can you retrieve a list of updated rows when running an UPDATE query using the Go sqlx package with Postgres?", "body": "<p>I have a query I'm running using Go's sqlx package (an extension to the standard database/sql package) with a Postgres database. It looks something like this:</p>\n\n<pre><code>result, err := s.getDB(tx).Exec(`\n    UPDATE table_name\n    SET var_name = 0\n    WHERE var_name = 1;`)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n\n<p>Without using a managed transaction, how can I retrieve the list of updated rows? Or at least a list of primary keys for the updated rows?</p>\n"}, {"tags": ["loops", "go"], "comments": [{"owner": {"reputation": 908, "user_id": 3649496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c95010d46812ccabe7eea947a090ab?s=128&d=identicon&r=PG&f=1", "display_name": "infiniteLearner", "link": "https://stackoverflow.com/users/3649496/infinitelearner"}, "edited": false, "score": 0, "creation_date": 1593510253, "post_id": 45647958, "comment_id": 110800139, "body": "Going off question , if you ever want to break infinite loop one way is using &quot;os.exit(0)&quot; . May it help users who are new to Golang."}], "answers": [{"comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1502525074, "post_id": 45647970, "comment_id": 78254481, "body": "(at the time of this writing, this is <a href=\"https://stackoverflow.com/questions/45137897/use-of-variable-in-for-loop-not-recognized-in-golang/45138077#45138077\">1/3 of my answers about Go</a>)"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1502525160, "post_id": 45647970, "comment_id": 78254505, "body": "@YvetteColomb: I knew it was a duplicate but wanted to give an explanation with a more complete code example."}, {"owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "edited": false, "score": 0, "creation_date": 1502525522, "post_id": 45647970, "comment_id": 78254609, "body": "I was under the impression that <code>:=</code> was smart enough to not redeclare variables already in scope in the case of a tuple where one entry is already in scope. Apparently I was wrong."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 5, "last_activity_date": 1502524989, "creation_date": 1502524989, "answer_id": 45647970, "question_id": 45647958, "link": "https://stackoverflow.com/questions/45647958/infinite-for-loop-in-golang/45647970#45647970", "title": "Infinite for loop in golang", "body": "<p>When you use <code>:=</code>, you declare new variables. An <code>s</code> is created inside the loop unrelated to the <code>s</code> outside it. Assign instead:</p>\n\n<pre><code>for len(s) != 0 {\n    j := len(s) - 1\n    <b>var top int\n    top, s = s[j], s[:j]</b>\n    fmt.Printf(\"top = %+v\\n\", top)\n    fmt.Printf(\"s = %+v\\n\", s)\n    fmt.Printf(\"len(s) = %+v\\n\", len(s))\n}</code></pre>\n"}], "owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2368, "favorite_count": 0, "closed_date": 1502525087, "accepted_answer_id": 45647970, "answer_count": 1, "score": 2, "last_activity_date": 1502524989, "creation_date": 1502524837, "question_id": 45647958, "link": "https://stackoverflow.com/questions/45647958/infinite-for-loop-in-golang", "closed_reason": "Duplicate", "title": "Infinite for loop in golang", "body": "<p>I'm new to Golang, but I would expect not to have issues with something as basic as this.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := make([]int, 0)\n    s = append(s, 1)\n    for len(s) != 0 {\n        j := len(s) - 1\n        top, s := s[j], s[:j]\n        fmt.Printf(\"top = %+v\\n\", top)\n        fmt.Printf(\"s = %+v\\n\", s)\n        fmt.Printf(\"len(s) = %+v\\n\", len(s))\n    }\n}\n</code></pre>\n\n<p>This command doesn't exit, it just prints</p>\n\n<pre><code>len(s) = 0\ntop = 1\ns = []\nlen(s) = 0\ntop = 1\ns = []\nlen(s) = ^C\n</code></pre>\n\n<p>I find this stunning; what am I doing wrong? Syntactically, based on <a href=\"https://tour.golang.org/flowcontrol/3\" rel=\"nofollow noreferrer\">https://tour.golang.org/flowcontrol/3</a>, everything seems OK.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": false, "score": 0, "last_activity_date": 1502514823, "creation_date": 1502514823, "answer_id": 45646757, "question_id": 45646518, "link": "https://stackoverflow.com/questions/45646518/comparing-columns-of-a-text-file/45646757#45646757", "title": "Comparing columns of a text file", "body": "<p>Use a map[string]string (e.g. mapName[computerName+fileName] = fileHashvalue, for each line check if the map entry exists for the given computer and file name (concatenated string - computerName + fileName) &amp; if so compare with the existing hash value) you can do this in just one range loop instead of two you are using now. Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5513113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317b1216883b6b7c816b3bbd568170c8?s=128&d=identicon&r=PG&f=1", "display_name": "MOHL-CLAUZADE Yannick", "link": "https://stackoverflow.com/users/5513113/mohl-clauzade-yannick"}, "is_accepted": false, "score": -1, "last_activity_date": 1502536253, "creation_date": 1502536253, "answer_id": 45649560, "question_id": 45646518, "link": "https://stackoverflow.com/questions/45646518/comparing-columns-of-a-text-file/45649560#45649560", "title": "Comparing columns of a text file", "body": "<p>on testViolation you has (i deleted google chrome entry to better visibility):</p>\n\n<pre><code>line0 =\nc:\\program files\\internetexplorer\\iexplore.exe;\n0f3c97716fed8b554a7ec0464d50719f;\ncomputer1\n\nline1:\nc:\\windows\\system32\\notepad.exe;\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA;\ncomputer1\n\nline2:\nc:\\program files\\internetexplorer\\iexplore.exe;\nBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB;\ncomputer1\n\nline3:\nc:\\windows\\system32\\notepad.exe;\nf60a9d3a9461f68de0fccebb0c6cb31a;\ncomputer1\n</code></pre>\n\n<p>On your loop:</p>\n\n<pre><code>for _, f := range lines {\n    splitLine = strings.Split(f, \";\")\n\n    for _, c := range lines {\n    // To f == line0, you match with c == line2\n    // To f == line1, you match with c == line3\n    // To f == line2, you match with c == line0\n    // To f == line3, you match with c == line1\n        checkLine := strings.Split(c, \";\")\n        if splitLine[0] == checkLine[0] &amp;&amp; splitLine[2] == checkLine[2] &amp;&amp; splitLine[1] != checkLine[1] {\n        // ...\n        }\n    }\n}\n</code></pre>\n\n<p>So, you need delete line when you find a match.\nit's not very sexy, but it's work</p>\n\n<p>more simply:\nI think, you sould build a map[\"string-untilFirst';'\"][]\"stringhash+computer\" on begin function.</p>\n\n<pre><code>// map[string][]string\n</code></pre>\n\n<p>So, just you count number element:</p>\n\n<pre><code>for _, v := range myMap {\n    if len(v) &gt; 1 {\n    // if you need compare computer you can split here or use:\n    // map[string]map[string][]string\n    // \"there are a diff on v[0] and v[1] * len(v)\"\n    }\n}\n</code></pre>\n\n<p>I hope help you ;)\nGood continuation on you project !</p>\n"}], "owner": {"reputation": 1, "user_id": 8453532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24845e2af4cd06d058f048ebebd3ab0d?s=128&d=identicon&r=PG&f=1", "display_name": "MarilL", "link": "https://stackoverflow.com/users/8453532/marill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1502536882, "creation_date": 1502512367, "last_edit_date": 1502536882, "question_id": 45646518, "link": "https://stackoverflow.com/questions/45646518/comparing-columns-of-a-text-file", "title": "Comparing columns of a text file", "body": "<p>I need some advice on this piece of code. I'm developing a application in Go to read the content of a file line by line and compare one specific column formed by a hash with others in the same file. I'm trying to catch different hashes to the same filename and get an alert that a file has been changed. </p>\n\n<p>Here's an example of the text file. Each line is formed by filename, hash and computer name:</p>\n\n<pre><code>c:\\program files\\internet explorer\\iexplore.exe;0f3c97716fed8b554a7ec0464d50719f;computer1\nc:\\program files (x86)\\google\\chrome\\application\\chrome.exe;d387a06cd4bf5fcc1b50c3882f41a44e;computer1\nc:\\windows\\system32\\notepad.exe;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA;computer1\nc:\\program files\\internet explorer\\iexplore.exe;BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB;computer1\nc:\\program files (x86)\\google\\chrome\\application\\chrome.exe;d387a06cd4bf5fcc1b50c3882f41a44e;computer1\nc:\\windows\\system32\\notepad.exe;f60a9d3a9461f68de0fccebb0c6cb31a;computer1\n</code></pre>\n\n<p>When running the code I'm getting the same information twice because I used two for. Obviously I just need one occurrence of each. Results:</p>\n\n<pre><code>go run main.go \nOriginal:   c:\\program files\\internet explorer\\iexplore.exe 0f3c97716fed8b554a7ec0464d50719f computer1\nViolation:  c:\\program files\\internet explorer\\iexplore.exe BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB computer1\n------\nOriginal:   c:\\windows\\system32\\notepad.exe AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA computer1\nViolation:  c:\\windows\\system32\\notepad.exe f60a9d3a9461f68de0fccebb0c6cb31a computer1\n------\nOriginal:   c:\\program files\\internet explorer\\iexplore.exe BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB computer1\nViolation:  c:\\program files\\internet explorer\\iexplore.exe 0f3c97716fed8b554a7ec0464d50719f computer1\n------\nOriginal:   c:\\windows\\system32\\notepad.exe f60a9d3a9461f68de0fccebb0c6cb31a computer1\nViolation:  c:\\windows\\system32\\notepad.exe AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA computer1\n------\nIGNORE THIS LINE []\nIGNORE THIS LINE []\n</code></pre>\n\n<p>Expected result:</p>\n\n<pre><code>c:\\program files\\internet explorer\\iexplore.exe;0f3c97716fed8b554a7ec0464d50719f;computer1\nc:\\program files\\internet explorer\\iexplore.exe;BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB;computer1\n\nc:\\windows\\system32\\notepad.exe;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA;computer1\nc:\\windows\\system32\\notepad.exe;f60a9d3a9461f68de0fccebb0c6cb31a;computer1 \n</code></pre>\n\n<p>I tried break, continue, variables, etc but I think that I'm having trouble with logic to report only one occurrence.</p>\n\n<p>Here's the code (finally):</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"strings\"\n)\n\nconst (\n    FILE_DIR = \"./logs/\"\n)\n\nfunc main() {\n\n    p := fmt.Println\n\n    // List and open all log files\n    listOfFiles := listDirFiles(FILE_DIR)\n    for _, file := range listOfFiles {\n\n        f, err := os.Open(FILE_DIR + file)\n        if err != nil {\n            p(\"Error when opening the file \" + FILE_DIR + file + \" .\")\n            break\n        }\n        defer f.Close()\n\n        var lines []string\n        scanner := bufio.NewScanner(f)\n        for scanner.Scan() {\n            lines = append(lines, scanner.Text()) // Converting the content of a file into a slice\n        }\n\n        results := testViolation(lines)\n        fmt.Println(\"IGNORE THIS LINE\", results)\n    }\n\n}\n\nfunc testViolation(lines []string) []string {\n    var splitLine []string\n\n    for _, f := range lines {\n        splitLine = strings.Split(f, \";\")\n\n        for _, c := range lines {\n            checkLine := strings.Split(c, \";\")\n            if splitLine[0] == checkLine[0] &amp;&amp; splitLine[2] == checkLine[2] &amp;&amp; splitLine[1] != checkLine[1] {\n                fmt.Println(\"Original:  \", splitLine[0], splitLine[1], splitLine[2])\n                fmt.Println(\"Violation: \", checkLine[0], checkLine[1], checkLine[2])\n                fmt.Println(\"------\")\n            }\n        }\n    }\n    return nil\n}\n\nfunc listDirFiles(dir string) []string {\n\n    var filesString []string\n    files, _ := ioutil.ReadDir(dir)\n\n    // Convert []os.FileInfo into []string to return\n    for _, f := range files {\n        filesString = append(filesString, f.Name())\n    }\n    return filesString\n}\n</code></pre>\n\n<p>I really appreciate your help.</p>\n\n<p>Mario.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1502508407, "post_id": 45646198, "comment_id": 78251495, "body": "<i>How do I install Go on WIndows?</i> You download the Windows installer and run it. What does <i>the environment of the program is not there</i> mean?"}, {"owner": {"reputation": 1993, "user_id": 4083590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edffd2bb155bf72f1ca2d03eefc4f740?s=128&d=identicon&r=PG&f=1", "display_name": "Johny", "link": "https://stackoverflow.com/users/4083590/johny"}, "edited": false, "score": 2, "creation_date": 1502508689, "post_id": 45646198, "comment_id": 78251539, "body": "why javascript, java, php and jquery tags for a go question?"}, {"owner": {"reputation": 2635, "user_id": 1527252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v7x0R.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1527252/sam"}, "edited": false, "score": 0, "creation_date": 1502509429, "post_id": 45646198, "comment_id": 78251626, "body": "This is not really a relevant question. Like Johnny up here said, PHP, Java, JS, and Jquery don&#39;t fall under the category since you are not doing anything with those languages..."}], "answers": [{"tags": [], "owner": {"reputation": 159, "user_id": 4548643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-8a6qY64bJ18/AAAAAAAAAAI/AAAAAAAAAR8/O4eJ_vUndwU/photo.jpg?sz=128", "display_name": "Jackson Welch", "link": "https://stackoverflow.com/users/4548643/jackson-welch"}, "is_accepted": true, "score": 4, "last_activity_date": 1502510130, "creation_date": 1502510130, "answer_id": 45646340, "question_id": 45646198, "link": "https://stackoverflow.com/questions/45646198/how-do-i-installied-go-programming-on-windows/45646340#45646340", "title": "how do i installied Go programming on windows?", "body": "<p>Check out this link. <a href=\"https://golang.org/doc/install?download=go1.8.3.windows-amd64.msi\" rel=\"nofollow noreferrer\">https://golang.org/doc/install?download=go1.8.3.windows-amd64.msi</a></p>\n\n<p>You will find all the information you need there. </p>\n"}], "owner": {"reputation": 1, "user_id": 7904015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc83edb6b4d76ac7b1c956f508d93d7b?s=128&d=identicon&r=PG&f=1", "display_name": " NELSON DEGREAT", "link": "https://stackoverflow.com/users/7904015/nelson-degreat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "closed_date": 1502528524, "accepted_answer_id": 45646340, "answer_count": 1, "score": -9, "last_activity_date": 1502510136, "creation_date": 1502508177, "last_edit_date": 1502510136, "question_id": 45646198, "link": "https://stackoverflow.com/questions/45646198/how-do-i-installied-go-programming-on-windows", "closed_reason": "Needs details or clarity", "title": "how do i installied Go programming on windows?", "body": "<p>I want to learn Go program  so went through golang.org\\dl\\ to download for window installer, then installed it but now the environment of the program is not there rather what get after installation is GoDocServer what can i do</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1172, "user_id": 4784560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZAAHs.jpg?s=128&g=1", "display_name": "Christian Will", "link": "https://stackoverflow.com/users/4784560/christian-will"}, "is_accepted": false, "score": 5, "last_activity_date": 1502504507, "creation_date": 1502504507, "answer_id": 45645918, "question_id": 45645900, "link": "https://stackoverflow.com/questions/45645900/fmt-println-prints-out-format-verbs-like-s/45645918#45645918", "title": "fmt.Println prints out format verbs like %s", "body": "<p>You are using the wrong printing function.</p>\n\n<p>I) Try to replace <code>Println</code> with <code>Printf</code> and it should work fine.</p>\n\n<p>II) Another option is to first format the string <code>s := fmt.Sprintf(\"a %s\", \"string\")</code> and then print it <code>fmt.Println(s)</code>.</p>\n\n<p>reference: <a href=\"https://gobyexample.com/string-formatting\" rel=\"noreferrer\">Go by Example: String Formatting</a></p>\n"}, {"tags": [], "owner": {"reputation": 1715, "user_id": 2631732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc9c1998e15be9375572a153883ee4d6?s=128&d=identicon&r=PG", "display_name": "Daniel Corin", "link": "https://stackoverflow.com/users/2631732/daniel-corin"}, "is_accepted": true, "score": 7, "last_activity_date": 1502570553, "last_edit_date": 1502570553, "creation_date": 1502504562, "answer_id": 45645923, "question_id": 45645900, "link": "https://stackoverflow.com/questions/45645900/fmt-println-prints-out-format-verbs-like-s/45645923#45645923", "title": "fmt.Println prints out format verbs like %s", "body": "<p>It looks like you are trying to use string formatters, which aren't supported by <code>fmt.Println</code>.</p>\n\n<p>According to the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">godocs</a>:</p>\n\n<blockquote>\n  <p>Printf formats according to a format specifier </p>\n</blockquote>\n\n<p>whereas</p>\n\n<blockquote>\n  <p>Println formats using the default formats</p>\n</blockquote>\n\n<p>The following will give the output you are trying to get:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    kvs := map[string]string{\n        \"a\": \"apple\",\n        \"b\": \"banana\",\n    }\n    for k, v := range kvs {\n        fmt.Printf(\"%s -&gt; %s\\n\", k, v)\n    }\n}\n</code></pre>\n\n<p>Note that maps in Go do not have a specific ordering so you may get any arbitrary key-value pair before another.</p>\n"}], "owner": {"reputation": 305, "user_id": 5420339, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/avfd1.jpg?s=128&g=1", "display_name": "user147219", "link": "https://stackoverflow.com/users/5420339/user147219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5190, "favorite_count": 1, "accepted_answer_id": 45645923, "answer_count": 2, "score": 2, "last_activity_date": 1502570553, "creation_date": 1502504154, "last_edit_date": 1502528150, "question_id": 45645900, "link": "https://stackoverflow.com/questions/45645900/fmt-println-prints-out-format-verbs-like-s", "title": "fmt.Println prints out format verbs like %s", "body": "<p>I've written code that is intended to print out keys and values in a map.</p>\n\n<pre><code>kvs := map[string]string{\"a\": \"apple\", \"b\": \"banana\"}\nfor k, v := range kvs {\n    fmt.Println(\"%s -&gt; %s\\n\", k, v)\n}\n</code></pre>\n\n<p>I'm expecting the output to be:</p>\n\n<pre><code>a -&gt; apple\nb -&gt; banana\n</code></pre>\n\n<p>But the output is actually:</p>\n\n<pre><code>%s -&gt; %s\na apple\n%s -&gt; %s\nb banana\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 4, "creation_date": 1502477618, "post_id": 45641999, "comment_id": 78243630, "body": "Read golang tour <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">tour.golang.org/methods/1</a> will give you an insights to your question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1502482735, "post_id": 45641999, "comment_id": 78245786, "body": "When you understand things, you should also be aware of addressability and how methods are called, which will allow you to understand when a <code>poly</code> value can and can&#39;t be converted to a <code>*poly</code> value; this is important because <code>poly.reset</code> requires a <code>*poly</code> receiver while you used <code>p.reset()</code>, where <code>p</code> has type <code>poly</code>, not <code>*poly</code>."}, {"owner": {"reputation": 2038, "user_id": 1312971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ATNL0.png?s=128&g=1", "display_name": "mawburn", "link": "https://stackoverflow.com/users/1312971/mawburn"}, "edited": false, "score": 4, "creation_date": 1577332730, "post_id": 45641999, "comment_id": 105143207, "body": "The fact that this question was downvoted and closed is a great example for why people hate asking questions on SO. There&#39;s nothing wrong with the question, the way it was written or anything of the sort. The linked duplicate answers the question, but there is nothing wrong with this besides that."}, {"owner": {"reputation": 21272, "user_id": 52277, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/67498fd0e17d27cb9be0c107f306e378?s=128&d=identicon&r=PG", "display_name": "Michael Freidgeim", "link": "https://stackoverflow.com/users/52277/michael-freidgeim"}, "edited": false, "score": 0, "creation_date": 1615590923, "post_id": 45641999, "comment_id": 117747982, "body": "It\u2019s a more like a duplicate of <a href=\"https://stackoverflow.com/questions/34031801/function-declaration-syntax-things-in-parenthesis-before-function-name/66607825#66607825\" title=\"function declaration syntax things in parenthesis before function name\">stackoverflow.com/questions/34031801/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 2, "creation_date": 1502477671, "post_id": 45642042, "comment_id": 78243654, "body": "I couldn&#39;t find anywhere, what&#39;s the benefit of using <code>p *poly</code> before the function named instead of inside the parenthesis after the function name. Also when to use which?"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 2, "creation_date": 1502477825, "post_id": 45642042, "comment_id": 78243731, "body": "The benefit is that it makes it a method. Have you gone through the entire tour (not just skimmed the first 5 pages)? Most people learn Go syntax in a few days (understanding Go idioms takes longer, but the syntax is pretty simple). You can&#39;t just assume it&#39;s JavaScript/Java/Swift/etc. with other words. It&#39;s a completely different language."}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 1, "creation_date": 1502477996, "post_id": 45642042, "comment_id": 78243824, "body": "As jeevatkm noted, the specific section that covers methods is <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">tour.golang.org/methods/1</a>, but start at the beginning of the tour."}, {"owner": {"reputation": 174, "user_id": 3454759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYFY5.jpg?s=128&g=1", "display_name": "sibi", "link": "https://stackoverflow.com/users/3454759/sibi"}, "edited": false, "score": 0, "creation_date": 1595312010, "post_id": 45642042, "comment_id": 111422455, "body": "If you look closely, you are modifying the value of the <code>poly</code> in the reset function, in such cases, you need to pass the pointer reference not the value to access its actual address."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 12, "last_activity_date": 1502477591, "creation_date": 1502477591, "answer_id": 45642042, "question_id": 45641999, "link": "https://stackoverflow.com/questions/45641999/parameter-before-the-function-name-in-go/45642042#45642042", "title": "Parameter before the function name in Go?", "body": "<p>It means that <code>reset()</code> is a method on <code>*poly</code>. This is very basic Go; you really need to start with the <a href=\"https://tour.golang.org\" rel=\"noreferrer\">Go tour</a>. Trying to read Go without a basic understanding of its syntax is going to be very confusing.</p>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6578, "favorite_count": 2, "closed_date": 1502483810, "accepted_answer_id": 45642042, "answer_count": 1, "score": 8, "last_activity_date": 1502477591, "creation_date": 1502477410, "question_id": 45641999, "link": "https://stackoverflow.com/questions/45641999/parameter-before-the-function-name-in-go", "closed_reason": "Duplicate", "title": "Parameter before the function name in Go?", "body": "<p>I have seen some Go functions defined like this:</p>\n\n<pre><code>type poly struct {\n    coeffs [256]uint16\n}\n\nfunc (p *poly) reset() {\n    for i := range p.coeffs {\n        p.coeffs[i] = 0\n    }\n}\n</code></pre>\n\n<p>Which you can later call as:</p>\n\n<pre><code>var p poly\np.reset()\n</code></pre>\n\n<p>I haven't seen this in other programming languages that I know. What's the purpose of <code>p *poly</code> in the reset function? It seems to be like a function parameter but written before the function name. Any clarification for it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1502473768, "post_id": 45641037, "comment_id": 78241638, "body": "Reconnecting is not the responsibility of <code>Dial</code>; only connecting. The user of <code>Dial</code> is responsible for reconnecting intelligently if that&#39;s appropriate to the use case."}, {"owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502473811, "post_id": 45641037, "comment_id": 78241658, "body": "I didn&#39;t mean net.Dial function, but my own Dial() function in the code above."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1502473939, "post_id": 45641037, "comment_id": 78241724, "body": "You can&#39;t really reconnect from your <code>Dial</code> - when <code>Dial</code> returns, it&#39;s passing ownership of the <code>Conn</code> to its caller, so <code>Dial</code> shouldn&#39;t be doing <i>anything</i> with that <code>Conn</code> any more or it will cause all sorts of bizarre issues. What happens when you intentionally close the connection? How will Conn know when to reconnect? Should it resend data that was written to it when the connection failed? This doesn&#39;t seem like a problem that can or should be solved in this function."}, {"owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502474199, "post_id": 45641037, "comment_id": 78241840, "body": "I need to keep connection open all the time and there&#39;s no case when I want to close it intentionally. It shouldn&#39;t resend any data, just re-establish the connection. I was looking at <a href=\"https://stackoverflow.com/a/23396415/4833237\">stackoverflow.com/a/23396415/4833237</a> but couldn&#39;t come up with a way to use it in my case."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1502474279, "post_id": 45641037, "comment_id": 78241886, "body": "I&#39;m not sure how it&#39;s possible &quot;there&#39;s no case when I want to close it intentionally&quot;. At the very least, eventually your process will exit and it should close its connection gracefully, and not attempt to reopen it."}, {"owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502474344, "post_id": 45641037, "comment_id": 78241924, "body": "Good point. I&#39;ll make a note on it."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1502476556, "post_id": 45641037, "comment_id": 78243061, "body": "With XMPP, you must restart the XML stream when reestablishing the connection."}, {"owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "edited": false, "score": 0, "creation_date": 1502479024, "post_id": 45641037, "comment_id": 78244242, "body": "Thanks. Figured it out. I was on the right track, just needed to properly close and re-create tcp connection and then auth+re-start listener for xmpp."}], "answers": [{"tags": [], "owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "is_accepted": false, "score": 0, "last_activity_date": 1502478956, "creation_date": 1502478956, "answer_id": 45642362, "question_id": 45641037, "link": "https://stackoverflow.com/questions/45641037/how-to-make-net-dial-in-go-reconnect-if-connection-is-lost/45642362#45642362", "title": "How to make net.Dial in Go reconnect if connection is lost?", "body": "<p>Figured it out. I just started to close the current tcp connection on any error in my error channel and re-create both TCP and XMPP (auth+listen) connections.</p>\n"}], "owner": {"reputation": 374, "user_id": 4833237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b99a13ba5d3fc3b181d50e97e606896d?s=128&d=identicon&r=PG&f=1", "display_name": "Maklaus", "link": "https://stackoverflow.com/users/4833237/maklaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1780, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1502478956, "creation_date": 1502473628, "question_id": 45641037, "link": "https://stackoverflow.com/questions/45641037/how-to-make-net-dial-in-go-reconnect-if-connection-is-lost", "title": "How to make net.Dial in Go reconnect if connection is lost?", "body": "<p>I have an app in Go that's connecting to XMPP host using tcp and then xml Decoder to talk XMPP. How can I make net.Dial reconnect if tcp connection is dropped?</p>\n\n<p>I am getting the following error on my error channel when the connection is dropped:\n<code>write tcp client:port-&gt;xmpp_server:5222: write: broken pipe</code>. However I'm not sure how to properly handle it in my <code>Dial</code> function to make it reconnect.</p>\n\n<pre><code>// package xmpp\n// Conn represents a connection\ntype Conn struct {\n    incoming *xml.Decoder\n    outgoing net.Conn\n    errchan  chan error\n}\n\n// SetErrorChannel sets the channel for handling errors\nfunc (c *Conn) SetErrorChannel(channel chan error) {\n    c.errchan = channel\n}\n\n// Dial dials an xmpp host\nfunc Dial(host string) (*Conn, error) {\n    c := new(Conn)\n    var err error\n\n    c.outgoing, err = net.Dial(\"tcp\", host+\":5222\")\n    if err != nil {\n        log.Printf(\"Can't dial %s:5222: %s\", host, err)\n        return c, err\n    }\n\n    // TCP Keep Alive\n    err = c.outgoing.(*net.TCPConn).SetKeepAlive(true)\n    if err != nil {\n        c.errchan &lt;- err\n    }\n    err = c.outgoing.(*net.TCPConn).SetKeepAlivePeriod(30 * time.Second)\n    if err != nil {\n        c.errchan &lt;- err\n    }\n\n    c.incoming = xml.NewDecoder(c.outgoing)\n    log.Printf(\"Connected to: %s\", c.outgoing.RemoteAddr())\n    return c, nil\n}\n\n// In a separate package\nfunc NewXMPPClient(config) (*Client, error) {\n    errchannel := make(chan error)\n    connection, err := xmpp.Dial(host)\n\n    if err != nil {\n        return nil, err\n    }\n    connection.SetErrorChannel(errchannel)\n\n    // Do XMPP auth, receive messages, etc...\n</code></pre>\n"}, {"tags": ["go", "grpc"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502473715, "post_id": 45640968, "comment_id": 78241611, "body": "If the marked line is truly the line where the error is occurring, I&#39;m stumped, because no pointer is dereferenced there."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502473811, "post_id": 45640968, "comment_id": 78241657, "body": "Show more of the context in your code. Are you shadowing the <code>status</code> package with a <code>status</code> variable?"}, {"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502473942, "post_id": 45640968, "comment_id": 78241727, "body": "@JimB I added the whole function"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1502473964, "post_id": 45640968, "comment_id": 78241735, "body": "Per <a href=\"https://godoc.org/google.golang.org/grpc/status#Error\" rel=\"nofollow noreferrer\">godoc</a>, <code>status.Error</code> takes code value as type <code>codes.Code</code> which is <code>type Code uint32</code>. Use the type appropriately. And list of gRPC code per spec is here <a href=\"https://godoc.org/google.golang.org/grpc/codes#Code\" rel=\"nofollow noreferrer\">godoc.org/google.golang.org/grpc/codes#Code</a>"}, {"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1502474318, "post_id": 45640968, "comment_id": 78241911, "body": "@jeevatkm that works but why would it allow other codes that are not 0 - 15 based on <a href=\"https://godoc.org/google.golang.org/grpc/codes#Code\" rel=\"nofollow noreferrer\">codes</a> and work when there are no concurrent requests."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1502475014, "post_id": 45640968, "comment_id": 78242275, "body": "Those codes are enum value of <a href=\"https://godoc.org/google.golang.org/genproto/googleapis/rpc/status#Status\" rel=\"nofollow noreferrer\">grpc</a> other than that it will fail. Typically you could have got compile error when using incorrect type, not sure why."}, {"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "edited": false, "score": 0, "creation_date": 1502475496, "post_id": 45640968, "comment_id": 78242520, "body": "It builds fine without an error. I&#39;m using go version go1.8.1 darwin/amd64"}], "answers": [{"tags": [], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "is_accepted": false, "score": 1, "last_activity_date": 1502474220, "creation_date": 1502474220, "answer_id": 45641198, "question_id": 45640968, "link": "https://stackoverflow.com/questions/45640968/go-grpc-status-error-causing-invalid-memory-address-when-running-concurrent-re/45641198#45641198", "title": "Go gRPC status.Error() causing invalid memory address when running concurrent requests", "body": "<p>Added a code from <a href=\"https://godoc.org/google.golang.org/grpc/codes#Code\" rel=\"nofollow noreferrer\">godocs</a> does solve this issue. It only works with 0 - 15. Thank You  @jeevatkm</p>\n"}], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531694850, "creation_date": 1502473388, "last_edit_date": 1502473982, "question_id": 45640968, "link": "https://stackoverflow.com/questions/45640968/go-grpc-status-error-causing-invalid-memory-address-when-running-concurrent-re", "title": "Go gRPC status.Error() causing invalid memory address when running concurrent requests", "body": "<p>I have a <code>bcrypt.CompareHashAndPassword()</code> function that if the error is not nil return a status.Error() back to the client. </p>\n\n<p>It works If I don't run concurrent requests.</p>\n\n<p>If I just return the err back to the client instead of <code>status.Error()</code> from the bcrypt everything works with concurrent requests. I ran it testing race conditions and nothing came up.</p>\n\n<p>I'm not sure if the issue is with the <code>\"google.golang.org/grpc/status\"</code> library or with <code>\"golang.org/x/crypto/bcrypt\"</code>. I looked into the status library and there are no reading/writing of maps or anything in my mind that would cause this issue. Any help appreciated.</p>\n\n<p>My code:</p>\n\n<pre><code>  package main\n\nimport (\n    pb \"dms-cloud/authentication-microservice/pb\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"golang.org/x/net/context\"\n    \"golang.org/x/crypto/bcrypt\"\n    \"github.com/satori/go.uuid\"\n    \"time\"\n    \"encoding/json\"\n    \"google.golang.org/grpc/status\"\n)\n\nfunc (s *server) Authenticate(ctx context.Context, in *pb.AuthenticationRequest) (*pb.Ticket, error) {\n\n    // Verify Password Correct\n    err := bcrypt.CompareHashAndPassword([]byte(in.EncryptedPassword), []byte(in.Password))\n    if err != nil {\n        return nil, status.Error(105, \"Authentication Failed\")\n    }\n\n    // Generate Ticket\n    tkt := uuid.NewV4()\n    exp := time.Now().Unix() + 700\n\n    // Response\n    t := pb.Ticket{\n        Uuid: tkt.String(),\n        TimeExpire: exp,\n        AccountId: in.AccountId,\n    }\n\n    rTkt, err := json.Marshal(t)\n\n    err = cache.Set(tkt.String(), string(rTkt), time.Minute*60).Err()\n    if err != nil {\n        return nil, status.Error(500, \"Internal Error\")\n    }\n\n    return &amp;t, nil\n}\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x18 pc=0x13d96c5]\n\ngoroutine 34 [running]:\nmain.(*server).Authenticate(0x176f580, 0x1b44000, 0xc420194210, 0xc420192e00, 0x176f580, 0x102906e, 0x0)\n        /Users/kenfab/go/src/dms-cloud/authentication-microservice/Authenticate.go:19 +0x105\ndms-cloud/authentication-microservice/pb._AuthenticationMicroservice_Authenticate_Handler(0x1453060, 0x176f580, 0x1b44000, 0xc420194210, 0xc420016cd0, 0x0, 0x0, 0x0, 0x0, 0x0)\n        /Users/kenfab/go/src/dms-cloud/authentication-microservice/pb/authenticate.pb.go:240 +0x28d\ngoogle.golang.org/grpc.(*Server).processUnaryRPC(0xc4200128c0, 0x1717ec0, 0xc42001b1e0, 0xc42019c000, 0xc420019e60, 0x17464c0, 0xc4201625a0, 0x0, 0x0)\n        /Users/kenfab/go/src/google.golang.org/grpc/server.go:781 +0xc41\ngoogle.golang.org/grpc.(*Server).handleStream(0xc4200128c0, 0x1717ec0, 0xc42001b1e0, 0xc42019c000, 0xc4201625a0)\n        /Users/kenfab/go/src/google.golang.org/grpc/server.go:981 +0x15a6\ngoogle.golang.org/grpc.(*Server).serveStreams.func1.1(0xc420011b50, 0xc4200128c0, 0x1717ec0, 0xc42001b1e0, 0xc42019c000)\n        /Users/kenfab/go/src/google.golang.org/grpc/server.go:551 +0xa9\ncreated by google.golang.org/grpc.(*Server).serveStreams.func1\n        /Users/kenfab/go/src/google.golang.org/grpc/server.go:552 +0xa1\nexit status 2\n</code></pre>\n"}, {"tags": ["sorting", "go", "indexing", "int"], "comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1502555016, "post_id": 45640144, "comment_id": 78263213, "body": "Can the numbers be negative?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502471711, "post_id": 45640339, "comment_id": 78240545, "body": "The <code>strconv</code> package has the <code>Append*</code> functions for formatting without the extra string conversion."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502472656, "post_id": 45640339, "comment_id": 78241073, "body": "@JimB but the result would be a <code>[]byte</code>, which would have to be cast to <code>string</code> to use anyway. I&#39;m at a loss as to how <code>Append*</code> functions would be better."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502472868, "post_id": 45640339, "comment_id": 78241200, "body": "no, you don&#39;t need to format it as a string to get the first digit, the first <code>byte</code> in the slice is the first digit. It&#39;s faster, because it doesn&#39;t need to allocate the new string every time (internally FormatInt formats into a <code>[]byte</code> first the just calls <code>string(s)</code>), and you can reuse the buffer if you&#39;re really trying save. However it will still be slower than the direct solution of finding <i>only</i> the first digit like in Adrian&#39;s solution."}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 1, "last_activity_date": 1502475106, "last_edit_date": 1502475106, "creation_date": 1502470986, "answer_id": 45640339, "question_id": 45640144, "link": "https://stackoverflow.com/questions/45640144/getting-the-first-digit-of-an-int/45640339#45640339", "title": "Getting the first digit of an int", "body": "<p>You could convert them to strings in your sort function then index the first character. For <code>[]int</code> you can use <a href=\"https://godoc.org/strconv#Itoa\" rel=\"nofollow noreferrer\">https://godoc.org/strconv#Itoa</a> . Unfortunately this method will take a huge performance hit for the string conversion.</p>\n\n<p><a href=\"https://play.golang.org/p/S4j3NlfinD\" rel=\"nofollow noreferrer\">https://play.golang.org/p/S4j3NlfinD</a></p>\n\n<pre><code>type ByFirstDigit []int\n\nfunc (s ByFirstDigit) Len() int {\n    return len(s)\n}\n\nfunc (s ByFirstDigit) Swap(i, j int) {\n    s[i], s[j] = s[j], s[i]\n}\n\nfunc (s ByFirstDigit) Less(i, j int) bool {\n    si := strconv.Itoa(s[i])\n    sj := strconv.Itoa(s[j])\n    return si[0] &lt; sj[0]\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1502471605, "post_id": 45640476, "comment_id": 78240490, "body": "Awesome! Not sure why I didn&#39;t think of this. My first thought was bitwise operators, but obviously that wouldn&#39;t work, so I went straight for the easy answer."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1502471704, "post_id": 45640476, "comment_id": 78240536, "body": "I usually prefer the easy answer because it&#39;s more clear what&#39;s going on. Then when the implementation is done, if performance doesn&#39;t meet requirements, benchmark, profile, and optimize. Premature optimization is the root of all evil :)"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1502471906, "post_id": 45640476, "comment_id": 78240647, "body": "BTW, this has a bug in it in the fact that it doesn&#39;t account for the number <code>10</code>. <code>10</code> should be the first value. See here <a href=\"https://play.golang.org/p/eYZMVXQURS\" rel=\"nofollow noreferrer\">play.golang.org/p/eYZMVXQURS</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1502472170, "post_id": 45640476, "comment_id": 78240815, "body": "Feel free to just fix it in that playground and use it in your answer."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 6, "last_activity_date": 1502472196, "last_edit_date": 1502472196, "creation_date": 1502471489, "answer_id": 45640476, "question_id": 45640144, "link": "https://stackoverflow.com/questions/45640144/getting-the-first-digit-of-an-int/45640476#45640476", "title": "Getting the first digit of an int", "body": "<p>@RayfenWindspear has the easiest to use and read answer, but is correct about the performance hit. If performance is more important than maintainability, you can do the same thing using iterative division to get the most-significant base-10 digit:</p>\n\n<pre><code>var i int\nfor i = n; i &gt;= 10; i = i / 10 {}\n// i == most significant digit\n</code></pre>\n\n<p>Note that you have to declare <code>i</code> outside the loop to be able to use it after the loop finds the most-significant digit. I'd also benchmark both with your own data set to see what the real performance impact is in your particular situation.</p>\n\n<p><a href=\"https://play.golang.org/p/ozFw_ll6Y3\" rel=\"nofollow noreferrer\">Full playground example, courtesy of Rayfen</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1502475487, "post_id": 45641042, "comment_id": 78242513, "body": "I always forget, is the precision of a <code>float64</code> such that it is capable of holding <b>any whole number</b> within the <code>int64</code> range without some truncating happening? i.e. is there the possibility of <code>int64(float64(n)) != n</code> where <code>n</code> is originally <code>int64</code>?"}, {"owner": {"reputation": 1758, "user_id": 3277736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/EkNVT.jpg?s=128&g=1", "display_name": "boxtrain", "link": "https://stackoverflow.com/users/3277736/boxtrain"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1502477348, "post_id": 45641042, "comment_id": 78243499, "body": "No, are ints in Go 64 bits? (I haven&#39;t used Go before). Range of an int64: 2^64. Perfect int range of a float64: 2^53, because you get 52 perfect bits from the mantissa, and one from the exponent."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1502477587, "post_id": 45641042, "comment_id": 78243617, "body": "The <code>int</code> type is based off system architecture, but is still it&#39;s own type. On x64 it will be <code>int64</code> but doesn&#39;t mean that the types <code>int</code> and <code>int64</code> are the same, a cast is necessary."}, {"owner": {"reputation": 1758, "user_id": 3277736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/EkNVT.jpg?s=128&g=1", "display_name": "boxtrain", "link": "https://stackoverflow.com/users/3277736/boxtrain"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1502487499, "post_id": 45641042, "comment_id": 78247636, "body": "I&#39;d be curious to know what the downvote was for - anything specific in the code I can fix? I&#39;m new to Go, so always looking for tips."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1502724016, "post_id": 45641042, "comment_id": 78313173, "body": "@jbjw: The issue here is that <code>int</code> in Go can (and most often is) 64bits, so so converting values greater than <code>1&lt;&lt;52</code> to float64 can lose precision. Take the number <code>999999999999999999</code> for example: <a href=\"https://play.golang.org/p/ECNnjhJ-CR\" rel=\"nofollow noreferrer\">play.golang.org/p/ECNnjhJ-CR</a> -- RayfenWindspear hinted at the bug, but someone should probably have pointed it out directly rather than down-voting."}], "tags": [], "owner": {"reputation": 1758, "user_id": 3277736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/EkNVT.jpg?s=128&g=1", "display_name": "boxtrain", "link": "https://stackoverflow.com/users/3277736/boxtrain"}, "is_accepted": false, "score": 0, "last_activity_date": 1502473642, "creation_date": 1502473642, "answer_id": 45641042, "question_id": 45640144, "link": "https://stackoverflow.com/questions/45640144/getting-the-first-digit-of-an-int/45641042#45641042", "title": "Getting the first digit of an int", "body": "<p>In case you want a solution with a lot of high-level math functions that may or may not perform well:</p>\n\n<pre><code>package main\n\nimport \"sort\"\nimport \"fmt\"\nimport \"math\"\n\ntype ByFirstDigit []int\n\nfunc (s ByFirstDigit) Len() int {\n    return len(s)\n}\nfunc (s ByFirstDigit) Swap(i, j int) {\n    s[i], s[j] = s[j], s[i]\n}\nfunc (s ByFirstDigit) Less(i, j int) bool {\n    return firstDigit( s[i] ) &lt; firstDigit( s[j] )\n}\n\nfunc firstDigit( x int ) int {\n    return int( math.Abs( float64( x ) ) / math.Pow( 10, float64( numDigits(x) - 1 ) ) )\n}\n\nfunc numDigits( x int ) int {\n    if ( x == 0 ) { return 1 }\n    return int( math.Floor( math.Log10( math.Abs( float64(x) ) ) ) ) + 1\n}\n\nfunc main() {\n    ints := []int{3, 20, 400, -500, 101}\n    sort.Sort( ByFirstDigit( ints ) )\n    fmt.Println( ints )\n}\n</code></pre>\n\n<p>Here's a playground (same code):\n<a href=\"https://play.golang.org/p/uLyBMlra2N\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uLyBMlra2N</a></p>\n"}], "owner": {"reputation": 443, "user_id": 5158845, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eff4c21679d34a45c335d91940215c9?s=128&d=identicon&r=PG&f=1", "display_name": "gogofan", "link": "https://stackoverflow.com/users/5158845/gogofan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2024, "favorite_count": 0, "accepted_answer_id": 45640476, "answer_count": 3, "score": 4, "last_activity_date": 1502517335, "creation_date": 1502470270, "last_edit_date": 1502517335, "question_id": 45640144, "link": "https://stackoverflow.com/questions/45640144/getting-the-first-digit-of-an-int", "title": "Getting the first digit of an int", "body": "<p>How do I sort a slice of ints by the first digit of each int?</p>\n\n<p>I am trying to write my own custom sort:</p>\n\n<pre><code>type ByFirstDigit []int\n\nfunc (s ByFirstDigit) Len() int {\n    return len(s)\n}\n\nfunc (s ByFirstDigit) Swap(i, j int) {\n    s[i], s[j] = s[j], s[i]\n}\n\nfunc (s ByFirstDigit) Less(i, j int) bool {\n    return s[i][0] &lt; s[j][0]\n}\n</code></pre>\n\n<p>But I get this error: </p>\n\n<blockquote>\n  <p>s[j][0] (type int does not support indexing)</p>\n</blockquote>\n"}, {"tags": ["go", "struct", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1502468983, "post_id": 45639721, "comment_id": 78239125, "body": "The first two examples you have aren&#39;t pointers. The last three are all the same, with the knowledge that the type can be elided from composite literals when it can be inferred. Are you looking for the <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">Composite Literals spec</a>?"}, {"owner": {"reputation": 2087, "user_id": 6407379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XO9h7.jpg?s=128&g=1", "display_name": "Kevin Qian", "link": "https://stackoverflow.com/users/6407379/kevin-qian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1502469666, "post_id": 45639721, "comment_id": 78239490, "body": "@JimB Thanks! The material is exactly what I needed for understanding. It seems that the GOPL book missed the topic (or probably I missed the chapters that are actually mentioning it...)"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5513113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317b1216883b6b7c816b3bbd568170c8?s=128&d=identicon&r=PG&f=1", "display_name": "MOHL-CLAUZADE Yannick", "link": "https://stackoverflow.com/users/5513113/mohl-clauzade-yannick"}, "is_accepted": false, "score": 1, "last_activity_date": 1502538988, "creation_date": 1502538988, "answer_id": 45649976, "question_id": 45639721, "link": "https://stackoverflow.com/questions/45639721/golang-anonymous-struct-in-initializing-slice-of-pointers/45649976#45649976", "title": "Golang anonymous struct in initializing slice of pointers", "body": "<p>Please give more detail on your structure definition of Ex.</p>\n\n<p>But, if Ex is implemented as this:</p>\n\n<pre><code>type Ex struct {\n    t interface{}\n    o interface{}\n}\n</code></pre>\n\n<p>you don't give a pointer of anonymous struct because, the definition it's not know.</p>\n\n<p>Also you can't do:</p>\n\n<pre><code>variable := new({1, 2})\n// or\nvariable := {1, 2}\n</code></pre>\n\n<p>When you do:</p>\n\n<pre><code>b := []Ex{{1, 2}, {3, 4}}\n// you create slice of Ex with two Ex struct\n// so b := []Ex{Ex{t:1,o:2}, Ex{t:3, o:4}}\n</code></pre>\n\n<p>contrariwise:</p>\n\n<pre><code>f := []*Ex{&amp;{1, 2}, &amp;{3, 4}}\n// you create slice of unknow definition type\n// f = []Ex{Ex{t: addressOfUnknowType, o: addressOfUnknowType}}\n</code></pre>\n\n<p>I hope help you</p>\n"}, {"tags": [], "owner": {"reputation": 1780, "user_id": 985172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd7c27d584e896bc3f07f925e09dc37?s=128&d=identicon&r=PG", "display_name": "tschundler", "link": "https://stackoverflow.com/users/985172/tschundler"}, "is_accepted": false, "score": 2, "last_activity_date": 1529635464, "creation_date": 1529635464, "answer_id": 50979940, "question_id": 45639721, "link": "https://stackoverflow.com/questions/45639721/golang-anonymous-struct-in-initializing-slice-of-pointers/50979940#50979940", "title": "Golang anonymous struct in initializing slice of pointers", "body": "<p>I think anonymous isn't quite the correct word here. The struct has a name, \"Track\" or \"Ex\". But you are initializing it with a shortcut:</p>\n\n<pre><code>f := []&lt;type&gt;{{...}, {...}}\n</code></pre>\n\n<p>is roughly the same as:</p>\n\n<pre><code>f := []&lt;type&gt;{&lt;type&gt;{...}, &lt;type&gt;{...}}\n</code></pre>\n\n<p>But it's a little smarter than blind string replacement. If <code>&lt;type&gt;</code> is a pointer like <code>*Ex</code> or <code>*Track</code>, it also automatically initializes correctly:</p>\n\n<pre><code>f := []*&lt;type&gt;{{...}, {...}} // is the same as...\nf := []*&lt;type&gt;{&amp;&lt;type&gt;{...}, &amp;&lt;type&gt;{...}}\n</code></pre>\n\n<p>It works the same for maps:</p>\n\n<pre><code>f := map[string]*&lt;type&gt;{\"a\": {...}, \"b\": {...}} // is the same as...\nf := map[string]*&lt;type&gt;{\"a\": &amp;&lt;type&gt;{...}, \"b\": &amp;&lt;type&gt;{...}}\n</code></pre>\n\n<p>For further clarification, anonymous structs are ones that have no separate type definition. These are anonymous types, but not anonymous structs. An anonymous struct is a <em>struct</em> with no associated <em>type</em> definition. This syntax of initializing values without referring to the type is essential to making the manageable:</p>\n\n<pre><code>f := []struct{\n    A, B int\n}{\n    {1, 2}, {3, 4}\n}\n// or with pointers...\nf := []*struct{\n    A, B int\n}{\n    {1, 2}, {3, 4}\n}\n</code></pre>\n\n<p>Here the <em>struct</em> within the list has no type definition, so it is anonymous. And thanks to the initialization shorthand, that's fine - I don't need a name to initialize it.</p>\n"}], "owner": {"reputation": 2087, "user_id": 6407379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XO9h7.jpg?s=128&g=1", "display_name": "Kevin Qian", "link": "https://stackoverflow.com/users/6407379/kevin-qian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7381, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1529635464, "creation_date": 1502468635, "last_edit_date": 1502551106, "question_id": 45639721, "link": "https://stackoverflow.com/questions/45639721/golang-anonymous-struct-in-initializing-slice-of-pointers", "title": "Golang anonymous struct in initializing slice of pointers", "body": "<p>From Chapter 7 of GOPL (Section 7.6), I noticed this line:</p>\n\n<pre><code>var tracks = []*Track{\n     {\"Go\", \"Delilah\", \"From the Roots Up\", 2012, length(\"3m38s\")},\n     {\"Go\", \"Moby\", \"Moby\", 1992, length(\"3m37s\")},\n     {\"Go Ahead\", \"Alicia Keys\", \"As I Am\", 2007, length(\"4m36s\")},\n     {\"Ready 2 Go\", \"Martin Solveig\", \"Smash\", 2011, length(\"4m24s\")},\n}\n</code></pre>\n\n<p>I was kind of confused by how it initialized the slice of <code>Track</code> pointers.\nSo later I tried the following example:</p>\n\n<pre><code>type Ex struct {\n    A, B int\n}\n\na := []Ex{Ex{1, 2}, Ex{3, 4}}\nb := []Ex{{1, 2}, {3, 4}}\nc := []*Ex{&amp;Ex{1, 2}, &amp;Ex{3, 4}}\nd := []*Ex{{1, 2}, {3, 4}}\ne := []*Ex{{1, 2}, &amp;Ex{3, 4}}\n</code></pre>\n\n<p>I found all of the 5 cases are okay with no errors. The <code>{1, 2}</code> seems to be a structure called \"anonymous struct\", but it confuses me since it works fine even when I am trying to fill in <code>*Ex</code> pointers instead of <code>Ex</code> struct.</p>\n\n<p>Furthermore, when I try the following code, it complains syntax error:</p>\n\n<pre><code>f := []*Ex{&amp;{1, 2}, &amp;{3, 4}} // Syntax Error!\n</code></pre>\n\n<p>Can somebody help explain what is actually going on in these cases?</p>\n"}, {"tags": ["go", "amazon-s3", "google-cloud-storage", "compatibility"], "answers": [{"comments": [{"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "edited": false, "score": 0, "creation_date": 1502468197, "post_id": 45639488, "comment_id": 78238718, "body": "Awesome, thanks jterrace. I&#39;ll accept that answer as authoritative since you work at Google."}, {"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "edited": false, "score": 0, "creation_date": 1502468304, "post_id": 45639488, "comment_id": 78238777, "body": "To your knowledge, are there any plans to add support for this API in the future?"}, {"owner": {"reputation": 57152, "user_id": 624900, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dd56da509c21eebb967777a9dbcce437?s=128&d=identicon&r=PG", "display_name": "jterrace", "link": "https://stackoverflow.com/users/624900/jterrace"}, "reply_to_user": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "edited": false, "score": 0, "creation_date": 1502468624, "post_id": 45639488, "comment_id": 78238937, "body": "Sorry, but I&#39;m not allowed to share any information that&#39;s not already public."}, {"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "edited": false, "score": 0, "creation_date": 1502565592, "post_id": 45639488, "comment_id": 78266392, "body": "OK sure, I understand. I wasn&#39;t sure how public you guys were about plans. Thanks for the information you did provide!"}, {"owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "edited": false, "score": 0, "creation_date": 1504188014, "post_id": 45639488, "comment_id": 78926247, "body": "Do you know if the AWS compatibility API for GCS supports <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/API/multiobjectdeleteapi.html\" rel=\"nofollow noreferrer\">bulk deletes</a>?  That&#39;s another one we&#39;re having problems with."}, {"owner": {"reputation": 142, "user_id": 5674723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mTD8a.jpg?s=128&g=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5674723/ravi"}, "edited": false, "score": 0, "creation_date": 1571322672, "post_id": 45639488, "comment_id": 103210362, "body": "Is there any alternative way available to this for GCP? I want to list objects available in the GCP bucket."}, {"owner": {"reputation": 157, "user_id": 1686131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G7Nqp.png?s=128&g=1", "display_name": "Davi S Evangelista", "link": "https://stackoverflow.com/users/1686131/davi-s-evangelista"}, "edited": false, "score": 0, "creation_date": 1598830697, "post_id": 45639488, "comment_id": 112576713, "body": "It&#39;s been years and nothing changed... Is there anywhere we can &quot;vote&quot; or otherwise kindly inquire about implementing the ListObjectsV2 API?"}, {"owner": {"reputation": 57152, "user_id": 624900, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dd56da509c21eebb967777a9dbcce437?s=128&d=identicon&r=PG", "display_name": "jterrace", "link": "https://stackoverflow.com/users/624900/jterrace"}, "reply_to_user": {"reputation": 157, "user_id": 1686131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G7Nqp.png?s=128&g=1", "display_name": "Davi S Evangelista", "link": "https://stackoverflow.com/users/1686131/davi-s-evangelista"}, "edited": false, "score": 0, "creation_date": 1599016696, "post_id": 45639488, "comment_id": 112639445, "body": "@DaviSEvangelista added a link to the public issue for the feature request"}], "tags": [], "owner": {"reputation": 57152, "user_id": 624900, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dd56da509c21eebb967777a9dbcce437?s=128&d=identicon&r=PG", "display_name": "jterrace", "link": "https://stackoverflow.com/users/624900/jterrace"}, "is_accepted": true, "score": 3, "last_activity_date": 1599016679, "last_edit_date": 1599016679, "creation_date": 1502467800, "answer_id": 45639488, "question_id": 45638871, "link": "https://stackoverflow.com/questions/45638871/is-the-listobjectsv2-api-call-implemented-in-google-cloud-storage/45639488#45639488", "title": "Is the ListObjectsV2 api call implemented in Google Cloud Storage?", "body": "<p>Google Cloud Storage does not currently support the ListObjectsV2 API.</p>\n<p>The feature request is being tracked <a href=\"https://issuetracker.google.com/issues/155109631\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 45639488, "answer_count": 1, "score": 2, "last_activity_date": 1599016679, "creation_date": 1502465578, "question_id": 45638871, "link": "https://stackoverflow.com/questions/45638871/is-the-listobjectsv2-api-call-implemented-in-google-cloud-storage", "title": "Is the ListObjectsV2 api call implemented in Google Cloud Storage?", "body": "<p>I am using the <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/s3/#S3.ListObjectsV2\" rel=\"nofollow noreferrer\">aws go sdk <code>ListObjectsV2</code> function</a>, and I get back a response like this:</p>\n\n<p><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;&lt;Error&gt;&lt;Code&gt;InvalidArgument&lt;/Code&gt;&lt;Message&gt;Invalid argument.&lt;/Message&gt;&lt;Details&gt;Invalid query parameter(s): [list-type, start-after]&lt;/Details&gt;&lt;/Error&gt;\n</code></p>\n\n<p>From what I see in <a href=\"https://cloud.google.com/storage/docs/xml-api/get-bucket-list\" rel=\"nofollow noreferrer\">the <code>List Objects</code> docs for GCS</a>, these parameters are not included.</p>\n\n<p>If this was a known limitation, I would have expected it to be listed in <a href=\"https://cloud.google.com/storage/docs/migrating#migration-simple\" rel=\"nofollow noreferrer\">the <code>Simple Migration</code> documentation</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1502463525, "post_id": 45638189, "comment_id": 78235873, "body": "<code>p1</code> is a nil interface, it can&#39;t call anything."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 6, "last_activity_date": 1502463442, "creation_date": 1502463442, "answer_id": 45638216, "question_id": 45638189, "link": "https://stackoverflow.com/questions/45638189/how-to-fix-golang-too-many-arguments-error/45638216#45638216", "title": "How to fix golang too many arguments error", "body": "<p>The function <code>area</code> takes no arguments in its definition:</p>\n\n<pre><code>area() int\n// ...\nfunc (a details) area() int {\n</code></pre>\n\n<p>Therefor, passing any arguments to it is, as the error says, too many arguments. There is nowhere in the function where it makes use of arguments. It's making all its calculations based on the properties of its receiver, not any arguments. You're also calling it on an uninitialized (nil) interface value. It looks like what you want is probably:</p>\n\n<pre><code>r := details{height: 3, base: 4}\nr.area()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 2, "last_activity_date": 1502464179, "last_edit_date": 1502464179, "creation_date": 1502463774, "answer_id": 45638307, "question_id": 45638189, "link": "https://stackoverflow.com/questions/45638189/how-to-fix-golang-too-many-arguments-error/45638307#45638307", "title": "How to fix golang too many arguments error", "body": "<p>try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype shape interface {\n    area() int\n}\n\ntype traingle struct {\n    height int\n    base   int\n}\n\nfunc (a traingle) area() int {\n    return a.height * a.base / 2    \n}\n\nfunc main() {\n    var p1 shape = traingle{height: 3, base: 4}\n    fmt.Println(p1.area())\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>6\n</code></pre>\n\n<p>and see this thread example on shape: <a href=\"https://stackoverflow.com/a/38818437/8208215\">https://stackoverflow.com/a/38818437/8208215</a></p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 1294, "user_id": 2315104, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/67897548b9d55c6e2f8e3171fa7ca20d?s=128&d=identicon&r=PG", "display_name": "user2315104", "link": "https://stackoverflow.com/users/2315104/user2315104"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4221, "favorite_count": 0, "accepted_answer_id": 45638307, "answer_count": 2, "score": 0, "last_activity_date": 1502474705, "creation_date": 1502463375, "last_edit_date": 1502474705, "question_id": 45638189, "link": "https://stackoverflow.com/questions/45638189/how-to-fix-golang-too-many-arguments-error", "title": "How to fix golang too many arguments error", "body": "<p>i am using following code...</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n)\n\ntype traingle interface {\narea() int\n}\n\ntype details struct {\nheight int\nbase   int\n}\n\nfunc (a details) area() int {\n\ns := a.height + a.base\nfmt.Println(\"the area is\", s)\nreturn s\n\n}\n\nfunc main() {\nr := details{height: 3, base: 4}\nvar p1 traingle\np1.area(r)\n\n}\n</code></pre>\n\n<p>not getting why getting following error </p>\n\n<blockquote>\n  <p>too many arguments in call to p1.area\n      have (details)\n      want ()</p>\n</blockquote>\n\n<p>i am assuming that p1 object of triangle can call area() method with arguments. not getting why it is failing.</p>\n"}, {"tags": ["mysql", "join", "go"], "comments": [{"owner": {"reputation": 1543, "user_id": 8356442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8f892cf10c7afae14ab19ebbe89543?s=128&d=identicon&r=PG", "display_name": "Martin Campbell", "link": "https://stackoverflow.com/users/8356442/martin-campbell"}, "edited": false, "score": 0, "creation_date": 1502463020, "post_id": 45637808, "comment_id": 78235512, "body": "There was a similar question about this not long ago. See <a href=\"https://stackoverflow.com/questions/45374658/correct-approach-to-multiple-queries-go-rest-api/45375727#45375727\">this answer</a> which describes how to populate a struct using a primary key as a discriminator."}], "answers": [{"tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 7, "last_activity_date": 1567438028, "creation_date": 1567438028, "answer_id": 57759496, "question_id": 45637808, "link": "https://stackoverflow.com/questions/45637808/golang-db-query-with-sql-join/57759496#57759496", "title": "Golang db.Query with sql join", "body": "<p>In general it must be something like this:</p>\n\n<pre><code>func QuestionByIdAndAnswers(id string) (*Question, []*Answer, error) {\n  query := `\n    SELECT q.id, q.body, a.id, a.question_id, a.body\n    FROM question AS q\n    JOIN answer AS a ON q.id = a.question_id\n    WHERE q.id = ?\n  `\n  rows, err := db.Query(query, id)\n  checkErr(err)\n\n  question := &amp;Question{}\n  for rows.Next() {\n    answer := &amp;Answer{}\n    err = rows.Scan(\n      &amp;question.ID,\n      &amp;question.Body,\n      &amp;answer.ID,\n      &amp;answer.QuestionID,\n      &amp;answer.Body,\n    )\n    checkErr(err)\n    question.Answers = append(question.Answers, answer)\n  }\n\n  return question, question.Answers, nil\n}\n</code></pre>\n\n<p>Please pay attention, I intentionally replaced:\n<br><code>SELECT *</code> to <code>SELECT q.id, q.body, a.id, a.question_id, a.body</code>\n<br>with purpose to avoid errors like:\n<br><code>panic: sql: expected 6 destination arguments in Scan, not 5</code>\n<br>which may occur when some columns added or deleted from table, so this query more robust.</p>\n\n<p>And this is just basic implementation, you can extend it with more fields...</p>\n\n<p>PS: Function <code>checkErr</code> also omitted for brevity.</p>\n"}], "owner": {"reputation": 2810, "user_id": 5808504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/821bb6654d488185345d86bde0a586ef?s=128&d=identicon&r=PG&f=1", "display_name": "twharmon", "link": "https://stackoverflow.com/users/5808504/twharmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5367, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1567438028, "creation_date": 1502462134, "last_edit_date": 1502463108, "question_id": 45637808, "link": "https://stackoverflow.com/questions/45637808/golang-db-query-with-sql-join", "title": "Golang db.Query with sql join", "body": "<p>I would like to query for a <code>question</code> and all of its <code>answers</code>. The following two functions work just fine. The problem is I think this should be done in one function, with one query. (I removed error checking for brevity).</p>\n\n<pre><code>func QuestionById(id string) (*Question, error) {\n    question := new(Question)\n    _ = db.QueryRow(\"select * from question where question.id = ?\", id).Scan(\n        &amp;question.Id,\n        &amp;question.LessonId,\n        &amp;question.Body,\n        &amp;question.Type,\n    )\n\n    return question, nil\n}\n\nfunc AnswersByQuestionId(id string) ([]*Answer, error) {\n    rows, _ := db.Query(\"select * from answer where question_id = ?\", id)\n    defer rows.Close()\n\n    answers := make([]*Answer, 0)\n\n    for rows.Next() {\n        answer := new(Answer)\n\n        _ = rows.Scan(&amp;answer.Id, &amp;answer.Body, &amp;answer.QuestionId, &amp;answer.Correct)\n\n        answers = append(answers, answer)\n    }\n    _ = rows.Err()\n\n    return answers, nil\n}\n</code></pre>\n\n<p>I would like to use a join query in this way (or something similar):</p>\n\n<pre><code>func QuestionByIdAndAnswers(id string) (*Question, []*Answer error) {\n    rows, _ := db.Query(\"select * from question join answer on question.id = answer.question_id where question.id = ?\", id)\n\n    // more stuff here\n\n    return question, answers, nil\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "mgo"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1502462958, "post_id": 45637267, "comment_id": 78235477, "body": "Try <code>*[]*VM.VirtualMachineCdrom</code>. A nil slice == a zero length slice, but a nil pointer to a slice does not."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1502528749, "post_id": 45637267, "comment_id": 78255466, "body": "May I ask why the value must be nil?"}, {"owner": {"reputation": 176, "user_id": 3775467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/610b2c05c5be7a3a62c6862dab222997?s=128&d=identicon&r=PG&f=1", "display_name": "SokIsKedu", "link": "https://stackoverflow.com/users/3775467/sokiskedu"}, "edited": false, "score": 0, "creation_date": 1502556501, "post_id": 45637267, "comment_id": 78263603, "body": "My script runs on crontab and it compares values on Mongo and values from API if they have changed and need to be updated in mongo. But the comparison cannot happen corectly if some fields from null become zero value. I use DeepEqual to compare and it considers nil ant [] different things (of course it is supposed to). Thats Why I need to have exact data type"}, {"owner": {"reputation": 176, "user_id": 3775467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/610b2c05c5be7a3a62c6862dab222997?s=128&d=identicon&r=PG&f=1", "display_name": "SokIsKedu", "link": "https://stackoverflow.com/users/3775467/sokiskedu"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502892699, "post_id": 45637267, "comment_id": 78389770, "body": "@Adrian Your solution is exactly what I was looking for, it solves my problem."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502892840, "post_id": 45637267, "comment_id": 78389885, "body": "Glad it helped, reposted as an answer."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1504861185, "post_id": 45637267, "comment_id": 79187450, "body": "In which way does an empty slice and null make a difference? On unmarshalling, in both cases, you should have an empty slice."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1502892829, "creation_date": 1502892829, "answer_id": 45715958, "question_id": 45637267, "link": "https://stackoverflow.com/questions/45637267/how-to-insert-a-struct-with-nil-field-to-mongo/45715958#45715958", "title": "How to insert a struct with nil field to mongo?", "body": "<p>Try <code>*[]*VM.VirtualMachineCdrom</code> (or just <code>*[]VM.VirtualMachineCdrom</code> if you don't actually need the elements to be pointers). A <code>nil</code> slice == a zero length slice, but a <code>nil</code> <em>pointer to a slice</em> does not.</p>\n"}], "owner": {"reputation": 176, "user_id": 3775467, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/610b2c05c5be7a3a62c6862dab222997?s=128&d=identicon&r=PG&f=1", "display_name": "SokIsKedu", "link": "https://stackoverflow.com/users/3775467/sokiskedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 45715958, "answer_count": 1, "score": 2, "last_activity_date": 1502892829, "creation_date": 1502460566, "last_edit_date": 1502460908, "question_id": 45637267, "link": "https://stackoverflow.com/questions/45637267/how-to-insert-a-struct-with-nil-field-to-mongo", "title": "How to insert a struct with nil field to mongo?", "body": "<p>I am trying to insert a struct to mongo. Firstly I get the data from an API as JSON and assign the data to a struct. Some fields might be nil. After that I insert the struct to mongoDB. So the problem I get is that when inserted, all the fields are initialized. For example I have a struct like this: </p>\n\n<pre><code>type VirtualMachine struct {\nVirtualMachineID          utils.SUUID               `bson:\"VirtualMachineID\"`\nCdroms                    []*VM.VirtualMachineCdrom `bson:\"Cdroms\"`\nCpuAllocatedMHz           int                       `bson:\"CpuAllocatedMHz\"`\nName                      string                    `bson:\"Name\"`\n}\n</code></pre>\n\n<p>If I get Json data like this </p>\n\n<pre><code>{\n\"VirtualMachineID\":'16as4df663a',\n\"Cdroms\":null,\n\"CpuAllocatedMHz\":1666,\n\"Name\":'VMName'\n}\n</code></pre>\n\n<p>after I put it to mongo, the null field becomes an empty array. I need to avoid that. 'omitempty' did not help because it skips the field as well if the provided field happens to be an empty array and not null. </p>\n\n<p>Firstly I thought it was because of the pointers, but later I found that the same happens to all data types. Shortly, if its nil, mgo converts it to its zero value.</p>\n\n<p>I think I am missing something here, because it would be weird if mgo converts all nil values to their zero values by design. </p>\n"}, {"tags": ["go", "struct", "static-typing"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1502456864, "post_id": 45635839, "comment_id": 78231109, "body": "<code>return b.Type = typeStr</code> isn&#39;t a valid Go statement. Base isn&#39;t going to have <code>Username</code> and <code>Password</code> fields if that&#39;s what you&#39;re trying to do. There is no inheritance in Go."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1502456997, "post_id": 45635839, "comment_id": 78231197, "body": "I would recommend rethinking your design entirely from a Go perspective. Go is not an object-oriented language. It has no inheritance, and no polymorphism beyond interfaces."}, {"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 0, "creation_date": 1502457152, "post_id": 45635839, "comment_id": 78231307, "body": "Yes, I know that, but how the people solve the given problem, I have 359 struct all with the same methods, should I write them to all?"}, {"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502457205, "post_id": 45635839, "comment_id": 78231342, "body": "@JimB I fixed it"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1502457715, "post_id": 45635839, "comment_id": 78231674, "body": "@PumpkinSeed: Why does the it need to be based on methods? Most of the time one would create functions that take defined interfaces. Another solution for huge amount of repetitive code is of course code generation."}], "answers": [{"comments": [{"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "edited": false, "score": 1, "creation_date": 1502458819, "post_id": 45636408, "comment_id": 78232494, "body": "Thanks, that&#39;s exactly what I&#39;m looking for."}, {"owner": {"reputation": 496, "user_id": 5977709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wp5WfpAAGHo/AAAAAAAAAAI/AAAAAAAAASc/-Lw55LJlMJ8/photo.jpg?sz=128", "display_name": "Dusan Gligoric", "link": "https://stackoverflow.com/users/5977709/dusan-gligoric"}, "edited": false, "score": 0, "creation_date": 1585335266, "post_id": 45636408, "comment_id": 107733213, "body": "Would this solution be considered hacky? It sure does the trick and it helps with code repetition, should one avoid this sort of solution?"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 6, "last_activity_date": 1502458068, "creation_date": 1502458068, "answer_id": 45636408, "question_id": 45635839, "link": "https://stackoverflow.com/questions/45635839/golang-base-struct-to-define-methods-in-substructs/45636408#45636408", "title": "Golang base struct to define methods in substructs", "body": "<p>As mentioned in the comments, embedding is not inheritance but composition, so you'll probably have to either:</p>\n\n<ul>\n<li>Re-think your design to use the tools Go has available</li>\n<li>Resort to extensive hacking to get the results you want</li>\n</ul>\n\n<p>In the particular case you are showing (trying to get <code>GetJSON()</code> to include also the fields of the outer struct, here is a possible way of getting that to work that does not require many changes (just storing a pointer to the outer struct in Base when creating the struct):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Base struct {\n    Type  string      `json:\"$type\"`\n    selfP interface{} // this will store a pointer to the actual sub struct\n}\n\nfunc (b *Base) SetSelfP(p interface{}) {\n    b.selfP = p\n}\n\nfunc (b *Base) GetJSON() ([]byte, error) {\n    return json.Marshal(b.selfP)\n}\n\nfunc (b *Base) SetType(typeStr string) {\n    b.Type = typeStr\n}\n\ntype Auth struct {\n    Base\n    Username string\n    Password string\n}\n\nfunc main() {\n    a := &amp;Auth{\n        Username: \"Test\",\n        Password: \"test\",\n    }\n    a.SetSelfP(a) // this line does the trick\n    a.SetType(\"testtype\")\n    j, _ := a.GetJSON()\n    fmt.Println(string(j))\n}\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/npuy6XMk_t\" rel=\"noreferrer\">https://play.golang.org/p/npuy6XMk_t</a></p>\n"}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4769, "favorite_count": 1, "accepted_answer_id": 45636408, "answer_count": 1, "score": 2, "last_activity_date": 1502458068, "creation_date": 1502456314, "last_edit_date": 1502457083, "question_id": 45635839, "link": "https://stackoverflow.com/questions/45635839/golang-base-struct-to-define-methods-in-substructs", "title": "Golang base struct to define methods in substructs", "body": "<p>I would like to create a base struct which have to method, I want to use these methods in the substructs. For example:</p>\n\n<pre><code>type Base struct {\n  Type string `json:\"$type\"`\n}\n\nfunc (b Base) GetJSON() ([]byte, error) {\n  return json.Marshal(b)\n}\n\nfunc (b Base) SetType(typeStr string) interface{} {\n  b.Type = typeStr\n  return b\n}\n</code></pre>\n\n<p>In the new struct I want to use it like this:</p>\n\n<pre><code>type Auth struct {\n  Base\n  Username\n  Password\n}\n</code></pre>\n\n<p>and call these methods in the main: </p>\n\n<pre><code>func main() {\n  a := Auth{\n    Username: \"Test\",\n    Password: \"test\",\n  }\n  a = a.SetType(\"testtype\").(Auth) \n  j, _ := a.GetJSON()\n}\n</code></pre>\n\n<p>In the SetType case I got a panic caused by interface{} is not <code>Auth</code> type, it is <code>Base</code> type.\nIn the GetJSON case I got a json about the Type, but only the Type.</p>\n\n<p>Is there any solution for the problem what I want to solve?</p>\n"}, {"tags": ["go", "kubernetes", "kubectl", "kubernetes-go-client"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 8394973, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f2249630bdc88c1456fe7cab1643af4?s=128&d=identicon&r=PG&f=1", "display_name": "dkat", "link": "https://stackoverflow.com/users/8394973/dkat"}, "edited": false, "score": 0, "creation_date": 1502460738, "post_id": 45636982, "comment_id": 78233910, "body": "thank you !! figured it  - &gt;  fmt.Println(dp.GetObjectMeta().GetAnnotations()[&quot;deployment.&zwnj;&#8203;kubernetes.io/revisi&zwnj;&#8203;on&quot;]) is what i was looking."}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "reply_to_user": {"reputation": 167, "user_id": 8394973, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f2249630bdc88c1456fe7cab1643af4?s=128&d=identicon&r=PG&f=1", "display_name": "dkat", "link": "https://stackoverflow.com/users/8394973/dkat"}, "edited": false, "score": 0, "creation_date": 1502463046, "post_id": 45636982, "comment_id": 78235537, "body": "You&#39;re welcome. Rather than thanking me, mark the answer as correct, upvote it or answer it yourself with the correct answer. This is how it&#39;s supposed to work around here ;)"}], "tags": [], "owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "is_accepted": true, "score": 1, "last_activity_date": 1502459703, "creation_date": 1502459703, "answer_id": 45636982, "question_id": 45634812, "link": "https://stackoverflow.com/questions/45634812/rollback-the-deployment-using-client-go-api/45636982#45636982", "title": "Rollback the deployment using client-go api", "body": "<p>Assuming you already had a look at the <a href=\"https://github.com/kubernetes/client-go/tree/master/examples/create-update-delete-deployment\" rel=\"nofollow noreferrer\">update example</a>?</p>\n\n<p>In any case, the <code>dp</code> variable here contains all you need:</p>\n\n<pre><code>dp, err := clientset.ExtensionsV1beta1Client.Deployments(\"default\").Get(\"nginx-deployment\", metav1.GetOptions{})\n</code></pre>\n\n<p>So <code>dp</code> is of type <code>v1beta1.Deployment</code> which contains a variable of type <code>metav1.ObjectMeta</code> which has the <code>ResourceVersion</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6389029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba12f577ba48edae628c02a73a4f3018?s=128&d=identicon&r=PG&f=1", "display_name": "dujiacheng", "link": "https://stackoverflow.com/users/6389029/dujiacheng"}, "is_accepted": false, "score": 0, "last_activity_date": 1541478846, "creation_date": 1541478846, "answer_id": 53165785, "question_id": 45634812, "link": "https://stackoverflow.com/questions/45634812/rollback-the-deployment-using-client-go-api/53165785#53165785", "title": "Rollback the deployment using client-go api", "body": "<pre><code>clientset, err := kubernetes.NewForConfig(config)\ndeploymentsClient := clientset.AppsV1().Deployments(\"yournamespace\")\nresult, err := deploymentsClient.Get(\"yourdeployment\", metav1.GetOptions{})\nversion := result.GetObjectMeta().GetAnnotations()[\"deployment.kubernetes.io/revision\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 12456440, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--BHmBjj_Ejs/AAAAAAAAAAI/AAAAAAAAAAc/EOcvB0vi-5c/photo.jpg?sz=128", "display_name": "Clare Chu", "link": "https://stackoverflow.com/users/12456440/clare-chu"}, "is_accepted": false, "score": 0, "last_activity_date": 1592294738, "last_edit_date": 1592294738, "creation_date": 1592294194, "answer_id": 62403673, "question_id": 45634812, "link": "https://stackoverflow.com/questions/45634812/rollback-the-deployment-using-client-go-api/62403673#62403673", "title": "Rollback the deployment using client-go api", "body": "<p>try try \n<a href=\"https://github.com/kubernetes/kubernetes/blob/17fec00b8915dbffac40b9eb481516a66092ef3e/pkg/controller/deployment/rollback.go#L30-L69\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/kubernetes/blob/17fec00b8915dbffac40b9eb481516a66092ef3e/pkg/controller/deployment/rollback.go#L30-L69</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\nimport (\n    \"fmt\"\n\n    \"github.com/golang/glog\"\n\n    \"k8s.io/api/core/v1\"\n    extensions \"k8s.io/api/extensions/v1beta1\"\n    \"k8s.io/apimachinery/pkg/types\"\n    deploymentutil \"k8s.io/kubernetes/pkg/controller/deployment/util\"\n)\n\n\n\nfunc (un *Uninject) rollbackToTemplate(d *v1.Deployment, rs []v1.ReplicaSet) (bool, error) {\n\n    sort.Slice(rs, func(i, j int) bool {\n        return rs[i].CreationTimestamp.UnixNano() &gt; rs[j].CreationTimestamp.UnixNano()\n\n    })\n    performedRollback := false\n    replicaSet := v1.ReplicaSet{}\n    for _, r := range rs {\n        for _, initContainer := range r.Spec.Template.Spec.InitContainers {\n            if initContainer.Name == \"istio-init\" {\n                performedRollback = true\n                break\n            } else {\n                klog.V(4).Infof(\"Rolling back to a revision that contains the same template as current deployment %q, skipping rollback...\", d.Name)\n            }\n        }\n        if len(r.Spec.Template.Spec.InitContainers) == 0 || !performedRollback {\n            replicaSet = r\n            performedRollback = true\n            break\n        }\n    }\n    if performedRollback {\n        klog.V(4).Infof(\"Rolling back deployment %q to template spec %+v\", d.Name, replicaSet.Spec.Template.Spec)\n        deploymentutil.SetFromReplicaSetTemplate(d, replicaSet.Spec.Template)\n        deploymentutil.SetDeploymentAnnotationsTo(d, &amp;replicaSet)\n    }\n    return performedRollback, un.updateDeploymentAndClearRollbackTo(d)\n}\n\n// updateDeploymentAndClearRollbackTo sets .spec.rollbackTo to nil and update the input deployment\n// It is assumed that the caller will have updated the deployment template appropriately (in case\n// we want to rollback).\nfunc (un *Uninject) updateDeploymentAndClearRollbackTo(d *v1.Deployment) error {\n    klog.Infof(\"Cleans up rollbackTo of deployment %q\", d.Name)\n    _, err := un.clientSet.AppsV1().Deployments(d.Namespace).Update(context.TODO(), d, metav1.UpdateOptions{})\n    return err\n}\n\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 8394973, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f2249630bdc88c1456fe7cab1643af4?s=128&d=identicon&r=PG&f=1", "display_name": "dkat", "link": "https://stackoverflow.com/users/8394973/dkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 1, "accepted_answer_id": 45636982, "answer_count": 3, "score": 2, "last_activity_date": 1592294738, "creation_date": 1502453049, "question_id": 45634812, "link": "https://stackoverflow.com/questions/45634812/rollback-the-deployment-using-client-go-api", "title": "Rollback the deployment using client-go api", "body": "<p>I would like to roll back the deployment to a certain revision( rollout history) using client-go library of k8s. But so far I havent found a solution. I could onyl fetch resource revision but not 'deployment revision' that I get using kebctl </p>\n\n<pre><code>kubectl rollout history deployment/nginx_dep\n</code></pre>\n\n<p>Here is the code using client-go api :</p>\n\n<pre><code>config, err := clientcmd.BuildConfigFromFlags(\"\", *kubeconfig)\n\nclientset, err := kubernetes.NewForConfig(config)\n\ndp, err := clientset.ExtensionsV1beta1Client.Deployments(\"default\").Get(\"nginx-deployment\", metav1.GetOptions{})\n</code></pre>\n\n<p><strong><em>Using client-go api:\nHow do I get the existing revision for the given deployment.? I want to roll back the deployment to use this revision. Can anyone tell me how I should do that??</em></strong></p>\n\n<p>Here is the list of dependecies in my project:</p>\n\n<pre><code>[[constraint]]\n  name = \"k8s.io/client-go\"\n  version = \"3.0.0\"\n\n[[override]]\n  name = \"k8s.io/apimachinery\"\n  branch = \"release-1.6\"\n</code></pre>\n\n<p>Thank you in advance</p>\n"}]