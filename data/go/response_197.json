[{"tags": ["amazon-web-services", "go", "amazon-dynamodb"], "comments": [{"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1539822719, "post_id": 52865067, "comment_id": 92644820, "body": "Note that contains() does a substring match, not an equality match."}, {"owner": {"reputation": 3, "user_id": 10521173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1516ba0f02456e4aabe303025248e201?s=128&d=identicon&r=PG&f=1", "display_name": "jaksonwkr", "link": "https://stackoverflow.com/users/10521173/jaksonwkr"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1539823884, "post_id": 52865067, "comment_id": 92645062, "body": "I did test with &quot;NOT email = :e_mail&quot; and &quot;email &lt;&gt; :e_mail&quot; but didn&#39;t work too"}, {"owner": {"reputation": 3, "user_id": 10521173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1516ba0f02456e4aabe303025248e201?s=128&d=identicon&r=PG&f=1", "display_name": "jaksonwkr", "link": "https://stackoverflow.com/users/10521173/jaksonwkr"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1539828728, "post_id": 52865067, "comment_id": 92645938, "body": "I resolved doing a scan befone insert"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1539829674, "post_id": 52865067, "comment_id": 92646135, "body": "That&#39;s not ideal for two reasons: a) scan will iterate over the entire table and b) it&#39;s possible for some other process to put the same email address between your scan and your put. That said, you can get what you want by making email address a primary key and using a conditional put."}, {"owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "edited": false, "score": 0, "creation_date": 1539837812, "post_id": 52865067, "comment_id": 92647840, "body": "@Jakson where did you get the syntax of that condition <code>NOT contains(email, :e_email)</code> I can&#39;t find it in aws&#39; docs"}, {"owner": {"reputation": 3, "user_id": 10521173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1516ba0f02456e4aabe303025248e201?s=128&d=identicon&r=PG&f=1", "display_name": "jaksonwkr", "link": "https://stackoverflow.com/users/10521173/jaksonwkr"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1539853371, "post_id": 52865067, "comment_id": 92654608, "body": "@jarmod I used this docs, there&#39;s no example with NOT contanis()  <a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Expressions.OperatorsAndFunctions.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/amazondynamodb/latest/developerguide/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 10521173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1516ba0f02456e4aabe303025248e201?s=128&d=identicon&r=PG&f=1", "display_name": "jaksonwkr", "link": "https://stackoverflow.com/users/10521173/jaksonwkr"}, "edited": false, "score": 0, "creation_date": 1539853608, "post_id": 52865067, "comment_id": 92654738, "body": "I will try with email as primary key and use attribute_not_exists() Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "is_accepted": true, "score": 4, "last_activity_date": 1539866565, "creation_date": 1539866565, "answer_id": 52874323, "question_id": 52865067, "link": "https://stackoverflow.com/questions/52865067/condition-expression-on-dynamodb-putitem/52874323#52874323", "title": "Condition expression on DynamoDB PutItem", "body": "<p>You're misunderstanding how conditional expressions work. DynamoDB is not testing <em>all</em> items in the table for a matching email. It's testing <em>this</em> item for a matching email. Your conditional expression is only being applied to the item whose ID you are actually presenting on the put call, if there is such an item.</p>\n\n<p>Remember that PutItem can be used to insert a new item, but it can also be used to replace existing items. If an item with that ID is absent, which I presume is indeed the case here because you're writing a new ID, then your conditional expression will <em>never</em> work.</p>\n\n<p>Make email a primary key then you can use a conditional expression to test for presence and reject duplicate email insertion. Use the attribute_not_exists function with the name of the email attribute.</p>\n"}], "owner": {"reputation": 3, "user_id": 10521173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1516ba0f02456e4aabe303025248e201?s=128&d=identicon&r=PG&f=1", "display_name": "jaksonwkr", "link": "https://stackoverflow.com/users/10521173/jaksonwkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2684, "favorite_count": 0, "accepted_answer_id": 52874323, "answer_count": 1, "score": 0, "last_activity_date": 1539866565, "creation_date": 1539819901, "question_id": 52865067, "link": "https://stackoverflow.com/questions/52865067/condition-expression-on-dynamodb-putitem", "title": "Condition expression on DynamoDB PutItem", "body": "<p>I'm trying to use a condition to put a intem on DynamoDB, but doesn't work.</p>\n\n<p>I have a table of users and a attribute id as primary key and attibute name must be unique.</p>\n\n<pre><code>conditions := aws.String(\"NOT contains(email, :e_email)\")\nattributes := map[string]*dynamodb.AttributeValue{\n    \":e_mail\": &amp;dynamodb.AttributeValue{\n        S: &amp;user.Email,\n    },\n}\ninput := &amp;dynamodb.PutItemInput{\n    Item:                item,\n    TableName:           dynamoTable,\n    ConditionExpression: conditions,\n    ExpressionAttributeValues: attributes,\n}\n_, err = dynamo.PutItemWithContext(ctx1, input)\nif err != nil {\n    if erro, ok := err.(awserr.Error); ok {\n        if erro.Code() == dynamodb.ErrCodeConditionalCheckFailedException {\n            log.Println(\"User already exists\")\n            body, _ := json.Marshal(models.ErrUsuarioJaExiste)\n            resp.StatusCode = models.ErrUsuarioJaExiste.CodigoHTTP\n            resp.Body = string(body)\n            return resp\n        }\n    }\n\n    log.Println(err)\n    resp.StatusCode = models.ErrInterno.CodigoHTTP\n    body, _ := json.Marshal(models.ErrInterno)\n    resp.Body = string(body)\n    return resp\n}\n</code></pre>\n\n<p>But I still can add items with the same email</p>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 2, "creation_date": 1539814891, "post_id": 52864354, "comment_id": 92643087, "body": "I experience it only in first run (go run or build and run exe). Second run is instant."}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1539815682, "post_id": 52864354, "comment_id": 92643300, "body": "BTW, I have Goland too. If I use Goland, from within GoLand, it runs instantly whether first or not."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1539817764, "post_id": 52864354, "comment_id": 92643852, "body": "what version of Go are you running? Go1.10 and later have improved build times, see <a href=\"https://stackoverflow.com/a/47109826/3915\">this answer</a>."}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1539825790, "post_id": 52864354, "comment_id": 92645419, "body": "Are you using a local drive on your Windows machine, or a network drive?"}, {"owner": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "edited": false, "score": 0, "creation_date": 1539826313, "post_id": 52864354, "comment_id": 92645516, "body": "I&#39;m using go 1.11 on my local machine. All the files are local. Given that y&#39;all are not experiencing this, it has to be my setup that causes this."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1539841729, "post_id": 52864354, "comment_id": 92648917, "body": "I have two comments.  First, it&#39;s simple: just don&#39;t use MS Windows.  Second, on my Macbook the first run of a go build is much slower than 5 seconds but subsequent runs are in line with Linux"}, {"owner": {"reputation": 4920, "user_id": 5401681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/852873768142712/picture?type=large", "display_name": "Inconnu", "link": "https://stackoverflow.com/users/5401681/inconnu"}, "edited": false, "score": 0, "creation_date": 1539842886, "post_id": 52864354, "comment_id": 92649296, "body": "Completely uninstall and reinstall Go should do the trick."}, {"owner": {"reputation": 1682, "user_id": 655085, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/mHxsC.jpg?s=128&g=1", "display_name": "Ajay Bhosale", "link": "https://stackoverflow.com/users/655085/ajay-bhosale"}, "edited": false, "score": 1, "creation_date": 1547087986, "post_id": 52864354, "comment_id": 95074634, "body": "@Husain - are you still facing this problem? I am in the same boat, I have two windows laptop, on one laptop it build takes just 2 sec, while on other it takes 10 sec. Both are high end laptops. I tried disabling antivirus, but no improvements, version 1.11.4"}, {"owner": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "reply_to_user": {"reputation": 1682, "user_id": 655085, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/mHxsC.jpg?s=128&g=1", "display_name": "Ajay Bhosale", "link": "https://stackoverflow.com/users/655085/ajay-bhosale"}, "edited": false, "score": 0, "creation_date": 1547131688, "post_id": 52864354, "comment_id": 95093568, "body": "@AjayBhosale Yes I am still facing the problem, and I could not find a solution for it.It is not a caching problem or anything. Now that you mentioned it is not an antivirus issue, I have no clue what it is."}, {"owner": {"reputation": 11257, "user_id": 10197418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/be8Y6.jpg?s=128&g=1", "display_name": "MrFuppes", "link": "https://stackoverflow.com/users/10197418/mrfuppes"}, "edited": false, "score": 0, "creation_date": 1612363640, "post_id": 52864354, "comment_id": 116743940, "body": "related: <a href=\"https://stackoverflow.com/q/32062493/10197418\">golang is slow in Windows</a>. for me, configuring my AntiVirus correctly did the trick."}], "answers": [{"comments": [{"owner": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "edited": false, "score": 0, "creation_date": 1540064291, "post_id": 52893511, "comment_id": 92729537, "body": "Thanks Francois. But it looks like my GOCACHE is set. so builds should be cached."}, {"owner": {"reputation": 56, "user_id": 10527856, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1W1BVBedIkY/AAAAAAAAAAI/AAAAAAAAA5E/WnagCOAgScE/photo.jpg?sz=128", "display_name": "Fran&#231;ois Bastien", "link": "https://stackoverflow.com/users/10527856/fran%c3%a7ois-bastien"}, "reply_to_user": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "edited": false, "score": 0, "creation_date": 1540067209, "post_id": 52893511, "comment_id": 92730330, "body": "I don&#39;t think it is effective if two consecutive builds take so long, the second should be quasi instant, like in linux, except if something is wrong with the cache config. I would bet on the GOCACHE folder. Maybe it doesn&#39;t exists, or the permissions are wrong. But I can be wrong. Can you create a file in this folder with the same user that execute go build?"}, {"owner": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "edited": false, "score": 0, "creation_date": 1540301940, "post_id": 52893511, "comment_id": 92808906, "body": "Yup. I am able to create folders using the same username. :/ I am now guessing that it is the anti-virus software installed. I don&#39;t know for sure and I can&#39;t uninstall it to test since this is the companies machine. :/"}], "tags": [], "owner": {"reputation": 56, "user_id": 10527856, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1W1BVBedIkY/AAAAAAAAAAI/AAAAAAAAA5E/WnagCOAgScE/photo.jpg?sz=128", "display_name": "Fran&#231;ois Bastien", "link": "https://stackoverflow.com/users/10527856/fran%c3%a7ois-bastien"}, "is_accepted": false, "score": 1, "last_activity_date": 1539956298, "creation_date": 1539956298, "answer_id": 52893511, "question_id": 52864354, "link": "https://stackoverflow.com/questions/52864354/go-commands-run-slow-on-my-windows-machine-and-fine-on-my-linux/52893511#52893511", "title": "go commands run slow on my windows machine, and fine on my linux", "body": "<p>It seems that the <a href=\"https://golang.org/cmd/go/#hdr-Build_and_test_caching\" rel=\"nofollow noreferrer\">build cache</a> is disabled on your Windows and enabled on your Linux.</p>\n\n<p>Go build keeps the result of compilations and reuse it if the .go file hasn't changed. That's why your second build is so fast in Linux.</p>\n\n<p>If you disable it, not only your code, but also all the dependancies must be recompiled each time. Thus even if you change your code, all the libs (here \"fmt\") are already in cache.</p>\n\n<p>To test it, run <code>go clean -cache</code> before the <code>go build</code> on Linux, and see if the time correspond to the time on your Windows. Then if it matches, you have to find why the build cache is disabled on Windows.</p>\n\n<p>You can see the cache directory by typing <code>go env GOCACHE</code>. If the response is off, the cache is off. Otherwise verify that the repository exists and it has the right permissions.</p>\n\n<p>You can choos the cache directory by setting the value of the GOCACHE environment variable (sorry I don't know how to do this in Windows).</p>\n"}], "owner": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539956298, "creation_date": 1539814389, "last_edit_date": 1539826217, "question_id": 52864354, "link": "https://stackoverflow.com/questions/52864354/go-commands-run-slow-on-my-windows-machine-and-fine-on-my-linux", "title": "go commands run slow on my windows machine, and fine on my linux", "body": "<p>I don't know if someone else is running into this problem. I have this main.go file:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"hello world\")\n}\n</code></pre>\n\n<p>when I run go build, it takes 5 secs to run it (regardless if it is the first time I run it or if it is the second time)</p>\n\n<pre><code>PS&gt; Measure-Command {Start-Process go build -wait}\n\nDays              : 0\nHours             : 0\nMinutes           : 0\nSeconds           : 5\nMilliseconds      : 151\nTicks             : 51514117\nTotalDays         : 5.96228206018519E-05\nTotalHours        : 0.00143094769444444\nTotalMinutes      : 0.0858568616666667\nTotalSeconds      : 5.1514117\nTotalMilliseconds : 5151.4117\n</code></pre>\n\n<p>But when I run it on a linux machine:</p>\n\n<pre><code>time go build\n\nreal    0m2.017s\nuser    0m0.054s\nsys     0m1.915s\n</code></pre>\n\n<p>and when I run it for the second time:</p>\n\n<pre><code>time go build\n\nreal    0m0.120s\nuser    0m0.072s\nsys     0m0.088s\n</code></pre>\n\n<p>This is not only build, but also some of go tools such as fmt. It takes 0.12 seconds on linux, but almost 3 seconds on windows. Other tools like guru, gocode, etc. suffer the same problem, making code development very slow.</p>\n\n<p>I'm using golang 1.11. I'm using an SSD and everything is running locally. Sorry I wish I could be more helpful but I really have no idea where to start to debug this. </p>\n\n<p>Does anyone has an idea what's going on?</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-storage", "google-calendar-api", "google-api-client"], "comments": [{"owner": {"reputation": 1040, "user_id": 2549487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfcc724ce832c29b776b1c3413e101e9?s=128&d=identicon&r=PG", "display_name": "webofmars", "link": "https://stackoverflow.com/users/2549487/webofmars"}, "edited": false, "score": 0, "creation_date": 1540315773, "post_id": 52863364, "comment_id": 92817168, "body": "Any help on this topic ?"}, {"owner": {"reputation": 1601, "user_id": 7650339, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211714121623540/picture?type=large", "display_name": "I&#241;igo", "link": "https://stackoverflow.com/users/7650339/i%c3%b1igo"}, "edited": false, "score": 0, "creation_date": 1540553730, "post_id": 52863364, "comment_id": 92919208, "body": "where are you running the code, in GAE? Are you using the <a href=\"https://cloud.google.com/storage/docs/reference/libraries#client-libraries-install-go\" rel=\"nofollow noreferrer\">client libraries</a> for Go?"}, {"owner": {"reputation": 1040, "user_id": 2549487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfcc724ce832c29b776b1c3413e101e9?s=128&d=identicon&r=PG", "display_name": "webofmars", "link": "https://stackoverflow.com/users/2549487/webofmars"}, "reply_to_user": {"reputation": 1601, "user_id": 7650339, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211714121623540/picture?type=large", "display_name": "I&#241;igo", "link": "https://stackoverflow.com/users/7650339/i%c3%b1igo"}, "edited": false, "score": 0, "creation_date": 1540566709, "post_id": 52863364, "comment_id": 92926662, "body": "@I&#241;igo: No it&#39;s running on my own infrastructure on a little program i wrote : <a href=\"https://github.com/webofmars/oncall-buddy-finder\" rel=\"nofollow noreferrer\">github.com/webofmars/oncall-buddy-finder</a>. And yes i used the both Golang Gooogle Cloud lib and Google API lib"}], "owner": {"reputation": 1040, "user_id": 2549487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfcc724ce832c29b776b1c3413e101e9?s=128&d=identicon&r=PG", "display_name": "webofmars", "link": "https://stackoverflow.com/users/2549487/webofmars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540480387, "creation_date": 1539809211, "last_edit_date": 1540480387, "question_id": 52863364, "link": "https://stackoverflow.com/questions/52863364/google-calendar-and-google-cloud-storage-with-service-account", "title": "Google Calendar and Google Cloud Storage with service account?", "body": "<p>I'am writing a Golang app that will read calendars events in Google suite and after some processing output some content to a json file stored on Google Storage.</p>\n\n<p>Is there any simple way of accessing these 2 things using the same credentials, preferably a Service Account to avoid Oauth Token URL asking at startup ?</p>\n\n<p>I did find about Delegation (as explained here <a href=\"https://developers.google.com/admin-sdk/directory/v1/guides/delegation\" rel=\"nofollow noreferrer\">https://developers.google.com/admin-sdk/directory/v1/guides/delegation</a>) but i'm not sure this is the right way to go and it will success for storage as well.</p>\n\n<p>Any help appreciated</p>\n"}, {"tags": ["date", "datetime", "go"], "answers": [{"tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": true, "score": 2, "last_activity_date": 1539810346, "last_edit_date": 1539810346, "creation_date": 1539810045, "answer_id": 52863551, "question_id": 52863299, "link": "https://stackoverflow.com/questions/52863299/if-condition-is-going-wrong-in-golang/52863551#52863551", "title": "if condition is going wrong in golang", "body": "<p>It is about scoping, the mininttimeconfig you are using in check has the value of 0. </p>\n\n<pre><code>if mininttimeconfig, err := strconv.Atoi(strconfigtime); err == nil {\n    // mininttimeconfig is a new variable scoped to this block\n}\n\n// here mininttimeconfig is 0 from declaration line\n// var mininttimeconfig int\n</code></pre>\n\n<p>Try changing the lines as:</p>\n\n<pre><code>    var mininttimeconfig int\n    mininttimeconfig, err = strconv.Atoi(strconfigtime);\n    if err == nil { \n       // ...\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>    mininttimeconfig, err := strconv.Atoi(strconfigtime);\n    if err == nil { \n       // ...\n</code></pre>\n\n<p>Note generally error is used like if err != nil {...}</p>\n"}], "owner": {"reputation": 213, "user_id": 9223221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db22d31457019f8db39916c60d012fc?s=128&d=identicon&r=PG&f=1", "display_name": "btc user", "link": "https://stackoverflow.com/users/9223221/btc-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 52863551, "answer_count": 1, "score": 0, "last_activity_date": 1539845705, "creation_date": 1539809007, "last_edit_date": 1539845705, "question_id": 52863299, "link": "https://stackoverflow.com/questions/52863299/if-condition-is-going-wrong-in-golang", "title": "if condition is going wrong in golang", "body": "<p>I'm calculating date difference in golang, I have written code and it is executing fine but when i take the difference of time in minutes, convert the same to integer and comparing in if condition.</p>\n\n<p>code which im trying</p>\n\n<p>as per the below condition, it should not print \"diffinmin is greater\nP\" but it is printing. Where im doing wrong?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"strconv\"\n)\n\nfunc main() {\n    //fetching current time\n    currentTime := time.Now()\n    loc := currentTime.Location()\n    //past time comes in as string\n    pasttimestr := \"2018-10-18 01:00\"\n    layout := \"2006-01-02 15:04\"\n    //converting string to date\n    pasttime, err := time.ParseInLocation(layout, pasttimestr, loc)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(\"Past Time: \", pasttime)\n    fmt.Println(\"Current Time: \", currentTime)\n    //differnce between pastdate and current date\n    diff := currentTime.Sub(pasttime)\n    var diffinmin int = int(diff.Minutes())\n    fmt.Printf( \"heloo\",diffinmin )\n    fmt.Printf(\"time difference is %v or %v in minutes\\n\", diff, diff.Minutes())\n    var strconfigtime = \"9000\"\n    var mininttimeconfig int\n    if mininttimeconfig, err := strconv.Atoi(strconfigtime); err == nil {\n    fmt.Printf(\"i=%d, type: %T\\n\", mininttimeconfig, mininttimeconfig)\n     }\n\n    if diffinmin  &gt;  mininttimeconfig {\n    fmt.Printf(\"diffinmin is greater\" )\n    }\n\n}\n</code></pre>\n\n<p>fiddle: <a href=\"https://play.golang.org/p/x6-RebYycpk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/x6-RebYycpk</a></p>\n"}, {"tags": ["go", "concurrency", "thread-safety"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 2, "creation_date": 1539809300, "post_id": 52863273, "comment_id": 92641104, "body": "1) What kind of &quot;thread-safety&quot; is required/desired? 2) Look at <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\">golang.org/pkg/sync</a> ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1539809593, "post_id": 52863273, "comment_id": 92641233, "body": "<code>synchronized</code> in Java is a mean to allow only a single thread to execute a code block. In Go there are numerous constructs to achieve that (e.g. mutexes, channels, waitgroups), but Go&#39;s proverb is: <i>&quot;Do not communicate by sharing memory; instead, share memory by communicating.&quot;</i> So instead of locking and sharing a variable, try to not do that but instead communicate the result between goroutines e.g. using channels (so you won&#39;t have to access shared memory). For details, see <a href=\"https://blog.golang.org/share-memory-by-communicating\" rel=\"nofollow noreferrer\">blog.golang.org/share-memory-by-communicating</a>"}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 1, "creation_date": 1539842355, "post_id": 52863273, "comment_id": 92649129, "body": "Give some example code here and people can suggest a mechanism. There is no way to do this at a variable declaration, but you probably don&#39;t need to."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1539876963, "post_id": 52863273, "comment_id": 92668790, "body": "@icza, I&#39;d say it&#39;d be better to convert your comment to an answer. The other two are not too good: one focuses on a particular solution too much and another is simply a glib response to a phrase ripped out of context."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1539895770, "post_id": 52863273, "comment_id": 92678215, "body": "@kostix Did so, but it ended up longer than I thought it would. Obviously the topic is even bigger, maybe I improve it tomorrow."}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1539945949, "post_id": 52863273, "comment_id": 92694175, "body": "&quot;thread safe&quot; isn&#39;t a well-defined term, you must describe what you mean by &quot;thread safe&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 5, "creation_date": 1539863743, "post_id": 52864119, "comment_id": 92660278, "body": "This isn&#39;t a very helpful answer, could you explain?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 2, "creation_date": 1539864498, "post_id": 52864119, "comment_id": 92660730, "body": "@PeterMellett The OP asked whether there is some kind of language construct to &quot;synchronize&quot; access to a variable and there is no such thing in Go. You have to do this &quot;by hand&quot;. The answer is helpful: &quot;No there is not, you can stop looking for it.&quot;"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -15, "last_activity_date": 1539812986, "creation_date": 1539812986, "answer_id": 52864119, "question_id": 52863273, "link": "https://stackoverflow.com/questions/52863273/how-to-make-a-variable-thread-safe/52864119#52864119", "title": "How to make a variable thread-safe", "body": "<blockquote>\n  <p>Is there any way to synchronize variables?</p>\n</blockquote>\n\n<p>No.</p>\n"}, {"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1539946088, "post_id": 52882045, "comment_id": 92694239, "body": "A nice overview! May I suggest renaming the mutex&#39;s field to just <code>mu</code> and putting it above the variable it protects? This convention is not for some reason listed <a href=\"https://github.com/golang/go/wiki/CodeReviewComments\" rel=\"nofollow noreferrer\">in <i>the guide</i></a> but is spelled explicitly in <a href=\"http://www.gopl.io\" rel=\"nofollow noreferrer\"><i>The Book</i></a> ;-) Basically, a mutex variable (barring the need to have more than one in a struct) is named <code>mu</code> and is put above the set of fields it protects (all possibly preceded by a blank line)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1539947688, "post_id": 52882045, "comment_id": 92695082, "body": "@kostix Thanks. Done with some other minor adjustments. I was already grouping the mutex with what it protects in the variable declaration, but yes, listing the mutex first is handy. Also <code>mu</code> is the most common name used for short mutex name."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1580126899, "last_edit_date": 1580126899, "creation_date": 1539894500, "answer_id": 52882045, "question_id": 52863273, "link": "https://stackoverflow.com/questions/52863273/how-to-make-a-variable-thread-safe/52882045#52882045", "title": "How to make a variable thread-safe", "body": "<p><code>synchronized</code> in Java is a mean to allow only a single thread to execute a code block (at any given time).</p>\n\n<p>In Go there are numerous constructs to achieve that (e.g. mutexes, channels, waitgroups, primitives in <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"noreferrer\"><code>sync/atomic</code></a>), but Go's proverb is: <em>\"Do not communicate by sharing memory; instead, share memory by communicating.\"</em></p>\n\n<p>So instead of locking and sharing a variable, try to not do that but instead communicate the result between goroutines e.g. using channels (so you won't have to access shared memory). For details, see <a href=\"https://blog.golang.org/share-memory-by-communicating\" rel=\"noreferrer\">The Go Blog:\nShare Memory By Communicating</a>.</p>\n\n<p>Of course there may be cases when the simplest, direct solution is to use a mutex to protect concurrent access from multiple goroutines to a variable. When this is the case, this is how you can do that:</p>\n\n<pre><code>var (\n    mu        sync.Mutex\n    protectMe int\n)\n\nfunc getMe() int {\n    mu.Lock()\n    me := protectMe\n    mu.Unlock()\n    return me\n}\n\nfunc setMe(me int) {\n    mu.Lock()\n    protectMe = me\n    mu.Unlock()\n}\n</code></pre>\n\n<p>The above solution could be improved in several areas:</p>\n\n<ul>\n<li><p>Use <a href=\"https://golang.org/pkg/sync/#RWMutex\" rel=\"noreferrer\"><code>sync.RWMutex</code></a> instead of <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"noreferrer\"><code>sync.Mutex</code></a>, so that the <code>getMe()</code> may lock for reading only, so multiple concurrent readers would not block each other.</p></li>\n<li><p>After a (successful) locking it is advisable to unlock using <code>defer</code>, so if something bad happens in the subsequent code (e.g. runtime panic), the mutex will still be unlocked, avoiding resource leaks and deadlocks. Although this example is so simple, nothing bad could happen and does not warrant unconditional use of deferred unlocking.</p></li>\n<li><p>It is good practice to keep the mutex close to the data it is ought to protect. So \"wrapping\" <code>protectMe</code> and its <code>mu</code> in a struct is a good idea. And if we're at it, we may also use embedding, so locking / unlocking becomes more convenient (unless this functionality must not be exposed). For details, see <a href=\"https://stackoverflow.com/questions/44949467/when-do-you-embed-mutex-in-struct-in-go/44950096#44950096\">When do you embed mutex in struct in Go?</a></p></li>\n</ul>\n\n<p>So an improved version of the above example could look like this (try it on the <a href=\"https://play.golang.org/p/GgMZiE7LBGz\" rel=\"noreferrer\">Go Playground</a>):  </p>\n\n<pre><code>type Me struct {\n    sync.RWMutex\n    me int\n}\n\nfunc (m *Me) Get() int {\n    m.RLock()\n    m.RUnlock()\n    return m.me\n}\n\nfunc (m *Me) Set(me int) {\n    m.Lock()\n    m.me = me\n    m.Unlock()\n}\n\nvar me = &amp;Me{}\n\nfunc main() {\n    me.Set(2)\n    fmt.Println(me.Get())\n}\n</code></pre>\n\n<p>This solution has another advantage: should you need multiple values of <code>Me</code>, it will automatically have different, separate mutexes for each value (our initial solution would require creating separate mutexes manually for each new values).</p>\n\n<p>Although this example is correct and valid, may not be practical. Because protecting a single integer does not really require a mutex. We could achieve the same using the <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"noreferrer\"><code>sync/atomic</code></a> package:</p>\n\n<pre><code>var protectMe int32\n\nfunc getMe() int32 {\n    return atomic.LoadInt32(&amp;protectMe)\n}\n\nfunc setMe(me int32) {\n    atomic.StoreInt32(&amp;protectMe, me)\n}\n</code></pre>\n\n<p>This solution is shorter, cleaner and faster. If you're goal is only to protect a single value, this solution is preferred. If the data structure you ought to protect is more complex, <code>atomic</code> may not even be viable, and using a mutex might be justified.</p>\n\n<p>Now after showing examples of sharing / protecting variables, we should also give an example what we should aim to achieve to live up to <em>\"Do not communicate by sharing memory; instead, share memory by communicating.\"</em></p>\n\n<p>The situation is that you have multiple concurrent goroutines, and you use a variable where you store some state. One goroutine changes (sets) the state, and another reads (gets) the state. To access this state from multiple goroutines, access must be synchronized.</p>\n\n<p>And the idea is to not have a \"shared\" variable like this, but instead the state that one goroutine would set, it should <em>\"send\"</em> it instead, and the other goroutine that would read it, it should be the one the state is \"sent to\" (or in other words, the other goroutine should <em>receive</em> the changed state). So there is no shared state variable, instead there is a <em>communication</em> between the 2 goroutines. Go provides excellent support for this kind of \"inter-goroutine\" communication: <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"noreferrer\">channels</a>. Support for channels is built into the language, there are <a href=\"https://golang.org/ref/spec#Send_statements\" rel=\"noreferrer\">send statements</a>, <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"noreferrer\">receive operators</a> and other support (e.g. you can <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"noreferrer\">loop over</a> the values sent on a channel). For an intro and details, please check this answer: <a href=\"https://stackoverflow.com/questions/39826692/what-are-golang-channels-used-for/39826883#39826883\">What are channels used for?</a></p>\n\n<p>Let's see a practical / real-life example: a \"broker\". A broker is an entity where \"clients\" (goroutines) may subscribe to receive messages / updates, and the broker is capable of broadcasting messages to subscribed clients. In a system where there are numerous clients that might subscribe / unsubscribe at any time, and there may be a need to broadcast messages at any time, synchronizing all this in a safe manner would be complex. Wisely using channels, this broker implementation is rather clean and simple. Please allow me to not repeat the code, but you can check it in this answer: <a href=\"https://stackoverflow.com/questions/36417199/how-to-broadcast-message-using-channel/49877632#49877632\">How to broadcast message using channel</a>. The implementation is perfectly safe for concurrent use, supports \"unlimited\" clients, and does not use a single mutex or shared variable, only channels.</p>\n\n<p><strong>Also see related questions:</strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/49444734/reading-values-from-a-different-thread/49445102#49445102\">Reading values from a different thread</a></p>\n"}], "owner": {"reputation": 3047, "user_id": 10388629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/My8T3.png?s=128&g=1", "display_name": "Pika the Master of the Whales", "link": "https://stackoverflow.com/users/10388629/pika-the-master-of-the-whales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6215, "favorite_count": 1, "accepted_answer_id": 52882045, "answer_count": 2, "score": 8, "last_activity_date": 1580126899, "creation_date": 1539808902, "last_edit_date": 1539845669, "question_id": 52863273, "link": "https://stackoverflow.com/questions/52863273/how-to-make-a-variable-thread-safe", "title": "How to make a variable thread-safe", "body": "<p>I'm relatively new to Go, and I need to make a variable thread-safe. I know in java  you can just use the <code>synchronized</code> keyword, but nothing like that seems to exist in go. Is there any way to synchronize variables?</p>\n"}, {"tags": ["go", "network-programming"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1539807350, "post_id": 52862898, "comment_id": 92640196, "body": "<code>net.Conn</code> is an interface, you could create a mock/stub for it."}, {"owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539807421, "post_id": 52862898, "comment_id": 92640232, "body": "@Adrian if it isnt too much work for you can you assist?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1539807467, "post_id": 52862898, "comment_id": 92640257, "body": "Try it, and if you run into a problem, post a question about it."}, {"owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539807487, "post_id": 52862898, "comment_id": 92640268, "body": "@Adrian k cool thanks"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1539807603, "post_id": 52862898, "comment_id": 92640313, "body": "99% of the time a test requires a TCP connection, you just use loopback. Is there a reason you can&#39;t do that?"}, {"owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "edited": false, "score": 0, "creation_date": 1539808163, "post_id": 52862898, "comment_id": 92640588, "body": "so just use 127.0.0.1. Thats not a bad idea"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539808959, "post_id": 52862898, "comment_id": 92640965, "body": "<a href=\"https://godoc.org/net#Pipe\" rel=\"nofollow noreferrer\">godoc.org/net#Pipe</a> is useful for testing net.Conn in process."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1539851960, "post_id": 52862898, "comment_id": 92653817, "body": "Maybe I don&#39;t get it. But the only thing you want to test is what backend.String() does?"}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 0, "last_activity_date": 1539855562, "creation_date": 1539855562, "answer_id": 52871216, "question_id": 52862898, "link": "https://stackoverflow.com/questions/52862898/emulate-net-connection-without-entering-net-dial/52871216#52871216", "title": "Emulate net connection without entering net dial", "body": "<p>The pattern you could refactor your code is to create a <code>Dialer</code> interface. In your code example you are using the returned <code>ds</code> just as an <code>io.ReadWriteCloser</code>. So you don't need to implement the whole <code>net.Conn</code> interface. As <code>net.Conn</code> has the read and write method inside everything works</p>\n\n<pre><code>type Dialer interface{\n    Dial(network, address string) (io.ReadWriteCloser, error)\n}\n</code></pre>\n\n<p>Now let's change your function:</p>\n\n<pre><code>func handleConnection(us net.Conn, backend BA.Backend, d Dialer) {\n    // ...\n\n    // Code here stays\n    ds, err := d.Dial(\"tcp\", backend.String());if err != nil {\n        log.Printf(\"failed to dial %s: %s\", backend, err)\n        us.Close()\n        return\n    }\n    // ...\n}\n</code></pre>\n\n<p>That your production code works you now need to define a type <code>netDialer</code> which wraps the <code>net.Dial()</code> function. In your test you can use a <code>testDialer</code> which uses a <code>bytes.Buffer</code>.</p>\n\n<p>This answers your question:</p>\n\n<blockquote>\n  <p>Emulate net connection without entering net dial</p>\n</blockquote>\n"}], "owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 52871216, "answer_count": 1, "score": -2, "last_activity_date": 1539855562, "creation_date": 1539807156, "question_id": 52862898, "link": "https://stackoverflow.com/questions/52862898/emulate-net-connection-without-entering-net-dial", "title": "Emulate net connection without entering net dial", "body": "<p>I currently am working on vendor go balancer code. I need to remove the tcp dial call and emulate a successful connection without the call. In the code below, there is\nthis line:</p>\n\n<pre><code>ds, err := net.Dial(\"tcp\", backend.String());if err != nil {\n    log.Printf(\"failed to dial %s: %s\", backend, err)\n    us.Close()\n    return\n}\n</code></pre>\n\n<p>What this does is make a dial to the tcp server and then return connection\nresponse in <code>ds</code>, which is defined here: <a href=\"https://golang.org/pkg/net/#Dial\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/#Dial</a></p>\n\n<p>What i need is to obtain the <code>ds</code> without doing the <code>tcp dialer</code>. I'm\ntrying to test the load balancer without any actual tcp calls. So,\nessentially,\nwhen we enter <code>handleConnection</code> wed create a net connection prior to the tcp dial and use this net conn, which should emulate 100% net connection before the tcp dialing begins.</p>\n\n<pre><code>func copy(wc io.WriteCloser, r io.Reader) {        defer wc.Close()\n    io.Copy(wc, r)\n}\n\n\nfunc handleConnection(us net.Conn, backend BA.Backend) {\n    if backend == nil {\n        log.Printf(\"no backend available for connection from %s\",\n        us.RemoteAddr())\n        us.Close()\n        return\n    }\n\n    host, _, _ := net.SplitHostPort(us.RemoteAddr().String())\n    _, ok := dbAuthTokenData[host]; if !ok {\n        w := bufio.NewWriter(us)\n        w.WriteString(\"InvalidCredentials\")\n        w.Flush()\n        us.Close()\n        return\n    }\n\n    ds, err := net.Dial(\"tcp\", backend.String());if err != nil {\n        log.Printf(\"failed to dial %s: %s\", backend, err)\n        us.Close()\n        return\n    }\n\n    // Ignore errors\n    go copy(ds, us)\n    go copy(us, ds)\n}\n\nfunc tcpBalance(bind string, backends BA.Backends) error {\n    log.Println(\"using tcp balancing\")\n    ln, err := net.Listen(\"tcp\", bind)\n    if err != nil {\n        return fmt.Errorf(\"failed to bind: %s\", err)\n    }\n\n    log.Printf(\"listening on %s, balancing %d backends\", bind,                                 backends.Len())\n\n    for {\n        conn, err := ln.Accept()\n        if err != nil {\n           log.Printf(\"failed to accept: %s\", err)\n            continue\n        }\n        go handleConnection(conn, backends.Choose())\n    }\n\n    return err\n}\n</code></pre>\n\n<p>I tried commenting out <code>go handleConnection(conn, backends.Choose())</code> but that failed.</p>\n"}, {"tags": ["go", "random", "hex"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539805976, "post_id": 52862594, "comment_id": 92639594, "body": "<code>math&#47;rand</code> or <code>crypto&#47;rand</code>?"}, {"owner": {"reputation": 2151, "user_id": 414544, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3b393a43f087897332658031daefda1?s=128&d=identicon&r=PG&f=1", "display_name": "luben", "link": "https://stackoverflow.com/users/414544/luben"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539806440, "post_id": 52862594, "comment_id": 92639797, "body": "crypto/rand @RayfenWindspear"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 4, "creation_date": 1539806752, "post_id": 52862594, "comment_id": 92639922, "body": "I believe the answer to your question lies in the documentation for the particular platform you are on and the specific random source&#39;s documentation for what errors it can return. Go directly calls what is available via the operating system. See <a href=\"https://golang.org/src/crypto/rand/rand.go#L19\" rel=\"nofollow noreferrer\">golang.org/src/crypto/rand/rand.go#L19</a>"}, {"owner": {"reputation": 2151, "user_id": 414544, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3b393a43f087897332658031daefda1?s=128&d=identicon&r=PG&f=1", "display_name": "luben", "link": "https://stackoverflow.com/users/414544/luben"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1540048186, "post_id": 52862594, "comment_id": 92724849, "body": "@maerics sad, if this is consistently the case..."}], "answers": [{"comments": [{"owner": {"reputation": 2151, "user_id": 414544, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3b393a43f087897332658031daefda1?s=128&d=identicon&r=PG&f=1", "display_name": "luben", "link": "https://stackoverflow.com/users/414544/luben"}, "edited": false, "score": 0, "creation_date": 1539892953, "post_id": 52864184, "comment_id": 92676888, "body": "Finally I decided to go with a slightly different choice: instead of retrying the same method, if error occurs the first time on <code>rand.Read</code>, I&#39;ll try to generate MD5 hex string with some pseudorandom data from <code>math&#47;rand</code>, which should never fail."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 2151, "user_id": 414544, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3b393a43f087897332658031daefda1?s=128&d=identicon&r=PG&f=1", "display_name": "luben", "link": "https://stackoverflow.com/users/414544/luben"}, "edited": false, "score": 1, "creation_date": 1539898993, "post_id": 52864184, "comment_id": 92679439, "body": "@luben Do not forget to seed math/rand with something real random on startup."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1539813329, "creation_date": 1539813329, "answer_id": 52864184, "question_id": 52862594, "link": "https://stackoverflow.com/questions/52862594/is-it-good-idea-to-generate-random-string-until-success-with-crypto-rand/52864184#52864184", "title": "Is it good idea to generate random string until success with &quot;crypto/rand&quot;?", "body": "<blockquote>\n  <p>Is it a good idea to loop until the string is generated, </p>\n</blockquote>\n\n<p>That depends. Probably yes.</p>\n\n<blockquote>\n  <p>any pitfalls with that?</p>\n</blockquote>\n\n<p>You discard the random bytes read on error. And this in a tight loop.\nThis may drain you entropy source (depending on the OS) faster than\nit can be filled.</p>\n\n<p>Instead of an unbound infinite loop: Break after n rounds and give up.\nGraceful degradation or stopping is best: If your program is stuck in\nan endless loop it is also not \"continue\"ing.</p>\n"}, {"comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 3, "creation_date": 1539837709, "post_id": 52865132, "comment_id": 92647807, "body": "If the PRNG source is not available or has failed for some reason, the admin absolutely needs to know this immediately. Failing fast is the right thing to do. The problem with the PRNG needs to be fixed before attempting to run any program that needs it. Letting the program spin in a loop doesn&#39;t tell anybody that there is a problem, or could cause them to misidentify the problem."}, {"owner": {"reputation": 2151, "user_id": 414544, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3b393a43f087897332658031daefda1?s=128&d=identicon&r=PG&f=1", "display_name": "luben", "link": "https://stackoverflow.com/users/414544/luben"}, "edited": false, "score": 0, "creation_date": 1539850856, "post_id": 52865132, "comment_id": 92653165, "body": "Thank you, both answers helped me to implement it better."}], "tags": [], "owner": {"reputation": 388, "user_id": 6258130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8660009905c6eaef7e5111ea6658116?s=128&d=identicon&r=PG&f=1", "display_name": "caseyh", "link": "https://stackoverflow.com/users/6258130/caseyh"}, "is_accepted": false, "score": 3, "last_activity_date": 1539875175, "last_edit_date": 1539875175, "creation_date": 1539820503, "answer_id": 52865132, "question_id": 52862594, "link": "https://stackoverflow.com/questions/52862594/is-it-good-idea-to-generate-random-string-until-success-with-crypto-rand/52865132#52865132", "title": "Is it good idea to generate random string until success with &quot;crypto/rand&quot;?", "body": "<p>No. It may always return an error in certain contexts.</p>\n\n<p>Example: <a href=\"https://github.com/golang/go/issues/5096\" rel=\"nofollow noreferrer\">playground: don't use /dev/urandom in crypto/rand</a></p>\n\n<p>Imagine that a machine does not have the source that crypto/rand gets data from or the program runs in a context that doesn't have access to that source. In that case you might consider having the program return that error in a meaningful way rather than spin.</p>\n\n<p>More explicitly, if you are serious in your use of <code>crypto/rand</code> then consider writing <code>RandomHex</code> such that it is exceptionally clear to the caller that it is meant for security contexts (possibly rename it) and return the error from <code>RandomHex</code>. The calling function needs to handle that error and let the user know that something is very wrong. For example in a rest api, I'd expect that error to surface to the request handler, fail &amp; return a 500 at that point, and log a high severity error.</p>\n"}], "owner": {"reputation": 2151, "user_id": 414544, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3b393a43f087897332658031daefda1?s=128&d=identicon&r=PG&f=1", "display_name": "luben", "link": "https://stackoverflow.com/users/414544/luben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 52864184, "answer_count": 2, "score": -2, "last_activity_date": 1539875175, "creation_date": 1539805844, "last_edit_date": 1539806585, "question_id": 52862594, "link": "https://stackoverflow.com/questions/52862594/is-it-good-idea-to-generate-random-string-until-success-with-crypto-rand", "title": "Is it good idea to generate random string until success with &quot;crypto/rand&quot;?", "body": "<p>Is it a good idea to generate a secure random hex string until the process succeeds?</p>\n\n<p>All examples I've come across show that if <code>rand.Read</code> returns error, we should panic, os.Exit(1) or return empty string and the error.</p>\n\n<p>I need my program to continue to function in case of such errors and wait until a random string is generated. Is it a good idea to loop until the string is generated, any pitfalls with that?</p>\n\n<pre><code>import \"crypto/rand\"\n\nfunc RandomHex() string {\n    var buf [16]byte\n    for {\n        _, err := rand.Read(buf[:])\n        if err == nil {\n            break\n        }\n    }\n    return hex.EncodeToString(buf[:])\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539804857, "post_id": 52862087, "comment_id": 92639082, "body": "I think he might be asking, which half of the array gets assigned to x and y, which, with the given code, is undefined."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539805138, "post_id": 52862087, "comment_id": 92639212, "body": "Concurrent code is, broadly speaking, non-deterministic."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1539803660, "creation_date": 1539803660, "answer_id": 52862087, "question_id": 52861948, "link": "https://stackoverflow.com/questions/52861948/go-channel-read-concurrency-and-blocking/52862087#52862087", "title": "go channel read concurrency and blocking", "body": "<blockquote>\n  <p>my understanding is when first routine write to the channel, second routine's writing should be blocked, then main reads the value to x (or y). then 2nd routine writes to channel, main reads to x(or y).</p>\n</blockquote>\n\n<p>Correct, because it is unbuffered. If the channel were buffered, the two routines could both write to it without blocking until the buffer was full.</p>\n\n<blockquote>\n  <p>How does go decide which result goes to x or y?</p>\n</blockquote>\n\n<p>It \"decides\" which result in lexical order - the first value read goes into the first variable <code>x</code>, the second value read into the second variable <code>y</code>.</p>\n\n<blockquote>\n  <p>and if 2nd routine never ends, does main being blocked at this line?</p>\n</blockquote>\n\n<p>No. It blocks until a value is written to the channel, regardless of whether the goroutine(s) writing to the channel are still running or not (indeed, the routines could continue running and writing values to the channel forever if that were the desired behavior).</p>\n"}], "owner": {"reputation": 145, "user_id": 8390201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af51319263ed43525aac990b55e309a1?s=128&d=identicon&r=PG&f=1", "display_name": "Evan.zz", "link": "https://stackoverflow.com/users/8390201/evan-zz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539804721, "creation_date": 1539803117, "last_edit_date": 1539804721, "question_id": 52861948, "link": "https://stackoverflow.com/questions/52861948/go-channel-read-concurrency-and-blocking", "title": "go channel read concurrency and blocking", "body": "<pre><code>import \"fmt\"\n\nfunc sum(s []int, c chan int) {\n    sum := 0\n    for _, v := range s {\n        sum += v\n    }\n    c &lt;- sum // send sum to c\n}\n\nfunc main() {\n    s := []int{7, 2, 8, -9, 4, 0}\n\n    c := make(chan int)\n    go sum(s[:len(s)/2], c)\n    go sum(s[len(s)/2:], c)\n    x, y := &lt;-c, &lt;-c // receive from c\n\n    fmt.Println(x, y, x+y)\n}\n</code></pre>\n\n<p>Hi folks, This is the example of channel usage on official website.</p>\n\n<p>The example starts 2 go routines to calculate the sum of subarray. then it writes to the int channel.</p>\n\n<p>This line really confuse me. </p>\n\n<pre><code>x, y := &lt;-c, &lt;-c // receive from c\n</code></pre>\n\n<p>my understanding is when first routine write to the channel, second routine's writing should be blocked, then main reads the value to x (or y). then 2nd routine writes to channel, main reads to x(or y).</p>\n\n<p>Is this assumption correct?</p>\n\n<p>How does go decide which result goes to x or y?</p>\n\n<p>and if 2nd routine never ends, does main being blocked at this line?</p>\n\n<p>Thanks in advance. go rookie here.</p>\n"}, {"tags": ["go", "large-files", "gob"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1539802306, "post_id": 52861715, "comment_id": 92637934, "body": "Show a full <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Probably, some reference to your gigantic file data remains somewhere. Consider also <i>explicitly</i> clearing it and firing the GC."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1539802351, "post_id": 52861715, "comment_id": 92637958, "body": "This seems like a really poor use case for Gob, because it requires you to decode the entire file contents into memory before you can do anything with it. You&#39;d be better served using Gob for the metadata then just streaming the contents directly to file to conserve memory."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539803948, "post_id": 52861715, "comment_id": 92638666, "body": "Would this be a job for a loop using <a href=\"https://godoc.org/io#LimitedReader\" rel=\"nofollow noreferrer\">godoc.org/io#LimitedReader</a> ?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1539844156, "post_id": 52861715, "comment_id": 92649821, "body": "You shouldn&#39;t accept filenames from clients unchecked. With the code you&#39;ve shown, clients can overwrite arbitrary files the server has access to, and create arbitrary files in directories that the server has write access to. Even if you trust the client right now, those clients change over time, new clients pop up eventually, etc. Trust, but verify. Typical validation includes checking for directory separators and <code>&#47;..&#47;</code> segments."}, {"owner": {"reputation": 11, "user_id": 7776871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1411ee9a2ba6ac49968987b445b242df?s=128&d=identicon&r=PG&f=1", "display_name": "grbueno", "link": "https://stackoverflow.com/users/7776871/grbueno"}, "edited": false, "score": 0, "creation_date": 1539959119, "post_id": 52861715, "comment_id": 92701364, "body": "hi Adrian, indeed it is a poor use of Gob. It takes ~15 sec to read from conn to FileContent, and other 10 - 15 sec to read from FileContent to file. I&#39;ll write the bytes from conn directly to file, and will use the struct just for metadata."}], "owner": {"reputation": 11, "user_id": 7776871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1411ee9a2ba6ac49968987b445b242df?s=128&d=identicon&r=PG&f=1", "display_name": "grbueno", "link": "https://stackoverflow.com/users/7776871/grbueno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539808117, "creation_date": 1539802217, "last_edit_date": 1539808117, "question_id": 52861715, "link": "https://stackoverflow.com/questions/52861715/out-of-memory-when-transferring-large-file", "title": "Out of memory when transferring large file", "body": "<p>I'm using Go Gob to transfer large files (~ 1 GB) or many small files (~ 30 MB). Server is running in a loop, and will receive files when clients send it.</p>\n\n<p>My code is working if I send one large file, or few small files, but when sending a large file for the second time, it returns a 'fatal error: runtime: out of memory'. If I send a large file, stops the program, then starts again and send another large file, it works.</p>\n\n<p>It looks after receiving file via Gob and writing into a file, it is not releasing memory.</p>\n\n<p>Server code</p>\n\n<pre><code>type FileGob struct {\n  FileName    string\n  FileLen     int\n  FileContent []byte\n}\n\nfunc handleConnection(conn net.Conn) {\n  transf := &amp;FileGob{}\n  dec := gob.NewDecoder(conn)\n  err := dec.Decode(transf)       // file from conn to var transf\n  if err != nil {\n    fmt.Println(\"error to decode into buffer:\", err)\n  }\n\n  conn.Close()\n  file, err := os.Create(\"sent_\" + transf.FileName)\n  if err != nil {\n    fmt.Println(\"error to create file:\", err)\n  }\n  file.Write(transf.FileContent)     // writes into file\n\n  fileStat, err := file.Stat()\n  if err != nil {\n    fmt.Println(\"error to get File Stat:\", err)\n  }\n\n  file.Close()\n  fmt.Printf(\"File %v was transferred\\n\", transf.FileName)\n  fmt.Printf(\"Transferred: %d, Expected: %d\\n\", fileStat.Size(), transf.FileLen)\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 1600, "user_id": 4562156, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WuCmq.jpg?s=128&g=1", "display_name": "Sean Pianka", "link": "https://stackoverflow.com/users/4562156/sean-pianka"}, "edited": false, "score": 0, "creation_date": 1539793979, "post_id": 52859499, "comment_id": 92633962, "body": "You want to retrieve the newest object from a bucket in Go?"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1539796676, "post_id": 52859499, "comment_id": 92635230, "body": "S3 bucket list results are always returned in UTF-8 binary order. Each list call will return up to 1000 keys, and an indication if more are available (so that you can call the API again to get the next 1000 results)."}], "owner": {"reputation": 322, "user_id": 8399906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b20fa1357bb11e0ba2eab0d5b358ed?s=128&d=identicon&r=PG", "display_name": "CJW", "link": "https://stackoverflow.com/users/8399906/cjw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1539794445, "creation_date": 1539793462, "last_edit_date": 1539794445, "question_id": 52859499, "link": "https://stackoverflow.com/questions/52859499/list-s3-files-by-newest", "title": "List s3 files by newest", "body": "<p>I am working on a Lambda that needs to list the objects in an S3 bucket and build a URL based on the files *item.Key. The problem I am fast approaching is that soon the bucket will contain more than 1000 items.</p>\n\n<p>Currently, I am using a <code>for</code> to only return the last file that contains a specific item.Key:</p>\n\n<pre><code>resp, err := s3Client.ListObjects(&amp;s3.ListObjectsInput{Bucket: aws.String(bucket)})\nif err != nil {\n    fmt.Printf(\"Unable to list items in bucket %q, %v\", bucket, err)\n}\n\nfor _, item := range resp.Contents {\n    if strings.Contains(*item.Key, \"/output.txt\") {\n        lastItem = *item\n    }\n}\ns := fmt.Sprintf(\"https://s3.%s.amazonaws.com/%s/%s\", region, bucket, *lastItem.Key)\nfmt.Println(s)\n</code></pre>\n\n<p>My understanding is that once the bucket reaches over 1000 items the 1000th item will be returned each time the Lambda is run.</p>\n\n<p>By default bucket items are returned by oldest first, the best way I can see around this is to list the items by newest first and have the <code>for</code> stop after the first item. Is this possible?</p>\n\n<p>If not, has anyone else solved a similar issue?</p>\n"}, {"tags": ["go", "command-line", "command-line-interface", "command-line-arguments"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539783683, "post_id": 52856295, "comment_id": 92627735, "body": "OK. What&#39;s your question? You&#39;ve shown an implementation for what you don&#39;t want, can you show what you&#39;ve tried to achieve what you <i>do</i> want?"}, {"owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539784499, "post_id": 52856295, "comment_id": 92628290, "body": "Let us say every parameter has two columns. So the first column must be assigned as a flag and then second column value must be stored in that flag."}, {"owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539785062, "post_id": 52856295, "comment_id": 92628668, "body": "What I am talking is respect to the Command line   <code>.&#47;ipchange -firstparam={{firstflag},value} -secondparam={{secondflag},value}</code>  <b>All these flags should be declared in the runtime itself and then the value should be assigned</b>"}, {"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 1, "creation_date": 1539785864, "post_id": 52856295, "comment_id": 92629211, "body": "The purpose to use <i>falg</i> package is to document flags and access values properly. As is not your case, you should just access <i>os.Args</i> array, and do what you need"}, {"owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "edited": false, "score": 0, "creation_date": 1539786637, "post_id": 52856295, "comment_id": 92629765, "body": "As I told I am making this a universal app. I need the value of the flag documented so that I do not need to come and make changes in the code again."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 2, "creation_date": 1539786846, "post_id": 52856295, "comment_id": 92629915, "body": "You need to do what @MarioSantini suggests and write your own version of the code that accesses os.Args"}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 1, "last_activity_date": 1539787329, "creation_date": 1539787329, "answer_id": 52857579, "question_id": 52856295, "link": "https://stackoverflow.com/questions/52856295/how-to-use-random-arguments-with-the-help-of-flags-in-golang/52857579#52857579", "title": "How to use random arguments with the help of flags in Golang", "body": "<p>Here's a barebones example to give you an idea how to process os.Args</p>\n\n<pre><code>$ go run main.go --foo asdf --bar xxx --baz ccc\nmap[--foo:asdf --bar:xxx --baz:ccc]\njsandrew-Mac:osarg jsandrew$ cat main.go\npackage main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc manyRandomArg() map[string]string {\n    rv := make(map[string]string)\n    for ix, x := range os.Args {\n        if x[:2] == \"--\" {\n            rv[x] = os.Args[ix+1]\n        }\n    }\n    return rv\n}\n\nfunc main() {\n    fmt.Printf(\"%v\\n\", manyRandomArg())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "is_accepted": false, "score": 1, "last_activity_date": 1539870100, "creation_date": 1539870100, "answer_id": 52875426, "question_id": 52856295, "link": "https://stackoverflow.com/questions/52856295/how-to-use-random-arguments-with-the-help-of-flags-in-golang/52875426#52875426", "title": "How to use random arguments with the help of flags in Golang", "body": "<p>solved it thanks to @Vorsprung</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"regexp\"\n    \"strings\"\n)\n\nvar key0, key1, key2, key3, key4, filename string\nvar fileext = regexp.MustCompile(`([a-z]+)\\.yaml`)\n\nfunc manyRandomArg() map[string]string {\n    rv := make(map[string]string)\n    for ix, x := range os.Args {\n        if x[:2] == \"--\" {\n            rv[x] = os.Args[ix+1]\n        }\n    }\n    return rv\n}\n\nfunc main() {\n    fmt.Printf(\"\\n%v\\n\", manyRandomArg())\n    readargs()\n}\nfunc readargs() {\n\n    rv := manyRandomArg()\n    keys := make([]string, 0, len(rv))\n    for key, _ := range rv {\n        keys = append(keys, key)\n    }\n    // Convert map to slice of values.\n    values := []string{}\n    for _, value := range rv {\n        values = append(values, value)\n    }\n\n    for keys, values := range rv {\n        fmt.Printf(\"key[%s] value[%s]\\n\", keys, values)\n    }\n    if fileext.MatchString(values[0]) {\n        fmt.Printf(\"Value %s\\n\", values[0])\n        filename = values[0]\n    } else if fileext.MatchString(values[1]) {\n        fmt.Printf(\"Value %s\\n\", values[1])\n        filename = values[1]\n    } else if fileext.MatchString(values[2]) {\n        fmt.Printf(\"Value %s\\n\", values[2])\n        filename = values[2]\n    } else if fileext.MatchString(values[3]) {\n        fmt.Printf(\"Value %s\\n\", values[3])\n        filename = values[3]\n    } else if fileext.MatchString(values[4]) {\n        fmt.Printf(\"Value %s\\n\", values[4])\n        filename = values[4]\n    } else {\n        log.Fatal(\"index 4 fail\")\n        os.Exit(1)\n    }\n\n    b, err := ioutil.ReadFile(filename) // just pass the file name\n    if err != nil {\n        fmt.Print(err)\n    }\n    str := string(b) // convert content to a 'string'\n    key0 = trimLeftChars(keys[0], 2)\n    key1 = trimLeftChars(keys[1], 2)\n    key2 = trimLeftChars(keys[2], 2)\n    key3 = trimLeftChars(keys[3], 2)\n    key4 = trimLeftChars(keys[4], 2)\n\n    // Create replacer with pairs as arguments.\n    r := strings.NewReplacer(key0, values[0], key1, values[1], key2, values[2], key3, values[3], key4, values[4])\n\n    // Replace all pairs.\n    result := r.Replace(str)\n    fmt.Println(result)\n\n    newContents := []byte(result)\n    err = ioutil.WriteFile(\"new3.yaml\", newContents, 0664)\n    if err != nil {\n        panic(err)\n    }\n}\nfunc trimLeftChars(s string, n int) string {\n    m := 0\n    for i := range s {\n        if m &gt;= n {\n            return s[i:]\n        }\n        m++\n    }\n    return s[:0]\n}\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 52857579, "answer_count": 2, "score": 0, "last_activity_date": 1543241479, "creation_date": 1539783519, "last_edit_date": 1543241479, "question_id": 52856295, "link": "https://stackoverflow.com/questions/52856295/how-to-use-random-arguments-with-the-help-of-flags-in-golang", "title": "How to use random arguments with the help of flags in Golang", "body": "<p>I want the input from the console to be of anonymous parameters.\nMy current way of execution is</p>\n\n<blockquote>\n  <p>./app -infc=eth0 -ip=192.168.0.1</p>\n</blockquote>\n\n<p>I don't want this as I need this app to be universal so that I can use it for other purposes as well.</p>\n\n<p><strong>I want the CLI to be like this</strong></p>\n\n<blockquote>\n  <p>./app -firstparam={{infc},eth0} -secondparam={{ip},192.168.0.1}</p>\n</blockquote>\n\n<p>So this should basically work by reading the two columns in the parameters.</p>\n\n<p>So it should parse the parameters as a an internal key value pair</p>\n\n<p>Need help on how to store each of the parameter as a key value pair and later use them individually</p>\n"}, {"tags": ["go", "local", "google-app-engine-go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1539789818, "post_id": 52855933, "comment_id": 92631690, "body": "For the fewest restrictions use Go1.11: <a href=\"https://cloud.google.com/blog/products/application-development/go-1-11-is-now-available-on-app-engine\" rel=\"nofollow noreferrer\">Go 1.11 is now available on App Engine</a>."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1539796023, "post_id": 52855933, "comment_id": 92634893, "body": "@peterSO oh man, been waiting for this for three years now! Thanks for the link"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539796687, "post_id": 52855933, "comment_id": 92635235, "body": "With the new Go 1.11 support on App Engine (linked by PeterSO above), it is now possible to write applications that run inside and outside the App Engine standard environment.  There are restrictions on what the application can do in App Engine environment.  One of the restrictions is that an application cannot write files.  There may be others that apply to your application."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539797632, "post_id": 52855933, "comment_id": 92635654, "body": "@ThunderCat Depending on the platform as defined by config/environment variables in App Engine for 1.11, you could switch to using Cloud Storage based on if it&#39;s deployed to App Engine. Of course, OP wants to do as little code modifications as possible, but it won&#39;t work as-is because, like you said, you can&#39;t write files normally when deployed on App Engine."}, {"owner": {"reputation": 31, "user_id": 10518631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ef2a9598102b79c48da22b0247f0e0?s=128&d=identicon&r=PG&f=1", "display_name": "Romano", "link": "https://stackoverflow.com/users/10518631/romano"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539850704, "post_id": 52855933, "comment_id": 92653082, "body": "@RayfenWindspear So, I looked at the 1.11 docs and I see that there is a &quot;2nd gen&quot; environment for golang with much less restrictions than before, but unfortunately the one about writing files is still there as you all said... So, you are suggesting me to modify a bit my code where (for example) I need to look at the presence of the config file at setup stage or in case of modifications and make sure that my app uses the appropriate func to store and retrieve the config either from the filesystem or from the Storage. I&#39;ll give it a try... I hope I do not have to rethink the way my app works..."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539851979, "post_id": 52855933, "comment_id": 92653828, "body": "It could possibly be as easy as that, depending on how it&#39;s coded, of course. The rest of the app should theoretically function as-is, unless you make use of the C std lib. App Engine specifically disallows this. As an alternative, you could function with zero changes whatsoever if you used a compute engine, but that is no different than running any other sort of VM."}], "answers": [{"tags": [], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "is_accepted": false, "score": 0, "last_activity_date": 1564308601, "creation_date": 1564308601, "answer_id": 57239862, "question_id": 52855933, "link": "https://stackoverflow.com/questions/52855933/may-i-deploy-a-golang-app-on-app-engine-and-read-write-files-without-modifying-m/57239862#57239862", "title": "May I deploy a Golang app on app-engine and read/write files without modifying my code?", "body": "<p>The answer to the question \"May I deploy without modifying my code\", is no, this is not possible because of the way you have designed your application. </p>\n\n<p>Appengine creates on demand server instances to respond to requests, and then shuts down that instance when there are no web requests occurring. Appengine applications must be designed in a way that they are not dependent upon living on a single server with a configuration file.</p>\n\n<p>You can choose to design an app that is dependent on a single configuration file living on a single server, but then its not a good fit for google appengine.</p>\n"}], "owner": {"reputation": 31, "user_id": 10518631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ef2a9598102b79c48da22b0247f0e0?s=128&d=identicon&r=PG&f=1", "display_name": "Romano", "link": "https://stackoverflow.com/users/10518631/romano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564308601, "creation_date": 1539782437, "question_id": 52855933, "link": "https://stackoverflow.com/questions/52855933/may-i-deploy-a-golang-app-on-app-engine-and-read-write-files-without-modifying-m", "title": "May I deploy a Golang app on app-engine and read/write files without modifying my code?", "body": "<p>I have created a web-app in Go and I would like to make it possible to run it on a server or on app-engine in the smoothest way I can.</p>\n\n<p>Basically I created a single .exe (I am developing on Windows) and a set of folders wih static files. In addition there is a folder with N configuration files.</p>\n\n<p>These config files include all the configurations needed to setup the db, the folders/paths to write logs into, and so on.</p>\n\n<p>At \"time 0\" when I double click the .exe on my local machine the installation process starts. It looks at the config files (and if they do not exist they are even created) and updates them as per the answers I give on the console.\nIn addition the app generates log files on the filesystem.</p>\n\n<p><strong>My question</strong>: can I \"upload\" my go code on app engine \"as-is\" and just include some configurations specific to appengine on the yaml file, or am I forced to amend MY Go code so that:\n1) the main() must look for the config files elsewhere on app-engine\nand\n2) the logs are read/written from/to specific paths on app-engine</p>\n\n<p>In other words, I wonder whether I can achieve a sort of \"write once and run/deploy everywhere\" version of my web app.</p>\n\n<p>It's my first question on the community so I hope I folowed all instructions.\nThanks.</p>\n"}, {"tags": ["go", "redis", "redigo"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 5, "creation_date": 1539782477, "post_id": 52855850, "comment_id": 92626912, "body": "it doesn&#39;t work like that :)"}, {"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 0, "creation_date": 1539782986, "post_id": 52855850, "comment_id": 92627254, "body": "Wait so are you saying the redis keys are per-urlreq? The struct you scan into can have set keynames, maybe you could add a field to keep the urlreq value and use it for whatever you need to do later (presumably something like marshalling to JSON)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1539783330, "post_id": 52855850, "comment_id": 92627486, "body": "Struct fields are defined at compile time, not at runtime. Perhaps you should use a map instead."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1539784694, "post_id": 52855850, "comment_id": 92628420, "body": "yes I think probably a map is the appropriate data structure for this"}, {"owner": {"reputation": 303, "user_id": 9111646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0db9794a01a8d569e3081313b45911?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9111646/john-doe"}, "edited": false, "score": 0, "creation_date": 1539785194, "post_id": 52855850, "comment_id": 92628762, "body": "can anyone give me a solution for a map that i can ScanStruct into?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539831622, "post_id": 52855850, "comment_id": 92646543, "body": "@JohnDoe you might need to see my answer"}], "answers": [{"tags": [], "owner": {"reputation": 22, "user_id": 8272588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c218aacc4811a43c1f527d5f94993e?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad.Naser", "link": "https://stackoverflow.com/users/8272588/mohammad-naser"}, "is_accepted": false, "score": 0, "last_activity_date": 1539810433, "creation_date": 1539810433, "answer_id": 52863628, "question_id": 52855850, "link": "https://stackoverflow.com/questions/52855850/how-to-dynamically-naming-struct-items-in-golang/52863628#52863628", "title": "How to dynamically naming struct items in golang?", "body": "<p>This is not the way, go behave\nyou should use reflection instead</p>\n\n<pre><code>v := reflect.ValueOf(qwInfo).Elem().FieldByName(field) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 0, "last_activity_date": 1539834077, "last_edit_date": 1539834077, "creation_date": 1539831594, "answer_id": 52866347, "question_id": 52855850, "link": "https://stackoverflow.com/questions/52855850/how-to-dynamically-naming-struct-items-in-golang/52866347#52866347", "title": "How to dynamically naming struct items in golang?", "body": "<p>There are three available functions for scanning purpose on the redigo library: <code>Scan()</code>, <code>ScanSlice()</code>, <code>ScanStruct()</code>. </p>\n\n<p>The <code>ScanStruct()</code> cannot be used in your case because struct scheme need to be explicitly defined on compile time, it cannot be dynamic.</p>\n\n<p>Use <code>Scan()</code> instead. Create some variables to retrieve the values, then after scanning process is done, put all of those variables into one <code>map</code> object.</p>\n\n<p>Example:</p>\n\n<pre><code>c := pool.Get()\ndefer c.Close()\n\nvalues, _ := redis.Values(c.Do(\"HMGET\", urlhost, \"s\"+urlreq, \"c\"+urlreq, \"t\"+urlreq))\n\nvar s int = -1\nvar c []byte\nvar t int = -1\nredis.Scan(values, &amp;s, &amp;c, &amp;t))\n\nqwInfo := map[string]interface{}{\n    \"s\"+urlreq: s,\n    \"c\"+urlreq: c,\n    \"t\"+urlreq: t,\n}\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 9111646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0db9794a01a8d569e3081313b45911?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9111646/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1539834077, "creation_date": 1539782219, "question_id": 52855850, "link": "https://stackoverflow.com/questions/52855850/how-to-dynamically-naming-struct-items-in-golang", "title": "How to dynamically naming struct items in golang?", "body": "<p>I'm using redigo and ScanStruct is very useful. However it's obvious I'm trying to input urlhost and urlreq and these values are dynamically generated based on the actual uri of the user.</p>\n\n<p>Obviously the code below doesn't work so how do I achieve what I want by being able to dynamically naming my struct so I can ScanStruct properly? </p>\n\n<pre><code>   func GetInfo(urlhost string, urlreq string) {\n\n\n    type qwInfo struct {\n         \"s\"+urlreq int\n         \"c\"+urlreq []byte\n         \"t\"+urlreq int\n    }\n\n    var QwInfo qwInfo\n\n    c := pool.Get()\n    defer c.Close()\n\n    values, _ := redis.Values(c.Do(\"HMGET\", urlhost, \"s\"+urlreq, \"c\"+urlreq, \"t\"+urlreq))\n\n    redis.ScanStruct(values, &amp;QwInfo);\n</code></pre>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1539778536, "post_id": 52853602, "comment_id": 92624415, "body": "Probably you don&#39;t free some resources, which when the server left alone, eventually may time out (explains the slow memory reclamation). But when some clients do frequent connect / disconnect, the server memory is consumed at a quicker rate than it is being released thanks to timeouts. We can&#39;t tell based on the code sample you posted."}, {"owner": {"reputation": 171, "user_id": 4040546, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/513f200fdf77efd25af432f5a87551a7?s=128&d=identicon&r=PG&f=1", "display_name": "Yako", "link": "https://stackoverflow.com/users/4040546/yako"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1539779372, "post_id": 52853602, "comment_id": 92624923, "body": "@icza I just found the error. I didn&#39;t close a channel in my TCP server code. Sorry about that, I&#39;m new to Go."}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 4040546, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/513f200fdf77efd25af432f5a87551a7?s=128&d=identicon&r=PG&f=1", "display_name": "Yako", "link": "https://stackoverflow.com/users/4040546/yako"}, "is_accepted": false, "score": 2, "last_activity_date": 1539779394, "creation_date": 1539779394, "answer_id": 52854909, "question_id": 52853602, "link": "https://stackoverflow.com/questions/52853602/memory-keeps-going-up-when-a-client-reconnects-to-my-tcp-server/52854909#52854909", "title": "Memory keeps going up when a client reconnects to my TCP server", "body": "<p>I just found the error. I didn't close a channel in my TCP server code. </p>\n"}], "owner": {"reputation": 171, "user_id": 4040546, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/513f200fdf77efd25af432f5a87551a7?s=128&d=identicon&r=PG&f=1", "display_name": "Yako", "link": "https://stackoverflow.com/users/4040546/yako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1539779394, "creation_date": 1539775022, "last_edit_date": 1539775822, "question_id": 52853602, "link": "https://stackoverflow.com/questions/52853602/memory-keeps-going-up-when-a-client-reconnects-to-my-tcp-server", "title": "Memory keeps going up when a client reconnects to my TCP server", "body": "<p>I'm new to Go and I'm trying to build a simple TCP server. I've attached my code below. Whenever a client disconnects, it will be added to server.deadConns. </p>\n\n<p>If I use a simple Client and keep connecting and disconnecting to the TCP Server (code below), the memory usage of my Golang app just keeps going up. If I then stop connecting and reconnecting my Client and wait, the memory usage will slowly start to go down. It takes a long time for it to go down but it will. </p>\n\n<p>I noticed this issue when I was running my TCP server on Azure and the memory usage on the VM just kept going up until the machine crashed. I checked the logs and saw that there was some clients that just kept connecting and disconnecting all the time. I then tried it locally on my own machine and noticed that the same thing happens.</p>\n\n<pre><code>//NewTCPServer Creates the TCP Server\nfunc NewTCPServer(port string, logger *logrus.Logger) *TCPServer {\n    server := new(TCPServer)\n    server.socketAPI = socketapi.NewSocketAPI(logger)\n    newConns := make(chan net.Conn, 128)\n    server.deadConns = make(chan net.Conn, 128)\n    server.sessions = make(map[net.Conn]*types.ClientSession)\n    fmt.Println(time.Now().Format(\"2006-01-02 15:04:05.000000\") + \": Listening to: \" + port)\n    listener, err := net.Listen(\"tcp\", \":\"+port)\n    if err != nil {\n        panic(err)\n    }\n    go func() {\n        for {\n            conn, err := listener.Accept()\n            if err != nil {\n                panic(err)\n            }\n            fmt.Println(time.Now().Format(\"2006-01-02 15:04:05.000000\") + \": Connected: \" + conn.RemoteAddr().String())\n            newConns &lt;- conn\n        }\n    }()\n\n    go func(server *TCPServer) {\n        for {\n            select {\n            case conn := &lt;-newConns:\n                session := new(types.ClientSession)\n                tcp := createTCPSocket(&amp;conn, server)\n                session.Socket = tcp\n                server.sessions[conn] = session\n            case deadConn := &lt;-server.deadConns:\n                sess, ok := server.sessions[deadConn]\n\n                if ok {\n                    fmt.Println(time.Now().Format(\"2006-01-02 15:04:05.000000\") + \": Found session\")\n                    if server.socketAPI.StopSubscriptionOnClose(sess) {\n                        delete(server.sessions, deadConn)\n                    }\n                }\n\n                fmt.Println(time.Now().Format(\"2006-01-02 15:04:05.000000\") + \": Delete session!\")\n                _ = deadConn.Close()\n                sess.Socket = nil\n                sess = nil\n            }\n        }\n    }(server)\n    return server\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539774993, "post_id": 52853359, "comment_id": 92622320, "body": "Ask yourself: Can 2.1234 be represented <i>exactly</i> as a float64? If no: As which float64 would this be represented? This should fix your expectations (which are wrong, the value printed is the correct one)."}, {"owner": {"reputation": 23, "user_id": 10518086, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IKnT-NsHAWU/AAAAAAAAAAI/AAAAAAAAADw/RsMTeXfTSbo/photo.jpg?sz=128", "display_name": "ding zhu", "link": "https://stackoverflow.com/users/10518086/ding-zhu"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539775905, "post_id": 52853359, "comment_id": 92622834, "body": "I just want calc 1.2345 * 10 ^ 18.  i use big.Float mult big.Float, so i trans 1.2345 to big.Float"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1539777191, "last_edit_date": 1539777191, "creation_date": 1539775320, "answer_id": 52853690, "question_id": 52853359, "link": "https://stackoverflow.com/questions/52853359/the-problem-that-precision-loss-in-big-float/52853690#52853690", "title": "The problem that Precision loss in big.Float", "body": "<blockquote>\n<pre><code>big.NewFloat(float64(2.1234))\n</code></pre>\n</blockquote>\n\n<p><code>float64(2.1234)</code> converts to Go <code>float64</code> (IEEE-754 64-bit floating-point), which has 53 bits of precision.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    // 53 bits of precision (float64)\n    a := big.NewFloat(float64(2.1234))\n    fmt.Println(a.Text(102, 18))\n\n    x := \"2.1234\"\n\n    // 53 bits of precision\n    f, _, err := big.ParseFloat(x, 10, 53, big.ToNearestEven)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(f.Text(102, 18))\n\n    // 256 bits of precision\n    f, _, err = big.ParseFloat(x, 10, 256, big.ToNearestEven)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(f.Text(102, 18))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/z5iK90lQcD9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/z5iK90lQcD9</a></p>\n\n<p>Output:</p>\n\n<pre><code>2.123400000000000176\n2.123400000000000176\n2.123400000000000000\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10518086, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IKnT-NsHAWU/AAAAAAAAAAI/AAAAAAAAADw/RsMTeXfTSbo/photo.jpg?sz=128", "display_name": "ding zhu", "link": "https://stackoverflow.com/users/10518086/ding-zhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 1, "accepted_answer_id": 52853690, "answer_count": 1, "score": 0, "last_activity_date": 1539781394, "creation_date": 1539774235, "last_edit_date": 1539774955, "question_id": 52853359, "link": "https://stackoverflow.com/questions/52853359/the-problem-that-precision-loss-in-big-float", "title": "The problem that Precision loss in big.Float", "body": "<p>While running:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    a := big.NewFloat(float64(2.1234))\n    fmt.Println(a.Text(102,18))\n}\n</code></pre>\n\n<p>I expected 2.123400000000000000 as output, but instead got 2.123400000000000176.</p>\n\n<p>Can someone explain me why I do not have the expected number?</p>\n"}, {"tags": ["string", "go", "memory", "size"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539770685, "post_id": 52851788, "comment_id": 92619800, "body": "use go&#39;s  profiler to optimize program."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539770793, "post_id": 52851788, "comment_id": 92619865, "body": "General and helpful rule: Always read the official documentation of each function and each package carefully. The answer is there."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 10485416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gs1iVHY4do0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXQTSNnkyySA4dnV_FXzxtHOWNJBg/mo/photo.jpg?sz=128", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10485416/dylan"}, "edited": false, "score": 0, "creation_date": 1539770759, "post_id": 52851967, "comment_id": 92619847, "body": "Thank you for your reply! So basicaly following the StringHeader struct, the size of a string in memory is equal to sizeof(uintptr) * Len ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 137, "user_id": 10485416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gs1iVHY4do0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXQTSNnkyySA4dnV_FXzxtHOWNJBg/mo/photo.jpg?sz=128", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10485416/dylan"}, "edited": false, "score": 1, "creation_date": 1539770852, "post_id": 52851967, "comment_id": 92619901, "body": "@Dylan No, <code>StringHeader.Data</code> is a pointer where the bytes (characters) of the string are stored in memory. The size of a <code>string</code> value is basically its length (it&#39;s a byte-length), plus the size of the header. See edited answer."}, {"owner": {"reputation": 51, "user_id": 7835315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313ea7443a630f7d568e565889aadc00?s=128&d=identicon&r=PG&f=1", "display_name": "sprut", "link": "https://stackoverflow.com/users/7835315/sprut"}, "edited": false, "score": 0, "creation_date": 1618595293, "post_id": 52851967, "comment_id": 118658507, "body": "I get an error when trying to run the example <a href=\"https://play.golang.org/p/ugZoV5PeE9H\" rel=\"nofollow noreferrer\">play.golang.org/p/ugZoV5PeE9H</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 51, "user_id": 7835315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313ea7443a630f7d568e565889aadc00?s=128&d=identicon&r=PG&f=1", "display_name": "sprut", "link": "https://stackoverflow.com/users/7835315/sprut"}, "edited": false, "score": 0, "creation_date": 1618605130, "post_id": 52851967, "comment_id": 118662038, "body": "@sprut Thanks for the note, I fixed it (it just needs an <code>int</code> conversion)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 16, "last_activity_date": 1618605112, "last_edit_date": 1618605112, "creation_date": 1539769853, "answer_id": 52851967, "question_id": 52851788, "link": "https://stackoverflow.com/questions/52851788/string-memory-usage-in-golang/52851967#52851967", "title": "String memory usage in Golang", "body": "<p><a href=\"https://golang.org/pkg/unsafe/#Sizeof\" rel=\"nofollow noreferrer\"><code>unsafe.Sizeof()</code></a> does not recursively go into data structures, it just reports the &quot;shallow&quot; size of the value passed. Quoting from its doc:</p>\n<blockquote>\n<p><strong>The size does not include any memory possibly referenced by x.</strong> For instance, if x is a slice, Sizeof returns the size of the slice descriptor, not the size of the memory referenced by the slice.</p>\n</blockquote>\n<p>Maps in Go are implemented as pointers, so <code>unsafe.Sizeof(somemap)</code> will report the size of that pointer.</p>\n<p>Strings in Go are just headers containing a pointer and a length. See <a href=\"https://golang.org/pkg/reflect/#StringHeader\" rel=\"nofollow noreferrer\"><code>reflect.StringHeader</code></a>:</p>\n<pre><code>type StringHeader struct {\n        Data uintptr\n        Len  int\n}\n</code></pre>\n<p>So <code>unsafe.Sizeof(somestring)</code> will report the size of the above struct, which is independent of the length of the <code>string</code> value (which is the value of the <code>Len</code> field).</p>\n<p>To get the actual memory requirement of a map (&quot;deeply&quot;), see <a href=\"https://stackoverflow.com/questions/46278003/how-much-memory-do-golang-maps-reserve/46278240#46278240\">How much memory do golang maps reserve?</a> and also <a href=\"https://stackoverflow.com/questions/44257522/how-to-get-memory-size-of-variable-in-golang/44258164#44258164\">How to get memory size of variable in Go?</a></p>\n<p>Go stores the UTF-8 encoded byte sequences of <code>string</code> values in memory. The builtin function <a href=\"https://golang.org/pkg/builtin/#len\" rel=\"nofollow noreferrer\"><code>len()</code></a> reports the byte-length of a <code>string</code>, so\nbasically the memory required to store a <code>string</code> value in memory is:</p>\n<pre><code>var str string = &quot;some string&quot;\n\nstringSize := len(str) + int(unsafe.Sizeof(str))\n</code></pre>\n<p>Also don't forget that a <code>string</code> value may be constructed by slicing another, bigger string, and thus even if the original string is no longer referenced (and thus no longer needed), the bigger backing array will still be required to be kept in memory for the smaller string slice.</p>\n<p>For example:</p>\n<pre><code>s := &quot;some loooooooong string&quot;\ns2 := s[:2]\n</code></pre>\n<p>Here, even though memory requirement for <code>s2</code> would be <code>len(s2) + unsafe.Sizeof(str) = 2 + unsafe.Sizeof(str)</code>, still, the whole backing array of <code>s</code> will be retained.</p>\n"}], "owner": {"reputation": 137, "user_id": 10485416, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gs1iVHY4do0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXQTSNnkyySA4dnV_FXzxtHOWNJBg/mo/photo.jpg?sz=128", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10485416/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5820, "favorite_count": 1, "accepted_answer_id": 52851967, "answer_count": 1, "score": 8, "last_activity_date": 1618605112, "creation_date": 1539769325, "question_id": 52851788, "link": "https://stackoverflow.com/questions/52851788/string-memory-usage-in-golang", "title": "String memory usage in Golang", "body": "<p>I was optimising a code using a <strong>map[string]string</strong> where the value of the map was only either \"A\" or \"B\". So I thought Obviously a <strong>map[string]bool</strong> was way better as the map hold around 50 millions elements. </p>\n\n<pre><code>var a = \"a\"\nvar a2 = \"Why This ultra long string take the same amount of space in memory as 'a'\"\nvar b = true\nvar c map[string]string\nvar d map[string]bool\n\nc[\"t\"] = \"A\"\nd[\"t\"] = true\n\nfmt.Printf(\"a: %T, %d\\n\", a, unsafe.Sizeof(a))\nfmt.Printf(\"a2: %T, %d\\n\", a2, unsafe.Sizeof(a2))\nfmt.Printf(\"b: %T, %d\\n\", b, unsafe.Sizeof(b))\nfmt.Printf(\"c: %T, %d\\n\", c, unsafe.Sizeof(c))\nfmt.Printf(\"d: %T, %d\\n\", d, unsafe.Sizeof(d))\nfmt.Printf(\"c: %T, %d\\n\", c, unsafe.Sizeof(c[\"t\"]))\nfmt.Printf(\"d: %T, %d\\n\", d, unsafe.Sizeof(d[\"t\"]))\n</code></pre>\n\n<p>And the result was:</p>\n\n<pre><code>a: string, 8\na2: string, 8\nb: bool, 1\nc: map[string]string, 4\nd: map[string]bool, 4\nc2: map[string]string, 8\nd2: map[string]bool, 1\n</code></pre>\n\n<p>While testing I found something weird, why <strong>a2</strong> with a really long string use 8 bytes, same as <strong>a</strong> wich has only one letter ? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1539768781, "post_id": 52851540, "comment_id": 92618703, "body": "... and interface{}. Just do what fmt.Println() does as you obviously want your keystrokesaver to behave like Println() so use the same signature."}], "answers": [{"tags": [], "owner": {"reputation": 1121, "user_id": 5904368, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3f47ff4899eb45da5e5d79d25fdfe474?s=128&d=identicon&r=PG", "display_name": "Tomasz Bawor", "link": "https://stackoverflow.com/users/5904368/tomasz-bawor"}, "is_accepted": false, "score": 4, "last_activity_date": 1539768898, "creation_date": 1539768898, "answer_id": 52851650, "question_id": 52851540, "link": "https://stackoverflow.com/questions/52851540/equivalent-to-javas-passing-of-object-as-method-parameter-in-golang/52851650#52851650", "title": "Equivalent to Java&#39;s passing of Object as method parameter in GoLang", "body": "<p>Have you tried using <code>interface</code> ? </p>\n\n<pre><code>func print(obj interface{}) {\n // logic\n}\n</code></pre>\n\n<p>This way you can accept whatever you want.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1539770599, "last_edit_date": 1539770599, "creation_date": 1539769235, "answer_id": 52851759, "question_id": 52851540, "link": "https://stackoverflow.com/questions/52851540/equivalent-to-javas-passing-of-object-as-method-parameter-in-golang/52851759#52851759", "title": "Equivalent to Java&#39;s passing of Object as method parameter in GoLang", "body": "<p>Go is a <a href=\"https://en.wikipedia.org/wiki/Procedural_programming\" rel=\"nofollow noreferrer\">procedural programming</a> language with many <a href=\"https://en.wikipedia.org/wiki/Functional_programming\" rel=\"nofollow noreferrer\">functional programming</a> elements.</p>\n\n<p>Functions are first-class types in Go, you can create variables of function type, and you can assign function values to these variables, and you can call them (the function value stored in them).</p>\n\n<p>So you may simply do:</p>\n\n<pre><code>var myprint = fmt.Println\n\nmyprint(\"Hello, playground\")\nmyprint(1, 3.14, \"\\n\", time.Now())\n</code></pre>\n\n<p>Output of the above (try it on the <a href=\"https://play.golang.org/p/AMd7uUffJjo\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Hello, playground\n1 3.14 \n 2009-11-10 23:00:00 +0000 UTC m=+0.000000001\n</code></pre>\n\n<p>The advantage of the above <code>myprint</code> variable is that it will have the same signature as <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow noreferrer\"><code>fmt.Println()</code></a>, which is:</p>\n\n<pre><code>func Println(a ...interface{}) (n int, err error)\n</code></pre>\n\n<p>Yes, we can also create a wrapper function like:</p>\n\n<pre><code>func myprint(a ...interface{}) (n int, err error) {\n    return fmt.Println(a...)\n}\n</code></pre>\n\n<p>And it will work the same as calling <code>fmt.Println()</code>, but using a variable is less verbose, and it has the advantage that <strong>you can change the function value at runtime</strong>, which is very handy when writing tests (for an example, see <a href=\"https://stackoverflow.com/questions/40615641/testing-os-exit-scenarios-in-go-with-coverage-information-coveralls-io-goverall/40801733#40801733\">Testing os.Exit scenarios in Go with coverage information (coveralls.io/Goveralls)</a>).</p>\n\n<p>More on the topic:</p>\n\n<p><a href=\"https://dave.cheney.net/2016/11/13/do-not-fear-first-class-functions\" rel=\"nofollow noreferrer\">Dave Cheney: Do not fear first class functions</a></p>\n\n<p><a href=\"https://golangbot.com/first-class-functions/\" rel=\"nofollow noreferrer\">golangbot.com: First Class Functions</a></p>\n\n<p>Yet another possibility is to use \"dot import\", but I advise against it:</p>\n\n<pre><code>import (\n    . \"fmt\"\n)\n\nfunc main() {\n    Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>When you use a \"dot import\", all exported identifiers of the imported package become accessible without having to use <a href=\"https://golang.org/ref/spec#Qualified_identifiers\" rel=\"nofollow noreferrer\">qualified identifiers</a>. Quoting from <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">Spec: Import declarations:</a></p>\n\n<blockquote>\n  <p>If an explicit period (<code>.</code>) appears instead of a name, all the package's exported identifiers declared in that package's <a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow noreferrer\">package block</a> will be declared in the importing source file's file block and must be accessed without a qualifier.</p>\n</blockquote>\n"}], "owner": {"reputation": 2754, "user_id": 849632, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/NDhZK.jpg?s=128&g=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/849632/arun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 52851759, "answer_count": 2, "score": 7, "last_activity_date": 1539770599, "creation_date": 1539768522, "question_id": 52851540, "link": "https://stackoverflow.com/questions/52851540/equivalent-to-javas-passing-of-object-as-method-parameter-in-golang", "title": "Equivalent to Java&#39;s passing of Object as method parameter in GoLang", "body": "<p>Suppose I get bored in typing <code>System.out.println(message)</code> in all the places, I introduce a method in java that looks like</p>\n\n<pre><code>private void print (Object message) {\n   System.out.println(message);\n}\n</code></pre>\n\n<p>and I call <code>print (2)</code> &amp; <code>print (\"hi\")</code> in java wherever necessary .</p>\n\n<p>Can the same be achieved in GoLang too ? A function something like this</p>\n\n<pre><code>func print(message ) {\n    fmt.Println (message)\n}\n</code></pre>\n"}, {"tags": ["datetime", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1539768473, "post_id": 52851477, "comment_id": 92618529, "body": "Use 999 in the format."}, {"owner": {"reputation": 627, "user_id": 6208702, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/9f15540f242d18a14aadc28bcf2d82a5?s=128&d=identicon&r=PG&f=1", "display_name": "kpratihast", "link": "https://stackoverflow.com/users/6208702/kpratihast"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539768644, "post_id": 52851477, "comment_id": 92618626, "body": "@Volker Can you please help me with exact syntax"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1539769034, "post_id": 52851477, "comment_id": 92618829, "body": "You do <code>go doc time.RFC3339Nano</code> and read <code>go doc time.Format</code>."}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 6, "last_activity_date": 1585328901, "last_edit_date": 1585328901, "creation_date": 1539780517, "answer_id": 52855259, "question_id": 52851477, "link": "https://stackoverflow.com/questions/52851477/how-to-convert-rfc3339-format-to-iso8601-in-golang/52855259#52855259", "title": "How to convert RFC3339 format to ISO8601 in golang?", "body": "<p>make a custom layout as shown below</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t1, e := time.Parse(\n        time.RFC3339,\n        \"2018-10-17T07:26:33Z\")\n    if e != nil {\n        fmt.Println(e)\n    }\n    //2018-10-17T07:26:33.000Z required\n    //Layouts must use the reference time Mon Jan 2 15:04:05 MST 2006\n    fmt.Println(t1.Format(\"2006-01-02T15:04:05.000Z\"))\n\n}\n</code></pre>\n\n<p>playground link (good idea Sunny) <a href=\"https://play.golang.org/p/Y3II7lGZB-D\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Y3II7lGZB-D</a></p>\n"}, {"tags": [], "owner": {"reputation": 22, "user_id": 8272588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c218aacc4811a43c1f527d5f94993e?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad.Naser", "link": "https://stackoverflow.com/users/8272588/mohammad-naser"}, "is_accepted": false, "score": 0, "last_activity_date": 1539811173, "creation_date": 1539811173, "answer_id": 52863770, "question_id": 52851477, "link": "https://stackoverflow.com/questions/52851477/how-to-convert-rfc3339-format-to-iso8601-in-golang/52863770#52863770", "title": "How to convert RFC3339 format to ISO8601 in golang?", "body": "<p>use </p>\n\n<pre><code>t := time.Now()\nvar fdatevalue string\n// outstr = fmt.Sprintf(\"%02d%02d%02d%02d%02d\", t.Month(), t.Day(), t.Hour(),       t.Minute(), t.Second())\nfdatevalue=fmt.Sprintf(\"%02d%02d%2dT%2d:%2d:%2d\", t.Year() , t.Month(), t.Day() , t.Hour(),t.Minute(),t.Second)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1828, "user_id": 3236818, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8c062d0722ae02e3b5fafe312528b9e?s=128&d=identicon&r=PG&f=1", "display_name": "tharinduwijewardane", "link": "https://stackoverflow.com/users/3236818/tharinduwijewardane"}, "is_accepted": false, "score": 1, "last_activity_date": 1584362892, "creation_date": 1584362892, "answer_id": 60706317, "question_id": 52851477, "link": "https://stackoverflow.com/questions/52851477/how-to-convert-rfc3339-format-to-iso8601-in-golang/60706317#60706317", "title": "How to convert RFC3339 format to ISO8601 in golang?", "body": "<pre><code>time.Now().Format(\"2006-01-02T15:04:05.000Z\")\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 6208702, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/9f15540f242d18a14aadc28bcf2d82a5?s=128&d=identicon&r=PG&f=1", "display_name": "kpratihast", "link": "https://stackoverflow.com/users/6208702/kpratihast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2907, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1585328901, "creation_date": 1539768339, "question_id": 52851477, "link": "https://stackoverflow.com/questions/52851477/how-to-convert-rfc3339-format-to-iso8601-in-golang", "title": "How to convert RFC3339 format to ISO8601 in golang?", "body": "<p>I have a timestamp which I am getting using <code>time.Now().Format(time.RFC3339)</code>. The format is <code>2018-10-17T07:26:33Z</code> However, I want the format in ISO 8601: <code>2018-10-17T07:26:33.000Z</code> </p>\n\n<p>How do I get those extra milliseconds in the end ?</p>\n"}, {"tags": ["debugging", "go", "visual-studio-code", "delve"], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 3406737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1994b6f607056621d02a7a5b71611fc?s=128&d=identicon&r=PG&f=1", "display_name": "horex", "link": "https://stackoverflow.com/users/3406737/horex"}, "is_accepted": true, "score": 4, "last_activity_date": 1539766807, "creation_date": 1539766807, "answer_id": 52851002, "question_id": 52851001, "link": "https://stackoverflow.com/questions/52851001/how-to-pass-boolean-argument-to-delve-in-vs-code/52851002#52851002", "title": "How to pass boolean argument to delve in VS Code?", "body": "<p>After many attempts, I found the right one:</p>\n\n\n\n<pre><code>\"args\": [\n    \"--create\",\n    \"true\"\n]\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 3406737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1994b6f607056621d02a7a5b71611fc?s=128&d=identicon&r=PG&f=1", "display_name": "horex", "link": "https://stackoverflow.com/users/3406737/horex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 52851002, "answer_count": 1, "score": 5, "last_activity_date": 1540556086, "creation_date": 1539766807, "last_edit_date": 1540556086, "question_id": 52851001, "link": "https://stackoverflow.com/questions/52851001/how-to-pass-boolean-argument-to-delve-in-vs-code", "title": "How to pass boolean argument to delve in VS Code?", "body": "<p>I am trying to pass argument to delve through VS Code but it doesn't work.</p>\n\n<p>This is how to pass argument to a go program through delve:\n</p>\n\n<pre><code>dlv debug github.com/docker/swarm -- create\n</code></pre>\n\n<p>I tried many different solution in my <code>launch.json</code>:\n</p>\n\n<pre><code>\"args\": [\n    \"--\",\n    \"create\"\n]\n</code></pre>\n\n\n\n<pre><code>\"args\": [\n    \"--create\"\n]\n</code></pre>\n\n\n\n<pre><code>\"args\": [\n    \"create\"\n]\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code", "vscode-settings"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539764192, "post_id": 52849799, "comment_id": 92616069, "body": "If you changed path after starting <code>code</code>,  then try restarting, If not see <code>File&gt;Preferences&gt;Settings</code> and search for <code>go.infer</code> and see if you need to make any changes there."}, {"owner": {"reputation": 505, "user_id": 7877397, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6364a9c37d428aad0c96e48050619eff?s=128&d=identicon&r=PG&f=1", "display_name": "Chirrut Imwe", "link": "https://stackoverflow.com/users/7877397/chirrut-imwe"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539849274, "post_id": 52849799, "comment_id": 92652356, "body": "well, i did not make any change in the path cause i leave it as default."}], "answers": [{"tags": [], "owner": {"reputation": 505, "user_id": 7877397, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6364a9c37d428aad0c96e48050619eff?s=128&d=identicon&r=PG&f=1", "display_name": "Chirrut Imwe", "link": "https://stackoverflow.com/users/7877397/chirrut-imwe"}, "is_accepted": false, "score": 1, "last_activity_date": 1539849451, "creation_date": 1539849451, "answer_id": 52869453, "question_id": 52849799, "link": "https://stackoverflow.com/questions/52849799/vscode-gopath-different-from-gopath-set-in-shell/52869453#52869453", "title": "VSCODE gopath different from GOPATH set in shell", "body": "<p>This seems like a problem with the ms-vscode.go plugin, if I disable it, the problem go away. and if i enable it, it comes back. Strangely I tried uninstalling it completely, and then reinstall it again, and the problem goes away.</p>\n\n<p>Note: No, I did not make any changes to GOPATH at all since i first setup golang.  </p>\n"}], "owner": {"reputation": 505, "user_id": 7877397, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6364a9c37d428aad0c96e48050619eff?s=128&d=identicon&r=PG&f=1", "display_name": "Chirrut Imwe", "link": "https://stackoverflow.com/users/7877397/chirrut-imwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1262, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539849451, "creation_date": 1539762647, "question_id": 52849799, "link": "https://stackoverflow.com/questions/52849799/vscode-gopath-different-from-gopath-set-in-shell", "title": "VSCODE gopath different from GOPATH set in shell", "body": "<p>I am encountering a very weird issue on visual studio code when i try to import packages. </p>\n\n<pre><code>import (\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n)\n</code></pre>\n\n<p>I get the error </p>\n\n<pre><code>cannot find package \"github.com/gorilla/mux\" in any of:\n        /usr/local/go/src/github.com/gorilla/mux (from $GOROOT)\n        /user/chirrut/go/src/github.com/gorilla/mux (from $GOPATH)\n</code></pre>\n\n<p>however when i run go build from the terminal, I don't get any error.\nalso note that the GOPATH is set to /home/chirrut/go instead of /user/chirrut/go\nI ran echo on terminal, and the vscode integrated terminal and both returns me the correct path.</p>\n\n<pre><code>$ echo $GOPATH\n/home/chirrut/go\n</code></pre>\n\n<p>Somehow, somewhere VSCode is getting the GOPATH value as /user/chirrut/go instead. anyone have any idea where else is the GOPATH variable read from in VS Code? </p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539783499, "post_id": 52849868, "comment_id": 92627613, "body": "mgo provides <a href=\"https://godoc.org/github.com/globalsign/mgo#Session.Ping\" rel=\"nofollow noreferrer\">Session.Ping</a> to test if connectivity is available in the session."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539783757, "post_id": 52849868, "comment_id": 92627777, "body": "@Adrian Yes, but <code>Ping()</code> is to check connectivity, and asker wants to detect if <code>Session.Close()</code> was called before. It if was, quoting from its doc: <i>&quot;It&#39;s a runtime error to use a session after it has been closed.&quot;</i> So <code>Session.Ping()</code> should (may) also panic."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1539793429, "last_edit_date": 1539793429, "creation_date": 1539762827, "answer_id": 52849868, "question_id": 52849583, "link": "https://stackoverflow.com/questions/52849583/how-can-i-know-if-a-mgo-session-is-closed/52849868#52849868", "title": "How can I know if a mgo session is closed", "body": "<p>First, the <code>mgo</code> driver you are using: <code>gopkg.in/mgo.v2</code> (hosted at <a href=\"https://github.com/go-mgo/mgo\" rel=\"nofollow noreferrer\">https://github.com/go-mgo/mgo</a>) is not maintained anymore. Instead use the community supported fork <a href=\"https://github.com/globalsign/mgo\" rel=\"nofollow noreferrer\"><code>github.com/globalsign/mgo</code></a>, it has a backward compatible API.</p>\n\n<p><a href=\"https://godoc.org/github.com/globalsign/mgo#Session\" rel=\"nofollow noreferrer\"><code>mgo.Session</code></a> does not provide a way to detect if it has been closed (using its <a href=\"https://godoc.org/github.com/globalsign/mgo#Session.Close\" rel=\"nofollow noreferrer\"><code>Session.Close()</code></a> method).</p>\n\n<p>But you shouldn't depend on others closing the session you are using. <em>The same code that obtains a session should be responsible to close it.</em> Follow this simple principle, and you won't bump into problems of using a closed session.</p>\n\n<p>For instance, if we take a web server as an example, obtain a session using <a href=\"https://godoc.org/github.com/globalsign/mgo#Session.Copy\" rel=\"nofollow noreferrer\"><code>Session.Copy()</code></a> (or <a href=\"https://godoc.org/github.com/globalsign/mgo#Session.Clone\" rel=\"nofollow noreferrer\"><code>Session.Clone()</code></a>) in the beginning of the request, and close the session (preferably with defer) in the same handler, <em>in the same function</em>. And just pass along this session to whoever needs it. They don't have to close it, they mustn't, that's the responsibility of the function that created it.</p>\n"}], "owner": {"reputation": 73, "user_id": 6218462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd10659ed5b7641bd6fa3ddfa1ef4b45?s=128&d=identicon&r=PG&f=1", "display_name": "xjpsjtu", "link": "https://stackoverflow.com/users/6218462/xjpsjtu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1539793429, "creation_date": 1539761899, "last_edit_date": 1539762963, "question_id": 52849583, "link": "https://stackoverflow.com/questions/52849583/how-can-i-know-if-a-mgo-session-is-closed", "title": "How can I know if a mgo session is closed", "body": "<p>I'm using <code>*mgo.Session</code> of MongoDB driver <code>labix_mgo</code> for Go, however I don't know if a session is closed. When I use a closed session, a runtime error will be raised. I want to skip the session copy if I know a session is closed.</p>\n"}, {"tags": ["rest", "http", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1539762638, "post_id": 52849382, "comment_id": 92615244, "body": "FYI you don&#39;t neet to close the body on the <i>server</i> request, only when you get a request object using a <i>client</i>. See the last paragraph in this doc: <a href=\"https://golang.org/pkg/net/http/#Request.Body\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Request.Body</a>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1539763079, "post_id": 52849382, "comment_id": 92615476, "body": "There is no way around delaying the writing,  however the cases for the encoder returning error are very limited and documented, if your objects are big and it&#39;s important not to buffer the json, it makes sense to just log the error and return something sane in this case. It&#39;s up to you which is more important..."}], "answers": [{"comments": [{"owner": {"reputation": 14464, "user_id": 50419, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/S1nop.jpg?s=128&g=1", "display_name": "Navaneeth K N", "link": "https://stackoverflow.com/users/50419/navaneeth-k-n"}, "edited": false, "score": 0, "creation_date": 1539781625, "post_id": 52854720, "comment_id": 92626362, "body": "Thanks for the detailed answer. May be not returning the object is right thing. I can do that. I could set the <code>Location</code> header. Or stick to <code>200 OK</code> for now."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1539778682, "creation_date": 1539778682, "answer_id": 52854720, "question_id": 52849382, "link": "https://stackoverflow.com/questions/52849382/how-do-i-set-http-status-code-conditionally-in-a-go-http-server/52854720#52854720", "title": "How do I set HTTP status code conditionally in a Go HTTP server?", "body": "<p>Expanding my comment a bit: </p>\n\n<p>There is no way to do this without buffering. And if you think about it, even if there was, how would that be implemented? The response header needs to be sent before the contents. If the code depends on encoding the response, you must first encode, check the result, set the header and flush the encoded buffer.</p>\n\n<p>So even if the Go API supported a \"delayed\" status, you would be basically pushing the buffering problem one level down, to the http library :) </p>\n\n<p>You should make the call - either it's important to get the response code right at all costs and you can afford to buffer, or you want to stream the response and you cannot change the result. </p>\n\n<p>Theoretically Go could create an encoding validator that will make sure the object you are trying to encode will 100% pass before actually encoding. </p>\n\n<p>BTW, this makes me think of another thing - the semantic meaning of the response code. You return HTTP Created, right? It's the correct code since the object has in fact been created. But if you return a 500 error due to encoding, has the object not been created? It still has! So the Created code is still valid, the error is just in the encoding stage. So maybe a better design would be not to return the object as a response? </p>\n"}, {"tags": [], "owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "is_accepted": false, "score": 0, "last_activity_date": 1539790003, "creation_date": 1539790003, "answer_id": 52858484, "question_id": 52849382, "link": "https://stackoverflow.com/questions/52849382/how-do-i-set-http-status-code-conditionally-in-a-go-http-server/52858484#52858484", "title": "How do I set HTTP status code conditionally in a Go HTTP server?", "body": "<p>The JSON marshalling may fail if some of your types (deeply) can not be serialized to JSON.</p>\n\n<p>So you should ask yourself: what are the case where the encoding of the response can fail?</p>\n\n<p>If you know the answer, just fix those cases. If you don't know, this is probably that those cases just don't exist.</p>\n\n<p>If you are not sure, the only way to catch errors is to buffer the encoding. You have to balance the \"not nice\" between buffering and not returning a clean error.</p>\n\n<p>Anyway, returning a 500 error if just the JSON encoding failed is really not nice. At least, you should revert the object creation (the work of <code>saveToDb</code>), so you have to wrap in a transaction that you will rollback in any failure cases.</p>\n"}], "owner": {"reputation": 14464, "user_id": 50419, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/S1nop.jpg?s=128&g=1", "display_name": "Navaneeth K N", "link": "https://stackoverflow.com/users/50419/navaneeth-k-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1697, "favorite_count": 0, "accepted_answer_id": 52854720, "answer_count": 2, "score": 2, "last_activity_date": 1539790003, "creation_date": 1539761118, "question_id": 52849382, "link": "https://stackoverflow.com/questions/52849382/how-do-i-set-http-status-code-conditionally-in-a-go-http-server", "title": "How do I set HTTP status code conditionally in a Go HTTP server?", "body": "<p>I have the following HTTP handler function:</p>\n\n<pre><code>func (h *UptimeHttpHandler) CreateSchedule(w http.ResponseWriter, r *http.Request) {\n    defer r.Body.Close()\n    dec := json.NewDecoder(r.Body)\n\n    var req ScheduleRequest\n    if err := dec.Decode(&amp;req); err != nil {\n        // error handling omited\n    }\n\n    result, err := saveToDb(req)\n    if err != nil {\n        // error handling omited\n    }\n\n    // Responding with 201-Created instead of default 200-Ok\n    w.WriteHeader(http.StatusCreated)\n\n    enc := json.NewEncoder(w)\n    if err := enc.Encode(result); err != nil {\n        // this will have no effect as the status is already set before\n        w.WriteHeader(http.StatusInternalServerError)\n        fmt.Fprintf(w, \"%v\", err)\n    }\n}\n</code></pre>\n\n<p>Above code does the following:</p>\n\n<ol>\n<li>Request comes as a JSON data. It is decoded into <code>req</code></li>\n<li>Request is persisted in the DB. This returns a result object which will be the response</li>\n</ol>\n\n<p>Now here, as soon as the DB insert is successful, we set the status code to <code>201</code>. Then use a JSON encoder to stream the JSON encoded value directly to <code>ResponseWriter</code>.</p>\n\n<p>When <code>encode</code> returns an error, I need to change the status code to <code>500</code>. But currently I can't do it as Go allows to set the status code only once. </p>\n\n<p>I can handle this by keeping the encoded JSON in memory, and setting the status code only when it is success. But then this creates unwanted copies and not really nice. </p>\n\n<p>Is there a better way to handle this?</p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 864, "user_id": 281782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/TK2uJ.jpg?s=128&g=1", "display_name": "Geln Yang", "link": "https://stackoverflow.com/users/281782/geln-yang"}, "is_accepted": true, "score": 1, "last_activity_date": 1539766792, "creation_date": 1539766792, "answer_id": 52850997, "question_id": 52848564, "link": "https://stackoverflow.com/questions/52848564/get-protocol-buffer-option-information-for-golang/52850997#52850997", "title": "get protocol buffer option information for golang", "body": "<p>use <code>proto.GetExtension</code> get option value:</p>\n\n<pre><code>var msg *pb.TestMessage\n_, md := descriptor.ForMessage(msg)\noptions := md.GetOptions()\n\nfmt.Println(options.String()) // --&gt; [grpcapi.msg_option_a]:22 [grpcapi.msg_option_b]:33\nfmt.Println(len(options.GetUninterpretedOption())) // --&gt; 0\n\na, _ := proto.GetExtension(options, pb.E_MsgOptionA)\nfmt.Println(*a.(*int32)) // --&gt; 22\n\nb, _ := proto.GetExtension(options, pb.E_MsgOptionB)\nfmt.Println(*b.(*int32)) // --&gt; 33\n</code></pre>\n"}], "owner": {"reputation": 864, "user_id": 281782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/TK2uJ.jpg?s=128&g=1", "display_name": "Geln Yang", "link": "https://stackoverflow.com/users/281782/geln-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 3, "accepted_answer_id": 52850997, "answer_count": 1, "score": 1, "last_activity_date": 1539766792, "creation_date": 1539757908, "question_id": 52848564, "link": "https://stackoverflow.com/questions/52848564/get-protocol-buffer-option-information-for-golang", "title": "get protocol buffer option information for golang", "body": "<p>Protocol Buffer definition as following, the <code>TestMessage</code> has two options <code>msg_option_a</code> and <code>msg_option_b</code>: </p>\n\n<pre><code>syntax = \"proto3\";\npackage grpctest;\n\noption go_package = \"pb\";\n\nimport \"google/protobuf/descriptor.proto\";\n\nextend google.protobuf.MessageOptions {\n  int32 msg_option_a = 50011;\n  int32 msg_option_b = 50012;\n}\n\nmessage TestMessage {\n  option (msg_option_a) = 22;\n  option (msg_option_b) = 33;\n  string name = 1;\n}\n</code></pre>\n\n<p>I'd like to read the definition value of the two options:</p>\n\n<pre><code>var msg *pb.TestMessage\n_, md := descriptor.ForMessage(msg)\noptions := md.GetOptions()\n\nfmt.Println(options.String()) // --&gt; [grpcapi.msg_option_a]:22 [grpcapi.msg_option_b]:33\nfmt.Println(len(options.GetUninterpretedOption())) // --&gt; 0\n</code></pre>\n\n<p>It can get all options info when print the whole <code>MessageOptions</code>, <code>GetUninterpretedOption()</code> return a array of option definition, but it has a zero length. </p>\n\n<p>The following is the comment of type <code>UninterpretedOption</code> , but I cant get what it means, and haven't found any info about <code>DescriptorPool</code>:</p>\n\n<pre><code>// A message representing a option the parser does not recognize. This only\n// appears in options protos created by the compiler::Parser class.\n// DescriptorPool resolves these when building Descriptor objects. Therefore,\n// options protos in descriptor objects (e.g. returned by Descriptor::options(),\n// or produced by Descriptor::CopyTo()) will never have UninterpretedOptions\n// in them.\n</code></pre>\n\n<p><strong>I want to get a specific option value</strong>\uff0c but no ideas now. </p>\n\n<p>Please help! Thanks! </p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539756052, "post_id": 52847753, "comment_id": 92612092, "body": "Seems like the issue is not coming from the go-orm library. the issue is on the postgresql itself. can you show the raw sql query generated from your statements?"}, {"owner": {"reputation": 6317, "user_id": 1876355, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/HPpQk.png?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/1876355/pierre"}, "edited": false, "score": 0, "creation_date": 1539756494, "post_id": 52847753, "comment_id": 92612243, "body": "try moving the select after related"}, {"owner": {"reputation": 1039, "user_id": 8294118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cd5c198656aa0d0075eaadd22c0c316?s=128&d=identicon&r=PG&f=1", "display_name": "user666", "link": "https://stackoverflow.com/users/8294118/user666"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539766172, "post_id": 52847753, "comment_id": 92617133, "body": "@xpare how can this be done?"}, {"owner": {"reputation": 1039, "user_id": 8294118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cd5c198656aa0d0075eaadd22c0c316?s=128&d=identicon&r=PG&f=1", "display_name": "user666", "link": "https://stackoverflow.com/users/8294118/user666"}, "reply_to_user": {"reputation": 6317, "user_id": 1876355, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/HPpQk.png?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/1876355/pierre"}, "edited": false, "score": 0, "creation_date": 1539766301, "post_id": 52847753, "comment_id": 92617198, "body": "@Pierre just tried this it gave same error"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539767489, "post_id": 52847753, "comment_id": 92617925, "body": "@user666 try to enable the logging feature <a href=\"http://gorm.io/docs/logger.html\" rel=\"nofollow noreferrer\">gorm.io/docs/logger.html</a>"}, {"owner": {"reputation": 1039, "user_id": 8294118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cd5c198656aa0d0075eaadd22c0c316?s=128&d=identicon&r=PG&f=1", "display_name": "user666", "link": "https://stackoverflow.com/users/8294118/user666"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539768723, "post_id": 52847753, "comment_id": 92618664, "body": "@xpare I got: SELECT * FROM &quot;&quot;  WHERE (&quot;user_id&quot; = &#39;4&#39;) do you have any idea why adding select make the query text go wrong?"}, {"owner": {"reputation": 6317, "user_id": 1876355, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/HPpQk.png?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/1876355/pierre"}, "edited": false, "score": 0, "creation_date": 1539837381, "post_id": 52847753, "comment_id": 92647728, "body": "It should also be possible to manually create a query like <code>s.database.GetDatabase().Query(&quot; select * from user as u join result as r on u.name = r.Registrations where user_id = &#39;4&#39; &quot;)</code>? should <code>&amp;result</code> not be <code>&amp;dbResult</code> &lt;- just a question. It just seems like you have some fields missing... You don&#39;t state on which field it must join the two tables on, or does it automatically check for one field to join? ie. <code>user_id</code> ?"}, {"owner": {"reputation": 1039, "user_id": 8294118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cd5c198656aa0d0075eaadd22c0c316?s=128&d=identicon&r=PG&f=1", "display_name": "user666", "link": "https://stackoverflow.com/users/8294118/user666"}, "edited": false, "score": 0, "creation_date": 1539839849, "post_id": 52847753, "comment_id": 92648376, "body": "in fact without the select part it works perfectly and return the row... what i am currently doing is doing a loop over the result to extract the needed field in a list. But it sounds really strange if gorm does not support selecting one field from a join query ...."}, {"owner": {"reputation": 6317, "user_id": 1876355, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/HPpQk.png?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/1876355/pierre"}, "edited": false, "score": 1, "creation_date": 1539843070, "post_id": 52847753, "comment_id": 92649365, "body": "Well, get the row object back and select the single property like that then"}], "owner": {"reputation": 1039, "user_id": 8294118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cd5c198656aa0d0075eaadd22c0c316?s=128&d=identicon&r=PG&f=1", "display_name": "user666", "link": "https://stackoverflow.com/users/8294118/user666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539758435, "creation_date": 1539753766, "last_edit_date": 1539758435, "question_id": 52847753, "link": "https://stackoverflow.com/questions/52847753/query-two-tables-and-select-one-field-from-response", "title": "Query two tables and select one field from response", "body": "<p>I am using the following code to query a row from two joined tables:</p>\n\n<pre><code>s.database.GetDatabase().Model(&amp;dbUser).Related(&amp;result, \"Registrations\")\n</code></pre>\n\n<p>However when i use select as follows:</p>\n\n<pre><code>s.database.GetDatabase().Model(&amp;dbUser).Select(\"name\").Related(&amp;result, \"Registrations\")\n</code></pre>\n\n<p>it show the following error and returns zero records</p>\n\n<blockquote>\n  <p>(pq: zero-length delimited identifier at or near \"\"\"\")</p>\n</blockquote>\n"}, {"tags": ["web-services", "go", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 1, "last_activity_date": 1539737830, "creation_date": 1539737830, "answer_id": 52845883, "question_id": 52845807, "link": "https://stackoverflow.com/questions/52845807/gin-wildcard-route-conflicts-with-existing-children/52845883#52845883", "title": "Gin wildcard route conflicts with existing children", "body": "<p>Looks like the <a href=\"https://godoc.org/github.com/gin-gonic/gin#Engine.NoRoute\" rel=\"nofollow noreferrer\"><code>gin.NoRoute(...)</code> function</a> will do the trick.</p>\n\n<pre><code>r.GET(\"/special\", func(c *gin.Context) { // Serve the special resource...\nr.NoRoute(func(c *gin.Context) {         // Serve the default resource...\n</code></pre>\n\n<p>See also <a href=\"https://stackoverflow.com/a/32444263/244128\">https://stackoverflow.com/a/32444263/244128</a></p>\n"}, {"tags": [], "owner": {"reputation": 1369, "user_id": 2730233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GDPoY.jpg?s=128&g=1", "display_name": "Lucio Mollinedo", "link": "https://stackoverflow.com/users/2730233/lucio-mollinedo"}, "is_accepted": false, "score": 3, "last_activity_date": 1541166993, "creation_date": 1541166993, "answer_id": 53119915, "question_id": 52845807, "link": "https://stackoverflow.com/questions/52845807/gin-wildcard-route-conflicts-with-existing-children/53119915#53119915", "title": "Gin wildcard route conflicts with existing children", "body": "<p>Maybe someone else (like me) will have this error message in a situation where gin.NoRoute() won't be an acceptable fix. I took the following code <a href=\"https://github.com/gin-gonic/gin/issues/205#issuecomment-296155497\" rel=\"nofollow noreferrer\">from github</a> in search for a workaround for this issue:</p>\n\n<pre><code>    router.GET(\"/v1/images/:path1\", GetHandler)           //      /v1/images/detail\n    router.GET(\"/v1/images/:path1/:path2\", GetHandler)    //      /v1/images/&lt;id&gt;/history\n\nfunc GetHandler(c *gin.Context) {\n    path1 := c.Param(\"path1\")\n    path2 := c.Param(\"path2\")\n\n    if path1 == \"detail\" &amp;&amp; path2 == \"\" {\n        Detail(c)\n    } else if path1 != \"\" &amp;&amp; path2 == \"history\" {\n        imageId := path1\n        History(c, imageId)\n    } else {\n        HandleHttpError(c, NewHttpError(404, \"Page not found\"))\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1205, "user_id": 10713244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1176ac393f86b642dbf66e2b2fb6292?s=128&d=identicon&r=PG&f=1", "display_name": "\u0411\u043e\u0433\u0434\u0430\u043d \u041e\u043f\u0438\u0440", "link": "https://stackoverflow.com/users/10713244/%d0%91%d0%be%d0%b3%d0%b4%d0%b0%d0%bd-%d0%9e%d0%bf%d0%b8%d1%80"}, "edited": false, "score": 3, "creation_date": 1591972352, "post_id": 62346307, "comment_id": 110265318, "body": "Welcome to Stack Overflow! Please read &quot;<a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">Writing The Perfect Question</a>&quot;. Formatting is important on SO; Help is available to show how to use it when editing your text. &quot;<a href=\"https://stackoverflow.com/help/formatting\">How do I format my posts...</a>&quot; will help too. Also, please explain why this should be the selected solution, and how it works; The goal is to educate, not just toss out code."}], "tags": [], "owner": {"reputation": 21, "user_id": 13734795, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vk7_O80a7m4/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclYsc92ysQ4GyO3F4VxP3vI3qWOEg/photo.jpg?sz=128", "display_name": "Prakash Natarajan", "link": "https://stackoverflow.com/users/13734795/prakash-natarajan"}, "is_accepted": false, "score": 2, "last_activity_date": 1592198387, "last_edit_date": 1592198387, "creation_date": 1591971892, "answer_id": 62346307, "question_id": 52845807, "link": "https://stackoverflow.com/questions/52845807/gin-wildcard-route-conflicts-with-existing-children/62346307#62346307", "title": "Gin wildcard route conflicts with existing children", "body": "<p>You can try like this.</p>\n\n<pre><code>route.GET(\"/special/*action\", func(ctxt *gin.Context) {\n  ctxt.JSON(200, gin.H{\"message\": \"WildcardUrl\"})\n})\n</code></pre>\n"}], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7132, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1597431323, "creation_date": 1539737088, "last_edit_date": 1597431323, "question_id": 52845807, "link": "https://stackoverflow.com/questions/52845807/gin-wildcard-route-conflicts-with-existing-children", "title": "Gin wildcard route conflicts with existing children", "body": "<p>I'd like to build a <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\"><code>gin</code></a> program which serves the following routes:</p>\n\n<pre><code>r.GET(\"/special\", ... // Serves a special resource.\nr.Any(\"/*\", ...       // Serves a default resource.\n</code></pre>\n\n<p>However, such a program panics at runtime:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[GIN-debug] GET    /special                  --&gt; main.main.func1 (2 handlers)\n[GIN-debug] GET    /*                        --&gt; main.main.func2 (2 handlers)\npanic: wildcard route '*' conflicts with existing children in path '/*'\n</code></pre>\n\n<p>Is it possible to create a gin program which serves a default resource for every route <em>except</em> for a single one which serves a different resource?</p>\n\n<p>Many pages on the web lead me to believe it is not possible using the default gin router, so what is the easiest way to serve these routes from a gin program?</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-helm"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1539754655, "post_id": 52845492, "comment_id": 92611622, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17641887/how-do-i-escape-and-delimiters-in-go-templates\">How do I escape \u201c{{\u201d and \u201c}}\u201d delimiters in Go templates?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 1, "last_activity_date": 1539739404, "creation_date": 1539739404, "answer_id": 52846056, "question_id": 52845492, "link": "https://stackoverflow.com/questions/52845492/how-to-avoid-translate-some-of-the-helm-chart/52846056#52846056", "title": "How to avoid translate some `{{` of the helm chart?", "body": "<p>In the Go template language, the expression</p>\n\n<pre><code>{{ \"{{\" }}\n</code></pre>\n\n<p>will expand to two open curly braces, for cases when you need to use Go template syntax to generate documents in Go template syntax; for example</p>\n\n<pre><code>{{ \"{{\" }}- if .Values.foo }}\n- name: FOO\n  value: {{ \"{{\" }} .Values.foo }}\n{{ \"{{\" }}- end }}\n</code></pre>\n\n<p>(In a Kubernetes Helm context where you're using this syntax to generate YAML, be extra careful with how whitespace is handled; consider using <code>helm template</code> to dump out what gets generated.)</p>\n"}], "owner": {"reputation": 195, "user_id": 4168420, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/40ee7fb4216edf8b44d35b77929d4909?s=128&d=identicon&r=PG&f=1", "display_name": "che yang", "link": "https://stackoverflow.com/users/4168420/che-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1232, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539739404, "creation_date": 1539734174, "question_id": 52845492, "link": "https://stackoverflow.com/questions/52845492/how-to-avoid-translate-some-of-the-helm-chart", "title": "How to avoid translate some `{{` of the helm chart?", "body": "<p>I want to put the following CRD into helm chart, but it contains go raw template. How to make helm not translate <code>{{</code> and <code>}}</code> inside <code>rawTemplate</code>. Thanks for your response.\n<a href=\"https://github.com/kubeflow/katib/blob/master/examples/random-example.yaml\" rel=\"nofollow noreferrer\">https://github.com/kubeflow/katib/blob/master/examples/random-example.yaml</a></p>\n\n<pre><code>apiVersion: \"kubeflow.org/v1alpha1\"\nkind: StudyJob\nmetadata:\n  namespace: katib\n  labels:\n    controller-tools.k8s.io: \"1.0\"\n  name: random-example\nspec:\n studyName: random-example\n owner: crd\n optimizationtype: maximize\n objectivevaluename: Validation-accuracy\n optimizationgoal: 0.99\n requestcount: 4\n metricsnames:\n   - accuracy\n workerSpec:\n   goTemplate:\n    rawTemplate: |-\n      apiVersion: batch/v1\n      kind: Job\n      metadata:\n        name: {{.WorkerId}}\n        namespace: katib\n      spec:\n        template:\n          spec:\n            containers:\n            - name: {{.WorkerId}}\n              image: katib/mxnet-mnist-example\n              command:\n              - \"python\"\n              - \"/mxnet/example/image-classification/train_mnist.py\"\n              - \"--batch-size=64\"\n              {{- with .HyperParameters}}\n              {{- range .}}\n              - \"{{.Name}}={{.Value}}\"\n              {{- end}}\n              {{- end}}\n            restartPolicy: Never\n</code></pre>\n"}, {"tags": ["go", "ip", "packet", "icmp"], "comments": [{"owner": {"reputation": 27, "user_id": 8476120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972f2a3e218f620b6db91f2f7bd855b8?s=128&d=identicon&r=PG&f=1", "display_name": "Albert Fereidun", "link": "https://stackoverflow.com/users/8476120/albert-fereidun"}, "edited": false, "score": 0, "creation_date": 1539734359, "post_id": 52845450, "comment_id": 92606982, "body": "Maybe I should use <code>syscall.Socket()</code> to get <code>raw socket</code>? I have not tried this..."}], "owner": {"reputation": 27, "user_id": 8476120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972f2a3e218f620b6db91f2f7bd855b8?s=128&d=identicon&r=PG&f=1", "display_name": "Albert Fereidun", "link": "https://stackoverflow.com/users/8476120/albert-fereidun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539738051, "creation_date": 1539733817, "last_edit_date": 1539738051, "question_id": 52845450, "link": "https://stackoverflow.com/questions/52845450/how-to-send-a-fake-icmp-response", "title": "How to send a fake ICMP response?", "body": "<p>I am using TAP-Windows Adapter to capture all IP packets.\nAnd for some reason, I want to fake ICMP packet (fake src and dst),in order to let programs on my device get wrong ICMP delay. (maybe quick response or forward to other IP)</p>\n\n<p>I knew scapy can send fake ICMP packet, but now I want to use golang to achieve this.</p>\n\n<p>I using <code>net.DialIP(\"ip4:icmp\",fake_src,fake_dst)</code>, maybe as <code>raw socket</code>.\nHowever, I get an error :<code>dial ip4:icmp 8.8.8.8-&gt;10.9.9.2: bind: The requested address is not valid in its context.</code></p>\n\n<p>So what should I do?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 3, "creation_date": 1539733518, "post_id": 52845294, "comment_id": 92606805, "body": "In Go, always check for errors. For example, <code>err = json.Unmarshal(byteValue, &amp;pageList)</code>."}, {"owner": {"reputation": 128, "user_id": 9646215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/733b088a1b3ee3615881704aba61c351?s=128&d=identicon&r=PG&f=1", "display_name": "AAvery", "link": "https://stackoverflow.com/users/9646215/aavery"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1539734439, "post_id": 52845294, "comment_id": 92607005, "body": "Thanks for this. It gave me exactly what I was looking for. The issue was the trailing comma on the last Author"}, {"owner": {"reputation": 128, "user_id": 9646215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/733b088a1b3ee3615881704aba61c351?s=128&d=identicon&r=PG&f=1", "display_name": "AAvery", "link": "https://stackoverflow.com/users/9646215/aavery"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1539735927, "post_id": 52845294, "comment_id": 92607340, "body": "Unfortunately now the array has the expected length, but the values of the PageData attributes are all empty strings for some reason"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1539739451, "post_id": 52845294, "comment_id": 92608086, "body": "If you write a test or use <code>go vet</code> directly it will show you the next problem: <code>bad syntax for struct tag value</code>."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1539740762, "last_edit_date": 1539740762, "creation_date": 1539740459, "answer_id": 52846175, "question_id": 52845294, "link": "https://stackoverflow.com/questions/52845294/no-values-when-loading-json-from-file-golang/52846175#52846175", "title": "No Values when Loading Json from File Golang", "body": "<p>Fix the JSON commas and the Go struct field tags. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\ntype PageData struct {\n    Title       string   `json:\"page_title\"`\n    Description string   `json:\"page_description\"`\n    Link        string   `json:\"link\"`\n    Authors     []string `json:\"authors\"`\n}\n\nfunc main() {\n    var numPages int = LoadPageData(\"page_data.json\")\n    fmt.Printf(\"Num Pages: %d\\n\", numPages)\n}\n\nfunc LoadPageData(path string) int {\n    jsonFile, err := os.Open(path)\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer jsonFile.Close()\n    byteValue, err := ioutil.ReadAll(jsonFile)\n    if err != nil {\n        fmt.Println(err)\n    }\n    var pageList []PageData\n\n    err = json.Unmarshal(byteValue, &amp;pageList)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(pageList)\n\n    return len(pageList)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[{Page1 Introduction example_link [Author1 Author2 Author3]}]\n</code></pre>\n\n<p><code>page_data.json</code>:</p>\n\n<pre><code>[\n    {\n        \"page_title\": \"Page1\",\n        \"page_description\": \"Introduction\",\n        \"link\": \"example_link\",\n        \"authors\":\n        [\n            \"Author1\",\n            \"Author2\",\n            \"Author3\"\n        ]\n    }\n]\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 9646215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/733b088a1b3ee3615881704aba61c351?s=128&d=identicon&r=PG&f=1", "display_name": "AAvery", "link": "https://stackoverflow.com/users/9646215/aavery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 52846175, "answer_count": 1, "score": 1, "last_activity_date": 1539740762, "creation_date": 1539732437, "question_id": 52845294, "link": "https://stackoverflow.com/questions/52845294/no-values-when-loading-json-from-file-golang", "title": "No Values when Loading Json from File Golang", "body": "<p>I hope someone could help me with this issue because I have been scratching my head for a while.</p>\n\n<p>I have a project where I am trying to load json into a struct in go. I have followed exactly several tutorials online, but keep getting no data back and no error.</p>\n\n<p>My json file is called page_data.json and looks like: </p>\n\n<pre><code>[\n    {\n        \"page_title\": \"Page1\",\n        \"page_description\": \"Introduction\",\n        \"link\": \"example_link\",\n        \"authors\":\n        [\n            \"Author1\",\n            \"Author2\",\n            \"Author3\",\n        ]\n    },\n    // second object, same as the first\n]\n</code></pre>\n\n<p>But when I try the following in go:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"encoding/json\"\n\"os\"\n\"io/ioutil\"\n )\n\ntype PageData struct {\n  Title string `json: \"page_title\"`\n  Description string `json: \"page_description\"`\n  Link string `json: \"link\"`\n  Authors []string `json: \"authors\"`\n}\n\nfunc main() {\n    var numPages int = LoadPageData(\"page_data.json\")\n    fmt.Printf(\"Num Pages: %d\", numPages)\n}\n\nfunc LoadPageData(path string) int {\n    jsonFile, err := os.Open(path)\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer jsonFile.Close()\n    byteValue, _ := ioutil.ReadAll(jsonFile)\n\n    var pageList []PageData\n\n    json.Unmarshal(byteValue, &amp;pageList)\n    return len(pageList)\n}\n</code></pre>\n\n<p>the output I get is:</p>\n\n<p>Num Pages: 0</p>\n"}, {"tags": ["go", "cassandra", "gocql"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6945764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221a5440f56f1eba8b271beeef919fd3?s=128&d=identicon&r=PG&f=1", "display_name": "h94", "link": "https://stackoverflow.com/users/6945764/h94"}, "edited": false, "score": 0, "creation_date": 1539731551, "post_id": 52845056, "comment_id": 92606383, "body": "Hey, you are correct..This was a syntax error on my part. Take a look at the answer that I posted. The change I suggest there correctly wrote the data into Cassandra :)"}, {"owner": {"reputation": 163, "user_id": 6338010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b2d062ab7e8473532c9c22203352c3?s=128&d=identicon&r=PG&f=1", "display_name": "falberto89", "link": "https://stackoverflow.com/users/6338010/falberto89"}, "reply_to_user": {"reputation": 55, "user_id": 6945764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221a5440f56f1eba8b271beeef919fd3?s=128&d=identicon&r=PG&f=1", "display_name": "h94", "link": "https://stackoverflow.com/users/6945764/h94"}, "edited": false, "score": 0, "creation_date": 1539732064, "post_id": 52845056, "comment_id": 92606497, "body": "I have seen. My doubt now is about the definition of the type. Why have you declared test_type with x and y as float in Cassandra? Aren&#39;t they maps in Golang?"}, {"owner": {"reputation": 55, "user_id": 6945764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221a5440f56f1eba8b271beeef919fd3?s=128&d=identicon&r=PG&f=1", "display_name": "h94", "link": "https://stackoverflow.com/users/6945764/h94"}, "edited": false, "score": 0, "creation_date": 1539745190, "post_id": 52845056, "comment_id": 92609247, "body": "You can do that as well. However, in my use case I wanted to represent it as a struct instead of a map."}], "tags": [], "owner": {"reputation": 163, "user_id": 6338010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b2d062ab7e8473532c9c22203352c3?s=128&d=identicon&r=PG&f=1", "display_name": "falberto89", "link": "https://stackoverflow.com/users/6338010/falberto89"}, "is_accepted": false, "score": 1, "last_activity_date": 1539730687, "creation_date": 1539730687, "answer_id": 52845056, "question_id": 52844147, "link": "https://stackoverflow.com/questions/52844147/inserting-an-array-of-user-defined-types-into-cassandra-using-gocql/52845056#52845056", "title": "Inserting an array of user defined types into Cassandra using gocql", "body": "<p>Maybe it isn't important, but I have read on <a href=\"https://docs.datastax.com/en/cql/3.3/cql/cql_reference/collection_type_r.html\" rel=\"nofollow noreferrer\">https://docs.datastax.com/en/cql/3.3/cql/cql_reference/collection_type_r.html</a> that it isn't</p>\n\n<p><code>CREATE TABLE test_table(\n     key text,\n     test_array list&lt;FROZEN test_type&gt;&gt;,\n     PRIMARY KEY (key))</code></p>\n\n<p>but</p>\n\n<p><code>CREATE TABLE test_table(\n     key text,\n     test_array list&lt;FROZEN &lt;test_type&gt;&gt;,\n     PRIMARY KEY (key))</code></p>\n\n<p>the correct definition of the table. I haven't the way to try your code, tell me if it change something.</p>\n\n<p>An other thing that I have read is in <a href=\"https://stackoverflow.com/questions/48662850/update-a-collection-type-of-a-custom-type-in-cassandra\">Update a collection type of a custom type in cassandra</a> \nI think you should define your custom type in Cassandra, because you have a list of custom type.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 6945764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221a5440f56f1eba8b271beeef919fd3?s=128&d=identicon&r=PG&f=1", "display_name": "h94", "link": "https://stackoverflow.com/users/6945764/h94"}, "is_accepted": true, "score": 0, "last_activity_date": 1539731472, "creation_date": 1539731472, "answer_id": 52845160, "question_id": 52844147, "link": "https://stackoverflow.com/questions/52844147/inserting-an-array-of-user-defined-types-into-cassandra-using-gocql/52845160#52845160", "title": "Inserting an array of user defined types into Cassandra using gocql", "body": "<p>Per: <a href=\"https://stackoverflow.com/questions/8270816/converting-go-struct-to-json\">Converting Go struct to JSON</a></p>\n\n<p>The problem was resolved by renaming the fields so it exports. That way gocql can see the data type x &amp; y. </p>\n\n<p>Simply renaming <code>x</code>to <code>X</code> and <code>y</code> to <code>Y</code>. Will do the trick</p>\n"}], "owner": {"reputation": 55, "user_id": 6945764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221a5440f56f1eba8b271beeef919fd3?s=128&d=identicon&r=PG&f=1", "display_name": "h94", "link": "https://stackoverflow.com/users/6945764/h94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1226, "favorite_count": 0, "accepted_answer_id": 52845160, "answer_count": 2, "score": 2, "last_activity_date": 1539745271, "creation_date": 1539724518, "last_edit_date": 1539745271, "question_id": 52844147, "link": "https://stackoverflow.com/questions/52844147/inserting-an-array-of-user-defined-types-into-cassandra-using-gocql", "title": "Inserting an array of user defined types into Cassandra using gocql", "body": "<p>I have a UDT in Cassandra and I have a table that has an array of these UDTs in its schema. Here's a sample:</p>\n\n<pre><code>CREATE TYPE keyspace.test_type(\n    x float, \n    y float)\n</code></pre>\n\n<p>In my schema I have</p>\n\n<pre><code> CREATE TABLE test_table(\n     key text,\n     test_array list&lt;FROZEN &lt;test_type&gt;&gt;,\n     PRIMARY KEY (key))\n</code></pre>\n\n<p>Inside my go package I built a struct:</p>\n\n<pre><code>type Test_type struct{\n     x float32\n     y float32\n}\n</code></pre>\n\n<p>Then I have a function that essentially returns a list of this test_type: <code>[]test_type</code>, let's call it <code>my_array</code>.</p>\n\n<p>When I try to do the insert using gocql like such:</p>\n\n<pre><code> err := gocql.Session.Query('INSERT into test_table (key,test_array)\n                             VALUES (?,?)', 'key', my_array).Exec()\n</code></pre>\n\n<p>I get a bunch of null values instead of my array. Essentially the test_type does not correctly map to the UDT that I created is my assumption. </p>\n\n<p>Essentially my question is how do you map a struct in go to a udt such that the type is recognized properly. . </p>\n"}, {"tags": ["c++", "go", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10542325, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i3BWlHmtqHE/AAAAAAAAAAI/AAAAAAAAHXA/WKGr1cc_qqo/photo.jpg?sz=128", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/10542325/abhishek-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1540234411, "creation_date": 1540234411, "answer_id": 52935991, "question_id": 52841895, "link": "https://stackoverflow.com/questions/52841895/grpc-client-streaming/52935991#52935991", "title": "gRPC client streaming", "body": "<p>Once the response and status are sent by the server and received back at the client(i.e., the client-side gRPC stack) , subsequent attempts to Write() will start failing. The first failing Write() is the signal to the client that it should stop Writing and Finish the RPC.</p>\n\n<p>So the two options here are:\n1. Wait for a Write to fail, then call finish to receive the Server's response and status.\n2. Switch to Bidirectional Streaming if the client really wants to read the response from the server before calling Finish.</p>\n"}], "owner": {"reputation": 1, "user_id": 4780643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c54b0b3dfe6101fde5aaca0102e2455?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin Spiewak", "link": "https://stackoverflow.com/users/4780643/marcin-spiewak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 979, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543141102, "creation_date": 1539714650, "question_id": 52841895, "link": "https://stackoverflow.com/questions/52841895/grpc-client-streaming", "title": "gRPC client streaming", "body": "<p>Official gRPC documentation for client streaming states that: </p>\n\n<blockquote>\n  <p>The server sends back a single response, typically but not necessarily after it has received all the client\u2019s requests...</p>\n</blockquote>\n\n<p>What I'm trying to do is to catch server response in the middle of the stream to stop sending more data.</p>\n\n<p>In Go I can spin up a new goroutine listening for the message from the server using <a href=\"https://godoc.org/google.golang.org/grpc#ClientStream\" rel=\"nofollow noreferrer\">RecvMsg</a>, but I can't find a way to do the same in C++. It looks like <a href=\"https://grpc.io/grpc/cpp/classgrpc_1_1_client_writer.html\" rel=\"nofollow noreferrer\">ClientWriter</a> doesn't offer this kind of functionality.</p>\n\n<p>One solution would be to have a bidirectional stream but was wondering if there is any other way to achieve this in C++.</p>\n"}, {"tags": ["go", "module"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1539710065, "post_id": 52840620, "comment_id": 92597348, "body": "Is <code>abc&#47;p</code> a directory or file?"}, {"owner": {"reputation": 179, "user_id": 3168473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/63399da3f0e6188eb8bc10d12da28d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Batman Rises", "link": "https://stackoverflow.com/users/3168473/batman-rises"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1539710100, "post_id": 52840620, "comment_id": 92597361, "body": "@Gavin it\u2019s a directory which has go files in it"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539715885, "post_id": 52840620, "comment_id": 92600344, "body": "You put tho go.mod file at the root of your module. Module boundaries and source code repositories do not need to overlap."}, {"owner": {"reputation": 179, "user_id": 3168473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/63399da3f0e6188eb8bc10d12da28d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Batman Rises", "link": "https://stackoverflow.com/users/3168473/batman-rises"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539715983, "post_id": 52840620, "comment_id": 92600401, "body": "@Volker by root you meant to say in xyz right ?"}, {"owner": {"reputation": 179, "user_id": 3168473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/63399da3f0e6188eb8bc10d12da28d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Batman Rises", "link": "https://stackoverflow.com/users/3168473/batman-rises"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539718351, "post_id": 52840620, "comment_id": 92601470, "body": "@Volker if i place it at xyz which is the root then i have to change all the imports inside the go file for other packages like xyx/src/abc in go file inside def directory"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1539721348, "post_id": 52840620, "comment_id": 92602919, "body": "This is all wrong. xyz/src looks like a GOPATH based layout and no of course not below xyz. Please come up with a understandable real-life fs-structure. Nobody can discuss abc and xyz. Again. You place go.mod at the root of what makes a module. if xyz is a module: Put it there if o is a module: Put it there."}, {"owner": {"reputation": 179, "user_id": 3168473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/63399da3f0e6188eb8bc10d12da28d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Batman Rises", "link": "https://stackoverflow.com/users/3168473/batman-rises"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539721915, "post_id": 52840620, "comment_id": 92603175, "body": "@Volker considering that i will create a folder root inside src and put the abc,def, etc inside that and put the mod file in the root directory as abc,def and etc makes a single module.Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 841, "user_id": 1241141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcdb618c55fec7ec4c807a7b8d127622?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/1241141/jonathan"}, "edited": false, "score": 0, "creation_date": 1604651129, "post_id": 52856519, "comment_id": 114417302, "body": "The problem with this answer is that at the top level, &quot;go run cmd/server/main.go&quot; bombs out when it can&#39;t find the source files under pkg/..."}], "tags": [], "owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "is_accepted": false, "score": 2, "last_activity_date": 1539784158, "creation_date": 1539784158, "answer_id": 52856519, "question_id": 52840620, "link": "https://stackoverflow.com/questions/52840620/where-to-place-go-mod-file/52856519#52856519", "title": "Where to place go.mod file", "body": "<p>I have a single go.mod in the root of my go application. I am using the following structure inspired by <a href=\"https://www.youtube.com/watch?v=oL6JBUk6tj0\" rel=\"nofollow noreferrer\">Kat Zien - How Do You Structure Your Go Apps</a></p>\n\n<p>At the minute one of my applications looks like this</p>\n\n<pre><code>.\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 cmd\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cli\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 server\n\u2502       \u2514\u2500\u2500 main.go\n\u251c\u2500\u2500 pkg\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 http\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 rest\n|   \u2502 # app-specific directories excluded\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 storage\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 sqlite\n</code></pre>\n\n<p>All packages are imported via their full path, i.e. <code>import \"github.com/myusername/myapp/pkg/http/rest\"</code> otherwise it causes problems all over the place and <strong>this was the one change I had to make going from <code>$GOPATH</code> to <code>go mod</code>.</strong></p>\n\n<p><code>go mod</code> then handles all the dependencies it discovers properly as far as I've discovered so far.</p>\n"}, {"tags": [], "owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "is_accepted": false, "score": 2, "last_activity_date": 1564705203, "last_edit_date": 1564705203, "creation_date": 1552684629, "answer_id": 55190783, "question_id": 52840620, "link": "https://stackoverflow.com/questions/52840620/where-to-place-go-mod-file/55190783#55190783", "title": "Where to place go.mod file", "body": "<p>The most common and easiest approach is <strong>a single go.mod file</strong> in your repository, where that single go.mod file is <strong>placed in the root of your repository</strong>.</p>\n\n<p>Russ Cox commented in <a href=\"https://github.com/golang/go/issues/26664#issuecomment-455232444\" rel=\"nofollow noreferrer\">#26664</a>:</p>\n\n<blockquote>\n  <p>For all but power users, you probably want to adopt the usual convention that one repo = one module. It's important for long-term evolution of code storage options that a repo <em>can</em> contain multiple modules, but it's almost certainly not something you want to do by default.</p>\n</blockquote>\n\n<p>The Modules wiki <a href=\"https://github.com/golang/go/wiki/Modules#gomod\" rel=\"nofollow noreferrer\">says</a>:</p>\n\n<blockquote>\n  <p>For example, if you are creating a module for a repository\n  <code>github.com/my/repo</code> that will contain two packages with import paths\n  <code>github.com/my/repo/foo</code> and <code>github.com/my/repo/bar</code>, then the first\n  line in your <code>go.mod</code> file typically would declare your module path as\n  <code>module github.com/my/repo</code>, and the corresponding on-disk structure\n  could be:</p>\n</blockquote>\n\n<pre><code>repo/\n\u251c\u2500\u2500 go.mod      &lt;&lt;&lt;&lt;&lt; Note go.mod is located in repo root\n\u251c\u2500\u2500 bar\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 bar.go\n\u2514\u2500\u2500 foo\n    \u2514\u2500\u2500 foo.go\n</code></pre>\n\n<p>In Go source code, packages are imported using the full path including\nthe module path. For example, if a module declared its identity in its\n<code>go.mod</code> as <code>module github.com/my/repo</code>, a consumer could do:</p>\n\n<pre><code>import \"example.com/my/repo/bar\"\n</code></pre>\n\n<p>That imports package <code>bar</code> from the module <code>github.com/my/repo</code>.</p>\n"}], "owner": {"reputation": 179, "user_id": 3168473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/63399da3f0e6188eb8bc10d12da28d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Batman Rises", "link": "https://stackoverflow.com/users/3168473/batman-rises"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5009, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1564705203, "creation_date": 1539709513, "last_edit_date": 1539712626, "question_id": 52840620, "link": "https://stackoverflow.com/questions/52840620/where-to-place-go-mod-file", "title": "Where to place go.mod file", "body": "<p>I have a repository structure as follows :-</p>\n\n<pre><code>xyz/src\n      1. abc\n            - p\n            - q\n            - r\n      2. def\n            - t\n            - u\n            - v\n      3. etc\n            - o\n            - m\n            - n\n</code></pre>\n\n<p>I have created a .mod file in src and run go build ./...\nExcept for local packages everything is fine. So if abc/p is being used in def then it throws the following exception :- cannot find module providing package abc/p. The idea behind keeping the .mod file in src package was to make sure the path is being found from where the mod file is located. Can anyone suggest where should the mod file ideally should be? also i tried placing it one directory above in xyz but still same issue as well as i created one for each sub directory. I am bit confused on this. Will I have to create separate repository for abc and etc. But considering gopath which earlier used to work for the same I think module should also be able to do the same. Any suggestions?</p>\n"}, {"tags": ["go", "embedding"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1539699922, "post_id": 52837457, "comment_id": 92591600, "body": "See <a href=\"https://stackoverflow.com/questions/40823315/x-does-not-implement-y-method-has-a-pointer-receiver/40824044#40824044\">X does not implement Y (\u2026 method has a pointer receiver)</a> (2nd part of the answer: Structs and embedding). Also: <a href=\"https://stackoverflow.com/questions/52739991/why-does-this-type-assertion-on-a-direct-implemented-interface-fail\">Why does this Type Assertion on a direct implemented interface fail?</a>"}, {"owner": {"reputation": 2917, "user_id": 940939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f04fbc97c3735bb1e24b90e1aa336aae?s=128&d=identicon&r=PG", "display_name": "Massimo Zerbini", "link": "https://stackoverflow.com/users/940939/massimo-zerbini"}, "edited": false, "score": 0, "creation_date": 1539701075, "post_id": 52837457, "comment_id": 92592326, "body": "You ca use both the implementations of Sub but you need to use a pointer in the first case. For example  <a href=\"https://play.golang.org/p/1zPXfsJacBt\" rel=\"nofollow noreferrer\">play.golang.org/p/1zPXfsJacBt</a>"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1539699983, "creation_date": 1539699983, "answer_id": 52837766, "question_id": 52837457, "link": "https://stackoverflow.com/questions/52837457/unexpected-behavior-in-go-structs/52837766#52837766", "title": "Unexpected behavior in Go structs", "body": "<p><code>*Base</code> has a method <code>Bar</code>, but <code>Base</code> does not; so <code>Base</code> does not implement <code>ITest</code>. Thus, embedding a <code>*Base</code> allows <code>Sub</code> to implement the interface.</p>\n\n<p>Your use of the names <code>Base</code> and <code>Sub</code> also implies you may be conflating composition and inheritance, which you should be very careful with in Go. <em>There is no inheritance in Go</em>. There are no base classes, no subclasses, no class hierarchy, no inheritance. The <em>only</em> form of polymorphism in go is interfaces.</p>\n"}], "owner": {"reputation": 139, "user_id": 7219692, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qPHnjUYIcwM/AAAAAAAAAAI/AAAAAAAAA6A/vxN08tG1erQ/photo.jpg?sz=128", "display_name": "Gordy", "link": "https://stackoverflow.com/users/7219692/gordy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1539700054, "answer_count": 1, "score": 0, "last_activity_date": 1539699983, "creation_date": 1539698923, "last_edit_date": 1539699461, "question_id": 52837457, "link": "https://stackoverflow.com/questions/52837457/unexpected-behavior-in-go-structs", "closed_reason": "Duplicate", "title": "Unexpected behavior in Go structs", "body": "<p>I faced a strange behavior in Go structs. I might be misunderstanding something but when I created like so:</p>\n\n<pre><code>type ITest interface {\n    Foo() string\n    Bar(string)\n}\n\ntype Base struct {\n    value string\n}\n\nfunc (b Base) Foo () string {\n    return b.value\n}\n\nfunc (b *Base) Bar (val string) {\n    b.value = val\n}\n// Not implementing ITest\ntype Sub struct {\n    Base\n}\n// Now it works\ntype Sub struct {\n    *Base\n}\n</code></pre>\n\n<p>Then <code>Sub</code> is not implementing <code>ITest</code>. But if I change <code>Sub</code> to embed pointer of <code>Base</code> it starts to implement <code>ITest</code>. I know it somehow related to caller in methods but come on. So the question is: Is that me Going wrong or Go have problems with embedding logic?</p>\n"}, {"tags": ["go", "marshalling", "unmarshalling"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539692960, "post_id": 52835458, "comment_id": 92587037, "body": "Refer this, <a href=\"https://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">blog.golang.org/json-and-go</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1539693717, "post_id": 52835458, "comment_id": 92587494, "body": "Related / possible duplicate of <a href=\"https://stackoverflow.com/questions/52690337/intersection-of-json-strings/52692253#52692253\">Intersection of JSON strings</a>. Not an exact duplicate, but the same technique can be applied here as well."}, {"owner": {"reputation": 203, "user_id": 7919991, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c67ec46250dd36b37af6c51f7ee6c899?s=128&d=identicon&r=PG&f=1", "display_name": "nihal", "link": "https://stackoverflow.com/users/7919991/nihal"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1539756373, "post_id": 52835458, "comment_id": 92612202, "body": "@icza Thanks! this does exactly what I needed."}, {"owner": {"reputation": 203, "user_id": 7919991, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c67ec46250dd36b37af6c51f7ee6c899?s=128&d=identicon&r=PG&f=1", "display_name": "nihal", "link": "https://stackoverflow.com/users/7919991/nihal"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1540366449, "post_id": 52835458, "comment_id": 92833313, "body": "@icza this one worked, but for the array part inside a json, i had to write a lot of custom code. I am trying to figure out if there is an easier way to do that."}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 7919991, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c67ec46250dd36b37af6c51f7ee6c899?s=128&d=identicon&r=PG&f=1", "display_name": "nihal", "link": "https://stackoverflow.com/users/7919991/nihal"}, "edited": false, "score": 0, "creation_date": 1540366511, "post_id": 52835565, "comment_id": 92833351, "body": "We don&#39;t know the json structure at the time of coding. Thanks for the above code anyways."}], "tags": [], "owner": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "is_accepted": false, "score": 5, "last_activity_date": 1539693741, "last_edit_date": 1539693741, "creation_date": 1539693155, "answer_id": 52835565, "question_id": 52835458, "link": "https://stackoverflow.com/questions/52835458/how-to-unmarshal-a-byte-into-a-json-structure-that-is-stored-as-a-value-inside/52835565#52835565", "title": "How to unmarshal a []byte into a json structure that is stored as a value inside a variable of type string?", "body": "<p>Try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype myjsonstruct struct {\n    FldA string `json:\"fldA\"`\n    FldB string `json:\"fldB\"`\n    FldC string `json:\"fldC\"`\n}\n\nfunc main() {\n    targetJsonString := `{\"fldA\":\"valueA\",\"fldA\":\"valueB\",\"fldA\":\"valueC\",\"fldOther\":\"valueOther\"}`\n\n    res := &amp;myjsonstruct{}\n    if err := json.Unmarshal([]byte(targetJsonString), res); err != nil {\n        panic(err)\n    }\n\n    myjsonstructBytes, err := json.Marshal(res)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(myjsonstructBytes))\n}\n</code></pre>\n\n<p>It will print:\n<code>{\"fldA\":\"valueC\",\"fldB\":\"\",\"fldC\":\"\"}</code></p>\n\n<p>In playground: <a href=\"https://play.golang.org/p/qUkGAmvsmAD\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qUkGAmvsmAD</a></p>\n\n<p><code>(!)</code> Also note, that fields in <code>myjsonstruct</code> must be public (start from capital letter), otherwise unmarshaller will not be able to access those fields.</p>\n"}], "owner": {"reputation": 203, "user_id": 7919991, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c67ec46250dd36b37af6c51f7ee6c899?s=128&d=identicon&r=PG&f=1", "display_name": "nihal", "link": "https://stackoverflow.com/users/7919991/nihal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539696460, "creation_date": 1539692818, "last_edit_date": 1539696460, "question_id": 52835458, "link": "https://stackoverflow.com/questions/52835458/how-to-unmarshal-a-byte-into-a-json-structure-that-is-stored-as-a-value-inside", "title": "How to unmarshal a []byte into a json structure that is stored as a value inside a variable of type string?", "body": "<p>Note: myjsonstruct is stored and read from a database. Hardcoding for clarity</p>\n\n<pre><code>myjsonstruct := `{\"fldA\":\"\", \"fldB\":\"\", \"fldC\":\"\"}`\n\ntargetJsonString := `{\"fldA\":\"valueA\",\"fldB\":\"valueB\",\"fldC\":\"valueC\",\"fldOther\":\"valueOther\"}`\n</code></pre>\n\n<p>Now, i want to unmarshal <code>targetJsonString</code> into <code>myjsonstruct</code> so that corresponding fields in <code>myjsonstruct</code> get populated. </p>\n\n<p>Please note: myjsonstruct is a \"string\" and cannot be programmed in the code. I dont know this structure at the time of coding. it will be read as a string during runtime, perhaps from a database.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["html", "image", "templates", "go", "wkhtmltopdf"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8477378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zW2k.jpg?s=128&g=1", "display_name": "flrnt", "link": "https://stackoverflow.com/users/8477378/flrnt"}, "edited": false, "score": 0, "creation_date": 1539699769, "post_id": 52836117, "comment_id": 92591484, "body": "Thank you @kostix you mean I&#39;ve to save my png to f/s then convert it to base64 then output as img tag into my template ?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 115, "user_id": 8477378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zW2k.jpg?s=128&g=1", "display_name": "flrnt", "link": "https://stackoverflow.com/users/8477378/flrnt"}, "edited": false, "score": 0, "creation_date": 1539704101, "post_id": 52836117, "comment_id": 92594235, "body": "Simplified, yes. Be sure to first practice on some static data to verify <code>wkhtmltopdf</code> will grok it (get some picture, encode it as base64, put to your template and see if you&#39;ll get a PDF with an embedded picture as a result)."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 115, "user_id": 8477378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zW2k.jpg?s=128&g=1", "display_name": "flrnt", "link": "https://stackoverflow.com/users/8477378/flrnt"}, "edited": false, "score": 0, "creation_date": 1539704205, "post_id": 52836117, "comment_id": 92594287, "body": "Ostensibly, other ways to explore\u2014if this thing will fail for you\u2014is 1) painting your barcode as a set of lines in an embedded SVG image; 2) painting it the same way on a <code>&lt;canvas&gt;</code> element."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1539695017, "creation_date": 1539695017, "answer_id": 52836117, "question_id": 52833028, "link": "https://stackoverflow.com/questions/52833028/generate-pdf-in-go-with-a-dynamic-image/52836117#52836117", "title": "Generate PDF in Go with a dynamic image", "body": "<p>Supposedly you might get away by using <a href=\"https://en.wikipedia.org/wiki/Data_URI_scheme\" rel=\"nofollow noreferrer\">embedding image data directly into your HTML pages</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 8477378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zW2k.jpg?s=128&g=1", "display_name": "flrnt", "link": "https://stackoverflow.com/users/8477378/flrnt"}, "is_accepted": false, "score": 0, "last_activity_date": 1539763421, "creation_date": 1539763421, "answer_id": 52850032, "question_id": 52833028, "link": "https://stackoverflow.com/questions/52833028/generate-pdf-in-go-with-a-dynamic-image/52850032#52850032", "title": "Generate PDF in Go with a dynamic image", "body": "<p>Thank you @kostix I'm pretty close. Now i'm stuck into another problem. I generated barcode (128), converted it to base64. When I pass it to my template like so :  it breaks my png once I open the pdf. But if I take the content of base64BarcodeUrl and paste it directly as src to my img tag, it works like a charm.\nbase64BarcodeUrl = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAABkEAAAAABJ+o5fAAABYUlEQVR4nOzSUYrCMBRA0ekw+99yhyLBUhIq2Pt3zo9V40si92/ffx6zba/XY+bxPGaPz8d317Xj/fksq9/P5p/Xr+Ze18/OtZoxO+/svqs51z1W97j7n+6eZ/vMzvvJfb/1+9woeBMWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGREBYJYZEQFglhkRAWCWGR+A8AAP//9bRAyVZD8C0AAAAASUVORK5C\"\nIs there any issue I'm not aware about \"injecting\" some data ?</p>\n"}], "owner": {"reputation": 115, "user_id": 8477378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zW2k.jpg?s=128&g=1", "display_name": "flrnt", "link": "https://stackoverflow.com/users/8477378/flrnt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1539763421, "creation_date": 1539684504, "last_edit_date": 1539694714, "question_id": 52833028, "link": "https://stackoverflow.com/questions/52833028/generate-pdf-in-go-with-a-dynamic-image", "title": "Generate PDF in Go with a dynamic image", "body": "<p>I am new to Go and actually trying to figure out the way to handle images in templates.\nMy goal is to generate a barcode and insert it into a template I wrote.\nThe program already use go-wkhtmltopdf to generate pdf but lacks about images.\nMy main question is : what's nicest way to do this ?\nShould I generate an image in a public directory then insert into img src tag/property ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1539683735, "post_id": 52832424, "comment_id": 92581648, "body": "you don&#39;t have to start the names of your structs with lower case in Go"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539684103, "post_id": 52832424, "comment_id": 92581877, "body": "<a href=\"https://golang.org/doc/effective_go.html#names\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#names</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1539688815, "post_id": 52832424, "comment_id": 92584506, "body": "For package main: Nobody cares."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1539684293, "creation_date": 1539684293, "answer_id": 52832969, "question_id": 52832424, "link": "https://stackoverflow.com/questions/52832424/case-of-the-first-letter-of-name-for-type-struct-in-main-package/52832969#52832969", "title": "Case of the first letter of name for type struct in main package", "body": "<p>This isn't a question of what's idiomatic, if an identifier starts with a lowercase letter, it's not exported and therefore can only be accessed from the declaring package (directly), and if an identifier starts with an uppercase letter (Unicode class \"Lu\"), it's exported and can be referred to from any package. For details, see <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">Spec: Exported identifiers</a>. This was a design decision, which I personally like (it keeps the source clean, and <em>\"They even have semantic effect: the visibility of a name outside a package is determined by whether its first character is upper case\"</em> \u2013 <a href=\"https://golang.org/doc/effective_go.html#names\" rel=\"nofollow noreferrer\">Effective Go: Names</a>).</p>\n\n<p>The <code>main</code> package is special: you can't import the main package, so it doesn't matter how you name your identifiers in the <code>main</code> package, no one (no package other than the <code>main</code>) will refer to them / use them.</p>\n\n<p>See more releavant blog posts:</p>\n\n<p><a href=\"https://golang.org/doc/faq#unicode_identifiers\" rel=\"nofollow noreferrer\">Go FAQ: What's up with Unicode identifiers?</a></p>\n\n<p><a href=\"https://www.ardanlabs.com/blog/2014/03/exportedunexported-identifiers-in-go.html\" rel=\"nofollow noreferrer\">Ardan labs: Exported / Unexported Identifiers In Go</a></p>\n"}], "owner": {"reputation": 45, "user_id": 7634727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56eeac9d14ac497c3aa60561af8b52f3?s=128&d=identicon&r=PG", "display_name": "edwvee", "link": "https://stackoverflow.com/users/7634727/edwvee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539688282, "creation_date": 1539682712, "last_edit_date": 1539688282, "question_id": 52832424, "link": "https://stackoverflow.com/questions/52832424/case-of-the-first-letter-of-name-for-type-struct-in-main-package", "title": "Case of the first letter of name for type struct in main package", "body": "<p>So it should be lowercase if it's not imported. And that's strange to import something from a main package. But, that's look very strange for me to use lowercase for the first of a struct/class from experience with other languages. What way is idiomatic?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 1, "creation_date": 1539681071, "post_id": 52831864, "comment_id": 92580053, "body": "This code doesn&#39;t seem to compile due to a missing argument."}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 1, "creation_date": 1539681465, "post_id": 52831864, "comment_id": 92580266, "body": "Why were trying to use contexts, without learning basics? <code>dosomething(...)</code> should be <code>DoSomething(...)</code>, pass your <code>ctx</code> as argument <code>b.DoSomething(ctx)</code>."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 1, "creation_date": 1539681470, "post_id": 52831864, "comment_id": 92580273, "body": "@bereal <code>dosomething</code> is also unexported"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1539681499, "post_id": 52831864, "comment_id": 92580291, "body": "Where are you importing the context package, and the fmt package, and the b package."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1539681520, "post_id": 52831864, "comment_id": 92580305, "body": "@pengliam you simplified your program to a degree when it does not demonstrate the original problem but makes no sense at all"}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1539706286, "post_id": 52833848, "comment_id": 92595474, "body": "Well, except that moving <code>DoSomething</code> to another package would eliminate the ability to get the <code>&quot;msg&quot;</code> value back out, since the <code>keyMsg()</code> type is unexported.  If you&#39;re using named types for the key (though int constants with <code>iota</code> work just as well for that), they either have to be exported or your package has to provide exported getter and setter functions for the context values."}, {"owner": {"reputation": 16, "user_id": 7764444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IX8kgqBLYaI/AAAAAAAAAAI/AAAAAAAAAII/ini9J-lN87w/photo.jpg?sz=128", "display_name": "Loyso", "link": "https://stackoverflow.com/users/7764444/loyso"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1540220071, "post_id": 52833848, "comment_id": 92773670, "body": "Thank you, @Kaedys! I&#39;ve fixed my answer."}], "tags": [], "owner": {"reputation": 16, "user_id": 7764444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IX8kgqBLYaI/AAAAAAAAAAI/AAAAAAAAAII/ini9J-lN87w/photo.jpg?sz=128", "display_name": "Loyso", "link": "https://stackoverflow.com/users/7764444/loyso"}, "is_accepted": true, "score": 0, "last_activity_date": 1540220042, "last_edit_date": 1540220042, "creation_date": 1539687306, "answer_id": 52833848, "question_id": 52831864, "link": "https://stackoverflow.com/questions/52831864/the-value-in-context-can-not-transmitted-in-different-package/52833848#52833848", "title": "The value in context can not transmitted in different package\uff1f", "body": "<p>I suggest you to use context only in a lifetime of a single task and pass the same context through functions.\nAlso you should understand where to use context and where just to pass arguments to functions. </p>\n\n<p>Another suggestion is to use custom types for setting and getting values from context.</p>\n\n<p>According to all above, you program should look like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n)\n\ntype KeyMsg string\n\nfunc main() {\n    ctx := context.WithValue(context.Background(), KeyMsg(\"msg\"), \"hello\")\n    DoSomething(ctx)\n}\n\n// DoSomething accepts context value, retrieves message by KeyMsg and prints it.\nfunc DoSomething(ctx context.Context) {\n    msg, ok := ctx.Value(KeyMsg(\"msg\")).(string)\n    if !ok {\n        return\n    }\n\n    fmt.Println(\"got msg:\", msg)\n}\n</code></pre>\n\n<p>You can move function DoSomething into another package and just call it as packagename.DoSomething it will change nothing.</p>\n"}], "owner": {"reputation": 13, "user_id": 7811568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540b3baeeb9fc1d30ebb220c925e5ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Liam Payne", "link": "https://stackoverflow.com/users/7811568/liam-payne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 52833848, "answer_count": 1, "score": -2, "last_activity_date": 1540220042, "creation_date": 1539680899, "question_id": 52831864, "link": "https://stackoverflow.com/questions/52831864/the-value-in-context-can-not-transmitted-in-different-package", "title": "The value in context can not transmitted in different package\uff1f", "body": "<p>Today I try to program with context,code as follow: </p>\n\n<pre><code>package main\n\nfunc main(){\n  ctx := context.Background()\n  ctx = context.WithValue(ctx,\"appid\",\"test111\")\n  b.dosomething()\n}\n\n\npackage b\n\nfunc dosomething(ctx context.Context){\n    fmt.Println(ctx.Value(\"appid\").(string))\n} \n</code></pre>\n\n<p>Then my program has crashed.I think it's due to that these ctx is in different package</p>\n"}, {"tags": ["php", "arrays", "go", "multidimensional-array"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1539680218, "post_id": 52831582, "comment_id": 92579558, "body": "Slices are indexed using integer numbers, and you used a <code>string</code> value. That obviously won&#39;t work. Maybe what you want is a slice of maps <code>[]map[string]float64</code> or a slice of structs describing your object?"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539680263, "post_id": 52831582, "comment_id": 92579580, "body": "how does your data look like, minimal example would help."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539680489, "post_id": 52831582, "comment_id": 92579697, "body": "&quot;I&#39;m very new to [Go]&quot; So take The Tour of Go and start with the simpler things until you are comfortable with them and jump into dynamic multidimensional stuff later."}, {"owner": {"reputation": 213, "user_id": 9223221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db22d31457019f8db39916c60d012fc?s=128&d=identicon&r=PG&f=1", "display_name": "btc user", "link": "https://stackoverflow.com/users/9223221/btc-user"}, "edited": false, "score": 0, "creation_date": 1539682011, "post_id": 52831582, "comment_id": 92580606, "body": "nilsocket i have updated with sample data"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539682122, "post_id": 52831582, "comment_id": 92580668, "body": "&quot;not able to find where it is going wrong&quot; You <b>cannot</b> use strings as slice indices in Go. Go is neither PHP nor JavaScript. You should try a map."}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "is_accepted": false, "score": 0, "last_activity_date": 1539708747, "last_edit_date": 1539708747, "creation_date": 1539682652, "answer_id": 52832408, "question_id": 52831582, "link": "https://stackoverflow.com/questions/52831582/how-to-insert-data-into-multi-dimension-array-in-golang/52832408#52832408", "title": "how to insert data into multi dimension array in golang?", "body": "<p>As you defined here your <code>arrDetails</code> variable as multidimentional slice as <code>[][]string</code>.It means you can not assign a <code>string</code> into its <code>keys</code> while you can assign string as a value.</p>\n\n<p>You can do your code like below I mentioned.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n  var arrDetails [][]string\n  var s []string\n  var index int\n  for i:=0; i&lt;5;i++ {\n     s = []string{\"001\", \"cust_001\", \"open\", \"200\"}\n     arrDetails = append(arrDetails, s)\n     index++\n  } \nfmt.Printf(\"Hello, playground %+v\", arrDetails )\n}\n</code></pre>\n\n<p>Or if you want <code>keys</code> and <code>value</code> pair then you've to use <code>map</code> as:</p>\n\n<pre><code>var arrDetails map[string]string\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 213, "user_id": 9223221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db22d31457019f8db39916c60d012fc?s=128&d=identicon&r=PG&f=1", "display_name": "btc user", "link": "https://stackoverflow.com/users/9223221/btc-user"}, "is_accepted": false, "score": 0, "last_activity_date": 1539685675, "creation_date": 1539685675, "answer_id": 52833363, "question_id": 52831582, "link": "https://stackoverflow.com/questions/52831582/how-to-insert-data-into-multi-dimension-array-in-golang/52833363#52833363", "title": "how to insert data into multi dimension array in golang?", "body": "<p>As per volker suggestion in the comment, I'm fill the multi dimensional array as below</p>\n\n<pre><code>arrDetails[index][0] = \"001\"\narrDetails[index][1] = \"cust_001\"\narrDetails[index][2] = \"open\"\narrDetails[index][3] = \"200\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 213, "user_id": 9223221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db22d31457019f8db39916c60d012fc?s=128&d=identicon&r=PG&f=1", "display_name": "btc user", "link": "https://stackoverflow.com/users/9223221/btc-user"}, "edited": false, "score": 0, "creation_date": 1539689593, "post_id": 52833900, "comment_id": 92584973, "body": "can we covert the result to json? json.Marshal?"}], "tags": [], "owner": {"reputation": 61, "user_id": 6076942, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gWl3eddD4us/AAAAAAAAAAI/AAAAAAAAACg/7v9hXU6UPS8/photo.jpg?sz=128", "display_name": "liao yu", "link": "https://stackoverflow.com/users/6076942/liao-yu"}, "is_accepted": false, "score": 0, "last_activity_date": 1539687509, "creation_date": 1539687509, "answer_id": 52833900, "question_id": 52831582, "link": "https://stackoverflow.com/questions/52831582/how-to-insert-data-into-multi-dimension-array-in-golang/52833900#52833900", "title": "how to insert data into multi dimension array in golang?", "body": "<p>you can try this:</p>\n\n<pre><code>import \"fmt\"\n\nfunc main() {\n\n    var arrDetails []map[string]string\n    var index int = 0\n\n    //for _, orderdetails := range ordersfromdb {\n    for i:=0; i&lt;5;i++ {\n        detail := make(map[string]string)\n\n        detail[\"OrderNumber\"] = \"001\"\n        detail[\"customernum\"] = \"cust_001\"\n        detail[\"orderstatus\"] = \"open\"\n        detail[\"orderprice\"] = \"200\"\n        arrDetails = append(arrDetails, detail)\n\n        index++\n    }\n    fmt.Printf(\"Hello, playground %+v\", arrDetails )\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "is_accepted": true, "score": 2, "last_activity_date": 1539692534, "creation_date": 1539692534, "answer_id": 52835387, "question_id": 52831582, "link": "https://stackoverflow.com/questions/52831582/how-to-insert-data-into-multi-dimension-array-in-golang/52835387#52835387", "title": "how to insert data into multi dimension array in golang?", "body": "<p>Let's consider this solution:</p>\n\n<pre><code>arrDetails := map[int]map[string]string{}\n\nindex := 0\nfor _, orderdetails := range ordersfromdb {\n    arrDetails[index] = map[string]string{} // you have to initialize map\n\n    arrDetails[index][\"OrderNumber\"] = \"001\"\n    arrDetails[index][\"customernum\"] = \"cust_001\"\n    arrDetails[index][\"orderstatus\"] = \"open\"\n    arrDetails[index][\"orderprice\"] = \"200\"\n\n    index++\n}\n</code></pre>\n\n<p>To convert results to json (as I saw you question in comment to @liao yu's answer), we should learn something more about <a href=\"https://golang.org/src/encoding/json/tags.go\" rel=\"nofollow noreferrer\">tags</a>:</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype OrderDetails struct {\n    Number   string `json:\"number\"`\n    Customer string `json:\"customer\"`\n    Status   string `json:\"status\"`\n    Price    string `json:\"price\"`\n}\n\nfunc main() {\n    ordersfromdb := []int{1, 2, 3}\n\n    var arrDetails []OrderDetails\n    for _, v := range ordersfromdb {\n        arrDetails = append(arrDetails, OrderDetails{\n            Number:   fmt.Sprintf(\"order_number_%v\", v),\n            Customer: fmt.Sprintf(\"customer_%v\", v),\n            Status:   fmt.Sprintf(\"order_status_%v\", v),\n            Price:    fmt.Sprintf(\"$%v\", v),\n        })\n    }\n\n    data, err := json.Marshal(arrDetails)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(data))\n}\n</code></pre>\n\n<p>See it on playground: <a href=\"https://play.golang.org/p/IA0G53YX_dZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IA0G53YX_dZ</a></p>\n"}], "owner": {"reputation": 213, "user_id": 9223221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db22d31457019f8db39916c60d012fc?s=128&d=identicon&r=PG&f=1", "display_name": "btc user", "link": "https://stackoverflow.com/users/9223221/btc-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 52835387, "answer_count": 4, "score": 3, "last_activity_date": 1539708747, "creation_date": 1539680067, "last_edit_date": 1539681380, "question_id": 52831582, "link": "https://stackoverflow.com/questions/52831582/how-to-insert-data-into-multi-dimension-array-in-golang", "title": "how to insert data into multi dimension array in golang?", "body": "<p>I have a dynamic multi dimension array, I need to fill dynamically from the loop. how can i define the array and fill the data.</p>\n\n<p>Here is the code which im trying</p>\n\n<pre><code>var arrDetails[][]string\nvar index int = 0\nfor _, orderdetails := range ordersfromdb {\n    arrDetails[index][\"OrderNumber\"] = \"001\"\n    arrDetails[index][\"customernum\"] = \"cust_001\"\n    arrDetails[index][\"orderstatus\"] = \"open\"\n    arrDetails[index][\"orderprice\"] = \"200\"\n    index++\n}\n</code></pre>\n\n<p>error which im facing: </p>\n\n<pre><code>non-integer slice index \"OrderNumber\"\nnon-integer slice index \"customernum\"\nnon-integer slice index \"orderstatus\"\nnon-integer slice index \"orderprice\"\n</code></pre>\n\n<p>I have done the same in php and works perfect:</p>\n\n<pre><code>for ($i=0;$i&lt;5:$i++)\n{\n     $arr_orderdetails[$i][\"OrderNumber\"] = \"001\";\n     $arr_orderdetails[$i][\"customernum\"] = \"cust_001\";\n     $arr_orderdetails[$i][\"orderstatus\"] = \"open\";\n     $arr_orderdetails[$i][\"orderprice\"] = \"200\";\n}\n</code></pre>\n\n<p>I'm new to golang, not able to find where it is going wrong, any help much appreciated.</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["go", "handler"], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 3, "last_activity_date": 1539689857, "creation_date": 1539689857, "answer_id": 52834620, "question_id": 52831471, "link": "https://stackoverflow.com/questions/52831471/record-response-bodies-for-logging-purposes/52834620#52834620", "title": "Record response bodies for logging purposes", "body": "<p>You already have a custom ResponseWriter, so just add a function something like this to override Write and store the amount written by the underlying writer: </p>\n\n<p><a href=\"https://play.golang.org/p/dwWEs5KI_wM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/dwWEs5KI_wM</a></p>\n\n<pre><code>func (lrw *loggingResponseWriter) Write(b []byte) (int, error) {\n    n,err := lrw.ResponseWriter.Write(b)\n    lrw.written  = lrw.written + n\n    return n,err\n}\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 52834620, "answer_count": 1, "score": 3, "last_activity_date": 1539689857, "creation_date": 1539679674, "question_id": 52831471, "link": "https://stackoverflow.com/questions/52831471/record-response-bodies-for-logging-purposes", "title": "Record response bodies for logging purposes", "body": "<p>Please see <a href=\"https://play.golang.org/p/GMBYEC2-BEU\" rel=\"nofollow noreferrer\">this playground</a>. I'm trying to provide access logging to our logging platform, but I'm kind of stuck now. I have managed to get the status code of the response, but now I'm also interested in the response content-length. But unfortunately I really don't have a clue of how to get/extract the content length by using the wrapped-handler mechanism. Any help is highly appreciated.</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 159, "user_id": 2980253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92537c305ef6d8e28e63589940a93fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2980253/rahul"}, "is_accepted": true, "score": 0, "last_activity_date": 1539682860, "creation_date": 1539682860, "answer_id": 52832468, "question_id": 52830410, "link": "https://stackoverflow.com/questions/52830410/create-associations-issue-in-inserting-in-associated-table/52832468#52832468", "title": "Create associations issue in inserting in associated table", "body": "<p>Found the bug myself. Group has an has-many association with GroupOrder and not many to many. Removed that and it worked clean.</p>\n\n<p>Hope it helps someone :) </p>\n"}], "owner": {"reputation": 159, "user_id": 2980253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92537c305ef6d8e28e63589940a93fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2980253/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 52832468, "answer_count": 1, "score": 2, "last_activity_date": 1539697603, "creation_date": 1539676080, "last_edit_date": 1539697603, "question_id": 52830410, "link": "https://stackoverflow.com/questions/52830410/create-associations-issue-in-inserting-in-associated-table", "title": "Create associations issue in inserting in associated table", "body": "<pre><code>type Group struct {\n        gorm.Model\n        CreatedBy       uint64\n        GroupOrders []GroupOrder gorm:\"many2many:group_orders;association_jointable_foreignkey:group_id;jointable_foreignkey:group_id;\"\n    }\n\n    type GroupOrder struct {\n        gorm.Model\n        GroupID uint64\n        OrderID     uint64\n        UserID      uint64\n        Group       Group\n\n}\n</code></pre>\n\n<p>I am trying to insert a record like this</p>\n\n<pre><code>newGroup: = &amp;Group{\n            CreatedBy: newGroupDetails.UserID,\n            GroupOrders: []GroupOrder{\n                {\n                    OrderID:     newGroupDetails.OrderID,\n                    UserID:      newGroupDetails.UserID,\n                },\n            },\n        }\n</code></pre>\n\n<p>I am creating a record by using this.</p>\n\n<pre><code>db.Create(newGroup)\n</code></pre>\n\n<p>It creates a record correctly in Group model but while inserting in GroupOrder model, it is inserting NULL value in group_id column.</p>\n\n<p>After that, it fires a query </p>\n\n<pre><code>INSERT INTO group_orders (group_id) SELECT ? FROM DUAL WHERE NOT EXISTS (SELECT * FROM group_orders WHERE group_id = ?)[30 30] 1  pkg=mysql\n</code></pre>\n\n<p>And then insert another record in GroupOrder Model with all empty fields but adding the group id field as the previously inserted group_order_id value. </p>\n\n<p>The resultant data in mysql</p>\n\n<p>GroupOrder </p>\n\n<pre><code>    | id | group_id | order_id | user_id |\n    +----+---------------+----------+---------+\n    | 30 |             0 |  8764822 |  678972 |\n    | 31 |            30 |     NULL |    NULL |\n</code></pre>\n\n<p>Group</p>\n\n<pre><code>    | id | created_by |\n    +----+------------+\n    | 18 |     678972 |\n</code></pre>\n\n<p>At least, it should be inserting 18 in place of 30 in the last row group_id column in GroupOrder table.</p>\n\n<p>Why is this happening? Can someone explain if there's a bug.</p>\n\n<p>PS: For brevity, removed a few other columns from both Models. </p>\n"}, {"tags": ["qt", "go", "opengl", "opengl-es", "opengl-es-2.0"], "owner": {"reputation": 2576, "user_id": 631612, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b7d2a769fa193f9efa36668148deb9f5?s=128&d=identicon&r=PG", "display_name": "quanta", "link": "https://stackoverflow.com/users/631612/quanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1539678141, "creation_date": 1539675816, "last_edit_date": 1539678141, "question_id": 52830331, "link": "https://stackoverflow.com/questions/52830331/is-it-possible-to-force-qt-to-use-angle-when-cross-compiling-from-linux-to-windo", "title": "Is it possible to force Qt to use ANGLE when cross compiling from Linux to Windows?", "body": "<p><a href=\"http://doc.qt.io/qt-5/windows-requirements.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/windows-requirements.html</a></p>\n\n<blockquote>\n  <p>For Qt Quick 2 to work, a graphics driver that provides OpenGL 2.1 or\n  higher is required. The default driver from Windows is OpenGL 1.1.</p>\n</blockquote>\n\n<pre><code>qt.scenegraph.general: Using sg animation driver\nqt.scenegraph.general: Animation Driver: using vsync: 15.63 ms\nqt.scenegraph.general: texture atlas dimensions: 512x1024\nqt.scenegraph.general: R/G/B/A Buffers:    8 8 8 8\nqt.scenegraph.general: Depth Buffer:       32\nqt.scenegraph.general: Stencil Buffer:     8\nqt.scenegraph.general: Samples:            -1\nqt.scenegraph.general: GL_VENDOR:          Microsoft Corporation\nqt.scenegraph.general: GL_RENDERER:        GDI Generic\nqt.scenegraph.general: GL_VERSION:         1.1.0\nqt.scenegraph.general: GL_EXTENSIONS:      GL_WIN_swap_hint GL_EXT_bgra GL_EXT_paletted_texture\nqt.scenegraph.general: Max Texture Size:  1024\nqt.scenegraph.general: Debug context:     false\n</code></pre>\n\n<p>Due to this problem, my app is crashing on Windows.</p>\n\n<p>My co-worker tried to build it on Windows and it works because it fall back to <a href=\"https://chromium.googlesource.com/angle/angle/+/master/README.md\" rel=\"nofollow noreferrer\">ANGLE</a>:</p>\n\n<pre><code>qt.scenegraph.general: windows render loop\nqt.scenegraph.general: Using sg animation driver\nqt.scenegraph.general: Animation Driver: using vsync: 15.63 ms\nqt.scenegraph.general: texture atlas dimensions: 512x1024\nqt.scenegraph.general: R/G/B/A Buffers:    8 8 8 8\nqt.scenegraph.general: Depth Buffer:       24\nqt.scenegraph.general: Stencil Buffer:     8\nqt.scenegraph.general: Samples:            0\nqt.scenegraph.general: GL_VENDOR:          Google Inc.\nqt.scenegraph.general: GL_RENDERER:        ANGLE (Microsoft Basic Render Driver Direct3D11 vs_5_0 ps_5_0)\nqt.scenegraph.general: GL_VERSION:         OpenGL ES 2.0 (ANGLE 2.1.0.8613f4946861)\n</code></pre>\n\n<p>The thing is we are building from Linux using <code>threcipe/qt:windows_64_shared</code> image: <a href=\"https://github.com/therecipe/qt/wiki/Deploying-Linux-to-Windows-64-bit-Shared\" rel=\"nofollow noreferrer\">https://github.com/therecipe/qt/wiki/Deploying-Linux-to-Windows-64-bit-Shared</a></p>\n\n<p>I tried something like this:</p>\n\n<ul>\n<li><code>export QT_OPENGL=angle</code> when building</li>\n<li>copy <code>D3Dcompiler_47.dll</code>, <code>libEGL.dll</code>, <code>libGLESV2.dll</code>, and <code>opengl32sw.dll</code> to the app folder</li>\n</ul>\n\n<p>but the app hangs when starting. There is no logs in console even with <code>QT_DEBUG_CONSOLE=true</code>.</p>\n\n<p>Is it possible to force Qt to use <code>ANGLE</code> when building on Linux? If yes, how?</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 193, "user_id": 6396562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a62231d631b82ca80222351684331eb?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6396562/richard"}, "edited": false, "score": 1, "creation_date": 1539687594, "post_id": 52830314, "comment_id": 92583817, "body": "Those who down vote this question. Please read my question again. I know that there is a function strings.Compare(). The problem is that golang seems don&#39;t allow you to achieve the same goal with only one single comparison. In language like C/C++, you need only one comparison of <b>strings</b> then compare integer yourself, which is more cheap compared with string comparison."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1539695010, "post_id": 52830314, "comment_id": 92588272, "body": "If you had the integer values -1, 0, or 1, <i>you would still have to do two comparisons</i> to find out which of the three statements is true. So it&#39;s not clear what you concern is regarding the built-in comparison operators."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1539697288, "post_id": 52830314, "comment_id": 92589805, "body": "I also don&#39;t see how you can only do &quot;one&quot; comparison in C/C++. I suspect you are either confused, or haven&#39;t explained what you mean well enough for us to understand it. Either way, <code>strings.Compare()</code> is what you want."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 6396562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a62231d631b82ca80222351684331eb?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6396562/richard"}, "edited": false, "score": 1, "creation_date": 1539676202, "post_id": 52830378, "comment_id": 92577257, "body": "If you look at the <a href=\"https://golang.org/src/strings/compare.go?s=490:519#L3\" rel=\"nofollow noreferrer\">source code</a>, you&#39;ll notice that this function is implemented using those 3 operators I mentioned in the question."}], "tags": [], "owner": {"reputation": 272, "user_id": 9730660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VtFxA.png?s=128&g=1", "display_name": "AdMer", "link": "https://stackoverflow.com/users/9730660/admer"}, "is_accepted": false, "score": 3, "last_activity_date": 1539675993, "creation_date": 1539675993, "answer_id": 52830378, "question_id": 52830314, "link": "https://stackoverflow.com/questions/52830314/go-compare-strings/52830378#52830378", "title": "Go compare strings", "body": "<p>What about Compare function ? </p>\n\n<p><a href=\"https://golang.org/pkg/strings/#Compare\" rel=\"nofollow noreferrer\">Golang Doc</a></p>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 6396562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a62231d631b82ca80222351684331eb?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6396562/richard"}, "edited": false, "score": 1, "creation_date": 1539687269, "post_id": 52831144, "comment_id": 92583613, "body": "If you use comparison function in C or C++, you just have to compare these two strings once, then compare to integers. In the case of golang, you have to compare them twice (use strings.Compare() or not). So in theory, the running time of golang will be as twice as long as the case of C/C++."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 193, "user_id": 6396562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a62231d631b82ca80222351684331eb?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6396562/richard"}, "edited": false, "score": 0, "creation_date": 1539687821, "post_id": 52831144, "comment_id": 92583945, "body": "@Richard That statement is unjustified. <code>strings.Compare()</code> first checks for equality, which if the length of 2 strings are different can be decided immediately because <code>string</code> also stores the length (unlike strings in C/C++)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 193, "user_id": 6396562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a62231d631b82ca80222351684331eb?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6396562/richard"}, "edited": false, "score": 0, "creation_date": 1539687910, "post_id": 52831144, "comment_id": 92583993, "body": "@Richard And also as mentioned in the answer, sorting strings does not require the <code>-1</code>, <code>0</code>, <code>1</code> result of <code>strings.Compare()</code>, the sorting algorithm only requires the result of <code>a &lt; b</code>. So while other languages may sort based on <code>Compare()</code>, Go&#39;s sorting library sorts only based on <code>a &lt; b</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 10, "last_activity_date": 1539721300, "last_edit_date": 1592644375, "creation_date": 1539678603, "answer_id": 52831144, "question_id": 52830314, "link": "https://stackoverflow.com/questions/52830314/go-compare-strings/52831144#52831144", "title": "Go compare strings", "body": "<p>Even though this comparator function exists in the <a href=\"https://golang.org/pkg/strings/\" rel=\"noreferrer\"><code>strings</code></a> package (<a href=\"https://golang.org/pkg/strings/#Compare\" rel=\"noreferrer\"><code>strings.Compare()</code></a>), even its doc advises against using it:</p>\n<blockquote>\n<p>Compare returns an integer comparing two strings lexicographically. The result will be 0 if a==b, -1 if a &lt; b, and +1 if a &gt; b.</p>\n<p>Compare is included only for symmetry with package bytes. It is usually clearer and always faster to use the built-in string comparison operators ==, &lt;, &gt;, and so on.</p>\n</blockquote>\n<h2>Why is it not practical to use <code>strings.Compare()</code>?</h2>\n<p>There are several reasons.</p>\n<p>First, in languages where this kind of <code>Compare()</code> is practical / common, usually those languages support sorting that builds exactly on a function with this signature.</p>\n<p>For example in Java there is the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html\" rel=\"noreferrer\"><code>Comparator</code></a> interface which you may pass to <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html\" rel=\"noreferrer\"><code>Collections.sort()</code></a>. So in Java you are forced to have / implement this kind of comparison (that returns <code>-1</code>, <code>0</code> or <code>1</code>).</p>\n<p>In Go, sorting is not based on such comparator function. In Go sorting is based on a single <code>Less(i, j int) bool</code> function which is basically <code>a[i] &lt; a[j]</code> comparison, it's just &quot;is it less?&quot;. For that, you don't need <code>strings.Compare()</code>, you only need <code>a &lt; b</code>. For example, see <a href=\"https://golang.org/pkg/sort/#Slice\" rel=\"noreferrer\"><code>sort.Slice()</code></a>.</p>\n<p>Second reason: <code>strings.Compare()</code> is not optimized <em>intentionally</em> so you don't accustomed using it. The implementation of <code>strings.Compare()</code> has this comment:</p>\n<pre><code>// NOTE(rsc): This function does NOT call the runtime cmpstring function,\n// because we do not want to provide any performance justification for\n// using strings.Compare. Basically no one should use strings.Compare.\n// As the comment above says, it is here only for symmetry with package bytes.\n// If performance is important, the compiler should be changed to recognize\n// the pattern so that all code doing three-way comparisons, not just code\n// using strings.Compare, can benefit.\n</code></pre>\n<p>What this means is that <code>a &lt; b</code> will be faster than calling <code>strings.Compare(a, b)</code>.</p>\n<p>Third, the return value of <code>strings.Compare()</code> is a single integer carrying the information whether <code>a</code> is less than <code>b</code>, or whether <code>a</code> is equal to <code>b</code> or whether <code>a</code> is greater than <code>b</code>. If you do need to use all 3 branches (not just the &quot;less&quot; or &quot;equal&quot; branch), you usually need to do further inspection on the return value of <code>strings.Compare()</code>, like in this simple example:</p>\n<pre><code>switch strings.Compare(&quot;a&quot;, &quot;b&quot;) {\ncase -1:\n    fmt.Println(&quot;less&quot;)\ncase 0:\n    fmt.Println(&quot;equal&quot;)\ncase 1: // or default:\n    fmt.Println(&quot;greater&quot;)\n}\n</code></pre>\n<p>Now if you think about it: comparisons are first performed inside <code>strings.Compare()</code>, and then again in your code (comparing the return value). This is redundant, and again less performant.</p>\n<p>The above can be written like this (which will be faster):</p>\n<pre><code>switch {\ncase a == b:\n    fmt.Println(&quot;equal&quot;)\ncase a &lt; b:\n    fmt.Println(&quot;less&quot;)\ndefault:\n    fmt.Println(&quot;greater&quot;)\n}\n</code></pre>\n<h2>More about efficiency</h2>\n<p>As said before, <code>strings.Compare()</code> is not optimized for performance deliberately. But Go's sorting library does not need the <code>-1</code>, <code>0</code>, <code>1</code> result for sorting strings, only the result of <code>a &lt; b</code>, which can be acquired with the same efficiency as acquiring the result of <code>Compare()</code> in other languages.</p>\n<p>Also note that <code>strings.Compare()</code> first checks for equality <code>a == b</code>, and only if they are not equal proceeds to check <code>a &lt; b</code>. This is important because <code>string</code> values in Go store the length of the <code>string</code> (for details, see <a href=\"https://golang.org/pkg/reflect/#StringHeader\" rel=\"noreferrer\"><code>reflect.StringHeader</code></a>), which means if 2 strings have different lengths, it can be decided immediately that they are not equal. C and C++ use <code>\\0</code>-terminated string values, which means to tell if 2 strings are equal always requires to compare the whole strings, even if one is a thousand characters and the other is one less. Actually this is not completely true, because if a mismatch is detected when comparing the characters, the comparison ends, but this may still be a lot slower than comparing 2 integers.</p>\n<p>Also see related question: <a href=\"https://stackoverflow.com/questions/50792777/using-the-symbol-in-golang-and-using-a-loop-to-compare-if-string-a-equals-str/50793043#50793043\">Using the == symbol in golang and using a loop to compare if string a equals string b,which performance is better?</a></p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1539708972, "last_edit_date": 1539708972, "creation_date": 1539708210, "answer_id": 52840293, "question_id": 52830314, "link": "https://stackoverflow.com/questions/52830314/go-compare-strings/52840293#52840293", "title": "Go compare strings", "body": "<p>Go was designed by programmers for programmers. If you want a C <code>strcmp</code> function, write one in Go.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc strcmp(s1, s2 string) int {\n    lens := len(s1)\n    if lens &gt; len(s2) {\n        lens = len(s2)\n    }\n    for i := 0; i &lt; lens; i++ {\n        if s1[i] != s2[i] {\n            return int(s1[i]) - int(s2[i])\n        }\n    }\n    return len(s1) - len(s2)\n}\n\nfunc main() {\n    tests := []struct {\n        s1, s2 string\n        cmp    int\n    }{\n        {\"\", \"\", 0},\n        {\"a\", \"a\", 0},\n        {\"a\", \"b\", -1},\n        {\"b\", \"a\", +1},\n        {\"a\", \"aa\", -1},\n        {\"aa\", \"a\", 1},\n    }\n    for _, t := range tests {\n        cmp := strcmp(t.s1, t.s2)\n        fmt.Printf(\"%q %q %d %t\\n\", t.s1, t.s2, cmp, cmp == t.cmp)\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/EAzV5_ouDI2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/EAzV5_ouDI2</a></p>\n\n<p>Output:</p>\n\n<pre><code>\"\" \"\" 0 true\n\"a\" \"a\" 0 true\n\"a\" \"b\" -1 true\n\"b\" \"a\" 1 true\n\"a\" \"aa\" -1 true\n\"aa\" \"a\" 1 true\n</code></pre>\n\n<hr>\n\n<p>GNU C Library (glibc): <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=string/strcmp.c;\" rel=\"nofollow noreferrer\"><code>strcmp.c</code></a></p>\n"}], "owner": {"reputation": 193, "user_id": 6396562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a62231d631b82ca80222351684331eb?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6396562/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9009, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1546428556, "creation_date": 1539675763, "last_edit_date": 1546428556, "question_id": 52830314, "link": "https://stackoverflow.com/questions/52830314/go-compare-strings", "title": "Go compare strings", "body": "<p>Given two strings <code>a</code> and <code>b</code>, sometimes I want to determine which one of the three statements: <code>a &lt; b</code>, <code>a == b</code> or <code>a &gt; b</code> is true.</p>\n\n<p>In a language like C or C++, I will get an int value <code>v</code> after one invoking of the corresponding function or method. Then I can determine which of the above statements is true by examining whether <code>v &lt; 0</code>, <code>v == 0</code> or <code>v &gt; 0</code>.</p>\n\n<p>But in Go I have to do at least two comparisons (e.g. first test <code>a &lt; b</code> then test <code>a == b</code>) to find out which one of the three statements is true.</p>\n\n<p>My question is that is there a way in Go so that I can just do a single comparison?</p>\n\n<p>It turns out that this feature is called <a href=\"https://en.wikipedia.org/wiki/Three-way_comparison\" rel=\"nofollow noreferrer\">three way comparison</a>.</p>\n"}, {"tags": ["go", "compiler-errors", "compilation", "package"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1539675508, "post_id": 52830226, "comment_id": 92576867, "body": "A package is compiled as a single unit, regardless of how many source files are used. This shouldn&#39;t really be that mysterious."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1539675570, "post_id": 52830226, "comment_id": 92576896, "body": "Further, your assertion that &quot;The order cannot be calculated if there is a cycle&quot; is simply wrong. It&#39;s trivial to calculate such things--many languages do this. Go prohibits this, though, as a matter of policy, not because it&#39;s impossible."}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1539675739, "post_id": 52830226, "comment_id": 92576993, "body": "@Flimzy Your comments are worth a real response."}], "answers": [{"comments": [{"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1539676330, "post_id": 52830387, "comment_id": 92577328, "body": "You haven\u2019t really answered my question. The Go compiler cannot simply concatenate the two source files and compile them as one big unit because there is a cyclic dependency. The compiler cannot put one file in front of the other."}, {"owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "edited": false, "score": 0, "creation_date": 1539676652, "post_id": 52830387, "comment_id": 92577535, "body": "Despite this, the compiler is still able to figure it out. That is my question"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1539676011, "creation_date": 1539676011, "answer_id": 52830387, "question_id": 52830226, "link": "https://stackoverflow.com/questions/52830226/cyclic-dependencies-between-sources-of-a-package/52830387#52830387", "title": "Cyclic dependencies between sources of a package", "body": "<p>A package is compiled as a single unit, regardless of how many source files are used. This shouldn't really be that mysterious.</p>\n\n<p>Further, your assertion that \"The order cannot be calculated if there is a cycle\" is simply wrong. It's trivial to calculate such things--many languages do this. Go prohibits this, though, as a matter of policy, because it leads to tight coupling of code, and code that is difficult to understand, not because it's impossible.</p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1539677610, "creation_date": 1539677610, "answer_id": 52830844, "question_id": 52830226, "link": "https://stackoverflow.com/questions/52830226/cyclic-dependencies-between-sources-of-a-package/52830844#52830844", "title": "Cyclic dependencies between sources of a package", "body": "<blockquote>\n  <p>[...] how the Go compiler is able to resolve dependencies between sources of a package but not able to resolve dependencies between packages. If the two sources depend on each other then you have to do some crazy acrobatics and compile them both at the same time somehow. </p>\n</blockquote>\n\n<p>The question is based on <em>wrong</em> assumptions on how Go code is structured and compiled: A source file <strong>does</strong> <strong>not</strong> have a dependency by definition.  A package has dependencies (all imports from all its source files). Dependencies are packages (not source files). To compile a package all dependencies have to be available <em>before</em> compilation starts.</p>\n\n<p>You really must stop thinking in terms of source files. Source files have (almost) no meaning in how Go code is compiled. A package's source may consist of one or several source files and this is basically the <em>only</em> point where source files enter compiling Go code. Everything relevant revolves around packages and packages only: You compile packages, you import packages, etc.</p>\n\n<p>(Just for completeness: Build tags work on source level and package initialization can depend on source code organization and by manual invoking gc you can do more than through the go tool.) </p>\n"}], "owner": {"reputation": 4465, "user_id": 4093378, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fQvO8M4nxAQ/AAAAAAAAAAI/AAAAAAAAB-E/YauVVLfKB5U/photo.jpg?sz=128", "display_name": "Indiana Kernick", "link": "https://stackoverflow.com/users/4093378/indiana-kernick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 52830844, "answer_count": 2, "score": -2, "last_activity_date": 1539677610, "creation_date": 1539675424, "question_id": 52830226, "link": "https://stackoverflow.com/questions/52830226/cyclic-dependencies-between-sources-of-a-package", "title": "Cyclic dependencies between sources of a package", "body": "<p>Let's say you have a package <code>mypack</code> with two source files <code>mypack/a.go</code> and <code>mypack/b.go</code>. Both of those source files depend on each another but the Go compiler doesn't complain. If you split that package into two, <code>apack/a.go</code> and <code>bpack/b.go</code>, the Go compiler will say <code>import cycle not allowed</code>.</p>\n\n<p>My understanding of how package dependencies are handled is that the compiler will construct a graph of the imports. The graph is analyzed and somehow (I would love to learn about the algorithm that does this!) the order of compilation calculated. The order cannot be calculated if there is a cycle in the graph so the compiler complains.</p>\n\n<p>What I don't understand is how the Go compiler is able to resolve dependencies between sources of a package but not able to resolve dependencies between packages. If the two sources depend on each other then you have to do some crazy acrobatics and compile them both at the same time somehow.</p>\n\n<p>Could someone clear this up for me?</p>\n"}, {"tags": ["go", "grpc"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1539674194, "post_id": 52829481, "comment_id": 92576212, "body": "That functionality does not exist in the context library. If you have values in your context that need to be transmitted, this must be done manually."}], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 4, "last_activity_date": 1539679602, "last_edit_date": 1539679602, "creation_date": 1539673406, "answer_id": 52829675, "question_id": 52829481, "link": "https://stackoverflow.com/questions/52829481/can-the-content-of-the-context-be-transmitted-in-grpc/52829675#52829675", "title": "Can the content of the context be transmitted in grpc?", "body": "<p><code>context</code> is a general purpose registry for global <strong>request</strong> variables. It is not supposed to escape the request scope. Consider doing this another way.</p>\n"}], "owner": {"reputation": 13, "user_id": 7811568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540b3baeeb9fc1d30ebb220c925e5ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Liam Payne", "link": "https://stackoverflow.com/users/7811568/liam-payne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 52829675, "answer_count": 1, "score": 1, "last_activity_date": 1539679602, "creation_date": 1539672733, "question_id": 52829481, "link": "https://stackoverflow.com/questions/52829481/can-the-content-of-the-context-be-transmitted-in-grpc", "title": "Can the content of the context be transmitted in grpc?", "body": "<p>I have defined a client and server. They all have a ctx(context) as parameter,client and server communicate by grpc.</p>\n\n<pre><code>type Client interface {\n    GetFileVersion(ctx context.Context, in *Req) (*Resp, error)\n}\n\ntype client struct {\n    cc *grpc.ClientConn\n}\n\nfunc (c *client) GetFileVersion(ctx context.Context, in *Req) (*Resp, error) {\n    out := new(Resp)\n    err := grpc.Invoke(ctx, \"/testpb/GetFileVersion\", in, out, c.cc, opts...)\n    if err != nil {\n        return nil, err\n    }\n    return out, nil\n}\n\n\n\ntype Server interface {\n    GetFileVersion(context.Context, *Req) (*Resp, error)\n}\n</code></pre>\n\n<p>If I set value in ctx in the implement of GetFileVersion in client,can I get this value in server?</p>\n\n<pre><code>ctx = context.WithValue(parent, \"test\", 123)\n</code></pre>\n"}, {"tags": ["go", "type-conversion"], "comments": [{"owner": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "edited": false, "score": 1, "creation_date": 1539670246, "post_id": 52828836, "comment_id": 92574323, "body": "for downvoter, care to explain?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1539670250, "post_id": 52828836, "comment_id": 92574325, "body": "You simply <b>cannot</b>. This is not how Go works. Please take the Tour of Go. Stop using interface{} here. Your limit is a string in the example so convert it with Atoi. You <i>must</i> get the type right and this is done by understanding Go&#39;s type system. Learn that now. And please read and understand the error messages: They describe <i>exactly</i> what you did wrong."}], "answers": [{"tags": [], "owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "is_accepted": false, "score": 1, "last_activity_date": 1539834800, "last_edit_date": 1539834800, "creation_date": 1539676748, "answer_id": 52830590, "question_id": 52828836, "link": "https://stackoverflow.com/questions/52828836/interface-variable-conversion-in-golang/52830590#52830590", "title": "Interface variable conversion in Golang", "body": "<p>In Go, in contrast to languages such as Python/JavaScript/Perl, the variables have strict types and strong boundaries. You have to write explicit code to make the conversion of a string from/to an integer. This is helpful to write safer and more performant programs.</p>\n\n<p>In addition, if the variable is stored in an <code>interface{}</code> you have to use a type assertion (or a type switch) to further use the content with a specific type.</p>\n\n<p>Here is your <a href=\"https://play.golang.org/p/yUYQrKyOIQq\" rel=\"nofollow noreferrer\">fixed code</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"log\"\nimport \"strconv\"\n\nfunc main() {\n    var limit interface{}\n    limit = \"50\"\n    page := 1\n    offset := 3\n    if limit != \"ALL\" {\n        // Type assertion\n        s, isString := limit.(string)\n        if !isString {\n            log.Fatalf(\"limit is not a string but %T\", limit)\n        }\n        // Conversion from string to int, with error handling\n        l, err := strconv.Atoi(s)\n        if err != nil {\n            log.Fatalf(\"%s: %v\", limit, err)\n        }\n        offset = l*page - l\n    }\n    fmt.Println(offset)\n}\n</code></pre>\n\n<p>However, I suggest that you just use the <code>string</code> type for the limit variable.</p>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 1, "creation_date": 1599959139, "post_id": 52831198, "comment_id": 112936707, "body": "Good example +1. It might be slightly clearer to write <a href=\"https://play.golang.org/p/ckgotHV6pXh\" rel=\"nofollow noreferrer\">play.golang.org/p/ckgotHV6pXh</a>."}], "tags": [], "owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "is_accepted": false, "score": 1, "last_activity_date": 1539678817, "creation_date": 1539678817, "answer_id": 52831198, "question_id": 52828836, "link": "https://stackoverflow.com/questions/52828836/interface-variable-conversion-in-golang/52831198#52831198", "title": "Interface variable conversion in Golang", "body": "<h2>strconv package can use for this kind of conversion</h2>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    var lim interface{}\n    lim = \"10\"\n    fmt.Printf(\"Type is: %T\\nValue is: %s \\n\", lim, lim.(string))\n    i, _ := strconv.Atoi(lim.(string))\n    fmt.Printf(\"After conversion value is: %d\", i)\n}\n</code></pre>\n\n<p>Output of the above code: </p>\n\n<blockquote>\n  <p>Type is: string, Value is: 10\n  After conversion value is: 10</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 382, "user_id": 1520331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fdb8518473ec145645e5925e7f08598?s=128&d=identicon&r=PG", "display_name": "Alex Medveshchek", "link": "https://stackoverflow.com/users/1520331/alex-medveshchek"}, "is_accepted": false, "score": 0, "last_activity_date": 1539705112, "creation_date": 1539705112, "answer_id": 52839438, "question_id": 52828836, "link": "https://stackoverflow.com/questions/52828836/interface-variable-conversion-in-golang/52839438#52839438", "title": "Interface variable conversion in Golang", "body": "<p>As I understood your question, value of your <code>limit</code> in fact is always string, but in one case it's value == <code>ALL</code>, otherwise it's a string representation of an integer value.</p>\n\n<p>If I'm right, then I would provide following solution:</p>\n\n<pre><code>import (\n    \"errors\"\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc getOffset(limit string, page int64) (int64, error) {\n    lim, err := strconv.ParseInt(limit, 10, 64)\n    if err != nil {\n        if limit == \"ALL\" {\n            return 0, nil\n        }\n\n        return 0, errors.New(fmt.Sprintf(\"string '%v' doesn't fit requirements, error: %v\", limit, err))\n    }\n\n    offset := lim*page - lim\n    return offset, nil\n}\n</code></pre>\n\n<p>Full solution on playground: <a href=\"https://play.golang.org/p/fJv9_cw18R5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/fJv9_cw18R5</a></p>\n"}], "owner": {"reputation": 233, "user_id": 7893198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91639ade70c5fc21ded9450808e3c97c?s=128&d=identicon&r=PG&f=1", "display_name": "blue panther", "link": "https://stackoverflow.com/users/7893198/blue-panther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1650, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1539834800, "creation_date": 1539669816, "last_edit_date": 1539677067, "question_id": 52828836, "link": "https://stackoverflow.com/questions/52828836/interface-variable-conversion-in-golang", "title": "Interface variable conversion in Golang", "body": "<p>I have a variable which value can be string or int depend on the input. I use <code>interface{}</code> as the type. How to convert the value of that variable to <code>int</code> if the input is like <code>\"50\"</code>, <code>\"45\"</code>, or any string of int.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"log\"\nimport \"strconv\"\n\nfunc main() {\n  var limit interface{}\n  limit = \"50\"\n  page := 1\n  offset := 0\n  if limit != \"ALL\" {\n        log.Println(\"INSIDE\")\n        offset = limit.(int)*page - limit.(int)\n    }\n    fmt.Println(offset)\n}\n</code></pre>\n\n<p>Above code got: </p>\n\n<pre><code>interface conversion: interface {} is string, not int\n</code></pre>\n\n<p>If I use this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"log\"\nimport \"strconv\"\n\nfunc main() {\n  var limit interface{}\n  limit = \"50\"\n  page := 1\n  offset := 0\n  if limit != \"ALL\" {\n        log.Println(\"INSIDE\")\n        offset = strconv.Atoi(limit)*page - strconv.Atoi(limit)\n    }\n  fmt.Println(offset)\n}\n</code></pre>\n\n<p>I got this</p>\n\n<pre><code>exit status 2\n command-line-arguments\n./main.go:14:24: cannot use limit (type interface {}) as type string in argument to strconv.Atoi: need type assertion\n./main.go:14:24: multiple-value strconv.Atoi() in single-value context\n./main.go:14:51: cannot use limit (type interface {}) as type string in argument to strconv.Atoi: need type assertion\n./main.go:14:51: multiple-value strconv.Atoi() in single-value context\n</code></pre>\n\n<p>How to convert value of that variable to int?</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1539676441, "post_id": 52828413, "comment_id": 92577410, "body": "Please ensure that your program listing shown above is <i>exactly</i> what you are running and give <i>exactly</i> all logged output"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9354171"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1539678271, "post_id": 52828413, "comment_id": 92578438, "body": "It is the same, I had two version, one with tmp folder and one without, I have removed the tmp so it will be less confusing. The issue is code runs fine on aws instance but does not run as lambda"}, {"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 0, "creation_date": 1539869431, "post_id": 52828413, "comment_id": 92663846, "body": "I notice you&#39;re not checking the error returned from <code>os.MkdirAll</code> in <code>createFolder</code>. - this may be failing and therefore not creating the download location. Additionally the error message you&#39;ve supplied doesn&#39;t match any you&#39;re printing in your code- you format all your errors differently, so where is that coming from?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9354171"}, "edited": false, "score": 0, "creation_date": 1539669642, "post_id": 52828636, "comment_id": 92574081, "body": "The code runs fine if I run on local server on aws not as lambda"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9354171"}, "edited": false, "score": 0, "creation_date": 1539669679, "post_id": 52828636, "comment_id": 92574091, "body": "I try both local path and tmp, both cases it fails on lambda runs fine on aws server"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 0, "last_activity_date": 1539668674, "creation_date": 1539668674, "answer_id": 52828636, "question_id": 52828413, "link": "https://stackoverflow.com/questions/52828413/open-no-such-file-or-directory/52828636#52828636", "title": "open no such file or directory", "body": "<p>ok so this code runs first</p>\n\n<pre><code>folder_name := \"images/users/original/\"\nfolder_name_220x220 := \"images/users/220x220/\"\nfolder_name_250x250 := \"images/users/250x250/\"\nfolder_name_500x500 := \"images/users/500x500/\"\nfolder_name_large   := \"images/users/large/\"\n\ncreateFolder(folder_name)\n</code></pre>\n\n<p>making a folder in wherever the program is at the moment</p>\n\n<p>Then it does this</p>\n\n<pre><code> item := \"/tmp\"/folder_name + item_name\n\n    fmt.Printf(\"Creating file %q \\n\", item)\n\n\n    file, err :=  os.OpenFile(item, os.O_RDWR|os.O_CREATE, 0666)\n    if err != nil {\n        exitErrorf(\"Unable to open file %q\", err)\n    }\n</code></pre>\n\n<p>when you run it locally it will make the folder in whatever directory you are in</p>\n\n<p>presumably at some point you have made those folders in /tmp too</p>\n\n<p>In the lambda the same thing happens but the lambda function must be running somewhere else that isn't in the /tmp directory</p>\n\n<p>So part of the path isn't found and the program fails</p>\n\n<p>To fix it make </p>\n\n<pre><code>folder_name := \"images/users/original/\"\n</code></pre>\n\n<p>become</p>\n\n<pre><code>folder_name := \"/tmp/images/users/original/\"\n</code></pre>\n\n<p>and remove the \"/tmp\" + line</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9354171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1916, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539676338, "creation_date": 1539667340, "last_edit_date": 1539676338, "question_id": 52828413, "link": "https://stackoverflow.com/questions/52828413/open-no-such-file-or-directory", "title": "open no such file or directory", "body": "<p>I am trying to follow AWS lambda go and s3 examples to create a function which will download the file from s3 resize it and upload back to s3. </p>\n\n<p>When I build the function and run it on local machine, everything works fine, when I run it as lambda I get \"\"open /tmp/images/users/original/5bba5c0f01e2f_dcadcc7139454bf6dba4cbd01a7c92f8.jpeg: no such file or directory\"</p>\n\n<p>Here is my code</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/s3\"\n    \"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n    \"github.com/aws/aws-lambda-go/lambda\"\n    \"github.com/nfnt/resize\"\n    \"image/jpeg\"\n\n    \"fmt\"\n    \"os\"\n)\n\n\nfunc HandleRequest() (string, error) {\n     return runResize(\"5bba5c0f01e2f_dcadcc7139454bf6dba4cbd01a7c92f8.jpeg\"), nil\n}\n\nfunc main() {\n        lambda.Start(HandleRequest)\n}\n\nfunc runResize(item_name string) {\n    bucket := \"bucket\"\n    folder_name := \"images/users/original/\"\n    folder_name_220x220 := \"images/users/220x220/\"\n    folder_name_250x250 := \"images/users/250x250/\"\n    folder_name_500x500 := \"images/users/500x500/\"\n    folder_name_large := \"images/users/large/\"\n\n    createFolder(folder_name)\n    createFolder(folder_name_220x220)\n    createFolder(folder_name_250x250)\n    createFolder(folder_name_500x500)\n    createFolder(folder_name_large)\n\n    item := folder_name + item_name\n\n    fmt.Printf(\"Creating file %q \\n\", item)\n\n\n    file, err :=  os.Create(item)\n    if err != nil {\n        exitErrorf(\"Unable to open file %q\", err)\n    }\n\n    defer file.Close()\n\n    sess, _ := session.NewSession(&amp;aws.Config{\n        Region: aws.String(\"us-east-1\")},\n    )\n\n    downloader := s3manager.NewDownloader(sess)\n\n    numBytes, err := downloader.Download(file,\n        &amp;s3.GetObjectInput{\n            Bucket: aws.String(bucket),\n            Key:    aws.String(item),\n        })\n    if err != nil {\n        exitErrorf(\"Unable to download item %q, %v\", item, err)\n    }\n\n\n    if err != nil {\n        exitErrorf(\"Unable to download item %q, %v\", item, err)\n    }\n\n    // decode jpeg into image.Image\n    img, err := jpeg.Decode(file)\n    if err != nil {\n        exitErrorf(\"Unable to download item %q, %v\", item, err)\n    }\n    file.Close()\n\n\n    m := resize.Thumbnail(1500, 1500, img, resize.Lanczos3)\n    out, err := os.OpenFile(folder_name_large + item_name, os.O_RDWR|os.O_CREATE, 0666)\n    if err != nil {\n        exitErrorf(\"Unable to resize item %q, %v\", item, err)\n    }\n    defer out.Close()\n    jpeg.Encode(out, m, nil)\n\n\n    m = resize.Thumbnail(500, 500, img, resize.Lanczos3)\n    out, err = os.OpenFile(folder_name_500x500 + item_name, os.O_RDWR|os.O_CREATE, 0666)\n    if err != nil {\n        exitErrorf(\"Unable to resize item %q, %v\", item, err)\n    }\n    defer out.Close()\n    jpeg.Encode(out, m, nil)\n\n    m = resize.Thumbnail(250, 250, img, resize.Lanczos3)\n    out, err = os.OpenFile(folder_name_250x250 + item_name, os.O_RDWR|os.O_CREATE, 0666)\n    if err != nil {\n        exitErrorf(\"Unable to resize item %q, %v\", item, err)\n    }\n    defer out.Close()\n    jpeg.Encode(out, m, nil)\n\n    m = resize.Thumbnail(220, 220, img, resize.Lanczos3)\n    out, err =  os.OpenFile(folder_name_220x220 + item_name, os.O_RDWR|os.O_CREATE, 0666)\n    if err != nil {\n        exitErrorf(\"Unable to resize item %q, %v\", item, err)\n    }\n    defer out.Close()\n    jpeg.Encode(out, m, nil)\n\n    uploadFile(folder_name_220x220 + item_name, bucket)\n    uploadFile(folder_name_250x250 + item_name, bucket)\n    uploadFile(folder_name_500x500 + item_name, bucket)\n    uploadFile(folder_name_large + item_name, bucket)\n\n\n    fmt.Println(\"Processed\", file.Name(), numBytes, \"bytes\")\n}\n\nfunc createFolder(folder_name string) {\n    if _, err := os.Stat(folder_name); os.IsNotExist(err) {\n        os.MkdirAll(folder_name, os.ModePerm)\n        fmt.Printf(\"Folder created %q \\n\", folder_name)\n    }\n}\n\nfunc uploadFile(filename string, bucket string){\n    file, err := os.Open(filename)\n    if err != nil {\n        exitErrorf(\"Unable to open file %q, %v\", err)\n    }\n\n    defer file.Close()\n    sess, err := session.NewSession(&amp;aws.Config{\n        Region: aws.String(\"us-east-1\")},\n    )\n\n    uploader := s3manager.NewUploader(sess)\n    _, err = uploader.Upload(&amp;s3manager.UploadInput{\n        Bucket: aws.String(bucket),\n        Key: aws.String(filename),\n        Body: file,\n        ACL:  aws.String(\"public-read\"),\n    })\n    if err != nil {\n        // Print the error and exit.\n        exitErrorf(\"Unable to upload %q to %q, %v\", filename, bucket, err)\n    }\n\nfmt.Printf(\"Successfully uploaded %q to %q\\n\", filename, bucket)\n}\n\n\nfunc exitErrorf(msg string, args ...interface{}) {\n    fmt.Fprintf(os.Stderr, msg+\"\\n\", args...)\n    os.Exit(1)\n}\n</code></pre>\n\n<p>Here is how I build </p>\n\n<pre><code>GOOS=linux go build -v -ldflags '-d -s -w' -a -tags netgo -installsuffix netgo -o resize &amp;&amp; zip deployment.zip resize\n</code></pre>\n\n<p>When I run locally, it all works fine, but when running on lambda get, I get the error </p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "edited": false, "score": 0, "creation_date": 1539690532, "post_id": 52829476, "comment_id": 92585504, "body": "thank you for your answers, is that means, if request page 3, I still need to get the documents from page 1, 2 and use the second cursor to retrieve page 3 documents?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "edited": false, "score": 0, "creation_date": 1539690907, "post_id": 52829476, "comment_id": 92585739, "body": "@sophiageng If you need page 3, you should already have a cursor returned by minquery when you requested page 2, so you should just set that, and you will get documents right of page 3. If you don&#39;t have any cursors and you still need page 3, then run a single query that contains the documents of the first 3 pages, discard documents of the first 2 pages and use the third."}, {"owner": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "edited": false, "score": 0, "creation_date": 1539691177, "post_id": 52829476, "comment_id": 92585886, "body": "yes, I need to get previous cursor by query method, thank you all."}, {"owner": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "edited": false, "score": 0, "creation_date": 1539691934, "post_id": 52829476, "comment_id": 92586377, "body": "and another question, the cursorfield, because I have access customer query condition to query paged document, how to create index in MongoDB, should I create all the scenarios index?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "edited": false, "score": 0, "creation_date": 1539693861, "post_id": 52829476, "comment_id": 92587565, "body": "@sophiageng See <a href=\"https://docs.mongodb.com/manual/core/index-intersection/\" rel=\"nofollow noreferrer\">Index Intersection</a> and <a href=\"https://docs.mongodb.com/manual/tutorial/create-indexes-to-support-queries/\" rel=\"nofollow noreferrer\">Create Indexes to Support Your Queries</a>."}, {"owner": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "edited": false, "score": 0, "creation_date": 1539736318, "post_id": 52829476, "comment_id": 92607416, "body": "I mean the cursorfield must totally consistent  with the index created in MongoDB?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "edited": false, "score": 1, "creation_date": 1539759412, "post_id": 52829476, "comment_id": 92613567, "body": "@sophiageng Yes, they must match."}, {"owner": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "edited": false, "score": 0, "creation_date": 1539767857, "post_id": 52829476, "comment_id": 92618138, "body": "got it. Thanks."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1539691023, "last_edit_date": 1539691023, "creation_date": 1539672697, "answer_id": 52829476, "question_id": 52827366, "link": "https://stackoverflow.com/questions/52827366/using-github-com-icza-minquery-to-directly-query-page-3-value/52829476#52829476", "title": "Using github.com/icza/minquery to directly query page 3 value", "body": "<p>You can't skip documents directly using <a href=\"https://github.com/icza/minquery\" rel=\"nofollow noreferrer\"><code>github.com/icza/minquery</code></a>. The purpose of <code>minquery</code> is to not have to use <a href=\"https://godoc.org/github.com/globalsign/mgo#Query.Skip\" rel=\"nofollow noreferrer\"><code>Query.Skip()</code></a> (because that becomes less efficient when the number of \"skippable\" documents grows). The only way to skip 3 documents is to query for more than 3, and throw away the first 3.</p>\n\n<p><code>minquery</code> is for cases where you don't have to skip the initial documents. <code>minquery</code> requires you to iterate over the documents, and acquire the cursor that encodes the index entry of the last returned document (this cursor is returned to you by <code>MinQuery.All()</code>). When you need the next page, you have to use the cursor you acquired in the previous query, and then it can list subsequent documents without having to skip anything, because the encoded index entry can be used to jump right where the last query finished listing documents.</p>\n\n<p>Think of GMail: you can always jump just to the <em>next</em> (and previous) page of emails, but you have no way of \"magically\" jumping to the 10th or 100th page: GMail uses the same mechanism under the hood.</p>\n"}], "owner": {"reputation": 49, "user_id": 4782044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8Kl9.png?s=128&g=1", "display_name": "sophiageng", "link": "https://stackoverflow.com/users/4782044/sophiageng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 52829476, "answer_count": 1, "score": 1, "last_activity_date": 1539691023, "creation_date": 1539658880, "last_edit_date": 1539672890, "question_id": 52827366, "link": "https://stackoverflow.com/questions/52827366/using-github-com-icza-minquery-to-directly-query-page-3-value", "title": "Using github.com/icza/minquery to directly query page 3 value", "body": "<p>I wanna confirm the right way to get skip(3) values using minquery, 1. foreach skip, get 1,2,3 page data, then return the 3rd value? or 2. use a way to get the cursor of skip(3). if the 2rd is right, how to get the cursor of skip(3) page? Thanks.</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539658721, "post_id": 52827318, "comment_id": 92571367, "body": "Do you want to get the value of the field, the name of the field or both?"}, {"owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539658841, "post_id": 52827318, "comment_id": 92571401, "body": "@ThunderCat I want to know whether a field has been assigned value. Here field <code>A</code> has been assigned value but <code>B</code> not."}, {"owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539659056, "post_id": 52827318, "comment_id": 92571453, "body": "@ThunderCat     a boolean reporting that some field is assigned"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539660801, "post_id": 52827318, "comment_id": 92571849, "body": "&quot;but field B not&quot;. This statement is <b>wrong</b>! B was assigned the value &quot;&quot;, the zero value for a string. There <i>are</i> <i>no</i> unassigned values in Go."}, {"owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1539666535, "post_id": 52827318, "comment_id": 92573146, "body": "@Volker yeah. Strictly speaking\uff0cI want to get the field which assigned value explicit rather than zero value by default."}], "answers": [{"comments": [{"owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "edited": false, "score": 0, "creation_date": 1539666649, "post_id": 52827432, "comment_id": 92573178, "body": "it worked, but as for some specific type like array, it yield  panic:  runtime error: comparing uncomparable type []*xx ."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1539667235, "last_edit_date": 1539667235, "creation_date": 1539659464, "answer_id": 52827432, "question_id": 52827318, "link": "https://stackoverflow.com/questions/52827318/can-i-get-whether-a-field-has-been-assigned-with-reflection-in-golang/52827432#52827432", "title": "can I get whether a field has been assigned with reflection in golang", "body": "<p>It's not possible to determine if a field was explicitly assigned a value, but it is possible to determine if there's a field that's not equal to the field's zero value.</p>\n\n<p>Loop through the fields. Return true if a field's value is not equal to the zero value for the field's type.</p>\n\n<pre><code>func hasNonZeroField(s interface{}) bool {\n    v := reflect.ValueOf(s)\n    if v.Kind() == reflect.Ptr {\n        v = v.Elem()\n    }\n    t := v.Type()\n    for i := 0; i &lt; t.NumField(); i++ {\n        sf := t.Field(i)\n        fv := v.Field(i)\n        switch sf.Type.Kind() {\n        case reflect.Chan, reflect.Func, reflect.Interface, reflect.Map, reflect.Ptr, reflect.Slice:\n            if !fv.IsNil() {\n                return true\n            }\n        case reflect.Struct:\n            if hasNonZeroField(fv.Interface()) {\n                return true\n            }\n        // case reflect.Array:\n        // TODO: call recursively for array elements\n        default:\n            if reflect.Zero(sf.Type).Interface() != fv.Interface() {\n                return true\n            }\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/cRNBPtuErTO\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}], "owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 52827432, "answer_count": 1, "score": 2, "last_activity_date": 1539667235, "creation_date": 1539658462, "last_edit_date": 1539666317, "question_id": 52827318, "link": "https://stackoverflow.com/questions/52827318/can-i-get-whether-a-field-has-been-assigned-with-reflection-in-golang", "title": "can I get whether a field has been assigned with reflection in golang", "body": "<p>I have a struct as below:</p>\n\n<pre><code>type Demo struct{\n     A string\n     B string\n}\n</code></pre>\n\n<p>and I have a instance of it as below:</p>\n\n<pre><code>demo := Demo{A:\"a\"}\n</code></pre>\n\n<p>the field of <strong>A</strong> has been assigned value explicit but field <strong>B</strong> not.\nNow, I want to know are there exist some method that I can get the field of Instance <strong>A</strong> which has been <strong>assigned</strong> value through <strong>reflection</strong>?</p>\n\n<p>Here I want to get field <strong>A</strong>.</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1539658382, "creation_date": 1539658382, "answer_id": 52827303, "question_id": 52827203, "link": "https://stackoverflow.com/questions/52827203/cannot-convert-expression-of-type-json-rawmessage-to-type-byte-in-golang/52827303#52827303", "title": "Cannot convert expression of type *json.RawMessage to type []byte in golang", "body": "<p>A <code>*json.RawMesasge</code> is not a <code>[]byte</code>.  It's a pointer.</p>\n\n<p>Dereference the pointer to convert to a slice of bytes:</p>\n\n<pre><code> byteSlice := []byte(*pointerToRawMessage)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10510403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c6eabd66c1c60a2d8d70105cce128d?s=128&d=identicon&r=PG&f=1", "display_name": "sijie.long", "link": "https://stackoverflow.com/users/10510403/sijie-long"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 1, "accepted_answer_id": 52827303, "answer_count": 1, "score": 0, "last_activity_date": 1539658382, "creation_date": 1539657611, "question_id": 52827203, "link": "https://stackoverflow.com/questions/52827203/cannot-convert-expression-of-type-json-rawmessage-to-type-byte-in-golang", "title": "Cannot convert expression of type *json.RawMessage to type []byte in golang", "body": "<p><a href=\"https://i.stack.imgur.com/ySCxW.png\" rel=\"nofollow noreferrer\">code and error message</a></p>\n\n<p>I was experiencing this problem when using golang's elasticsearch client \"elastic\".</p>\n\n<p>*json.RawMessage is a type of []byte.If I not write []byte() to cast type, it said cannot use 'resp.Source' (type *json.RawMessage) as type []byte.</p>\n\n<p>The environment is go 1.10.3 and elastic 6.x</p>\n"}, {"tags": ["go", "visual-studio-code", "intellisense"], "answers": [{"tags": [], "owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1539655128, "last_edit_date": 1539655128, "creation_date": 1539654797, "answer_id": 52826888, "question_id": 52826607, "link": "https://stackoverflow.com/questions/52826607/how-to-get-visual-studio-code-intellisense-to-complete-methods-and-set-cursor-in/52826888#52826888", "title": "How to get Visual Studio Code intellisense to complete methods and set cursor inside ( ) after hitting tab", "body": "<p>There's a few issues about this on <a href=\"https://github.com/Microsoft/vscode/issues/1021\" rel=\"nofollow noreferrer\">Github</a>. Seems they don't want to implement it as standard because it would interfere when you want to type a function reference instead of a function call.</p>\n\n<p>VSCode extensions can provide \"snippets\", which insert code based on a prefix and include the concept of <a href=\"https://code.visualstudio.com/docs/editor/userdefinedsnippets#_tabstops\" rel=\"nofollow noreferrer\">tab stops</a>. This is not really what you're looking for but I'll draw your attention to it anyway.</p>\n\n<p>You can implement more advanced functionality with a <a href=\"https://code.visualstudio.com/docs/extensions/example-language-server\" rel=\"nofollow noreferrer\">language server</a> that listens for events in the document. If you wanted to write it yourself, I think you would need to create a language server extension.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 4577807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wcXB1.jpg?s=128&g=1", "display_name": "Justin White", "link": "https://stackoverflow.com/users/4577807/justin-white"}, "edited": false, "score": 0, "creation_date": 1556598814, "post_id": 52827127, "comment_id": 98482299, "body": "Go: Use Language Server setting will also break this on my Windows 10 Visual Studio Code. I thought I would share."}], "tags": [], "owner": {"reputation": 71, "user_id": 4577807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wcXB1.jpg?s=128&g=1", "display_name": "Justin White", "link": "https://stackoverflow.com/users/4577807/justin-white"}, "is_accepted": false, "score": 2, "last_activity_date": 1539806299, "last_edit_date": 1539806299, "creation_date": 1539657072, "answer_id": 52827127, "question_id": 52826607, "link": "https://stackoverflow.com/questions/52826607/how-to-get-visual-studio-code-intellisense-to-complete-methods-and-set-cursor-in/52827127#52827127", "title": "How to get Visual Studio Code intellisense to complete methods and set cursor inside ( ) after hitting tab", "body": "<p>I finally found it.  Inside your settings.json you need the following line.</p>\n\n<pre><code>{\n        \"go.useCodeSnippetsOnFunctionSuggest\": true, \n}\n</code></pre>\n\n<p>I have the Go ms-vscode.go extension enabled, not sure if this is relevant but just in case.</p>\n"}], "owner": {"reputation": 71, "user_id": 4577807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wcXB1.jpg?s=128&g=1", "display_name": "Justin White", "link": "https://stackoverflow.com/users/4577807/justin-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1539806299, "creation_date": 1539652093, "last_edit_date": 1539652288, "question_id": 52826607, "link": "https://stackoverflow.com/questions/52826607/how-to-get-visual-studio-code-intellisense-to-complete-methods-and-set-cursor-in", "title": "How to get Visual Studio Code intellisense to complete methods and set cursor inside ( ) after hitting tab", "body": "<p>Packages and methods in Visual Studio Code all auto complete after hitting tab (Golang), which is great, but I want it to complete the method and then put the cursor inside the ( ).  I had it working like this on another machine but I can't seem to find setting/extension that does this.</p>\n\n<p>Example:</p>\n\n<p>// before hitting tab</p>\n\n<p><strong>fmt.Pri</strong></p>\n\n<p>// after hitting tab</p>\n\n<p><strong>fmt.Println</strong></p>\n\n<p>// would like this after hitting tab (with cursor inside parenthesis)</p>\n\n<p><strong>fmt.Println()</strong></p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539650683, "post_id": 52825484, "comment_id": 92569667, "body": "maybe you can use <a href=\"https://golang.org/pkg/reflect\" rel=\"nofollow noreferrer\">reflect</a> to convert that, but this is really depends on your case. If we just know what you are trying to achieve with your problem, we could share better approach"}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539682270, "post_id": 52825484, "comment_id": 92580752, "body": "@xpare thank you, I added the usecase."}, {"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 0, "creation_date": 1539803297, "post_id": 52825484, "comment_id": 92638381, "body": "You could use reflection to make this work how you want, but it&#39;s going to be very complicated and I&#39;m pretty convinced it&#39;s not necessary. Like if the only thing you&#39;re doing is calling <code>go customFunction(customObject)</code> just make the signature <code>func()</code> and expect the caller to pass a closure. Expand even more on your usecase (like full code) and I can help more."}, {"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 0, "creation_date": 1539803408, "post_id": 52825484, "comment_id": 92638426, "body": "But the easiest solution is for the client to pass in <code>func(I)</code> and type assert to <code>*T</code> internally, like the wrapper code in my answer does."}], "answers": [{"comments": [{"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1539682433, "post_id": 52825605, "comment_id": 92580836, "body": "I can&#39;t be sure about <code>T</code> type because it will be defined in a user space while <code>myRealFunc</code> will be library function. I update the question/"}], "tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": false, "score": 6, "last_activity_date": 1539642878, "creation_date": 1539642878, "answer_id": 52825605, "question_id": 52825484, "link": "https://stackoverflow.com/questions/52825484/interface-of-function-in-golang/52825605#52825605", "title": "Interface of function in golang", "body": "<p>No, the types need to be exact. Your example is especially broken because <code>I</code> isn't definitely convertible to <code>*T</code>, but it also wouldn't work the other way. If you're <em>sure</em> that the type of the <code>I</code> being passed to your function is <code>*T</code>, you could create wrapper function and pass that instead.</p>\n\n<pre><code>func wrapper(i I) {\n  t := i.(*T)\n  myRealFunc(t)\n}\n</code></pre>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539683251, "creation_date": 1539641915, "last_edit_date": 1539683251, "question_id": 52825484, "link": "https://stackoverflow.com/questions/52825484/interface-of-function-in-golang", "title": "Interface of function in golang", "body": "<p>Consider such function that accepts function as argument:</p>\n\n<pre><code>func f(arg func(I)){}\n</code></pre>\n\n<p>where <code>I</code> is interface.</p>\n\n<p>Is there any way to pass into above function an argument of signature <code>func(*T)</code> where <code>T</code> implements <code>I</code> interface.</p>\n\n<p>Now when I pass it, I have an error:</p>\n\n<pre><code>cannot use (type func(*T)) as type func(I) in argument\n</code></pre>\n\n<p>Here is playground:\n<a href=\"https://play.golang.org/p/7vilY4zkEzf\" rel=\"nofollow noreferrer\">https://play.golang.org/p/7vilY4zkEzf</a></p>\n\n<p><strong>Use case is the following:</strong></p>\n\n<p>I write package that has <code>f(a func(I), b I)</code> function. Then user will import it as library.</p>\n\n<p>As a next step, user will define a custom type <code>T</code> that implements <code>I</code> interface and a custom function with signature <code>func(*T)</code> . Then user will call library <code>f</code> function:</p>\n\n<pre><code>f(customFunction, customObject)\n</code></pre>\n\n<p>In turn, package will receive it and create a goroutine:</p>\n\n<pre><code>go  customFunction(customObject)\n</code></pre>\n\n<p>The reason why goroutines are created \"inside\" package is that goroutine orchestration should be hold \"under the hood\". </p>\n"}, {"tags": ["go", "oauth-2.0", "google-oauth"], "answers": [{"tags": [], "owner": {"reputation": 2586, "user_id": 3548468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U5OZO.png?s=128&g=1", "display_name": "kkesley", "link": "https://stackoverflow.com/users/3548468/kkesley"}, "is_accepted": true, "score": 1, "last_activity_date": 1539660377, "creation_date": 1539660377, "answer_id": 52827561, "question_id": 52825464, "link": "https://stackoverflow.com/questions/52825464/how-to-use-google-refresh-token-when-the-access-token-is-expired-in-go/52827561#52827561", "title": "How to use google refresh token when the access token is expired in GO?", "body": "<p><code>oauth2.Config</code> has a function which can automatically refreshes the token.</p>\n\n<p><code>updatedToken, err := config.TokenSource(context.TODO(), token).Token()</code></p>\n\n<p>pass your old token there and the updatedToken will reflect the updated access token and expiry</p>\n"}], "owner": {"reputation": 2586, "user_id": 3548468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U5OZO.png?s=128&g=1", "display_name": "kkesley", "link": "https://stackoverflow.com/users/3548468/kkesley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "accepted_answer_id": 52827561, "answer_count": 1, "score": 1, "last_activity_date": 1539660377, "creation_date": 1539641764, "question_id": 52825464, "link": "https://stackoverflow.com/questions/52825464/how-to-use-google-refresh-token-when-the-access-token-is-expired-in-go", "title": "How to use google refresh token when the access token is expired in GO?", "body": "<p>I'm new to use Google services and I'm currently trying to read emails from gmail API. However, I'm stuck in the scenario when the access token is expired.</p>\n\n<p>I have the refresh token from the first authentication, however, some threads say that the access token is refreshed automatically when it expires. But mine didn't. I don't know where I'm wrong. Here's my code currently.</p>\n\n<pre><code>// get saved token from database / anywhere else\nfunc getCachedToken() *oauth2.Token {\n    token := new(oauth2.Token)\n    token.AccessToken = \"xxxxxxxx\"\n    token.RefreshToken = \"xxxxxx\"\n    token.TokenType = \"Bearer\"\n    return token\n}\n\nfunc refreshToken(config *oauth2.Config, token *oauth2.Token) *http.Client {\n    return config.Client(context.Background(), token)\n}\n\n// Retrieve a token, saves the token, then returns the generated client.\nfunc getClient(config *oauth2.Config) *http.Client {\n    tok := getTokenFromWeb(config)\n    fmt.Println(tok.RefreshToken)\n    fmt.Println(tok.AccessToken)\n    fmt.Println(tok.Expiry)\n    fmt.Println(tok.TokenType)\n    return config.Client(context.Background(), tok)\n}\n\nfunc main() (string, error) {\n    b, err := ioutil.ReadFile(\"credentials.json\")\n    if err != nil {\n        log.Fatalf(\"Unable to read client secret file: %v\", err)\n    }\n\n    // If modifying these scopes, delete your previously saved token.json.\n    config, err := google.ConfigFromJSON(b, gmail.GmailReadonlyScope, gmail.GmailSendScope, gauth.UserinfoEmailScope, gauth.UserinfoProfileScope)\n    if err != nil {\n        log.Fatalf(\"Unable to parse client secret file to config: %v\", err)\n    }\n    token := getCachedToken()\n    accessToken := token.AccessToken\n    client := refreshToken(config, token)\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve oauth client: %v\", err)\n    }\n    if accessToken != token.AccessToken {\n        fmt.Println(token.RefreshToken)\n        fmt.Println(token.AccessToken)\n        fmt.Println(token.Expiry)\n        fmt.Println(token.TokenType)\n    } //THE TOKEN IS NOT CHANGED HERE WHEN THE ACCESS TOKEN EXPIRED\n    srv, err := gmail.New(client)\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve Gmail client: %v\", err)\n    }\n\n    user := \"me\"\n\n    profile, err := srv.Users.GetProfile(user).Do()\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(profile.MessagesTotal)\n\n    return \"test\", nil\n}\n</code></pre>\n"}, {"tags": ["git", "go", "git-submodules", "dep"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1539669159, "post_id": 52824560, "comment_id": 92573906, "body": "What are you using makefiles for?"}, {"owner": {"reputation": 11, "user_id": 9559811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3faf2f156681c67bb89e80b213934d9d?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/9559811/kai"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1541004214, "post_id": 52824560, "comment_id": 93073572, "body": "I REALLY don&#39;t want to use them. But a developer I work with enjoys them quite much. This would&#39;ve been an intermediary step to getting rid of makefiles. I figured I&#39;d help phase out the submodules first then ultimately the makefiles."}], "owner": {"reputation": 11, "user_id": 9559811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3faf2f156681c67bb89e80b213934d9d?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/9559811/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1539636500, "creation_date": 1539636500, "question_id": 52824560, "link": "https://stackoverflow.com/questions/52824560/how-can-i-import-a-set-of-generic-personal-makefiles-into-my-go-project-using-de", "title": "How can I import a set of generic personal makefiles into my go project using Dep, avoiding submodules?", "body": "<p>I'm trying to clean out submodules from my Golang project. Submodules tagged at certain commits really complicates project setup and initialization. I'm looking for a way to import this non go project (not package) of makefiles to avoid submodule imports.</p>\n\n<p>I'm using <code>Dep</code> in my project as a package manager and thought the <code>[required]</code> element would allow me to pull in external files. As it <a href=\"https://golang.github.io/dep/docs/Gopkg.toml.html\" rel=\"nofollow noreferrer\">states</a>:</p>\n\n<blockquote>\n  <p>\"Use this for: linters, generators, and other development tools that are needed by your project, aren't imported by your project (directly or transitively), if you don't want to put them in your GOPATH, and/or you want to lock the version.\"</p>\n</blockquote>\n\n<p>Is this kind of import even possible to do?</p>\n"}, {"tags": ["pointers", "go", "slice"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 5, "creation_date": 1539631777, "post_id": 52823467, "comment_id": 92564222, "body": "Slices are passed around by value.  A slice value has a pointer to the backing array, length and capacity.  Changing the slice value in initial.elems does not change the slice value in s[0].elems"}, {"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 2, "creation_date": 1539632278, "post_id": 52823467, "comment_id": 92564437, "body": "<a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">golang.org/ref/spec</a>  CTRL+F &quot;Appending to and copying slices&quot;"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539632655, "post_id": 52823467, "comment_id": 92564574, "body": "Either store pointers in the slice, or reference its contents by index."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 2, "creation_date": 1539632825, "post_id": 52823467, "comment_id": 92564626, "body": "@tike <a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Appending_and_copying_slices</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 8684545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yk7IZ.jpg?s=128&g=1", "display_name": "Soveu", "link": "https://stackoverflow.com/users/8684545/soveu"}, "is_accepted": false, "score": 1, "last_activity_date": 1539632873, "creation_date": 1539632873, "answer_id": 52823760, "question_id": 52823467, "link": "https://stackoverflow.com/questions/52823467/appending-to-slice-on-struct-inside-other-slice-not-persisting/52823760#52823760", "title": "Appending To Slice on Struct Inside Other Slice Not Persisting", "body": "<p>Its caused by fact, that the <code>initial</code> variable isn't the same as <code>s[0]</code> - they are two independent <code>Test</code> variables and appending to one doesn't change the second. <code>initial</code> is being copied by value to different object when passed to <code>append()</code></p>\n\n<p>Proof:</p>\n\n<p><code>fmt.Printf(\"second: %p, initial: %p\\n\", &amp;second.elems[0], &amp;initial.elems[0])</code> </p>\n\n<p>(where <code>second.elems[0] == \"apple\"</code> and <code>initial.elems[0] == \"apple\"</code>)\noutputs</p>\n\n<p><code>second: 0xc00000a120, initial: 0xc00000a0c0</code></p>\n\n<p>which shows, that this is true</p>\n"}, {"comments": [{"owner": {"reputation": 1122, "user_id": 4970650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496526a825adf2e6587a19d3a6d391f7?s=128&d=identicon&r=PG", "display_name": "Cirelli94", "link": "https://stackoverflow.com/users/4970650/cirelli94"}, "edited": false, "score": 0, "creation_date": 1582811643, "post_id": 52823886, "comment_id": 106911638, "body": "s := make([]*Test, 0) // create a pointer to Test struct or to slice of pointers of test struct?"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 3, "last_activity_date": 1582910683, "last_edit_date": 1582910683, "creation_date": 1539633371, "answer_id": 52823886, "question_id": 52823467, "link": "https://stackoverflow.com/questions/52823467/appending-to-slice-on-struct-inside-other-slice-not-persisting/52823886#52823886", "title": "Appending To Slice on Struct Inside Other Slice Not Persisting", "body": "<p>In Golang it is mentioned:</p>\n\n<blockquote>\n  <p>Map and slice values behave like pointers: they are descriptors that\n  contain pointers to the underlying map or slice data. Copying a map or\n  slice value doesn't copy the data it points to.</p>\n</blockquote>\n\n<p>The way you are appending to the slice <code>s</code> is creating a new slice by adding the copy of Test struct to the <code>s</code> slice. Hence you are not setting a pointer to the original <code>Test</code> struct. So that if data changes inside the struct it will be reflected in the slice too. This is the problem you are facing.</p>\n\n<pre><code>  initial.elems = append(initial.elems, \"apple\")\n  fmt.Println(initial.elems) // #1 [apple]\n\n  s := make([]Test, 0) // this should be pointer to the struct to have teh changes in future to original struct.\n  s = append(s, initial) // appending to the s slice\n</code></pre>\n\n<p>Create a pointer to the <code>Test</code> struct when making slice <code>s</code>, which will reflect the change whenever you change the elems inside original struct. For example:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\ntype Test struct {\n  elems []string\n}\n\nfunc main() {\n  initial := Test{\n    elems: make([]string, 0),\n  }\n  initial.elems = append(initial.elems, \"apple\")\n  fmt.Println(initial.elems) // #1 [apple]\n\n  s := make([]*Test, 0) // create a pointer to Test struct.\n  s = append(s, &amp;initial)\n\n  initial.elems = append(initial.elems, \"bannana\")\n  fmt.Println(initial.elems) // #2 [apple bannana]\n  fmt.Printf(\"%+v\\n\",*s[0]) // #3 [apple banana]\n\n  second := s[0]\n  second.elems = append(second.elems, \"carrot\")\n  fmt.Println(second.elems) // #4 [apple bannana carrot]\n}\n</code></pre>\n\n<p><strong>Output:-</strong></p>\n\n<pre><code>[apple]\n[apple bannana]\n{elems:[apple bannana]}\n[apple bannana carrot]\n</code></pre>\n\n<p>Working Code on <a href=\"https://play.golang.org/p/VRS6i8Xf3yE\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 3285, "user_id": 4286177, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b15ea6889ed8351f27f11368701a9774?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Dito", "link": "https://stackoverflow.com/users/4286177/anthony-dito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 52823886, "answer_count": 2, "score": -1, "last_activity_date": 1582910683, "creation_date": 1539631461, "question_id": 52823467, "link": "https://stackoverflow.com/questions/52823467/appending-to-slice-on-struct-inside-other-slice-not-persisting", "title": "Appending To Slice on Struct Inside Other Slice Not Persisting", "body": "<p>For example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Test struct {\n  elems []string\n}\n\nfunc main() {\n  initial := Test{\n    elems: make([]string, 0),\n  }\n  initial.elems = append(initial.elems, \"apple\")\n  fmt.Println(initial.elems) // #1 [apple]\n\n  s := make([]Test, 0)\n  s = append(s, initial)\n\n  initial.elems = append(initial.elems, \"bannana\")\n  fmt.Println(initial.elems) // #2 [apple bannana]\n  fmt.Println(s[0].elems) // #3 [apple]\n\n  second := s[0]\n  second.elems = append(second.elems, \"carrot\")\n  fmt.Println(second.elems) // #4 [apple bannana]\n}\n</code></pre>\n\n<p>I am looking for help understanding print statements #3 and #4. In #3 I expect <code>[apple bannana]</code> and in #4 I am expecing <code>[apple bannana carrot]</code>.</p>\n\n<p>It is my understanding that the <code>elems</code> field which is a slice is automatically passed by reference and therefore each append that I do in the above block of code should modify the underlying array. But, apparently that is not the case.</p>\n\n<p>So, my question is: What happens to <code>initial</code> when it gets inserted into a slice that makes this not work? Also, how would one write this code to get the expected result at print statement #4?</p>\n"}, {"tags": ["go", "build"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1539628581, "post_id": 52822815, "comment_id": 92562658, "body": "<code>&#47;&#47; +build custom_tag_name</code> will work just fine. Have you actually tried it and run into some issue?"}, {"owner": {"reputation": 3301, "user_id": 1024412, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/86a328376ad10ede36774e864cb6efa4?s=128&d=identicon&r=PG", "display_name": "KG6ZVP", "link": "https://stackoverflow.com/users/1024412/kg6zvp"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539628695, "post_id": 52822815, "comment_id": 92562714, "body": "My understanding is that using // +build custom_tag would consume the tag, not create a new tag that could be consumed in other files. If // +build custom_tag created tags, then using build tags to resolve correct source files wouldn&#39;t work."}, {"owner": {"reputation": 3301, "user_id": 1024412, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/86a328376ad10ede36774e864cb6efa4?s=128&d=identicon&r=PG", "display_name": "KG6ZVP", "link": "https://stackoverflow.com/users/1024412/kg6zvp"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539628925, "post_id": 52822815, "comment_id": 92562852, "body": "This question shows an example of &quot;consuming&quot; build tags in a source file: <a href=\"https://stackoverflow.com/questions/15214459/how-to-properly-use-build-tags\" title=\"how to properly use build tags\">stackoverflow.com/questions/15214459/&hellip;</a>  In that example, the tags are &quot;created&quot;/&quot;set&quot; with the -tags debug flag on the cli."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1539629107, "post_id": 52822815, "comment_id": 92562952, "body": "Tags are not &quot;created&quot;, they&#39;re just arbitrary text. As the documentation states, files will be compiled at build time so long as their build constraints (if any) are satisfied. Constraints can be set by file name convention or by comments. Some constraints are satisfied implicitly by the environment (GOOS, GOARCH, Go version, etc), others are satisfied explicitly by passing a <code>-tags</code> parameter. It&#39;s not clear what you&#39;re trying to do here or what isn&#39;t working."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1539629459, "post_id": 52822815, "comment_id": 92563126, "body": "You can&#39;t do that. Source files can only set build constraints on themselves, they can&#39;t satisfy constraints. Constraints can only be satisfied as noted - implicitly by the environment, or explicitly via the <code>-tags</code> flag."}, {"owner": {"reputation": 3301, "user_id": 1024412, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/86a328376ad10ede36774e864cb6efa4?s=128&d=identicon&r=PG", "display_name": "KG6ZVP", "link": "https://stackoverflow.com/users/1024412/kg6zvp"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539629910, "post_id": 52822815, "comment_id": 92563351, "body": "You should make that the answer."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1539630183, "creation_date": 1539630183, "answer_id": 52823207, "question_id": 52822815, "link": "https://stackoverflow.com/questions/52822815/how-to-set-build-tags-in-source-file/52823207#52823207", "title": "How to set build tags in source file", "body": "<p>You can't do that. Source files can only set build constraints on themselves, they can't satisfy constraints. Constraints can only be satisfied as noted - implicitly by the environment, or explicitly via the -tags flag. Build constraints are a way to achieve environment-sensitive conditional compilation. Using one source file to control the build of another doesn't really make sense; you know at build time whether file A is in the build, so you know whether file B should be in the build. This seems like an XY Problem, possibly better solved by a mechanism similar to that of the SQL drivers (registering a handler in an <code>init</code> function) or something like that?</p>\n"}], "owner": {"reputation": 3301, "user_id": 1024412, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/86a328376ad10ede36774e864cb6efa4?s=128&d=identicon&r=PG", "display_name": "KG6ZVP", "link": "https://stackoverflow.com/users/1024412/kg6zvp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52823207, "answer_count": 1, "score": -4, "last_activity_date": 1539630183, "creation_date": 1539628455, "last_edit_date": 1539629499, "question_id": 52822815, "link": "https://stackoverflow.com/questions/52822815/how-to-set-build-tags-in-source-file", "title": "How to set build tags in source file", "body": "<p>New to go. I'm familiar with the ability to consume build tags in source files like so:</p>\n\n<pre><code>// +build linux arm,!linux\n</code></pre>\n\n<p>but is there any way to create/export build tags in a source file? Something like:</p>\n\n<pre><code>// +build +custom_tag_name\n</code></pre>\n\n<p>I'm trying to do what the -tags argument does inside of a source file instead of adding it to a makefile so that when a library is added to a project, it will \"set\" certain tags that can be used in other files.</p>\n"}, {"tags": ["mysql", "go", "mariadb"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1539628016, "post_id": 52822261, "comment_id": 92562393, "body": "Not sure about mariadb and mysql, but when using postgres with the lib/pq driver you can create prepared statements from query strings, and if the query contains invalid sql, or even if its valid but you specify a table/column that does not exist <a href=\"https://golang.org/pkg/database/sql/#DB.Prepare\" rel=\"nofollow noreferrer\">Prepare</a> will return an error. Note that if you choose to go this route make sure to Close each prepared statement if you don&#39;t intend to reuse later."}], "answers": [{"comments": [{"owner": {"reputation": 8999, "user_id": 478406, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f923cc63f1ead90b526c3ab330cf2cd?s=128&d=identicon&r=PG", "display_name": "Robert Strauch", "link": "https://stackoverflow.com/users/478406/robert-strauch"}, "edited": false, "score": 0, "creation_date": 1539626622, "post_id": 52822329, "comment_id": 92561747, "body": "Good point. This way I could also make use of a data source in my IDE. And if the statements complete I could write it to a file."}], "tags": [], "owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "is_accepted": false, "score": 3, "last_activity_date": 1539626331, "creation_date": 1539626331, "answer_id": 52822329, "question_id": 52822261, "link": "https://stackoverflow.com/questions/52822261/performing-an-sql-dry-run-from-go-application/52822329#52822329", "title": "Performing an SQL &quot;dry run&quot; (from Go application)", "body": "<p>Have you considered running the 'Dry Run' statements inside of a transaction, provided by the <code>*DB.Conn</code>?</p>\n\n<pre><code>db, err = sql.Open(...)\n\ntxn, err = db.BeginTx(...)\ndefer txn.Rollback\n\nrows, err = txn.Query(...)\n</code></pre>\n"}], "owner": {"reputation": 8999, "user_id": 478406, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f923cc63f1ead90b526c3ab330cf2cd?s=128&d=identicon&r=PG", "display_name": "Robert Strauch", "link": "https://stackoverflow.com/users/478406/robert-strauch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539626331, "creation_date": 1539625996, "question_id": 52822261, "link": "https://stackoverflow.com/questions/52822261/performing-an-sql-dry-run-from-go-application", "title": "Performing an SQL &quot;dry run&quot; (from Go application)", "body": "<p>I have a tool in Go which generates SQL scripts from a YAML file. To minimize the risk that the generated scripts will fail I'd like to do something like a \"dry run\", either by means of SQL or the Go application.</p>\n\n<p>My first thought was using the <code>ROLLBACK</code> statement but then the generated script would also include a rollback instead of a commit.</p>\n\n<p>Does SQL or Go provide something like this?</p>\n"}, {"tags": ["go", "networking", "concurrency"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1539626022, "post_id": 52821939, "comment_id": 92561445, "body": "You are reading from the connection in both goroutines but only writing in one of them, of course this is going to block.... Unless I&#39;m misunderstanding what the server is supposed to be sending you?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1539626118, "post_id": 52821939, "comment_id": 92561490, "body": "You are creating and discarding a bufio.Reader on every iteration of the loop.  This can discard data read from the network, but not yet read from the application.  Create the bufio.Reader outside of the loop."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1539627429, "post_id": 52821939, "comment_id": 92562102, "body": "When the code involved is too big to copy in paste, is the time to create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>. Boiling the code down to the minimum needed to reproduce the issue is often itself a beneficial exercise in finding the cause."}, {"owner": {"reputation": 1, "user_id": 10508587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf1bd13249043091ffb5d60ba0d23a?s=128&d=identicon&r=PG&f=1", "display_name": "Ctrl-c", "link": "https://stackoverflow.com/users/10508587/ctrl-c"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539628110, "post_id": 52821939, "comment_id": 92562449, "body": "@ThunderCat Thanks for your answer. My bad, the actual code creates only one reader, so unfortunately this is not the problem."}, {"owner": {"reputation": 1, "user_id": 10508587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf1bd13249043091ffb5d60ba0d23a?s=128&d=identicon&r=PG&f=1", "display_name": "Ctrl-c", "link": "https://stackoverflow.com/users/10508587/ctrl-c"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1539628478, "post_id": 52821939, "comment_id": 92562610, "body": "@RayfenWindspear, Thanks for your answer. So basically the server sends confirmation that a specific condition was met i.e another client connected to the server. I&#39;m not sure how writing to the connection in both the go routines would fix this."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1539628502, "post_id": 52821939, "comment_id": 92562624, "body": "For starters, while reading from a <code>net.Conn</code> concurrently in 2 places is safe, it makes no sense to do so. You can&#39;t determine which parts of the stream go to which Read calls (not to mention there&#39;s hidden data buffered in the <code>bufio.Readers</code>).  I&#39;m not sure what this is supposed to do, but there&#39;s no way to make it work"}, {"owner": {"reputation": 1, "user_id": 10508587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf1bd13249043091ffb5d60ba0d23a?s=128&d=identicon&r=PG&f=1", "display_name": "Ctrl-c", "link": "https://stackoverflow.com/users/10508587/ctrl-c"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1539629083, "post_id": 52821939, "comment_id": 92562935, "body": "@JimB, thanks for your answer. I understand, will probably try another approach."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539629090, "post_id": 52821939, "comment_id": 92562943, "body": "@Ctrl-c Edit the question to include the actual code.  It&#39;s difficult to help when the posted code is not what you are using."}, {"owner": {"reputation": 1, "user_id": 10508587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf1bd13249043091ffb5d60ba0d23a?s=128&d=identicon&r=PG&f=1", "display_name": "Ctrl-c", "link": "https://stackoverflow.com/users/10508587/ctrl-c"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539632116, "post_id": 52821939, "comment_id": 92564381, "body": "@ThunderCat, I&#39;ve added some sample code that recreates the same error. Hope this makes sense."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1539633371, "post_id": 52821939, "comment_id": 92564863, "body": "@Ctrl-c: your new code is different, but my previous statement still stands, reading concurrently doesn&#39;t makes sense. Also, a <code>bufio.Reader</code> is <i>not</i> safe for concurrent access, so this new example has race conditions (always test the race detector). Just read and process the stream in a single loop."}, {"owner": {"reputation": 1, "user_id": 10508587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf1bd13249043091ffb5d60ba0d23a?s=128&d=identicon&r=PG&f=1", "display_name": "Ctrl-c", "link": "https://stackoverflow.com/users/10508587/ctrl-c"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1539634899, "post_id": 52821939, "comment_id": 92565529, "body": "@JimB, thanks for pointing out the race condition issue. Unfortunately it cannot read in the same loop as the client does some other actions other than communicating with the server. That part of the program would only read from the connection straight after some data has been sent to the server. That is why I was trying to find a way to have one routine read infinitely while the other does some actions and from time to time reads and writes to the server. Do you know a way in which this could be accomplished?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1539635651, "post_id": 52821939, "comment_id": 92565873, "body": "Read messages from one goroutine, determine target for message using message data and/or local state and dispatch to that target."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1539635681, "post_id": 52821939, "comment_id": 92565883, "body": "@Ctrl-c: of course you can do all the reading in one place at a time, because that how all TCP code has to be written. Use a single reader, and dispatch the actions you need done accordingly."}, {"owner": {"reputation": 1, "user_id": 10508587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf1bd13249043091ffb5d60ba0d23a?s=128&d=identicon&r=PG&f=1", "display_name": "Ctrl-c", "link": "https://stackoverflow.com/users/10508587/ctrl-c"}, "edited": false, "score": 0, "creation_date": 1539636882, "post_id": 52821939, "comment_id": 92566369, "body": "Thanks for your help, really appreciated. hope I can make it work :)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10508587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf1bd13249043091ffb5d60ba0d23a?s=128&d=identicon&r=PG&f=1", "display_name": "Ctrl-c", "link": "https://stackoverflow.com/users/10508587/ctrl-c"}, "edited": false, "score": 0, "creation_date": 1540316817, "post_id": 52864137, "comment_id": 92817657, "body": "Hey thanks for your answer. I&#39;ve managed to get it working perfectly with channels."}], "tags": [], "owner": {"reputation": 22, "user_id": 8272588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c218aacc4811a43c1f527d5f94993e?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad.Naser", "link": "https://stackoverflow.com/users/8272588/mohammad-naser"}, "is_accepted": false, "score": 0, "last_activity_date": 1539813067, "creation_date": 1539813067, "answer_id": 52864137, "question_id": 52821939, "link": "https://stackoverflow.com/questions/52821939/golang-concurrently-reading-from-a-tcp-connectoin/52864137#52864137", "title": "Golang concurrently reading from a tcp connectoin", "body": "<p>You should use channel \nhere is a sample which can receive some connection and each connection could send data as wish</p>\n\n<p>package tcp</p>\n\n<pre><code>import (\n    \"bufio\"\n    \"fmt\"\n    \"net\"\n    \"strconv\"\n\n    \"../log\"\n\n    \"../config\"\n    \"../controllers\"\n    h \"../helpers\"\n    )\n\n    type msgFormat struct {\n      text []byte\n      net.Conn\n    }\n\nvar accounts = make(map[net.Conn]int)\nvar conns = make(chan net.Conn)\nvar dconns = make(chan net.Conn)\nvar msgs = make(chan msgFormat)\nvar i int\n\n//Init is first point\nfunc Init() {\n    startserver()\n    for {\n        select {\n        case conn := &lt;-conns:\n            handleconnect(conn)\n        case msg := &lt;-msgs:\n            go handlemsg(msg)\n        case dconn := &lt;-dconns:\n            handlediscounect(dconn)\n        }\n    }\n}\nfunc handlemsg(incomemsg msgFormat) {\n    logger.Log.Println(string(incomemsg.text))\n    resp, err := controllers.Do(incomemsg.text)\n    if err != nil {\n        logger.Log.Println(err.Error())\n    }\n    strLen := []byte(h.Lpad(string(fmt.Sprintf(\"%v\", len(resp))), \"0\", 4))\n    //\n    fresponse := append(strLen, resp...)\n\n    incomemsg.Write(fresponse)\n    logger.Log.Println(\"response is %v\" , string(fresponse))\n}\n\nfunc startserver() {\n    conf := config.GetConfigInstance()\n\n    ln, err := net.Listen(conf.SERVER.Nettype, conf.SERVER.Address)\n    if err != nil {\n        logger.Log.Println(err.Error())\n    }\n    logger.Log.Printf(\"server is serving at %v\", conf.SERVER.Address)\n    go func() {\n        for {\n            conn, err := ln.Accept()\n            if err != nil {\n                logger.Log.Println(err.Error())\n            }\n            conns &lt;- conn\n        }\n    }()\n\n}\n\nfunc readdate(conn net.Conn, i int) {\n    for {\n        rd := bufio.NewReader(conn)\n\n        dataLen := make([]byte, 4)\n        _, err := rd.Read(dataLen)\n        if err != nil {\n            break\n        }\n        intLen, _ := strconv.Atoi(string(dataLen))\n        data := make([]byte, intLen)\n        _, err = rd.Read(data)\n        if err != nil {\n            break\n        }\n        msgs &lt;- msgFormat{data, conn}\n    }\n    dconns &lt;- conn\n}\n\nfunc handleconnect(newconnection net.Conn) {\n    accounts[newconnection] = i\n    i++\n    // if addr , ok := newconnection.RemoteAddr().str\n    logger.Log.Printf(\"Action: Client_Connected %v is connected via %v \\n\", i, newconnection.RemoteAddr().(*net.TCPAddr).IP)\n    go readdate(newconnection, i)\n}\n\nfunc handlediscounect(disconnection net.Conn) {\n    logger.Log.Printf(\"Action: Client_Disconnected %v / %v is gone\\n\", accounts[disconnection] + 1, disconnection.RemoteAddr().(*net.TCPAddr).IP)\n    delete(accounts, disconnection)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10508587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18bf1bd13249043091ffb5d60ba0d23a?s=128&d=identicon&r=PG&f=1", "display_name": "Ctrl-c", "link": "https://stackoverflow.com/users/10508587/ctrl-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1540115340, "creation_date": 1539624605, "last_edit_date": 1540115340, "question_id": 52821939, "link": "https://stackoverflow.com/questions/52821939/golang-concurrently-reading-from-a-tcp-connectoin", "title": "Golang concurrently reading from a tcp connectoin", "body": "<p>I am having some issue with a Go project. The code is way too big to copy and paste so I will try to explain as well as I can.</p>\n\n<p>My program first connects to a TCP server, then it starts a goroutine passing as argument the connection object.</p>\n\n<p>What I'm trying to achieve is having the client to read infinitely from the tcp connection while at the same time to take user input and communicate to the server by sending a retrieving data. I've tried using another goroutine but the program blocks whenever trying to retrieve data from the server.</p>\n\n<p>Here is a reproduction of the error on go playground.</p>\n\n<p><a href=\"https://play.golang.org/p/OD5ozCRmy_4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OD5ozCRmy_4</a> server</p>\n\n<p><a href=\"https://play.golang.org/p/t1r_BAQM-jn\" rel=\"nofollow noreferrer\">https://play.golang.org/p/t1r_BAQM-jn</a> client </p>\n\n<p>Basically whenever the client tries to read from the connection it gets stuck.\nThank you for your help.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 5, "creation_date": 1539624100, "post_id": 52821749, "comment_id": 92560496, "body": "If you look <a href=\"https://gobyexample.com/errors\" rel=\"nofollow noreferrer\">here</a>, you will see <code>By convention, errors are the last return value and have type error, a built-in interface.</code>."}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "edited": false, "score": 2, "creation_date": 1539624155, "post_id": 52821749, "comment_id": 92560524, "body": "example <code>b</code> is correct as mentioned in golang documentation."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1539625464, "post_id": 52821749, "comment_id": 92561179, "body": "&quot;and not sure where to look&quot; then look at the stdlib."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1539627536, "post_id": 52821749, "comment_id": 92562150, "body": "&quot;I&#39;ve seen examples of both&quot; - where have you seen an example of form A? Certainly not anywhere in the standard library."}, {"owner": {"reputation": 3159, "user_id": 1424399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4382058a42be60198883a4c9fdbc0779?s=128&d=identicon&r=PG", "display_name": "bigmadwolf", "link": "https://stackoverflow.com/users/1424399/bigmadwolf"}, "edited": false, "score": 0, "creation_date": 1539635577, "post_id": 52821749, "comment_id": 92565843, "body": "no, you&#39;re right, not in the standard lib."}], "answers": [{"tags": [], "owner": {"reputation": 3159, "user_id": 1424399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4382058a42be60198883a4c9fdbc0779?s=128&d=identicon&r=PG", "display_name": "bigmadwolf", "link": "https://stackoverflow.com/users/1424399/bigmadwolf"}, "is_accepted": true, "score": 1, "last_activity_date": 1539635718, "creation_date": 1539635718, "answer_id": 52824406, "question_id": 52821749, "link": "https://stackoverflow.com/questions/52821749/idiomatic-error-and-value-order-using-multiple-return-values-in-go/52824406#52824406", "title": "idiomatic error and value order using Multiple Return Values in go", "body": "<p>As pointed out by @Gavin above in the comments :</p>\n\n<blockquote>\n  <p>If you look <a href=\"https://gobyexample.com/errors\" rel=\"nofollow noreferrer\">here</a>, you will see By convention, errors are the last return value and have type error, a built-in interface.</p>\n</blockquote>\n\n<p>As can be seen in the standard lib.</p>\n"}], "owner": {"reputation": 3159, "user_id": 1424399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4382058a42be60198883a4c9fdbc0779?s=128&d=identicon&r=PG", "display_name": "bigmadwolf", "link": "https://stackoverflow.com/users/1424399/bigmadwolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 52824406, "answer_count": 1, "score": -2, "last_activity_date": 1539635718, "creation_date": 1539623879, "question_id": 52821749, "link": "https://stackoverflow.com/questions/52821749/idiomatic-error-and-value-order-using-multiple-return-values-in-go", "title": "idiomatic error and value order using Multiple Return Values in go", "body": "<p>When creating a <code>func</code> that returns both an error and a result, which order should they be in?  I've seen examples of both, and not sure where to look to confirm the idiomatic style.</p>\n\n<p>should it be:</p>\n\n<pre><code>// a\nfunc funcName(n int) (error, int) {}\n\n// or b\nfunc funcName(n int) (int, error) {}\n</code></pre>\n"}, {"tags": ["json", "go", "encoding"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 2, "creation_date": 1539623013, "post_id": 52821456, "comment_id": 92560027, "body": "There is nothing wrong with the approach. You  are getting the output you want so what is the question here. The header is added if you create a struct. SO you are getting this json or you want to create a json like that. if that is the question then one more better way is to create a slice of dogs and cats."}, {"owner": {"reputation": 89, "user_id": 10123374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ef45474ba37378f0360a3c54a80e2?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/10123374/javier-salas"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1539623143, "post_id": 52821456, "comment_id": 92560071, "body": "the output of line fmt.Println(string(d)) is:     `        {                 &quot;Breed&quot;: &quot;Chihuahua&quot;,                 &quot;Color&quot;: &quot;brown&quot;         },         {                 &quot;Breed&quot;: &quot;Pug&quot;,                 &quot;Color&quot;: &quot;white&quot;         }`  That&#39;s my concern, how to add the &quot;struct&quot; header to the JSON ."}, {"owner": {"reputation": 89, "user_id": 10123374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ef45474ba37378f0360a3c54a80e2?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/10123374/javier-salas"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1539623193, "post_id": 52821456, "comment_id": 92560094, "body": "I was wondering if there&#39;s a function that do that, output the header and values"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1539623396, "post_id": 52821456, "comment_id": 92560188, "body": "There&#39;s no such thing as a &quot;header&quot; in JSON. What you have is a JSON object with two keys (&quot;Dog&quot; and &quot;Cat&quot;), each containing an array of objects."}, {"owner": {"reputation": 89, "user_id": 10123374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ef45474ba37378f0360a3c54a80e2?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/10123374/javier-salas"}, "edited": false, "score": 0, "creation_date": 1539623457, "post_id": 52821456, "comment_id": 92560214, "body": "Got it, the best approach is the way I&#39;m doing this?"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 10123374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ef45474ba37378f0360a3c54a80e2?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/10123374/javier-salas"}, "edited": false, "score": 0, "creation_date": 1539624021, "post_id": 52821689, "comment_id": 92560458, "body": "That&#39;s what exactly I was looking for!! this is working like a charm!! thanks!!"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1539623617, "creation_date": 1539623617, "answer_id": 52821689, "question_id": 52821456, "link": "https://stackoverflow.com/questions/52821456/how-to-add-header-to-json-to-identify-array-name-of-array-values/52821689#52821689", "title": "How to add header to JSON to identify array name of array values", "body": "<p>There is no need to create json objects separately for dogs and cats. This will lead to separate json objects when marhsalling the data.</p>\n\n<p>The approach you are trying is basically in appropriate and useless.</p>\n\n<p>Approach should to create a result struct which will have dogs and cats structs as fields with type as slice of both of them respectively. Take for an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n    \"log\"\n)\n\ntype Result struct{\n    Dog []Dog\n    Cat []Cat\n}\n\ntype Dog struct{\n   Breed string\n   Color string\n}\n\ntype Cat struct {\n   Breed string\n   Color string\n}\n\nfunc main(){\n\n   dogs := []Dog{\n       {\"Chihuahua\", \"brown\"},\n       {\"Pug\", \"white\"},\n   }\n\n   cats := []Cat{\n        {\"British\", \"white\"},\n        {\"Ragdoll\", \"gray\"},\n   }\n\n   result := Result{\n    Dog: dogs,\n    Cat: cats,\n   } \n\n   output, err := json.MarshalIndent(result, \"\", \"\\t\")\n   if err != nil {\n       log.Fatal(err)\n   }\n   fmt.Println(string(output))\n\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>{\n    \"Dog\": [\n        {\n            \"Breed\": \"Chihuahua\",\n            \"Color\": \"brown\"\n        },\n        {\n            \"Breed\": \"Pug\",\n            \"Color\": \"white\"\n        }\n    ],\n    \"Cat\": [\n        {\n            \"Breed\": \"British\",\n            \"Color\": \"white\"\n        },\n        {\n            \"Breed\": \"Ragdoll\",\n            \"Color\": \"gray\"\n        }\n    ]\n}\n</code></pre>\n\n<p>Working Code on <a href=\"https://play.golang.org/p/wJOwylMDWth\" rel=\"nofollow noreferrer\">Go playground</a></p>\n"}], "owner": {"reputation": 89, "user_id": 10123374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ef45474ba37378f0360a3c54a80e2?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Salas", "link": "https://stackoverflow.com/users/10123374/javier-salas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52821689, "answer_count": 1, "score": -1, "last_activity_date": 1539625689, "creation_date": 1539622761, "last_edit_date": 1539625689, "question_id": 52821456, "link": "https://stackoverflow.com/questions/52821456/how-to-add-header-to-json-to-identify-array-name-of-array-values", "title": "How to add header to JSON to identify array name of array values", "body": "<p>I'm trying to look if there's a way (easy way) to add a header to each array in JSON using <code>encoding/json</code> with GO.</p>\n\n<p>What I mean?</p>\n\n<p>Want to have something like this:</p>\n\n<pre><code>{\n     \"Dog\":[\n      {\n           \"breed\":\"Chihuahua\",\n           \"color\":\"brown\"\n      },\n      {\n           \"breed\":\"Pug\",\n           \"color\":\"white\"\n      }\n    ],\n     \"Cat\":[\n     {\n           \"breed\":\"British\",\n           \"color\":\"white\"\n     },\n           \"breed\":\"Ragdoll\",\n           \"color\":\"gray\"\n     }\n    ]\n}\n</code></pre>\n\n<p>The main idea is to have a \"category\" in this case <code>Dog</code> and <code>Cat</code>.</p>\n\n<p>I already have this solution but I'm looking for something that can Improve this.</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>type Dog struct {\n   Breed string\n   Color string\n}\n\ntype Cat struct {\n   Breed string\n   Color string\n}\n\nfunc main(){\n\n   dogs := [...]Dog{\n       {\"Chihuahua\", \"brown\"},\n       {\"Pug\", \"white\"},\n   }\n\n   cats := [...]Cat{\n        {\"British\", \"white\"},\n        {\"Ragdoll\", \"gray\"},\n   }\n\n   c, err := json.MarshalIndent(cats, \"\", \"\\t\")\n\n   if err != nil {\n       log.Fatal(err)\n   }\n\n   d, err := json.MarshalIndent(dogs, \"\", \"\\t\")\n\n   if err != nil {\n      log.Fatal(err)\n   }\n\n   fmt.Println(\"{\")\n   fmt.Printf(\"    \\\"Dog\\\": %v,\\n\", string(d))\n   fmt.Printf(\"    \\\"Cat\\\": %v\\n}\", string(c))\n\n}\n</code></pre>\n\n<p>The main idea is to have \"Dog\" and \"Cat\" as new array but I want to improve my code to don't have it that \"hardcoded\" to looks as supposed to be, I'm wondering if there's an easy way to add the header \"Dog\" and all the array values, add the header \"Cat\" and all the array values.</p>\n"}, {"tags": ["go", "operating-system", "file-descriptor"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1539622857, "post_id": 52821247, "comment_id": 92559958, "body": "What is wrong here, other than it being confusing to rename a file that&#39;s being written to for no reason? How would this leak anything?"}, {"owner": {"reputation": 4773, "user_id": 2165342, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wgqs2.jpg?s=128&g=1", "display_name": "galusben", "link": "https://stackoverflow.com/users/2165342/galusben"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1539623665, "post_id": 52821247, "comment_id": 92560298, "body": "Is moving an open for write file ok? Will the process be able to close it after is has been moved? will everything be written to the new destination correctly?"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 3, "last_activity_date": 1539623639, "creation_date": 1539623639, "answer_id": 52821697, "question_id": 52821247, "link": "https://stackoverflow.com/questions/52821247/in-golang-does-moving-an-open-file-cause-a-leak-or-any-other-problem/52821697#52821697", "title": "In golang, does moving an open file cause a leak or any other problem?", "body": "<p>If we're talking with an OS and filesystem implementing POSIX semantics (that is, not Windows which normally would not allow you to rename an opened file), there is absolutely no problem: an open file descriptor merely counts as a hardlink to the file's data.</p>\n\n<p>That data of the renamed file does not somehow gets detached from the opened file descriptor\u2014consider the latter as a sort of \"anonymous\" reference to that data.</p>\n\n<p>To cite <a href=\"http://pubs.opengroup.org/onlinepubs/009696899/functions/close.html\" rel=\"nofollow noreferrer\">the <code>close(2)</code> manual</a>:</p>\n\n<blockquote>\n  <p>If the link count of the file is 0, when all file descriptors associated with the file are closed, the space occupied by the file shall be freed and the file shall no longer be accessible.</p>\n</blockquote>\n"}], "owner": {"reputation": 4773, "user_id": 2165342, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wgqs2.jpg?s=128&g=1", "display_name": "galusben", "link": "https://stackoverflow.com/users/2165342/galusben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 52821697, "answer_count": 1, "score": 1, "last_activity_date": 1539623639, "creation_date": 1539621832, "question_id": 52821247, "link": "https://stackoverflow.com/questions/52821247/in-golang-does-moving-an-open-file-cause-a-leak-or-any-other-problem", "title": "In golang, does moving an open file cause a leak or any other problem?", "body": "<p>Consider the following code:</p>\n\n<pre><code>f, err := os.Create(tmpFilepath)\ndefer f.Close()\n// do some writing to f\nos.Rename(tmpFilepath, newpath)\n</code></pre>\n\n<p>Some error handling has been removed to simplify.</p>\n\n<p>Also, I know this code is wrong, but I am trying to understand what is the effect of this code in term of correctness of the files, and in terms of performance.</p>\n\n<p>Is there a resource leak here?</p>\n\n<p>By the way, the fix is to close when you are done writing to the file.</p>\n"}, {"tags": ["go", "active-directory", "ldap", "ldap-query"], "answers": [{"tags": [], "owner": {"reputation": 9067, "user_id": 88122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/U0pg3.png?s=128&g=1", "display_name": "jwilleke", "link": "https://stackoverflow.com/users/88122/jwilleke"}, "is_accepted": false, "score": 0, "last_activity_date": 1539618227, "creation_date": 1539618227, "answer_id": 52820327, "question_id": 52819035, "link": "https://stackoverflow.com/questions/52819035/how-to-compose-a-base-ldap-string-for-unknown-hierarchy/52820327#52820327", "title": "How to compose a base ldap string for unknown hierarchy", "body": "<p>Unfortunately not on Microsoft Active Directory.</p>\n\n<p>There is a thing called <a href=\"https://ldapwiki.com/wiki/ExtensibleMatch\" rel=\"nofollow noreferrer\">ExtensibleMatch</a>, but <a href=\"https://ldapwiki.com/wiki/Microsoft%20Active%20Directory%20Extensible%20Match%20Rules\" rel=\"nofollow noreferrer\">not supported on Microsoft Active Directory</a>.</p>\n\n<p>-jim</p>\n"}, {"tags": [], "owner": {"reputation": 1413, "user_id": 10076590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvrG0.png?s=128&g=1", "display_name": "LisaJ", "link": "https://stackoverflow.com/users/10076590/lisaj"}, "is_accepted": false, "score": 0, "last_activity_date": 1539644513, "creation_date": 1539644513, "answer_id": 52825824, "question_id": 52819035, "link": "https://stackoverflow.com/questions/52819035/how-to-compose-a-base-ldap-string-for-unknown-hierarchy/52825824#52825824", "title": "How to compose a base ldap string for unknown hierarchy", "body": "<p>You do not need to use the fully qualified DN for LDAP binds against an Active Directory server. You can use sAMAccountName and userPrincipalName values to authenticate to AD LDAP... provided you've got a single tree in a single forest, these are formed by concatenating the user-provided logon ID with a string. </p>\n\n<p>For the AD domain gdcmpny.com with legacy domain name GDCMPNY, the user with logon ID MyUserName has userPrincipalName <strong>MyUserName@gdcmpny.com</strong> and sAMAccountName of <strong>GDCMPNY\\MyUserName</strong> regardless of where their ID resides within the directory structure. </p>\n\n<p>In cases where you've got multiple domains within the forest and cannot simply <em>know</em> the proper string to add to the user ID, you can bind under a known system credential, search for the user-supplied logon ID, and return the fully qualified DN (FQDN) of the matching entry. Then use the FQDN with the user-supplied password to validate the user's credentials. </p>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "is_accepted": true, "score": 0, "last_activity_date": 1539677902, "creation_date": 1539677902, "answer_id": 52830927, "question_id": 52819035, "link": "https://stackoverflow.com/questions/52819035/how-to-compose-a-base-ldap-string-for-unknown-hierarchy/52830927#52830927", "title": "How to compose a base ldap string for unknown hierarchy", "body": "<p>string formatting, like:</p>\n\n<pre><code>CN=Users,OU=%s,OU=Goenter code hereodCompany,DC=gdcmpny,DC=com\n</code></pre>\n\n<p>isn't supported, but I can simply don't specify the whole hierarchy in my request.<br>This is what worked for me:</p>\n\n<pre><code>OU=GoodCompany,DC=gdcmpny,DC=com\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 52830927, "answer_count": 3, "score": 0, "last_activity_date": 1539677902, "creation_date": 1539613759, "question_id": 52819035, "link": "https://stackoverflow.com/questions/52819035/how-to-compose-a-base-ldap-string-for-unknown-hierarchy", "title": "How to compose a base ldap string for unknown hierarchy", "body": "<p>I have an active directory that looks a little like this:</p>\n\n<pre><code>gdcmpny.com\n    |__GoodCompany\n       |\n       |__NYC\n       |  |__Users\n       |\n       |__SF\n          |__Users\n</code></pre>\n\n<p>When a user sends me his username+password, i cant know if he's under NYC/Users or SF/Users. Is there a way to compound a string like this:</p>\n\n<pre><code>CN=Users,OU=%s,OU=GoodCompany,DC=gdcmpny,DC=com\n</code></pre>\n\n<p>so the ldap request will look in both NYC/Users and SF/Users? Or do I have to specify the exact absolute path?<br>I am using Go to send the request, with the package github.com/jtblin/go-ldap-client.<br>Thanks!</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1539613659, "post_id": 52818689, "comment_id": 92555308, "body": "error 1 is &quot;operation not permitted&quot;  so I guess you are tripping over some kind of resource or security constraint"}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1539614694, "post_id": 52818689, "comment_id": 92555943, "body": "I generally like to cross compile using GOOS and GOARCH and not do the actual build on the docker container.  You may be able to get smaller images that way"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4194320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbb15276cdc98dd9d0b3033e41708c83?s=128&d=identicon&r=PG&f=1", "display_name": "ditmay", "link": "https://stackoverflow.com/users/4194320/ditmay"}, "edited": false, "score": 0, "creation_date": 1539615413, "post_id": 52819413, "comment_id": 92556372, "body": "yeah you right! its because connection to DB. Thank you very much"}], "tags": [], "owner": {"reputation": 36, "user_id": 10507878, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jCPyfemex8Y/AAAAAAAAAAI/AAAAAAAAAEE/vmoFA-ih0TI/photo.jpg?sz=128", "display_name": "Dzmitry Misiuk", "link": "https://stackoverflow.com/users/10507878/dzmitry-misiuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1539615046, "creation_date": 1539615046, "answer_id": 52819413, "question_id": 52818689, "link": "https://stackoverflow.com/questions/52818689/go-docker-container-fail-exit-code-1/52819413#52819413", "title": "Go Docker Container Fail: &quot;Exit Code 1&quot;", "body": "<p>I have briefly looked at your code and found that app could be finished in a case when <code>connection.Ping()</code> return err\n<a href=\"https://github.com/aditmayapada/tryout/blob/master/main.go#L44\" rel=\"nofollow noreferrer\">https://github.com/aditmayapada/tryout/blob/master/main.go#L44</a>\nI recommend adding some logging in this space to identify a point of exit. It seems something is wrong with connection to DB in docker. </p>\n"}], "owner": {"reputation": 23, "user_id": 4194320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbb15276cdc98dd9d0b3033e41708c83?s=128&d=identicon&r=PG&f=1", "display_name": "ditmay", "link": "https://stackoverflow.com/users/4194320/ditmay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7321, "favorite_count": 0, "accepted_answer_id": 52819413, "answer_count": 1, "score": 1, "last_activity_date": 1539615046, "creation_date": 1539612693, "question_id": 52818689, "link": "https://stackoverflow.com/questions/52818689/go-docker-container-fail-exit-code-1", "title": "Go Docker Container Fail: &quot;Exit Code 1&quot;", "body": "<p>i'am trying to running my Go Apps in Docker container, but it fail and give error exit code 1. The application works well in my local machine but not in Docker.</p>\n\n<p>Below is my Dockerfile.</p>\n\n<pre><code>FROM golang:1.8 as goimage\n\nRUN go get -u github.com/golang/dep/cmd/dep\n\nCOPY . src/github.com/aditmayapada/tryout\nWORKDIR src/github.com/aditmayapada/tryout\n\n\nENV PORT 9090\n\nRUN dep ensure\n\nRUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o bin/main\n\nFROM alpine:3.6 as baseimagealp\nRUN apk add --no-cache bash\nENV WORK_DIR=/docker/bin\nWORKDIR $WORK_DIR\n# RUN mkdir src/github.com/aditmayapada/tryout/bin\n# WORKDIR src/github.com/aditmayapada/tryout/bin\nCOPY --from=goimage /go/src/github.com/aditmayapada/tryout/bin ./\nENTRYPOINT /docker/bin/main\nEXPOSE 9090\n</code></pre>\n\n<p>And below is my apps repository that i want to deploy in Docker\n<a href=\"https://github.com/aditmayapada/tryout\" rel=\"nofollow noreferrer\">https://github.com/aditmayapada/tryout</a></p>\n\n<p>I have tried to get logs using docker events, and i only get this\n<a href=\"https://i.stack.imgur.com/2LpyG.png\" rel=\"nofollow noreferrer\">Logs</a></p>\n\n<p>Then i tried to use --logs in docker but its not showing anything.</p>\n\n<p>Am i missing something here? because my apps run well in my local machine... Thank you.</p>\n"}, {"tags": ["go", "postman", "load-testing", "go-gin"], "comments": [{"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1539615656, "post_id": 52817890, "comment_id": 92556514, "body": "Could you show us vegata file you have written?"}, {"owner": {"reputation": 79, "user_id": 10031581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/686926de56fb3840ee7a53bc269fdc21?s=128&d=identicon&r=PG&f=1", "display_name": "misha", "link": "https://stackoverflow.com/users/10031581/misha"}, "reply_to_user": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1539662540, "post_id": 52817890, "comment_id": 92572170, "body": "@mbuechmann see the edit I edit my question"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1539672017, "post_id": 52817890, "comment_id": 92575080, "body": "Hi @misha You have included your whole program. That is a start. However, your question would be much easier to answer if you would reduce your code to the relevant part. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 79, "user_id": 10031581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/686926de56fb3840ee7a53bc269fdc21?s=128&d=identicon&r=PG&f=1", "display_name": "misha", "link": "https://stackoverflow.com/users/10031581/misha"}, "reply_to_user": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1539672469, "post_id": 52817890, "comment_id": 92575294, "body": "@mbuechmann will you tell me that is there any reference program from which I will under vegeta attack that how to implement it in go to test multiple routes."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1539673180, "post_id": 52817890, "comment_id": 92575666, "body": "There is no such thing. Just use common sense and ask yourself: &quot;Is this part relevant&quot;? E.g. your main func is not relevant. Your routing is not relevant, at least not all routes. All those fmt.Printlns, too, and so on."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1539673551, "post_id": 52817890, "comment_id": 92575844, "body": "Also: more important would be, on which lines your errore occurs. You should add a comment in the source code. Do you get them during run time or compile time?"}, {"owner": {"reputation": 79, "user_id": 10031581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/686926de56fb3840ee7a53bc269fdc21?s=128&d=identicon&r=PG&f=1", "display_name": "misha", "link": "https://stackoverflow.com/users/10031581/misha"}, "reply_to_user": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1539673823, "post_id": 52817890, "comment_id": 92575981, "body": "@mbuechmann yes sir,I got the run time error"}], "answers": [{"tags": [], "owner": {"reputation": 1188, "user_id": 300520, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/282efd4afde27a16916568b25c79beb9?s=128&d=identicon&r=PG", "display_name": "maverick", "link": "https://stackoverflow.com/users/300520/maverick"}, "is_accepted": false, "score": -2, "last_activity_date": 1539621217, "creation_date": 1539621217, "answer_id": 52821102, "question_id": 52817890, "link": "https://stackoverflow.com/questions/52817890/how-i-will-do-load-testvegeta-for-multiple-methods-multiple-in-golang/52821102#52821102", "title": "How I will do load test(vegeta) for multiple methods multiple in golang", "body": "<p>Vegeta takes concurrency and time parameters and you can create report out of it.</p>\n"}, {"tags": [], "owner": {"reputation": 22, "user_id": 8272588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c218aacc4811a43c1f527d5f94993e?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad.Naser", "link": "https://stackoverflow.com/users/8272588/mohammad-naser"}, "is_accepted": false, "score": -2, "last_activity_date": 1539813782, "creation_date": 1539813782, "answer_id": 52864263, "question_id": 52817890, "link": "https://stackoverflow.com/questions/52817890/how-i-will-do-load-testvegeta-for-multiple-methods-multiple-in-golang/52864263#52864263", "title": "How I will do load test(vegeta) for multiple methods multiple in golang", "body": "<p>you could use \n <a href=\"https://linux.die.net/man/1/siege\" rel=\"nofollow noreferrer\">https://linux.die.net/man/1/siege</a> and it allow you to test APIs and having report </p>\n"}], "owner": {"reputation": 79, "user_id": 10031581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/686926de56fb3840ee7a53bc269fdc21?s=128&d=identicon&r=PG&f=1", "display_name": "misha", "link": "https://stackoverflow.com/users/10031581/misha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1065, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1539813782, "creation_date": 1539610134, "last_edit_date": 1539672637, "question_id": 52817890, "link": "https://stackoverflow.com/questions/52817890/how-i-will-do-load-testvegeta-for-multiple-methods-multiple-in-golang", "title": "How I will do load test(vegeta) for multiple methods multiple in golang", "body": "<p>Suppose I have an api having two routes one is for saving the user and another one is for getting the user given below:-</p>\n\n<p>router.go</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n    \"go-training/postAPI/controller\"\n)\n\ntype Route struct {\n    Name        string\n    Method      string\n    Pattern     string\n    HandlerFunc func(*gin.Context)\n}\n\ntype Routes []Route\n\nvar routes = Routes{\n    Route{\"SaveUser\", \"POST\", \"/post\", controller.SaveUser},\n    Route{\"GetUser\", \"GET\", \"/post/:id\", controller.GetUser},\n}\nfunc NewRouter() {\n    router := gin.Default()\n    v1 := router.Group(\"/api/v1\")\n    for _, route := range routes {\n        switch route.Method {\n        case \"GET\":\n            v1.GET(route.Pattern, route.HandlerFunc)\n        case \"POST\":\n            v1.POST(route.Pattern, route.HandlerFunc)\n        case \"PUT\":\n            v1.PUT(route.Pattern, route.HandlerFunc)\n        case \"DELETE\":\n            v1.DELETE(route.Pattern, route.HandlerFunc)\n        default:\n            v1.GET(route.Pattern, func(c *gin.Context) {\n                c.JSON(200, gin.H{\n                    \"result\": \"Specify a valid http method with this route.\",\n                })\n            })\n        }\n    }\n    router.Run(\":8080\")\n}\n</code></pre>\n\n<p>By hitting these url <code>localhost:8080/api/v1/post</code> method:- <code>POST</code> by Postman it will take the json data from postman and enters into the database and while getting the user url <code>localhost:8080/api/v1/post/:id</code> method:- <code>GET</code> by postman then it will return the user matching with the id entered. Now, I want to take load test(vegeta) these api's because I want to see that how many request it would be take in one second. I read <a href=\"https://thisdata.com/blog/load-testing-api-interfaces-with-go-and-vegeta/\" rel=\"nofollow noreferrer\">this link</a> and implement the program but I don't know how will I take load test of my api's separately.</p>\n\n<p>Can anyone tell me that how will I take the load test of these two api's or any refrence?</p>\n\n<p><strong>Edited</strong></p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nfunc main() {\n    NewRouter()\n    GetVegeta()\n}\n</code></pre>\n\n<p>vegeta.go</p>\n\n<pre><code>// Panic if there is an error\nfunc check(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\nfunc GetVegeta() {\n    var (\n        users int\n    )\n\n    // The Go random number generator source is deterministic, so we need to seed    \n    // Configure our command line app\n    app := cli.NewApp()\n    app.Name = \"Pokemon User Data Generator\"\n    app.Usage = \"generate a stream of test data for vegeta. Type 'pokemon help' for details\"\n\n    // Add -users flag, which defaults to 5\n    app.Flags = []cli.Flag{\n        cli.IntFlag{\n            Name: \"users\",\n        },\n    }\n\n    // Our app's main action\n    app.Action = func(c *cli.Context) error {\n    // Combine verb and URL to a target for Vegeta\n        verb := c.Args().Get(0)\n        url := c.Args().Get(1)\n        target := fmt.Sprintf(\"%s %s\", verb, url)\n        fmt.Println(verb)\n        fmt.Println(url)\n        fmt.Println(target)\n        if len(target) &gt; 1 {\n\n            for i := 1; i &lt; users; i++ {\n                fmt.Println(users)\n            }\n        } else {\n            // Return an error if we're missing the required command line arguments\n            return cli.NewExitError(\"You must specify the target in format 'VERB url'\", 1)\n        }\n        return nil\n    }\n\n    app.Run(os.Args)\n}\n</code></pre>\n\n<p>These files are in same folder name <code>Template</code>. I'm running this whole folder with the command <code>./Template -users=10 GET https://localhost:8080/api/v1/customer | vegeta attack -rate=10 -duration=30s | vegeta report</code></p>\n\n<p>by running this all api's run and when I will hit any api from the postman then it will give me the <strong>error</strong> of <code>bad method: [GIN]</code> and <code>encode: can't detect encoding of \"stdin\"</code> How will I solve this to make a report of my api's.</p>\n\n<p>Thanks for your precious time!</p>\n"}, {"tags": ["docker", "go", "goroutine", "docker-api"], "comments": [{"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1539609454, "post_id": 52816890, "comment_id": 92552643, "body": "If this was me I would make the slice internal to the package and have a method, like &quot;GetContainers&quot; that returned a copy of the slice (copy protected by mutex)."}, {"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1539761602, "post_id": 52816890, "comment_id": 92614724, "body": "The question as it stands now is too broad, and I will vote for it to be closed."}], "answers": [{"comments": [{"owner": {"reputation": 1598, "user_id": 1955704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/90de93f0b1184d5daea7574e4fa5e37d?s=128&d=identicon&r=PG", "display_name": "Loric-", "link": "https://stackoverflow.com/users/1955704/loric"}, "edited": false, "score": 0, "creation_date": 1539697720, "post_id": 52829107, "comment_id": 92590104, "body": "Thanks for enlightening. I understand now it is not idiomatic. I have searched for information and I have updated my question above. Would a mutex be sufficient to protect the variable? (by using a method locking the variable before reading it)."}], "tags": [], "owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "is_accepted": true, "score": 0, "last_activity_date": 1539671073, "creation_date": 1539671073, "answer_id": 52829107, "question_id": 52816890, "link": "https://stackoverflow.com/questions/52816890/uptodate-list-of-running-docker-containers-stated-in-an-exported-golang-variable/52829107#52829107", "title": "Uptodate list of running docker containers stated in an exported golang variable", "body": "<p>No, it is not idiomatic Go to share the <code>Running</code> variable between two goroutines. You do this by sharing it between the routine that runs your <code>main</code> function, and the <code>listen</code> function which is started with <code>go</code>\u2014which spawns another goroutine.</p>\n\n<p>Why, is because it breaks with </p>\n\n<blockquote>\n  <p>Do not communicate by sharing memory; instead, share memory by\n  communicating. <a href=\"https://blog.golang.org/share-memory-by-communicating\" rel=\"nofollow noreferrer\">\u00b9</a></p>\n</blockquote>\n\n<p>So the design of the API needs to change in order to be idiomatic; you need to remove the <code>Running</code> variable and replace it with what? It depends on what you are trying to achieve. If you are trying to cache the <code>cli.ContainerList</code> because you need to call it often, and it might be expensive, you should implement a cache which is invalidated on each <code>cli.Events</code>.</p>\n\n<p>What is your motivation?</p>\n"}], "owner": {"reputation": 1598, "user_id": 1955704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/90de93f0b1184d5daea7574e4fa5e37d?s=128&d=identicon&r=PG", "display_name": "Loric-", "link": "https://stackoverflow.com/users/1955704/loric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 52829107, "answer_count": 1, "score": 0, "last_activity_date": 1539697542, "creation_date": 1539606802, "last_edit_date": 1539697542, "question_id": 52816890, "link": "https://stackoverflow.com/questions/52816890/uptodate-list-of-running-docker-containers-stated-in-an-exported-golang-variable", "title": "Uptodate list of running docker containers stated in an exported golang variable", "body": "<p>I am trying to use the Golang SDK of Docker in order to maintain a slice variable with currently running containers on the local Docker instance. This slice is exported from a package and I want to use it to feed a web page.</p>\n\n<p>I am not really used to goroutines and channels and that's why I am wondering if I have spotted a good solution for my problem.</p>\n\n<p>I have a <code>docker</code> package as follows.</p>\n\n<p><a href=\"https://play.golang.org/p/eMmqkMezXZn\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eMmqkMezXZn</a></p>\n\n<p>It has a <code>Running</code> variable containing the current state of running containers.</p>\n\n<pre><code>var Running []types.Container\n</code></pre>\n\n<p>I use a <code>reload</code> function to load the running containers in the <code>Running</code> variable.</p>\n\n<pre><code>// Reload the list of running containers\nfunc reload() error {\n    ...\n    Running, err = cli.ContainerList(context.Background(), types.ContainerListOptions{\n        All: false,\n    })\n    ...\n}\n</code></pre>\n\n<p>And then I start a goroutine from the <code>init</code> function to listen to Docker events and trigger the <code>reload</code> function accordingly.</p>\n\n<pre><code>func init() {\n    ...\n    // Listen for docker events\n    go listen()\n    ...\n}\n\n// Listen for docker events\nfunc listen() {\n    filter := filters.NewArgs()\n    filter.Add(\"type\", \"container\")\n    filter.Add(\"event\", \"start\")\n    filter.Add(\"event\", \"die\")\n\n    msg, errChan := cli.Events(context.Background(), types.EventsOptions{\n        Filters: filter,\n    })\n\n    for {\n        select {\n        case err := &lt;-errChan:\n            panic(err)\n        case &lt;-msg:\n            fmt.Println(\"reloading\")\n            reload()\n        }\n    }\n}\n</code></pre>\n\n<p>My question is, is it proper to update a variable from inside a goroutine (in terms of sync)? Maybe there is a cleaner way to achieve what I am trying to build?</p>\n\n<p><strong>Update</strong></p>\n\n<p>My concern here is not really about caching. It is more about hiding the \"complexity\" of the process of listening and update from the Docker SDK. I wanted to provide something like an index to easily let the end user loop and display currently running containers.</p>\n\n<p>I was aware of data-races problems in threaded programs but I did not realize I was as actually in a context of concurrence here (I never wrote concurrent programs in Go before).</p>\n\n<p>I effectively need to re-think the solution to be more idiomatic. As far as I can see, I have two options here: either protecting the variable with a mutex or re-thinking the design to integrate channels.</p>\n\n<p>What means the most to me is to hide or encapsulate the method of synchronization used so the package users need not concern of how the shared state is protected.</p>\n\n<p>Would you have any recommendations?</p>\n\n<p>Thanks a lot for your help,\nLoric</p>\n"}, {"tags": ["go", "middleware", "mux"], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 8147937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf46fcd1a3a82c2ff156fdbef0b24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Niel_patel", "link": "https://stackoverflow.com/users/8147937/niel-patel"}, "edited": false, "score": 0, "creation_date": 1539610041, "post_id": 52817757, "comment_id": 92553011, "body": "I am starting a transaction in the handler and want to close it in middleware whether it throws an error from the handler or returns response."}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "reply_to_user": {"reputation": 74, "user_id": 8147937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf46fcd1a3a82c2ff156fdbef0b24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Niel_patel", "link": "https://stackoverflow.com/users/8147937/niel-patel"}, "edited": false, "score": 0, "creation_date": 1539610279, "post_id": 52817757, "comment_id": 92553163, "body": "As you can see the response in <code>else</code> part, if authorization failed in <code>validateMiddleware</code> handler, so you can also return like this. And don&#39;t forget to mention <code>return</code> keyword if you don&#39;t want to execute further code after throws an error."}, {"owner": {"reputation": 74, "user_id": 8147937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf46fcd1a3a82c2ff156fdbef0b24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Niel_patel", "link": "https://stackoverflow.com/users/8147937/niel-patel"}, "edited": false, "score": 0, "creation_date": 1539610712, "post_id": 52817757, "comment_id": 92553439, "body": "I think the code you shared will call before the actual handler but I want to write it in a way that it will be called after handler&#39;s response or error it throws."}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "reply_to_user": {"reputation": 74, "user_id": 8147937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf46fcd1a3a82c2ff156fdbef0b24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Niel_patel", "link": "https://stackoverflow.com/users/8147937/niel-patel"}, "edited": false, "score": 0, "creation_date": 1539611060, "post_id": 52817757, "comment_id": 92553631, "body": "you want to manage errors throwing by your code? then why you need a <code>middleware</code>? why don&#39;t you use <code>error</code> handle process like: <code>if err != nil { &#47;&#47;something to response }</code>"}, {"owner": {"reputation": 74, "user_id": 8147937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf46fcd1a3a82c2ff156fdbef0b24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Niel_patel", "link": "https://stackoverflow.com/users/8147937/niel-patel"}, "edited": false, "score": 0, "creation_date": 1539611279, "post_id": 52817757, "comment_id": 92553776, "body": "I want to close the SQL transaction which started in the handler. because I am writing repetitive code everywhere, and if I found a way to write a middleware which closed after any response from a handler. i am looking for error because if it throws an error then i want to roll back the transaction else i will commit it on success."}, {"owner": {"reputation": 74, "user_id": 8147937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf46fcd1a3a82c2ff156fdbef0b24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Niel_patel", "link": "https://stackoverflow.com/users/8147937/niel-patel"}, "edited": false, "score": 0, "creation_date": 1539611577, "post_id": 52817757, "comment_id": 92553983, "body": "<code>func closeTxnMiddleware(next http.HandlerFunc) http.HandlerFunc {         return http.HandlerFunc(func(w http.ResponseWriter, req *http.Request) {             if w.response_code == 200 || 201 {              if err = txo.Commit(); err == nil { \t\t\treturn false \t\t}             }           else {               txo.Rollback();            }         })     }</code>   i am looking for something like this"}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "reply_to_user": {"reputation": 74, "user_id": 8147937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf46fcd1a3a82c2ff156fdbef0b24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Niel_patel", "link": "https://stackoverflow.com/users/8147937/niel-patel"}, "edited": false, "score": 0, "creation_date": 1539611983, "post_id": 52817757, "comment_id": 92554243, "body": "may be this <a href=\"https://stackoverflow.com/questions/42871194/how-can-i-combine-go-middleware-pattern-with-error-returning-request-handlers\">link</a> would be helpful for you."}], "tags": [], "owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "is_accepted": false, "score": -1, "last_activity_date": 1539610367, "last_edit_date": 1539610367, "creation_date": 1539609750, "answer_id": 52817757, "question_id": 52816646, "link": "https://stackoverflow.com/questions/52816646/how-do-i-write-golang-middleware-which-handle-response-error-from-api/52817757#52817757", "title": "How do i write golang middleware which handle response/error from API?", "body": "<p>In Go lang you can create a middle-ware too, below I've written the process to create handler as <code>validateMiddleware</code> then called it when <code>TestEndpoint</code> API requested.</p>\n\n<pre><code>func main() {\n    router := mux.NewRouter()\n\n    router.HandleFunc(\"/test\", ValidateMiddleware(TestEndpoint)).Methods(\"GET\")\n    log.Fatal(http.ListenAndServe(\":12345\", router))\n}\n</code></pre>\n\n<p>And now you can create your <code>validateMiddleware</code> handler as:</p>\n\n<pre><code>    func ValidateMiddleware(next http.HandlerFunc) http.HandlerFunc {\n        return http.HandlerFunc(func(w http.ResponseWriter, req *http.Request) {\n            authorizationHeader := req.Header.Get(\"authorization\")\n                    if authorizationHeader != \"\" {\n                        // if true, then request for next handler.\n                        next(w, req)\n                    } else {\n                        json.NewEncoder(w).Encode(Exception{Message: \"Invalid authorization token\"})\n                        return\n                    }\n        })\n    }\n</code></pre>\n\n<p>And finally create original requested handler <code>TestEndpoint</code></p>\n\n<pre><code>func TestEndpoint(w http.ResponseWriter, req *http.Request) {\n    fmt.Println(\"Hello Go middleware!!!\")\n}\n</code></pre>\n"}], "owner": {"reputation": 74, "user_id": 8147937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf46fcd1a3a82c2ff156fdbef0b24b2?s=128&d=identicon&r=PG&f=1", "display_name": "Niel_patel", "link": "https://stackoverflow.com/users/8147937/niel-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1259, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539610367, "creation_date": 1539605943, "question_id": 52816646, "link": "https://stackoverflow.com/questions/52816646/how-do-i-write-golang-middleware-which-handle-response-error-from-api", "title": "How do i write golang middleware which handle response/error from API?", "body": "<p>Basically, I want to write one middleware which closes transaction object is created while a request. I am using gorilla mux package. I am familiar with python-Django middlewares and it gives proper handling of error or response. but not able to find anything similar with golang</p>\n"}, {"tags": ["windows", "batch-file", "go", "testing", "cmd"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1539605818, "post_id": 52816437, "comment_id": 92550380, "body": "Simply run <code>go run .&#47;...</code>. Starting from Go 1.9, this does not execute tests in <code>vendor</code> folder."}, {"owner": {"reputation": 548, "user_id": 5345652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZdgGaohbRX0/AAAAAAAAAAI/AAAAAAAAAAA/65laXilEcK8/photo.jpg?sz=128", "display_name": "Sharon Katz", "link": "https://stackoverflow.com/users/5345652/sharon-katz"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1539608764, "post_id": 52816437, "comment_id": 92552201, "body": "Thanks for the link you added. However I am using go1.7 and all answers are talking about go 1.9  Appreciate if you can reopen"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1539609101, "post_id": 52816437, "comment_id": 92552411, "body": "Go 1.7 is more than 2 years old and is not maintained anymore, it doesn&#39;t even receive security patches. Believe me, it&#39;s better to upgrade to Go 1.11 than to keep beating a dead horse."}], "owner": {"reputation": 548, "user_id": 5345652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZdgGaohbRX0/AAAAAAAAAAI/AAAAAAAAAAA/65laXilEcK8/photo.jpg?sz=128", "display_name": "Sharon Katz", "link": "https://stackoverflow.com/users/5345652/sharon-katz"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1539605796, "answer_count": 0, "score": 1, "last_activity_date": 1539608704, "creation_date": 1539605295, "last_edit_date": 1539608704, "question_id": 52816437, "link": "https://stackoverflow.com/questions/52816437/run-go-1-7-x-test-from-batch-file-and-exclude-vendor", "closed_reason": "Duplicate", "title": "Run GO 1.7.x test from batch file and exclude vendor", "body": "<p>I'm trying to run go test -v from windows command batch file.</p>\n\n<p>My GO version is 1.7.1 (and can't be replaced)</p>\n\n<p>go test -v .... doesn't work since I have vendor folder.</p>\n\n<p>I searched and found this:\nfor /f \"\" %G in ('go list ./... ^| find /i /v \"/vendor/\"') do @go test %G</p>\n\n<p>But it doesn't work for me.</p>\n\n<p>Any ideas ?\nThanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1539606993, "post_id": 52816069, "comment_id": 92551093, "body": "What have you tried so far?"}, {"owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "reply_to_user": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1539607362, "post_id": 52816069, "comment_id": 92551313, "body": "I am able to change the IP by hardcoding the template file inside my main program."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1539609369, "post_id": 52816069, "comment_id": 92552596, "body": "You should take a look at text/template."}], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "is_accepted": true, "score": 2, "last_activity_date": 1540219569, "creation_date": 1540219569, "answer_id": 52932078, "question_id": 52816069, "link": "https://stackoverflow.com/questions/52816069/how-can-i-create-a-file-with-interface-names-in-specific-parts-and-later-parsed/52932078#52932078", "title": "How can I create a file with interface names in specific parts and later parsed from an another file to modify the interface with data in GO?", "body": "<p>I was able to carry this out by converting the command line input</p>\n\n<blockquote>\n  <p>./program --xyz.yaml --{interface} eth0 --IPaddress 192.168.1.233/24 --{gateway} 192.168.0.1 --DNS 8.8.3.8,8.8.8.3</p>\n</blockquote>\n\n<p>I used a mapping function to map the CLI to strings with this</p>\n\n<pre><code>func manyRandomArg() map[string]string {\n    rv := make(map[string]string)\n    for ix, x := range os.Args {\n        if x[:2] == \"--\" {\n            rv[x] = os.Args[ix+1]\n        }\n    }\n    return rv\n}\n</code></pre>\n\n<p>Then I sorted only the keys and carried out the Search Replace function</p>\n\n<pre><code>keys := make([]string, 0, len(rv))\n    for key := range rv {\n        keys = append(keys, key)\n    }\n    sort.Strings(keys) //sort keys alphabetically\n</code></pre>\n\n<p>Had to trim the '--' part in the key</p>\n\n<pre><code>key0 = trimLeftChars(keys[0], 2)\n</code></pre>\n\n<p>The string replace function used was</p>\n\n<pre><code>r := strings.NewReplacer(key0, rv[keys[0]], key1, rv[keys[1]], key2, rv[keys[2]], key3, rv[keys[3]], key4, rv[keys[4]])\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52932078, "answer_count": 1, "score": 1, "last_activity_date": 1540219569, "creation_date": 1539603966, "last_edit_date": 1539607298, "question_id": 52816069, "link": "https://stackoverflow.com/questions/52816069/how-can-i-create-a-file-with-interface-names-in-specific-parts-and-later-parsed", "title": "How can I create a file with interface names in specific parts and later parsed from an another file to modify the interface with data in GO?", "body": "<p>I am building a program to change IP address of the machine in Ubuntu 18.04.1 LTS. So basically I am creating a YAML file template with </p>\n\n<pre><code>network:\n   ethernets:\n      {INTERFACE}:\n          dhcp4: no\n          addresses: [{IP}/24]\n          gateway4: {GATEWAY}\n          optional: true\n          nameservers:\n           addresses: [{DNS}]\n     {INTERFACE2}:\n          dhcp4: no\n          addresses: [{IP2}/24]\n          gateway4: {GATEWAY2}\n          optional: true\n          nameservers:\n           addresses: [{DNS2}]\n</code></pre>\n\n<p>Now I need to scan this template file and add the values from an another file either through a JSON call or as parameters in CLI.</p>\n\n<p>So the app will take a template file that has been pre-prepared. Such as the example template for yaml file.</p>\n\n<p>It will take 3 parameters\nthis template file, a translation file(JSON), and the output</p>\n\n<p>the translation file could be parsed on the commandline also</p>\n\n<p>It is based on 2 columns, the search variable such as IP and its new value\nThe utility will search for the <code>{IP}</code> variable and replace it with the second column value.</p>\n\n<p>On the CLI it might look like this:</p>\n\n<blockquote>\n  <p>./searchreplace -intemplate='templateip.yaml' -translation='{IP},xxx.x.x.x;\n  {SUBNET},yyy.yyy.yyy.y} -outfile=/tmp/newipfile.yaml</p>\n</blockquote>\n\n<p>My current code hard codes the data and changes the IP but I want it to be in a separate template file. This is my current code</p>\n\n<pre><code>    package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"os\"\n    \"os/exec\"\n    \"regexp\"\n    \"strings\"\n)\n\nvar pathdelete = \"/etc/netplan/01-network-manager-all.yaml\"\nvar ipv4Regex = regexp.MustCompile(`^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}/[0-9]+$`)\nvar gatewayRegex = regexp.MustCompile(`^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$`)\nvar nsRegex = regexp.MustCompile(`^(?:[0-9]\\.){3}[0-9]{1,3}\\,(?:[0-9]\\.){3}[0-9]{1,3}$`)\nvar nicRegex = regexp.MustCompile(`e([a-z]+)`)\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter the IP address: \")\n    IPaddress, _ := reader.ReadString('\\n')\n    IPaddress = strings.TrimSuffix(IPaddress, \"\\n\")\n\n    //sanity check\n    testInput := net.ParseIP(IPaddress)\n    if testInput.To4() == nil {\n        fmt.Printf(\"%v is not a valid IPv4 address\\n\", testInput)\n    } else {\n        fmt.Printf(\"It is a valid IP address\\n\")\n        writeFile()\n        readFile()\n    }\n}\nfunc writeFile() {\n    err01 := os.Truncate(pathdelete, 0)\n    if err01 != nil {\n        log.Fatal(err01)\n    }\n\n    //reading Network Cards\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter the Ethernet Card (for example : 'ens0N' or 'eth0') \")\n    nic, _ := reader.ReadString('\\n')\n    nic = strings.TrimSuffix(nic, \"\\n\")\n    if nicRegex.MatchString(nic) {\n    } else {\n        log.Fatal(\"Please check the name of the NIC Card you have entered\")\n        os.Exit(1)\n    }\n\n    //reading IP Address and DNS\n    fmt.Print(\"Enter the IP address along with the DNS in the format xxx.xxx.x.xxx/yy \")\n    IP, _ := reader.ReadString('\\n')\n    IP = strings.TrimSuffix(IP, \"\\n\")\n\n    if ipv4Regex.MatchString(IP) {\n    } else {\n        log.Fatal(\"Please check the IP address you have entered\")\n        os.Exit(1)\n    }\n\n    //reading Gateway\n    fmt.Print(\"Enter the gateway in the format xxx.xxx.x.x \")\n    gateway, _ := reader.ReadString('\\n')\n    gateway = strings.TrimSuffix(gateway, \"\\n\")\n    if gatewayRegex.MatchString(gateway) {\n    } else {\n        log.Fatal(\"Please check the Gateway you have entered\")\n        os.Exit(1)\n    }\n\n    //reading Name servers\n    fmt.Print(\"Enter the nameservers seperated by comma(,) in the format x.x.x.x,y.y.y.y \")\n    ns, _ := reader.ReadString('\\n')\n    ns = strings.TrimSuffix(ns, \"\\n\")\n    if nsRegex.MatchString(ns) {\n    } else {\n        log.Fatal(\"Please check the Name Servers you have entered\")\n        os.Exit(1)\n    }\n\n    // open file using READ &amp; WRITE permission\n    var file, err = os.OpenFile(pathdelete, os.O_RDWR, 0644)\n    checkError(err)\n    defer file.Close()\n\n    // write some text to file\n    _, err = file.WriteString(\"# Let NetworkManager manage all devices on this system\\nnetwork:\\n  version: 2\\n  renderer: NetworkManager\\n\")\n    if err != nil {\n        fmt.Println(err.Error())\n        return //must return here for defer statements to be called\n    }\n    _, err = file.WriteString(\"  ethernets:\\n    \" + nic + \":\\n      dhcp4: no\\n      dhcp6: no\\n\")\n    if err != nil {\n        fmt.Println(err.Error())\n        return //same as above\n    }\n    _, err = file.WriteString(\"      addresses: [\" + IP + \"]\\n      gateway4: \" + gateway + \"\\n      nameservers:\\n        addresses: [\" + ns + \"]\")\n    if err != nil {\n        fmt.Println(err.Error())\n        return //same as above\n    }\n\n    // save changes\n    err = file.Sync()\n    if err != nil {\n        fmt.Println(err.Error())\n        return //same as above\n    }\n    applyCmd := exec.Command(\"bash\", \"-c\", \"sudo netplan apply\")\n    _, err2 := applyCmd.Output()\n    if err2 != nil {\n        panic(err2)\n    }\n}\n\nfunc readFile() {\n    // re-open file\n    var file, err = os.OpenFile(pathdelete, os.O_RDWR, 0644)\n    checkError(err)\n    defer file.Close()\n\n    // read file\n    var text = make([]byte, 1024)\n    n, err := file.Read(text)\n    if n &gt; 0 {\n        fmt.Println(\"\\nThe data you have entered is \\n \")\n        fmt.Println(string(text))\n    }\n    //if there is an error while reading\n    //just print however much was read if any\n    //at return file will be closed\n}\n\nfunc checkError(err error) {\n    if err != nil {\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 484, "user_id": 5826540, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0ea9d7911377881cf7a69ce177143cd9?s=128&d=identicon&r=PG&f=1", "display_name": "nagrom97", "link": "https://stackoverflow.com/users/5826540/nagrom97"}, "is_accepted": false, "score": 1, "last_activity_date": 1539600954, "last_edit_date": 1539600954, "creation_date": 1539600385, "answer_id": 52814976, "question_id": 52814840, "link": "https://stackoverflow.com/questions/52814840/how-to-calculate-something-in-html-template/52814976#52814976", "title": "How to calculate something in html/template", "body": "<p>You can use a FuncMap like <a href=\"https://www.calhoun.io/intro-to-templates-p3-functions/\" rel=\"nofollow noreferrer\">this</a>. Once you define a function within a funcmap, you can use it in the HTML. In your case you could define a <strong>MapLength</strong> function or something similar that calculates the length of a given map and returns it for you. You can then call it in the template a bit like this:</p>\n\n<pre><code>&lt;p&gt;The last index of this map is: {{ .MapLength . }} &lt;/p&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1189, "user_id": 9288348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ug2H4.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/9288348/jeremy"}, "edited": false, "score": 0, "creation_date": 1539609258, "post_id": 52815110, "comment_id": 92552513, "body": "Thanks, I saw  that you can use some functions like <code>len()</code> and others inside the html template. Hoped there would be like a calculate function."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1539613866, "last_edit_date": 1539613866, "creation_date": 1539600807, "answer_id": 52815110, "question_id": 52814840, "link": "https://stackoverflow.com/questions/52814840/how-to-calculate-something-in-html-template/52815110#52815110", "title": "How to calculate something in html/template", "body": "<p>You can't. Templates are not a scripting language. By design philosophy, complex logic should be outside of templates.</p>\n\n<p>Either pass the calculated result as a parameter (preferred / easiest), or register custom functions which you can call during template execution, pass values to them and which may perform calculations and return any values (e.g. return <code>param - 1</code>).</p>\n\n<p>For examples of registering and using custom functions, see:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/35550326/golang-templates-and-passing-funcs-to-template/35550730#35550730\">Golang templates (and passing funcs to template)</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/48579757/how-do-i-access-object-field-by-variable-in-template/48581296#48581296\">How do I access object field by variable in template?</a> </p>\n\n<p><a href=\"https://stackoverflow.com/questions/42948556/iterate-go-map-get-index/42950177#42950177\">Iterate Go map get index</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "is_accepted": false, "score": 1, "last_activity_date": 1539600963, "creation_date": 1539600963, "answer_id": 52815147, "question_id": 52814840, "link": "https://stackoverflow.com/questions/52814840/how-to-calculate-something-in-html-template/52815147#52815147", "title": "How to calculate something in html/template", "body": "<p>The other answers are correct, you can't do it in the template themselves. However, here's a working example of how to use <code>Funcs</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n    \"os\"\n)\n\ntype MyMap map[string]string\n\nfunc LastMapIndex(args ...interface{}) string {\n    if m, ok := args[0].(MyMap); ok &amp;&amp; len(args) == 1 {\n        return fmt.Sprintf(\"%d\", len(m) - 1)\n    }\n    return \"\"\n\n}\n\nfunc main() {\n    myMap := MyMap{}\n    myMap[\"foo\"] = \"bar\"\n\n    t := template.New(\"template test\")\n    t = t.Funcs(template.FuncMap{\"LastMapIndex\": LastMapIndex})\n    t = template.Must(t.Parse(\"Last map index: {{.|LastMapIndex}}\\n\"))\n    t.Execute(os.Stdout, myMap)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/YNchaHc5Spz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/YNchaHc5Spz</a></p>\n"}], "owner": {"reputation": 1189, "user_id": 9288348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ug2H4.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/9288348/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 52815110, "answer_count": 3, "score": 0, "last_activity_date": 1539613876, "creation_date": 1539599902, "last_edit_date": 1539613876, "question_id": 52814840, "link": "https://stackoverflow.com/questions/52814840/how-to-calculate-something-in-html-template", "title": "How to calculate something in html/template", "body": "<p>How can you calculate something inside a html template of go?</p>\n\n<p><em>For example:</em></p>\n\n<pre><code>{{ $length := len . }}\n&lt;p&gt;The last index of this map is: {{ $length -1 }} &lt;/p&gt;\n</code></pre>\n\n<p>Were the <code>.</code>  is a map.<br>\nThe code <code>{{ $length -1 }}</code>  is not working, is there a way to achieve this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1539600379, "post_id": 52814761, "comment_id": 92547263, "body": "If you are testing unexported functions, you must test it in the same package. Normal rules apply, testing is not special in this regard."}, {"owner": {"reputation": 2571, "user_id": 2422530, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/zlebS.jpg?s=128&g=1", "display_name": "Obi Wan - PallavJha", "link": "https://stackoverflow.com/users/2422530/obi-wan-pallavjha"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1539600530, "post_id": 52814761, "comment_id": 92547345, "body": "@Flimzy I tried that way too. I&#39;ve updated the code."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 1, "last_activity_date": 1539600832, "creation_date": 1539600832, "answer_id": 52815118, "question_id": 52814761, "link": "https://stackoverflow.com/questions/52814761/testing-the-methods-present-in-different-packages/52815118#52815118", "title": "Testing the methods present in different packages", "body": "<blockquote>\n  <p>Is there any way to add other tests present in children packages into the test suite?</p>\n</blockquote>\n\n<p>No.</p>\n\n<p>Tests are not part of the package. As you can import only whole packages and the tests are not part of it you simply cannot. And stop thinking about \"child packages\": There are no such things. All packages are equal and their filesystem location does not matter (except internal and vendor).</p>\n"}], "owner": {"reputation": 2571, "user_id": 2422530, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/zlebS.jpg?s=128&g=1", "display_name": "Obi Wan - PallavJha", "link": "https://stackoverflow.com/users/2422530/obi-wan-pallavjha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 52815118, "answer_count": 1, "score": -1, "last_activity_date": 1539600832, "creation_date": 1539599639, "last_edit_date": 1539600461, "question_id": 52814761, "link": "https://stackoverflow.com/questions/52814761/testing-the-methods-present-in-different-packages", "title": "Testing the methods present in different packages", "body": "<p>While writing test cases I found 2 problems:</p>\n\n<ol>\n<li><p>There are 3 test files out of which <code>one_test.go</code> and <code>two_test.go</code> can be added to <code>server_suites_test.go</code> and it runs fine. But the functions of <code>three_point_one_test.go</code> cannot be added into <code>server_suites_test.go</code> because <code>_test.go</code> cannot be imported.</p></li>\n<li><p><code>one_test.go</code> and <code>two_test.go</code> use gRPC client object which is created by <code>server_test.go</code>. Actually, <code>server_test.go</code> creates a gRPC server and a client and this client is used by the other test cases. Currently <code>three_point_one_test.go</code> cannot access this client. So to solve this issue I'm creating client every time this test is run. </p></li>\n</ol>\n\n<p>Project Structure(incomplete BTW!)</p>\n\n<pre><code>&gt; tree /f\nFolder PATH listing for volume Windows\nVolume serial number is 1C92-17A5\nC:.\n\u2514\u2500\u2500\u2500data\n    \u2502   one.go\n    \u2502   one_test.go\n    \u2502   two.go\n    \u2502   two_test.go\n    \u2502   server.go\n    \u2502   server_suites_test.go\n    \u2502   server_test.go\n    \u2502   \n    \u2514\u2500\u2500\u2500three\n            three_point_one.go\n            three_point_one_test.go\n</code></pre>\n\n<p>server_suites_test.go</p>\n\n<pre><code>package data\n\nimport (\n    \"testing\"\n    \"someproj/three\"\n)\n\nfunc TesOne(t *testing.T) {\n    t.Run(\"One\", testOne) //from one_test.go\n}\n\nfunc TestTwo(t *testing.T) {\n    t.Run(\"Two\", testTwo) //from two_test.go\n}\n\n// Below code cannot be compiled -START\nfunc TestThreePointOne(t *testing.T) {\n    t.Run(\"ThreePointOne\", three.TestThreePointOne) //cannot import this function\n}\n// Below code cannot be compiled -END\n</code></pre>\n\n<p>Is there any way to add other tests present in children packages into the test suite?</p>\n"}, {"tags": ["go", "go-get"], "answers": [{"tags": [], "owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "is_accepted": true, "score": 9, "last_activity_date": 1539594071, "last_edit_date": 1539594071, "creation_date": 1539593730, "answer_id": 52813009, "question_id": 52812872, "link": "https://stackoverflow.com/questions/52812872/does-go-get-command-do-cache/52813009#52813009", "title": "Does go get command do cache?", "body": "<p><code>go get</code> downloads the packages named by the import paths, along with their\ndependencies.</p>\n\n<p>Then installs the package, using <code>go install</code>, which uses <code>go build</code> and <code>go build</code> caches recent build results in <code>$GOPATH/pkg</code></p>\n\n<p>The default location for cache data is a subdirectory named <code>go-build</code> in the standard user cache directory for the current operating system.</p>\n\n<p>Cache directory:</p>\n\n<p><code>go env GOCACHE</code></p>\n\n<p>For more information about cache <code>go help cache</code></p>\n\n<p>More information about caching, <a href=\"https://golang.org/doc/go1.10#build\" rel=\"noreferrer\">1.10</a>, <a href=\"https://golang.org/cmd/go/#hdr-Build_and_test_caching\" rel=\"noreferrer\">documentation</a>, <a href=\"https://golang.org/doc/go1.11#gocache\" rel=\"noreferrer\">upcoming changes</a></p>\n"}], "owner": {"reputation": 1674, "user_id": 4487542, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/f5Hr6.png?s=128&g=1", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/4487542/j%c3%a9r%c3%b4me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5652, "favorite_count": 0, "accepted_answer_id": 52813009, "answer_count": 1, "score": 1, "last_activity_date": 1539595297, "creation_date": 1539593267, "question_id": 52812872, "link": "https://stackoverflow.com/questions/52812872/does-go-get-command-do-cache", "title": "Does go get command do cache?", "body": "<p>I trying to find if the <code>go get</code> command do cache or not but I don't find any information inside <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow noreferrer\">https://golang.org/cmd/go/</a>.</p>\n\n<p>I think there is no cache but I'm not sure. </p>\n\n<p>Does <code>go get</code> do cache and if yes where is located ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539592206, "post_id": 52812546, "comment_id": 92543022, "body": "I don&#39;t get what you are trying to achieve, could you explain more clearly."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1539592479, "post_id": 52812546, "comment_id": 92543176, "body": "This is 100% wrong. <code>MapSnapshot := MapVar.MyMap</code> does <i>not</i> produce a copy which can be used concurrently to the &quot;original&quot;."}, {"owner": {"reputation": 25, "user_id": 4665374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy15J.png?s=128&g=1", "display_name": "Anarz", "link": "https://stackoverflow.com/users/4665374/anarz"}, "edited": false, "score": 0, "creation_date": 1539592778, "post_id": 52812546, "comment_id": 92543335, "body": "You say that the pointer of MapVar.MyMap is the same as MapSnapshot ? Its a new var declaration, so it should be just a copy. Can you explain me why I&#39;m wrong on this point ?"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539593134, "post_id": 52812546, "comment_id": 92543523, "body": "@Anarz map is a complex data structure, it&#39;s not an integer or string value, to copy with single assignment. It holds several other references to other things, and by the way <code>map[x]x</code> is itself a reference.read <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">this</a> for more information."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4665374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy15J.png?s=128&g=1", "display_name": "Anarz", "link": "https://stackoverflow.com/users/4665374/anarz"}, "edited": false, "score": 0, "creation_date": 1539592693, "post_id": 52812674, "comment_id": 92543281, "body": "This for loop takes a lot of time, there is many stuff in this loop, so locking will slow down other routines. I am looking to make a copy of MapVar.MyMap which can be used as it and not linked by any way to the &quot;original&quot; MapVar"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 25, "user_id": 4665374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy15J.png?s=128&g=1", "display_name": "Anarz", "link": "https://stackoverflow.com/users/4665374/anarz"}, "edited": false, "score": 0, "creation_date": 1539592785, "post_id": 52812674, "comment_id": 92543343, "body": "even you copied the <code>MapVar.MyMap</code> you&#39;ll end by performing loop on the copied object, so the <code>map concurrent write&#47;read</code> will still happen."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 25, "user_id": 4665374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy15J.png?s=128&g=1", "display_name": "Anarz", "link": "https://stackoverflow.com/users/4665374/anarz"}, "edited": false, "score": 0, "creation_date": 1539592862, "post_id": 52812674, "comment_id": 92543379, "body": "change the <code>MyFunc()</code> execution to normal execution (not as goroutine), then inside the loop run each process as goroutine, so you&#39;ll get better performance. then you can remove the mutex."}, {"owner": {"reputation": 25, "user_id": 4665374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy15J.png?s=128&g=1", "display_name": "Anarz", "link": "https://stackoverflow.com/users/4665374/anarz"}, "edited": false, "score": 0, "creation_date": 1539592936, "post_id": 52812674, "comment_id": 92543416, "body": "So I guess I&#39;m looking for the right way to copy the content of the object into a new var and not the object itself"}, {"owner": {"reputation": 25, "user_id": 4665374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy15J.png?s=128&g=1", "display_name": "Anarz", "link": "https://stackoverflow.com/users/4665374/anarz"}, "edited": false, "score": 0, "creation_date": 1539593425, "post_id": 52812674, "comment_id": 92543697, "body": "I understand your approach and thanks for this. But I absolutely have to thread this func since it launch in another func which is a main part of a big software. So if I understand : to copy the content of a map, I MUST loop through it and write each value to the new map ? Just NewMap := OldMap will never work because it also copy the reference of the map because of the native data structure of a map which is not like any standard string or int value"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 0, "last_activity_date": 1539593480, "last_edit_date": 1539593480, "creation_date": 1539592529, "answer_id": 52812674, "question_id": 52812546, "link": "https://stackoverflow.com/questions/52812546/concurrent-read-write-of-a-map-var-snapshot/52812674#52812674", "title": "Concurrent read/write of a map var snapshot", "body": "<blockquote>\n  <p>there is no multiple runs of this func. Many other functions are accessing to the same \"MapVar\" with the same method and it randomly produce a \"map concurrent write/read\"</p>\n</blockquote>\n\n<p>When you pass the value of <code>MapVar.MyMap</code> to <code>MapSnapshot</code>, the <code>Map concurrent write/read</code> will never be occur, because the operation is wrapped with mutex.</p>\n\n<p>But on the loop, the error could happen since practically reading process is happening during loop. So better to wrap the loop with mutex as well.</p>\n\n<pre><code>MapVar.Lock() // lock begin\n\nMapSnapshot := MapVar.MyMap\nfor _, a := range MapSnapshot {\n   // Map concurrent write/read occur here\n   // Some stuff\n}\n\nMapVar.Unlock() // lock end\n</code></pre>\n\n<hr>\n\n<h3>UPDATE 1</h3>\n\n<p>Here is my response to your argument below:</p>\n\n<blockquote>\n  <p>This for loop takes a lot of time, there is many stuff in this loop, so locking will slow down other routines</p>\n</blockquote>\n\n<p>As per your statement <code>The function \"MyFunc\" is run in a go routine, only once, there is no multiple runs of this func</code>, then I think making the <code>MyFunc</code> to be executed as goroutine is not a good choice.</p>\n\n<p>And to increase the performance, better to make the process inside the loop to be executed in a goroutine.</p>\n\n<pre><code>func MyFunc() {\n    for _, a := range MapVar.MyMap {\n        go func(a MyDatas) {\n           // do stuff here\n        }(a)\n    }\n}\n\nmain() {\n    MyFunc() // remove the go keyword\n}\n</code></pre>\n\n<hr>\n\n<h3>UPDATE 2</h3>\n\n<p>If you really want to <strong>copy</strong> the <code>MapVar.MyMap</code> into another object, passing it to another variable will not solve that (<code>map</code> is different type compared to <code>int</code>, <code>float32</code> or other <s>primitive</s> type).</p>\n\n<p>Please refer to this thread <a href=\"https://stackoverflow.com/questions/23057785/how-to-copy-a-map\">How to copy a map?</a></p>\n"}], "owner": {"reputation": 25, "user_id": 4665374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy15J.png?s=128&g=1", "display_name": "Anarz", "link": "https://stackoverflow.com/users/4665374/anarz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 52812674, "answer_count": 1, "score": 0, "last_activity_date": 1539593751, "creation_date": 1539591968, "last_edit_date": 1539593751, "question_id": 52812546, "link": "https://stackoverflow.com/questions/52812546/concurrent-read-write-of-a-map-var-snapshot", "title": "Concurrent read/write of a map var snapshot", "body": "<p>I encounter a situation that I can not understand. In my code, I use functions have the need to read a map (but not write, only loop through a snapshot of existing datas in this map). There is my code :</p>\n\n<pre><code>type MyStruct struct {\n   *sync.RWMutex\n   MyMap map[int]MyDatas\n}\n\nvar MapVar = MyStruct{ &amp;sync.RWMutex{}, make(map[int]MyDatas) }\n\nfunc MyFunc() {\n   MapVar.Lock()\n   MapSnapshot := MapVar.MyMap\n   MapVar.Unlock()\n   for _, a := range MapSnapshot { // Map concurrent write/read occur here\n      //Some stuff\n   }\n}\n\nmain() {\n   go MyFunc()\n}\n</code></pre>\n\n<p>The function \"MyFunc\" is run in a go routine, only once, there is no multiple runs of this func. Many other functions are accessing to the same \"MapVar\" with the same method and it randomly produce a \"map concurrent write/read\". I hope someone will explain to me why my code is wrong.</p>\n\n<p>Thank you for your time.</p>\n\n<p>edit: To clarify, I am just asking why my range MapSnapshot produce a concurrent map write/read. I cant understand how this map can be concurrently used since I save the real global var (MapVar) in a local var (MapSnapshot) using a sync mutex.</p>\n\n<p>edit: Solved. To copy the content of a map in a new variable without using the same reference (and so to avoid map concurrent read/write), I must loop through it and write each index and content to a new map with a for loop. </p>\n\n<p>Thanks xpare and nilsocket.</p>\n"}, {"tags": ["json", "parsing", "go"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1539591318, "post_id": 52812227, "comment_id": 92542572, "body": "It&#39;s better to use a struct type."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539592124, "post_id": 52812227, "comment_id": 92542977, "body": "@Sammy btw, please approve the correct and best answer, because it might be useful for others. They probably face similar problem and doesn&#39;t know how to solve it. see more <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 2999, "user_id": 3893182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0HeT.jpg?s=128&g=1", "display_name": "danopz", "link": "https://stackoverflow.com/users/3893182/danopz"}, "edited": false, "score": 0, "creation_date": 1539608678, "post_id": 52812227, "comment_id": 92552152, "body": "Btw there is proably not the correct and best answer, this would imply that any other way would be false which isn&#39;t. Better also means readable and maintainable which obviously is better using structs instead of random type casts."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 1, "creation_date": 1539618650, "post_id": 52812227, "comment_id": 92558034, "body": "The question was <i>not</i> about unmarshalling JSON into a struct. Both answers are valid, but there might be a reason OP is using unmarshalling into a map - there&#39;s always a possibility that JSON structure is not fixed. That&#39;s why I voted for @xpare answer, which <i>exactly</i> answers the question without refactoring and assumptions. However, perfect answer would probably suggest an option of unmarshalling into a struct for convenience, and explain pros and cons of this approach."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 2999, "user_id": 3893182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0HeT.jpg?s=128&g=1", "display_name": "danopz", "link": "https://stackoverflow.com/users/3893182/danopz"}, "edited": false, "score": 0, "creation_date": 1539657587, "post_id": 52812227, "comment_id": 92571109, "body": "@danopz btw, I was not trying to say that that my answer is the correct and the best one indeed. I&#39;m just telling OP to approve the best answer from his perspective, and letting him know about the guidelines. because yesterday I saw his profile, I found out that he&#39;s rarely approve people answer on his own questions."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 2999, "user_id": 3893182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0HeT.jpg?s=128&g=1", "display_name": "danopz", "link": "https://stackoverflow.com/users/3893182/danopz"}, "edited": false, "score": 0, "creation_date": 1539657863, "post_id": 52812227, "comment_id": 92571159, "body": "@danopz and also I use AND operator. &quot;correct AND best&quot;. it&#39;ll not imply that any other answer would be false. it&#39;s very possible that all of the answers are correct, then OP decide one of them to be the best one"}], "answers": [{"tags": [], "owner": {"reputation": 2999, "user_id": 3893182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0HeT.jpg?s=128&g=1", "display_name": "danopz", "link": "https://stackoverflow.com/users/3893182/danopz"}, "is_accepted": false, "score": 1, "last_activity_date": 1539608800, "last_edit_date": 1539608800, "creation_date": 1539591123, "answer_id": 52812331, "question_id": 52812227, "link": "https://stackoverflow.com/questions/52812227/parse-json-with-an-array-in-golang/52812331#52812331", "title": "Parse JSON with an array in golang", "body": "<p>You should probably define a struct for the body and unmarshal into this:</p>\n\n<pre><code>var result struct {\n    Results []struct{\n        ID string `json:\"ID\"`\n    } `json:\"results\"`\n    Index int `json:\"index\"`\n}\n\nerr := json.Unmarshal(body, &amp;result)\n\nif err != nil {\n    // do something, result may be empty\n    return\n}\n\nfor i, result := range result.Results {\n    fmt.Println(i, result.ID)\n}\n</code></pre>\n\n<p>Then you would have access to the values e.g. by calling <code>result.Index</code> or <code>result.Results[0].ID</code>.</p>\n\n<p>Working example: <a href=\"https://play.golang.org/p/j1WpEolQlXV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/j1WpEolQlXV</a></p>\n"}, {"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 4, "last_activity_date": 1539648897, "last_edit_date": 1539648897, "creation_date": 1539591234, "answer_id": 52812359, "question_id": 52812227, "link": "https://stackoverflow.com/questions/52812227/parse-json-with-an-array-in-golang/52812359#52812359", "title": "Parse JSON with an array in golang", "body": "<p>As per your json string, few things need to be fixed. First, the <code>result[\"results\"]</code> property need to be casted as <code>[]interface{}</code> because <code>results</code> hold an array data.</p>\n\n<pre><code>ids := result[\"results\"].([]interface{})\n</code></pre>\n\n<p>Then, on each iteration of <code>ids</code>, variable <code>value</code> (whose type is <code>interface{}</code>) need to be casted into <code>map[string]interface{}</code>, so we will be able to access <code>ID</code> property to get it's value.</p>\n\n<pre><code>for index, value := range ids {\n    valueMap := value.(map[string]interface{})\n    fmt.Println(index, valueMap[\"ID\"])\n}\n</code></pre>\n\n<p>Working example: <a href=\"https://play.golang.org/p/Pxq6u7q-NAK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Pxq6u7q-NAK</a></p>\n\n<hr>\n\n<p>As per @Andrejs' answer, if your JSON structure is fixed, then it would be better to use well defined struct on the result (see @danopz's answer). <a href=\"https://www.reddit.com/r/golang/comments/67jppg/performance_difference_for_unmarshaling_json/\" rel=\"nofollow noreferrer\">It has better performance</a> and consume less effort interact with it's child.</p>\n"}], "owner": {"reputation": 705, "user_id": 637794, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/b7cb728a98ea17d32a6b12d2affebd13?s=128&d=identicon&r=PG", "display_name": "Sammy", "link": "https://stackoverflow.com/users/637794/sammy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 52812359, "answer_count": 2, "score": 1, "last_activity_date": 1540171244, "creation_date": 1539590685, "last_edit_date": 1539591412, "question_id": 52812227, "link": "https://stackoverflow.com/questions/52812227/parse-json-with-an-array-in-golang", "title": "Parse JSON with an array in golang", "body": "<p>I would like to retrieve all IDs and also the index value. </p>\n\n<pre><code>{\n  \"results\": [\n    {\n      \"ID\": \"3b72\"\n    },\n    {\n      \"ID\": \"d953b1\"\n    },\n    {\n      \"ID\": \"8eac\"\n    },\n    {\n      \"ID\": \"00b4c\"\n    },\n    {\n      \"ID\": \"22360\"\n    }\n  ],\n  \"index\": 10\n}\n</code></pre>\n\n<p>I tried the following but no success ( I am quite new in golang):</p>\n\n<pre><code>var result map[string]interface{}\njson.Unmarshal([]byte(body), &amp;result)\n\nids:= result[\"results\"].(map[string]interface{})\n\nfor key, value := range ids{\n    fmt.Println(key, value.(string))\n}\n</code></pre>\n"}, {"tags": ["arrays", "go", "slice", "bit", "endianness"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1539598191, "last_edit_date": 1539598191, "creation_date": 1539589553, "answer_id": 52811969, "question_id": 52811744, "link": "https://stackoverflow.com/questions/52811744/extract-bits-into-a-int-slice-from-byte-slice/52811969#52811969", "title": "Extract bits into a int slice from byte slice", "body": "<p>One way is to loop over the bytes, and use a 2nd loop to shift the byte values bit-by-bit and test for the bits with a bitmask. And add the result to the output slice.</p>\n\n<p>Here's an implementation of it:</p>\n\n<pre><code>func bits(bs []byte) []int {\n    r := make([]int, len(bs)*8)\n    for i, b := range bs {\n        for j := 0; j &lt; 8; j++ {\n            r[i*8+j] = int(b &gt;&gt; uint(7-j) &amp; 0x01)\n        }\n    }\n    return r\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>fmt.Println(bits([]byte{3, 255}))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/NgXAoU-zoE7\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 730, "user_id": 6161244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/990831a04db3b7c4a8ac83e67e00817d?s=128&d=identicon&r=PG", "display_name": "Constantin Konstantinidis", "link": "https://stackoverflow.com/users/6161244/constantin-konstantinidis"}, "is_accepted": false, "score": 0, "last_activity_date": 1569326665, "creation_date": 1569326665, "answer_id": 58079934, "question_id": 52811744, "link": "https://stackoverflow.com/questions/52811744/extract-bits-into-a-int-slice-from-byte-slice/58079934#58079934", "title": "Extract bits into a int slice from byte slice", "body": "<p>Using the <code>bits</code> package provides a fairly straightforward solution.</p>\n\n<pre><code>func bitsToBits(data []byte) (st []int) {\n    st = make([]int, len(data)*8) // Performance x 2 as no append occurs.\n    for i, d := range data {\n        for j := 0; j &lt; 8; j++ {\n            if bits.LeadingZeros8(d) == 0 {\n                // No leading 0 means that it is a 1\n                st[i*8+j] = 1\n            } else {\n                st[i*8+j] = 0\n            }\n            d = d &lt;&lt; 1\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>Performance is comparable to <a href=\"https://github.com/iWdGo/GoCompilerEfficiency/tree/master/src/bytetobits\" rel=\"nofollow noreferrer\">similar solutions</a>.</p>\n"}], "owner": {"reputation": 713, "user_id": 1508479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/K8WcV.jpg?s=128&g=1", "display_name": "Vinay", "link": "https://stackoverflow.com/users/1508479/vinay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1338, "favorite_count": 0, "accepted_answer_id": 52811969, "answer_count": 2, "score": 4, "last_activity_date": 1569326665, "creation_date": 1539588685, "last_edit_date": 1539613887, "question_id": 52811744, "link": "https://stackoverflow.com/questions/52811744/extract-bits-into-a-int-slice-from-byte-slice", "title": "Extract bits into a int slice from byte slice", "body": "<p>I have following byte slice which from which i need to extract bits and place them in a []int as i intend to fetch individual bit values later. I am having a hard time figuring out how to do that.</p>\n\n<p>below is my code</p>\n\n<pre><code>data := []byte{3 255}//binary representation is for 3 and 255 is 00000011 11111111\n</code></pre>\n\n<p>what i need is a slice of bits -- > <code>[0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1]</code></p>\n\n<p>What i tried </p>\n\n<ul>\n<li>I tried converting byte slice to Uint16 with BigEndian and then tried to use <code>strconv.FormatUint</code> but that fails  with error <code>panic: runtime error: index out of range</code></li>\n<li>Saw many examples that simple output bit representation of number using <code>fmt.Printf</code> function but that is not useful for me as i need a int slice for further bit value access.</li>\n</ul>\n\n<p>Do i need to use bit shift operators here ? Any help will be greatly appreciated.</p>\n"}, {"tags": ["go", "time"], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 10, "last_activity_date": 1582635422, "last_edit_date": 1582635422, "creation_date": 1539579559, "answer_id": 52809985, "question_id": 52809661, "link": "https://stackoverflow.com/questions/52809661/what-is-m-in-go-time-string/52809985#52809985", "title": "What is &quot;m=+&quot; in GO time string?", "body": "<p>The <code>m=\u00b1&lt;value&gt;</code> is <a href=\"https://golang.org/pkg/time/#hdr-Monotonic_Clocks\" rel=\"noreferrer\">monotonic clock</a> reading in second.</p>\n\n<p>Explanation from <a href=\"https://golang.org/pkg/time/#Time.String\" rel=\"noreferrer\"><code>time.Time.String</code> documentation</a>:</p>\n\n<blockquote>\n  <p>If the time has a monotonic clock reading, the returned string includes a final field \"m=\u00b1\", where value is the monotonic clock reading formatted as a decimal number of seconds.</p>\n</blockquote>\n\n<p>Afaik, golang doesn't provide layout for parsing monotonic clock, so <em>in my opinion</em> it's safe to remove it.</p>\n\n<pre><code>dateFormat := \"2006-01-02 15:04:05.999999999 -0700 MST\"\ndateString := \"2018-10-15 15:42:37.5989253 +1100 AEDT m=+3610.688917401\"\n\nt, err := time.Parse(dateFormat, strings.Split(dateString, \" m=\")[0])\nif err != nil {\n    fmt.Println(err)\n    os.Exit(0)\n}\n\nfmt.Println(t) // 2018-10-15 15:42:37.5989253 +1100 AEDT\n</code></pre>\n\n<p>Starting from <a href=\"https://golang.org/doc/go1.9#monotonic-time\" rel=\"noreferrer\">go 1.9</a>, calling <code>.String()</code> will generates date string output with monotonic clock in it. So I suggest try to use <code>.Format()</code> for normal usage instead of <code>.String()</code>. The monotonic clock info only useful for debugging purpose.</p>\n"}], "owner": {"reputation": 2586, "user_id": 3548468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U5OZO.png?s=128&g=1", "display_name": "kkesley", "link": "https://stackoverflow.com/users/3548468/kkesley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2774, "favorite_count": 1, "closed_date": 1539581239, "accepted_answer_id": 52809985, "answer_count": 1, "score": 6, "last_activity_date": 1582635422, "creation_date": 1539576772, "last_edit_date": 1539579377, "question_id": 52809661, "link": "https://stackoverflow.com/questions/52809661/what-is-m-in-go-time-string", "closed_reason": "Duplicate", "title": "What is &quot;m=+&quot; in GO time string?", "body": "<p>I'm experimenting with Google OAuth2 and I encountered this in the expiry time of my refresh token. It comes from  <code>2018-10-15 15:42:37.5989253 +1100 AEDT m=+3610.688917401</code></p>\n\n<p>I know it's a time format but I couldn't find any information about <code>m=+</code> anywhere. Is it used internally by Google? I tried to parse it with <code>time.RFC3339</code> but as you can guess, it ignores the <code>m=+</code>. It says</p>\n\n<blockquote>\n  <p>parsing time \"2018-10-15 15:42:37.5989253 +1100 AEDT\n  m=+3610.688917401\" as \"2006-01-02T15:04:05Z07:00\": cannot parse \"\n  15:42:37.5989253 +1100 AEDT m=+3610.688917401\" as \"T\"</p>\n</blockquote>\n\n<p>So what's this <code>m=+</code>  in the time string?</p>\n"}, {"tags": ["mysql", "go", "orm", "beego"], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 5, "last_activity_date": 1543027507, "last_edit_date": 1543027507, "creation_date": 1539567685, "answer_id": 52808701, "question_id": 52808454, "link": "https://stackoverflow.com/questions/52808454/beego-orm-mysql-default-addr-for-network-unknown/52808701#52808701", "title": "Beego ORM MySQL: default addr for network &#39;...&#39; unknown", "body": "<p>I checked on the <a href=\"https://github.com/go-sql-driver/mysql/blob/749ddf1598b47e3cd909414bda735fe790ef3d30/dsn.go#L86-L94\" rel=\"nofollow noreferrer\">go-mysql-driver source code, on file dsn.go:86</a>, the error only occurred when the network type is <code>\"\"</code>.</p>\n\n<p>You need to specify the selected network type on the connection string (whether it is <code>tcp</code> or <code>unix</code>). Use below connection string scheme instead of the one you are currently used.</p>\n\n<pre><code>&lt;username&gt;:&lt;password&gt;@&lt;network-type&gt;(&lt;host&gt;:&lt;port&gt;)/&lt;dbname&gt;\n</code></pre>\n\n<p>With your code, it would be like this:</p>\n\n<pre><code>connectionString := \"root:root@tcp(*******.aliyuncs.com:3308)/dbname\"\norm.RegisterDataBase(\"default\", \"mysql\", connectionString)\n</code></pre>\n\n<p>Note: network type <code>tcp</code> is chosen in example above.</p>\n"}], "owner": {"reputation": 33, "user_id": 10504753, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VprqaKe7h4A/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVvwfICboOE1bM3XMx9tk7vTESuyw/mo/photo.jpg?sz=128", "display_name": "\u5f20\u6587\u5065", "link": "https://stackoverflow.com/users/10504753/%e5%bc%a0%e6%96%87%e5%81%a5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 0, "accepted_answer_id": 52808701, "answer_count": 1, "score": 3, "last_activity_date": 1543027507, "creation_date": 1539565042, "last_edit_date": 1539568505, "question_id": 52808454, "link": "https://stackoverflow.com/questions/52808454/beego-orm-mysql-default-addr-for-network-unknown", "title": "Beego ORM MySQL: default addr for network &#39;...&#39; unknown", "body": "<p>My database link is a domain name instead of an IP address, and I don't use the ip address. Below is my configuration.</p>\n\n<pre><code>orm.RegisterDataBase(\"default\", \"mysql\", \"root:root@*******.aliyuncs.com:3308/dbname?charset=utf8\")\n</code></pre>\n\n<p>Error Message\uff1a</p>\n\n<blockquote>\n  <p>register db Ping <code>default</code>, default addr for network '***.mysql.rds.aliyuncs.com:3308' unknown\n  must have one register DataBase alias named <code>default</code></p>\n</blockquote>\n"}, {"tags": ["http", "go", "production-environment", "stability"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539621478, "post_id": 52808399, "comment_id": 92559310, "body": "Why do you need present the data as an <code>http.Response</code>?  Is it sufficient to provide status, headers written by the application and body as a []byte?"}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1539587317, "post_id": 52810532, "comment_id": 92540653, "body": "<code>httptest.ResponseRecorder</code> -- its purpose is to record responses. If you cannot rely on the &quot;to record responses&quot; for production use, how can you rely on it for testing then?"}, {"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1539592312, "post_id": 52810532, "comment_id": 92543077, "body": "You can&#39;t compare production and testing like that. In testing, <i>I</i> write the inputs, in production we must assume <i>anyone</i> (including malignant actors) can write the inputs."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1539593282, "post_id": 52810532, "comment_id": 92543614, "body": "I see that you added the security point, which I partially agree with. Yet I still fail to see how &quot;it&#39;s unreliable&quot; point makes any sense: it must be reliable, be it for test or production. &quot;All production usage of the package is disregarded by its authors&quot; --- any source for that?"}, {"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1539596396, "post_id": 52810532, "comment_id": 92545194, "body": "From <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">1</a>: &quot;&#91;the test package&#93; is intended to be used in concert with the &#39;go test&#39; command&quot;. I.e. it is the intention of the authors to be used in testing. I can moderate my answer, since that&#39;s strongly worded here."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1539603684, "post_id": 52810532, "comment_id": 92549132, "body": "But the test package is not the httptest package! And which part of the implementation could have security issues? The recorder uses a bytes.Buffer, so why is this an issue?"}, {"owner": {"reputation": 131, "user_id": 5560268, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156172418395543/picture?type=large", "display_name": "Loren Osborn", "link": "https://stackoverflow.com/users/5560268/loren-osborn"}, "edited": false, "score": 0, "creation_date": 1539605911, "post_id": 52810532, "comment_id": 92550435, "body": "This is definitely an angle I hadn\u2019t considered. I need to \u201csit with this answer a bit\u201d before marking it \u201caccepted\u201d, but this does sound like what my gut concern was. I think you captured it quite well. Thank you."}, {"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1539606572, "post_id": 52810532, "comment_id": 92550838, "body": "@apxp you&#39;re right. That&#39;s a bit confusing. Feel free to remove that from the answer. I am at the moment equating the test and httptest package."}], "tags": [], "owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "is_accepted": true, "score": 3, "last_activity_date": 1539596712, "last_edit_date": 1539596712, "creation_date": 1539583244, "answer_id": 52810532, "question_id": 52808399, "link": "https://stackoverflow.com/questions/52808399/should-i-avoid-using-net-http-httptest-in-production-code/52810532#52810532", "title": "Should I avoid using net/http/httptest in production code?", "body": "<p>You should not use this code in production. No matter what you are attempting to achieve.</p>\n\n<p><code>httptest.ResponseRecorder</code>'s ultimate purpose is to facilitate <em>testing</em>, and will thus always be extended, optimized\u2014<em>rewritten</em>\u2014with testing in mind. <em>Any</em> assumption can be made in this package, as long as it makes the package better at testing. The package authors intended for this to be \"used in concert with <code>go test</code>\"<a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">\u00b9</a>. I interpret that as discouraging production use, because they are then free to break e.g. your production usage in favor of <code>go test</code> usage.</p>\n\n<p>Another argument is that of security. The security model of any test package is going to be that the usage is trusted, whereas non-testing code will be the opposite.</p>\n\n<p>The world of software a perilous place. You are asking to make it even more perilous.</p>\n"}], "owner": {"reputation": 131, "user_id": 5560268, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156172418395543/picture?type=large", "display_name": "Loren Osborn", "link": "https://stackoverflow.com/users/5560268/loren-osborn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 52810532, "answer_count": 1, "score": 1, "last_activity_date": 1539596712, "creation_date": 1539564461, "last_edit_date": 1539581480, "question_id": 52808399, "link": "https://stackoverflow.com/questions/52808399/should-i-avoid-using-net-http-httptest-in-production-code", "title": "Should I avoid using net/http/httptest in production code?", "body": "<p>I like the ability to present a buffered <code>net/http.ResponseWriter</code> as a <code>net/http.Response</code> in some situations which <a href=\"https://golang.org/pkg/net/http/httptest/#ResponseRecorder\" rel=\"nofollow noreferrer\"><code>net/http/httptest.ResponseRecorder</code></a> would give me, but the package name makes me a bit concerned about using it in production code. I understand that it\u2019s intended to be used <strong>primarily</strong> for testing, but am unsure if I am asking for trouble using it in production code.</p>\n\n<p>Am I tempting fate?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1539592196, "post_id": 52807752, "comment_id": 92543013, "body": "Check out these questions for some guidance: <a href=\"https://stackoverflow.com/questions/33709033/golang-how-can-i-call-win32-api-without-cgo/33709631#33709631\">Golang: how can I call win32 API without cgo?</a>, and <a href=\"https://stackoverflow.com/questions/38646794/implement-a-global-hotkey-in-golang/38954281#38954281\">Implement a global hotkey in golang?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3793, "user_id": 2136970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0b3de472b291902c62f5e1b414bbe3?s=128&d=identicon&r=PG", "display_name": "Kevin Sandow", "link": "https://stackoverflow.com/users/2136970/kevin-sandow"}, "is_accepted": true, "score": 2, "last_activity_date": 1539596256, "creation_date": 1539596256, "answer_id": 52813778, "question_id": 52807752, "link": "https://stackoverflow.com/questions/52807752/load-windows-dlls-in-go/52813778#52813778", "title": "Load Windows DLLs in Go?", "body": "<p>Actually the link you have is a good reference.\nAll you need now is choose one of the implementations proposed.</p>\n\n<p>You can find the documentation for <code>kernel32.SetConsoleTextAtribute</code> here: <a href=\"https://docs.microsoft.com/en-us/windows/console/setconsoletextattribute\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/console/setconsoletextattribute</a></p>\n\n<p>The exposed API is defined as:</p>\n\n<pre><code>BOOL WINAPI SetConsoleTextAttribute(\n  _In_\u00a0HANDLE hConsoleOutput,\n  _In_\u00a0WORD \u00a0\u00a0wAttributes\n);\n</code></pre>\n\n<p>Example for the second option (using <code>syscall.NewProc</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"syscall\"\n)\n\nconst (\n    // defined base colors\n    ForegroundBlue      uint = 1\n    ForegroundGreen     uint = 2\n    ForegroundRed       uint = 4\n    ForegroundIntensity uint = 8\n    BackgroundBlue      uint = 16\n    BackgroundGreen     uint = 32\n    BackgroundRed       uint = 64\n    BackgroundIntensity uint = 128\n\n    // colors can also be mixed\n    ForegroundGrey = ForegroundBlue | ForegroundGreen | ForegroundRed\n    ForegroundWhite = ForegroundBlue | ForegroundGreen | ForegroundRed | ForegroundIntensity\n)\n\nfunc main() {\n    kernel32 := syscall.NewLazyDLL(\"kernel32.dll\")\n    setConsoleTextAttribute := kernel32.NewProc(\"SetConsoleTextAttribute\")\n    stdOutHandle := os.Stdout.Fd()\n\n    attributes := ForegroundWhite | BackgroundRed\n    ret, _, err := setConsoleTextAttribute.Call(stdOutHandle, uintptr(attributes))\n    if err != nil {\n        panic(err) // calling kernel32.SetConsoleTextAttribute failed\n    }\n\n    if ret == 0 {\n        print(\"Could not set the desired attributes\")\n        // TODO: call GetLastError to get more information\n    }\n\n    print(\"OK\")\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10481362"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 1, "accepted_answer_id": 52813778, "answer_count": 1, "score": 0, "last_activity_date": 1539596256, "creation_date": 1539557428, "last_edit_date": 1539558779, "question_id": 52807752, "link": "https://stackoverflow.com/questions/52807752/load-windows-dlls-in-go", "title": "Load Windows DLLs in Go?", "body": "<p>I need to use Windows DLLs in my applications, specificaly kernel32.dll.\nI only find this: <a href=\"https://github.com/golang/go/wiki/WindowsDLLs\" rel=\"nofollow noreferrer\">WindowsDLL</a> </p>\n\n<p>But that \"guide\" is not so intiuitive.</p>\n\n<p>For example, in Python you use ctypes. ej: <code>ctypes.windll.kernel32.SetConsoleTextAtribute(handle, color)</code></p>\n\n<p>How I can made the same thing but in Golang?</p>\n\n<p>Anyone can give some examples of that I want?</p>\n"}, {"tags": ["http", "authentication", "go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "edited": false, "score": 0, "creation_date": 1539563835, "post_id": 52808196, "comment_id": 92534747, "body": "Excellent @ThunderCat, sending both requests to the same endpoint was my suspicion, but your articulation of the the issue makes it clear why this won&#39;t work the way I had it. I will try your solution and mark accepted once validated. Thank you!"}, {"owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "edited": false, "score": 0, "creation_date": 1539577895, "post_id": 52808196, "comment_id": 92537490, "body": "This solution worked for me, accepting answer. For anyone who stumbles across this, there is a minor typo. The http header declaration should be: <code>http.Header{&quot;X-Api-Key&quot;: []string{&quot;test_api_key&quot;}}</code>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 8, "last_activity_date": 1539577959, "last_edit_date": 1539577959, "creation_date": 1539562236, "answer_id": 52808196, "question_id": 52807735, "link": "https://stackoverflow.com/questions/52807735/authenticating-websocket-connections-via-http-middleware-golang/52808196#52808196", "title": "Authenticating WebSocket Connections via HTTP Middleware - Golang", "body": "<p>The client application in the question sends two requests to the websocket endpoint.  The first is a an authenticated HTTP request. This request fails to upgrade because it's not a websocket handshake.  The second request is an unauthenticated websocket handshake. This request fails because it fails to authenticate.</p>\n\n<p>The fix is to send an authenticated websocket handshake. Pass the auth headers through the last argument to Dial.</p>\n\n<pre><code>func main() {\n    u := url.URL{Scheme: \"ws\", Host: \"localhost:8080\", Path: \"/ws\"}\n    conn, _, err := websocket.DefaultDialer.Dial(u.String(), http.Header{\"X-Api-Key\": []string{\"test_api_key\"}})\n    if err != nil {\n        log.Fatalf(\"dial err: %v\", err)\n    }\n    err = conn.WriteMessage(websocket.TextMessage, []byte(\"hellow websockets\"))\n    if err != nil {\n        log.Fatalf(\"msg err: %v\", err)\n    }\n}\n</code></pre>\n\n<p>On the server, authenticate the handshake using the application's code for authenticating HTTP requests.</p>\n"}], "owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4870, "favorite_count": 5, "accepted_answer_id": 52808196, "answer_count": 1, "score": 4, "last_activity_date": 1539577959, "creation_date": 1539557261, "question_id": 52807735, "link": "https://stackoverflow.com/questions/52807735/authenticating-websocket-connections-via-http-middleware-golang", "title": "Authenticating WebSocket Connections via HTTP Middleware - Golang", "body": "<p><strong>Problem Statement:</strong></p>\n\n<p>I am attempting to protect a websocket upgrader http endpoint using basic middleware in Golang, as <a href=\"https://devcenter.heroku.com/articles/websocket-security\" rel=\"nofollow noreferrer\">the WebSocket protocol doesn\u2019t handle authorization or authentication</a>.</p>\n\n<p><strong>Community Suggestions</strong></p>\n\n<ol>\n<li>Some have suggested, albeit vaguely \"I recommend authenticating the upgrade handshake using the application's code for authenticating HTTP requests.\"</li>\n<li>Still others suggest \"after connected, client need to send username &amp; password which need to be checked by server. If not match, close the connection\", but this seems non-idiomatic.</li>\n</ol>\n\n<p><strong>Strategy:</strong></p>\n\n<p>My failed strategy so far is attempting community strategy 1 above to secure upgrading the connection with a custom header <code>X-Api-Key</code> via middleware, and only upgrade clients who initiate the conversation with a matching key.</p>\n\n<p>The code below results in <code>the client is not using the websocket protocol: 'upgrade' token not found in 'Connection' header</code> on the server side.</p>\n\n<p><strong>The Ask:</strong></p>\n\n<p>I would like to ask for help with understanding:</p>\n\n<ul>\n<li>If my take on strategy 1 is flawed, how might I improve it? It seems like that by sending the initial auth <code>GET</code> via http, that the subsequent upgrade request via scheme <code>ws</code> is rejected by the server.</li>\n<li>If strategy 2 is feasible, how might this be implemented?</li>\n</ul>\n\n<p>Thoughts and suggestions, examples, gists appreciated, and if I can clarify further or restate please advise.</p>\n\n<p>server.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/websocket\"\n)\n\nfunc main() {\n    var addr = flag.String(\"addr\", \"localhost:8080\", \"http service address\")\n    flag.Parse()\n\n    http.Handle(\"/ws\", Middleware(\n        http.HandlerFunc(wsHandler),\n        authMiddleware,\n    ))\n    log.Printf(\"listening on %v\", *addr)\n    log.Fatal(http.ListenAndServe(*addr, nil))\n}\n\nfunc Middleware(h http.Handler, middleware ...func(http.Handler) http.Handler) http.Handler {\n    for _, mw := range middleware {\n        h = mw(h)\n    }\n    return h\n}\n\nvar upgrader = websocket.Upgrader{\n    ReadBufferSize:  1024,\n    WriteBufferSize: 1024,\n}\n\nfunc wsHandler(rw http.ResponseWriter, req *http.Request) {\n    wsConn, err := upgrader.Upgrade(rw, req, nil)\n    if err != nil {\n        log.Printf(\"upgrade err: %v\", err)\n        return\n    }\n    defer wsConn.Close()\n\n    for {\n        _, message, err := wsConn.ReadMessage()\n        if err != nil {\n            log.Printf(\"read err: %v\", err)\n            break\n        }\n        log.Printf(\"recv: %s\", message)\n    }\n}\n\nfunc authMiddleware(next http.Handler) http.Handler {\n    TestApiKey := \"test_api_key\"\n    return http.HandlerFunc(func(rw http.ResponseWriter, req *http.Request) {\n        var apiKey string\n        if apiKey = req.Header.Get(\"X-Api-Key\"); apiKey != TestApiKey {\n            log.Printf(\"bad auth api key: %s\", apiKey)\n            rw.WriteHeader(http.StatusForbidden)\n            return\n        }\n        next.ServeHTTP(rw, req)\n    })\n}\n</code></pre>\n\n<p>client.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n\n    \"github.com/gorilla/websocket\"\n)\n\nfunc main() {\n    // auth first\n    req, err := http.NewRequest(\"GET\", \"http://localhost:8080/ws\", nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.Header.Set(\"X-Api-Key\", \"test_api_key\")\n\n    resp, err := http.DefaultClient.Do(req)\n    if err != nil || resp.StatusCode != http.StatusOK {\n        log.Fatalf(\"auth err: %v\", err)\n    }\n    defer resp.Body.Close()\n\n    // create ws conn\n    u := url.URL{Scheme: \"ws\", Host: \"localhost:8080\", Path: \"/ws\"}\n    u.RequestURI()\n    fmt.Printf(\"ws url: %s\", u.String())\n    log.Printf(\"connecting to %s\", u.String())\n\n    conn, _, err := websocket.DefaultDialer.Dial(u.String(), nil)\n    if err != nil {\n        log.Fatalf(\"dial err: %v\", err)\n    }\n\n    err = conn.WriteMessage(websocket.TextMessage, []byte(\"hellow websockets\"))\n    if err != nil {\n        log.Fatalf(\"msg err: %v\", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["git", "go", "glide-golang"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539559284, "post_id": 52807674, "comment_id": 92533954, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49433624/how-to-install-private-repo-using-glide-golang\">how to install private repo using glide golang</a>"}, {"owner": {"reputation": 948, "user_id": 1715913, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b89674fac7de835c2e0d821b67531d85?s=128&d=identicon&r=PG", "display_name": "Kilise", "link": "https://stackoverflow.com/users/1715913/kilise"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539559483, "post_id": 52807674, "comment_id": 92533990, "body": "@xpare I&#39;ve read that, it is somehow related but still doesn&#39;t solve the issue. If it should solve it, maybe a better answer is needed."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539560371, "post_id": 52807674, "comment_id": 92534134, "body": "do you get any error?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539560918, "post_id": 52807674, "comment_id": 92534229, "body": "how about this <a href=\"https://medium.com/@dcrichards/go-dep-with-private-bitbucket-9649e0b2b153\" rel=\"nofollow noreferrer\">medium.com/@dcrichards/&hellip;</a> actually if you google there are lot of solutions available for this kind of problem"}], "owner": {"reputation": 948, "user_id": 1715913, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b89674fac7de835c2e0d821b67531d85?s=128&d=identicon&r=PG", "display_name": "Kilise", "link": "https://stackoverflow.com/users/1715913/kilise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553435993, "creation_date": 1539556768, "last_edit_date": 1553435993, "question_id": 52807674, "link": "https://stackoverflow.com/questions/52807674/how-to-configure-glide-yaml-to-access-a-private-bitbucket-repo", "title": "How to configure glide.yaml to access a private bitbucket repo?", "body": "<p>In my glide.yaml file I am trying to specify some of the repostories my GoLang project is using. But I am struggeling to make it install/update my private bitbucket repostories.</p>\n\n<p>At the moment it looks like this:</p>\n\n<pre><code>import:\n- package: bitbucket.org/*****/go-repo\n  repo: https://*****@bitbucket.org/*****/go-repo.git\n  vcs:  git\n</code></pre>\n\n<p>So my question is, how do I configure glide.yaml to access a private bitbucket repo?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1539556645, "post_id": 52807520, "comment_id": 92533475, "body": "Asking for 3rd party libs is off-topic for StackOverflow, but what you&#39;re looking for is in Go&#39;s standard lib itself. Check out the <a href=\"https://golang.org/pkg/go/parser/\" rel=\"nofollow noreferrer\"><code>go&#47;parser</code></a> and <a href=\"https://golang.org/pkg/go/ast/\" rel=\"nofollow noreferrer\"><code>go&#47;ast</code></a> packages (as a starting point)."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 5560268, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156172418395543/picture?type=large", "display_name": "Loren Osborn", "link": "https://stackoverflow.com/users/5560268/loren-osborn"}, "is_accepted": false, "score": 0, "last_activity_date": 1593329851, "last_edit_date": 1593329851, "creation_date": 1539566369, "answer_id": 52808586, "question_id": 52807520, "link": "https://stackoverflow.com/questions/52807520/is-there-a-golang-library-for-parsing-go-sources-and-returning-a-stdlibs-identi/52808586#52808586", "title": "Is there a Golang library for parsing go sources and returning a stdlib&#39;s identifier list?", "body": "<p>(I just randomly was looking over old stuff I touched and saw this question again. I think I read the question very differently this time.)</p>\n<p>I think this question is based on the false premise that Go\u2019s standard library is communicating with the OS via C\u2019s <code>stdlib</code> as most other programs do. With the exception of the optional CGo library, Go binaries do not generally link to C libraries, either statically (via .a files) or dynamically, via a .so or .dll. Go\u2019s standard library communicates with the OS kernel via system calls implemented with interrupts and the like. There are no stdlib symbols because Go\u2019s standard library doesn\u2019t call C\u2019s stdlib.</p>\n<p><strong>Original answer from Oct-2018:</strong> I\u2019m not sure what you want to do specifically, but generally a list of tokens isn\u2019t particularly useful. Generally you want to look at walking an AST (Abstract Syntax Tree) which gives you most of the same information within a more meaningful context. For this you probably want to look at the <code>go/ast</code> and <code>go/parser</code> standard library packages should give you most of what you want.</p>\n"}], "owner": {"reputation": 465, "user_id": 1936173, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/8uQ1j.png?s=128&g=1", "display_name": "Illia Danko", "link": "https://stackoverflow.com/users/1936173/illia-danko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1593329851, "creation_date": 1539555079, "question_id": 52807520, "link": "https://stackoverflow.com/questions/52807520/is-there-a-golang-library-for-parsing-go-sources-and-returning-a-stdlibs-identi", "title": "Is there a Golang library for parsing go sources and returning a stdlib&#39;s identifier list?", "body": "<p>I'm looking for a library that should parse a go source code and returns the list of identifies related to the Go's standard library. For instance, after processing the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/signal\"\n    \"syscall\"\n)\n\nfunc main() {\n    c := make(chan os.Signal, 1)\n    signal.Notify(c, syscall.SIGINT, syscall.SIGUSR2)\n}\n</code></pre>\n\n<p>the output should resemble something like:\n<code>os: Signal: 1\nos/signal: Notify: 1\nsyscall: SIGINT: 1, SIGUSR2: 1</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "edited": false, "score": 1, "creation_date": 1539548877, "post_id": 52806628, "comment_id": 92531800, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25025409/delete-element-in-a-slice\">Delete element in a slice</a>"}, {"owner": {"reputation": 13757, "user_id": 1270003, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d5ed9123b92a6e4dffa75f9f6dd9e382?s=128&d=identicon&r=PG&f=1", "display_name": "texasbruce", "link": "https://stackoverflow.com/users/1270003/texasbruce"}, "edited": false, "score": 0, "creation_date": 1539550440, "post_id": 52806628, "comment_id": 92532131, "body": "If you need O(1) for both lookup and deleting/inserting, consider a map like <code>map[int]int</code>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 6, "last_activity_date": 1539555996, "last_edit_date": 1539555996, "creation_date": 1539548218, "answer_id": 52806726, "question_id": 52806628, "link": "https://stackoverflow.com/questions/52806628/remove-item-from-slice/52806726#52806726", "title": "Remove item from slice", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := []int{1, 2, 3, 4, 5, 6}\n    fmt.Println(s)\n    i := 3\n    fmt.Println(i)\n    s = append(s[:i], s[i+1:]...)\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/SVQEUE7Rrei\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SVQEUE7Rrei</a></p>\n\n<p>Output:</p>\n\n<pre><code>[1 2 3 4 5 6]\n3\n[1 2 3 5 6]\n</code></pre>\n\n<hr>\n\n<p>Or, if order is not important,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := []int{1, 2, 3, 4, 5, 6}\n    fmt.Println(s)\n    i := 3\n    fmt.Println(i)\n    s[i] = s[len(s)-1]\n    s = s[:len(s)-1]\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/lVgKew3ZJNF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/lVgKew3ZJNF</a></p>\n\n<p>Output:</p>\n\n<pre><code>[1 2 3 4 5 6]\n3\n[1 2 3 6 5]\n</code></pre>\n\n<hr>\n\n<p>For several other ways, see <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">SliceTricks</a>.</p>\n"}], "owner": {"reputation": 835, "user_id": 1105727, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Ys5Bh.jpg?s=128&g=1", "display_name": "Charles Bryant", "link": "https://stackoverflow.com/users/1105727/charles-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1539555996, "creation_date": 1539547546, "last_edit_date": 1539548841, "question_id": 52806628, "link": "https://stackoverflow.com/questions/52806628/remove-item-from-slice", "title": "Remove item from slice", "body": "<p>I was having some issues with Golang slices.</p>\n\n<p>I understand that a slice is a pointer to an underlying array, but some of the behaviour feels a little odd.</p>\n\n<p>I was trying to remove an item from a slice I managed to do it by copying the slice is there a better way?</p>\n\n<p>In the code below the original slice is changed.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    mySlice := []int{1,2,3,4,5,6}\n    pos := 3\n\n    slicePart1 := mySlice[:pos+1]\n    slicePart2 := mySlice[pos+2:]\n\n    fmt.Println(mySlice)\n    fmt.Println(slicePart1)\n    fmt.Println(slicePart2)\n    new := append(slicePart1,slicePart2...)\n    fmt.Println(new)\n    fmt.Println(mySlice)\n}\n</code></pre>\n"}, {"tags": ["email", "go", "smtp"], "comments": [{"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "edited": false, "score": 0, "creation_date": 1539541318, "post_id": 52804824, "comment_id": 92529847, "body": "Interesting. I couldn&#39;t find anything about it. But I wonder if the underlying conn can be consumed."}, {"owner": {"reputation": 141, "user_id": 7388072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oti0y.jpg?s=128&g=1", "display_name": "hoenir", "link": "https://stackoverflow.com/users/7388072/hoenir"}, "edited": false, "score": 0, "creation_date": 1539553940, "post_id": 52804824, "comment_id": 92532977, "body": "I have a suggestion. If you look closely the <a href=\"https://golang.org/pkg/net/smtp/#Client\" rel=\"nofollow noreferrer\">Client</a> has an exported field named <code>Text</code>. The <code>Text</code> type contains one important <a href=\"https://golang.org/pkg/net/textproto/#Conn\" rel=\"nofollow noreferrer\">embedded</a> type name <code>Reader</code> and you can actually read the response with <a href=\"https://golang.org/pkg/net/textproto/#Reader.ReadResponse\" rel=\"nofollow noreferrer\">it</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1047, "user_id": 1191999, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8a5575da1a4d6205f568754e55294cfb?s=128&d=identicon&r=PG", "display_name": "Ram", "link": "https://stackoverflow.com/users/1191999/ram"}, "edited": false, "score": 0, "creation_date": 1539613259, "post_id": 52814186, "comment_id": 92555041, "body": "No that does work   This is what I tried   \t_, message, err := c.Text.ReadResponse(0) \tfmt.Printf(&quot;Response = %s\\n&quot;, message)   // hangs for ever"}, {"owner": {"reputation": 1047, "user_id": 1191999, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8a5575da1a4d6205f568754e55294cfb?s=128&d=identicon&r=PG", "display_name": "Ram", "link": "https://stackoverflow.com/users/1191999/ram"}, "edited": false, "score": 0, "creation_date": 1539618483, "post_id": 52814186, "comment_id": 92557953, "body": "After going through the library I realized.  The underlying net/smtp module implements the Close to throwaway the DSN   Is there some other library I can use"}], "tags": [], "owner": {"reputation": 3793, "user_id": 2136970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0b3de472b291902c62f5e1b414bbe3?s=128&d=identicon&r=PG", "display_name": "Kevin Sandow", "link": "https://stackoverflow.com/users/2136970/kevin-sandow"}, "is_accepted": false, "score": 3, "last_activity_date": 1539597584, "creation_date": 1539597584, "answer_id": 52814186, "question_id": 52804824, "link": "https://stackoverflow.com/questions/52804824/golang-net-smtp-getting-smtp-server-response-dsn/52814186#52814186", "title": "golang net/smtp getting smtp server response DSN", "body": "<p>As mentioned in the comments you can use <code>c.Text.ReadResponse()</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/smtp\"\n)\n\nfunc sendEmail(msg []byte) (code int, message string, err error) {\n    c, err := smtp.Dial(\"localhost:25\")\n    if err != nil {\n        return\n    }\n    defer c.Quit() // make sure to quit the Client\n\n    if err = c.Mail(\"sender@example.org\"); err != nil {\n        return\n    }\n\n    if err = c.Rcpt(\"recipient@example.net\"); err != nil {\n        return\n    }\n\n    wc, err := c.Data()\n    if err != nil {\n        return\n    }\n    defer wc.Close() // make sure WriterCloser gets closed\n\n    _, err = wc.Write(msg)\n    if err != nil {\n        return\n    }\n\n    code, message, err = c.Text.ReadResponse(0)\n    return\n}\n</code></pre>\n\n<hr>\n\n<p>The <code>code</code>, <code>message</code> and any <code>err</code> are now passed to the caller, don't use <code>log.Fatal</code> throughout your code, handle the error on the calling side.</p>\n"}], "owner": {"reputation": 1047, "user_id": 1191999, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8a5575da1a4d6205f568754e55294cfb?s=128&d=identicon&r=PG", "display_name": "Ram", "link": "https://stackoverflow.com/users/1191999/ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 2, "answer_count": 1, "score": 6, "last_activity_date": 1539828885, "creation_date": 1539534956, "last_edit_date": 1539596496, "question_id": 52804824, "link": "https://stackoverflow.com/questions/52804824/golang-net-smtp-getting-smtp-server-response-dsn", "title": "golang net/smtp getting smtp server response DSN", "body": "<p>I am using golang net/smtp to send mails </p>\n\n<p>Whenever I send to my smtp server I need to capture the response from the server \nEspecially the DSN </p>\n\n<p>For example my local smtp server gives a \"ok queued as \"  at the end of the mail </p>\n\n<p>I need to capture this and print in the logs </p>\n\n<p>How can I do this </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/smtp\"\n)\n\nfunc sendEmail(msg []byte) {\n    c, err := smtp.Dial(\"localhost:25\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    if err := c.Mail(\"sender@example.org\"); err != nil {\n        log.Fatal(err)\n    }\n\n    if err := c.Rcpt(\"recipient@example.net\"); err != nil {\n        log.Fatal(err)\n    }\n    wc, err := c.Data()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    _, err = wc.Write(msg)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    //How do I get the response here ??\n    err = wc.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err = c.Quit()\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["arrays", "go"], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 7388072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oti0y.jpg?s=128&g=1", "display_name": "hoenir", "link": "https://stackoverflow.com/users/7388072/hoenir"}, "is_accepted": false, "score": 1, "last_activity_date": 1539537296, "last_edit_date": 1539537296, "creation_date": 1539536827, "answer_id": 52805071, "question_id": 52804600, "link": "https://stackoverflow.com/questions/52804600/receiving-any-array-type-in-function-arguments/52805071#52805071", "title": "Receiving any array type in function arguments", "body": "<blockquote>\n  <p>Can I turn this function to be able to receive an array that has strings in it or any other types?\n  Also, can I set to return that same type at the end? I</p>\n</blockquote>\n\n<p>Unfortunately the Go programming language does not have generics. AFAIK Go will have generics in the next 2.0 release so right now you mainly have 3 maybe 4 options.</p>\n\n<h2>1. Using the <code>[]interface{}</code> type</h2>\n\n<p>Your function declaration will look something like this.</p>\n\n<pre><code>func chunks(a []interface{}, size int) [][]interface{}\n</code></pre>\n\n<p>Using this approach will imply some <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">type assertion</a>.</p>\n\n<h2>2. Using the <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflect</a> package</h2>\n\n<p>The definition will look the same but this time in your implementation, instead of using the type assertion technique you will use the reflect package to determine your type and retrieve values. Remember you will <a href=\"http://www.jerf.org/iri/post/2945\" rel=\"nofollow noreferrer\">pay a reasonable cost</a> using this approach.</p>\n\n<h2>3. Using some unsafe.Pointer magic.</h2>\n\n<p>You could use this generic pointer type and do some pointer arithmetic in a C spirit way. </p>\n\n<pre><code>func chunks(a unsafe.Pointer, len uintptr, size uintptr) unsafe.Pointer\n</code></pre>\n\n<p>I know if you search Go does not <strong><em>oficially</em></strong> support doing pointer arithmetic but you can <strong><em>fake</em></strong> it using tricks like.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"unsafe\"\n\nfunc main() {\n    vals := []int{10, 20, 30, 40}\n    start := unsafe.Pointer(&amp;vals[0])\n    size := unsafe.Sizeof(int(0))\n    for i := 0; i &lt; len(vals); i++ {\n        item := *(*int)(unsafe.Pointer(uintptr(start) + size*uintptr(i)))\n        fmt.Println(item)\n    }\n}\n</code></pre>\n\n<h2>4. Try using <a href=\"https://golang.org/pkg/cmd/go/internal/generate/\" rel=\"nofollow noreferrer\">go generate</a> in your building phase</h2>\n\n<p>You can find <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">more information</a> on how to generate go code base on what types you provide.</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 9437981, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204316850116913/picture?type=large", "display_name": "Vlada", "link": "https://stackoverflow.com/users/9437981/vlada"}, "edited": false, "score": 1, "creation_date": 1539542881, "post_id": 52805073, "comment_id": 92530304, "body": "I liked this solution and the reference to the <code>reflect</code> package. I will definitely look into it. Somehow I have a feeling that to do any useful stuff with arrays, there is a huge ceremony around it. This problem would be one example. Can you tell me, is there some package that has all those array methods in them so I would not have to reinvent the wheel every time I operate on arrays?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 145, "user_id": 9437981, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204316850116913/picture?type=large", "display_name": "Vlada", "link": "https://stackoverflow.com/users/9437981/vlada"}, "edited": false, "score": 1, "creation_date": 1539564319, "post_id": 52805073, "comment_id": 92534843, "body": "The <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">Slice Tricks</a> wiki page shows how to perform many common slice operations in one or two lines of Go code.  I don&#39;t know of a library that provides chunking as in this question."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1539538940, "last_edit_date": 1539538940, "creation_date": 1539536835, "answer_id": 52805073, "question_id": 52804600, "link": "https://stackoverflow.com/questions/52804600/receiving-any-array-type-in-function-arguments/52805073#52805073", "title": "Receiving any array type in function arguments", "body": "<p>Because Go does not yet have the generics, the options are to use reflection or to duplicate code for each type.  Here's how to use the <a href=\"https://godoc.org/reflect\" rel=\"nofollow noreferrer\">reflect</a> package:</p>\n\n<pre><code>// chunkAny slices a into size chunks and puts result in cp. \n// The variable cp must be pointer to slice of a's type.\nfunc chunkAny(a interface{}, size int, cp interface{}) {\n    av := reflect.ValueOf(a)\n    cv := reflect.ValueOf(cp).Elem()\n    cv.SetLen(0) // reset length in case backing array allocated\n    i, j := 0, size\n    for j &lt; av.Len() {\n        cv.Set(reflect.Append(cv, av.Slice(i, j)))\n        i += size\n        j += size\n    }\n    cv.Set(reflect.Append(cv, av.Slice(i, av.Len())))\n}\n</code></pre>\n\n<p>Call the function like this:</p>\n\n<pre><code>a := []string{\"a\", \"b\", \"c\", \"d\"}\nvar b [][]string\nchunkAny(a, 3, &amp;b)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ozNp8diySkJ\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}], "owner": {"reputation": 145, "user_id": 9437981, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204316850116913/picture?type=large", "display_name": "Vlada", "link": "https://stackoverflow.com/users/9437981/vlada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1539539703, "creation_date": 1539533390, "last_edit_date": 1539539703, "question_id": 52804600, "link": "https://stackoverflow.com/questions/52804600/receiving-any-array-type-in-function-arguments", "title": "Receiving any array type in function arguments", "body": "<p>I just started playing with Go. I started creating a function that accepts an array of integers and returning the chunks of that array. To see what I mean, here is that program:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    a:= []int{1,2,3,4,5,6,2, 231, 521,21, 51}\n\n    c:=chunks(a[:], 3)\n    fmt.Println(c) // [[1 2 3] [4 5 6] [2 231 521] [51]]\n}\n\nfunc chunks(a []int, size int) [][]int{\n    var f float64 = float64(len(a)) / float64(size)\n    size_of_wrapper := int(math.Ceil(f))\n    i := 0\n    j := 0\n    twoD := make([][]int, size_of_wrapper )\n\n    for i &lt; len(a) {\n        if i + size &lt; len(a) {\n            twoD[j] = make([]int, size)\n            twoD[j] = append(a[i:i+size])\n            i = i + size\n            j++\n        } else {\n                if i + size == len(a){\n                i++\n            } else {\n                twoD[j] = make([]int, 1)\n                    twoD[j] = append(a[len(a)-1:])\n                i++\n            }\n\n        }\n    }\n\n    return twoD \n}\n</code></pre>\n\n<p>Now, I have a question. Can I turn this function to be able to receive an array that has strings in it or any other types? Also, can I set to return that same type at the end? In this case, I return an array of arrays that contain only integer values.</p>\n\n<p>I seem to really struggle to find the solution to this problem. One of the posts that I have read recommended to use interface type for this kind of job. Is that the only one? </p>\n"}, {"tags": ["arrays", "go"], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1539535718, "last_edit_date": 1539535718, "creation_date": 1539534420, "answer_id": 52804747, "question_id": 52804595, "link": "https://stackoverflow.com/questions/52804595/neater-way-of-storing-space-separated-ints-into-an-array-in-go/52804747#52804747", "title": "Neater way of storing space separated ints into an array in go?", "body": "<p>You can go for <code>bufio.NewScanner</code> to scan the whole line. The default split function is ScanLines. </p>\n\n<blockquote>\n  <p>NewScanner returns a new Scanner to read from r. The split function\n  defaults to ScanLines.</p>\n</blockquote>\n\n<pre><code>func (s *Scanner) Text() string\n</code></pre>\n\n<blockquote>\n  <p>Text returns the most recent token generated by a call to Scan as a\n  newly allocated string holding its bytes</p>\n</blockquote>\n\n<p>Parse the string value one by one to convert the string into integer values, append the data to the slice of integers. Now process the data in the way you want. </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n\n    data := make([]int, 0)\n    scanner := bufio.NewScanner(os.Stdin)\n    counter := 0\n    for scanner.Scan() {\n        output := strings.Split(scanner.Text(), \" \")\n        for _, value := range output {\n            i, err := strconv.Atoi(value)\n            if err != nil {\n                fmt.Println(err)\n            }\n            data = append(data, i)\n        }\n        counter++\n    }\n\n    if err := scanner.Err(); err != nil {\n        fmt.Fprintln(os.Stdout, \"reading standard input:\", err)\n    }\n\n    fmt.Println(\"the data from terminal: \", data)\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10503219, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--_r4_-iR3Xo/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU89sGJSpOpfltVrb2hmPwNPkENuQ/mo/photo.jpg?sz=128", "display_name": "Henry Wilkinson", "link": "https://stackoverflow.com/users/10503219/henry-wilkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 52804747, "answer_count": 1, "score": 1, "last_activity_date": 1539535718, "creation_date": 1539533342, "question_id": 52804595, "link": "https://stackoverflow.com/questions/52804595/neater-way-of-storing-space-separated-ints-into-an-array-in-go", "title": "Neater way of storing space separated ints into an array in go?", "body": "<p>I've only just started using go so sorry in advance if any of my questions are very obvious but I've spent a long time looking for answers online and couldn't find what I was looking for.</p>\n\n<p>I want to read a line of space separated int values and store them into an array. The number of values will be known before they are input but I'm fairly sure there must be a more simple or neat way of writing it than this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main()  {\n    var array[5] int\n    fmt.Scanf(\"%d %d %d %d %d\", &amp;array[0], &amp;array[1], &amp;array[2], &amp;array[3], &amp;array[4])\n    fmt.Printf(\"%v\", array)\n\n}\n</code></pre>\n\n<p>I also need to make it so that the number of values can be changed (to up to 50) and they should still be stored in the array. I wrote a simple function to make the scanf function read the right amount of numbers but without writing out each array element all the way out to &amp;array[49] I couldn't find a work around. <strong>Is there an easier way of storing all the values without having a really long list of array locations?</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main()  {\n    var length int\n    fmt.Scanf(\"%d\", &amp;length)\n    var array[50] int\n    fmt.Scanf(scanFormat(length), &amp;array[0], &amp;array[1], &amp;array[2]) //etc.\n    fmt.Printf(\"%v\", array)\n\n}\nfunc scanFormat (N int) string{\n    if N==0 {\n        return \"\"\n    }\n    return \"%d \"+scanFormat(N-1)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1539533497, "post_id": 52803727, "comment_id": 92527550, "body": "Show the code for sender3. The receive branch in the select statement receives two values, but only prints one."}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1539536106, "last_edit_date": 1539536106, "creation_date": 1539528118, "answer_id": 52803805, "question_id": 52803727, "link": "https://stackoverflow.com/questions/52803727/how-to-read-from-a-single-channel-shared-by-multiple-goroutines/52803805#52803805", "title": "How to read from a single channel shared by multiple goroutines", "body": "<p>The code will return with an error if you not create buffer channels reason being the channel is closed before all the values sent on it.</p>\n\n<p>Do not close the channels and wait for the go routines to complete. If you want to close the channels, close when all the values send on the channel are received inside the receiver go routine.</p>\n\n<pre><code>fmt.Println(\"testAsyncFunc2\")\nfor  i :=0; i &lt; 10; i++  {\n    wg.Add(1)\n    go sender3(ch, i)\n}\n\nreceiver3(ch)\nclose(ch) // this will close the channels before all the values sent on it will be received.\nwg.Wait()\n</code></pre>\n\n<p>One more thing to notice you have increased wait group counter to 10 while you are decreasing the counter after you launch the go routine inside the for loop which is wrong. You should decrease the wait group counter inside the sender go routine when it is finished its execution.</p>\n\n<pre><code>func sender(ch chan int, int){\n     defer wg.Done()\n}\n</code></pre>\n\n<p>In the for loop the select default condition will run before all the values sent on the channel is received that's why all values send will not print. Since the loop will return when there is no value send on the channel.</p>\n\n<pre><code>func receiver3(ch chan int) {\n    for {\n        select {\n        case &lt;-ch:\n            fmt.Println(&lt;-ch)\n        default: // this condition will run when value is not available on the channel.\n            fmt.Println(\"Done...\")\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>Create a go routine to close the channel and wait for the sender go routines to finish. So below code will wait for your all go routines to finish sending the values on channels and then it will close the channel:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    ch := make(chan int)\n    fmt.Println(\"testAsyncFunc2\")\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go sender(ch, i)\n    }\n    receiver3(ch)\n    go func() {\n        defer close(ch)\n        wg.Wait()\n    }()\n}\n\nfunc receiver3(ch &lt;-chan int) {\n    for i := 0; i &lt; 10; i++ {\n        select {\n        case value, ok := &lt;-ch:\n            if !ok {\n                ch = nil\n            }\n            fmt.Println(value)\n        }\n        if ch == nil {\n            break\n        }\n    }\n}\n\nfunc sender(ch chan int, i int) {\n    defer wg.Done()\n    ch &lt;- i\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>testAsyncFunc2\n9\n0\n1\n2\n3\n4\n5\n6\n7\n8\n</code></pre>\n\n<p>Working Code on <a href=\"https://play.golang.org/p/8_C-Tb8Q7ES\" rel=\"nofollow noreferrer\">Go playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 3, "last_activity_date": 1539528376, "creation_date": 1539528376, "answer_id": 52803839, "question_id": 52803727, "link": "https://stackoverflow.com/questions/52803727/how-to-read-from-a-single-channel-shared-by-multiple-goroutines/52803839#52803839", "title": "How to read from a single channel shared by multiple goroutines", "body": "<p>Select Default does not work the way that you think it does. If a select block has a default case it will select it <strong>immediately</strong> if none of the other cases are ready to read.</p>\n\n<p>That means your receiver3 is very likely to hit its default case.</p>\n"}], "owner": {"reputation": 6124, "user_id": 5627983, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/696f780ea286896dd41a92459152fbb3?s=128&d=identicon&r=PG&f=1", "display_name": "s952163", "link": "https://stackoverflow.com/users/5627983/s952163"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 0, "accepted_answer_id": 52803805, "answer_count": 2, "score": 4, "last_activity_date": 1539561293, "creation_date": 1539527665, "last_edit_date": 1539561293, "question_id": 52803727, "link": "https://stackoverflow.com/questions/52803727/how-to-read-from-a-single-channel-shared-by-multiple-goroutines", "title": "How to read from a single channel shared by multiple goroutines", "body": "<p>I have several goroutines writing to the same channel. If I use a buffered channel I can retrieve the input. However if use an unbuffered channel I can only read about half the values:</p>\n\n<pre><code>func testAsyncFunc2() {\n\n    ch := make(chan int,10)\n\n    fmt.Println(\"testAsyncFunc2\")\n    wg.Add(10)\n    for  i :=0; i &lt; 10; i++  {\n        go sender3(ch, i)\n        wg.Done()\n    }\n\n    receiver3(ch)\n\n    close(ch)\n    wg.Wait()\n}\n</code></pre>\n\n<p>This is the receiver function:</p>\n\n<pre><code>func receiver3(ch chan int) {\n    for {\n        select {\n        case &lt;-ch:\n            fmt.Println(&lt;-ch)\n        default:\n            fmt.Println(\"Done...\")\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>Sender function:  </p>\n\n<pre><code>func sender3(ch chan int, i int) {\n    ch &lt;- i\n}\n</code></pre>\n\n<p>And the output:  </p>\n\n<blockquote>\n  <p>testAsyncFunc 2 0 4 6 8 2 Done...</p>\n</blockquote>\n\n<p>While I would expect to get back 10 numbers. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 0, "creation_date": 1539527394, "post_id": 52803583, "comment_id": 92525784, "body": "Try <code>$GOROOT&#47;pkg&#47;tool</code>."}], "answers": [{"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 2, "last_activity_date": 1539527514, "creation_date": 1539527514, "answer_id": 52803711, "question_id": 52803583, "link": "https://stackoverflow.com/questions/52803583/where-are-go-tools-stored/52803711#52803711", "title": "Where are go tools stored?", "body": "<p>On my installation they're in the <code>GOTOOLDIR</code> in the <code>go env</code> output.</p>\n\n<pre><code>~% go env | grep GOTOOLDIR\nGOTOOLDIR=\"/usr/local/Cellar/go/1.11.1/libexec/pkg/tool/darwin_amd64\"\n~% ls /usr/local/Cellar/go/1.11.1/libexec/pkg/tool/darwin_amd64\naddr2line buildid   cover     fix       objdump   test2json\napi       cgo       dist      link      pack      trace\nasm       compile   doc       nm        pprof     vet\n</code></pre>\n"}], "owner": {"reputation": 1130, "user_id": 469679, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0ad0df7bcf910723e1189b96422f1c5?s=128&d=identicon&r=PG", "display_name": "Federico Nafria", "link": "https://stackoverflow.com/users/469679/federico-nafria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52803711, "answer_count": 1, "score": -1, "last_activity_date": 1539527514, "creation_date": 1539526779, "question_id": 52803583, "link": "https://stackoverflow.com/questions/52803583/where-are-go-tools-stored", "title": "Where are go tools stored?", "body": "<p>I'm having some diffculty finding out where go tools are currently located in my setup.</p>\n\n<pre><code>$ go tool\ncgo\ncover\nvet\n</code></pre>\n\n<p>cover is not on the path:</p>\n\n<pre><code>$ which cover\n/usr/bin/which: no cover in ...\n</code></pre>\n\n<p>This is the go environment:</p>\n\n<pre><code>$ go env\nGOARCH=\"amd64\"\nGOBIN=\"~/go//bin\"\nGOCACHE=\"~/.cache/go-build\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"~/go/\"\nGORACE=\"\"\nGOROOT=\"/usr/bin/go\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/libexec/gcc/x86_64-redhat-linux/8\"\nGCCGO=\"/usr/bin/gccgo\"\n</code></pre>\n\n<p>And <code>~/go/bin</code> is empty:</p>\n\n<pre><code>$ ls -a ~/go/\n.  ..  pkg  \n</code></pre>\n\n<p>Where is go picking the tools from?</p>\n"}, {"tags": ["windows", "docker", "go"], "comments": [{"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1539560454, "post_id": 52802959, "comment_id": 92534153, "body": "Could it be that you are still running your go code locally? That would block the port."}, {"owner": {"reputation": 352, "user_id": 10467997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2q2ny.jpg?s=128&g=1", "display_name": "Laurent GRENIER", "link": "https://stackoverflow.com/users/10467997/laurent-grenier"}, "reply_to_user": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1539586322, "post_id": 52802959, "comment_id": 92540147, "body": "@PassKit, I forgot to precise this in my post then, I have updated it."}], "answers": [{"comments": [{"owner": {"reputation": 694, "user_id": 2639298, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/531120985/picture?type=large", "display_name": "Richard Crane", "link": "https://stackoverflow.com/users/2639298/richard-crane"}, "edited": false, "score": 0, "creation_date": 1569110115, "post_id": 52802978, "comment_id": 102489919, "body": "This does not work if your host crashed.  Docker will leave the port locked and the only way to unlock is to uninstall Docker, restart, restart again and then the port is no longer locked.  You can then reinstall Docker."}, {"owner": {"reputation": 352, "user_id": 10467997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2q2ny.jpg?s=128&g=1", "display_name": "Laurent GRENIER", "link": "https://stackoverflow.com/users/10467997/laurent-grenier"}, "reply_to_user": {"reputation": 694, "user_id": 2639298, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/531120985/picture?type=large", "display_name": "Richard Crane", "link": "https://stackoverflow.com/users/2639298/richard-crane"}, "edited": false, "score": 0, "creation_date": 1569135140, "post_id": 52802978, "comment_id": 102492808, "body": "Thanks @RichardCrane. I&#39;m afraid to see that such a problem is still there almost one year later ! I definitely recommend Ubuntu as a more stable environment and a smooth transition from Windows."}], "tags": [], "owner": {"reputation": 352, "user_id": 10467997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2q2ny.jpg?s=128&g=1", "display_name": "Laurent GRENIER", "link": "https://stackoverflow.com/users/10467997/laurent-grenier"}, "is_accepted": true, "score": 2, "last_activity_date": 1539522472, "creation_date": 1539522472, "answer_id": 52802978, "question_id": 52802959, "link": "https://stackoverflow.com/questions/52802959/docker-on-windows-port-locked/52802978#52802978", "title": "Docker on Windows - port locked", "body": "<p>Docker on Windows sometimes lock your ports, even after the deletion of your container, during an undetermined duration.</p>\n\n<p>The simplest thing you have to do is to restart docker and the port are no longer locked.</p>\n"}], "owner": {"reputation": 352, "user_id": 10467997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2q2ny.jpg?s=128&g=1", "display_name": "Laurent GRENIER", "link": "https://stackoverflow.com/users/10467997/laurent-grenier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 52802978, "answer_count": 1, "score": 0, "last_activity_date": 1539586215, "creation_date": 1539522342, "last_edit_date": 1539586215, "question_id": 52802959, "link": "https://stackoverflow.com/questions/52802959/docker-on-windows-port-locked", "title": "Docker on Windows - port locked", "body": "<p>I recently experienced an error while I was trying to test locally my Golang API. </p>\n\n<p>My API was exposed on the port 8080:</p>\n\n<pre><code>log.Fatal(http.ListenAndServe(\":8080\", router))\n</code></pre>\n\n<p>My final docker file expose the API on the same port:</p>\n\n<pre><code>FROM scratch\n\nWORKDIR /app\nCOPY ./fooAPI.exe /app/fooapi\nCOPY ./cmd/fooAPI/conf.json /app\n\n# tell we are exposing our service on port 8080\nEXPOSE 8080\n\n# run it!\nCMD [\"./fooapi\"]  \n</code></pre>\n\n<p>When I was trying to run my docker image, I had the following error message:</p>\n\n<pre><code>C:\\Program Files\\Docker\\Docker\\Resources\\bin\\docker.exe: Error response from daemon: driver failed programming external connectivity on endpoint fooapi (f6d5bed281ad1e8c1c56770cc1c05e3b5a7f8a05abd8265ae3a4007eeb3ff895): \nError starting userland proxy: mkdir /port/tcp:0.0.0.0:8080:tcp:172.17.0.2:8080: input/output error\n</code></pre>\n\n<p>Event after the deletion of the previous containers by using the command below:</p>\n\n<pre><code>docker rm $(docker ps -a -q)\n</code></pre>\n"}, {"tags": ["http", "go", "networking"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1539522328, "post_id": 52802861, "comment_id": 92524349, "body": "What parts do you need to replace? Everything is done through the <code>net.Conn</code> Interface."}, {"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1539522897, "post_id": 52802861, "comment_id": 92524471, "body": "My network package implements the <code>net.Conn</code> interface. What I&#39;m not sure about is how to make the <code>net&#47;http</code> package use this new iplementation of the interface without replacing it everywhere in the code."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1539523062, "post_id": 52802861, "comment_id": 92524515, "body": "If you implement <code>net.Conn</code>, then you just use your implementation. Can you show a specific problem you\u2019re having doing that?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1539540365, "post_id": 52802861, "comment_id": 92529564, "body": "@JimB I&#39;m guessing the OP wants an example for how to hook into the APIs . For an HTTP server I guess the answer is to implement net.Listener whose Accept() method returns the custom net.Conn. For an HTTP client doing <code>http.Get(...)</code> I can&#39;t quite figure out where the hook would be."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1539542615, "post_id": 52802861, "comment_id": 92530245, "body": "@nos, the \u201chooks\u201d are the same as for the <code>net</code> package, a <code>net.Listener</code> for the server, and the <code>Transport</code> Has <code>Dial*</code> functions for getting connections. It\u2019s all documented there, but I can write up an answer if I have time later."}], "owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539581733, "creation_date": 1539521611, "last_edit_date": 1539581733, "question_id": 52802861, "link": "https://stackoverflow.com/questions/52802861/go-http-package-with-custom-network-layer", "title": "Go HTTP package with custom network layer", "body": "<p>I'm trying to write an HTTP package in Go that uses a custom network layer, not IP. My goal is to have a package that offers the same interface as the net/http package in the standard library such that existing applications can just swap the package for mine and they would still work.</p>\n\n<p>My question is how I should go about this. It seems to me that I have to fork the whole net/http package and replace calls to the network with my network layer. However, this doesn't seem very elegant as it's basically just duplicating code apart from some changes. Is there another way to re-use the existing http package?</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 7147393, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nonlb.jpg?s=128&g=1", "display_name": "Russiancold", "link": "https://stackoverflow.com/users/7147393/russiancold"}, "edited": false, "score": 0, "creation_date": 1539529757, "post_id": 52803791, "comment_id": 92526458, "body": "Comprehensive. No words."}], "tags": [], "owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "is_accepted": true, "score": 0, "last_activity_date": 1539528346, "last_edit_date": 1539528346, "creation_date": 1539528040, "answer_id": 52803791, "question_id": 52802734, "link": "https://stackoverflow.com/questions/52802734/implementing-a-pipeline-of-worker-functions/52803791#52803791", "title": "Implementing a pipeline of worker functions", "body": "\n\n<p>If your intent is to propagate a signal along the pipeline to communicate when previous pipeline stages have completed and will produce no further values, you can do this synchronously by closing the channel after each pipeline stage returns. The following code does so by wrapping the invocation of each pipeline worker:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func startWork(val job, in, out chan interface{}) {\n    val(in, out)\n    // out will be closed after val returns\n    close(out)\n}\n\n// Later, in ExecutePipeline, start your worker by calling startWork\nfunc ExecutePipeline(jobs ...job) {\n    // ...\n    for _, val := range jobs {\n        // ...\n        go startWork(val, in, out)\n    }\n}\n</code></pre>\n\n<hr>\n\n<h1>Avoiding multiple channel closure</h1>\n\n<blockquote>\n  <p>I don't have any guarantee that <code>out</code> will be closed at the end of each function</p>\n</blockquote>\n\n<p>Conversely, if any worker <em>can</em> close a channel, this is problematic; the subsequent call in <code>startWork</code> to close the channel will panic if you attempt to close an already-closed channel.</p>\n\n<p>In this simple implementation, workers must delegating channel closure to the code which supervises the pipeline to avoid causing your program to panic.</p>\n\n<hr>\n\n<h1>Handling in-band signalling</h1>\n\n<p>As the signalling is passed in-band (in the same channel as the data), care may be required in the implementation of your pipeline workers to ensure they differentiate between</p>\n\n<ul>\n<li>reads of a value from an open channel, and</li>\n<li>reads of a zero value from a closed channel</li>\n</ul>\n\n<p><code>range</code>ing over a channel in a <code>for</code> loop will automatically break the loop when the channel is closed. If you implement your own logic to read from the channel, you will need to ascertain when the read trivially succeeds with a zero value because the channel is closed. This can be achieved using the <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">multi-valued assignment form of the receive operator</a>, which will return a boolean when a read from the channel was of a zero value because the channel was closed and empty.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func someWorker(in, out chan interface{}) {\n    for {\n        val, open := &lt;-in\n        if !open {\n            // Read of val was the zero value of \"in\", indicating the channel\n            // is closed.\n            break // or, if appropriate, return\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 7147393, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nonlb.jpg?s=128&g=1", "display_name": "Russiancold", "link": "https://stackoverflow.com/users/7147393/russiancold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 2, "accepted_answer_id": 52803791, "answer_count": 1, "score": 0, "last_activity_date": 1539528346, "creation_date": 1539520778, "question_id": 52802734, "link": "https://stackoverflow.com/questions/52802734/implementing-a-pipeline-of-worker-functions", "title": "Implementing a pipeline of worker functions", "body": "<p>I'm implementing a pipeline of a several worker functions connected by channels. All of them get <code>(in, out chan interface{})</code> as a input (each function receives <code>out</code> of previous one as <code>in</code>)\n<br><br> I don't have any guarantee that <code>out</code> will be closed at the end of each function, so I'm wondering how should I check if a previous function has done its work. I've started with something like this:</p>\n\n<pre><code>func ExecutePipeline(jobs ...job) {\n    out := make(chan interface{}, 10)\n    for _, val := range jobs {\n        in := out\n        out := make(chan interface{})\n        go val(in, out)\n    }\n}\n</code></pre>\n\n<p>I'm thinking about using <code>WaitGroup</code> somehow to use the end of function's goroutine as an indicator that it's done its work and close its out channel.<br> How can I do it?</p>\n"}, {"tags": ["mysql", "go", "timestamp", "protocol-buffers"], "comments": [{"owner": {"reputation": 7554, "user_id": 700471, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ebb4cc58c1fce4f22abc59a1226ee8e2?s=128&d=identicon&r=PG", "display_name": "Matt Mc", "link": "https://stackoverflow.com/users/700471/matt-mc"}, "edited": false, "score": 0, "creation_date": 1557017554, "post_id": 52802521, "comment_id": 98624614, "body": "Ever figure this out?"}, {"owner": {"reputation": 21, "user_id": 1858745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd55d73e8eeaf89597ef2aaa24179966?s=128&d=identicon&r=PG", "display_name": "burx", "link": "https://stackoverflow.com/users/1858745/burx"}, "edited": false, "score": 1, "creation_date": 1559786475, "post_id": 52802521, "comment_id": 99531597, "body": "ptypes already have convenient functions which convert between time.Time and *timestamp.Timestamp. [ <a href=\"https://godoc.org/github.com/golang/protobuf/ptypes#Timestamp](http://%20https://godoc.org/github.com/golang/protobuf/ptypes#Timestamp)\" rel=\"nofollow noreferrer\">godoc.org/github.com/golang/protobuf/ptypes#Timestamp](http:&zwnj;&#8203;//&hellip;</a> <a href=\"https://godoc.org/github.com/golang/protobuf/ptypes#TimestampProto\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/golang/protobuf/ptypes#Timestam&zwnj;&#8203;pProto</a>"}, {"owner": {"reputation": 908, "user_id": 3649496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c95010d46812ccabe7eea947a090ab?s=128&d=identicon&r=PG&f=1", "display_name": "infiniteLearner", "link": "https://stackoverflow.com/users/3649496/infinitelearner"}, "edited": false, "score": 0, "creation_date": 1604322639, "post_id": 52802521, "comment_id": 114303900, "body": "import &quot;github.com/golang/protobuf/ptypes&quot;  createdObject,err := ptypes.TimestampProto(dbresponse[i].CreatedOn)             if err !=nil{                           log.Println(&quot;Error found:&quot;,err)             }"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 10217443, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ipP2mZGiFGU/AAAAAAAAAAI/AAAAAAAAADc/ZvHNj7o3sOI/photo.jpg?sz=128", "display_name": "Yuliang Li", "link": "https://stackoverflow.com/users/10217443/yuliang-li"}, "edited": false, "score": 0, "creation_date": 1539533532, "post_id": 52803909, "comment_id": 92527568, "body": "So it need a process to convert the attribute format?"}, {"owner": {"reputation": 317, "user_id": 10217443, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ipP2mZGiFGU/AAAAAAAAAAI/AAAAAAAAADc/ZvHNj7o3sOI/photo.jpg?sz=128", "display_name": "Yuliang Li", "link": "https://stackoverflow.com/users/10217443/yuliang-li"}, "edited": false, "score": 2, "creation_date": 1539533704, "post_id": 52803909, "comment_id": 92527623, "body": "can protobuf define the attribute <code>time.Time</code> type in message?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 2, "creation_date": 1560138532, "post_id": 52803909, "comment_id": 99625372, "body": "In short, yes. A protobuf timestamp has no timezone info. Go&#39;s time.Time does. So one would need to add zoneinfo to any message alongside the timestamp. However, since protobuf is mainly used with micro-services &amp; not usually user-facing, maintaining zoneinfo at a micro-service level is most likely not needed."}], "tags": [], "owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "is_accepted": false, "score": 24, "last_activity_date": 1539528831, "creation_date": 1539528831, "answer_id": 52803909, "question_id": 52802521, "link": "https://stackoverflow.com/questions/52802521/how-can-i-get-time-time-in-golang-protobuf-v3-struct/52803909#52803909", "title": "How can I get time.Time in Golang protobuf v3 struct?", "body": "<p>To obtain a <code>time.Time</code> from a protobuf field of type <code>google.protobuf.Timestamp</code>, use the <a href=\"https://godoc.org/github.com/golang/protobuf/ptypes#Timestamp\" rel=\"noreferrer\"><code>ptypes.Timestamp</code> helper function</a>.</p>\n\n<p>When producing the insert call into your database, or any other location where a <code>time.Time</code> is required, call <code>ptypes.Timestamp(myMsg.UpdateTime)</code> to obtain the required value (where <code>myMsg</code> is a variable to an instance of the relevant Protobuf message type).</p>\n"}, {"tags": [], "owner": {"reputation": 299, "user_id": 1843751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/910a91ec4709ae36a5d0bb114cb6d2bd?s=128&d=identicon&r=PG", "display_name": "ignite", "link": "https://stackoverflow.com/users/1843751/ignite"}, "is_accepted": false, "score": 1, "last_activity_date": 1618211675, "creation_date": 1618211675, "answer_id": 67054037, "question_id": 52802521, "link": "https://stackoverflow.com/questions/52802521/how-can-i-get-time-time-in-golang-protobuf-v3-struct/67054037#67054037", "title": "How can I get time.Time in Golang protobuf v3 struct?", "body": "<p>The <a href=\"https://pkg.go.dev/google.golang.org/protobuf/types/known/timestamppb#Timestamp.AsTime\" rel=\"nofollow noreferrer\">AsTime</a> method can be used to convert a Timestamp message to a standard Go time.Time value in UTC:</p>\n<pre><code>t := ts.AsTime()\n... // make use of t as a time.Time\n</code></pre>\n<p>The AsTime method performs the conversion on a best-effort basis. Timestamps with denormal values (e.g., nanoseconds beyond 0 and 99999999, inclusive) are normalized during the conversion to a time.Time. To manually check for invalid Timestamps per the documented limitations in timestamp.proto, additionally call the CheckValid method:</p>\n<pre><code>if err := ts.CheckValid(); err != nil {\n    ... // handle error\n}\n</code></pre>\n<p>This is documented in <a href=\"https://pkg.go.dev/google.golang.org/protobuf/types/known/timestamppb\" rel=\"nofollow noreferrer\">timestamppb</a> package.</p>\n"}], "owner": {"reputation": 317, "user_id": 10217443, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ipP2mZGiFGU/AAAAAAAAAAI/AAAAAAAAADc/ZvHNj7o3sOI/photo.jpg?sz=128", "display_name": "Yuliang Li", "link": "https://stackoverflow.com/users/10217443/yuliang-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18318, "favorite_count": 1, "answer_count": 2, "score": 17, "last_activity_date": 1618211675, "creation_date": 1539519243, "last_edit_date": 1611310156, "question_id": 52802521, "link": "https://stackoverflow.com/questions/52802521/how-can-i-get-time-time-in-golang-protobuf-v3-struct", "title": "How can I get time.Time in Golang protobuf v3 struct?", "body": "<p>I'm using the google time package <code>github.com/golang/protobuf/ptypes/timestamp</code> in protobuf message file  now.</p>\n<pre><code>google.protobuf.Timestamp UpdateTime = 9;\n</code></pre>\n<p>But the <code>UpdateTime</code> property becomes a pointer <code>*timestamp.Timestamp</code> in golang struct after protoc compiling, it's not a <code>time.Time</code> and I can't save these property into Mysql timestamp column.</p>\n<p>What can I do?</p>\n"}, {"tags": ["go", "goroutine", "go-sqlite3"], "answers": [{"comments": [{"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 0, "creation_date": 1539518968, "post_id": 52802452, "comment_id": 92523533, "body": "I did the same thing with wait groups. But it still does not work. In both the cases r is not printed but print after calling someFunction is printed. Only when ran sequentially it is printed."}, {"owner": {"reputation": 98839, "user_id": 3848, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W10YY.jpg?s=128&g=1", "display_name": "Motti", "link": "https://stackoverflow.com/users/3848/motti"}, "reply_to_user": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 0, "creation_date": 1539519040, "post_id": 52802452, "comment_id": 92523549, "body": "I see you print <code>r</code> before checking for an error. Could it be that you&#39;re always getting an error and thus no <code>r</code>?"}, {"owner": {"reputation": 98839, "user_id": 3848, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W10YY.jpg?s=128&g=1", "display_name": "Motti", "link": "https://stackoverflow.com/users/3848/motti"}, "reply_to_user": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 1, "creation_date": 1539519092, "post_id": 52802452, "comment_id": 92523560, "body": "I think I see your problem now, hold on I&#39;ll update the answer."}], "tags": [], "owner": {"reputation": 98839, "user_id": 3848, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W10YY.jpg?s=128&g=1", "display_name": "Motti", "link": "https://stackoverflow.com/users/3848/motti"}, "is_accepted": true, "score": 3, "last_activity_date": 1539524313, "last_edit_date": 1539524313, "creation_date": 1539518753, "answer_id": 52802452, "question_id": 52802310, "link": "https://stackoverflow.com/questions/52802310/go-routines-not-executing/52802452#52802452", "title": "Go routines not executing", "body": "<p>The usual pattern for what you're trying to achieve uses <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\"><code>WaitGroup</code></a>.</p>\n\n<p>I think the problem you're facing is that <code>i</code> is captured by each goroutine and it keeps getting incremented by the outer loop. Your inner loop starts at <code>i</code> and since the outer loop has continued, each goroutine starts at 5.</p>\n\n<p>Try passing the iterator as parameter to the goroutine so that you get a new copy each time.</p>\n\n<pre><code>func someFunction(){\n    ....\n    gos := 5\n    var wg sync.WaitGroup\n    wg.Add(gos)\n\n    for i:=0; i&lt; gos; i++ {\n        go func(n int) {\n            defer wg.Done()\n            for j:=n; j&lt;len(tables); j+=gos {\n                r, err := db.Exec(tables[j])\n\n                fmt.Println(r)\n\n                if err != nil {\n                    methods.CheckErr(err, err.Error())\n                }\n            }\n        }(i)\n    }\n    wg.Wait();     \n}\n</code></pre>\n\n<p>I'm not sure what you're trying to achieve here, each goroutine does <code>db.Exec</code> on all the tables above the one it started with so the first one treats all the tables, the second one treats all but the first one and so on. Is this what you intended?</p>\n"}], "owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 52802452, "answer_count": 1, "score": 1, "last_activity_date": 1539524313, "creation_date": 1539517676, "last_edit_date": 1539518259, "question_id": 52802310, "link": "https://stackoverflow.com/questions/52802310/go-routines-not-executing", "title": "Go routines not executing", "body": "<p>The following is the code that is giving me problem. What i want to achieve is to create those many tables in parallel. After all the tables are created I want to exit the functions.  </p>\n\n<pre><code>func someFunction(){\n    ....\n    gos := 5\n    proc := make(chan bool, gos)\n    allDone := make(chan bool)\n\n    for i:=0; i&lt;gos; i++ {\n        go func() {\n            for j:=i; j&lt;len(tables); j+=gos {\n                r, err := db.Exec(tables[j])\n\n                fmt.Println(r)\n\n                if err != nil {\n                    methods.CheckErr(err, err.Error())\n                }\n            }\n            proc &lt;- true\n        }()\n    }\n\n    go func() {\n        for i:=0; i&lt;gos; i++{\n            &lt;-proc\n        }\n        allDone &lt;- true\n    }()\n\n    for {\n        select {\n        case &lt;-allDone:\n            return\n        }\n    }   \n}\n</code></pre>\n\n<p>I'm creating two channels 1 to keep track of number of tables created (proc) and other (allDone) to see if all are done.</p>\n\n<p><strong>When i run this code then the go routine to create table starts execution but before it completes someFunction gets terminated.</strong> </p>\n\n<p>However there is no problem if run the code sequentially</p>\n\n<p>What is the mistake in my design pattern and also how do i correct it.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1539509758, "post_id": 52801215, "comment_id": 92521487, "body": "&quot;captured all calls...&quot; - What do you mean by this? Did you manage to intercept the headers/body and the status code?  Can you also post some code snippets so we can understand the problem easier :)"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5560268, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156172418395543/picture?type=large", "display_name": "Loren Osborn", "link": "https://stackoverflow.com/users/5560268/loren-osborn"}, "edited": false, "score": 0, "creation_date": 1539537606, "post_id": 52801393, "comment_id": 92528776, "body": "This does, indeed look like what I was searching for. I must say i\u2019m a bit nervous about the name. Should I be at all concerned using this in production code?"}, {"owner": {"reputation": 131, "user_id": 5560268, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156172418395543/picture?type=large", "display_name": "Loren Osborn", "link": "https://stackoverflow.com/users/5560268/loren-osborn"}, "edited": false, "score": 0, "creation_date": 1539564735, "post_id": 52801393, "comment_id": 92534938, "body": "I expect to mark this as an accepted answer, but I\u2019m waiting on this relavant question first: <a href=\"https://stackoverflow.com/questions/52808399/golang-should-i-avoid-using-net-http-httptest-in-production-code\" title=\"golang should i avoid using net http httptest in production code\">stackoverflow.com/questions/52808399/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24595, "user_id": 19165, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/87eb90e1395b5ebd36fd5599fcca4847?s=128&d=identicon&r=PG", "display_name": "Bob Fanger", "link": "https://stackoverflow.com/users/19165/bob-fanger"}, "is_accepted": true, "score": 1, "last_activity_date": 1539510278, "creation_date": 1539510278, "answer_id": 52801393, "question_id": 52801215, "link": "https://stackoverflow.com/questions/52801215/how-do-i-convert-a-net-http-responsewriter-to-a-net-http-response/52801393#52801393", "title": "How do I convert a net/http.ResponseWriter to a net/http.Response", "body": "<p>The <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\">net/http/httptest</a> package has a ResponseRecorder that can convert a ResponseWriter to a Response.</p>\n\n<p>If you've captured the raw http text, http.ReadResponse() can be used, but if you already parsed things like headers, status code, you could also create the <code>new http.Request{}</code> struct yourself.</p>\n\n<p>Look at <a href=\"https://golang.org/src/net/http/response.go\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/response.go</a> for details.</p>\n"}], "owner": {"reputation": 131, "user_id": 5560268, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156172418395543/picture?type=large", "display_name": "Loren Osborn", "link": "https://stackoverflow.com/users/5560268/loren-osborn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 1, "accepted_answer_id": 52801393, "answer_count": 1, "score": 0, "last_activity_date": 1539520360, "creation_date": 1539508754, "last_edit_date": 1539520360, "question_id": 52801215, "link": "https://stackoverflow.com/questions/52801215/how-do-i-convert-a-net-http-responsewriter-to-a-net-http-response", "title": "How do I convert a net/http.ResponseWriter to a net/http.Response", "body": "<p>Firstly, I intentionally asked this question incorrectly in hopes that the web search engines would better understand my intended question. The more accurate question is:</p>\n\n<p><strong>If I have captured all calls to a custom net/http.ResponseWriter, how do take the values passed to it, that I have stored into a []byte buffer, how do I convert this to a net/http.Response?</strong></p>\n\n<p>I believe the answer lies in net/http.ReadResponse(), but I'm not sure how to render the Response properly for ReadResponse to understand.</p>\n"}, {"tags": ["go", "compilation"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 3, "creation_date": 1539501050, "post_id": 52800217, "comment_id": 92519617, "body": "You can pass the config file as a flag to the binary e.g. <code>&lt;binary&gt; -c config.toml</code> and set the default in <code>flag.String(&quot;c&quot;, &quot;config.toml&quot;, &quot;config file&quot;)</code>."}, {"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "reply_to_user": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1539526645, "post_id": 52800217, "comment_id": 92525575, "body": "@weavr , I will be looking into that."}], "answers": [{"comments": [{"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1539526578, "post_id": 52800370, "comment_id": 92525551, "body": "I actually use viper. I will be testing the live watch functionality today."}, {"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1539539862, "post_id": 52800370, "comment_id": 92529444, "body": "Perfect, it works now. I had to update the config after reload. Now I need it to work with the binary."}, {"owner": {"reputation": 430, "user_id": 986597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0hCj.jpg?s=128&g=1", "display_name": "Graham Nicholls", "link": "https://stackoverflow.com/users/986597/graham-nicholls"}, "edited": false, "score": 0, "creation_date": 1568319626, "post_id": 52800370, "comment_id": 102246941, "body": "Actually, the assertion that &quot;Config files aren&#39;t meant to be embedded in executables&quot; is at best contentious.    There are cases where this is a useful thing to do - see here:                        <a href=\"https://stackoverflow.com/questions/17796043/how-to-embed-files-into-golang-binaries\" title=\"how to embed files into golang binaries\">stackoverflow.com/questions/17796043/&hellip;</a>"}, {"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "reply_to_user": {"reputation": 430, "user_id": 986597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0hCj.jpg?s=128&g=1", "display_name": "Graham Nicholls", "link": "https://stackoverflow.com/users/986597/graham-nicholls"}, "edited": false, "score": 0, "creation_date": 1568367365, "post_id": 52800370, "comment_id": 102259773, "body": "@GrahamNicholls They are just not supposed to. Embedding static files to serve directly from the executable inside is acceptable. However configuration is different and does change even if it&#39;s not often. I believe they should be loaded at runtime for the best efficiency. There is an architectural pattern that tackles this. <a href=\"https://docs.microsoft.com/en-us/azure/architecture/patterns/external-configuration-store\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/azure/architecture/patterns/&hellip;</a>"}, {"owner": {"reputation": 430, "user_id": 986597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0hCj.jpg?s=128&g=1", "display_name": "Graham Nicholls", "link": "https://stackoverflow.com/users/986597/graham-nicholls"}, "edited": false, "score": 0, "creation_date": 1568898802, "post_id": 52800370, "comment_id": 102427856, "body": "We&#39;ll have to agree to disagree.  Sometimes it&#39;s extremely useful to embed config.  I&#39;m sure that MS have all sorts of patterns, and in general, that they are worth following.  Just not in every case."}], "tags": [], "owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "is_accepted": false, "score": 6, "last_activity_date": 1539501358, "creation_date": 1539501358, "answer_id": 52800370, "question_id": 52800217, "link": "https://stackoverflow.com/questions/52800217/ship-golang-binary-with-dynamicconfig-toml-configuration-file/52800370#52800370", "title": "Ship Golang binary with dynamic(config.toml) configuration file", "body": "<p>Config files aren't meant to be embedded in executables. It'd be better to have them reside alongside executables. Since I couldn't get your point on rebuilding complete app just for reloading configuration, I made up my former sentences presuming you're hardcoding.</p>\n\n<p>If we get to the \u201creloading\u201d topic, I would surely restart my program or send a signal to re-load the configuration. You don't have to do this, because there is a nice library doing this: <a href=\"https://github.com/spf13/viper\" rel=\"noreferrer\">https://github.com/spf13/viper</a>. It is easy to use and supports live watching for changes on config file. Besides supporting JSON, YAML, TOML and HCL, it can read from environment variables, remote config systems (like Consul and etcd). It's trusted and used by big projects, such as Kubernetes.</p>\n"}], "owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1294, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539501358, "creation_date": 1539499855, "question_id": 52800217, "link": "https://stackoverflow.com/questions/52800217/ship-golang-binary-with-dynamicconfig-toml-configuration-file", "title": "Ship Golang binary with dynamic(config.toml) configuration file", "body": "<p>I have a simple go server that works, and gets most of its configuration settings from a <code>toml</code> file.<br>\nThe current process involves restarting the <code>go build</code> source every time the settings are changed.<br>\nWhat is the correct/most preferred/tested and working way to ship only binary and the config.toml file?<br>\nI am still a newbie when it comes to compiling, and i have been reading a lot of texts and still not having a clear understanding on this issue.<br>\nAny useful comments will be appreciated.</p>\n"}, {"tags": ["go", "testing"], "comments": [{"owner": {"reputation": 3542, "user_id": 5033611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a91063fb01317639d57d5fc9c9d9c7?s=128&d=identicon&r=PG", "display_name": "ssemilla", "link": "https://stackoverflow.com/users/5033611/ssemilla"}, "edited": false, "score": 0, "creation_date": 1539501353, "post_id": 52800137, "comment_id": 92519677, "body": "This might be relevant: <a href=\"https://stackoverflow.com/questions/23729790/how-can-i-do-test-setup-using-the-testing-package-in-go\" title=\"how can i do test setup using the testing package in go\">stackoverflow.com/questions/23729790/&hellip;</a>"}, {"owner": {"reputation": 5906, "user_id": 76091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w78it.jpg?s=128&g=1", "display_name": "Neil Fenwick", "link": "https://stackoverflow.com/users/76091/neil-fenwick"}, "edited": false, "score": 0, "creation_date": 1539553173, "post_id": 52800137, "comment_id": 92532798, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23729790/how-can-i-do-test-setup-using-the-testing-package-in-go\">How can I do test setup using the testing package in Go</a>"}], "owner": {"reputation": 101, "user_id": 2701720, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/801cca1dff7f8ad9012eba2c01b68e80?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/2701720/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539501864, "creation_date": 1539499160, "last_edit_date": 1539501864, "question_id": 52800137, "link": "https://stackoverflow.com/questions/52800137/persisting-state-across-tests-in-golang", "title": "Persisting State Across tests in GoLang", "body": "<p>I am looking to instantiate an object and update the state of this object across multiple function calls in a Go Test. </p>\n\n<p>My main logic looks like this: </p>\n\n<pre><code>type User struct {\n    Username string\n    Persist4 map[string]string\n}\n\n\nfunc Init(username string, password string) (userdataptr *User, err error) {\n    mapping2 := make(map[string]string)\n    var userdata User\n    userdata.Username = username\n    userdata.Persist5 = mapping2\n    // Marshak and store this structure \n    return &amp;userdata, err\n}\n\n\nfunc Get(uname string, password string) (user *User, err error) {\n    // Retrieve and unmarshal user into tmp\n    return &amp;temp, nil\n}\n\nfunc (userdata *User) StoreFile(filename string, data []byte) {\n    userdata.Persist4['test'] = 'fails' // This is not available in the next call \n\n}\n</code></pre>\n\n<p>And the testing logic looks like this: </p>\n\n<pre><code>func TestInit(t *testing.T) {\n    u, _ := Init(\"a\", \"f\")\n\n}\n\nfunc TestStorage(t *testing.T) {\n    u, err := GetUser(\"a\", \"f\")\n\n    u.StoreFile(\"file1\", v)\n\n}\n\nfunc test(t *testing.T) {\n    u, err := Get(\"a\", \"f\")\n    // u no longer has attribute persist4['test'] = 'fails'\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1539497394, "post_id": 52799886, "comment_id": 92519064, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28497254/struct-field-not-updated-when-implementing-interface-function\" title=\"struct field not updated when implementing interface function\">stackoverflow.com/questions/28497254/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/24994721/assign-a-new-value-to-golang-structure-field\" title=\"assign a new value to golang structure field\">stackoverflow.com/questions/24994721/&hellip;</a> and more."}], "answers": [{"tags": [], "owner": {"reputation": 2274, "user_id": 7567579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab9644beeb1d324d1247b2951d28927?s=128&d=identicon&r=PG", "display_name": "Emin Laletovic", "link": "https://stackoverflow.com/users/7567579/emin-laletovic"}, "is_accepted": false, "score": 1, "last_activity_date": 1539499400, "creation_date": 1539499400, "answer_id": 52800169, "question_id": 52799886, "link": "https://stackoverflow.com/questions/52799886/why-is-value-changing-after-function-execution/52800169#52800169", "title": "Why is value changing after function execution?", "body": "<p>With <code>Increment</code> and <code>LogState</code> defined the way you've defined them, you are working only with the <strong>copy</strong> of the value of <code>List</code>. This means that if you make some changes inside <code>Increment</code> function, they are visible only inside <code>Increment</code>'s function scope and only for the remainder of that particular scope's existence. To confirm you are always working with a copy of of the initial <code>List</code> value, you can log <code>&amp;list</code> before executing <code>Increment</code> function and <code>&amp;l</code> inside the same function.</p>\n\n<p>If you want to make changes permanent, you should work with a pointer to a memory address. That means your your function should be defined like this:</p>\n\n<pre><code>func (l *List) Increment()\n\nfunc (l *List) LogState()\n</code></pre>\n\n<p>This way, you are passing a memory reference (pointer to an address in memory) and every time you change a value of <code>l</code>, you are changing it on the passed memory reference and it reflects everywhere.</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1539618564, "last_edit_date": 1539618564, "creation_date": 1539500630, "answer_id": 52800297, "question_id": 52799886, "link": "https://stackoverflow.com/questions/52799886/why-is-value-changing-after-function-execution/52800297#52800297", "title": "Why is value changing after function execution?", "body": "<p>The reason your nodes are not added to the original linkedList because you are not using pointer to the struct. So even if the <code>Increment</code> function in your example code changes the value. The copy of the struct is changed not the actual struct.</p>\n\n<blockquote>\n  <p>You can declare methods with pointer receivers. This means the\n  receiver type has the literal syntax *T for some type T. (Also, T\n  cannot itself be a pointer such as *int.)</p>\n</blockquote>\n\n<p>If you want to change the linkedlistNode struct counter to show the nodes added to the list you should be using a pointer type receiver on both methdos working to modify the linked list as:</p>\n\n<pre><code>func (l *LinkedList) AddInitialValue(v interface{})\nfunc (l *LinkedList) LogState()\n</code></pre>\n\n<p>And Inside the main pass an address to the linkedList to use those pointer type receivers as:</p>\n\n<pre><code>func main() {\n    list :=  &amp;LinkedList{}\n    list.AddInitialValue(9)\n\n    fmt.Println(\"----\")\n    list.LogState() // size: 0\n}\n</code></pre>\n\n<p>Working Code <a href=\"https://play.golang.org/p/JK8G95KpDXH\" rel=\"nofollow noreferrer\">Go playground</a></p>\n\n<p><strong>Note:-</strong></p>\n\n<p>There are two reasons to use a pointer receiver.</p>\n\n<blockquote>\n  <ul>\n  <li>To modify the value that its receiver points to. </li>\n  <li>To avoid copying the value on each method call. This can be more efficient if the receiver is a large struct</li>\n  </ul>\n</blockquote>\n\n<p>For more information go through <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">Method Sets</a></p>\n"}], "owner": {"reputation": 2190, "user_id": 3758164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7e2d17723471fee401172b514e3227ac?s=128&d=identicon&r=PG&f=1", "display_name": "bjnsn", "link": "https://stackoverflow.com/users/3758164/bjnsn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 52800297, "answer_count": 2, "score": 1, "last_activity_date": 1539618564, "creation_date": 1539496532, "question_id": 52799886, "link": "https://stackoverflow.com/questions/52799886/why-is-value-changing-after-function-execution", "title": "Why is value changing after function execution?", "body": "<p>I'm currently teaching myself Go, and I'm having trouble understanding a certain behavior:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype List struct {\n    n int\n}\n\nfunc (l List) Increment() {\n    l.n += 1\n    l.LogState() // size: 1\n}\n\nfunc (l List) LogState() {\n    fmt.Printf(\"size: %v\\n\", l.n)\n}\n\nfunc main() {\n    list := List{}\n    list.Increment()\n\n    fmt.Println(\"----\")\n    list.LogState() // size: 0\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/-O24DiNPkxx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-O24DiNPkxx</a></p>\n\n<p><code>LogState</code> is executed twice. The initial time, during the <code>Increment</code> call, it prints <code>size: 1</code> but after <code>Increment</code> has returned it prints <code>size: 0</code>. Why are those values different?</p>\n"}, {"tags": ["go", "gob", "go-interface"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539495033, "post_id": 52799745, "comment_id": 92518718, "body": "try to put the <code>go.Register()</code> statement on <code>init()</code> function"}, {"owner": {"reputation": 387, "user_id": 7827687, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rxdhHmEIL7Q/AAAAAAAAAAI/AAAAAAAABxU/R6XRHvLaoJI/photo.jpg?sz=128", "display_name": "tbraden", "link": "https://stackoverflow.com/users/7827687/tbraden"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539596633, "post_id": 52799745, "comment_id": 92545292, "body": "putting <code>gob.Register()</code> in <code>init()</code> didn&#39;t work. I also tried putting gob.Register() on the line right before decoder.Decode(), but the same error persisted. I think the underlying problem is that <code>chain.someStruct1</code> is somehow identified as <code>main.someStruct1</code>."}, {"owner": {"reputation": 387, "user_id": 7827687, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rxdhHmEIL7Q/AAAAAAAAAAI/AAAAAAAABxU/R6XRHvLaoJI/photo.jpg?sz=128", "display_name": "tbraden", "link": "https://stackoverflow.com/users/7827687/tbraden"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 2, "creation_date": 1539660150, "post_id": 52799745, "comment_id": 92571709, "body": "as a workaround, I am now using gob.RegisterName(&quot;main.SomeStruct1&quot;, chain.SomeStruct1) and things seem to work fine for now"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1539661485, "post_id": 52799745, "comment_id": 92571963, "body": "I suggest please post the solution as an answer, then approve it. it might be useful for others"}], "answers": [{"tags": [], "owner": {"reputation": 387, "user_id": 7827687, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rxdhHmEIL7Q/AAAAAAAAAAI/AAAAAAAABxU/R6XRHvLaoJI/photo.jpg?sz=128", "display_name": "tbraden", "link": "https://stackoverflow.com/users/7827687/tbraden"}, "is_accepted": true, "score": 2, "last_activity_date": 1539675925, "creation_date": 1539675925, "answer_id": 52830356, "question_id": 52799745, "link": "https://stackoverflow.com/questions/52799745/gob-register-name-not-registered-for-interface-in-another-package/52830356#52830356", "title": "gob.Register name not registered for interface in another package", "body": "<p>I have not been able to solve the problem completely and I think the cause was that <code>chain.SomeStruct1</code> was somehow recognized at runtime as having the name <code>main.SomeStruct1</code> while it was registered with the internal name <code>main.SomeStruct1</code>.</p>\n\n<p>Therefore a workaround I have now is using <code>gob.RegisterName(\"main.SomeStruct1\", chain.SomeStruct1)</code>.</p>\n"}], "owner": {"reputation": 387, "user_id": 7827687, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rxdhHmEIL7Q/AAAAAAAAAAI/AAAAAAAABxU/R6XRHvLaoJI/photo.jpg?sz=128", "display_name": "tbraden", "link": "https://stackoverflow.com/users/7827687/tbraden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 52830356, "answer_count": 1, "score": 0, "last_activity_date": 1539675925, "creation_date": 1539494821, "last_edit_date": 1539660107, "question_id": 52799745, "link": "https://stackoverflow.com/questions/52799745/gob-register-name-not-registered-for-interface-in-another-package", "title": "gob.Register name not registered for interface in another package", "body": "<p>I have recently restructured my code so that now under the <code>main</code> package there are two packages: <code>chain</code> and <code>api</code>.</p>\n\n<p>In <code>chain</code> I defined a few structs <code>SomeStruct1</code>, <code>SomeStruct2</code> and an interface <code>SomeInterface</code> for those structs. The following is what <code>chain/cli.go</code> looks like.</p>\n\n<pre><code>package chain\n\ntype CLI struct{}\n\nfunc (cli *CLI) Run() {\n    ...\n    gob.Register(SomeStruct1{})\n    gob.Register(SomeStruct2{})\n    ...\n}\n</code></pre>\n\n<p>There is another similar <code>api/api.go</code> where inside <code>Run()</code> I put <code>gob.Register(chain.SomeStruct1{})</code>.</p>\n\n<p><code>main.go</code> looks like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"myproj/api\"\n    \"myproj/chain\"\n)\n\nfunc main() {\n    // I have also tried the following lines.\n    // gob.Register(chain.SomeStruct1{})\n    // gob.Register(chain.SomeStruct2{})\n    go api.Run()\n\n    cli := chain.CLI{}\n    cli.Run()\n}\n</code></pre>\n\n<p>However, I got the error <code>gob: name not registered for interface: \"main.SomeStruct1\"</code> at runtime. This did not happen when I had all the code inside one <code>main</code> package and I felt weird that <code>SomeStruct1</code> is now under <code>chain</code> package but the error referred to <code>main.SomeStruct1</code>. Where did I get wrong of <code>gob.Register()</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 1, "creation_date": 1539489895, "post_id": 52799340, "comment_id": 92518115, "body": "Does this help? <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/O7EfGiy3ok0\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/O7EfGiy3ok0</a>"}, {"owner": {"reputation": 844, "user_id": 1726468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NULGa.png?s=128&g=1", "display_name": "Christian M. Raymonds", "link": "https://stackoverflow.com/users/1726468/christian-m-raymonds"}, "reply_to_user": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 0, "creation_date": 1539490856, "post_id": 52799340, "comment_id": 92518229, "body": "I read that but, I needed a little better explanation."}], "owner": {"reputation": 844, "user_id": 1726468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NULGa.png?s=128&g=1", "display_name": "Christian M. Raymonds", "link": "https://stackoverflow.com/users/1726468/christian-m-raymonds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1539495591, "answer_count": 0, "score": 0, "last_activity_date": 1539489292, "creation_date": 1539489292, "question_id": 52799340, "link": "https://stackoverflow.com/questions/52799340/golang-complex-formal-argument-for-hex-encodetostring", "closed_reason": "Duplicate", "title": "Golang complex formal argument for hex.EncodeToString", "body": "<p>I have two pieces of code, one works while the other doesn't. Can you please tell me the difference between these two:</p>\n\n<p><strong>This code works:</strong></p>\n\n<pre><code>targetHash := md5.Sum([]byte(fmt.Sprintf(\"%s:%s:%s\", ra.User, ra.Realm, password)))\n\nxhash := hex.EncodeToString(targetHash[:])\n</code></pre>\n\n<p><strong>This code doesn't work:</strong></p>\n\n<pre><code>targetHash := hex.EncodeToString(md5.Sum([]byte(fmt.Sprintf(\"%s:%s:%s\", ra.User, ra.Realm, password)))[:])\n</code></pre>\n\n<p>The error is: <code>slice of unaddressable value</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 968, "user_id": 3988964, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/38XEF.jpg?s=128&g=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/3988964/prakhar"}, "edited": false, "score": 1, "creation_date": 1584179405, "post_id": 52799280, "comment_id": 107361057, "body": "I appreciate the questions like these which are to the point and show some actual homework done before just asking."}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 1926351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/101a618d128a23b36b1052a52be1e8d1?s=128&d=identicon&r=PG", "display_name": "kargirwar", "link": "https://stackoverflow.com/users/1926351/kargirwar"}, "edited": false, "score": 0, "creation_date": 1618635351, "post_id": 52799478, "comment_id": 118667171, "body": "This answer actually points out the root cause."}], "tags": [], "owner": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "is_accepted": false, "score": 9, "last_activity_date": 1569353072, "last_edit_date": 1569353072, "creation_date": 1539491460, "answer_id": 52799478, "question_id": 52799280, "link": "https://stackoverflow.com/questions/52799280/context-confusion-regarding-cancellation/52799478#52799478", "title": "Context confusion regarding cancellation", "body": "<p>In your <code>for ... select</code>, you have 2 cases: <code>case &lt;-ctx.Done():</code> and <code>default:</code>. When your code reaches the <code>select</code>, it enters the <code>default</code> case because the context is not yet cancelled, where it sleeps for 15 seconds and then returns, breaking your loop. (in other words, it isn't blocking/waiting for your context to cancel)</p>\n\n<p>If you want your code to do what you are describing, you need your <code>select</code> to have cases for the context being cancelled <em>and</em> your imposed timeout.</p>\n\n<pre><code>select {\ncase &lt;-ctx.Done(): // context was cancelled\n  fmt.Printf(\"Ctx is kicking in with error:%+v\\n\", ctx.Err())\n  return\ncase &lt;-time.After(15 * time.Second): // 15 seconds have elapsed\n  fmt.Printf(\"I was not canceled\\n\")\n  return\n}\n</code></pre>\n\n<p>Now, your code will block when it hits <code>select</code>, rather than entering the <code>default</code> case and breaking your loop.</p>\n"}, {"comments": [{"owner": {"reputation": 449, "user_id": 4841710, "user_type": "registered", "profile_image": "https://graph.facebook.com/977883255564720/picture?type=large", "display_name": "Benjamin Slabbert", "link": "https://stackoverflow.com/users/4841710/benjamin-slabbert"}, "edited": false, "score": 0, "creation_date": 1584103671, "post_id": 52799874, "comment_id": 107340878, "body": "Thank you for the example. Just a question regarding the section of code:      // simulate a process that takes 4 second to complete     time.Sleep(4 * time.Second)  This process will still be running for another second. Do you have a suggestion for cancelling that process? Should you just pass on the context?"}, {"owner": {"reputation": 103, "user_id": 5860323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e949efb7d342b4fef51cab90938a5cd8?s=128&d=identicon&r=PG&f=1", "display_name": "frostbyte", "link": "https://stackoverflow.com/users/5860323/frostbyte"}, "edited": false, "score": 0, "creation_date": 1596661889, "post_id": 52799874, "comment_id": 111886708, "body": "Very useful examples, thanks. Just wondering about something in example #3 in the case of an error passed through errCh the context is never cancelled. Why is this? Can it be solved with additional info #2, or cancelling in the errCh select case?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 103, "user_id": 5860323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e949efb7d342b4fef51cab90938a5cd8?s=128&d=identicon&r=PG&f=1", "display_name": "frostbyte", "link": "https://stackoverflow.com/users/5860323/frostbyte"}, "edited": false, "score": 0, "creation_date": 1597049814, "post_id": 52799874, "comment_id": 111997073, "body": "@particulator the limitation of #2 is actually you cannot pas the detailed error information. when you force cancel it by <code>cancel()</code> then what you get on the <code>ctx.Err()</code> is always <code>context.Canceled</code>. there will be a situation that you might want to pass the detailed error object that causing the context to be cancelled. you can use #3, or you can use #2 with additional <code>chan error</code> variable to hold the detailed error object"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 14, "last_activity_date": 1590749606, "last_edit_date": 1590749606, "creation_date": 1539496412, "answer_id": 52799874, "question_id": 52799280, "link": "https://stackoverflow.com/questions/52799280/context-confusion-regarding-cancellation/52799874#52799874", "title": "Context confusion regarding cancellation", "body": "<p>If you want to use the <em>timeout and cancellation</em> feature from the context, then the <code>ctx.Done()</code> need to be handled synchronously. </p>\n\n<p>Explanation from <a href=\"https://golang.org/pkg/context/#Context\" rel=\"noreferrer\">https://golang.org/pkg/context/#Context</a></p>\n\n<blockquote>\n  <p>Done returns a channel that's closed when work is done on behalf of this context should be canceled. Done may return nil if this context can never be canceled. Successive calls to Done return the same value.</p>\n</blockquote>\n\n<p>So basically the <code>&lt;-ctx.Done()</code> will be called on two conditions:</p>\n\n<ol>\n<li>when context timeout exceeds</li>\n<li>when context canceled by force</li>\n</ol>\n\n<p>And when that happens, the <code>ctx.Err()</code> will never be <code>nil</code>.</p>\n\n<p>We can perform some checking on the error object to see whether the context is canceled by force or exceeding the timeout.</p>\n\n<p>Context package provides two error objects, <code>context.DeadlineExceeded</code> and <code>context.Timeout</code>, this two will help us to identify why <code>&lt;-ctx.Done()</code> is called.</p>\n\n<hr>\n\n<h2>Example #1 scenario: context timeout exceeded</h2>\n\n<p>In the test, we'll try to make the context to be canceled before the timeout exceeds, so the <code>&lt;-ctx.Done()</code> will be executed.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>ctx, cancel := context.WithTimeout(\n    context.Background(),\n    time.Duration(3*time.Second))\n\ngo func(ctx context.Context) {\n    // simulate a process that takes 2 second to complete\n    time.Sleep(2 * time.Second)\n\n    // cancel context by force, assuming the whole process is complete\n    cancel()\n}(ctx)\n\nselect {\ncase &lt;-ctx.Done():\n    switch ctx.Err() {\n    case context.DeadlineExceeded:\n        fmt.Println(\"context timeout exceeded\")\n    case context.Canceled:\n        fmt.Println(\"context cancelled by force. whole process is complete\")\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ go run test.go \ncontext cancelled by force\n</code></pre>\n\n<hr>\n\n<h2>Example #2 scenario: context timeout exceeded</h2>\n\n<p>In this scenario, we make the process takes longer than context timeout, so ideally the <code>&lt;-ctx.Done()</code> will also be executed.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>ctx, cancel := context.WithTimeout(\n    context.Background(),\n    time.Duration(3*time.Second))\n\ngo func(ctx context.Context) {\n    // simulate a process that takes 4 second to complete\n    time.Sleep(4 * time.Second)\n\n    // cancel context by force, assuming the whole process is complete\n    cancel()\n}(ctx)\n\nselect {\ncase &lt;-ctx.Done():\n    switch ctx.Err() {\n    case context.DeadlineExceeded:\n        fmt.Println(\"context timeout exceeded\")\n    case context.Canceled:\n        fmt.Println(\"context cancelled by force. whole process is complete\")\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ go run test.go \ncontext timeout exceeded\n</code></pre>\n\n<hr>\n\n<h2>Example #3 scenario: context canceled by force causing by some error</h2>\n\n<p>There will be likely a condition where we need to stop the goroutine in the middle of the process because some errors occurred. And sometimes we want to bring the error information to the main route. To make it happen, we might need an additional channel to indicate that goroutine is stopped because of the error.</p>\n\n<p>In the below example, I've prepared a new channel, <code>chErr</code>. Whenever an error happens in the middle of (goroutine) process, then we will send the error object through the channel and then stop the process immediately.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>ctx, cancel := context.WithTimeout(\n    context.Background(),\n    time.Duration(3*time.Second))\n\nchErr := make(chan error)\n\ngo func(ctx context.Context) {\n    // ... some process ...\n\n    if err != nil {\n        // cancel context by force, an error occurred\n        chErr &lt;- err\n        return\n    }\n\n    // ... some other process ...\n\n    // cancel context by force, assuming the whole process is complete\n    cancel()\n}(ctx)\n\nselect {\ncase &lt;-ctx.Done():\n    switch ctx.Err() {\n    case context.DeadlineExceeded:\n        fmt.Println(\"context timeout exceeded\")\n    case context.Canceled:\n        fmt.Println(\"context cancelled by force. whole process is complete\")\n    }\ncase err := &lt;-chErr:\n    fmt.Println(\"process fail causing by some error:\", err.Error())\n}\n</code></pre>\n\n<hr>\n\n<h2>Additional info #1: calling <code>cancel()</code> right after context initialized</h2>\n\n<p>As per <a href=\"https://golang.org/pkg/context/#Context\" rel=\"noreferrer\">context documentation</a> regarding the <code>cancel()</code> function:</p>\n\n<blockquote>\n  <p>Canceling this context releases resources associated with it, so code should call cancel as soon as the operations running in this Context complete.</p>\n</blockquote>\n\n<p>It's good to always call <code>cancel()</code> function right after the context declaration. doesn't matter whether it's also called within the goroutine. This is due to ensure context is always cancelled when the whole process within the block are fully complete.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>ctx, cancel := context.WithTimeout(\n    context.Background(),\n    time.Duration(3*time.Second))\ndefer cancel()\n\n// ...\n</code></pre>\n\n<hr>\n\n<h2>Additional info #2: <code>defer cancel()</code> call within goroutine</h2>\n\n<p>You can use <code>defer</code> on the <code>cancel()</code> statement within the goroutine (if you want).</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// ...\n\ngo func(ctx context.Context) {\n    defer cancel()\n\n    // ...\n}(ctx)\n\n// ...\n</code></pre>\n"}], "owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11301, "favorite_count": 3, "answer_count": 2, "score": 7, "last_activity_date": 1607414725, "creation_date": 1539488436, "last_edit_date": 1607414725, "question_id": 52799280, "link": "https://stackoverflow.com/questions/52799280/context-confusion-regarding-cancellation", "title": "Context confusion regarding cancellation", "body": "<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc myfunc(ctx context.Context) {\n    for {\n        select {\n        case &lt;-ctx.Done():\n            fmt.Printf(\"Ctx is kicking in with error:%+v\\n\", ctx.Err())\n            return\n        default:\n            time.Sleep(15 * time.Second)\n            fmt.Printf(\"I was not canceled\\n\")\n            return\n        }\n    }\n}\n\nfunc main() {\n    ctx, cancel := context.WithTimeout(\n        context.Background(),\n        time.Duration(3*time.Second))\n    defer cancel()\n\n    var wg sync.WaitGroup\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        myfunc(ctx)\n    }()\n\n    wg.Wait()\n    fmt.Printf(\"In main, ctx err is %+v\\n\", ctx.Err())\n}\n</code></pre>\n\n<p>I have the above snippet that does print the output like this</p>\n\n<pre><code>I was not canceled\nIn main, ctx err is context deadline exceeded\n\nProcess finished with exit code 0\n</code></pre>\n\n<p>I understand that <code>context</code> times-out after 3 seconds and hence it does give me the expected error when I call <code>ctx.Err()</code> in the end. I also get the fact that in my <code>myfunc</code> once <code>select</code> matches on the case for <code>default</code>, it won't match on the <code>done</code>. What I do not understand is that how do I make my <code>go func myfunc</code> get aborted in 3 seconds using the context logic. Basically, it won't terminate in 3 seconds so I am trying to understand how can golang's <code>ctx</code> help me with this?</p>\n"}, {"tags": ["go", "concurrency", "mutex", "goroutine"], "comments": [{"owner": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "edited": false, "score": 0, "creation_date": 1539465990, "post_id": 52797446, "comment_id": 92514682, "body": "You are only locking around writes, you need to lock around reads too."}, {"owner": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "edited": false, "score": 0, "creation_date": 1539466121, "post_id": 52797446, "comment_id": 92514713, "body": "Since you didn&#39;t include a corresponding read method, I assume you&#39;re reading from the <code>urls</code> map somewhere else in your package."}, {"owner": {"reputation": 754, "user_id": 4379762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e0a911a9fe018db744b4565f3dfc6d?s=128&d=identicon&r=PG&f=1", "display_name": "eriel marimon", "link": "https://stackoverflow.com/users/4379762/eriel-marimon"}, "reply_to_user": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "edited": false, "score": 0, "creation_date": 1539467083, "post_id": 52797446, "comment_id": 92514937, "body": "No read was being performed at this point. The struct was used to mimic a set basically to check if the URL had been seen before or not. The check happens with the add() function. Now I have added a size() function that does locks in order to get the size of the map."}], "answers": [{"tags": [], "owner": {"reputation": 26649, "user_id": 188702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9257dbb2fdd9d164711aa191420ef621?s=128&d=identicon&r=PG", "display_name": "Dominic Barnes", "link": "https://stackoverflow.com/users/188702/dominic-barnes"}, "is_accepted": true, "score": 4, "last_activity_date": 1539467039, "creation_date": 1539467039, "answer_id": 52797621, "question_id": 52797446, "link": "https://stackoverflow.com/questions/52797446/why-go-panics-with-concurrent-map-writes-even-with-locks-in-place/52797621#52797621", "title": "Why GO panics with &#39;concurrent map writes&#39; even with locks in place?", "body": "<p>Upon reading the code on Github that you linked to, the <code>crawl()</code> function accepts a <code>concurrentStorage</code> (not a pointer).</p>\n\n<p>For each de-reference (ie: <code>*urlSet</code>) when calling <code>crawl()</code>, you are copying the <code>concurrentStorage</code> struct (including the <code>sync.Mutex</code>) while the map retains the pointer to the original. This means that your mutexes are isolated to each goroutine, while they are sharing the same state.</p>\n\n<p>If you change <code>crawl()</code> to accept a pointer instead, and stop de-referencing <code>concurrentStorage</code>, it will work as you intend.</p>\n"}], "owner": {"reputation": 754, "user_id": 4379762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e0a911a9fe018db744b4565f3dfc6d?s=128&d=identicon&r=PG&f=1", "display_name": "eriel marimon", "link": "https://stackoverflow.com/users/4379762/eriel-marimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 0, "accepted_answer_id": 52797621, "answer_count": 1, "score": 0, "last_activity_date": 1545165161, "creation_date": 1539465693, "last_edit_date": 1545165161, "question_id": 52797446, "link": "https://stackoverflow.com/questions/52797446/why-go-panics-with-concurrent-map-writes-even-with-locks-in-place", "title": "Why GO panics with &#39;concurrent map writes&#39; even with locks in place?", "body": "<p>When trying to use this struct with multiple goroutines sometimes I get one of these errors:</p>\n\n<p><code>fatal error: concurrent map read and map write</code></p>\n\n<p>or </p>\n\n<p><code>concurrent map writes</code></p>\n\n<p>After reading the <a href=\"https://github.com/golang/go/issues/20060\" rel=\"nofollow noreferrer\">this thread</a> I made sure to return a reference in the constructor and pass in a reference to the receivers. </p>\n\n<p>The entirety of the code where this is being used is in <a href=\"https://github.com/aldeano19/JuliusCaesar/blob/master/url-scraper.go\" rel=\"nofollow noreferrer\">this github repo</a></p>\n\n<pre><code>type concurrentStorage struct {\n    sync.Mutex\n    domain string\n    urls map[url.URL]bool\n}\n\nfunc newConcurrentStorage(d string) *concurrentStorage{\n    return &amp;concurrentStorage{\n        domain: d,\n        urls: map[url.URL]bool{},\n    }\n}\n\nfunc (c *concurrentStorage) add(u url.URL) (bool) {\n    c.Lock()\n    defer c.Unlock()\n    if _, ok := c.urls[u]; ok{\n        return false\n    }\n    c.urls[u] = true\n    return true\n}\n</code></pre>\n"}, {"tags": ["go", "encryption", "rsa", "public-key-encryption", "public-key"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1539467981, "creation_date": 1539467981, "answer_id": 52797711, "question_id": 52797337, "link": "https://stackoverflow.com/questions/52797337/how-to-generate-entropy-by-myself-rsa-golang/52797711#52797711", "title": "How to generate entropy by myself? - RSA Golang", "body": "<p>By design, it is possible and it is easy to do. Provide any <code>io.Reader</code> as the <code>random</code> argument. </p>\n\n<p>Here's an example from the Go <code>crypto/rsa</code> package. I replaced the <code>crypto/rand</code> <code>io.Reader</code> with a <code>math/rand</code> <code>io.Reader</code> .</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/rsa\"\n    \"crypto/sha256\"\n    \"fmt\"\n    \"math/big\"\n    \"math/rand\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    secretMessage := []byte(\"send reinforcements, we're going to advance\")\n    label := []byte(\"orders\")\n\n    // crypto/rand.Reader is a good source of entropy for randomizing the\n    // encryption function.\n    // rng := rand.Reader\n    // However, you can use any io.Reader.\n    // For example, math/rand.Reader\n    rng := rand.New(rand.NewSource(time.Now().UnixNano()))\n\n    ciphertext, err := rsa.EncryptOAEP(sha256.New(), rng, &amp;test2048Key.PublicKey, secretMessage, label)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error from encryption: %s\\n\", err)\n        return\n    }\n\n    // Since encryption is a randomized function, ciphertext will be\n    // different each time.\n    fmt.Printf(\"Ciphertext: %x\\n\", ciphertext)\n}\n\nfunc fromBase10(base10 string) *big.Int {\n    i, ok := new(big.Int).SetString(base10, 10)\n    if !ok {\n        panic(\"bad number: \" + base10)\n    }\n    return i\n}\n\nvar test2048Key *rsa.PrivateKey\n\nfunc init() {\n    test2048Key = &amp;rsa.PrivateKey{\n        PublicKey: rsa.PublicKey{\n            N: fromBase10(\"14314132931241006650998084889274020608918049032671858325988396851334124245188214251956198731333464217832226406088020736932173064754214329009979944037640912127943488972644697423190955557435910767690712778463524983667852819010259499695177313115447116110358524558307947613422897787329221478860907963827160223559690523660574329011927531289655711860504630573766609239332569210831325633840174683944553667352219670930408593321661375473885147973879086994006440025257225431977751512374815915392249179976902953721486040787792801849818254465486633791826766873076617116727073077821584676715609985777563958286637185868165868520557\"),\n            E: 3,\n        },\n        D: fromBase10(\"9542755287494004433998723259516013739278699355114572217325597900889416163458809501304132487555642811888150937392013824621448709836142886006653296025093941418628992648429798282127303704957273845127141852309016655778568546006839666463451542076964744073572349705538631742281931858219480985907271975884773482372966847639853897890615456605598071088189838676728836833012254065983259638538107719766738032720239892094196108713378822882383694456030043492571063441943847195939549773271694647657549658603365629458610273821292232646334717612674519997533901052790334279661754176490593041941863932308687197618671528035670452762731\"),\n        Primes: []*big.Int{\n            fromBase10(\"130903255182996722426771613606077755295583329135067340152947172868415809027537376306193179624298874215608270802054347609836776473930072411958753044562214537013874103802006369634761074377213995983876788718033850153719421695468704276694983032644416930879093914927146648402139231293035971427838068945045019075433\"),\n            fromBase10(\"109348945610485453577574767652527472924289229538286649661240938988020367005475727988253438647560958573506159449538793540472829815903949343191091817779240101054552748665267574271163617694640513549693841337820602726596756351006149518830932261246698766355347898158548465400674856021497190430791824869615170301029\"),\n        },\n    }\n    test2048Key.Precompute()\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/KtqUuDC2Tai\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KtqUuDC2Tai</a></p>\n\n<p>Output:</p>\n\n<pre><code>Ciphertext: 47516ff9863897f8f5344d07bca363515856ace56fed5451ede414eb6771eff357f09ca67f07d0d918b6e7107975f83afc4eebc932a7d9ba3f48c3f70399af88917c852e46a3d43eaa9bc563c7780bf7cf090c0b5e1690ac77af9e7c8cc6ec0d2fb729eed3fb45c824754bfd898e02eee8dae88b4fb3277f6970dbb0b929da7c14d245e51ed3a3e63127efc3e4c438adcfce78bbc1117a134f5a9dd62f9ebc14f125561c959ce6963a2b8605687ab568ec570295bb8f25477c7bbcb7303d96e888a0150e23ea0dd4880fefe40d86567518784d7f54c594f2c0e576a14c210201bf9d75fbd96b70fdd793c28ffecaa5c036b2949dba6e66004ec2f0e676095f1c\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9508850, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216299826511976/picture?type=large", "display_name": "Yamil", "link": "https://stackoverflow.com/users/9508850/yamil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 2, "accepted_answer_id": 52797711, "answer_count": 1, "score": 2, "last_activity_date": 1539467981, "creation_date": 1539464886, "last_edit_date": 1539465975, "question_id": 52797337, "link": "https://stackoverflow.com/questions/52797337/how-to-generate-entropy-by-myself-rsa-golang", "title": "How to generate entropy by myself? - RSA Golang", "body": "<p>I'm working with Golang's RSA encryption library. The following is the function to encrypt a message:</p>\n\n<pre><code>func EncryptOAEP(hash hash.Hash, random io.Reader, pub *PublicKey, msg []byte, label []byte) ([]byte, error)\n</code></pre>\n\n<p>The random parameter is used as a source of entropy to ensure that encrypting the same message twice doesn't result in the same ciphertext. This parameter allow to use linux functions like getrandom(2) if available or /dev/urandom otherwise that serves as a random number generator by accessing environmental noise collected from devices and other sources. I don't want the EncryptOAEP function to use the functions of the operating system (getrandom(2) or /dev/urandom) to generate the random number. I need to generate a random number by myself (that is, outside the EncryptOAEP function) and then insert it into it. Is that possible with this library? In case it is not, what Golang's library could I use to achieve this behavior? I hope I was clear enough, any help will be appreciated, thanks!</p>\n"}, {"tags": ["go", "append", "slice"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1539463914, "post_id": 52797030, "comment_id": 92514195, "body": "Well, because you&#39;re not using the return value of append. Append may return a new slice, so you have to assign the return value. <a href=\"https://tour.golang.org/moretypes/15\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/15</a>"}, {"owner": {"reputation": 21, "user_id": 3947410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb4792035db0bc726af49e6e6e714f76?s=128&d=identicon&r=PG", "display_name": "gtalton007", "link": "https://stackoverflow.com/users/3947410/gtalton007"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1539464771, "post_id": 52797030, "comment_id": 92514398, "body": "Yep, that fixed the compile error, next question is this going to allocate a new slice?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1539470923, "post_id": 52797030, "comment_id": 92515759, "body": "The <a href=\"https://godoc.org/builtin#append\" rel=\"nofollow noreferrer\">append documentation</a> answers your next question."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1539506723, "post_id": 52797030, "comment_id": 92520788, "body": "See also <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}], "answers": [{"tags": [], "owner": {"reputation": 44, "user_id": 6737528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YXGoAYQGQrg/AAAAAAAAAAI/AAAAAAAAAA4/R_sW5Kl88IU/photo.jpg?sz=128", "display_name": "GerryLon", "link": "https://stackoverflow.com/users/6737528/gerrylon"}, "is_accepted": true, "score": 0, "last_activity_date": 1539749726, "creation_date": 1539749726, "answer_id": 52847200, "question_id": 52797030, "link": "https://stackoverflow.com/questions/52797030/golang-remove-dup-ints-from-slice-append-function-evaluated-but-not-used/52847200#52847200", "title": "Golang remove dup ints from slice append function &quot;evaluated but not used&quot;", "body": "<p><a href=\"https://stackoverflow.com/questions/45004854/golang-append-evaluated-but-not-used\">\"evaluated but not used\" error</a>.</p>\n\n<p>Code below is my idea. I think your code is not very clear.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc removeDuplicates(testArr *[]int) int {\n    m := make(map[int]bool)\n    arr := make([]int, 0)\n\n    for curIndex := 0; curIndex &lt; len((*testArr)); curIndex++ {\n        curValue := (*testArr)[curIndex]\n        if has :=m[curValue]; !has {\n            m[curValue] = true\n            arr = append(arr, curValue)\n        }\n    }\n    *testArr = arr\n    return len(*testArr)\n}\n\nfunc main() {\n    testArr := []int{0, 0, 1, 1, 1, 2, 2, 3, 3, 4}\n\n    nonDupSize := removeDuplicates(&amp;testArr)\n\n    fmt.Printf(\"nonDupSize = %d\", nonDupSize)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3947410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb4792035db0bc726af49e6e6e714f76?s=128&d=identicon&r=PG", "display_name": "gtalton007", "link": "https://stackoverflow.com/users/3947410/gtalton007"}, "is_accepted": false, "score": 0, "last_activity_date": 1539861642, "creation_date": 1539861642, "answer_id": 52872832, "question_id": 52797030, "link": "https://stackoverflow.com/questions/52797030/golang-remove-dup-ints-from-slice-append-function-evaluated-but-not-used/52872832#52872832", "title": "Golang remove dup ints from slice append function &quot;evaluated but not used&quot;", "body": "<p>Peter's answer nailed it, the compile error was due to not grabbing the return value from append()</p>\n"}], "owner": {"reputation": 21, "user_id": 3947410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb4792035db0bc726af49e6e6e714f76?s=128&d=identicon&r=PG", "display_name": "gtalton007", "link": "https://stackoverflow.com/users/3947410/gtalton007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 52847200, "answer_count": 2, "score": 0, "last_activity_date": 1539861642, "creation_date": 1539462435, "question_id": 52797030, "link": "https://stackoverflow.com/questions/52797030/golang-remove-dup-ints-from-slice-append-function-evaluated-but-not-used", "title": "Golang remove dup ints from slice append function &quot;evaluated but not used&quot;", "body": "<p>I can't get this Go lang test program to run. The compiler keeps giving an error on the append() function call below with an \"evaluated but not used\" error. I can't figure out why.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc removeDuplicates(testArr *[]int) int {\n\n    prevValue := (*testArr)[0]\n    for curIndex := 1; curIndex &lt; len((*testArr)); curIndex++ {\n        curValue := (*testArr)[curIndex]\n        if curValue == prevValue {\n            append((*testArr)[:curIndex], (*testArr)[curIndex+1:]...)\n        }\n        prevValue = curValue\n    }\n    return len(*testArr)\n}\n\nfunc main() {\n    testArr := []int{0, 0, 1, 1, 1, 2, 2, 3, 3, 4}\n\n    nonDupSize := removeDuplicates(&amp;testArr)\n\n    fmt.Printf(\"nonDupSize = %d\", nonDupSize)\n}\n</code></pre>\n"}]