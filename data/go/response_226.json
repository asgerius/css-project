[{"tags": ["list", "go", "yaml", "default"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557353389, "post_id": 56049589, "comment_id": 98740758, "body": "Have you tried <code>viper.SetDefault(&quot;connections.ssl&quot;, true)</code>? ie without the <code>[]</code> and passing in an actual boolean value instead of a string."}, {"owner": {"reputation": 186, "user_id": 1372810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c4830c584f88bfe443e7a21f085f4c?s=128&d=identicon&r=PG", "display_name": "Vadym Myrgorod", "link": "https://stackoverflow.com/users/1372810/vadym-myrgorod"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1557353814, "post_id": 56049589, "comment_id": 98740870, "body": "Yes, it does not work. It works only for the struct in case if connections is not an array, but this is not what I need."}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1557359258, "post_id": 56049589, "comment_id": 98742069, "body": "It seems like the problem is that you don&#39;t know how many elements are in the Connections collection until you unmarshal, so there isn&#39;t a good way to initialize the slice with defaults. Do you have control over the definition of the <code>Config</code> struct itself? Renaming the properties to <code>NoSsl</code> and <code>NoSslVerify</code> might be a good way to re-frame things in this case."}, {"owner": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 0, "creation_date": 1557377931, "post_id": 56049589, "comment_id": 98745758, "body": "You can load this as a hashmap first, fill in the gaps, dump (to file or string), then reload using the appropriate types. That way you don&#39;t have to do checks during the rest of the run-time."}], "answers": [{"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1557389259, "last_edit_date": 1557389259, "creation_date": 1557388547, "answer_id": 56054708, "question_id": 56049589, "link": "https://stackoverflow.com/questions/56049589/what-is-the-way-to-set-default-values-on-keys-in-lists-when-unmarshalling-yaml-i/56054708#56054708", "title": "What is the way to set default values on keys in lists when unmarshalling Yaml in Go?", "body": "<p>You can use a function to do the job:</p>\n\n<pre><code>type Connection struct {\n    Name      string\n    Hosts     []string\n    Username  string\n    Password  string\n    Ssl       *bool\n    SslVerify bool\n    Version   int\n}\n\n// If Ssl is nil, returns true\n// otherwise the value\nfunc (c Connection) IsSSL() bool {\n    return c.Ssl == nil || *c.Ssl\n}\n\ntype Config struct {\n    Connections []Connection\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Or, even better, simply invert the logic of your booleans:</p>\n\n<pre><code>type Connection struct {\n    Name          string\n    Hosts         []string\n    Username      string\n    Password      string\n    SkipSsl       bool\n    SkipSslVerify bool\n    Version       int\n}\n</code></pre>\n\n<p>This way, SSL would be used unless explicitly told different in the config - which would stand out when somebody reads the config.</p>\n"}, {"comments": [{"owner": {"reputation": 3359, "user_id": 122727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b5e946def051f311e802140ecb9fbf?s=128&d=identicon&r=PG", "display_name": "kubanczyk", "link": "https://stackoverflow.com/users/122727/kubanczyk"}, "edited": false, "score": 0, "creation_date": 1599560995, "post_id": 56080478, "comment_id": 112804828, "body": "<code>type plain Connection</code> that is elegant. This should be included in the example of the UnmarshalYAML (currently non-existent) in godoc."}], "tags": [], "owner": {"reputation": 186, "user_id": 1372810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c4830c584f88bfe443e7a21f085f4c?s=128&d=identicon&r=PG", "display_name": "Vadym Myrgorod", "link": "https://stackoverflow.com/users/1372810/vadym-myrgorod"}, "is_accepted": false, "score": 3, "last_activity_date": 1557533772, "last_edit_date": 1557533772, "creation_date": 1557501455, "answer_id": 56080478, "question_id": 56049589, "link": "https://stackoverflow.com/questions/56049589/what-is-the-way-to-set-default-values-on-keys-in-lists-when-unmarshalling-yaml-i/56080478#56080478", "title": "What is the way to set default values on keys in lists when unmarshalling Yaml in Go?", "body": "<p>I figured it out. I am using <code>github.com/creasty/defaults</code> in the <code>UnmarshalYAML</code> callback.</p>\n\n<pre><code>\ntype Config struct {\n    Connections []Connection\n}\n\ntype Connection struct {\n    Name      string\n    Hosts     []string\n    Username  string\n    Password  string\n    Ssl       bool `default:\"true\"`\n    SslVerify bool `default:\"true\" yaml:\"ssl_verify\"`\n    Version   int  `version:\"7\"`\n}\n\nfunc (s *Connection) UnmarshalYAML(unmarshal func(interface{}) error) error {\n    defaults.Set(s)\n\n    type plain Connection\n    if err := unmarshal((*plain)(s)); err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>Also this solution pairs well with <a href=\"https://github.com/dealancer/validate\" rel=\"nofollow noreferrer\">https://github.com/dealancer/validate</a> for validation purpose.</p>\n"}], "owner": {"reputation": 186, "user_id": 1372810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c4830c584f88bfe443e7a21f085f4c?s=128&d=identicon&r=PG", "display_name": "Vadym Myrgorod", "link": "https://stackoverflow.com/users/1372810/vadym-myrgorod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4020, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1557533772, "creation_date": 1557352797, "question_id": 56049589, "link": "https://stackoverflow.com/questions/56049589/what-is-the-way-to-set-default-values-on-keys-in-lists-when-unmarshalling-yaml-i", "title": "What is the way to set default values on keys in lists when unmarshalling Yaml in Go?", "body": "<p>I have a YAML like one below.</p>\n\n<pre><code>connections:\n  - name: demo\n    hosts:\n      - demo.example.com:9200\n    username: admin\n    password: password\n    ssl: true\n    ssl_verify: true\n    version: 7\n  - name: test\n    hosts:\n      - \"test.example.com:9200\"\n    username: admin\n    password: password\n</code></pre>\n\n<p>As you can see <code>ssl</code> and <code>ssl_verify</code> is not set in the second item of the list. I want them by default to be <code>true</code>, however, it is not happening. I tried different solutions.</p>\n\n<ol>\n<li>Viper defaults - does not work.</li>\n</ol>\n\n<pre><code>viper.SetDefault(\"connections[].ssl\", \"true\")\n</code></pre>\n\n<ol start=\"2\">\n<li><a href=\"https://github.com/creasty/defaults\" rel=\"nofollow noreferrer\">https://github.com/creasty/defaults</a> - does not work.</li>\n</ol>\n\n<pre><code>type Config struct {\n    Connections []struct {\n        Name      string\n        Hosts     []string\n        Username  string\n        Password  string\n        Ssl       bool `default:\"true\"`\n        SslVerify bool `default:\"true\"`\n        Version   int\n    }\n}\n\n...\n\nerr := defaults.Set(config)\n\n</code></pre>\n\n<ol start=\"3\">\n<li><p>Manually looping through the list of structures. While these method work with strings, it does not work with boolean values because they are already initialized with <code>false</code> after unmarshalling and we don't know for sure whether <code>false</code> is entered by the user or not.</p></li>\n<li><p>Using pointers with boolean values. This works as uninitialized values are equal to <code>nil</code> and they are easy to catch. However, it will require to dereference pointers when using config struct, which is not very convenient. Alternatively, a new struct can be generated based on the one that comes from unmarshalling.</p></li>\n</ol>\n\n<pre><code>type Config struct {\n    Connections []struct {\n        Name      string\n        Hosts     []string\n        Username  string\n        Password  string\n        Ssl       *bool\n        SslVerify *bool\n        Version   int\n    }\n}\n</code></pre>\n\n<ol start=\"5\">\n<li>Using hashmap instead of struct. This works because empty values are not initialized, however, it will require to run checks on the map elements before accessing them or to convert a map to the struct.</li>\n</ol>\n\n<p>Solutions 4 and 5 will likely work, but I am wondering if there anything better than that.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 2, "creation_date": 1557346356, "post_id": 56048259, "comment_id": 98738212, "body": "@colminator not a duplicate. The OP is asking if a further element would be printed if it&#39;s deleted in previous iteration."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1557346667, "post_id": 56048259, "comment_id": 98738326, "body": "The OP is <i>not</i> asking that."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1557346690, "post_id": 56048259, "comment_id": 98738340, "body": "Well, the actual question is is nearly identically worded as <a href=\"https://stackoverflow.com/questions/23229975/is-it-safe-to-remove-selected-keys-from-map-within-a-range-loop\">Is it safe to remove selected keys from map within a range loop</a>, and the answer regardless is just quoted from the spec."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557348784, "post_id": 56048259, "comment_id": 98739240, "body": "they are sort of two sides of the same coin ... that question focuses on the case when it <i>is</i> safe, but my question is more specifically about the case when it is unsafe (my code in the question)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1557352481, "post_id": 56048259, "comment_id": 98740509, "body": "But it <i>is</i> safe, so how do the questions differ? Also, iteration order is non-deterministic, so your example may print one or both values at runtime."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557355470, "post_id": 56048259, "comment_id": 98741262, "body": "Ok, maybe &quot;safe&quot; isn&#39;t the right term, but my code in the question wouldn&#39;t <i>dependably</i> do as intended"}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1557346284, "post_id": 56048297, "comment_id": 98738179, "body": "Thank you for this. So, my example in the question would not dependably work. What about if I only delete the key being currently processed (similar to Ruby&#39;s <a href=\"https://apidock.com/ruby/Array/delete_if\" rel=\"nofollow noreferrer\">delete_if</a>)? That would be safe, because the map entry being removed <i>has</i> already been reached during iteration?"}, {"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1557346684, "post_id": 56048297, "comment_id": 98738338, "body": "@maxpleaner If I get it right, if you delete the key in the same iteration, it would still work because it&#39;s already loaded in <code>key</code> and <code>val</code> of the loop."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1557346019, "creation_date": 1557346019, "answer_id": 56048297, "question_id": 56048259, "link": "https://stackoverflow.com/questions/56048259/is-it-safe-to-remove-dictionary-keys-while-iterating-over-it/56048297#56048297", "title": "Is it safe to remove dictionary keys while iterating over it?", "body": "<p>As always, <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">the spec</a> is the definitive answer. Scroll down to \"For statements with range clause\", item 3 (emphasis mine):</p>\n\n<blockquote>\n  <p>The iteration order over maps is not specified and is not guaranteed to be the same from one iteration to the next. <strong>If a map entry that has not yet been reached is removed during iteration, the corresponding iteration value will not be produced</strong>. If a map entry is created during iteration, that entry may be produced during the iteration or may be skipped. The choice may vary for each entry created and from one iteration to the next. If the map is nil, the number of iterations is 0.</p>\n</blockquote>\n"}], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "closed_date": 1557348450, "answer_count": 1, "score": 1, "last_activity_date": 1557346457, "creation_date": 1557345827, "question_id": 56048259, "link": "https://stackoverflow.com/questions/56048259/is-it-safe-to-remove-dictionary-keys-while-iterating-over-it", "closed_reason": "Duplicate", "title": "Is it safe to remove dictionary keys while iterating over it?", "body": "<p>I wrote some code which does this, and it is working fine, but when reviewing the code I realize what I did might not have worked in other languages.</p>\n\n<p>To give a contrived example:</p>\n\n<pre><code>dict := map[string]string{ \"a\": \"1\", \"b\": \"2\" }\n\nfor key, val := range dict {\n  fmt.Println(val)\n   delete(dict, \"b\")\n}\n</code></pre>\n\n<p>This prints \"1\" and \"2\", and when I inspect <code>dict</code> afterward it is <code>{ \"a\": \"1\" }</code> only.</p>\n\n<p>So, I get the impression that it <em>is</em> safe to do this, but I'm wondering why? </p>\n\n<p>Does <code>range dict</code> create a copy internally?</p>\n"}, {"tags": ["unit-testing", "go", "testing"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1557343311, "post_id": 56047649, "comment_id": 98736967, "body": "I&#39;m not sure what the &quot;stats&quot; package is, but why can&#39;t you just read them after each test step?"}, {"owner": {"reputation": 17856, "user_id": 1439168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd72ad672b055a7d59cfb1c30d1c724f?s=128&d=identicon&r=PG", "display_name": "Miguel Mota", "link": "https://stackoverflow.com/users/1439168/miguel-mota"}, "edited": false, "score": 1, "creation_date": 1557343402, "post_id": 56047649, "comment_id": 98737004, "body": "@vpham you can wrap the 3rd party library and return something that you can test with"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557344340, "post_id": 56047649, "comment_id": 98737399, "body": "Using the &quot;real&quot; stats library, this is an integration test. To unit test this code, you would use a mock/stub instead and use that to ensure the logic is correct."}], "owner": {"reputation": 9, "user_id": 8098868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/284a7399ae10f653f7094b802052b2a2?s=128&d=identicon&r=PG&f=1", "display_name": "vpham", "link": "https://stackoverflow.com/users/8098868/vpham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1557344674, "answer_count": 0, "score": 0, "last_activity_date": 1557343124, "creation_date": 1557343124, "question_id": 56047649, "link": "https://stackoverflow.com/questions/56047649/is-there-a-way-to-unit-test-if-a-function-correctly-executes-stats-and-logs-in-g", "closed_reason": "Duplicate", "title": "Is there a way to unit test if a function correctly executes stats and logs in Go?", "body": "<p>I'm trying to write a unit test for a function that checks a URL string input and increments some stats using a third party package depending on what that URL string is. Since this function only increments stats and returns, how can this be unit tested?</p>\n\n<p>Right now, I just have a test that basically makes sure the function returns and doesn't segfault. The function returns increments different stats and returns no matter what, so my test will pass for all string inputs. </p>\n\n<pre><code>func handleStats(url string) {\n    if url == \"\" {\n        stats.Increment(metricForEmptyStringURL)\n        return\n    }\n    stats.Increment(metricForNonEmptyURL)\n    if strings.Contains(url, \"${\") {\n        stats.Increment(metricCorrectlyEncodedURL)\n    }\n}\n</code></pre>\n\n<p>This is what I currently have (which is not useful since it'll always pass):</p>\n\n<pre><code>func Test_handleStats(t *testing.T) {\n    tests := []struct {\n        name string\n        url  string\n    }{\n        {name: \"Blank\", url: \"\"},\n        {name: \"No encoding\", url: \"http://testurl.com/\"},\n        {name: \"With encoding\", url: \"http://testurl.com/${ENCODING}\"},\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            handleStats(tt.url)\n        })\n    }\n}\n</code></pre>\n\n<p>What is the best way to test something like this?</p>\n"}, {"tags": ["image", "go", "graphics", "sdl", "goroutine"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557339652, "post_id": 56046520, "comment_id": 98735359, "body": "&quot;I tried but get weird results.&quot; can you define &quot;weird results&quot;?"}, {"owner": {"reputation": 84, "user_id": 10011729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pRN-9smfua0/AAAAAAAAAAI/AAAAAAAAACQ/0m2EjUAktHw/photo.jpg?sz=128", "display_name": "Pourya ", "link": "https://stackoverflow.com/users/10011729/pourya"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557346487, "post_id": 56046520, "comment_id": 98738263, "body": "Sometimes it works. Sometimes not. Sometimes it will close the window after 5 seconds but sometimes after 10 seconds."}], "answers": [{"comments": [{"owner": {"reputation": 84, "user_id": 10011729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pRN-9smfua0/AAAAAAAAAAI/AAAAAAAAACQ/0m2EjUAktHw/photo.jpg?sz=128", "display_name": "Pourya ", "link": "https://stackoverflow.com/users/10011729/pourya"}, "edited": false, "score": 0, "creation_date": 1557346659, "post_id": 56046897, "comment_id": 98738324, "body": "So is there any solution for me if I want to have multiple thread."}, {"owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "reply_to_user": {"reputation": 84, "user_id": 10011729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pRN-9smfua0/AAAAAAAAAAI/AAAAAAAAACQ/0m2EjUAktHw/photo.jpg?sz=128", "display_name": "Pourya ", "link": "https://stackoverflow.com/users/10011729/pourya"}, "edited": false, "score": 0, "creation_date": 1557367759, "post_id": 56046897, "comment_id": 98743626, "body": "No you can certainly do it...however you generally want to do any extra computation and/or io on other threads and then do the necessary synchronization to eventually get that data onto to the main thread so your UI can be updated correctly.  You need to think of the main thread as being dedicated to your UI and event loop and other threads as being usable for other work but where that work must properly be \u201cpassed\u201d to your main thread in a way that is threadsafe."}, {"owner": {"reputation": 84, "user_id": 10011729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pRN-9smfua0/AAAAAAAAAAI/AAAAAAAAACQ/0m2EjUAktHw/photo.jpg?sz=128", "display_name": "Pourya ", "link": "https://stackoverflow.com/users/10011729/pourya"}, "edited": false, "score": 0, "creation_date": 1557379919, "post_id": 56046897, "comment_id": 98746324, "body": "I kept the sdl in my main thread and moved others to other threads and it&#39;s working."}], "tags": [], "owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "is_accepted": true, "score": 3, "last_activity_date": 1557339745, "creation_date": 1557339745, "answer_id": 56046897, "question_id": 56046520, "link": "https://stackoverflow.com/questions/56046520/run-and-use-sdl-in-a-goroutine-in-go/56046897#56046897", "title": "Run and use SDL in a Goroutine in go", "body": "<p>Be careful as using SDL from multiple threads is not entirely trivial. Typically, your SDL loop must sit in the <code>main</code> thread. There is a good reason for that and it's because the event loop is part of the <code>main</code> thread and many of your objects are created and mutated on the <code>main</code> thread...or at least they should be. </p>\n\n<p>When you introduce multiple threads weird undefined and dangerous behavior could happen. This is why a good rule of thumb is to use <code>runtime.LockOSThread</code> to ensure the Go runtime doesn't pin your <code>main</code> goroutine to other threads and keeps it on the <code>main</code> thread.</p>\n\n<p>See this for more details: <a href=\"https://github.com/campoy/flappy-gopher/blob/master/main.go#L66\" rel=\"nofollow noreferrer\">enter link description here</a></p>\n"}], "owner": {"reputation": 84, "user_id": 10011729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pRN-9smfua0/AAAAAAAAAAI/AAAAAAAAACQ/0m2EjUAktHw/photo.jpg?sz=128", "display_name": "Pourya ", "link": "https://stackoverflow.com/users/10011729/pourya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 56046897, "answer_count": 1, "score": 1, "last_activity_date": 1557339745, "creation_date": 1557338061, "question_id": 56046520, "link": "https://stackoverflow.com/questions/56046520/run-and-use-sdl-in-a-goroutine-in-go", "title": "Run and use SDL in a Goroutine in go", "body": "<p>I have a program with multiple multiple loops, each one ran in a Goroutine. I need to plug or unplug monitors while my program runs, so I have to restart the sdl to let it find my new monitors, I do it by sdl.quit() to quit the last sdl and sdl.init(sdl.InitEverything) to initialize it again. \nMy problem is that I have to handle the sdl events in a loop, If I don't it will become unresponsive, but this loop will block my Main code. I don't need to handle any events like mouse clicks, I just want to show some simple picture and manipulate them, is there any way to stop events or run the whole sdl in a goroutine? I tried but get weird results. This is my struct:</p>\n\n<pre><code>type SDLstruct{\n    window *sdl.Window\n    renderer *sdl.Renderer\n    texture *sdl.Texture\n    src, dst sdl.Rect\n    event sdl.Event\n    Close bool\n    winWidth, winHeight int32\n}\n</code></pre>\n\n<p>This function starts a window and a renderer:</p>\n\n<pre><code>func (sdlVars *SDLstruct)StartWindow() (err error) {\n\n    sdlVars.winWidth, sdlVars.winHeight = 1920,1080\n    sdl.Init(sdl.INIT_VIDEO)\n    Num,err :=sdl.GetNumVideoDisplays()\n    if err!=nil {\n        return err\n    }\n    var rect sdl.Rect\n    rect,err = sdl.GetDisplayBounds(0)\n    if err!=nil {\n        return err\n    }\n    for i:=Num-1;i&gt;=0;i--{\n        Mod , _:=sdl.GetDisplayMode(i,0)\n        if Mod.W ==info.winWidth &amp;&amp; Mod.H==info.winHeight{\n            rect,err = sdl.GetDisplayBounds(i)\n            if err!=nil {\n                return err\n            }\n            break\n        }\n    }\n    sdlVars.window, err = sdl.CreateWindow(winTitle, rect.X, rect.Y,\n        rect.W, rect.H, sdl.WINDOW_SHOWN)\n    sdlVars.window.SetBordered(false)\n    sdlVars.window.SetFullscreen(1)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Failed to create window: %s\\n\", err)\n        return err\n    }\n    sdlVars.renderer, err = sdl.CreateRenderer(sdlVars.window, -1, sdl.RENDERER_ACCELERATED)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Failed to create renderer: %s\\n\", err)\n        return err\n    }\n    sdlVars.renderer.Clear()\n    sdlVars.renderer.SetDrawColor(0, 0, 0, 255)\n    sdlVars.renderer.FillRect(&amp;sdl.Rect{0, 0, int32(info.winWidth), int32(info.winHeight)})\n    sdlVars.renderer.Present()\n    sdl.ShowCursor(0)\n    return nil\n}\n</code></pre>\n\n<p>This function handle events:</p>\n\n<pre><code>func (sdlVars *SDLstruct)HandleEvents()  {\n    for sdlVars.event = sdl.PollEvent(); sdlVars.event != nil; sdlVars.event = sdl.PollEvent() {\n        switch t := sdlVars.event.(type) {\n        case *sdl.QuitEvent:\n            sdlVars.Close = true\n        }\n    }\n}\n</code></pre>\n\n<p>and this one closes everything:</p>\n\n<pre><code>func (sdlVars *SDLstruct)CloseSDL() (err error) {\n    err =sdlVars.renderer.Destroy()\n    if err!=nil{\n        return err\n    }\n    err = sdlVars.window.Destroy()\n    if err!=nil{\n        return err\n    }\n    sdl.Quit()\n    return nil\n}\n</code></pre>\n\n<p>This is my Main function:</p>\n\n<pre><code>func main()  {\n    var wg sync.WaitGroup\n    SdlVars:= new(SDLstruct)\n    wg.Add(1)\n    go SdlVars.StartSDL()\n    time.Sleep(time.Second*5)\n    SdlVars.Close = true\n    time.Sleep(time.Second*15)\n}\n</code></pre>\n\n<p>In my Main function I tell it to start the sdl and after 5 seconds close everything and wait 15 seconds, but it doesn't close window.</p>\n"}, {"tags": ["go", "arangodb"], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 11336397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OLBzFFev1ig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revhxnoqL-WkwrBF1IHS7dPeSDRbg/mo/photo.jpg?sz=128", "display_name": "Matthew Loughney", "link": "https://stackoverflow.com/users/11336397/matthew-loughney"}, "is_accepted": false, "score": 0, "last_activity_date": 1557340247, "creation_date": 1557340247, "answer_id": 56047004, "question_id": 56045516, "link": "https://stackoverflow.com/questions/56045516/how-to-read-arbitrary-object-from-arangodb-using-cursor-readdocument/56047004#56047004", "title": "How to read arbitrary object from arangodb using cursor.ReadDocument()", "body": "<p>So it turns out the answer was a lot more simple than I thought it would be. This works if <code>prop1</code> and <code>prop2</code> are type <code>interface{}</code>, it reads the data in as a map, then as long as the keys in the map are all strings (which they are in my case), to turn it into a json string I can just use <code>json.Marshal()</code> and cast the returned byte array as a string.</p>\n"}], "owner": {"reputation": 19, "user_id": 11336397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OLBzFFev1ig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3revhxnoqL-WkwrBF1IHS7dPeSDRbg/mo/photo.jpg?sz=128", "display_name": "Matthew Loughney", "link": "https://stackoverflow.com/users/11336397/matthew-loughney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557340247, "creation_date": 1557334143, "last_edit_date": 1557336084, "question_id": 56045516, "link": "https://stackoverflow.com/questions/56045516/how-to-read-arbitrary-object-from-arangodb-using-cursor-readdocument", "title": "How to read arbitrary object from arangodb using cursor.ReadDocument()", "body": "<p>I am trying to build a fairly generalizable service to create graphs in <code>arangodb</code>.</p>\n\n<p>In my <code>ReadVertex()</code> function, I would like to be able to read a property with arbitrary fields of a vertex and read it into a variable, preferably a string without having to create a specific struct with the json tags hardcoded for particular properties.</p>\n\n<p>I have no problem inserting arbitrary objects as a property of a vertex, and I've tried reading them into a string, but it always comes up blank.</p>\n\n<p>An example of what I would like to accomplish: if a vertex has a property: <code>\"Prop1\": {\"Nested1\": true, \"Nested2\": false}</code>, and a property <code>\"Prop2\": \"Just a string\"</code>, in my <code>ReadVertex()</code> function I would like to be able to do something along the lines of</p>\n\n<pre><code>// query the database and get a cursor containing prop1 and prop2\n\nvar prop1 someType\ncursor.ReadDocument(ctx, &amp;prop1)\nfmt.Println(prop1.String()) // should print {\"Prop1\": {\"Nested1\": true, \"Nested2\": false}}\n\nvar prop2 someType\ncursor.ReadDocument(ctx, &amp;prop2)\nfmt.Println(prop2.String()) // should print {\"Prop2\": \"Just a string\"}\n</code></pre>\n\n<p>And I would like this to work having prop1 and prop2 be of the same type.</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 6718, "user_id": 3484146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N411E.jpg?s=128&g=1", "display_name": "ifloop", "link": "https://stackoverflow.com/users/3484146/ifloop"}, "edited": false, "score": 1, "creation_date": 1557331886, "post_id": 56044702, "comment_id": 98731635, "body": "The compiler tells you, that you&#39;re passing a <i>pointer to a slice of <code>Foo</code></i>, but the function expects <i>a pointer to a slice of <code>map[string]interface{}</code></i>. That&#39;s clearly not gonna work because a <code>Foo</code> is not a map."}], "answers": [{"comments": [{"owner": {"reputation": 4848, "user_id": 4698795, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-Geo9JqDWnPg/AAAAAAAAAAI/AAAAAAAAKFg/VCKLQs7w4vo/photo.jpg?sz=128", "display_name": "Brick Yang", "link": "https://stackoverflow.com/users/4698795/brick-yang"}, "edited": false, "score": 0, "creation_date": 1557365294, "post_id": 56045445, "comment_id": 98743181, "body": "It works! Thanks. One more thing, if the field name doesn&#39;t exist, the code will panic by <code>panic: reflect: call of reflect.Value.Interface on zero Value</code>. How can I do some precheck to make the code stronger?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 4848, "user_id": 4698795, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-Geo9JqDWnPg/AAAAAAAAAAI/AAAAAAAAKFg/VCKLQs7w4vo/photo.jpg?sz=128", "display_name": "Brick Yang", "link": "https://stackoverflow.com/users/4698795/brick-yang"}, "edited": false, "score": 0, "creation_date": 1557366984, "post_id": 56045445, "comment_id": 98743490, "body": "Check that value returned from FieldByNsme is valid before calling Interface. <a href=\"https://godoc.org/reflect#Value.IsValid\" rel=\"nofollow noreferrer\">godoc.org/reflect#Value.IsValid</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1557333904, "creation_date": 1557333904, "answer_id": 56045445, "question_id": 56044702, "link": "https://stackoverflow.com/questions/56044702/go-function-accept-different-array-parameter/56045445#56045445", "title": "Go function accept different array parameter", "body": "<p>To work with arbitrary slice types, declare the argument as type <code>interface{}</code> and use <a href=\"https://godoc.org/reflect\" rel=\"nofollow noreferrer\">reflection</a> to access the value:</p>\n\n<pre><code>func unmarshal(data []byte, v interface{}) {\n    err := json.Unmarshal(data, v)\n    rv := reflect.ValueOf(v).Elem()\n\n    if err != nil || rv.Len() == 0 || rv.Index(0).FieldByName(\"Name\").Interface() == \"\" {\n        rv.Set(reflect.Zero(rv.Type()))\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 4848, "user_id": 4698795, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-Geo9JqDWnPg/AAAAAAAAAAI/AAAAAAAAKFg/VCKLQs7w4vo/photo.jpg?sz=128", "display_name": "Brick Yang", "link": "https://stackoverflow.com/users/4698795/brick-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 56045445, "answer_count": 1, "score": -5, "last_activity_date": 1557333904, "creation_date": 1557331067, "question_id": 56044702, "link": "https://stackoverflow.com/questions/56044702/go-function-accept-different-array-parameter", "title": "Go function accept different array parameter", "body": "<p>I want to use a generic function to unmarshal different types:</p>\n\n<pre><code>type Foo struct {\n  Name    string\n  Another string\n}\n\ntype Bar struct {\n  Name  string\n  Some  string\n}\n\nfunc unmarshal(data []byte, val *[]map[string]interface{}) {\n  err := json.Unmarshal(data, val)\n\n  if err != nil || (*val)[0][\"Name\"] == \"\" {\n    *val = nil\n  }\n}\n\nfunc main() {\n  var foos []Foo\n  var bars []Bar\n\n  // fooData and barData are JSON strings retrieved from database\n  unmarshal(fooData, &amp;foos)\n  unmarshal(barData, &amp;bars)\n}\n</code></pre>\n\n<p>I got an error like <code>cannot use &amp;foo (type *[]Foo) as type *[]map[string]interface {} in argument to unmarshal</code>.</p>\n\n<p>I've tried use <code>val interface{}</code> as the parameter but it doesn't support index.</p>\n\n<p>How can I achieve the goal then? Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557339905, "post_id": 56044638, "comment_id": 98735474, "body": "To clarify what&#39;s said below, GC is not responsible at all for freeing memory to the operating system (a separate scavenger goroutine handles that, though it does report in the gctrace output if it runs). GC is only concerned with managing the allocated memory. As for the goal, read the documentation for the <code>GOGC</code> env variable."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1557334330, "creation_date": 1557334330, "answer_id": 56045568, "question_id": 56044638, "link": "https://stackoverflow.com/questions/56044638/for-what-heap-size-at-gc-start-at-gc-end-and-live-heap-numbers-from-gctrace-1-s/56045568#56045568", "title": "For what heap size at GC start, at GC end and live heap numbers from gctrace=1 stand for?", "body": "<p>The GC cleans some amount of garbage each pass. It does not necessarily release it to the OS (if it thinks it would just have to request it again shortly); and if it does, the OS does not necessarily reclaim it (until there is memory pressure from another process, the OS may leave that memory allocated to your process in case it needs it again).</p>\n\n<p>Live heap size is how much of the heap is actively in use, less any dead objects and free heap space ready for future allocations. Goal heap size is how much memory GC thinks it needs to get from the OS to handle your process's allocations on an ongoing basis without having to constantly request more memory from the OS (i.e. how much stays alive + how much is allocated &amp; discarded between GC runs).</p>\n\n<p>The goal of GC is to clean up dead objects in the heap, <strong>and</strong> to maintain enough free heap space to handle most allocations without having to request more memory from the OS (which is slow), while also not keeping excessive free memory (so that the OS can still allocate to other processes).</p>\n"}], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 56045568, "answer_count": 1, "score": 1, "last_activity_date": 1557334330, "creation_date": 1557330891, "question_id": 56044638, "link": "https://stackoverflow.com/questions/56044638/for-what-heap-size-at-gc-start-at-gc-end-and-live-heap-numbers-from-gctrace-1-s", "title": "For what heap size at GC start, at GC end and live heap numbers from gctrace=1 stand for?", "body": "<p>Setting <code>GODEBUG=gctrace=1</code> causes the Go garbage collector to emit a single line to standard error about internal info about each GC round. Let's say I have this output:</p>\n\n<pre><code>gc 1 @0.021s 0%: 0.15+0.37+0.25 ms clock, 3.0+0.19/0.39/0.60+5.0 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 2 @0.024s 0%: 0.097+0.94+0.16 ms clock, 0.29+0.21/1.3/0+0.49 ms cpu, 4-&gt;4-&gt;1 MB, 5 MB goal, 48 P\ngc 3 @0.027s 1%: 0.10+0.43+0.17 ms clock, 0.60+0.48/1.5/0+1.0 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 4 @0.028s 1%: 0.18+0.41+0.28 ms clock, 0.18+0.69/2.0/0+0.28 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 5 @0.031s 1%: 0.078+0.35+0.29 ms clock, 1.1+0.26/2.0/0+4.4 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 6 @0.032s 1%: 0.11+0.50+0.32 ms clock, 0.22+0.99/2.3/0+0.64 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 7 @0.034s 1%: 0.18+0.39+0.27 ms clock, 0.18+0.56/2.2/0+0.27 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 8 @0.035s 2%: 0.12+0.40+0.27 ms clock, 0.12+0.63/2.2/0+0.27 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 9 @0.036s 2%: 0.13+0.41+0.26 ms clock, 0.13+0.52/2.2/0+0.26 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 10 @0.038s 2%: 0.099+0.51+0.20 ms clock, 0.19+0.56/1.9/0+0.40 ms cpu, 4-&gt;5-&gt;0 MB, 5 MB goal, 48 P\ngc 11 @0.039s 2%: 0.10+0.46+0.20 ms clock, 0.10+0.23/1.3/0.005+0.20 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 12 @0.040s 2%: 0.066+0.46+0.24 ms clock, 0.93+0.40/1.7/0+3.4 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 13 @0.041s 2%: 0.099+0.30+0.20 ms clock, 0.099+0.60/1.7/0+0.20 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 14 @0.042s 2%: 0.095+0.45+0.24 ms clock, 0.38+0.58/2.0/0+0.98 ms cpu, 4-&gt;5-&gt;0 MB, 5 MB goal, 48 P\ngc 15 @0.044s 2%: 0.095+0.45+0.21 ms clock, 1.0+0.78/1.9/0+2.3 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\ngc 16 @0.045s 3%: 0.10+0.45+0.23 ms clock, 0.10+0.70/2.1/0+0.23 ms cpu, 4-&gt;5-&gt;0 MB, 5 MB goal, 48 P\ngc 17 @0.046s 3%: 0.088+0.40+0.17 ms clock, 0.088+0.45/1.9/0+0.17 ms cpu, 4-&gt;4-&gt;0 MB, 5 MB goal, 48 P\n.\n.\n.\n.\ngc 6789 @9.998s 12%: 0.17+0.91+0.24 ms clock, 0.85+1.8/5.0/0+1.2 ms cpu, 4-&gt;6-&gt;1 MB, 6 MB goal, 48 P\ngc 6790 @10.000s 12%: 0.086+0.55+0.24 ms clock, 0.78+0.30/4.2/0.043+2.2 ms cpu, 4-&gt;5-&gt;1 MB, 6 MB goal, 48 P\n</code></pre>\n\n<p>There is a definition of these values in <a href=\"https://golang.org/pkg/runtime/\" rel=\"nofollow noreferrer\">documention</a>:</p>\n\n<pre><code>gc # @#s #%: #+#+# ms clock#+#/#/#+# ms cpu, #-&gt;#-&gt;# MB, # MB goal, #P \n\nwhere the fields are as follows:\ngc #       the GC number, incremented at each GC\n@#s        time in seconds since program start\n#%         percentage of time spent in GC since program start\n#+...+#    wall-clock/CPU times for the phases of the GC\n#-&gt;#-&gt;#    MB heap size at GC start, at GC end, and live heap\n# MB goal  goal heap size\n# P        number of processors used\n</code></pre>\n\n<p>What I am really confused with is <code>#-&gt;#-&gt;#  MB heap size at GC start, at GC end, and live heap</code>.</p>\n\n<ul>\n<li><p>Is that correct, that at each round GC releases some amount of unused(garbage) memory to OS and this must decrease heap size ? If yes, then why some values of heap are increasing ? For example: 4->5->0.\nWe had 4MB memory, including garbage, before the GC start. Then, how it is possible to get 5MB of memory after we cleaned up the garbage from it ?</p></li>\n<li><p>The third value is live heap size. What is the difference between the regular heap size ? I suppose that it is heap w/o garbage.</p></li>\n<li><p>How the goal heap size is calculated ? Is that correct it is a heap size that GC wants to achieve after the cleanup ? Then why this value is greater than heap size before the GC start ?</p></li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6718, "user_id": 3484146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N411E.jpg?s=128&g=1", "display_name": "ifloop", "link": "https://stackoverflow.com/users/3484146/ifloop"}, "edited": false, "score": 0, "creation_date": 1557331097, "post_id": 56044621, "comment_id": 98731304, "body": "What about writing a struct with the common fields, like pricedTx, and then embed it in the other structs?"}, {"owner": {"reputation": 382, "user_id": 3328311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/437d1a24f69a7108e6abd9fa71c98b70?s=128&d=identicon&r=PG&f=1", "display_name": "randomshinichi", "link": "https://stackoverflow.com/users/3328311/randomshinichi"}, "reply_to_user": {"reputation": 6718, "user_id": 3484146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N411E.jpg?s=128&g=1", "display_name": "ifloop", "link": "https://stackoverflow.com/users/3484146/ifloop"}, "edited": false, "score": 0, "creation_date": 1557350252, "post_id": 56044621, "comment_id": 98739740, "body": "That could be interesting - would take a few hours to try this approach out though."}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 3328311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/437d1a24f69a7108e6abd9fa71c98b70?s=128&d=identicon&r=PG&f=1", "display_name": "randomshinichi", "link": "https://stackoverflow.com/users/3328311/randomshinichi"}, "edited": false, "score": 0, "creation_date": 1557348738, "post_id": 56045372, "comment_id": 98739218, "body": "I&#39;m not sure what you mean by &quot;Since it also appears that you&#39;re doing all the associated processing for producing the message in the method where you&#39;re trying to get its final length, couldn&#39;t you just produce the message as a []byte, take its length, and then use that same output when you do... whatever it is you&#39;re doing with these?&quot;  This is just one step in a bigger operation - there&#39;s a complex equation that depends on the size of the transaction after this."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 382, "user_id": 3328311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/437d1a24f69a7108e6abd9fa71c98b70?s=128&d=identicon&r=PG&f=1", "display_name": "randomshinichi", "link": "https://stackoverflow.com/users/3328311/randomshinichi"}, "edited": false, "score": 0, "creation_date": 1557408022, "post_id": 56045372, "comment_id": 98761058, "body": "OK. Again, it&#39;s hard to guess what your options might be because there&#39;s no context provided."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1557333649, "creation_date": 1557333649, "answer_id": 56045372, "question_id": 56044621, "link": "https://stackoverflow.com/questions/56044621/how-to-guarantee-the-presence-of-a-struct-field-like-interfaces-do-for-methods/56045372#56045372", "title": "How to guarantee the presence of a struct field like interfaces do for methods?", "body": "<p>You don't. If you don't care about the specific type (i.e., you can use an interface), then you don't care about the data, only the behavior (which is why interfaces only specify methods). If you care about the data, then you're already knee-deep in the type's internals, and you should be using the specific concrete type (or using a type assertion/type switch to get at it). This is not Go-specific; most languages do not permit specifying fields in interfaces.</p>\n\n<p>A getter wouldn't be the worst thing. You could also encapsulate the fields you need direct access to into their own struct type, and have a getter for that (if there are multiple related fields you want to work with together). Lastly, you could rework the overall design to eliminate or migrate the need. There's not enough context to make a hard suggestion here, but to take a total guess, it seems like you likely have something that writes these transactions to somewhere, and it's the size of what's to be written you're concerned with. Since it also appears that you're doing all the associated processing for producing the message in the method where you're trying to get its final length, couldn't you just produce the message as a <code>[]byte</code>, take its length, and then use that same output when you do... whatever it is you're doing with these?</p>\n"}, {"tags": [], "owner": {"reputation": 382, "user_id": 3328311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/437d1a24f69a7108e6abd9fa71c98b70?s=128&d=identicon&r=PG&f=1", "display_name": "randomshinichi", "link": "https://stackoverflow.com/users/3328311/randomshinichi"}, "is_accepted": false, "score": 0, "last_activity_date": 1557360902, "creation_date": 1557360902, "answer_id": 56050552, "question_id": 56044621, "link": "https://stackoverflow.com/questions/56044621/how-to-guarantee-the-presence-of-a-struct-field-like-interfaces-do-for-methods/56050552#56050552", "title": "How to guarantee the presence of a struct field like interfaces do for methods?", "body": "<p>Estimating the size of the Tx requires the Tx.RLP() (guaranteed by the Tx interface) and the Tx.Fee field (which is there all the time but can't be proven to the compiler).</p>\n\n<p>Size estimation is the same for all transaction types. So I found a satisfactory solution making the size estimation a function on its own, and I just provide the transaction's Fee as an argument to the function:</p>\n\n<pre><code>// sizeEstimate returns the size of the transaction when RLP serialized, assuming the Fee has a length of 8 bytes.\nfunc calcSizeEstimate(tx Tx, fee *utils.BigInt) (int, error) {\n    feeRlp, err := rlp.EncodeToBytes(fee)\n    if err != nil {\n        return 0, err\n    }\n    feeRlpLen := len(feeRlp)\n\n    rlpRawMsg, err := tx.RLP()\n    if err != nil {\n        return 0, err\n    }\n\n    return len(rlpRawMsg) - feeRlpLen + 8, nil\n}\n\n...\nfunc (tx *SpendTx) sizeEstimate() (int, error) {\n    return calcSizeEstimate(tx, &amp;tx.Fee)\n}\n...\nfunc (tx *NamePreclaimTx) sizeEstimate() (int, error) {\n    return calcSizeEstimate(tx, &amp;tx.Fee)\n}\n...\nfunc (tx *NameClaimTx) sizeEstimate() (int, error) {\n    return calcSizeEstimate(tx, &amp;tx.Fee)\n}\n...\n</code></pre>\n"}], "owner": {"reputation": 382, "user_id": 3328311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/437d1a24f69a7108e6abd9fa71c98b70?s=128&d=identicon&r=PG&f=1", "display_name": "randomshinichi", "link": "https://stackoverflow.com/users/3328311/randomshinichi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557360902, "creation_date": 1557330811, "question_id": 56044621, "link": "https://stackoverflow.com/questions/56044621/how-to-guarantee-the-presence-of-a-struct-field-like-interfaces-do-for-methods", "title": "How to guarantee the presence of a struct field like interfaces do for methods?", "body": "<p>I have several transaction structs:</p>\n\n<pre><code>SpendTx\nNameTransferTx\nNameUpdateTx\n...\n</code></pre>\n\n<p>I'd like to estimate the size of these structs, excluding the Fee field. They all have a Fee struct field. Currently, for each struct I have this method:</p>\n\n<pre><code>func (tx *NameTransferTx) sizeEstimate() (int, error) {\n    feeRlp, err := rlp.EncodeToBytes(tx.Fee)\n    if err != nil {\n        return 0, err\n    }\n    feeRlpLen := len(feeRlp)\n\n    rlpRawMsg, err := tx.RLP()\n    if err != nil {\n        return 0, err\n    }\n\n    return len(rlpRawMsg) - feeRlpLen + 8, nil\n}\n</code></pre>\n\n<p>That's a lot of duplicated code, all because I cannot write something like this:</p>\n\n<pre><code>type Tx interface {\n    RLP() ([]byte, error)\n    Fee utils.BigInt // Golang won't allow this\n}\nfunc estimateSizeOfTx(tx Tx) (int, error) {\n    feeRlp, err := rlp.EncodeToBytes(tx.Fee)\n    if err != nil {\n        return 0, err\n    }\n    feeRlpLen := len(feeRlp)\n\n    rlpRawMsg, err := tx.RLP()\n    if err != nil {\n        return 0, err\n    }\n\n    return len(rlpRawMsg) - feeRlpLen + 8, nil\n}\n</code></pre>\n\n<p>Of course I could write a getter function like <code>getFee()</code> and make an interface out of that, but that's not any better. Or is that how other people do it?</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557330162, "post_id": 56044362, "comment_id": 98730834, "body": "Do you have a protobuf-encoded message, or do you have a decoded Go struct value?"}, {"owner": {"reputation": 1561, "user_id": 4389183, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-P2Zfjta6JN4/AAAAAAAAAAI/AAAAAAAAADU/K4cwO3iCqNE/photo.jpg?sz=128", "display_name": "maralla", "link": "https://stackoverflow.com/users/4389183/maralla"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557331628, "post_id": 56044362, "comment_id": 98731527, "body": "I have a decoded go struct value and the type is <code>proto.FileDescriptorProto</code>."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1557335220, "post_id": 56044362, "comment_id": 98733148, "body": "To restate: you have the <b>compiled</b> proto schema (the <code>FileDescriptorProto</code>), and you want to decompile it back to a text .proto schema - is that right? AFAIK, there are no <i>direct</i> tools to do this, but it should be entirely possible - although perhaps slightly ambiguous (meaning, it might not give back exactly the same text input, but it should be semantically useful enough). The work to do this would be similar to the work for writing a language plugin for protoc"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557372241, "post_id": 56044362, "comment_id": 98744502, "body": "Why would one want to do this? What is the end goal?"}, {"owner": {"reputation": 1561, "user_id": 4389183, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-P2Zfjta6JN4/AAAAAAAAAAI/AAAAAAAAADU/K4cwO3iCqNE/photo.jpg?sz=128", "display_name": "maralla", "link": "https://stackoverflow.com/users/4389183/maralla"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557372712, "post_id": 56044362, "comment_id": 98744606, "body": "@colminator I want to write a protobuf plugin to modify proto files  then pass the modified files to other plugins."}], "owner": {"reputation": 1561, "user_id": 4389183, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-P2Zfjta6JN4/AAAAAAAAAAI/AAAAAAAAADU/K4cwO3iCqNE/photo.jpg?sz=128", "display_name": "maralla", "link": "https://stackoverflow.com/users/4389183/maralla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557330172, "creation_date": 1557329943, "last_edit_date": 1557330172, "question_id": 56044362, "link": "https://stackoverflow.com/questions/56044362/how-to-generate-protobuf-files-from-proto-messages", "title": "How to generate protobuf files from proto messages?", "body": "<p>I already have a <code>FileDescriptorProto</code> object which is a proto message and I want to convert the object to string representation just like the contents in a proto file. The language I use is Go.</p>\n"}, {"tags": ["go", "kubernetes", "openapi"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11471017"}, "edited": false, "score": 0, "creation_date": 1557336832, "post_id": 56045133, "comment_id": 98733954, "body": "Yea I stumbled onto that but it seems to have been abandoned since v1.9. I haven&#39;t been able to get this approach to work."}, {"owner": {"reputation": 95, "user_id": 10874564, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LPtgvhrgWpA/AAAAAAAAAAI/AAAAAAAAAsY/v1R4aeIN4dQ/photo.jpg?sz=128", "display_name": "PREETI BANSAL", "link": "https://stackoverflow.com/users/10874564/preeti-bansal"}, "edited": false, "score": 0, "creation_date": 1577096359, "post_id": 56045133, "comment_id": 105088802, "body": "Did you have another approach to perform validation or a sample example which can be referred for the suggested approach"}], "tags": [], "owner": {"reputation": 5656, "user_id": 11374921, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-74ExUmq_FAw/AAAAAAAAAAI/AAAAAAAARVQ/qmxKhxFOHDs/photo.jpg?sz=128", "display_name": "Vasili Angapov", "link": "https://stackoverflow.com/users/11374921/vasili-angapov"}, "is_accepted": true, "score": 0, "last_activity_date": 1557332669, "creation_date": 1557332669, "answer_id": 56045133, "question_id": 56044319, "link": "https://stackoverflow.com/questions/56044319/validating-a-crd-with-an-embedded-core-v1-podspec/56045133#56045133", "title": "Validating a CRD with an embedded core.v1.PodSpec", "body": "<p>In general CRD doesn't allow to put references to other objects. There was a discussion on that: <a href=\"https://github.com/kubernetes/kubernetes/issues/54579\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/kubernetes/issues/54579</a>. Decision was made not to add references.</p>\n\n<p>Workaround is described in this comment: <a href=\"https://github.com/kubernetes/kubernetes/issues/54579#issuecomment-370372942\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/kubernetes/issues/54579#issuecomment-370372942</a>\nI haven't use it but you may try. </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11471017"}, "edited": false, "score": 0, "creation_date": 1557340303, "post_id": 56046332, "comment_id": 98735655, "body": "To use a web hook in this manner, does this mean I need to develop and run a controller/operator (or whatever you wanna call it), in addition to the controller for my CRD itself, that kubernetes in turn will contact to validate any workloads submitted using my CRD?"}, {"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "edited": false, "score": 0, "creation_date": 1557346447, "post_id": 56046332, "comment_id": 98738249, "body": "yes, you would deploy a stateless microservice. here is an example: <a href=\"https://github.com/northwesternmutual/kanali/blob/master/pkg/middleware/validator.go\" rel=\"nofollow noreferrer\">github.com/northwesternmutual/kanali/blob/master/pkg/middlew&zwnj;&#8203;are/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "is_accepted": false, "score": 0, "last_activity_date": 1557337265, "creation_date": 1557337265, "answer_id": 56046332, "question_id": 56044319, "link": "https://stackoverflow.com/questions/56044319/validating-a-crd-with-an-embedded-core-v1-podspec/56046332#56046332", "title": "Validating a CRD with an embedded core.v1.PodSpec", "body": "<p>There are multiple ways to perform CRD validation. Static validation via <code>.validation</code> is one way as you know. Other way is to perform dynamic via a <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#validatingadmissionwebhook\" rel=\"nofollow noreferrer\"><code>ValidatingAdmissionWebhook</code></a>. This allows you to implement and deploy a server that the Kubernetes API server will call just prior to resource admission. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11471017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 56045133, "answer_count": 2, "score": 1, "last_activity_date": 1557337265, "creation_date": 1557329797, "question_id": 56044319, "link": "https://stackoverflow.com/questions/56044319/validating-a-crd-with-an-embedded-core-v1-podspec", "title": "Validating a CRD with an embedded core.v1.PodSpec", "body": "<p>I'm developing a controller with a CRD. The CRD includes our custom stuff along with an embedded core.v1.PodSpec. (v1.13.1)</p>\n\n<p>I define a validation section in the CRD that can validate and enforce constraints on our custom fields but I can't figure out how to do this for the embedded PodSpec. PodSpec is far too large and far too many options to manually add this to the validate section of the CRD:</p>\n\n<pre><code>apiVersion: apiextensions.k8s.io/v1beta1\nkind: CustomResourceDefinition\nmetadata:\n  name: mystuff.example.com\nspec:\n  group: mystuff.example.com\n  versions:\n    - name: v1alpha1\n      served: true\n      storage: true\n  names:\n    kind: MyStuff\n    plural: mystuffs\n    singular: mystuff\n    shortNames:\n    - ms\n  scope: Namespaced\n  additionalPrinterColumns:\n  - JSONPath: .status.phase\n    name: Status\n    type: string\n  - JSONPath: .metadata.resourceVersion\n    name: Version\n    type: string\n  validation:\n    openAPIV3Schema:\n      properties:\n        spec:\n          required:\n            - myVar1\n            - myVar2\n            - podSpec\n          properties:\n            myVar1:\n              type: boolean\n            myVar2:\n              type: boolean\n            # Here I need to validate a valid core.v1.PodSpec\n            podSpec:\n              type: core.v1.PodSpec\n</code></pre>\n\n<p>How do other people approach this? </p>\n\n<p>I also need validation for any mechanism in which a user can submit a workload, ie directly using the kube apiserver or with kubectl.</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["go", "testing", "websocket"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1557328596, "post_id": 56043871, "comment_id": 98729938, "body": "there a go test packages that can simulate websocket servers"}, {"owner": {"reputation": 1188, "user_id": 1308927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6c692ca1e6b1ad945b14b3a2f7e0850?s=128&d=identicon&r=PG", "display_name": "RdB", "link": "https://stackoverflow.com/users/1308927/rdb"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1557328996, "post_id": 56043871, "comment_id": 98730178, "body": "Can I have a link please?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1557329043, "post_id": 56043871, "comment_id": 98730214, "body": "Have your mock websocket server refuse connections? Or just try to connect to it while it isn&#39;t running?"}, {"owner": {"reputation": 1188, "user_id": 1308927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6c692ca1e6b1ad945b14b3a2f7e0850?s=128&d=identicon&r=PG", "display_name": "RdB", "link": "https://stackoverflow.com/users/1308927/rdb"}, "edited": false, "score": 0, "creation_date": 1557329776, "post_id": 56043871, "comment_id": 98730624, "body": "I need to have it down, then running again. Just like plug out and then plugi n the cable."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1557330369, "post_id": 56043871, "comment_id": 98730939, "body": "Set <a href=\"https://godoc.org/github.com/gorilla/websocket#Dialer.NetDial\" rel=\"nofollow noreferrer\">Dialer.NetDial</a> (or NetDialContext) to a function that wraps the net.Conn with code that simulates whatever failure you want to simulate."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557340501, "post_id": 56043871, "comment_id": 98735723, "body": "@RdB: you can&#39;t simulate &quot;pulling a cable&quot; in your code, because that&#39;s at the wrong layer. Do you want packets null routed? Do you want ICMP HostUnreachable? Do you want ICMP NetworkUnreachable? You need to actually change the network to do that, which can be done physically, or by various means in the OS network stack."}], "owner": {"reputation": 1188, "user_id": 1308927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6c692ca1e6b1ad945b14b3a2f7e0850?s=128&d=identicon&r=PG", "display_name": "RdB", "link": "https://stackoverflow.com/users/1308927/rdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557328348, "creation_date": 1557328348, "question_id": 56043871, "link": "https://stackoverflow.com/questions/56043871/programmaticaly-simulate-drop-internet-connection-in-golang", "title": "Programmaticaly simulate drop internet connection in Golang", "body": "<p>I wrote a websocket client in Go using <a href=\"http://www.gorillatoolkit.org/pkg/websocket\" rel=\"nofollow noreferrer\">http://www.gorillatoolkit.org/pkg/websocket</a>\nI need to write a test for this client, and check how it would behave in case of dropping connection. To do that, I wrote a fake <em>WebSocket</em> server. So my question is: how can I simulate down and up again from the server side?</p>\n"}, {"tags": ["go", "grpc", "grpc-go", "knative-serving", "knative"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1557324098, "post_id": 56042511, "comment_id": 98727088, "body": "is your go program server tls?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1557324434, "post_id": 56042511, "comment_id": 98727329, "body": "Thanks and no the server is not tls but the connection is over https - just updated the question."}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1557325038, "post_id": 56042511, "comment_id": 98727715, "body": "you can not have a https connection with a server that does not support https ..."}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1557325337, "post_id": 56042511, "comment_id": 98727925, "body": "Ok thanks, so if I start a go server with tls it should work?"}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1557325405, "post_id": 56042511, "comment_id": 98727975, "body": "yep that should work"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1557325474, "post_id": 56042511, "comment_id": 98728013, "body": "IFYI:  am using letsencrypt on the server side"}], "answers": [{"comments": [{"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 0, "creation_date": 1557326425, "post_id": 56043042, "comment_id": 98728624, "body": "Thanks, is is knative on kubernetes so the ports are mapped"}], "tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": false, "score": 3, "last_activity_date": 1557325589, "creation_date": 1557325589, "answer_id": 56043042, "question_id": 56042511, "link": "https://stackoverflow.com/questions/56042511/grpc-go-over-https-failed-rpc-error-code-unavailable-desc-transport-is-clo/56043042#56043042", "title": "grpc-go over https: failed rpc error: code = Unavailable desc = transport is closing:", "body": "<p>In your server code, you are not listening on port 443, so this is most likely the reason your example isn't working.</p>\n\n<p>If you want to keep using http and not https, then your code is working just fine.</p>\n\n<p>If you want to get it working with TLS, <a href=\"https://gist.github.com/denji/12b3a568f092ab951456\" rel=\"nofollow noreferrer\">this overview</a> is a pretty good one.</p>\n\n<p>To get port 80 to redirect to port 443 (I highly recommend it if you are using https), see <a href=\"https://stackoverflow.com/questions/37536006/how-do-i-rewrite-redirect-from-http-to-https-in-go\">this SO post</a>.</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4780, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1557335479, "creation_date": 1557323846, "last_edit_date": 1557335479, "question_id": 56042511, "link": "https://stackoverflow.com/questions/56042511/grpc-go-over-https-failed-rpc-error-code-unavailable-desc-transport-is-clo", "title": "grpc-go over https: failed rpc error: code = Unavailable desc = transport is closing:", "body": "<p>Note: This is running in containers in Kubernetes.</p>\n\n<p>I have successfully done this very short description: <a href=\"https://knative.dev/docs/serving/samples/grpc-ping-go/\" rel=\"nofollow noreferrer\">https://knative.dev/docs/serving/samples/grpc-ping-go/</a></p>\n\n<p>Success:</p>\n\n<pre><code>2019/05/08 13:43:56 Ping got hello - pong\n2019/05/08 13:43:56 Got pong 2019-05-08 13:43:57.646935391 +0000 UTC m=+1.661567121\n</code></pre>\n\n<p>But if I run through 443 from a Gateway on knative setup for https, it does not work:</p>\n\n<pre><code>docker run -ti --entrypoint=/client docker.io/{username}/grpc-ping-go \\\n  -server_addr=\"${SERVICE_IP}:443\" \\\n  -server_host_override=\"${SERVICE_HOST}\" \\\n  -insecure\n\n2019/05/08 13:50:28 &amp;{0xc00012e000}.Ping failed rpc error: code = Unavailable desc = transport is closing: \n</code></pre>\n\n<p>The <a href=\"https://github.com/knative/docs/blob/master/docs/serving/samples/grpc-ping-go/client/client.go\" rel=\"nofollow noreferrer\">client</a> code from the sample, and the <a href=\"https://github.com/knative/docs/blob/master/docs/serving/samples/grpc-ping-go/grpc-ping.go\" rel=\"nofollow noreferrer\">server</a> code.\nThe server is not listening for tls, but the connection to the server is over https. </p>\n\n<p>Just to make sure, I know the https is worning from a simpel hello-go text reply.</p>\n"}, {"tags": ["reactjs", "go", "server"], "comments": [{"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 0, "creation_date": 1557328259, "post_id": 56042398, "comment_id": 98729711, "body": "Hi! Could you provide a testable and reproducible go program? That will help in getting you the solution quickly."}, {"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "reply_to_user": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 0, "creation_date": 1557328436, "post_id": 56042398, "comment_id": 98729831, "body": "Sure, could you explain how exactly I should provide it?"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 10792324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/906e5dfd36a010991bbe581769290628?s=128&d=identicon&r=PG&f=1", "display_name": "jittrfunc", "link": "https://stackoverflow.com/users/10792324/jittrfunc"}, "is_accepted": false, "score": 0, "last_activity_date": 1557337051, "last_edit_date": 1557337051, "creation_date": 1557336683, "answer_id": 56046191, "question_id": 56042398, "link": "https://stackoverflow.com/questions/56042398/retrieve-form-values-in-golang-server-from-frontend-reactjs-within-url/56046191#56046191", "title": "Retrieve Form Values in Golang Server From Frontend ReactJS Within URL", "body": "<p>Add <code>method=\"post\"</code> to the form. Eg</p>\n\n<pre><code>&lt;form action=\"/path/post\" method=\"post\" ...\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1557337051, "creation_date": 1557323558, "last_edit_date": 1557324324, "question_id": 56042398, "link": "https://stackoverflow.com/questions/56042398/retrieve-form-values-in-golang-server-from-frontend-reactjs-within-url", "title": "Retrieve Form Values in Golang Server From Frontend ReactJS Within URL", "body": "<p>I am trying to enter a search query in an input form within my front-end React and retrieve that search query in my Golang server.\nI am currently running React on the development server on port 3000 and my Goland server on port 5000.</p>\n\n<p>When I enter a query I see the URL change to localhost:3000/?query=\"Honda\" which is what I want, but it does not show up in the backend server and I think it's because I am using 2 different servers.\nI am aware that I can send the data in a json object but I want to know how to retrieve the values from the URL in the Golang server (serve the React files from the golang server).</p>\n\n<pre><code>// React front end search bar component \n&lt;Form action=\"/path/post\" id=\"searchform\" onSubmit={this.handleSubmit}&gt;\n    &lt;Input value={this.state.query} onChange={this.handleChange} type=\"text\" name=\"query\" /&gt;\n\n// React package.json\n\n...\n\"proxy\": \"http://localhost:5000\",\n...\n\n\n- - - - - - - - - - - - - - - - - \n\n// golang server\n...\nfunc main() {\n    router := gin.Default()\n    router.Use(static.Serve(\"/\", static.LocalFile(\"../client/public\", true)))\n\n    ping := router.Group(\"/path\") \n    ping.POST(\"/post\", pingFunc)\n    router.Run(\":5000\")\n}\n\nfunc post(c *gin.Context) {\n    c.Request.ParseForm()\n        q := FormValue(\"query\")\n        fmt.Println(q)\n}\n...\n\n</code></pre>\n"}, {"tags": ["go", "prometheus"], "answers": [{"comments": [{"owner": {"reputation": 582, "user_id": 10436615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e163f4fab2c2171136264c8c2365b3f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/10436615/jack"}, "edited": false, "score": 0, "creation_date": 1557328852, "post_id": 56043609, "comment_id": 98730084, "body": "those labels are common across all alerts. works perfect"}], "tags": [], "owner": {"reputation": 5081, "user_id": 8657904, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rMfL3u_MOf8/AAAAAAAAAAI/AAAAAAAAA3o/MAq-a_P33vI/photo.jpg?sz=128", "display_name": "Alin S&#238;np\u0103lean", "link": "https://stackoverflow.com/users/8657904/alin-s%c3%aenp%c4%83lean"}, "is_accepted": true, "score": 2, "last_activity_date": 1557327500, "creation_date": 1557327500, "answer_id": 56043609, "question_id": 56040751, "link": "https://stackoverflow.com/questions/56040751/prometheus-alert-manager-template-changes/56043609#56043609", "title": "Prometheus alert manager template changes", "body": "<p>You could replace your template with something like this:</p>\n\n<pre><code>{{ define \"__subject\" }}[{{ .Status | toUpper }} {{ if eq .Status \"firing\" }}:{{ .Alerts.Firing | len }}{{ end }}] {{ .GroupLabels.alertname }} ({{ .GroupLabels.group }} {{ .GroupLabels.instance }})\n</code></pre>\n\n<p>Not sure what will happen if the <code>group</code> or <code>instance</code> labels are not common across all alerts (e.g. if you have an alert firing across multiple groups and/or instances). Maybe you'll just get an empty string, maybe <code>null</code>. According to some <a href=\"https://play.golang.org/p/tK0vmtHA2Ga\" rel=\"nofollow noreferrer\">brief testing in the Go playground</a>, it would seem you may get <code>&lt;no value&gt;</code>. If you don't want that, you can play around with <a href=\"https://golang.org/pkg/text/template/#hdr-Actions\" rel=\"nofollow noreferrer\">Go template's <code>{{if }}</code> action</a>.</p>\n\n<p>Something like</p>\n\n<pre><code>{{ if .GroupLabels.group }}{{ .GroupLabels.group }}{{ end }}\n</code></pre>\n"}], "owner": {"reputation": 582, "user_id": 10436615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e163f4fab2c2171136264c8c2365b3f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/10436615/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 56043609, "answer_count": 1, "score": 0, "last_activity_date": 1568902663, "creation_date": 1557318322, "last_edit_date": 1557326526, "question_id": 56040751, "link": "https://stackoverflow.com/questions/56040751/prometheus-alert-manager-template-changes", "title": "Prometheus alert manager template changes", "body": "<p>I have prometheus alert manager running with a template, and im getting email subject as following </p>\n\n<blockquote>\n  <p>[FIRING:6] Unusual network throughput out (thanos group_b aws_us_b\n  instance_191 infrastructure monitoring-prometheus-node warning)</p>\n</blockquote>\n\n<p>all the values after the alert name are labels.\nhere is the template subject code</p>\n\n<pre><code>{{ define \"__subject\" }}[{{ .Status | toUpper }} {{ if eq .Status \"firing\" }}:{{ .Alerts.Firing | len }}{{ end }}]  {{ .GroupLabels.SortedPairs.Values | join \" \" }}  {{ if gt (len .CommonLabels) (len .GroupLabels) }} ({{ with .CommonLabels.Remove .GroupLabels.Names }}   {{ .Values | join \" \" }}   {{ end }}) {{ end }}{{ end }}\n</code></pre>\n\n<p>I would like to modify this only to get following</p>\n\n<p>[FIRING:6] Unusual network throughput out (group_b instance_191)\nonly group name and instance name</p>\n\n<p>how can I achieve this?</p>\n"}, {"tags": ["go", "binaryfiles", "pprof"], "comments": [{"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1557325860, "post_id": 56039362, "comment_id": 98728249, "body": "If you are using <code>go tool pprof</code>, the flag <code>source_path</code> might help.  Have you tried setting this?"}, {"owner": {"reputation": 1519, "user_id": 2972348, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6f9edd3f6213aca1c54edefed5796033?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Khare", "link": "https://stackoverflow.com/users/2972348/ishan-khare"}, "reply_to_user": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 1, "creation_date": 1568021042, "post_id": 56039362, "comment_id": 102128959, "body": "@FrankBryce I noticed just setting the binary path didn&#39;t help and pprof seemed to try to get the source code from the same path too in order to show line-by-line cpu usage etc. I was able to get around this by setting up a temp docker container with the code and binaries mounted at the correct places (source code at the same path which was set when pprof dump was generated). I will update with a detailed solution soon."}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1569812103, "post_id": 56039362, "comment_id": 102704064, "body": "That&#39;s great to hear. Looking forward to the details answer!"}], "owner": {"reputation": 1519, "user_id": 2972348, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6f9edd3f6213aca1c54edefed5796033?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Khare", "link": "https://stackoverflow.com/users/2972348/ishan-khare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 484, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1568020808, "creation_date": 1557313661, "last_edit_date": 1568020808, "question_id": 56039362, "link": "https://stackoverflow.com/questions/56039362/go-tool-pprof-cant-set-binary-path-for-local-libraries", "title": "go tool pprof can&#39;t set binary path for local libraries", "body": "<p>The have tried to take a pprof dump of a part of our server code that we are trying to optimize. I'm not using the <code>net/http/pprof</code>, rather relying on <code>runtime/pprof</code>. My whole setup works correctly and I'm able to use the pprof dump on the server machine.</p>\n\n<p>However when I <code>scp</code> the pprof dump to my local machine - in order to use <code>web</code> since I don't want to install graphviz on my servers, pprof starts showing me this warning:</p>\n\n<pre><code>Local symbolization failed for contacts: open /home/deploy/amigo/bin/contacts: no such file or directory\nSome binary filenames not available. Symbolization may be incomplete.\nTry setting PPROF_BINARY_PATH to the search path for local binaries.\nFile: contacts\nType: cpu\nTime: May 8, 2019 at 3:27pm (IST)\nDuration: 1.06s, Total samples = 1.07s (101.25%)\nEntering interactive mode (type \"help\" for commands, \"o\" for options)\n</code></pre>\n\n<p>I copied the original <code>bin</code> from the server and try setting the <code>PPROF_BINARY_PATH</code>. But it still doesn't help. What am I doing wrong here? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 10626938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Neo Li", "link": "https://stackoverflow.com/users/10626938/neo-li"}, "edited": false, "score": 1, "creation_date": 1557314671, "post_id": 56039373, "comment_id": 98721377, "body": "Thanks for your reply, and I agree with you. It really causes problems to my testing. But I a little hate to call public Init functions, especially when there are many main in my project which means I must call Init in many places."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 153, "user_id": 10626938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Neo Li", "link": "https://stackoverflow.com/users/10626938/neo-li"}, "edited": false, "score": 2, "creation_date": 1557315396, "post_id": 56039373, "comment_id": 98721780, "body": "@NeoLi If you don&#39;t have global variables, you don&#39;t have to call <code>Init()</code> functions. Try to get rid of global variables."}, {"owner": {"reputation": 912, "user_id": 7921366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RLYPB.png?s=128&g=1", "display_name": "MatthiasSommer", "link": "https://stackoverflow.com/users/7921366/matthiassommer"}, "edited": false, "score": 0, "creation_date": 1582710374, "post_id": 56039373, "comment_id": 106867747, "body": "I have an example. I load an environment variable in init() and do os.Exit(1) if it is not set. My unit tests fail as this is always executed, being totally unrelated the file under test."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1557318481, "last_edit_date": 1557318481, "creation_date": 1557313708, "answer_id": 56039373, "question_id": 56039154, "link": "https://stackoverflow.com/questions/56039154/is-it-really-bad-to-use-init-in-go/56039373#56039373", "title": "Is it really bad to use init in go?", "body": "<p>Package <code>init()</code> functions are a handy tool, sometimes necessary, but should not be overused. They are often used to initialize some global variables, but even global variables should be avoided as much as possible.</p>\n\n<p>Quote from <a href=\"https://github.com/leighmcculloch/gochecknoinits\" rel=\"noreferrer\"><code>github.com/leighmcculloch/gochecknoinits</code></a>:</p>\n\n<blockquote>\n  <p>Init functions cause an import to have a side effects, and side effects are hard to test, reduce readability and increase the complexity of code.</p>\n</blockquote>\n\n<p>There is your answer. When you import a package, its <code>init()</code> functions are called and may do whatever they want to. They may change things some of your (unrelated) tests depend on, so whether your tests pass could depend on whether you import a specific package.</p>\n\n<p>Further reading: <a href=\"https://leighmcculloch.com/posts/tool-go-check-no-globals-no-inits/\" rel=\"noreferrer\">Go: No globals, no init functions</a></p>\n"}], "owner": {"reputation": 153, "user_id": 10626938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Neo Li", "link": "https://stackoverflow.com/users/10626938/neo-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3870, "favorite_count": 1, "accepted_answer_id": 56039373, "answer_count": 1, "score": 7, "last_activity_date": 1557318481, "creation_date": 1557313045, "question_id": 56039154, "link": "https://stackoverflow.com/questions/56039154/is-it-really-bad-to-use-init-in-go", "title": "Is it really bad to use init in go?", "body": "<p>I started a new go projects a few days ago, and I use golangci-lint to make my code in good style. I found gochecknoinits is one of linters of golangci-lint, and it tells me not to use init.</p>\n\n<p>In my opinion, I can put simple initial code in init for convenience. Without init, I must write a Init function and find somewhere to call it before use that package. This can be forgotten or be done multiple times. </p>\n\n<p>So, is it really bad to use init in go?</p>\n"}, {"tags": ["multithreading", "go", "race-condition", "goroutine"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1557311754, "post_id": 56038613, "comment_id": 98719688, "body": "<i>&quot;From my understanding it is bound to run into a race condition sometime ...&quot;</i> - can you please explain your understanding in more detail, i.e. where exactly you see a race conditions which should happen in what circumstances and how should the result look like if the race happened? So far it is only that you expect some race without telling any details about it and then expect others to explain why the thing you did not explain did not happen."}, {"owner": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1557312070, "post_id": 56038613, "comment_id": 98719874, "body": "@SteffenUllrich I have added more detail to the question."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1557312421, "post_id": 56038613, "comment_id": 98720082, "body": "Care must be taken: not all file systems are POSIX-compatible. Best would be to synchronize / serialize the writes (appends) to the file. It&#39;s a waste to open / close it every time. Open it once, and close it where you&#39;re done with all your files."}, {"owner": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557312550, "post_id": 56038613, "comment_id": 98720150, "body": "@icza I understand. I purposefully wanted to force a race condition just for testing."}], "answers": [{"comments": [{"owner": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "edited": false, "score": 0, "creation_date": 1557313065, "post_id": 56038874, "comment_id": 98720484, "body": "Well, removing the <code>O_APPEND</code> flag made no difference. Maybe a little slower but the result is the same."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "edited": false, "score": 0, "creation_date": 1557313275, "post_id": 56038874, "comment_id": 98720586, "body": "@HamedMomeni: if you remove <code>O_APPEND</code> you&#39;ll get a file which always contains only a single md5sum since every new <code>open+write</code> will write at the beginning of the file. Maybe you should be more clear what exactly you expect as result of the race."}, {"owner": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "edited": false, "score": 0, "creation_date": 1557313505, "post_id": 56038874, "comment_id": 98720737, "body": "Well I expect to some lines to be mingled and also the total number of lines should be inconsistent. But it is not the case with this code."}, {"owner": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "edited": false, "score": 0, "creation_date": 1557313605, "post_id": 56038874, "comment_id": 98720814, "body": "And as for why I&#39;m not getting a single line output, I moved file opening outside the write function so as not to open the file anew for every call."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "edited": false, "score": 0, "creation_date": 1557313844, "post_id": 56038874, "comment_id": 98720944, "body": "@HamedMomeni: <i>&quot;I moved file opening outside the write function so as not to open the file anew for every call.&quot;</i> - Which is a totally different thing than what you did in your question. Because in this case you have the shared file offset in the OS kernel - which again does not produce a race. A race could happen if you do the open in the go routine, seek to the end of the file and then write. Because only then you have a local file offset which can get affected by the race between seeking and writing."}, {"owner": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "edited": false, "score": 0, "creation_date": 1557314121, "post_id": 56038874, "comment_id": 98721080, "body": "Ok, I&#39;m starting to get it now. Thanks for the explanation. As you have said if I open the file in every goroutine and skip the <code>O_APPEND</code> flag I get the race condition I&#39;m looking for. Well the OS does a very good job to protect us from our own stupidity."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 2, "last_activity_date": 1557312195, "creation_date": 1557312195, "answer_id": 56038874, "question_id": 56038613, "link": "https://stackoverflow.com/questions/56038613/why-isnt-this-code-hitting-a-race-condition/56038874#56038874", "title": "Why isn&#39;t this code hitting a race condition?", "body": "<blockquote>\n  <p>When I say it is bound to face a race condition I mean when running multiple goroutines it is possible for more than one goroutine to want to write to file at the same time.</p>\n</blockquote>\n\n<p>It is not a problem to open a file multiple times. And since you explicitly use <code>O_APPEND</code> the writes don't interact badly with each other. To cite \n from <a href=\"http://man7.org/linux/man-pages/man2/open.2.html\" rel=\"nofollow noreferrer\">man open</a>:</p>\n\n<blockquote>\n  <p><strong>O_APPEND</strong> ...<br>\n  Before each write(2), the file offset is positioned at the end of the file, as if with lseek(2). The <strong>modification of the file offset and the write operation are performed as a single atomic step</strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 7679, "user_id": 370073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3a08086180419f07762db20ba8cc0904?s=128&d=identicon&r=PG", "display_name": "2hamed", "link": "https://stackoverflow.com/users/370073/2hamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56038874, "answer_count": 1, "score": -3, "last_activity_date": 1557312195, "creation_date": 1557311289, "last_edit_date": 1557312022, "question_id": 56038613, "link": "https://stackoverflow.com/questions/56038613/why-isnt-this-code-hitting-a-race-condition", "title": "Why isn&#39;t this code hitting a race condition?", "body": "<p>I have this go code which walks a directory file tree and produces MD5 hashes of every file in it and writes the result in an output file.  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"crypto/md5\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"path/filepath\"\n    \"sync\"\n)\n\nfunc main() {\n\n    filePath := os.Args[1]\n    output := os.Args[2]\n    wg := &amp;sync.WaitGroup{}\n\n    err := filepath.Walk(filePath, func(path string, info os.FileInfo, err error) error {\n        if !info.IsDir() {\n            wg.Add(1)\n            go func(path string) {\n                md5Sum, _ := md5File(path)\n                if err := writeToFile(path, md5Sum, output); err != nil {\n                    panic(err)\n                }\n                wg.Done()\n            }(path)\n        }\n        return nil\n    })\n    if err != nil {\n        panic(err)\n    }\n    wg.Wait()\n}\n\nfunc md5File(filePath string) (string, error) {\n    file, err := os.Open(filePath)\n    if err != nil {\n        return \"\", err\n    }\n    defer file.Close()\n\n    hash := md5.New()\n    if _, err := io.Copy(hash, file); err != nil {\n        return \"\", err\n    }\n\n    checksum := hash.Sum(nil)\n\n    return string(hex.EncodeToString(checksum)), nil\n}\n\nfunc writeToFile(filePath, md5sum, output string) error {\n\n    file, err := os.OpenFile(output, os.O_WRONLY|os.O_APPEND|os.O_CREATE, 0755)\n    if err != nil {\n        return err\n    }\n\n    defer file.Close()\n\n    file.WriteString(fmt.Sprintf(\"%s %s\\n\", md5sum, filePath))\n\n    return file.Sync()\n}\n</code></pre>\n\n<p>From my understanding it is bound to run into a race condition sometime upon writing to the output file but it never does. I mean I have executed this code countless times never facing any issues. It even produces the same result every time.</p>\n\n<p>Why is that? Am I missing something?</p>\n\n<p><strong>UPDATE:</strong> When I say it is bound to face a race condition I mean when running multiple goroutines it is possible for more than one goroutine to want to write to file at the same time.</p>\n"}, {"tags": ["go", "file-io", "file-permissions"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1557318375, "post_id": 56038512, "comment_id": 98723408, "body": "If that&#39;s the behavior you want, then do that. We can&#39;t really answer what you want the permissions to be for you."}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 1, "last_activity_date": 1557319625, "creation_date": 1557319625, "answer_id": 56041168, "question_id": 56038512, "link": "https://stackoverflow.com/questions/56038512/what-should-i-pass-for-the-perm-argument-to-ioutil-writefile/56041168#56041168", "title": "What should I pass for the `perm` argument to ioutil.WriteFile?", "body": "<p>There is no standard permission that's \"generally recommended\". This is more of an OS question than a Go question.</p>\n\n<ul>\n<li>Do you want your file to be executable?</li>\n<li>Do you want it to be writable?</li>\n<li>Do you want other accounts to be able to access it and with which permissions</li>\n</ul>\n\n<p>If you're taking an existing file and transforming it to the output file, and it's logically OK for your application to have both files with the same permissions, then copying permissions sounds like a reasonable idea (unless you foresee security issues).</p>\n"}, {"tags": [], "owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "is_accepted": true, "score": 1, "last_activity_date": 1557329849, "creation_date": 1557329849, "answer_id": 56044339, "question_id": 56038512, "link": "https://stackoverflow.com/questions/56038512/what-should-i-pass-for-the-perm-argument-to-ioutil-writefile/56044339#56044339", "title": "What should I pass for the `perm` argument to ioutil.WriteFile?", "body": "<blockquote>\n  <p>In the general case, is there a recommended value to pass for the <code>perm</code> argument?</p>\n</blockquote>\n\n<p><code>0666</code>. This is the value used by Go's <a href=\"https://golang.org/pkg/os/#Create\" rel=\"nofollow noreferrer\"><code>os.Create</code></a>, and is also the value of <a href=\"http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/system.h\" rel=\"nofollow noreferrer\"><code>MODE_RW_UGO</code></a>, used when a file is created by tools such as <a href=\"http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/touch.c\" rel=\"nofollow noreferrer\"><code>touch</code></a>.</p>\n\n<blockquote>\n  <p>More specifically, I am writing a file which is a transformation of an existing file. Is it recommended to read the permissions of the input file (using <a href=\"https://golang.org/pkg/os/#Stat\" rel=\"nofollow noreferrer\"><code>os.Stat</code></a>) and use the same permissions for the output file?</p>\n</blockquote>\n\n<p>Other than pure <code>cp</code>, tools don't seem to do this. As above, tools that create new files generally just use <code>0666</code>.</p>\n"}], "owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 56044339, "answer_count": 2, "score": -3, "last_activity_date": 1557329849, "creation_date": 1557310986, "question_id": 56038512, "link": "https://stackoverflow.com/questions/56038512/what-should-i-pass-for-the-perm-argument-to-ioutil-writefile", "title": "What should I pass for the `perm` argument to ioutil.WriteFile?", "body": "<p><a href=\"https://golang.org/pkg/io/ioutil/#WriteFile\" rel=\"nofollow noreferrer\"><code>ioutil.WriteFile</code></a> takes a <code>perm</code> argument - if the file to write doesn't already exist, it is created with permissions <code>perm</code>:</p>\n\n<pre><code>func WriteFile(filename string, data []byte, perm os.FileMode) error\n</code></pre>\n\n<p>In the general case, is there a recommended value to pass for the <code>perm</code> argument?</p>\n\n<p>More specifically, I am writing a file which is a transformation of an existing file. Is it recommended to read the permissions of the input file (using <a href=\"https://golang.org/pkg/os/#Stat\" rel=\"nofollow noreferrer\"><code>os.Stat</code></a>) and use the same permissions for the output file?</p>\n"}, {"tags": ["go", "mqtt"], "comments": [{"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 1, "creation_date": 1557318117, "post_id": 56038448, "comment_id": 98723253, "body": "Can you provide a minimal and complete code sample, including the import of the actual mqtt library you&#39;re using?"}, {"owner": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "edited": false, "score": 1, "creation_date": 1557329848, "post_id": 56038448, "comment_id": 98730667, "body": "You can check out the answer on this question <a href=\"https://stackoverflow.com/questions/48872360/golang-mqtt-publish-and-subscribe\" title=\"golang mqtt publish and subscribe\">stackoverflow.com/questions/48872360/&hellip;</a> I think that would also help you. In essence, they&#39;ve created a channel that waits for an input (<code>SIGTERM</code>). As long as that input doesn&#39;t come, the program won&#39;t stop and the connection will remain open."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5061830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jyg44uYh7-Q/AAAAAAAAAAI/AAAAAAAAApA/cbRNvI3x9ZY/photo.jpg?sz=128", "display_name": "Raunak Singwi", "link": "https://stackoverflow.com/users/5061830/raunak-singwi"}, "is_accepted": false, "score": 0, "last_activity_date": 1618824400, "creation_date": 1618824400, "answer_id": 67159352, "question_id": 56038448, "link": "https://stackoverflow.com/questions/56038448/keep-a-mqtt-go-client-running/67159352#67159352", "title": "Keep a MQTT Go client running", "body": "<p>You have to make the program run infinitely or unless you want to explicitly end it (Cntrl c). One good solution that worked for me is to wait for a channel before exiting the main function and that channel can keep listening for an interrupt.</p>\n<p>Eg:</p>\n<pre><code>func main() {\n\n    keepAlive := make(chan os.Signal)\n    signal.Notify(keepAlive, os.Interrupt, syscall.SIGTERM)\n\n    // All your code\n\n    &lt;-keepAlive\n}\n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 9243790, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/461ba83f504b5073e9528791b3464bea?s=128&d=identicon&r=PG&f=1", "display_name": "NeitoFR", "link": "https://stackoverflow.com/users/9243790/neitofr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1618824400, "creation_date": 1557310774, "last_edit_date": 1557328729, "question_id": 56038448, "link": "https://stackoverflow.com/questions/56038448/keep-a-mqtt-go-client-running", "title": "Keep a MQTT Go client running", "body": "<p>I think it is a silly question, I need a MQTT Client to keep running after connection and subscription. I never encountered the problem because my MQTT clients are always coupled with an HTTP server, and when launching a HTTP server, the code don't stop running. </p>\n\n<p>But in the present use case I only need a MQTT Client to subscribe to some topic and stay alive.</p>\n\n<p>Here is what I do (the function just connect to a broker and subcribe to one topic.)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    godotenv.Load(\"./.env\")\n    _initMqttConnection()\n}\n</code></pre>\n\n<p>I need the client to stay connected and not stop just after the subscription is done. </p>\n\n<p>How to perform that simple thing ?</p>\n\n<p>Edit 1 : Complete Code </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>package main\r\n\r\nimport (\r\n\t\"encoding/json\"\r\n\t\"fmt\"\r\n\t\"log\"\r\n\t\"net/http\"\r\n\t\"os\"\r\n\t\"path/filepath\"\r\n\t\"strings\"\r\n\r\n\t\"github.com/yosssi/gmq/mqtt\"\r\n\t\"github.com/yosssi/gmq/mqtt/client\"\r\n\r\n\t\"github.com/joho/godotenv\"\r\n\r\n\t\"github.com/skratchdot/open-golang/open\"\r\n)\r\n\r\nvar cli *client.Client\r\n\r\nfunc _initMqttConnection() {\r\n\tcli = client.New(&amp;client.Options{\r\n\t\tErrorHandler: func(err error) {\r\n\t\t\tfmt.Println(err)\r\n\t\t},\r\n\t})\r\n\tdefer cli.Terminate()\r\n\tlog.Println(\"Connecting to \" + os.Getenv(\"mqtt_host\"))\r\n\r\n\terr := cli.Connect(&amp;client.ConnectOptions{\r\n\t\tNetwork:  \"tcp\",\r\n\t\tAddress:  os.Getenv(\"mqtt_host\"),\r\n\t\tUserName: []byte(os.Getenv(\"mqtt_user\")),\r\n\t\tPassword: []byte(os.Getenv(\"mqtt_password\")),\r\n\t\tClientID: []byte(\"mqtt_video_launcher\"),\r\n\t})\r\n\tif err != nil {\r\n\t\tlog.Println(\"Error 1\")\r\n\t\tpanic(err)\r\n\t}\r\n\tlog.Println(\"Connected to MQTT\")\r\n\r\n\ttopic_to_sub := []byte(\"/\" + os.Getenv(\"video_topic\"))\r\n\r\n\terr = cli.Subscribe(&amp;client.SubscribeOptions{\r\n\t\tSubReqs: []*client.SubReq{\r\n\t\t\t&amp;client.SubReq{\r\n\t\t\t\tTopicFilter: topic_to_sub,\r\n\t\t\t\tQoS:         mqtt.QoS0,\r\n\t\t\t\tHandler: func(topicName, message []byte) {\r\n\t\t\t\t\t//do struff with message\r\n          fmt.Println(string(topicName), string(message))\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t})\r\n\tif err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n\tlog.Println(\"Subscription OK : \" + string(topic_to_sub[:len(topic_to_sub)]))\r\n}\r\n\r\nfunc main() {\r\n\tgodotenv.Load(\"./.env\")\r\n\t_initMqttConnection()\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The temporary solution I use is adding : </p>\n\n<pre><code>http.ListenAndServe(\":\", nil)\n</code></pre>\n\n<p>at the end. </p>\n"}, {"tags": ["go", "x509", "csr"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1557312593, "post_id": 56038083, "comment_id": 98720173, "body": "A certificate does not get created directly from a CSR. A CSR only contains the public key and some information which the one requesting the certificate wants to have included in the certificate. The CA only takes selected information from the CSR for the created certificate and adds some more information. There is not even a CSR needed in the first place to generate a certificate. Thus all you could check if some specific information match, like the subject and the public key."}, {"owner": {"reputation": 97, "user_id": 10407203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sUaCdSM-aLY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXx_aDQ1MlPNzgWvEss0bfN12Om_w/mo/photo.jpg?sz=128", "display_name": "Miguel Reis", "link": "https://stackoverflow.com/users/10407203/miguel-reis"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1557312869, "post_id": 56038083, "comment_id": 98720364, "body": "Yes I am aware that a CA just takes the CSR&#39;s content in order to create the certificate and there is no real link between a CSR and Certificate. I just thought that could exist a function/library to check if a certificate was generated based on the content of a CSR.  &quot;Thus all you could check if some specific information match, like the subject and the public key&quot;: yes that will work.  Thank you for your response!"}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 52366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1446a1a4d86835b88d871f40fef47419?s=128&d=identicon&r=PG", "display_name": "akakjs", "link": "https://stackoverflow.com/users/52366/akakjs"}, "is_accepted": true, "score": 0, "last_activity_date": 1557770709, "last_edit_date": 1557770709, "creation_date": 1557319153, "answer_id": 56041028, "question_id": 56038083, "link": "https://stackoverflow.com/questions/56038083/check-if-x509-certificate-matches-a-certificaterequest-csr/56041028#56041028", "title": "Check if X509 Certificate matches a CertificateRequest (CSR)", "body": "<p>If your signing request is in the DER format there's a couple of functions in the standard library you can use; first to parse the CSR (<a href=\"https://golang.org/pkg/crypto/x509/#ParseCertificateRequest\" rel=\"nofollow noreferrer\">https://golang.org/pkg/crypto/x509/#ParseCertificateRequest</a>) and then the certificate (<a href=\"https://golang.org/pkg/crypto/x509/#ParseCertificate\" rel=\"nofollow noreferrer\">https://golang.org/pkg/crypto/x509/#ParseCertificate</a>). Once parsed you can compare the public key values.</p>\n\n<p>Standard but important security note:</p>\n\n<p>Please note that this DOES NOT validate the certificate in anyway. It may or may not be safe to use, and could have been substituted or altered.</p>\n"}], "owner": {"reputation": 97, "user_id": 10407203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sUaCdSM-aLY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXx_aDQ1MlPNzgWvEss0bfN12Om_w/mo/photo.jpg?sz=128", "display_name": "Miguel Reis", "link": "https://stackoverflow.com/users/10407203/miguel-reis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 56041028, "answer_count": 1, "score": -1, "last_activity_date": 1557770709, "creation_date": 1557309592, "last_edit_date": 1557318510, "question_id": 56038083, "link": "https://stackoverflow.com/questions/56038083/check-if-x509-certificate-matches-a-certificaterequest-csr", "title": "Check if X509 Certificate matches a CertificateRequest (CSR)", "body": "<p>How can I check if a x509 certificate matches a CSR (if the certificate was generated based on a specific CSR) in Go? Do I need to generate a new certificate from the CSR and compare them?</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 1107, "user_id": 2579309, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/37f47fd5ebdaa3c4b2eb0b90522e6d1a?s=128&d=identicon&r=PG", "display_name": "Mullefa", "link": "https://stackoverflow.com/users/2579309/mullefa"}, "edited": false, "score": 0, "creation_date": 1557312128, "post_id": 56038529, "comment_id": 98719901, "body": "thanks - so just to clarify, by calling <code>db.Query(...)</code> I have created a new database client, but no connections have yet been created? Therefore, when <code>db.Query(...)</code> is called, an attempt is made to create a connection and (for whatever reason) one isn&#39;t created within the (specified?) time, resulting in a connection timeout? I think I got the wrong end of the stick, assuming connection timeout meant the connection was closed after a set period of time, but in fact it was never open!"}, {"owner": {"reputation": 1164, "user_id": 2888851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oZ14C.jpg?s=128&g=1", "display_name": "Alley Shairu", "link": "https://stackoverflow.com/users/2888851/alley-shairu"}, "reply_to_user": {"reputation": 1107, "user_id": 2579309, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/37f47fd5ebdaa3c4b2eb0b90522e6d1a?s=128&d=identicon&r=PG", "display_name": "Mullefa", "link": "https://stackoverflow.com/users/2579309/mullefa"}, "edited": false, "score": 1, "creation_date": 1557313321, "post_id": 56038529, "comment_id": 98720614, "body": "My understanding is that whenever you call some function that needs to communicate with the database, the first thing they do is look for an free connection in the pool and use that. If there isn&#39;t any free connection then it opens a new connection. When the function completes it ultimately returns the connection back to pool."}], "tags": [], "owner": {"reputation": 1164, "user_id": 2888851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oZ14C.jpg?s=128&g=1", "display_name": "Alley Shairu", "link": "https://stackoverflow.com/users/2888851/alley-shairu"}, "is_accepted": true, "score": 1, "last_activity_date": 1557311047, "creation_date": 1557311047, "answer_id": 56038529, "question_id": 56037887, "link": "https://stackoverflow.com/questions/56037887/connect-connection-timed-out/56038529#56038529", "title": "connect: connection timed out", "body": "<blockquote>\n  <p>sql.Open() may just validate its arguments <strong>without creating a connection</strong> to\n  the database. To verify that the data source name is valid, <strong>call Ping</strong>.</p>\n</blockquote>\n\n<p>The <code>sql.Open()</code> function has only created an object, your pool is currently empty. In simple words connection with the database hasn't been established yet.</p>\n\n<p>You need to call <code>db.Ping()</code> to make sure your pool has a working connection.</p>\n"}], "owner": {"reputation": 1107, "user_id": 2579309, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/37f47fd5ebdaa3c4b2eb0b90522e6d1a?s=128&d=identicon&r=PG", "display_name": "Mullefa", "link": "https://stackoverflow.com/users/2579309/mullefa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "accepted_answer_id": 56038529, "answer_count": 1, "score": 1, "last_activity_date": 1557318529, "creation_date": 1557308976, "last_edit_date": 1557318529, "question_id": 56037887, "link": "https://stackoverflow.com/questions/56037887/connect-connection-timed-out", "title": "connect: connection timed out", "body": "<p>I have successfully connected to a Postgres database using the go sql package:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>...\ndb, err := sql.Open(\"postgres\", connStr)\n</code></pre>\n\n<p>I then use the returned database to execute a (long running) query:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>rows, err := db.Query(...)\n</code></pre>\n\n<p>And am getting the error:</p>\n\n<pre><code>dial tcp xx.xxx.xxx.xx:5432: connect: connection timed out\n</code></pre>\n\n<p>I have a couple of questions regarding this:</p>\n\n<ol>\n<li>why is the connection timing out?</li>\n<li>is there anything I can do to prevent it timing out?</li>\n</ol>\n"}, {"tags": ["docker", "go", "docker-compose", "vscode-debugger", "delve"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1584651608, "post_id": 56058071, "comment_id": 107509876, "body": "That bug report just got closed: see my <a href=\"https://stackoverflow.com/a/57433817/6309\">edited answer below</a>"}], "tags": [], "owner": {"reputation": 83, "user_id": 3900870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f3186125d89a4bc9ff7d54a9d697adf?s=128&d=identicon&r=PG&f=1", "display_name": "joedoe150", "link": "https://stackoverflow.com/users/3900870/joedoe150"}, "is_accepted": true, "score": 2, "last_activity_date": 1557400166, "creation_date": 1557400166, "answer_id": 56058071, "question_id": 56037313, "link": "https://stackoverflow.com/questions/56037313/breakpoints-in-vscode-win-10-unverified-and-not-hit-when-remote-debugging-go/56058071#56058071", "title": "Breakpoints in vscode (Win 10) &quot;unverified&quot; and not hit when remote debugging Go app in Linux Docker container (Hyper-V)", "body": "<p>I have finally found a <a href=\"https://github.com/microsoft/vscode-go/issues/2010\" rel=\"nofollow noreferrer\">bug report</a> on this, so it appears to be an open bug for now. Leaving this here for anybody searching as this bug was not easy to find (for me at least).</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1584651573, "last_edit_date": 1584651573, "creation_date": 1565367190, "answer_id": 57433817, "question_id": 56037313, "link": "https://stackoverflow.com/questions/56037313/breakpoints-in-vscode-win-10-unverified-and-not-hit-when-remote-debugging-go/57433817#57433817", "title": "Breakpoints in vscode (Win 10) &quot;unverified&quot; and not hit when remote debugging Go app in Linux Docker container (Hyper-V)", "body": "<p>I just experienced the same issue, with the latest (July 2019) 1.37.0 VSCode, dlv 1.2.0 and Go 1.12.7, on a local Windows 10 machine (no Docker, just attach to a localhost running Go program).</p>\n\n<p>In my case, the <code>project\\.vscode\\launch.json</code> was:</p>\n\n<pre><code>{\n    // Use IntelliSense to learn about possible attributes.\n    // Hover to view descriptions of existing attributes.\n    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Remote Debug\",\n            \"type\": \"go\",\n            \"request\": \"attach\",\n            \"mode\": \"remote\",\n            \"remotePath\": \"C:\\\\Users\\\\VonC\\\\git\\\\go-gitea\\\\gitea.exe\",\n            \"cwd\": \"C:\\\\Users\\\\VonC\\\\git\\\\go-gitea\",\n            \"port\": 2345,\n            \"host\": \"127.0.0.1\",\n            \"showLog\": true,\n            \"trace\": \"verbose\",\n        }\n    ]\n}\n</code></pre>\n\n<p>By activating the log and verbose traces, I clearly saw the root cause:</p>\n\n<pre><code>Error on CreateBreakpoint: could not find C:\\Users\\VonC\\git\\go-gitea\\gitea.exe\\models\\repo.go:230\n</code></pre>\n\n<p>I mixed-up remotePath for the executable.</p>\n\n<pre><code>\"remotePath\": \"C:\\\\Users\\\\VonC\\\\git\\\\go-gitea\",\n</code></pre>\n\n<p>With a path, that same configuration worked flawlessly, and my breakpoints were recognized (and stopped when encountered during the execution).</p>\n\n<p>Maybe the <a href=\"https://github.com/microsoft/vscode-go/issues/2010\" rel=\"nofollow noreferrer\">microsoft/vscode-go issue 2010</a> is still valid when trying to remote attach to a program in a Docker container.</p>\n\n<hr>\n\n<p>Update March 2020: <a href=\"https://github.com/microsoft/vscode-go/issues/2010\" rel=\"nofollow noreferrer\"><code>microsoft/vscode-go</code> issue 2010</a> is now closed with <a href=\"https://github.com/microsoft/vscode-go/pull/3108\" rel=\"nofollow noreferrer\">PR 3108</a>, from <a href=\"https://github.com/quoctruong\" rel=\"nofollow noreferrer\"><strong>Quoc Truong</strong></a>, <a href=\"https://github.com/microsoft/vscode-go/commit/7da50774f84578b5ec6c46b27c0a3446d485f4a6\" rel=\"nofollow noreferrer\">commit 7da5077</a>.</p>\n\n<blockquote>\n  <p>When we are remote debugging cross-compiled binary on Windows, we are not respecting the separator that users use in <code>remotePath</code> field.</p>\n</blockquote>\n\n<p>That should be in VSCode 1.44, March 2020 edition.</p>\n"}], "owner": {"reputation": 83, "user_id": 3900870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f3186125d89a4bc9ff7d54a9d697adf?s=128&d=identicon&r=PG&f=1", "display_name": "joedoe150", "link": "https://stackoverflow.com/users/3900870/joedoe150"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 1, "accepted_answer_id": 56058071, "answer_count": 2, "score": 4, "last_activity_date": 1584651573, "creation_date": 1557306904, "last_edit_date": 1557344281, "question_id": 56037313, "link": "https://stackoverflow.com/questions/56037313/breakpoints-in-vscode-win-10-unverified-and-not-hit-when-remote-debugging-go", "title": "Breakpoints in vscode (Win 10) &quot;unverified&quot; and not hit when remote debugging Go app in Linux Docker container (Hyper-V)", "body": "<p>I am developing a Go (1.12.0) api-server using vscode (1.34.0 insider and stable builds) for Windows 10. The source code is located on the Windows machine in the defined %GOPATH%. Delve (dlv.exe - version 1.2.0) is also installed in %GOPATH%\\bin and %GOPATH%\\bin is also in the Windows %PATH%.</p>\n\n<p>The go app is then built in a Docker (Docker Desktop Version 2.0.0.3 (31259)) container with docker-compose (as some other services such as Database and web-server are running in other containers). The final go app binary is then copied to an Alpine-Linux container together with the delve executable and the delve server is started in headless mode. No source code is copied over to the Alpine-Linux container, just the binaries.</p>\n\n<p>I have not managed to get remote debugging set up properly in vscode with this set-up. The debugger does start my app but any breakpoints immediately turn grey and become \"unverified\". They are also not hit when the app (api server) runs.</p>\n\n<p>Debugging with this set-up works perfectly (debugger starts, breakpoints can be set and are hit) when using the Goland IDE from Jetbrains for remote debugging.</p>\n\n<p>I have tried to find a solution over the last couple of days, finding forum posts with similar problems for Chrome debugging, Node.js debugging etc. and this post on Go, specifically:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/39456064/remote-debugging-unverified-breakpoint\">Remote debugging - Unverified breakpoint</a></p>\n\n<p>I also found this sample config:</p>\n\n<p><a href=\"https://github.com/lukehoban/webapp-go/blob/debugging/.vscode/launch.json\" rel=\"nofollow noreferrer\">https://github.com/lukehoban/webapp-go/blob/debugging/.vscode/launch.json</a></p>\n\n<p>I think the main problem I had is that nowhere could I find any examples of how to properly set the path of the program in launch.json for the remote debug config on a Windows machine (nor could I find any documentation referring to this). The source code is only on the Windows machine in GOPATH, not in the final container the app and delve run in (and this, again, works fine with Goland debugger)</p>\n\n<p>My project path/directory structure (simplified):</p>\n\n<pre><code>%GOPATH%\\github.com\\myuser\\project_dir\\\n   .vscode\\\n      launch.json\n   cmd\\\n      my_api\\\n          main.go\n      another_app\\\n          main.go\n   package1\\\n      package1.go (this is where I am setting the breakpoint, this package is imported in cmd\\my_api\\main.go)\n   Dockerfile\n   ... (.gitignore, GoPkg etc.)\n</code></pre>\n\n<p>My current launch.json config (see some variants I tried below)</p>\n\n<p>launch.json - remote config</p>\n\n<pre><code>{\n         \"name\": \"RemoteDockerAPI\",\n         \"type\": \"go\",\n         \"request\": \"launch\",\n         \"mode\": \"remote\",\n         \"program\": \"${workspaceFolder}/cmd/my_api\",\n         \"env\": {},\n         \"args\": [],\n         \"remotePath\": \"/my_api\",\n         \"port\": 40400, // Port \n         \"host\": \"127.0.0.1\", // Docker IP\n         \"showLog\": true\n}\n</code></pre>\n\n<p>Notes: project_folder/cmd/my_api is where the main.go for the api server is located. However, some of the packages for this app are located under the project folder directly, i.e. project_folder/package1/package1.go</p>\n\n<p>I have tried with just</p>\n\n<pre><code>\"program\": \"${workspaceFolder}\",\n</code></pre>\n\n<p>and </p>\n\n<pre><code>\"program\": \"${workspaceFolder}\\\\cmd\\\\my_api\",\n</code></pre>\n\n<p>and</p>\n\n<pre><code>\"program\": \"${workspaceFolder}/cmd/my_api\",\n</code></pre>\n\n<p>and </p>\n\n<pre><code>\"program\": \"${workspaceFolder}\\\\cmd\\\\my_api\\\\main.go\",\n</code></pre>\n\n<p>and</p>\n\n<pre><code>\"program\": \"${workspaceFolder}/cmd/my_api/main.go\",\n</code></pre>\n\n<p>I also tried to change this (with no discern-able change): </p>\n\n<pre><code>\"remotePath\": \"/\",\n</code></pre>\n\n<p>without success.</p>\n\n<p>My multi-stage Dockerfile for building the app and launching delve in headless mode:</p>\n\n<pre><code>FROM golang:1.11.6-alpine3.9 AS builder\n\nRUN wget -O /usr/bin/dep 'https://github.com/golang/dep/releases/download/v0.5.1/dep-linux-amd64' \\\n    &amp;&amp; chmod +x /usr/bin/dep\n\n# For debugging: conmpile Delve\nRUN apk add --no-cache git\nRUN go get github.com/derekparker/delve/cmd/dlv\n\n# Copy Code and build it:\nWORKDIR $GOPATH/src/github.com/myuser/my_api/\nCOPY Gopkg.toml Gopkg.lock ./\nRUN dep ensure --vendor-only\nCOPY . ./\n\n# Compile with necessary flags for delve\nRUN CGO_ENABLED=0 GOOS=linux go build -gcflags \"all=-N -l\" -a -installsuffix nocgo -o /my_api ./cmd/my_api\n\nFROM alpine:3.9 AS runtime-base\n\n# DEBUGGING: Allow delve to run on Alpine based containers.\nRUN apk add --no-cache libc6-compat\n\n# App container\nFROM runtime-base\n\nWORKDIR /\n# Copy certificates\nCOPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\n# Copy app\nCOPY --from=builder /my_api ./\n# Copy delve\nCOPY --from=builder /go/bin/dlv /\n\n# 40400 for delve\nEXPOSE 40400\n\nCMD [\"/dlv\",\"--listen=:40400\",\"--headless=true\",\"--api-version=2\", \"exec\", \"./my_api\"]\n</code></pre>\n\n<p>I set a breakpoint in one of the packages (not in project_dir/cmd/my_api/main.go, but for example in project_dir/package1/package1.go). This turns grey and \"unverified\" as soon as I launch the debugger in vscode and the breakpoint is not hit.</p>\n\n<p>I may be doing something wrong on a really simple level, but I can't seem to figure out what.</p>\n\n<p><strong>UPDATE</strong>\nI have finally found the debugger log and see this:</p>\n\n<pre><code>From client: setBreakpoints({\"source\":{\"name\":\"package1.go\",\"path\":\"c:\\\\Users\\\\myuser\\\\go\\\\src\\\\github.com\\\\githubaccount\\\\project_dir\\\\package1\\\\package1.go\"},\"lines\":[165,170],\"breakpoints\":[{\"line\":165},{\"line\":170}],\"sourceModified\":false})\nSetBreakPointsRequest\nAll cleared\nCreating on: C:\\Users\\myuser\\go\\src\\github.com\\githubaccount\\project_dir\\package1\\package1.go (C:/Users/myuser/go/src/github.com/githubaccount/project_dir/package1/package1.go) :165\nCreating on: C:\\Users\\myuser\\go\\src\\github.com\\githubaccount\\project_dir\\package1\\package1.go (C:/Users/myuser/go/src/github.com/githubaccount/project_dir/package1/package1.go) :170\nError on CreateBreakpoint: could not find C:/Users/myuser/go/src/github.com/githubaccount/project_dir/package1/package1.go:165\nError on CreateBreakpoint: could not find C:/Users/myuser/go/src/github.com/githubaccount/project_dir/package1/package1.go:170\n</code></pre>\n\n<p>I am not sure it helps me really figure out the problem with vscode though. Could this be a bug? I found a reference to an older MacOS bug:</p>\n\n<p><a href=\"https://github.com/Microsoft/vscode-go/issues/1859\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/vscode-go/issues/1859</a></p>\n\n<p>and</p>\n\n<p><a href=\"https://github.com/go-delve/delve/issues/1282\" rel=\"nofollow noreferrer\">https://github.com/go-delve/delve/issues/1282</a></p>\n\n<p>but these are old and fixed(?).</p>\n\n<p>With the exception of the windows path separators (\"\\\") being converted to Unix-style path separators \"/\" by vscode(?), the path is correct, the file exists and the lines to set the breakpoints on are in the middle of the file (and correct)...</p>\n\n<p>In vscode, if I CTRL-click on the path shown in \"could not find..\" (made into a link by vscode), it takes me right to the file (so vscode can find/see it no problem).</p>\n\n<p>This connects no problem on the Windows host (but only if called from within this directory):</p>\n\n<pre><code>%GOPATH%\\...\\project_dir\\cmd\\my_api\\dlv debug -l 127.0.0.1:40400\n</code></pre>\n\n<p>and </p>\n\n<pre><code>(dlv) funcs any_function_in_package1 \n</code></pre>\n\n<p>finds this function, so the (source) code seems to be visible to delve.</p>\n\n<p>Setting the breakpoint I want in Delve directly also works:</p>\n\n<pre><code>(dlv) break C:/Users/myuser/go/src/github.com/githubaccount/project_dir/package1/package1.go:170\nBreakpoint 1 set at 0xad8dd8 for github.com/githubaccount/project_dir/package1.(*Struct).Function() C:/Users/myuser/go/src/github.com/githubaccount/project_dir/package1/package1.go:170\n</code></pre>\n\n<p>Windows-style path also works the same way on the command line:</p>\n\n<pre><code>(dlv) break C:\\Users\\myuser\\go\\src\\github.com\\githubaccount\\project_dir\\package1\\package1.go:170\nBreakpoint 1 set at 0xad8dd8 for github.com/githubaccount/project_dir/package1.(*Struct).Function() C:/Users/myuser/go/src/github.com/githubaccount/project_dir/package1/package1.go:170\n</code></pre>\n\n<p>Is this a Windows/Unix path-style issue in vscode? Any suggestions?</p>\n\n<p><strong>UPDATE 2</strong>\nJust found this bug report from late 2018, which seems to describe a similar problem between Delve and vscode:</p>\n\n<p><a href=\"https://github.com/bazelbuild/rules_go/issues/1844\" rel=\"nofollow noreferrer\">https://github.com/bazelbuild/rules_go/issues/1844</a></p>\n\n<p>However, as I posted above, Delve seems to have no problem being passed absolute (Windows) paths for breakpoints in my case, so I am unsure the above bug applies to this situation? Also, why would it work in Delve directly and not via vscode? Or could it be a Windows path / Unix path issue after all?</p>\n\n<p>Thank you for any help!</p>\n"}, {"tags": ["go", "time", "controller", "beego"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1557300204, "post_id": 56035498, "comment_id": 98713585, "body": "Never ignore errors. Your input time (<code>2019-5-8</code>) is invalid, but you don&#39;t notice, because you&#39;re ignoring the error."}, {"owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557300324, "post_id": 56035498, "comment_id": 98713639, "body": "@Flimzy I just don&#39;t get it. There is no error I guess. <code>&quot;yearMonth&quot;:&quot;2019&#47;5&#47;8&quot;</code> used this one. Can you explain more?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557300370, "post_id": 56035498, "comment_id": 98713659, "body": "<code>startT, err := time.Parse(time.RFC3339, timeT)</code> returns an error, which you ignore. Don&#39;t ignore it. See <a href=\"https://play.golang.org/p/QkGqYncZfQF\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557300584, "post_id": 56035498, "comment_id": 98713761, "body": "Read the error, and you will know what you did wrong. You&#39;re trying to parse an invalid date. So it returns the zero value for the date, and an error. Don&#39;t ignore that error. Ignoring the error is what you&#39;re doing wrong."}, {"owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557300731, "post_id": 56035498, "comment_id": 98713826, "body": "There is no error, if there is any error it would show me. But invalid date ? I used the <code>https:&#47;&#47;yourbasic.org&#47;golang&#47;format-parse-string-time-date-e&zwnj;&#8203;xample&#47;</code> this one."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1557301400, "post_id": 56035498, "comment_id": 98714159, "body": "There absolutely is an error. See <a href=\"https://play.golang.org/p/QkGqYncZfQF\" rel=\"nofollow noreferrer\">here</a> for proof. The problem is that you&#39;re ignoring the error. That&#39;s why it doesn&#39;t show you."}, {"owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557301798, "post_id": 56035498, "comment_id": 98714341, "body": "@Flimzy <code>err =  parsing time &quot;2019-05-08 08:00:00&quot; as &quot;2006-01-02T15:04:05Z07:00&quot;: cannot parse &quot; 08:00:00&quot; as &quot;T&quot;</code> my bad sorry."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1557301879, "post_id": 56035498, "comment_id": 98714387, "body": "That doesn&#39;t even match the code in your question. <i>Always paste exact code</i> if you want meaningful help."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1557301904, "post_id": 56035498, "comment_id": 98714407, "body": "But I&#39;m glad you found the problem. Good luck with the rest."}], "owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1557300436, "creation_date": 1557299954, "last_edit_date": 1592644375, "question_id": 56035498, "link": "https://stackoverflow.com/questions/56035498/how-to-parse-string-to-time-rangeto-date-by-orm", "title": "How to parse string to Time &amp; rangeto Date by ORM", "body": "<p>Problem is i cant filter by date range to date. It gives me zero data. But i have many data at 2019/5/7</p>\n<pre><code>timeT := &quot;2019-5-8&quot;\nstartT, err := time.Parse(time.RFC3339, timeT)\n\nxxx := now.New(startT).BeginningOfMonth()\nyyy := now.New(startT).EndOfMonth()\n\n_, err = o.QueryTable(&quot;BillDetail&quot;).Filter(&quot;OriginalID&quot;, id).Filter(&quot;Date&quot;, xxx).Filter(&quot;Date&quot;, yyy).All(&amp;bills)\n\n    if err != nil {\n    return nil, err\n}\n\nreturn bills, err\n</code></pre>\n<p>I used</p>\n<blockquote>\n<p>&quot;time&quot;</p>\n<p>&quot;github.com/jinzhu/now&quot;</p>\n<p>&quot;github.com/astaxie/beego/orm&quot;</p>\n</blockquote>\n<p>I used debug and i found this output on console</p>\n<pre><code>[ORM]2019/05/08 15:12:22  -[Queries/default] - [  OK /    db.Query /    16.9ms] - [SELECT T0.`i_d`, T0.`date`, T0.`name`, T0.`original_i_d`, T0.`value` FROM `bill_detail` T0 WHERE T0.`original_i_d` = ? AND T0.`date` = ? AND T0.`date` = ? ] - `6`, `0001-01-01 08:00:00`, `0001-01-01 08:00:00`\n</code></pre>\n<p>Pay your attention here</p>\n<pre><code>`0001-01-01 08:00:00`, `0001-01-01 08:00:00`\n</code></pre>\n"}, {"tags": ["go", "grpc-go"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7811844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fac93b75d33e19ffcd645183be9244c?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Duncan", "link": "https://stackoverflow.com/users/7811844/ian-duncan"}, "edited": false, "score": 0, "creation_date": 1557565803, "post_id": 56046917, "comment_id": 98814623, "body": "I have registered the service <a href=\"https://github.com/Duncanian/identity-management/blob/b35d825e0cdca706cd23ed8727c8b73ef48cd61e/server/index.ts#L50\" rel=\"nofollow noreferrer\">here</a> in my node.js server. Also have a look at the procedures <a href=\"https://github.com/Duncanian/identity-management/tree/develop/server/procedures\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 36, "user_id": 3477206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d434863359909b34ef9e202eb318395f?s=128&d=identicon&r=PG&f=1", "display_name": "lyuxuan", "link": "https://stackoverflow.com/users/3477206/lyuxuan"}, "reply_to_user": {"reputation": 31, "user_id": 7811844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fac93b75d33e19ffcd645183be9244c?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Duncan", "link": "https://stackoverflow.com/users/7811844/ian-duncan"}, "edited": false, "score": 0, "creation_date": 1558582471, "post_id": 56046917, "comment_id": 99151142, "body": "I am not very familiar with how node.js works. I would suggest you to use a command line tool (like <a href=\"https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md\" rel=\"nofollow noreferrer\">github.com/grpc/grpc/blob/master/doc/command_line_tool.md</a>) to check whether the service is indeed registered, because the error indicates it is not registered."}], "tags": [], "owner": {"reputation": 36, "user_id": 3477206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d434863359909b34ef9e202eb318395f?s=128&d=identicon&r=PG&f=1", "display_name": "lyuxuan", "link": "https://stackoverflow.com/users/3477206/lyuxuan"}, "is_accepted": false, "score": 0, "last_activity_date": 1557339855, "creation_date": 1557339855, "answer_id": 56046917, "question_id": 56035027, "link": "https://stackoverflow.com/questions/56035027/rpc-error-code-unimplemented-desc-rpc-method-not-implemented/56046917#56046917", "title": "rpc error: code = Unimplemented desc = RPC method not implemented", "body": "<p>The error indicates that the <code>/protobuf.IdentityService/CreateUser</code> method is not registered at the server side. And I didn't see any service registration code in your linked server code. Please take a look at the node.js guide <a href=\"https://grpc.io/docs/tutorials/basic/node/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2174, "user_id": 7127824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cde3b677ba36e4e191116a5f13dddbd2?s=128&d=identicon&r=PG&f=1", "display_name": "techkuz", "link": "https://stackoverflow.com/users/7127824/techkuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1578667164, "last_edit_date": 1578667164, "creation_date": 1576841300, "answer_id": 59424568, "question_id": 56035027, "link": "https://stackoverflow.com/questions/56035027/rpc-error-code-unimplemented-desc-rpc-method-not-implemented/59424568#59424568", "title": "rpc error: code = Unimplemented desc = RPC method not implemented", "body": "<p>Using GUI of grpc try to send your protos to your both servers and check for upcoming errors/correct endpoints. </p>\n\n<p>In my case java proto had a package inside which was added to the endpoint.<br>\nHad <code>package com.example.grpc;</code>\ninstead of \n<code>option java_package = \"com.example.grpc\";</code></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 10826535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd457a0633e0e084e4c9785773c32904?s=128&d=identicon&r=PG&f=1", "display_name": "Artur", "link": "https://stackoverflow.com/users/10826535/artur"}, "is_accepted": false, "score": 1, "last_activity_date": 1612384335, "creation_date": 1612384335, "answer_id": 66035227, "question_id": 56035027, "link": "https://stackoverflow.com/questions/56035027/rpc-error-code-unimplemented-desc-rpc-method-not-implemented/66035227#66035227", "title": "rpc error: code = Unimplemented desc = RPC method not implemented", "body": "<p>I had the same problem.</p>\n<p>Here is my solution:\nAfter compiling <code>.proto</code> I created 2 files: <code>client.go</code> and <code>server.go</code>.</p>\n<p>In <code>client.go</code> I implemented my methods (rpc in terms of protobuffers) and had a <code>main</code> function.</p>\n<p>In <code>server.go</code> I defined a server struct <code>server</code> with one field: <code>Unimplemented*ServiceName*Server</code>. After that I also implemented the mentioned above methods, but those had a receiver type: <code>func (s *server) Foo(ctx context.Context, *other params*)</code></p>\n<p>That worked for me, hopefully it will help you!</p>\n"}], "owner": {"reputation": 31, "user_id": 7811844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fac93b75d33e19ffcd645183be9244c?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Duncan", "link": "https://stackoverflow.com/users/7811844/ian-duncan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7752, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1612384335, "creation_date": 1557298141, "last_edit_date": 1557299679, "question_id": 56035027, "link": "https://stackoverflow.com/questions/56035027/rpc-error-code-unimplemented-desc-rpc-method-not-implemented", "title": "rpc error: code = Unimplemented desc = RPC method not implemented", "body": "<p>I have been trying to create a grpc client in Go and I have followed the correct instructions as shown in the official <a href=\"https://grpc.io/docs/tutorials/basic/go/#client\" rel=\"nofollow noreferrer\">grpc</a> site. When I start my grpc server written in node.js, the connection works well but upon compiling the protocol buffer in Go and creating a client interface with the correct grpc client configurations, I run into an error.</p>\n\n<p>Here is my what I have in my <code>identity.pb.go</code>.</p>\n\n<pre><code>type IdentityServiceClient interface {\n    CreateUser(ctx context.Context, in *GoogleIdToken, opts ...grpc.CallOption) (error, *UserInfo)\n}\n\ntype simpleServerClient struct {\n    connection *grpc.ClientConn\n}\n\nfunc NewSimpleServerClient(connection *grpc.ClientConn) IdentityServiceClient {\n    return &amp;simpleServerClient{connection}\n}\n\nfunc (simpleClient *simpleServerClient) CreateUser(ctx context.Context, in *GoogleIdToken, opts ...grpc.CallOption) (error, *UserInfo) {\n    out := new(UserInfo)\n    err := simpleClient.connection.Invoke(ctx, \"/protobuf.IdentityService/CreateUser\", in, out, opts...)\n\n    if err != nil {\n        return err, nil\n    }\n\n    return nil, out\n}\n</code></pre>\n\n<p>here is the <code>identity.proto</code></p>\n\n<pre><code>syntax=\"proto3\";\n\npackage protobuf;\n\nservice IdentityService {\n    rpc CreateUser (GoogleIdToken) returns (UserInfo) {}\n}\n\nmessage GoogleIdToken {\n    string token = 1;\n}\n\nmessage UserInfo {\n    string name = 1;\n    string email = 2;\n    message Profile {\n        string imageUrl = 1;\n        string lastUpdated = 2;\n    };\n    Profile profile = 3;\n    string token = 4;\n}\n\n</code></pre>\n\n<p>here is my <code>main.go</code></p>\n\n<pre><code>import pb \"github.com/Duncanian/iam-gateway/server/protobuf\"\n\nfunc grpcConnection() {\n    conn, err := grpc.Dial(\"localhost:50051\", grpc.WithInsecure())\n    if err != nil {\n        log.Fatalf(\"Failed to start gRPC connection: %v\", err)\n    }\n\n    defer conn.Close()\n\n    client := pb.NewSimpleServerClient(conn)\n\n    err, _ = client.CreateUser(context.Background(), &amp;pb.GoogleIdToken{Token: \"tevgvybububvvg\"})\n    if err != nil {\n        log.Fatalf(\"Failed to create user: %v\", err)\n    }\n    log.Println(\"Created user!\")\n}\n</code></pre>\n\n<p>I expect the output of passing a correct google auth token to get me the correct user details which are</p>\n\n<pre><code>name: user,\nemail: user.email@user.com,\nprofile: {\n   imageUrl: myimageUrl,\n   lastUpdated: mylastUpdatedTime,\n},\ntoken,\n</code></pre>\n\n<p>but got</p>\n\n<pre><code>rpc error: code = Unimplemented desc = RPC method not implemented /protobuf.IdentityService/CreateUser\n</code></pre>\n\n<p>Here are my github repos:\n<a href=\"https://github.com/Duncanian/iam-gateway/tree/ft-grpc-create-user-165677707\" rel=\"nofollow noreferrer\">Go grpc client</a> &amp;\n<a href=\"https://github.com/Duncanian/identity-management/blob/develop/server/procedures/createUser.ts\" rel=\"nofollow noreferrer\">Node JS grpc server</a></p>\n"}, {"tags": ["go", "protocol-buffers", "grpc", "grpc-go"], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557332237, "post_id": 56034906, "comment_id": 98731796, "body": "Please review <a href=\"https://stackoverflow.com/help/how-to-answer\">how-to-answer</a> a question on Stackoverflow: &quot;Links to external resources are encouraged, but please add context ... Always quote the most relevant part of an important link&quot;"}], "tags": [], "owner": {"reputation": 71, "user_id": 5202444, "user_type": "registered", "profile_image": "https://graph.facebook.com/520516124765591/picture?type=large", "display_name": "Jaskirat Singh", "link": "https://stackoverflow.com/users/5202444/jaskirat-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557383878, "last_edit_date": 1557383878, "creation_date": 1557297625, "answer_id": 56034906, "question_id": 56034049, "link": "https://stackoverflow.com/questions/56034049/grpc-message-structures/56034906#56034906", "title": "GRPC Message Structures", "body": "<p>you don't need to create structs in app code. just use messages of proto file.\nHere is a quick start for GRPC in Go.</p>\n\n<blockquote>\n  <p><a href=\"https://grpc.io/docs/quickstart/go/\" rel=\"nofollow noreferrer\">https://grpc.io/docs/quickstart/go/</a></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1359, "user_id": 1815241, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4af5ac233bc59102243f2b2266e766b1?s=128&d=identicon&r=PG", "display_name": "mornindew", "link": "https://stackoverflow.com/users/1815241/mornindew"}, "edited": false, "score": 1, "creation_date": 1557340804, "post_id": 56035656, "comment_id": 98735856, "body": "Thank you!   Useful feedback.   Sounds like GRPC really doesn&#39;t care but for safety and extensibility purposes I should decouple the two.    I can see some cases where they will be identical but in most cases there is some data that will need to be supressed.   I guess the data marshalling is a small price to pay for better decoupling.  Thanks for your response."}, {"owner": {"reputation": 170, "user_id": 8819631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8kvBO.jpg?s=128&g=1", "display_name": "Avinash Dhinwa", "link": "https://stackoverflow.com/users/8819631/avinash-dhinwa"}, "reply_to_user": {"reputation": 1359, "user_id": 1815241, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4af5ac233bc59102243f2b2266e766b1?s=128&d=identicon&r=PG", "display_name": "mornindew", "link": "https://stackoverflow.com/users/1815241/mornindew"}, "edited": false, "score": 0, "creation_date": 1557368640, "post_id": 56035656, "comment_id": 98743822, "body": "Exactly. And you have nicely put &quot;marshalling is a small price to pay&quot; in the lifecycle of a project."}], "tags": [], "owner": {"reputation": 170, "user_id": 8819631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8kvBO.jpg?s=128&g=1", "display_name": "Avinash Dhinwa", "link": "https://stackoverflow.com/users/8819631/avinash-dhinwa"}, "is_accepted": true, "score": 2, "last_activity_date": 1557323878, "last_edit_date": 1557323878, "creation_date": 1557300644, "answer_id": 56035656, "question_id": 56034049, "link": "https://stackoverflow.com/questions/56034049/grpc-message-structures/56035656#56035656", "title": "GRPC Message Structures", "body": "<p>Though a very basic question but a very good question too. People generally skip it and have to struggle with codebase later as it grows.</p>\n\n<p>Of course using message as core structs will be helpful in cases where the data you need to process the request is completely available in message. But in cases where you need to fetch data from other sources will not be helpful.</p>\n\n<p>Normally a message data is dealt by boundary-layer/controller which further uses multiple services to create a response. So a service-layer/logic-layer is independent of a controller layer and the same should happen with message structs and core structs.</p>\n\n<blockquote>\n  <p>Always try to reduce coupling between layers so that they become reusable.</p>\n</blockquote>\n\n<p>So if you have a layer which deals with database, you should have separate structs for that too.</p>\n"}], "owner": {"reputation": 1359, "user_id": 1815241, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4af5ac233bc59102243f2b2266e766b1?s=128&d=identicon&r=PG", "display_name": "mornindew", "link": "https://stackoverflow.com/users/1815241/mornindew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 56035656, "answer_count": 2, "score": 3, "last_activity_date": 1557383878, "creation_date": 1557293139, "question_id": 56034049, "link": "https://stackoverflow.com/questions/56034049/grpc-message-structures", "title": "GRPC Message Structures", "body": "<p>I am in the process of migrating a legacy application (bit of microservices and monolith) into using GRPC.  The entire code base is currently in GO.</p>\n\n<p>I have started to model my messages and they are looking very similar to my structs that I am using in my application code.   It seems odd that I have the same objects defined twice but also seems odd to use message objects as core structs.  Seems that I will have a lot of memory intensive marshaling of data though.  Below is an example of a message and a struct and how similar they are.   </p>\n\n<p>Are there any recommendations/best practices on deciding how to model my messages?   Should they be aligned with my core structs?  Should I not care about all the marshalling that has to happen from my Golang Structs into messages?   </p>\n\n<p>Forgive me if I am asking such a basic question as I am very new to protocol buffers and GRPC.</p>\n\n<p>Message Proto Def: </p>\n\n<pre><code>message Profile {\n    string UID = 1;\n    string ContactEmail = 2;\n    google.protobuf.Timestamp DateOfBirth = 3;\n    float WeightInKilos = 4;\n    string Gender = 5;\n    string Unit = 6;\n    string CurrentStatus = 7;\n    string Country = 8;\n    string ExperienceType = 9;\n    google.protobuf.Timestamp DateJoined = 10;\n    repeated Ability Abilities = 11;\n    repeated Role Roles = 12;\n    repeated TermsAndConditionsAcceptance TermsAndConditionsAcceptances = 13;\n    string TimeZone = 14;\n    repeated BaselineTestResults BaselineTests =15;\n    //Excluded UpdatedDate as other domains shouldn't need it\n    string FirstName =16;\n    string LastName =17;\n    string DisplayName = 18;\n    string State = 19;\n    repeated google.protobuf.Any Preferences = 20;\n    Thresholds Thresholds = 21;\n    string StripeCustomerID = 22;\n}\n</code></pre>\n\n<p>Struct Def:</p>\n\n<pre><code>type Profile struct {\n    UID                           string                         `json:\"UID\" firestore:\"UID\"`\n    ContactEmail                  string                         `json:\"ContactEmail,omitempty\" firestore:\"ContactEmail\"`\n    DateOfBirth                   time.Time                      `json:\"DateOfBirth,omitempty\" firestore:\"DateOfBirth\"`\n    WeightInKilos                 float64                        `json:\"WeightInKilos,omitempty\" firestore:\"WeightInKilos\"`\n    Gender                        string                         `json:\"Gender,omitempty\" firestore:\"Gender\"`\n    Unit                          string                         `json:\"Unit,omitempty\" firestore:\"Unit\"`\n    CurrentStatus                 string                         `json:\"CurrentStatus,omitempty\" firestore:\"CurrentStatus\"`\n    Country                       string                         `json:\"Country,omitempty\" firestore:\"Country\"`\n    ExperienceType                string                         `json:\"ExperienceType,omitempty\" firestore:\"ExperienceType\"`\n    DateJoined                    time.Time                      `json:\"DateJoined,omitempty\" firestore:\"DateJoined\"`\n    Abilities                     []Ability                      `json:\"Abilities,omitempty\" firestore:\"Abilities\"`\n    Goals                         Goals                          `json:\"Goals,omitempty\" firestore:\"Goals\"`\n    Roles                         []Role                         `json:\"Roles,omitempty\" firestore:\"Roles\"`\n    TermsAndConditionsAcceptances []TermsAndConditionsAcceptance `json:\"TermsAndConditionsAcceptances,omitempty\" firestore:\"TermsAndConditionsAcceptances\"`\n    TimeZone                      string                         `json:\"TimeZone,omitempty\" firestore:\"TimeZone\"`\n    BaselineTests                 []BaselineTestResults          `json:\"BaselineTests,omitempty\" firestore:\"BaselineTests\"`\n    UpdatedDate                   time.Time                      `json:\"UpdatedDate,omitempty\" firestore:\"UpdatedDate\"`\n    FirstName                     *string                        `json:\"FirstName,omitempty\" firestore:\"FirstName\"`\n    LastName                      string                         `json:\"LastName,omitempty\" firestore:\"LastName\"`\n    DisplayName                   string                         `json:\"DisplayName,omitempty\" firestore:\"DisplayName\"`\n    State                         string                         `json:\"State\"`\n    Preferences                   map[string]interface{}         `json:\"Preferences\"`\n    Thresholds                    Thresholds                     `json:\"Thresholds\"`\n    StripeCustomerID              string                         `json:\"-\"` //Tells it to ignore exporting\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "is_accepted": false, "score": 3, "last_activity_date": 1557289246, "creation_date": 1557289246, "answer_id": 56033495, "question_id": 56033464, "link": "https://stackoverflow.com/questions/56033464/what-is-the-meaning-of-go-syntax-struct/56033495#56033495", "title": "what is the meaning of go syntax struct {}{}", "body": "<p>The first braces mean you have declared a struct with empty field. and the Second braces is meaning you are going to new one instance of your struct, which you have declared before.</p>\n"}], "owner": {"reputation": 9, "user_id": 11464927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8dd7c68448426bbcb8dc64bafadd81c?s=128&d=identicon&r=PG&f=1", "display_name": "Mayank", "link": "https://stackoverflow.com/users/11464927/mayank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1557290224, "answer_count": 1, "score": -2, "last_activity_date": 1557293344, "creation_date": 1557289027, "last_edit_date": 1557293344, "question_id": 56033464, "link": "https://stackoverflow.com/questions/56033464/what-is-the-meaning-of-go-syntax-struct", "closed_reason": "Duplicate", "title": "what is the meaning of go syntax struct {}{}", "body": "<p>what is the meaning of following statement in Go?</p>\n\n<p><strong>struct {}{}</strong></p>\n\n<p>First curly braces probably mean interface or initialisation with blank. What does second curly braces do.</p>\n"}, {"tags": ["go", "testing"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "edited": false, "score": 0, "creation_date": 1580193906, "post_id": 56033283, "comment_id": 106007106, "body": "<code>assert.Equal(t, expectedURL, resp.Location)</code> this also works as well using http request"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1557287572, "creation_date": 1557287572, "answer_id": 56033283, "question_id": 56033042, "link": "https://stackoverflow.com/questions/56033042/how-to-test-http-redirect-target-url-in-golang/56033283#56033283", "title": "How to test http.Redirect target URL in golang", "body": "<p>Assert that the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Location\" rel=\"noreferrer\">Location</a> header is as expected:</p>\n\n<pre><code>assert.Equal(t, expectedURL, resp.HeaderMap.Get(\"Location\"))\n</code></pre>\n"}], "owner": {"reputation": 84, "user_id": 5932379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a3d207ad099be68088bbf6d818677a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Wang", "link": "https://stackoverflow.com/users/5932379/chris-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 0, "accepted_answer_id": 56033283, "answer_count": 1, "score": 1, "last_activity_date": 1557287572, "creation_date": 1557285472, "question_id": 56033042, "link": "https://stackoverflow.com/questions/56033042/how-to-test-http-redirect-target-url-in-golang", "title": "How to test http.Redirect target URL in golang", "body": "<p>I have set up a http redirect in the go handler, and I'm trying to verify if the target URL is composed as expected.\nI'm currently using httptest for relevant unit test.</p>\n\n<p>In the handler:</p>\n\n<pre><code>url := fmt.Sprintf(\"%s%s?token=%s\", domain, someURL, token)\nhttp.Redirect(w, r, url, 302)\n</code></pre>\n\n<p>The current unit test can only verify the respond code but not the target URL:</p>\n\n<pre><code>resp := httptest.NewRecorder()\nrouter.ServeHTTP(resp, req)\nassert.Equal(t, 302, resp.Code)\n</code></pre>\n\n<p>I'm expecting something like</p>\n\n<pre><code>assert.Equal(t, expectedURL, resp.redirectURL)\n</code></pre>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557318701, "post_id": 56032544, "comment_id": 98723597, "body": "Have you tried using <code>go mod why</code>? Although if you can&#39;t parse <code>go.mod</code>, I&#39;m not sure what you can do other than remove the offending module path. (also make sure you&#39;re using the latest go release to generate <code>go.mod</code>, and run <code>go mod tidy</code>)"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1557319267, "post_id": 56032544, "comment_id": 98723948, "body": "Cross-posted: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/mJcpYYim3-w\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/mJcpYYim3-w</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1557322516, "post_id": 56032544, "comment_id": 98726058, "body": "&quot;How do I find out the source of this old Sirupsen module?&quot; - it&#39;s not old, it&#39;s still actively maintained, and the source is exactly where the import path indicates: github.com/sirupsen/logrus"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557340848, "post_id": 56032544, "comment_id": 98735870, "body": "Yes, 1.4.1 was <i>long</i> after the rename, there should be no reason to have the <code>Sirupsen</code> path in your code."}], "answers": [{"tags": [], "owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "is_accepted": false, "score": 9, "last_activity_date": 1564772971, "last_edit_date": 1564772971, "creation_date": 1564764304, "answer_id": 57330598, "question_id": 56032544, "link": "https://stackoverflow.com/questions/56032544/how-to-find-dependency-causing-sirupsen-logrus-vs-sirupsen-logrus-unexpecte/57330598#57330598", "title": "How to find dependency causing &quot;Sirupsen/logrus&quot; vs. &quot;sirupsen/logrus&quot; unexpected module path error?", "body": "<blockquote>\n  <p>How do I find out the source of this old Sirupsen module?</p>\n</blockquote>\n\n<p>Use the Go 1.13 beta (<code>go get golang.org/dl/go1.13beta1 &amp;&amp; go1.13beta1 download</code>) or even better, try the latest Go on tip / master (<code>go get golang.org/dl/gotip &amp;&amp; gotip download</code>).</p>\n\n<p>Go 1.13 has improved error messages in general. It should help in your case, including most likely showing the import chain leading up to the error.</p>\n\n<p>For example:</p>\n\n<pre><code>$ gotip build .\ngo: example.com/temp/mod imports\n        github.com/docker/libcompose/docker imports\n        github.com/Sirupsen/logrus: github.com/Sirupsen/logrus@v1.4.2: parsing go.mod:\n        module declares its path as: github.com/Sirupsen/logrus\n                but was required as: github.com/sirupsen/logrus\n</code></pre>\n\n<p>In that example, you can see that <code>docker/libcompose/docker</code> is importing the old and now incorrect uppercase version of <code>Sirupsen/logrus</code>.</p>\n\n<p>The most common reason people see a <code>Sirupsen/logrus</code> vs. <code>sirupsen/logrus</code> case mismatch is when importing <code>github.com/docker/docker</code> or one of the other docker repos. Importing docker repos is a bit confusing with modules, including because:</p>\n\n<ul>\n<li>The <code>docker/docker</code> repo does not follow semver.</li>\n<li>There is a very old <code>v1.13.1</code> semver tag on the <code>docker/docker</code> repo. \n\n<ul>\n<li>Even though it is a couple years old, it is still the \"latest\" semver tag on that repo, and hence that old version is picked by default by the <code>go</code> command if you don't ask for a more specific version. </li>\n<li>That old <code>docker/docker</code> version imports the old and not incorrect uppercase <code>Sirupsen/logrus</code>, which can then trigger the error reported in the question above.</li>\n</ul></li>\n<li>The docker client package has had breaking changes after v1.13.1.</li>\n<li>There is generally confusion about <code>docker/docker</code> vs. <code>docker/engine</code> repositories, and about what import paths to use.</li>\n<li>The docker repos do not have <code>go.mod</code> files.</li>\n</ul>\n\n<p>For the <code>docker/docker</code> repo, the import path remains <code>github.com/docker/docker</code>, but it needs to come from <code>github.com/docker/engine</code>, so the recommended approach is often for a docker importer to do <code>import \"github.com/docker/docker\"</code> and edit their <code>go.mod</code> to something like this:</p>\n\n<pre><code>require (\n    github.com/docker/docker v1.13.1\n)\n\nreplace github.com/docker/docker =&gt; github.com/docker/engine &lt;tag-or-commit-hash&gt;\n</code></pre>\n\n<p>Docker issue <a href=\"https://github.com/moby/moby/issues/39302\" rel=\"noreferrer\">#39302</a> tracks trying to document how to import docker repos when using modules.</p>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3120, "favorite_count": 6, "answer_count": 1, "score": 6, "last_activity_date": 1564772971, "creation_date": 1557280766, "last_edit_date": 1564772778, "question_id": 56032544, "link": "https://stackoverflow.com/questions/56032544/how-to-find-dependency-causing-sirupsen-logrus-vs-sirupsen-logrus-unexpecte", "title": "How to find dependency causing &quot;Sirupsen/logrus&quot; vs. &quot;sirupsen/logrus&quot; unexpected module path error?", "body": "<p>I am trying to convert <a href=\"https://github.com/appscode/voyager\" rel=\"noreferrer\">https://github.com/appscode/voyager</a> from glide to go mod.</p>\n\n<p>I am getting an error like below:</p>\n\n<pre><code>go: github.com/Sirupsen/logrus@v1.4.1: parsing go.mod: unexpected module path \"github.com/sirupsen/logrus\"\ngo: error loading module requirements\n</code></pre>\n\n<p>How do I find out the source of this old Sirupsen module?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6683327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f609bab99e2126d841a63a6f71a3a?s=128&d=identicon&r=PG&f=1", "display_name": "nguyennd", "link": "https://stackoverflow.com/users/6683327/nguyennd"}, "edited": false, "score": 0, "creation_date": 1557282190, "post_id": 56032604, "comment_id": 98708425, "body": "Thank you, Mr Opnauticus. I want to ask one more question.  My result will be a JSON like that:           {&quot;name&quot;:&quot;xyz_example&quot;}  How can I parse this string and get just &quot;xyz_example&quot; Thank you"}, {"owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "reply_to_user": {"reputation": 55, "user_id": 6683327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f609bab99e2126d841a63a6f71a3a?s=128&d=identicon&r=PG&f=1", "display_name": "nguyennd", "link": "https://stackoverflow.com/users/6683327/nguyennd"}, "edited": false, "score": 0, "creation_date": 1557282400, "post_id": 56032604, "comment_id": 98708459, "body": "That depends what the server you are querying is serving up. What you just posted (<code>{&quot;name&quot;:&quot;xyz_example&quot;}</code>) is JSON - whereas your original question was about a server that returns a string. Either way, something very much like this example is how you would get that response, but if you&#39;re expecting JSON, you would probably want to parse the <code>responseBytes</code> with the &quot;encoding/json&quot; package rather than just casting to a string."}, {"owner": {"reputation": 55, "user_id": 6683327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f609bab99e2126d841a63a6f71a3a?s=128&d=identicon&r=PG&f=1", "display_name": "nguyennd", "link": "https://stackoverflow.com/users/6683327/nguyennd"}, "edited": false, "score": 0, "creation_date": 1557283419, "post_id": 56032604, "comment_id": 98708680, "body": "Thank you so much for your keyword. I can do it now :D"}], "tags": [], "owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "is_accepted": true, "score": 1, "last_activity_date": 1557281326, "creation_date": 1557281326, "answer_id": 56032604, "question_id": 56032492, "link": "https://stackoverflow.com/questions/56032492/get-output-string-after-access-a-link/56032604#56032604", "title": "get output string after access a link", "body": "<p>Here's an example of reading the response from an HTTP request.\nI would recommend reading up on the <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">documentation</a> for the http package, and maybe a simple tutorial like <a href=\"https://medium.com/@masnun/making-http-requests-in-golang-dd123379efe7\" rel=\"nofollow noreferrer\">this one</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n    //make a request\n    response, err := http.Get(\"https://mdtf.org\")\n    if err != nil {\n      fmt.Println(\"error making request: \", err)\n      return\n    }\n\n    //make sure the response body gets closed\n    defer response.Body.Close()\n\n    //read the bytes\n    responseBytes, err := ioutil.ReadAll(response.Body)\n    if err != nil {\n      fmt.Println(\"error reading response bytes: \", err)\n      return\n    }\n\n    //turn the response bytes into a string\n    responseString := string(responseBytes)\n\n    //print it or something\n    fmt.Println(responseString)\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6683327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f609bab99e2126d841a63a6f71a3a?s=128&d=identicon&r=PG&f=1", "display_name": "nguyennd", "link": "https://stackoverflow.com/users/6683327/nguyennd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56032604, "answer_count": 1, "score": 2, "last_activity_date": 1557282355, "creation_date": 1557280288, "last_edit_date": 1557282355, "question_id": 56032492, "link": "https://stackoverflow.com/questions/56032492/get-output-string-after-access-a-link", "title": "get output string after access a link", "body": "<p>I am writing a program by Go.\nIn this program, I access to a website and in this website, it will print a string. I want to get this string for next process.\nFor example: </p>\n\n<p>I access by curl and the returned string will like that: </p>\n\n<pre><code>curl localhost:4000\nabc_example\n</code></pre>\n\n<p>I need to get \"abc_example\" for next process in my program.\nNow, this problem was solved.</p>\n\n<p>Actually, my result will be a JSON like that:</p>\n\n<pre><code>{\"name\":\"xyz_example\"}\n</code></pre>\n\n<p>How can I parse this string and just get \"xyz_example\"</p>\n\n<p>I am a newbie in Go. May you help me.\nThank you!</p>\n"}, {"tags": ["javascript", "go", "xmlhttprequest"], "answers": [{"comments": [{"owner": {"reputation": 1240, "user_id": 1788496, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7efebd4721a49a49058e243f01d1dd9a?s=128&d=identicon&r=PG", "display_name": "mgrenier", "link": "https://stackoverflow.com/users/1788496/mgrenier"}, "edited": false, "score": 0, "creation_date": 1557281321, "post_id": 56032515, "comment_id": 98708265, "body": "if I did &quot;r.URL.Query()&quot; wouldn&#39;t that then apply to all my routers instead of just the particular one I want to handle the parameters of? Could you provide a code example? I am a little confused."}, {"owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "reply_to_user": {"reputation": 1240, "user_id": 1788496, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7efebd4721a49a49058e243f01d1dd9a?s=128&d=identicon&r=PG", "display_name": "mgrenier", "link": "https://stackoverflow.com/users/1788496/mgrenier"}, "edited": false, "score": 0, "creation_date": 1557281398, "post_id": 56032515, "comment_id": 98708275, "body": "I&#39;m suggesting you make that call inside your handler function for the particular route you&#39;re handling in order to read the query parameters from the request pointer in the handler function."}, {"owner": {"reputation": 1240, "user_id": 1788496, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7efebd4721a49a49058e243f01d1dd9a?s=128&d=identicon&r=PG", "display_name": "mgrenier", "link": "https://stackoverflow.com/users/1788496/mgrenier"}, "edited": false, "score": 0, "creation_date": 1557281925, "post_id": 56032515, "comment_id": 98708369, "body": "ahhh sorry totally misunderstood what you were saying thanks!"}, {"owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "reply_to_user": {"reputation": 1240, "user_id": 1788496, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7efebd4721a49a49058e243f01d1dd9a?s=128&d=identicon&r=PG", "display_name": "mgrenier", "link": "https://stackoverflow.com/users/1788496/mgrenier"}, "edited": false, "score": 0, "creation_date": 1557282120, "post_id": 56032515, "comment_id": 98708404, "body": "No problem! Examples always help :)"}], "tags": [], "owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "is_accepted": true, "score": 2, "last_activity_date": 1557281722, "last_edit_date": 1557281722, "creation_date": 1557280490, "answer_id": 56032515, "question_id": 56032378, "link": "https://stackoverflow.com/questions/56032378/adding-parameters-to-xmlhttprequests-causes-405-error/56032515#56032515", "title": "Adding parameters to XMLHttpRequests causes 405 Error", "body": "<p>Your parameters in the open command are defined as URL query parameters (everything after the <code>?</code>).<br>\nBut you added them as URL path parameters in the call to <code>r.HandleFunc</code>.  </p>\n\n<p>Try handling the base path of <code>/mytemplate</code> with <code>r.HandleFunc</code> and then parsing the query parameters in your <code>MyHandler</code> function with <code>r.URL.Query()</code>. That should return a map of the query parameters, which you should be able to reference by key (<code>param1</code>, <code>param2</code>...).</p>\n\n<p>Stubbed out example below:</p>\n\n<pre><code>func myHandler(w http.ResponseWriter, r *http.Request) {\n    //get the query vals\n    values := r.URL.Query()\n\n    //parse specific params\n    param1 := values[\"param1\"]\n\n    //do other stuff\n}\n\nfunc main() {\n    //define the handler\n    http.HandleFunc(\"/myHandlerPath\", myHandler)\n\n    // do some other stuff?\n    // ...\n\n    // serve up the endpoint\n    log.Fatal(http.ListenAndServe(\":8081\", nil))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": false, "score": 2, "last_activity_date": 1557280620, "last_edit_date": 1557280620, "creation_date": 1557280497, "answer_id": 56032517, "question_id": 56032378, "link": "https://stackoverflow.com/questions/56032378/adding-parameters-to-xmlhttprequests-causes-405-error/56032517#56032517", "title": "Adding parameters to XMLHttpRequests causes 405 Error", "body": "<p>You're handling a route that looks like this:</p>\n\n<pre><code>/mytemplate/some/variables/here\n</code></pre>\n\n<p>But you're sending the request to <code>/mytemplate</code> with query parameters, like this:</p>\n\n<pre><code>/mytemplate?param1=some&amp;param2=variables&amp;param3=here\n</code></pre>\n\n<p>Gorilla Mux won't match on these.  If you want to match query parameters, and not URL parameters, see the <code>.Queries</code> method in the Gorilla Mux <a href=\"https://godoc.org/github.com/gorilla/mux#Route.Queries\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n"}], "owner": {"reputation": 1240, "user_id": 1788496, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7efebd4721a49a49058e243f01d1dd9a?s=128&d=identicon&r=PG", "display_name": "mgrenier", "link": "https://stackoverflow.com/users/1788496/mgrenier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 56032515, "answer_count": 2, "score": 1, "last_activity_date": 1557281722, "creation_date": 1557279181, "last_edit_date": 1557280594, "question_id": 56032378, "link": "https://stackoverflow.com/questions/56032378/adding-parameters-to-xmlhttprequests-causes-405-error", "title": "Adding parameters to XMLHttpRequests causes 405 Error", "body": "<p>I can successfully send an XMLHttpRequest without parameters using this code:</p>\n\n<p>template file:</p>\n\n<pre><code>xhr.open('POST', '/mytemplate');\nxhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\nxhr.onload = function() {\n   if (xhr.status == 200) {\n      alert('success');\n   }\n   else {\n      alert('failed:' + xhr.status);\n   }\n}\nxhr.send();\n</code></pre>\n\n<p>router:</p>\n\n<pre><code>r.HandleFunc(\"/mytemplate\", MyHandler).Methods(\"POST\")\n</code></pre>\n\n<p>But as soon as I try to add parameters I get a 405 error. I only change 2 lines, not sure what I am doing wrong:</p>\n\n<p>template file:</p>\n\n<pre><code>xhr.open('POST', '/mytemplate?param1='+var1+'&amp;param2='+var2+'&amp;param3='+var3);\n</code></pre>\n\n<p>router:</p>\n\n<pre><code>r.HandleFunc(\"/mytemplate/{param1}/{param2}/{param2}\", MyHandler).Methods(\"POST\")\n</code></pre>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "edited": false, "score": 0, "creation_date": 1557276677, "post_id": 56031597, "comment_id": 98707503, "body": "Thanks! I simplified the scenario in order to ask the question, but I&#39;m really trying to limit the number of requests I send downstream to another server. I know it probably wouldn&#39;t make sense to queue requests if I was immediately sending back upstream. It&#39;s surprising to me there&#39;s not way to avoid this."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1557293603, "post_id": 56031597, "comment_id": 98710960, "body": "Just limit the number of requests sent to that server, then. Don&#39;t use async. Just have any pending goroutines wait until the service is available. Go already handles that for you. Async is invented for languages that don&#39;t have that flexibility."}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "reply_to_user": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "edited": false, "score": 1, "creation_date": 1557318026, "post_id": 56031597, "comment_id": 98723196, "body": "@nickackerman42: the blog post I linked to near the bottom has a code sample for limiting the concurrency downstream"}, {"owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "edited": false, "score": 0, "creation_date": 1557331322, "post_id": 56031597, "comment_id": 98731409, "body": "I understand returning the response in the handler by passing it a &quot;go ahead&quot; message to a channel is a possibility. However, because the handler is already responsible for placing the request on a queue, I was trying to let another function be responsible for writing back the actual response. Y&#39;all may say that&#39;s not &quot;idiomatic,&quot; and I value that opinion, but my question was whether this is possible. It sounds like it&#39;s not."}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "reply_to_user": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "edited": false, "score": 0, "creation_date": 1557332221, "post_id": 56031597, "comment_id": 98731788, "body": "@nickackerman42: yes, it&#39;s possible. your handler can call a function with the response writer, or send it on a channel, but it <i>has to wait</i> for the function to finish its job, it can&#39;t just return and leave the function to run and write the result later"}, {"owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "edited": false, "score": 0, "creation_date": 1557332519, "post_id": 56031597, "comment_id": 98731918, "body": "Mhm -- makes sense. I&#39;m blocking on a &quot;done&quot; channel until the request is served. Thanks for the help."}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 1, "last_activity_date": 1557293562, "last_edit_date": 1557293562, "creation_date": 1557271169, "answer_id": 56031597, "question_id": 56031519, "link": "https://stackoverflow.com/questions/56031519/how-to-write-http-response-outside-of-http-listenandserve-handler/56031597#56031597", "title": "How to write http response outside of http.ListenAndServe handler?", "body": "<p>Once the handler returns, the server sends a reply/status. You'll need something like:</p>\n\n<pre><code>func putRequestOnQueue(w http.ResponseWriter, r *http.Request){\n    RequestQueue.Put(responseWriter)\n    waitForResponse()\n}\n</code></pre>\n\n<p>In other words, <code>putRequestOnQueue</code> shouldn't return until the response is ready. You can use a channel, for example, or whatever else to do this waiting.</p>\n\n<hr>\n\n<p>Note, however, that this isn't very idiomatic Go. In Go we don't do as much async patterns as in other languages, because goroutines are cheap. Each HTTP handler <a href=\"https://eli.thegreenplace.net/2019/on-concurrency-in-go-http-servers/\" rel=\"nofollow noreferrer\">is already called in a separate goroutine</a>, so you might as well use your handler to <em>do the work</em> rather than <em>dispatch the work to be done elsewhere</em>.</p>\n"}], "owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 56031597, "answer_count": 1, "score": -2, "last_activity_date": 1557293562, "creation_date": 1557270346, "question_id": 56031519, "link": "https://stackoverflow.com/questions/56031519/how-to-write-http-response-outside-of-http-listenandserve-handler", "title": "How to write http response outside of http.ListenAndServe handler?", "body": "<p>I'm setting up a HTTP server in Go, telling the server to handle all requests with the putRequestOnQueue function:</p>\n\n<pre><code>http.ListenAndServe(\":6776\", *handler)\nhttp.HandleFunc(\"/\", putRequestOnQueue)\n</code></pre>\n\n<p>The job of putRequestOnQueue is to put the response writer on a queue, to be pulled off and used to return a response at some future time.</p>\n\n<pre><code>func putRequestOnQueue(w http.ResponseWriter, r *http.Request){\n    RequestQueue.Put(responseWriter)\n}\n</code></pre>\n\n<p>However, it appears that once the ResponseWriter goes out of scope, the server returns a 200. I'd imagine it does this because it figures \"oh, the function you told me was gonna handle this request just lost the writer, so I'm just gonna spit back a 200.\"</p>\n\n<p>But I don't want this behavior. I want to be able to write back when I choose, from another function. Is there a way I can write back a response from another function without the server prematurely returning a 200?</p>\n"}, {"tags": ["dictionary", "go", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1557266325, "creation_date": 1557266325, "answer_id": 56030983, "question_id": 56030848, "link": "https://stackoverflow.com/questions/56030848/syntactic-meaning-of-the-space-between-the-map-key-type-and-the-value-type/56030983#56030983", "title": "Syntactic meaning of the space between the map key type and the value type", "body": "<p>It doesn't mean anything. It doesn't matter if you leave space(s) there or not, the code is the same. Always use <code>gofmt</code> to avoid dis-ambiguity.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Tokens\" rel=\"noreferrer\">Spec: Tokens:</a></p>\n\n<blockquote>\n  <p>Tokens form the vocabulary of the Go language. There are four classes: <em>identifiers</em>, <em>keywords</em>, <em>operators and punctuation</em>, and <em>literals</em>. <strong><em>White space</em>, formed from spaces (U+0020), horizontal tabs (U+0009), carriage returns (U+000D), and newlines (U+000A), is ignored except as it separates tokens that would otherwise combine into a single token.</strong> Also, a newline or end of file may trigger the insertion of a semicolon. While breaking the input into tokens, the next token is the longest sequence of characters that form a valid token.</p>\n</blockquote>\n\n<p>The map type: <code>map[string]interface{}</code> is made up of tokens, and a <em>white space</em> at the position in question: <code>map[string] interface{}</code> is simply ignored because the tokens it separates (<code>]</code> and <code>interface</code> would not combine into a single token if the space wouldn't be there.</p>\n"}], "owner": {"reputation": 69, "user_id": 3685346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04d62b49eb8bc4327bffa2a2b7b90396?s=128&d=identicon&r=PG&f=1", "display_name": "TGuedes", "link": "https://stackoverflow.com/users/3685346/tguedes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56030983, "answer_count": 1, "score": -2, "last_activity_date": 1557308057, "creation_date": 1557265397, "last_edit_date": 1557308057, "question_id": 56030848, "link": "https://stackoverflow.com/questions/56030848/syntactic-meaning-of-the-space-between-the-map-key-type-and-the-value-type", "title": "Syntactic meaning of the space between the map key type and the value type", "body": "<p>An online example of Go I am following has the following syntax for a map type as a parameter in a function: </p>\n\n<p><code>func (contact *Contact) Validate() (map[string] interface{}, bool) {</code></p>\n\n<p>What does the space between map[string] and interface mean? I can't find any other examples defining a map with a space there.</p>\n"}, {"tags": ["reactjs", "go", "redirect", "server", "proxy"], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "edited": false, "score": 0, "creation_date": 1557277419, "post_id": 56030733, "comment_id": 98707630, "body": "Thanks so much for answering. So when I tried to send data back and <i>then</i> also send back the redirect, I got an error about overriding the headers.  How would you recommend redirecting from the server only?  UPDATE So I got the correct redirected url to come in through the Network tab on &quot;inspect&quot; within chrome.  But the frontend page isn&#39;t actually changing (the URL stays the same at the home page).  Do you know why that is?"}, {"owner": {"reputation": 537, "user_id": 11370939, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xfbPig8G68U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recO4YpXT2Xh9cIEfRrbxg246rfOw/mo/photo.jpg?sz=128", "display_name": "German", "link": "https://stackoverflow.com/users/11370939/german"}, "reply_to_user": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "edited": false, "score": 0, "creation_date": 1557279286, "post_id": 56030733, "comment_id": 98707917, "body": "No problem , glad I help! ;) So this is happening because your front end is in a different domain than your server, so the client can&#39;t redirect to the server, usually, you would talk to the front end with json from the server. To redirect to the server you have to have your front end rendered from the server. But I can help you with that, is kind hard to explain here, could you add your code in an online editor, that would be easier to explain, thank you ;)"}, {"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "edited": false, "score": 0, "creation_date": 1557280330, "post_id": 56030733, "comment_id": 98708081, "body": "Here&#39;s the link. Thanks again! <a href=\"https://codeshare.io/5eojOx\" rel=\"nofollow noreferrer\">codeshare.io/5eojOx</a>   So just in case it&#39;s not clear.  I have a search bar component.  Once a user submits their query, handleSubmit sends a post request back to the server, which hits the pingFuncPost endpoint and should redirect the user to the localhost:3000/results page but the page stays at the home page and doesn&#39;t move."}, {"owner": {"reputation": 537, "user_id": 11370939, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xfbPig8G68U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recO4YpXT2Xh9cIEfRrbxg246rfOw/mo/photo.jpg?sz=128", "display_name": "German", "link": "https://stackoverflow.com/users/11370939/german"}, "reply_to_user": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "edited": false, "score": 0, "creation_date": 1557282801, "post_id": 56030733, "comment_id": 98708543, "body": "Are you familiar with single page applications and dynamic websites?"}, {"owner": {"reputation": 537, "user_id": 11370939, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xfbPig8G68U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recO4YpXT2Xh9cIEfRrbxg246rfOw/mo/photo.jpg?sz=128", "display_name": "German", "link": "https://stackoverflow.com/users/11370939/german"}, "reply_to_user": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "edited": false, "score": 0, "creation_date": 1557282872, "post_id": 56030733, "comment_id": 98708565, "body": "I can explain here, <a href=\"https://join.slack.com/t/tutoring-s6w8396/shared_invite/enQtNjIzNjIxOTg3Nzc2LWU4M2I0ODA3NDVjNmMyNWRkNzA3MDQwM2MwOWU5YWJjN2M4YWRkNDBjZTE1ZWI0ZWRjZTY2NzBiZjY1Yzg0MmU\" rel=\"nofollow noreferrer\">join.slack.com/t/tutoring-s6w8396/shared_invite/&hellip;</a> add the slack channel."}, {"owner": {"reputation": 537, "user_id": 11370939, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xfbPig8G68U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recO4YpXT2Xh9cIEfRrbxg246rfOw/mo/photo.jpg?sz=128", "display_name": "German", "link": "https://stackoverflow.com/users/11370939/german"}, "reply_to_user": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "edited": false, "score": 0, "creation_date": 1557284001, "post_id": 56030733, "comment_id": 98708778, "body": "I edited the post with how you would redirect to another component ;) let me know if it helps!"}], "tags": [], "owner": {"reputation": 537, "user_id": 11370939, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xfbPig8G68U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recO4YpXT2Xh9cIEfRrbxg246rfOw/mo/photo.jpg?sz=128", "display_name": "German", "link": "https://stackoverflow.com/users/11370939/german"}, "is_accepted": false, "score": 1, "last_activity_date": 1557283969, "last_edit_date": 1557283969, "creation_date": 1557264733, "answer_id": 56030733, "question_id": 56030553, "link": "https://stackoverflow.com/questions/56030553/server-redirect-does-not-work-with-reactjs-proxy-server/56030733#56030733", "title": "Server redirect does not work with ReactJS proxy server", "body": "<p>You redirect, with </p>\n\n<pre><code>        const data = {\"query\": this.state.query};\n        fetch(`/path/ping`, {  // should hit the end point of pingFuncPost in golang server, which should redirect to localhost:3000/results\n            method: 'POST',\n            body: JSON.stringify(data),\n        })\n.then(res =&gt; res.json())\n.then(res =&gt; {\n&lt;Redirect to=\"/somewhere/else\" /&gt;\n})\n\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557307590, "creation_date": 1557263614, "last_edit_date": 1557307590, "question_id": 56030553, "link": "https://stackoverflow.com/questions/56030553/server-redirect-does-not-work-with-reactjs-proxy-server", "title": "Server redirect does not work with ReactJS proxy server", "body": "<p>I'm using a proxy server on my react front end and a Go server for my back end.  When I DON'T use react or a proxy server, the redirect works fine.  But when I use react, with its development server and a proxy to my Go back end, the redirect doesn't do anything.</p>\n\n<pre><code>// React package.json file \n\"proxy\": \"http://localhost:5000\", // proxy to golang hosted on 5000\n    \"scripts\": {\n    \"start\": \"react-scripts start\",\n},\n\n-----------------------\n\n// golang server\n\nfunc main() {\n    router := gin.Default()\n    router.Use(static.Serve(\"/\", static.LocalFile(\"../client/public\", true)))\n    ping := router.Group(\"/path\") \n    ping.GET(\"/ping\", pingFunc)\n    ping.POST(\"/ping\", pingFuncPost)\n    router.Run(\":5000\")\n}\n\n// This redirect is not working.\n// In the terminal it shows that a redirect is made but on the frontend\n// nothing occurs\n\nfunc pingFuncPost( c *gin.Context) \n{\n    http.Redirect(c.Writer, c.Request, \"/page\", http.StatusSeeOther)`\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes", "scheduler"], "comments": [{"owner": {"reputation": 12216, "user_id": 8803619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QegS5.jpg?s=128&g=1", "display_name": "Suresh Vishnoi", "link": "https://stackoverflow.com/users/8803619/suresh-vishnoi"}, "edited": false, "score": 0, "creation_date": 1557262903, "post_id": 56030098, "comment_id": 98704391, "body": "Hi your  flag is also different <code>--address=1.1.1.1</code> <code>--address=0.0.0.0</code> means all of the interface"}, {"owner": {"reputation": 11, "user_id": 9581349, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brenda Wang", "link": "https://stackoverflow.com/users/9581349/brenda-wang"}, "reply_to_user": {"reputation": 12216, "user_id": 8803619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QegS5.jpg?s=128&g=1", "display_name": "Suresh Vishnoi", "link": "https://stackoverflow.com/users/8803619/suresh-vishnoi"}, "edited": false, "score": 0, "creation_date": 1557266322, "post_id": 56030098, "comment_id": 98705465, "body": "@SureshVishnoi Thanks for pointing this out! Cause initially I thought the port conflict might be an issue, so I changed that to try it out. With the right address <code>1.1.1.1</code> it still fails :("}, {"owner": {"reputation": 11, "user_id": 9581349, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brenda Wang", "link": "https://stackoverflow.com/users/9581349/brenda-wang"}, "reply_to_user": {"reputation": 12216, "user_id": 8803619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QegS5.jpg?s=128&g=1", "display_name": "Suresh Vishnoi", "link": "https://stackoverflow.com/users/8803619/suresh-vishnoi"}, "edited": false, "score": 0, "creation_date": 1557267050, "post_id": 56030098, "comment_id": 98705640, "body": "I mean <code>0.0.0.0</code>"}, {"owner": {"reputation": 5656, "user_id": 11374921, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-74ExUmq_FAw/AAAAAAAAAAI/AAAAAAAARVQ/qmxKhxFOHDs/photo.jpg?sz=128", "display_name": "Vasili Angapov", "link": "https://stackoverflow.com/users/11374921/vasili-angapov"}, "edited": false, "score": 1, "creation_date": 1557289172, "post_id": 56030098, "comment_id": 98709790, "body": "The error &quot;standard_init_linux.go:207: exec user process caused &quot;exec format error&quot; may point to OS architecture mismatch. If you&#39;ve compiled binary on x64 platform - then it must run on x64 platform and so on. If you compiled it on x86 or ARM and try to run on x64 - you&#39;ll see this error. Is this your case?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9581349, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brenda Wang", "link": "https://stackoverflow.com/users/9581349/brenda-wang"}, "edited": false, "score": 1, "creation_date": 1557377885, "post_id": 56033638, "comment_id": 98745744, "body": "Thanks! I checked the logs after executing <code>make</code>, I think you are right. And also I&#39;m using minikube, and it runs on darwin (amd64)."}], "tags": [], "owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "is_accepted": false, "score": 1, "last_activity_date": 1557290324, "creation_date": 1557290324, "answer_id": 56033638, "question_id": 56030098, "link": "https://stackoverflow.com/questions/56030098/errors-occur-when-following-configure-multiple-schedulers-kubernetes-guide/56033638#56033638", "title": "Errors occur when following &quot;Configure Multiple Schedulers&quot; Kubernetes guide", "body": "<p>This totally looks like that you are using the <code>darwin</code> <code>kube-scheduler</code> go binary to run in a <a href=\"https://hub.docker.com/_/busybox\" rel=\"nofollow noreferrer\">Linux container</a>. </p>\n\n<p>You probably ran this on your mac:</p>\n\n<pre><code>git clone https://github.com/kubernetes/kubernetes.git\ncd kubernetes\nmake\n</code></pre>\n\n<p>Which created the <code>darwin</code> binaries and not the Linux binaries. I would try to run that from a Linux box. Or change the make target to use <a href=\"https://gist.github.com/asukakenji/f15ba7e588ac42795f421b48b8aede63\" rel=\"nofollow noreferrer\"><code>GOOS=linux</code> and <code>GOARCH=amd64</code></a>.</p>\n\n<p>Note that K8s mainly supports Linux and only Windows nodes as of this writing.</p>\n"}], "owner": {"reputation": 11, "user_id": 9581349, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brenda Wang", "link": "https://stackoverflow.com/users/9581349/brenda-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559014266, "creation_date": 1557261125, "last_edit_date": 1559014266, "question_id": 56030098, "link": "https://stackoverflow.com/questions/56030098/errors-occur-when-following-configure-multiple-schedulers-kubernetes-guide", "title": "Errors occur when following &quot;Configure Multiple Schedulers&quot; Kubernetes guide", "body": "<p>When I trying to follow the <a href=\"https://kubernetes.io/docs/tasks/administer-cluster/configure-multiple-schedulers/\" rel=\"nofollow noreferrer\">Kubernetes Configure Multiple Schedulers guide</a>, I cannot successfully get the my-scheduler pod running.</p>\n\n<p>I succeed to build the image and push it to a registry, and the image shows in my docker and Google Could Platform.\nBut when I apply the deployment file to set the pods, the status is <code>CrashLoopBackOff</code>.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>my-scheduler-64576b7897-8b549            0/1     CrashLoopBackOff   14         84m\n</code></pre>\n\n<p>Here is the output for <code>kuberctl describe pod my-scheduler-64576b7897-8b549 -n kube-system</code>:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>Name:               my-scheduler-64576b7897-8b549\nNamespace:          kube-system\nPriority:           0\nPriorityClassName:  &lt;none&gt;\nNode:               minikube/10.0.2.15\nStart Time:         Tue, 07 May 2019 15:06:59 -0500\nLabels:             component=scheduler\n                    pod-template-hash=64576b7897\n                    tier=control-plane\n                    version=second\nAnnotations:        &lt;none&gt;\nStatus:             Running\nIP:                 172.17.0.15\nControlled By:      ReplicaSet/my-scheduler-64576b7897\nContainers:\n  kube-second-scheduler:\n    Container ID:  docker://a0cadf03dd5ffd11cbb6f1f8e669fc04cd6aa00aa6f361550f06f32785a4d63c\n    Image:         gcr.io/my-gcp-project-239900/my-kube-scheduler:1.0\n    Image ID:      docker-pullable://gcr.io/my-gcp-project-239900/my-kube-scheduler@sha256:0895687b7646d159438f086e8f8b23b253332930e169cf29d8b9951ebf3ba653\n    Port:          &lt;none&gt;\n    Host Port:     &lt;none&gt;\n    Command:\n      /usr/local/bin/kube-scheduler\n      --address=1.1.1.1\n      --leader-elect=false\n      --scheduler-name=my-scheduler\n    State:          Terminated\n      Reason:       Error\n      Exit Code:    1\n      Started:      Tue, 07 May 2019 15:07:45 -0500\n      Finished:     Tue, 07 May 2019 15:07:45 -0500\n    Last State:     Terminated\n      Reason:       Error\n      Exit Code:    1\n      Started:      Tue, 07 May 2019 15:07:24 -0500\n      Finished:     Tue, 07 May 2019 15:07:24 -0500\n    Ready:          False\n    Restart Count:  3\n    Requests:\n      cpu:        100m\n    Liveness:     http-get http://:10251/healthz delay=15s timeout=1s period=10s #success=1 #failure=3\n    Readiness:    http-get http://:10251/healthz delay=0s timeout=1s period=10s #success=1 #failure=3\n    Environment:  &lt;none&gt;\n    Mounts:\n      /var/run/secrets/kubernetes.io/serviceaccount from my-scheduler-token-lzwvk (ro)\nConditions:\n  Type              Status\n  Initialized       True\n  Ready             False\n  ContainersReady   False\n  PodScheduled      True\nVolumes:\n  my-scheduler-token-lzwvk:\n    Type:        Secret (a volume populated by a Secret)\n    SecretName:  my-scheduler-token-lzwvk\n    Optional:    false\nQoS Class:       Burstable\nNode-Selectors:  &lt;none&gt;\nTolerations:     node.kubernetes.io/not-ready:NoExecute for 300s\n                 node.kubernetes.io/unreachable:NoExecute for 300s\nEvents:\n  Type     Reason     Age               From               Message\n  ----     ------     ----              ----               -------\n  Normal   Scheduled  48s               default-scheduler  Successfully assigned kube-system/my-scheduler-64576b7897-8b549 to minikube\n  Normal   Pulled     2s (x4 over 47s)  kubelet, minikube  Container image \"gcr.io/my-gcp-project-239900/my-kube-scheduler:1.0\" already present on machine\n  Normal   Created    2s (x4 over 47s)  kubelet, minikube  Created container kube-second-scheduler\n  Normal   Started    2s (x4 over 47s)  kubelet, minikube  Started container kube-second-scheduler\n  Warning  BackOff    1s (x6 over 45s)  kubelet, minikube  Back-off restarting failed container\n</code></pre>\n\n<p>And when I try to see the log of this pod, this error message appears:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code> standard_init_linux.go:207: exec user process caused \"exec format error\"\n</code></pre>\n\n<p>And my <code>Dockerfile</code> is bit different from the guide, it looks like:</p>\n\n<pre><code>FROM busybox\nADD ./_output/local/bin/darwin/amd64/kube-scheduler /usr/local/bin/kube-scheduler\n</code></pre>\n\n<p>I changed</p>\n\n<pre><code>ADD ./_output/dockerized/bin/linux/amd64/kube-scheduler /usr/local/bin/kube-scheduler\n</code></pre>\n\n<p>into</p>\n\n<pre><code>ADD ./_output/local/bin/darwin/amd64/kube-scheduler /usr/local/bin/kube-scheduler\n</code></pre>\n\n<p>because <code>./_output/local/bin/darwin/amd64/kube-scheduler</code>is where the scheduler file acctually located. I would also appreciate it if anyone could tell me why would this happen.</p>\n\n<hr>\n\n<p><strong>Some Updates</strong></p>\n\n<h2>Different file location</h2>\n\n<p>Following the guide, I typed these command in my shell</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>git clone https://github.com/kubernetes/kubernetes.git\ncd kubernetes\nmake\n</code></pre>\n\n<p>by executing <code>make</code>, the <code>Makefile</code>file will generate the kubernetes exec files in certain path (including the kube-scheduler we want). And the generation path is related to your system. Since I'm using <strong>minikube</strong> to run kubernetes and docker, and it runs on <strong>darwin(amd64)</strong>. I think that's the reason why my path is different from the guide. </p>\n\n<h2>The \"exec format error\"</h2>\n\n<p>For this error</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code> standard_init_linux.go:207: exec user process caused \"exec format error\"\n</code></pre>\n\n<p>I find <a href=\"https://github.com/moby/moby/issues/23865\" rel=\"nofollow noreferrer\">this issue</a> suggesting add the <code>#!/bin/bash</code> before you try to run commands in the container. This tells the system to treat the commands as bash commands. Here in busybox it should be <code>/bin/sh</code>. (I don't know much about shell language mechanism, so correct me if I'm wrong)</p>\n\n<p>So I changed these lines in <code>my-sheduler.yaml</code>:</p>\n\n<pre><code>- command:\n - /usr/local/bin/kube-scheduler\n - --address=0.0.0.0\n - --leader-elect=false\n - --scheduler-name=my-scheduler\n</code></pre>\n\n<p>into</p>\n\n<pre><code>- command:\n - /bin/sh\n - /usr/local/bin/kube-scheduler\n - --address=0.0.0.0\n - --leader-elect=false\n - --scheduler-name=my-schedule\n</code></pre>\n\n<p>Now the <code>my-sheduler</code> pods still fail and get the <code>CrashLoopBackOff</code> error. \nGood news is I now have the log when executing <code>kubectl logs</code>.\nBad news is the logs are unreadable like this</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>/usr/local/bin/kube-scheduler: line 1: \ufffd\ufffd\ufffd\ufffd: not found\n/usr/local/bin/kube-scheduler: line 2: syntax error: unexpected \")\"\n</code></pre>\n\n<p>I assume this happened because of something happened in the docker image. But since I'm using the scrips right from the <a href=\"https://github.com/kubernetes/kubernetes\" rel=\"nofollow noreferrer\">kubernetes github page</a>, there shouldn't be any bug.</p>\n\n<p>The same log shows up when I run <code>docker run -it {my-image-id} /bin/sh</code> and go into my image and run the exec kube-scheduler file.</p>\n\n<p>I can't figure it out what's in the GO script causes this problem. </p>\n\n<hr>\n\n<h1>Another alternative</h1>\n\n<p>I ended up trying another way to build my custom scheduler.</p>\n\n<p>I followed this tutorial: <a href=\"https://www.youtube.com/watch?v=IYcL0Un1io0&amp;t=1807s\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=IYcL0Un1io0&amp;t=1807s</a></p>\n\n<p>And you can find the source code here: <a href=\"https://github.com/kelseyhightower/scheduler\" rel=\"nofollow noreferrer\">https://github.com/kelseyhightower/scheduler</a></p>\n\n<p>Comparing to the official guide, this one is more clear light (in in official guide you have to build the whole thing to get the scheduler file). </p>\n\n<p>Hope this helps if someone is running into the same problem. </p>\n"}, {"tags": ["go", "concurrency"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10904897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b467e89eb951dc8e68e0f2a8ba0b30b?s=128&d=identicon&r=PG&f=1", "display_name": "John Fitzgerald", "link": "https://stackoverflow.com/users/10904897/john-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1557261297, "post_id": 56030069, "comment_id": 98703816, "body": "Thank you Eli, I&#39;m aware of <code>WaitGroup</code>. However, it was more like a theoretical question: &quot;Am I right or not?&quot;. The runtime couldn&#39;t really terminate the go routine because the main go routine quits before them or not??"}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "reply_to_user": {"reputation": 15, "user_id": 10904897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b467e89eb951dc8e68e0f2a8ba0b30b?s=128&d=identicon&r=PG&f=1", "display_name": "John Fitzgerald", "link": "https://stackoverflow.com/users/10904897/john-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1557261559, "post_id": 56030069, "comment_id": 98703919, "body": "@JohnFitzgerald: when I lower the iteration counter <code>i</code> seems like everything terminates alright. I think you overcomplicated your example. algo() runs one by one (because <code>c&lt;-5</code> blocks). Try to simplify your example to answer your theoretical question"}, {"owner": {"reputation": 15, "user_id": 10904897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b467e89eb951dc8e68e0f2a8ba0b30b?s=128&d=identicon&r=PG&f=1", "display_name": "John Fitzgerald", "link": "https://stackoverflow.com/users/10904897/john-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1557261691, "post_id": 56030069, "comment_id": 98703970, "body": "Thanks Eli, that was intentional. I&#39;ve been trying to see receiving a message happens randomly or in an order. I thought that if I run it several times, I can detect that. The Go Spec doesn&#39;t say anything about this."}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "reply_to_user": {"reputation": 15, "user_id": 10904897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b467e89eb951dc8e68e0f2a8ba0b30b?s=128&d=identicon&r=PG&f=1", "display_name": "John Fitzgerald", "link": "https://stackoverflow.com/users/10904897/john-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1557261747, "post_id": 56030069, "comment_id": 98703999, "body": "@JohnFitzgerald: I suggest you synthesize a simpler example and ask a new question. It&#39;s not clear what you&#39;re asking here, to be honest"}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 0, "last_activity_date": 1557261012, "creation_date": 1557261012, "answer_id": 56030069, "question_id": 56030044, "link": "https://stackoverflow.com/questions/56030044/how-to-ensure-all-goroutines-terminate-without-time-sleep/56030069#56030069", "title": "How to ensure all goroutines terminate without time.Sleep?", "body": "<p>That's exactly what <code>sync.WaitGroup</code> is for. Here's a toy example taken from <a href=\"https://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/\" rel=\"nofollow noreferrer\">this blog post</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    messages := make(chan int)\n    var wg sync.WaitGroup\n\n    // you can also add these one at \n    // a time if you need to \n\n    wg.Add(3)\n    go func() {\n        defer wg.Done()\n        time.Sleep(time.Second * 3)\n        messages &lt;- 1\n    }()\n    go func() {\n        defer wg.Done()\n        time.Sleep(time.Second * 2)\n        messages &lt;- 2\n    }() \n    go func() {\n        defer wg.Done()\n        time.Sleep(time.Second * 1)\n        messages &lt;- 3\n    }()\n    go func() {\n        for i := range messages {\n            fmt.Println(i)\n        }\n    }()\n\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10904897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b467e89eb951dc8e68e0f2a8ba0b30b?s=128&d=identicon&r=PG&f=1", "display_name": "John Fitzgerald", "link": "https://stackoverflow.com/users/10904897/john-fitzgerald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "closed_date": 1557261346, "accepted_answer_id": 56030069, "answer_count": 1, "score": 0, "last_activity_date": 1557261526, "creation_date": 1557260865, "question_id": 56030044, "link": "https://stackoverflow.com/questions/56030044/how-to-ensure-all-goroutines-terminate-without-time-sleep", "closed_reason": "Duplicate", "title": "How to ensure all goroutines terminate without time.Sleep?", "body": "<p>I'm trying to experiment with go routines about who gets the message first. However, when the main goroutine terminates, some go routines are still hanging around. I see this through the stack trace from <code>panic</code>. However, If I add <code>time.Sleep</code> they all terminate. I guess this is because, when the main go routines ends, Go runtime couldn't find time to terminate the others.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    package main\n\n    import (\n        \"fmt\"\n        \"time\"\n    )\n\n    func main() {\n        for i := 0; i &lt; 1000000; i++ {\n            algo()\n        }\n\n        // without this, some goroutines do not terminate\n        // time.Sleep(time.Second)\n\n        panic(\"\")\n    }\n\n    func algo() {\n        c := make(chan int)\n        wait := make(chan bool)\n\n        go racer(1, wait, c)\n        go racer(2, wait, c)\n        go racer(3, wait, c)\n        go racer(4, wait, c)\n        go racer(5, wait, c)\n\n        // who gets it first\n        c &lt;- 5\n        close(wait)\n    }\n\n    func racer(name int, wait chan bool, c chan int) {\n        select {\n        case &lt;-wait:\n        case v := &lt;-c:\n            fmt.Println(name, \":\", v)\n        }\n    }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 3, "creation_date": 1557261297, "post_id": 56029983, "comment_id": 98703815, "body": "Seems like <code>out</code> is till open when <code>exec.Command</code> is run. <code>defer</code> will only close it at the end of the lexical scope. Try to <code>Close</code> it after the <code>Sleep</code>"}, {"owner": {"reputation": 9, "user_id": 11209357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c00ac8383ec62e452c489fe8bb396f?s=128&d=identicon&r=PG&f=1", "display_name": "zorgos", "link": "https://stackoverflow.com/users/11209357/zorgos"}, "reply_to_user": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1557261913, "post_id": 56029983, "comment_id": 98704056, "body": "I still get the error, but thanks for the fast reply"}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 1, "creation_date": 1557262409, "post_id": 56029983, "comment_id": 98704225, "body": "Why do you use <code>cmd &#47;C</code> instead of using <code>exec.Command</code> directly? Why is the program you&#39;re executing in <code>PATH</code>, is your Go script in PATH? Did you try to run it manually after downloading? Did you try to split apart the download code from the <code>exec</code> code and see which one is bad? In short <i>this is not a Go question, it&#39;s just a general Windows question</i>"}, {"owner": {"reputation": 9, "user_id": 11209357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c00ac8383ec62e452c489fe8bb396f?s=128&d=identicon&r=PG&f=1", "display_name": "zorgos", "link": "https://stackoverflow.com/users/11209357/zorgos"}, "reply_to_user": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1557262810, "post_id": 56029983, "comment_id": 98704369, "body": "When i try to run it directly with exec.Command i get don&#39;t get any output, it seems to works great with cmd manually that&#39;s why. I compile it with linux for a Windows system, I don&#39;t the issue come from my PATH here. Everything work when i split the files, and it work manually also. I was thinking it&#39;s about out.close also. But now I have no clues."}, {"owner": {"reputation": 9, "user_id": 11209357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c00ac8383ec62e452c489fe8bb396f?s=128&d=identicon&r=PG&f=1", "display_name": "zorgos", "link": "https://stackoverflow.com/users/11209357/zorgos"}, "reply_to_user": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1557263621, "post_id": 56029983, "comment_id": 98704661, "body": "Moreover i want to launch my program in another process, because I&#39;m not advanced with go i was thinking cmd will do it for me."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1557267526, "post_id": 56029983, "comment_id": 98705761, "body": "You\u2019re not going to get any output unless you try to get the output. Maybe start with <code>CombinedOutput</code>"}], "owner": {"reputation": 9, "user_id": 11209357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c00ac8383ec62e452c489fe8bb396f?s=128&d=identicon&r=PG&f=1", "display_name": "zorgos", "link": "https://stackoverflow.com/users/11209357/zorgos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557260576, "creation_date": 1557260576, "question_id": 56029983, "link": "https://stackoverflow.com/questions/56029983/download-and-execute-binary-in-go", "title": "Download and execute binary in go", "body": "<p>I'm trying to download a file and execute it in my windows laptop.\nMy program is well downloaded but when i try to execute it in my code i get this windows error : Your file cannot be executed because the process is busy.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>fmt.Println(stdout)\nout, err := os.Create(\"output.exe\")\ndefer out.Close()\nresp, err := http.Get(\"http://IP:8000/myfile.exe\")\ndefer resp.Body.Close()\nn, err := io.Copy(out, resp.Body)\ntime.Sleep(2 * time.Second)\n\nc := exec.Command(\"cmd\", \"/C\", \"start\", \"C:\\\\PATH\\\\output.exe\")\nif err := c.Run(); err != nil {\nfmt.Println(\"Error: \", err)\n}\n</code></pre>\n\n<p>I'm pretty new with go.\nThanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1557260524, "post_id": 56029929, "comment_id": 98703476, "body": "No there is no other way to get a key, you can omit the else however and just break after the if block."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557322188, "post_id": 56029929, "comment_id": 98725850, "body": "This code also doesn&#39;t do anything. If the first element&#39;s <code>k.Type  == 2</code>, the function immediately returns. Otherwise, it breaks from the <code>for</code>... and the function immediately returns. The entire function body could be removed and the behavior would be the same."}, {"owner": {"reputation": 759, "user_id": 3942851, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh4.googleusercontent.com/-nIkq4wdsg6g/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMtFLuG4ftgrUKJVYOo8SEwFsosuQ/mo/photo.jpg?sz=128", "display_name": "sfdcnoob", "link": "https://stackoverflow.com/users/3942851/sfdcnoob"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557333210, "post_id": 56029929, "comment_id": 98732187, "body": "@Adrian added // Do something"}], "owner": {"reputation": 759, "user_id": 3942851, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh4.googleusercontent.com/-nIkq4wdsg6g/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMtFLuG4ftgrUKJVYOo8SEwFsosuQ/mo/photo.jpg?sz=128", "display_name": "sfdcnoob", "link": "https://stackoverflow.com/users/3942851/sfdcnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557333161, "creation_date": 1557260379, "last_edit_date": 1557333161, "question_id": 56029929, "link": "https://stackoverflow.com/questions/56029929/get-any-item-from-map-without-loop", "title": "get any item from map without loop", "body": "<pre><code>package main\n\nimport ()\n\ntype Scope struct {\n    Type   int // 1,2,3\n    Parent *Scope\n}\n\nfunc main() {\n\n    scopes := map[*Scope]string{}\n    filter(scopes)\n}\n\n// key is always the same type of scopes\nfunc filter(scopes map[*Scope]string) {\n    // This function only works for scopes of Type 1,3\n    // if the Type is 2 return\n    // I just need to pick any item in the map to do a check\n\n    for k := range scopes {\n        if k.Type == 2 {\n            return\n        } else {\n            break\n        }\n        // Do something\n    }\n}\n</code></pre>\n\n<p>I have to check the type of the key of a map.\nThe keys of the map are of the same type.\nso I just need to pick any item from the map.</p>\n\n<pre><code>for k := range scopes {\n        if k.Type == 2 {\n            return\n        } else {\n            break\n        }\n        // Do something\n    }\n</code></pre>\n\n<p>this code does the check but is there a way doing this without evolving loop?</p>\n"}, {"tags": ["ssl", "go", "ssl-certificate", "x509certificate"], "comments": [{"owner": {"reputation": 1337, "user_id": 903766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94253e3b2045fbf75c05e81a92035e37?s=128&d=identicon&r=PG", "display_name": "ctt", "link": "https://stackoverflow.com/users/903766/ctt"}, "edited": false, "score": 4, "creation_date": 1557258577, "post_id": 56029508, "comment_id": 98702622, "body": "It looks like you&#39;re starting your certificate with the contents of your private key.  Try skipping the first line of your certificate creation script and trying again."}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 8092543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOOdr.png?s=128&g=1", "display_name": "sebito91", "link": "https://stackoverflow.com/users/8092543/sebito91"}, "is_accepted": false, "score": 0, "last_activity_date": 1557278977, "creation_date": 1557278977, "answer_id": 56032352, "question_id": 56029508, "link": "https://stackoverflow.com/questions/56029508/listenandservertls-keeps-failing-with-error-failed-to-find-any-pem-data-in-cert/56032352#56032352", "title": "ListenAndServerTLS keeps failing with error: failed to find any PEM data in certificate input", "body": "<p>I've struggled with this myself and I <em>think</em> your issue here is that you need to process the keys before presenting for the <code>http.Server</code>, and you'll need to include the RootCA. I've downloaded an SSL from GoDaddy (using the <code>Other</code> option) and grabbed their <code>gd_bundle-g2.crt</code> RootCA from <a href=\"https://ssl-ccp.godaddy.com/repository\" rel=\"nofollow noreferrer\">here</a>. Once you've grabbed that, create a function like below (added a gist <a href=\"https://gist.github.com/sebito91/21d6b6536a3f3add1d8be2738ee1fcae\" rel=\"nofollow noreferrer\">here</a>):</p>\n\n<pre><code>func genTLS() (*tls.Config, error) {\n    caCert, err := ioutil.ReadFile(\"/home/sborza/gd_bundle-g2.crt\")\n    if err != nil {\n            return nil, fmt.Errorf(\"read root cert: %s\", err.Error())\n    }\n\n    // **** START PRIV KEY PROCESSING ****\n\n    clientBytes, err := ioutil.ReadFile(\"/home/sborza/sborza_dev.key\")\n    if err != nil {\n            return nil, fmt.Errorf(\"read client priv key: %s\", err.Error())\n    }\n\n    cb, _ := pem.Decode(clientBytes)\n    k, err := x509.ParsePKCS8PrivateKey(cb.Bytes)\n    if err != nil {\n            return nil, fmt.Errorf(\"parse client privkey: %s\", err.Error())\n    }\n\n    clientKey, _ := x509.MarshalPKCS8PrivateKey(k)\n    clientKeyPEM := pem.EncodeToMemory(&amp;pem.Block{\n            Type:  \"PRIVATE KEY\",\n            Bytes: clientKey,\n    })\n\n    // **** END PRIV KEY PROCESSING ****\n    // **** START CERT PROCESSING ****\n\n    certBytes, err := ioutil.ReadFile(\"/home/sborza/sborza_dev.pem\")\n    if err != nil {\n            return nil, fmt.Errorf(\"read client cert: %s\", err.Error())\n    }\n\n    cbk, _ := pem.Decode(certBytes)\n    certs, err := x509.ParseCertificates(cbk.Bytes)\n    if err != nil {\n            return nil, fmt.Errorf(\"parse client cert: %s\", err.Error())\n    }\n\n    clientCertPEM := pem.EncodeToMemory(&amp;pem.Block{\n            Type:  \"CERTIFICATE\",\n            Bytes: certs[0].Raw,\n    })\n\n    // **** END CERT PROCESSING ****\n    // **** START TLS CONFIG ****\n\n    cert, err := tls.X509KeyPair(clientCertPEM, clientKeyPEM)\n    if err != nil {\n            return nil, fmt.Errorf(\"tls key pair: %s\", err.Error())\n    }\n    caCertPool := x509.NewCertPool()\n    if ok := caCertPool.AppendCertsFromPEM(caCert); !ok {\n            return nil, fmt.Errorf(\"append cert: %s\", err.Error())\n    }\n\n    return &amp;tls.Config{\n            RootCAs:      caCertPool,\n            Certificates: []tls.Certificate{cert},\n    }, nil\n    // **** END TLS CONFIG ****\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1842, "user_id": 2254802, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d32c3e8c2bd04797670b2b51e50c902e?s=128&d=identicon&r=PG&f=1", "display_name": "impossible", "link": "https://stackoverflow.com/users/2254802/impossible"}, "edited": false, "score": 0, "creation_date": 1566491538, "post_id": 56041850, "comment_id": 101682427, "body": "Hey, I am in the same boat. How did your server.key look like? How did you append the content of each file?"}], "tags": [], "owner": {"reputation": 41, "user_id": 10917838, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NJ0nV2igwyI/AAAAAAAAAAI/AAAAAAAABLM/g6XQnirhTGQ/photo.jpg?sz=128", "display_name": "Yuval Lerner", "link": "https://stackoverflow.com/users/10917838/yuval-lerner"}, "is_accepted": false, "score": 1, "last_activity_date": 1557321740, "creation_date": 1557321740, "answer_id": 56041850, "question_id": 56029508, "link": "https://stackoverflow.com/questions/56029508/listenandservertls-keeps-failing-with-error-failed-to-find-any-pem-data-in-cert/56041850#56041850", "title": "ListenAndServerTLS keeps failing with error: failed to find any PEM data in certificate input", "body": "<p>Finally solved it, I had to combine both generated-private-key.txt and generated-csr.txt that Godaddy provided me into a single \"server.key\" file.\nIncredible what lack of knowledge of certain things end up wasting so much time.\nBut I guess that's why were here, for the thrill of exploring.\nThank you everyone for the help!</p>\n"}, {"comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1566542357, "post_id": 57614615, "comment_id": 101696067, "body": "While this might solve this problem in the specific case it is very likely only a side effect of opening the file in some editor and writing it again and thereby implicitly cleaning up some problems of the key file which should not have been there in the first place (like UTF-8 BOM at the start of the file or similar). The certificate information are definitely not needed. Likely just adding an empty line at the beginning of the file would have done this too, since this way any UTF-8 BOM would not be longer directly at the beginning of the PEM data."}, {"owner": {"reputation": 1842, "user_id": 2254802, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d32c3e8c2bd04797670b2b51e50c902e?s=128&d=identicon&r=PG&f=1", "display_name": "impossible", "link": "https://stackoverflow.com/users/2254802/impossible"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1566553033, "post_id": 57614615, "comment_id": 101700957, "body": "I am still working on it. I will update this answer after little more debugging and conclusions. Thanks you for helping me out @SteffenUllrich"}], "tags": [], "owner": {"reputation": 1842, "user_id": 2254802, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d32c3e8c2bd04797670b2b51e50c902e?s=128&d=identicon&r=PG&f=1", "display_name": "impossible", "link": "https://stackoverflow.com/users/2254802/impossible"}, "is_accepted": false, "score": -1, "last_activity_date": 1566615624, "last_edit_date": 1566615624, "creation_date": 1566495923, "answer_id": 57614615, "question_id": 56029508, "link": "https://stackoverflow.com/questions/56029508/listenandservertls-keeps-failing-with-error-failed-to-find-any-pem-data-in-cert/57614615#57614615", "title": "ListenAndServerTLS keeps failing with error: failed to find any PEM data in certificate input", "body": "<p>The issue was with the key file. This was the same key I used given by GoDaddy without any modification. The beginning of the file had some issue (like UTF-8 BOM at the start of the file or similar) as @SteffenUllrich  mentioned. To fix this, I added an empty line just above the key file and it worked.</p>\n\n<p>Finally, the key looks like:</p>\n\n<pre><code>&lt;Empty line&gt;\n-----BEGIN RSA PRIVATE KEY-----\nwlWPpSnGEdNjRapfW/6+xzjDVAaKC41c5b07OAviFchwqGI+88\naZGwBJnTgkbsLddddddd=\n-----END RSA PRIVATE KEY-----\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "is_accepted": false, "score": 0, "last_activity_date": 1607693487, "creation_date": 1607693487, "answer_id": 65252280, "question_id": 56029508, "link": "https://stackoverflow.com/questions/56029508/listenandservertls-keeps-failing-with-error-failed-to-find-any-pem-data-in-cert/65252280#65252280", "title": "ListenAndServerTLS keeps failing with error: failed to find any PEM data in certificate input", "body": "<p>As per one of the other comments, for the first param to ListenAndServeTLS, the GoDaddy cert and chain files have to be concatenated. Here is an example</p>\n<pre><code>var srv http.Server\nsrv.Handler = yourHandler\nsrv.Addr = &quot;:443&quot;\n\n// Load cert files\nchainBytes, err := ioutil.ReadFile(&quot;gd_bundle-g2-g1.crt&quot;) // GoDaddy chain\nif err != nil {\n    log.Fatal(err)\n}\ncertBytes, err := ioutil.ReadFile(&quot;server.crt&quot;) // Your server cert\nif err != nil {\n    log.Fatal(err)\n}\nkeyBytes, err := ioutil.ReadFile(&quot;server.key&quot;) // Your server key\nif err != nil {\n    log.Fatal(err)\n}\n\n// Concatenate chain and cert\nb := bytes.NewBuffer(certBytes)\nb.Write([]byte(&quot;\\n&quot;))\nb.Write(chainBytes)\n\n// Setup TLS\ncert, err := tls.X509KeyPair(b.Bytes(), keyBytes)\nif err != nil {\n    log.Fatal(err)\n}\ncfg := &amp;tls.Config{\n    Certificates: []tls.Certificate{cert},\n}\nsrv.TLSConfig = cfg\n\n// Start server\nerr = srv.ListenAndServeTLS(&quot;&quot;, &quot;&quot;)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n<p>My experience was that just using the cert file is fine in latest versions of browsers like <strong>Google Chrome</strong>, but I would get TLS errors with clients like <strong>HTTPie</strong> or <strong>CURL</strong></p>\n<pre><code>certificate verify failed\n</code></pre>\n<p>And various errors on the server</p>\n<pre><code>tls: bad record MAC\ntls: unknown certificate authority\n</code></pre>\n<p>Concatenating the cert and chain files solved above errors.</p>\n"}], "owner": {"reputation": 41, "user_id": 10917838, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NJ0nV2igwyI/AAAAAAAAAAI/AAAAAAAABLM/g6XQnirhTGQ/photo.jpg?sz=128", "display_name": "Yuval Lerner", "link": "https://stackoverflow.com/users/10917838/yuval-lerner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 950, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1607693487, "creation_date": 1557258342, "question_id": 56029508, "link": "https://stackoverflow.com/questions/56029508/listenandservertls-keeps-failing-with-error-failed-to-find-any-pem-data-in-cert", "title": "ListenAndServerTLS keeps failing with error: failed to find any PEM data in certificate input", "body": "<p>I bought an SSL certificate from Godaddy for a web site.\nI added the files in the server and run the service and it just returns an error:</p>\n\n<blockquote>\n  <p>failed to find any PEM data in certificate input</p>\n</blockquote>\n\n<p>I used cat to generate a server.pem file with all the files, even added a godaddy pem intermediate pem file they provide for a G2 Certificate Chain and nothing.</p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>cat generated-private-key.txt &gt; server.pem\ncat 678f65b8a7391017.crt &gt;&gt; server.pem\ncat gd_bundle-g2-g1.crt &gt;&gt; server.pem\ncat gdig2.crt.pem &gt;&gt; server.pem\n</code></pre>\n\n<p>Using self signed certificate works but off course it's not usable in real world.</p>\n\n<p>Code attempt 1:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>log.Fatal(http.ListenAndServeTLS(fmt.Sprintf(\"%s:%d\", configuration.HttpServer.Address, configuration.HttpServer.Port), \"server.pem\", \"generated-private-key.txt\", router))\n</code></pre>\n\n<p>Code attempt 2:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    cert, err := tls.LoadX509KeyPair(\"server.pem\",\"generated-private-key.txt\")\n    if err != nil {\n        log.Fatalf(\"server: loadkeys: %s\", err)\n    }\n    pem, err := ioutil.ReadFile(\"gd_bundle-g2-g1.crt\")\n    if err != nil {\n        log.Fatalf(\"Failed to read client certificate authority: %v\", err)\n    }\n    certpool := x509.NewCertPool()\n    if !certpool.AppendCertsFromPEM(pem) {\n        log.Fatalf(\"Can't parse client certificate authority\")\n    }\n    tlsConfig := &amp;tls.Config{\n        ClientCAs:    certpool,\n        Certificates: []tls.Certificate{cert},\n    }\n\n    srv := &amp;http.Server{\n        Addr: fmt.Sprintf(\"%s:%d\", configuration.HttpServer.Address, configuration.HttpServer.Port),\n        Handler: router,\n        ReadTimeout: time.Duration(5) * time.Second,\n        WriteTimeout: time.Duration(5) * time.Second,\n        TLSConfig: tlsConfig,\n    }\n    log.Fatal(srv.ListenAndServeTLS(\"678f65b8a7391017.crt\",\"generated-private-key.txt\"))\n</code></pre>\n\n<p>Both give the same error.</p>\n\n<p>I need to have this up and running as I already have the back-end done but now I just want to enable HTTPS for productive environment.</p>\n"}, {"tags": ["go", "bson", "mongo-go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user773737"}, "edited": false, "score": 0, "creation_date": 1557252684, "post_id": 56028029, "comment_id": 98700157, "body": "And if you have other values that aren&#39;t strings, you can do <code>map[string]interface{}</code>, right? Or would that cause problems?"}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 0, "creation_date": 1557252860, "post_id": 56028029, "comment_id": 98700216, "body": "<code>map[string]interface{}</code> will work. However, it is only recommended if you do not know the structure of <code>data</code>. You should create a struct if you do."}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 4, "last_activity_date": 1557251404, "creation_date": 1557251404, "answer_id": 56028029, "question_id": 56027875, "link": "https://stackoverflow.com/questions/56027875/how-can-i-get-json-from-bson-without-my-keys-all-being-named-key/56028029#56028029", "title": "How can I get JSON from BSON without my keys all being named &quot;Key&quot;?", "body": "<p>You need to provide a map instead of an interface to get value as a key-value pair. </p>\n\n<p>Try:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n\n    \"go.mongodb.org/mongo-driver/bson\"\n)\n\nfunc main() {\n\n    var data = \"{\\\"foo\\\":\\\"bar\\\"}\"\n    var testInterface map[string]string\n    e := bson.UnmarshalExtJSON([]byte(data), false, &amp;testInterface)\n    if e != nil {\n        fmt.Println(\"err is \", e)\n    }\n\n    out, _ := json.Marshal(testInterface)\n    fmt.Println(string(out))\n    // prints: {\"foo\":\"bar\"}\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user773737"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 56028029, "answer_count": 1, "score": -3, "last_activity_date": 1557251404, "creation_date": 1557250744, "question_id": 56027875, "link": "https://stackoverflow.com/questions/56027875/how-can-i-get-json-from-bson-without-my-keys-all-being-named-key", "title": "How can I get JSON from BSON without my keys all being named &quot;Key&quot;?", "body": "<p>I'm trying to read from a database and then return the result to the user as json.</p>\n\n<p>What's happening is that I'm getting output like:<br>\n<code>[{\"Key\":\"foo\",\"Value\":\"bar\"}]</code>  </p>\n\n<p>When I would like to get:<br>\n<code>\"{\"foo\":\"bar\"}\"</code></p>\n\n<p>How do I get the former?</p>\n\n<p>Example: (reading from the db and converting <code>Raw</code> to string are not shown)</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n\n    \"go.mongodb.org/mongo-driver/bson\"\n)\n\nfunc main() {\n\n    var data = \"{\\\"foo\\\":\\\"bar\\\"}\"\n    var testInterface interface{}\n    e := bson.UnmarshalExtJSON([]byte(data), false, &amp;testInterface)\n    if e != nil {\n        fmt.Println(\"err is \", e)\n    }\n    out, _ := json.Marshal(testInterface)\n    fmt.Println(string(out))\n    // prints: [{\"Key\":\"foo\",\"Value\":\"bar\"}]\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1557252612, "post_id": 56027718, "comment_id": 98700128, "body": "<a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">golang.org/cmd/cgo</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557252730, "post_id": 56027718, "comment_id": 98700175, "body": "I&#39;m not sure I understand what the issue is, but a &quot;Go pointer&quot; is simply a pointer to Go allocated memory. The runtime can easily determine what is and isn&#39;t a go pointer."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1557256454, "post_id": 56027718, "comment_id": 98701762, "body": "Why should Go pin each and every pointer just because you pass some to cgo?"}, {"owner": {"reputation": 1320, "user_id": 593146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2404c3e4304714294c0458b3feb39ff0?s=128&d=identicon&r=PG", "display_name": "Zyl", "link": "https://stackoverflow.com/users/593146/zyl"}, "edited": false, "score": 0, "creation_date": 1557257418, "post_id": 56027718, "comment_id": 98702173, "body": "I made changes to clarify my question."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1557274950, "post_id": 56027718, "comment_id": 98707247, "body": "You refer to a technical discussion for Go1.2 (December 2013). We are now approaching Go1.13 (August 2019). Cgo has undergone substantial revisions with a new maintainer. Use the current cgo documentation: <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">golang.org/cmd/cgo</a>."}, {"owner": {"reputation": 1320, "user_id": 593146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2404c3e4304714294c0458b3feb39ff0?s=128&d=identicon&r=PG", "display_name": "Zyl", "link": "https://stackoverflow.com/users/593146/zyl"}, "edited": false, "score": 0, "creation_date": 1557315218, "post_id": 56027718, "comment_id": 98721686, "body": "I wrapped up what I found in an answer. Proof-reading is welcome."}], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 593146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2404c3e4304714294c0458b3feb39ff0?s=128&d=identicon&r=PG", "display_name": "Zyl", "link": "https://stackoverflow.com/users/593146/zyl"}, "is_accepted": true, "score": 1, "last_activity_date": 1606221807, "last_edit_date": 1606221807, "creation_date": 1557315180, "answer_id": 56039834, "question_id": 56027718, "link": "https://stackoverflow.com/questions/56027718/how-to-pass-a-go-pointer-to-cgo/56039834#56039834", "title": "How to &quot;pass a Go pointer to Cgo&quot;?", "body": "<p>Looking at <a href=\"https://golang.org/cmd/cgo/#hdr-Passing_pointers\" rel=\"nofollow noreferrer\">the section on passing pointers in the current cgo documentation</a>, (thanks to peterSO) we find that</p>\n<blockquote>\n<p>the term Go pointer means a pointer to memory allocated by Go</p>\n</blockquote>\n<p>as well as that</p>\n<blockquote>\n<p>A pointer type may hold a Go pointer or a C pointer</p>\n</blockquote>\n<p>Thus, <strong>using <code>uintptr</code> and other integer (read: non-pointer) types will lose us Go's guarantee of pinning the pointer.</strong></p>\n<blockquote>\n<p>A uintptr is an integer, not a reference. Converting a Pointer to a uintptr creates an integer value with no pointer semantics. Even if a uintptr holds the address of some object, the garbage collector will not update that uintptr's value if the object moves, nor will that uintptr keep the object from being reclaimed.</p>\n</blockquote>\n<p>Source: <a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow noreferrer\">https://golang.org/pkg/unsafe/#Pointer</a></p>\n<p><strong>Regarding C pointer types such as <code>*char</code>/<code>*C.char</code>, these are only safe when the pointed data does not itself contain pointers to other memory allocated by Go.</strong> This can actually be shown by trying to trigger Go's Cgo Debug mechanism, which disallows passing a Go pointer to (or into) a value which itself contains another Go pointer:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;unsafe&quot;\n\n    /*\n    #include &lt;stdio.h&gt;\n\n    void cFuncChar(char* ptr) {\n        printf(&quot;%s\\n&quot;, ptr);\n    }\n\n    void cFuncVoid(void* ptr) {\n        printf(&quot;%s\\n&quot;, (char*)ptr);\n    }\n    */\n    &quot;C&quot;\n)\n\ntype MyStruct struct {\n    Distraction [2]byte\n    Dangerous *MyStruct\n}\n\nfunc main() {\n    bypassDetection()\n    triggerDetection()\n}\n\nfunc bypassDetection() {\n    fmt.Println(&quot;=== Bypass Detection ===&quot;)\n    ms := &amp;MyStruct{[2]byte{'A', 0}, &amp;MyStruct{[2]byte{0, 0}, nil}}\n    C.cFuncChar((*C.char)(unsafe.Pointer(ms)))\n}\n\nfunc triggerDetection() {\n    fmt.Println(&quot;=== Trigger Detection ===&quot;)\n    ms := &amp;MyStruct{[2]byte{'B', 0}, &amp;MyStruct{[2]byte{0, 0}, nil}}\n    C.cFuncVoid(unsafe.Pointer(ms))\n}\n</code></pre>\n<p>This will print the following:</p>\n<pre><code>=== Bypass Detection ===\nA\n=== Trigger Detection ===\npanic: runtime error: cgo argument has Go pointer to Go pointer\n</code></pre>\n<p>Using <code>*C.char</code> bypassed the detection. <strong>Only using <code>unsafe.Pointer</code> will detect Go pointer to Go pointer scenarios.</strong> Unfortunately, this means we will have to have an occasional nebulous <code>void*</code>-parameter in the C-function's signature.</p>\n<p>Adding for clarity: Go may very well pin the value pointed by a <code>*C.char</code> or such, which is safe to pass; it just (reasonably) won't make an effort to find out whether it might be something else which could contain additional pointers into memory allocated by Go. Casting to <code>unsafe.Pointer</code> is actually safe; casting <em>from</em> it is what may be dangerous.</p>\n"}], "owner": {"reputation": 1320, "user_id": 593146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2404c3e4304714294c0458b3feb39ff0?s=128&d=identicon&r=PG", "display_name": "Zyl", "link": "https://stackoverflow.com/users/593146/zyl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1780, "favorite_count": 1, "accepted_answer_id": 56039834, "answer_count": 1, "score": 4, "last_activity_date": 1606221807, "creation_date": 1557250051, "last_edit_date": 1557258936, "question_id": 56027718, "link": "https://stackoverflow.com/questions/56027718/how-to-pass-a-go-pointer-to-cgo", "title": "How to &quot;pass a Go pointer to Cgo&quot;?", "body": "<p>I am confused regarding the passing of Go pointers (which, to my understanding, include all pointer types as well as <code>unsafe.Pointer</code>) to cgo. When calling C functions with cgo, I can <s>only</s> provide variables of types known on the C-side, or <code>unsafe.Pointer</code> if it matches with a <code>void*</code>-typed parameter in the C-function's signature. So when <a href=\"https://github.com/golang/go/issues/6397\" rel=\"nofollow noreferrer\">\"Go pointers passed to C are pinned for lifetime of call\"</a>, how does Go know that what I am passing is, in fact, a Go pointer, if I am ever forced to cast it to <code>C.some_wide_enough_uint_type</code> or <code>C.some_c_pointer_type</code> beforehand? The moment it is cast, isn't the information that it is a Go pointer lost, and I run risk of the GC changing the pointer? (I can see how freeing is prevented at least, when a pointer-type reference is retained on the Go-side)</p>\n\n<p>We have a project with a fair amount of working cgo code, but zero confidence in its reliability. I would like to see an example of \"here is how to do it correctly\" which doesn't resort to circumventing Go's memory model by using <code>C.malloc()</code> or such, which most examples unfortunately do.</p>\n\n<p>So regardless of what \"pinning the pointer for lifetime of call\" actually means, I see a problem either way:</p>\n\n<ol>\n<li>If it means that Go will pin <strong>all pointers in the entire program</strong>, I see a race condition in the time interval between casting a Go pointer to a C-type and the cgo-call actually being invoked.</li>\n<li>If it means that Go will pin only those Go pointers which are being passed, how does it know that they are Go pointers when, at the time of calling, they can only have a C-type?</li>\n</ol>\n\n<p>I've been reading through Go issues for half the day and am starting to feel like I'm just missing something simple. Any <em>pointers</em> are appreciated.</p>\n\n<p>EDIT: I will try to clarify the question by providing examples.</p>\n\n<p>Consider this:</p>\n\n<pre><code>/*\n#include &lt;stdio.h&gt;\nvoid myCFunc(void* ptr) {\n    printf((char*)ptr);\n}\n*/\nimport \"C\"\nimport \"unsafe\"\n\nfunc callMyCFunc() {\n    goPointer := []byte(\"abc123\\n\\x00\")\n    C.myCFunc(unsafe.Pointer(&amp;goPointer[0]))\n}\n</code></pre>\n\n<p>Here, Go's <code>unsafe.Pointer</code>-type effortlessly translates into C's <code>void*</code>-type, so we are happy on the C-side of things, and we should be on the Go-side also: the pointer clearly points into Go-allocated memory, so it should be trivial for Go to figure out that it should pin this pointer during the call, despite it being an <strong>unsafe</strong> one. <strong>Is this the case?</strong> If it is, without further research, I would consider this to be the preferred way to pass Go pointers to cgo. <strong>Is it?</strong></p>\n\n<p>Then, consider this:</p>\n\n<pre><code>/*\n#include &lt;stdio.h&gt;\nvoid myCFunc(unsigned long long int stupidlyTypedPointerVariable) {\n    char* pointerToHopefullyStillTheSameMemory = (char*)stupidlyTypedPointerVariable;\n    printf(pointerToHopefullyStillTheSameMemory);\n}\n*/\nimport \"C\"\nimport \"unsafe\"\n\nfunc callMyCFunc() {\n    goPointer := []byte(\"abc123\\n\\x00\")\n    C.myCFunc(C.ulonglong(uintptr(unsafe.Pointer(&amp;goPointer[0]))))\n}\n</code></pre>\n\n<p>Here, I would expect that Go won't make any guesses on whether some <code>C.ulonglong</code>-typed variable actually means to contain the address of a Go pointer. <strong>But am I correct?</strong></p>\n\n<p>My confusion largely arises from the fact that it's not really possible to write some code to reliably test this with.</p>\n\n<p>Finally, what about this:</p>\n\n<pre><code>/*\n#include &lt;stdio.h&gt;\nvoid cFuncOverWhichIHaveNoControl(char* ptr) {\n    printf(ptr);\n}\n*/\nimport \"C\"\nimport \"unsafe\"\n\nfunc callMyCFunc() {\n    goPointer := []byte(\"abc123\\n\\x00\")\n    C.cFuncOverWhichIHaveNoControl((*C.char)(unsafe.Pointer(&amp;goPointer[0])))\n}\n</code></pre>\n\n<p>If I am, for whatever reason, unable to change the signature of the C-function, I <strong>must</strong> cast to <code>*C.char</code>. <strong>Will Go still check if the value is a Go pointer, when it already is a C pointer-type?</strong></p>\n"}, {"tags": ["go", "admob", "tink"], "answers": [{"tags": [], "owner": {"reputation": 369, "user_id": 7791205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukb4J.jpg?s=128&g=1", "display_name": "Salam Hiyali", "link": "https://stackoverflow.com/users/7791205/salam-hiyali"}, "is_accepted": false, "score": -1, "last_activity_date": 1566118941, "last_edit_date": 1566118941, "creation_date": 1566020747, "answer_id": 57533616, "question_id": 56026581, "link": "https://stackoverflow.com/questions/56026581/admob-server-side-validation-for-video-reward/57533616#57533616", "title": "AdMob Server Side Validation for Video Reward", "body": "<p>In the end, I finished this job myself.</p>\n\n<p>Use this <a href=\"https://github.com/hiyali/go-lib-ssv\" rel=\"nofollow noreferrer\">hiyali/go-lib-ssv</a>, hope to save your life :)</p>\n"}], "owner": {"reputation": 145, "user_id": 4910308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-QWyrqp3elWk/AAAAAAAAAAI/AAAAAAAABrw/VEiwztHUOfg/photo.jpg?sz=128", "display_name": "Diego Barreto", "link": "https://stackoverflow.com/users/4910308/diego-barreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566118941, "creation_date": 1557245310, "question_id": 56026581, "link": "https://stackoverflow.com/questions/56026581/admob-server-side-validation-for-video-reward", "title": "AdMob Server Side Validation for Video Reward", "body": "<p>I need to verify the video reward of a user on the server, I'm using  Google's Admob and as the documentation found on their website I can't find anything that could help me doing that kind of stuff, as the Golang API is not documented and I also need to use the Crypto Lib used by them, also made by Google, Tink.</p>\n"}, {"tags": ["go", "import", "package"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557239028, "post_id": 56024765, "comment_id": 98693213, "body": "What version of Go are you using?"}, {"owner": {"reputation": 190, "user_id": 3156262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000323467588/picture?type=large", "display_name": "user3156262", "link": "https://stackoverflow.com/users/3156262/user3156262"}, "edited": false, "score": 0, "creation_date": 1557239262, "post_id": 56024765, "comment_id": 98693374, "body": "go version go1.12.5 linux/amd64"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1557240922, "post_id": 56024765, "comment_id": 98694427, "body": "The errors are correct, and that code is simply broken."}], "answers": [{"tags": [], "owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "is_accepted": false, "score": 0, "last_activity_date": 1557240983, "creation_date": 1557240983, "answer_id": 56025384, "question_id": 56024765, "link": "https://stackoverflow.com/questions/56024765/getting-this-error-while-importing-package-in-go-any-idea-how-to-resolve-this/56025384#56025384", "title": "getting this error while importing package in go any idea how to resolve this?", "body": "<p>You are using <a href=\"https://godoc.org/golang.org/x/net/proxy#Dialer\" rel=\"nofollow noreferrer\">proxy.Dialer</a> whereas it seems you want <a href=\"https://golang.org/pkg/net/#Dialer\" rel=\"nofollow noreferrer\">net.Dialer</a>, as that one has a <a href=\"https://golang.org/pkg/net/#Dialer.DialContext\" rel=\"nofollow noreferrer\"><code>DialContext</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 8770689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503904e5ebb1cde58bedf8e83355cc0f?s=128&d=identicon&r=PG&f=1", "display_name": "alex4532", "link": "https://stackoverflow.com/users/8770689/alex4532"}, "is_accepted": false, "score": 0, "last_activity_date": 1558005630, "creation_date": 1558005630, "answer_id": 56167377, "question_id": 56024765, "link": "https://stackoverflow.com/questions/56024765/getting-this-error-while-importing-package-in-go-any-idea-how-to-resolve-this/56167377#56167377", "title": "getting this error while importing package in go any idea how to resolve this?", "body": "<p>For those not familiar with go (like me), a very temporary workaround (until there is a fix for <a href=\"https://github.com/docker/go-connections/issues/60\" rel=\"nofollow noreferrer\">https://github.com/docker/go-connections/issues/60</a>) would be:</p>\n\n<pre><code>cd ~/go/src/github.com/docker/go-connections\ngit checkout 9885905e989f4d8cc9f42d3549c5be9c27e4460d\ngo get github.com/docker/go-connections/sockets\ncd -\n</code></pre>\n\n<p>Cheers</p>\n"}], "owner": {"reputation": 190, "user_id": 3156262, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000323467588/picture?type=large", "display_name": "user3156262", "link": "https://stackoverflow.com/users/3156262/user3156262"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1558005630, "creation_date": 1557238968, "last_edit_date": 1557252352, "question_id": 56024765, "link": "https://stackoverflow.com/questions/56024765/getting-this-error-while-importing-package-in-go-any-idea-how-to-resolve-this", "title": "getting this error while importing package in go any idea how to resolve this?", "body": "<p>When I run the following:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>go get github.com/docker/go-plugins-helpers/volume\n</code></pre>\n\n<p>It prints:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code> github.com/docker/go-connections/sockets\n\n../github.com/docker/go-connections/sockets/sockets.go:35:26: dialer.DialContext undefined (type proxy.Dialer has no field or method DialContext)\n\n../github.com/docker/go-connections/sockets/sockets_unix.go:24:28: undefined: context\n</code></pre>\n"}, {"tags": ["json", "date", "go", "go-echo"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 3, "creation_date": 1557235861, "post_id": 56023335, "comment_id": 98691257, "body": "you will need a custom json.Unmarshaler to extract the correct time.  There is no way for the default unmarshaler to know your time format. I assume you are <code>YYYY-MM-DD</code>, but it could be <code>YYYY-DD-MM</code>. json.Unmarshal expects time format <code>time.RFC3339</code>"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 2, "creation_date": 1557235976, "post_id": 56023335, "comment_id": 98691338, "body": "see this <a href=\"https://stackoverflow.com/a/25088283/1218512\">answer</a> on how to create a CustomTime type to handle custom formats."}, {"owner": {"reputation": 1550, "user_id": 3079776, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/NmNaz.png?s=128&g=1", "display_name": "M14", "link": "https://stackoverflow.com/users/3079776/m14"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557239551, "post_id": 56023335, "comment_id": 98693577, "body": "I&#39;ll try and let you know"}], "answers": [{"comments": [{"owner": {"reputation": 1550, "user_id": 3079776, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/NmNaz.png?s=128&g=1", "display_name": "M14", "link": "https://stackoverflow.com/users/3079776/m14"}, "edited": false, "score": 0, "creation_date": 1557293681, "post_id": 56026123, "comment_id": 98710987, "body": "This is working but in my mongo it is saving as <code>&quot;start_date&quot; : {                 &quot;time&quot; : ISODate(&quot;2019-01-02T00:00:00.000Z&quot;)             },             &quot;end_date&quot; : {                 &quot;time&quot; : ISODate(&quot;2020-05-06T00:00:00.000Z&quot;)             },</code>"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 2, "last_activity_date": 1557243521, "creation_date": 1557243521, "answer_id": 56026123, "question_id": 56023335, "link": "https://stackoverflow.com/questions/56023335/request-body-date-parsing-issue/56026123#56026123", "title": "Request body date parsing issue", "body": "<p>You need to have a custom time type in order to unmarshal custom time format:</p>\n\n<pre><code>type Datetime struct {\n    time.Time\n}\n\nfunc (t *Datetime) UnmarshalJSON(input []byte) error {\n    strInput := strings.Trim(string(input), `\"`)\n    newTime, err := time.Parse(\"2006-01-02\", strInput)\n    if err != nil {\n        return err\n    }\n\n    t.Time = newTime\n    return nil\n}\n\nVendorAgreement struct {\n    ID                   primitive.ObjectID   `json:\"id\" bson:\"_id\"`\n    StartDate            Datetime             `json:\"start_date,date\" bson:\"start_date\"`\n    EndDate              Datetime             `json:\"end_date,date\" bson:\"end_date\"`\n    CommissionPercentage float32              `json:\"commission_percentage\" bson:\"commission_percentage\"`\n    Status               int                  `json:\"status\" bson:\"status\"`\n    CreatedDate          Datetime             `json:\"created_date\" bson:\"created_date\"`\n    Media                VendorAgreementMedia `json:\"media\" bson:\"media\"`\n}\n\nVendorAgreementMedia struct {\n    MediaId     primitive.ObjectID `json:\"mediaId\" bson:\"_id\"`\n    FileName    string             `json:\"file_name\" bson:\"file_name\"`\n    SourcePath  string             `json:\"source_path\" bson:\"source_path\"`\n    CreatedDate Datetime           `json:\"created_date\" bson:\"created_date\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5202444, "user_type": "registered", "profile_image": "https://graph.facebook.com/520516124765591/picture?type=large", "display_name": "Jaskirat Singh", "link": "https://stackoverflow.com/users/5202444/jaskirat-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557298636, "creation_date": 1557298636, "answer_id": 56035130, "question_id": 56023335, "link": "https://stackoverflow.com/questions/56023335/request-body-date-parsing-issue/56035130#56035130", "title": "Request body date parsing issue", "body": "<p>you can parse your date returned by mongo like this:</p>\n\n<pre><code>layout := \"2006-01-02T15:04:05.999999999Z07:00\"\nstr := \"2019-01-02T00:00:00.000Z\"\nt, err := time.Parse(layout, str)\nif err != nil {\n    fmt.Println(err)\n} else {\n    fmt.Println(t)\n}\n</code></pre>\n"}], "owner": {"reputation": 1550, "user_id": 3079776, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/NmNaz.png?s=128&g=1", "display_name": "M14", "link": "https://stackoverflow.com/users/3079776/m14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557298636, "creation_date": 1557234452, "last_edit_date": 1557235580, "question_id": 56023335, "link": "https://stackoverflow.com/questions/56023335/request-body-date-parsing-issue", "title": "Request body date parsing issue", "body": "<p>I have a strange issue. I'm using <code>echo</code> package for routing. While I'm decoding <code>json</code> to <code>struct</code> I'm getting error <code>parsing time \\\"\\\"2019-01-02\\\"\\\" as \\\"\\\"2006-01-02T15:04:05Z07:00\\\"\\\": cannot parse \\\"\\\"\\\" as \\\"T\\\"\"</code></p>\n\n<p><strong>my structs</strong></p>\n\n<pre><code>VendorAgreement struct {\n    ID                   primitive.ObjectID   `json:\"id\" bson:\"_id\"`\n    StartDate            time.Time            `json:\"start_date,date\" bson:\"start_date\"`\n    EndDate              time.Time            `json:\"end_date,date\" bson:\"end_date\"`\n    CommissionPercentage float32              `json:\"commission_percentage\" bson:\"commission_percentage\"`\n    Status               int                  `json:\"status\" bson:\"status\"`\n    CreatedDate          time.Time            `json:\"created_date\" bson:\"created_date\"`\n    Media                VendorAgreementMedia `json:\"media\" bson:\"media\"`\n}\n\nVendorAgreementMedia struct {\n    MediaId     primitive.ObjectID `json:\"mediaId\" bson:\"_id\"`\n    FileName    string             `json:\"file_name\" bson:\"file_name\"`\n    SourcePath  string             `json:\"source_path\" bson:\"source_path\"`\n    CreatedDate time.Time          `json:\"created_date\" bson:\"created_date\"`\n}\n</code></pre>\n\n<p><strong>My decoding step</strong></p>\n\n<pre><code>var agreement VendorAgreement\nerr = json.NewDecoder(c.Request().Body).Decode(&amp;agreement)\n</code></pre>\n\n<p><strong>request body</strong></p>\n\n<pre><code> {\n    \"start_date\":\"2019-01-02\",\n    \"end_date\":\"2020-05-06\",\n    \"commission_percentage\":10,\n    \"media\":{\n        \"mediaId\":\"5cd1644cc57849f0761632b5\"\n    }\n}\n</code></pre>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 21857, "user_id": 842075, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9e1e6d890077d7e1199084462fd0a5b1?s=128&d=identicon&r=PG", "display_name": "Molecular Man", "link": "https://stackoverflow.com/users/842075/molecular-man"}, "edited": false, "score": 0, "creation_date": 1557231533, "post_id": 56022163, "comment_id": 98688608, "body": "there is an example in the tests <a href=\"https://github.com/olivere/elastic/blob/36c8ae535866bc295bfbb74de8ddd36fd91984be/suggester_completion_test.go#L90-L96\" rel=\"nofollow noreferrer\">github.com/olivere/elastic/blob/&hellip;</a>. Is it what you are looking for?"}, {"owner": {"reputation": 11, "user_id": 8457481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f267166c77ba9d8b2c0eef24e3b462?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya K", "link": "https://stackoverflow.com/users/8457481/aditya-k"}, "reply_to_user": {"reputation": 21857, "user_id": 842075, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9e1e6d890077d7e1199084462fd0a5b1?s=128&d=identicon&r=PG", "display_name": "Molecular Man", "link": "https://stackoverflow.com/users/842075/molecular-man"}, "edited": false, "score": 0, "creation_date": 1557298329, "post_id": 56022163, "comment_id": 98712653, "body": "Thank you. I overlooked this section. It was exactly what I was looking for!"}], "owner": {"reputation": 11, "user_id": 8457481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f267166c77ba9d8b2c0eef24e3b462?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya K", "link": "https://stackoverflow.com/users/8457481/aditya-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557298535, "creation_date": 1557230458, "question_id": 56022163, "link": "https://stackoverflow.com/questions/56022163/what-argument-to-pass-in-contextqueries-for-completion-suggester-in-elasticsearc", "title": "What argument to pass in ContextQueries for Completion Suggester in Elasticsearch for Go?", "body": "<p>I am trying to add a context for my completion suggester in elasticsearch for Go. I am using Olivere's elasticsearch library for Go but I am unable to determine the argument that has to be passed to <em><strong>ContextQueries()</strong></em>. I can see it requires a type <em><strong>SuggesterContextQuery</strong></em> but I am unsure of how to make one.</p>\n\n<p>I tried going through the <a href=\"https://godoc.org/github.com/olivere/elastic#CompletionSuggester\" rel=\"nofollow noreferrer\">docs</a> but it is still unclear to me.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (q *CompletionSuggester) ContextQueries(queries ...SuggesterContextQuery) *CompletionSuggester {\n    q.contextQueries = append(q.contextQueries, queries...)\n    return q\n}\n</code></pre>\n\n<pre><code>type SuggesterContextQuery interface {\n    Source() (interface{}, error)\n}\n</code></pre>\n\n<p>Here's my code</p>\n\n<pre><code>sugg := \"sticker-suggest\"\ntagSuggester := elastic.NewCompletionSuggester(sugg).Fuzziness(0).Text(term).Field(\"tags\").SkipDuplicates(true)\n\nsearchSource := elastic.NewSearchSource().\n    Suggester(tagSuggester).\n    FetchSource(false).\n    TrackScores(true)\n\nsearchResult, err := client.Search().\n    Index(index).\n    Type(Type).\n    SearchSource(searchSource).\n    Do(ctx)\n</code></pre>\n\n<p>How can I add a context for my completion suggester?</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 83063, "user_id": 2310830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6rM1.png?s=128&g=1", "display_name": "RiggsFolly", "link": "https://stackoverflow.com/users/2310830/riggsfolly"}, "edited": false, "score": 1, "creation_date": 1557228909, "post_id": 56021626, "comment_id": 98687081, "body": ":) I know you are chasing your 100K but this one has a well used Dup"}], "tags": [], "owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "is_accepted": true, "score": 2, "last_activity_date": 1557228912, "last_edit_date": 1557228912, "creation_date": 1557228684, "answer_id": 56021626, "question_id": 56021583, "link": "https://stackoverflow.com/questions/56021583/what-causes-sql-syntax-error-1064-in-this-code/56021626#56021626", "title": "What causes SQL syntax error 1064 in this code?", "body": "<p>miisng quote around string values </p>\n\n<pre><code> INSERT INTO `users` (`update`, `name`, `dob`, `status`,`avatar`,\n        `province`, `city`, `district`, `village`) \nVALUES (1557227442, 'Cortez Mante', 702086400, 1, 'http://lorempixel.com/150/150/', 'Provinsi', 'Kota', 'Kecamatan', 'Kelurahan')\n</code></pre>\n\n<p>your contents  string </p>\n\n<pre><code> 'Cortez Mante' \n\n 'http://lorempixel.com/150/150/'\n\n'Provinsi', 'Kota', 'Kecamatan', 'Kelurahan'\n</code></pre>\n\n<p>and you should close each single statements  with semicolon </p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `users` (\n`id` INT UNSIGNED NOT NULL AUTO_INCREMENT,\n`update` INT(11),\n`name` VARCHAR(255),\n`dob` INT(11),\n`status` INT,\n`avatar` VARCHAR(255),\n`province` VARCHAR(255),\n`city` VARCHAR(255),\n`district` VARCHAR(255),\n`village` VARCHAR(255),\nCONSTRAINT `pk_users` PRIMARY KEY (id)\n)\n;\n\n INSERT INTO `users` (`update`, `name`, `dob`, `status`,`avatar`,\n        `province`, `city`, `district`, `village`) \nVALUES (1557227442, 'Cortez Mante', 702086400, 1, 'http://lorempixel.com/150/150/', 'Provinsi', 'Kota',\n     'Kecamatan', 'Kelurahan')\n;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 4177704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3427ad4ec3e505bbe3773ed4620b84?s=128&d=identicon&r=PG&f=1", "display_name": "Afzal Patel", "link": "https://stackoverflow.com/users/4177704/afzal-patel"}, "is_accepted": false, "score": 1, "last_activity_date": 1557228704, "creation_date": 1557228704, "answer_id": 56021633, "question_id": 56021583, "link": "https://stackoverflow.com/questions/56021583/what-causes-sql-syntax-error-1064-in-this-code/56021633#56021633", "title": "What causes SQL syntax error 1064 in this code?", "body": "<p>Add var char values in the single code this will work</p>\n\n<p><code>province</code>, <code>city</code>, <code>district</code>, <code>village</code>) VALUES (1557227442, 'Cortez Mante', 702086400, 1, '<a href=\"http://lorempixel.com/150/150/\" rel=\"nofollow noreferrer\">http://lorempixel.com/150/150/</a>', 'Provinsi', 'Kota', 'Kecamatan', 'Kelurahan');</p>\n"}], "owner": {"reputation": 31, "user_id": 5810812, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206951902693399/picture?type=large", "display_name": "Nasser Maronie", "link": "https://stackoverflow.com/users/5810812/nasser-maronie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "closed_date": 1557228838, "accepted_answer_id": 56021626, "answer_count": 2, "score": 0, "last_activity_date": 1557228979, "creation_date": 1557228492, "last_edit_date": 1557228979, "question_id": 56021583, "link": "https://stackoverflow.com/questions/56021583/what-causes-sql-syntax-error-1064-in-this-code", "closed_reason": "Duplicate", "title": "What causes SQL syntax error 1064 in this code?", "body": "<p>I'm trying to insert data into my new table, and I got sql error 1064.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE IF NOT EXISTS `users` (\n`id` INT UNSIGNED NOT NULL AUTO_INCREMENT,\n`update` INT(11),\n`name` VARCHAR(255),\n`dob` INT(11),\n`status` INT,\n`avatar` VARCHAR(255),\n`province` VARCHAR(255),\n`city` VARCHAR(255),\n`district` VARCHAR(255),\n`village` VARCHAR(255),\nCONSTRAINT `pk_users` PRIMARY KEY (id))\n</code></pre>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO `users` (`update`, `name`, `dob`, `status`,`avatar`,\n`province`, `city`, `district`, `village`) VALUES (1557227442, Cortez Mante, 702086400, 1, http://lorempixel.com/150/150/, Provinsi, Kota, Kecamatan, Kelurahan)\n</code></pre>\n\n<p>And I got error:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ panic: Error 1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Mante, 702086400, 1, http://lorempixel.com/150/150/, Provinsi, Kota, Kecamatan, ' at line 1\n</code></pre>\n\n<p>I don't know exactly what cause the error. can anyone help me with this ?</p>\n\n<p>btw, I am using Golang for crating and inserting to this table.</p>\n\n<p>this is how I connect to mysql and create the table through Go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func connect() (db *sql.DB) {\n  dbDriver := \"mysql\"\n  dbUser := \"root\"\n  dbPass := \"password\"\n  dbName := \"user\"\n  db, err := sql.Open(dbDriver, dbUser+\":\"+dbPass+\"@/\"+dbName)\n\n  if err != nil {\n      panic(err.Error())\n  }\n\n  return db\n}\n\nfunc create_table() {\n  db := connect()\n  sql := fmt.Sprintf(\n    \"CREATE TABLE IF NOT EXISTS `users` (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)\",\n    \"`id` INT UNSIGNED NOT NULL AUTO_INCREMENT\",\n    \"`update` INT(11)\",\n    \"`name` VARCHAR(255)\",\n    \"`dob` INT(11)\",\n    \"`status` INT\",\n    \"`avatar` VARCHAR(255)\",\n    \"`province` VARCHAR(255)\",\n    \"`city` VARCHAR(255)\",\n    \"`district` VARCHAR(255)\",\n    \"`village` VARCHAR(255)\",\n    \"CONSTRAINT `pk_users` PRIMARY KEY (id)\")\n\n  fmt.Println(sql)\n\n  insert, err := db.Query(sql)\n  if err != nil {\n    panic(err.Error())\n  }\n\n  defer insert.Close()\n}\n</code></pre>\n\n<p>this is how I insert the data:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func AddUser(u user.User) {\n  db := connect()\n\n  insert_users := \"INSERT INTO `users` (`update`, `name`, `dob`, `status`, `avatar`, `province`, `city`, `district`, `village`)\"\n  values_users := fmt.Sprintf(\n    \"VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)\",\n    strconv.Itoa(u.Update), u.Name, strconv.Itoa(u.Dob), strconv.Itoa(u.Status), u.Avatar, u.Province, u.City, u.District, u.Village)\n\n  sql := insert_users + \" \" + values_users\n\n  fmt.Println(sql)\n\n  insert, err := db.Query(sql)\n\n  if err != nil {\n    panic(err.Error())\n  } else {\n    fmt.Println(\"success add user:\", u.Id)\n  }\n\n  defer insert.Close()\n}\n</code></pre>\n"}, {"tags": ["http", "go", "proxy", "self-signed"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10684813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a52beef370c9f21f794e5d6b0a96698?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkylo", "link": "https://stackoverflow.com/users/10684813/darkskylo"}, "edited": false, "score": 0, "creation_date": 1557909185, "post_id": 56027168, "comment_id": 98919639, "body": "it is not working... I am getting the same error message: &quot;x509: certificate signed by unknown authority&quot;"}], "tags": [], "owner": {"reputation": 1391, "user_id": 240750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7aec284f4746da267863b4f3363a30f?s=128&d=identicon&r=PG", "display_name": "Cytown", "link": "https://stackoverflow.com/users/240750/cytown"}, "is_accepted": false, "score": 0, "last_activity_date": 1557247665, "creation_date": 1557247665, "answer_id": 56027168, "question_id": 56021457, "link": "https://stackoverflow.com/questions/56021457/self-signed-proxy-client/56027168#56027168", "title": "Self signed proxy client", "body": "<p>add this to http.Transport:</p>\n\n<pre><code>TLSNextProto: make(map[string]func(authority string, c *tls.Conn) http.RoundTripper),\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10684813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a52beef370c9f21f794e5d6b0a96698?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkylo", "link": "https://stackoverflow.com/users/10684813/darkskylo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557247665, "creation_date": 1557227996, "question_id": 56021457, "link": "https://stackoverflow.com/questions/56021457/self-signed-proxy-client", "title": "Self signed proxy client", "body": "<p>I need to create a function that returns a self signed proxy http.Client and I couldn't find any working solution. </p>\n\n<p>I am attaching my current code that doesn't seem to be working.</p>\n\n<pre><code>func CreateProxyClient(server string,serverProxy string, sid string, portProxy int) (*Client, error) {\n    http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config{InsecureSkipVerify: true}\n\n    proxyURL, _ := url.Parse(\"http://\" + serverProxy+\":\"+strconv.Itoa(portProxy) )\n    http.DefaultTransport = &amp;http.Transport{\n        Proxy: http.ProxyURL(proxyURL),\n    }\n\n    var netClient = &amp;http.Client{\n        Timeout: time.Second * 1,\n    }\n\n    resp, _ := http.Get(\"http://\"+server+\":443\")\n    fmt.Printf(\"%d\",resp.StatusCode)\n    return &amp;Client{netClient, server, sid, \"\", \"\"}, nil\n}\n</code></pre>\n\n<p>I</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1557224927, "post_id": 56020543, "comment_id": 98684902, "body": "as far as i am aware go replaces // with / in url&#39;s, so y0u can not have an empty store_id"}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 1, "creation_date": 1557226558, "post_id": 56020543, "comment_id": 98685786, "body": "If you know the pattern for <code>store_id</code>, you can add its regex. For example, if it contains only numbers, then you can change the path to <code>&#47;api&#47;store&#47;{store_id:\\d+}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "is_accepted": true, "score": 2, "last_activity_date": 1557241261, "creation_date": 1557241261, "answer_id": 56025467, "question_id": 56020543, "link": "https://stackoverflow.com/questions/56020543/golang-gorilla-sends-301-for-urls/56025467#56025467", "title": "Golang Gorilla Sends 301 For &quot;//&quot; URLs", "body": "<p>By default mux will clean the URL. You can set the <a href=\"https://godoc.org/github.com/gorilla/mux#Router.SkipClean\" rel=\"nofollow noreferrer\"><code>router.SkipClean(true)</code></a> parameter to avoid that.</p>\n\n<blockquote>\n  <p>When true, if the route path is \"/path//to\", it will remain with the double slash. This is helpful if you have a route like: /fetch/<a href=\"http://xkcd.com/534/\" rel=\"nofollow noreferrer\">http://xkcd.com/534/</a></p>\n</blockquote>\n"}], "owner": {"reputation": 1488, "user_id": 1388987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3161648292c8c3d5867004cdb8434536?s=128&d=identicon&r=PG", "display_name": "Fei", "link": "https://stackoverflow.com/users/1388987/fei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 56025467, "answer_count": 1, "score": 3, "last_activity_date": 1557241261, "creation_date": 1557224805, "question_id": 56020543, "link": "https://stackoverflow.com/questions/56020543/golang-gorilla-sends-301-for-urls", "title": "Golang Gorilla Sends 301 For &quot;//&quot; URLs", "body": "<p>I have two route configured as following </p>\n\n<ul>\n<li><code>GET /api/store/{store_id}/books</code> </li>\n<li><code>GET /api/store/{store_id}</code></li>\n</ul>\n\n<p>When an API call comes for the first URL without <code>{store_id}</code> parameter, like <code>/api/store//books</code>, Gorilla would somehow send a <code>301 /api/store/books</code> to client. This is causing me problem because it acutally matched the second route. Gorilla would treat <code>books</code> as the <code>{store_id}</code> parameter.</p>\n\n<p>How do I configure Gorilla to return 404 or other error code when receiving <code>//</code> in URLs?</p>\n\n<p>I am using Gorilla v1.7.0.</p>\n"}, {"tags": ["sql", "sqlite", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557225505, "post_id": 56019945, "comment_id": 98685207, "body": "You could first <code>SELECT</code> the server record from the db using the <code>requestID</code>, then bind that existing server with <code>c.Bind</code> which will update only those fields that are provided in the json. With that you can now use a simple <code>UPDATE</code> query where you set all the columns, those that weren&#39;t changed by <code>c.Bind</code> will just be set to their old value and those that were changed will be set to the new value."}, {"owner": {"reputation": 378, "user_id": 8980015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b9ba86fe32c5b8a4fecd2389f4e9278?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/8980015/stefan"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557228680, "post_id": 56019945, "comment_id": 98686958, "body": "@mkopriva Thank you i clearly understand what are you trying to say. I will need some time tho because i don&#39;t quite have the code in my head yet."}], "owner": {"reputation": 378, "user_id": 8980015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b9ba86fe32c5b8a4fecd2389f4e9278?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/8980015/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557222796, "creation_date": 1557222796, "question_id": 56019945, "link": "https://stackoverflow.com/questions/56019945/how-can-i-tell-the-patch-method-which-field-i-want-to-update", "title": "How can i tell the PATCH Method which field i want to update", "body": "<p>I'm working on a simple REST API and I'm having troubles with the <code>PATCH</code> method. I don't know how can i tell the method and the query which fields i want to update(for example which fields are passed as JSON) in the database. Here is what i have so far.</p>\n\n<pre><code>func PatchServer(c echo.Context) error {\n    patchedServer := new(structs.Server)\n    requestID := c.Param(\"id\")\n    if err := c.Bind(patchedServer); err != nil {\n        return err\n    }\n        sql := \"UPDATE servers SET server_name = CASE WHEN ? IS NOT NULL THEN ? END WHERE id = ?\"\n        stmt, err := db.Get().Prepare(sql)\n    if err != nil {\n        panic(err)\n    }\n    _, err2 := stmt.Exec(patchedServer.Name, patchedServer.Name, requestID)\n    if err2 != nil {\n        panic(err2)\n    }\n    fmt.Println(patchedServer.ID, patchedServer.Name, patchedServer.Components)\n    fmt.Println(\"Requested id: \", requestID)\n    return c.JSON(http.StatusOK, \"Patched!\")\n    }\n</code></pre>\n"}, {"tags": ["rest", "go"], "comments": [{"owner": {"reputation": 782, "user_id": 7071577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b816a812978bc140df497f0fbdd49c0?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Gonzalez", "link": "https://stackoverflow.com/users/7071577/carlos-gonzalez"}, "edited": false, "score": 4, "creation_date": 1557221679, "post_id": 56019549, "comment_id": 98683050, "body": "<a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557237214, "post_id": 56019549, "comment_id": 98692091, "body": "Have you tried anything or done a basic web search? Accessing REST APIs is a very common use case and there is plentiful documentation available."}, {"owner": {"reputation": 1083, "user_id": 854190, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/caaca452699fcefd23178f439b8478f4?s=128&d=identicon&r=PG", "display_name": "Venkat Teki", "link": "https://stackoverflow.com/users/854190/venkat-teki"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557238207, "post_id": 56019549, "comment_id": 98692688, "body": "@Adrian I know the net/http route, but wondering if there is a third party library on top of that"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557238406, "post_id": 56019549, "comment_id": 98692805, "body": "Wondering about third-party libraries is off-topic for SO: <i>Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam.</i>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557238462, "post_id": 56019549, "comment_id": 98692834, "body": "That said, do you have something against <code>net&#47;http</code>? There&#39;s no real reason to put anything on top of it."}, {"owner": {"reputation": 1083, "user_id": 854190, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/caaca452699fcefd23178f439b8478f4?s=128&d=identicon&r=PG", "display_name": "Venkat Teki", "link": "https://stackoverflow.com/users/854190/venkat-teki"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557239363, "post_id": 56019549, "comment_id": 98693447, "body": "@Adrian Thanks for the guideline."}], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 2931316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOHqU.jpg?s=128&g=1", "display_name": "M Ashraful A", "link": "https://stackoverflow.com/users/2931316/m-ashraful-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1557222347, "creation_date": 1557222347, "answer_id": 56019813, "question_id": 56019549, "link": "https://stackoverflow.com/questions/56019549/invoking-a-rest-api-written-in-java-from-go-code/56019813#56019813", "title": "Invoking a rest API written in java from go code", "body": "<p>Golang comes with native <code>\"net/http\"</code> package which you can use to request REST APIs</p>\n"}], "owner": {"reputation": 1083, "user_id": 854190, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/caaca452699fcefd23178f439b8478f4?s=128&d=identicon&r=PG", "display_name": "Venkat Teki", "link": "https://stackoverflow.com/users/854190/venkat-teki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56019813, "answer_count": 1, "score": -1, "last_activity_date": 1557238244, "creation_date": 1557221350, "last_edit_date": 1557238244, "question_id": 56019549, "link": "https://stackoverflow.com/questions/56019549/invoking-a-rest-api-written-in-java-from-go-code", "title": "Invoking a rest API written in java from go code", "body": "<p>I am newbie to Golang.\nI am writing a go client, in which I am trying to invoke a bunch of REST APIs in server</p>\n\n<p>Which rest clients/libraries should be used for this use case</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "code-coverage"], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 2, "last_activity_date": 1557216261, "creation_date": 1557216261, "answer_id": 56018085, "question_id": 56017696, "link": "https://stackoverflow.com/questions/56017696/problem-when-installing-the-cover-package-for-golang/56018085#56018085", "title": "Problem when installing the cover package for golang", "body": "<p>The correct path is:</p>\n\n<pre><code>go get golang.org/x/tools/cmd/cover\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11458554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94ccf41ce22358dc7b3a036fc74b709?s=128&d=identicon&r=PG&f=1", "display_name": "testBig", "link": "https://stackoverflow.com/users/11458554/testbig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557216648, "creation_date": 1557214657, "last_edit_date": 1557216648, "question_id": 56017696, "link": "https://stackoverflow.com/questions/56017696/problem-when-installing-the-cover-package-for-golang", "title": "Problem when installing the cover package for golang", "body": "<p>I have some code. \nBut when \nI try run cover test and have response: </p>\n\n<pre><code>'go get -u github.com/gregoryv/uncover/...\ngo test -coverprofile /tmp/c.out\nuncover /tmp/c.out'\n</code></pre>\n\n<p>I try install cover package:</p>\n\n<pre><code>go get code.google.com/p/go.tools/cmd/cover\n</code></pre>\n\n<p>but get error</p>\n\n<pre><code>package code.google.com/p/go.tools/cmd/cover: unrecognized import path \"code.google.com/p/go.tools/cmd/cover\" (parse https://code.google.com/p/go.tools/cmd/cover?go-get=1: no go-import meta tags (meta tag github.com/golang/go did not match import path code.google.com/p/go.tools/cmd/cover))\n</code></pre>\n\n<p>System: Ubuntu 18.04</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1557214764, "last_edit_date": 1557214764, "creation_date": 1557214340, "answer_id": 56017624, "question_id": 56017558, "link": "https://stackoverflow.com/questions/56017558/is-there-a-using-in-golang/56017624#56017624", "title": "Is there a &quot;using&quot; in golang?", "body": "<p>This is possible using the \"dot\" import. Use the <code>.</code> as the package name in the import declaration, and so you can refer to the package's exported identifiers as if they would have been declared in the package you import them.</p>\n\n<p>Quoting from <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"noreferrer\">Spec: Import declarations:</a></p>\n\n<blockquote>\n  <p>If an explicit period (<code>.</code>) appears instead of a name, all the package's exported identifiers declared in that package's <a href=\"https://golang.org/ref/spec#Blocks\" rel=\"noreferrer\">package block</a> will be declared in the importing source file's file block and must be accessed without a qualifier.</p>\n</blockquote>\n\n<p>This is how your example would look like:</p>\n\n<pre><code>package myhighlevellibrary\n\nimport . \"mypackage\"\n\nfunc Foo() *SomeType {\n    a := Somefunction()\n    b := SomeFactoryMethod(a)\n    return b\n}\n</code></pre>\n\n<p>Here's a runnable <a href=\"https://play.golang.org/p/e2HwxiqZe4E\" rel=\"noreferrer\">Playground example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    . \"fmt\"\n    . \"reflect\"\n)\n\nfunc main() {\n    Println(TypeOf(\"text\")) // short for: fmt.Println(reflect.TypeOf(\"text\"))\n}\n</code></pre>\n\n<p>See related / possible duplicate: <a href=\"https://stackoverflow.com/questions/38904423/whats-cs-using-equivalent-in-golang/38910838#38910838\">What&#39;s C++&#39;s `using` equivalent in golang</a></p>\n"}], "owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1557215390, "accepted_answer_id": 56017624, "answer_count": 1, "score": 0, "last_activity_date": 1557214764, "creation_date": 1557214042, "question_id": 56017558, "link": "https://stackoverflow.com/questions/56017558/is-there-a-using-in-golang", "closed_reason": "Duplicate", "title": "Is there a &quot;using&quot; in golang?", "body": "<p>Is there a way to use the names in a golang import without specifying the package name each time?\nIn C++ I can \"use\" a nampespace.\nIn Java, when I import something, the namespace is automatically used.</p>\n\n<p>Sometimes I have a high level helper library, who's main purpose is using another pacakge, and providing some high level wrappers for it. It seems overly verbose to keep using the pacakge name over and over in the code. </p>\n\n<pre><code>package myhighlevellibrary\nimport \"mypackage\"\n\nfunc Foo() *mypackage.SomeType{\n  a:=mypackage.Somefunction();\n  b:=mypackage.SomeFactoryMethod(a);\n  return b\n}\n</code></pre>\n\n<p>Can I somehow avoid writing the \"mypackage\" literal so many times in my code? It gets much worse as my library grows larger...</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 5, "creation_date": 1557212713, "post_id": 56017181, "comment_id": 98678226, "body": "note that binary only packages will no longer be supported in go version 1.13."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6786963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461ce300ea533bd628d8e0f273dd055?s=128&d=identicon&r=PG&f=1", "display_name": "Sriman Narayana", "link": "https://stackoverflow.com/users/6786963/sriman-narayana"}, "edited": false, "score": 0, "creation_date": 1557731863, "post_id": 56017446, "comment_id": 98848473, "body": "Thanks for the reply, i would like to know the alternatives on how a package is distributed to the enterprise customers. I understood that we didn&#39;t have any centralized go repository where we place the package code and distribute similar to pypi(python)."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 11, "user_id": 6786963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461ce300ea533bd628d8e0f273dd055?s=128&d=identicon&r=PG&f=1", "display_name": "Sriman Narayana", "link": "https://stackoverflow.com/users/6786963/sriman-narayana"}, "edited": false, "score": 0, "creation_date": 1557732854, "post_id": 56017446, "comment_id": 98848896, "body": "@SrimanNarayana You can ship the source code. Or you can host it somewhere, e.g. in your git repo and let your customer access your git if they provide the appropriate credentials (which is a git issue only, unrelated to Go)."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1594743797, "last_edit_date": 1594743797, "creation_date": 1557213573, "answer_id": 56017446, "question_id": 56017181, "link": "https://stackoverflow.com/questions/56017181/how-to-distribute-binary-only-packages-for-different-go-versions/56017446#56017446", "title": "How to distribute binary-only packages for different go versions", "body": "<blockquote>\n<p>Is it possible to do this [distribute a binary-only package for different golang versions?</p>\n</blockquote>\n<p>No.</p>\n"}], "owner": {"reputation": 11, "user_id": 6786963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461ce300ea533bd628d8e0f273dd055?s=128&d=identicon&r=PG&f=1", "display_name": "Sriman Narayana", "link": "https://stackoverflow.com/users/6786963/sriman-narayana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56017446, "answer_count": 1, "score": -2, "last_activity_date": 1594743797, "creation_date": 1557212455, "question_id": 56017181, "link": "https://stackoverflow.com/questions/56017181/how-to-distribute-binary-only-packages-for-different-go-versions", "title": "How to distribute binary-only packages for different go versions", "body": "<p>I am planning to distribute a binary-only package for different golang versions. Is it possible to do this?</p>\n"}, {"tags": ["go", "build"], "comments": [{"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 1, "creation_date": 1557212249, "post_id": 56017047, "comment_id": 98677973, "body": "I think you read something wrong there, go hasn&#39;t changed the <code>$GOPATH&#47;src&#47;repo</code> pattern. The repo you&#39;ve mentioned simple states that the code shouldn&#39;t have a <code>src</code> directory inside of it, as most java based projects do. Form the article <b>Don&#39;t confuse the project level /src directory with the /src directory Go uses for its workspaces</b>"}, {"owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1557213309, "post_id": 56017047, "comment_id": 98678542, "body": "@ishaan I still don&#39;t get it. When I wanted to use my project locally: It had a &quot;src&quot; directory inside it. So I could set my $GOPATH to point at my project. However, now  that the project has no &quot;src&quot; inside it, I can no longer set my $GOPATH to point at it. (because $GOPATH expects a src directory...). I might mention that I want to work &quot;locally&quot;. I am not committing my code to github.com. I want to use the latest changes on my HDD. (I am just creating debug-builds on my local dev machine [before I push to github] )"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1557213840, "post_id": 56017047, "comment_id": 98678817, "body": "There simply is <i>no</i> directory structure mandated, needed or recommended. Just use what fits your need (only thing: a folder named <code>internal</code> is for &quot;internal packages only). You have to choose between GOPATH builds and module builds and that is is. How you cram your packages into the filesystem is of no concern. Just stick to How to Write Go Code and you&#39;ll be fine."}, {"owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557214356, "post_id": 56017047, "comment_id": 98679097, "body": "@Volker that is not true. I tried to rename &quot;src&quot; to &quot;someotherdir&quot;. Then I used the same $GOPATH approach, and it was definetly looking for $GOPATH/src. It was not looking for $GOPATH/someotherdir. So a directory structure is definitly mandated when I use the $GOPATH approach for builds. HINT: I am well aware that I need to change my approach to building, and that is what this question is about: I am looking for an example on what a build command might look like."}, {"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 1, "creation_date": 1557215024, "post_id": 56017047, "comment_id": 98679457, "body": "Right, so you need $GOPATH/src but you don&#39;t need to point it to your code directory, instead can use the <code>&#47;path&#47;to&#47;gohome</code> and have multiple repositories there. But what you were doing is also correct, albeit overkill. The article you&#39;re referencing isn&#39;t saying to not do that, it&#39;s saying you avoid using src in your codebase just because you did in in Java."}, {"owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 0, "creation_date": 1557215988, "post_id": 56017047, "comment_id": 98679933, "body": "@ishaan It&#39;s not about correctness (or Java habits). It&#39;s about go. I <i>want</i> to use this new project structure. But I cannot get it to build or run. I have not found any examples of the build commands for this new structure online. I do not understand how I can go from having a project structure that does not have an &quot;src&quot; path, to an &quot;src&quot; path magically appearing in my $GOPATH after I build. What is this <code>&#47;path&#47;to&#47;gohome</code> that you mention? I know only of $GOPATH and $GOROOT. Not sure what a &quot;go home&quot; would be..."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1557217461, "post_id": 56017047, "comment_id": 98680635, "body": "@eshalev Sorry, but you are wrong. For GOPATH builds you code must live under $GOPATH/src but that is not the directory structure we are talking about here. GOPATH builds: Your code lives under $GOPATH/src and where is just a matter of taste (and tooling like go get)."}, {"owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557218389, "post_id": 56017047, "comment_id": 98681135, "body": "@Volker, this phillosophical discussion is just causing more confusion. I do not want to use the old project structure. I want to use the new one. Can someone supply/link a material (non phillosophical) example of the commands to build and run such a project? A picture is worth a thousand words!"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1557218789, "post_id": 56017047, "comment_id": 98681380, "body": "@eshalev You write &quot;I want to use the new on [project structure]&quot; but here is no new &quot;project structure&quot;. How to Write Go Code is still accurate and nothing has changed. You can do GOPATH builds or module builds and project structure has no meaning."}, {"owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1557220876, "post_id": 56017047, "comment_id": 98682601, "body": "@Volker I see that alot of modern projects have this new directory structure. I also don&#39;t like the redundant &quot;src&quot; in my project structure. People are obviously using this new project structure. This means that they are also <i>building</i> these <i>projects</i> and running them. I would like to <i>learn</i> how. That is why I am posting on stackoverlow"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1557221301, "post_id": 56017047, "comment_id": 98682823, "body": "@eshalev You build every Go project with <code>go build &lt;fullpackagepath&gt;</code> or <code>go build</code> in the directory of the package. I have to admit I do not understand what your problem is."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557221407, "post_id": 56017047, "comment_id": 98682883, "body": "How would I reference the files in the pkg directory if it&#39;s not in my &quot;$GOPATH/myproject/src&quot;? Makes no sense at all as you do not reference files."}, {"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 1, "creation_date": 1557223645, "post_id": 56017047, "comment_id": 98684144, "body": "Nothing in GoLang has changed, you used a method that was well... not recommended anyway. For Golang, put all your source inside a <code>src</code>, but the structure is <code>$GOPATH&#47;src&#47;repository</code> so all you do is, put multiple repositories inside src and don&#39;t need another src inside your own repo. Go automatically understands that. You don&#39;t need a separate path for all projects. Not sure why you started doing that in the first place, maybe for dependencies, but that is also solved with <code>deps ensure</code>. Go has been doing this since I started using it in 1.3"}, {"owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "edited": false, "score": 0, "creation_date": 1557224163, "post_id": 56017047, "comment_id": 98684462, "body": "This makes a pretty strong assumption though: That my repository contains only one project. We are working on project which contains many many microservices. Each written in a different language (Python/Java/C/Go etc...) . From an administrative perspective, we are not using git submodules (as there would be too many of them). As such, my golang service cannot be top level in my repository. So I guess this means that I cannot use this new directory structure, right?"}, {"owner": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 1, "creation_date": 1557227278, "post_id": 56017047, "comment_id": 98686194, "body": "Yeah that is the assumption, but to be clear, it&#39;s not new. This is how go has always been. But for you, if you have a multi-language/multi-service repository, you have to do what you&#39;ve done previously."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 1696, "user_id": 2475746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8e7f7e72a207de4277bf40013eafb6?s=128&d=identicon&r=PG", "display_name": "ishaan", "link": "https://stackoverflow.com/users/2475746/ishaan"}, "edited": false, "score": 1, "creation_date": 1557237495, "post_id": 56017047, "comment_id": 98692254, "body": "@ishaan this is misinformation. Since Go 1.11 and module support, projects no longer need to be under <code>$GOPATH&#47;src</code>."}], "owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557217255, "creation_date": 1557211908, "last_edit_date": 1557217255, "question_id": 56017047, "link": "https://stackoverflow.com/questions/56017047/golang-building-and-running-with-new-directory-structure", "title": "Golang: Building and running with new directory structure", "body": "<p>Brushing up on my golang, I see that there is a new recommended directory structure for go projects: We should be emitting the \"src\" directory from our project.\nHere is an example of such a project: <a href=\"https://github.com/golang-standards/project-layout\" rel=\"nofollow noreferrer\">https://github.com/golang-standards/project-layout</a> , and I have also seen this mentioned in several recent articles.</p>\n\n<p>Until now, I have created a package under /myproject/src/mypackage. Then, to run my project I would add /myproject to $GOPATH.</p>\n\n<p>My question: If I use the new directory structure, how would I go about building and running my project? I could \"hack\" it by creating a symlink into a \"src\" directory... But that seems rather \"dirty\" (If I was going to do that, I could've just used \"src\" to begin with) .</p>\n\n<p>I would appreciate if someone could point out the build and run commands for a project arranged in the structure mentioned above. </p>\n\n<p>EDIT based on comments: This question is not about whether I want to use \"src\" or not. I definitely do want to embrace this new project structure. It's just that I cannot find instructions on how to build  and run a project with such a directory structure. For example: How would I reference the files in the pkg directory if it's not in my \"$GOPATH/myproject/src\"?</p>\n"}, {"tags": ["go", "interface", "builder"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 2, "creation_date": 1557206647, "post_id": 56015613, "comment_id": 98675905, "body": "While this is possible, it violates type safety. That goes against the point of that article. Maybe there&#39;s a better approach. Can you provide a more concrete example?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 2, "creation_date": 1557212268, "post_id": 56015613, "comment_id": 98677984, "body": "I do not get the whole point. Interfaces only need to be implicitly implemented - so even when implementing 3 interfaces Aer,Ber and Cer, when passed as Aer, the struct will only be handled as an Aer anyway."}, {"owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 0, "creation_date": 1557217277, "post_id": 56015613, "comment_id": 98680527, "body": "Clarified the question, take a look."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1557237726, "post_id": 56015613, "comment_id": 98692408, "body": "&quot;borrowed from Java&quot; - stop right there. Go is very very different from Java, and trying to borrow from Java will lead to a lot of frustration and bad code. Go uses completely different paradigms and idioms from Java. Do not attempt to write Java code in Go."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1557244844, "post_id": 56015613, "comment_id": 98696669, "body": "@hlin117 Why do you need a single Builder which constructs different structs which match different interfaces? That seems like an anti-pattern. A more concrete example would help. Also be careful about mixing up interfaces and the structs which implement them. <code>OneAndTwoer</code> is an interface. You don&#39;t construct an interface, you construct a struct which implements that interface."}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1557206761, "last_edit_date": 1557206761, "creation_date": 1557206280, "answer_id": 56015967, "question_id": 56015613, "link": "https://stackoverflow.com/questions/56015613/how-to-use-builder-pattern-to-construct-a-struct-which-dynamically-implements-in/56015967#56015967", "title": "How to use builder pattern to construct a struct which dynamically implements interfaces", "body": "<p>Here is a way to do it, though it feels very clunky.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\ntype FieldOner interface {\n    FieldOne() int\n}\n\ntype FieldTwoer interface {\n    FieldTwo() int\n}\n</code></pre>\n\n<p>Set up structs One and Two implementing FieldOner and FieldTwoer respectively.</p>\n\n<pre><code>type One struct {\n    one int\n}\n\nfunc (f One) FieldOne() int {\n    return f.one\n}\n\ntype Two struct {\n    two int\n}\n\nfunc (f Two) FieldTwo() int {\n    return f.two\n}\n</code></pre>\n\n<p>Create the FieldBuilder which can store both values and whether it has been given each value, plus WithFieldOne and WithFieldTwo.</p>\n\n<pre><code>type FieldBuilder struct {\n    one int\n    has_one bool\n    two int\n    has_two bool\n}\n\nfunc NewObject() FieldBuilder {\n    return FieldBuilder{ has_one: false, has_two: false }\n}\n\nfunc (f FieldBuilder) WithFieldOne(one int) FieldBuilder {\n    f.one = one\n    f.has_one = true\n    return f\n}\n\nfunc (f FieldBuilder) WithFieldTwo(two int) FieldBuilder {\n    f.two = two\n    f.has_two = true\n    return f\n}\n</code></pre>\n\n<p><code>Build</code> might return One, Two, or a combination of One and Two. Since it can return multiple things which have nothing in common between them (<em>a red flag</em>) it returns an <code>interface{}</code>.</p>\n\n<pre><code>func (f FieldBuilder) Build() interface{} {\n    switch {\n    case f.has_one &amp;&amp; f.has_two:\n        return struct {\n            One\n            Two\n        }{\n            One{one: f.one}, Two{two: f.two},\n        }\n    case f.has_one:\n        return One{ one: f.one }\n    case f.has_two:\n        return Two{ two: f.two }\n    }\n    panic(\"Should never be here\")\n}\n</code></pre>\n\n<p>Because <code>Build</code> returns an <code>interface{}</code> it's necessary to typecast the result in order to actually use it possibly defeating the whole point of the exercise.</p>\n\n<pre><code>func main() {\n    s := NewObject().\n        WithFieldOne(1).\n        Build()\n\n    s1, ok := s.(FieldOner)\n    fmt.Println(s1.FieldOne())\n\n    _, ok = s.(FieldTwoer)\n    fmt.Println(ok) // Prints false\n\n    t := NewObject().\n        WithFieldOne(1).\n        WithFieldTwo(2).\n        Build()\n\n    t1, ok := t.(FieldOner)\n    fmt.Println(t1.FieldOne())\n\n    t2, ok := t.(FieldTwoer)\n    fmt.Println(t2.FieldTwo())\n}\n</code></pre>\n\n<p>This does not scale particularly well. Two interfaces require three cases. Three will require six. Four will require ten. Five will need fifteen...</p>\n"}], "owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 56015967, "answer_count": 1, "score": -2, "last_activity_date": 1557217215, "creation_date": 1557203662, "last_edit_date": 1557217215, "question_id": 56015613, "link": "https://stackoverflow.com/questions/56015613/how-to-use-builder-pattern-to-construct-a-struct-which-dynamically-implements-in", "title": "How to use builder pattern to construct a struct which dynamically implements interfaces", "body": "<p>I'm trying to use <a href=\"https://dzone.com/articles/design-patterns-the-builder-pattern\" rel=\"nofollow noreferrer\">builder patterns</a> (borrowed from Java) to allow structs to implement interfaces. For example, I would ideally like this code pattern:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Oner interface {\n    One() int\n}\n\ntype Twoer interface {\n    Two() int\n}\n\nfunc main() {\n    s := NewObject().\n        WithOne(1).\n        Build()\n\n    _, ok := s.(Oner)\n    fmt.Println(ok) // Prints true\n\n    _, ok = s.(Twoer)\n    fmt.Println(ok) // Prints false\n\n    t := NewObject().\n        WithOne(1).\n        WithTwo(2).\n        Build()\n\n    _, ok = t.(Oner)\n    fmt.Println(ok) // Prints true\n\n    _, ok = t.(Twoer)\n    fmt.Println(ok) // Prints true\n}\n</code></pre>\n\n<p>As you could see, the definition of the builder determines what interfaces <code>s</code> and <code>t</code> implement.</p>\n\n<p>How would one write the function definition of the builder <code>NewObject()</code> so the <code>Build()</code> method returns a struct which can (possibly) implement a <code>Oner</code> and <code>Twoer</code>?</p>\n\n<hr>\n\n<h1>Edit:</h1>\n\n<p>Here's some clarification on how it's going to be used. I'm constructing a library barring certain structs from being passed into functions if they violate the type safety. For example:</p>\n\n<pre><code>type Oner interface {\n    One() int\n}\n\ntype OneAndTwoer interface {\n    Oner\n\n    Two() int\n}\n\ntype Library interface {\n    DoSomethingWithOner(Oner)\n    DoSomethingWithOneAndTwoer(Twoer)\n}\n</code></pre>\n\n<p>Though we can define a function which always constructs a <code>OneAndTwoer</code>, my constraints are whenever we construct a <code>OneAndTwoer</code>, this takes a lot longer time than just constructing a <code>Oner</code></p>\n\n<pre><code>func NewOneAndTwoer() OneAndTwoer {\n    // Do some really really complicated logic which takes a lot of time\n}\n\nfunc NewOner() Oner {\n    // Do simple logic\n}\n</code></pre>\n\n<p>You could imagine how if we have a <code>Threer</code>, <code>Fourer</code>, etc, this becomes extremely unwieldly, and we have to construct constructors for all possible permutations of attributes.</p>\n\n<p>This is where builder patterns come in handy. Assuming the calculations for <code>One</code>, <code>Two</code>, etc are independent of each other, we can pick and choose which interface we want to create.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1557202659, "post_id": 56015409, "comment_id": 98674894, "body": "The variables in a for-loop are copies."}], "answers": [{"tags": [], "owner": {"reputation": 3754, "user_id": 6027873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa721a23e4aa11f8d8c4d92f0eee8cc?s=128&d=identicon&r=PG&f=1", "display_name": "hoque", "link": "https://stackoverflow.com/users/6027873/hoque"}, "is_accepted": false, "score": 1, "last_activity_date": 1557211876, "creation_date": 1557211876, "answer_id": 56017037, "question_id": 56015409, "link": "https://stackoverflow.com/questions/56015409/modifying-map-value-of-type-slice-in-place/56017037#56017037", "title": "modifying map value of type slice in place", "body": "<pre><code>for k,s := range mp {\n</code></pre>\n\n<p>Here <strong>s</strong> keeps the value of <strong>mp</strong>, which is <strong>[]int</strong>.</p>\n\n<p>If you change or modify the <strong>s</strong> in the loop it won't affect the value of <strong>mp</strong>, cause <strong>s</strong> is just a copy of the value of <strong>mp</strong>. If you want to affect the change into <strong>mp</strong> then modify with <strong>mp[k]</strong>. </p>\n"}], "owner": {"reputation": 759, "user_id": 3942851, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh4.googleusercontent.com/-nIkq4wdsg6g/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMtFLuG4ftgrUKJVYOo8SEwFsosuQ/mo/photo.jpg?sz=128", "display_name": "sfdcnoob", "link": "https://stackoverflow.com/users/3942851/sfdcnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1557211876, "creation_date": 1557201909, "question_id": 56015409, "link": "https://stackoverflow.com/questions/56015409/modifying-map-value-of-type-slice-in-place", "title": "modifying map value of type slice in place", "body": "<pre><code>mp := map[string][]int{\n\"1\" : {1,2,3,4},\n}\n\n\nfor _,s := range mp {\n  i:= 0\n  for _,v:=range s{\n    if v%2==0 {\n      s[i] = v\n      i++\n    }\n  }\n  s = s[:i]\n  // I tried mp[k] = s and it works fine\n}\n\nwant := map[string][]int{\n\"1\" : {2,4},\n}\n\nif !reflect.DeepEqual(mp,want) {\n   fmt.Printf(\"not expected\")\n   fmt.Println(mp)\n}\n</code></pre>\n\n<p>With the above code I'm not able to remove odd integers from the slice.</p>\n\n<p>I changed this to </p>\n\n<pre><code>mp := map[string][]int{\n\"1\" : {1,2,3,4},\n}\n\n\nfor k,s := range mp {\n  i:= 0\n  for _,v:=range s{\n    if v%2==0 {\n      s[i] = v\n      i++\n    }\n  }\n  s = s[:i]\n  mp[k] = s\n}\n\nwant := map[string][]int{\n\"1\" : {2,4},\n}\n</code></pre>\n\n<p>And now it works.\nI am wondering what is the problem with the first piece of code.\nI think s's address is not changed.</p>\n"}, {"tags": ["html", "go", "video", "http-live-streaming", "m3u8"], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 10272062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3d4a52c3f9fc9a9d888b54db2cf07a?s=128&d=identicon&r=PG&f=1", "display_name": "jetjetboi", "link": "https://stackoverflow.com/users/10272062/jetjetboi"}, "edited": false, "score": 0, "creation_date": 1557215329, "post_id": 56017729, "comment_id": 98679598, "body": "thank you for your answer. It works. however, there is another error pop up     hls.js@latest:1 Access to XMLHttpRequest at &#39;file:///home/jetherng/go/src/stream/%7B%7B.%7D%7D&#39; from origin &#39;null&#39; has been blocked by CORS policy: Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension, https.  Any idea about this?"}, {"owner": {"reputation": 550, "user_id": 8502370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e587aadff91cff87943be941d5aab08b?s=128&d=identicon&r=PG", "display_name": "MaddEye", "link": "https://stackoverflow.com/users/8502370/maddeye"}, "reply_to_user": {"reputation": 112, "user_id": 10272062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3d4a52c3f9fc9a9d888b54db2cf07a?s=128&d=identicon&r=PG&f=1", "display_name": "jetjetboi", "link": "https://stackoverflow.com/users/10272062/jetjetboi"}, "edited": false, "score": 0, "creation_date": 1557303704, "post_id": 56017729, "comment_id": 98715225, "body": "you have to enable cross origin (CORS) on your webserver. Look here <a href=\"https://flaviocopes.com/golang-enable-cors/\" rel=\"nofollow noreferrer\">flaviocopes.com/golang-enable-cors</a>"}], "tags": [], "owner": {"reputation": 550, "user_id": 8502370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e587aadff91cff87943be941d5aab08b?s=128&d=identicon&r=PG", "display_name": "MaddEye", "link": "https://stackoverflow.com/users/8502370/maddeye"}, "is_accepted": true, "score": 2, "last_activity_date": 1557214759, "creation_date": 1557214759, "answer_id": 56017729, "question_id": 56015322, "link": "https://stackoverflow.com/questions/56015322/html-video-tag-not-playing-m3u8-file-when-serve-by-golang-server/56017729#56017729", "title": "html video tag not playing m3u8 file when serve by golang server", "body": "<p>You have to set your header to the right type.\nTry something like this:</p>\n\n<pre><code>func serveHandler(w http.ResponseWriter, r *http.Request){\n  w.Header().Set(\"Content-Type\", \"application/x-mpegURL\")\n\n  tmpl := template.Must(template.ParseFiles(\"index.html\"))\n  tmpl.Execute(w, \"videosource/index.m3u8\")\n\n}\n</code></pre>\n"}], "owner": {"reputation": 112, "user_id": 10272062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c3d4a52c3f9fc9a9d888b54db2cf07a?s=128&d=identicon&r=PG&f=1", "display_name": "jetjetboi", "link": "https://stackoverflow.com/users/10272062/jetjetboi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 0, "accepted_answer_id": 56017729, "answer_count": 1, "score": 0, "last_activity_date": 1557214759, "creation_date": 1557201267, "last_edit_date": 1557201820, "question_id": 56015322, "link": "https://stackoverflow.com/questions/56015322/html-video-tag-not-playing-m3u8-file-when-serve-by-golang-server", "title": "html video tag not playing m3u8 file when serve by golang server", "body": "<p>I have generated the m3u8 file (index.m3u8) from a video and I want to play it on HTML.\nBasically, I have a golang server which will send the index.m3u8 to the video tag in html5 to play it when <a href=\"http://127.0.0.1:8200/play\" rel=\"nofollow noreferrer\">http://127.0.0.1:8200/play</a> is called.</p>\n\n<p>my golang file :</p>\n\n<pre><code>package main\n\nimport(\n\"fmt\"\n\"net/http\"\n\"html/template\"\n)\n\n\nfunc serveHandler(w http.ResponseWriter, r *http.Request){\n\n    tmpl := template.Must(template.ParseFiles(\"index.html\"))\n\n    tmpl.Execute(w, \"videosource/index.m3u8\")\n\n}\n\n\nfunc main(){\n\nfmt.Println(\"begin listening to port 8200\")\n\nserver := http.Server{\n    Addr: \"127.0.0.1:8200\",\n}\nhttp.HandleFunc(\"/play\",serveHandler)\nserver.ListenAndServe()\n\n}\n</code></pre>\n\n<p>this is my html file:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;body&gt;\n&lt;script src=\"https://cdn.jsdelivr.net/npm/hls.js@canary\"&gt;&lt;/script&gt;\n&lt;video id=\"video\" controls autoplay&gt;&lt;/video&gt;\n&lt;script&gt;\nif(Hls.isSupported())\n{\n    var video = document.getElementById('video');\n    var hls = new Hls();\n    hls.loadSource('{{.}}');\n    hls.attachMedia(video);\n    hls.on(Hls.Events.MANIFEST_PARSED,function()\n    {\n        video.play();\n    });\n}\nelse if (video.canPlayType('application/vnd.apple.mpegurl'))\n{\n    video.src = '{{.}}';\n    video.addEventListener('canplay',function()\n    {\n        video.play();\n    });\n}\n&lt;/script&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p>the error i get in console when i go to the url (<a href=\"http://127.0.0.1:8200/play\" rel=\"nofollow noreferrer\">http://127.0.0.1:8200/play</a>)  is </p>\n\n<pre><code>videosource/index.m3u8:1 Failed to load resource: the server responded with a status of 404 (Not Found)\n</code></pre>\n\n<p>To check that the error is not caused by path error, I tried to replace the <code>'{{.}}'</code> in HTML with the full path ('videosource/index.m3u8') and it works perfectly.</p>\n\n<p>Please guide me and show me what's wrong with my code.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["python", "python-3.x", "python-2.7", "go", "scons"], "comments": [{"owner": {"reputation": 3006, "user_id": 82681, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/bsfkb.jpg?s=128&g=1", "display_name": "bdbaddog", "link": "https://stackoverflow.com/users/82681/bdbaddog"}, "edited": false, "score": 0, "creation_date": 1557203173, "post_id": 56014056, "comment_id": 98675019, "body": "Where did you find that go builder. It&#39;s not really very SCons&#39;ian. And could be much improved.."}, {"owner": {"reputation": 2186, "user_id": 4143840, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7f2e835583e38a4f4c69f6f947496410?s=128&d=identicon&r=PG&f=1", "display_name": "jersey bean", "link": "https://stackoverflow.com/users/4143840/jersey-bean"}, "reply_to_user": {"reputation": 3006, "user_id": 82681, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/bsfkb.jpg?s=128&g=1", "display_name": "bdbaddog", "link": "https://stackoverflow.com/users/82681/bdbaddog"}, "edited": false, "score": 0, "creation_date": 1557208442, "post_id": 56014056, "comment_id": 98676454, "body": "@bdbaddog I started with the solution here: <a href=\"https://stackoverflow.com/questions/1735993/what-build-systems-work-with-go\" title=\"what build systems work with go\">stackoverflow.com/questions/1735993/&hellip;</a> .  I had run into so many indentation errors, and other env vars that weren&#39;t defined, I stripped it down to what I have here.  Any suggestions for a better resource?  Seems like there&#39;s very little example for Golang."}, {"owner": {"reputation": 2186, "user_id": 4143840, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7f2e835583e38a4f4c69f6f947496410?s=128&d=identicon&r=PG&f=1", "display_name": "jersey bean", "link": "https://stackoverflow.com/users/4143840/jersey-bean"}, "reply_to_user": {"reputation": 3006, "user_id": 82681, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/bsfkb.jpg?s=128&g=1", "display_name": "bdbaddog", "link": "https://stackoverflow.com/users/82681/bdbaddog"}, "edited": false, "score": 0, "creation_date": 1557208815, "post_id": 56014056, "comment_id": 98676583, "body": "@bdbaddog ...also, this actually follows a very similar pattern as described in chapter 18.5 of the scons user guide, titled Builders That Create Actions Using Generators.   Maybe a bit simplified as I was having so many troubles getting it to work.  In fact, now I&#39;m having issues getting scons to recognize Go&#39;s env vars."}, {"owner": {"reputation": 3006, "user_id": 82681, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/bsfkb.jpg?s=128&g=1", "display_name": "bdbaddog", "link": "https://stackoverflow.com/users/82681/bdbaddog"}, "edited": false, "score": 0, "creation_date": 1557246206, "post_id": 56014056, "comment_id": 98697338, "body": "There&#39;s no need to use a generator here.. your action could be &quot;go build $SOURCES&quot;.."}, {"owner": {"reputation": 3006, "user_id": 82681, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/bsfkb.jpg?s=128&g=1", "display_name": "bdbaddog", "link": "https://stackoverflow.com/users/82681/bdbaddog"}, "edited": false, "score": 0, "creation_date": 1557246627, "post_id": 56014056, "comment_id": 98697505, "body": "That posting is ancient.. 2009..  Here&#39;s a more recent effort. Though not complete: <a href=\"https://bitbucket.org/bdbaddog/scons-gobuilder/src/default/\" rel=\"nofollow noreferrer\">bitbucket.org/bdbaddog/scons-gobuilder/src/default</a>"}, {"owner": {"reputation": 3006, "user_id": 82681, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/bsfkb.jpg?s=128&g=1", "display_name": "bdbaddog", "link": "https://stackoverflow.com/users/82681/bdbaddog"}, "edited": false, "score": 0, "creation_date": 1557246783, "post_id": 56014056, "comment_id": 98697571, "body": "If you&#39;d like to help/help with go builder for scons.. come to the scons users mailing list.. <a href=\"https://scons.org/lists.html\" rel=\"nofollow noreferrer\">scons.org/lists.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3006, "user_id": 82681, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/bsfkb.jpg?s=128&g=1", "display_name": "bdbaddog", "link": "https://stackoverflow.com/users/82681/bdbaddog"}, "edited": false, "score": 0, "creation_date": 1557246747, "post_id": 56014065, "comment_id": 98697555, "body": "I&#39;d suggest delete this question as it&#39;s unlikely going to be of help for anyone going forward?"}], "tags": [], "owner": {"reputation": 2186, "user_id": 4143840, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7f2e835583e38a4f4c69f6f947496410?s=128&d=identicon&r=PG&f=1", "display_name": "jersey bean", "link": "https://stackoverflow.com/users/4143840/jersey-bean"}, "is_accepted": false, "score": 0, "last_activity_date": 1557189619, "creation_date": 1557189619, "answer_id": 56014065, "question_id": 56014056, "link": "https://stackoverflow.com/questions/56014056/indentation-errors-with-scons-sconscript-files/56014065#56014065", "title": "Indentation errors with scons / SConscript files", "body": "<p>I had copied/pasted some of this code from online.  Turns out there was some embedded tabs, but my editor was using spaces.  So several lines were inconsistently indented.  I spend hours looking at this, so I figured I would share my mistake.</p>\n"}], "owner": {"reputation": 2186, "user_id": 4143840, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7f2e835583e38a4f4c69f6f947496410?s=128&d=identicon&r=PG&f=1", "display_name": "jersey bean", "link": "https://stackoverflow.com/users/4143840/jersey-bean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557189619, "creation_date": 1557189536, "question_id": 56014056, "link": "https://stackoverflow.com/questions/56014056/indentation-errors-with-scons-sconscript-files", "title": "Indentation errors with scons / SConscript files", "body": "<p>I'm trying to write a SConscript file so that I can use scons to build Go code.  The SConscript file is pretty simple; its just a starter file:</p>\n\n<pre><code>def gc(source, target, env, for_signature):\n   targets = target[0]\n   sources = \" \".join(str(s) for s in source)\n   print(sources)\n   return 'go build {}'.format(sources)\n\n\ngo_compiler = Builder(\n   generator=gc,\n   src_suffix='.go',\n)\n\n# Create environment\nenv = Environment(\n   BUILDERS={'Go': go_compiler, }\n)\n\n# Build programs\nmain_package = env.Go(target='helloworld', source='helloworld.go')\n</code></pre>\n\n<p>But I keep getting this error:</p>\n\n<pre><code># scons\nscons: Reading SConscript files ...\n  File \"/root/repo/SConstruct\", line 5\n\n    print(sources)\n\n    ^\n\nIndentationError: unexpected indent\n</code></pre>\n\n<p>I tried switching between python v2.7 and 3.7, rewriting the code in various different ways, but I kept hitting the same issue.  I even tried writing several fragments of the above code inside a python interpreter and the syntax and indentation were fine.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1337, "user_id": 903766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94253e3b2045fbf75c05e81a92035e37?s=128&d=identicon&r=PG", "display_name": "ctt", "link": "https://stackoverflow.com/users/903766/ctt"}, "edited": false, "score": 5, "creation_date": 1557191520, "post_id": 56014031, "comment_id": 98672946, "body": "Perhaps it&#39;s a way to confirm that FIFO satisfies the interface, Queue.  If a maintainer changes things so that FIFO does not satisfy the interface, the compiler will prevent the program from being built and clearly describe the problem."}, {"owner": {"reputation": 429, "user_id": 1101691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2258274567a29afc262661feb0fa5fd?s=128&d=identicon&r=PG", "display_name": "Jack Liu Shurui", "link": "https://stackoverflow.com/users/1101691/jack-liu-shurui"}, "reply_to_user": {"reputation": 1337, "user_id": 903766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94253e3b2045fbf75c05e81a92035e37?s=128&d=identicon&r=PG", "display_name": "ctt", "link": "https://stackoverflow.com/users/903766/ctt"}, "edited": false, "score": 2, "creation_date": 1557192369, "post_id": 56014031, "comment_id": 98673106, "body": "Ctt, Thanks. I googled the internet according to your answer.  It is the case."}], "owner": {"reputation": 429, "user_id": 1101691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2258274567a29afc262661feb0fa5fd?s=128&d=identicon&r=PG", "display_name": "Jack Liu Shurui", "link": "https://stackoverflow.com/users/1101691/jack-liu-shurui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1557191845, "answer_count": 0, "score": 1, "last_activity_date": 1557189264, "creation_date": 1557189264, "question_id": 56014031, "link": "https://stackoverflow.com/questions/56014031/whats-the-purpose-of-this-line-code-queuefifo", "closed_reason": "Duplicate", "title": "What&#39;s the purpose of this line code &quot; _ = Queue(&amp;FIFO{})&quot;?", "body": "<p>I don't get the idea of one line of golang code in <a href=\"https://github.com/kubernetes/client-go/blob/ef81ee0960bf57e94c697d674a1a8f5694c0ec9a/tools/cache/fifo.go#L118\" rel=\"nofollow noreferrer\">kunbernets code</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var (\n    _ = Queue(&amp;FIFO{}) // FIFO is a Queue\n)\n</code></pre>\n"}, {"tags": ["go", "unmarshalling", "mongo-go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user773737"}, "edited": false, "score": 0, "creation_date": 1557244239, "post_id": 56013579, "comment_id": 98696321, "body": "Thanks, that worked. Where could I have learned that I would have needed to use the <code>bson</code> field tag?"}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 1, "creation_date": 1557246610, "post_id": 56013579, "comment_id": 98697495, "body": "@Houseman: Good question. The docs don&#39;t seem to go out of their way to tell you about it, but there&#39;s some info <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/bson/bsoncodec#StructTagParserFunc\" rel=\"nofollow noreferrer\">here</a> for example. But in general if you&#39;re having such issues and the labels in your file don&#39;t exactly match the names of your struct fields, then some problem with the field tags is a possibility which immediately springs to mind."}], "tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": true, "score": 1, "last_activity_date": 1557185301, "creation_date": 1557185301, "answer_id": 56013579, "question_id": 56013317, "link": "https://stackoverflow.com/questions/56013317/invalid-request-to-read-array-when-doing-unmarshalextjson/56013579#56013579", "title": "invalid request to read array when doing UnmarshalExtJSON", "body": "<p>You're unmarshalling using the <code>bson</code> package, but you're using <code>json</code> struct field tags. Change them to <code>bson</code> struct field tags and it should work for you:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"go.mongodb.org/mongo-driver/bson\"\n)\n\nfunc main() {\n    var json = \"{\\\"data\\\":{\\\"streamInformation\\\":{\\\"codecs\\\":[\\\"avc1.640028\\\"]}}}\"\n    var workflow Workflow\n    e := bson.UnmarshalExtJSON([]byte(json), false, &amp;workflow)\n    if e != nil {\n        fmt.Println(\"err is \", e)\n        return\n    }\n    fmt.Println(workflow)\n}\n\ntype Workflow struct {\n    Data WorkflowData `bson:\"data,omitempty\"`\n}\n\ntype WorkflowData struct {\n    StreamInformation StreamInformation `bson:\"streamInformation,omitempty\"`\n}\n\ntype StreamInformation struct {\n    Codecs []string `bson:\"codecs,omitempty\"`\n}\n</code></pre>\n\n<p>with output:</p>\n\n<pre><code>paul@mac:bson$ ./bson\n{{{[avc1.640028]}}}\npaul@mac:bson$ \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user773737"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 56013579, "answer_count": 1, "score": 0, "last_activity_date": 1557185301, "creation_date": 1557182974, "last_edit_date": 1557184137, "question_id": 56013317, "link": "https://stackoverflow.com/questions/56013317/invalid-request-to-read-array-when-doing-unmarshalextjson", "title": "invalid request to read array when doing UnmarshalExtJSON", "body": "<p>I'm trying to unmarshal extended JSON into a struct using <code>UnmarshalExtJSON</code> from <code>go.mongodb.org/mongo-driver/bson</code></p>\n\n<p>It's giving me an error: <code>invalid request to read array</code></p>\n\n<p>How can I unmarshal this data into my struct? </p>\n\n<p>MVCE:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"go.mongodb.org/mongo-driver/bson\"\n)\n\nfunc main() {\n    var json = \"{\\\"data\\\":{\\\"streamInformation\\\":{\\\"codecs\\\":[\\\"avc1.640028\\\"]}}}\"\n    var workflow Workflow\n    e := bson.UnmarshalExtJSON([]byte(json), false, &amp;workflow)\n    if e != nil {\n        fmt.Println(\"err is \", e)\n        // should print \"err is  invalid request to read array\"\n        return\n    }\n    fmt.Println(workflow)\n}\n\ntype Workflow struct {\n    Data WorkflowData `json:\"data,omitempty\"`\n}\n\ntype WorkflowData struct {\n    StreamInformation StreamInformation `json:\"streamInformation,omitempty\"`\n}\n\ntype StreamInformation struct {\n    Codecs []string `json:\"codecs,omitempty\"`\n}\n\n</code></pre>\n\n<p>I'm using go version 1.12.4 windows/amd64</p>\n"}, {"tags": ["linux", "pdf", "go", "jpeg"], "comments": [{"owner": {"reputation": 71, "user_id": 11019788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66d7b2280e6be2da1dc93e3fea10bf27?s=128&d=identicon&r=PG&f=1", "display_name": "AMDarwech", "link": "https://stackoverflow.com/users/11019788/amdarwech"}, "edited": false, "score": 0, "creation_date": 1557173011, "post_id": 56011592, "comment_id": 98668452, "body": "Perhaps it could be something solved with elevated privileges?"}, {"owner": {"reputation": 998, "user_id": 3930220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s5PSO.jpg?s=128&g=1", "display_name": "Ugo T.", "link": "https://stackoverflow.com/users/3930220/ugo-t"}, "edited": false, "score": 0, "creation_date": 1557173121, "post_id": 56011592, "comment_id": 98668502, "body": "Apparently it is due toa  bug in Ghostscript, you have to modify you <code>policy.xml</code> or update the Ghostscript package (a fix has been published) : <a href=\"https://stackoverflow.com/questions/52998331/imagemagick-security-policy-pdf-blocking-conversion\" title=\"imagemagick security policy pdf blocking conversion\">stackoverflow.com/questions/52998331/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 7438923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xDFWm.png?s=128&g=1", "display_name": "Viggi", "link": "https://stackoverflow.com/users/7438923/viggi"}, "is_accepted": false, "score": 2, "last_activity_date": 1595054741, "last_edit_date": 1595054741, "creation_date": 1580434056, "answer_id": 59996831, "question_id": 56011592, "link": "https://stackoverflow.com/questions/56011592/is-there-any-way-converting-a-pdf-to-jpeg-with-golang/59996831#59996831", "title": "Is there any way converting a PDF to jpeg with golang?", "body": "<p>I've been through the same issue and din't find any pure Golang solution.</p>\n<p>Not a pure Golang solution, but <a href=\"https://github.com/brunsgaard/go-pdfium-render\" rel=\"nofollow noreferrer\">this</a> works flawlessly which uses <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">cgo</a> internally. Underlying library is <a href=\"https://pdfium.googlesource.com/pdfium/+/refs/heads/master/public/\" rel=\"nofollow noreferrer\">Pdfium</a> which is a C++ library, developed by Google and used in Chrome.</p>\n<p>After a lot of research, I discovered that Pdfium was the best in class in terms of speed, robustness, license requirements and reliability.</p>\n<p>To improve overall performance of the operation, I've ended up with <a href=\"https://github.com/antonini/golibjpegturbo\" rel=\"nofollow noreferrer\">this</a> encoder as Golang's image encoders aren't geared towards performance and are <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/ATOWYGuZbfI\" rel=\"nofollow noreferrer\">slow</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 7502507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec9abfcc99059d1ad06da232ed69e563?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Stein", "link": "https://stackoverflow.com/users/7502507/jan-stein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2296, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1618674733, "creation_date": 1557172573, "question_id": 56011592, "link": "https://stackoverflow.com/questions/56011592/is-there-any-way-converting-a-pdf-to-jpeg-with-golang", "title": "Is there any way converting a PDF to jpeg with golang?", "body": "<p>I am currently rewriting my \"old\" Python-based Chatbots into golang.\nOne issue I came across was that I can\u00b4t convert a PDF into jpeg. Which I\u00b4d like to do so I can send it into a chat easily.</p>\n\n<p>Already tried this with bimg (did not work at all) and imagemagick (gopkg.in/gographics/imagick.v3/imagick) as provided in this answer to another thread: \"<a href=\"https://stackoverflow.com/a/47520596/7502507\">https://stackoverflow.com/a/47520596/7502507</a>\"</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>imagick.Initialize()\n\ndefer imagick.Terminate()\n\nmw := imagick.NewMagickWand()\n\ndefer mw.Destroy()\n\nmw.ReadImage(pdf)\n\nmw.SetIteratorIndex(0) // This being the page offset\n\nmw.SetImageFormat(\"jpg\")\n\nmw.WriteImage(image)\n</code></pre>\n\n<p>It does not produce a jpg at all, it just gives me the error</p>\n\n<pre><code>ERROR_POLICY: attempt to perform an operation not allowed by the security policy `PDF' @ error/constitute.c/IsCoderAuthorized/408\n</code></pre>\n\n<p>How can I make this work? I can\u00b4t seem to edit the security settings for this.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["docker", "go", "arm"], "comments": [{"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1557187400, "post_id": 56011323, "comment_id": 98672268, "body": "The &quot;you have provided here&quot; comment is confusing since a large majority of stackoverflow users are not acrcloud maintainers. That tree appears to be x86 specific and therefore should not be expected to work on an ARM based hardware platform. To the best of my knowledge, there&#39;s no qemu based interpreter to run x86 code on ARM, only the other way around."}, {"owner": {"reputation": 155, "user_id": 6759337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xmkBv.png?s=128&g=1", "display_name": "PeggyScott", "link": "https://stackoverflow.com/users/6759337/peggyscott"}, "reply_to_user": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1557252004, "post_id": 56011323, "comment_id": 98699827, "body": "Yes thanks. I&#39;ll try getting ARM binaries"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1557171340, "question_id": 1433727}, "owner": {"reputation": 155, "user_id": 6759337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xmkBv.png?s=128&g=1", "display_name": "PeggyScott", "link": "https://stackoverflow.com/users/6759337/peggyscott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557186992, "creation_date": 1557170873, "last_edit_date": 1557186992, "question_id": 56011323, "link": "https://stackoverflow.com/questions/56011323/how-do-i-build-golang-acrcloud-sdk-for-arm-builds", "title": "How do I build golang acrcloud sdk for ARM builds", "body": "<p>We are trying to build a docker image with ACRCloud sdk in Golang for ARM64.</p>\n\n<p>We are able to build the sdk for amd 64 for linux, both on stretch and alpine flavors.\nBut when we try building it for arm64 using both gcc and gnueabi compilers, we see:</p>\n\n<p>golang:1.12 &amp; alpine docker images using gnueabihf compiler:</p>\n\n<pre><code>Step 17/32 : RUN go build -o $GOPATH/pkg/linux_arm64/acrcloud.a\n---&gt; Running in a1150605660a\n&lt;span&gt;# runtime&amp;#x2F;cgo&lt;/span&gt;\u200c\nIn file included from _cgo_export.c:4:0:\ncgo-gcc-export-header-prolog:25:14: error: size of array '_check_for_64_bit_pointer_matching_GoInt' is negative\n.\n.\n.\n</code></pre>\n\n<p>golang:1.12.4-alpine3.9 &amp; golang:1.12 images using gcc compiler</p>\n\n<pre><code>span&gt;TERM=&amp;#x27;dumb&amp;#x27; gcc -I . -fPIC -pthread -fmessage-length=0 -fdebug-prefix-map=$WORK&amp;#x2F;b059=&amp;#x2F;tmp&amp;#x2F;go-build -gno-record-gcc-switches -I $WORK&amp;#x2F;b059&amp;#x2F; -g -O2 -Wall -Werror -o $WORK&amp;#x2F;b059&amp;#x2F;_x012.o -c gcc_arm64.S&lt;/span&gt;\u200c\n&lt;span&gt;# runtime&amp;#x2F;cgo&lt;/span&gt;\u200c\ngcc_arm64.S: Assembler messages:\ngcc_arm64.S:27: Error: no such instruction: `stp x19,x20,[sp,'\ngcc_arm64.S:28: Error: no such instruction: `stp x21,x22,[sp,'\n.\n.\n.\n</code></pre>\n\n<p>I have the latest compiled binaries for Linux you have provided here:\n<a href=\"https://github.com/acrcloud/acrcloud_sdk_golang/tree/master/linux/x86-64/acrcloud\" rel=\"nofollow noreferrer\">https://github.com/acrcloud/acrcloud_sdk_golang/tree/master/linux/x86-64/acrcloud</a></p>\n\n<p>Please advise how we can move forward. Please let me know what additional information/ logs you would need to do this.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 674, "user_id": 11443248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cd00135ccb2cd2cd510a706b1932a9?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Willmon", "link": "https://stackoverflow.com/users/11443248/kyle-willmon"}, "edited": false, "score": 0, "creation_date": 1557169011, "post_id": 56010803, "comment_id": 98666965, "body": "Have you tried populating the <code>go.mod</code> file by just running <code>go build</code>?"}, {"owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "reply_to_user": {"reputation": 674, "user_id": 11443248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cd00135ccb2cd2cd510a706b1932a9?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Willmon", "link": "https://stackoverflow.com/users/11443248/kyle-willmon"}, "edited": false, "score": 0, "creation_date": 1557169064, "post_id": 56010803, "comment_id": 98666982, "body": "Yes, same error (&quot;cannot load github.com/jteeuwen/go-pkg-rss: cannot find module providing package github.com/jteeuwen/go-pkg-rss&quot;)"}, {"owner": {"reputation": 674, "user_id": 11443248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cd00135ccb2cd2cd510a706b1932a9?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Willmon", "link": "https://stackoverflow.com/users/11443248/kyle-willmon"}, "edited": false, "score": 0, "creation_date": 1557169200, "post_id": 56010803, "comment_id": 98667034, "body": "Or rather, <code>go build -mod=vendor</code> as recommended <a href=\"https://github.com/golang/go/wiki/Modules#how-do-i-use-vendoring-with-modules-is-vendoring-going-away\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "reply_to_user": {"reputation": 674, "user_id": 11443248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cd00135ccb2cd2cd510a706b1932a9?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Willmon", "link": "https://stackoverflow.com/users/11443248/kyle-willmon"}, "edited": false, "score": 0, "creation_date": 1557169515, "post_id": 56010803, "comment_id": 98667140, "body": "Yes, that works. But that doesn&#39;t populate the go.mod file. My (perhaps mis)understanding is that using -mod=vendor just uses /vendor and doesn&#39;t touch go.mod at all. So I don&#39;t get any of the advantages of go modules."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1557178403, "last_edit_date": 1557178403, "creation_date": 1557175085, "answer_id": 56012107, "question_id": 56010803, "link": "https://stackoverflow.com/questions/56010803/converting-vendor-to-go-modules-cannot-find-module-providing-package-error/56012107#56012107", "title": "Converting /vendor to Go Modules, cannot find module providing package error", "body": "<p>You can't mix the <code>vendor</code> directory behavior and modules, each method of dependency resolution precludes the other. You can re-publish the missing package yourself somewhere that <code>go mod</code> can locate it, or you can redirect it directly to the existing vendored source in your module.</p>\n\n<p>To redirect the source of a module, use the <a href=\"https://golang.org/cmd/go/#hdr-The_go_mod_file\" rel=\"nofollow noreferrer\"><code>replace</code> directive</a> in the go.mod file</p>\n\n<p><code>replace missing/package v0.0.1 =&gt; ./vendor/missing/package</code></p>\n"}], "owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 56012107, "answer_count": 1, "score": 0, "last_activity_date": 1557178403, "creation_date": 1557168605, "question_id": 56010803, "link": "https://stackoverflow.com/questions/56010803/converting-vendor-to-go-modules-cannot-find-module-providing-package-error", "title": "Converting /vendor to Go Modules, cannot find module providing package error", "body": "<p>Converting an existing project with a /vendor directory to use Go Modules (go version 1.12). I do <code>go mod init</code> to generate the <code>go.mod</code> file. Then I do <code>go get -u ./...</code> to populate the go.mod file. During this time, it tries to locate a package on github that no longer exists. It is vendored in my /vendor directory. </p>\n\n<p>Until I can upgrade my code to use a different package, how can I continue the conversion to using modules? That is, I want to keep some things vendored (I also have some modified code under /vendor), while other things are handled by go modules.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform", "app-engine-flexible"], "comments": [{"owner": {"reputation": 129, "user_id": 11316432, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ciokz1dnGM8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reEKAfl1Tb7ZXUaoCzlmsOwARqUDQ/mo/photo.jpg?sz=128", "display_name": "Duck Hunt Duo", "link": "https://stackoverflow.com/users/11316432/duck-hunt-duo"}, "edited": false, "score": 4, "creation_date": 1557159200, "post_id": 56008835, "comment_id": 98663070, "body": "I experienced this error while trying to deploy on GAE a few weeks back. I couldn&#39;t find any real solutions searching online and in the end it just worked when I retried a while later. As it seems likely to be more of an issue on the Gogole side it might be worth raising an issue on their Public Issue Tracker: <a href=\"https://issuetracker.google.com/issues?q=star:true\" rel=\"nofollow noreferrer\">issuetracker.google.com/issues?q=star:true</a>"}, {"owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "reply_to_user": {"reputation": 129, "user_id": 11316432, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ciokz1dnGM8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reEKAfl1Tb7ZXUaoCzlmsOwARqUDQ/mo/photo.jpg?sz=128", "display_name": "Duck Hunt Duo", "link": "https://stackoverflow.com/users/11316432/duck-hunt-duo"}, "edited": false, "score": 1, "creation_date": 1557163586, "post_id": 56008835, "comment_id": 98664923, "body": "@DuckHuntDuo it&#39;s been happening for about a week now but i&#39;ll try the public issue tracker. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 432, "user_id": 612118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4f8a79868a600c5835bfd56708744c?s=128&d=identicon&r=PG", "display_name": "andersand", "link": "https://stackoverflow.com/users/612118/andersand"}, "edited": false, "score": 0, "creation_date": 1578415880, "post_id": 56053522, "comment_id": 105427704, "body": "Adding role &quot;App Engine Deployer&quot; to the couldbuild service account did it for me"}], "tags": [], "owner": {"reputation": 381, "user_id": 11407878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iui6c.jpg?s=128&g=1", "display_name": "April", "link": "https://stackoverflow.com/users/11407878/april"}, "is_accepted": true, "score": 30, "last_activity_date": 1557383860, "creation_date": 1557383860, "answer_id": 56053522, "question_id": 56008835, "link": "https://stackoverflow.com/questions/56008835/error-gcloud-app-deploy-invalid-argument-unable-to-resolve-source/56053522#56053522", "title": "ERROR: (gcloud.app.deploy) INVALID_ARGUMENT: unable to resolve source", "body": "<p>Try disabling and enabling the Cloud Build API in your project so a new service account is created, then try to deploy again.</p>\n\n<p>This ensures that Cloud Build has permission to start builds (the service account name should look like project-number@cloudbuild.gserviceaccount.com).</p>\n"}, {"tags": [], "owner": {"reputation": 2430, "user_id": 4092401, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L2gLB.jpg?s=128&g=1", "display_name": "Ying Li", "link": "https://stackoverflow.com/users/4092401/ying-li"}, "is_accepted": false, "score": 3, "last_activity_date": 1557511517, "creation_date": 1557511517, "answer_id": 56082752, "question_id": 56008835, "link": "https://stackoverflow.com/questions/56008835/error-gcloud-app-deploy-invalid-argument-unable-to-resolve-source/56082752#56082752", "title": "ERROR: (gcloud.app.deploy) INVALID_ARGUMENT: unable to resolve source", "body": "<p>Cloud Build uses a service account instead of your user credential, so adding roles to your user won't help in this case.</p>\n\n<p>You should be able to manually add the service account, [project-number]@cloudbuild.gserviceaccount.com, back to your account without re-enabling the API. Some users are known to delete random service accounts they don't recognize, which can sometimes cause this issue.</p>\n\n<p>In summary, check if the service account exists. If so, give it all the roles it needs; if not, then create it and give it all the role it needs.</p>\n"}, {"comments": [{"owner": {"reputation": 460, "user_id": 5658458, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/l6ZrC.jpg?s=128&g=1", "display_name": "NOP-MOV", "link": "https://stackoverflow.com/users/5658458/nop-mov"}, "edited": false, "score": 1, "creation_date": 1587398396, "post_id": 58637225, "comment_id": 108490153, "body": "Same here. Mine took 10~ minutes."}], "tags": [], "owner": {"reputation": 8546, "user_id": 71062, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6dc7e281ace4555f3a8f5a85d4d4f849?s=128&d=identicon&r=PG", "display_name": "aidan", "link": "https://stackoverflow.com/users/71062/aidan"}, "is_accepted": false, "score": 9, "last_activity_date": 1583791966, "last_edit_date": 1583791966, "creation_date": 1572498775, "answer_id": 58637225, "question_id": 56008835, "link": "https://stackoverflow.com/questions/56008835/error-gcloud-app-deploy-invalid-argument-unable-to-resolve-source/58637225#58637225", "title": "ERROR: (gcloud.app.deploy) INVALID_ARGUMENT: unable to resolve source", "body": "<p>I found that it took a while for the API permissions to propagate fully.</p>\n\n<p>I had this error after enabling the App Engine Admin API, but I waited a few minutes and tried again and it worked fine.</p>\n"}], "owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8296, "favorite_count": 2, "accepted_answer_id": 56053522, "answer_count": 3, "score": 22, "last_activity_date": 1583791966, "creation_date": 1557158976, "question_id": 56008835, "link": "https://stackoverflow.com/questions/56008835/error-gcloud-app-deploy-invalid-argument-unable-to-resolve-source", "title": "ERROR: (gcloud.app.deploy) INVALID_ARGUMENT: unable to resolve source", "body": "<p>I am trying to deploy a <code>go 1.11</code> runtime that used to work, but recently I've been getting: <code>ERROR: (gcloud.app.deploy) INVALID_ARGUMENT: unable to resolve source</code> errors. </p>\n\n<p>Nothing in my <code>app.yaml</code> has changed, and the error message isn't helpful to understand what the issue could be. I ran it with the <code>--verbosity=debug flag</code> and get:</p>\n\n<pre><code>Building and pushing image for service [apiv1]\nDEBUG: Could not call git with args ('config', '--get-regexp', 'remote\\\\.(.*)\\\\.url'): Command '['git', 'config', '--get-regexp', 'remote\\\\.(.*)\\\\.url']' returned non-zero exit status 1\nINFO: Could not generate [source-context.json]: Could not list remote URLs from source directory: /var/folders/18/k3w6w7f169xg4mypdwj7p4_c0000gn/T/tmp6IkZKx/tmphibUAo\nStackdriver Debugger may not be configured or enabled on this application. See https://cloud.google.com/debugger/ for more information.\nINFO: Uploading [/var/folders/18/k3w6w7f169xg4mypdwj7p4_c0000gn/T/tmpVHKXol/src.tgz] to [staging.wildfire-app-backend.appspot.com/asia.gcr.io/wildfire-app-backend/appengine/apiv1.20190506t090359:latest]\nDEBUG: Using runtime builder root [gs://runtime-builders/]\nDEBUG: Loading runtimes manifest from [gs://runtime-builders/runtimes.yaml]\nINFO: Reading [&lt;googlecloudsdk.api_lib.storage.storage_util.ObjectReference object at 0x105ca9b10&gt;]\nDEBUG: Resolved runtime [go1.11] as build configuration [gs://runtime-builders/go-1.11-builder-20181217154124.yaml]\nINFO: Using runtime builder [gs://runtime-builders/go-1.11-builder-20181217154124.yaml]\nINFO: Reading [&lt;googlecloudsdk.api_lib.storage.storage_util.ObjectReference object at 0x105b03b50&gt;]\nDEBUG: (gcloud.app.deploy) INVALID_ARGUMENT: unable to resolve source\nTraceback (most recent call last):\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/calliope/cli.py\", line 985, in Execute\n    resources = calliope_command.Run(cli=self, args=args)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/calliope/backend.py\", line 795, in Run\n    resources = command_instance.Run(args)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/surface/app/deploy.py\", line 90, in Run\n    parallel_build=False)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/command_lib/app/deploy_util.py\", line 636, in RunDeploy\n    flex_image_build_option=flex_image_build_option)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/command_lib/app/deploy_util.py\", line 411, in Deploy\n    image, code_bucket_ref, gcr_domain, flex_image_build_option)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/command_lib/app/deploy_util.py\", line 287, in _PossiblyBuildAndPush\n    self.deploy_options.parallel_build)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/api_lib/app/deploy_command_util.py\", line 450, in BuildAndPushDockerImage\n    return _SubmitBuild(build, image, project, parallel_build)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/api_lib/app/deploy_command_util.py\", line 483, in _SubmitBuild\n    build, project=project)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/api_lib/cloudbuild/build.py\", line 149, in ExecuteCloudBuild\n    build_op = self.ExecuteCloudBuildAsync(build, project)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/api_lib/cloudbuild/build.py\", line 133, in ExecuteCloudBuildAsync\n    build=build,))\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/googlecloudsdk/third_party/apis/cloudbuild/v1/cloudbuild_v1_client.py\", line 205, in Create\n    config, request, global_params=global_params)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/third_party/apitools/base/py/base_api.py\", line 731, in _RunMethod\n    return self.ProcessHttpResponse(method_config, http_response, request)\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/third_party/apitools/base/py/base_api.py\", line 737, in ProcessHttpResponse\n    self.__ProcessHttpResponse(method_config, http_response, request))\n  File \"/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/lib/third_party/apitools/base/py/base_api.py\", line 604, in __ProcessHttpResponse\n    http_response, method_config=method_config, request=request)\nHttpBadRequestError: HttpError accessing &lt;https://cloudbuild.googleapis.com/v1/projects/wildfire-app-backend/builds?alt=json&gt;: response: &lt;{'status': '400', 'content-length': '114', 'x-xss-protection': '0'\n, 'x-content-type-options': 'nosniff', 'transfer-encoding': 'chunked', 'vary': 'Origin, X-Origin, Referer', 'server': 'ESF', '-content-encoding': 'gzip', 'cache-control': 'private', 'date': 'Mon, 06 May 2\n019 16:04:41 GMT', 'x-frame-options': 'SAMEORIGIN', 'alt-svc': 'quic=\":443\"; ma=2592000; v=\"46,44,43,39\"', 'content-type': 'application/json; charset=UTF-8'}&gt;, content &lt;{\n  \"error\": {\n    \"code\": 400,\n    \"message\": \"unable to resolve source\",\n    \"status\": \"INVALID_ARGUMENT\"\n  }\n}\n&gt;\nERROR: (gcloud.app.deploy) INVALID_ARGUMENT: unable to resolve \n</code></pre>\n\n<p>Any advice would be useful, I also tried it with <code>gcloud beta</code>, I rotated my credentials and was of no use. My user has <code>Owner</code> role, but I added individually all the roles that might be necessary </p>\n\n<pre><code>App Engine Admin\nApp Engine Code Viewer\nApp Engine Deployer\nApp Engine Service Admin\nProject Billing Manager\nCloud Build Service Account\nCloud Build Editor\nCloud Build Viewer\nOwner\nStorage Admin\n</code></pre>\n"}, {"tags": ["regex", "go", "regex-group", "regex-greedy"], "comments": [{"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1557158871, "post_id": 56008732, "comment_id": 98662946, "body": "Are you trying to extract the whole HTML element <code>&lt;a href=&quot;&#47;kontakt-termin-verbeinaren&#47;&quot; data-link-title=&quot;Kontakt &#47; Termin verbeinaren&quot;&gt;Kontakt &#47; Termin verbeinaren&lt;&#47;a&gt;</code> or only the text inside?"}, {"owner": {"reputation": 33, "user_id": 11010059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9qndn0eocMc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMI8OZydgialcWQkwbx1MP9WAIasQ/mo/photo.jpg?sz=128", "display_name": "\u0410\u0440\u0442\u0435\u043c \u0411\u043e\u043b\u043e\u0442\u043e\u0432", "link": "https://stackoverflow.com/users/11010059/%d0%90%d1%80%d1%82%d0%b5%d0%bc-%d0%91%d0%be%d0%bb%d0%be%d1%82%d0%be%d0%b2"}, "reply_to_user": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1557159933, "post_id": 56008732, "comment_id": 98663383, "body": "@Abdullah  I have to get only &quot;/kontakt-termin-verbeinaren/&quot;"}, {"owner": {"reputation": 4288, "user_id": 1519836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2852ae66cfd8671011c61239be84e25?s=128&d=identicon&r=PG", "display_name": "GottZ", "link": "https://stackoverflow.com/users/1519836/gottz"}, "edited": false, "score": 0, "creation_date": 1557161759, "post_id": 56008732, "comment_id": 98664171, "body": "fyi: it&#39;s &quot;vereinbaren&quot; not &quot;verbeinaren&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 91458, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 1, "creation_date": 1557210264, "post_id": 56010669, "comment_id": 98677145, "body": "The graph has a different pattern than the suggested pattern. And did you mean <code>[A-Za-z]</code> instead of <code>[A-z]</code> because that matches <a href=\"https://stackoverflow.com/questions/29771901/why-is-this-regex-allowing-a-caret\">more characters</a>."}, {"owner": {"reputation": 33, "user_id": 11010059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9qndn0eocMc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMI8OZydgialcWQkwbx1MP9WAIasQ/mo/photo.jpg?sz=128", "display_name": "\u0410\u0440\u0442\u0435\u043c \u0411\u043e\u043b\u043e\u0442\u043e\u0432", "link": "https://stackoverflow.com/users/11010059/%d0%90%d1%80%d1%82%d0%b5%d0%bc-%d0%91%d0%be%d0%bb%d0%be%d1%82%d0%be%d0%b2"}, "edited": false, "score": 1, "creation_date": 1557217522, "post_id": 56010669, "comment_id": 98680663, "body": "@Emma, thank you. Now it looks like (.*)((&lt;a\\s[^&gt;]*href=\\&quot;([^\\&quot;]*)\\&quot;(.*?)?\\&gt;(Kontakte?)(.*)(\\&lt;\\/&zwnj;&#8203;a\\&gt;)))"}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": true, "score": 1, "last_activity_date": 1557210460, "last_edit_date": 1592644375, "creation_date": 1557167864, "answer_id": 56010669, "question_id": 56008732, "link": "https://stackoverflow.com/questions/56008732/regex-for-matching-the-last-occurrence-of-a-tag/56010669#56010669", "title": "RegEx for matching the last occurrence of a tag", "body": "<p><a href=\"https://regex101.com/r/VQJZxl/1\" rel=\"nofollow noreferrer\">This expression</a> might help you to design a desired one to do so:</p>\n<pre><code>(.*)(&lt;a href=&quot;)([A-z0-9-\\/]+)(&quot;.*)\n</code></pre>\n<p>It swipe from beginning using <code>(.*)</code> to the last <code>href</code>, then you can add any boundary that you wish to capture that target URL.</p>\n<p><a href=\"https://i.stack.imgur.com/jWCyX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jWCyX.png\" alt=\"enter image description here\" /></a></p>\n<h3>Graph</h3>\n<p>This graph shows how it works:</p>\n<p><a href=\"https://i.stack.imgur.com/H2Axk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H2Axk.png\" alt=\"enter image description here\" /></a></p>\n<p>I'm not so sure, if you want just the URL or the entire tag. If you wish to get the entire tag, then the expression can be simply modified to something <a href=\"https://regex101.com/r/qO0L3c/1\" rel=\"nofollow noreferrer\">similar to</a>:</p>\n<pre><code>(.*)((&lt;a href=&quot;)(.*)(\\&lt;\\/a\\&gt;))\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11010059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9qndn0eocMc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMI8OZydgialcWQkwbx1MP9WAIasQ/mo/photo.jpg?sz=128", "display_name": "\u0410\u0440\u0442\u0435\u043c \u0411\u043e\u043b\u043e\u0442\u043e\u0432", "link": "https://stackoverflow.com/users/11010059/%d0%90%d1%80%d1%82%d0%b5%d0%bc-%d0%91%d0%be%d0%bb%d0%be%d1%82%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 56010669, "answer_count": 1, "score": 3, "last_activity_date": 1557251418, "creation_date": 1557158511, "last_edit_date": 1557251418, "question_id": 56008732, "link": "https://stackoverflow.com/questions/56008732/regex-for-matching-the-last-occurrence-of-a-tag", "title": "RegEx for matching the last occurrence of a tag", "body": "<p>I am trying to extract the contact link from the HTML code below. I have tried this but doesn't seem to work:</p>\n\n<pre><code>\\\"([^\\\"]*)\\\"(.*?)?\\&gt;(Kontakt)\n</code></pre>\n\n<p>and some part HTML-code: </p>\n\n<pre><code>&lt;li id=\"cc-nav-view-2315645627\" class=\"jmd-nav__list-item-0\"&gt;\n    &lt;a href=\"/\" data-link-title=\"Start\" class=\"cc-nav-current j-nav-current jmd-nav__link--current\"&gt;Start&lt;/a&gt;\n&lt;/li&gt;\n&lt;li id=\"cc-nav-view-2315645625\" class=\"jmd-nav__list-item-0\"&gt;\n    &lt;a href=\"/\u00f6ffnungszeiten-schlie\u00dfzeiten/\" data-link-title=\"\u00d6ffnungszeiten &amp;amp; Schlie\u00dfzeiten\"&gt;\u00d6ffnungszeiten &amp;amp; Schlie\u00dfzeiten&lt;/a&gt;\n&lt;/li&gt;\n&lt;li id=\"cc-nav-view-2316315025\" class=\"jmd-nav__list-item-0\"&gt;\n   &lt;a href=\"/flyer/\" data-link-title=\"Flyer\"&gt;Flyer&lt;/a&gt;\n&lt;/li&gt;\n&lt;li id=\"cc-nav-view-2315732425\" class=\"jmd-nav__list-item-0\"&gt;\n    &lt;a href=\"/anfahrt/\" data-link-title=\"Anfahrt\"&gt;Anfahrt&lt;/a&gt;&lt;/li&gt;\n&lt;li id=\"cc-nav-view-2315645825\" class=\"jmd-nav__list-item-0\"&gt;\n    &lt;a href=\"/kontakt-termin-verbeinaren/\" data-link-title=\"Kontakt / Termin verbeinaren\"&gt;Kontakt / Termin verbeinaren&lt;/a&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>I need to get the last <code>a href</code> occurrence with the contact link, but regexp returns the full string.</p>\n\n<p>Check this <a href=\"https://regex101.com/r/fSbnXi/2\" rel=\"nofollow noreferrer\">link</a>.</p>\n"}, {"tags": ["arrays", "postgresql", "rest", "go", "request"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557165237, "post_id": 56008417, "comment_id": 98665565, "body": "Are you sure the two slice fields are populated by <code>c.Bind</code>? Try setting them manually at first just to see if the query works. Also you should not use <code>Query</code> when you don&#39;t expect to scan the returned <code>sql.Rows</code> object, use <code>Exec</code> instead. If you decide to stick with <code>Query</code> then at least make sure to call <code>Close</code> on the <code>sql.Rows</code> value, otherwise you&#39;ll run out of available connections."}, {"owner": {"reputation": 1, "user_id": 8815223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e01cf19a8bdafd41a8dbb41fba151c?s=128&d=identicon&r=PG&f=1", "display_name": "Sten", "link": "https://stackoverflow.com/users/8815223/sten"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557167308, "post_id": 56008417, "comment_id": 98666337, "body": "Thank you MKopriva for your advices."}, {"owner": {"reputation": 1, "user_id": 8815223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e01cf19a8bdafd41a8dbb41fba151c?s=128&d=identicon&r=PG&f=1", "display_name": "Sten", "link": "https://stackoverflow.com/users/8815223/sten"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557213044, "post_id": 56008417, "comment_id": 98678412, "body": "Well the problem is how convert [...] to &#39;{&quot;&quot;,&quot;&quot;...}&#39; ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557213856, "post_id": 56008417, "comment_id": 98678824, "body": "That should be handled by the values returned by <a href=\"https://godoc.org/github.com/lib/pq#Array\" rel=\"nofollow noreferrer\"><code>pq.Array</code></a>. For example passing it <code>l.Langs</code> which is a slice of strings will return <a href=\"https://github.com/lib/pq/blob/master/array.go#L40-L41\" rel=\"nofollow noreferrer\"><code>*pq.StringArray</code></a> which properly translates its contents into <code>{&quot;&quot;, &quot;&quot;, ...}</code> as you can see <a href=\"https://github.com/lib/pq/blob/master/array.go#L524-L545\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1, "user_id": 8815223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e01cf19a8bdafd41a8dbb41fba151c?s=128&d=identicon&r=PG&f=1", "display_name": "Sten", "link": "https://stackoverflow.com/users/8815223/sten"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557220533, "post_id": 56008417, "comment_id": 98682394, "body": "Thank you very much MKopriva for your consistent help, in fact I had l.langs instead of l.Langs as in Cats"}], "owner": {"reputation": 1, "user_id": 8815223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e01cf19a8bdafd41a8dbb41fba151c?s=128&d=identicon&r=PG&f=1", "display_name": "Sten", "link": "https://stackoverflow.com/users/8815223/sten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557164877, "creation_date": 1557157216, "last_edit_date": 1557164877, "question_id": 56008417, "link": "https://stackoverflow.com/questions/56008417/how-to-insert-an-array-in-postgresql-with-data-from-rest-echo", "title": "How to insert an array in Postgresql with data from REST echo", "body": "<p>I receive data into my echo rest api by post method. I have two arrays. I import pq library.\nMy structure is</p>\n\n<pre><code>type Lien struct {\n    LinkID      int      `json: \"linkID\"`\n    Linklabel   string   `json: \"label\"`\n    Linkaddress string   `json: \"address\"`\n    Langs       []string `json: \"langs\"`\n    Cats        []int    `json: \"cats\"`\n}\n</code></pre>\n\n<p>My post function is</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func createLink(c echo.Context) error {\n    l := new(Lien)\n    if err := c.Bind(l); err != nil {\n        return err\n    }\n    sqlStatement := \"INSERT INTO link_test (label, address,langs, cats)VALUES ($1, $2, $3, $4)\"\n    res, err := db.Query(sqlStatement, l.Linklabel, l.Linkaddress, pq.Array(l.Langs), pq.Array(l.Cats))\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Println(res)\n        return c.JSON(http.StatusCreated, l)\n    }\n    return c.String(http.StatusOK, \"ok\")\n}\n</code></pre>\n\n<p>It works for the first two fields but not for the arrays, I always get a null value.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 4089909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3cb4a9065e5e8efaa371dbde6aee707?s=128&d=identicon&r=PG", "display_name": "Konstantin Itskov", "link": "https://stackoverflow.com/users/4089909/konstantin-itskov"}, "is_accepted": true, "score": 6, "last_activity_date": 1557157168, "creation_date": 1557157168, "answer_id": 56008405, "question_id": 56008287, "link": "https://stackoverflow.com/questions/56008287/how-to-initialize-nested-array-of-structs-in-go/56008405#56008405", "title": "How to initialize nested array of structs in GO?", "body": "<p>Unfortunately you cannot define an anonymous struct and then initialize it un-anonymously. If you want to do that, you have to type out the entire struct all over again. This way is easier.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Circuit struct {\n    RemedyCircuitID            string `json:\"RemedyCircuitId\"`\n    Status                     string `json:\"Status\"`\n    VendorName                 string `json:\"VendorName\"`\n    VendorCommunityID          int    `json:\"VendorCommunityId\"`\n    CommunityID                int    `json:\"CommunityId\"`\n    ZLocCommunityID            int    `json:\"ZLocCommunityId\"`\n    CircuitType                string `json:\"CircuitType\"`\n    InstalledSpeed             string `json:\"InstalledSpeed\"`\n    CircuitID                  string `json:\"CircuitId\"`\n    CircuitSpeed               string `json:\"CircuitSpeed\"`\n    CircuitFunction            string `json:\"CircuitFunction\"`\n    ContractID                 string `json:\"ContractId\"`\n    ALocName                   string `json:\"ALocName\"`\n    ZLocName                   string `json:\"ZLocName\"`\n    ExpectedMonthlyCircuitCost string `json:\"ExpectedMonthlyCircuitCost\"`\n    ExpectedOneTimeCircuitCost string `json:\"ExpectedOneTimeCircuitCost\"`\n    TotalCost                  string `json:\"TotalCost\"`\n    CustomerMakeReadyComplete  string `json:\"CustomerMakeReadyComplete\"`\n    CarrierOriginalDueDate     string `json:\"CarrierOriginalDueDate\"`\n    CarrierCurrentDueDate      string `json:\"CarrierCurrentDueDate\"`\n    CarrierCompletion          string `json:\"CarrierCompletion\"`\n    EnaTurnUpDate              string `json:\"EnaTurnUpDate\"`\n    SiteVisit                  string `json:\"SiteVisit\"`\n    DisconnectRequested        string `json:\"DisconnectRequested\"`\n    DisconnectEffective        string `json:\"DisconnectEffective\"`\n}\n\ntype Error struct {\n    ErrorCode string `json:\"ErrorCode\"`\n    FieldName string `json:\"FieldName\"`\n    Message   string `json:\"Message\"`\n}\n\ntype ResponseStatus struct {\n    ErrorCode  string  `json:\"ErrorCode\"`\n    Message    string  `json:\"Message\"`\n    StackTrace string  `json:\"StackTrace\"`\n    Errors     []Error `json:\"Errors\"`\n}\n\ntype RemedyCircuitsResp struct {\n    Circuits       []Circuit      `json:\"Circuits\"`\n    ResponseStatus ResponseStatus `json:\"ResponseStatus\"`\n}\n\nfunc main() {\n    fmt.Printf(\"%#v\\n\", RemedyCircuitsResp{\n        Circuits: []Circuit{{}, {}, {}, {}},\n    })\n}\n</code></pre>\n\n<p>Alternatively you have to do something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype RemedyCircuitsResp struct {\n    Circuits []struct {\n        RemedyCircuitID            string `json:\"RemedyCircuitId\"`\n        Status                     string `json:\"Status\"`\n        VendorName                 string `json:\"VendorName\"`\n        VendorCommunityID          int    `json:\"VendorCommunityId\"`\n        CommunityID                int    `json:\"CommunityId\"`\n        ZLocCommunityID            int    `json:\"ZLocCommunityId\"`\n        CircuitType                string `json:\"CircuitType\"`\n        InstalledSpeed             string `json:\"InstalledSpeed\"`\n        CircuitID                  string `json:\"CircuitId\"`\n        CircuitSpeed               string `json:\"CircuitSpeed\"`\n        CircuitFunction            string `json:\"CircuitFunction\"`\n        ContractID                 string `json:\"ContractId\"`\n        ALocName                   string `json:\"ALocName\"`\n        ZLocName                   string `json:\"ZLocName\"`\n        ExpectedMonthlyCircuitCost string `json:\"ExpectedMonthlyCircuitCost\"`\n        ExpectedOneTimeCircuitCost string `json:\"ExpectedOneTimeCircuitCost\"`\n        TotalCost                  string `json:\"TotalCost\"`\n        CustomerMakeReadyComplete  string `json:\"CustomerMakeReadyComplete\"`\n        CarrierOriginalDueDate     string `json:\"CarrierOriginalDueDate\"`\n        CarrierCurrentDueDate      string `json:\"CarrierCurrentDueDate\"`\n        CarrierCompletion          string `json:\"CarrierCompletion\"`\n        EnaTurnUpDate              string `json:\"EnaTurnUpDate\"`\n        SiteVisit                  string `json:\"SiteVisit\"`\n        DisconnectRequested        string `json:\"DisconnectRequested\"`\n        DisconnectEffective        string `json:\"DisconnectEffective\"`\n    } `json:\"Circuits\"`\n    ResponseStatus struct {\n        ErrorCode  string `json:\"ErrorCode\"`\n        Message    string `json:\"Message\"`\n        StackTrace string `json:\"StackTrace\"`\n        Errors     []struct {\n            ErrorCode string `json:\"ErrorCode\"`\n            FieldName string `json:\"FieldName\"`\n            Message   string `json:\"Message\"`\n        } `json:\"Errors\"`\n    } `json:\"ResponseStatus\"`\n}\n\nfunc main() {\n    value := RemedyCircuitsResp{\n        Circuits: []struct {\n            RemedyCircuitID            string `json:\"RemedyCircuitId\"`\n            Status                     string `json:\"Status\"`\n            VendorName                 string `json:\"VendorName\"`\n            VendorCommunityID          int    `json:\"VendorCommunityId\"`\n            CommunityID                int    `json:\"CommunityId\"`\n            ZLocCommunityID            int    `json:\"ZLocCommunityId\"`\n            CircuitType                string `json:\"CircuitType\"`\n            InstalledSpeed             string `json:\"InstalledSpeed\"`\n            CircuitID                  string `json:\"CircuitId\"`\n            CircuitSpeed               string `json:\"CircuitSpeed\"`\n            CircuitFunction            string `json:\"CircuitFunction\"`\n            ContractID                 string `json:\"ContractId\"`\n            ALocName                   string `json:\"ALocName\"`\n            ZLocName                   string `json:\"ZLocName\"`\n            ExpectedMonthlyCircuitCost string `json:\"ExpectedMonthlyCircuitCost\"`\n            ExpectedOneTimeCircuitCost string `json:\"ExpectedOneTimeCircuitCost\"`\n            TotalCost                  string `json:\"TotalCost\"`\n            CustomerMakeReadyComplete  string `json:\"CustomerMakeReadyComplete\"`\n            CarrierOriginalDueDate     string `json:\"CarrierOriginalDueDate\"`\n            CarrierCurrentDueDate      string `json:\"CarrierCurrentDueDate\"`\n            CarrierCompletion          string `json:\"CarrierCompletion\"`\n            EnaTurnUpDate              string `json:\"EnaTurnUpDate\"`\n            SiteVisit                  string `json:\"SiteVisit\"`\n            DisconnectRequested        string `json:\"DisconnectRequested\"`\n            DisconnectEffective        string `json:\"DisconnectEffective\"`\n        }{{}, {}, {}, {}},\n    }\n    fmt.Printf(\"%#v\\n\", value)\n}\n</code></pre>\n"}], "owner": {"reputation": 2393, "user_id": 7648377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lK7JG.jpg?s=128&g=1", "display_name": "Andrei Lupuleasa", "link": "https://stackoverflow.com/users/7648377/andrei-lupuleasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56008405, "answer_count": 1, "score": 2, "last_activity_date": 1557157168, "creation_date": 1557156672, "last_edit_date": 1557156850, "question_id": 56008287, "link": "https://stackoverflow.com/questions/56008287/how-to-initialize-nested-array-of-structs-in-go", "title": "How to initialize nested array of structs in GO?", "body": "<p>I'm having this struct:</p>\n\n<pre><code>type RemedyCircuitsResp struct {\n    Circuits []struct {\n        RemedyCircuitID            string `json:\"RemedyCircuitId\"`\n        Status                     string `json:\"Status\"`\n        VendorName                 string `json:\"VendorName\"`\n        VendorCommunityID          int    `json:\"VendorCommunityId\"`\n        CommunityID                int    `json:\"CommunityId\"`\n        ZLocCommunityID            int    `json:\"ZLocCommunityId\"`\n        CircuitType                string `json:\"CircuitType\"`\n        InstalledSpeed             string `json:\"InstalledSpeed\"`\n        CircuitID                  string `json:\"CircuitId\"`\n        CircuitSpeed               string `json:\"CircuitSpeed\"`\n        CircuitFunction            string `json:\"CircuitFunction\"`\n        ContractID                 string `json:\"ContractId\"`\n        ALocName                   string `json:\"ALocName\"`\n        ZLocName                   string `json:\"ZLocName\"`\n        ExpectedMonthlyCircuitCost string `json:\"ExpectedMonthlyCircuitCost\"`\n        ExpectedOneTimeCircuitCost string `json:\"ExpectedOneTimeCircuitCost\"`\n        TotalCost                  string `json:\"TotalCost\"`\n        CustomerMakeReadyComplete  string `json:\"CustomerMakeReadyComplete\"`\n        CarrierOriginalDueDate     string `json:\"CarrierOriginalDueDate\"`\n        CarrierCurrentDueDate      string `json:\"CarrierCurrentDueDate\"`\n        CarrierCompletion          string `json:\"CarrierCompletion\"`\n        EnaTurnUpDate              string `json:\"EnaTurnUpDate\"`\n        SiteVisit                  string `json:\"SiteVisit\"`\n        DisconnectRequested        string `json:\"DisconnectRequested\"`\n        DisconnectEffective        string `json:\"DisconnectEffective\"`\n    } `json:\"Circuits\"`\n    ResponseStatus struct {\n        ErrorCode  string `json:\"ErrorCode\"`\n        Message    string `json:\"Message\"`\n        StackTrace string `json:\"StackTrace\"`\n        Errors     []struct {\n            ErrorCode string `json:\"ErrorCode\"`\n            FieldName string `json:\"FieldName\"`\n            Message   string `json:\"Message\"`\n        } `json:\"Errors\"`\n    } `json:\"ResponseStatus\"`\n}\n</code></pre>\n\n<p>I've tried to initialize Circuits and Errors but I don't know how:</p>\n\n<pre><code>    allCircuits := RemedyCircuitsResp{}\n    allCircuits.Circuits = make([]RemedyCircuitsResp.Circuits, 0)\n    allCircuits.ResponseStatus.Errors = make([]RemedyCircuitsResp.ResponseStatus.Errors, 0)\n</code></pre>\n\n<p>Visual Studio Code says:</p>\n\n<pre><code>RemedyCircuitsResp.Circuits undefined (type RemedyCircuitsResp has no method Circuits)\nRemedyCircuitsResp.ResponseStatus undefined (type RemedyCircuitsResp has no method ResponseStatus)\n</code></pre>\n"}, {"tags": ["go", "makefile"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1557155919, "post_id": 56008017, "comment_id": 98661488, "body": "go uses the same source code for all os&#39;es so you can just make 1 test file and use that for every os"}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1557158953, "post_id": 56008017, "comment_id": 98662981, "body": "you could move your release build and test into docker, run it inside the container"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1557168507, "post_id": 56008017, "comment_id": 98666786, "body": "@MadWombat sure but I don&#39;t want to repeat the makefile code for both local and docker builds (there&#39;s a lot more to it than shown in the minimal example in the question)."}], "answers": [{"comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1557156803, "post_id": 56008291, "comment_id": 98661963, "body": "Because I also want to build the executable for use on my local system. So &quot;build&quot; should only cross-compile when it&#39;s invoked via &quot;release&quot;."}, {"owner": {"reputation": 125, "user_id": 4089909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3cb4a9065e5e8efaa371dbde6aee707?s=128&d=identicon&r=PG", "display_name": "Konstantin Itskov", "link": "https://stackoverflow.com/users/4089909/konstantin-itskov"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1557157355, "post_id": 56008291, "comment_id": 98662210, "body": "Ahhh... makes total sense. In that case you have two options. a. put the environment variable definitions inside of the Dockerfile or b. write an if statement inside of the Makefile that runs two different <code>go build ...</code>"}, {"owner": {"reputation": 125, "user_id": 4089909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3cb4a9065e5e8efaa371dbde6aee707?s=128&d=identicon&r=PG", "display_name": "Konstantin Itskov", "link": "https://stackoverflow.com/users/4089909/konstantin-itskov"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1557157683, "post_id": 56008291, "comment_id": 98662358, "body": "Or c. write another Makefile targer that is run by <code>release</code>, separate from the one you run locally. Don&#39;t over engineer. :)"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1557157923, "post_id": 56008291, "comment_id": 98662477, "body": "Ah wait - your observation about setting env vars on the command line has inspired the answer, I can just unset them on the &quot;test&quot; command so it uses the local system os/arch!"}], "tags": [], "owner": {"reputation": 125, "user_id": 4089909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3cb4a9065e5e8efaa371dbde6aee707?s=128&d=identicon&r=PG", "display_name": "Konstantin Itskov", "link": "https://stackoverflow.com/users/4089909/konstantin-itskov"}, "is_accepted": false, "score": 1, "last_activity_date": 1557156677, "creation_date": 1557156677, "answer_id": 56008291, "question_id": 56008017, "link": "https://stackoverflow.com/questions/56008017/makefile-environment-variable-for-specific-target/56008291#56008291", "title": "Makefile environment variable for specific target", "body": "<p>Why not do something like this? It will just set those environment variables during that <code>go</code> execution.</p>\n\n<pre><code>    # Generates a container release artifact.\nrelease: build\n  docker build ...\n\n# Generates an executable for local use.\nbuild: test\n  GOOS=linux GOARCH=amd64 go build ...\n\ntest: fmt vet\n  go test ./...\n\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1557158073, "creation_date": 1557158073, "answer_id": 56008639, "question_id": 56008017, "link": "https://stackoverflow.com/questions/56008017/makefile-environment-variable-for-specific-target/56008639#56008639", "title": "Makefile environment variable for specific target", "body": "<p>I just realized that I can unset the env vars in the troublesome test command itself:</p>\n\n<pre><code>test: fmt vet\n    GOOS= GOARCH= go test ./...\n</code></pre>\n\n<p>This way the \"go test\" command will always use the local system OS and architecture (as it should!).</p>\n\n<p>Thx @KonstantinItskov for the inspiration</p>\n"}, {"comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1557168386, "post_id": 56009263, "comment_id": 98666746, "body": "Yes, this works great and probably reads a bit better than my solution. Ultimately this is the proper fix since testing can only be done on the local platform, so those env vars should never be set for the test target. Nit: spelling text/test"}], "tags": [], "owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "is_accepted": true, "score": 2, "last_activity_date": 1557168725, "last_edit_date": 1557168725, "creation_date": 1557160861, "answer_id": 56009263, "question_id": 56008017, "link": "https://stackoverflow.com/questions/56008017/makefile-environment-variable-for-specific-target/56009263#56009263", "title": "Makefile environment variable for specific target", "body": "<p>I would do it this way:</p>\n\n<pre><code>test: export GOOS=\ntest: export GOARCH=\ntest: fmt vet\n    go test ./...\n</code></pre>\n"}], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "accepted_answer_id": 56009263, "answer_count": 3, "score": 0, "last_activity_date": 1557168725, "creation_date": 1557155758, "last_edit_date": 1557157108, "question_id": 56008017, "link": "https://stackoverflow.com/questions/56008017/makefile-environment-variable-for-specific-target", "title": "Makefile environment variable for specific target", "body": "<p>I'm working on a go project which has a Makefile like below. Note that the \"release\" target sets two environment variables so that the \"build\" target cross-compiles for a specific architecture (which is possibly not that of the build system).</p>\n\n<pre class=\"lang-make prettyprint-override\"><code># Generates a container release artifact.\nrelease: export GOOS=linux\nrelease: export GOARCH=amd64\nrelease: build\n  docker build ...\n\n# Generates an executable for local use.\nbuild: test\n  go build ...\n\ntest: fmt vet\n  go test ./...\n\n...\n</code></pre>\n\n<p>The problems is that the <code>GOOS</code> and <code>GOARCH</code> env vars are also detected by the \"go test\" command which causes that step to fail since <a href=\"https://stackoverflow.com/a/44146306/244128\">cross-platform testing apparently is not supported</a>.</p>\n\n<p>To put it another way, it's like I want to clear the env vars for the \"test\" target, but the example below doesn't appear to unset the vars as expected:</p>\n\n<pre><code>unexport GOOS\nunexport GOARCH\ntest: fmt vet\n    go test ./...\n</code></pre>\n\n<p>I could remove the \"test\" dependency for the \"build\" target and it works fine but that seems like the wrong approach since I wouldn't want to build or release the binary if the tests fail.</p>\n\n<p>Can I somehow modify the Makefile so that the <code>GOOS</code> and <code>GOARCH</code> environment variables are set by the \"release\" target and used by the \"build\" target but not the dependent \"test\" target?</p>\n\n<p>Is there perhaps some other way to cross compile for release and still run the tests as a dependency without otherwise complicating things (such as building via Docker, etc)?  Note that the make targets are a bit more complicated than the example above due to several flags for the release and build targets.</p>\n"}, {"tags": ["go", "go-xorm"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1557155817, "post_id": 56007123, "comment_id": 98661439, "body": "It seems to not exist: <a href=\"https://github.com/go-xorm/xorm/issues/73\" rel=\"nofollow noreferrer\">github.com/go-xorm/xorm/issues/73</a>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1557155923, "post_id": 56007123, "comment_id": 98661492, "body": "also see <a href=\"https://stackoverflow.com/questions/29435783/gorm-golang-orm-associations\" title=\"gorm golang orm associations\">stackoverflow.com/questions/29435783/&hellip;</a>"}, {"owner": {"reputation": 1587, "user_id": 3033386, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6d8no.png?s=128&g=1", "display_name": "MoralCode", "link": "https://stackoverflow.com/users/3033386/moralcode"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1589055933, "post_id": 56007123, "comment_id": 109142978, "body": "@RickyA their github page has been moved to another platform, but here&#39;s an issue reply from a month ago where they explicitly say they dont support foreign keys right now <a href=\"https://gitea.com/xorm/xorm/issues/1627\" rel=\"nofollow noreferrer\">gitea.com/xorm/xorm/issues/1627</a>"}], "owner": {"reputation": 452, "user_id": 5600965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeOd1.jpg?s=128&g=1", "display_name": "Mahmood Al Rayhan", "link": "https://stackoverflow.com/users/5600965/mahmood-al-rayhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 684, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557152931, "creation_date": 1557152527, "last_edit_date": 1557152931, "question_id": 56007123, "link": "https://stackoverflow.com/questions/56007123/how-to-declare-foreign-key-relationship-in-go-xorm-for-postgres", "title": "How to declare foreign key relationship in go-xorm for postgres?", "body": "<p>I want to declare foreign key relation between tables using XORM in golang for postgres.</p>\n\n<p>I've tried the following schema to create foreign key relationship.</p>\n\n<pre><code>type Author struct {\n    Id uint64 `xorm:\"pk autoincr\"`\n    Name string `xorm:\"VARCHAR(128) NOT NULL\"`\n    Email string `xorm:\"VARCHAR(128) NOT NULL UNIQUE\"`\n    Phone string `xorm:\"VARCHAR(32)\"`\n    Age float32\n    Address string `xorm:\"VARCHAR(256)\"`\n\n    Created time.Time `xorm:\"created\"`\n    Updated time.Time `xorm:\"updated\"`\n}\n\n\ntype Book struct {\n    Id uint64 `xorm:\"pk autoincr\"`\n    Name string `xorm:\"varchar(128) NOT NULL\"`\n    Isbn string `xorm:\"varchar(64) NOT NULL\"`\n    Author *Author `xorm:\"-\"`\n\n    Created time.Time `xorm:\"created\"`\n    Updated time.Time `xorm:\"updated\"`\n}\n</code></pre>\n\n<p>And then,</p>\n\n<pre><code>err := engine.Sync(new(models.Author))\nerr = engine.Sync(new(models.Book))\n</code></pre>\n\n<p>But the above code doesn't create foreign key, even no column named author in Book table.\nHelp me to solve this problem that how i can declare foreign key for postgres.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1557151145, "post_id": 56006727, "comment_id": 98659018, "body": "Because <code>*T</code> and <code>T</code> are two separate types and their <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method sets</a> differ."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557151165, "post_id": 56006727, "comment_id": 98659032, "body": "<code>ToString</code> is defined on the pointer, so if you don&#39;t have a pointer you don&#39;t have that method."}], "owner": {"reputation": 27, "user_id": 9648992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5099294b65e600bd75851552a5d5b6?s=128&d=identicon&r=PG&f=1", "display_name": "Wongfy", "link": "https://stackoverflow.com/users/9648992/wongfy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557151187, "creation_date": 1557151074, "last_edit_date": 1557151187, "question_id": 56006727, "link": "https://stackoverflow.com/questions/56006727/through-reflection-acquisition-method-is-affected-by-whether-the-receiver-is-a-p", "title": "Through reflection acquisition method is affected by whether the receiver is a pointer", "body": "<p>I used Go's reflection function to get the type of the method, but I found that the method I can get is related to whether the recipient is a pointer. Why is that?</p>\n\n<p>When I ran the code below, I got the following result\u3002</p>\n\n<pre><code>\n--- value interface ---\nTest\n--- pointer interface ---\nTest\nToString\n\n</code></pre>\n\n<p>I don't understand how the result obtained by the Method method is related to whether the recipient is a pointer or not.</p>\n\n<pre><code>type User struct{}\ntype Admin struct{ User }\n\nfunc (*User) ToString() {\n    fmt.Println(\"tostring\")\n}\n\nfunc (Admin) Test() {\n    fmt.Println(\"test\")\n}\nfunc main27() { \n    var u Admin\n    methods := func(t reflect.Type) {\n        for i, n := 0, t.NumMethod(); i &lt; n; i++ {\n            m := t.Method(i)\n            fmt.Println(m.Name)\n        }\n    }\n    fmt.Println(\"--- value interface ---\")\n    methods(reflect.TypeOf(u)) \n    fmt.Println(\"--- pointer interface ---\")\n    methods(reflect.TypeOf(&amp;u))\n}\n</code></pre>\n"}, {"tags": ["go", "mongo-go"], "owner": {"reputation": 11, "user_id": 11459078, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wfpWjDBw-ts/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regTo1b8u0lB7X38DUpLnn3lpvUoA/mo/photo.jpg?sz=128", "display_name": "ermazi", "link": "https://stackoverflow.com/users/11459078/ermazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557146555, "creation_date": 1557141312, "last_edit_date": 1557146555, "question_id": 56004079, "link": "https://stackoverflow.com/questions/56004079/how-to-bson-unmarshalextjson-to-parse-time-string-into-isodate", "title": "How to bson.UnmarshalExtJSON to parse Time string into ISODate", "body": "<p>I have raw json:</p>\n\n<pre><code>{\n    \"@timestamp\":\"2019-05-05T19:54:00.455+08:00\"\n}\n</code></pre>\n\n<p>and I have defined struct:</p>\n\n<pre><code>type A struct {\n    Timestamp string bson:\"@timestamp\"\n}\n</code></pre>\n\n<p>How to realize it with <code>bson.UnmarshalExtJSON</code>?</p>\n"}, {"tags": ["go", "unicode"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1557141148, "post_id": 56003838, "comment_id": 98653646, "body": "I&#39;d grep the source of <code>golang.org&#47;x&#47;text&#47;language</code> for a set of sample script names. I&#39;m afraid there may be no such support as the packages under <code>golang.org&#47;x&#47;text</code> are primarily targeted at working with Internet protocols which use codes to refer to languages."}, {"owner": {"reputation": 708, "user_id": 989827, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2dc4984b386fa22692c93300cfcdb394?s=128&d=identicon&r=PG", "display_name": "jeremie", "link": "https://stackoverflow.com/users/989827/jeremie"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1557149125, "post_id": 56003838, "comment_id": 98657870, "body": "@kostix, thanks, I couldn&#39;t really find anything though. Too bad, I feel it creates a kind of inconsistency within the API."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1557155770, "post_id": 56003838, "comment_id": 98661421, "body": "&quot;Inconsistency&quot; is not correct IMO: it would be a thing if parts the code would use or produce codes and other disparate pieces would do the same with scripts, and there would be difficult to mix and match these parts. But supposedly this is an omission. If these names are standardized, I&#39;m pretty much sure it could be possible to add mapping of codes to script names which would be autogenerated (and hence easily updated when another version of the standard is released). I suggest you to <a href=\"https://github.com/golang/text#report-issues--send-patches\" rel=\"nofollow noreferrer\">file an issue</a> against this package."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1557155790, "post_id": 56003838, "comment_id": 98661427, "body": "\u2026and if you do this, please post the link to the issue here, thanks!"}, {"owner": {"reputation": 708, "user_id": 989827, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2dc4984b386fa22692c93300cfcdb394?s=128&d=identicon&r=PG", "display_name": "jeremie", "link": "https://stackoverflow.com/users/989827/jeremie"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1557157519, "post_id": 56003838, "comment_id": 98662286, "body": "@kostix, thanks for the pointers, here&#39;s the issue: <a href=\"https://github.com/golang/go/issues/31862\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/31862</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1557161190, "post_id": 56003838, "comment_id": 98663926, "body": "Please put the <code>x&#47;text: </code> in the issue&#39;s title as suggested by the bit I linked to: &#171;\u2026Prefix your issue with &quot;x/text:&quot; in the subject line, so it is easy to find.&#187;. Also consider adding a comment linking back to this your question\u2014it could help to provide more context for the problem."}], "answers": [{"tags": [], "owner": {"reputation": 708, "user_id": 989827, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2dc4984b386fa22692c93300cfcdb394?s=128&d=identicon&r=PG", "display_name": "jeremie", "link": "https://stackoverflow.com/users/989827/jeremie"}, "is_accepted": false, "score": 0, "last_activity_date": 1557149043, "creation_date": 1557149043, "answer_id": 56006171, "question_id": 56003838, "link": "https://stackoverflow.com/questions/56003838/get-unicode-script-name-in-go/56006171#56006171", "title": "Get unicode script name in Go", "body": "<p>This is the kind of mapping I was after:</p>\n\n<pre><code>var scriptCodeToScriptNames = map[string][]string {\n    \"Adlm\": {\"Adlam\"},\n    \"Afak\": {\"Afaka\"},\n    \"Aghb\": {\"Caucasian_Albanian\"},\n    \"Ahom\": {\"Ahom\"},\n    \"Arab\": {\"Arabic\"},\n    \"Aran\": {\"Arabic\"},\n    \"Armi\": {\"Imperial_Aramaic\"},\n    \"Armn\": {\"Armenian\"},\n    \"Avst\": {\"Avestan\"},\n    \"Bali\": {\"Balinese\"},\n    \"Bamu\": {\"Bamum\"},\n    \"Bass\": {\"Bassa_Vah\"},\n    \"Batk\": {\"Batak\"},\n    \"Beng\": {\"Bengali\"},\n    \"Bhks\": {\"Bhaiksuki\"},\n    \"Bopo\": {\"Bopomofo\"},\n    \"Brah\": {\"Brahmi\"},\n    \"Brai\": {\"Braille\"},\n    \"Bugi\": {\"Buginese\"},\n    \"Buhd\": {\"Buhid\"},\n    \"Cakm\": {\"Chakma\"},\n    \"Cans\": {\"Canadian_Aboriginal\"},\n    \"Cari\": {\"Carian\"},\n    \"Cham\": {\"Cham\"},\n    \"Cher\": {\"Cherokee\"},\n    \"Copt\": {\"Coptic\"},\n    \"Cpmn\": {\"Cypro-Minoan\"},\n    \"Cprt\": {\"Cypriot\"},\n    \"Cyrl\": {\"Cyrillic\"},\n    \"Cyrs\": {\"Cyrillic\"},\n    \"Deva\": {\"Devanagari\"},\n    \"Dogr\": {\"Dogra\"},\n    \"Dsrt\": {\"Deseret\"},\n    \"Dupl\": {\"Duployan\"},\n    \"Egyd\": {\"Egyptian_Demotic\"},\n    \"Egyh\": {\"Egyptian_Hieratic\"},\n    \"Egyp\": {\"Egyptian_Hieroglyphs\"},\n    \"Elba\": {\"Elbasan\"},\n    \"Ethi\": {\"Ethiopic\"},\n    \"Geok\": {\"Khutsuri\"},\n    \"Geor\": {\"Georgian\"},\n    \"Glag\": {\"Glagolitic\"},\n    \"Gong\": {\"Gunjala_Gondi\"},\n    \"Gonm\": {\"Masaram_Gondi\"},\n    \"Goth\": {\"Gothic\"},\n    \"Gran\": {\"Grantha\"},\n    \"Grek\": {\"Greek\"},\n    \"Gujr\": {\"Gujarati\"},\n    \"Guru\": {\"Gurmukhi\"},\n    \"Hanb\": {\"Han\", \"Bopomofo\"},\n    \"Hang\": {\"Hangul\"},\n    \"Hani\": {\"Han\"},\n    \"Hano\": {\"Hanunoo\"},\n    \"Hans\": {\"Han\"},\n    \"Hant\": {\"Han\"},\n    \"Hatr\": {\"Hatran\"},\n    \"Hebr\": {\"Hebrew\"},\n    \"Hira\": {\"Hiragana\"},\n    \"Hluw\": {\"Anatolian_Hieroglyphs\"},\n    \"Hmng\": {\"Pahawh_Hmong\"},\n    \"Hmnp\": {\"Nyiakeng_Puachue_Hmong\"},\n    \"Hrkt\": {\"Hiragana\", \"Katakana\"},\n    \"Hung\": {\"Old_Hungarian\"},\n    \"Inds\": {\"Indus_(Harappan)\"},\n    \"Ital\": {\"Old_Italic\"},\n    \"Jamo\": {\"Hangul\"},\n    \"Java\": {\"Javanese\"},\n    \"Jpan\": {\"Han\", \"Hiragana\", \"Katakana\"},\n    \"Jurc\": {\"Jurchen\"},\n    \"Kali\": {\"Kayah_Li\"},\n    \"Kana\": {\"Katakana\"},\n    \"Khar\": {\"Kharoshthi\"},\n    \"Khmr\": {\"Khmer\"},\n    \"Khoj\": {\"Khojki\"},\n    \"Kitl\": {\"Khitan_large_script\"},\n    \"Kits\": {\"Khitan_small_script\"},\n    \"Knda\": {\"Kannada\"},\n    \"Kore\": {\"Hangul\", \"Han\"},\n    \"Kpel\": {\"Kpelle\"},\n    \"Kthi\": {\"Kaithi\"},\n    \"Lana\": {\"Tai_Tham\"},\n    \"Laoo\": {\"Lao\"},\n    \"Latf\": {\"Latin\"},\n    \"Latg\": {\"Latin\"},\n    \"Latn\": {\"Latin\"},\n    \"Leke\": {\"Leke\"},\n    \"Lepc\": {\"Lepcha\"},\n    \"Limb\": {\"Limbu\"},\n    \"Lina\": {\"Linear_A\"},\n    \"Linb\": {\"Linear_B\"},\n    \"Lisu\": {\"Lisu\"},\n    \"Loma\": {\"Loma\"},\n    \"Lyci\": {\"Lycian\"},\n    \"Lydi\": {\"Lydian\"},\n    \"Mahj\": {\"Mahajani\"},\n    \"Maka\": {\"Makasar\"},\n    \"Mand\": {\"Mandaic\"},\n    \"Mani\": {\"Manichaean\"},\n    \"Marc\": {\"Marchen\"},\n    \"Maya\": {\"Mayan_hieroglyphs\"},\n    \"Mend\": {\"Mende_Kikakui\"},\n    \"Merc\": {\"Meroitic_Cursive\"},\n    \"Mero\": {\"Meroitic_Hieroglyphs\"},\n    \"Mlym\": {\"Malayalam\"},\n    \"Modi\": {\"Modi\"},\n    \"Mong\": {\"Mongolian\"},\n    \"Mroo\": {\"Mro\"},\n    \"Mtei\": {\"Meetei_Mayek\"},\n    \"Mult\": {\"Multani\"},\n    \"Mymr\": {\"Myanmar\"},\n    \"Narb\": {\"Old_North_Arabian\"},\n    \"Nbat\": {\"Nabataean\"},\n    \"Newa\": {\"Newa\"},\n    \"Nkoo\": {\"Nko\"},\n    \"Nshu\": {\"Nushu\"},\n    \"Ogam\": {\"Ogham\"},\n    \"Olck\": {\"Ol_Chiki\"},\n    \"Orkh\": {\"Old_Turkic\"},\n    \"Orya\": {\"Oriya\"},\n    \"Osge\": {\"Osage\"},\n    \"Osma\": {\"Osmanya\"},\n    \"Palm\": {\"Palmyrene\"},\n    \"Pauc\": {\"Pau_Cin_Hau\"},\n    \"Perm\": {\"Old_Permic\"},\n    \"Phag\": {\"Phags_Pa\"},\n    \"Phli\": {\"Inscriptional_Pahlavi\"},\n    \"Phlp\": {\"Psalter_Pahlavi\"},\n    \"Phlv\": {\"Book_Pahlavi\"},\n    \"Phnx\": {\"Phoenician\"},\n    \"Plrd\": {\"Miao\"},\n    \"Prti\": {\"Inscriptional_Parthian\"},\n    \"Rjng\": {\"Rejang\"},\n    \"Rohg\": {\"Hanifi_Rohingya\"},\n    \"Roro\": {\"Rongorongo\"},\n    \"Runr\": {\"Runic\"},\n    \"Samr\": {\"Samaritan\"},\n    \"Sara\": {\"Sarati\"},\n    \"Sarb\": {\"Old_South_Arabian\"},\n    \"Saur\": {\"Saurashtra\"},\n    \"Sgnw\": {\"SignWriting\"},\n    \"Shaw\": {\"Shavian\"},\n    \"Shrd\": {\"Sharada\"},\n    \"Shui\": {\"Shuishu\"},\n    \"Sidd\": {\"Siddham\"},\n    \"Sind\": {\"Khudawadi\"},\n    \"Sinh\": {\"Sinhala\"},\n    \"Sogd\": {\"Sogdian\"},\n    \"Sogo\": {\"Old_Sogdian\"},\n    \"Sora\": {\"Sora_Sompeng\"},\n    \"Soyo\": {\"Soyombo\"},\n    \"Sund\": {\"Sundanese\"},\n    \"Sylo\": {\"Syloti_Nagri\"},\n    \"Syrc\": {\"Syriac\"},\n    \"Syre\": {\"Syriac\"},\n    \"Syrj\": {\"Syriac\"},\n    \"Syrn\": {\"Syriac\"},\n    \"Tagb\": {\"Tagbanwa\"},\n    \"Takr\": {\"Takri\"},\n    \"Tale\": {\"Tai_Le\"},\n    \"Talu\": {\"New_Tai_Lue\"},\n    \"Taml\": {\"Tamil\"},\n    \"Tang\": {\"Tangut\"},\n    \"Tavt\": {\"Tai_Viet\"},\n    \"Telu\": {\"Telugu\"},\n    \"Teng\": {\"Tengwar\"},\n    \"Tfng\": {\"Tifinagh\"},\n    \"Tglg\": {\"Tagalog\"},\n    \"Thaa\": {\"Thaana\"},\n    \"Thai\": {\"Thai\"},\n    \"Tibt\": {\"Tibetan\"},\n    \"Tirh\": {\"Tirhuta\"},\n    \"Ugar\": {\"Ugaritic\"},\n    \"Vaii\": {\"Vai\"},\n    \"Visp\": {\"Visible_Speech\"},\n    \"Wara\": {\"Warang_Citi\"},\n    \"Wcho\": {\"Wancho\"},\n    \"Wole\": {\"Woleai\"},\n    \"Xpeo\": {\"Old_Persian\"},\n    \"Xsux\": {\"Cuneiform\"},\n    \"Yiii\": {\"Yi\"},\n    \"Zanb\": {\"Zanabazar_Square\"},\n    \"Zinh\": {\"Inherited\"},\n    \"Zyyy\": {\"Common\"},\n}\n</code></pre>\n"}], "owner": {"reputation": 708, "user_id": 989827, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2dc4984b386fa22692c93300cfcdb394?s=128&d=identicon&r=PG", "display_name": "jeremie", "link": "https://stackoverflow.com/users/989827/jeremie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557167368, "creation_date": 1557140465, "last_edit_date": 1557167368, "question_id": 56003838, "link": "https://stackoverflow.com/questions/56003838/get-unicode-script-name-in-go", "title": "Get unicode script name in Go", "body": "<p>In Go, I want to get the RangeTable of a script given a specific language.</p>\n\n<pre><code>import (\n    \"golang.org/x/text/language\"\n    \"unicode\"\n)\n\n...\n\nscript, confidence := language.French.Script() \nscriptAsString := script.String() // here scriptAsString = \"Latn\"\nrangeTable, ok := unicode.Scripts[scriptAsString]\n// here ok = false, because the Scripts map has key \"Latin\" and not \"Latn\"\n</code></pre>\n\n<p>The problem is that the following function returns the <a href=\"https://en.wikipedia.org/wiki/ISO_15924#List_of_codes\" rel=\"nofollow noreferrer\">script code</a></p>\n\n<pre><code>func (s Script) String() string \n</code></pre>\n\n<p>Whereas the map <code>unicode.Scripts</code> has all of its keys using the <a href=\"https://en.wikipedia.org/wiki/ISO_15924#List_of_codes\" rel=\"nofollow noreferrer\">script name</a></p>\n\n<p>Do you know if there is a way in the native Go lib to go from a <code>script code</code> to a <code>script name</code>?</p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>opened issue here: github.com/golang/go/issues/31862 </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1557147296, "last_edit_date": 1557147296, "creation_date": 1557146161, "answer_id": 56005396, "question_id": 56003564, "link": "https://stackoverflow.com/questions/56003564/using-net-dialtimeout-with-specific-local-port/56005396#56005396", "title": "Using net.DialTimeout with specific local port", "body": "<p><code>Dial</code> and <code>DialTimeout</code> are just helpers around the <a href=\"https://golang.org/pkg/net/#Dialer\" rel=\"nofollow noreferrer\"><code>net.Dialer</code></a> type, which has all the available options documented.</p>\n\n<p>You can set a local address and the timeout. The <code>Dialer</code> also has a <a href=\"https://golang.org/pkg/net/#Dialer.DialContext\" rel=\"nofollow noreferrer\"><code>DialContext</code></a> method to use a context directly rather than a timeout if desired. </p>\n\n<pre><code>d := net.Dialer{\n    LocalAddr: lAddr,\n    Timeout: timeout,\n}\nconn, err := d.Dial(network, address)\n...\n</code></pre>\n"}], "owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557147296, "creation_date": 1557139404, "question_id": 56003564, "link": "https://stackoverflow.com/questions/56003564/using-net-dialtimeout-with-specific-local-port", "title": "Using net.DialTimeout with specific local port", "body": "<p>I'm trying to use specific source IP port, but net.DialTimeout does not have laddr parameter</p>\n\n<pre><code>my_dial, err := net.DialTimeout(\"tcp\", addr, 3*time.Second)\nconn := tls.Client(my_dial, tlsconf)\n</code></pre>\n\n<p>Then I checked the document, the only method that support <code>laddr</code> is:</p>\n\n<pre><code>func DialIP(network string, laddr, raddr *IPAddr) (*IPConn, error)\n</code></pre>\n\n<p>But it returns net.IPConn instead of net.Conn. </p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["ssl", "go", "tcp", "singlestore"], "answers": [{"tags": [], "owner": {"reputation": 1196, "user_id": 5302387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6161e7c6af146b816cdaefd47811a48?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Chen", "link": "https://stackoverflow.com/users/5302387/jack-chen"}, "is_accepted": true, "score": 0, "last_activity_date": 1557255943, "creation_date": 1557255943, "answer_id": 56029027, "question_id": 56002541, "link": "https://stackoverflow.com/questions/56002541/how-to-make-an-ssl-based-tcp-connection-to-memsql-in-go/56029027#56029027", "title": "How to make an ssl based tcp connection to memsql in Go", "body": "<ol>\n<li><p>Can you clarify what your question is? The SSL authentication is one-way, the client verifies the server. The server verifies the client via their login information.</p></li>\n<li><p>No, MemSQL uses the same port for SSL and non-SSL connections.</p></li>\n<li><p>You may also need to configure the SSL certificate, as described in <a href=\"https://github.com/go-sql-driver/mysql#tls\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql#tls</a>.</p></li>\n<li><p>Most client libraries support connecting with SSL.</p></li>\n</ol>\n\n<blockquote>\n  <p>I've followed the memsql documentation and inserted the certificates to memsql master and aggregator, as well as made the permission check enabled, but still I'm able to get into the memsql without giving the rootCertificate in the login.</p>\n</blockquote>\n\n<p>Is it possible the connection is already using SSL? It may be using SSL-preferred mode without verifying the certificate.</p>\n"}], "owner": {"reputation": 35, "user_id": 8956736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2566a7fe2d81a31c07126ac4f5456e6?s=128&d=identicon&r=PG&f=1", "display_name": "Abc", "link": "https://stackoverflow.com/users/8956736/abc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 56029027, "answer_count": 1, "score": 0, "last_activity_date": 1557255943, "creation_date": 1557135550, "last_edit_date": 1557144089, "question_id": 56002541, "link": "https://stackoverflow.com/questions/56002541/how-to-make-an-ssl-based-tcp-connection-to-memsql-in-go", "title": "How to make an ssl based tcp connection to memsql in Go", "body": "<p>I'm trying to setup an ssl based tcp connection to memsql using Go.</p>\n\n<p>The application/services are running as openshift pods and written in Go. </p>\n\n<ol>\n<li>Can I have one-way authentication to memsql from the service?</li>\n<li>Do I need to enable any port in memsql to listen for tls based ssl connection?</li>\n<li>Apart from updating the DSN in my service to tls=true, what can be the alternative to customise this configuration.</li>\n<li>Can someone suggest an efficient way to connect to memsql with ssl enabled?</li>\n</ol>\n\n<p>I've followed the memsql <a href=\"https://docs.memsql.com/security/v6.7/ssl/\" rel=\"nofollow noreferrer\">documentation</a> and inserted the certificates to memsql master and aggregator, as well as made the permission check enabled, but still I'm able to get into the memsql without giving the rootCertificate in the login.</p>\n\n<p>Currently the connection is established by following code:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", DSN) and\nDSN=root:@tcp(IPAddress:3306)/riodev?interpolateParams=true&amp;parseTime=true\n</code></pre>\n"}, {"tags": ["azure", "file", "go", "storage"], "answers": [{"comments": [{"owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "edited": false, "score": 0, "creation_date": 1557826341, "post_id": 56003608, "comment_id": 98885938, "body": "@MuhammadArijSiddiqui Any update? If it helps you, could you mark it?"}], "tags": [], "owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "is_accepted": false, "score": 1, "last_activity_date": 1557139565, "creation_date": 1557139565, "answer_id": 56003608, "question_id": 56002146, "link": "https://stackoverflow.com/questions/56002146/how-to-list-shares-in-azure-storage-using-go-sdk/56003608#56003608", "title": "How to list shares in azure storage using Go SDK", "body": "<p>Here is my sample code for you. Hope it helps.</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n    \"net/url\"\n\n    \"github.com/Azure/azure-storage-file-go/azfile\"\n)\n\nfunc main() {\n    accountName, accountKey := \"&lt;your account name&gt;\", \"&lt;your account key&gt;\"\n    credential, _ := azfile.NewSharedKeyCredential(accountName, accountKey)\n    serviceURL, _ := url.Parse(\"https://&lt;your account name&gt;.file.core.windows.net/\")\n    p := azfile.NewPipeline(credential, azfile.PipelineOptions{})\n    service := azfile.NewServiceURL(*serviceURL, p)\n    list, _ := service.ListSharesSegment(context.Background(), azfile.Marker{}, azfile.ListSharesOptions{})\n    for i, item := range list.ShareItems {\n        fmt.Println(i, item)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11399483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2473572d71b11f71feafa408a1a36a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Arij Siddiqui", "link": "https://stackoverflow.com/users/11399483/muhammad-arij-siddiqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557146655, "creation_date": 1557134149, "last_edit_date": 1557146655, "question_id": 56002146, "link": "https://stackoverflow.com/questions/56002146/how-to-list-shares-in-azure-storage-using-go-sdk", "title": "How to list shares in azure storage using Go SDK", "body": "<p>I have download \"go get github.com/Azure/azure-storage-file-go/azfile\" this library.</p>\n\n<p>Now I am trying to list shares, files and directories using Go SDK.</p>\n\n<p>But I am stuck. How to call listshare function and also how to authenticate it using Shared key.</p>\n"}, {"tags": ["go", "cassandra", "reconnect", "gocql"], "comments": [{"owner": {"reputation": 1762, "user_id": 6114888, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10208661162904754/picture?type=large", "display_name": "Jim Wartnick", "link": "https://stackoverflow.com/users/6114888/jim-wartnick"}, "edited": false, "score": 2, "creation_date": 1557146839, "post_id": 56002002, "comment_id": 98656558, "body": "Not sure about go, but I tested this with java and the program automatically reconnected to the node once it became available again. Nothing to do. It just worked."}], "answers": [{"tags": [], "owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "is_accepted": true, "score": 1, "last_activity_date": 1557208575, "creation_date": 1557208575, "answer_id": 56016318, "question_id": 56002002, "link": "https://stackoverflow.com/questions/56002002/constantly-reconnect-to-cassandra/56016318#56016318", "title": "Constantly Reconnect to Cassandra", "body": "<p>Special thanks to <a href=\"https://stackoverflow.com/users/6114888/jim-wartnick\">@Jim Wartnick</a> for this. I just tried turning Cassandra off on my local machine and then turning it back on and <code>gocql</code> instantly reconnected without having to use any of the above snippets in my question.</p>\n\n<p>As long as your <code>Cluster</code> and <code>Session</code> have connected to Cassandra at least once, even if Cassandra goes down, they will instantly reconnect to it as soon as Cassandra gets back online.</p>\n\n<p>Many thanks to everyone who helped!</p>\n"}], "owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 56016318, "answer_count": 1, "score": 2, "last_activity_date": 1557208575, "creation_date": 1557133631, "last_edit_date": 1557140404, "question_id": 56002002, "link": "https://stackoverflow.com/questions/56002002/constantly-reconnect-to-cassandra", "title": "Constantly Reconnect to Cassandra", "body": "<p>I have read online that the best practice when using Cassandra is to have 1 <code>Cluster</code> and 1 <code>Session</code> for the lifetime of your service.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>In case our Cassandra server goes down, how do I make sure that my Cluster and/or Session will keep trying to reconnect until our Cassandra server gets back online?</p></li>\n<li><p>Should only the Cluster attempt to reconnect, or only the Session, or both?</p></li>\n</ol>\n\n<p>We are using <code>Go</code> and <a href=\"http://github.com/gocql/gocql\" rel=\"nofollow noreferrer\">github.com/gocql/gocql</a> for our service.</p>\n\n<p>I have seen the following snippet in the <code>gocql</code> documentation, but it looks like it only has a limited number of retries:</p>\n\n<pre><code>cluster.ReconnectionPolicy = &amp;gocql.ConstantReconnectionPolicy{MaxRetries: 10, Interval: 8 * time.Second}\n</code></pre>\n\n<p>I also found the below snippet online, but it doesn't look like it's designed to handle this scenario:</p>\n\n<pre><code>var cluster *gocql.ClusterConfig\nvar session *gocql.Session\n\nfunc getCassandraSession() *gocql.Session {\n    if session == nil || session.Closed() {\n        if cluster == nil {\n            cluster = gocql.NewCluster(\"127.0.0.1:9042\")\n            cluster.Keyspace = \"demodb\"\n            cluster.Consistency = gocql.One\n            cluster.ProtoVersion = 4\n        }\n        var err error\n        if session, err = cluster.CreateSession(); err != nil {\n            panic(err)\n        }\n    }\n    return session\n}\n</code></pre>\n\n<p>Are any of the above methods sufficient to ensure that reconnections are attempted until our Cassandra server gets back online? And if not, what's the best practice for this scenario?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1557132901, "post_id": 56001748, "comment_id": 98649877, "body": "It is <b>not</b> safe."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1557132925, "post_id": 56001748, "comment_id": 98649892, "body": "No, this is racy. Running it under the race detector would have shown you this."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 6931629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DVH5n.png?s=128&g=1", "display_name": "G.yang", "link": "https://stackoverflow.com/users/6931629/g-yang"}, "edited": false, "score": 0, "creation_date": 1557136937, "post_id": 56001821, "comment_id": 98651724, "body": "but it dosen&#39;t panic the goroutine? it will only cause some goroutines to read old data."}, {"owner": {"reputation": 195, "user_id": 6931629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DVH5n.png?s=128&g=1", "display_name": "G.yang", "link": "https://stackoverflow.com/users/6931629/g-yang"}, "edited": false, "score": 0, "creation_date": 1557137055, "post_id": 56001821, "comment_id": 98651778, "body": "Go map is implemented with a pointer.Assign a map to a another map like pointer assignement"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 195, "user_id": 6931629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DVH5n.png?s=128&g=1", "display_name": "G.yang", "link": "https://stackoverflow.com/users/6931629/g-yang"}, "edited": false, "score": 2, "creation_date": 1557137138, "post_id": 56001821, "comment_id": 98651826, "body": "@G.yang The behavior is undefined. If &quot;sometimes&quot; it works for your that also falls under the &quot;undefiend&quot; behavior. It might break miserable at other times or on other platforms. Don&#39;t play with the devil, just use proper synchronization."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 195, "user_id": 6931629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DVH5n.png?s=128&g=1", "display_name": "G.yang", "link": "https://stackoverflow.com/users/6931629/g-yang"}, "edited": false, "score": 2, "creation_date": 1557137200, "post_id": 56001821, "comment_id": 98651853, "body": "@G.yang And it doesn&#39;t matter if maps are pointers under the hood or not. Reading the map pointer and changing it is no exception to the race condition. Read the linked questions / articles for details / examples."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1557137291, "last_edit_date": 1557137291, "creation_date": 1557132925, "answer_id": 56001821, "question_id": 56001748, "link": "https://stackoverflow.com/questions/56001748/assign-a-map-to-another-map-is-safety-in-golang/56001821#56001821", "title": "Assign a map to another map is safety in golang?", "body": "<p>You have goroutines reading the <code>m</code> varaible, and goroutines writing the <code>m</code> variable without explicit synchronization. This is a data race, and therefore undefined behaviour.</p>\n\n<p>Run it with the race detector enabled:</p>\n\n<pre><code>$ go run -race play.go\n==================\nWARNING: DATA RACE\nWrite at 0x00c00008c000 by goroutine 15:\n  main.main.func2()\n      /home/icza/gows/src/play/play.go:17 +0x46\n\nPrevious read at 0x00c00008c000 by goroutine 5:\n  main.main.func1()\n      /home/icza/gows/src/play/play.go:8 +0x45\n\nGoroutine 15 (running) created at:\n  main.main()\n      /home/icza/gows/src/play/play.go:15 +0xdd\n\nGoroutine 5 (finished) created at:\n  main.main()\n      /home/icza/gows/src/play/play.go:7 +0xa4\n==================\nFound 1 data race(s)\nexit status 66\n</code></pre>\n\n<p>See related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/41406501/is-it-safe-to-read-a-function-pointer-concurrently-without-a-lock/41407827#41407827\">Is it safe to read a function pointer concurrently without a lock?</a></p>\n\n<p>Also an example which breaks Go's memory safety with intentional data race: <a href=\"http://blog.stalkr.net/2015/04/golang-data-races-to-break-memory-safety.html\" rel=\"nofollow noreferrer\">Golang data races to break memory safety</a></p>\n"}], "owner": {"reputation": 195, "user_id": 6931629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DVH5n.png?s=128&g=1", "display_name": "G.yang", "link": "https://stackoverflow.com/users/6931629/g-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 56001821, "answer_count": 1, "score": -3, "last_activity_date": 1557137291, "creation_date": 1557132579, "question_id": 56001748, "link": "https://stackoverflow.com/questions/56001748/assign-a-map-to-another-map-is-safety-in-golang", "title": "Assign a map to another map is safety in golang?", "body": "<p>The code like:</p>\n\n<pre><code>    m := make(map[interface{}]interface{})\n    //read\n    for i := 0; i&lt; 10000; i++ {\n        go func() {\n            for range m {\n\n            }\n        }()\n    }\n    //write\n    for i := 0; i&lt; 10000; i++ {\n        go func() {\n            mTemp := make(map[interface{}]interface{})\n            m = mTemp\n        }()\n    }\n</code></pre>\n\n<p>There are 10000 read goroutine access m,and another 10000 write goroutine assign a new map to m, and it's safety?</p>\n"}, {"tags": ["go", "scope", "global-variables"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1557132765, "post_id": 56001682, "comment_id": 98649820, "body": "The <code>init()</code> function prints the <code>Conf</code> global variable, which is distinct from the global <code>Interval</code> variable. The <code>init()</code> function never sets the <code>Interval</code> global variable. And inside <code>main()</code> and in <code>Handle()</code>, you print the <code>Interval</code> variable, not the <code>Interval</code> field of the <code>Conf</code> global variable."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1557133538, "post_id": 56001682, "comment_id": 98650148, "body": "Package level variable expressions are evaluated first, so <code>var Interval = time.Second * Conf.Interval</code> becomes zero, because <code>Conf.Interval</code> is zero. <code>init</code> is executed next, however this has no effect on the global <code>Interval</code>, that&#39;s already initialized and the runtime will not re-initialize it just because the global <code>Conf</code> was populated. After that <code>main</code> is executed. To fix this you can do something like this: <a href=\"https://play.golang.com/p/C_ySH-TMiJd\" rel=\"nofollow noreferrer\">play.golang.com/p/C_ySH-TMiJd</a>. For more details see: <a href=\"https://golang.org/ref/spec#Package_initialization\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Package_initialization</a>."}, {"owner": {"reputation": 59, "user_id": 9902243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XmZBD_x_jqg/AAAAAAAAAAI/AAAAAAAAABY/K98gO8CjpUY/photo.jpg?sz=128", "display_name": "dino123", "link": "https://stackoverflow.com/users/9902243/dino123"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557313527, "post_id": 56001682, "comment_id": 98720752, "body": "@icza my intention is not to print the Conf.Interval. The aim is to initialise the global variable with the value read from config file multiplied by time.Second. Guess, you&#39;ve overlooked the following operation, var Interval = time.Second * Conf.Interval"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557313765, "post_id": 56001682, "comment_id": 98720905, "body": "@dino123 Yes, overlooked that, but mkopriva already answered that the <code>init()</code> function runs after that declaration."}, {"owner": {"reputation": 59, "user_id": 9902243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XmZBD_x_jqg/AAAAAAAAAAI/AAAAAAAAABY/K98gO8CjpUY/photo.jpg?sz=128", "display_name": "dino123", "link": "https://stackoverflow.com/users/9902243/dino123"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557314225, "post_id": 56001682, "comment_id": 98721130, "body": "@mkopriva Thanks for the explanationa and references. The suggested fix didn&#39;t work for me. pls check this link: <a href=\"https://play.golang.com/p/LDEeY1jQL97\" rel=\"nofollow noreferrer\">play.golang.com/p/LDEeY1jQL97</a>. Read from internet: Global and static variables go to data segment that memory is either initialized with constants you provide or by default gets initialized with zero. So global can be initialized with only constant and not on runtime with some local variable. Compiler flashes an error if global is not initialized with a constant."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557314494, "post_id": 56001682, "comment_id": 98721277, "body": "@dino123 <a href=\"https://play.golang.com/p/OCE-2vzWDoc\" rel=\"nofollow noreferrer\">play.golang.com/p/OCE-2vzWDoc</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557314881, "post_id": 56001682, "comment_id": 98721489, "body": "@dino123 the link in your comment is no different from the original code in the question, you&#39;ve only switched from <code>Interval</code> to <code>interval</code> and added a comment to the <code>init</code> function. Is there something specific you didn&#39;t understand in my previous comment? Or something about the linked specification on package initialization that is not clear to you?"}, {"owner": {"reputation": 59, "user_id": 9902243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XmZBD_x_jqg/AAAAAAAAAAI/AAAAAAAAABY/K98gO8CjpUY/photo.jpg?sz=128", "display_name": "dino123", "link": "https://stackoverflow.com/users/9902243/dino123"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557320451, "post_id": 56001682, "comment_id": 98724685, "body": "@mkopriva This works fine.  I&#39;ve understood now. Thanks a lot."}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1557152539, "last_edit_date": 1557152539, "creation_date": 1557151933, "answer_id": 56006946, "question_id": 56001682, "link": "https://stackoverflow.com/questions/56001682/how-to-initialise-a-global-variable-in-go-with-a-value-read-from-a-configuration/56006946#56006946", "title": "How to initialise a global variable in go with a value read from a configuration file at run time", "body": "<p>You already have done the hard part: a global <code>Conf</code> object where the YAML config is unmarshaled to. So simply reference it directly:</p>\n\n<pre><code>// var Interval = time.Second * Conf.Interval // &lt;- don't use this\n\n// use Conf.Interval directly\n\nfunc init() {\n        PopulateConfig(\"./test.config\")\n        Conf.Interval = Conf.Interval * time.Second // convert to seconds here\n}\n\nfunc main() {\n    fmt.Println(\"Inside main, Interval = \", Conf.Interval)\n}\n\nfunc Handle(ticker *time.Ticker) {\n    fmt.Println(\"Inside Handle, Interval = \", Conf.Interval)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/FiheCtV2gtv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FiheCtV2gtv</a></p>\n"}], "owner": {"reputation": 59, "user_id": 9902243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XmZBD_x_jqg/AAAAAAAAAAI/AAAAAAAAABY/K98gO8CjpUY/photo.jpg?sz=128", "display_name": "dino123", "link": "https://stackoverflow.com/users/9902243/dino123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "accepted_answer_id": 56006946, "answer_count": 1, "score": -1, "last_activity_date": 1557152539, "creation_date": 1557132308, "question_id": 56001682, "link": "https://stackoverflow.com/questions/56001682/how-to-initialise-a-global-variable-in-go-with-a-value-read-from-a-configuration", "title": "How to initialise a global variable in go with a value read from a configuration file at run time", "body": "<p>I'm trying to initialize a global variable with an interval value which is read from a configuration file at run time. </p>\n\n<p>The configuration file contains set of key-value pairs.As part of init() function, Using yaml parser the values are parsed and stored in a structure.</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"io/ioutil\"\n        \"time\"\n        yaml \"gopkg.in/yaml.v2\"\n)\n\nfunc init(){\n        PopulateConfig(\"./test.config\")\n}\n\nvar Conf Config\nvar Interval = time.Second * Conf.Interval\n\ntype Config struct {\n        Port     string        `yaml:\"port\"`\n        Interval time.Duration `yaml:\"interval\"`\n}\n\nfunc PopulateConfig(filePath string) {\n        data, err := ioutil.ReadFile(filePath)\n        err = yaml.Unmarshal(data, &amp;Conf)\n        if err != nil {\n        }\n        fmt.Println(\"CONFIG =&gt; \", Conf)\n}\n\nfunc main() {\n        // start timer\n        fmt.Println(\"Inside main, Interval = \", Interval)\n        purgeTicker := time.NewTicker(time.Second * 10)\n        go Handle(purgeTicker)\n        time.Sleep(60 * time.Second)\n\n}\n\nfunc Handle(ticker *time.Ticker) {\n        fmt.Println(\"Inside Handle, Interval = \", Interval)\n        for t := range ticker.C {\n                fmt.Println(\"Calling purge timer at \", t)\n                //Additional processing\n        }\n}\n\n===========================\n\nconfig file:\n# cat test.config\nport: 1234\ninterval: 15\n</code></pre>\n\n<p>The config values are populated correctly within the structure.\nExpected result is to set the global variable with the value read from file.\nBut the actual output is 0.\nActual Result:</p>\n\n<pre><code># ./main\nCONFIG =&gt;  {1234 15ns}\nInside main, Interval =  0s\nInside Handle, Interval =  0s\n</code></pre>\n"}, {"tags": ["html", "string", "go", "unicode", "encode"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1557129626, "creation_date": 1557129626, "answer_id": 56001060, "question_id": 56000962, "link": "https://stackoverflow.com/questions/56000962/how-to-convert-a-string-from-unicode-to-html-entity/56001060#56001060", "title": "How to convert a string from unicode to html entity", "body": "<p>That character is not special in HTML, so you can include it as-is in the output, just be sure to set the proper encoding of the document.</p>\n\n<p>Note that to escape special characters in strings, you may use <a href=\"https://golang.org/pkg/html/#EscapeString\" rel=\"nofollow noreferrer\"><code>html.EscapeString()</code></a>. But because <code>\u0635</code> is not special in HTML, that will not change.</p>\n\n<p>If for some reason you do need to escape it, you may simply use the decimal representation of the <code>rune</code>:</p>\n\n<pre><code>fmt.Println(html.EscapeString(\"\u0635\"))\nfmt.Printf(\"&amp;#%d;\", '\u0635')\n</code></pre>\n\n<p>Outputs (try it on the <a href=\"https://play.golang.org/p/M9QD-nRuVOH\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\u0635\n&amp;#1589;\n</code></pre>\n"}], "owner": {"reputation": 1064, "user_id": 7448025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b840f3fdf13febcfcee463d6dec039c9?s=128&d=identicon&r=PG", "display_name": "Moein Hosseini", "link": "https://stackoverflow.com/users/7448025/moein-hosseini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 56001060, "answer_count": 1, "score": 2, "last_activity_date": 1557130049, "creation_date": 1557129182, "last_edit_date": 1557130049, "question_id": 56000962, "link": "https://stackoverflow.com/questions/56000962/how-to-convert-a-string-from-unicode-to-html-entity", "title": "How to convert a string from unicode to html entity", "body": "<p>I'm trying to convert an Arabic string like this:</p>\n\n<pre><code>\u0635\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>&amp;#1589;\n</code></pre>\n\n<p>Is there a way (or package) to do it in Go?</p>\n"}, {"tags": ["go", "aws-sdk"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1557128560, "post_id": 56000723, "comment_id": 98647967, "body": "What makes you think you need to unmarshal an instance? From what I see it is already a struct that can be used as is."}, {"owner": {"reputation": 21, "user_id": 6847844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3c6012035de5039031b991dc93a0b9?s=128&d=identicon&r=PG&f=1", "display_name": "darthguinea", "link": "https://stackoverflow.com/users/6847844/darthguinea"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1557130137, "post_id": 56000723, "comment_id": 98648672, "body": "My aim is that I can pass in parameters such as ipv4, or instance id dynamically and only return values for those struct values, I didnt want to write an if statement for each parameter if that makes sense"}], "owner": {"reputation": 21, "user_id": 6847844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3c6012035de5039031b991dc93a0b9?s=128&d=identicon&r=PG&f=1", "display_name": "darthguinea", "link": "https://stackoverflow.com/users/6847844/darthguinea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1580783322, "creation_date": 1557128223, "last_edit_date": 1580783322, "question_id": 56000723, "link": "https://stackoverflow.com/questions/56000723/deserialising-aws-struct-to-string-mapping", "title": "Deserialising aws struct to string mapping", "body": "<p>I'm trying to deserialize an AWS struct in go so that I can pass in parameters and output values based on those parameters, for example;</p>\n\n<pre><code>func DisplayResults(conf *config.Configuration,\nregionalData []*ec2.DescribeInstancesOutput) {\n\n  log.Debug(\"Displaying results\")\n  log.Debug(\"Table view [%v]\", conf.Display)\n\n  for _, rv := range regionalData {\n    for _, reservation := range rv.Reservations {\n      for _, instance := range reservation.Instances {\n        var i map[string]interface{}\n        json.Unmarshal(instance, i)\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>I've also tried using:</p>\n\n<pre><code>\"github.com/fatih/structs\"\n</code></pre>\n\n<pre><code>i := structs.Map(instance)\nlog.Print(\"%v\", i)\n</code></pre>\n\n<p>however, I think that I need to somehow derefence the struct because my output looks like this:</p>\n\n<pre><code>RamdiskId:&lt;nil&gt; SriovNetSupport:&lt;nil&gt; VpcId:0xc420321ba0 State:map[Code:0xc42031ea08 Name:0xc420321890] VirtualizationType:0xc420321b90 CapacityReservationId:&lt;nil&gt; ClientToken:0xc420321560 HibernationOptions:map[Configured:0xc42031e96b] IamInstanceProfile:map[Arn:0xc4203215a0 Id:0xc4203215b0] ImageId:0xc4203215c0\n</code></pre>\n\n<p>I've also tried this:</p>\n\n<pre><code>  func DisplayResults(conf *config.Configuration, regionalData []*ec2.DescribeInstancesOutput, parameters []string) {\n  log.Debug(\"Displaying results\")\n  log.Debug(\"Table view [%v]\", conf.Display)\n\n  for _, rv := range regionalData {\n    for _, reservation := range rv.Reservations {\n      for _, instance := range reservation.Instances {\n          y := deref(instance)\n\n         log.Print(\"%v\", y[\"InstanceId\"])\n      }\n    }\n  }\n}\n\n  func deref(instance *ec2.Instance) ec2.Instance {\n  var i ec2.Instance\n  x := &amp;i\n  *x = *instance\n  return i\n }\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1557126068, "post_id": 56000128, "comment_id": 98646961, "body": "<a href=\"https://golang.org/pkg/net/http/#HandleFunc\" rel=\"nofollow noreferrer\">http.HandleFunc()</a> can not be used to register a pattern to match a regular expression."}, {"owner": {"reputation": 4217, "user_id": 5010082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4afc5a5544e4bf8a0d7093a986990392?s=128&d=identicon&r=PG&f=1", "display_name": "cbll", "link": "https://stackoverflow.com/users/5010082/cbll"}, "edited": false, "score": 0, "creation_date": 1557126278, "post_id": 56000128, "comment_id": 98647049, "body": "Are you taking the <code>&#47;</code> into consideration? Also, you might not want to compile a regular expression every time the endpoint is hit - it&#39;s an expensive operation. Compile it elsewhere just once(if it won&#39;t change)."}], "answers": [{"tags": [], "owner": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "is_accepted": false, "score": 1, "last_activity_date": 1557126149, "creation_date": 1557126149, "answer_id": 56000234, "question_id": 56000128, "link": "https://stackoverflow.com/questions/56000128/regex-is-not-working-in-golang-handlefunc-function/56000234#56000234", "title": "Regex is not working in Golang HandleFunc function", "body": "<p>your Regex work on \"localhost:8081/somerandonurl\" because of the first \"/\" so it matched.</p>\n\n<p>you need somthing like \"/(.*$)\" but this will match any /blala/blala/...</p>\n\n<p>you can test your regex from here:\n<a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">Regex</a></p>\n"}], "owner": {"reputation": 61, "user_id": 11135616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-h_GbRB-s0Fg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfGSYp5nia_OE9Tx-SFUzkmmtpQJA/mo/photo.jpg?sz=128", "display_name": "Ankur Chaudhari", "link": "https://stackoverflow.com/users/11135616/ankur-chaudhari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580782358, "creation_date": 1557125621, "last_edit_date": 1580782358, "question_id": 56000128, "link": "https://stackoverflow.com/questions/56000128/regex-is-not-working-in-golang-handlefunc-function", "title": "Regex is not working in Golang HandleFunc function", "body": "<p>I am trying to redirect the URL based on a pattern in Go. If my URL is containing \"clientApi\" then I am sending it to <code>clientApiPoint</code> func otherwise I am sending it to <code>redirectApiPoint</code> func. My <code>handleRequest</code> func is </p>\n\n<pre><code>func handleRequest()  {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/\", homePage)\n    r.HandleFunc(\"/clientApi\", clientApiPoint)\n    r.HandleFunc(\"/{^((?!clientApi).)*$}\", redirectApiPoint)\n    http.Handle(\"/\", r)\n    log.Fatal(http.ListenAndServe(\":8081\", nil))\n} \n</code></pre>\n\n<p><code>{^((?!clientApi).)*$}</code> regex is working fine if my url is something like </p>\n\n<pre><code>localhost:8081/somerandonurl  (sending it to redirectApiPoint func)\n</code></pre>\n\n<p>but if there one or more \"/\" in the url, regex is not redirecting it to <code>redirectApiPoint</code> func.</p>\n\n<pre><code>localhost:8081/somerandonurl/somethingdifferent    (not sending it to redirectApiPoint. 404 page not found message)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "edited": false, "score": 0, "creation_date": 1557123072, "post_id": 55999405, "comment_id": 98645841, "body": "Are you wanting to mock that function so you can test Update? What have you tried that didn&#39;t work?"}, {"owner": {"reputation": 181, "user_id": 4873694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fba1ba75bad8a2ca29c277ec849738c2?s=128&d=identicon&r=PG&f=1", "display_name": "RezaOptic", "link": "https://stackoverflow.com/users/4873694/rezaoptic"}, "reply_to_user": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "edited": false, "score": 0, "creation_date": 1557123640, "post_id": 55999405, "comment_id": 98646022, "body": "yes, i try to mock ``` func TestUpdate(t *testing.T) { \tvar MockFunc = func(userName string) (*User, error) { \t\treturn &amp;User{Username:&quot;foo&quot;, Password:&quot;bar&quot;},nil \t} \tuser := NewUser() \tuser.FindByUsername = MockFunc \tuser.Update(&amp;User{Username:&quot;optic&quot;, Password:&quot;ola&quot;}) }``` but it&#39;s doesn&#39;t work."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557123967, "post_id": 55999405, "comment_id": 98646141, "body": "Please don&#39;t put code in comments, instead update your question. You cannot assign functions to methods in Go. You can write a mock implementation of the interface <code>UserOperation</code> and use that during testing."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1557128686, "post_id": 55999405, "comment_id": 98648030, "body": "@RezaOptic take a look at this: <a href=\"https://play.golang.com/p/G7dutF3Tc74\" rel=\"nofollow noreferrer\">play.golang.com/p/G7dutF3Tc74</a> however this is not really a mock, I would call it a fake or a stub, mocks usually allow you to specify the methods you expect to be called alongside with their arguments and return values and then at the end of the test check whether they were actually called. You may want to give this a try: <a href=\"https://github.com/golang/mock\" rel=\"nofollow noreferrer\">github.com/golang/mock</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2808, "user_id": 98596, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/213851cc1f442df8f40b000f59ecb08a?s=128&d=identicon&r=PG", "display_name": "ftl", "link": "https://stackoverflow.com/users/98596/ftl"}, "is_accepted": false, "score": 2, "last_activity_date": 1557134103, "creation_date": 1557134103, "answer_id": 56002130, "question_id": 55999405, "link": "https://stackoverflow.com/questions/55999405/how-can-i-mock-specific-embedded-method-inside-interface/56002130#56002130", "title": "how can i mock specific embedded method inside interface", "body": "<p>You're mixing two levels of abstraction in your <code>UserOperation</code> interface: <code>Update</code> depends on <code>FindByUsername</code>. To make <code>Update</code> testable you need to inject the <code>UserFinder</code> functionality into your <code>Update</code> method. You can do this e.g. by defining a field in the <code>UserLogic</code> struct:</p>\n\n<pre><code>type UserOperation interface {\n    Update(info *User) error\n}\n\ntype UserFinder func(userName string) (*User, error)\n\ntype UserLogic struct {\n    UserOperation\n    FindByUsername UserFinder\n}\n\n//NewUser struct\nfunc NewUser() *UserLogic { // return structs, accept interfaces!\n    return &amp;UserLogic{\n        findByUsername: FindByUsername\n    }\n}\n\nfunc (u *UserLogic) Update(info *User) error {\n    userInfo, err := u.findByUsername(info.Username)\n    if err != nil {\n        return err\n    }\n    fmt.Println(userInfo.Username, userInfo.Password)\n    fmt.Println(\"do some update logic !!!\")\n    return nil\n}\n\nfunc FindByUsername(userName string) (*User, error) {\n    userInfo := &amp;User{}\n    var exist bool\n    if userInfo, exist = dataStore[userName]; !exist {\n        return nil, errors.New(\"user not found\")\n    }\n    return userInfo, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4873694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fba1ba75bad8a2ca29c277ec849738c2?s=128&d=identicon&r=PG&f=1", "display_name": "RezaOptic", "link": "https://stackoverflow.com/users/4873694/rezaoptic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557134103, "creation_date": 1557121500, "last_edit_date": 1557124777, "question_id": 55999405, "link": "https://stackoverflow.com/questions/55999405/how-can-i-mock-specific-embedded-method-inside-interface", "title": "how can i mock specific embedded method inside interface", "body": "<p>I have this code and I wanna write a unit tests for update function.</p>\n\n<p>how can i mock <code>FindByUsername</code> function ?</p>\n\n<p>I try to overwrite <code>u.FindByUsername</code> but it's doesn't work.</p>\n\n<p>also, I can write some function to give <code>u *UserLogic</code> and <code>userName string</code> as input parameters and execute <code>u.FindByUsername()</code> and mock this function but it's not a clean solution I need a better solution for mocking methods inside <code>UserOperation</code> interface.</p>\n\n<pre><code>package logic\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\nvar (\n    dataStore = map[string]*User{\n        \"optic\": &amp;User{\n            Username: \"bla\",\n            Password: \"ola\",\n        },\n    }\n)\n\n//UserOperation interface\ntype UserOperation interface {\n    Update(info *User) error\n    FindByUsername(userName string) (*User, error)\n}\n\n//User struct\ntype User struct {\n    Username string\n    Password string\n}\n\n//UserLogic struct\ntype UserLogic struct {\n    UserOperation\n}\n\n//NewUser struct\nfunc NewUser() UserOperation {\n    return &amp;UserLogic{}\n}\n\n//Update method\nfunc (u *UserLogic) Update(info *User) error {\n    userInfo, err := u.FindByUsername(info.Username)\n    if err != nil {\n        return err\n    }\n    fmt.Println(userInfo.Username, userInfo.Password)\n    fmt.Println(\"do some update logic !!!\")\n    return nil\n}\n\n//FindByUsername method\nfunc (u *UserLogic) FindByUsername(userName string) (*User, error) {\n    userInfo := &amp;User{}\n    var exist bool\n    if userInfo, exist = dataStore[userName]; !exist {\n        return nil, errors.New(\"user not found\")\n    }\n    return userInfo, nil\n}\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>I try to mock function with this code</p>\n\n<pre><code>func TestUpdate2(t *testing.T) {\n    var MockFunc = func(userName string) (*User, error) {\n        return &amp;User{Username:\"foo\", Password:\"bar\"},nil\n    }\n    user := NewUser()\n    user.FindByUsername = MockFunc\n    user.Update(&amp;User{Username:\"optic\", Password:\"ola\"})\n}\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code", "vscode-settings"], "answers": [{"comments": [{"owner": {"reputation": 719, "user_id": 2995358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/076e6e1653a19d63574e2afac5664ee8?s=128&d=identicon&r=PG&f=1", "display_name": "user2995358", "link": "https://stackoverflow.com/users/2995358/user2995358"}, "edited": false, "score": 0, "creation_date": 1557121925, "post_id": 55999054, "comment_id": 98645499, "body": "Thanks for the quick response.  I tried using the suggested command: go mod edit -go=1.11 I got an error: flag provided but not defined: -go I manually edited to add go 1.11 right under my module declaration in all go.mod files, it did not work."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 719, "user_id": 2995358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/076e6e1653a19d63574e2afac5664ee8?s=128&d=identicon&r=PG&f=1", "display_name": "user2995358", "link": "https://stackoverflow.com/users/2995358/user2995358"}, "edited": false, "score": 0, "creation_date": 1557248200, "post_id": 55999054, "comment_id": 98698154, "body": "@user2995358: See my revised answer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1557248901, "last_edit_date": 1557248901, "creation_date": 1557119149, "answer_id": 55999054, "question_id": 55998703, "link": "https://stackoverflow.com/questions/55998703/limit-vs-code-for-go-to-download-packages-only-for-v-1-11/55999054#55999054", "title": "Limit VS Code for Go to download packages only for v 1.11", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/go1.12\" rel=\"nofollow noreferrer\">Go 1.12 Release Notes (February 2019)</a></p>\n  \n  <p><a href=\"https://golang.org/doc/go1.12#modules\" rel=\"nofollow noreferrer\">Modules</a></p>\n  \n  <p>The go directive in a go.mod file now indicates the version of the\n  language used by the files within that module. It will be set to the\n  current release (go 1.12) if no existing version is present. If the go\n  directive for a module specifies a version newer than the toolchain in\n  use, the go command will attempt to build the packages regardless, and\n  will note the mismatch only if that build fails.</p>\n  \n  <p>This changed use of the go directive means that if you use Go 1.12 to\n  build a module, thus recording go 1.12 in the go.mod file, you will\n  get an error when attempting to build the same module with Go 1.11\n  through Go 1.11.3. Go 1.11.4 or later will work fine, as will releases\n  older than Go 1.11. If you must use Go 1.11 through 1.11.3, you can\n  avoid the problem by setting the language version to 1.11, using the\n  Go 1.12 go tool, via go mod edit -go=1.11.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n<pre><code>$ go help go.mod\n\nThe go.mod file itself is line-oriented, with // comments but\nno /* */ comments. Each line holds a single directive, made up of a\nverb followed by arguments. For example:\n\n  module my/thing\n  go 1.12\n  require other/thing v1.0.2\n  require new/thing/v2 v2.3.4\n  exclude old/thing v1.2.3\n  replace bad/thing v1.4.5 =&gt; good/thing v1.4.5\n\nThe verbs are\n  module, to define the module path;\n  go, to set the expected language version;\n  require, to require a particular module at a given version or later;\n  exclude, to exclude a particular module version from use; and\n  replace, to replace a module version with a different module version.\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>A possible solution to your problem was first introduced in Go1.12: the <code>go.mod</code> verb <code>go</code>, to set the expected language version.</p>\n\n<hr>\n\n<p>UPDATE:</p>\n\n<hr>\n\n<blockquote>\n  <p>Comment: I tried using the suggested command: go mod edit -go=1.11 I\n  got an error: flag provided but not defined: -go I manually edited to\n  add go 1.11 right under my module declaration in all go.mod files, it\n  did not work. \u2013\n  <a href=\"https://stackoverflow.com/users/2995358/user2995358\">user2995358</a></p>\n</blockquote>\n\n<p>Your results are expected. As I explained before and the documentation states, the <code>go.mod</code> verb <code>go</code> was first introduced in Go1.12.</p>\n\n<p>For example, the expected results,</p>\n\n<pre><code>$ go version\ngo version go1.11.10 linux/amd64\n$ go mod edit -go=1.11\nflag provided but not defined: -go\nusage: go mod edit [editing flags] [go.mod]\nRun 'go help mod edit' for details.\n$ \n\n$ go version\ngo version go1.12.5 linux/amd64\n$ go mod edit -go=1.11\n$ \n</code></pre>\n\n<hr>\n\n<p>Read the documentation:</p>\n\n<blockquote>\n<pre><code>$ go version\ngo version go1.11.10 linux/amd64\n$ go1.11 help modules\n\nPreliminary module support\n\nGo 1.11 includes preliminary support for Go modules,\nincluding a new module-aware 'go get' command.\nWe intend to keep revising this support, while preserving compatibility,\nuntil it can be declared official (no longer preliminary),\nand then at a later point we may remove support for work\nin GOPATH and the old 'go get' command.\n$ \n\n\n$ go version\ngo version devel +004fb5cb8d Fri May 3 03:49:11 2019 +0000 linux/amd64\n$ go help modules\n\nModule support\n\nGo 1.13 includes official support for Go modules,\nincluding a module-aware 'go get' command.\nModule-aware mode is active by default.\n$\n</code></pre>\n</blockquote>\n\n<p>Go 1.11 includes only preliminary support for Go modules. Go 1.13 includes full official support for Go modules. </p>\n\n<p>Why do you expect everything to work flawlessly in Go1.11 with only preliminary support?</p>\n"}], "owner": {"reputation": 719, "user_id": 2995358, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/076e6e1653a19d63574e2afac5664ee8?s=128&d=identicon&r=PG&f=1", "display_name": "user2995358", "link": "https://stackoverflow.com/users/2995358/user2995358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1557248901, "creation_date": 1557115896, "last_edit_date": 1557123749, "question_id": 55998703, "link": "https://stackoverflow.com/questions/55998703/limit-vs-code-for-go-to-download-packages-only-for-v-1-11", "title": "Limit VS Code for Go to download packages only for v 1.11", "body": "<p>I am using Visual Studio Code version 1.33.1 as IDE for our Go applications. We would like to use Go version 1.11 for our applications. However looks like one or more of the dependencies we are using has downloaded a package for Go 1.12. Now, VS Code is failing to build the application with the following error:</p>\n\n<blockquote>\n  <p>go build golang.org/x/sys/unix: module requires Go 1.12 go build\n  github.com/pelletier/go-toml: module requires Go 1.12 \n  go [1,1]</p>\n</blockquote>\n\n<p>I tried re-installing Go 1.11, removed the offending packages and let it reinstall. No matter when I tried to build VS Code is downloading the 1.12 version fails to build.\nI would like VS Code not to download 1.12 version of the packages and restrict it to 1.11 only.</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1557371132, "post_id": 55998825, "comment_id": 98744290, "body": "I noticed there was problem when Execing SQL <a href=\"https://github.com/unee-t/bz-database/issues/128#issuecomment-490724862\" rel=\"nofollow noreferrer\">github.com/unee-t/bz-database/issues/128#issuecomment-490724&zwnj;&#8203;862</a> I am tracking master of the Go SQL driver btw 8056f2ca4aa7be2e2e10ab01426a630d5a5bfa81"}, {"owner": {"reputation": 393, "user_id": 3430118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/351a10f392414345ed67a05e986dc4dd?s=128&d=identicon&r=PG", "display_name": "methane", "link": "https://stackoverflow.com/users/3430118/methane"}, "reply_to_user": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1557463430, "post_id": 55998825, "comment_id": 98780628, "body": "I don&#39;t know which query caused such an error.  Could you give us some short example?"}], "tags": [], "owner": {"reputation": 393, "user_id": 3430118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/351a10f392414345ed67a05e986dc4dd?s=128&d=identicon&r=PG", "display_name": "methane", "link": "https://stackoverflow.com/users/3430118/methane"}, "is_accepted": false, "score": 0, "last_activity_date": 1557117650, "last_edit_date": 1557117650, "creation_date": 1557117009, "answer_id": 55998825, "question_id": 55998671, "link": "https://stackoverflow.com/questions/55998671/connecting-with-wrong-collation-to-a-mysql-server/55998825#55998825", "title": "Connecting with wrong collation to a mysql server?", "body": "<p>In most case, there are no problem.  For example, column collation is used regardless connection collation when <code>WHERE column=?</code> is used.</p>\n\n<p>See also: <a href=\"https://dev.mysql.com/doc/refman/5.6/en/charset-collation-coercibility.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/refman/5.6/en/charset-collation-coercibility.html</a></p>\n\n<p>But I can't speak it's 100% safe.  It's safe to use one collation all place.</p>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557117650, "creation_date": 1557115629, "question_id": 55998671, "link": "https://stackoverflow.com/questions/55998671/connecting-with-wrong-collation-to-a-mysql-server", "title": "Connecting with wrong collation to a mysql server?", "body": "<p>I have a Golang program that may connect to databases with different character sets or collation.</p>\n\n<p>For example the default at the time of writing of the Golang MYSQL driver is <strong>utf8mb4_general_ci</strong> <a href=\"https://github.com/go-sql-driver/mysql#collation\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql#collation</a></p>\n\n<p>However if I connect to a database configured like so:</p>\n\n<pre><code>CREATE DATABASE example character set utf8mb4 collate utf8mb4_unicode_ci;\n</code></pre>\n\n<p>Can I expect \"bad things to happen\"? Indexes not to work?</p>\n"}, {"tags": ["go", "mux"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1557089393, "post_id": 55996263, "comment_id": 98639645, "body": "Check networking tab in your browser and update the question with exact requests to that <code>css</code> files that have been performed in every case, including http status codes."}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1557089945, "post_id": 55996263, "comment_id": 98639786, "body": "I have updated my question. Apparently there is a 307 Temporary Redirect happening- but I can&#39;t imagine why."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557090254, "post_id": 55996263, "comment_id": 98639859, "body": "Did you mean to load different css files on these two pages? Or was it supposed to be the same one?"}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "edited": false, "score": 0, "creation_date": 1557090667, "post_id": 55996263, "comment_id": 98639950, "body": "It is intentionally two different css files."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557091852, "post_id": 55996263, "comment_id": 98640192, "body": "is the permissions on the splash.css open enough that the process running the go-server can read it?  Perform a curl command targeted at this css file - to see any other header info e.g. <code>curl http:&#47;&#47;localhost:8080&#47;static&#47;css&#47;splash.css -D &#47;dev&#47;tty</code>"}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557093039, "post_id": 55996263, "comment_id": 98640402, "body": "@colminator I tried that command and it responded &quot;Warning: Failed to open /dev/tty&quot;."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557094202, "post_id": 55996263, "comment_id": 98640634, "body": "@LeslieP. <code>&#47;dev&#47;tty</code> is trick on Mac/Linux to have saved content (via the -D flag) appear on the console. If on another OS, use some temp path <code>&#47;tmp&#47;curl-headers.txt</code> and inspect the file afterwards."}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557094773, "post_id": 55996263, "comment_id": 98640752, "body": "@colminator I&#39;ve added the information that file produced to the question. It seems to be parsing the css as an html file for some reason?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557097389, "post_id": 55996263, "comment_id": 98641200, "body": "It&#39;s redirecting the CSS GET to /login. How are you handling the static routes? That code is missing from your question."}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557098161, "post_id": 55996263, "comment_id": 98641332, "body": "@colminator I&#39;ve added the relevant snip of code to the question, unless you meant something else. Thank you for continuing to help me."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1557098683, "post_id": 55996263, "comment_id": 98641412, "body": "You didn&#39;t add enough. Take a look at the whole router."}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1557099169, "post_id": 55996263, "comment_id": 98641499, "body": "@MichaelHampton can you clarify what you mean by the whole router, or give an example of what you&#39;re looking for? That&#39;s the only handler for the static files in my go code."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1557102360, "post_id": 55996263, "comment_id": 98641979, "body": "Looks like you&#39;re using gorilla/mux. So somewhere you called mux.NewRouter() and started adding stuff to it. You need to look at (and add to your question) all of those things."}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1557106577, "post_id": 55996263, "comment_id": 98642585, "body": "@MichaelHampton I&#39;ve gone ahead and added some more of my code to the third code block. I&#39;ve included everything that could possibly be relevant to the login page."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557107489, "post_id": 55996263, "comment_id": 98642702, "body": "Seems quite clear that verifyUser is called for the CSS file. We can&#39;t tell why from the code you show, because it&#39;s incomplete."}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557108631, "post_id": 55996263, "comment_id": 98642885, "body": "@Peter what else should I add?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1557110183, "post_id": 55996263, "comment_id": 98643129, "body": "Indeed, your main() function just sets up a couple of routes and then exits? That can&#39;t possibly be your actual code."}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1557112200, "post_id": 55996263, "comment_id": 98643468, "body": "@MichaelHampton I am having a very specific problem that has to do with my /login route only. I do have other routes like /upload and some session handling code but I didn&#39;t think they were relevant... but if you really want to look at the whole go file I can add it. I&#39;m just confused as to why it&#39;s necessary. (And yes, it really is just a bunch of routes.. it&#39;s a fairly simple app. Sorry for being dumb.)"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1557115197, "post_id": 55996263, "comment_id": 98643994, "body": "Your question is that the wrong route is being called. So, yes, it is necessary to look at all of them."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557153657, "post_id": 55996263, "comment_id": 98660300, "body": "As all of the above comments suggest - another handler is intercepting your static file route - so I think you need to simplify your route architecture. For example, you have several http FileServer routes - I would consider consolidating all of them into a single &quot;/static&quot; route handler. All your html/css would need to update their paths to reference their relevant files correctly (<code>&#47;static&#47;css&#47;...</code>  <code>&#47;static&#47;img&#47;...</code> <code>&#47;static&#47;files</code> etc.)"}, {"owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557581018, "post_id": 55996263, "comment_id": 98817950, "body": "@colminator Thank you!! Removing the second PathPrefix line appears to be the correct answer. Could you add it as a solution so I can mark it as correct?"}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 0, "last_activity_date": 1557582471, "creation_date": 1557582471, "answer_id": 56090932, "question_id": 55996263, "link": "https://stackoverflow.com/questions/55996263/how-to-serve-static-files-for-all-pages-not-just-a-few/56090932#56090932", "title": "How to serve static files for all pages, not just a few", "body": "<p>As the comments suggest another handler is intercepting your static file route. Try simplifying your routes. Reduce:</p>\n\n<pre><code>mux.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\nmux.PathPrefix(\"/css/\").Handler(http.StripPrefix(\"/css/\", http.FileServer(http.Dir(\"css\"))))\nmux.PathPrefix(\"/img/\").Handler(http.StripPrefix(\"/img/\", http.FileServer(http.Dir(\"img\"))))\nmux.PathPrefix(\"/files/\").Handler(http.StripPrefix(\"/files/\", http.FileServer(http.Dir(\"files\"))))\n</code></pre>\n\n<p>to a single route:</p>\n\n<pre><code>mux.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n</code></pre>\n\n<p>and move all your static files under the <code>static</code> directory - updating any html/css paths accordingly.</p>\n"}], "owner": {"reputation": 113, "user_id": 7000465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e5c5c32f846e672c0b14b5e53df541?s=128&d=identicon&r=PG&f=1", "display_name": "Leslie P.", "link": "https://stackoverflow.com/users/7000465/leslie-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 56090932, "answer_count": 1, "score": 1, "last_activity_date": 1557582471, "creation_date": 1557089104, "last_edit_date": 1557144055, "question_id": 55996263, "link": "https://stackoverflow.com/questions/55996263/how-to-serve-static-files-for-all-pages-not-just-a-few", "title": "How to serve static files for all pages, not just a few", "body": "<p>I'm having a problem with my Go project where one route handles CSS fine and another route's CSS is broken. The CSS used to work on both pages, but now it isn't loading for /login.html.</p>\n\n<p>I know that I'm properly stripping the prefix for the /static/ folder because it's working in once place and not another. I also directly copied and pasted the header code from the working page to the not-working page (being careful to use the correct css file).</p>\n\n<p>Negroni is showing that the application is making the call to the correct location: </p>\n\n<pre><code>999.3\u00b5s | localhost:8080 | GET /static/css/splash.css\n</code></pre>\n\n<p>The correctly working html file index.html:</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html lang=\"en\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" /&gt;\n    &lt;title&gt;Pando&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" href=\"/static/css/index.css\" type=\"text/css\" /&gt;\n    &lt;link href=\"https://fonts.googleapis.com/css?family=Bitter|Nunito:400,700\" rel=\"stylesheet\"&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n    &lt;div id=\"sidebar\"&gt;\n        &lt;p id=\"logo\"&gt;&lt;img src=\"/static/img/logo.svg\" height=\"14px\"&gt;Pando&lt;/p&gt;\n        &lt;span id=\"all-files\" class=\"selected\"&gt;All Files&lt;/span&gt;\n        &lt;p id=\"shared-collections\"&gt;Shared Collections&lt;img src=\"/static/img/gear.svg\" /&gt;&lt;/p&gt;\n        &lt;div class=\"collections\"&gt;\n            &lt;span&gt;Collection 1&lt;/span&gt;\n            &lt;span&gt;Collection 2&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;p id=\"my-collections\"&gt;My Collections&lt;img src=\"/static/img/gear.svg\" /&gt;&lt;/p&gt;\n        &lt;div class=\"collections\"&gt;\n            &lt;span&gt;Collection 1&lt;/span&gt;\n            &lt;span&gt;Collection 2&lt;/span&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div id=\"header\"&gt;\n        &lt;input type=\"button\" id=\"upload-launch-button\" value=\"Upload\" onclick=\"showUploadDialog()\"&gt;&lt;/button&gt;\n\n\n        &lt;form id=\"search\"&gt;\n            &lt;input type=\"search\" placeholder=\"Search..\"&gt;\n            &lt;input type=\"button\"&gt;&lt;img src=\"/static/img/search.svg\"&gt;&lt;/button&gt;\n        &lt;/form&gt;\n\n        &lt;div id=\"user\"&gt;\n            &lt;img src=\"/static/img/user.svg\"&gt;{{.User}}&lt;a href=\"/logout\"&gt;(Log out)&lt;/a&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n   &lt;!-- &lt;span id=\"filter\"&gt;Latest Files&lt;/span&gt; --&gt;\n\n    &lt;div id=\"results\"&gt;\n        {{range .Files}}\n        &lt;div class=\"img-container\"&gt;\n            &lt;img src=\"/files/{{.Name}}\" id=\"file-{{.PK}}\"&gt;\n            &lt;div class=\"hover-actions\"&gt;\n                &lt;a href=\"/files/{{.Name}}\" download&gt;&lt;img src=\"/static/img/download.svg\"&gt;&lt;/a&gt;\n                &lt;img src=\"/static/img/edit.svg\"&gt;\n                &lt;img src=\"/static/img/delete.svg\" onclick=\"deleteFile('/files/{{.Name}}', {{.PK}})\"&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n        {{end}}\n    &lt;/div&gt;\n\n    &lt;div class=\"dialog\" id=\"upload-dialog\"&gt;\n        &lt;div class=\"dialog-name\"&gt;Upload&lt;/div&gt;\n        &lt;form id=\"upload\" enctype=\"multipart/form-data\" action=\"/upload\" method=\"post\"&gt;\n            &lt;input type=\"file\" id=\"selectedFile\" name=\"file\" /&gt; &lt;!--multiple later display none--&gt;\n            &lt;input id=\"upload-button\" type=\"submit\" value=\"Upload\" onclick=\"hideUploadDialog()\" /&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n\n    &lt;script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.3.1.js\"&gt;&lt;/script&gt;\n    &lt;script type=\"text/javascript\" src=\"/static/js/script.js\"&gt;&lt;/script&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>Login.html:</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" /&gt;\n    &lt;title&gt;Pando&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" href=\"/static/css/splash.css\" type=\"text/css\" /&gt;\n    &lt;link href=\"https://fonts.googleapis.com/css?family=Bitter|Nunito:400,700\" rel=\"stylesheet\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;section class=\"section-a\"&gt;\n            &lt;div id=\"logo\"&gt;&lt;img src=\"/static/img/logo.svg\"&gt;Pando&lt;/div&gt;\n            &lt;p id=\"welcome\"&gt;Join Pando.&lt;/p&gt;\n            &lt;div id=\"buttoncont\"&gt;\n                &lt;a href=\"/static/html/index.html\"&gt;&lt;span id=\"enter\" class=\"button\"&gt;Enter&lt;/span&gt;&lt;/a&gt;\n            &lt;/div&gt;\n            &lt;/section&gt;\n    &lt;section class=\"section-b\"&gt;\n        &lt;form id=\"login-form\"&gt;\n            &lt;div&gt;\n                &lt;label&gt;Email&lt;/label&gt;&lt;input type=\"email\" name=\"username\" required&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n                &lt;label&gt;Password&lt;/label&gt;&lt;input type=\"password\" name=\"password\" required&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n                &lt;input type=\"submit\" value=\"Register\" name=\"register\"&gt;\n                &lt;input type=\"submit\" value=\"Log In\" name=\"login\"&gt;\n            &lt;/div&gt;\n            &lt;div id=\"error\"&gt;{{.Error}}&lt;/div&gt;\n        &lt;/form&gt;\n    &lt;/section&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The complete go file:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"html/template\"\n    \"io/ioutil\"\n    \"os\"\n    \"path/filepath\"\n    \"strconv\"\n    \"time\"\n\n    \"net/http\"\n\n    \"gopkg.in/gorp.v1\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n\n    \"encoding/json\"\n\n    \"golang.org/x/crypto/bcrypt\"\n\n    sessions \"github.com/goincremental/negroni-sessions\"\n    \"github.com/goincremental/negroni-sessions/cookiestore\"\n    gmux \"github.com/gorilla/mux\"\n    \"github.com/urfave/negroni\"\n)\n\n/*File struct\nPK primary key\nName is the original name of the file; new file location at /files/{name}\nFile Type is the extension of the file; valid file types are image formats, PDF, .AI, .PSD, and MS Word docs\nUpload Date is a static value indicating when the file was uploaded\nLast Modified records if any changes are made to the file while it's on the server\nUser is the uploading user\n\nEventually I will probably want to refactor this so that I can allow for files with the same name to coexist. Not sure how to do that right now elegantly.\n*/\ntype File struct {\n    PK           int64  `db:\"pk\"`\n    Name         string `db:\"name\"`\n    FileType     string `db:\"type\"`\n    UploadDate   string `db:\"uploadtime\"`\n    LastModified string `db:\"modtime\"`\n    User         string `db:\"user\"`\n}\n\n// Tag struct\ntype Tag struct {\n    PK     int64  `db:\"pk\"`\n    FilePK int64  `db:\"filepk\"`\n    Name   string `db:\"name\"`\n}\n\n// Collection struct\ntype Collection struct {\n    PK          int64  `db:\"pk\"`\n    Name        string `db:\"name\"`\n    ContentName string `db:\"contentname\"`\n    ContentType string `db:\"type\"`\n}\n\n// User struct\ntype User struct {\n    Username string `db:\"username\"`\n    Secret   []byte `db:\"secret\"`\n}\n\n// Page struct\ntype Page struct {\n    Files  []File\n    Filter string\n    User   string\n}\n\n// LoginPage struct\ntype LoginPage struct {\n    Error string\n}\n\n// UploadPage struct\ntype UploadPage struct {\n    Error string\n}\n\nvar db *sql.DB\nvar dbmap *gorp.DbMap\n\nfunc main() {\n\n    initDb()\n    index := template.Must(template.ParseFiles(\"html/index.html\"))\n    login := template.Must(template.ParseFiles(\"html/login.html\"))\n    upload := template.Must(template.ParseFiles(\"html/upload.html\"))\n\n    mux := gmux.NewRouter()\n    defer db.Close()\n\n    mux.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n    mux.PathPrefix(\"/css/\").Handler(http.StripPrefix(\"/css/\", http.FileServer(http.Dir(\"css\"))))\n    mux.PathPrefix(\"/img/\").Handler(http.StripPrefix(\"/img/\", http.FileServer(http.Dir(\"img\"))))\n    mux.PathPrefix(\"/files/\").Handler(http.StripPrefix(\"/files/\", http.FileServer(http.Dir(\"files\"))))\n\n    // Login\n    mux.HandleFunc(\"/login\", func(w http.ResponseWriter, r *http.Request) {\n        var p LoginPage\n\n        if r.FormValue(\"register\") != \"\" {\n            secret, _ := bcrypt.GenerateFromPassword([]byte(r.FormValue(\"password\")), bcrypt.DefaultCost)\n            user := User{r.FormValue(\"username\"), secret}\n            if err := dbmap.Insert(&amp;user); err != nil {\n                p.Error = err.Error()\n            } else {\n                sessions.GetSession(r).Set(\"User\", user.Username)\n                http.Redirect(w, r, \"/\", http.StatusFound)\n                return\n            }\n        } else if r.FormValue(\"login\") != \"\" {\n            user, err := dbmap.Get(User{}, r.FormValue(\"username\"))\n            if err != nil {\n                p.Error = err.Error()\n            } else if user == nil {\n                p.Error = \"No user account exists for the username \" + r.FormValue(\"username\")\n            } else {\n                u := user.(*User)\n                if err = bcrypt.CompareHashAndPassword(u.Secret, []byte(r.FormValue(\"password\"))); err != nil {\n                    p.Error = err.Error()\n                } else {\n                    sessions.GetSession(r).Set(\"User\", u.Username)\n                    http.Redirect(w, r, \"/\", http.StatusFound)\n                    return\n                }\n            }\n        }\n\n        if err := login.ExecuteTemplate(w, \"login.html\", p); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n        }\n\n    })\n\n    // Upload\n    mux.HandleFunc(\"/upload\", func(w http.ResponseWriter, r *http.Request) {\n\n        var p UploadPage\n\n        // Checks filesize against max upload size (10MB)\n        if err := r.ParseMultipartForm(10 &lt;&lt; 20); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n        // reads file\n        fileType := r.PostFormValue(\"type\")\n        file, header, err := r.FormFile(\"file\")\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n        defer file.Close()\n        fileBytes, err := ioutil.ReadAll(file)\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n        // checks the filetype against expected mime types\n        mimetype := http.DetectContentType(fileBytes)\n        if mimetype != \"image/jpeg\" &amp;&amp; mimetype != \"image/jpg\" &amp;&amp;\n            mimetype != \"image/gif\" &amp;&amp; mimetype != \"image/png\" &amp;&amp;\n            mimetype != \"application/pdf\" &amp;&amp; mimetype != \"image/vnd.adobe.photoshop\" &amp;&amp; mimetype != \"application/illustrator\" &amp;&amp; mimetype != \"image/vnd.microsoft.icon\" &amp;&amp;\n            mimetype != \"application/msword\" &amp;&amp; mimetype != \"application/x-photoshop\" &amp;&amp; mimetype != \"application/photoshop\" &amp;&amp; mimetype != \"application/psd\" {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n        filename := header.Filename\n        newPath := filepath.Join(\"files/\", filename)\n        fmt.Printf(\"FileType: %s, File: %s\\n\", fileType, newPath)\n\n        t := time.Now().String()\n        currentTime, _ := time.Parse(time.Stamp, t)\n\n        // Creates a File struct-type object out of the file information from\n        f := File{\n            PK:           -1,\n            Name:         filename,\n            FileType:     fileType,\n            UploadDate:   currentTime.String(),\n            LastModified: currentTime.String(),\n            User:         getStringFromSession(r, \"User\"),\n        }\n\n        // Inserts the file information into the database\n        if err = dbmap.Insert(&amp;f); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n        newFile, err := os.Create(newPath)\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n        defer newFile.Close()\n        if _, err := newFile.Write(fileBytes); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        // w.Write([]byte(\"SUCCESS\"))\n\n        if err := upload.ExecuteTemplate(w, \"upload.html\", p); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n        }\n\n    }).Methods(\"POST\")\n\n    // Sort\n    mux.HandleFunc(\"/files\", func(w http.ResponseWriter, r *http.Request) {\n\n        var b []File\n        if !getFileCollection(&amp;b, r.FormValue(\"sortBy\"), getStringFromSession(r, \"Filter\"), getStringFromSession(r, \"User\"), w) {\n            return\n        }\n\n        sessions.GetSession(r).Set(\"sortBy\", r.FormValue(\"sortBy\"))\n\n        if err := json.NewEncoder(w).Encode(b); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n    }).Methods(\"GET\").Queries(\"sortBy\", \"{sortBy:title|author|classification}\")\n\n    // Default page\n    mux.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n\n        p := Page{Files: []File{}, Filter: getStringFromSession(r, \"Filter\"), User: getStringFromSession(r, \"User\")}\n        if !getFileCollection(&amp;p.Files, getStringFromSession(r, \"SortBy\"), getStringFromSession(r, \"Filter\"), p.User, w) {\n            return\n        }\n\n        if err := index.ExecuteTemplate(w, \"index.html\", p); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n        }\n\n    }).Methods(\"GET\")\n\n    mux.HandleFunc(\"/logout\", func(w http.ResponseWriter, r *http.Request) {\n        sessions.GetSession(r).Set(\"User\", nil)\n        sessions.GetSession(r).Set(\"Filter\", nil)\n\n        http.Redirect(w, r, \"/login\", http.StatusFound)\n    })\n\n    // Deletes file from database; currently not working :(\n    mux.HandleFunc(\"/files/{name}\", func(w http.ResponseWriter, r *http.Request) {\n\n        pk, _ := strconv.ParseInt(gmux.Vars(r)[\"pk\"], 10, 64)\n\n        fmt.Printf(\"pk is %d\", pk)\n\n        var f File\n        if err := dbmap.SelectOne(&amp;f, \"select * from files where pk=?\", pk); err != nil {\n            http.Error(w, err.Error(), http.StatusBadRequest)\n        }\n        if _, err := dbmap.Delete(&amp;f); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        w.WriteHeader(http.StatusOK)\n\n    }).Methods(\"DELETE\")\n\n    // Session management\n    n := negroni.Classic()\n    n.Use(sessions.Sessions(\"pando\", cookiestore.New([]byte(\"hubert88\"))))\n    n.Use(negroni.HandlerFunc(verifyDatabase))\n    n.Use(negroni.HandlerFunc(verifyUser))\n    n.UseHandler(mux)\n    n.Run(\":8080\")\n\n} // end main\n\n// Opens the database connection to SQL and creates tables if they don't exist\nfunc initDb() {\n    db, _ = sql.Open(\"mysql\", \"root:secret@tcp(127.0.0.1:3306)/pando\")\n\n    dbmap = &amp;gorp.DbMap{Db: db, Dialect: gorp.MySQLDialect{\"InnoDB\", \"UTF8\"}}\n\n    // creates tables, specifies the fields on the struct that map to table primary keys\n    dbmap.AddTableWithName(File{}, \"files\").SetKeys(true, \"pk\")\n    dbmap.AddTableWithName(Tag{}, \"tags\").SetKeys(true, \"pk\")\n    dbmap.AddTableWithName(Collection{}, \"collections\").SetKeys(true, \"pk\")\n    dbmap.AddTableWithName(User{}, \"users\").SetKeys(false, \"username\")\n    dbmap.CreateTablesIfNotExists()\n\n}\n\n// Checks to make sure the database is alive\nfunc verifyDatabase(w http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n    if err := db.Ping(); err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    next(w, r)\n}\n\nfunc getStringFromSession(r *http.Request, key string) string {\n    var strVal string\n    if val := sessions.GetSession(r).Get(key); val != nil {\n        strVal = val.(string)\n    }\n    return strVal\n}\n\nfunc verifyUser(w http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n\n    if r.URL.Path == \"/login\" {\n        next(w, r)\n        return\n    }\n\n    if username := getStringFromSession(r, \"User\"); username != \"\" {\n        if user, _ := dbmap.Get(User{}, username); user != nil {\n            next(w, r)\n            return\n        }\n    }\n    http.Redirect(w, r, \"/login\", http.StatusTemporaryRedirect)\n}\n\n\n</code></pre>\n\n<p>I'm at my wits end trying to debug this, and all the search results I get only talk about stripping prefixes (which I'm already doing).</p>\n\n<p>In the Networking tab of my browser, the CSS and image files are returning a 307 Temporary Redirect error.</p>\n\n<p>Running colminator's curl command gave this output:</p>\n\n<pre><code>HTTP/1.1 307 Temporary Redirect\nContent-Type: text/html; charset=utf-8\nLocation: /login\nDate: Sun, 05 May 2019 22:16:17 GMT\nContent-Length: 42\n</code></pre>\n\n<p>This is how I'm handling my static files.</p>\n\n<pre><code>mux.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n</code></pre>\n"}, {"tags": ["c#", "go", "x509", "asn.1", "csr"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557108175, "post_id": 55996232, "comment_id": 98642820, "body": "Just to clarify: PEM encoding is based on but distinct from base64 encoding. There is no PEM encoding involved here; it&#39;s just base64. See <a href=\"https://golang.org/pkg/encoding/pem/\" rel=\"nofollow noreferrer\">encoding/pem for some examples</a>. This code seems correct to me, though."}, {"owner": {"reputation": 113, "user_id": 1949388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5eccb448a056bb070f1936a03ff07d?s=128&d=identicon&r=PG", "display_name": "geNAZt", "link": "https://stackoverflow.com/users/1949388/genazt"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557120928, "post_id": 55996232, "comment_id": 98645214, "body": "Yeah it should work it seems to parse all data correct but expects more data than the cert is long and I can&#39;t figure out what golang expects there."}], "answers": [{"comments": [{"owner": {"reputation": 501, "user_id": 2144222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c8dbbc804fda6116da2c5066ab5de7?s=128&d=identicon&r=PG", "display_name": "David Hook", "link": "https://stackoverflow.com/users/2144222/david-hook"}, "edited": false, "score": 1, "creation_date": 1570347040, "post_id": 56008778, "comment_id": 102879667, "body": "The issue here is some CA&#39;s will reject a PKCS#10 request if the attribute set is empty (yes, I know...). So BC supports both. It can&#39;t enforce the presence of the set as to do so would cause things to break. The solution for this circumstance is correct though."}], "tags": [], "owner": {"reputation": 113, "user_id": 1949388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5eccb448a056bb070f1936a03ff07d?s=128&d=identicon&r=PG", "display_name": "geNAZt", "link": "https://stackoverflow.com/users/1949388/genazt"}, "is_accepted": true, "score": 1, "last_activity_date": 1557158743, "creation_date": 1557158743, "answer_id": 56008778, "question_id": 55996232, "link": "https://stackoverflow.com/questions/55996232/unmarshal-with-x509-parsecertificaterequest-fails-but-openssl-is-ok/56008778#56008778", "title": "Unmarshal with x509.ParseCertificateRequest fails but openssl is ok?", "body": "<p>I found the answer to this problem.</p>\n\n<p>Bouncycastle does not add a0:00 to the attributes when no attribute instance is given (null). This leads to incomplete encoded data. </p>\n\n<p>\"If you just see:\n        Attributes:\nthen the SET OF is missing and the encoding is technically invalid (but it is tolerated).\"\n- <a href=\"https://www.openssl.org/docs/man1.0.2/man1/openssl-req.html\" rel=\"nofollow noreferrer\">https://www.openssl.org/docs/man1.0.2/man1/openssl-req.html</a></p>\n\n<p>The solution is to provide a empty DerSet to the CSR which leads to the a0:00 generation indicating there are no attributes present.</p>\n"}], "owner": {"reputation": 113, "user_id": 1949388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee5eccb448a056bb070f1936a03ff07d?s=128&d=identicon&r=PG", "display_name": "geNAZt", "link": "https://stackoverflow.com/users/1949388/genazt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 56008778, "answer_count": 1, "score": 1, "last_activity_date": 1570338402, "creation_date": 1557088861, "last_edit_date": 1570338402, "question_id": 55996232, "link": "https://stackoverflow.com/questions/55996232/unmarshal-with-x509-parsecertificaterequest-fails-but-openssl-is-ok", "title": "Unmarshal with x509.ParseCertificateRequest fails but openssl is ok?", "body": "<p>When I try to load the PEM encoded CSR, Golang does not parse the ASN.1 data inside the CSR correctly. It spits out that the sequence is truncated.</p>\n\n<p>OpenSSL on the other hand is fine with the CSR and prints out the correct CN.</p>\n\n<p>Here is the generation code (in c#):</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public string generateCSR(string cn) \n{\n    try\n    {\n        AsymmetricCipherKeyPair pair = this.keyHolder.keypair;\n\n        var subject = new X509Name(\"CN=\" + cn);\n        var pkcs10CertificationRequest = new Pkcs10CertificationRequest\n            (PkcsObjectIdentifiers.Sha256WithRsaEncryption.Id, subject, pair.Public, null, pair.Private);\n\n        string csr = Convert.ToBase64String(pkcs10CertificationRequest.GetDerEncoded());\n        Debug.Log(csr);\n        return csr;\n    } catch(Exception e) \n    {\n        Debug.LogError(e);\n    }\n\n    return null;\n}\n</code></pre>\n\n<p>That gets send directly via HTTP to the Golang service (without any URL encoding etc.)</p>\n\n<p>Golang server side:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>// Try to parse CSR\nbytes := make([]byte, base64.StdEncoding.DecodedLen(len(csrData)))\nn, err := base64.StdEncoding.Decode(bytes, csrData)\nif err != nil {\n    fmt.Printf(\"Error whilst parsing PEM: %v\\n\", err)\n    resp.WriteHeader(http.StatusBadRequest)\n    return\n}\n\n_, err = x509.ParseCertificateRequest(bytes[:n])\nif err != nil {\n    fmt.Printf(\"Error whilst parsing ASN.1/REQ CSR: %v\\n\", err)\n    resp.WriteHeader(http.StatusBadRequest)\n    return\n}\n</code></pre>\n\n<p>Test CSR (in PEM):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>MIIEWTCCAkECAQAwFjEUMBIGA1UEAwwLdGVzdEFjY291bnQwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQCHu2/2GXBGlEuIWAjhBHXRnT17Pod9aPbTnLwfVSD+1xjchsu2rB83LtSWlfRXoIs4geUTvr2io0iP/kU+IzVZwL/CMzPWoWwq4VH5nQ5QMqCCMEF2g90BmIlLgaopNuQPfAEO64d+3dSFnha3QLbmv2xXe3WwYJ+RTvf+Kij0jgeB3MGzEmlVDiVWlaH4TO5LzY5/CbQgtfDHmhp4LDGe+9vbSkX/m4TXMEg4//21oe7YKO4spM1z9pIUsk8vBb0jDwRFnYRhRjHY5JTzOOM6lewjciOIlOKiBBPb4xSGJeRexZZvl111L/chhLQR701XvSyEn8MQRC6U3/BAhdvvwROPfJoEkbpf5vPYGfmsRr4iwci7XBFlw7q1iJZ6Jk4T4iYaPXl2HF0x9kpbA6eDDKkdJvM0Z6X61Eir6hI8xsyAoTEh4pBRyypl+tTLl1vK1BNEZhaPatTj5N0glCxa/MxODDDri6aobU5mjbYfp1FMdpSYiJub0l7tZvgSCv82ANxjPvT4HLge658C7VOfAQj+kdeGzNgJRSA8/FwJGsbl0RyB0Yn82HrYKB+YQy/e79+i/BIm9yAmBsEjTgrjkNF1izl5PrwQBc/lU9gVbONNvryODV4pG7NrNERSsiwN5YXFWDElDZjO3TaFwbz67raRgX7aBIHlCeINzBVuzwIDAQABMA0GCSqGSIb3DQEBCwUAA4ICAQBFZmrjbbqxerp5oLbmW91fBzinXKLmP8E1bsIyh4GSsWxnN13a9Srbq/VEaNJm+vucAFrptleMCz8GAO5Gm8XobhnMzr6uotn8b2rEDZvo9UHuyqu2H8wI2Te5sqjBjnbH/KOTN83uYLQVODkVve/9VW7e0xxjG8i/OCmyVjVY0sc4U06LRJw4LVqeeOFWJcv0yjxEucwLNodlzm0S3t9Cx0Vkd3cVzq/lwcBTEDHzcfgleOUcOCgbOZF6NDvyuB5VLsS+HwJeIm8tiBF9yqT+RYFKYQjvDy1XT9a1sNqn7jmiV3zwb4vcy16vgAakjyBeWnK87UJQI4XiCyGP61Xchlo5p5yyIu09iJeAN5pHuKCQAYmvEjTF630O5i/e0UHWhIZA0PnG1xAksVv9FpoQh8LjfnG7+XkAYWFxAbiIG/x8rQsyZie9SSvW2hbRykGpNdQYy4wiwt/dx/UaZI3/n24/dE50NWckP8fLeGWqqej0mYWCLjzxult0xELRiVvjNfuHwcfTPBrqmQqG16PII7tjhv0bhszRrIAkcVMpTM0RV/jcSVc4aMLpDRVLElDtaG2qCaJWq5a8MBk1BiYLjI8i8f0cMBXJ2dq9sjzEwl0vGObBui5my9jHgwzY7aPqIO0mgZm5sEpisBZMgCJ9AmK36u7wjqZZC6jnuxYoWg==\n</code></pre>\n\n<p>Is there any option i miss in the ASN parser in go? Why is OpenSSL fine with that input?</p>\n"}, {"tags": ["go", "reflection", "types", "type-assertion"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1557087706, "last_edit_date": 1557087706, "creation_date": 1557087169, "answer_id": 55996003, "question_id": 55995917, "link": "https://stackoverflow.com/questions/55995917/reverse-of-reflect-typeof/55996003#55996003", "title": "Reverse of reflect.TypeOf", "body": "<p>A <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>reflect.Type</code></a> holds no value you could <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assert</a> (actually you could, but that could only be <code>reflect.Type</code>, not what you want). A <code>reflect.Type</code> is just a type descriptor (which you obtained from a value).</p>\n\n<p>However, you could create a value of the type represented by <code>reflect.Type</code>, and you can type-assert the values from that you originally wanted.</p>\n\n<p>To create a new pointer value, use <a href=\"https://golang.org/pkg/reflect/#New\" rel=\"nofollow noreferrer\"><code>reflect.New()</code></a>. To obtain the pointed value, use <a href=\"https://golang.org/pkg/reflect/#Value.Elem\" rel=\"nofollow noreferrer\"><code>Value.Elem()</code></a>. These are all wrapped in a <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\"><code>reflect.Value</code></a>. To unwrap it, use <a href=\"https://golang.org/pkg/reflect/#Value.Interface\" rel=\"nofollow noreferrer\"><code>Value.Interface()</code></a>.</p>\n\n<p>For example:</p>\n\n<pre><code>for _, v := range alltypes {\n    fmt.Printf(\"%T\\t%q\\n\", v, v)\n    value := reflect.New(v.(reflect.Type)).Elem().Interface()\n    switch value.(type) {\n    default:\n        fmt.Printf(\"unexpected type %T\\n\", v)\n    case bool:\n        fmt.Println(\"bool type!\")\n    case int:\n        fmt.Println(\"int type!\")\n    case float64:\n        fmt.Println(\"float64 type!\")\n    }\n}\n</code></pre>\n\n<p>This will output (try it on the <a href=\"https://play.golang.org/p/yRlV8erWeNu\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[]interface {}  [\"bool\" \"float64\" \"int\"]\n*reflect.rtype  \"bool\"\nbool type!\n*reflect.rtype  \"float64\"\nfloat64 type!\n*reflect.rtype  \"int\"\nint type!\n</code></pre>\n\n<p>Also if you don't want to create new values just test the type, \"save\" the <code>reflect.Type</code> descriptors of the types you're interested in, and use a normal <code>switch</code> on the type:</p>\n\n<pre><code>var (\n    TypeBool    = reflect.TypeOf(true)\n    TypeFloat64 = reflect.TypeOf(0.0)\n    TypeInt     = reflect.TypeOf(0)\n)\n\nfunc main() {\n    var alltypes []interface{}\n\n    alltypes = append(alltypes, reflect.TypeOf(true))\n    alltypes = append(alltypes, reflect.TypeOf(0.0))\n    alltypes = append(alltypes, reflect.TypeOf(0))\n    fmt.Printf(\"%T\\t%q\\n\", alltypes, alltypes)\n\n    for _, v := range alltypes {\n        fmt.Printf(\"%T\\t%q\\n\", v, v)\n        switch v {\n        default:\n            fmt.Printf(\"unexpected type %T\\n\", v)\n        case TypeBool:\n            fmt.Println(\"bool type!\")\n        case TypeInt:\n            fmt.Println(\"int type!\")\n        case TypeFloat64:\n            fmt.Println(\"float64 type!\")\n        }\n    }\n}\n</code></pre>\n\n<p>This will output (try it on the <a href=\"https://play.golang.org/p/NFT4-yjSy2x\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[]interface {}  [\"bool\" \"float64\" \"int\"]\n*reflect.rtype  \"bool\"\nbool type!\n*reflect.rtype  \"float64\"\nfloat64 type!\n*reflect.rtype  \"int\"\nint type!\n</code></pre>\n\n<p>Recommended reading: <a href=\"https://blog.golang.org/laws-of-reflection\" rel=\"nofollow noreferrer\">The Go Blog: The Laws of Reflection</a></p>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 2254024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rE2by.jpg?s=128&g=1", "display_name": "Karimai", "link": "https://stackoverflow.com/users/2254024/karimai"}, "edited": false, "score": 0, "creation_date": 1557088065, "post_id": 55996052, "comment_id": 98639337, "body": "just the data type is necessary later. it also worked fine."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 2, "last_activity_date": 1557087805, "last_edit_date": 1557087805, "creation_date": 1557087485, "answer_id": 55996052, "question_id": 55995917, "link": "https://stackoverflow.com/questions/55995917/reverse-of-reflect-typeof/55996052#55996052", "title": "Reverse of reflect.TypeOf", "body": "<p>Depending on what you want to do, you don't necessarily need to do that with a type assertion. <code>v.(reflect.Type).Kind()</code> will tell you what kind of type it is (e.g., <code>reflect.Bool</code>, <code>reflect.Float64</code>,  <code>reflect.Int</code>, etc.).</p>\n"}], "owner": {"reputation": 193, "user_id": 2254024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rE2by.jpg?s=128&g=1", "display_name": "Karimai", "link": "https://stackoverflow.com/users/2254024/karimai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 55996003, "answer_count": 2, "score": 0, "last_activity_date": 1557123794, "creation_date": 1557086543, "last_edit_date": 1557123794, "question_id": 55995917, "link": "https://stackoverflow.com/questions/55995917/reverse-of-reflect-typeof", "title": "Reverse of reflect.TypeOf", "body": "<p>I want to retrieve back the type of value I saved once. I used reflect.Typeof() and saved the type. then try to use switch type. the type will always be \"*reflect.rtype    \". I couldn't retrieve either by type assertion.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    var alltypes []interface{}\n\n    alltypes = append(alltypes, reflect.TypeOf(true))\n    alltypes = append(alltypes, reflect.TypeOf(0.0))\n    alltypes = append(alltypes, reflect.TypeOf(0))\n    fmt.Printf(\"%T\\t%q\\n\", alltypes, alltypes)\n\n    for _, v := range alltypes {\n        fmt.Printf(\"%T\\t%q\\n\", v, v)\n        res, ok := v.(bool)\n        fmt.Println(\"res: \", res, \" ok: \", ok)\n        switch v.(type) {\n        default:\n            fmt.Printf(\"unexpected type %T\\n\", v)\n        case bool:\n            fmt.Println(\"bool type!\")\n        case int:\n            fmt.Println(\"int type!\")\n        case float64:\n            fmt.Println(\"float64 type!\")\n        }\n    }\n\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/kqDo4DPYjra\" rel=\"nofollow noreferrer\">https://play.golang.org/p/kqDo4DPYjra</a></p>\n"}, {"tags": ["go", "aws-lambda", "aws-api-gateway"], "comments": [{"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 1, "creation_date": 1557087663, "post_id": 55995716, "comment_id": 98639242, "body": "In the Node.JS example you&#39;re using <code>POST</code> to provide a request body to the endpoint. IIUC when you say &quot;in the browser&quot;, I assume you&#39;re trying to open the URL in the browser address bar which corresponds to a <code>GET</code>. You don&#39;t include your <code>curl</code> example. Are you using <code>curl --request POST --header ... --data ..</code>? If so, that would corroborate my assumption. If this is correct, you can&#39;t <code>POST</code> from the address bar of a browser and would need to add a <code>GET</code> method (wrapper) to your code."}, {"owner": {"reputation": 75, "user_id": 6383880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209419880163160/picture?type=large", "display_name": "DougCal", "link": "https://stackoverflow.com/users/6383880/dougcal"}, "reply_to_user": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 1, "creation_date": 1557097768, "post_id": 55995716, "comment_id": 98641270, "body": "@DazWilkin I&#39;m running that small Node.JS example inside a React application I built.  So, that&#39;s what I mean by &quot;in the browser&quot; I guess you can say.  There&#39;s no query strings or anything like that, just a body that&#39;s being sent.  And yes, that curl command is very similar.  I think it&#39;s a good idea to add that to my question in case someone else has the same thought as you.  Does this make sense?"}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 3, "creation_date": 1557103686, "post_id": 55995716, "comment_id": 98642157, "body": "Clutching at straws: is the domain that&#39;s originating the request, different to the domain where your Go server is running? Perhaps you&#39;re hitting a CORS issue."}, {"owner": {"reputation": 9320, "user_id": 5196394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52GqN.jpg?s=128&g=1", "display_name": "hoangdv", "link": "https://stackoverflow.com/users/5196394/hoangdv"}, "edited": false, "score": 0, "creation_date": 1557107540, "post_id": 55995716, "comment_id": 98642712, "body": "The endpoint on browser is the same with in CURL?"}, {"owner": {"reputation": 75, "user_id": 6383880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209419880163160/picture?type=large", "display_name": "DougCal", "link": "https://stackoverflow.com/users/6383880/dougcal"}, "reply_to_user": {"reputation": 9320, "user_id": 5196394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52GqN.jpg?s=128&g=1", "display_name": "hoangdv", "link": "https://stackoverflow.com/users/5196394/hoangdv"}, "edited": false, "score": 1, "creation_date": 1557107613, "post_id": 55995716, "comment_id": 98642727, "body": "@hoangdv Yes it is"}, {"owner": {"reputation": 9320, "user_id": 5196394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52GqN.jpg?s=128&g=1", "display_name": "hoangdv", "link": "https://stackoverflow.com/users/5196394/hoangdv"}, "edited": false, "score": 0, "creation_date": 1557107781, "post_id": 55995716, "comment_id": 98642761, "body": "@JohnCalhoun Check again in Network tab of Chrome dev tool."}, {"owner": {"reputation": 75, "user_id": 6383880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209419880163160/picture?type=large", "display_name": "DougCal", "link": "https://stackoverflow.com/users/6383880/dougcal"}, "reply_to_user": {"reputation": 9320, "user_id": 5196394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52GqN.jpg?s=128&g=1", "display_name": "hoangdv", "link": "https://stackoverflow.com/users/5196394/hoangdv"}, "edited": false, "score": 1, "creation_date": 1557107959, "post_id": 55995716, "comment_id": 98642786, "body": "@hoangdv I double checked it for you.  They are definitely the same."}, {"owner": {"reputation": 75, "user_id": 6383880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209419880163160/picture?type=large", "display_name": "DougCal", "link": "https://stackoverflow.com/users/6383880/dougcal"}, "reply_to_user": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 1, "creation_date": 1557107999, "post_id": 55995716, "comment_id": 98642791, "body": "@DazWilkin It is.  With my fetch request above, do you have a recommendation on how to see if it is?  I&#39;m not sure where I can see &quot;CORS&quot; settings in API Gateway, for I only see a way to enable them which has me believing they are not enabled."}, {"owner": {"reputation": 9320, "user_id": 5196394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52GqN.jpg?s=128&g=1", "display_name": "hoangdv", "link": "https://stackoverflow.com/users/5196394/hoangdv"}, "edited": false, "score": 0, "creation_date": 1557108015, "post_id": 55995716, "comment_id": 98642794, "body": "@JohnCalhoun Poor you! It comes from another reason."}, {"owner": {"reputation": 75, "user_id": 6383880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209419880163160/picture?type=large", "display_name": "DougCal", "link": "https://stackoverflow.com/users/6383880/dougcal"}, "reply_to_user": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 1, "creation_date": 1557237262, "post_id": 55995716, "comment_id": 98692124, "body": "You had a good lead there @DazWilkin"}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1557241217, "post_id": 55995716, "comment_id": 98694625, "body": "Were you able to resolve the issue?"}, {"owner": {"reputation": 75, "user_id": 6383880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209419880163160/picture?type=large", "display_name": "DougCal", "link": "https://stackoverflow.com/users/6383880/dougcal"}, "reply_to_user": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 1, "creation_date": 1557256541, "post_id": 55995716, "comment_id": 98701799, "body": "@DazWilkin Yeah, I threw an update in the description describing what happened."}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1557256921, "post_id": 55995716, "comment_id": 98701958, "body": "Nice! I think that warrants being your answer to your question."}], "owner": {"reputation": 75, "user_id": 6383880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209419880163160/picture?type=large", "display_name": "DougCal", "link": "https://stackoverflow.com/users/6383880/dougcal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557237229, "creation_date": 1557085229, "last_edit_date": 1557237229, "question_id": 55995716, "link": "https://stackoverflow.com/questions/55995716/how-to-get-my-go-lambda-function-to-give-me-a-response-when-calling-it-in-a-brow", "title": "How to get my Go Lambda function to give me a response when calling it in a browser?", "body": "<p>I created a microservice in Go that unmarshals the data off of a request body and stores it in DynamoDB.  The REST URL runs pretty much anywhere but a browser it seems.  When I run the fetch in a browser I get a 403 with no response.  I can get a 200 response using a Node script, curl command, or even when using a tool like repl.it to test.  For some reason though, it never wants to work in a web app, or the dev console (I'm using Chrome).  I tried running the request in multiple websites including the web app I'm building to run it in and all of them gave the same 403 no response result.</p>\n\n<p>In API Gateway, Authorization is set to \"none\", and API Key is set to \"not required\", so I'm having a lot of difficulty in seeing how I can get a 403 on my endpoint.  On the frontend, my fetch request looks like something below.  The curl command that worked is below as well.  I followed <a href=\"https://stackoverflow.com/questions/40988051/getting-message-forbidden-reply-from-aws-api-gateway\">this</a> post before creating this, and although it's similar, this person does actually get a response, while mine gives me no response.  It works as a script, but just doesn't work in the browser.  How does this work anywhere but inside a browser?  If I can just get some info on what's going on, that would be awesome.  If I can get some info on how this can be solved, that would be REALLY awesome.</p>\n\n<p>js</p>\n\n<pre><code>fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    data: JSON.stringify({\n        Email: 'example@test.com'\n    }),\n})\n    .then(res =&gt; res.json())\n    .then(json =&gt; console.log(json))\n    .catch(e =&gt; console.error(e))\n</code></pre>\n\n<p>curl</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>curl -H 'application/json' -d '{ \"Email\": \"example@test.com\" }' $URL\n</code></pre>\n\n<p>UPDATE: I discovered what I had going wrong.  It was a CORS issue.  I was not handling the OPTIONS method that was sent as a preflight request prior to my POST request.  The OPTIONS method gets sent automatically when in the browser, but does not if you're running the code anywhere else.</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557104272, "post_id": 55995668, "comment_id": 98642249, "body": "This is leaking every request goroutine and connection (which includes other goroutines). You&#39;re ignoring the response, which you need in order to consume the body. Nothing is reading from the channels, so all sends block. What do you want to do with the channels?"}, {"owner": {"reputation": 77, "user_id": 1981855, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7f602293c178312fde2f52a8775dc86b?s=128&d=identicon&r=PG", "display_name": "user1981855", "link": "https://stackoverflow.com/users/1981855/user1981855"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557115996, "post_id": 55995668, "comment_id": 98644109, "body": "@JimB, I see. I edited the code and playground to address your comments. I am simply trying to send 2 GET requests at the same time, wait for 1 second, then send two more at the same time until 10 requests are sent total. Does it make sense?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557146661, "post_id": 55995668, "comment_id": 98656450, "body": "You&#39;re still not handling the response which may cause problems, but otherwise this should function. It would make sense that if you&#39;re not sure if it&#39;s working, to actually test it to verify that it works as expected, in which case you&#39;d see that your math doesn&#39;t work, you&#39;re sending 2 requests every second."}, {"owner": {"reputation": 77, "user_id": 1981855, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7f602293c178312fde2f52a8775dc86b?s=128&d=identicon&r=PG", "display_name": "user1981855", "link": "https://stackoverflow.com/users/1981855/user1981855"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557170316, "post_id": 55995668, "comment_id": 98667446, "body": "@JimB, good catch, I updated the code to reflect this, and now the frequency is 5 per second, thanks!"}], "owner": {"reputation": 77, "user_id": 1981855, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7f602293c178312fde2f52a8775dc86b?s=128&d=identicon&r=PG", "display_name": "user1981855", "link": "https://stackoverflow.com/users/1981855/user1981855"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557170257, "creation_date": 1557084884, "last_edit_date": 1557170257, "question_id": 55995668, "link": "https://stackoverflow.com/questions/55995668/multiple-get-requests-per-second-using-channels", "title": "Multiple GET Requests per second using channels", "body": "<p>I am attempting to write a simple program that sends a given number of concurrent GET requests per second, so let's say I want to send 10 requests at a frequency of 5 per second. In this case it means we want to send 5 concurrent requests twice for a total of 10 requests.</p>\n\n<p>I have implemented this using channels, but I am not sure if this is the right approach:</p>\n\n<p>Edited</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"net/http\"\n)\n\nfunc main() {\n    transactions := 10\n    frequency := 5\n    prepareRequests(frequency, transactions)\n\n}\n\nfunc prepareRequests(frequency int, transactions int) {\n    transactionsPerSecond := transactions / frequency\n    c := make(chan string)\n    link := \"http://google.com\"\n    for i := 0; i &lt; transactionsPerSecond; i++ {\n        fmt.Println(\"batch: \", i+1)\n        for j := 0; j &lt; frequency; j++ {\n            go sendRequests(link, c)\n        }\n        time.Sleep(time.Duration(1) * time.Second)\n\n    }\n\n    for k :=0; k &lt; frequency; k++ {\n        fmt.Println(&lt;-c)\n    }\n}\n\nfunc sendRequests(l string, c chan string) {\n    _, err := http.Get(l)\n    if err != nil {\n        fmt.Println(l, \"might be down!\")\n        c &lt;- l\n        return\n    }\n\n    c &lt;- l\n}\n</code></pre>\n\n<p>Updated\n<a href=\"https://play.golang.org/p/I-qlreym7Eg\" rel=\"nofollow noreferrer\">go playground</a></p>\n\n<p>Is this correct? Seems to be working, but I am not sure I am actually sending concurrent GET request through the sub routines.</p>\n"}, {"tags": ["http", "go", "server", "signals", "reload"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1557086891, "post_id": 55995494, "comment_id": 98639012, "body": "It&#39;s possible, but signals lack granularity. Why not just have an auth route that can control the temporary redirect? That way you know the state of the server. Sending signals is flying blind - as there&#39;s no return code to indicate the signal was received. Plus a http route can be invoked remotely - signals require (Root) local access."}, {"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557087773, "post_id": 55995494, "comment_id": 98639273, "body": "What about using SIGHUP?"}, {"owner": {"reputation": 347, "user_id": 9370956, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mikael Brenner", "link": "https://stackoverflow.com/users/9370956/mikael-brenner"}, "edited": false, "score": 1, "creation_date": 1557162453, "post_id": 55995494, "comment_id": 98664449, "body": "I&#39;d recommend that you use a middleware, and redirect all requests to that page in the right conditions. Would probably not need signals. Use an authenticated endpoint to change the status and it should be fine."}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 0, "creation_date": 1557155360, "post_id": 56006937, "comment_id": 98661220, "body": "Thank you so much! Well, it&#39;s part of learning for me rather trying to have a production ready code :) Thank you again!"}], "tags": [], "owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "is_accepted": true, "score": 4, "last_activity_date": 1557152892, "last_edit_date": 1557152892, "creation_date": 1557151904, "answer_id": 56006937, "question_id": 55995494, "link": "https://stackoverflow.com/questions/55995494/send-a-custom-signal-to-curreng-golang-process/56006937#56006937", "title": "Send a custom signal to curreng Golang process", "body": "<p>As noted in the comments, signals may not be the best way to accomplish this. I\u2019m assuming that you do want signals nonetheless.</p>\n\n<p>You can use the <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/signal.h.html\" rel=\"nofollow noreferrer\">standard</a> user signals: <code>SIGUSR1</code> to enable maintenance and <code>SIGUSR2</code> to disable it.</p>\n\n<p>Use <a href=\"https://golang.org/pkg/os/signal/\" rel=\"nofollow noreferrer\"><code>os/signal</code></a> to get notified of these signals and update program state:</p>\n\n<pre><code>// Brief example code. Real code might be structured differently\n// (perhaps pack up maint and http.Server in one type MyServer).\n\nvar maint uint32 // atomic: 1 if in maintenance mode\n\nfunc handleMaintSignals() {\n    ch := make(chan os.Signal, 1)\n    go func() { // FIXME: use Server.RegisterOnShutdown to terminate this\n        for sig := range ch {\n            switch sig { // FIXME: add logging\n            case syscall.SIGUSR1:\n                atomic.StoreUint32(&amp;maint, 1)\n            case syscall.SIGUSR2:\n                atomic.StoreUint32(&amp;maint, 0)\n            }\n        }\n    }()\n    signal.Notify(ch, syscall.SIGUSR1, syscall.SIGUSR2)\n}\n</code></pre>\n\n<p>Have a middleware look at that state and respond accordingly:</p>\n\n<pre><code>func withMaint(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        if atomic.LoadUint32(&amp;maint) == 1 {\n            http.Error(w, \"Down for maintenance\", http.StatusServiceUnavailable)\n            return\n        }\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>You can apply this middleware on a per-route basis, or directly to the server\u2019s <a href=\"https://golang.org/pkg/net/http/#Server.Handler\" rel=\"nofollow noreferrer\">root handler</a>:</p>\n\n<pre><code>func main() {\n    handleMaintSignals()\n    srv := http.Server{\n        Addr:    \":17990\",\n        Handler: withMaint(http.DefaultServeMux),\n    }\n    srv.ListenAndServe()\n}\n</code></pre>\n\n\n\n<p>You don\u2019t need a second executable like <code>changeMyServerStatus</code>. Use your operating system\u2019s tools to send signals, such as <a href=\"http://manpages.ubuntu.com/manpages/bionic/en/man1/pkill.1.html\" rel=\"nofollow noreferrer\">pkill</a>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ nohup myserver &amp;\n\n$ curl http://localhost:17990/\n404 page not found\n\n$ pkill -USR1 myserver\n\n$ curl http://localhost:17990/\nDown for maintenance\n\n$ pkill -USR2 myserver\n\n$ curl http://localhost:17990/\n404 page not found\n</code></pre>\n\n<p>But manually juggling <code>nohup</code> and <code>pkill</code> is tedious and error-prone. Instead, use a service manager such as <a href=\"https://en.wikipedia.org/wiki/Systemd\" rel=\"nofollow noreferrer\">systemd</a> to manage your process. Systemd lets you send arbitrary signals with <a href=\"http://manpages.ubuntu.com/manpages/bionic/en/man1/systemctl.1.html\" rel=\"nofollow noreferrer\"><code>systemctl kill</code></a>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>systemctl kill -s SIGUSR1 myserver\n</code></pre>\n"}], "owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1203, "favorite_count": 0, "accepted_answer_id": 56006937, "answer_count": 1, "score": 0, "last_activity_date": 1557152892, "creation_date": 1557083651, "last_edit_date": 1557083688, "question_id": 55995494, "link": "https://stackoverflow.com/questions/55995494/send-a-custom-signal-to-curreng-golang-process", "title": "Send a custom signal to curreng Golang process", "body": "<p>I'm creating a HTTP server using Go. And whenever I work on a database maintenance, I want the server to redirect all the traffic to \"current working on maintenance\" page. </p>\n\n<p>Currently, this is done by secret admin page (eg. <a href=\"http://myhome/secret\" rel=\"nofollow noreferrer\">http://myhome/secret</a>) but I'm wondering if this can be done with signal -similar to TERM signal, but temporarily redirect rather than actually terminate the process.</p>\n\n<p>Eg.</p>\n\n<pre><code>/home/myhome&gt; nohup startServer &amp;\n... \n/home/myhome&gt; changeMyServerStatus \"maintenance\"\n</code></pre>\n\n<p>I assume there will be two executable.. \"startServer\" and \"changeMyServerStatus\"</p>\n\n<p>So, this is similar to a service. (like reload) But, is this possible? If so, can you give me some hint please?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1557080363, "post_id": 55994888, "comment_id": 98637328, "body": "What&#39;s the union? What types do you need to switch between during unmarshaling?"}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557082164, "post_id": 55994888, "comment_id": 98637821, "body": "The <code>payload</code> field contains different types. Sorry I realise the examples I gave weren&#39;t obvious - I&#39;ll update it."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557082242, "post_id": 55994888, "comment_id": 98637849, "body": "To be clear - the type of <code>payload</code> depends on the value of <code>intent</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557082399, "post_id": 55994888, "comment_id": 98637907, "body": "<a href=\"https://play.golang.org/p/u0tjSvrlp9Z\" rel=\"nofollow noreferrer\">play.golang.org/p/u0tjSvrlp9Z</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557082559, "post_id": 55994888, "comment_id": 98637953, "body": "<code>json.Unmarshal</code> will unmarshal the json by the tags, so if you have a &quot;union&quot; of , say 100 possible types, you can have a struct with 100 fields with the correct tags or fieldnames and json.Unmarshal will unmarshal the json into the correct field."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557082599, "post_id": 55994888, "comment_id": 98637960, "body": "@mkopriva That&#39;s a hack that only works for this specific example. It doesn&#39;t work if you have a field with the same name with two different types for example."}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": true, "score": 3, "last_activity_date": 1557082644, "last_edit_date": 1557082644, "creation_date": 1557082359, "answer_id": 55995306, "question_id": 55994888, "link": "https://stackoverflow.com/questions/55994888/unmarshal-json-tagged-union-in-go/55995306#55995306", "title": "Unmarshal JSON tagged union in Go", "body": "<p>Instead of unmarshaling <code>Payload</code> to an <code>interface{}</code> you can store it as a <code>json.RawMessage</code> and then unmarshal it based on the value of Intent.  This is shown in the example in the json docs:</p>\n\n<p><a href=\"https://golang.org/pkg/encoding/json/#example_RawMessage_unmarshal\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/json/#example_RawMessage_unmarshal</a></p>\n\n<p>Using that example with your JSON and struct your code becomes something like this:</p>\n\n<pre><code>type Request struct {\n    RequestId string\n    Inputs    []struct {\n        Intent   string\n        Payload  json.RawMessage\n    }\n}\n\nvar request Request\nerr := json.Unmarshal(j, &amp;request)\nif err != nil {\n    log.Fatalln(\"error:\", err)\n}\nfor _, input := range request.Inputs {\n    var payload interface{}\n    switch input.Intent {\n    case \"action.devices.EXECUTE\":\n        payload = new(Execute)\n    case \"action.devices.QUERY\":\n        payload = new(Query)\n    }\n    err := json.Unmarshal(input.Payload, payload)\n    if err != nil {\n        log.Fatalln(\"error:\", err)\n    }\n    // Do stuff with payload\n}\n</code></pre>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "accepted_answer_id": 55995306, "answer_count": 1, "score": 3, "last_activity_date": 1557082644, "creation_date": 1557079525, "last_edit_date": 1557082203, "question_id": 55994888, "link": "https://stackoverflow.com/questions/55994888/unmarshal-json-tagged-union-in-go", "title": "Unmarshal JSON tagged union in Go", "body": "<p>I'm trying to demarshal the JSON requests of <a href=\"https://developers.google.com/actions/smarthome/create#provide-fulfillment\" rel=\"nofollow noreferrer\">Google Actions</a>. These have arrays of tagged unions like this:</p>\n\n<pre><code>{\n    \"requestId\": \"ff36a3cc-ec34-11e6-b1a0-64510650abcf\",\n    \"inputs\": [{\n      \"intent\": \"action.devices.QUERY\",\n      \"payload\": {\n        \"devices\": [{\n          \"id\": \"123\",\n          \"customData\": {\n            \"fooValue\": 74,\n            \"barValue\": true,\n            \"bazValue\": \"foo\"\n          }\n        }, {\n          \"id\": \"456\",\n          \"customData\": {\n            \"fooValue\": 12,\n            \"barValue\": false,\n            \"bazValue\": \"bar\"\n          }\n        }]\n      }\n    }]\n}\n\n{\n    \"requestId\": \"ff36a3cc-ec34-11e6-b1a0-64510650abcf\",\n    \"inputs\": [{\n      \"intent\": \"action.devices.EXECUTE\",\n      \"payload\": {\n        \"commands\": [{\n          \"devices\": [{\n            \"id\": \"123\",\n            \"customData\": {\n              \"fooValue\": 74,\n              \"barValue\": true,\n              \"bazValue\": \"sheepdip\"\n            }\n          }, {\n            \"id\": \"456\",\n            \"customData\": {\n              \"fooValue\": 36,\n              \"barValue\": false,\n              \"bazValue\": \"moarsheep\"\n            }\n          }],\n          \"execution\": [{\n            \"command\": \"action.devices.commands.OnOff\",\n            \"params\": {\n              \"on\": true\n            }\n          }]\n        }]\n      }\n    }]\n}\n\netc.\n</code></pre>\n\n<p>Obviously I can demarshal this to an <code>interface{}</code> and use fully dynamic type casts and everything to decode it, but Go has decent support for decoding to structs. Is there a way to do this elegantly in Go (<a href=\"https://serde.rs/enum-representations.html\" rel=\"nofollow noreferrer\">like you can in Rust</a> for example)?</p>\n\n<p>I feel like you could almost do it by reading demarshalling to this initially:</p>\n\n<pre><code>type Request struct {\n    RequestId string\n    Inputs    []struct {\n        Intent   string\n        Payload  interface{}\n    }\n}\n</code></pre>\n\n<p>However once you have the <code>Payload interface{}</code> there doesn't seem to be any way to deserialise that into a <code>struct</code> (other than serialising it and deserialising it again which sucks. Is there any good solution?</p>\n"}, {"tags": ["go", "llvm", "antlr4"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 11456075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d692d21d702a08d3fdf751a53e3c4dd?s=128&d=identicon&r=PG&f=1", "display_name": "JackP", "link": "https://stackoverflow.com/users/11456075/jackp"}, "edited": false, "score": 0, "creation_date": 1557084837, "post_id": 55994730, "comment_id": 98638533, "body": "Ok, I see..! So maybe I was looking at this all wrong, then. So the notion of there being a &quot;target language&quot; really only applies to the lexer/parser and not to the code I&#39;d eventually be generating. I take it then, that if I do generate LLVM IR .. I would code that by hand as I did for the Go code?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 117, "user_id": 11456075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d692d21d702a08d3fdf751a53e3c4dd?s=128&d=identicon&r=PG&f=1", "display_name": "JackP", "link": "https://stackoverflow.com/users/11456075/jackp"}, "edited": false, "score": 0, "creation_date": 1557086793, "post_id": 55994730, "comment_id": 98638978, "body": "@JackP &quot;So the notion of there being a &quot;target language&quot; really only applies to the lexer/parser and not to the code I&#39;d eventually be generating.&quot; Yes, ANTLR&#39;s target language refers to the language that the lexer and parser (also listeners and visitors if enabled) will be generated in. LLVM might be the target language <i>of your compiler</i>, but that&#39;s completely independent from ANTLR&#39;s target language."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 117, "user_id": 11456075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d692d21d702a08d3fdf751a53e3c4dd?s=128&d=identicon&r=PG&f=1", "display_name": "JackP", "link": "https://stackoverflow.com/users/11456075/jackp"}, "edited": false, "score": 0, "creation_date": 1557086839, "post_id": 55994730, "comment_id": 98638992, "body": "&quot; if I do generate LLVM IR .. I would code that by hand as I did for the Go code?&quot; If by &quot;by hand&quot; you mean that ANTLR doesn&#39;t do it for you, then yes. You still have the choice between using the LLVM API vs. generating LLVM assembly as text, but that basically comes out the same in terms of the amount of work (and in terms of the logic of the code)."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 0, "last_activity_date": 1557078339, "last_edit_date": 1592644375, "creation_date": 1557078339, "answer_id": 55994730, "question_id": 55994540, "link": "https://stackoverflow.com/questions/55994540/im-using-antlr4-to-create-a-language-which-i-then-want-to-generate-llvm-ir-with/55994730#55994730", "title": "I&#39;m using Antlr4 to create a language which I then want to generate LLVM IR with. Do I need to hand-write LLVM IR in response to my visitor events?", "body": "<blockquote>\n<p>While learning Antlr4, I used Golang as a target language, so a statement in my toy language like:</p>\n<pre><code>$myVar = 10\n$myVar + 5\n</code></pre>\n<p>Would translate to some Golang code that generates &quot;15&quot; for the result</p>\n</blockquote>\n<p>That's not accurate. Your grammar is translated into Go code that parses your language. Your own code can then use that generated parser to translate the above into whatever you want.</p>\n<blockquote>\n<p>there isn't an LLVM IR target for ANTLR</p>\n</blockquote>\n<p>Nor would it help you if there were one. All that would do would be to create a parser written in LLVM instead of Go. You'd still have to write the code to translate your language into LLVM yourself (just like you'd have to write your own code into translate your language to Go).</p>\n<hr />\n<p>As to whether to use the LLVM-API to generate LLVM or to generate it as strings, either option would work. There are <a href=\"https://github.com/llvm-mirror/llvm/tree/release_80/bindings/go\" rel=\"nofollow noreferrer\">Go bindings for LLVM</a>, but it's also perfectly possible to just write LLVM assembly into an <code>.ll</code> file and then run that through <code>llc</code>.</p>\n"}], "owner": {"reputation": 117, "user_id": 11456075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d692d21d702a08d3fdf751a53e3c4dd?s=128&d=identicon&r=PG&f=1", "display_name": "JackP", "link": "https://stackoverflow.com/users/11456075/jackp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 55994730, "answer_count": 1, "score": 0, "last_activity_date": 1557078339, "creation_date": 1557076992, "last_edit_date": 1557077407, "question_id": 55994540, "link": "https://stackoverflow.com/questions/55994540/im-using-antlr4-to-create-a-language-which-i-then-want-to-generate-llvm-ir-with", "title": "I&#39;m using Antlr4 to create a language which I then want to generate LLVM IR with. Do I need to hand-write LLVM IR in response to my visitor events?", "body": "<p>While learning Antlr4, I used Golang as a target language, so a statement in my toy language like: </p>\n\n<pre><code>$myVar = 10\n$myVar + 5\n</code></pre>\n\n<p>Would translate to some Golang code that generates \"15\" for the result</p>\n\n<p>However, as far as I can see, there isn't an LLVM IR target for ANTLR, so the question is: what are my options?</p>\n\n<p>1) Generate C/C++ and then use it to emit LLVM IR?<br>\n 2) Try to find a Golang LLVM IR emitter?<br>\n 3) Keep using the generated Go lexer/parser but hand-write LLVM IR?  </p>\n\n<p>I tried to go through the LLVM documentation and watched a few videos on LLVM&lt; but they all seem to generate C/C++ and then communicate with the API that way. Not sure if they do that because that's what they know or if it's because that's the only way.</p>\n\n<p>Thanks in advance for any insights! </p>\n"}, {"tags": ["go", "dns", "nslookup"], "comments": [{"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1557166134, "post_id": 55993822, "comment_id": 98665934, "body": "Can you post your source code somewhere? You should not include the port number in the name you want to lookup. If you want to change the port used when talking to the DNS server you can use <code>-port=</code> i think."}, {"owner": {"reputation": 1074, "user_id": 1474572, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/61e620ade854da1592d4603691a258f6?s=128&d=identicon&r=PG", "display_name": "Saturnian", "link": "https://stackoverflow.com/users/1474572/saturnian"}, "reply_to_user": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1557167713, "post_id": 55993822, "comment_id": 98666523, "body": "@MattiasWadman just added some code! Hope this helps"}, {"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1557184490, "post_id": 55993822, "comment_id": 98671716, "body": "You seem to be mixing various stuff. Your code is doing an SOA request for the name google.com:53  This is not a valid name. Port has nothing to do there. <code>str</code> should be the name you want to query. The second parameter of Exchange is the nameserver you query + &quot;:&quot; + the port. So you can not use <code>str</code> both for <code>SetQuestion</code> and for <code>Exchange</code>.  You have to be clear on the separation between who (which nameserver) you query and what you query it for."}, {"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1557184581, "post_id": 55993822, "comment_id": 98671729, "body": "Also if you use <code>check-soa.go</code> you do not need to deal with all that stuff, <code>localQuery</code> does most of it for you. You can then study how the rest of the code in the same file uses the result from <code>localQuery</code> to display various stuff."}, {"owner": {"reputation": 1074, "user_id": 1474572, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/61e620ade854da1592d4603691a258f6?s=128&d=identicon&r=PG", "display_name": "Saturnian", "link": "https://stackoverflow.com/users/1474572/saturnian"}, "reply_to_user": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1557240762, "post_id": 55993822, "comment_id": 98694325, "body": "@PatrickMevzek You&#39;re right about that, that worked for me. Thanks! :)"}], "owner": {"reputation": 1074, "user_id": 1474572, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/61e620ade854da1592d4603691a258f6?s=128&d=identicon&r=PG", "display_name": "Saturnian", "link": "https://stackoverflow.com/users/1474572/saturnian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 448, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557167696, "creation_date": 1557071853, "last_edit_date": 1557167696, "question_id": 55993822, "link": "https://stackoverflow.com/questions/55993822/dns-soa-type-lookup-in-golang", "title": "DNS SOA type lookup in GoLang", "body": "<p>I'm very new to GoLang. So, I'm supposed to do an <code>nslookup</code> of a DNS that I read from a file. When I do <code>nslookup example-dns.com</code> from my terminal, I receive all details such as the server, address and all records associated with that dns. However, when I try the same via code (I'm using the following library: <a href=\"https://github.com/darkoperator/golang-dns/tree/master/contrib/check-soa\" rel=\"nofollow noreferrer\">GoLang check-soa.go</a>), I obtain an error saying <code>Missing port number</code>. </p>\n\n<p>So I tried with various port numbers (53, 443, etc - not random, of course) and I receive a <code>No such host</code> error. And when I try <code>nslookup example-dns.com:&lt;port number&gt;</code> via the terminal, I receive <code>** server can't find example-dns:&lt;port-number&gt;: NXDOMAIN</code> error.</p>\n\n<p>I'm not sure what I'm missing or doing wrong. Here's the code:</p>\n\n<pre><code>    import (\n    \"github.com/miekg/dns\"\n    \"fmt\"\n    // other imports\n    )\n\n    //other code ...\n\n    func checkSOA() {\n    str:=\"google.com:53\"\n    m := new(dns.Msg)\n    m.SetQuestion(str, dns.TypeSOA)\n\n    c := new(dns.Client)\n    r, p, q := c.Exchange(m, str)\n    fmt.Println(\"r is: \", r)\n    fmt.Println(\"p is: \", p)\n    fmt.Println(\"q is: \", q)\n\n    if r != nil &amp;&amp; r.Rcode != dns.RcodeSuccess {\n        fmt.Println(\"Failed to get an valid answer\")\n        fmt.Println(\"%v\\n\", r)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "midi"], "comments": [{"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1588709939, "post_id": 55993819, "comment_id": 109002892, "body": "Could you solve this problem? I think the reason is that you did not open any MIDI port to read the data from."}], "answers": [{"tags": [], "owner": {"reputation": 3216, "user_id": 1273978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dd2212a18f9aba8d63b14c552027a12?s=128&d=identicon&r=PG", "display_name": "metakeule", "link": "https://stackoverflow.com/users/1273978/metakeule"}, "is_accepted": true, "score": 2, "last_activity_date": 1594705573, "creation_date": 1594705573, "answer_id": 62888779, "question_id": 55993819, "link": "https://stackoverflow.com/questions/55993819/reading-midi-input-from-go/62888779#62888779", "title": "Reading MIDI input from GO", "body": "<p>Here is a working example with the current version of <code>gitlab.com/gomidi/midi</code> (also have a look at <code>gitlab.com/gomidi/midi/examples</code>).</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n\n    &quot;time&quot;\n\n    &quot;gitlab.com/gomidi/midi&quot;\n    . &quot;gitlab.com/gomidi/midi/midimessage/channel&quot; // (Channel Messages)\n    &quot;gitlab.com/gomidi/midi/reader&quot;\n    &quot;gitlab.com/gomidi/rtmididrv&quot;\n)\n\n// This example reads from the first input port\nfunc main() {\n    drv, err := rtmididrv.New()\n    must(err)\n\n    // make sure to close the driver at the end\n    defer drv.Close()\n\n    ins, err := drv.Ins()\n    must(err)\n\n    // takes the first input\n    in := ins[0]\n\n    fmt.Printf(&quot;opening MIDI Port %v\\n&quot;, in)\n    must(in.Open())\n\n    defer in.Close()\n\n    // to disable logging, pass mid.NoLogger() as option\n    rd := reader.New(\n        reader.NoLogger(),\n        // print every message\n        reader.Each(func(pos *reader.Position, msg midi.Message) {\n\n            // inspect\n            fmt.Println(msg)\n\n            switch v := msg.(type) {\n            case NoteOn:\n                fmt.Printf(&quot;NoteOn at channel %v: key: %v velocity: %v\\n&quot;, v.Channel(), v.Key(), v.Velocity())\n            case NoteOff:\n                fmt.Printf(&quot;NoteOff at channel %v: key: %v\\n&quot;, v.Channel(), v.Key())\n            }\n        }),\n    )\n\n    // listen for MIDI\n    err = rd.ListenTo(in)\n    must(err)\n\n    time.Sleep(10 * time.Second)\n    err = in.StopListening()\n    must(err)\n    fmt.Printf(&quot;closing MIDI Port %v\\n&quot;, in)\n}\n\nfunc must(err error) {\n    if err != nil {\n        panic(err.Error())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 6859358, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7r74U13hoVk/AAAAAAAAAAI/AAAAAAAAAHM/hN2G4W6D_rI/photo.jpg?sz=128", "display_name": "Lan Vuku\u0161i\u010d", "link": "https://stackoverflow.com/users/6859358/lan-vuku%c5%a1i%c4%8d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 62888779, "answer_count": 1, "score": 3, "last_activity_date": 1594705573, "creation_date": 1557071813, "question_id": 55993819, "link": "https://stackoverflow.com/questions/55993819/reading-midi-input-from-go", "title": "Reading MIDI input from GO", "body": "<p>I would like to listen to incoming MIDI messages using my GO program. However, I can't make it work.</p>\n\n<p>I've tried using midi libraries such as <a href=\"https://github.com/gomidi/midi\" rel=\"nofollow noreferrer\">https://github.com/gomidi/midi</a>, but I couldn't get it to work. There are no examples to be found and the documentation is unclear to me.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n\n    \"github.com/gomidi/midi\"\n    . \"github.com/gomidi/midi/midimessage/channel\" // (Channel Messages)\n    \"github.com/gomidi/midi/midimessage/realtime\"\n    \"github.com/gomidi/midi/midireader\"\n)\n\nfunc main() {\n    var input io.Reader\n\n    rthandler := func(m realtime.Message) {\n        fmt.Printf(\"Realtime: %s\\n\", m)\n    }\n\n    rd := midireader.New(input, rthandler)\n\n    var m midi.Message\n    var err error\n\n    for {\n        m, err = rd.Read()\n\n        // breaking at least with io.EOF\n        if err != nil {\n            break\n        }\n\n        // inspect\n        fmt.Println(m)\n\n        switch v := m.(type) {\n        case NoteOn:\n            fmt.Printf(\"NoteOn at channel %v: key: %v velocity: %v\\n\", v.Channel(), v.Key(), v.Velocity())\n        case NoteOff:\n            fmt.Printf(\"NoteOff at channel %v: key: %v\\n\", v.Channel(), v.Key())\n        }\n\n    }\n\n    if err != io.EOF {\n        panic(\"error: \" + err.Error())\n    }\n}\n</code></pre>\n\n<p>My goal is to be able to read (just printing when the midi message is received) the MIDI input for further processing.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["node.js", "go", "kubernetes"], "answers": [{"tags": [], "owner": {"reputation": 5656, "user_id": 11374921, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-74ExUmq_FAw/AAAAAAAAAAI/AAAAAAAARVQ/qmxKhxFOHDs/photo.jpg?sz=128", "display_name": "Vasili Angapov", "link": "https://stackoverflow.com/users/11374921/vasili-angapov"}, "is_accepted": true, "score": 2, "last_activity_date": 1557065497, "creation_date": 1557065497, "answer_id": 55992837, "question_id": 55991672, "link": "https://stackoverflow.com/questions/55991672/can-i-write-a-kubernetes-controller-in-nodejs-instead-of-go/55992837#55992837", "title": "Can I write a kubernetes controller in Nodejs instead of go?", "body": "<p>Client libraries for Kubernetes are available in many languages. See here for examples: <a href=\"https://kubernetes.io/docs/reference/using-api/client-libraries/\" rel=\"nofollow noreferrer\">https://kubernetes.io/docs/reference/using-api/client-libraries/</a></p>\n"}], "owner": {"reputation": 921, "user_id": 5488621, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/eQTff.jpg?s=128&g=1", "display_name": "sfxworks", "link": "https://stackoverflow.com/users/5488621/sfxworks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 55992837, "answer_count": 1, "score": 0, "last_activity_date": 1557065497, "creation_date": 1557057449, "question_id": 55991672, "link": "https://stackoverflow.com/questions/55991672/can-i-write-a-kubernetes-controller-in-nodejs-instead-of-go", "title": "Can I write a kubernetes controller in Nodejs instead of go?", "body": "<p>Looking into it for making awesome api things, but I don't know Go yet. I see there are generators for go, but I'd rather use a more familiar language at first. Is this possible or should I start learning Go?</p>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1557057821, "post_id": 55991116, "comment_id": 98631234, "body": "I don&#39;t see any significant difference in the output: <a href=\"https://play.golang.com/p/iRjS5XnIQkg\" rel=\"nofollow noreferrer\">play.golang.com/p/iRjS5XnIQkg</a> are you certain you shared the exact code you are having an issue with?"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1557060062, "post_id": 55991116, "comment_id": 98631866, "body": "This is an interesting case. It is because the program would not find any time on the Go scheduler to actually print anything, and exits. If you add a function call after <code>close(handler)</code>, you will see the output - for the purpose of only testing, call <code>runtime.Goschd()</code>."}], "owner": {"reputation": 477, "user_id": 1771375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JLDWW.jpg?s=128&g=1", "display_name": "Lakshan Dissanayake", "link": "https://stackoverflow.com/users/1771375/lakshan-dissanayake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557052866, "creation_date": 1557052866, "question_id": 55991116, "link": "https://stackoverflow.com/questions/55991116/go-routine-and-closing-channel-strange-behavior", "title": "Go-routine and closing channel strange behavior", "body": "<p>According to <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">Golang Documentation</a>, </p>\n\n<blockquote>\n  <p>A <code>defer</code> statement pushes a function call onto a list. The list of saved calls is executed after the surrounding function returns. Defer is commonly used to simplify functions that perform various clean-up actions. </p>\n</blockquote>\n\n<p>In other words, go <code>defer</code> temporarily holds the execution of command until the surrounding function returns. \nI wrote a simple go program which contains several goroutines, which should terminate 8 <code>reader</code> goroutines upon the termination of the <code>looper</code> goroutine.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n    // declaring handler\n    handler := make(chan int)\n\n    var wg sync.WaitGroup\n\n    // execute reader as 8 separate processes\n    for i := 0; i &lt; 8; i++ {\n        go reader(handler, &amp;wg)\n    }\n\n    // timer which fires an event once in a second\n    ticker := time.NewTicker(1 * time.Second)\n\n    // the channel which carries out termination signal\n    terminator := make(chan interface{})\n\n    go looper(ticker.C, handler, terminator)\n\n    // wait for 5 Seconds\n    time.Sleep(time.Second * 5)\n\n    // terminate looper\n    close(terminator)\n\n    //wait for reader functions to do their work\n    wg.Wait()\n}\n\n// receive val from looper and process it\nfunc reader(handler &lt;-chan int, wg *sync.WaitGroup) {\n    wg.Add(1)\n    defer wg.Done()\n    for val := range handler {\n        fmt.Printf(\"Received %d\\n\", val)\n        time.Sleep(2 * time.Second) //just to simulate a lengthy process\n    }\n}\n</code></pre>\n\n<p>in the program, if I close the handler channel using <code>defer</code>, it works fine.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func looper(ticker &lt;-chan time.Time, handler chan&lt;- int, terminator &lt;-chan interface{}) {\n    arr := []int{1, 2, 3, 4, 5}\n    defer close(handler)\n    for {\n        select {\n        case &lt;-ticker:\n            for _, val := range arr {\n                // passed the index to communication channel\n                handler &lt;- val\n            }\n        case &lt;-terminator:\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>But if I close the handler channel just before the return statement as follows, the program exists without printing anything</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func looper(ticker &lt;-chan time.Time, handler chan&lt;- int, terminator &lt;-chan interface{}) {\n    arr := []int{1, 2, 3, 4, 5}\n    for {\n        select {\n        case &lt;-ticker:\n            for _, val := range arr {\n                // passed the val to reader\n                handler &lt;- val\n            }\n        case &lt;-terminator:\n            close(handler)\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>What could be the root cause? I'm just having a BIG confusion there.</p>\n"}, {"tags": ["docker", "go", "docker-compose", "grpc", "grpc-go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9843325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u8wf4.jpg?s=128&g=1", "display_name": "nandakumar_r", "link": "https://stackoverflow.com/users/9843325/nandakumar-r"}, "edited": false, "score": 0, "creation_date": 1557052415, "post_id": 55990567, "comment_id": 98629961, "body": "but <code>docker ps -a</code> it is showing ports like <code>0.0.0.0:50051-&gt;50051&#47;tcp</code>"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 1, "last_activity_date": 1557048711, "creation_date": 1557048711, "answer_id": 55990567, "question_id": 55990378, "link": "https://stackoverflow.com/questions/55990378/i-tried-to-deploy-grpc-go-server-in-docker-and-expose-port-in-local-port-but-p/55990567#55990567", "title": "I tried to deploy gRPC (go) server in docker and expose port in local port but port bindings are not working", "body": "<p>You should use <code>127.0.0.1:50051</code> when connecting from a client on the host machine, or <code>auth_server:50051</code> if you are connecting from docker-compose network.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 8648485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abba524e9f9e7e5905383b29a8edc533?s=128&d=identicon&r=PG&f=1", "display_name": "Giuseppe Corbelli", "link": "https://stackoverflow.com/users/8648485/giuseppe-corbelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1610442454, "creation_date": 1610442454, "answer_id": 65680869, "question_id": 55990378, "link": "https://stackoverflow.com/questions/55990378/i-tried-to-deploy-grpc-go-server-in-docker-and-expose-port-in-local-port-but-p/65680869#65680869", "title": "I tried to deploy gRPC (go) server in docker and expose port in local port but port bindings are not working", "body": "<p>If you're running this on windows I would check the &quot;reserved port ranges&quot; with command</p>\n<pre><code> netsh interface ipv4 show excludedportrange protocol=tcp\n</code></pre>\n<p>Also see <a href=\"https://github.com/docker/for-win/issues/3171\" rel=\"nofollow noreferrer\">this thread on github</a>.</p>\n<p>If it's linux check that nothing on the host is binding on that port.</p>\n"}], "owner": {"reputation": 1, "user_id": 9843325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u8wf4.jpg?s=128&g=1", "display_name": "nandakumar_r", "link": "https://stackoverflow.com/users/9843325/nandakumar-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1610442454, "creation_date": 1557047215, "question_id": 55990378, "link": "https://stackoverflow.com/questions/55990378/i-tried-to-deploy-grpc-go-server-in-docker-and-expose-port-in-local-port-but-p", "title": "I tried to deploy gRPC (go) server in docker and expose port in local port but port bindings are not working", "body": "<p>I tried to deploy gRPC server and mongodb in docker. After that I trying to binding docker ports to my local ports. mongodb ports binding was working fine. But, gRPC server ports are not binding my local port </p>\n\n<pre><code>ports:\n  - \"50051:50051\"\n</code></pre>\n\n<p>like this i tried in docker-compose.yml</p>\n\n<p><b>docker-compose.yml</b></p>\n\n<pre><code>services:\n  auth_server:\n    container_name: auth_service\n    build: .\n    command: go run server.go\n    volumes:\n      - .:/go/src/auth_server\n    working_dir: /go/src/auth_server\n    ports:\n      - \"50051:50051\"\n    environment:\n      PORT: 50051\n</code></pre>\n\n<p>In client gRPC file I used host and port like, <b>0.0.0.0:50051</b>  </p>\n\n<pre><code>conn, err := grpc.Dial(\"0.0.0.0:50051\", grpc.WithInsecure())\n</code></pre>\n\n<p>but it was not working. I can't find any bug, so I assume I am doing something incorrectly.</p>\n"}, {"tags": ["performance", "go", "profile", "goroutine"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557044610, "post_id": 55990074, "comment_id": 98628336, "body": "I&#39;m assuming, simply subtracting two values from <code>time.Now()</code> is not good enough?"}, {"owner": {"reputation": 51, "user_id": 988746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1accf9109d5e9af1ae856c6a5540d577?s=128&d=identicon&r=PG", "display_name": "Huskar", "link": "https://stackoverflow.com/users/988746/huskar"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1557125701, "post_id": 55990074, "comment_id": 98646808, "body": "@rustyx CentOS Linux release 7.4.1708 (Core)"}, {"owner": {"reputation": 51, "user_id": 988746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1accf9109d5e9af1ae856c6a5540d577?s=128&d=identicon&r=PG", "display_name": "Huskar", "link": "https://stackoverflow.com/users/988746/huskar"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557125833, "post_id": 55990074, "comment_id": 98646871, "body": "@Sergio Tulentsev Right, it will include idle time when goroutine yields out."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 988746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1accf9109d5e9af1ae856c6a5540d577?s=128&d=identicon&r=PG", "display_name": "Huskar", "link": "https://stackoverflow.com/users/988746/huskar"}, "edited": false, "score": 0, "creation_date": 1557318425, "post_id": 56037754, "comment_id": 98723432, "body": "It&#39;s seens to be a nice solution, but I wonder if a goroutine has uniq CLOCK_THREAD_CPUTIME_ID , I will take some time to learing &quot;clock_gettime&quot;, do some experiments and feedback, thank you very much."}, {"owner": {"reputation": 175, "user_id": 13345667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b4c88ba8d10ab098c273e2a02b0049?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Naden", "link": "https://stackoverflow.com/users/13345667/anna-naden"}, "edited": false, "score": 0, "creation_date": 1600586013, "post_id": 56037754, "comment_id": 113130185, "body": "For this to work, the import C has to be immediately after the C code header"}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 1, "last_activity_date": 1557308536, "creation_date": 1557308536, "answer_id": 56037754, "question_id": 55990074, "link": "https://stackoverflow.com/questions/55990074/how-to-measure-execution-time-of-function-in-golang-excluding-waiting-time/56037754#56037754", "title": "How to measure execution time of function in golang, excluding waiting time", "body": "<p>There is no built-in way in Go to measure CPU time, but you can do it in a platform-specific way.</p>\n\n<p>For example, on POSIX systems (e.g. Linux) use <strong><a href=\"https://linux.die.net/man/3/clock_gettime\" rel=\"nofollow noreferrer\"><code>clock_gettime</code></a></strong> with <strong><code>CLOCK_THREAD_CPUTIME_ID</code></strong> as the parameter.</p>\n\n<p>Similarly you can use <code>CLOCK_PROCESS_CPUTIME_ID</code> to measure process CPU time and <code>CLOCK_MONOTONIC</code> for elapsed time.</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;pthread.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n\nstatic long long getThreadCpuTimeNs() {\n    struct timespec t;\n    if (clock_gettime(CLOCK_THREAD_CPUTIME_ID, &amp;t)) {\n        perror(\"clock_gettime\");\n        return 0;\n    }\n    return t.tv_sec * 1000000000LL + t.tv_nsec;\n}\n*/\nimport \"C\"\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    cputime1 := C.getThreadCpuTimeNs()\n    doWork()\n    cputime2 := C.getThreadCpuTimeNs()\n    fmt.Printf(\"CPU time = %d ns\\n\", (cputime2 - cputime1))\n}\n\nfunc doWork() {\n    x := 1\n    for i := 0; i &lt; 100000000; i++ {\n        x *= 11111\n    }\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>CPU time = 31250000 ns\n</code></pre>\n\n<p>Note the output is in nanoseconds. So here CPU time is 0.03 sec.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 12935407, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ettjgBXWSn0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxo4XqC07RDONUAZZ4LLbRmlsZ3g/photo.jpg?sz=128", "display_name": "Brent", "link": "https://stackoverflow.com/users/12935407/brent"}, "is_accepted": false, "score": 1, "last_activity_date": 1607112759, "creation_date": 1607112759, "answer_id": 65150085, "question_id": 55990074, "link": "https://stackoverflow.com/questions/55990074/how-to-measure-execution-time-of-function-in-golang-excluding-waiting-time/65150085#65150085", "title": "How to measure execution time of function in golang, excluding waiting time", "body": "<p>For people who stumble on this later like I did, you can actually use the built-in syscall.Getrusage instead of using Cgo. An example of this looks like</p>\n<pre><code>func GetCPU() int64 {\n    usage := new(syscall.Rusage)\n    syscall.Getrusage(syscall.RUSAGE_SELF, usage)\n    return usage.Utime.Nano() + usage.Stime.Nano()\n}\n</code></pre>\n<p>where I have added up the Utime (user CPU time) and Stime (system CPU time) of the calling process (RUSAGE_SELF) after converting them both to nanoseconds. <code>man 2 getrusage</code> has a bit more information on this system call.</p>\n<p>The documentation for syscall.Timeval suggests that Nano() returns the time in nanoseconds since the Unix epoch, but in my tests and looking at the implementation it appears actually to return just the CPU time in nanoseconds, not in nanoseconds since the Unix epoch.</p>\n"}], "owner": {"reputation": 51, "user_id": 988746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1accf9109d5e9af1ae856c6a5540d577?s=128&d=identicon&r=PG", "display_name": "Huskar", "link": "https://stackoverflow.com/users/988746/huskar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1229, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1607112759, "creation_date": 1557044179, "last_edit_date": 1557316935, "question_id": 55990074, "link": "https://stackoverflow.com/questions/55990074/how-to-measure-execution-time-of-function-in-golang-excluding-waiting-time", "title": "How to measure execution time of function in golang, excluding waiting time", "body": "<p>I have a demand to measure execute time(cpu cost) of plugins in go, we can treat plugins as functions, there may be many goroutine running in the same time. More precisely, the execute time should exclude idle time(goroutine waiting time), only cpu acquire time(of current goroutine).\nit's like:</p>\n\n<pre><code>go func(){\n    // this func is a plugin\n    ** start to record cpu acquire time of current func/plugin/goroutine **\n    ** run code **\n    ** stop to record cpu acquire time of current func/plugin/goroutine **\n    log.Debugf(\"This function is buzy for %d millisecs.\", cpuAcquireTime)\n    ** report cpuAcquirTime to monitor **\n}()\n</code></pre>\n\n<p>In my circunstance, it's hard to make unit test to measure function, the code is hard to decouple.</p>\n\n<p>I search google and stackoverflow and find no clue, is there any solution to satisfy my demand, and does it take too much resource?</p>\n"}, {"tags": ["linux", "docker", "go", "alpine"], "comments": [{"owner": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 0, "creation_date": 1557044990, "post_id": 55989902, "comment_id": 98628417, "body": "Your Dockerfile working fine same output as above, what command are you trying to building/running the image?"}], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 2891793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab80e4ccc2c9603843fb36a49b913bda?s=128&d=identicon&r=PG&f=1", "display_name": "siriele", "link": "https://stackoverflow.com/users/2891793/siriele"}, "edited": false, "score": 0, "creation_date": 1557096174, "post_id": 55994941, "comment_id": 98641012, "body": "Thanks for your answer. To add more context to this: If you change the version of golang to 1.10 in the docker file It works without any change to the DNS server. There was a change made in golang 1.11 to not support compressed hostnames.   <a href=\"https://groups.google.com/forum/#!topic/Golang-Nuts/vAbjprJNPV0\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/Golang-Nuts/vAbjprJNPV0</a>  <a href=\"https://github.com/golang/go/issues/27546\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/27546</a>  My issue is that I will be deploying this in a Kubernetes cluster and need a version of linux where systemd, or whatever dns resolver go uses not arbitrarily crash"}, {"owner": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "reply_to_user": {"reputation": 88, "user_id": 2891793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab80e4ccc2c9603843fb36a49b913bda?s=128&d=identicon&r=PG&f=1", "display_name": "siriele", "link": "https://stackoverflow.com/users/2891793/siriele"}, "edited": false, "score": 0, "creation_date": 1557105097, "post_id": 55994941, "comment_id": 98642376, "body": "If you create the executable using Go 1.10, you can run it on any type of Linux system (provided you compile it with CGO disabled and use have the same architecture, like <code>amd64</code>). In that case you&#39;d have a multi-stage docker build. Stage 1 builds the executable and stage 2 creates the docker image you want to run in your K8s cluster."}, {"owner": {"reputation": 88, "user_id": 2891793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab80e4ccc2c9603843fb36a49b913bda?s=128&d=identicon&r=PG&f=1", "display_name": "siriele", "link": "https://stackoverflow.com/users/2891793/siriele"}, "edited": false, "score": 0, "creation_date": 1557105107, "post_id": 55994941, "comment_id": 98642377, "body": "After trying your solution I could indeed get the results I expect, but the underlying issue is still there. I will upvote this answer because It provided additional context and tools that I had not known prior."}, {"owner": {"reputation": 88, "user_id": 2891793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab80e4ccc2c9603843fb36a49b913bda?s=128&d=identicon&r=PG&f=1", "display_name": "siriele", "link": "https://stackoverflow.com/users/2891793/siriele"}, "edited": false, "score": 0, "creation_date": 1557105235, "post_id": 55994941, "comment_id": 98642394, "body": "Oh yeah, I&#39;m using Go modules, which forces you to do all sorts of stuff to get it work; so I can&#39;t quite fallback to go1.10. I also want to compile in the container itself if possible."}], "tags": [], "owner": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "is_accepted": true, "score": 1, "last_activity_date": 1557079871, "creation_date": 1557079871, "answer_id": 55994941, "question_id": 55989902, "link": "https://stackoverflow.com/questions/55989902/lookup-google-com-on-192-168-65-153-cannot-unmarshal-dns-message/55994941#55994941", "title": "lookup google.com on 192.168.65.1:53: cannot unmarshal DNS message", "body": "<p>It's not really a Go issue. Running <code>go run run_stuff.go</code> on my mac yields the result you're expecting</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ go run run_stuff.go \n\ncname: _xmpp-server._tcp.google.com. \n\nxmpp-server.l.google.com.:5269:5:0\nalt2.xmpp-server.l.google.com.:5269:20:0\nalt4.xmpp-server.l.google.com.:5269:20:0\nalt1.xmpp-server.l.google.com.:5269:20:0\nalt3.xmpp-server.l.google.com.:5269:20:0\n</code></pre>\n\n<p>The issue likely has to do with your DNS settings in Docker. Using the exact same code and Dockerfile as you posted above, I ran the command <code>docker build -t test . &amp;&amp; docker run --rm -it --dns 8.8.8.8 test</code> which builds and runs the container. The difference being that I set the <code>--dns</code> flag (see <a href=\"https://docs.docker.com/config/containers/container-networking/\" rel=\"nofollow noreferrer\">the Docker docs</a> for details). The result being:</p>\n\n<pre><code>$ docker build -t test . &amp;&amp; docker run --rm -it --dns 8.8.8.8  test  \nSending build context to Docker daemon  27.14kB\nStep 1/7 : FROM golang:1.12.4\n ---&gt; b860ab44e93e\nStep 2/7 : RUN mkdir /app\n ---&gt; Using cache\n ---&gt; 2a339a5e5fde\nStep 3/7 : RUN uname -a\n ---&gt; Using cache\n ---&gt; dac4362453e6\nStep 4/7 : RUN go version\n ---&gt; Using cache\n ---&gt; ae654c1c4aa6\nStep 5/7 : WORKDIR /app\n ---&gt; Using cache\n ---&gt; db3c82038173\nStep 6/7 : COPY . /app/\n ---&gt; 9dba317a267d\nStep 7/7 : CMD [\"go\",\"run\",\"run_stuff.go\"]\n ---&gt; Running in 2ea6b38869f1\nRemoving intermediate container 2ea6b38869f1\n ---&gt; 0a0f817b51bb\nSuccessfully built 0a0f817b51bb\nSuccessfully tagged test:latest\n\ncname: _xmpp-server._tcp.google.com. \n\nxmpp-server.l.google.com.:5269:5:0\nalt4.xmpp-server.l.google.com.:5269:20:0\nalt3.xmpp-server.l.google.com.:5269:20:0\nalt1.xmpp-server.l.google.com.:5269:20:0\nalt2.xmpp-server.l.google.com.:5269:20:0\n</code></pre>\n\n<p>The default DNS server (<code>192.168.65.1</code>, usually set in <code>/etc/resolv.conf</code>) isn't capable of resolving the query. You could update the DNS settings for your host system, or add the <code>--dns</code> flag to make your code work properly in a Docker container.</p>\n"}], "owner": {"reputation": 88, "user_id": 2891793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab80e4ccc2c9603843fb36a49b913bda?s=128&d=identicon&r=PG&f=1", "display_name": "siriele", "link": "https://stackoverflow.com/users/2891793/siriele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "accepted_answer_id": 55994941, "answer_count": 1, "score": 2, "last_activity_date": 1557079871, "creation_date": 1557042751, "question_id": 55989902, "link": "https://stackoverflow.com/questions/55989902/lookup-google-com-on-192-168-65-153-cannot-unmarshal-dns-message", "title": "lookup google.com on 192.168.65.1:53: cannot unmarshal DNS message", "body": "<p>I have been with getting my docker image to issue srv record queries. It seems the golang guys broke the existing behavior by disregarding malformed records. I heard there was a fix, but I keep trying newer versions of ubuntu/alpine linux and nothing seems to make a difference. I cannot downgrade to golang 1.10. Is there something I'm doing wrong here? like screwing up my docker file? how ca I make this code actually work in my container? \nMy code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    net.DefaultResolver.PreferGo=true\n    cname, srvs, err := net.LookupSRV(\"xmpp-server\", \"tcp\", \"google.com\")\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"\\ncname: %s \\n\\n\", cname)\n\n    for _, srv := range srvs {\n        fmt.Printf(\"%v:%v:%d:%d\\n\", srv.Target, srv.Port, srv.Priority, srv.Weight)\n    }\n\n    // cname: _xmpp-server._tcp.google.com.\n    //\n    // xmpp-server.l.google.com.:5269:5:0\n    // alt2.xmpp-server.l.google.com.:5269:20:0\n    // alt1.xmpp-server.l.google.com.:5269:20:0\n    // alt4.xmpp-server.l.google.com.:5269:20:0\n    // alt3.xmpp-server.l.google.com.:5269:20:0\n}\n</code></pre>\n\n<p>My error:</p>\n\n<pre><code>panic: lookup google.com on 192.168.65.1:53: cannot unmarshal DNS message\n\ngoroutine 1 [running]:\nmain.main()\n    /app/run_stuff.go:12 +0x322\nexit status 2\n</code></pre>\n\n<p>my docker file:</p>\n\n<pre><code>FROM golang:1.12\nRUN mkdir /app \nRUN uname -a\nRUN go version\nWORKDIR /app\nCOPY . /app/\nCMD [\"go\",\"run\",\"run_stuff.go\"]\n</code></pre>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1557031074, "post_id": 55988766, "comment_id": 98626192, "body": "It looks like you have a problem connecting to gopkg.in.  Can you access <a href=\"https://gopkg.in/xmlpath.v2\" rel=\"nofollow noreferrer\">gopkg.in/xmlpath.v2</a> in a browser?"}, {"owner": {"reputation": 1, "user_id": 11219811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b0c79232b930ca7e02260b88598882?s=128&d=identicon&r=PG&f=1", "display_name": "casualmind", "link": "https://stackoverflow.com/users/11219811/casualmind"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1557032447, "post_id": 55988766, "comment_id": 98626388, "body": "Yes I can connecting to gopkg.in"}, {"owner": {"reputation": 479, "user_id": 1538022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7318ab5b78414d79e63b33c0c0d29f4?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/1538022/alper"}, "edited": false, "score": 0, "creation_date": 1557046049, "post_id": 55988766, "comment_id": 98628624, "body": "Are you behind any kind of proxy ? What is the result of <code>curl -v https:&#47;&#47;gopkg.in&#47;xmlpath.v2?go-get=1</code> ?"}, {"owner": {"reputation": 1, "user_id": 11219811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b0c79232b930ca7e02260b88598882?s=128&d=identicon&r=PG&f=1", "display_name": "casualmind", "link": "https://stackoverflow.com/users/11219811/casualmind"}, "reply_to_user": {"reputation": 479, "user_id": 1538022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7318ab5b78414d79e63b33c0c0d29f4?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/1538022/alper"}, "edited": false, "score": 0, "creation_date": 1557047376, "post_id": 55988766, "comment_id": 98628859, "body": "@Alper no Im not. Im using VPS Ubuntu 18.04 btw. Here is the result <code>*   Trying 35.196.143.184... * TCP_NODELAY set * Connected to gopkg.in (35.196.143.184) port 443 (#0) * ALPN, offering h2 * ALPN, offering http&#47;1.1 * successfully set certificate verify locations: *   CAfile: &#47;etc&#47;ssl&#47;certs&#47;ca-certificates.crt   CApath: &#47;etc&#47;ssl&#47;certs * (304) (OUT), TLS handshake, Client hello (1):</code>"}, {"owner": {"reputation": 479, "user_id": 1538022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7318ab5b78414d79e63b33c0c0d29f4?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/1538022/alper"}, "edited": false, "score": 0, "creation_date": 1557049908, "post_id": 55988766, "comment_id": 98629398, "body": "This output is not complete. But do you see the <code>HTTP&#47;2 200</code> or something similar ? Or do you see any kind of timeout again?"}, {"owner": {"reputation": 1, "user_id": 11219811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b0c79232b930ca7e02260b88598882?s=128&d=identicon&r=PG&f=1", "display_name": "casualmind", "link": "https://stackoverflow.com/users/11219811/casualmind"}, "edited": false, "score": 0, "creation_date": 1557051448, "post_id": 55988766, "comment_id": 98629758, "body": "omg I forgot... this <code>* OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to gopkg.in:443                                                                    * stopped the pause stream!                                          * Closing connection 0 curl: (35) OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to gopkg.in:443</code>"}, {"owner": {"reputation": 479, "user_id": 1538022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7318ab5b78414d79e63b33c0c0d29f4?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/1538022/alper"}, "edited": false, "score": 0, "creation_date": 1557088831, "post_id": 55988766, "comment_id": 98639518, "body": "There seems to be some issue with your ssl connection, you may try to update openssl maybe. Though I am not sure of the exact reason. I think the problem is related to your OS or libraries in your OS and not the package."}, {"owner": {"reputation": 479, "user_id": 1538022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7318ab5b78414d79e63b33c0c0d29f4?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/1538022/alper"}, "edited": false, "score": 0, "creation_date": 1557089740, "post_id": 55988766, "comment_id": 98639732, "body": "This may be related <a href=\"https://askubuntu.com/questions/1042440/ubuntu-18-04-failed-to-connect-to-some-https-sites\" title=\"ubuntu 18 04 failed to connect to some https sites\">askubuntu.com/questions/1042440/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11219811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b0c79232b930ca7e02260b88598882?s=128&d=identicon&r=PG&f=1", "display_name": "casualmind", "link": "https://stackoverflow.com/users/11219811/casualmind"}, "reply_to_user": {"reputation": 479, "user_id": 1538022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7318ab5b78414d79e63b33c0c0d29f4?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/1538022/alper"}, "edited": false, "score": 0, "creation_date": 1557093419, "post_id": 55988766, "comment_id": 98640484, "body": "@Alper I have been following and disabling IPV6. And It&#39;s still not working"}, {"owner": {"reputation": 479, "user_id": 1538022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7318ab5b78414d79e63b33c0c0d29f4?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/1538022/alper"}, "edited": false, "score": 0, "creation_date": 1557096479, "post_id": 55988766, "comment_id": 98641055, "body": "Well, you can search for VPS and <code>go get</code> issues. This is the only thing I can find: <a href=\"https://groups.google.com/forum/#!topic/mgo-users/rO1-gUDFo_g\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/mgo-users/rO1-gUDFo_g</a>"}], "owner": {"reputation": 1, "user_id": 11219811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b0c79232b930ca7e02260b88598882?s=128&d=identicon&r=PG&f=1", "display_name": "casualmind", "link": "https://stackoverflow.com/users/11219811/casualmind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557092024, "creation_date": 1557029595, "last_edit_date": 1557092024, "question_id": 55988766, "link": "https://stackoverflow.com/questions/55988766/unrecognized-import-path-gopkg-in-xmlpath-v2", "title": "Unrecognized Import Path &quot;gopkg.in/xmlpath.v2&quot;", "body": "<p>I got an error when I tried to run app on my ubuntu, but when I try in Windows, It is worked.</p>\n\n<p><code>go: gopkg.in/xmlpath.v2@v2.0.0-20150820204837-860cbeca3ebc: unrecognized import path \"gopkg.in/xmlpath.v2\" (https fetch: Get https://gopkg.in/xmlpath.v2?go-get=1: net/http: TLS handshake timeout)            go: gopkg.in/sourcemap.v1@v1.0.5: unrecognized import path \"gopkg.in/sourcemap.v1\" (https fetch: Get https://gopkg.in/sourcemap.v1?go-get=1: net/http: TLS handshake timeout)                                  go: gopkg.in/check.v1@v1.0.0-20180628173108-788fd7840127: unrecognized import path \"gopkg.in/check.v1\" (https fetch: Get https://gopkg.in/check.v1?go-get=1: net/http: TLS handshake timeout)</code></p>\n\n<p>And here result of curl for check connection</p>\n\n<pre><code>*   Trying 35.196.143.184...                                         \n* TCP_NODELAY set                                                    \n* Connected to gopkg.in (35.196.143.184) port 443 (#0)               \n* ALPN, offering h2                                                  \n* ALPN, offering http/1.1                                            \n* successfully set certificate verify locations:                     \n*   CAfile: /etc/ssl/certs/ca-certificates.crt                         \nCApath: /etc/ssl/certs                                             \n* (304) (OUT), TLS handshake, Client hello (1):                      \n* OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to gopkg.in:443                                                                    \n* stopped the pause stream!                                          \n* Closing connection 0\ncurl: (35) OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to gopkg.in:443\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8264448, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--KNChjI64PM/AAAAAAAAAAI/AAAAAAAAFYw/tT1ZElP76ME/photo.jpg?sz=128", "display_name": "Raj Shrestha", "link": "https://stackoverflow.com/users/8264448/raj-shrestha"}, "edited": false, "score": 0, "creation_date": 1557028256, "post_id": 55988575, "comment_id": 98625853, "body": "Thanks. Python interpreter needs a new line at the end of each input. By appending the new line at the input it worked."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1557026614, "creation_date": 1557026614, "answer_id": 55988575, "question_id": 55988528, "link": "https://stackoverflow.com/questions/55988528/i-need-to-copy-the-input-given-by-the-user-to-the-child-process-how-can-i-copy/55988575#55988575", "title": "I need to copy the input given by the user to the child Process. How can I copy the input given to child processes stdIn?", "body": "<p>I think you'll actually need to capture the input, and pass it to the subprocess...</p>\n\n<pre><code>func main(){\n  cmd := exec.Command(\"python\", \"-i\")\n  stdin, err := cmd.StdinPipe()\n  if err != nil {\n      panic(err)\n  }\n  cmd.Stdout = os.Stdout\n  cmd.Stderr = os.Stderr\n\n  buff := bufio.NewScanner(os.Stdin)\n\n  go func(){\n    for buff.Scan(){\n      input := buff.Text()\n      fmt.Println(input)\n      io.WriteString(stdin, input)\n    }\n  }()\n\n  cmd.Start()  \n  cmd.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8264448, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--KNChjI64PM/AAAAAAAAAAI/AAAAAAAAFYw/tT1ZElP76ME/photo.jpg?sz=128", "display_name": "Raj Shrestha", "link": "https://stackoverflow.com/users/8264448/raj-shrestha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557026614, "creation_date": 1557026011, "question_id": 55988528, "link": "https://stackoverflow.com/questions/55988528/i-need-to-copy-the-input-given-by-the-user-to-the-child-process-how-can-i-copy", "title": "I need to copy the input given by the user to the child Process. How can I copy the input given to child processes stdIn?", "body": "<p>I need to copy all the input provided by the user for the child process during its execution. I have tried to scan the cmd.Stdin for the copy of  input but can't get it. Am I missing something here?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\nfunc main(){\n  cmd:= exec.Command(\"python\", \"-i\")\n  cmd.Stdin = os.Stdin\n  cmd.Stdout = os.Stdout\n  cmd.Stderr = os.Stderr\n\n  buff := bufio.NewScanner(cmd.Stdin)\n\n  go func(){\n    for buff.Scan(){\n      fmt.Println(buff.Text())\n    }\n  }()\n\n  _ = cmd.Run()  \n}\n</code></pre>\n"}]