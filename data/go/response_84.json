[{"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1471479458, "last_edit_date": 1471479458, "creation_date": 1471478703, "answer_id": 39008046, "question_id": 39007498, "link": "https://stackoverflow.com/questions/39007498/golang-copy-exec-output-to-a-buffer/39008046#39008046", "title": "Golang - Copy exec output to a buffer", "body": "<p>I see some problems:</p>\n\n<ul>\n<li>You should be waiting for the goroutines to finish (e.g., using\n<code>sync.WaitGroup</code>).</li>\n<li>You're accessing <code>output</code> concurrently in two\ngoroutines, which is not safe.</li>\n</ul>\n\n<p>You could collect <code>stdout</code> and <code>stderr</code> in two separate buffers and return them separately, if that works for what you're trying to do.</p>\n"}, {"tags": [], "owner": {"reputation": 261, "user_id": 153967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889b0f39714481513516c8c9c7921201?s=128&d=identicon&r=PG", "display_name": "amoebob", "link": "https://stackoverflow.com/users/153967/amoebob"}, "is_accepted": true, "score": 1, "last_activity_date": 1471484712, "creation_date": 1471484712, "answer_id": 39008735, "question_id": 39007498, "link": "https://stackoverflow.com/questions/39007498/golang-copy-exec-output-to-a-buffer/39008735#39008735", "title": "Golang - Copy exec output to a buffer", "body": "<p>Here is a simplified and working revision of your example. Note that the test command was swapped out so that I could test within Windows and that your error checks have been omitted only for brevity.</p>\n\n<p>The key change is that a <code>sync.WaitGroup</code> is preventing the <code>run</code> function from printing the output and returning until the goroutine has indicated that it's finished.</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>func main() {\n    dir := \"c:\\\\windows\\\\system32\"\n    command1 := exec.Command(\"cmd\", \"/C\", \"dir\", \"/s\", dir)\n    command2 := exec.Command(\"cmd\", \"/C\", \"dir\", \"/s\", dir)\n    out1, _ := run(command1)\n    out2, _ := run(command2)\n    log.Printf(\"Length [%d] vs [%d]\\n\", len(out1), len(out2))\n}\n\nfunc run(cmd *exec.Cmd) (string, error) {\n    var output bytes.Buffer\n    var waitGroup sync.WaitGroup\n\n    stdout, _ := cmd.StdoutPipe()\n    writer := io.MultiWriter(os.Stdout, &amp;output)\n\n    waitGroup.Add(1)\n    go func() {\n        defer waitGroup.Done()\n        io.Copy(writer, stdout)\n    }()\n\n    cmd.Run()\n    waitGroup.Wait()\n    return output.String(), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2308, "favorite_count": 0, "accepted_answer_id": 39008735, "answer_count": 2, "score": 0, "last_activity_date": 1471484712, "creation_date": 1471474779, "question_id": 39007498, "link": "https://stackoverflow.com/questions/39007498/golang-copy-exec-output-to-a-buffer", "title": "Golang - Copy exec output to a buffer", "body": "<p>I'm writing a function that exec's a program and returns stdout and stderr. It also has the option to display the output to the console. I'm clearly not waiting on something, as if I run the function twice in a row, the outputs are different. Here's a sample program, replace the dir var with a dir with a lot of files to fill up the buffers:</p>\n\n<pre><code>func main() {\n    dir := \"SOMEDIRECTORYWITHALOTOFFILES\"\n    out, err := run(\"ls -l \"+dir, true)\n    if err != nil {\n        log.Fatalf(\"run returned %s\", err)\n    }\n    log.Printf(\"Out: %s\", out)\n    out2, err := run(\"ls -l \"+dir, false)\n    if err != nil {\n        log.Fatalf(\"run returned %s\", err)\n    }\n    log.Printf(\"Out2: %s\", out2)\n    if out != out2 {\n        log.Fatalf(\"Out mismatch\")\n    }\n}\n\nfunc run(cmd string, displayOutput bool) (string, error) {\n    var command *exec.Cmd\n    command = exec.Command(\"/bin/sh\", \"-c\", cmd)\n    var output bytes.Buffer\n\n    stdout, err := command.StdoutPipe()\n    if err != nil {\n        return \"\", fmt.Errorf(\"Unable to setup stdout for command: %v\", err)\n    }\n    go func() {\n        if displayOutput == true {\n            w := io.MultiWriter(os.Stdout, &amp;output)\n            io.Copy(w, stdout)\n        } else {\n            output.ReadFrom(stdout)\n        }\n    }()\n\n    stderr, err := command.StderrPipe()\n    if err != nil {\n        return \"\", fmt.Errorf(\"Unable to setup stderr for command: %v\", err)\n    }\n    go func() {\n        if displayOutput == true {\n            w := io.MultiWriter(os.Stderr, &amp;output)\n            io.Copy(w, stderr)\n        } else {\n            output.ReadFrom(stderr)\n        }\n    }()\n    err = command.Run()\n    if err != nil {\n        return \"\", err\n    }\n    return output.String(), nil\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 4176, "user_id": 26849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-tO7nkYt2C3Q/AAAAAAAAAAI/AAAAAAAAAr4/UstVddaB4E4/photo.jpg?sz=128", "display_name": "chris", "link": "https://stackoverflow.com/users/26849/chris"}, "edited": false, "score": 0, "creation_date": 1471460219, "post_id": 39004259, "comment_id": 65360240, "body": "Thanks for the help :)"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 3, "last_activity_date": 1471459976, "creation_date": 1471459976, "answer_id": 39004259, "question_id": 39004164, "link": "https://stackoverflow.com/questions/39004164/compile-error-on-type-comparison/39004259#39004259", "title": "Compile error on type comparison", "body": "<p><code>Error</code> method is defined on the type that is a pointer to <code>datastore.ErrFieldMismatch</code>, i.e., <code>Error</code> is defined on <code>*datastore.ErrFieldMismatch</code>, hence it's only <code>*datastore.ErrFieldMismatch</code> that implements the <code>Error</code> interface.</p>\n\n<p>Try changing your <code>case</code> expression:</p>\n\n<pre><code>func (p *Program) Load(ps []datastore.Property) error {\n    if err := datastore.LoadStruct(p, ps); err != nil {\n        switch err.(type) {\n        case *datastore.ErrFieldMismatch:  // use pointer type here\n            return nil\n        default:\n            return err\n        }\n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 4176, "user_id": 26849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-tO7nkYt2C3Q/AAAAAAAAAAI/AAAAAAAAAr4/UstVddaB4E4/photo.jpg?sz=128", "display_name": "chris", "link": "https://stackoverflow.com/users/26849/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 39004259, "answer_count": 1, "score": 1, "last_activity_date": 1471459976, "creation_date": 1471459663, "question_id": 39004164, "link": "https://stackoverflow.com/questions/39004164/compile-error-on-type-comparison", "title": "Compile error on type comparison", "body": "<p>I get the compile error shown below saying that the ErrFieldMismatch type is missing an <code>Error()</code> method, but as shown in the last code chunk, it is not. </p>\n\n<p>Any idea to why I cannot perform the type comparison for this?</p>\n\n<h2>Error</h2>\n\n<p><code>impossible type switch case: err (type error) cannot have dynamic type \"google.golang.org/appengine/datastore\".ErrFieldMismatch (missing Error method)</code> </p>\n\n<h2>my code</h2>\n\n<pre><code>type Program struct {\n    aemodel.Base\n\n    Name        string   `json:\"name\" required:\"true\"`\n    Public      bool     `json:\"isPublic\"`\n    Description string   `json:\"description\" required:\"true\"`\n    Default     bool     `json:\"isDefault\"`\n    Tags        []string `json:\"tags\"`\n\n    // Level int\n}\n\n// Load - PropertyLoadSaver interface\nfunc (p *Program) Load(ps []datastore.Property) error {\n    if err := datastore.LoadStruct(p, ps); err != nil {\n        switch err.(type) {\n        case datastore.ErrFieldMismatch:  // &lt;-- Failure point\n            return nil\n        default:\n            return err\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<h2>appengine code</h2>\n\n<pre><code>type ErrFieldMismatch struct {\n    StructType reflect.Type\n    FieldName  string\n    Reason     string\n}\n\nfunc (e *ErrFieldMismatch) Error() string {\n    return fmt.Sprintf(\"datastore: cannot load field %q into a %q: %s\",\n        e.FieldName, e.StructType, e.Reason)\n}\n</code></pre>\n"}, {"tags": ["go", "ffmpeg", "exec"], "answers": [{"comments": [{"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "edited": false, "score": 0, "creation_date": 1471457958, "post_id": 39003518, "comment_id": 65359015, "body": "Wow. I cannot believe that fixed it. You are a genius my friend."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 1, "last_activity_date": 1471457186, "creation_date": 1471457186, "answer_id": 39003518, "question_id": 39003365, "link": "https://stackoverflow.com/questions/39003365/golang-command-working-in-terminal-but-not-with-exec-package/39003518#39003518", "title": "Golang command working in terminal but not with exec package", "body": "<p>When you are using <code>strings.Fields(command)</code>, the fields are being split on spaces. This results in the <code>parts</code> slice containing a value <code>'fade=in:0:15,fade=out:105:15'</code>, with quotes. This complete value (with quotes) is being passed to the <code>ffmpeg</code> command, which the command is unable to recognize.</p>\n\n<p>A shell would strip off these quotes and pass the string <code>fade=in:0:15,fade=out:105:15</code> only which Go isn't doing. To fix, try:</p>\n\n<pre><code>// remove the quotes around fade=in:0:15,fade=out:105:15\ncommand := \"ffmpeg -y -loop 1 -i image.png -vf fade=in:0:15,fade=out:105:15 -c:v mpeg2video -t 5 -s 1280x720 -r 30 -q:v 1 -preset ultrafast image.mpg\"\n\nparts := strings.Fields(command)\n</code></pre>\n"}], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1526, "favorite_count": 0, "accepted_answer_id": 39003518, "answer_count": 1, "score": 0, "last_activity_date": 1471457186, "creation_date": 1471456636, "last_edit_date": 1592644375, "question_id": 39003365, "link": "https://stackoverflow.com/questions/39003365/golang-command-working-in-terminal-but-not-with-exec-package", "title": "Golang command working in terminal but not with exec package", "body": "<p>I am converting a video generation library from NodeJS to GO that primarily uses FFMPEG for all the video processing. I already have all the FFMPEG commands written out to do the generation I want. The issue is that when I try to run the command through the <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">os/exec</a> package, it fails. However, if I copy the exact command and run it directly in the terminal it works and I cannot figure out why that is. My code that runs the command is below:</p>\n<pre><code>command := &quot;ffmpeg -y -loop 1 -i image.png -vf 'fade=in:0:15,fade=out:105:15' -c:v mpeg2video -t 5 -s 1280x720 -r 30 -q:v 1 -preset ultrafast image.mpg&quot;\n\nparts := strings.Fields(command)\ncmd := exec.Command(parts[0], parts[1:]...)\ncmd.Stderr = os.Stderr\ncmd.Stdout = os.Stdout\nerr := cmd.Run()\nif err != nil {\n    panic(err)\n}\n</code></pre>\n<p>The ffmpeg error I get when I try to run this code is:</p>\n<blockquote>\n<p>[AVFilterGraph @ 0x22a9bc0] No such filter: 'fade=in:0:15,fade=out:105:15'</p>\n<p>Error opening filters!</p>\n<p>2016/08/17 17:48:53 exit status 1</p>\n</blockquote>\n<p>Like I previously stated, if I copy the EXACT command:</p>\n<pre><code>ffmpeg -y -loop 1 -i image.png -vf 'fade=in:0:15,fade=out:105:15' -c:v mpeg2video -t 5 -s 1280x720 -r 30 -q:v 1 -preset ultrafast image.mpg\n</code></pre>\n<p>and run it directly in the terminal, it works no problem.</p>\n<p>PLEASE HELP.</p>\n"}, {"tags": ["linux", "shell", "go", "terminal"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 1, "creation_date": 1471450366, "post_id": 39001517, "comment_id": 65354836, "body": "dumb is literally that. it just spits out characters you send it and has no positioning capabilities other than carriage return and outputting spaces. there&#39;s no &quot;cursor&quot; to move around, therefore you can&#39;t print &quot;complicated&quot; interfaces in it, without basically printing out the entire screen every time something changes. and note that this isn&#39;t bash complaining, this is mc. it requires a proper terminal. try vt100 or something instead of dumb."}, {"owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1471450588, "post_id": 39001517, "comment_id": 65354962, "body": "@MarcB, oh, I won&#39;t be able to implement <code>vt100</code> for sure, I just want to check that my <code>dumb</code> implementation works as expected from <code>dumb</code> terminals. For example I noticed that my standard terminal on Linux doesn&#39;t automatically scroll when the character is printed on the last column of last line."}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1471507381, "post_id": 39001517, "comment_id": 65376744, "body": "It would (only) do that when printing an additional character to wrap to the next line."}], "answers": [{"comments": [{"owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "edited": false, "score": 0, "creation_date": 1471450855, "post_id": 39001689, "comment_id": 65355137, "body": "Thanks. Now I need only to decipher that flags.. =)"}, {"owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "reply_to_user": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "edited": false, "score": 0, "creation_date": 1471451328, "post_id": 39001689, "comment_id": 65355414, "body": "in <code>man terminfo</code> on modern linux there&#39;s a nice list of capabilities with some explanations, at least enough to decode what&#39;s going on."}, {"owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "edited": false, "score": 0, "creation_date": 1494836740, "post_id": 39001689, "comment_id": 74978889, "body": "Still would be nice to get those explanations online."}, {"owner": {"reputation": 583, "user_id": 7102831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cd25404ff80b8271b3ed72a718c269?s=128&d=identicon&r=PG&f=1", "display_name": "nate", "link": "https://stackoverflow.com/users/7102831/nate"}, "edited": false, "score": 0, "creation_date": 1494849397, "post_id": 39001689, "comment_id": 74986827, "body": "including <code>-L</code> doesn&#39;t work? Ex: <code>$ infocmp -L dumb</code>.  May I ask, what flags are you talking about?"}], "tags": [], "owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "is_accepted": false, "score": 5, "last_activity_date": 1471450706, "creation_date": 1471450706, "answer_id": 39001689, "question_id": 39001517, "link": "https://stackoverflow.com/questions/39001517/features-obligatory-for-term-dumb-terminal/39001689#39001689", "title": "Features obligatory for TERM=dumb terminal", "body": "<p>Your best source of information will be the terminfo entry, easily viewed with the <a href=\"http://linux.die.net/man/1/infocmp\" rel=\"noreferrer\">infocmp</a> tool:</p>\n\n<pre><code>infocmp dumb\n#       Reconstructed via infocmp from file: /lib/terminfo/d/dumb\ndumb|80-column dumb tty,\n        am,\n        cols#80,\n        bel=^G, cr=^M, cud1=^J, ind=^J,\n</code></pre>\n\n<p>which makes it pretty clear that the dumb terminal is quite limited ...</p>\n"}, {"comments": [{"owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "edited": false, "score": 0, "creation_date": 1471508657, "post_id": 39005551, "comment_id": 65377420, "body": "So, <code>^G</code> is byte 0x07 and means that my client should beep when it receives one? And <code>^M</code> is 0x0D, which is <code>\\r</code>, and <code>^J</code>is actually <code>\\n</code>, so when remote sends 0x0D my client should get cursor back at the start of line."}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "reply_to_user": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "edited": false, "score": 0, "creation_date": 1471508792, "post_id": 39005551, "comment_id": 65377500, "body": "yes - but: the carriage return may be (normally is) translated by the terminal driver (not the terminal itself) into <code>^M^J</code>.  The terminal description only tells what the <i>terminal</i> can do."}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": true, "score": 8, "last_activity_date": 1471465446, "last_edit_date": 1592644375, "creation_date": 1471465087, "answer_id": 39005551, "question_id": 39001517, "link": "https://stackoverflow.com/questions/39001517/features-obligatory-for-term-dumb-terminal/39005551#39005551", "title": "Features obligatory for TERM=dumb terminal", "body": "<p>Going to the source can help.  The terminal database has comments.  Here is a <a href=\"http://invisible-island.net/ncurses/terminfo.src.html#tic-dumb\" rel=\"noreferrer\">slice from that</a>:</p>\n<pre><code>#### Specials\n#\n# Special &quot;terminals&quot;.  These are used to label tty lines when you don't\n# know what kind of terminal is on it.  The characteristics of an unknown\n# terminal are the lowest common denominator - they look about like a ti 700.\n#\n\ndumb|80-column dumb tty,\n        am,\n        cols#80,\n        bel=^G, cr=^M, cud1=^J, ind=^J,\nunknown|unknown terminal type,\n        gn, use=dumb,\n</code></pre>\n<p>The &quot;dumb&quot; and &quot;unknown&quot; terminal types are assumed, but rarely used:</p>\n<ul>\n<li><p>&quot;dumb&quot; has automargins (text &quot;wraps&quot; at the right margin), is assumed to have 80 columns, and an ASCII BEL and carriage return.  For lack of something better, <code>cud1</code> (cursor down) is an ASCII line-feed.  The <code>ind</code> (index) value is the same, implying that text scrolls up when you reach the bottom of the screen.</p>\n<p>There is no cursor-addressing (<code>cup</code>) nor alternates (such as moving along a row or column arbitrarily).</p>\n</li>\n<li><p>&quot;unknown&quot; adds the &quot;generic&quot; flag, which marks it as unsuitable for use by curses applications.  Think of it as a printer.</p>\n</li>\n</ul>\n<p>As for <em>minimum</em> requirements, that actually depends upon the individual application.  ncurses can manage to move around the screen without actually having <code>cup</code>.  It works with a half-dozen strategies.  If you read the source for <code>mvcur</code>, you can get an idea of what it needs.</p>\n<p>However, applications such as <code>mc</code> do not simply rely upon ncurses to decide if it works, since (in this case) it may link with slang (which doesn't check that closely).  So <code>mc</code> does its own checks, which may add restrictions.</p>\n<p>In practice, unless you choose a limited terminal description such as &quot;dumb&quot;, most of the terminals you are likely to encounter will work.</p>\n<p>Further reading:</p>\n<ul>\n<li><a href=\"http://invisible-island.net/ncurses/man/terminfo.5.html\" rel=\"noreferrer\">terminfo - terminal capability data base</a></li>\n<li><a href=\"http://invisible-island.net/ncurses/man/curs_terminfo.3x.html\" rel=\"noreferrer\">curses interfaces to terminfo database</a> (including <code>mvcur</code>)</li>\n<li><a href=\"https://github.com/ThomasDickey/ncurses-snapshots/blob/master/ncurses/tty/lib_mvcur.c\" rel=\"noreferrer\">ncurses/tty/lib_mvcur.c</a></li>\n</ul>\n"}], "owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7663, "favorite_count": 2, "accepted_answer_id": 39005551, "answer_count": 2, "score": 7, "last_activity_date": 1494831622, "creation_date": 1471450167, "last_edit_date": 1489164193, "question_id": 39001517, "link": "https://stackoverflow.com/questions/39001517/features-obligatory-for-term-dumb-terminal", "title": "Features obligatory for TERM=dumb terminal", "body": "<p>I am looking to implement a remote client in <a href=\"/questions/tagged/golang\" class=\"post-tag\" title=\"show questions tagged &#39;golang&#39;\" rel=\"tag\">golang</a> which connects to Linux through <code>nc</code> and starts <code>bash</code>. So I need to tell <code>bash</code> what features I can parse from the <code>stdout</code> that it sends to me, and how I am going to send keycodes and other stuff to its <code>stdin</code>, so that it could parse them too.</p>\n\n<p>This is done with <code>TERM=something</code> environment variable, which I need to set to some value. If I don't set it, then various programs start to complain:</p>\n\n<pre><code>$ mc\nThe TERM environment variable is unset!\n</code></pre>\n\n<p>I found that I can set TERM to <code>dumb</code> to say that my client is really limited. And still it seems that I am missing something.</p>\n\n<pre><code>$ export TERM=dumb\n$ mc\nYour terminal lacks the ability to clear the screen or position the cursor.\n</code></pre>\n\n<p>From here it looks like <code>dumb</code> terminal don't have these two abilities, but what abilities it is still expected to have? Is there a specification or some de-facto standard about it?</p>\n"}, {"tags": ["go", "multicast"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1471497455, "post_id": 39000125, "comment_id": 65372400, "body": "Have you read up on what behaviour is enabled by using <code>SO_REUSRADDR</code>? Why did you use it in the first place? I&#39;m asking because your question basically sounds like this: &quot;I have a problem X due to Y (if I disable Y the problem did not occur); should I not use Y?&quot;. This begs an obvious answer and hence begs the question about why do you have Y in the first place."}, {"owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1471502120, "post_id": 39000125, "comment_id": 65374028, "body": "i didnt say i enabled/disabled SO_REUSRADDR, i said it might be related to it as the code is working perfectly when using different ports (based on my knowledge in c++)  how to enabled/disable SO_REUSRADDR in golang anyways?"}, {"owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1471539368, "post_id": 39000125, "comment_id": 65398005, "body": "when using netstat -tulnp, the system is showing 0 0.0.0.0:1234, usually it should be 224.1.2.2:1234"}], "owner": {"reputation": 15, "user_id": 3688382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c89eea6accae4ab213e5d8ef087ce09?s=128&d=identicon&r=PG&f=1", "display_name": "aissa", "link": "https://stackoverflow.com/users/3688382/aissa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 850, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1471445959, "creation_date": 1471445959, "question_id": 39000125, "link": "https://stackoverflow.com/questions/39000125/golang-udp-multicast", "title": "Golang UDP Multicast", "body": "<p>Im doing some testing for receiving multicast UDP stream and save it to file using the below functions:</p>\n\n<pre><code>func Record2(udp string, filePath string) {\n    c1, err := net.ListenPacket(\"udp4\", udp)\n    if err != nil {\n        return\n    }\n    defer c1.Close()\n    p1 := ipv4.NewPacketConn(c1)\n    en0, err := net.InterfaceByName(\"enp3s0\")\n    addr, _ := net.ResolveUDPAddr(\"udp4\", udp)\n    if err := p1.JoinGroup(en0, addr); err != nil {\n\n    }\n    Bee.DelFile(filePath)\n    fo, err := os.Create(filePath)\n    defer fo.Close()\n    if err != nil {\n        panic(err)\n    }\n    io.Copy(fo, p1)\n\n}\nfunc Record(udp string, filePath string) {\n    addr, err := net.ResolveUDPAddr(\"udp4\", udp)\n\n    if err != nil {\n        return\n    }\n    Bee.DelFile(filePath)\n    fo, err := os.Create(filePath)\n    defer fo.Close()\n    if err != nil {\n        panic(err)\n    }\n    l, err := net.ListenMulticastUDP(\"udp4\", nil, addr)\n\n    defer l.Close()\n    l.SetReadBuffer(maxDatagramSize)\n    io.Copy(fo, l)\n\n}\n go Record2(\"224.1.2.2:1234\", \"file1\")\n go Record2(\"224.1.2.1:1234\", \"file2\")\n go Record(\"224.1.2.2:1234\", \"file3\")\n Record(\"224.1.2.1:1234\", \"file4\")\n</code></pre>\n\n<p>the problem is that udp stream have different content while all files saved got the same content of the first address</p>\n\n<p>this is not occuring when using UDP addresses with different ports</p>\n\n<p>im not sure if this is related to SO_REUSEADDR</p>\n\n<p>how to fix that?</p>\n"}, {"tags": ["mongodb", "date", "go"], "comments": [{"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471443333, "post_id": 38998938, "comment_id": 65349875, "body": "Are you asking how to create time.Time for 24 hours in the past and in UTC, possibly truncating the hours? Or are you asking how to parse a timestamp string? Or how to filter records that stores the timestamp as a string?"}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "reply_to_user": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471526652, "post_id": 38998938, "comment_id": 65389172, "body": "I know how to create a timeStamp, but the time.Time object either uses time.Local or time.UTC which this value is neither.  So, when I am trying to limit the mongodb result set it appears that there are no records.  If the dates were stored as UTC or Local then it would be an easy solution.  How do I make mongodb ignore the time stamp when doing the $gte or $lt call is what I am looking for."}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471527210, "post_id": 38998938, "comment_id": 65389580, "body": "&quot;Zulu Time Zone is often used in aviation and the military as another name for UTC +0&quot;. So effectively the dates you&#39;re seeing are UTC timestamp, the <code>Z</code> in the end indicates that this is what you have."}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "reply_to_user": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471527318, "post_id": 38998938, "comment_id": 65389670, "body": "Ok, then what I am doing able should work right?  Why would it return 0 records, when if I dump them all I can clearly see records that are greater than the prior date at midnight?"}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471527521, "post_id": 38998938, "comment_id": 65389817, "body": "maybe print your fromDate &amp; toDate strings as well as the record you&#39;re seeing when dumping all. And try to make some reproducible example of how to create the initial data in MongoDB to be used in a test"}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "reply_to_user": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471527609, "post_id": 38998938, "comment_id": 65389875, "body": "I&#39;ll see what I can do to recreate the data, but I didn&#39;t initially create it so that will take me a little bit."}, {"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "reply_to_user": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 1, "creation_date": 1471579647, "post_id": 38998938, "comment_id": 65412109, "body": "Thanks @baloo, I resolved the issue.  Looking back at the code I had already minimized the result set and thus excluded the records that fell into that date range.  I apologize for this post."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "edited": false, "score": 0, "creation_date": 1471526731, "post_id": 38999259, "comment_id": 65389229, "body": "Thanks for the answer but that isn&#39;t quite what I am looking for.  I&#39;m trying to figure out how to make mongo ignore the time stamp when running the date comparison query."}], "tags": [], "owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "is_accepted": false, "score": 0, "last_activity_date": 1471443548, "creation_date": 1471443548, "answer_id": 38999259, "question_id": 38998938, "link": "https://stackoverflow.com/questions/38998938/mongodb-golang-limit-results-by-date/38999259#38999259", "title": "mongodb golang limit results by date", "body": "<p>If I understand the question, you're looking how to create a UTC timestamp 24 hours into the past where hours have been truncated?</p>\n\n<p>You can try filtering on these dates:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    today := time.Now().Truncate(24*time.Hour).UTC()\n    yesterday := today.Add(-24*time.Hour)\n    fmt.Println(today)\n    fmt.Println(yesterday)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "is_accepted": false, "score": 0, "last_activity_date": 1471579721, "creation_date": 1471579721, "answer_id": 39030958, "question_id": 38998938, "link": "https://stackoverflow.com/questions/38998938/mongodb-golang-limit-results-by-date/39030958#39030958", "title": "mongodb golang limit results by date", "body": "<p>The code in the above post actually works for the \"Zulu\" date time stamp.  This is a non-issue.</p>\n"}], "owner": {"reputation": 23, "user_id": 4206238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9151bab4be840ada27d4978af501ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "CRob", "link": "https://stackoverflow.com/users/4206238/crob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471579721, "creation_date": 1471442674, "question_id": 38998938, "link": "https://stackoverflow.com/questions/38998938/mongodb-golang-limit-results-by-date", "title": "mongodb golang limit results by date", "body": "<p>I have a mongodb collection that I am trying to limit the result set, but the data was created by someone else and the date format appears to be stored as \"2016-05-12 00:00:00.000Z\".  I am unsure how to format my find query to limit this type of date.  I have been successful with other types of date formats, but not this one.  Has anyone else encountered this issue?</p>\n\n<pre><code>myCollection {\n  \"_id\" : {\n    \"$oid\" : bson.ObjectId\n  },\n  \"createdDate\" : {\n    \"$date\" : Date\n} \n</code></pre>\n\n<p>This is what I have attempted.</p>\n\n<pre><code>toDate := time.Date(time.Now().Year(), time.Now().Month(), time.Now().Day(), 0, 0, 0, 0, time.UTC)\nfromDate := toDate.AddDate(0, 0, -1)\n\ncollectionResult := collectionRecords.Find(bson.M{\"retailer\": result.Id, \"createdAt\": bson.M{\"$gte\": fromDate}})\n</code></pre>\n\n<p>Ultimately, I would like to limit to one day and was attempting to do the following:</p>\n\n<pre><code>collectionResult := collectionRecords.Find(bson.M{\"retailer\": result.Id, \"createdAt\": bson.M{\"$gte\": fromDate, \"$lt\": toDate}})\ncollectionResult.All(&amp;collectionData)\ncollectionCount, _ := collectionResult.Count()\nfmt.Println(\"Count: \", collectionCount)\n</code></pre>\n\n<p>it always returns 0.  Like I stated above I have been successful with UTC dates, but this one seems to trouble me.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "edited": false, "score": 1, "creation_date": 1471442893, "post_id": 38998866, "comment_id": 65349568, "body": "<a href=\"http://stackoverflow.com/questions/33418107/why-cant-i-do-fmt-sprintfd-d-d-d-a\" title=\"why cant i do fmt sprintfd d d d a\">stackoverflow.com/questions/33418107/&hellip;</a>"}, {"owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "edited": false, "score": 0, "creation_date": 1471442961, "post_id": 38998866, "comment_id": 65349618, "body": "I found the same question in stackoverflow: <a href=\"http://stackoverflow.com/questions/33418107/why-cant-i-do-fmt-sprintfd-d-d-d-a\" title=\"why cant i do fmt sprintfd d d d a\">stackoverflow.com/questions/33418107/&hellip;</a>   but If there are other ways to transfer directly"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1471443516, "post_id": 38998866, "comment_id": 65350045, "body": "See <a href=\"https://golang.org/src/net/ip.go#L260\" rel=\"nofollow noreferrer\">golang.org/src/net/ip.go#L260</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "is_accepted": false, "score": 4, "last_activity_date": 1471504010, "last_edit_date": 1471504010, "creation_date": 1471443853, "answer_id": 38999365, "question_id": 38998866, "link": "https://stackoverflow.com/questions/38998866/how-to-transform-4byte1-2-3-4-to-1-2-3-4-in-golang/38999365#38999365", "title": "How to transform [4]byte{1,2,3,4} to &quot;1.2.3.4&quot; in Golang?", "body": "<p>You don't need to define your own type as there is already <a href=\"https://golang.org/pkg/net/#IP\" rel=\"nofollow\">net.IP</a> which implements <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow\">fmt.Stringer</a>.</p>\n\n<p>Example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    ip := net.IP{127, 0, 0, 1}\n    fmt.Println(ip)\n}\n</code></pre>\n\n<p><code>net.IP</code> is a byte slice, so you can also do:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>b := []byte{127, 0, 0, 1}\nip := net.IP(b)\nfmt.Println(ip)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 2, "last_activity_date": 1471446181, "last_edit_date": 1471446181, "creation_date": 1471444895, "answer_id": 38999745, "question_id": 38998866, "link": "https://stackoverflow.com/questions/38998866/how-to-transform-4byte1-2-3-4-to-1-2-3-4-in-golang/38999745#38999745", "title": "How to transform [4]byte{1,2,3,4} to &quot;1.2.3.4&quot; in Golang?", "body": "<p>1- Use <code>net.IP</code>, like this working sample code: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"net\"\n\nfunc main() {\n    hosts := map[string]net.IP{\n        \"loopback \": {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for name, ip := range hosts {\n        fmt.Println(name, \":\", ip)\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>loopback  : 127.0.0.1\ngoogleDNS : 8.8.8.8\n</code></pre>\n\n<hr>\n\n<p>2- Use this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (ip IPAddr) String() string {\n    return strconv.Itoa(int(ip[0])) + \".\" +\n        strconv.Itoa(int(ip[1])) + \".\" +\n        strconv.Itoa(int(ip[2])) + \".\" +\n        strconv.Itoa(int(ip[3]))\n}\n</code></pre>\n\n<p>like this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"strconv\"\n\ntype IPAddr [4]byte\n\nfunc (ip IPAddr) String() string {\n    return strconv.Itoa(int(ip[0])) + \".\" +\n        strconv.Itoa(int(ip[1])) + \".\" +\n        strconv.Itoa(int(ip[2])) + \".\" +\n        strconv.Itoa(int(ip[3]))\n}\n\nfunc main() {\n    hosts := map[string]IPAddr{\n        \"loopback \": {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for name, ip := range hosts {\n        fmt.Println(name, \":\", ip)\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>loopback  : 127.0.0.1\ngoogleDNS : 8.8.8.8\n</code></pre>\n\n<hr>\n\n<p>3- Use <code>strings.Trim(strings.Join(strings.Fields(fmt.Sprint(ip)), \".\"), \"[]\")</code><br>\nlike this working sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\ntype IPAddr [4]byte\n\nfunc (ip IPAddr) String() string {\n    return strings.Trim(strings.Join(strings.Fields(fmt.Sprint([4]byte(ip))), \".\"), \"[]\")\n}\n\nfunc main() {\n    hosts := map[string]IPAddr{\n        \"loopback \": {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for name, ip := range hosts {\n        fmt.Println(name, \":\", ip)\n    }\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>loopback  : 127.0.0.1\ngoogleDNS : 8.8.8.8\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3593, "user_id": 613256, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/JuDL2.jpg?s=128&g=1", "display_name": "Stanislav Mekhonoshin", "link": "https://stackoverflow.com/users/613256/stanislav-mekhonoshin"}, "edited": false, "score": 0, "creation_date": 1536606043, "post_id": 52260301, "comment_id": 91475717, "body": "Please provide additional explanation to your code sample."}], "tags": [], "owner": {"reputation": 61, "user_id": 8810911, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JbQfe53jpBo/AAAAAAAAAAI/AAAAAAAAIFE/1WB0LqgogZQ/photo.jpg?sz=128", "display_name": "Isaac Muthui", "link": "https://stackoverflow.com/users/8810911/isaac-muthui"}, "is_accepted": false, "score": 0, "last_activity_date": 1536590572, "creation_date": 1536590572, "answer_id": 52260301, "question_id": 38998866, "link": "https://stackoverflow.com/questions/38998866/how-to-transform-4byte1-2-3-4-to-1-2-3-4-in-golang/52260301#52260301", "title": "How to transform [4]byte{1,2,3,4} to &quot;1.2.3.4&quot; in Golang?", "body": "<p>Here's how I did it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype IPAddr [4]byte\n\n\nfunc (ip IPAddr) String() string {\n    return fmt.Sprintf(\"%v.%v.%v.%v\", int(ip[0]), int(ip[1]), int(ip[3]), int(ip[3]))\n}\n\nfunc main() {\n    hosts := map[string]IPAddr{\n        \"loopback\":  {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for name, ip := range hosts {\n        fmt.Printf(\"%v: %v\\n\", name, ip)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1536600458, "last_edit_date": 1536600458, "creation_date": 1536594439, "answer_id": 52261387, "question_id": 38998866, "link": "https://stackoverflow.com/questions/38998866/how-to-transform-4byte1-2-3-4-to-1-2-3-4-in-golang/52261387#52261387", "title": "How to transform [4]byte{1,2,3,4} to &quot;1.2.3.4&quot; in Golang?", "body": "<p>Note that <a href=\"https://golang.org/pkg/net/#IP\" rel=\"nofollow noreferrer\"><code>net.IP</code> is a <code>[]byte</code></a> which <a href=\"https://golang.org/pkg/net/#IP.String\" rel=\"nofollow noreferrer\">implements <code>String() string</code></a> so you can simply do:</p>\n\n<pre><code>net.IP{127, 0, 0, 1}.String() // =&gt; \"127.0.0.1\"\n</code></pre>\n\n<p>This strategy is much faster than <code>fmt.Sprintf(...)</code> or <code>strings.Join(...)</code>:</p>\n\n<pre><code>// ip_string_test.go\n\nvar ip = net.IP{127, 0, 0, 1}\n\nfunc Benchmark_net_IP_String(b *testing.B) {\n  for i := 0; i &lt; b.N; i++ {\n    ip.String()\n  }\n}\n\nfunc Benchmark_fmt_Sprintf(b *testing.B) {\n  for i := 0; i &lt; b.N; i++ {\n    fmt.Sprintf(\"%d.%d.%d.%d\", ip[0], ip[1], ip[2], ip[3])\n  }\n}\n\nfunc Benchmark_strings_Join(b *testing.B) {\n  ss := make([]string, len(ip))\n  for i := 0; i &lt; b.N; i++ {\n    for i, x := range ip {\n      ss[i] = strconv.FormatInt(int64(x), 10)\n    }\n    strings.Join(ss, \".\")\n  }\n}\n</code></pre>\n\n<p><code>$ go test -bench=. ./ip_string_test.go</code></p>\n\n<pre><code>goos: darwin\ngoarch: amd64\nBenchmark_net_IP_String-8       50000000            30.8 ns/op\nBenchmark_fmt_Sprintf-8         10000000           194 ns/op\nBenchmark_strings_Join-8        20000000           113 ns/op\nPASS\nok      command-line-arguments  6.123s\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3383, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1536600458, "creation_date": 1471442492, "last_edit_date": 1471490035, "question_id": 38998866, "link": "https://stackoverflow.com/questions/38998866/how-to-transform-4byte1-2-3-4-to-1-2-3-4-in-golang", "title": "How to transform [4]byte{1,2,3,4} to &quot;1.2.3.4&quot; in Golang?", "body": "<p>Here is my code which was used to transfer a byte array to string\nbut it was failed:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n)\n\ntype IPAddr [4]byte\n\n// TODO: Add a \"String() string\" method to IPAddr.\n\nfunc (ip IPAddr) String() string {\n    s := [][]byte{ip[:]}\n    //fmt.Println(s)\n    sep := []byte(\".\")\n    return string(bytes.Join(s, sep))\n}\n\nfunc main() {\n    hosts := map[string]IPAddr{\n        \"loopback\":  {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for name, ip := range hosts {\n        fmt.Printf(\"%v: %v\\n\", name, ip)\n    }\n}\n</code></pre>\n\n<p>The program does not generate a expected output as</p>\n\n<pre><code>loopback: 127.0.0.1\ngoogleDNS: 8.8.8.8\n</code></pre>\n\n<p>How to transform [4]byte{1,2,3,4} to \"1.2.3.4\" in Golang?</p>\n"}, {"tags": ["database", "postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 2902, "user_id": 67276, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Dydxy.jpg?s=128&g=1", "display_name": "G. Ghez", "link": "https://stackoverflow.com/users/67276/g-ghez"}, "edited": false, "score": 2, "creation_date": 1568184431, "post_id": 38999354, "comment_id": 102189603, "body": "prerequisite is <code>psql</code> tool installed."}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": false, "score": 8, "last_activity_date": 1502691139, "last_edit_date": 1502691139, "creation_date": 1471443827, "answer_id": 38999354, "question_id": 38998267, "link": "https://stackoverflow.com/questions/38998267/how-to-execute-a-sql-file/38999354#38999354", "title": "How to execute a sql file", "body": "<p>You can use <code>os/exec</code> package of standard library. No database driver is required. Code would look something like this for postgreSQL:</p>\n\n<pre><code>cmd := exec.Command(\"psql\", \"-U\", psqlUser, \"-h\", psqlHost, \"-d\", psqlDBName, \"-a\", \"-f\", sqlFilePath)\n\nvar out, stderr bytes.Buffer\n\ncmd.Stdout = &amp;out\ncmd.Stderr = &amp;stderr\n\nerr := cmd.Run()\nif err != nil {\n    log.Fatalf(\"Error executing query. Command Output: %+v\\n: %+v, %v\", out.String(), stderr.String(), err)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 751, "user_id": 1073655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65f33ad1c6b545a3c9473b86b3b0f8cd?s=128&d=identicon&r=PG", "display_name": "weivall", "link": "https://stackoverflow.com/users/1073655/weivall"}, "edited": false, "score": 6, "creation_date": 1482158484, "post_id": 39007309, "comment_id": 69648643, "body": "It won&#39;t work if you have procedures in you sql file."}, {"owner": {"reputation": 404, "user_id": 6692196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vV1ew.png?s=128&g=1", "display_name": "Gene S", "link": "https://stackoverflow.com/users/6692196/gene-s"}, "edited": false, "score": 5, "creation_date": 1518753443, "post_id": 39007309, "comment_id": 84643455, "body": "<code>requests := strings.Split(string(file), &quot;;&quot;) </code> will break in case of SQL like this: <code>INSERT INTO testtable(test) VALUES(&#39;abc;def&#39;);</code>"}, {"owner": {"reputation": 2283, "user_id": 320911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/adCJz.jpg?s=128&g=1", "display_name": "Arto Bendiken", "link": "https://stackoverflow.com/users/320911/arto-bendiken"}, "reply_to_user": {"reputation": 404, "user_id": 6692196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vV1ew.png?s=128&g=1", "display_name": "Gene S", "link": "https://stackoverflow.com/users/6692196/gene-s"}, "edited": false, "score": 6, "creation_date": 1541686074, "post_id": 39007309, "comment_id": 93306696, "body": "Suggest using <code>strings.Split(string(file), &quot;;\\n&quot;)</code> to avoid the problem that @GeneS mentioned."}, {"owner": {"reputation": 67, "user_id": 5456910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/659c6cb2399710d7bf1744a5938940e7?s=128&d=identicon&r=PG&f=1", "display_name": "haj_baba", "link": "https://stackoverflow.com/users/5456910/haj-baba"}, "edited": false, "score": 0, "creation_date": 1601727903, "post_id": 39007309, "comment_id": 113499036, "body": "<code>&quot;;\\n&quot;</code> also works for <code>panic: Error 1065: Query was empty </code> error"}, {"owner": {"reputation": 360, "user_id": 4383917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gD22F.jpg?s=128&g=1", "display_name": "Antoine Catton", "link": "https://stackoverflow.com/users/4383917/antoine-catton"}, "edited": false, "score": 0, "creation_date": 1616592722, "post_id": 39007309, "comment_id": 118050400, "body": "This won&#39;t work if you have triggers with PLpgSQL, since it would need to parse the BEGIN and END, etc..."}], "tags": [], "owner": {"reputation": 348, "user_id": 6634768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2WCdT.png?s=128&g=1", "display_name": "Pavel Kazhevets", "link": "https://stackoverflow.com/users/6634768/pavel-kazhevets"}, "is_accepted": false, "score": 8, "last_activity_date": 1595529958, "last_edit_date": 1595529958, "creation_date": 1471473475, "answer_id": 39007309, "question_id": 38998267, "link": "https://stackoverflow.com/questions/38998267/how-to-execute-a-sql-file/39007309#39007309", "title": "How to execute a sql file", "body": "<p>You can just split file into separate requests and execute them one-by-one:</p>\n<pre><code>file, err := ioutil.ReadFile(&quot;/some/path/to/file&quot;)\n\nif err != nil {\n    // handle error\n}\n\nrequests := strings.Split(string(file), &quot;;&quot;)\n\nfor _, request := range requests {\n    result, err := db.Exec(request)\n    // do whatever you need with result and error\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 869, "user_id": 5752875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e07eba630b8aa0601d30171f57a667c?s=128&d=identicon&r=PG&f=1", "display_name": "carusyte", "link": "https://stackoverflow.com/users/5752875/carusyte"}, "is_accepted": false, "score": 9, "last_activity_date": 1490971182, "creation_date": 1490971182, "answer_id": 43143416, "question_id": 38998267, "link": "https://stackoverflow.com/questions/38998267/how-to-execute-a-sql-file/43143416#43143416", "title": "How to execute a sql file", "body": "<p>I found dotsql in search of similar demand. You can load named sql statements/prepare statements from a specific file and execute. </p>\n\n<pre><code>// Get a database handle\ndb, err := sql.Open(\"sqlite3\", \":memory:\")\n\n// Loads queries from file\ndot, err := dotsql.LoadFromFile(\"queries.sql\")\n\n// Run queries\nres, err := dot.Exec(db, \"create-users-table\")\nres, err := dot.Exec(db, \"create-user\", \"User Name\", \"main@example.com\")\nrows, err := dot.Query(db, \"find-users-by-email\", \"main@example.com\")\nrow, err := dot.QueryRow(db, \"find-one-user-by-email\", \"user@example.com\")\n\nstmt, err := dot.Prepare(db, \"drop-users-table\")\nresult, err := stmt.Exec()\n</code></pre>\n\n<p>see: <a href=\"https://github.com/gchaincl/dotsql\" rel=\"noreferrer\">https://github.com/gchaincl/dotsql</a></p>\n"}, {"tags": [], "owner": {"reputation": 3650, "user_id": 5387794, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7c76efa31a04b23c99d0b964a474491c?s=128&d=identicon&r=PG&f=1", "display_name": "kovac", "link": "https://stackoverflow.com/users/5387794/kovac"}, "is_accepted": false, "score": 11, "last_activity_date": 1617285430, "last_edit_date": 1617285430, "creation_date": 1551108044, "answer_id": 54869407, "question_id": 38998267, "link": "https://stackoverflow.com/questions/38998267/how-to-execute-a-sql-file/54869407#54869407", "title": "How to execute a sql file", "body": "<p>It's too much trouble if you are going to execute it using a command line. You have to deal with issues like setting your passwords, making sure the path variables are properly set, etc. I think the bets way is to use the database driver and just call it using Go.</p>\n<p>In the following example, I'm using <a href=\"https://godoc.org/github.com/jackc/pgx\" rel=\"nofollow noreferrer\">pgx implementation of sql driver</a> for Postgres. You can do it with any driver implementation of your choice.</p>\n<pre><code>path := filepath.Join(&quot;path&quot;, &quot;to&quot;, &quot;script.sql&quot;)\n\nc, ioErr := ioutil.ReadFile(path)\nif ioErr != nil {\n   // handle error.\n}\nsql := string(c)\n_, err := *pgx.Conn.Exec(sql)\nif err != nil {\n  // handle error.\n}\n</code></pre>\n<p>Explanation:</p>\n<ol>\n<li>Get the path to your sql script in a os agnostic way.</li>\n<li>Read the content of the file to string.</li>\n<li>Execute the statements in the file using the sql driver.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 7775, "user_id": 5658350, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3vhKa.png?s=128&g=1", "display_name": "DhiaTN", "link": "https://stackoverflow.com/users/5658350/dhiatn"}, "is_accepted": false, "score": 0, "last_activity_date": 1601051234, "last_edit_date": 1601051234, "creation_date": 1599516016, "answer_id": 63784753, "question_id": 38998267, "link": "https://stackoverflow.com/questions/38998267/how-to-execute-a-sql-file/63784753#63784753", "title": "How to execute a sql file", "body": "<h3>Here you have 2 options:</h3>\n<ol>\n<li><p>Using sql driver to connect to db and execute the sql statements:\nHere a full example using additionally transaction:</p>\n<pre><code>func loadSQLFile(db *sqlx.DB, sqlFile string) error {\n  file, err := ioutil.ReadFile(sqlFile)\n  if err != nil {\n      return err\n  }\n  tx, err := db.Begin()\n  if err != nil {\n      return err\n  }\n  defer func() {\n     tx.Rollback()\n  }()\n  for _, q := range strings.Split(string(file), &quot;;&quot;) {\n      q := strings.TrimSpace(q)\n      if q == &quot;&quot; {\n         continue\n      }\n     if _, err := tx.Exec(q); err != nil {\n         return err\n     }\n  }\n  return tx.Commit()\n}\n</code></pre>\n</li>\n</ol>\n<p>usage:</p>\n<pre><code>loadSQLFile(db, &quot;data/my_file.sql&quot;)\n</code></pre>\n<ol start=\"2\">\n<li><p>Second options by executing a bash command:</p>\n<pre><code>func loadSQLFile(db, user, host, sqlFile string) error {\n  cmd := exec.Command(&quot;psql&quot;, &quot;-U&quot;, user, &quot;-h&quot;, host, &quot;-d&quot;, db, &quot;-a&quot;, &quot;-q&quot;, &quot;-f&quot;, sqlFile)\n  cmd.Stdout = os.Stdout\n  cmd.Stderr = os.Stderr\n  return cmd.Run()\n}\n</code></pre>\n</li>\n</ol>\n<p>usage:</p>\n<pre><code>loadSQLFile(&quot;my_db&quot;, &quot;my_user&quot;, &quot;localhost&quot;, &quot;data/my_file.sql&quot;)\n</code></pre>\n<p>While second option looks easier and shorter I recommend the first option, it gives you more control on what you do and most importantly it's more portable.</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 12021551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDDATQMGGzQxcOZwLsMgFnwCR-5onfPZEP-rK7K=k-s128", "display_name": "Ezequiel Falcon", "link": "https://stackoverflow.com/users/12021551/ezequiel-falcon"}, "is_accepted": false, "score": 0, "last_activity_date": 1606674422, "creation_date": 1606674422, "answer_id": 65063631, "question_id": 38998267, "link": "https://stackoverflow.com/questions/38998267/how-to-execute-a-sql-file/65063631#65063631", "title": "How to execute a sql file", "body": "<p>This worked for me</p>\n<pre><code>func loadSqlFile(db *sqlx.DB) {\n    // Read file\n    file, err := ioutil.ReadFile(&quot;./test/mock.sql&quot;)\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n\n    // Execute all\n    _, err = db.Exec(string(file))\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17023, "favorite_count": 1, "answer_count": 6, "score": 15, "last_activity_date": 1617285430, "creation_date": 1471441078, "last_edit_date": 1617285383, "question_id": 38998267, "link": "https://stackoverflow.com/questions/38998267/how-to-execute-a-sql-file", "title": "How to execute a sql file", "body": "<p>I have .sql file which has lots of database creation, deletion, population stuff. Is it possible to have a go function which can excute a sql file. I am using postgres as my database and using lib/pq driver for all database transactions. But I am open to any library for executing this sql file in my Go project.</p>\n"}, {"tags": ["docker", "go", "jenkins", "jenkins-pipeline", "jwt-go"], "answers": [{"tags": [], "owner": {"reputation": 2509, "user_id": 1225993, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3166c937f1b99e4518fdeccb22d1e5bc?s=128&d=identicon&r=PG", "display_name": "Nicholas Albion", "link": "https://stackoverflow.com/users/1225993/nicholas-albion"}, "is_accepted": true, "score": 2, "last_activity_date": 1471437354, "creation_date": 1471437354, "answer_id": 38996841, "question_id": 38995933, "link": "https://stackoverflow.com/questions/38995933/building-go-app-with-vendor-directory-on-jenkins-with-docker/38996841#38996841", "title": "Building Go app with &quot;vendor&quot; directory on Jenkins with Docker", "body": "<p>I managed to get it working by including the <code>cd</code> in the same <code>sh</code> statement:</p>\n\n<pre>\ndocker.image('nalbion/go-web-build:latest')\n      .inside(\"-v ${env.WORKSPACE}:/workspace/src/bitbucket.org/nalbion/go-demo \" +\n              \"-e GOPATH=/usr/lib/go_appengine/gopath:/workspace\") {\n   sh \"\"\"\n       cd /workspace/src/bitbucket.org/nalbion/go-demo\n       go vet ./src/...\n       goapp test ./...\n      \"\"\"\n}\n</pre>\n"}], "owner": {"reputation": 2509, "user_id": 1225993, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3166c937f1b99e4518fdeccb22d1e5bc?s=128&d=identicon&r=PG", "display_name": "Nicholas Albion", "link": "https://stackoverflow.com/users/1225993/nicholas-albion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1719, "favorite_count": 2, "accepted_answer_id": 38996841, "answer_count": 1, "score": 3, "last_activity_date": 1588099196, "creation_date": 1471434876, "last_edit_date": 1588099196, "question_id": 38995933, "link": "https://stackoverflow.com/questions/38995933/building-go-app-with-vendor-directory-on-jenkins-with-docker", "title": "Building Go app with &quot;vendor&quot; directory on Jenkins with Docker", "body": "<p>I'm trying to set up a Jenkins Pipeline to build and deploy my first Go project using a <code>Jenkinsfile</code> and <code>docker.image().inside </code>.  I can't figure out how to get go to pick up the dependencies in the <code>vendor/</code> directory.</p>\n\n<p>When I run the build, I get a bunch of errors:</p>\n\n<pre>\n+ goapp test ./...\nsrc/dao/demo_dao.go:8:2: cannot find package \"github.com/dgrijalva/jwt-go\" in any of:\n    /usr/lib/go_appengine/goroot/src/github.com/dgrijalva/jwt-go (from $GOROOT)\n    /usr/lib/go_appengine/gopath/src/github.com/dgrijalva/jwt-go (from $GOPATH)\n    /workspace/src/github.com/dgrijalva/jwt-go\n</pre>\n\n<p><strong>...why isn't it picking up the Vendor directory?</strong></p>\n\n<p>When I throw in some logging, it seems that after running <code>sh \"cd /workspace/src/bitbucket.org/nalbion/go-demo\"</code> the next <code>sh</code> command is still in the original <code>${WORKSPACE}</code> directory.  I really like the idea of the Jenkins file, but I can't find any decent documentation for it.</p>\n\n<p>(Edit - there is decent documentation <a href=\"https://dzone.com/refcardz/continuous-delivery-with-jenkins-workflow\" rel=\"nofollow\">here</a> but <code>dir(\"/workspace/src/bitbucket.org/nalbion/go-demo\") {}</code> doesn't seem to work within <code>docker.image().inside)</code></p>\n\n<p>My Docker file resembles:</p>\n\n<pre>\nFROM golang:1.6.2\n# Google's App Engine Go SDK\nRUN wget https://storage.googleapis.com/appengine-sdks/featured/go_appengine_sdk_linux_amd64-1.9.40.zip -q -O go_appengine_sdk.zip && \\\n    unzip -q go_appengine_sdk.zip -d /usr/lib/ && \\\n    rm go_appengine_sdk.zip\nENV PATH /usr/lib/go_appengine:/go/bin:/usr/local/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nENV GOPATH /usr/lib/go_appengine/gopath\n# Add Jenkins user\nRUN groupadd -g 132 jenkins && useradd -d \"/var/jenkins_home\" -u 122 -g 132 -m -s /bin/bash jenkins\n</pre>\n\n<p>And my Jenkinsfile:</p>\n\n<pre>\nnode('docker') {\n    currentBuild.result = \"SUCCESS\"\n\n    try {\n        stage 'Checkout'\n        checkout scm\n\n        stage 'Build and Test'\n        env.WORKSPACE = pwd()\n        docker.image('nalbion/go-web-build:latest').inside(\n                \"-v ${env.WORKSPACE}:/workspace/src/bitbucket.org/nalbion/go-demo \" +\n                \"-e GOPATH=/usr/lib/go_appengine/gopath:/workspace\") {\n\n            // Debugging\n            sh 'echo GOPATH: $GOPATH'\n            sh \"ls -al /workspace/src/bitbucket.org/nalbion/go-demo\"\n            sh \"cd /workspace/src/bitbucket.org/nalbion/go-demo\"\n            sh \"pwd\"\n\n            sh \"go vet ./src/...\"\n            sh \"goapp test ./...\"\n        }\n\n        stage 'Deploy to DEV'\n        docker.image('nalbion/go-web-build').inside {\n            sh \"goapp deploy --application go-demo --version v${v} app.yaml\"\n        }\n\n        timeout(time:5, unit:'DAYS') {\n            input message:'Approve deployment?', submitter: 'qa'\n        }\n\n        stage 'Deploy to PROD'\n        docker.image('nalbion/go-web-build').inside {\n            sh \"goapp deploy --application go-demo --version v${v} app.yaml\"\n        }\n    } catch (err) {\n        currentBuild.result = \"FAILURE\"\n        // send notifications\n        throw err\n    }\n}\n</pre>\n"}, {"tags": ["wordpress", "go"], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "edited": false, "score": 0, "creation_date": 1471521972, "post_id": 38995298, "comment_id": 65385862, "body": "but for cross domain requests I have to write proxy or is there any other way?"}, {"owner": {"reputation": 73, "user_id": 1842123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cfc5e389737a86142280da8fccfc4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Waa", "link": "https://stackoverflow.com/users/1842123/rob-waa"}, "edited": false, "score": 0, "creation_date": 1524062087, "post_id": 38995298, "comment_id": 86820296, "body": "I&#39;m just adding to the answer by @Mayank Patel. Here is a good tutorial on <a href=\"https://codeable.io/how-to-import-json-into-wordpress/\" rel=\"nofollow noreferrer\">How to import JSON into WordPress</a> with the <a href=\"https://codex.wordpress.org/Plugin_API/Action_Reference/wp_ajax_(action)\" rel=\"nofollow noreferrer\">wp_ajax</a> hook/action. I realise that you already resolved your dilemma by now. ;)"}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": false, "score": 5, "last_activity_date": 1471438226, "last_edit_date": 1471438226, "creation_date": 1471433044, "answer_id": 38995298, "question_id": 38994898, "link": "https://stackoverflow.com/questions/38994898/integrate-wordpress-with-golang/38995298#38995298", "title": "Integrate Wordpress with golang", "body": "<p>If your API is has a response that is understandable by third party then you can use any front-end technology with Go. </p>\n\n<p>For example if your APIs are having response in JSON format, any front-end technology can use it, as long as it can understand JSON data.</p>\n\n<p><strong>In short</strong> you can use any back-end and front-end combination as long as they can understand each other.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1623, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1471438226, "creation_date": 1471432008, "question_id": 38994898, "link": "https://stackoverflow.com/questions/38994898/integrate-wordpress-with-golang", "title": "Integrate Wordpress with golang", "body": "<p>I am developing a project in which the front-end part is done in wordpress and backend apis are in GO. I want to know whether they can be integrated.</p>\n"}, {"tags": ["go", "sqlx"], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2156718, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93c82b05997424df0edd2deb69b676e2?s=128&d=identicon&r=PG", "display_name": "Ankur Garg", "link": "https://stackoverflow.com/users/2156718/ankur-garg"}, "edited": false, "score": 0, "creation_date": 1471432883, "post_id": 38994780, "comment_id": 65342107, "body": "Select * is a dangerous ploy to play with (In case you add or remove columns) . It may be ok with goLang but with generic use in ORM world (select *) should be avoided ."}], "tags": [], "owner": {"reputation": 141, "user_id": 1672533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba5c12e1020f644630a80813a049071?s=128&d=identicon&r=PG", "display_name": "yanzay", "link": "https://stackoverflow.com/users/1672533/yanzay"}, "is_accepted": false, "score": 0, "last_activity_date": 1471431678, "creation_date": 1471431678, "answer_id": 38994780, "question_id": 38994419, "link": "https://stackoverflow.com/questions/38994419/jmoiron-sqlx-golang-common-interface/38994780#38994780", "title": "Jmoiron SQLX Golang common interface", "body": "<p>Usually your struct should represent all fields of SQL table, not only fields that you are fetching in <code>SELECT</code>, so you can just do <code>SELECT * FROM...</code> and deserialize response from db to your struct <code>Resp3</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1963, "user_id": 2156718, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93c82b05997424df0edd2deb69b676e2?s=128&d=identicon&r=PG", "display_name": "Ankur Garg", "link": "https://stackoverflow.com/users/2156718/ankur-garg"}, "is_accepted": true, "score": 1, "last_activity_date": 1471965181, "last_edit_date": 1495540465, "creation_date": 1471965181, "answer_id": 39104921, "question_id": 38994419, "link": "https://stackoverflow.com/questions/38994419/jmoiron-sqlx-golang-common-interface/39104921#39104921", "title": "Jmoiron SQLX Golang common interface", "body": "<p>I could not get answer to this here and since I needed this , I dug up myself and I found how to solve this in an efficient way .</p>\n\n<p>To solve this one can define all your String values as sql.NullString , integer as sql.int64 , float as sql.float64 etc .</p>\n\n<p>So Say your table is having columns a,b,c,d,e,f and for some response you only have to display a,b,d for some other d,e and so on . Instead of creating different structures and mapping them in db.Select(...) statement Just define ur struct as follows </p>\n\n<pre><code>a       sql.NullString `json:\"whatever u wish to have as key,omitempty\"`\nb       sql.NullString `json:\"b,omitempty\"`\nc       sql.NullString `json:\"c,omitempty\"`\nd       sql.int64  `json:\"d,omitempty\"`\ne       sql.float64  `json:\"e,omitempty\"`\n</code></pre>\n\n<p>Remember sql.NullString will be Marshalled  to json with an additional key displayed (Valid:boolean) . You can follow approach here to fix that  <a href=\"https://stackoverflow.com/questions/33072172/how-can-i-work-with-sql-null-values-and-json-in-golang-in-a-good-way\">How can I work with sql NULL values and JSON in Golang in a good way?</a></p>\n\n<p>Hope this is helpful to someone.!!</p>\n"}], "owner": {"reputation": 1963, "user_id": 2156718, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93c82b05997424df0edd2deb69b676e2?s=128&d=identicon&r=PG", "display_name": "Ankur Garg", "link": "https://stackoverflow.com/users/2156718/ankur-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 39104921, "answer_count": 2, "score": 1, "last_activity_date": 1471965181, "creation_date": 1471430620, "question_id": 38994419, "link": "https://stackoverflow.com/questions/38994419/jmoiron-sqlx-golang-common-interface", "title": "Jmoiron SQLX Golang common interface", "body": "<p>I am new to golang and using Jmoiron Sqlx package for querying the Postgres Database(select query) . The waY I am doing is creating a sql string and calling Select(dest interface{}, query string,args) method. While it works well , the problem is I am generating my sql String dynamically and as such the destination structure should be different for each response .</p>\n\n<p>For ex : - One query can be </p>\n\n<pre><code>Select a,b,c,d from table A ;\n</code></pre>\n\n<p>the other can be </p>\n\n<pre><code>Select x,y,z from Table B;\n</code></pre>\n\n<p>From what i understand , there should be two different structs defined for Select Method to work i.e.</p>\n\n<pre><code>Struct Resp1{\n   a string\n   b string\n   c  string\n   d string\n}\n</code></pre>\n\n<p>And,</p>\n\n<pre><code>Struct Resp2{\n   x string\n   y string\n   z  string\n\n}\n</code></pre>\n\n<p>And then invoke select as <code>db.Select(&amp;resp1,query,args)</code> and <code>db.Select(&amp;resp2,query,args)</code>\nI am thinking if its possible for me to define a common Struct </p>\n\n<pre><code>say Resp3{\n   a string\n   b string\n   c  string\n   d string\n   x string\n   y string\n   z  string\n}\n</code></pre>\n\n<p>And based on my select query populates only the matching columns (i.e only a,b,c,d for first and x,y,z for second) .</p>\n\n<p>I tried searching but couldnt get any leads .</p>\n"}, {"tags": ["go", "oauth", "khan-academy"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 1239277, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ec5f6733493ef9e88f3dbc7b37da672c?s=128&d=identicon&r=PG", "display_name": "Shokry", "link": "https://stackoverflow.com/users/1239277/shokry"}, "is_accepted": false, "score": 0, "last_activity_date": 1471798201, "creation_date": 1471798201, "answer_id": 39066581, "question_id": 38990552, "link": "https://stackoverflow.com/questions/38990552/khan-academy-redirecting-default-url-go-lang/39066581#39066581", "title": "khan academy redirecting default URL GO lang", "body": "<p>I've faced a similar situation, fixed by providing the callback as a URL query.</p>\n\n<pre><code>https://www.khanacademy.org/api/auth2/request_token?oauth_callback=yourcallbackurl\n</code></pre>\n"}], "owner": {"reputation": 306, "user_id": 4144399, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100003597293998/picture?type=large", "display_name": "Ali", "link": "https://stackoverflow.com/users/4144399/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1471798201, "creation_date": 1471418871, "question_id": 38990552, "link": "https://stackoverflow.com/questions/38990552/khan-academy-redirecting-default-url-go-lang", "title": "khan academy redirecting default URL GO lang", "body": "<p>I want to access khan academy services, which requires authenticate such as OAuth consumer. Authentication working fine I have used following <a href=\"https://github.com/mrjones/oauth\" rel=\"nofollow\">oauth library</a>.</p>\n\n<p><strong>Steps</strong></p>\n\n<ul>\n<li><p>Get request token</p></li>\n<li><p>Now I have a request_token. I need to have it approved by the user.</p></li>\n</ul>\n\n<blockquote>\n  <p><a href=\"https://www.khanacademy.org/api/auth2/authorize?oauth_token=t6492705587593216\" rel=\"nofollow\">https://www.khanacademy.org/api/auth2/authorize?oauth_token=t6492705587593216</a></p>\n</blockquote>\n\n<p><a href=\"https://github.com/Khan/khan-api/wiki/Khan-Academy-API-Authentication\" rel=\"nofollow\">Khan academy documentation says</a></p>\n\n<p>When the user clicks the \"Accept\" button, they will be redirected to callback url specified by <code>oauth_callback</code> (or <code>/api/auth/default_callback</code> if a custom callback url is not provided) </p>\n\n<pre><code>https://www.khanacademy.org/api/auth/default_callback?oauth_token_secret=NmZ5nFEttE8gwnnz&amp;oauth_verifier=gyM9xcZVtg&amp;oauth_token=t6492705587593216\n</code></pre>\n\n<p>Here is my GO Code</p>\n\n<pre><code>const (\n    CONSUMER_KEY  = \"XXXXX\"\n    CONSUMER_SECRET = \"XXXXXXXX\"\n)\n\nfunc GetRequestToken(r *http.Request,unitAttemptID int64)(string,error){\n    c := oauth.NewConsumer(\n        CONSUMER_KEY,\n        CONSUMER_SECRET,\n        oauth.ServiceProvider{\n            RequestTokenUrl:   \"https://www.khanacademy.org/api/auth2/request_token\",\n            AuthorizeTokenUrl: \"https://www.khanacademy.org/api/auth2/authorize\",\n            AccessTokenUrl:    \"https://www.khanacademy.org/api/auth2/access_token\",\n            ExerciseUrl:      \"https://www.khanacademy.org/api/v1/user/exercises\",\n        })\n    callback := \"http://127.0.0.1/example/index.php/khan/authorizeRequestToken\"\n    requestToken, u, err := c.GetRequestTokenAndUrl(callback)\n    if err != nil {\n        fmt.Println(\"err is  - \",err)\n        return \"\",err\n    }\n    fmt.Println(\"requestToken \",requestToken)\n    return u,nil\n }\n</code></pre>\n\n<p><strong>Problem</strong></p>\n\n<p>It always redirect me on custom default URL. I want to redirect my own callback url.</p>\n"}, {"tags": ["algorithm", "go", "heatmap"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1471421353, "post_id": 38989572, "comment_id": 65334493, "body": "use the weights for a weighted average, and put move the point slightly. e.g. if point A has 0.9 and point B 0.1, the new point should around 0.1 of the line connecting A and B, near A."}, {"owner": {"reputation": 38400, "user_id": 12166, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ae44dc366eacfc7e7eede0ae0ac065c?s=128&d=identicon&r=PG", "display_name": "Rafa\u0142 Dowgird", "link": "https://stackoverflow.com/users/12166/rafa%c5%82-dowgird"}, "edited": false, "score": 2, "creation_date": 1471422539, "post_id": 38989572, "comment_id": 65335189, "body": "Two important questions: 1. What should the heatmap represent, i.e. what is the definition of the perfect, non-lossy result? Once you define that, question 2. is: what kind of deviations from 1. can you accept?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "reply_to_user": {"reputation": 38400, "user_id": 12166, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ae44dc366eacfc7e7eede0ae0ac065c?s=128&d=identicon&r=PG", "display_name": "Rafa\u0142 Dowgird", "link": "https://stackoverflow.com/users/12166/rafa%c5%82-dowgird"}, "edited": false, "score": 0, "creation_date": 1471426090, "post_id": 38989572, "comment_id": 65337455, "body": "@Rafa\u0142Dowgird The heatmap represents the movement of a vehicle."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1471426335, "post_id": 38989572, "comment_id": 65337600, "body": "@Not_a_Golfer is it possible for you to provide an example?"}, {"owner": {"reputation": 38400, "user_id": 12166, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ae44dc366eacfc7e7eede0ae0ac065c?s=128&d=identicon&r=PG", "display_name": "Rafa\u0142 Dowgird", "link": "https://stackoverflow.com/users/12166/rafa%c5%82-dowgird"}, "edited": false, "score": 0, "creation_date": 1471433169, "post_id": 38989572, "comment_id": 65342311, "body": "So, you need to represent the roads/paths/shortcuts from a huge number of car coordinate snapshots, is that more or less correct?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "reply_to_user": {"reputation": 38400, "user_id": 12166, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ae44dc366eacfc7e7eede0ae0ac065c?s=128&d=identicon&r=PG", "display_name": "Rafa\u0142 Dowgird", "link": "https://stackoverflow.com/users/12166/rafa%c5%82-dowgird"}, "edited": false, "score": 0, "creation_date": 1471434745, "post_id": 38989572, "comment_id": 65343328, "body": "@Rafa\u0142Dowgird I need to build a Heat Map of the places the car visit with the geo codes. So shortcuts and roads are not important. Just want to get rough idea on which parts of the city this car travelled. By aggregating geocodes with in short distance ,lets say 100m, we could know which ever parts of the city car visited most."}, {"owner": {"reputation": 2580, "user_id": 1233197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cue35.jpg?s=128&g=1", "display_name": "Mike B", "link": "https://stackoverflow.com/users/1233197/mike-b"}, "edited": false, "score": 1, "creation_date": 1471441640, "post_id": 38989572, "comment_id": 65348591, "body": "I&#39;ve done that by dividing the map in sections (large squares), when new route is added, calculate which blocks it goes through and add 1 to each block. Algorithm for finding squares can be very heavy if done sloppy though."}, {"owner": {"reputation": 217, "user_id": 2381111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7862740d4344e2320296afedac6b876?s=128&d=identicon&r=PG", "display_name": "vporoshok", "link": "https://stackoverflow.com/users/2381111/vporoshok"}, "edited": false, "score": 0, "creation_date": 1495980984, "post_id": 38989572, "comment_id": 75466538, "body": "what data base you are using? Postgres and Mongo have geo-indexes <a href=\"https://docs.mongodb.com/manual/applications/geospatial-indexes/\" rel=\"nofollow noreferrer\">docs.mongodb.com/manual/applications/geospatial-indexes</a> and <a href=\"http://revenant.ca/www/postgis/workshop/indexing.html\" rel=\"nofollow noreferrer\">revenant.ca/www/postgis/workshop/indexing.html</a>. Also you might be clustering data"}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1514647547, "creation_date": 1514647547, "answer_id": 48035253, "question_id": 38989572, "link": "https://stackoverflow.com/questions/38989572/how-to-aggregate-a-data-set-of-geocodes-to-reduce-there-numbers-for-a-heat-map/48035253#48035253", "title": "How to aggregate a data set of geocodes to reduce there numbers for a heat map?", "body": "<p>As mentioned by a commenter, consider using a weighted average of points, for example.</p>\n\n<p>Pick some proximity threshold within which any points will be aggregated. For each of these points, generate a synthetic point whose coordinates are the average (median) of the others and whose weight is the count of the points in question. Include only the synthetic weighted points when generating your heatmap so that you can reduce the amount of data by adjusting your proximity threshold.</p>\n\n<p>For example:</p>\n\n<pre><code>type Point struct{ X, Y float32 }\n\ntype WeightedPoint struct{ Weight, X, Y float32 }\n\nfunc GetWeightedPoint(ps []Point) WeightedPoint {\n    n := float32(len(ps))\n    wp := WeightedPoint{Weight: n}\n    if n &gt; 0 {\n        for _, p := range ps {\n            wp.X += p.X\n            wp.Y += p.Y\n        }\n        wp.X /= n\n        wp.Y /= n\n    }\n    return wp\n}\n\nfunc main() {\n    ps := []Point{{0.0, 0.0}, {1.0, 0.0}, {0.5, 1.0}}\n    fmt.Printf(\"OK: %#v\\n\", GetWeightedPoint(ps))\n    // OK: main.WeightedPoint{Weight:3, X:0.5, Y:0.33333334}\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6681013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1514647547, "creation_date": 1471415569, "question_id": 38989572, "link": "https://stackoverflow.com/questions/38989572/how-to-aggregate-a-data-set-of-geocodes-to-reduce-there-numbers-for-a-heat-map", "title": "How to aggregate a data set of geocodes to reduce there numbers for a heat map?", "body": "<p>I have a data set of Latitudes and Longitudes for populating a heat map. The data is too large and will keep on increasing day by day. I need to reduce the amount of data without much affecting the performance of the heat map. I understand we could add one more field for \"weight\" and combine two near-by points to form a new point with the \"weight\" as sum of the first two. But I am confused about where to plant the new point. I don't think this will be a standard way for solving my problem. I am using golang for the implementation, but all ideas are welcome. Thank you.</p>\n"}, {"tags": ["go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 3173409, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d6e363f7845b9b2ab6efbf756c53749d?s=128&d=identicon&r=PG&f=1", "display_name": "Rudys", "link": "https://stackoverflow.com/users/3173409/rudys"}, "is_accepted": false, "score": 0, "last_activity_date": 1472111288, "last_edit_date": 1472111288, "creation_date": 1472110782, "answer_id": 39139367, "question_id": 38988686, "link": "https://stackoverflow.com/questions/38988686/revel-framework-go-lang-not-able-to-find-controller/39139367#39139367", "title": "Revel Framework - Go Lang - Not able to find controller", "body": "<p>Configure the route for APP2.show like this <code>GET   /new/v2/show</code></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4251843, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jE4eSalhg4Y/AAAAAAAAAAI/AAAAAAAAAhs/VYlJqiEKcdI/photo.jpg?sz=128", "display_name": "Kushal Bhandari", "link": "https://stackoverflow.com/users/4251843/kushal-bhandari"}, "is_accepted": false, "score": 0, "last_activity_date": 1478038428, "creation_date": 1478038428, "answer_id": 40369474, "question_id": 38988686, "link": "https://stackoverflow.com/questions/38988686/revel-framework-go-lang-not-able-to-find-controller/40369474#40369474", "title": "Revel Framework - Go Lang - Not able to find controller", "body": "<p>Add the below at the top of <code>app2.go</code></p>\n\n<pre><code>package controllers\n</code></pre>\n\n<p>I tried the same using a similar example and it worked for me. I would suggest not to use full capitalized controller names; use <code>App2</code> instead of <code>APP2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 2752051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d5cc7da92da1b46c3eb0fafc183fdc5?s=128&d=identicon&r=PG&f=1", "display_name": "batwalrus76", "link": "https://stackoverflow.com/users/2752051/batwalrus76"}, "is_accepted": false, "score": 0, "last_activity_date": 1540843620, "creation_date": 1540843620, "answer_id": 53053059, "question_id": 38988686, "link": "https://stackoverflow.com/questions/38988686/revel-framework-go-lang-not-able-to-find-controller/53053059#53053059", "title": "Revel Framework - Go Lang - Not able to find controller", "body": "<p>I was a little confused to find out that the methods referenced from the router need to be Pascal Cased to be recognized (e.g. like above <code>func (c APP2) DescribeService() revel.Result</code>).  This might be obvious to seasoned Revel or Go developers but really wasn't obvious to me.</p>\n"}], "owner": {"reputation": 835, "user_id": 4008473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/bab2d01a5c2ce91bed8964aabf65527c?s=128&d=identicon&r=PG&f=1", "display_name": "user27111987", "link": "https://stackoverflow.com/users/4008473/user27111987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 531, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1540843620, "creation_date": 1471411555, "last_edit_date": 1471411981, "question_id": 38988686, "link": "https://stackoverflow.com/questions/38988686/revel-framework-go-lang-not-able-to-find-controller", "title": "Revel Framework - Go Lang - Not able to find controller", "body": "<p>I am using Revel framework for golang. I have a subdirectory in my controllers folder like below</p>\n\n<pre><code>controllers\n   new\n     app2.go\n   app1.go\n</code></pre>\n\n<p>Contents of app1.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/revel/revel\"\n)\n\ntype APP1 struct {\n    *revel.Controller\n}\nfunc (c APP1) Show() revel.Result {\n}\n</code></pre>\n\n<p>Contents of app2.go</p>\n\n<pre><code>import (\n    \"github.com/revel/revel\"\n)\n\ntype APP2 struct {\n    *revel.Controller\n}\nfunc (c APP2) Show() revel.Result {\n}\n</code></pre>\n\n<p>My routes file is like this</p>\n\n<pre><code>GET     /v1/show              APP1.show\nGET     /v2/show              APP2.show\n</code></pre>\n\n<p>When I call /v2/show it gives me error failed to find controller APP2 while v1/show is working absolutely working fine. Can anybody tell me how to fix it.</p>\n"}, {"tags": ["go", "proxy", "reverse", "nat", "forwarding"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6421586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6HBr.png?s=128&g=1", "display_name": "Johnny BeGood", "link": "https://stackoverflow.com/users/6421586/johnny-begood"}, "edited": false, "score": 0, "creation_date": 1471410420, "post_id": 38988319, "comment_id": 65329231, "body": "Actually i want to use the SOCKS5 protocol and somehow just forward the raw requests/traffic to the client proxy through the public server. So only the client worries about the socks protocol. \tNevertheless it&#39;s an interesting link. But still i don&#39;t understand how this would work with multiple users of that exposed client proxy."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1471409725, "last_edit_date": 1471409725, "creation_date": 1471409420, "answer_id": 38988319, "question_id": 38988195, "link": "https://stackoverflow.com/questions/38988195/use-a-client-behind-nat-as-proxy-through-public-server/38988319#38988319", "title": "Use a client behind NAT as proxy through public server", "body": "<p>You may use <code>httputil.ReverseProxy</code> to redirect User to local servers:<br>\nAlso see: <a href=\"http://blog.charmes.net/2015/07/reverse-proxy-in-go.html\" rel=\"nofollow\">http://blog.charmes.net/2015/07/reverse-proxy-in-go.html</a></p>\n\n<p>Test sample code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"net/http\"\n    \"net/http/httputil\"\n    \"net/url\"\n)\n\nfunc handler(handler http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        r.Host = r.URL.Host\n        handler.ServeHTTP(w, r)\n    })\n}\n\nfunc main() {\n    u, _ := url.Parse(\"https://translate.google.com\")\n    reverseProxy := httputil.NewSingleHostReverseProxy(u)\n    http.ListenAndServe(\":3000\", handler(reverseProxy))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 6421586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6HBr.png?s=128&g=1", "display_name": "Johnny BeGood", "link": "https://stackoverflow.com/users/6421586/johnny-begood"}, "edited": false, "score": 0, "creation_date": 1471424270, "post_id": 38991922, "comment_id": 65336272, "body": "Okay I think I understood, but how should the pairing be done? Could you pleas give me a little example?"}], "tags": [], "owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "is_accepted": false, "score": 0, "last_activity_date": 1471424703, "last_edit_date": 1471424703, "creation_date": 1471423438, "answer_id": 38991922, "question_id": 38988195, "link": "https://stackoverflow.com/questions/38988195/use-a-client-behind-nat-as-proxy-through-public-server/38991922#38991922", "title": "Use a client behind NAT as proxy through public server", "body": "<p>The connections has to be paired as to make two \"clients\" talk to each other, where one of them acts as the SOCKS5 server and one as the SOCKS5 client. You accept TCP connections on the public server from both the \"server behind NAT\" and the \"client that connects to server behind NAT\".</p>\n\n<p>Once both connections are up, you could use <a href=\"https://golang.org/pkg/io/#Copy\" rel=\"nofollow\">io.Copy</a> to proxy the inputs and outputs between the two connections.</p>\n\n<p>You will have to keep a pool of connections around, so that there will be one SOCKS5 server connection available to any new SOCKS5 client connection request.</p>\n\n<p>The server behind NAT will have to dial a new connection to the public server and then serve SOCKS5 requests on that connection <a href=\"https://github.com/balboah/gosocks\" rel=\"nofollow\">using a generic SOCKS5 server that accepts io.ReadWriteCloser</a>.</p>\n\n<p>A simplified and untested example:</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"log\"\n    \"net\"\n)\n\nfunc main() {\n    lnServer, err := net.Listen(\"tcp\", \"1234\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n    lnClients, err := net.Listen(\"tcp\", \"1235\")\n    if err != nil {\n        log.Fatalln(err)\n    }   \n\n    serverCh := make(chan net.Conn)\n    go func() {\n        for {\n            conn, err := lnServer.Accept()\n            if err != nil {\n                // handle errors\n            }\n            serverCh &lt;- conn\n        }\n    }()\n    for {\n        conn, err := ln.Accept()\n        if err != nil {\n            // handle errors\n        }\n        sc &lt;- serverCh\n        go io.Copy(sc, conn)\n        io.Copy(conn, sc)\n    }\n}\n</code></pre>\n\n<p>An easier approach to avoid creating your own connection pooling and pairing might be to create a VPN between the two servers. Where the public server forwards all connections towards the NAT'ed client. Which will be able to accept connections on a virtual IP that is assigned through VPN. One popular solution for doing this setup is <a href=\"https://openvpn.net/\" rel=\"nofollow\">OpenVPN</a>.</p>\n"}], "owner": {"reputation": 29, "user_id": 6421586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6HBr.png?s=128&g=1", "display_name": "Johnny BeGood", "link": "https://stackoverflow.com/users/6421586/johnny-begood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1112, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1617030033, "creation_date": 1471408651, "last_edit_date": 1471464939, "question_id": 38988195, "link": "https://stackoverflow.com/questions/38988195/use-a-client-behind-nat-as-proxy-through-public-server", "title": "Use a client behind NAT as proxy through public server", "body": "<p>I have a few problems to understand the theory of exposing clients behind NATs via a public server, for example to use the client as a proxy (preferably SOCKS5).\nI want to solve this problem using Go and there are some awesome Go libraries out there for SOCKS5 so this is no problem.</p>\n\n<p>If a client behind a NAT connects to a public server, how do others users can connect (maybe on a different port) and how should I forward the requests?</p>\n\n<ul>\n<li>\"C\" is the (single) client behind NAT</li>\n<li>\"A\" is the public server i want to use to expose the client</li>\n<li>\"U\" is a user (or multiple users) which want to connect to C through A</li>\n</ul>\n\n<p>e.g. if A (public server) listens on port 5544 and C (the client behind NAT connects to it while C also has a local SOCKS5 server where the requests  are getting forwarded to) how does (U) the user or maybe even multiple users forward the request to C (the first connection made on A:5544)</p>\n\n<p>[ U   -->   A:5544   &lt;-->   C   &lt;-->   C local socks5 server]     </p>\n\n<p>User connects to A, C is connected to A, the traffic gets forwarded to C (note that C doesn't listen for incoming connections cause C is connected to A and not reverse, because C is behind a NAT) </p>\n\n<p>I hope you understand what I mean.</p>\n\n<p>Thank you in advance!</p>\n\n<p>Edit:</p>\n\n<p>To point out what i mean.\nC - the client behind the NAT does not directly listen on TCP it just opens up a TCP connection (net.Dial() ...) to the public server which soulde expose the client - the socks5 proxy on C is not directly exposed so the dialed TCP connection soulde somehow behave like a TCP listener.</p>\n\n<p>I think basically it's the same technique that teamviewer is using.\nBut how exactly? And also it's important that multiple users can connect to the client \"C\" through \"A\".</p>\n\n<p>Addition: baloo's answer got me a step further but now the problem is that if the answer/traffic from the Client &lt;--> Remote server connection get's copied (on the public server side code) via </p>\n\n<pre><code>_, err := io.Copy(usrConn, s.ProxyClient)\n</code></pre>\n\n<p>The data gets streamed/tunneled but if I request a site through the proxy the site is loading and loading this causes also the problem that other \"User\" connections are blocked. (I get a Site response on the first request so far but the request of the whole site is still pending... I may have a wrong understanding of the SOCKS5 protocol?)</p>\n\n<p>Here is my messy prototype code for the public server: <a href=\"http://pastebin.com/7Y2JBVE0\" rel=\"nofollow\">http://pastebin.com/7Y2JBVE0</a></p>\n\n<p>And this is the code for the client (reverse proxy): <a href=\"http://pastebin.com/w3i9cap4\" rel=\"nofollow\">http://pastebin.com/w3i9cap4</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dftHt.jpg?s=128&g=1", "display_name": "godtail", "link": "https://stackoverflow.com/users/6677510/godtail"}, "edited": false, "score": 0, "creation_date": 1471409762, "post_id": 38988091, "comment_id": 65329018, "body": "Thank your for answer ~.i should move my library packages to the $GOPATH dir. also can improve reuse. and when i use git how can i push my lib package. or i have some product use the same lib package."}, {"owner": {"reputation": 159, "user_id": 6677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dftHt.jpg?s=128&g=1", "display_name": "godtail", "link": "https://stackoverflow.com/users/6677510/godtail"}, "edited": false, "score": 0, "creation_date": 1471410073, "post_id": 38988091, "comment_id": 65329121, "body": "did go have package manger like composer or npm ? then i just need to edit the config json. and it can pull code from remote."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 159, "user_id": 6677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dftHt.jpg?s=128&g=1", "display_name": "godtail", "link": "https://stackoverflow.com/users/6677510/godtail"}, "edited": false, "score": 0, "creation_date": 1471410132, "post_id": 38988091, "comment_id": 65329145, "body": "see: <a href=\"http://stackoverflow.com/questions/30300279/golang-dependency-management-best-practice\" title=\"golang dependency management best practice\">stackoverflow.com/questions/30300279/&hellip;</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1506535589, "last_edit_date": 1506535589, "creation_date": 1471407795, "answer_id": 38988091, "question_id": 38987866, "link": "https://stackoverflow.com/questions/38987866/why-go-put-all-code-in-gopath-src/38988091#38988091", "title": "Why Go put all code in $GOPATH/src", "body": "<p>See: <a href=\"https://golang.org/ref/spec#Packages\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Packages</a>  </p>\n\n<blockquote>\n  <p>Go programs are constructed by linking together packages. A package in\n  turn is constructed from one or more source files that together\n  declare constants, types, variables and functions belonging to the\n  package and which are accessible in all files of the same package.\n  Those elements may be exported and used in another package.</p>\n  \n  <p>Source file organization</p>\n  \n  <p>Each source file consists of a package clause defining the package to\n  which it belongs, followed by a possibly empty set of import\n  declarations that declare packages whose contents it wishes to use,\n  followed by a possibly empty set of declarations of functions, types,\n  variables, and constants.</p>\n  \n  <p>SourceFile       = PackageClause \";\" { ImportDecl \";\" } { TopLevelDecl\n  \";\" } .</p>\n</blockquote>\n\n<p>You may add many <code>src</code> dirs to your <code>$GOPATH</code>:   </p>\n\n<blockquote>\n  <p>Like the system PATH environment variable, Go path is a <code>:</code> delimited \n   list of directories where Go will look for packages (<code>;</code>on Windows).</p>\n</blockquote>\n\n<p>So you may add your project <code>src</code> dir to the <code>$GOPATH</code>.<br>\nOr just store your library packages in one <code>$GOPATH</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5386, "user_id": 1061155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57eb915295663567365f1eebe0a41faa?s=128&d=identicon&r=PG", "display_name": "ospider", "link": "https://stackoverflow.com/users/1061155/ospider"}, "is_accepted": false, "score": 0, "last_activity_date": 1521997526, "creation_date": 1521997526, "answer_id": 49478483, "question_id": 38987866, "link": "https://stackoverflow.com/questions/38987866/why-go-put-all-code-in-gopath-src/49478483#49478483", "title": "Why Go put all code in $GOPATH/src", "body": "<p>You don't need to do that. Golang is going to introduce an official tool called <code>dep</code>, which is like <code>pip</code> for python or <code>npm</code> for node.js.</p>\n"}], "owner": {"reputation": 159, "user_id": 6677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dftHt.jpg?s=128&g=1", "display_name": "godtail", "link": "https://stackoverflow.com/users/6677510/godtail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4405, "favorite_count": 0, "accepted_answer_id": 38988091, "answer_count": 2, "score": 1, "last_activity_date": 1521997526, "creation_date": 1471406169, "last_edit_date": 1471410385, "question_id": 38987866, "link": "https://stackoverflow.com/questions/38987866/why-go-put-all-code-in-gopath-src", "title": "Why Go put all code in $GOPATH/src", "body": "<p>When I make a package use <code>go install</code>, I found Go search the package form two path </p>\n\n<ol>\n<li><p><code>/usr/local/Cellar/go/1.6.2/libexec/src/</code> go install dir. many base package like fmt...</p></li>\n<li><p><code>/Users/godtail/Product/go/go_path/src/</code> $GOPATH/src. bad $GOPATH, I will change it.</p></li>\n</ol>\n\n<p>also can use relative path, but is not recommended.</p>\n\n<p>I always put my work dir like this.</p>\n\n<pre><code>Product A\n    php\n    nodejs\n    go(i hope to put here)\nProduct B\n    java\n    nodejs\n...\n</code></pre>\n\n<p>How can I do like this? or maybe change dir follow Go.<br>\nGive me some advice, thank you very much.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471418028, "post_id": 38987637, "comment_id": 65332580, "body": "@user3309002 I hope this helps."}, {"owner": {"reputation": 63, "user_id": 3309002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jkCUA.jpg?s=128&g=1", "display_name": "Aitch", "link": "https://stackoverflow.com/users/3309002/aitch"}, "edited": false, "score": 0, "creation_date": 1471423349, "post_id": 38987637, "comment_id": 65335695, "body": "Thanks a lot. I understand the difference now."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1475385530, "last_edit_date": 1495535358, "creation_date": 1471404460, "answer_id": 38987637, "question_id": 38987391, "link": "https://stackoverflow.com/questions/38987391/pointer-receiver-and-value-receiver-difference-in-implementation-with-iris-frame/38987637#38987637", "title": "Pointer receiver and Value receiver difference in implementation with Iris framework", "body": "<p><a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">See Docs</a>:</p>\n\n<blockquote>\n  <p>A type may have a method set associated with it. The method set of an\n  interface type is its interface. The method set of any other type <code>T</code>\n  consists of all methods declared with receiver type <code>T</code>. The method set\n  of the corresponding pointer type <code>*T</code> is the set of all methods\n  declared with receiver <code>*T</code> or <code>T</code> (that is, it also contains the method\n  set of <code>T</code>). Further rules apply to structs containing anonymous fields,\n  as described in the section on struct types. Any other type has an\n  empty method set. In a method set, each method must have a unique\n  non-blank method name.</p>\n</blockquote>\n\n<p>And see: <a href=\"https://stackoverflow.com/a/33591156/6169399\">https://stackoverflow.com/a/33591156/6169399</a> : </p>\n\n<blockquote>\n  <p>If you have an interface <code>I</code>, and some or all of the methods in <code>I</code>'s\n  method set are provided by methods with a receiver of <code>*T</code> (with the\n  remainder being provided by methods with a receiver of <code>T</code>), then <code>*T</code>\n  satisfies the interface <code>I</code>, but <code>T</code> doesn't. That is because <code>*T</code>'s method\n  set includes <code>T</code>'s, but not the other way around.</p>\n</blockquote>\n\n<p>Using <code>ctrl := Pages{}</code> makes error:</p>\n\n<pre><code>cannot use ctrl (type Pages) as type Handler in argument to Handle:\nPages does not implement Handler (Serve method has pointer receiver)\n</code></pre>\n\n<p>Using <code>ctrl := Pages{}</code>needs:</p>\n\n<pre><code>func (p Pages) Serve() {\n    fmt.Println(p.i)\n}\n</code></pre>\n\n<p><a href=\"https://godoc.org/github.com/kataras/iris#Handler\" rel=\"nofollow noreferrer\">Iris Handler</a> is an interface type. like this working sample (see comment):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\ntype Handler interface {\n    Serve()\n}\n\ntype Pages struct {\n    i int\n}\n\nfunc (p *Pages) Serve() {\n    fmt.Println(p.i)\n}\n\nfunc Handle(p Handler) {\n    p.Serve()\n}\n\nfunc main() {\n    // cannot use ctrl (type Pages) as type Handler in argument to Handle:\n    // Pages does not implement Handler (Serve method has pointer receiver)\n    //ctrl := Pages{}\n    ctrl := &amp;Pages{101}\n    Handle(ctrl)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>101\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1471405833, "creation_date": 1471405833, "answer_id": 38987829, "question_id": 38987391, "link": "https://stackoverflow.com/questions/38987391/pointer-receiver-and-value-receiver-difference-in-implementation-with-iris-frame/38987829#38987829", "title": "Pointer receiver and Value receiver difference in implementation with Iris framework", "body": "<p>According to <a href=\"https://godoc.org/github.com/kataras/iris#Handler\" rel=\"nofollow\">https://godoc.org/github.com/kataras/iris#Handler</a>. Iris Handler is an interface type. </p>\n\n<p>GO performs implicit pointer-conversion on variables only, not on interfaces. </p>\n"}], "owner": {"reputation": 63, "user_id": 3309002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jkCUA.jpg?s=128&g=1", "display_name": "Aitch", "link": "https://stackoverflow.com/users/3309002/aitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "closed_date": 1570832540, "accepted_answer_id": 38987637, "answer_count": 2, "score": 1, "last_activity_date": 1475385530, "creation_date": 1471402633, "last_edit_date": 1471417942, "question_id": 38987391, "link": "https://stackoverflow.com/questions/38987391/pointer-receiver-and-value-receiver-difference-in-implementation-with-iris-frame", "closed_reason": "Duplicate", "title": "Pointer receiver and Value receiver difference in implementation with Iris framework", "body": "<p>I am studying Iris framework recently. I encountered a question when I was implementing the Handler. Like following:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package controller\n\nimport \"github.com/kataras/iris\"    \n\ntype Pages struct{\n}\n\nfunc (p *Pages) Serve(c *iris.Context) {\n}\n</code></pre>\n\n<p>In order to use this controller, I implemented the following entry script:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n     \"github.com/kataras/iris\"\n     \"web/controller\"\n)\n\nfunc main(){\n      ctrl := controller.Pages{}\n      iris.Handle(\"GET\", \"/\", ctrl)\n      iris.Listen(\":8080\")\n}\n</code></pre>\n\n<p>But when I compiled the code, I got the following error message:</p>\n\n<pre><code>cannot use ctrl (type controllers.Pages) as type iris.Handler in argument to iris.Handle:\ncontrollers.Pages does not implement iris.Handler (Serve method has pointer receiver)\n</code></pre>\n\n<p>After I changed the declaration to:</p>\n\n<pre><code>ctrl := &amp;controller.Pages{}\n</code></pre>\n\n<p>Then the compiler passed with no complaint. </p>\n\n<p>The question is: I thought the following statements are equal, since the GO compiler will do the conversion under the table:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Pages struct {\n}\n\nfunc (p *Pages) goWithPointer() {\n    fmt.Println(\"goWithPointer\")\n}\n\nfunc (p Pages) goWithValue() {\n    fmt.Println(\"goWithValue\")\n}\n\nfunc main() {\n    p1 := Pages{}\n    p2 := &amp;Pages{}\n\n    p1.goWithPointer()\n    p1.goWithValue()\n\n    p2.goWithPointer()\n    p2.goWithValue()\n}\n</code></pre>\n\n<p>Why can't I use <code>ctrl := controller.Pages{}</code> as the parameter to <code>iris.Handle()</code>, instead of <code>ctrl := &amp;controller.Pages{}</code> as the parameter to <code>iris.Handle()</code>?</p>\n\n<p>Thank you for your time and sharing.</p>\n"}, {"tags": ["go", "codahale-metrics"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471400938, "post_id": 38986154, "comment_id": 65326974, "body": "make sure you known what <code>SetReadDeadline</code> do."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471408741, "post_id": 38986154, "comment_id": 65328752, "body": "@ jamil-seaidoun I don&#39;t see any error, even with <code>SetReadDeadline</code> commented. what is your go version? and show your minimum client sample code."}, {"owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "edited": false, "score": 0, "creation_date": 1471409366, "post_id": 38986154, "comment_id": 65328921, "body": "@Amd The client code is the druid graphite emitter found here: <a href=\"https://github.com/druid-io/druid/tree/master/extensions-contrib/graphite-emitter\" rel=\"nofollow noreferrer\">github.com/druid-io/druid/tree/master/extensions-contrib/&hellip;</a>. At it&#39;s core it&#39;s using the coda hale metrics library mentioned in the post above."}], "owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2726, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1471393265, "creation_date": 1471391476, "last_edit_date": 1592644375, "question_id": 38986154, "link": "https://stackoverflow.com/questions/38986154/golang-broken-pipe", "title": "Golang broken pipe", "body": "<p>I have a code segment that is reading from a TCP connection and after the first few connections, the server is outputing broken pipe however no error is occurring in my go code. The server sending the messages is at its core the coda hale metrics library, more specifically the <a href=\"http://metrics.dropwizard.io/3.1.0/apidocs/com/codahale/metrics/graphite/PickledGraphite.html\" rel=\"nofollow noreferrer\">PickledGraphite</a> class.</p>\n<p>here is the Go code that is reading:</p>\n<pre><code>func handleConn(conn net.Conn, id int) {\n    fmt.Println(&quot;handleConn&quot;)\n    defer conn.Close()\n    buf := make([]byte, 0, 10240)\n    tmp := make([]byte, 256)\n    fmt.Printf(&quot;%v Reading...\\n&quot;, id)\n    for {\n        n, err := conn.Read(tmp)\n        fmt.Printf(&quot;%v Read %v\\n&quot;, id, n)\n        if err != nil {\n            fmt.Printf(&quot;%v Got err: %v\\n&quot;, id, err)\n            if err != io.EOF {\n                fmt.Printf(&quot;%v read error: %v\\n&quot;, id, err)\n            }\n            buf = append(buf, tmp[:n]...)\n            break\n        }\n        buf = append(buf, tmp[:n]...)\n    }\n    fmt.Printf(&quot;%v Done Reading\\n&quot;, id)\n    // Do stuff with buf\n}\n\nfunc main() {\n    ln, err := net.Listen(&quot;tcp&quot;, &quot;:5555&quot;)\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(-1)\n    }\n    id := 1\n    for {\n        fmt.Println(&quot;getting connection\\n&quot;)\n        conn, err := ln.Accept()\n        if err != nil {\n            fmt.Println(err)\n            break\n        }\n        conn.SetReadDeadline(time.Now().Add(20 * time.Second))\n        fmt.Println(&quot;Got connection&quot;)\n        go handleConn(conn, id)\n        id = id + 1\n        fmt.Println(&quot;sent handleConn\\n&quot;)\n    }\n}\n</code></pre>\n<p>My code is still running, I can still execute <code>nc</code> commands and see my code receive it, so I am not sure how I am losing the connection.\nIf I remove the <code>conn.SetReadDeadline()</code> line then what happens is my code no longer receives a EOF after the first message.\nThanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1471377295, "post_id": 38983089, "comment_id": 65319589, "body": "1. There is no &quot;pass by reference&quot; in Go. 2. Never copy a http.Request. 3. Work with *http.Request only."}, {"owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1471377664, "post_id": 38983089, "comment_id": 65319777, "body": "I agree, but I&#39;m using a lib doing this (<a href=\"https://github.com/haisum/recaptcha/blob/master/recaptcha.go#L46\" rel=\"nofollow noreferrer\">github.com/haisum/recaptcha/blob/master/recaptcha.go#L46</a>). And that doesn&#39;t explain what I see :("}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1471379546, "post_id": 38983788, "comment_id": 65320662, "body": "In other words, you can fix this in a generalized way by calling <code>req.ParseForm()</code> before doing anything with the request."}, {"owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1471379679, "post_id": 38983788, "comment_id": 65320724, "body": "That&#39;s what I was looking for. So the body being read &quot;for the copy&quot; is no more available for the original request, hence the empty string. Thanks!"}], "tags": [], "owner": {"reputation": 141, "user_id": 1672533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba5c12e1020f644630a80813a049071?s=128&d=identicon&r=PG", "display_name": "yanzay", "link": "https://stackoverflow.com/users/1672533/yanzay"}, "is_accepted": true, "score": 5, "last_activity_date": 1471378856, "creation_date": 1471378856, "answer_id": 38983788, "question_id": 38983089, "link": "https://stackoverflow.com/questions/38983089/http-request-values-are-empty-if-the-request-is-passed-by-value/38983788#38983788", "title": "http request values are empty if the request is passed by value", "body": "<p>It's because Request's body is <code>io.Reader</code>, and you can read from <code>io.Reader</code> only once, when you try to read content second time, there is no more data to read.</p>\n\n<p>Method <code>FormValue</code> calls <code>ParseForm</code>, and it reads all data from the reader.</p>\n"}], "owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 0, "accepted_answer_id": 38983788, "answer_count": 1, "score": 1, "last_activity_date": 1471378856, "creation_date": 1471376126, "question_id": 38983089, "link": "https://stackoverflow.com/questions/38983089/http-request-values-are-empty-if-the-request-is-passed-by-value", "title": "http request values are empty if the request is passed by value", "body": "<p>Could someone explains what's happening here?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc Verify(req http.Request) string {\n    return req.FormValue(\"g-recaptcha-response\")\n}\n\nfunc main() {\n    req, _ := http.NewRequest(\"POST\", \"http://www.google.com/search?q=foo&amp;q=bar&amp;both=x&amp;prio=1&amp;empty=not\",\n        strings.NewReader(\"z=post&amp;both=y&amp;prio=2&amp;empty=\"))\n    req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded; param=value\")\n    Verify(*req)\n    fmt.Println(req.FormValue(\"z\"))\n}\n</code></pre>\n\n<p>(<a href=\"https://play.golang.org/p/ve4Cc_JTzr\" rel=\"nofollow\">https://play.golang.org/p/ve4Cc_JTzr</a>)</p>\n\n<p>This will produce an empty output.\nNow if I access the value \"z\" <em>before</em> passing the request as value, it works!</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc Verify(req http.Request) string {\n    return req.FormValue(\"g-recaptcha-response\")\n}\n\nfunc main() {\n    req, _ := http.NewRequest(\"POST\", \"http://www.google.com/search?q=foo&amp;q=bar&amp;both=x&amp;prio=1&amp;empty=not\",\n        strings.NewReader(\"z=post&amp;both=y&amp;prio=2&amp;empty=\"))\n    req.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded; param=value\")\n    Verify(*req)\n    fmt.Println(req.FormValue(\"z\"))\n}\n</code></pre>\n\n<p>(<a href=\"https://play.golang.org/p/5ALnt-pHTl\" rel=\"nofollow\">https://play.golang.org/p/5ALnt-pHTl</a>)</p>\n\n<p>I have tried with several versions of go from 1.5 to 1.7, with the same odd result.\nIf the request is passed by reference, it's working as expected.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 2864973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed511902c18b95508b74db37bcf07bc?s=128&d=identicon&r=PG&f=1", "display_name": "tochiai", "link": "https://stackoverflow.com/users/2864973/tochiai"}, "edited": false, "score": 0, "creation_date": 1471374616, "post_id": 38982567, "comment_id": 65318241, "body": "Thanks for the explanation!"}, {"owner": {"reputation": 3303, "user_id": 479478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/488d6b3925a325a0a3170d1ca4ab5b19?s=128&d=identicon&r=PG", "display_name": "Eric Chen", "link": "https://stackoverflow.com/users/479478/eric-chen"}, "edited": false, "score": 7, "creation_date": 1554931524, "post_id": 38982567, "comment_id": 97936058, "body": "Sure, this solves the problem of not unmarshaling <code>Num</code>, however, it doesn&#39;t work with embedded data such as <code>{&quot;data&quot;: &quot;test&quot;, &quot;num&quot;: 1}</code>, it would only work with something like <code>{&quot;inner&quot;: {&quot;data&quot;: &quot;test&quot;}, &quot;num&quot;: 1}</code>."}, {"owner": {"reputation": 1772, "user_id": 633495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc1cb16f0fd38a8126a1b65526b92c19?s=128&d=identicon&r=PG", "display_name": "Mohammad", "link": "https://stackoverflow.com/users/633495/mohammad"}, "edited": false, "score": 1, "creation_date": 1567161396, "post_id": 38982567, "comment_id": 101890498, "body": "Agreed with Eric. I think this answer is only barely applicable in this case but in general case it&#39;s misleading."}, {"owner": {"reputation": 3215, "user_id": 494934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/35ebf73df33de7bd85359e78007e8c36?s=128&d=identicon&r=PG", "display_name": "maulik13", "link": "https://stackoverflow.com/users/494934/maulik13"}, "edited": false, "score": 1, "creation_date": 1583956635, "post_id": 38982567, "comment_id": 107290700, "body": "This is a misleading answer. I understand that the question itself is a bit unclear, but the proposed solution has nothing to do with embedded type."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 2, "last_activity_date": 1471374069, "creation_date": 1471374069, "answer_id": 38982567, "question_id": 38982445, "link": "https://stackoverflow.com/questions/38982445/json-unmarshal-embedded-struct/38982567#38982567", "title": "json unmarshal embedded struct", "body": "<p>This is happening because <code>Inner</code> is being embedded in <code>Outer</code>. That means when json library calls unmarshaler on <code>Outer</code>, it instead ends up calling it on <code>Inner</code>.</p>\n\n<p>Therefore, inside <code>func (i *Inner) UnmarshalJSON(data []byte)</code>, the <code>data</code> argument contains the entire json string, which you are then processing for <code>Inner</code> only.</p>\n\n<p>You can fix this by making <code>Inner</code> explicit field in <code>Outer</code></p>\n\n<pre><code>Outer struct {\n    I Inner // make Inner an explicit field\n    Num int `json:\"Num\"`\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/TZg70ZrvHp\" rel=\"nofollow\">Working example</a></p>\n"}, {"tags": [], "owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "is_accepted": false, "score": 1, "last_activity_date": 1471374099, "creation_date": 1471374099, "answer_id": 38982574, "question_id": 38982445, "link": "https://stackoverflow.com/questions/38982445/json-unmarshal-embedded-struct/38982574#38982574", "title": "json unmarshal embedded struct", "body": "<p>Just delete <code>UnmarshalJSON</code> in your example because it's used in unmarshaling of <code>Outer</code> since <code>Inner</code> is inlined. Otherwise, you need to override it if you want to do something custom.</p>\n\n<p><a href=\"https://play.golang.org/p/D6V6vKpx9J\" rel=\"nofollow\">https://play.golang.org/p/D6V6vKpx9J</a></p>\n"}, {"comments": [{"owner": {"reputation": 3996, "user_id": 1615594, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VD0n3.jpg?s=128&g=1", "display_name": "tsuz", "link": "https://stackoverflow.com/users/1615594/tsuz"}, "edited": false, "score": 0, "creation_date": 1564975526, "post_id": 54624012, "comment_id": 101191490, "body": "But <code>Num</code> is still 0, even though it should be 4"}, {"owner": {"reputation": 15, "user_id": 6201353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28c72a403900d7f1802a9f0572463c7?s=128&d=identicon&r=PG&f=1", "display_name": "Mykola M.", "link": "https://stackoverflow.com/users/6201353/mykola-m"}, "reply_to_user": {"reputation": 3996, "user_id": 1615594, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VD0n3.jpg?s=128&g=1", "display_name": "tsuz", "link": "https://stackoverflow.com/users/1615594/tsuz"}, "edited": false, "score": 0, "creation_date": 1565074328, "post_id": 54624012, "comment_id": 101225980, "body": "Hmm, yes we can remove InnerRaw struct and UnmarshallJSON function.  Result: <a href=\"https://play.golang.org/p/JkKCLQOnsHp\" rel=\"nofollow noreferrer\">play.golang.org/p/JkKCLQOnsHp</a> and it works fine"}, {"owner": {"reputation": 3996, "user_id": 1615594, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VD0n3.jpg?s=128&g=1", "display_name": "tsuz", "link": "https://stackoverflow.com/users/1615594/tsuz"}, "edited": false, "score": 0, "creation_date": 1565082429, "post_id": 54624012, "comment_id": 101230016, "body": "The OP wants to parse <code>Num</code> when there is <code>UnmarshalJSON</code> for Inner. If we remove <code>UnmarshalJSON</code>, then it wouldn&#39;t answer the question"}], "tags": [], "owner": {"reputation": 15, "user_id": 6201353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28c72a403900d7f1802a9f0572463c7?s=128&d=identicon&r=PG&f=1", "display_name": "Mykola M.", "link": "https://stackoverflow.com/users/6201353/mykola-m"}, "is_accepted": false, "score": -1, "last_activity_date": 1549859582, "creation_date": 1549859582, "answer_id": 54624012, "question_id": 38982445, "link": "https://stackoverflow.com/questions/38982445/json-unmarshal-embedded-struct/54624012#54624012", "title": "json unmarshal embedded struct", "body": "<p>Actually you not need explicit field, you need properly Marshal/UnMarshal</p>\n\n<p>Example: <a href=\"https://play.golang.org/p/mWPM7m44wfK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mWPM7m44wfK</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Outer struct {\n    Inner\n    Num int `json:\"Num\"`\n}\n\ntype Inner struct{ Data string }\n\ntype InnerRaw struct {Data string}\n\nfunc (i *Inner) UnmarshalJSON(data []byte) error {\n    ir:=&amp;InnerRaw{}\n    json.Unmarshal(data, ir)\n    i.Data = ir.Data\n    return nil\n}\n\nfunc main() {\n    x := Outer{}\n    data := []byte(`{\"Num\": 4, \"Data\":\"234\"}`)\n    _ = json.Unmarshal(data, &amp;x)\n    fmt.Printf(\"%+v\\n\", x)\n    js, _:=json.Marshal(x)\n    fmt.Printf(\"JSON:%s\", string(js))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 74, "user_id": 7458658, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c966f0580315b1118d5884de049022b8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Ferrarotto", "link": "https://stackoverflow.com/users/7458658/peter-ferrarotto"}, "is_accepted": false, "score": 0, "last_activity_date": 1618585111, "creation_date": 1618585111, "answer_id": 67127578, "question_id": 38982445, "link": "https://stackoverflow.com/questions/38982445/json-unmarshal-embedded-struct/67127578#67127578", "title": "json unmarshal embedded struct", "body": "<p>One way to do this is to forgo the custom <code>UnmarshalJSON</code> function entirely and just use the basic JSON notation, i.e.:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>type Outer struct {\n    Inner\n    Num int `json:&quot;num&quot;`\n}\n\ntype Inner struct {\n   Data string `json:&quot;data&quot;`\n}\n</code></pre>\n<p>You lose some of the more granular capabilities you could have with a custom unmarshalling method, but when you're unmarshalling a struct with mostly primitive fields like strings, you really don't need to worry about that.</p>\n<p><a href=\"https://play.golang.org/p/KNKkH5qhUNy\" rel=\"nofollow noreferrer\">Example in go playground</a></p>\n<p>If you really need custom unmarshalling, you could use composition, and give the struct a custom json encoding tag and have the struct contain the fields you want to play with. So if <code>data</code> is something that will contain multiple complex fields, you could just change <code>Inner</code> to reflect those fields, like this:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>type Outer struct {\n    Data Inner `json:&quot;data&quot;`\n    Num int `json:&quot;num&quot;`\n}\n\ntype Inner struct {\n    Thing string `json:&quot;thing&quot;`\n    OtherThing int `json:&quot;otherThing&quot;`\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/6pFTj8hVezw\" rel=\"nofollow noreferrer\">Example in go playground</a></p>\n<p>Once again, this doesn't have a custom unmarshalling function, but that can be scraped together for <code>Inner</code> easily enough. (Personally, I'd forgo the use of custom unmarshal functions entirely in any given case and just use encoding tags unless I absolutely had to use the unmarshalling function.)</p>\n"}], "owner": {"reputation": 123, "user_id": 2864973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed511902c18b95508b74db37bcf07bc?s=128&d=identicon&r=PG&f=1", "display_name": "tochiai", "link": "https://stackoverflow.com/users/2864973/tochiai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10514, "favorite_count": 2, "accepted_answer_id": 38982567, "answer_count": 4, "score": 11, "last_activity_date": 1618585111, "creation_date": 1471373567, "question_id": 38982445, "link": "https://stackoverflow.com/questions/38982445/json-unmarshal-embedded-struct", "title": "json unmarshal embedded struct", "body": "<p>I would like to unmarshal to struct <code>Outer</code> defined as:</p>\n\n<pre><code>type Outer struct {\n    Inner\n    Num int\n}\n\ntype Inner struct {\n    Data string\n}\nfunc (i *Inner) UnmarshalJSON(data []byte) error {\n    i.Data = string(data)\n    return nil\n}\n</code></pre>\n\n<p>Using <code>json.Unmarshal(data, &amp;Outer{})</code> seems only to use <code>Inner</code>'s <code>UnmarshalJSON</code> and ignores the <code>Num</code> field: <a href=\"https://play.golang.org/p/WUBfzpheMl\" rel=\"noreferrer\">https://play.golang.org/p/WUBfzpheMl</a></p>\n\n<p>I have an unwieldy <a href=\"https://play.golang.org/p/mHs0INz9rV\" rel=\"noreferrer\">solution</a> where I set the <code>Num</code> field manually, but I was wondering if anybody had a cleaner or simpler way to do it.</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["go", "constants"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 1, "creation_date": 1471373456, "post_id": 38982278, "comment_id": 65317611, "body": "not exactly the answer but might help: <a href=\"http://stackoverflow.com/questions/38806491/why-doesnt-left-bit-shifting-by-64-overflow-in-golang\" title=\"why doesnt left bit shifting by 64 overflow in golang\">stackoverflow.com/questions/38806491/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1471375820, "post_id": 38982278, "comment_id": 65318842, "body": "The Go compiler is open source, you may peek yourself: golang.org/src/cmd/compile/internal/gc/mpint.go"}], "answers": [{"tags": [], "owner": {"reputation": 996, "user_id": 253298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/07d1db375942d93877c2a6512a654e61?s=128&d=identicon&r=PG", "display_name": "duckbrain", "link": "https://stackoverflow.com/users/253298/duckbrain"}, "is_accepted": false, "score": 0, "last_activity_date": 1613280895, "last_edit_date": 1613280895, "creation_date": 1471373249, "answer_id": 38982357, "question_id": 38982278, "link": "https://stackoverflow.com/questions/38982278/how-does-go-perform-arithmetic-on-constants/38982357#38982357", "title": "How does Go perform arithmetic on constants?", "body": "<p>Go constants are not allocated to memory. They are used in context by the compiler. The blog post you refer to gives the example of Pi:</p>\n<pre><code>Pi    = 3.14159265358979323846264338327950288419716939937510582097494459\n</code></pre>\n<p>If you assign Pi to a <code>float32</code> it will lose precision to fit, but if you assign it to a <code>float64</code>, it will lose less precision, but the compiler will determine what type to use.</p>\n"}, {"comments": [{"owner": {"reputation": 1048, "user_id": 1496324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ade15ace31e0b74a19bdacf5d2422300?s=128&d=identicon&r=PG", "display_name": "Liz Sander", "link": "https://stackoverflow.com/users/1496324/liz-sander"}, "edited": false, "score": 0, "creation_date": 1471443907, "post_id": 38982889, "comment_id": 65350386, "body": "Very thorough and helpful! Here&#39;s my understanding based on this: nothing is arbitrary-precision at runtime. At compile time, compilers may vary in exact precision, but essentially perform operations on special arbitrary-precision types which are stored as slices of basic types (at least for ints, I would have to check for other types). These are then coerced into standard Go types for runtime. Is this accurate?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1048, "user_id": 1496324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ade15ace31e0b74a19bdacf5d2422300?s=128&d=identicon&r=PG", "display_name": "Liz Sander", "link": "https://stackoverflow.com/users/1496324/liz-sander"}, "edited": false, "score": 0, "creation_date": 1471447747, "post_id": 38982889, "comment_id": 65353201, "body": "@LizSander Edited the answer, added a <b>Summary</b> section at the end (which is the answer to your comment)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1565883539, "last_edit_date": 1565883539, "creation_date": 1471375297, "answer_id": 38982889, "question_id": 38982278, "link": "https://stackoverflow.com/questions/38982278/how-does-go-perform-arithmetic-on-constants/38982889#38982889", "title": "How does Go perform arithmetic on constants?", "body": "<p><em>Short summary (TL;DR) is at the end of the answer.</em></p>\n\n<p>Untyped arbitrary-precision constants don't live at runtime, constants live only at compile time (during the compilation). That being said, Go does not have to represent constants with arbitrary precision at runtime, only when compiling your application.</p>\n\n<p>Why? Because constants do not get compiled into the executable binaries. They don't have to be. Let's take your example:</p>\n\n<pre><code>const Huge = 1e1000\nfmt.Println(Huge / 1e999)\n</code></pre>\n\n<p>There is a constant <code>Huge</code> in the <em>source code</em> (and will be in the package object), but it won't appear in your executable. Instead a function call to <code>fmt.Println()</code> will be recorded with a value passed to it, whose type will be <code>float64</code>. So in the executable only a <code>float64</code> value being <code>10.0</code> will be recorded. There is no sign of any number being <code>1e1000</code> in the executable.</p>\n\n<p>This <code>float64</code> type is derived from the <em>default</em> type of the <em>untyped</em> constant <code>Huge</code>. <code>1e1000</code> is a <a href=\"https://golang.org/ref/spec#Floating-point_literals\" rel=\"noreferrer\">floating-point literal</a>. To verify it:</p>\n\n<pre><code>const Huge = 1e1000\nx := Huge / 1e999\nfmt.Printf(\"%T\", x) // Prints float64\n</code></pre>\n\n<p>Back to the arbitrary precision:</p>\n\n<p><a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">Spec: Constants:</a></p>\n\n<blockquote>\n  <p>Numeric constants represent exact values of arbitrary precision and do not overflow.</p>\n</blockquote>\n\n<p>So constants represent exact values of arbitrary precision. As we saw, there is no need to represent constants with arbitrary precision at <em>runtime</em>, but the compiler still has to do something at <em>compile time</em>. And it <em>does</em>!</p>\n\n<p>Obviously \"infinite\" precision cannot be dealt with. But there is no need, as the source code itself is not \"infinite\" (size of the source is finite). Still, it's not practical to <em>allow</em> truly arbitrary precision. So the spec gives some freedom to compilers regarding to this:</p>\n\n<blockquote>\n  <p>Implementation restriction: Although numeric constants have arbitrary precision in the language, a compiler may implement them using an internal representation with limited precision. That said, every implementation must:</p>\n  \n  <ul>\n  <li>Represent integer constants with at least 256 bits.</li>\n  <li>Represent floating-point constants, including the parts of a complex constant, with a mantissa of at least 256 bits and a signed exponent of at least 32 bits.</li>\n  <li>Give an error if unable to represent an integer constant precisely.</li>\n  <li>Give an error if unable to represent a floating-point or complex constant due to overflow.</li>\n  <li>Round to the nearest representable constant if unable to represent a floating-point or complex constant due to limits on precision.\n  These requirements apply both to literal constants and to the result of evaluating <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"noreferrer\">constant expressions</a>.</li>\n  </ul>\n</blockquote>\n\n<p>However, also note that when all the above said, the standard package provides you the means to still represent and work with values (constants) with \"arbitrary\" precision, see package <a href=\"https://golang.org/pkg/go/constant/\" rel=\"noreferrer\"><code>go/constant</code></a>. You may look into its source to get an idea how it's implemented.</p>\n\n<p>Implementation is in <a href=\"https://golang.org/src/go/constant/value.go\" rel=\"noreferrer\"><code>go/constant/value.go</code></a>. Types representing such values:</p>\n\n<pre><code>// A Value represents the value of a Go constant.\ntype Value interface {\n    // Kind returns the value kind.\n    Kind() Kind\n\n    // String returns a short, human-readable form of the value.\n    // For numeric values, the result may be an approximation;\n    // for String values the result may be a shortened string.\n    // Use ExactString for a string representing a value exactly.\n    String() string\n\n    // ExactString returns an exact, printable form of the value.\n    ExactString() string\n\n    // Prevent external implementations.\n    implementsValue()\n}\n\ntype (\n    unknownVal struct{}\n    boolVal    bool\n    stringVal  string\n    int64Val   int64                    // Int values representable as an int64\n    intVal     struct{ val *big.Int }   // Int values not representable as an int64\n    ratVal     struct{ val *big.Rat }   // Float values representable as a fraction\n    floatVal   struct{ val *big.Float } // Float values not representable as a fraction\n    complexVal struct{ re, im Value }\n)\n</code></pre>\n\n<p>As you can see, the <a href=\"https://golang.org/pkg/math/big/\" rel=\"noreferrer\"><code>math/big</code></a> package is used to represent untyped arbitrary precision values. <a href=\"https://golang.org/pkg/math/big/#Int\" rel=\"noreferrer\"><code>big.Int</code></a> is for example (from <a href=\"https://golang.org/src/math/big/int.go\" rel=\"noreferrer\"><code>math/big/int.go</code></a>):</p>\n\n<pre><code>// An Int represents a signed multi-precision integer.\n// The zero value for an Int represents the value 0.\ntype Int struct {\n    neg bool // sign\n    abs nat  // absolute value of the integer\n}\n</code></pre>\n\n<p>Where <code>nat</code> is (from <a href=\"https://golang.org/src/math/big/nat.go\" rel=\"noreferrer\"><code>math/big/nat.go</code></a>):</p>\n\n<pre><code>// An unsigned integer x of the form\n//\n//   x = x[n-1]*_B^(n-1) + x[n-2]*_B^(n-2) + ... + x[1]*_B + x[0]\n//\n// with 0 &lt;= x[i] &lt; _B and 0 &lt;= i &lt; n is stored in a slice of length n,\n// with the digits x[i] as the slice elements.\n//\n// A number is normalized if the slice contains no leading 0 digits.\n// During arithmetic operations, denormalized values may occur but are\n// always normalized before returning the final result. The normalized\n// representation of 0 is the empty or nil slice (length = 0).\n//\ntype nat []Word\n</code></pre>\n\n<p>And finally <a href=\"https://golang.org/pkg/math/big/#Word\" rel=\"noreferrer\"><code>Word</code></a> is (from <a href=\"https://golang.org/src/math/big/arith.go\" rel=\"noreferrer\"><code>math/big/arith.go</code></a>)</p>\n\n<pre><code>// A Word represents a single digit of a multi-precision unsigned integer.\ntype Word uintptr\n</code></pre>\n\n<hr>\n\n<p><strong>Summary</strong></p>\n\n<p>At runtime: <em>predefined</em> types provide limited precision, but you can \"mimic\" arbitrary precision with certain packages, such as <code>math/big</code> and <code>go/constant</code>. At compile time: constants seemingly provide arbitrary precision, but in reality a compiler may not live up to this (doesn't have to); but still the spec provides minimal precision for constants that all compiler must support, e.g. integer constants must be represented with at least 256 bits which is 32 bytes (compared to <code>int64</code> which is \"only\" 8 bytes).</p>\n\n<p>When an executable binary is created, results of constant expressions (with arbitrary precision) have to be converted and represented with values of finite precision types \u2013 which may not be possible and thus may result in compile-time errors. Note that only <em>results</em> \u2013not intermediate operands\u2013 have to be converted to finite precision, constant operations are carried out with arbitrary precision.</p>\n\n<p>How this arbitrary or enhanced precision is implemented is not defined by the spec, <code>math/big</code> for example stores \"digits\" of the number in a slice (where digits is not a digit of the base 10 representation, but \"digit\" is an <code>uintptr</code> which is like base 4294967295 representation on 32-bit architectures, and even bigger on 64-bit architectures).</p>\n"}], "owner": {"reputation": 1048, "user_id": 1496324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ade15ace31e0b74a19bdacf5d2422300?s=128&d=identicon&r=PG", "display_name": "Liz Sander", "link": "https://stackoverflow.com/users/1496324/liz-sander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 1, "accepted_answer_id": 38982889, "answer_count": 2, "score": 6, "last_activity_date": 1613280895, "creation_date": 1471372985, "last_edit_date": 1471375462, "question_id": 38982278, "link": "https://stackoverflow.com/questions/38982278/how-does-go-perform-arithmetic-on-constants", "title": "How does Go perform arithmetic on constants?", "body": "<p>I've been reading this <a href=\"https://blog.golang.org/constants\" rel=\"noreferrer\">post on constants in Go</a>, and I'm trying to understand how they are stored and used in memory. You can perform operations on very large constants in Go, and as long as the result fits in memory, you can coerce that result to a type. For example, this code prints <code>10</code>, as you would expect:</p>\n\n<pre><code>const Huge = 1e1000\nfmt.Println(Huge / 1e999)\n</code></pre>\n\n<p>How does this work under the hood? At some point, Go has to store <code>1e1000</code> and <code>1e999</code> in memory, in order to perform operations on them. So how are constants stored, and how does Go perform arithmetic on them?</p>\n"}, {"tags": ["json", "go", "gzip"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471418509, "post_id": 38982020, "comment_id": 65332856, "body": "The <code>http</code> package automatically decodes gzip responses. What you get from <code>resp.Body</code> is the uncompressed response. No need to manually decode it. Decode it like this: <code>json.NewDecoder(resp.Body).Decode(&amp;response)</code>"}, {"owner": {"reputation": 395, "user_id": 410527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3683bc5f16e1bf87e3c0111e9482ccd4?s=128&d=identicon&r=PG", "display_name": "Sion", "link": "https://stackoverflow.com/users/410527/sion"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471439374, "post_id": 38982020, "comment_id": 65346756, "body": "Doing this gives me the error <code>[NewDecoder]: invalid character &#39;\\x1f&#39; looking for beginning of value</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471439702, "post_id": 38982020, "comment_id": 65347046, "body": "If the response contains the <code>Content-Encoding: gzip</code> header, the <code>net&#47;http</code> package will decode it automatically for you. Please check if this is present."}, {"owner": {"reputation": 395, "user_id": 410527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3683bc5f16e1bf87e3c0111e9482ccd4?s=128&d=identicon&r=PG", "display_name": "Sion", "link": "https://stackoverflow.com/users/410527/sion"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471453489, "post_id": 38982020, "comment_id": 65356575, "body": "Have you seen the full example I posted? One of the steps was checking the encoding."}], "answers": [{"tags": [], "owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "is_accepted": false, "score": -1, "last_activity_date": 1471530483, "creation_date": 1471530483, "answer_id": 39020829, "question_id": 38982020, "link": "https://stackoverflow.com/questions/38982020/decoding-gzip-json-with-go/39020829#39020829", "title": "Decoding gZip json with Go", "body": "<p>As @icza mentioned in the comments, decoding isn't required because the gzip reader automatically decodes when you read using it. Perhaps try:</p>\n\n<pre><code>ubs := make([]byte, len) // check Content-Length header to set len\nn, err := reader.Read(ubs)\nerr := json.Unmarshal(ubs, &amp;response)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 410527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3683bc5f16e1bf87e3c0111e9482ccd4?s=128&d=identicon&r=PG", "display_name": "Sion", "link": "https://stackoverflow.com/users/410527/sion"}, "edited": false, "score": 0, "creation_date": 1471852515, "post_id": 39026078, "comment_id": 65495898, "body": "Sorry for the delayed response. I tried the code that you suggested, but unfortunately I still get an empty struct. If you want to try the api for yourself you could register here; <a href=\"https://devportal.tescolabs.com/\" rel=\"nofollow noreferrer\">devportal.tescolabs.com</a>  This feels like it really should work."}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "reply_to_user": {"reputation": 395, "user_id": 410527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3683bc5f16e1bf87e3c0111e9482ccd4?s=128&d=identicon&r=PG", "display_name": "Sion", "link": "https://stackoverflow.com/users/410527/sion"}, "edited": false, "score": 0, "creation_date": 1471882684, "post_id": 39026078, "comment_id": 65516456, "body": "See my updated code. I&#39;ve fixed your TescoResponse using a JSON to Go tool. <a href=\"https://play.golang.org/p/Vt07y_xgak\" rel=\"nofollow noreferrer\">play.golang.org/p/Vt07y_xgak</a>"}, {"owner": {"reputation": 395, "user_id": 410527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3683bc5f16e1bf87e3c0111e9482ccd4?s=128&d=identicon&r=PG", "display_name": "Sion", "link": "https://stackoverflow.com/users/410527/sion"}, "edited": false, "score": 0, "creation_date": 1471883334, "post_id": 39026078, "comment_id": 65516804, "body": "Ok, I&#39;m completely bamboozled now. I have run this in both Intellij and Atom, and stepped through the debugger. The struct is empty every time. I&#39;m running the latest go <code>go version go1.7 darwin&#47;amd64</code>."}, {"owner": {"reputation": 395, "user_id": 410527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3683bc5f16e1bf87e3c0111e9482ccd4?s=128&d=identicon&r=PG", "display_name": "Sion", "link": "https://stackoverflow.com/users/410527/sion"}, "edited": false, "score": 0, "creation_date": 1471894649, "post_id": 39026078, "comment_id": 65522603, "body": "I have literally copied your code exactly and replaced my api key. The program prints <code>Data from response &amp;{[]}</code>"}, {"owner": {"reputation": 395, "user_id": 410527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3683bc5f16e1bf87e3c0111e9482ccd4?s=128&d=identicon&r=PG", "display_name": "Sion", "link": "https://stackoverflow.com/users/410527/sion"}, "edited": false, "score": 0, "creation_date": 1471897454, "post_id": 39026078, "comment_id": 65523983, "body": "Thanks @Ezequiel. I completely missed your alteration to the new struct. I&#39;m surprised to see we need to model the complete response as my understanding of the unmarshal was that we could choose the bits we wanted. Either way, poor understanding on my part. Thanks for your support"}], "tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": true, "score": 5, "last_activity_date": 1471883095, "last_edit_date": 1471883095, "creation_date": 1471548434, "answer_id": 39026078, "question_id": 38982020, "link": "https://stackoverflow.com/questions/38982020/decoding-gzip-json-with-go/39026078#39026078", "title": "Decoding gZip json with Go", "body": "<p><a href=\"https://golang.org/src/net/http/transport.go#125\" rel=\"noreferrer\">From the documenation</a>:</p>\n\n<blockquote>\n  <p>DisableCompression, if true, prevents the Transport from requesting\n  compression with an \"Accept-Encoding: gzip\" request header when the\n  Request contains no existing Accept-Encoding value. If the Transport\n  requests gzip on its own and gets a gzipped response, it's\n  transparently decoded in the Response.Body. However, if the user\n  explicitly requested gzip it is not automatically uncompressed.</p>\n</blockquote>\n\n<p>Proposed solution:</p>\n\n<pre><code>type gzreadCloser struct {\n    *gzip.Reader\n    io.Closer\n}\n\nfunc (gz gzreadCloser) Close() error {\n    return gz.Closer.Close()\n}\n</code></pre>\n\n<p>// then in your http call ....</p>\n\n<pre><code>    if resp.Header.Get(\"Content-Encoding\") == \"gzip\" {\n        resp.Header.Del(\"Content-Length\")\n        zr, err := gzip.NewReader(resp.Body)\n        if err != nil {\n            return nil, err\n        }\n        resp.Body = gzreadCloser{zr, resp.Body}\n    }\n\n// then you will be able to decode the json transparently\n\nif err := json.NewDecoder(resp.Body).Decode(&amp;response); err != nil {\n\n}\n</code></pre>\n\n<p>Adapted solution from your code: <a href=\"https://play.golang.org/p/Vt07y_xgak\" rel=\"noreferrer\">https://play.golang.org/p/Vt07y_xgak</a></p>\n"}], "owner": {"reputation": 395, "user_id": 410527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3683bc5f16e1bf87e3c0111e9482ccd4?s=128&d=identicon&r=PG", "display_name": "Sion", "link": "https://stackoverflow.com/users/410527/sion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3368, "favorite_count": 0, "accepted_answer_id": 39026078, "answer_count": 2, "score": 5, "last_activity_date": 1471883095, "creation_date": 1471372044, "question_id": 38982020, "link": "https://stackoverflow.com/questions/38982020/decoding-gzip-json-with-go", "title": "Decoding gZip json with Go", "body": "<p>As a Go newbie it's difficult for me to pinpoint the problem area, but hopefully giving you some facts will help.</p>\n\n<p>I'm playing with an API which returns its <code>Content-Encoding</code> as gzip. I have written the following to encode my response struct:</p>\n\n<pre><code>reader, err = gzip.NewReader(resp.Body)\ndefer reader.Close()\n\n// print to standard out\n//_, err = io.Copy(os.Stdout, reader)\n//if err != nil {\n//  log.Fatal(err)\n//}\n\n// Decode the response into our tescoResponse struct\nvar response TescoResponse\nerr := json.NewDecoder(reader).Decode(&amp;response)\n</code></pre>\n\n<p>I've removed the error handling for brevity, but the point of interest is that if I uncomment the print to stdout, I get the expected result. However, the decode doesn't give me what I expect. Any pointers? Is it that the struct has to map exactly to the response??</p>\n\n<p>Here's the full example:\n<a href=\"https://play.golang.org/p/4eCuXxXm3T\" rel=\"noreferrer\">https://play.golang.org/p/4eCuXxXm3T</a></p>\n"}, {"tags": ["go", "cassandra"], "answers": [{"tags": [], "owner": {"reputation": 801, "user_id": 5056691, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z3xo21C2gaU/AAAAAAAAAAI/AAAAAAAAAI0/0KSAJRkAaYA/photo.jpg?sz=128", "display_name": "Anupam", "link": "https://stackoverflow.com/users/5056691/anupam"}, "is_accepted": true, "score": 3, "last_activity_date": 1472063108, "last_edit_date": 1472063108, "creation_date": 1471370914, "answer_id": 38981698, "question_id": 38981452, "link": "https://stackoverflow.com/questions/38981452/how-to-create-persistent-cassandra-connection-in-go-language/38981698#38981698", "title": "How to create persistent cassandra connection in GO language?", "body": "<pre><code>var session *gocql.Session\n\nfunc getCluster() *gocql.ClusterConfig {\n     cluster := gocql.NewCluster(\"cluseter_ip\")\n     pass := gocql.PasswordAuthenticator{\"username\", \"password\"}\n     cluster.Keyspace = \"keyspace_name\"\n     cluster.Authenticator = pass\n     cluster.Consistency = gocql.One\n     cluster.Port = 9042   // default port \n     cluster.NumConns = 1\n     return cluster\n}\n\nfunc initSession() error {\n    var err error\n    if session == nil || session.Closed() {\n        session, err := getCluster().CreateSession()\n    }\n    return err\n}\n</code></pre>\n\n<p>Now before using session, call <code>initSession()</code> and check for error before using it. Something like this should work. If your application is multithreaded, make sure to synchronize initSession api.</p>\n"}], "owner": {"reputation": 63, "user_id": 5465535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02516348dbe9779a0fa50bff30fcc99?s=128&d=identicon&r=PG&f=1", "display_name": "Daisy", "link": "https://stackoverflow.com/users/5465535/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1316, "favorite_count": 0, "accepted_answer_id": 38981698, "answer_count": 1, "score": 2, "last_activity_date": 1472063108, "creation_date": 1471370076, "question_id": 38981452, "link": "https://stackoverflow.com/questions/38981452/how-to-create-persistent-cassandra-connection-in-go-language", "title": "How to create persistent cassandra connection in GO language?", "body": "<p>I am trying to learn GO language. In my small project, making Cassandra DB connection but its taking more time to create session. </p>\n\n<p>I want to create persistent connection so that from next hit, connection time will be equal to negligible.</p>\n\n<p><strong>Is any method to create persistent connection?</strong></p>\n\n<p>Cassandra connection code is below:</p>\n\n<pre><code>cluster := gocql.NewCluster(\"cluseter_ip\")\npass := gocql.PasswordAuthenticator{\"username\", \"password\"}\ncluster.Keyspace = \"keyspace_name\"\ncluster.Authenticator = pass\ncluster.Consistency = gocql.One\ncluster.Port = 9042   // default port \ncluster.NumConns = 1\nsession, _ := cluster.CreateSession()\n</code></pre>\n"}, {"tags": ["go", "concurrency"], "answers": [{"comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1471367580, "post_id": 38980696, "comment_id": 65314250, "body": "I don&#39;t know how I missed that - should take a break. Thanks,"}, {"owner": {"reputation": 1052, "user_id": 1284683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f463198d9ab38b5d367263e17f17e624?s=128&d=identicon&r=PG", "display_name": "Billy", "link": "https://stackoverflow.com/users/1284683/billy"}, "edited": false, "score": 0, "creation_date": 1493180298, "post_id": 38980696, "comment_id": 74298564, "body": "Sometimes as an alternative to using a mutex with a slice you can use a buffered channel. <a href=\"https://play.golang.org/p/CGdz4T2Qn5\" rel=\"nofollow noreferrer\">play.golang.org/p/CGdz4T2Qn5</a>"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 8, "last_activity_date": 1471367229, "creation_date": 1471367229, "answer_id": 38980696, "question_id": 38980565, "link": "https://stackoverflow.com/questions/38980565/why-does-this-waitgroup-sometimes-not-wait-for-all-goroutines/38980696#38980696", "title": "Why does this WaitGroup sometimes not wait for all goroutines?", "body": "<p>There is a race condition in your code. It is right here:</p>\n\n<pre><code>go func (i int) {\n    defer ws.Done()\n    // race condition on s.Rash access\n    s.Rash = append(s.Rash, i) \n}(i)\n</code></pre>\n\n<p>Since all the goroutines access <code>s.Rash</code> concurrently, this may cause the slice updates to be overwritten. Try running the same code with <code>sync.Mutex</code> locking to prevent this:</p>\n\n<pre><code>// create a global mutex\nvar mutex = &amp;sync.Mutex{}\n\n// use mutex to prevent race condition\ngo func (i int) {\n    defer ws.Done()\n    defer mutex.Unlock() // ensure that mutex unlocks\n\n    // Lock the resource before accessing it\n    mutex.Lock()\n    s.Rash = append(s.Rash, i) \n}(i)\n</code></pre>\n\n<p>You can read more about this <a href=\"http://www.alexedwards.net/blog/understanding-mutexes\" rel=\"noreferrer\">here</a> and <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 4, "last_activity_date": 1471376140, "last_edit_date": 1471376140, "creation_date": 1471367268, "answer_id": 38980707, "question_id": 38980565, "link": "https://stackoverflow.com/questions/38980565/why-does-this-waitgroup-sometimes-not-wait-for-all-goroutines/38980707#38980707", "title": "Why does this WaitGroup sometimes not wait for all goroutines?", "body": "<p>If you run your code with race detector </p>\n\n<pre><code>go test -race .\n</code></pre>\n\n<p>you will find out race condition on slice <code>s.Rash</code>.</p>\n"}], "owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1536, "favorite_count": 0, "accepted_answer_id": 38980696, "answer_count": 2, "score": 4, "last_activity_date": 1471376140, "creation_date": 1471366746, "question_id": 38980565, "link": "https://stackoverflow.com/questions/38980565/why-does-this-waitgroup-sometimes-not-wait-for-all-goroutines", "title": "Why does this WaitGroup sometimes not wait for all goroutines?", "body": "<p>The code below outputs 2 sometimes. Why isn't the wait group waiting for all the goroutines to complete ?</p>\n\n<pre><code>type Scratch struct {\n    //sync.RWMutex\n    Itch []int\n}\n\nfunc (s *Scratch) GoScratch(done chan bool, j int) error {\n\n    var ws sync.WaitGroup\n\n    if len(s.Itch) == 0 {\n            s.Rash = make([]int, 0)\n    }\n    for i := 0; i &lt; j; i++ {\n            ws.Add(1)\n            go func (i int) {\n                    defer ws.Done()\n\n                   s.Rash = append(s.Rash, i) \n            }(i)\n    }\n    ws.Wait()\n    done&lt;- true\n    return nil\n}\n\nfunc main() {\n    done := make(chan bool, 3)\n    s := &amp;Scratch{}\n    err := s.GoScratch(done, 3)\n    if err != nil {\n            log.Println(\"Error:%v\",err)\n    }\n    &lt;-done\n    log.Println(\"Length: \", len(s.Rash)) \n}`\n</code></pre>\n\n<p>Strangely i can't get it to output 2 with a main function but when I use a test case it outputs 2 sometimes.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1471357879, "post_id": 38977555, "comment_id": 65308121, "body": "Sorry. my bad. Updated the question"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1471357968, "post_id": 38977555, "comment_id": 65308187, "body": "Can you reproduce this on the same site Mellow linked to?"}, {"owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "edited": false, "score": 0, "creation_date": 1471357998, "post_id": 38977555, "comment_id": 65308200, "body": "stil doesn&#39;t give an error."}, {"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1471359217, "post_id": 38977555, "comment_id": 65309020, "body": "Pls check my updated question @tadman"}, {"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1471359240, "post_id": 38977555, "comment_id": 65309043, "body": "Pls check my updated question @MellowMarmot"}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 4, "creation_date": 1471359512, "post_id": 38977555, "comment_id": 65309222, "body": "The problem you have is how you define the example string. In your example you have to double escape it like so: <code>&quot;[{\\&quot;Message\\&quot;: \\&quot;Hi\\\\n:Hello\\&quot;}]</code>. But you should really use this syntax <code>`[{&quot;Message&quot;: &quot;Hi\\n:Hello&quot;}]`</code> for readability, as suggested in the play link in earlier comment."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471364297, "post_id": 38979640, "comment_id": 65312301, "body": "@hardy I hope this helps."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1471369888, "last_edit_date": 1471369888, "creation_date": 1471363611, "answer_id": 38979640, "question_id": 38977555, "link": "https://stackoverflow.com/questions/38977555/error-embedding-n-into-a-string-literal/38979640#38979640", "title": "Error embedding &quot;\\n&quot; into a string literal", "body": "<p>Use backtick, like this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Person struct {\n    Name    string `json:\"Name\"`\n    Message string `json:\"Message\"`\n}\n\nfunc main() {\n    s := `\n[\n    {\"Name\":\"Neo\", \"Message\":\"Hi\\n:Hello everyone\"},\n    {\"Name\":\"Sam\", \"Message\":\"Hello\\nEvery\\nOne\"}\n]   \n    `\n    var pro []Person\n    err := json.Unmarshal([]byte(s), &amp;pro)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Printf(\"%q\\n\", pro)\n    fmt.Println()\n    fmt.Println(pro)\n\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[{\"Neo\" \"Hi\\n:Hello everyone\"} {\"Sam\" \"Hello\\nEvery\\nOne\"}]\n\n[{Neo Hi\n:Hello everyone} {Sam Hello\nEvery\nOne}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 9, "last_activity_date": 1471363612, "creation_date": 1471363612, "answer_id": 38979641, "question_id": 38977555, "link": "https://stackoverflow.com/questions/38977555/error-embedding-n-into-a-string-literal/38979641#38979641", "title": "Error embedding &quot;\\n&quot; into a string literal", "body": "<p>There are a few of issues here. The first is that newline is not allowed in a JSON string. Use the two bytes <code>\\n</code> to specify a newline, not an actual newline. If you use an interpreted string literal, then the <code>\\</code> must be quoted with a <code>\\</code>. Example:</p>\n\n<pre><code>\"Hello\\\\nWorld\"\n</code></pre>\n\n<p>No quoting is required in a raw string literal:</p>\n\n<pre><code>`Hello\\nWorld`\n</code></pre>\n\n<p>The next issue is that JSON value is an array of object values. To handle the array, unmarshal to a slice:</p>\n\n<pre><code>var pro []Person\nerr := json.Unmarshal([]byte(s), &amp;pro)\n</code></pre>\n\n<p>To handle the objects, define Person as a struct:</p>\n\n<pre><code>type Person struct {\n  Name    string\n  Message string\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/UniPq3cvBR\" rel=\"noreferrer\">working example on the playground</a>.</p>\n"}], "owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14538, "favorite_count": 0, "accepted_answer_id": 38979641, "answer_count": 2, "score": 2, "last_activity_date": 1471369888, "creation_date": 1471357613, "last_edit_date": 1471366836, "question_id": 38977555, "link": "https://stackoverflow.com/questions/38977555/error-embedding-n-into-a-string-literal", "title": "Error embedding &quot;\\n&quot; into a string literal", "body": "<p>I need to decode a JSON string which has \"\\n\" in it:</p>\n\n<pre><code>[\n    {\"Name\":\"Neo\", \"Message\":\"Hi\\n:Hello everyone\"},\n    {\"Name\":\"Sam\",\"Messsage\":\"Hello\\nEveery\\nOne\"}\n]\n</code></pre>\n\n<p>I use the Golang code below:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Person struct {\n    Messages  []string     `json:\"Name,omitempty\"`\n}\n\nfunc main() {\ns := \"[{\\\"Name\\\":\\\"Neo\\\", \\\"Message\\\":\\\"Hi\\n:Hello everyone\\\"},   {\\\"Name\\\":\\\"Sam\\\",\\\"Messsage\\\":\\\"Hello\\nEveery\\nOne\\\"}]\"\nvar pro Person\nerr := json.Unmarshal([]byte(s), &amp;pro)\nif err == nil {\nfmt.Printf(\"%+v\\n\", pro)\n} else {\nfmt.Println(err)\nfmt.Printf(\"%+v\\n\", err)\n}\n}\n</code></pre>\n\n<p>But I get the error:</p>\n\n<pre><code>ERROR invalid character '\\n' in string literal\n</code></pre>\n"}, {"tags": ["go", "interface", "type-assertion", "multiple-return-values"], "answers": [{"comments": [{"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 2, "creation_date": 1471357740, "post_id": 38977464, "comment_id": 65308032, "body": "IMO this example shows bad practice as we&#39;re making a type assertion without checking for an error, where the wrapping function gives the impression that it will return errors and not panic."}, {"owner": {"reputation": 759, "user_id": 607453, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f460ee15558ce3c81d2048c7778476a9?s=128&d=identicon&r=PG", "display_name": "raindog308", "link": "https://stackoverflow.com/users/607453/raindog308"}, "edited": false, "score": 0, "creation_date": 1471359195, "post_id": 38977464, "comment_id": 65309004, "body": "Thanks for the detailed explanation!  Also learned something on runtime panics from type assertions, which had been a worry in the back of my mind."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1471358561, "last_edit_date": 1495540849, "creation_date": 1471357339, "answer_id": 38977464, "question_id": 38977247, "link": "https://stackoverflow.com/questions/38977247/golang-can-you-type-a-returned-interface-in-one-statement/38977464#38977464", "title": "Golang: Can you type a returned interface{} in one statement?", "body": "<p>You can't. Best you can do is write a helper function (and do the type assertion in that):</p>\n\n<pre><code>func getDonut(p interface{}, err error) (Donut, error) {\n    return p.(Donut), err\n}\n</code></pre>\n\n<p>And then it becomes a one-line:</p>\n\n<pre><code>d, err := getDonut(getPastry())\n</code></pre>\n\n<p>Or you may even \"incorporate\" the <code>getPastry()</code> call in the helper function:</p>\n\n<pre><code>func getDonutPastry() (Donut, error) {\n    p, err := getPastry()\n    return p.(Donut), err\n}\n</code></pre>\n\n<p>And then calling it (an even shorter one-liner):</p>\n\n<pre><code>d, err := getDonutPastry()\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Of course if the value returned by <code>getPastry()</code> is not of dynamic type <code>Donut</code>, this will be a runtime panic. To prevent that, you may use the special form of the <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>:</p>\n\n<pre><code>v, ok := x.(T)\n</code></pre>\n\n<p>Which yields an additional untyped boolean value. The value of <code>ok</code> is <code>true</code> if the assertion holds. Otherwise it is <code>false</code> and the value of <code>v</code> is the zero value for type <code>T</code>. No run-time panic occurs in this case.</p>\n\n<p>Safe versions of the helper functions using the special form could look like this (they return an error rather than panic):</p>\n\n<pre><code>func getDonut2(p interface{}, err error) (Donut, error) {\n    if d, ok := p.(Donut); ok {\n        return d, err\n    } else {\n        return \"\", errors.New(\"Not a Donut!\")\n    }\n}\n\nfunc getDonutPastry2() (Donut, error) {\n    p, err := getPastry()\n    if d, ok := p.(Donut); ok {\n        return d, err\n    } else {\n        return \"\", errors.New(\"Not a Donut!\")\n    }\n}\n</code></pre>\n\n<p><strong>See related questions:</strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/28487036/return-map-like-ok-in-golang-on-normal-functions\">Return map like &#39;ok&#39; in Golang on normal functions</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/28227095/go-multiple-value-in-single-value-context\">Go: multiple value in single-value context</a></p>\n"}, {"tags": [], "owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "is_accepted": false, "score": 4, "last_activity_date": 1471357797, "last_edit_date": 1471357797, "creation_date": 1471357413, "answer_id": 38977500, "question_id": 38977247, "link": "https://stackoverflow.com/questions/38977247/golang-can-you-type-a-returned-interface-in-one-statement/38977500#38977500", "title": "Golang: Can you type a returned interface{} in one statement?", "body": "<p>Short answer: It's not possible.</p>\n\n<p>Long answer:<br>\nIt will be more readable and understandable by more people as there are no long lines chaining together many things.</p>\n\n<p>In your example, I'm assuming you will have to test for an error and then check for a Muffin etc.\nTo make it super clear which types you expect and what to do with them, you can do a type switch:</p>\n\n<pre><code>thisPastry, err := getPastry()\nif err != nil { ... }\n\nswitch v := thisPastry.(type) {\ncase Donut:\n    fmt.Println(v)\ncase Muffin:\n    fmt.Println(v, \"mmm!\")\ndefault:\n    // some kind of error?\n}\n</code></pre>\n"}], "owner": {"reputation": 759, "user_id": 607453, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f460ee15558ce3c81d2048c7778476a9?s=128&d=identicon&r=PG", "display_name": "raindog308", "link": "https://stackoverflow.com/users/607453/raindog308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 38977464, "answer_count": 2, "score": 4, "last_activity_date": 1471358813, "creation_date": 1471356737, "last_edit_date": 1471358813, "question_id": 38977247, "link": "https://stackoverflow.com/questions/38977247/golang-can-you-type-a-returned-interface-in-one-statement", "title": "Golang: Can you type a returned interface{} in one statement?", "body": "<p>Let's say I have this:</p>\n\n<pre><code>type Donut string\ntype Muffin string\n\nfunc getPastry () (interface{}, error) {\n  // some logic - this is contrived\n  var d Donut\n  d = \"Bavarian\"\n  return d, nil\n}\n</code></pre>\n\n<p>Is it possible to reduce this to one line:</p>\n\n<pre><code>p, err := getPastry()\nthisPastry := p.(Donut)\n</code></pre>\n\n<p>In other words, something like this, which does not compile:</p>\n\n<pre><code>thisPastry, err := getPastry().(Donut, error)\n</code></pre>\n\n<p>Not that having two lines of code to get the \"generic\" and type it is a big deal, but it just feels wasteful and un-simple to me, and that usually means I'm missing something obvious :-)</p>\n"}, {"tags": ["go", "synchronization", "closures", "channel", "goroutine"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1471354595, "post_id": 38976377, "comment_id": 65305890, "body": "there&#39;s not enough of your code here to tell the problem."}], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "edited": false, "score": 0, "creation_date": 1471354964, "post_id": 38976523, "comment_id": 65306165, "body": "Thank you @Baloo, but with break Loop, the main thread is waiting now."}], "tags": [], "owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "is_accepted": false, "score": 3, "last_activity_date": 1471355051, "last_edit_date": 1471355051, "creation_date": 1471354795, "answer_id": 38976523, "question_id": 38976377, "link": "https://stackoverflow.com/questions/38976377/reading-from-a-concurrent-function-via-channel-using-goroutine-and-a-closure-giv/38976523#38976523", "title": "Reading from a concurrent function via channel using goroutine and a closure giving error", "body": "<p>The <code>break</code> doesn't break the outer <code>for</code> loop.\nTo reference the outer loop, you can use a label like this:</p>\n\n<pre><code>Loop:\n    for {\n        select {\n            case ...:\n                break Loop\n        }\n    }\n</code></pre>\n\n<p>Also to help with the coding style,\nyou should practice using <a href=\"https://golang.org/cmd/gofmt/\" rel=\"nofollow\">gofmt</a> to format your code. It will for example replace <code>for ; ; { ... }</code> with the cleaner <code>for { ... }</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1471355780, "last_edit_date": 1471355780, "creation_date": 1471354966, "answer_id": 38976586, "question_id": 38976377, "link": "https://stackoverflow.com/questions/38976377/reading-from-a-concurrent-function-via-channel-using-goroutine-and-a-closure-giv/38976586#38976586", "title": "Reading from a concurrent function via channel using goroutine and a closure giving error", "body": "<p>The break statement breaks out of the inner most case, for or switch statement.  The function that receives on <code>somechan</code> spins in a loop decrementing the wait group when the channel closes.  Write the code like this:</p>\n\n<pre><code>wgread.Add(1)\ngo func() {\n    defer wgread.Done()\n    for chanoutput := range somechan {\n        fmt.Println(string(*chanoutput))\n    }\n    fmt.Println(\"DONE\")\n}()\nwgread.Wait()\n</code></pre>\n\n<p>If the receiving code is as written in the question, then the receiving goroutine can eliminated. Replace the code from <code>wgread.Add(1)</code> to <code>wgread.Wait()</code> with</p>\n\n<pre><code>for chanoutput := range somechan {\n    fmt.Println(string(*chanoutput))\n}\n</code></pre>\n"}], "owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 38976586, "answer_count": 2, "score": 1, "last_activity_date": 1471355780, "creation_date": 1471354397, "question_id": 38976377, "link": "https://stackoverflow.com/questions/38976377/reading-from-a-concurrent-function-via-channel-using-goroutine-and-a-closure-giv", "title": "Reading from a concurrent function via channel using goroutine and a closure giving error", "body": "<p>I have a function (not a closure) that is writing to a channel. I am invoking that function from a goroutine as</p>\n\n<pre><code>var wg sync.WaitGroup\nwg.Add(1)\ngo DoStuff(somechan, &amp;wg)\n</code></pre>\n\n<p>Inside DoStuff, I have something like</p>\n\n<pre><code>for ; ; {\n\n    if err == io.EOF { \n        fmt.Println(err)\n        close(somechan)\n        fmt.Println(\"Closed channel\")\n        break\n    } else if err != nil {\n        panic(err)\n    }\n    somechan &lt;- Somefunc()\n}\n</code></pre>\n\n<p>Now I am trying to read from that channel using another goroutine.</p>\n\n<pre><code>wgread.Add(1)\ngo func() {\n    for ; ; {\n        select {\n        case chanoutput, ok := &lt;-somechan:\n            if ok == true {\n                fmt.Println(string(*chanoutput))\n            } else {\n                fmt.Println(\"DONE\")\n                fmt.Println(ok)\n                wgread.Done()\n                break\n            }\n        }\n\n    }\n}()\nwgread.Wait()\n</code></pre>\n\n<p>However, when running, I am getting </p>\n\n<pre><code>panic: sync: negative WaitGroup counter\n</code></pre>\n\n<p>after printing </p>\n\n<pre><code>DONE\nfalse\nDONE\nfalse\n</code></pre>\n\n<p>If I give   wgread.Add(2), it will print the above DONE and false 3 times.</p>\n\n<p>Why is is giving a negative waitgroup counter error though I incremented the waitgroup delta by 1? What is the best way to read from a goroutine using another concurrent function or a closure?</p>\n"}, {"tags": ["json", "go", "type-conversion"], "comments": [{"owner": {"reputation": 965, "user_id": 6709663, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ec5f45f8412916ca4e0ddaa08e432b16?s=128&d=identicon&r=PG&f=1", "display_name": "qantik", "link": "https://stackoverflow.com/users/6709663/qantik"}, "reply_to_user": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471351253, "post_id": 38974961, "comment_id": 65303453, "body": "I have no control over the input. It&#39;s a struct containing a byte array. The above is just an illustration."}, {"owner": {"reputation": 965, "user_id": 6709663, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ec5f45f8412916ca4e0ddaa08e432b16?s=128&d=identicon&r=PG&f=1", "display_name": "qantik", "link": "https://stackoverflow.com/users/6709663/qantik"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471351870, "post_id": 38974961, "comment_id": 65303898, "body": "True that. Thank you."}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471353085, "post_id": 38974961, "comment_id": 65304834, "body": "was marked a duplicate but is not the same question, however similar"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471353385, "post_id": 38974961, "comment_id": 65305073, "body": "And why is it not the same? Because here <code>[]byte</code> is used, and <code>[]uint8</code> in the other question? <code>byte</code> is alias for <code>uint8</code>."}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471354207, "post_id": 38974961, "comment_id": 65305609, "body": "the use cases of the questions are different, but I guess if @quantik believes it answers his question it&#39;s a duplicate"}, {"owner": {"reputation": 965, "user_id": 6709663, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ec5f45f8412916ca4e0ddaa08e432b16?s=128&d=identicon&r=PG&f=1", "display_name": "qantik", "link": "https://stackoverflow.com/users/6709663/qantik"}, "edited": false, "score": 0, "creation_date": 1471354636, "post_id": 38974961, "comment_id": 65305914, "body": "They&#39;re very similar. According to the docs bytes are always converted during marshalling. Thus I should settle with an intermediate struct to avoid the problem."}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471355497, "post_id": 38974961, "comment_id": 65306493, "body": "You can also define a new type which implements the Marshaler interface,       type fooBytes []byte      func (fb fooBytes) MarshalJSON() ([]byte, error) {         b := []int{}         for n := 0; n &lt; len(fb); n++ {             b = append(b, int(fb[n]))         }         return json.Marshal(b) }"}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471355512, "post_id": 38974961, "comment_id": 65306503, "body": "if the issue wasn&#39;t closed, I could show the full example :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "edited": false, "score": 0, "creation_date": 1471355592, "post_id": 38974961, "comment_id": 65306547, "body": "@baloo But a full example of your proposal is in the answer to the marked duplicate question."}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471355730, "post_id": 38974961, "comment_id": 65306638, "body": "@icza how does that comment add any value?"}], "owner": {"reputation": 965, "user_id": 6709663, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ec5f45f8412916ca4e0ddaa08e432b16?s=128&d=identicon&r=PG&f=1", "display_name": "qantik", "link": "https://stackoverflow.com/users/6709663/qantik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 1, "closed_date": 1471351919, "answer_count": 0, "score": 0, "last_activity_date": 1471350446, "creation_date": 1471350446, "question_id": 38974961, "link": "https://stackoverflow.com/questions/38974961/golang-json-marshal-byte-array", "closed_reason": "Duplicate", "title": "Golang Json Marshal Byte Array", "body": "<p>is there a way to preserve the string representation of a byte array when\nthe surrounding struct is marshalled using the Golang JSON library?\nThe problem does not occur with integer types.</p>\n\n<p>Example:</p>\n\n<pre><code>type foo struct {\n    Array   []byte\n    Name    string\n}\n\nfunc main() {\n    tmp := foo{Array: []byte{1, 2, 3}, Name: \"EPFL\"}\n    mar, _ := json.Marshal(tmp)\n    fmt.Println(string(mar))\n}\n</code></pre>\n\n<p>Should output</p>\n\n<pre><code>{\"Array\":[1,2,3],\"Name\":\"EPFL\"}\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>{\"Array\":\"AQID\",\"Name\":\"EPFL\"}\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["sql", "go", "garbage-collection"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 34, "last_activity_date": 1563683522, "last_edit_date": 1563683522, "creation_date": 1471342021, "answer_id": 38972057, "question_id": 38972003, "link": "https://stackoverflow.com/questions/38972003/how-to-stop-the-golang-gc-and-trigger-it-manually/38972057#38972057", "title": "How to stop the golang gc and trigger it manually?", "body": "<p>Package documentation of <a href=\"https://golang.org/pkg/runtime/\" rel=\"noreferrer\"><code>runtime</code></a> contains all the details you need:</p>\n\n<blockquote>\n  <p>The GOGC variable sets the initial garbage collection target percentage. A collection is triggered when the ratio of freshly allocated data to live data remaining after the previous collection reaches this percentage. The default is GOGC=100. <strong>Setting GOGC=off disables the garbage collector entirely.</strong> The runtime/debug package's SetGCPercent function allows changing this percentage at run time. See <a href=\"https://golang.org/pkg/runtime/debug/#SetGCPercent\" rel=\"noreferrer\">https://golang.org/pkg/runtime/debug/#SetGCPercent</a>.</p>\n</blockquote>\n\n<p>So you may set the environment variable <code>GOGC</code> to a percent which is the ratio of freshly allocated data to live data remaining after the previous collection.</p>\n\n<p>When the above data ratio reaches the value of <code>GOGC</code>, a (garbage) collection is initiated.  The initial setting is taken from the <code>GOGC</code> env variable, or <code>100</code> if the variable is not set. The value <code>off</code> disables garbage collection.</p>\n\n<p>At runtime you can change the <code>GOGC</code> ratio by calling <a href=\"https://golang.org/pkg/runtime/debug/#SetGCPercent\" rel=\"noreferrer\"><code>debug.SetGCPercent()</code></a>, pass a negative value to disable it:</p>\n\n<pre><code>debug.SetGCPercent(-1)\n</code></pre>\n\n<p>You may trigger a garbage collection \"manually\" with <a href=\"https://golang.org/pkg/runtime/#GC\" rel=\"noreferrer\"><code>runtime.GC()</code></a>.</p>\n\n<p>Completely disabling GC might not be what you want though. Read the complete package doc of <code>runtime</code> where you find details about how to fine-tune GC and how to trace GC runs. Analyze them and act accordingly.</p>\n\n<p>Also note that <a href=\"https://blog.golang.org/go1.7\" rel=\"noreferrer\">Go 1.7</a> was released today with improved garbage collector:</p>\n\n<blockquote>\n  <p>Programs should run a bit faster due to speedups in the garbage collector and optimizations in the standard library. Programs with many idle goroutines will experience much shorter garbage collection pauses than in Go 1.6.</p>\n</blockquote>\n\n<p>If you haven't, first test your application compiled with Go 1.7 before taking any further action.</p>\n"}], "owner": {"reputation": 191, "user_id": 6721168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a137450faa560df194697b44081bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Han Fei", "link": "https://stackoverflow.com/users/6721168/han-fei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21545, "favorite_count": 11, "answer_count": 1, "score": 18, "last_activity_date": 1563683522, "creation_date": 1471341856, "last_edit_date": 1471401301, "question_id": 38972003, "link": "https://stackoverflow.com/questions/38972003/how-to-stop-the-golang-gc-and-trigger-it-manually", "title": "How to stop the golang gc and trigger it manually?", "body": "<p>Currently I'm supporting big table join on a database written in golang. But the gc costs too much time. I want to close the go gc and trigger it manually. How to config the go build args?</p>\n"}, {"tags": ["json", "function", "dictionary", "go"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 2, "last_activity_date": 1471344986, "creation_date": 1471344986, "answer_id": 38973067, "question_id": 38971542, "link": "https://stackoverflow.com/questions/38971542/golang-function-call-in-map/38973067#38973067", "title": "Golang Function Call in Map", "body": "<p>There is no direct way to parse a function directly from a JSON value. Also, you cannot use string values to refer to variables. So a string <code>check_cpu</code> would not be able to refer to the function with the same name directly.</p>\n\n<p>What you can do instead is parse the json string as is and have a global map for functions. That way, you can call your functions like so:</p>\n\n<pre><code>var funcMap = map[string]pluginfunc{\n    \"check_disk\": check_disk,\n    \"check_cpu\": check_cpu\n}\n</code></pre>\n\n<p>In your <code>main</code> loop:</p>\n\n<pre><code>for index, funcname := range func1.Templateitems.Checkmethod {\n        fmt.Printf(\"%d = %s\\n\", index, funcMap[funcname]())\n}\n</code></pre>\n\n<p>If however, you really need to put the value in your structure, you can try implementing <code>UnmarshalJSON</code> from the <code>json.Unmarshaler</code> interface. A simple example would be:</p>\n\n<pre><code>type pf map[string]pluginfunc\n\ntype Plugindata struct {\n        Template string `json:\"template\"`\n        Checkname []string `json:\"checkname\"`\n        Checkmethod pf `json:\"checkmethod\"`\n}\n\nfunc (p *pf) UnmarshalJSON(data []byte) error {\n    d := []string{}\n    if err := json.Unmarshal(data, &amp;d); err != nil {\n        return err\n    }\n    *p = make(pf)\n    for _, s := range d {\n        (*p)[s] = funcMap[s]\n    }\n    return nil\n}\n\nvar funcMap = pf{\n    \"check_disk\": check_disk,\n    \"check_cpu\": check_cpu\n}\n\nfunc main() {\n    json.Unmarshal(tdata, &amp;Templateitems)\n    for k, f := range Templateitems.Checkmethod {\n        fmt.Printf(\"%s -- %s\\n\", k, f())\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/n1mDMfK8py\" rel=\"nofollow\">Working code</a></p>\n\n<p>Note that this way is not as readable or simple as the first method and it still relies on a function map.</p>\n\n<p>You can read more about <code>json.Unmarshaler</code> <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 1665065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e681eceb05d4b9316473b506d0e2e4?s=128&d=identicon&r=PG", "display_name": "user1665065", "link": "https://stackoverflow.com/users/1665065/user1665065"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471344986, "creation_date": 1471340603, "last_edit_date": 1471342724, "question_id": 38971542, "link": "https://stackoverflow.com/questions/38971542/golang-function-call-in-map", "title": "Golang Function Call in Map", "body": "<p>I am a newbie at GO Programming.  Here is scenario :-</p>\n\n<p>There exists a JSON file that looks like this :-</p>\n\n<pre><code>{\n        \"template\": \"linuxbase1\",\n        \"checkname\": [\"check_disk\"],\n        \"checkmethod\": [\"check_disk\"]\n}\n</code></pre>\n\n<p>I am Unmarshalling this data into a structure :-</p>\n\n<pre><code>package func1\n\nimport (\n        \"io/ioutil\"\n        \"os\"\n        \"encoding/json\"\n        \"fmt\"\n)\n\ntype pluginfunc func() string\ntype Plugindata struct {\n        Template string `json:\"template\"`\n        Checkname []string `json:\"checkname\"`\n        Checkmethod []pluginfunc `json:\"checkmethod\"`\n}\n\nvar (\n        Templatepath = \"json_sample1.json\"\n        Templateitems Plugindata\n)\n\nfunc Gettemplatedata() {\n        tdata, err := ioutil.ReadFile(Templatepath)\n        if err != nil {\n                fmt.Printf(\"Unable to read file %s. Error - %v\\n\",Templatepath, err.Error())\n                os.Exit(3)\n        }\n        json.Unmarshal(tdata, &amp;Templateitems)\n}\n</code></pre>\n\n<p>The \"check_disk\" function is here :-</p>\n\n<pre><code>package func1\n\nfunc check_disk() string {\n        return \"Called check_disk\"\n}\n</code></pre>\n\n<p>This is the program with main() :-</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"checksexpt/func1\"\n)\n\nfunc main() {\n        func1.Gettemplatedata()\n        fmt.Printf(\"Templateitems in Main() =&gt; %v\\n\",func1.Templateitems)\n        for index,funcname := range func1.Templateitems.Checkmethod {\n                fmt.Printf(\"%d = %s\\n\",index,funcname())\n        }\n\n}\n</code></pre>\n\n<p>As expected, when I run main(); I see the error :-</p>\n\n<pre><code>Templateitems in Main() =&gt; {linuxbase1 [check_cpu check_disk] [&lt;nil&gt; &lt;nil&gt;]}\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x40115e]\n\ngoroutine 1 [running]:\npanic(0x50e980, 0xc82000a100)\n        /opt/go/src/runtime/panic.go:481 +0x3e6\n</code></pre>\n\n<p>So, I am trying to grab a string from the JSON file and treat it as a function call. That obviously fails !  But, the primary constraint here is that the function names have to be picked from the JSON file. How can I do this ?  I know that I can create a static map as follows :-</p>\n\n<pre><code>type checkfunc func() string\nvar (\n        Templateitems = map[string]map[string]checkfunc {\n                \"linuxbase1\": {\n                        \"check_disk\": check_disk,\n                },\n        }\n)\n</code></pre>\n\n<p>So, A call like - <code>Templateitems[\"linuxbase1\"][\"check_disk\"]()</code> would work just fine. But, I dont want to create any such static map as the elements in that map needs to keep growing. Any ideas on this?</p>\n"}, {"tags": ["arrays", "loops", "go"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471342927, "post_id": 38972058, "comment_id": 65298099, "body": "<a href=\"https://play.golang.org/p/E7yt3p0BbC\" rel=\"nofollow noreferrer\">play.golang.org/p/E7yt3p0BbC</a>, this is the code i have and i get this index out range error i cant understand why, In my previous questions i mentioned about what I&#39;m working on, It would be great if you can help.. @Roman Khimov"}], "tags": [], "owner": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "is_accepted": true, "score": 0, "last_activity_date": 1471342022, "creation_date": 1471342022, "answer_id": 38972058, "question_id": 38971143, "link": "https://stackoverflow.com/questions/38971143/accessing-array-elements-individually-in-golang/38972058#38972058", "title": "Accessing array elements individually in Golang", "body": "<p>On your last iteration (when <code>j == len(currentarray) - 1</code> which is 7) you're accessing <code>currentarray[7]</code> and then if that equals zero trying to access <code>currentarray[8]</code> which is out of range for <code>[8]int</code>.</p>\n\n<p>The fix depends on the intended behaviour, it might be that you need to fix your loop invariant to be <code>j &lt; len(currentarray) - 1</code>, or, if you want to treat your array in a circular way, you may want to do <code>Sourceposition = currentarray[(j + 1) % len(currentarray)]</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 38972058, "answer_count": 1, "score": 1, "last_activity_date": 1471342022, "creation_date": 1471339498, "last_edit_date": 1471340893, "question_id": 38971143, "link": "https://stackoverflow.com/questions/38971143/accessing-array-elements-individually-in-golang", "title": "Accessing array elements individually in Golang", "body": "<p>I know this is very basic but i want to know how to access elements individually,the values of Sourceposition and currentarray keep changing, this operation is apart of recursive function.</p>\n\n<p>For example: </p>\n\n<pre><code> var Sourceposition int\n\nvar currentarray [8]int\n\nfor j:=0;j&lt;len(currentarray);j++\n{\n  if currentarray[j]==0{\n  Sourceposition = currentarray[j+1]}\nfmt.Pritnln(Sourceposition)\n}\n\n//random statements\n</code></pre>\n\n<p>this gives me a error index out of range, Can someone help me , how to this calculation.</p>\n"}, {"tags": ["go", "consul"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1471339266, "post_id": 38971036, "comment_id": 65295763, "body": "Have you tried listening on 0.0.0.0?"}, {"owner": {"reputation": 3063, "user_id": 450598, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/780c14039de44c48349f578fdcfa66e0?s=128&d=identicon&r=PG", "display_name": "soupdiver", "link": "https://stackoverflow.com/users/450598/soupdiver"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1471339373, "post_id": 38971036, "comment_id": 65295837, "body": "You can&#39;t listen on <code>0.0.0.0</code>. This results in: <code>Failed to get advertise address: Multiple private IPs found. Please configure one.</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2430, "user_id": 1762493, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pEEmF.jpg?s=128&g=1", "display_name": "Mikeumus", "link": "https://stackoverflow.com/users/1762493/mikeumus"}, "is_accepted": false, "score": 0, "last_activity_date": 1517546057, "creation_date": 1517546057, "answer_id": 48575747, "question_id": 38971036, "link": "https://stackoverflow.com/questions/38971036/consul-agent-started-programmatically-does-not-open-http-port/48575747#48575747", "title": "Consul agent started programmatically does not open HTTP port", "body": "<p>Make sure all the required ports are open too:</p>\n\n<ul>\n<li>Server RPC (Default 8300)</li>\n<li>Serf LAN (Default 8301)</li>\n<li>Serf WAN (Default 8302)</li>\n<li>HTTP API (Default 8500)</li>\n<li>DNS Interface (Default 8600)</li>\n</ul>\n\n<p>From Consul docs:\n<a href=\"https://www.consul.io/docs/agent/options.html#ports-used\" rel=\"nofollow noreferrer\">https://www.consul.io/docs/agent/options.html#ports-used</a></p>\n"}], "owner": {"reputation": 3063, "user_id": 450598, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/780c14039de44c48349f578fdcfa66e0?s=128&d=identicon&r=PG", "display_name": "soupdiver", "link": "https://stackoverflow.com/users/450598/soupdiver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517546057, "creation_date": 1471339157, "question_id": 38971036, "link": "https://stackoverflow.com/questions/38971036/consul-agent-started-programmatically-does-not-open-http-port", "title": "Consul agent started programmatically does not open HTTP port", "body": "<p>I try to start a Consul agent using their Golang <a href=\"http://github.com/hashicorp/consul/command/agent\" rel=\"nofollow\">package</a>.\nThe server itself comes up but I can't interact with it because it does not start to listen for incoming HTTP requests.</p>\n\n<p>My code to start the agent:</p>\n\n<pre><code>//create the logwriter\nwriter := bytes.NewBuffer(server.log)\n\nagentConfig := agent.DefaultConfig()\nagentConfig.BindAddr = \"127.0.0.1\"\nagentConfig.DevMode = true\nagentConfig.Bootstrap = true\nagentConfig.Server = true\nagentConfig.DataDir = \"/tmp\"\nagentConfig.Ports.HTTP = 8500\nagentConfig.Ports.HTTPS = -1\n//agentConfig.AdvertiseAddr = \"127.0.0.1\"\n//agentConfig.EnableUi = true\nagentConfig.Addresses.HTTP = \"127.0.0.1\"\n\nglog.Infof(\"Agent config: %+v\", agentConfig)\n\nagent, err := agent.Create(agentConfig, writer)\nif err != nil {\n    t.Fatalf(\"Error starting consul agent: %v\", err)\n}\n</code></pre>\n\n<p>The resulting configuration on start looks like:</p>\n\n<pre><code>Agent config: &amp;{DevMode:true Bootstrap:true BootstrapExpect:0\nServer:true Datacenter:dc1 DataDir:/tmp DNSRecursor: DNSRecursors:[]  DNSConfig:{NodeTTL:0 NodeTTLRaw: ServiceTTL:map[] ServiceTTLRaw:map[] \nAllowStale:false EnableTruncate:false UDPAnswerLimit:3 MaxStale:5s \nMaxStaleRaw: OnlyPassing:false} Domain:consul. EncryptKey: \nLogLevel:INFO NodeName: ClientAddr:127.0.0.1 BindAddr:127.0.0.1 \nAdvertiseAddr: AdvertiseAddrs:{SerfLan:&lt;nil&gt; SerfLanRaw: SerfWan:&lt;nil&gt; \nSerfWanRaw: RPC:&lt;nil&gt; RPCRaw:} AdvertiseAddrWan: \nTranslateWanAddrs:false Ports:{DNS:8600 HTTP:8500 HTTPS:-1 RPC:8400 \nSerfLan:8301 SerfWan:8302 Server:8300} Addresses:{DNS: HTTP:127.0.0.1 \nHTTPS: RPC:} TaggedAddresses:map[] LeaveOnTerm:false SkipLeaveOnInt:\n&lt;nil&gt; Telemetry:{StatsiteAddr: StatsdAddr: StatsitePrefix:consul \nDisableHostname:false DogStatsdAddr: DogStatsdTags:[]} Protocol:2 \nEnableDebug:false VerifyIncoming:false VerifyOutgoing:false VerifyServerHostname:false CAFile: CertFile: KeyFile: ServerName: \nStartJoin:[] StartJoinWan:[] RetryJoin:[] RetryMaxAttempts:0 \nRetryInterval:30s RetryIntervalRaw: RetryJoinWan:[] \nRetryMaxAttemptsWan:0 RetryIntervalWan:30s RetryIntervalWanRaw: \nReconnectTimeoutLan:0 ReconnectTimeoutLanRaw: ReconnectTimeoutWan:0 \nReconnectTimeoutWanRaw: EnableUi:false UiDir: PidFile: \nEnableSyslog:false SyslogFacility:LOCAL0 RejoinAfterLeave:false \nCheckUpdateInterval:5m0s CheckUpdateIntervalRaw: ACLToken: \nACLMasterToken: ACLDatacenter: ACLTTL:30s ACLTTLRaw: \nACLDefaultPolicy:allow ACLDownPolicy:extend-cache Watches:[] \nDisableRemoteExec:false DisableUpdateCheck:false \nDisableAnonymousSignature:false HTTPAPIResponseHeaders:map[] \nAtlasInfrastructure: AtlasToken: AtlasACLToken: AtlasJoin:false \nAtlasEndpoint: AEInterval:1m0s DisableCoordinates:false \nSyncCoordinateRateTarget:64 SyncCoordinateIntervalMin:15s Checks:[] \nServices:[] ConsulConfig:&lt;nil&gt; Revision: Version: VersionPrerelease: \nWatchPlans:[] UnixSockets:{UnixSocketPermissions:{Usr: Grp: Perms:}} \nSessionTTLMin:0 SessionTTLMinRaw: Reap:&lt;nil&gt;}\n</code></pre>\n\n<p>Checking my open ports I can see that the agent is up but not listening for HTTP</p>\n\n<pre><code>storage.t 16820  felix    5u  IPv4 469866      0t0  TCP localhost:8300 (LISTEN)\nstorage.t 16820  felix    6u  IPv4 469867      0t0  TCP localhost:8301 (LISTEN)\nstorage.t 16820  felix    7u  IPv4 469868      0t0  UDP localhost:8301\nstorage.t 16820  felix    8u  IPv4 469869      0t0  TCP localhost:8302 (LISTEN)\nstorage.t 16820  felix    9u  IPv4 469870      0t0  UDP localhost:8302\n</code></pre>\n\n<p>Every tip to get that running is appreciated :)</p>\n"}, {"tags": ["go", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 1683, "user_id": 862763, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e7de5dad6c72ebdadbf4f6b69268c4d0?s=128&d=identicon&r=PG", "display_name": "alpha_cod", "link": "https://stackoverflow.com/users/862763/alpha-cod"}, "edited": false, "score": 0, "creation_date": 1471431103, "post_id": 38974969, "comment_id": 65340891, "body": "Thanks for the help. Could you give me an example of how to do this?"}, {"owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "reply_to_user": {"reputation": 1683, "user_id": 862763, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e7de5dad6c72ebdadbf4f6b69268c4d0?s=128&d=identicon&r=PG", "display_name": "alpha_cod", "link": "https://stackoverflow.com/users/862763/alpha-cod"}, "edited": false, "score": 0, "creation_date": 1471431351, "post_id": 38974969, "comment_id": 65341050, "body": "@alpha_cod See the link above and then click Example on that page. You simply have to adapt that to the gin framework if you really need to use their router."}], "tags": [], "owner": {"reputation": 7171, "user_id": 330777, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71b71dc18da5a52f1f15f16af523fcab?s=128&d=identicon&r=PG", "display_name": "baloo", "link": "https://stackoverflow.com/users/330777/baloo"}, "is_accepted": true, "score": 3, "last_activity_date": 1471350477, "creation_date": 1471350477, "answer_id": 38974969, "question_id": 38970561, "link": "https://stackoverflow.com/questions/38970561/golang-gin-gonic-web-framework-proxy-route-to-another-backend/38974969#38974969", "title": "Golang gin gonic web framework proxy route to another backend", "body": "<p>You can do this with the standard library <a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow\">httputil.ReverseProxy</a>.</p>\n\n<p>I haven't found a reason to use gin myself yet, I'm a fan of sticking to stdlib whenever possible.\nHowever I believe you can wrap this ReverseProxy handler in <code>gin.WrapH()</code> to be able to use it with your gin router.</p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 405407, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e717c3a27e45887c4578f649f4e6c86e?s=128&d=identicon&r=PG", "display_name": "chinuy", "link": "https://stackoverflow.com/users/405407/chinuy"}, "edited": false, "score": 7, "creation_date": 1518113996, "post_id": 39009974, "comment_id": 84382728, "body": "I got this error message <code>http: proxy error: unsupported protocol scheme &quot;&quot;</code>. I need to comment out <code>req = r</code> so the reverse proxy will work."}], "tags": [], "owner": {"reputation": 1683, "user_id": 862763, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e7de5dad6c72ebdadbf4f6b69268c4d0?s=128&d=identicon&r=PG", "display_name": "alpha_cod", "link": "https://stackoverflow.com/users/862763/alpha-cod"}, "is_accepted": false, "score": 8, "last_activity_date": 1471494209, "creation_date": 1471494209, "answer_id": 39009974, "question_id": 38970561, "link": "https://stackoverflow.com/questions/38970561/golang-gin-gonic-web-framework-proxy-route-to-another-backend/39009974#39009974", "title": "Golang gin gonic web framework proxy route to another backend", "body": "<p>This was the solution I used for reverse-proxying a specific subset of endpoints from gin framework to another backend:</p>\n\n<pre><code>router.POST(\"/api/v1/endpoint1\", ReverseProxy()\n\nfunc ReverseProxy() gin.HandlerFunc {\n\n    target := \"localhost:3000\"\n\n    return func(c *gin.Context) {\n        director := func(req *http.Request) {\n            r := c.Request\n            req = r\n            req.URL.Scheme = \"http\"\n            req.URL.Host = target\n            req.Header[\"my-header\"] = []string{r.Header.Get(\"my-header\")}\n            // Golang camelcases headers\n            delete(req.Header, \"My-Header\")\n        }\n        proxy := &amp;httputil.ReverseProxy{Director: director}\n        proxy.ServeHTTP(c.Writer, c.Request)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13598024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GimMTfeePAIyTUjTQC0iNImr3L7YB7bewFO5XiA=k-s128", "display_name": "kaynAw", "link": "https://stackoverflow.com/users/13598024/kaynaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1590167106, "creation_date": 1590167106, "answer_id": 61960275, "question_id": 38970561, "link": "https://stackoverflow.com/questions/38970561/golang-gin-gonic-web-framework-proxy-route-to-another-backend/61960275#61960275", "title": "Golang gin gonic web framework proxy route to another backend", "body": "<p>when you use director:</p>\n\n<pre><code>req.URL.Scheme = \"http\"\nreq.Host, req.URL.Host = \"google.com\", \"google.com\"\n</code></pre>\n"}], "owner": {"reputation": 1683, "user_id": 862763, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e7de5dad6c72ebdadbf4f6b69268c4d0?s=128&d=identicon&r=PG", "display_name": "alpha_cod", "link": "https://stackoverflow.com/users/862763/alpha-cod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5217, "favorite_count": 1, "accepted_answer_id": 38974969, "answer_count": 3, "score": 7, "last_activity_date": 1590167106, "creation_date": 1471337788, "last_edit_date": 1489349827, "question_id": 38970561, "link": "https://stackoverflow.com/questions/38970561/golang-gin-gonic-web-framework-proxy-route-to-another-backend", "title": "Golang gin gonic web framework proxy route to another backend", "body": "<p>How to reverse proxy web requests for a few routes to another backend in <a href=\"https://gin-gonic.github.io/gin/\" rel=\"noreferrer\">Gin Gonic</a> web golang framework</p>\n\n<p>Is there a way to directly forward in the Handle function as shown below?</p>\n\n<p><code>\nrouter := gin.New()\nrouter.Handle(\"POST\", \"/api/v1/endpoint1\", ForwardToAnotherBackend)\n</code></p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471340766, "post_id": 38970180, "comment_id": 65296788, "body": "your <code>go get -u -v github.com&#47;gin-gonic&#47;gin</code>  fetch failed:  Are you having proxy or internet connection problem ? try it again"}, {"owner": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "edited": false, "score": 0, "creation_date": 1471389903, "post_id": 38970180, "comment_id": 65324606, "body": "oh,  I tried it again and there are no errors. but still it doesn&#39;t work..."}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "edited": false, "score": 0, "creation_date": 1471337827, "post_id": 38970414, "comment_id": 65294859, "body": "Thanks. I put correct source code and error again. But still getting the same error. hmmm, It looks depends on the Go version???"}, {"owner": {"reputation": 76, "user_id": 5622965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1d4bd0043fa0c623d339a9541b0b13?s=128&d=identicon&r=PG&f=1", "display_name": "sophisticasean", "link": "https://stackoverflow.com/users/5622965/sophisticasean"}, "reply_to_user": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "edited": false, "score": 0, "creation_date": 1471338121, "post_id": 38970414, "comment_id": 65295036, "body": "Yeah, I&#39;d try to downgrade. I didn&#39;t see any information regarding the specific version of golang gin is confirmed for."}], "tags": [], "owner": {"reputation": 76, "user_id": 5622965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1d4bd0043fa0c623d339a9541b0b13?s=128&d=identicon&r=PG&f=1", "display_name": "sophisticasean", "link": "https://stackoverflow.com/users/5622965/sophisticasean"}, "is_accepted": false, "score": 0, "last_activity_date": 1471337356, "creation_date": 1471337356, "answer_id": 38970414, "question_id": 38970180, "link": "https://stackoverflow.com/questions/38970180/golang-gin-c-param-undefined-type-gin-context-has-no-field-or-method-param/38970414#38970414", "title": "Golang Gin &quot;c.Param undefined (type *gin.Context has no field or method Param)&quot;", "body": "<p>I got this working, but I had to import the http package:</p>\n\n<pre><code>package main\n\nimport \"github.com/gin-gonic/gin\"\nimport \"net/http\"\n\nfunc main() {\nrouter := gin.Default()\n\nrouter.GET(\"/user/:name\", func(c *gin.Context) {\n    name := c.Param(\"name\")\n    c.String(http.StatusOK, \"Hello %s\", name)\n    })\n\nrouter.Run(\":8080\")\n}\n</code></pre>\n\n<p><code>go version</code> returns <code>go version go1.5.3 linux/amd64</code> for me.</p>\n\n<p>It seems your error was on line 19 of your gin.go as per './main.go:19: c.Param undefined' what are the other lines in the script? </p>\n\n<p>The provided script is only 14 lines long.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 1, "creation_date": 1471338761, "post_id": 38970791, "comment_id": 65295436, "body": "@k16  I hope this helps."}, {"owner": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "edited": false, "score": 0, "creation_date": 1471340097, "post_id": 38970791, "comment_id": 65296348, "body": "thank you. I added the message to the original form. As I wrote it doesn&#39;t work. I think my docker environment something wrong, but also I don&#39;t think it depends on the server environment. it&#39;s weird. @Amd"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1475078521, "last_edit_date": 1475078521, "creation_date": 1471338461, "answer_id": 38970791, "question_id": 38970180, "link": "https://stackoverflow.com/questions/38970180/golang-gin-c-param-undefined-type-gin-context-has-no-field-or-method-param/38970791#38970791", "title": "Golang Gin &quot;c.Param undefined (type *gin.Context has no field or method Param)&quot;", "body": "<p>Edit:\nThe OP had \"vendor dir created by the Glide\" with old version of package.\nand problem solved by removing that folder (updating vendor package).</p>\n\n<p><a href=\"https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies\" rel=\"nofollow\">Note</a>: <code>go get</code> never checks out or updates code stored in vendor directories.</p>\n\n<hr>\n\n<p><code>c.Param(key)</code> is a shortcut for <code>c.Params.ByName(key)</code>, see <code>c.Param(key)</code> Docs:</p>\n\n<blockquote>\n<pre><code>// Param returns the value of the URL param.\n// It is a shortcut for c.Params.ByName(key)\n//        router.GET(\"/user/:id\", func(c *gin.Context) {\n//            // a GET request to /user/john\n//            id := c.Param(\"id\") // id == \"john\"\n//        })\nfunc (c *Context) Param(key string) string {\n  return c.Params.ByName(key)\n}\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>You need to update  <code>github.com/gin-gonic/gin</code> package, try: </p>\n\n<pre><code>go get -u github.com/gin-gonic/gin\n</code></pre>\n\n<p>And make sure there aren't any <code>vendor</code> and  try remove all files and vendor dir except <code>main.go</code> then <code>go build</code> (or update your vendor package).</p>\n\n<hr>\n\n<p>Your code works fine in <code>go1.7</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"net/http\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    router := gin.Default()\n\n    router.GET(\"/user/:name\", func(c *gin.Context) {\n        name := c.Param(\"name\")\n        c.String(http.StatusOK, \"Hello %s\", name)\n    })\n\n    router.Run(\":8080\")\n}\n</code></pre>\n\n<p>Open in browser <code>http://127.0.0.1:8080/user/World</code><br>\noutput:</p>\n\n<pre><code>Hello World\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471400919, "post_id": 38986763, "comment_id": 65326967, "body": "the path <code>&#47;go&#47;myproject&#47;src&#47;server&#47;main.go</code> is OK, what is the  error ?"}, {"owner": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "edited": false, "score": 0, "creation_date": 1471401786, "post_id": 38986763, "comment_id": 65327162, "body": "thank you. hmmm, the error means &quot; c.Param undefined (type *gin.Context has no field or method Param)&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471402054, "post_id": 38986763, "comment_id": 65327215, "body": "is <code>main.go</code> the only file inside <code>&#47;go&#47;myproject&#47;src&#47;s\u200c\u200berver&#47;</code> or there is another <code>*.go</code> file inside <code>&#47;go&#47;myproject&#47;src&#47;s\u200c\u200berver&#47;</code>?"}, {"owner": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "edited": false, "score": 0, "creation_date": 1471402644, "post_id": 38986763, "comment_id": 65327360, "body": "Yes, I put the additional information to this form which is below &quot;added2&quot;. Actually, I have only main.go."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471403538, "post_id": 38986763, "comment_id": 65327585, "body": "What&#39;s inside <code>vendor</code>, try remove all files and <code>vendor</code> dir   except <code>main.go</code>  then <code>go build</code>, is this OK? if so problem is vendor."}, {"owner": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "edited": false, "score": 1, "creation_date": 1471406201, "post_id": 38986763, "comment_id": 65328175, "body": "Awesome, it works. you are right. Thank you. vendor dir is created by the Glide. I wanted to manage packages in my project, so I tried to use the Glide. I guess probably the Gin can not read it selves packages downloaded by the Glide??? hmmm, I have another trouble. lol. I will try to use other package manager. anyway thank you for your greate help @Amd ."}], "tags": [], "owner": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "is_accepted": false, "score": 0, "last_activity_date": 1471403025, "last_edit_date": 1471403025, "creation_date": 1471396858, "answer_id": 38986763, "question_id": 38970180, "link": "https://stackoverflow.com/questions/38970180/golang-gin-c-param-undefined-type-gin-context-has-no-field-or-method-param/38986763#38986763", "title": "Golang Gin &quot;c.Param undefined (type *gin.Context has no field or method Param)&quot;", "body": "<p>I got the success.</p>\n\n<p>The reason why is my directory depth.\nI put the main.go at \"/go/myproject/src/server/main.go\" and set \"export GOPATH=/go/myproject\".</p>\n\n<p>In this case, I got the error.\nBut after I changed the path of main.go at \"/go/myproject/src/main.go\", it works.</p>\n\n<p>I was wondering that I didn't think that my directory structure is wrong.\nI can put the main.go any depth, can't I ?   </p>\n\n<p>Added2</p>\n\n<pre><code># pwd\n/go/myproject/src/server\n# ls -l\ntotal 12\n-rw-r--r-- 1 1000 ftp 633  8\u6708 17 02:52 glide.lock\n-rw-r--r-- 1 1000 ftp  78  8\u6708 17 02:51 glide.yaml\n-rw-r--r-- 1 1000 ftp 254  8\u6708 17 02:51 main.go\ndrwxr-xr-x 1 1000 ftp 136  8\u6708 17 02:52 vendor\n# go run main.go\n# command-line-arguments\n./main.go:12: c.Param undefined (type *gin.Context has no field or method Param)\n# cat main.go\npackage main\n\nimport (\n        \"github.com/gin-gonic/gin\"\n        \"net/http\"\n)\n\nfunc main() {\n        router := gin.Default()\n\n        router.GET(\"/user/:name\", func(c *gin.Context) {\n            name := c.Param(\"name\")\n            c.String(http.StatusOK, \"Hello %s\", name)\n        })\n\n        router.Run(\":8080\")\n}\n</code></pre>\n\n<p>But when I don't call the param function, like this , Gin looks working.</p>\n\n<pre><code># cat main.go\npackage main\n\nimport \"github.com/gin-gonic/gin\"\n\nfunc main() {\n        r := gin.Default()\n        r.GET(\"/ping\", func(c *gin.Context) {\n            c.JSON(200, gin.H{\n                \"message\": \"pong\",\n            })\n        })\n        r.Run(\":8080\")\n}\n# go run main.go\n[GIN-debug] GET   /ping                     --&gt; main.main.func1 (3 handlers)\n[GIN-debug] Listening and serving HTTP on :8080\n[GIN] 2016/08/17 - 03:01:17 | 200 |     79.238\u00b5s | [::1]:41546 |   GET     /ping\n</code></pre>\n\n<p>The main.go is set at same place.</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 1098522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe0f75dc7f344999f09d2fe8d5a3e89a?s=128&d=identicon&r=PG", "display_name": "nxvl", "link": "https://stackoverflow.com/users/1098522/nxvl"}, "is_accepted": false, "score": 0, "last_activity_date": 1472668287, "creation_date": 1472668287, "answer_id": 39256645, "question_id": 38970180, "link": "https://stackoverflow.com/questions/38970180/golang-gin-c-param-undefined-type-gin-context-has-no-field-or-method-param/39256645#39256645", "title": "Golang Gin &quot;c.Param undefined (type *gin.Context has no field or method Param)&quot;", "body": "<p>Got the same problem. Glide now tries to use Semantic Versioning 2.0.0, which glide hasn't update in a while, setting the version manually to latest develop fixes the issue:</p>\n\n<pre><code>- package: github.com/gin-gonic/gin\n  version: f931d1ea80ae95a6fc739213cdd9399bd2967fb6\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1474964052, "post_id": 39714992, "comment_id": 66736441, "body": "No this is not an answer and this is another problem, see the all comments under all posts. <code>c.Param(key)</code> is a shortcut for <code>c.Params.ByName(key)</code>, see <code>Param(key)</code> docs. And update your package: <code>github.com&#47;gin-gonic&#47;gin</code>"}, {"owner": {"reputation": 3138, "user_id": 1219798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/902d3920daa753ac343d748ce6a9d952?s=128&d=identicon&r=PG", "display_name": "Athir Nuaimi", "link": "https://stackoverflow.com/users/1219798/athir-nuaimi"}, "edited": false, "score": 1, "creation_date": 1475062827, "post_id": 39714992, "comment_id": 66789138, "body": "agree the root cause was the use of an older version of the gin-gonic code.  Updated to the latest and the problem went away."}], "tags": [], "owner": {"reputation": 3138, "user_id": 1219798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/902d3920daa753ac343d748ce6a9d952?s=128&d=identicon&r=PG", "display_name": "Athir Nuaimi", "link": "https://stackoverflow.com/users/1219798/athir-nuaimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1474964858, "last_edit_date": 1474964858, "creation_date": 1474942351, "answer_id": 39714992, "question_id": 38970180, "link": "https://stackoverflow.com/questions/38970180/golang-gin-c-param-undefined-type-gin-context-has-no-field-or-method-param/39714992#39714992", "title": "Golang Gin &quot;c.Param undefined (type *gin.Context has no field or method Param)&quot;", "body": "<p>I ran into the same issue.<br>\nI'm not sure the root cause but I fixed it by changing the code from </p>\n\n<pre><code>c.Param(\"name\")\n</code></pre>\n\n<p>to </p>\n\n<pre><code>c.Params.ByName(\"name\")\n</code></pre>\n\n<p>If you look at the source for the <code>Param()</code> method, this is what it called under the covers.</p>\n"}], "owner": {"reputation": 381, "user_id": 3936512, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kPnAi.jpg?s=128&g=1", "display_name": "k16", "link": "https://stackoverflow.com/users/3936512/k16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5815, "favorite_count": 1, "accepted_answer_id": 38970791, "answer_count": 5, "score": 3, "last_activity_date": 1475078521, "creation_date": 1471336627, "last_edit_date": 1474949187, "question_id": 38970180, "link": "https://stackoverflow.com/questions/38970180/golang-gin-c-param-undefined-type-gin-context-has-no-field-or-method-param", "title": "Golang Gin &quot;c.Param undefined (type *gin.Context has no field or method Param)&quot;", "body": "<p>I tried to use the Gin which is framework for Golang.<br>\n<a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">https://github.com/gin-gonic/gin</a></p>\n\n<p>And the I copied sample codes from official github.<br>\nIt's like this.  </p>\n\n<pre><code>package main\n\nimport (\n   \"github.com/gin-gonic/gin\"\n   \"net/http\"\n)\n\nfunc main() {\n    router := gin.Default()\n\n    router.GET(\"/user/:name\", func(c *gin.Context) {\n        name := c.Param(\"name\")\n        c.String(http.StatusOK, \"Hello %s\", name)\n        })\n\n    router.Run(\":8080\")\n}\n</code></pre>\n\n<p>But I got the error.  </p>\n\n<pre><code># go run main.go\n# command-line-arguments ./main.go:12: c.Param undefined (type *gin.Context has no field or method Param)\n</code></pre>\n\n<p>Does anyone know how can I fix the problem ?</p>\n\n<p>\u30fbCentOS7</p>\n\n<p>\u30fbgo version go1.6.3 linux/amd64</p>\n\n<h3>Edit:</h3>\n\n<p>I actually use the glide but I updated gin as global.\nAnd also update Go to 1.7 but getting still the same error:</p>\n\n<pre><code># go get -u -v github.com/gin-gonic/gin\ngithub.com/gin-gonic/gin (download)\ngithub.com/golang/protobuf (download)\nFetching https://gopkg.in/go-playground/validator.v8?go-get=1\nhttps fetch failed: Get https://gopkg.in/go-playground/validator.v8?go-get=1: dial tcp: lookup gopkg.in on 192.168.11.1:53: dial udp 192.168.11.1:53: i/o timeout\ngopkg.in/go-playground/validator.v8 (download)\nFetching https://gopkg.in/yaml.v2?go-get=1\nhttps fetch failed: Get https://gopkg.in/yaml.v2?go-get=1: dial tcp: lookup gopkg.in on 192.168.11.1:53: dial udp 192.168.11.1:53: i/o timeout\ngopkg.in/yaml.v2 (download)\ngithub.com/manucorporat/sse (download)\nFetching https://golang.org/x/net/context?go-get=1\nParsing meta tags from https://golang.org/x/net/context?go-get=1 (status code 200)\nget \"golang.org/x/net/context\": found meta tag main.metaImport{Prefix:\"golang.org/x/net\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/net\"} at https://golang.org/x/net/context?go-get=1\nget \"golang.org/x/net/context\": verifying non-authoritative meta tag\nFetching https://golang.org/x/net?go-get=1\nParsing meta tags from https://golang.org/x/net?go-get=1 (status code 200)\ngolang.org/x/net (download)\n\n# go version\ngo version go1.7 linux/amd64\n\n# go run test.go\n# command-line-arguments\n./test.go:12: c.Param undefined (type *gin.Context has no field or method Param)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 1672533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fba5c12e1020f644630a80813a049071?s=128&d=identicon&r=PG", "display_name": "yanzay", "link": "https://stackoverflow.com/users/1672533/yanzay"}, "is_accepted": false, "score": 0, "last_activity_date": 1471382918, "creation_date": 1471382918, "answer_id": 38984772, "question_id": 38969191, "link": "https://stackoverflow.com/questions/38969191/golang-httputil-newsinglehostreverseproxy-how-to-read-response-and-modify-the-re/38984772#38984772", "title": "golang httputil.NewSingleHostReverseProxy how to read response and modify the response?", "body": "<p>When you are going to http:// for most good sites (for example your habrahabr.ru) there is a redirect to https://, so request to http will return something like <code>301 Moved Permanently</code> and you will not find content that you seek for. Also, after correct to https, make sure that site does not use javascript to load content, you can easily check this by curl:\n<code>\ncurl localhost:3000\n</code></p>\n\n<p>Also use some logging to determine what's wrong.</p>\n"}], "owner": {"reputation": 21, "user_id": 3497889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a66d8f043a9c347826cbafca257418e?s=128&d=identicon&r=PG&f=1", "display_name": "user3497889", "link": "https://stackoverflow.com/users/3497889/user3497889"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 705, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471382918, "creation_date": 1471333363, "question_id": 38969191, "link": "https://stackoverflow.com/questions/38969191/golang-httputil-newsinglehostreverseproxy-how-to-read-response-and-modify-the-re", "title": "golang httputil.NewSingleHostReverseProxy how to read response and modify the response?", "body": "<p>I've  a reverse proxy like this:\nIam using RoundTrip  but this proxy server don't work correctly.<br>\nHow to correctly read  and modify response?<br>\nand somebody create proxy server via NewSingleHostReverseProxy.\nPlease Help.</p>\n\n<pre><code>package main\n\nimport (\n\"bytes\"\n\"fmt\"\n\"io/ioutil\"\n\"net/http\"\n\"net/http/httputil\"\n\"net/url\"\n)\n\ntype transport struct {\n http.RoundTripper\n}\n\nfunc (t *transport) RoundTrip(req *http.Request) (resp *http.Response, err error) {\n   resp, err = t.RoundTripper.RoundTrip(req)\n   if err != nil {\n    return nil, err\n   }\n\n   b, err := ioutil.ReadAll(resp.Body)\n   if err != nil {\n    return nil, err\n   }\n\n   err = resp.Body.Close()\n   if err != nil {\n    return nil, err\n   }\n\n   b = bytes.Replace(b, []byte(\"Google\"), []byte(\"GOOGLE\"), -1)\n   body := ioutil.NopCloser(bytes.NewReader(b))\n   resp.Body = body\n   return resp, nil\n}\n\nfunc sameHost(handler http.Handler) http.Handler {\n return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    r.Host = r.URL.Host\n    handler.ServeHTTP(w, r)\n })\n}\n\nfunc main() {\n  u, _ := url.Parse(\"http://habrahabr.ru\")\n  reverseProxy := httputil.NewSingleHostReverseProxy(u)\n  reverseProxy.Transport = &amp;transport{http.DefaultTransport}\n  // wrap that proxy with our sameHost function\n  singleHosted := sameHost(reverseProxy)\n  http.ListenAndServe(\":3000\", singleHosted)\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471317476, "post_id": 38966042, "comment_id": 65286700, "body": "@skm  I hope this helps."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 3, "last_activity_date": 1475154274, "last_edit_date": 1475154274, "creation_date": 1471316812, "answer_id": 38966042, "question_id": 38965693, "link": "https://stackoverflow.com/questions/38965693/missing-type-in-composite-literal-error/38966042#38966042", "title": "&quot;Missing type in composite literal&quot; error", "body": "<p>Use </p>\n\n<pre><code>LTI{Leads: []LI{leadIdInput}}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>fmt.Printf(\"rCR is '%+v' \\n\", rCR.Input.Leads[0])\n</code></pre>\n\n<p>Try it on <a href=\"https://play.golang.org/p/TADgKGFrqv\" rel=\"nofollow\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype LI struct {\n    Id int `json:\"id\"`\n}\n\ntype TP struct {\n    Name  string `json:\"name\"`\n    Value string `json:\"value\"`\n}\n\ntype LTI struct {\n    Leads  []LI `json:\"leads\"`\n    Tokens []TP `json:\"tokens,omitempty\"`\n}\n\ntype RCR struct {\n    Input LTI `json:\"input\"`\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    leadIdInput := LI{Id: 55213}\n    leadTokensInput := LTI{Leads: []LI{leadIdInput}}\n    rCR := RCR{Input: leadTokensInput}\n    fmt.Printf(\"rCR is '%+v' \\n\", rCR.Input.Leads[0])\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Hello, playground\nrCR is '{Id:55213}' \n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5161654, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gdyIN.jpg?s=128&g=1", "display_name": "skm", "link": "https://stackoverflow.com/users/5161654/skm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9363, "favorite_count": 0, "closed_date": 1559571435, "accepted_answer_id": 38966042, "answer_count": 1, "score": 0, "last_activity_date": 1475154274, "creation_date": 1471313784, "last_edit_date": 1471354439, "question_id": 38965693, "link": "https://stackoverflow.com/questions/38965693/missing-type-in-composite-literal-error", "closed_reason": "Duplicate", "title": "&quot;Missing type in composite literal&quot; error", "body": "<p>I am getting the following error, while executing this Go program. not sure what I am missing.</p>\n\n<pre><code>.\\m.go:28: missing type in composite literal\n.\\m.go:28: too few values in struct initializer\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/SseWnsX3jN\" rel=\"nofollow\">Go Playground</a></kbd></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype LI struct {\n    Id int `json:\"id\"`\n}\n\ntype TP struct {\n    Name  string `json:\"name\"`\n    Value string `json:\"value\"`\n}\n\ntype LTI struct {\n    Leads  []LI `json:\"leads\"`\n    Tokens []TP `json:\"tokens,omitempty\"`\n}\n\ntype RCR struct {\n    Input LTI `json:\"input\"`\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    leadIdInput := LI{Id: 55213}\n    leadTokensInput := LTI{{[]LI{leadIdInput}, nil}}\n    rCR := RCR{Input: leadTokensInput}\n    fmt.Println(\"rCR is '%+v'\", rCR.Input.Leads[0])\n}\n</code></pre>\n\n<p>Please help.</p>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1471308948, "post_id": 38963896, "comment_id": 65284905, "body": "A slightly better solution: <code>output,_ := exec.Command(&quot;file&quot; &quot;-s&quot;, &quot;&#47;proc&#47;uptime&quot;).Output()</code>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1471345777, "post_id": 38963896, "comment_id": 65299845, "body": "Well, after re-reading the question several times I think we&#39;re dealing with a classical case of the <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. Please could you &quot;forget&quot; about the <code>file</code> program for a moment and state what <i>initial</i> problem are you trying to solve? Is it about reading and interpreting the contents of <code>&#47;proc&#47;uptime</code> specifically?"}, {"owner": {"reputation": 103, "user_id": 2297314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GFRBw.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/2297314/will"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1471354472, "post_id": 38963896, "comment_id": 65305801, "body": "@kostix Fair Point. My initial problem that I want to solve is that I have <i>files</i> in /proc/* that I need to quickly scan and find out if they are empty. This specific file tells me if a job still has tasks remaining for it. If none exist, the job is finished. Above when I do a <code>file -s &lt;fileglob&gt;</code>, I see that all of the <i>truly empty</i> files show as empty versus an ASCII Text. I&#39;ll show a practical use case that I&#39;m trying to do in my question."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1471359248, "post_id": 38963896, "comment_id": 65309049, "body": "Uh, sorry, but do you mean that if you combine <code>path&#47;filepath.Walk()</code> with <code>os.Stat()</code> the latter call returns non-zero for some files which are <i>truly empty?</i>  I&#39;m still struggling with this &quot;truly empty&quot; thing because <code>&#47;proc</code> is supposed to faithfully adhere to the conventions of a &quot;real&quot; file system. Isn&#39;t this the case that what you&#39;re observing is merely a regular race?  I mean, <i>while you scan</i> the entries under some <code>&#47;proc</code> hierarchy they are free to change right under your feet: there&#39;s no guarantee of snapshot semantics or something like this."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1471359301, "post_id": 38963896, "comment_id": 65309091, "body": "I mean, even repeatable read of the same <code>&#47;cgroup&#47;memory&#47;lsf&#47;&lt;cluster&gt;&#47;&lt;jobid&gt;&#47;tasks</code> file twice in a row might bring you different results on each read (the first being non-empty with the second being empty).  Moreover, you can&#39;t event guarantee that it&#39;s impossible to have &quot;empty then non-empty&quot; result -- because in theory your program could have been suspended (by the OS) after the first read and in the meantime anothe job in the clusted with the same <code>&lt;cluster&gt;</code>+<code>&lt;jobid&gt;</code> was launched."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1471359502, "post_id": 38963896, "comment_id": 65309215, "body": "While this is improbable, certain other resources such as process PIDs are not so unique.  The kernel tries to make reusing of them be a rare occasion, but still reading something like <code>&#47;proc&#47;&lt;pid&gt;&#47;status</code> twice in a row is not guaranteed to return you the status of <i>the same</i> process."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1471359679, "post_id": 38963896, "comment_id": 65309339, "body": "Oh, silly me: disregard what I said about &#171;<code>&#47;proc</code> is supposed to faithfully adhere to the conventions of a &quot;real&quot; file system&#187;: a simple check with <code>stat &#47;proc&#47;$$&#47;status</code> clearly shows that the <code>stat</code> call sees the file has size 0 while actually reading from it yelds some information. Sorry for the conusion. I&#39;ll update my answer in a moment."}, {"owner": {"reputation": 103, "user_id": 2297314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GFRBw.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/2297314/will"}, "edited": false, "score": 0, "creation_date": 1471374388, "post_id": 38963896, "comment_id": 65318118, "body": "Not relevant to my question but an interesting sidenote in case anyone stumbles on this; I can nearly guarantee that it is impossible to go from empty to non-empty (at least in our implementation). cgroups tracks the process IDs in this tasks file and when that file is empty the job is finished. The job is more of a meta concept collection of tasks. If there are no tasks, the job isn&#39;t running."}], "answers": [{"tags": [], "owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "is_accepted": false, "score": 2, "last_activity_date": 1471353888, "last_edit_date": 1471353888, "creation_date": 1471324861, "answer_id": 38967137, "question_id": 38963896, "link": "https://stackoverflow.com/questions/38963896/how-do-i-implement-file-s-file-on-linux-in-pure-go/38967137#38967137", "title": "How do I implement &quot;file -s &lt;file&gt;&quot; on Linux in pure Go?", "body": "<blockquote>\n  <p>I have a fileglob of files in /proc/* that I need to very quickly\n  detect if they are truly empty instead of appearing to be empty.</p>\n</blockquote>\n\n<p>They are <em>truly</em> empty in some sense (eg. they occupy no space on file system). If you want to check whether any data can be read from them, try reading from them - that's what <code>file -s</code> does:</p>\n\n<blockquote>\n  <p><code>-s, --special-files</code></p>\n  \n  <p>Normally, file only attempts to read and\n  determine the type of argument files which stat(2) reports are\n  ordinary files.  This prevents problems, because reading special files\n  may have peculiar consequences.  Specifying the -s option causes file\n  to also read argument files which are block or character special\n  files.  This is useful for determining the filesystem types of the\n  data in raw disk partitions, which are block special files.  This\n  option also causes file to disregard the file size as reported by\n  stat(2) since on some systems it reports a zero size for raw disk\n  partitions.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 2297314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GFRBw.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/2297314/will"}, "edited": false, "score": 0, "creation_date": 1471357051, "post_id": 38967155, "comment_id": 65307577, "body": "If I&#39;m reading the <a href=\"https://github.com/file/file/blob/da42d88766f4a015018d54c91dd9803b905c18ba/src/fsmagic.c\" rel=\"nofollow noreferrer\">source code</a> correctly, when the <code>-s</code> option is given to file it simply ignores the <code>stat()</code> call and proceeds the read the area to determine what&#39;s actually there. In this case, (and my use case) this still results in a file read call so I could potentially do something comparable."}, {"owner": {"reputation": 103, "user_id": 2297314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GFRBw.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/2297314/will"}, "edited": false, "score": 0, "creation_date": 1471374070, "post_id": 38967155, "comment_id": 65317955, "body": "I like the 1 byte solution as it is fairly minimalistic and may even potentially be a faster call than <code>os.stat()</code> (I&#39;d have to test). I&#39;m going to leave the answer un-accepted for a few days and see if any other potentials come in prior to confirming it as <i>the best way</i> forward."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 2, "last_activity_date": 1471360177, "last_edit_date": 1471360177, "creation_date": 1471324995, "answer_id": 38967155, "question_id": 38963896, "link": "https://stackoverflow.com/questions/38963896/how-do-i-implement-file-s-file-on-linux-in-pure-go/38967155#38967155", "title": "How do I implement &quot;file -s &lt;file&gt;&quot; on Linux in pure Go?", "body": "<p>I'm afraid you might be confusing matters here: <code>file</code> is special in precisely a way it \"knows\" a set of heuristics to carry out its tasks.</p>\n\n<p>To my knowledge, Go does not have anything like this in its standard library, and I've not came across a 3rd-party package implementing a <code>file</code>-like functionality (though I invite you to search by relevant keywords on <a href=\"http://godoc.org\" rel=\"nofollow\">http://godoc.org</a>)</p>\n\n<p>On the other hand, Go provides full access to the syscall interface of the underlying OS so when it comes to querying the OS in a way <code>file</code> does it, there's nothing you could not do in plain Go.</p>\n\n<p>So I suggest you to just fetch the source code of <code>file</code>, learn what it does in its mode turned on by the \"-s\" command-line option and implement that in your Go code.\nWe'll try to have you with specific problems doing that \u2014 should you have any.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Looks like I've managed to grasp the OP is struggling with: a simple check:</p>\n\n<pre><code>$ stat -c %s /proc/$$/status &amp;&amp; wc -c &lt; $_\n0\n849\n</code></pre>\n\n<p>That is, the <code>stat</code> call on a file under <code>/proc</code> shows it has no contents but actually reading from that file returns that contents.</p>\n\n<p>OK, so the solution is simple: instead of doing a call to <code>os.Stat()</code> while traversing the subtree of the filesystem one should instead merely attempt to read a single byte from the file, like in:</p>\n\n<pre><code>var buf [1]byte\nf, err := os.Open(fname)\nif err != nil {\n    // do something, or maybe ignore.\n    // A not existing file is OK to ignore\n    // (the POSIX error code will be ENOENT)\n    // because after the `path/filepath.Walk()` fetched an entry for\n    // this file from its directory, the file might well have gone.\n}\n_, err = f.Read(buf[:])\nif err != nil {\n    if err == io.EOF {\n        // OK, we failed to read 1 byte, so the file is empty.\n    }\n    // Otherwise, deal with the error\n}\nf.Close()\n</code></pre>\n\n<p>You might try to be more clever and first obtain the stat information\n(using a call to <code>os.Stat()</code>) to see if the file is a regular file&mdash;to\nnot attempt reading from sockets etc.</p>\n"}], "owner": {"reputation": 103, "user_id": 2297314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GFRBw.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/2297314/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 38967155, "answer_count": 2, "score": 0, "last_activity_date": 1471360177, "creation_date": 1471299566, "last_edit_date": 1471355052, "question_id": 38963896, "link": "https://stackoverflow.com/questions/38963896/how-do-i-implement-file-s-file-on-linux-in-pure-go", "title": "How do I implement &quot;file -s &lt;file&gt;&quot; on Linux in pure Go?", "body": "<p><strong>Intent:</strong><br>\nDoes Go have the functionality (package or otherwise) to perform a <em>special</em> file stat on Linux akin to the command <code>file -s &lt;path&gt;</code></p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>[root@localhost ~]# file /proc/uptime\n/proc/uptime: empty\n[root@localhost ~]# file -s /proc/uptime\n/proc/uptime: ASCII text\n</code></pre>\n\n<p><strong>Use Case:</strong><br>\nI have a fileglob of files in /proc/* that I need to very quickly detect if they are <em>truly</em> empty instead of appearing to be empty.</p>\n\n<p><strong>Using The os Package:</strong></p>\n\n<p><em>Code:</em></p>\n\n<pre><code>result,_ := os.Stat(\"/proc/uptime\")\nfmt.Println(\"Name:\",result.Name(),\" Size:\",result.Size(),\" Mode:\",int(result.Mode()))\nfmt.Printf(\"%q\",result)\n</code></pre>\n\n<p><em>Result:</em></p>\n\n<pre><code>Name: uptime  Size: 0  Mode: 292\n&amp;{\"uptime\" '\\x00' '\u0124' {%!q(int64=63606896088) %!q(int32=413685520) %!q(*time.Location=&amp;{ [] [] 0 0 &lt;nil&gt;})} {'\\x03' %!q(uint64=4026532071) '\\x01' '\u8124' '\\x00' '\\x00' '\\x00' '\\x00' '\\x00' '\u0400' '\\x00' {%!q(int64=1471299288) %!q(int64=413685520)} {%!q(int64=1471299288) %!q(int64=413685520)} {%!q(int64=1471299288) %!q(int64=413685520)} ['\\x00' '\\x00' '\\x00']}}\n</code></pre>\n\n<p><strong>Obvious Workaround:</strong><br>\nThere is the obvious workaround of the following. But it's a little over the top to need to call in a bash shell in order to get file stats.</p>\n\n<pre><code>output,_ := exec.Command(\"bash\",\"-c\",\"file -s\",\"/proc/uptime\").Output()\n//parse output etc...\n</code></pre>\n\n<p><strong>EDIT/MY PRACTICAL USE CASE:</strong><br>\nQuickly determining which files are zero size without needing to read each one of them first.</p>\n\n<pre><code>file -s /cgroup/memory/lsf/&lt;cluster&gt;/*/tasks | &lt;clean up commands&gt; | uniq -c\n6 /cgroup/memory/lsf/&lt;cluster&gt;/&lt;jobid&gt;/tasks: ASCII text\n805 /cgroup/memory/lsf/&lt;cluster&gt;/&lt;jobid&gt;/tasks: empty\n</code></pre>\n\n<p>So in this case, I know that only those 6 jobs are running and the rest (805) have terminated. Reading the file works like this:</p>\n\n<pre><code># cat /cgroup/memory/lsf/&lt;cluster&gt;/&lt;jobid&gt;/tasks\n#\n</code></pre>\n\n<p>or   </p>\n\n<pre><code># cat /cgroup/memory/lsf/&lt;cluster&gt;/&lt;jobid&gt;/tasks\n12352\n53455\n...\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7470, "user_id": 1262783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/O9pU2.jpg?s=128&g=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/1262783/guilherme"}, "edited": false, "score": 0, "creation_date": 1471394544, "post_id": 38964156, "comment_id": 65325626, "body": "That looks interesting. But shouldn&#39;t be <code>Next()</code> the last call in this function?"}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 7470, "user_id": 1262783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/O9pU2.jpg?s=128&g=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/1262783/guilherme"}, "edited": false, "score": 1, "creation_date": 1471395544, "post_id": 38964156, "comment_id": 65325835, "body": "No. in simple words, Next() calls next handler in the chain of processing (last of which will be the handler of the request). They called chaining, but I&#39;d rather suggest thinking about them rather like a Russian doll than a chain. If you move Next() call to the end of firmware, then all your measuring and logging will happen before you handler is called."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 7470, "user_id": 1262783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/O9pU2.jpg?s=128&g=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/1262783/guilherme"}, "edited": false, "score": 0, "creation_date": 1471395723, "post_id": 38964156, "comment_id": 65325878, "body": "Another example would be github.com/iris-contrib/middleware/logger. Look at Serve() method."}, {"owner": {"reputation": 7470, "user_id": 1262783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/O9pU2.jpg?s=128&g=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/1262783/guilherme"}, "edited": false, "score": 0, "creation_date": 1471397020, "post_id": 38964156, "comment_id": 65326154, "body": "Understood, thanks! I updated my question, do you know why that solution didn&#39;t work?"}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 7470, "user_id": 1262783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/O9pU2.jpg?s=128&g=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/1262783/guilherme"}, "edited": false, "score": 0, "creation_date": 1471403288, "post_id": 38964156, "comment_id": 65327528, "body": "I&#39;m not sure. I don&#39;t use OnError() in my code. First of all, OnError() is only called  when your own handler sets that response status (such as 503). And 503 is most likely generated by a load balancer or proxy without actually accessing your service. If you set 503 status in your own code, check that iris.onError() is called before iris.Get(). I&#39;m not sure if  this is important, but would suspect it is. See <a href=\"https://kataras.gitbooks.io/iris/content/custom-http-errors.html\" rel=\"nofollow noreferrer\">kataras.gitbooks.io/iris/content/custom-http-errors.html</a>. Note how iris.onError() calls precede iris.Get() calls there."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 7470, "user_id": 1262783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/O9pU2.jpg?s=128&g=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/1262783/guilherme"}, "edited": false, "score": 0, "creation_date": 1471403490, "post_id": 38964156, "comment_id": 65327577, "body": "You can also check http status of the response in the above middleware handler by calling ctx.Response.StatusCode() after ctx.Next(). Again, github.com/iris-cont\u200c\u200brib/middleware/logger\u200c\u200b is another example of doing that."}], "tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": true, "score": 1, "last_activity_date": 1471301291, "creation_date": 1471301291, "answer_id": 38964156, "question_id": 38963317, "link": "https://stackoverflow.com/questions/38963317/iris-how-to-log-erros-exceptions/38964156#38964156", "title": "Iris - How to log erros/exceptions?", "body": "<p>You'll need to write your own <a href=\"https://kataras.gitbooks.io/iris/content/middleware.html\" rel=\"nofollow\">iris middleware</a>.</p>\n\n<p>Should look something like this:</p>\n\n<pre><code>func irisMiddlewareFunc(ctx *iris.Context) {\n    startedAt := time.Now()\n    ctx.Next()\n    timeTaken := time.Since(startedAt)\n\n    // now check time taken and log as required\n    if timeTaken.Seconds() &gt; 2 {\n        fmt.Println(\"Taken too long\")\n    }\n}\n</code></pre>\n\n<p>The you use it like this:</p>\n\n<pre><code>    iris.UseFunc(irisMiddlewareFunc)\n</code></pre>\n\n<p>And if you need to handle panics as well, just use recover() as you would usually do to handle panics. See <a href=\"http://github.com/iris-contrib/middleware/recovery\" rel=\"nofollow\">github.com/iris-contrib/middleware/recovery\n</a> for an example.</p>\n"}], "owner": {"reputation": 7470, "user_id": 1262783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/O9pU2.jpg?s=128&g=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/1262783/guilherme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 38964156, "answer_count": 1, "score": 0, "last_activity_date": 1471394004, "creation_date": 1471296360, "last_edit_date": 1471394004, "question_id": 38963317, "link": "https://stackoverflow.com/questions/38963317/iris-how-to-log-erros-exceptions", "title": "Iris - How to log erros/exceptions?", "body": "<p>I'm testing a Go application using <a href=\"https://github.com/kataras/iris\" rel=\"nofollow\">Iris</a>.\nI want to log every error or exception to my Rollbar account.</p>\n\n<p>For instance, if the endpoint takes too long to respond and there is a timeout, I want to log it. How can I capture errors like that?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I found in the documentation the <code>OnError</code> method, and I thought I could use it like this:</p>\n\n<pre><code>iris.OnError(iris.StatusServiceUnavailable, func(c *iris.Context) {\n    c.Write(\"503\")\n    params := string(c.RequestCtx.Request.Body())\n    rollbar.Error(\"error\", errors.New(\"503 Service Unavailable\"), &amp;rollbar.Field{Name: \"request_body\", Data: params})\n})\n</code></pre>\n\n<p>But it is not logging the error to Rollbar.</p>\n"}, {"tags": ["mongodb", "go", "aggregation-framework", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 4375256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af19fde5cd9aa4f928616f0722bf0230?s=128&d=identicon&r=PG", "display_name": "Vardhan", "link": "https://stackoverflow.com/users/4375256/vardhan"}, "is_accepted": false, "score": -1, "last_activity_date": 1471313641, "last_edit_date": 1471313641, "creation_date": 1471312472, "answer_id": 38965534, "question_id": 38962165, "link": "https://stackoverflow.com/questions/38962165/how-do-i-use-mgo-aggregation-pipeline-to-find-all-embedded-documents-matching-ce/38965534#38965534", "title": "How do I use MGO aggregation pipeline to find all embedded documents matching certain criteria", "body": "<p>Try this</p>\n\n<pre><code>db.groups.aggregate([{$unwind : '$Requests'},\n                     {$match: {'Requests._id' :{$in: [1,2,4]}}}, \n                     {$project : {_id : '$Requests._id',name:'$Requests.name'}}]);\n</code></pre>\n"}], "owner": {"reputation": 7606, "user_id": 180253, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df46030788b7cc95cadb9778a2b9e7dd?s=128&d=identicon&r=PG", "display_name": "TheJediCowboy", "link": "https://stackoverflow.com/users/180253/thejedicowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471313641, "creation_date": 1471291182, "last_edit_date": 1471291270, "question_id": 38962165, "link": "https://stackoverflow.com/questions/38962165/how-do-i-use-mgo-aggregation-pipeline-to-find-all-embedded-documents-matching-ce", "title": "How do I use MGO aggregation pipeline to find all embedded documents matching certain criteria", "body": "<p>Lets say I have the following data in a <code>Groups</code> collection in MongoDB</p>\n\n<pre><code>[\n    {\n        \u201cGroup\u201d: {\n            \u201c_id\u201d: 1,\n            \u201cRequests\u201d: [\n                {\n                    \u201c_id\u201d:1,\n                    \u201cname\u201d:\u201dRequest A\u201d\n                }.\n                {\n                    \u201c_id\u201d:2,\n                    \u201cname\u201d:\u201dRequest B\u201d\n                }\n            ]       \n        }\n    },\n            {\n        \u201cGroup\u201d: {\n            \u201c_id\u201d: 2,\n            \u201cRequests\u201d: [\n                {\n                    \u201c_id\u201d:3,\n                    \u201cname\u201d:\u201dRequest C\u201d\n                }.\n                {\n                    \u201c_id\u201d:4,\n                    \u201cname\u201d:\u201dRequest D\u201d\n                }\n            ]       \n        }\n    }\n\n]\n</code></pre>\n\n<p>Also, lets say I have the following function</p>\n\n<pre><code>func GetRequests(requestIDs []string) (Request[] error){\n        //NEED TO IMPLEMENT W/ MGO\n}\n</code></pre>\n\n<p>Is there a way to use the aggregation pipeline (or not if its not needed) to return just a projection of the requests matching <code>requestIDs</code>?</p>\n\n<p>For example</p>\n\n<p><strong>Sample input reflecting <code>requestIds</code></strong></p>\n\n<pre><code>[1,2,4]\n</code></pre>\n\n<p><strong>Sample output from <code>mgo</code> aggregation/query</strong></p>\n\n<pre><code>[\n  {\n    \u201c_id\u201d:1,\n    \u201cname\u201d:\u201dRequest A\u201d\n  },\n  {\n    \u201c_id\u201d:2,\n    \u201cname\u201d:\u201dRequest B\u201d\n  },\n  {\n    \u201c_id\u201d:4,\n    \u201cname\u201d:\u201dRequest D\u201d\n  }\n]\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-pubsub"], "owner": {"reputation": 105, "user_id": 6055486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a960bc4f7735c3331765d9bbbec0f486?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6055486/sven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 367, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1472922416, "creation_date": 1471289473, "last_edit_date": 1495541779, "question_id": 38961748, "link": "https://stackoverflow.com/questions/38961748/google-cloud-pubsub-from-appengine-suddenly-not-authorized-error-401", "title": "Google Cloud PubSub from AppEngine: suddenly not authorized (Error 401)", "body": "<p>I cannot say exactly since when we have this problem, since our project is still in development and we only periodically deploy to test things.</p>\n\n<p>In our most recent test the PubSub authentication does not seem to work anymore. When subscribing to a topic, the following error comes up in the logs:</p>\n\n<pre><code>21:10:29.577 Error subscribing to '123456'-topic: googleapi: Error 401: The request does not have valid authentication credentials., unauthorized\n</code></pre>\n\n<p>This error is <strong>new</strong>. It worked fine before. We cannot trace it back to any code change on our part.</p>\n\n<p>This error is also <strong>not occuring on the devappserver</strong> with the PubSub-Emulator.</p>\n\n<p>The subscriber is in the same project as the PubSub-Service. Again, <strong>everything here is happening in one project.</strong></p>\n\n<p>Here is some insight into what we are doing:</p>\n\n<pre><code>client, err := pubsub.NewClient(ctx, \"lol123\", option.WithTokenSource(google.AppEngineTokenSource(ctx, pubsub.ScopePubSub)), option.WithHTTPClient(urlfetch.Client(ctx)))\n[...] more code [...]\n_, err := client.NewSubscription(ctx, subname, topic, 0, &amp;pubsub.PushConfig{\n        Endpoint: endpoint,\n    })\n</code></pre>\n\n<p>Pretty standard stuff.</p>\n\n<p>Here are things we tried to play with:</p>\n\n<p>Adding a second scope: </p>\n\n<pre><code>option.WithTokenSource(google.AppEngineTokenSource(ctx, pubsub.ScopePubSub, pubsub.ScopeCloudPlatform)\n</code></pre>\n\n<p>Using the default tokensource:</p>\n\n<pre><code>tokenSource, _ := google.DefaultTokenSource(ctx, pubsub.ScopePubSub)\noption.WithTokenSource(tokenSource)\n</code></pre>\n\n<p>Adding an endpoint, in case <a href=\"https://stackoverflow.com/questions/38860888/gloud-java-permission-denied-google-cloud-pub-sub-api-experimental\">https://experimental.pubsub.googleapis.com/</a> is somehow used:</p>\n\n<pre><code>option.WithEndpoint(\"https://pubsub.googleapis.com/\")\n</code></pre>\n\n<p>Also, we switched from the previous cloud.WithTokenSource(...)-stuff to the new option.WithTokenSource(...)-libraries. This migration to the new Cloud-Libraries worked well. However, they did not help with the permission problem.</p>\n\n<p>We also played around with every imaginable combination of Service Accounts and Permissions. E.g., the default Appengine Service Account has been added as Owner to all PubSub-Topics. Remember, that this error is new and it worked before and we cannot trace it back to changes on our part.</p>\n\n<p>Any ideas and suggestions? We'll try pretty much anything at this point. ;-)</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "is_accepted": true, "score": 2, "last_activity_date": 1471286204, "creation_date": 1471286204, "answer_id": 38960919, "question_id": 38960858, "link": "https://stackoverflow.com/questions/38960858/referencing-another-struct-gives-undefined/38960919#38960919", "title": "Referencing another struct gives &quot;undefined&quot;", "body": "<p>Since you've defined the types in a function, the config type definition runs before there is a group type to reference.  Reversing the order of your definitions works, although I had to remove the reference to target as you have not provided it's definition.</p>\n\n<p>This works in the playgound <a href=\"https://play.golang.org/p/fzRCtCHqnH\" rel=\"nofollow\">https://play.golang.org/p/fzRCtCHqnH</a>:</p>\n\n<pre><code>func main() {\n\n    type group struct {\n        group        string `mapstructure:\"group\"`\n        targetPrefix string `mapstructure:\"target_prefix\"`\n    }\n    type config struct {\n        interval     int    `mapstructure:\"Interval\"`\n        statsdPrefix string `mapstructure:\"statsd_prefix\"`\n        groups       []group\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 38960919, "answer_count": 1, "score": -1, "last_activity_date": 1471286204, "creation_date": 1471285947, "question_id": 38960858, "link": "https://stackoverflow.com/questions/38960858/referencing-another-struct-gives-undefined", "title": "Referencing another struct gives &quot;undefined&quot;", "body": "<p>I have some very simple golang code:</p>\n\n<pre><code>func main (){\n\n      type config struct {\n        interval     int    `mapstructure:\"Interval\"`\n        statsdPrefix string `mapstructure:\"statsd_prefix\"`\n        groups       []group\n      }\n\n      type group struct {\n        group        string `mapstructure:\"group\"`\n        targetPrefix string `mapstructure:\"target_prefix\"`\n        targets      []target\n      }\n}\n</code></pre>\n\n<p>When I run this, I get the following:</p>\n\n<p><code>undefined: group</code></p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 51, "user_id": 5265446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbbb98ba4f8ba919e9ce0c299997aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Vg", "link": "https://stackoverflow.com/users/5265446/siva-vg"}, "edited": false, "score": 0, "creation_date": 1471290005, "post_id": 38960719, "comment_id": 65278323, "body": "my question is w.r.t assignment, when we do s=s[:n], my thinking was s is getting overwritten by the new slice where in the old array\\slice is actually lost, no longer exists. But to contrary I continue to slice on the original array that was already sliced and diced down, which seems different from Java."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5265446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbbb98ba4f8ba919e9ce0c299997aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Vg", "link": "https://stackoverflow.com/users/5265446/siva-vg"}, "edited": false, "score": 0, "creation_date": 1471289356, "post_id": 38960954, "comment_id": 65277984, "body": "Thanks, my question is w.r.t assignment, when we do s=s[:n], my thinking was s is getting overwritten by the new slice where in the old array\\slice is actually lost. It seems a little non-intuitive to me."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 51, "user_id": 5265446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbbb98ba4f8ba919e9ce0c299997aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Vg", "link": "https://stackoverflow.com/users/5265446/siva-vg"}, "edited": false, "score": 0, "creation_date": 1471290455, "post_id": 38960954, "comment_id": 65278566, "body": "Ah, no, same underlying array.  A slice, fundamentally, is just a 3-word structure, with a pointer to an underlying array, an integer length, and an integer capacity.  When you subslice, you alter that slice &quot;header&quot; (or create a new one) with updated fields as needed.  When you do <code>s=s[:n]</code>, all that does is change the &quot;length&quot; value of the slice header to <code>n</code>.  Still points to the same underlying array, still has the same capacity, so you can extend it again up to that capacity."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 51, "user_id": 5265446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbbb98ba4f8ba919e9ce0c299997aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Vg", "link": "https://stackoverflow.com/users/5265446/siva-vg"}, "edited": false, "score": 0, "creation_date": 1471290760, "post_id": 38960954, "comment_id": 65278755, "body": "If you want to make a copy of the underlying array (ie. have a new slice that points to an entirely different array, but with the same data in it), you either need to do it manually, index by index, or use the built in <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\"><code>copy()</code></a> function, which does a deep copy of the slice. <b>Edit:</b> only deep copy to the array level.  If your array stores pointers, those won&#39;t be deep copied."}, {"owner": {"reputation": 51, "user_id": 5265446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbbb98ba4f8ba919e9ce0c299997aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Vg", "link": "https://stackoverflow.com/users/5265446/siva-vg"}, "edited": false, "score": 0, "creation_date": 1471290802, "post_id": 38960954, "comment_id": 65278776, "body": "Thanks this makes it clear, Ok the key here seems capacity. So capacity and length is different in Go arrays. So when I slice it is better to loop over length than capacity, is that a true statement?"}, {"owner": {"reputation": 51, "user_id": 5265446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbbb98ba4f8ba919e9ce0c299997aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Vg", "link": "https://stackoverflow.com/users/5265446/siva-vg"}, "edited": false, "score": 0, "creation_date": 1471290875, "post_id": 38960954, "comment_id": 65278804, "body": "Oh ok ... copy() to make a duplicate"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 51, "user_id": 5265446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbbb98ba4f8ba919e9ce0c299997aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Vg", "link": "https://stackoverflow.com/users/5265446/siva-vg"}, "edited": false, "score": 0, "creation_date": 1471290978, "post_id": 38960954, "comment_id": 65278854, "body": "Yes, capacity just specifies the total size, relative to the array pointer, of the underlying array.  Length represents how much data is actually stored in it. You always want to loop over length, not capacity, as accessing an index of a slice that&#39;s inside the capacity but outside the length is still illegal.  The capacity can be longer than the length to allow <code>append()</code> and similar to grow the slice exponentially rather than reallocating for every append, allowing it to be amortized O(1) time for append."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 4, "last_activity_date": 1471286366, "creation_date": 1471286366, "answer_id": 38960954, "question_id": 38960719, "link": "https://stackoverflow.com/questions/38960719/go-slice-difference-between-n-and-n/38960954#38960954", "title": "Go Slice - difference between [:n] and [n:]", "body": "<p>Subslicing in Go allows you to slice beyond the end of the slice, as long as it's still within range of the underlaying array's capacity.  You cannot slice <em>before</em> the start of that slice, but you can slice after it so long as you don't go past that last allocated index.</p>\n\n<p>As an example, <code>s[3:]</code> then <code>s[:3]</code> works, but <code>s[4:]</code> then <code>s[:4]</code> will panic, as you're requesting indexes 4 through 7 of the underlying array, which only has allocated indexes 0-5.</p>\n\n<p>It's a bit of an oddity, but it does allow you to max out any slice simply by doing <code>slice = slice[:cap(slice)]</code>.</p>\n\n<p><a href=\"https://play.golang.org/p/Gq5xoXc3Vd\" rel=\"nofollow\">https://play.golang.org/p/Gq5xoXc3Vd</a></p>\n\n<p>The <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow\">language specification</a> annotes this, btw.  I've paraphrased it below for the simple slice notation you're using (there's an alternative that also specifies the maximum index for the new slice).</p>\n\n<blockquote>\n  <p>For a string, array, pointer to array, or slice a, the primary expression <code>a[low : high]</code> constructs a substring or slice.\n  The indices are in range if 0 &lt;= low &lt;= high &lt;= cap(a),\n  otherwise they are out of range.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 6902790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6376fca37a9434edab3475069870546d?s=128&d=identicon&r=PG&f=1", "display_name": "Doge", "link": "https://stackoverflow.com/users/6902790/doge"}, "is_accepted": false, "score": 0, "last_activity_date": 1490128846, "creation_date": 1490128846, "answer_id": 42937727, "question_id": 38960719, "link": "https://stackoverflow.com/questions/38960719/go-slice-difference-between-n-and-n/42937727#42937727", "title": "Go Slice - difference between [:n] and [n:]", "body": "<p>I just wanted to share my thoughts on this after reading the official blog:  <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">https://blog.golang.org/slices</a></p>\n\n<p>Here is the sliceHeader in Golang's blog:</p>\n\n<pre><code>type sliceHeader struct {\n    Length        int\n    ZerothElement *byte\n}\n</code></pre>\n\n<p>Now you declare your slice:</p>\n\n<pre><code>s := []int{2, 3, 5, 7, 11, 13}\n</code></pre>\n\n<p>which I believe does something like:</p>\n\n<pre><code>var array [6]int\nslice := sliceHeader {\n    Length:        6,\n    ZerothElement: &amp;array[0], \n}\n</code></pre>\n\n<p>By doing: <code>s = s[:2]</code>, you effectively changed the Length of the sliceHeader from 6 to 2, so your sliceHeader will look like this:</p>\n\n<pre><code>slice := sliceHeader {\n    Length:        2,\n    ZerothElement: &amp;array[0],\n}\n</code></pre>\n\n<p>Notice that the ZerothElement is still pointing to the same place in memory. So we can extend the slice back to its original form <code>s = s[:6]</code> by simply changing the Length again.</p>\n\n<p>Now, let's say you did not do <code>s = s[:2]</code> and instead did <code>s = s[2:]</code>, what you have effectively done is hiding the first two elements by subtracting 2 from Length AND shifting the ZerothElement two indices forward, resulting in a sliceHeader of:</p>\n\n<pre><code>slice := sliceHeader {\n    Length:        4,\n    ZerothElement: &amp;array[2],   \n}\n</code></pre>\n\n<p>At this point, you CANNOT restore the slice to its original form because there is no way to extend the slice beyond the ZerothElement. Okay, what if hypothetically you could access whatever elements before the ZerothElement? Then our slice becomes undefined because it could be <code>array[0...4]</code>, <code>array[1...5]</code>, or <code>array[2...6]</code>. </p>\n\n<p>So yeah, that is why I think [n:] and [:n] behaves differently.</p>\n"}], "owner": {"reputation": 51, "user_id": 5265446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbbb98ba4f8ba919e9ce0c299997aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Siva Vg", "link": "https://stackoverflow.com/users/5265446/siva-vg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "accepted_answer_id": 38960954, "answer_count": 2, "score": 0, "last_activity_date": 1490128846, "creation_date": 1471285385, "question_id": 38960719, "link": "https://stackoverflow.com/questions/38960719/go-slice-difference-between-n-and-n", "title": "Go Slice - difference between [:n] and [n:]", "body": "<p>Go Slice question, please check below and comment if I am missing something.</p>\n\n<pre><code>   import \"fmt\"\n   func main() {\n       s := []int{2, 3, 5, 7, 11, 13}\n       s = s[1:]\n       fmt.Println(s)\n       s = s[2:]\n       fmt.Println(s)\n       s = s[5:]\n       fmt.Println(s)\n  }\n</code></pre>\n\n<p>Output:</p>\n\n<p><code>[3 5 7 11 13]\n[7 11 13]\npanic: runtime error: slice bounds out of range</code></p>\n\n<p>The above makes sense.</p>\n\n<pre><code>func main() {\n       s := []int{2, 3, 5, 7, 11, 13}\n       s = s[:1]\n       fmt.Println(s)\n       s = s[:2]\n       fmt.Println(s)\n       s = s[:5]\n       fmt.Println(s)\n   }\n</code></pre>\n\n<p>Output:</p>\n\n<p><code>[2]\n[2 3]\n[2 3 5 7 11]</code></p>\n\n<p>Should this also get array out of bounds panic from s=s[:2]?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1471316351, "post_id": 38960704, "comment_id": 65286464, "body": "@rick-mason  I hope this helps."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1471321364, "last_edit_date": 1471321364, "creation_date": 1471285308, "answer_id": 38960704, "question_id": 38959644, "link": "https://stackoverflow.com/questions/38959644/convert-struct-to-json-in-golang/38960704#38960704", "title": "Convert Struct to JSON in Golang", "body": "<p>1- You may use <code>Marshal</code> and <code>Unmarshal</code> time, like this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"strconv\"\n    \"time\"\n)\n\ntype UCSUserAccess struct {\n    Groups                 map[string]string `json:\"groups\"`\n    Access                 map[string]string `json:\"access\"`\n    IsExpert               string            `json:\"isExpert\"`\n    SubscriptionGroupDates map[string]struct {\n        StartDate Time `json:\"START_DATE\"`\n        EndDate   Time `json:\"END_DATE\"`\n    } `json:\"subscription_group_dates\"`\n}\n\ntype Time time.Time\n\nfunc (t Time) MarshalJSON() ([]byte, error) {\n    data := []byte(fmt.Sprint(time.Time(t).UTC().Unix()))\n    return data, nil\n}\nfunc (t *Time) UnmarshalJSON(data []byte) error {\n    i, e := strconv.ParseInt(string(data), 10, 64)\n    *t = Time(time.Unix(i, 0).UTC())\n    return e\n}\nfunc (t Time) String() string {\n    return time.Time(t).UTC().String()\n}\n\nfunc main() {\n    str := `{ \n\"access\": {\n      \"STOCK\": \"1\",\n      \"FOREX\": \"1\",\n      \"WEBFOREX\": \"1\",\n      \"WEBSTOCK\": \"1\"\n    },\n\"subscription_group_dates\": {\n      \"32\": {\n            \"START_DATE\": 1464753600,\n            \"END_DATE\": 1472616000\n            },\n      \"42\": {\n            \"START_DATE\": 1470024000,\n            \"END_DATE\": 1472616000\n          }\n    } \n    }`\n    var d UCSUserAccess\n    err := json.Unmarshal([]byte(str), &amp;d)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(d)\n\n    fmt.Println()\n    body, err := json.Marshal(d)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(body))\n}\n</code></pre>\n\n<hr>\n\n<p>2- You may use <code>Marshal</code> and <code>Unmarshal</code> time, like this simplified working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"strconv\"\n    \"time\"\n)\n\ntype UCSUserAccess struct {\n    StartDate Time `json:\"START_DATE\"`\n}\n\ntype Time time.Time\n\nfunc (t Time) MarshalJSON() ([]byte, error) {\n    data := []byte(fmt.Sprint(time.Time(t).UTC().Unix()))\n    return data, nil\n}\nfunc (t *Time) UnmarshalJSON(data []byte) error {\n    i, e := strconv.ParseInt(string(data), 10, 64)\n    *t = Time(time.Unix(i, 0).UTC())\n    return e\n}\nfunc (t Time) String() string {\n    return time.Time(t).UTC().String()\n}\n\nfunc main() {\n    str := `{ \n            \"START_DATE\": 1464753600  \n    }`\n    var d UCSUserAccess\n    err := json.Unmarshal([]byte(str), &amp;d)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(d)\n\n    fmt.Println()\n    body, err := json.Marshal(d)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(body))\n}\n</code></pre>\n\n<hr>\n\n<p>3- Also you may use <code>int64</code> for time,like this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\ntype GroupID struct {\n    StartDate int64 `json:\"START_DATE\"`\n    EndDate   int64 `json:\"END_DATE\"`\n}\n\nfunc (t *GroupID) Start() time.Time {\n    return time.Unix(t.StartDate, 0)\n}\nfunc (t *GroupID) End() time.Time {\n    return time.Unix(t.EndDate, 0)\n}\n\ntype UCSUserAccess struct {\n    Access                 map[string]string  `json:\"access\"`\n    SubscriptionGroupDates map[string]GroupID `json:\"subscription_group_dates\"`\n}\n\nfunc main() {\n    str := `{\n\"access\": {\n      \"STOCK\": \"1\",\n      \"FOREX\": \"1\",\n      \"WEBFOREX\": \"1\",\n      \"WEBSTOCK\": \"1\"\n    },\n\"subscription_group_dates\": {\n      \"32\": {\n            \"START_DATE\": 1464753600,\n            \"END_DATE\": 1472616000\n            },\n      \"42\": {\n            \"START_DATE\": 1470024000,\n            \"END_DATE\": 1472616000\n          }\n    }\n    }`\n    var d UCSUserAccess\n    err := json.Unmarshal([]byte(str), &amp;d)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(d)\n    gID := d.SubscriptionGroupDates[\"32\"]\n    fmt.Println(gID.Start())\n\n    fmt.Println()\n    body, err := json.Marshal(d)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(body))\n}\n</code></pre>\n\n<hr>\n\n<p>4- You may use <code>Int64</code> with receiver method, like this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\ntype Int64 int64\ntype GroupID struct {\n    StartDate Int64 `json:\"START_DATE\"`\n    EndDate   Int64 `json:\"END_DATE\"`\n}\n\nfunc (t *Int64) Time() time.Time {\n    return time.Unix(int64(*t), 0).UTC()\n}\n\ntype UCSUserAccess struct {\n    Access                 map[string]string  `json:\"access\"`\n    SubscriptionGroupDates map[string]GroupID `json:\"subscription_group_dates\"`\n}\n\nfunc main() {\n    str := `{\n\"access\": {\n      \"STOCK\": \"1\",\n      \"FOREX\": \"1\",\n      \"WEBFOREX\": \"1\",\n      \"WEBSTOCK\": \"1\"\n    },\n\"subscription_group_dates\": {\n      \"32\": {\n            \"START_DATE\": 1464753600,\n            \"END_DATE\": 1472616000\n            },\n      \"42\": {\n            \"START_DATE\": 1470024000,\n            \"END_DATE\": 1472616000\n          }\n    }\n    }`\n    var d UCSUserAccess\n    err := json.Unmarshal([]byte(str), &amp;d)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(d)\n    gID := d.SubscriptionGroupDates[\"32\"]\n    fmt.Println(gID.StartDate.Time())\n\n    fmt.Println()\n    body, err := json.Marshal(d)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(body))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 5, "last_activity_date": 1471285503, "last_edit_date": 1495542809, "creation_date": 1471285503, "answer_id": 38960747, "question_id": 38959644, "link": "https://stackoverflow.com/questions/38959644/convert-struct-to-json-in-golang/38960747#38960747", "title": "Convert Struct to JSON in Golang", "body": "<p>Your structure is a bit off.  SubscriptionGroupDates, specifically, is a map of string to a structure, and the structure itself is either a map of strings to ints, or a static structure with two int fields.  You have a second struct nested, and your dates are specified as maps when they should just be ints:</p>\n\n<pre><code>type UCSUserAccess struct {\n    Groups                 map[string]string  `json:\"groups\"`\n    Access                 map[string]string  `json:\"access\"`\n    IsExpert               string             `json:\"isExpert\"`\n    SubscriptionGroupDates map[string]GroupID `json:\"subscription_group_dates\"`\n}\n\ntype GroupID struct {\n    StartDate int `json:\"START_DATE\"`\n    EndDate   int `json:\"END_DATE\"`\n}\n</code></pre>\n\n<p>This gives the JSON as you expect.  Example: <a href=\"https://play.golang.org/p/rGm7zKJypk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rGm7zKJypk</a> (run the output through jsonlint.com to verify it comes out how you wanted).</p>\n\n<p>As for the timestamp, your timestamps in the JSON are stored as Unix timestamps.  In order to get those into a time.Time, you need to parse them yourself, either after unmarshalling, or by implementing the <code>json.Unmarshaller</code> interface on a custom time type.  See <a href=\"https://stackoverflow.com/questions/25087960/json-unmarshal-time-that-isnt-in-rfc-3339-format\">this answer</a> for details on how to do that.</p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 2014640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/231f12584c6c45ca62a176ba332eaca0?s=128&d=identicon&r=PG", "display_name": "John Murphy", "link": "https://stackoverflow.com/users/2014640/john-murphy"}, "is_accepted": false, "score": 1, "last_activity_date": 1471320024, "last_edit_date": 1471320024, "creation_date": 1471287372, "answer_id": 38961223, "question_id": 38959644, "link": "https://stackoverflow.com/questions/38959644/convert-struct-to-json-in-golang/38961223#38961223", "title": "Convert Struct to JSON in Golang", "body": "<p>You could create your own date simple by supplying UnmarshalJSON and MarshalJSON methods.  You can format the handle the input and format the output in any way you please. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype Date struct {\n    year  int\n    month int\n    day   int\n}\n\nfunc (t *Date) UnmarshalJSON(data []byte) (e error) {\n    trimmed := string(data)\n    trimmed = strings.TrimLeft(trimmed, \"\\\"\")\n    trimmed = strings.TrimRight(trimmed, \"\\\"\")\n\n    parts := strings.Split(trimmed, \"-\")\n\n    t.year, _ = strconv.Atoi(parts[0])\n    t.month, _ = strconv.Atoi(parts[1])\n    t.day, _ = strconv.Atoi(parts[2])\n\n    return\n}\n\nfunc (t *Date) MarshalJSON() (buff []byte, e error) {\n    buff = []byte(fmt.Sprintf(\"\\\"%d-%d-%d\\\"\", t.year, t.month, t.day))\n    return\n}\n\ntype Foo struct {\n    Groups map[string]string `json:\"groups\"`\n    Date   Date              `json:\"date\"`\n}\n\nfunc main() {\n\n    f := Foo{\n        Groups: map[string]string{\n            \"group1\": \"bar\",\n            \"group2\": \"baz\",\n        },\n        Date: Date{year: 2016, month: 12, day: 22},\n    }\n\n    buff, _ := json.Marshal(&amp;f)\n\n    fmt.Println(string(buff))\n\n    json.Unmarshal(buff, &amp;f)\n\n    fmt.Printf(\"%+v\", f)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 4995879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-qTH7g1and7w/AAAAAAAAAAI/AAAAAAAAAAA/lYXDvq3wrrQ/photo.jpg?sz=128", "display_name": "Rick Mason", "link": "https://stackoverflow.com/users/4995879/rick-mason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15403, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1471321364, "creation_date": 1471280998, "last_edit_date": 1471320006, "question_id": 38959644, "link": "https://stackoverflow.com/questions/38959644/convert-struct-to-json-in-golang", "title": "Convert Struct to JSON in Golang", "body": "<p>New to Golang here and I'm trying to get a struct to convert to a JSON object that one of my other applications will consume. </p>\n\n<p>The expected response will look something like this...</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\"access\": {\n      \"STOCK\": \"1\",\n      \"FOREX\": \"1\",\n      \"WEBFOREX\": \"1\",\n      \"WEBSTOCK\": \"1\"\n    },\n\"subscription_group_dates\": {\n      \"32\": {\n            \"START_DATE\": 1464753600,\n            \"END_DATE\": 1472616000\n            },\n      \"42\": {\n            \"START_DATE\": 1470024000,\n            \"END_DATE\": 1472616000\n          }\n    }\n</code></pre>\n\n<p>I have left in the \"access\" part of the object to show the parts I know work. Everything else has been omitted for brevity.  The tough part for me is handling the nesting nature of structs in golang... The following Struct I think will work, but I'm not sure about the syntax. </p>\n\n<p>Under the SubscriptionGroupDates Type... can I use map[string]struct and embed the rest as shown?. see below</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type UCSUserAccess struct {\n    Groups          map[string]string           `json:\"groups\"`\n    Access          map[string]string           `json:\"access\"`\n    IsExpert        string                      `json:\"isExpert\"`\n    SubscriptionGroupDates map[string]struct {\n        GroupID struct {\n            StartDate map[string]int `START_DATE`\n            EndDate   map[string]int `END_DATE`\n            }\n    } `json:\"subscription_group_dates\"`\n}\n</code></pre>\n\n<p>In addition... I have imported the \"time\" library in the import section. How would I use that to declare the dates as time objects? (instead of map[string]int)</p>\n\n<p>Thanks</p>\n"}, {"tags": ["android", "go"], "comments": [{"owner": {"reputation": 5926, "user_id": 174843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e90f42b582744131475090c31d95551?s=128&d=identicon&r=PG", "display_name": "Vince Bowdren", "link": "https://stackoverflow.com/users/174843/vince-bowdren"}, "edited": false, "score": 2, "creation_date": 1471278975, "post_id": 38959067, "comment_id": 65272573, "body": "Hi Cucumber, and welcome to Stack Overflow. About the image you have linked - it would be better if you copy the console log and error message, in full, into your question. That way anybody can get the complete question information in one place, without having to refer to any other site."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1529891"}, "is_accepted": false, "score": 1, "last_activity_date": 1487293485, "creation_date": 1487293485, "answer_id": 42287588, "question_id": 38959067, "link": "https://stackoverflow.com/questions/38959067/dns-lookup-issue-when-running-my-go-app-in-termux/42287588#42287588", "title": "DNS lookup issue when running my Go app in Termux", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Localhost\" rel=\"nofollow noreferrer\">Your phone is trying to connect to itself</a>: <code>[::1]:39143-&gt;[::1]:53</code></p>\n\n<p>My guess is your phone is probably not running a local DNS server and so you get the <code>connection refused</code> error.</p>\n\n<p>Your <code>nslookup</code> is irrelevant because you connected directly to <code>8.8.8.8</code>. Instead, try <code>nslookup ::1</code> or <code>dig @::1 google.com A</code></p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 6718570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4488b6949f5f300f8e684b873deeb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Cucumber", "link": "https://stackoverflow.com/users/6718570/cucumber"}, "edited": false, "score": 0, "creation_date": 1521274937, "post_id": 49315513, "comment_id": 85669449, "body": "Thanks a lot! I believe this got fixed in the recent termux."}, {"owner": {"reputation": 2141, "user_id": 2587343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52874e9b4f06834f233ea323925fd305?s=128&d=identicon&r=PG", "display_name": "Vlastimil Ov\u010d&#225;\u010d&#237;k", "link": "https://stackoverflow.com/users/2587343/vlastimil-ov%c4%8d%c3%a1%c4%8d%c3%adk"}, "reply_to_user": {"reputation": 83, "user_id": 6718570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4488b6949f5f300f8e684b873deeb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Cucumber", "link": "https://stackoverflow.com/users/6718570/cucumber"}, "edited": false, "score": 1, "creation_date": 1524325405, "post_id": 49315513, "comment_id": 86931001, "body": "@Cucumber I don&#39;t think this got fixed at all (e.g. <a href=\"https://github.com/termux/termux-packages/commit/70dae767351e8909a5ac7d1eba064db294cd5b8f\" rel=\"nofollow noreferrer\">this</a>). According to <a href=\"https://github.com/termux/termux-app/issues/210\" rel=\"nofollow noreferrer\">termux/termux-app#210</a> you need to compile with <a href=\"https://github.com/termux/termux-packages/tree/master/packages/golang\" rel=\"nofollow noreferrer\">termux-golang package</a> so you get linked to termux libc. I assume that the libc will detect and use <code>$TERMUX_PREFIX&#47;etc&#47;resolv.conf</code>. At least thats the <a href=\"https://github.com/termux/termux-packages/blob/master/packages/resolv-conf/build.sh\" rel=\"nofollow noreferrer\">termux way</a>."}, {"owner": {"reputation": 2141, "user_id": 2587343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52874e9b4f06834f233ea323925fd305?s=128&d=identicon&r=PG", "display_name": "Vlastimil Ov\u010d&#225;\u010d&#237;k", "link": "https://stackoverflow.com/users/2587343/vlastimil-ov%c4%8d%c3%a1%c4%8d%c3%adk"}, "edited": false, "score": 0, "creation_date": 1524325550, "post_id": 49315513, "comment_id": 86931042, "body": "You might need root and remount <code>&#47;system</code> temporarily if it is <a href=\"https://stackoverflow.com/a/8534641/2587343\">read-only</a>."}, {"owner": {"reputation": 136, "user_id": 1120148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a50efc32c17fb182d769c6d8e0ea59?s=128&d=identicon&r=PG", "display_name": "Absurdev", "link": "https://stackoverflow.com/users/1120148/absurdev"}, "edited": false, "score": 0, "creation_date": 1572976121, "post_id": 49315513, "comment_id": 103726766, "body": "What other workarounds are possible on a <i>non rooted</i> phone? Is it to change the default DNS server at build time?"}], "tags": [], "owner": {"reputation": 136, "user_id": 2432452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149cb99ead3e54e95181f0b6ed2d7188?s=128&d=identicon&r=PG", "display_name": "woohaha", "link": "https://stackoverflow.com/users/2432452/woohaha"}, "is_accepted": true, "score": 6, "last_activity_date": 1521186437, "creation_date": 1521186437, "answer_id": 49315513, "question_id": 38959067, "link": "https://stackoverflow.com/questions/38959067/dns-lookup-issue-when-running-my-go-app-in-termux/49315513#49315513", "title": "DNS lookup issue when running my Go app in Termux", "body": "<p>Just create <code>/etc/resolv.conf</code> and append <code>nameserver 8.8.8.8</code>\nthen this problem will be resolved.</p>\n\n<p>According to <a href=\"https://golang.org/src/net/dnsconfig_unix.go\" rel=\"noreferrer\">src/net/dnsclient_unix.go</a>, if <code>/etc/resolv.conf</code> is absent, <code>localhost:53</code> is chosen as a name server.</p>\n\n<p>Since the Linux in Android is not so \"standard\". <code>/etc/resolv.conf</code> is not available. The app then just keep looking up host in localhost:53.</p>\n"}, {"tags": [], "owner": {"reputation": 497, "user_id": 4213397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-lWHCkEp656A/AAAAAAAAAAI/AAAAAAAAABU/tRO9MZnEIVc/photo.jpg?sz=128", "display_name": "Hirbod Behnam", "link": "https://stackoverflow.com/users/4213397/hirbod-behnam"}, "is_accepted": false, "score": 1, "last_activity_date": 1600242010, "creation_date": 1600242010, "answer_id": 63915298, "question_id": 38959067, "link": "https://stackoverflow.com/questions/38959067/dns-lookup-issue-when-running-my-go-app-in-termux/63915298#63915298", "title": "DNS lookup issue when running my Go app in Termux", "body": "<p>I also found that <code>proot</code> could be used in order to load the <code>resolv.conf</code>. Example:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>pkg install proot resolv-conf\nproot -b $PREFIX/etc/resolv.conf:/etc/resolv.conf ./fastnet\n</code></pre>\n<p><a href=\"https://github.com/termux/termux-app/issues/869#issuecomment-433985523\" rel=\"nofollow noreferrer\">Source</a></p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 6926677, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TwIsI.jpg?s=128&g=1", "display_name": "Adzimzf", "link": "https://stackoverflow.com/users/6926677/adzimzf"}, "is_accepted": false, "score": 0, "last_activity_date": 1604015213, "creation_date": 1604015213, "answer_id": 64600775, "question_id": 38959067, "link": "https://stackoverflow.com/questions/38959067/dns-lookup-issue-when-running-my-go-app-in-termux/64600775#64600775", "title": "DNS lookup issue when running my Go app in Termux", "body": "<p>I solved my problem using <code>termux-chroot</code>, you can find the detail here <a href=\"https://wiki.termux.com/wiki/Differences_from_Linux\" rel=\"nofollow noreferrer\">https://wiki.termux.com/wiki/Differences_from_Linux</a></p>\n"}], "owner": {"reputation": 83, "user_id": 6718570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4488b6949f5f300f8e684b873deeb7c?s=128&d=identicon&r=PG&f=1", "display_name": "Cucumber", "link": "https://stackoverflow.com/users/6718570/cucumber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3821, "favorite_count": 3, "accepted_answer_id": 49315513, "answer_count": 4, "score": 8, "last_activity_date": 1612121104, "creation_date": 1471278674, "last_edit_date": 1612121104, "question_id": 38959067, "link": "https://stackoverflow.com/questions/38959067/dns-lookup-issue-when-running-my-go-app-in-termux", "title": "DNS lookup issue when running my Go app in Termux", "body": "<p>I am trying to write a Go App that lets me spawn Digital Ocean droplets. It works fine on my desktop and laptop, but when I try to run it on my Android phone in Termux I get the issue shown in the image. I already filed an issue on their GitHub, but I am not sure if this is related to Termux or if I am missing something.</p>\n<p>Here is part of the error:</p>\n<blockquote>\n<p>dial tcp: lookup api.digitalocean.com on [::1]:53: read udp [::1]:39143-&gt;[::1]:53: read: connection refused</p>\n</blockquote>\n<p>Not sure why it is trying to use localhost as a dns server. Here is the log:</p>\n<pre><code>Preparing to unpack .../resolv-conf_1.0_aarch64.deb ...\nUnpacking resolv-conf (1.0) ...\n\nSelecting previously unselected package dnsutils.\nPreparing to unpack .../dnsutils_9.10.4-1_aarch64.deb ...\n\nUnpacking dnsutils (9.10.4-1) ...\nSetting up ca-certificates (20160429) ...\nSetting up openssl (1.0.2h-1) ...\nSetting up resolv-conf (1.0) ...\nSetting up dnsutils (9.10.4-1) ...\n\n$ ./fastnet\n2016/08/15 02:28:53 Get https://api.digitalocean.com/v2/images?private=true: dial tcp: lookup api.digitalocean.com on [::1]:53: read udp [::1]:39143-&gt;[::1]:53: read: connection refused\n\n$ nslookup google.com\nServer:         8.8.8.8\nAddress:        8.8.8.8#53\n\nNon-authoritative answer:\nName:   google.com\nAddress: 216.58.194.174\n</code></pre>\n"}, {"tags": ["go", "enums", "type-conversion", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 9786, "user_id": 8986, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MZj47.png?s=128&g=1", "display_name": "Juve", "link": "https://stackoverflow.com/users/8986/juve"}, "edited": false, "score": 0, "creation_date": 1471278505, "post_id": 38958767, "comment_id": 65272300, "body": "Yes! I now also found the <code>X_name</code> map and use <code>if _, ok := X_name[int32(v)]; ok { return X(v), nil } </code> to test the values. Btw. if you want the credit for this answer you should stick to the example. And are you sure about your <code>found, _</code> statement. I guess you need to write <code>_, found</code> here."}], "tags": [], "owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "is_accepted": true, "score": 2, "last_activity_date": 1471282126, "last_edit_date": 1471282126, "creation_date": 1471277518, "answer_id": 38958767, "question_id": 38957169, "link": "https://stackoverflow.com/questions/38957169/go-best-practice-for-safely-converting-integers-to-protocol-buffer-enum-values/38958767#38958767", "title": "Go: best practice for safely converting integers to protocol buffer enum values", "body": "<p>I do not know which proto generation package you are using, but with <code>github.com/golang/protobuf/proto</code> you also get the reverse mapping of enums.</p>\n\n<p>Example xyz.pb.go generated file:</p>\n\n<pre><code>type TimeInterval int32\n\nconst (\n    TimeInterval_TI_UNKNOWN TimeInterval = 0\n    TimeInterval_TI_HOUR    TimeInterval = 1\n    TimeInterval_TI_DAY     TimeInterval = 2\n    TimeInterval_TI_WEEK    TimeInterval = 3\n    TimeInterval_TI_MONTH   TimeInterval = 4\n    TimeInterval_TI_QUARTER TimeInterval = 5\n    TimeInterval_TI_YEAR    TimeInterval = 6\n)\n\nvar TimeInterval_name = map[int32]string{\n    0: \"TI_UNKNOWN\",\n    1: \"TI_HOUR\",\n    2: \"TI_DAY\",\n    3: \"TI_WEEK\",\n    4: \"TI_MONTH\",\n    5: \"TI_QUARTER\",\n    6: \"TI_YEAR\",\n}\nvar TimeInterval_value = map[string]int32{\n    \"TI_UNKNOWN\": 0,\n    \"TI_HOUR\":    1,\n    \"TI_DAY\":     2,\n    \"TI_WEEK\":    3,\n    \"TI_MONTH\":   4,\n    \"TI_QUARTER\": 5,\n    \"TI_YEAR\":    6,\n}\n\nfunc (x TimeInterval) String() string {\n    return proto.EnumName(TimeInterval_name, int32(x))\n}\nfunc (TimeInterval) EnumDescriptor() ([]byte, []int) { return fileDescriptor0, []int{0} }\n</code></pre>\n\n<p>So with this you could test for existence in the following manner:</p>\n\n<pre><code>if _, found := TimeInterval_name[testinputint]; found{\n    //all ok\n} else {\n   //not a value for this enum\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 18703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/45b0ee94acfbcc06f333f2daf03d4c91?s=128&d=identicon&r=PG", "display_name": "Hace", "link": "https://stackoverflow.com/users/18703/hace"}, "is_accepted": false, "score": 0, "last_activity_date": 1495545695, "creation_date": 1495545695, "answer_id": 44136086, "question_id": 38957169, "link": "https://stackoverflow.com/questions/38957169/go-best-practice-for-safely-converting-integers-to-protocol-buffer-enum-values/44136086#44136086", "title": "Go: best practice for safely converting integers to protocol buffer enum values", "body": "<p>Yes as @RickyA mentions using a range is nice as it verifies for all the possible underlying const values.</p>\n\n<p>Additionally you could check the length of the enum, although that would only be possible when the underlying enum values do not have any 'gaps' and have a consequitive range of numbers.</p>\n\n<p>Verbose explanation via code:</p>\n\n<pre><code>typelength := int32(len(TimeInterval_name))\nif testinputint &lt; 0 || int32(testinputint) &gt;= typelength {\n    // not a value for this enum, return err\n}\n</code></pre>\n\n<p>A bit less verbose, and just using int instead of int32</p>\n\n<pre><code>if testinputint &lt; 0 || int(testinputint) &gt;= len(TimeInterval_name) {\n    // not a value for this enum, return err \n}\n</code></pre>\n\n<p>But as said, this will only be valid for enums that adhere to a proper iota. That might not be the case when you have changed your enum to read something like this:</p>\n\n<pre><code>var TimeInterval_name = map[int32]string{\n    0: \"TI_UNKNOWN\",\n    1: \"TI_HOUR\",\n    2: \"TI_DAY\",\n    3: \"TI_WEEK\",\n    // we do not use month anymore 4: \"TI_MONTH\",\n    5: \"TI_QUARTER\",\n    6: \"TI_YEAR\",\n}\n</code></pre>\n\n<p>as the length of the generated map will be clearly less than six :)</p>\n\n<p>In other words use the found method of @Ricky_A above to keep on the safe side.</p>\n"}], "owner": {"reputation": 9786, "user_id": 8986, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MZj47.png?s=128&g=1", "display_name": "Juve", "link": "https://stackoverflow.com/users/8986/juve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4703, "favorite_count": 0, "accepted_answer_id": 38958767, "answer_count": 2, "score": 3, "last_activity_date": 1495545695, "creation_date": 1471271698, "last_edit_date": 1471278211, "question_id": 38957169, "link": "https://stackoverflow.com/questions/38957169/go-best-practice-for-safely-converting-integers-to-protocol-buffer-enum-values", "title": "Go: best practice for safely converting integers to protocol buffer enum values", "body": "<p>I have an enum in a proto file that generates to integer constants in the pb.go file. I now have some integers coming from the an external data source and want to safely map them to the possible constants.</p>\n\n<p>Here is what I currently have: <a href=\"https://play.golang.org/p/-5VZqPbukd\" rel=\"nofollow\">https://play.golang.org/p/-5VZqPbukd</a></p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\n//enum in the proto file\n//\n// enum X {\n//    A = 0;\n//    B = 1;\n//    C = 2;\n//    D = 3;\n// }\n\n//enum type generated by protoc\ntype X int32\n\n//enum constants generated by protoc\nconst (\n    X_A X = 0\n    X_B X = 1\n    X_C X = 2\n    X_D X = 3\n)\n\nfunc intToX(v int) (X, error) {\n    x := X(v)\n    switch x {\n    case X_A, X_B, X_C, X_D:\n        return x, nil\n    }\n    return 0, errors.New(\"could not convert int to X\")\n}\n\nfunc main() {\n    for i := -1; i &lt; 10; i++ {\n        if x, err := intToX(i); err != nil {\n            fmt.Println(\"unhandled error:\", err, \"for input value\", i)\n        } else {\n            fmt.Printf(\"%d =&gt; X(%d)\\n\", i, x)\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Question</strong>: Is there a better, more idiomatic way to map incoming integer values to protoc-generated constants?</p>\n\n<p>In particular, I would like to avoid listing all constants explicitly in the <code>case A, B, C, D</code> statement.</p>\n"}, {"tags": ["mysql", "google-app-engine", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471270645, "post_id": 38956385, "comment_id": 65267677, "body": "Are you using go-sql-driver (<code>&quot;github.com&#47;go-sql-driver&#47;mysql&quot;</code>) or mymysql driver (<code>&quot;github.com&#47;ziutek&#47;mymysql&#47;godrv&quot;</code>)?"}, {"owner": {"reputation": 63, "user_id": 4765450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b689319ab53a3bbd2fbbc8a12be2610?s=128&d=identicon&r=PG&f=1", "display_name": "lflahive", "link": "https://stackoverflow.com/users/4765450/lflahive"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471271000, "post_id": 38956385, "comment_id": 65267885, "body": "github.com/go-sql\u200c\u200b-driver/mysql, do I need to use github.com/ziutek\u200c\u200b/mymysql/godrv with GAE?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471271163, "post_id": 38956385, "comment_id": 65267998, "body": "No, both work well with Cloud SQL, but they require different syntax to define the data source. Yours look fine however, are you sure user is <code>root</code>, and project id and instance name are correct?"}, {"owner": {"reputation": 63, "user_id": 4765450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b689319ab53a3bbd2fbbc8a12be2610?s=128&d=identicon&r=PG&f=1", "display_name": "lflahive", "link": "https://stackoverflow.com/users/4765450/lflahive"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471271408, "post_id": 38956385, "comment_id": 65268156, "body": "Yep only user is currently root (I connect to the Cloud SQL instance via IP using the local GAE server and it works fine) and have checked the project id / instance name multiple times they&#39;re identical so I can&#39;t see that being the issue."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471272012, "post_id": 38956385, "comment_id": 65268535, "body": "Are your app and Cloud SQL instance in the same region? Have you granted your app access to the SQL instance?"}, {"owner": {"reputation": 63, "user_id": 4765450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b689319ab53a3bbd2fbbc8a12be2610?s=128&d=identicon&r=PG&f=1", "display_name": "lflahive", "link": "https://stackoverflow.com/users/4765450/lflahive"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471272289, "post_id": 38956385, "comment_id": 65268707, "body": "Yeah both are us-central and they&#39;re in the same project so they have access by default I believe, going off of the access control of the SQL instance: &quot;App Engine authorization All apps in this project are authorized by default. To authorize apps in other projects, follow the steps below.&quot;"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471272434, "post_id": 38956385, "comment_id": 65268804, "body": "See this page how to grant access: <a href=\"https://cloud.google.com/sql/docs/app-engine-connect\" rel=\"nofollow noreferrer\">Connecting from Google App Engine</a> (note: different steps for first and second generation instances)."}, {"owner": {"reputation": 63, "user_id": 4765450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b689319ab53a3bbd2fbbc8a12be2610?s=128&d=identicon&r=PG&f=1", "display_name": "lflahive", "link": "https://stackoverflow.com/users/4765450/lflahive"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471301143, "post_id": 38956385, "comment_id": 65283098, "body": "Yeah I had seen that before asking here I am currently using Gen 2 which the first step is: &quot;If your application is in the same project as your Cloud SQL instance, you can proceed to step 2.&quot; which just gives you the connection code? The only thing I don&#39;t understand is that sql.Open doesn&#39;t cause an error, but trying to use db afterwards does?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471328140, "post_id": 38956385, "comment_id": 65289616, "body": "That is normal. <code>sql.Open()</code> just validates its arguments, but it does not open a connection. For that you may use <code>DB.Ping()</code>. See this answer for details: <a href=\"http://stackoverflow.com/a/32345607/1705598\">Why does sql.Open() return nil as error when it should not?</a>"}, {"owner": {"reputation": 63, "user_id": 4765450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b689319ab53a3bbd2fbbc8a12be2610?s=128&d=identicon&r=PG&f=1", "display_name": "lflahive", "link": "https://stackoverflow.com/users/4765450/lflahive"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471336345, "post_id": 38956385, "comment_id": 65293971, "body": "Hey @icza have found the issue! I needed to change my dbcloud env_variable to include my region even though they&#39;re both in us_central? So now it goes &#39;projectid:regionname:instancename&#39; and works... Thank you so much for your time though even though it was just a silly mistake by me!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471336414, "post_id": 38956385, "comment_id": 65294005, "body": "Glad you solved your issue. Please post your solution as an answer so others can benefit from it."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4765450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b689319ab53a3bbd2fbbc8a12be2610?s=128&d=identicon&r=PG&f=1", "display_name": "lflahive", "link": "https://stackoverflow.com/users/4765450/lflahive"}, "is_accepted": true, "score": 3, "last_activity_date": 1471336719, "creation_date": 1471336719, "answer_id": 38970202, "question_id": 38956385, "link": "https://stackoverflow.com/questions/38956385/google-app-engine-golang-driver-bad-connection/38970202#38970202", "title": "google app engine golang, driver: bad connection", "body": "<p>I ended up needing to change my dbcloud variable to include the region of the SQL server changing it from:</p>\n\n<pre><code>'projectid:instancename'\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>'projectid:regionname:instancename'\n</code></pre>\n\n<p>No idea why I need to do this as it's not in the docs of <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow\">https://github.com/go-sql-driver/mysql</a> but is all working now!</p>\n"}], "owner": {"reputation": 63, "user_id": 4765450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b689319ab53a3bbd2fbbc8a12be2610?s=128&d=identicon&r=PG&f=1", "display_name": "lflahive", "link": "https://stackoverflow.com/users/4765450/lflahive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2084, "favorite_count": 1, "accepted_answer_id": 38970202, "answer_count": 1, "score": 3, "last_activity_date": 1471336719, "creation_date": 1471269168, "last_edit_date": 1471336567, "question_id": 38956385, "link": "https://stackoverflow.com/questions/38956385/google-app-engine-golang-driver-bad-connection", "title": "google app engine golang, driver: bad connection", "body": "<p>I have some code that is working on the local GAE server but once I publish it to GAE it throws the error \"driver: bad connection\".</p>\n\n<p>Below code generates a new *sql.DB:</p>\n\n<pre><code>func NewDb() (*sql.DB, error) {\n  cloud := os.Getenv(\"dbcloud\")\n  local := os.Getenv(\"dblocal\")\n  if appengine.IsDevAppServer() {\n    return sql.Open(\"mysql\", \"root@tcp(\"+local+\":3306)/dbo\")\n  }\n  return sql.Open(\"mysql\", \"root@cloudsql(\"+cloud+\")/dbo\")\n}\n</code></pre>\n\n<p>In my app.yaml I have the following:</p>\n\n<pre><code>env_variables:\n  dbcloud: 'projectid:instancename'\n  dblocal: 'xxx.xxx.xxx.xxx'\n</code></pre>\n\n<p>It seems to return a new *sql.DB correctly but once I start using prepared statements is when things start to break.</p>\n\n<pre><code>db, err := NewDb() // err is nil\nstmt, err := db.Prepare(\"INSERT INTO dbo.Users (Id) VALUES (?)\") // err is driver: bad connection\n</code></pre>\n\n<p>I've been fighting with this for an hour now and i'm probably doing something very stupid any help would be appreciated!</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 4, "creation_date": 1471268940, "post_id": 38956290, "comment_id": 65266576, "body": "It&#39;s not JSON, it&#39;s a &quot;pretty printing&quot; representation of the object, that is only applicable for things like <code>println</code> and debug printing. It means nothing and there&#39;s no need to fix it in any way."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1471269032, "post_id": 38956290, "comment_id": 65266631, "body": "As @Not_a_Golfer wrote. Try to print only this: <code>fmt.Println(bytes.NewBufferString(...))</code> (insert your json there), it outputs: <code>[&quot;foobar&quot;:42]</code>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1471269098, "post_id": 38956290, "comment_id": 65266663, "body": "If you fear that this will be passed on to the server, fear not. The server will receive the body exactly as you&#39;ve encoded it."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 4, "last_activity_date": 1471321625, "creation_date": 1471321625, "answer_id": 38966649, "question_id": 38956290, "link": "https://stackoverflow.com/questions/38956290/golang-wraps-a-json-with-brackets/38966649#38966649", "title": "Golang wraps a JSON with brackets", "body": "<p>It's a pretty printing, see <code>func Println(a ...interface{}) (n int, err error)</code> Docs:</p>\n\n<blockquote>\n  <p>Println formats using the default formats for its operands and writes\n  to standard output. Spaces are always added between operands and a\n  newline is appended. It returns the number of bytes written and any\n  write error encountered.</p>\n</blockquote>\n\n<p>You may use <code>strings.Trim(st, \"{}\")</code> to remove <code>{}</code> from string.<br>\nYou may use <code>Marshal</code> and <code>Unmarshal</code> for JSON, like this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"strings\"\n)\n\ntype Foo struct {\n    Foobar int `json:\"foobar\"`\n}\n\nfunc main() {\n    str := `{ \n            \"Foobar\": 42  \n    }`\n    var d Foo\n    err := json.Unmarshal([]byte(str), &amp;d)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(d) // {42}\n\n    fmt.Println()\n    body, err := json.Marshal(d)\n    if err != nil {\n        panic(err)\n    }\n    st := string(body)\n    fmt.Println(st) //{\"foobar\":42}\n\n    fmt.Println(strings.Trim(st, \"{}\")) // \"foobar\":42\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>{42}\n\n{\"foobar\":42}\n\"foobar\":42\n</code></pre>\n"}], "owner": {"reputation": 2843, "user_id": 613461, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/wVevO.jpg?s=128&g=1", "display_name": "zmeda", "link": "https://stackoverflow.com/users/613461/zmeda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2582, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1471321677, "creation_date": 1471268793, "last_edit_date": 1471321677, "question_id": 38956290, "link": "https://stackoverflow.com/questions/38956290/golang-wraps-a-json-with-brackets", "title": "Golang wraps a JSON with brackets", "body": "<p>I'm totally new to Golang.</p>\n\n<p>I can not figure out how to prevent it to wrap JSON in the <code>{...}</code>.</p>\n\n<p>So example:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"bytes\"\n    \"fmt\"\n)\n\nfunc main() {\n    request, _ := http.NewRequest(\"POST\", \"http://example.com\", bytes.NewBufferString(`[\"foobar\":42]`))\n    fmt.Println(request)\n}\n</code></pre>\n\n<p>This example will output:</p>\n\n<pre><code>&amp;{POST http://example.com HTTP/1.1 1 1 map[] {[\"foobar\":42]} 13 [] false example.com map[] map[] &lt;nil&gt; map[]   &lt;nil&gt; &lt;nil&gt;}\n</code></pre>\n\n<p>As you can see our array (which is BTW valid JSON) is now wrapped into <code>{</code> and <code>}</code>. I ran out of ideas how to fix that.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1471283338, "post_id": 38958084, "comment_id": 65274829, "body": "Once it&#39;s been Unmarshalled, how are the values then made available?"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1471285266, "post_id": 38958084, "comment_id": 65275851, "body": "values can be available as interv:=C.interval or in loop for grp:=range C.groups{ for trg:=range grp{...}} Error is most likely cause of a typo-change all grope to group sure."}, {"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1471285691, "post_id": 38958084, "comment_id": 65276108, "body": "I don&#39;t think it is a typo, it happens regardless of the name of the next struct. I think this is because all this code is in main.go?"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 9, "last_activity_date": 1471285216, "last_edit_date": 1471285216, "creation_date": 1471274765, "answer_id": 38958084, "question_id": 38955605, "link": "https://stackoverflow.com/questions/38955605/reading-a-slice-of-maps-with-golang-viper/38958084#38958084", "title": "Reading a slice of maps with Golang Viper", "body": "<p>Instead of call raw Get and then decide what exactly you get I'd suggest first describe your desired config structure, something like</p>\n\n<pre><code>type config struct {\n    interval int `mapstructure:\"Interval\"`\n    statsdPrefix string `mapstructure:\"statsd_prefix\"`\n    groups []group\n}\ntype group struct {\n    group string `mapstructure:\"group\"`\n    targetPrefix string `mapstructure:\"target_prefix\"`\n    targets []target\n}\ntype target struct {\n    target string `mapstructure:\"target\"`\n    hosts []string `mapstructure:\"hosts\"`\n}\n</code></pre>\n\n<p>and than unmarshall(decode) in it</p>\n\n<pre><code>var C config\n\nerr := viper.Unmarshal(&amp;C)\nif err != nil {\n    t.Fatalf(\"unable to decode into struct, %v\", err)\n}\n</code></pre>\n\n<p>assuming decoder is smart enough to unmurshall in provided structure if it possible and meaningful.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 10224365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567118375c93d6baa4d7f5eb261f8799?s=128&d=identicon&r=PG&f=1", "display_name": "manamana", "link": "https://stackoverflow.com/users/10224365/manamana"}, "is_accepted": false, "score": 4, "last_activity_date": 1592511554, "creation_date": 1592511554, "answer_id": 62458718, "question_id": 38955605, "link": "https://stackoverflow.com/questions/38955605/reading-a-slice-of-maps-with-golang-viper/62458718#62458718", "title": "Reading a slice of maps with Golang Viper", "body": "<p>The question is a bit older, but I figured since I stumbled upon this, somebody else might come here looking...</p>\n\n<p>The primary issue in the original question is that this JSON notation defines a list, not a map:</p>\n\n<pre><code>hosts = [\n      \"dnsserver1\",\n      \"dnsserver2\"\n    ]\n</code></pre>\n\n<p>So the simple solution in this case is not to use <code>viper.GetStringMap(\"group\")</code>, but instead <code>viper.GetStringSlice(\"group\")</code>.</p>\n\n<p>A slice in GO is what most other programming languages refer to as an Array or a List.\nSo in this case, the Slice would then be <code>[\"dnsserver1\", \"dnsserver2\"]</code> .</p>\n\n<p>If you wanted to properly use the <code>GetStringMap()</code> function of viper, you need a different format in your config file, namely a map format:</p>\n\n<pre><code>\"hosts\": {\n    \"dnsserver1\": \"8.8.8.8\",\n    \"dnsserver2\": \"8.8.4.4\"\n  }\n</code></pre>\n\n<p>This can then be parsed using <code>viper.GetStringMap()</code> into a <code>map[string]string</code> Structure, which looks like this: <code>map[\"dnsserver1\":\"8.8.8.8\" \"dnsserver2\":\"8.8.4.4\"]</code>.\nYou could then access the map at a given key, like <code>map[\"dnsserver1\"]</code> which would give you a string containing \"8.8.8.8\".</p>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9437, "favorite_count": 0, "accepted_answer_id": 38958084, "answer_count": 2, "score": 4, "last_activity_date": 1592511554, "creation_date": 1471266099, "question_id": 38955605, "link": "https://stackoverflow.com/questions/38955605/reading-a-slice-of-maps-with-golang-viper", "title": "Reading a slice of maps with Golang Viper", "body": "<p>I'm using the excellent viper library from here: <a href=\"https://github.com/spf13/viper\" rel=\"nofollow\">https://github.com/spf13/viper</a></p>\n\n<p>I'm trying to read in a config file in hcl (although it could be a JSOn or YAML file as well) which looks like this:</p>\n\n<pre><code>interval = 10\nstatsd_prefix = \"pinger\"\n\n\n\ngroup \"dns\" {\n  target_prefix = \"ping\"\n  target \"dns\" {\n    hosts = [\n      \"dnsserver1\",\n      \"dnsserver2\"\n    ]\n  }\n}\n</code></pre>\n\n<p>The code I have so far looks like this:</p>\n\n<pre><code>viper.SetConfigName(\"config\")\nviper.AddConfigPath(\".\")\n\nerr := viper.ReadInConfig()\n\nif err != nil {\n  panic(fmt.Errorf(\"Fatal error config file: %s \\n\", err))\n}\n\ninterval := viper.GetInt(\"interval\")\nprefix := viper.GetString(\"statsd_prefix\")\n\ngroups := viper.GetStringMap(\"group\")\n\nfmt.Println(interval)\nfmt.Println(prefix)\n</code></pre>\n\n<p>The big problem I'm having is with the group option. This can be multiple different groups.</p>\n\n<p>It doesn't seem to work when I read it in using <code>viper.GetStringMap</code>, so I used the standard <code>viper.Get</code> function. The resulting structure looks like this when dumped:</p>\n\n<pre><code>([]map[string]interface {}) (len=1 cap=1) {\n (map[string]interface {}) (len=1) {\n  (string) (len=3) \"dns\": ([]map[string]interface {}) (len=1 cap=2) {\n   (map[string]interface {}) (len=2) {\n    (string) (len=13) \"target_prefix\": (string) (len=4) \"ping\",\n    (string) (len=6) \"target\": ([]map[string]interface {}) (len=1 cap=1) {\n     (map[string]interface {}) (len=1) {\n      (string) (len=8) \"dns\": ([]map[string]interface {}) (len=1 cap=1) {\n       (map[string]interface {}) (len=1) {\n        (string) (len=5) \"hosts\": ([]interface {}) (len=2 cap=2) {\n         (string) (len=18) \"dnsserver1\",\n         (string) (len=18) \"dnsserver2\"\n        }\n       }\n      }\n     }\n    }\n   }\n  }\n }\n}\n</code></pre>\n\n<p>It seems to be of type slice when I use reflect. Do I need to cast it to a slice? How do I do that? Is there an easier way of managing a data structure like this?</p>\n\n<p>I'm completely new to golang, so please go easy on me :)</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1471266656, "last_edit_date": 1495541315, "creation_date": 1471266169, "answer_id": 38955621, "question_id": 38955383, "link": "https://stackoverflow.com/questions/38955383/appengine-datastore-byte-slice-vs-datastore-bytestring/38955621#38955621", "title": "AppEngine Datastore: byte slice vs datastore.ByteString", "body": "<p>The type <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#ByteString\" rel=\"nofollow noreferrer\"><code>datastore.ByteString</code></a> is really just a regular <code>[]byte</code> slice, see its declaration:</p>\n\n<pre><code>type ByteString []byte\n</code></pre>\n\n<p>The difference is that if you have a property of type <code>ByteString</code>, AppEngine will try to index it by default. Since datastore index entires have limited length, the length of a <code>ByteString</code> value can only be max 1500 bytes to be indexable.</p>\n\n<p><code>ByteString</code> also doesn't have any additional methods which would add some benefit besides the indexability.</p>\n\n<p>If you don't plan to index your property, simply use a <code>[]byte</code>. If you plan to index it because you want to search / filter by it, then you must use <code>ByteString</code>. This can be useful if for example you want to store hashes of some content (e.g. a file), and you want to search for a file based on its content hash. In this case a <code>ByteString</code> makes perfect sense and is most compact (compared to an alternative where you would store the hash as a <code>string</code> being the hexadecimal representation).</p>\n\n<p>Note that even if you use <code>ByteString</code>, you can still make the property unindexed by using <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">tags</a>, e.g.:</p>\n\n<pre><code>type MyEntity struct {\n    Something datastore.ByteString `datastore:\"something,noindex\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 38955621, "answer_count": 1, "score": 1, "last_activity_date": 1472922438, "creation_date": 1471265224, "last_edit_date": 1472922438, "question_id": 38955383, "link": "https://stackoverflow.com/questions/38955383/appengine-datastore-byte-slice-vs-datastore-bytestring", "title": "AppEngine Datastore: byte slice vs datastore.ByteString", "body": "<p>I require a property with a short sequence of bytes but I don't need an index on the property. The <code>datastore.ByteString</code> property type is meant for short sequences of bytes and is indexed whereas the normal <code>[]byte</code> property is meant for longer sequences of bytes and is <em>not</em> indexed.</p>\n\n<p>I'm compelled to use <code>[]byte</code> because I don't need the index and it'll save me the extra write-cost but is it better that I use <code>datastore.ByteString</code> because it's meant for short values? Are there any benefits to doing so?</p>\n"}, {"tags": ["ruby", "methods", "go", "reflection"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1471253194, "post_id": 38952419, "comment_id": 65259070, "body": "Well, you tagged the question with &quot;reflection&quot; so you seem to know where to look: <code>package reflect</code>. Especially <a href=\"https://golang.org/pkg/reflect/#Value.Method\" rel=\"nofollow noreferrer\">golang.org/pkg/reflect/#Value.Method</a> ."}], "answers": [{"comments": [{"owner": {"reputation": 991, "user_id": 1572028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3c18fd15010927238391dd5049f0d98?s=128&d=identicon&r=PG", "display_name": "user130268", "link": "https://stackoverflow.com/users/1572028/user130268"}, "edited": false, "score": 0, "creation_date": 1471255357, "post_id": 38952530, "comment_id": 65259995, "body": "Thank you. I just want to quickly take a look of all the methods or properties that I can use on a variable as I&#39;m currently learning Golang."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 991, "user_id": 1572028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3c18fd15010927238391dd5049f0d98?s=128&d=identicon&r=PG", "display_name": "user130268", "link": "https://stackoverflow.com/users/1572028/user130268"}, "edited": false, "score": 4, "creation_date": 1471255460, "post_id": 38952530, "comment_id": 65260058, "body": "@user130268 The documentation of the standard library is a better solution IMHO :)"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 6, "last_activity_date": 1471253522, "last_edit_date": 1471253522, "creation_date": 1471253203, "answer_id": 38952530, "question_id": 38952419, "link": "https://stackoverflow.com/questions/38952419/whats-the-golangs-equivalent-of-rubys-methods-method/38952530#38952530", "title": "What&#39;s the Golang&#39;s equivalent of Ruby&#39;s &quot;methods&quot; method?", "body": "<p>Yes, you can. With reflection, each <code>reflect.Type</code> object can enumerate all the methods the actual type exposes. but it's not a very common or idiomatic thing to do in Go:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Foo struct {\n}\n\nfunc (f Foo) Bar() {\n}\n\nfunc (f Foo) Baz() {\n}\n\nfunc main() {\n\n    t := reflect.TypeOf(Foo{})\n    for i := 0; i &lt; t.NumMethod(); i++ {\n        fmt.Println(t.Method(i).Name)\n    }\n}\n// Output:\n// Bar\n// Baz\n</code></pre>\n\n<p>This can also be done on <code>reflect.Value</code>, depending on what you need. </p>\n\n<p>But the real question is - what are you trying to achieve here? Are you trying to check if a type implements an interface or something like this? There probably is a simpler solution to your goal. What is your actual goal?</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1471258825, "creation_date": 1471258825, "answer_id": 38953825, "question_id": 38952419, "link": "https://stackoverflow.com/questions/38952419/whats-the-golangs-equivalent-of-rubys-methods-method/38953825#38953825", "title": "What&#39;s the Golang&#39;s equivalent of Ruby&#39;s &quot;methods&quot; method?", "body": "<p>If you only need this in development phase <a href=\"http://golang.org/s/using-guru\" rel=\"nofollow\">guru</a> development tool can help you a lot.</p>\n"}], "owner": {"reputation": 991, "user_id": 1572028, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3c18fd15010927238391dd5049f0d98?s=128&d=identicon&r=PG", "display_name": "user130268", "link": "https://stackoverflow.com/users/1572028/user130268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 38952530, "answer_count": 2, "score": 1, "last_activity_date": 1471258825, "creation_date": 1471252731, "question_id": 38952419, "link": "https://stackoverflow.com/questions/38952419/whats-the-golangs-equivalent-of-rubys-methods-method", "title": "What&#39;s the Golang&#39;s equivalent of Ruby&#39;s &quot;methods&quot; method?", "body": "<p>I'm playing with Golang and I want to know if there is a way that can list all the methods or properties I can use on a variable. In Ruby I can simply use <code>some_variable.methods</code> to get all the methods defined on <code>some_variable</code>. Is there a similar thing in Golang?</p>\n"}, {"tags": ["go", "conditional-compilation"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 1, "creation_date": 1471246657, "post_id": 38950909, "comment_id": 65256435, "body": "Strictly spoken no. There is no preprocessor, and therefore no preprocessor magic."}, {"owner": {"reputation": 693, "user_id": 1802697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eH3MJ.jpg?s=128&g=1", "display_name": "Igor Maznitsa", "link": "https://stackoverflow.com/users/1802697/igor-maznitsa"}, "edited": false, "score": 0, "creation_date": 1486904529, "post_id": 38950909, "comment_id": 71537735, "body": "like in Java there is not any embedded preprocessor in GoLang but also like Java it is possible to use 3th side similar tools. for instance I use <a href=\"https://github.com/raydac/mvn-golang/tree/master/mvn-golang-examples/mvn-golang-examples-preprocessing\" rel=\"nofollow noreferrer\">Java Comment Preprocessor + mvn-golang</a> and it makes good results"}], "answers": [{"comments": [{"owner": {"reputation": 55899, "user_id": 58961, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5be12a5a883043ee47443e93217504b6?s=128&d=identicon&r=PG", "display_name": "John Leidegren", "link": "https://stackoverflow.com/users/58961/john-leidegren"}, "edited": false, "score": 8, "creation_date": 1559639352, "post_id": 38951389, "comment_id": 99474862, "body": "If it&#39;s not obvious. You can declare a constant in these files as either true or false since they are mutually exclusive. You can then use that constant in an if-statement. Go will recognize that the if statement is always true or false depending on build tags and remove the code from non-debug builds, or vice versa."}], "tags": [], "owner": {"reputation": 471, "user_id": 6573268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44130f383b5f894f91a5d1984d9c6e9a?s=128&d=identicon&r=PG&f=1", "display_name": "aebudak", "link": "https://stackoverflow.com/users/6573268/aebudak"}, "is_accepted": true, "score": 33, "last_activity_date": 1471322441, "last_edit_date": 1471322441, "creation_date": 1471248153, "answer_id": 38951389, "question_id": 38950909, "link": "https://stackoverflow.com/questions/38950909/c-style-conditional-compilation-in-golang/38951389#38951389", "title": "C-style conditional compilation in golang", "body": "<p>Go does not have a preprocessor or a macro system. What you could do is pass in tags to go build through the <code>-tags</code> flag and use build constraints. To do this you would need two versions of the same source and only one would get build depending if the tag is present or not.</p>\n\n<p>Look at build constraints in <a href=\"https://golang.org/pkg/go/build/\" rel=\"noreferrer\">https://golang.org/pkg/go/build/</a></p>\n\n<p>main_debug.go</p>\n\n<pre><code>// +build debug\n\npackage main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Debug build\")\n}\n</code></pre>\n\n<p>main_release.go</p>\n\n<pre><code>// +build !debug\n\npackage main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Release build\")\n}\n</code></pre>\n\n<p>Here <code>go build</code> would compile with main_release.go and <code>go build -tags debug</code> would compile with main_debug.go</p>\n"}, {"comments": [{"owner": {"reputation": 612, "user_id": 5511137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52669f8524c53fd6a1451800dac0c45?s=128&d=identicon&r=PG&f=1", "display_name": "Roflcopter4", "link": "https://stackoverflow.com/users/5511137/roflcopter4"}, "edited": false, "score": 1, "creation_date": 1542772215, "post_id": 51929933, "comment_id": 93685000, "body": "This is something I have always wanted to do but the major downside that makes it impractical is the fact that linters don&#39;t understand m4 and will be terribly confused. Writing code without any linters giving real time feedback is obviously possible, but is rather unpleasant."}], "tags": [], "owner": {"reputation": 69, "user_id": 10249692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5004dabd21ed6ac048c7c7044b1576?s=128&d=identicon&r=PG", "display_name": "Hahahrf", "link": "https://stackoverflow.com/users/10249692/hahahrf"}, "is_accepted": false, "score": 5, "last_activity_date": 1543402535, "last_edit_date": 1543402535, "creation_date": 1534764964, "answer_id": 51929933, "question_id": 38950909, "link": "https://stackoverflow.com/questions/38950909/c-style-conditional-compilation-in-golang/51929933#51929933", "title": "C-style conditional compilation in golang", "body": "<p>if you work on <strong>linux</strong> or <strong>Mac</strong> , you can try the \"<strong>m4</strong>\" command.This command is a <strong>macro</strong> processor which just fits this issue.</p>\n\n<p>Writing a Makefile to run the m4 command before \"go build\" can do the same as using \"go build -tags ...\" and support more customization and of course, save your work.</p>\n\n<p>for example:</p>\n\n<p>write these within your go file(such as main.go):</p>\n\n<pre><code>define(DEBUG)\nifdef(`DEBUG',\n    fmt.Println(\"Debug message...\"); \n)\n</code></pre>\n\n<p>write these within your Makefile file:</p>\n\n<pre><code>all:*.go\n    mv main.go main.go.bak\n    m4 main.go.bak &gt; main.go\n    go build\n    mv main.go.bak main.go\n</code></pre>\n\n<p>then run \"make\".</p>\n\n<p>Disadvantage:</p>\n\n<ol>\n<li>You can't write a go function named \"define\" or \"ifndef\" etc which will be translated into Macro by m4.</li>\n<li>If you have a lot of files you may want to improve your Makefile.</li>\n<li>You may want to study m4 which is a little difficult and complicated.</li>\n</ol>\n"}], "owner": {"reputation": 1748, "user_id": 1077158, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1062d55a6ee0f0f6c71398be71fc86bd?s=128&d=identicon&r=PG", "display_name": "can.", "link": "https://stackoverflow.com/users/1077158/can"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13024, "favorite_count": 9, "accepted_answer_id": 38951389, "answer_count": 2, "score": 20, "last_activity_date": 1543402535, "creation_date": 1471245960, "last_edit_date": 1537247798, "question_id": 38950909, "link": "https://stackoverflow.com/questions/38950909/c-style-conditional-compilation-in-golang", "title": "C-style conditional compilation in golang", "body": "<p>Does golang support</p>\n\n<pre><code>#define DEBUG \n\n#ifdef DEBUG \n  fmt.Println(\"Debug message...\"); \n#endif \n</code></pre>\n\n<p>So I can build a debug version with zero runtime overhead?</p>\n"}, {"tags": ["go", "docker", "docker-compose", "docker-volume"], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 793024, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6518816315a3d94fecbb9365f7c176b5?s=128&d=identicon&r=PG", "display_name": "WooDzu", "link": "https://stackoverflow.com/users/793024/woodzu"}, "edited": false, "score": 0, "creation_date": 1471327960, "post_id": 38961508, "comment_id": 65289535, "body": "Hi @Kel Cecil and thanks for you post. Yeah was my oversight, thought this is part of the docker core."}], "tags": [], "owner": {"reputation": 174, "user_id": 2510038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ae9975ea868e41ea6aea30e5d85dad?s=128&d=identicon&r=PG", "display_name": "Kel Cecil", "link": "https://stackoverflow.com/users/2510038/kel-cecil"}, "is_accepted": true, "score": 2, "last_activity_date": 1471288485, "creation_date": 1471288485, "answer_id": 38961508, "question_id": 38950856, "link": "https://stackoverflow.com/questions/38950856/docker-error-volume-specifies-nonexistent-driver-inmemory/38961508#38961508", "title": "Docker ERROR: Volume specifies nonexistent driver inmemory", "body": "<p>The link you've provided points to <a href=\"https://docs.docker.com/registry/storage-drivers/inmemory/\" rel=\"nofollow\">storage drivers for Docker Registry</a>. You seem to want to mount a volume in a container which would require a <a href=\"https://docs.docker.com/engine/extend/plugins/\" rel=\"nofollow\">Docker Engine Volume Plugin</a>. These are two distinct types of plugins for two different applications and aren't interchangeable.</p>\n\n<p>You may be able to easily accomplish what you want by creating a RAM disk and using the Local Persist Plugin in Docker Engine.</p>\n"}], "owner": {"reputation": 4621, "user_id": 793024, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6518816315a3d94fecbb9365f7c176b5?s=128&d=identicon&r=PG", "display_name": "WooDzu", "link": "https://stackoverflow.com/users/793024/woodzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2445, "favorite_count": 0, "accepted_answer_id": 38961508, "answer_count": 1, "score": 0, "last_activity_date": 1471288485, "creation_date": 1471245711, "question_id": 38950856, "link": "https://stackoverflow.com/questions/38950856/docker-error-volume-specifies-nonexistent-driver-inmemory", "title": "Docker ERROR: Volume specifies nonexistent driver inmemory", "body": "<p>According to the docs there is a 'inmemory' driver for docker volumes:\n<a href=\"https://docs.docker.com/registry/storage-drivers/inmemory/\" rel=\"nofollow\">https://docs.docker.com/registry/storage-drivers/inmemory/</a></p>\n\n<blockquote>\n  <p>For purely tests purposes, you can use the inmemory storage driver.\n  This driver is an implementation of the storagedriver.StorageDriver\n  interface which uses local memory for object storage.</p>\n</blockquote>\n\n<p>But when trying to use it like so:</p>\n\n<pre><code>volumes:\n  ui-tmp-memory:\n    driver: inmemory\n</code></pre>\n\n<p>It gives me this output:</p>\n\n<pre><code>Creating volume \"myapp_ui-tmp-memory\" with inmemory driver\nERROR: Volume ui-tmp-memory specifies nonexistent driver inmemory\n</code></pre>\n\n<p>Am I missing something or do I need to install \"inmemory\" driver somehow?</p>\n"}, {"tags": ["go", "concurrency", "synchronization", "thread-safety"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1471294267, "post_id": 38950260, "comment_id": 65280467, "body": "Accessing any field in any language is unsafe - except maybe some pure functional languages like Erlang and Elixir or Haskell or some languages that have complex type systems that consider concurrency as part of their type system Like Pony or some languages like Rust that &quot;provide&quot; means to make concurrent access safe. So you should always consider pretty much everything concurrent-unsafe when using usual/mainstream programming languages."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1471247799, "last_edit_date": 1471247799, "creation_date": 1471243811, "answer_id": 38950501, "question_id": 38950260, "link": "https://stackoverflow.com/questions/38950260/is-this-thread-safe-with-concurrent-access/38950501#38950501", "title": "Is this thread-safe with concurrent access?", "body": "<p>Yes, if only those 3 methods access the <code>count</code> field, your solution is safe to use concurrently from multiple goroutines.</p>\n\n<p>But know that the value returned by <code>Status.Get()</code> may be \"outdated\" by the time you attempt to use it. E.g.:</p>\n\n<pre><code>s := &amp;Status{}\n\nif s.Get() == 3 {\n    fmt.Println(s.Get()) // This may or may not print 3\n}\n\n// Or\nc := s.Get()\nfmt.Println(c == s.Get()) // This may or may not print true\n</code></pre>\n\n<p>The above example may or may not print <code>3</code> and <code>true</code> as the 2nd call to <code>s.Get()</code> might be preceeded by another call to <code>s.Add()</code> in another goroutine.</p>\n\n<p>If you need guarantee that noone else modifies or accesses the value of the <code>Status.count</code> field while you perform further calculations on it, then <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"nofollow\"><code>sync.Mutex</code></a> or <a href=\"https://golang.org/pkg/sync/#RWMutex\" rel=\"nofollow\"><code>sync.RWMutex</code></a> is the way to go, as you can hold a lock on the <code>count</code> field while you finish your calculations.</p>\n\n<p><strong>Edit:</strong> To answer your edit:</p>\n\n<p>Direct access to <code>s.count</code> is not safe, <code>atomic.LoadUint32(&amp;s.count)</code> is safe. Reason for this is because if goroutine #1 calls <code>s.Add()</code>, and goroutine #2 tries to access <code>s.count</code>, there is no guarantee that goroutine #2 will see changes made by #1. In #2 you may see just a cached version of <code>s.count</code>.</p>\n\n<p>Without explicit synchronization you have no guarantee to observe changes made to a variable in another goroutine. Directly accessing <code>s.count</code> is an unsynchronized access. Use of channels or other synchronization primitives (e.g. <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow\"><code>sync</code></a> or <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"nofollow\"><code>sync/atomic</code></a> packages) ensures serialized access to <code>s.count</code>, so these solutions will always see the current, updated value.</p>\n\n<p>For details, see this article: <a href=\"https://golang.org/ref/mem\" rel=\"nofollow\"><strong>The Go Memory Model</strong></a></p>\n"}], "owner": {"reputation": 5435, "user_id": 1078503, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/00cb3812de2cb2d15f6e5d14c15e6ed8?s=128&d=identicon&r=PG", "display_name": "leiyonglin", "link": "https://stackoverflow.com/users/1078503/leiyonglin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "accepted_answer_id": 38950501, "answer_count": 1, "score": 5, "last_activity_date": 1471247799, "creation_date": 1471242492, "last_edit_date": 1471247664, "question_id": 38950260, "link": "https://stackoverflow.com/questions/38950260/is-this-thread-safe-with-concurrent-access", "title": "Is this thread-safe with concurrent access?", "body": "<p>I have struct with <code>count</code> property need to thread-safe access.</p>\n\n<p>I know it can be done with <code>sync.Mutex</code> or <code>sync.RWMutex</code>. But I am not sure it's ok like this:</p>\n\n<pre><code>type Status struct {\n    count uint32\n\n    attr1 string\n    attr2 string\n}\n\nfunc (s *Status) Get() uint32 {\n    return atomic.LoadUint32(&amp;s.count)\n}\n\nfunc (s *Status) Add(n uint32) {\n    atomic.AddUint32(&amp;s.count, n)\n}\n\nfunc (s *Status) Reset(n uint32) {\n    atomic.StoreUint32(&amp;s.count, n)\n}\n</code></pre>\n\n<p>Thank you.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I'm confused that access field directly <code>s.count</code> is not safe. But <code>atomic.LoadUint32(&amp;s.count)</code> is safe?</p>\n"}, {"tags": ["android", "go", "cross-compiling", "cgo"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471251141, "post_id": 38948418, "comment_id": 65258261, "body": "To make things easy, I think you need Android NDK.  clang should work too,  but it&#39;s not offical for Android native programming, need lots of configurations maybe."}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471254990, "post_id": 38948418, "comment_id": 65259829, "body": "As stated above, I already successfully compiled the code using Android NDK. The question is why it is needed. When I target &quot;Linux amd64&quot;, a cross compiler is never needed. What makes the difference?"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471256562, "post_id": 38948418, "comment_id": 65260611, "body": "I guess something related <code>-D__ARM_ANDROID__ -DHAVE_PTHREADS</code> which we always added in NDK building."}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471257456, "post_id": 38948418, "comment_id": 65260974, "body": "I am afraid that you missed the point. I understand very well that the NDK can get the job done. I just wonder why a C compiler is needed. As far as I know, the Golang compiler compiles source to binary without the need of another compiler, unless CGO is used. I have successfully built these on a Mac, all without any external tools: &quot;darwin amd64&quot; (host), &quot;linux 386&quot;, &quot;linux amd64&quot;, &quot;windows 386&quot;, &quot;windows amd64&quot;. But why is &quot;android arm&quot; an exception? The point is not the flags used, the point is why a C compiler is needed at the first place!"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471313466, "post_id": 38948418, "comment_id": 65285816, "body": "I know your point. But C-things (compiler/stdlib/macros/headers/#pragma) depends platform badly. Another C compiler hardly work with the android C-things. Still it&#39;s my guess, not dig deep."}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471315098, "post_id": 38948418, "comment_id": 65286175, "body": "I didn&#39;t write a single line of C code here."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471315350, "post_id": 38948418, "comment_id": 65286231, "body": "some old <a href=\"http://blog.hashbangbash.com/2014/04/linking-golang-statically/\" rel=\"nofollow noreferrer\">blog.hashbangbash.com/2014/04/linking-golang-statically</a>"}, {"owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1471316370, "post_id": 38948418, "comment_id": 65286469, "body": "Thanks! But I&#39;m <b>NOT</b> using CGO here, and that&#39;s exactly why I wonder why a C compiler is needed. Sorry, but have you read my question?"}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 3, "last_activity_date": 1471253714, "creation_date": 1471253714, "answer_id": 38952639, "question_id": 38948418, "link": "https://stackoverflow.com/questions/38948418/cross-compiling-hello-world-on-mac-for-android/38952639#38952639", "title": "Cross compiling &quot;Hello World&quot; on Mac for Android", "body": "<p>Android isn't official target platform for cross-compilation. If all you need are command-line executables then you can set GOOS=linux because android is a linux under the hood, else take a look at <a href=\"https://github.com/golang/go/wiki/Mobile\" rel=\"nofollow\">https://github.com/golang/go/wiki/Mobile</a></p>\n"}, {"tags": [], "owner": {"reputation": 1765, "user_id": 332798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47656e20ff5e42f125fc5ea0fd636c6?s=128&d=identicon&r=PG", "display_name": "tmm1", "link": "https://stackoverflow.com/users/332798/tmm1"}, "is_accepted": false, "score": 2, "last_activity_date": 1481866784, "creation_date": 1481866784, "answer_id": 41177920, "question_id": 38948418, "link": "https://stackoverflow.com/questions/38948418/cross-compiling-hello-world-on-mac-for-android/41177920#41177920", "title": "Cross compiling &quot;Hello World&quot; on Mac for Android", "body": "<p>The cgo requirement might be because go requires libc for DNS lookups on Android: <a href=\"https://github.com/golang/go/issues/8877\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/8877</a></p>\n"}, {"comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1533397554, "post_id": 51687094, "comment_id": 90336318, "body": "Sure, it is now, in go1.10.3. The question is two years old."}], "tags": [], "owner": {"reputation": 39, "user_id": 10175582, "user_type": "registered", "profile_image": "https://graph.facebook.com/2228422987386019/picture?type=large", "display_name": "Annymosse", "link": "https://stackoverflow.com/users/10175582/annymosse"}, "is_accepted": false, "score": 4, "last_activity_date": 1533396862, "creation_date": 1533396862, "answer_id": 51687094, "question_id": 38948418, "link": "https://stackoverflow.com/questions/38948418/cross-compiling-hello-world-on-mac-for-android/51687094#51687094", "title": "Cross compiling &quot;Hello World&quot; on Mac for Android", "body": "<p>if you run that code you find the android as an official target platform \nlisted as GOOS/GOARCH</p>\n\n<pre><code>$go tool dist list\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15416, "user_id": 2441637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z8fpp.jpg?s=128&g=1", "display_name": "Hasan A Yousef", "link": "https://stackoverflow.com/users/2441637/hasan-a-yousef"}, "is_accepted": false, "score": 0, "last_activity_date": 1599252202, "last_edit_date": 1599252202, "creation_date": 1599206733, "answer_id": 63737213, "question_id": 38948418, "link": "https://stackoverflow.com/questions/38948418/cross-compiling-hello-world-on-mac-for-android/63737213#63737213", "title": "Cross compiling &quot;Hello World&quot; on Mac for Android", "body": "<p>You need to use <a href=\"https://developer.android.com/ndk\" rel=\"nofollow noreferrer\">Android NDK</a> to compile for android, you can download it from the link, or from <a href=\"https://developer.android.com/studio\" rel=\"nofollow noreferrer\">Android Studio</a>:</p>\n<p><a href=\"https://i.stack.imgur.com/DV8HU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DV8HU.png\" alt=\"enter image description here\" /></a></p>\n<p>Then you can find the compilerlink in the route as below:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>Last login: Fri Sep  4 09:25:16 on console\n\nThe default interactive shell is now zsh.\nTo update your account to use zsh, please run `chsh -s /bin/zsh`.\nFor more details, please visit https://support.apple.com/kb/HT208050.\nHasans-Air:~ hajsf$ pwd\n/Users/hajsf\nHasans-Air:~ hajsf$ cd Library\nHasans-Air:Library hajsf$ cd android\nHasans-Air:android hajsf$ cd sdk\nHasans-Air:sdk hajsf$ cd ndk\nHasans-Air:ndk hajsf$ ls\n21.3.6528147\nHasans-Air:ndk hajsf$ cd 21.3.6528147\nHasans-Air:21.3.6528147 hajsf$ cd toolchains\nHasans-Air:toolchains hajsf$ cd llvm\nHasans-Air:llvm hajsf$ cd prebuilt\nHasans-Air:prebuilt hajsf$ ls\ndarwin-x86_64\nHasans-Air:prebuilt hajsf$ cd darwin-x86_64\nHasans-Air:darwin-x86_64 hajsf$ cd bin\nHasans-Air:bin hajsf$ pwd\n/Users/hajsf/Library/android/sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/darwin-x86_64/bin\n</code></pre>\n<p>Then you can use the one reflectiong:</p>\n<ol>\n<li>Archeticture you want to build your android app for, like <code>aarch64</code></li>\n<li>Android API you want to compile for, like <code>Android 30</code></li>\n</ol>\n<p>You can see full list of availbe options there, and you can seect the one you want like <code>aarch64-linux-android30-clang</code></p>\n<p>If you are at <code>Windows 10</code> you'll find it at:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>&quot;C:\\Users\\${user}\\AppData\\Local\\Android\\Sdk\\ndk\\${NKD_version}\\toolchains\\llvm\\prebuilt\\windows-x86_64\\bin\\aarch64-linux-android30-clang&quot;\n</code></pre>\n<p>There are 4 avaiailble linkers which are:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>//CC_FOR_TARGET=/Users/hajsf/Library/android/sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/darwin-x86_64/bin/aarch64-linux-android30-clang\n//CC_FOR_TARGET=/Users/hajsf/Library/android/sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/darwin-x86_64/bin/i686-linux-android30-clang\n//CC_FOR_TARGET=/Users/hajsf/Library/android/sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/darwin-x86_64/bin/x86_64-linux-android30-clang\n//CC_FOR_TARGET=/Users/hajsf/Library/android/sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/darwin-x86_64/bin/armv7a-linux-androideabi30-clang\n</code></pre>\n<p>After that only you can do cross copiling, as:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>$ CGO_ENABLED=1\n$ GOOS=android\n$ GOARCH=arm64\n$ CC_FOR_TARGET=/Users/hajsf/Library/android/sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/darwin-x86_64/bin/aarch64-linux-android30-clang\n$ go build -buildmode=c-shared -o lib-aarch64-android30.so lib.go\n</code></pre>\n<p>And a simple <code>cgo</code> file <code>lib.go</code> could be:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport &quot;C&quot;\nimport &quot;fmt&quot;\n\n//export HelloWorld\nfunc HelloWorld() {\n    fmt.Printf(&quot;hello world from GO\\n&quot;)\n}\n\n//export GetKey\nfunc GetKey() *C.char {\n    theKey := &quot;123-456-789&quot;\n    return C.CString(theKey)\n}\n\nfunc main() {}\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/JUEEY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JUEEY.png\" alt=\"enter image description here\" /></a></p>\n<p>As shown copilation completed successfuly, and both <code>lib-aarch64-android30.so</code> and <code>ib-aarch64-android30.h</code> had been generated without any error.</p>\n<p>Quick note, not to go far from the scope of the question, if you return a string, then the return value from this function <em>must</em> be explicitly freed in the C code if if you call it from <code>C</code> code, but as you call it from garbage collector environment, Java/Kotlin you do not want to worry about it.</p>\n<p>If freeing the allocated buffer isn't convenient, its common to fill a buffer provided by the caller:</p>\n<pre><code>func GetKey(buff *C.char, n int) int\n</code></pre>\n<p>If you can allocate the memory but don't want to handle C strings, you can insert the buffer into a pointer and return the size.</p>\n<pre><code>func GetKey(buff **C.char) int\n</code></pre>\n"}], "owner": {"reputation": 6845, "user_id": 142239, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/aff0365957ec55e4e4cb904f20ce2a14?s=128&d=identicon&r=PG", "display_name": "Siu Ching Pong -Asuka Kenji-", "link": "https://stackoverflow.com/users/142239/siu-ching-pong-asuka-kenji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5716, "favorite_count": 5, "answer_count": 4, "score": 9, "last_activity_date": 1599252202, "creation_date": 1471227014, "last_edit_date": 1559833776, "question_id": 38948418, "link": "https://stackoverflow.com/questions/38948418/cross-compiling-hello-world-on-mac-for-android", "title": "Cross compiling &quot;Hello World&quot; on Mac for Android", "body": "<p>I'm trying to build a standard \"Hello, World!\" command-line executable for Android. The executable is to be run via <code>adb shell</code>.</p>\n\n<h2>0. The Go (Golang) Source</h2>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, world!\")\n}\n</code></pre>\n\n<h2>1A. The Build Command</h2>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ CGO_ENABLED=0 GOOS=android GOARCH=arm GOARM=7 go build .\n</code></pre>\n\n<h2>1B. The Output (Line Breaks Rearranged to Prevent Scrollbars)</h2>\n\n<pre class=\"lang-none prettyprint-override\"><code># github.com/asukakenji/cross\nwarning: unable to find runtime/cgo.a\n/usr/local/go/pkg/tool/darwin_amd64/link: running clang failed: exit status 1\nld: warning: ignoring file\n    /var/folders/dd/6k6vkzbd6d5803xj9zkjdhmh0000gn/T/go-link-150305609/go.o,\n    file was built for unsupported file format\n    ( 0x7F 0x45 0x4C 0x46 0x01 0x01 0x01 0x00\n      0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 )\n    which is not the architecture being linked (x86_64):\n    /var/folders/dd/6k6vkzbd6d5803xj9zkjdhmh0000gn/T/go-link-150305609/go.o\nUndefined symbols for architecture x86_64:\n  \"_main\", referenced from:\n     implicit entry/start for main executable\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<h2>1C. The Build Command, Again</h2>\n\n<p>The following command gives the same result:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ env CGO_ENABLED=0 GOOS=android GOARCH=arm GOARM=7 go build .\n</code></pre>\n\n<h2>2. The Build Command (Verbose)</h2>\n\n<p>I've tried using <code>\"-v\"</code> as mentioned like this:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ CGO_ENABLED=0 GOOS=android GOARCH=arm GOARM=7 go build \\\n      -x -ldflags \"-extldflags -v\" .\n</code></pre>\n\n<p>It gives me more than 100 lines of messages, so I don't post it here unless it's necessary. The <code>go build</code> command seems to try compiling the source with the <code>clang</code> bundled with <code>Xcode</code>.</p>\n\n<h2>3A. The Build Command (Successful, but...)</h2>\n\n<p>Given the hint that the wrong compiler is found, I tried to set <code>$CC</code> like this:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ CGO_ENABLED=0 GOOS=android GOARCH=arm GOARM=7 \\\n      CC=/path/to/arm-linux-androideabi/bin/clang go build .\n</code></pre>\n\n<p><code>arm-linux-androideabi</code> is the output from <code>make_standalone_toolchain.py</code> (or <code>make-standalone-toolchain.sh</code>).</p>\n\n<h2>3B. The Output</h2>\n\n<p>The executable (named <code>cross</code>) is successfully built, with the following messages:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code># github.com/asukakenji/cross\nwarning: unable to find runtime/cgo.a\n</code></pre>\n\n<p>I tried <code>adb push</code> it and run it with <code>adb shell</code> on Android, it worked fine.</p>\n\n<h2>My Questions</h2>\n\n<ol>\n<li>Why does it need a C compiler? Doesn't Go cross-compile out-of-the-box?</li>\n<li><p>When building for Linux (instead of Android), the compilation works fine:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build .\n</code></pre>\n\n<p>Why?</p></li>\n<li>The <code>go build</code> command keeps looking for <code>runtime/cgo.a</code>, even when I didn't use CGO in the source code, and even when I set <code>CGO_ENABLED=0</code>. How can I get rid of the warning? How is it harmful not having one?</li>\n</ol>\n"}, {"tags": ["email", "go", "goroutine"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1471218096, "post_id": 38947328, "comment_id": 65250397, "body": "Honestly working with emails directly is hell... It would be about $600/m with your volume, but you might find <a href=\"http://www.mailgun.com/\" rel=\"nofollow noreferrer\">Mailgun</a> amicable"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1471219744, "post_id": 38947328, "comment_id": 65250669, "body": "The remote server is resetting your connection, probably to stop you from sending emails at the rate you&#39;re attempting. You have to make sure you are working within the limits of the remote server too."}, {"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "edited": false, "score": 0, "creation_date": 1471222521, "post_id": 38947328, "comment_id": 65251136, "body": "What remote server are referring to resetting the connection? I agree, that&#39;s what the error message suggests, but every individual email goes to a different address so it&#39;s not the same remote server."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1471227586, "post_id": 38947328, "comment_id": 65252015, "body": "you&#39;re not showing how you initialize <code>dialer</code>, but I assume it&#39;s dialing the same host every time."}, {"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "edited": false, "score": 0, "creation_date": 1471440111, "post_id": 38947328, "comment_id": 65347411, "body": "You were right. I contacted our provider and found out their limits which is 30 simultaneous connections and 1,000 emails per connection per minute. So, I have reduced the number of workers to 20 and am resetting each worker&#39;s connection after they have sent 900 emails. Everything is working great. Thanks for all your help."}, {"owner": {"reputation": 1180, "user_id": 2156341, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/P1aeY.jpg?s=128&g=1", "display_name": "Manjesh V", "link": "https://stackoverflow.com/users/2156341/manjesh-v"}, "edited": false, "score": 0, "creation_date": 1512482152, "post_id": 38947328, "comment_id": 82268751, "body": "hi i&#39;m trying to achieve same pls share sourcecode"}], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1471215309, "creation_date": 1471215309, "question_id": 38947328, "link": "https://stackoverflow.com/questions/38947328/go-sending-simultaneous-emails-through-goroutines-times-out-connection-reset", "title": "Go - Sending simultaneous emails through goroutines times out - connection reset by peer", "body": "<p>I have 50 goroutines that start with a channel. Then, the process forever loops reading 100 database records at a time and sleeping for 10 seconds in between database calls. As it loops through the 100 email records to send, it passes each record through the channel to one of the 50 worker goroutines, who then sends the email. The problem is, after it goes through about 1000 emails, I start getting errors like this:</p>\n\n<p>gomail: could not send email 1: read tcp 10.2.30.25:56708->216.###.##.###:25: read: connection reset by peer</p>\n\n<p>I have to send out about 50k emails per day. What do you recommend? Here's the main code that processes the email queue and passes each record to the worker through the channel:</p>\n\n<pre><code>func main() {\n\n    MaxWorkers := 50\n    println(\"Creating: \" + strconv.Itoa(MaxWorkers) + \" workers..\")\n    batchChannel := make(chan EmailQueue.EmailQueueObj)\n\n    for i := 0; i &lt; MaxWorkers; i++ {\n        go startWorker(batchChannel)\n    }\n\n    for {\n        println(\"Getting queue..\")\n        data, _ := EmailQueue.GetQueue() //returns 100 database records\n\n        println(\"Reading through \" + strconv.Itoa(len(data)) + \" records..\")\n        for _, element := range data {\n            batchChannel &lt;- element\n        }\n\n        time.Sleep(10 * time.Second)\n    }\n}\n\n\nfunc startWorker(channel chan EmailQueue.EmailQueueObj) {\n    var s gomail.SendCloser\n    var err error\n    open := false\n    for obj := range channel {\n        if !open {\n            s, err = dialer.Dial()\n            if err != nil {\n                fmt.Println(err.Error())\n                return\n            } else {\n                sendEmail(obj, &amp;s)\n            }\n        } else {\n            sendEmail(obj, &amp;s)\n        }\n        open = true\n    }\n    s.Close()\n}\n\nfunc sendEmail(obj EmailQueue.EmailQueueObj, s *gomail.SendCloser) {\n\n    m := gomail.NewMessage()\n    m.SetHeader(\"From\", \"example@example.com\")\n    m.SetHeader(\"To\", obj.Recipient)\n    m.SetHeader(\"Subject\", obj.Subject.String)\n    m.SetBody(\"text/html\", obj.HTML.String)\n\n    // Send the email\n    response := \"\"\n    status := \"\"\n    if err := gomail.Send(*s, m); err != nil {\n        response = err.Error()\n        status = \"error\"\n    } else {\n        response = \"Email sent\"\n        status = \"sent\"\n    }\n    m.Reset()\n\n    return\n}\n</code></pre>\n\n<p>I am using the library <a href=\"https://github.com/go-gomail/gomail\" rel=\"nofollow\">gomail</a> to send the emails. I am open to anything, even a new library or method to send these emails. But, what I'm doing currently is not working. Any help is greatly appreciated!</p>\n"}, {"tags": ["go", "range", "indexof", "panic"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 3, "creation_date": 1471194032, "post_id": 38944388, "comment_id": 65243857, "body": "Noone can help you as good as you. Start to use debugger and it will  tell you line, where the problem is ;o)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1471196668, "post_id": 38944388, "comment_id": 65244743, "body": "You don&#39;t even need a debugger, the output will show the exact line and stack trace leading up to the panic."}, {"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1471199351, "post_id": 38944388, "comment_id": 65245567, "body": "@JimB  i posted the error also, I cant understand what is the problem with the code"}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 1683251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6fsxn.jpg?s=128&g=1", "display_name": "MaC", "link": "https://stackoverflow.com/users/1683251/mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1471200233, "creation_date": 1471200233, "answer_id": 38945460, "question_id": 38944388, "link": "https://stackoverflow.com/questions/38944388/panicindex-out-of-range-error-in-golang/38945460#38945460", "title": "Panic:index out of range error in Golang", "body": "<p>You are passing a 0 or 1 char string to your \"toNumber(s string)\" function. That's why is panicking.</p>\n\n<p>This is probably caused because you don't have the proper information in chessin.txt. When you split it in <code>strs := strings.Split(scanner.Text(), \",\")</code> is not finding what you are expecting</p>\n"}], "owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "accepted_answer_id": 38945460, "answer_count": 1, "score": -1, "last_activity_date": 1471200233, "creation_date": 1471193373, "last_edit_date": 1471199264, "question_id": 38944388, "link": "https://stackoverflow.com/questions/38944388/panicindex-out-of-range-error-in-golang", "title": "Panic:index out of range error in Golang", "body": "<p><a href=\"https://i.stack.imgur.com/a9nLG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a9nLG.jpg\" alt=\"this is the error description im getting, i cant really understand what is the problem\"></a>In this program, I'm trying to calculate the shortest path between any two squares on chess board according to the moves of the knight, I checked few websites they say something about finding out the length, I ddint quiet understand how to work with.I'm encountering a error saying \"panic:index out of range\" Can anybody help me out..!! please</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"sort\"\n    \"strings\"\n)\n\nvar heightcurrstack int\nvar currentSource string\nvar currentDest string\nvar currentDestn int\nvar PosMoves [8]int\n\nfunc main() {\n\n    file, err := os.Open(\"chessin.txt\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer file.Close()\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n        strs := strings.Split(scanner.Text(), \",\")\n\n        currentSource = strs[0]\n        currentDest = strs[1]\n        IsValid(currentSource)\n      toNumber(currentSource)\n        IsValid(currentDest)\n        currentDestn = toNumber(currentDest)\n    }\n\n}\nfunc IsValid(b string) bool {\n\n    if b[0] &lt;= 'H' &amp;&amp; b[0] &gt;= 'A' &amp;&amp; b[1] &lt;= '8' &amp;&amp; b[1] &gt;= '1' {\n        return true\n    }\n    return false\n}\n\nfunc toNumber(s string) int {\n    var Number int\n\n    if len(s) != 2 {\n        fmt.Println(\"Invalid Input\", s, \".\")\n    }\n    Number = int(s[0]-'A')*8 + int(s[1]-'0')\n    return Number\n}\n\nfunc ToString(n int) string {\n    n--\n    return string((n/8)+65) + string((n%8)+49)\n\n}\n\nfunc PossibleMoves(n int) [8]int {\n\n    a := ToString(n)\n    isval := IsValid(a)\n\n    if isval == true {\n        if IsValid(string(a[0]+1) + string(a[1]+2)) {\n            PosMoves[0] = toNumber(string(a[0]+1) + string(a[1]+2))\n        }\n        if IsValid(string(a[0]+1) + string(a[1]-2)) {\n            PosMoves[1] = toNumber(string(a[0]+1) + string(a[1]-2))\n        }\n        if IsValid(string(a[0]-1) + string(a[1]+2)) {\n            PosMoves[2] = toNumber(string(a[0]-1) + string(a[1]+2))\n        }\n        if IsValid(string(a[0]-1) + string(a[1]-2)) {\n            PosMoves[3] = toNumber(string(a[0]-1) + string(a[1]-2))\n        }\n        if IsValid(string(a[0]+2) + string(a[1]+1)) {\n            PosMoves[4] = toNumber(string(a[0]+2) + string(a[1]+1))\n        }\n        if IsValid(string(a[0]+2) + string(a[1]-1)) {\n            PosMoves[5] = toNumber(string(a[0]+2) + string(a[1]-1))\n        }\n        if IsValid(string(a[0]-2) + string(a[1]+1)) {\n            PosMoves[6] = toNumber(string(a[0]-2) + string(a[1]+1))\n        }\n        if IsValid(string(a[0]-2) + string(a[1]-1)) {\n            PosMoves[7] = toNumber(string(a[0]-2) + string(a[1]-1))\n        }\n    }\n\n    sort.Sort(sort.Reverse(sort.IntSlice(PosMoves[0:8])))\n    return PosMoves\n}\nvar visithistory [64]bool\n\nfunc IsvisitedNode(currentSource int) bool {\n\n\n    visithistory[currentSource] = true\n\n    if visithistory[currentSource] == true {\n\n        return false\n\n    }\n    return true\n\n\n}\n\ntype stack []int\n\nfunc (s stack) Push(currentSource int) stack {\n    return append(s, currentSource)\n}\n\nfunc (s stack) Pop() ([]int) {\n    heightcurrstack := len(s)\n\n    return s[0:heightcurrstack]\n}\n\nfunc dfstraversal(currentSource int) {\n\n    var currentchildren [8]int\n    copy(PosMoves[:], currentchildren[:])\n    s := make(stack, 0)\n\n   if IsvisitedNode(currentSource) == true {\n\n        var j int = 0\n        for j &lt; len(currentchildren) {\n            currentchildren[j+1] = currentSource\n        }\n } else  if IsvisitedNode(currentSource) == false { //condition 1:previously not visited\n        if heightcurrstack &gt; 6 { //condition 2: if the number of moves are more than 6\n            tracesuccessfulpath()\n        }\n\n        if currentSource == currentDestn { //condition 3 : if the destination  posititon is found\n            tracesuccessfulpath()\n        }\n        s = s.Push(currentSource)\n\n        s = s.Push(currentchildren[0])\n\n        currentchildren[0] = currentSource\n\n        if currentSource == currentDestn {\n            tracesuccessfulpath()\n        }\n\n    }\n\n    PossibleMoves(currentSource)\n    dfstraversal(currentSource)\n\n}\n\nfunc tracesuccessfulpath() {\n\n\n    s := make(stack, 0)\n     s.Pop()\n\n\nvar Path []string \n\nfor _,x := range s {\n    Path := append(Path, ToString(x))\n\n fmt.Println(Path)\n}\n\n}\n</code></pre>\n"}, {"tags": ["go", "dependency-management", "glide-golang"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1471191189, "creation_date": 1471191189, "answer_id": 38944087, "question_id": 38943924, "link": "https://stackoverflow.com/questions/38943924/unwanted-glide-imports/38944087#38944087", "title": "Unwanted Glide imports", "body": "<p>I often had extra imports when using glide (a bit like in <a href=\"https://github.com/Masterminds/glide/issues/101\" rel=\"nofollow\">issue 101</a>)</p>\n\n<p>Just for testing, try re-populate your vendor folder using <a href=\"https://github.com/kardianos/govendor/\" rel=\"nofollow\"><code>govendor</code></a></p>\n\n<pre><code>govendor list\ngovendor fetch +m\n</code></pre>\n\n<p>In my experience, the resulting list of dependencies is cleaner.</p>\n"}], "owner": {"reputation": 597, "user_id": 515320, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/56bb98d5e22200a138bbcbf68047cb6f?s=128&d=identicon&r=PG", "display_name": "Andy Haskell", "link": "https://stackoverflow.com/users/515320/andy-haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1553439149, "creation_date": 1471190079, "last_edit_date": 1553439149, "question_id": 38943924, "link": "https://stackoverflow.com/questions/38943924/unwanted-glide-imports", "title": "Unwanted Glide imports", "body": "<p>I am working on an App Engine app and am coming across this error running <code>goapp serve</code>:</p>\n\n<p><code>Failed parsing input: parser: bad import \"syscall\" in vendor/golang.org/x/net/icmp/message.go</code></p>\n\n<p>Which is apparently from Glide importing the entire <code>golang.org/x/net</code> package when I only wanted <code>golang.org/x/net/context</code>.</p>\n\n<p>The import in my glide.yaml was:</p>\n\n<pre><code>- package: golang.org/x/net\n  subpackages:\n  - context\n</code></pre>\n\n<p>And the glide.lock file says</p>\n\n<pre><code>- name: golang.org/x/net\n  version: 07b51741c1d6423d4a6abab1c49940ec09cb1aaf\n  subpackages:\n  - context\n</code></pre>\n\n<p>How would I keep net/icmp out of my build in <code>goapp serve</code>?</p>\n"}, {"tags": ["json", "xml", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1471205808, "post_id": 38943089, "comment_id": 65247361, "body": "<code>{{</code> isn&#39;t valid json, but that doesn&#39;t correlate with the invalid <code>b</code> either. Please make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem you&#39;re having."}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 0, "creation_date": 1471242570, "post_id": 38943089, "comment_id": 65255149, "body": "Don&#39;t just show the error. Show which line is giving you the error and what is the req in that scenario."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 23, "last_activity_date": 1471271385, "creation_date": 1471271385, "answer_id": 38957081, "question_id": 38943089, "link": "https://stackoverflow.com/questions/38943089/golang-invalid-character-b-looking-for-beginning-of-value/38957081#38957081", "title": "golang invalid character &#39;b&#39; looking for beginning of value", "body": "<p>The error indicates that the server did not return a valid JSON response.  I suggest adding the following code to debug the issue:</p>\n\n<pre><code>err := json.Unmarshal(resBody, v)\nif err != nil {\n    log.Printf(\"error decoding sakura response: %v\", err)\n    if e, ok := err.(*json.SyntaxError); ok {\n        log.Printf(\"syntax error at byte offset %d\", e.Offset)\n    }\n    log.Printf(\"sakura response: %q\", resBody)\n    return err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 6150881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a42d9d73c727b1b482f4e215ac1b663?s=128&d=identicon&r=PG&f=1", "display_name": "Rabhi salim", "link": "https://stackoverflow.com/users/6150881/rabhi-salim"}, "is_accepted": false, "score": 1, "last_activity_date": 1580745246, "creation_date": 1580745246, "answer_id": 60042738, "question_id": 38943089, "link": "https://stackoverflow.com/questions/38943089/golang-invalid-character-b-looking-for-beginning-of-value/60042738#60042738", "title": "golang invalid character &#39;b&#39; looking for beginning of value", "body": "<p>Reason for this eerie error message is : </p>\n\n<pre><code>// When unmarshaling quoted strings, invalid UTF-8 or\n// invalid UTF-16 surrogate pairs are not treated as an error.\n// Instead, they are replaced by the Unicode replacement\n// character U+FFFD.\n</code></pre>\n\n<p><a href=\"https://golang.org/src/encoding/json/decode.go\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/json/decode.go</a></p>\n\n<p>In my case I saved my json as string then parsed it by :\n<code>stringData = JSON.parse(myJsonString)</code></p>\n\n<p>I also had the same error another time using gin-context-ShouldBind() (<a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.ShouldBind\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/gin-gonic/gin#Context.ShouldBind</a>) and mapping my json to go object:\nerror was because it needs a json as string, so I used : JSON.stringify(jsonObject) when sending my request from front-end part.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 11822233, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VuFe9JAd5QM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf11pdzF0Dwd1mcVz6nM7_M6Eha1g/photo.jpg?sz=128", "display_name": "Jim", "link": "https://stackoverflow.com/users/11822233/jim"}, "is_accepted": false, "score": 1, "last_activity_date": 1595239420, "last_edit_date": 1595239420, "creation_date": 1595237810, "answer_id": 62992602, "question_id": 38943089, "link": "https://stackoverflow.com/questions/38943089/golang-invalid-character-b-looking-for-beginning-of-value/62992602#62992602", "title": "golang invalid character &#39;b&#39; looking for beginning of value", "body": "<p>Please Check the request header first. Check the Content-Type. In my cases, it's not an <code>application/JSON</code>. It's <code>application/x-www-form-urlencoded.</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14201190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98a2489c38273ef66b635c3e53f8e09?s=128&d=identicon&r=PG&f=1", "display_name": "chenpeiyue", "link": "https://stackoverflow.com/users/14201190/chenpeiyue"}, "is_accepted": false, "score": 0, "last_activity_date": 1599038386, "last_edit_date": 1599038386, "creation_date": 1599016155, "answer_id": 63698121, "question_id": 38943089, "link": "https://stackoverflow.com/questions/38943089/golang-invalid-character-b-looking-for-beginning-of-value/63698121#63698121", "title": "golang invalid character &#39;b&#39; looking for beginning of value", "body": "<p>I have the problem, too. It's because vue request api stringifies the json data, keep request data is json data.\nlike <code>curl apiUrl -H '' -d '{&quot;a&quot;:1,&quot;b&quot;:2}'</code>,\nnot <code>curl apiUrl -H '' -d 'a=1&amp;b=2'</code>,\nI think keep your response is json data will be resolved</p>\n"}], "owner": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39734, "favorite_count": 2, "accepted_answer_id": 38957081, "answer_count": 4, "score": 14, "last_activity_date": 1599038386, "creation_date": 1471184060, "last_edit_date": 1471249462, "question_id": 38943089, "link": "https://stackoverflow.com/questions/38943089/golang-invalid-character-b-looking-for-beginning-of-value", "title": "golang invalid character &#39;b&#39; looking for beginning of value", "body": "<p>I am trying to post a json with xml message inside it. However it returns </p>\n\n<p>invalid character 'b' looking for beginning of value</p>\n\n<p>I think the possible reason is that I am trying to marshal the returns body which is not in json format.</p>\n\n<pre><code>func (s *BackendConfiguration) Do(req *http.Request, v interface{}) error {\n    log.Printf(\"Requesting %v %v%v\\n\", req.Method, req.URL.Host, req.URL.Path)\n    start := time.Now()\n\n    res, err := s.HTTPClient.Do(req)\n\n    if debug {\n        log.Printf(\"Completed in %v\\n\", time.Since(start))\n    }\n\n    if err != nil {\n        log.Printf(\"Request to sakura failed: %v\\n\", err)\n        return err\n    }\n    defer res.Body.Close()\n\n    resBody, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        log.Printf(\"Cannot parse sakura response: %v\\n\", err)\n        return err\n    }\n\n    if debug {\n        log.Printf(\"sakura response: %q\\n\", resBody)\n    }\n\n    if v != nil {\n        return json.Unmarshal(resBody, v)\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>The error happened at this line</p>\n\n<pre><code>return json.Unmarshal(resBody, v)\n</code></pre>\n"}, {"tags": ["google-app-engine", "ssl", "go"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1471364702, "post_id": 38942171, "comment_id": 65312574, "body": "Are you not able to create a Transport on appengine ? Like <code>tr := &amp;http.Transport{ TLSClientConfig:    &amp;tls.Config{...}, } client := &amp;http.Client{Transport: tr}</code> maybe in the flex environment ?"}, {"owner": {"reputation": 21554, "user_id": 4243, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/501b2f1d20a7a8f9539d46776a640225?s=128&d=identicon&r=PG", "display_name": "kristina", "link": "https://stackoverflow.com/users/4243/kristina"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1471538504, "post_id": 38942171, "comment_id": 65397424, "body": "Unfortunately, AppEngine requires that you use its Transport, <a href=\"https://cloud.google.com/appengine/docs/go/urlfetch/reference#Transport\" rel=\"nofollow noreferrer\">urlfetch.Transport</a> (AFAICT). There might be some way to override whatever this transport&#39;s <a href=\"https://github.com/golang/appengine/blob/master/urlfetch/urlfetch.go#L169\" rel=\"nofollow noreferrer\">RoundTrip</a> is doing, which is what I&#39;m looking for advice on."}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1471539256, "post_id": 38942171, "comment_id": 65397929, "body": "I think it can be done on the <a href=\"https://cloud.google.com/appengine/docs/flexible/go/\" rel=\"nofollow noreferrer\">flex environment</a> - see <a href=\"https://godoc.org/google.golang.org/cloud/internal\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 21554, "user_id": 4243, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/501b2f1d20a7a8f9539d46776a640225?s=128&d=identicon&r=PG", "display_name": "kristina", "link": "https://stackoverflow.com/users/4243/kristina"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1471615296, "post_id": 38942171, "comment_id": 65431470, "body": "Aha!  Using your advice about Transports, I dug down into what the RoundTrip code was calling and eventually figured out that I could use a vanilla http.Client, I just needed to set <code>Proxy: http.ProxyFromEnvironment</code> in the Transport. If you&#39;d like to write up an an answer, happy to award you the bounty."}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1471628276, "post_id": 38942171, "comment_id": 65439274, "body": "So you set Proxy:http.ProxyFromEnvironment in urlfetch.Transport ? It&#39;s already set in http.Transport as DefaultTransport."}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1471629437, "post_id": 38942171, "comment_id": 65439924, "body": "According to <a href=\"https://cloud.google.com/appengine/docs/go/issue-requests\" rel=\"nofollow noreferrer\">this</a> you shouldn&#39;t really have to do anything other than perhaps AllowInvalidServerCertificate."}, {"owner": {"reputation": 21554, "user_id": 4243, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/501b2f1d20a7a8f9539d46776a640225?s=128&d=identicon&r=PG", "display_name": "kristina", "link": "https://stackoverflow.com/users/4243/kristina"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 1, "creation_date": 1471732532, "post_id": 38942171, "comment_id": 65468017, "body": "Yeah, this is now working with just <code>&amp;http.Client{Transport: &amp;http.Transport{TLSClientConfig: &amp;tls.Config{MinVersion: tls.VersionTLS12,},},}</code>, no need to mess with urlfetch. I have no idea why <code>http.Client</code> wasn&#39;t allowed originally."}], "answers": [{"comments": [{"owner": {"reputation": 21554, "user_id": 4243, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/501b2f1d20a7a8f9539d46776a640225?s=128&d=identicon&r=PG", "display_name": "kristina", "link": "https://stackoverflow.com/users/4243/kristina"}, "edited": false, "score": 0, "creation_date": 1471354482, "post_id": 38966338, "comment_id": 65305806, "body": "I don&#39;t think I can from Go.  dev_appserver.py invokes a <a href=\"https://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/tools/devappserver2/api_server.py\" rel=\"nofollow noreferrer\">python backend</a>, so I&#39;m wondering how to set this in Python/Go, not Java."}], "tags": [], "owner": {"reputation": 85, "user_id": 654749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/49e85f0a5614358826a5b7e04300cfd6?s=128&d=identicon&r=PG", "display_name": "Reza", "link": "https://stackoverflow.com/users/654749/reza"}, "is_accepted": false, "score": 0, "last_activity_date": 1471319157, "creation_date": 1471319157, "answer_id": 38966338, "question_id": 38942171, "link": "https://stackoverflow.com/questions/38942171/how-to-use-tls-1-2-with-appengine-urlfetch-from-a-go-appengine-app/38966338#38966338", "title": "How to use TLS 1.2 with appengine/urlfetch from a Go AppEngine app", "body": "<p>Please see this <a href=\"https://blogs.oracle.com/java-platform-group/entry/diagnosing_tls_ssl_and_https\" rel=\"nofollow\">oracle blog post</a>. Appengine runs JDK7 and it supports TLSv1.2 but the default protocol is TLSV1</p>\n\n<p>So it first tries to make connection in v1 and if it doesnt support try the other protocols v1.1 and then v1.2 </p>\n\n<p>As far as I know you cannot pass {-Dhttps.protocols=TLSv1.2} to GAE but you may be able to set it through code\n{System.setProperty(\"https.protocols\", \"TLSv1.2\");}</p>\n"}, {"tags": [], "owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "is_accepted": true, "score": 4, "last_activity_date": 1471738189, "creation_date": 1471738189, "answer_id": 39059763, "question_id": 38942171, "link": "https://stackoverflow.com/questions/38942171/how-to-use-tls-1-2-with-appengine-urlfetch-from-a-go-appengine-app/39059763#39059763", "title": "How to use TLS 1.2 with appengine/urlfetch from a Go AppEngine app", "body": "<p>From Go net/http documentation:</p>\n\n<blockquote>\n  <p>For control over proxies, TLS configuration, keep-alives, compression, and other settings, create a Transport:</p>\n</blockquote>\n\n<pre><code>tr := &amp;http.Transport{\n    TLSClientConfig:    &amp;tls.Config{...},\n    DisableCompression: true,\n}\nclient := &amp;http.Client{Transport: tr}\n</code></pre>\n\n<p>From the <a href=\"https://cloud.google.com/appengine/docs/go/issue-requests\" rel=\"nofollow\">appengine documentation</a> it appears you can use the net/http package as usual with a few tweaks.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1904480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f19cac213e6a728d63dd4fae17aec49?s=128&d=identicon&r=PG", "display_name": "Taras", "link": "https://stackoverflow.com/users/1904480/taras"}, "is_accepted": false, "score": 0, "last_activity_date": 1474374132, "creation_date": 1474374132, "answer_id": 39593997, "question_id": 38942171, "link": "https://stackoverflow.com/questions/38942171/how-to-use-tls-1-2-with-appengine-urlfetch-from-a-go-appengine-app/39593997#39593997", "title": "How to use TLS 1.2 with appengine/urlfetch from a Go AppEngine app", "body": "<p>You should create and setup new transport that has TLS configuration and uses the AppEngine service. It can be done by replacing default dial function with one that is defined by AppEngine SDK (with context).</p>\n\n<pre><code>// NewClient sets up an HTTP/2 client for a certificate and context\nfunc NewClient(ctx context.Context) (*http.Client, error) {\n    config := &amp;tls.Config{}\n    transport := &amp;http.Transport{\n        TLSClientConfig: config,\n        Dial: func(network, addr string) (net.Conn, error) {\n            // this uses the appengine service to create the actual client\n            return socket.Dial(ctx, network, addr)\n        },\n    }\n    return &amp;http.Client{Transport: transport}, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 21554, "user_id": 4243, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/501b2f1d20a7a8f9539d46776a640225?s=128&d=identicon&r=PG", "display_name": "kristina", "link": "https://stackoverflow.com/users/4243/kristina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1659, "favorite_count": 2, "accepted_answer_id": 39059763, "answer_count": 3, "score": 3, "last_activity_date": 1474374132, "creation_date": 1471177068, "last_edit_date": 1471183625, "question_id": 38942171, "link": "https://stackoverflow.com/questions/38942171/how-to-use-tls-1-2-with-appengine-urlfetch-from-a-go-appengine-app", "title": "How to use TLS 1.2 with appengine/urlfetch from a Go AppEngine app", "body": "<p>I'm writing a go appengine app, which needs to fetch a page from Stripe. </p>\n\n<p>Basically I'm using <a href=\"https://github.com/stripe/stripe-go#google-appengine\" rel=\"nofollow\">these instructions</a> that come with the official Stripe API.  However, when I run this with <code>dev_appserver.py</code>, I get:</p>\n\n<pre><code>2016/08/14 12:03:15 Requesting POST api.stripe.com/v1/customers\n2016/08/14 12:03:18 Error encountered from Stripe: {\"type\":\"invalid_request_error\",\"message\":\"Stripe no longer supports API requests made with TLS 1.0. Please initiate HTTPS connections with TLS 1.2 or later. You can learn more about this at https://stripe.com/blog/upgrading-tls.\",\"request_id\":\"req_90O6reF1Mwi9yZ\",\"status\":401}\n</code></pre>\n\n<p>I found that Python AppEngine apps can specify the SSL library to use in my app.yaml (see <a href=\"https://cloud.google.com/appengine/docs/python/sockets/ssl_support\" rel=\"nofollow\">SSL support</a>). However, if I add a <code>libraries</code> section to my app.yaml file, I get:</p>\n\n<pre><code>$ (go_appengine/dev_appserver.py app)\nTraceback (most recent call last):\n  File \"go_appengine/dev_appserver.py\", line 89, in &lt;module&gt;\n    _run_file(__file__, globals())\n  File \"go_appengine/dev_appserver.py\", line 85, in _run_file\n    execfile(_PATHS.script_file(script_name), globals_)\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 1040, in &lt;module&gt;\n    main()\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 1033, in main\n    dev_server.start(options)\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 758, in start\n    options.config_paths, options.app_id)\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/tools/devappserver2/application_configuration.py\", line 831, in __init__\n    module_configuration = ModuleConfiguration(config_path, app_id)\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/tools/devappserver2/application_configuration.py\", line 127, in __init__\n    self._config_path)\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/tools/devappserver2/application_configuration.py\", line 424, in _parse_configuration\n    config, files = appinfo_includes.ParseAndReturnIncludePaths(f)\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/api/appinfo_includes.py\", line 82, in ParseAndReturnIncludePaths\n    appyaml = appinfo.LoadSingleAppInfo(appinfo_file)\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/api/appinfo.py\", line 2191, in LoadSingleAppInfo\n    listener.Parse(app_info)\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/api/yaml_listener.py\", line 227, in Parse\n    self._HandleEvents(self._GenerateEventParameters(stream, loader_class))\n  File \"/Users/kchodorow/gitroot/tt/go_appengine/google/appengine/api/yaml_listener.py\", line 178, in _HandleEvents\n    raise yaml_errors.EventError(e, event_object)\ngoogle.appengine.api.yaml_errors.EventError: libraries entries are only supported by the \"python27\" runtime\n  in \"app/app.yaml\", line 25, column 1\n</code></pre>\n\n<p>Which makes sense, because I'm not using Python.  I really need a way to set this for Go.  </p>\n\n<p>My app.yaml file looks like:</p>\n\n<pre><code>application: app-name\nversion: alpha-001\nruntime: go\napi_version: go1\n\nhandlers:\n...\n</code></pre>\n\n<p>Changing <code>runtime</code> to <code>python27</code> gets rid of the library error, but obviously then my go code doesn't work.</p>\n\n<p>Any ideas how to get TLS 1.2 enabled, both with the dev appserver and production?</p>\n"}, {"tags": ["go", "cryptography", "rsa", "windows-hello", "webauthn"], "comments": [{"owner": {"reputation": 1226, "user_id": 427566, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/AATey.jpg?s=128&g=1", "display_name": "yngling", "link": "https://stackoverflow.com/users/427566/yngling"}, "edited": false, "score": 0, "creation_date": 1471163276, "post_id": 38940462, "comment_id": 65236081, "body": "if someone with 1500+ rep could add a tag called &quot;webauthn&quot; that would be great. (It is the name of the standard, cf. <a href=\"https://www.w3.org/Webauthn/\" rel=\"nofollow noreferrer\">w3.org/Webauthn</a> )"}], "answers": [{"comments": [{"owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "edited": false, "score": 0, "creation_date": 1473034111, "post_id": 39322415, "comment_id": 65977045, "body": "You should also try to decode the modulus using URLEncoding instead of StdEncoding like this: base64.URLEncoding.DecodeString(nStr) with my example"}, {"owner": {"reputation": 1226, "user_id": 427566, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/AATey.jpg?s=128&g=1", "display_name": "yngling", "link": "https://stackoverflow.com/users/427566/yngling"}, "edited": false, "score": 0, "creation_date": 1473163493, "post_id": 39322415, "comment_id": 66026806, "body": "Thank you so much for your interest! I have tried the above (and URLEncoding), it gives the same errors that I mention in the question (&quot;crypto/rsa: input must be hashed message&quot; and &quot;crypto/rsa: verification error&quot;). In your code, how do you call rsa.VerifyPKCS1v15? Do you combine authenticatorData and hash?"}, {"owner": {"reputation": 1226, "user_id": 427566, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/AATey.jpg?s=128&g=1", "display_name": "yngling", "link": "https://stackoverflow.com/users/427566/yngling"}, "edited": false, "score": 0, "creation_date": 1473164862, "post_id": 39322415, "comment_id": 66027714, "body": "In the PHP sample code the verification is done by &quot;return $rsa-&gt;verify($a . $h,$s);&quot;, but if I do the same in Go I get the error &quot;crypto/rsa: input must be hashed message&quot;."}, {"owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "reply_to_user": {"reputation": 1226, "user_id": 427566, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/AATey.jpg?s=128&g=1", "display_name": "yngling", "link": "https://stackoverflow.com/users/427566/yngling"}, "edited": false, "score": 0, "creation_date": 1473175434, "post_id": 39322415, "comment_id": 66035048, "body": "You can see my snippet in Edit 2 regarding the combining of hash and data. To verify the signature in PHP I use opensslverify(data, $signature,pubKey, OPENSSL_ALGO_SHA256) and the port to Go is working for me. Hope it helps."}, {"owner": {"reputation": 1226, "user_id": 427566, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/AATey.jpg?s=128&g=1", "display_name": "yngling", "link": "https://stackoverflow.com/users/427566/yngling"}, "edited": false, "score": 0, "creation_date": 1473199672, "post_id": 39322415, "comment_id": 66046959, "body": "I really appreciate your help. It is difficult for me to know exactly what has been used to sign the message, as it happens in the webauthn part of Windows, but as C#, PHP and JavaScript sample code all combine the authenticatorData and hash arrays, I assume it is that. I get &quot;crypto/rsa: verification error&quot; if I use that though, so I am unsure what I am doing wrong."}], "tags": [], "owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "is_accepted": false, "score": 2, "last_activity_date": 1473174936, "last_edit_date": 1473174936, "creation_date": 1473032492, "answer_id": 39322415, "question_id": 38940462, "link": "https://stackoverflow.com/questions/38940462/biometric-login-webauthn-in-go-how-to-verify-signature/39322415#39322415", "title": "Biometric login (webauthn) in Go, how to verify signature", "body": "<p>I'm not a crypto expert but I have some experience in Go, including verifying signatures that were signed with PHP. So, assuming the compared byte values are the same I would say that Your problem is probably the public key creation. I would suggest to try my solution of creating public keys from modulus and exponent with this function:</p>\n\n<pre><code>func CreatePublicKey(nStr, eStr string)(pubKey *rsa.PublicKey, err error){\n\n    decN, err := base64.StdEncoding.DecodeString(nStr)\n    n := big.NewInt(0)\n    n.SetBytes(decN)\n\n    decE, err := base64.StdEncoding.DecodeString(eStr)\n    if err != nil {\n        fmt.Println(err)\n        return nil, err\n    }\n    var eBytes []byte\n    if len(decE) &lt; 8 {\n        eBytes = make([]byte, 8-len(decE), 8)\n        eBytes = append(eBytes, decE...)\n    } else {\n        eBytes = decE\n    }\n    eReader := bytes.NewReader(eBytes)\n    var e uint64\n    err = binary.Read(eReader, binary.BigEndian, &amp;e)\n    if err != nil {\n        fmt.Println(err)\n        return nil, err\n    }\n    pKey := rsa.PublicKey{N: n, E: int(e)}\n    return &amp;pKey, nil\n}\n</code></pre>\n\n<p>I compared my public key and Yours (<a href=\"https://play.golang.org/p/L-08vwuWQ-\" rel=\"nofollow\">Playground</a>), and they have different values. Could You please give me feedback of the solution I suggested with Your code if it's working?</p>\n\n<p><strong>Edit 1</strong>: URLEncoding example <a href=\"https://play.golang.org/p/XCm679CJqS\" rel=\"nofollow\">Playground 2</a></p>\n\n<p><strong>Edit 2</strong>: This is how I verify the signature:</p>\n\n<pre><code>hasher := sha256.New()\nhasher.Write([]byte(data))\nerr = rsa.VerifyPKCS1v15(pubKey, crypto.SHA256, hasher.Sum(nil), signature)\n</code></pre>\n\n<p>So the 'data' variable in Edit 2 snippet is the same data(message) that has been used for signing on PHP side.</p>\n"}], "owner": {"reputation": 1226, "user_id": 427566, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/AATey.jpg?s=128&g=1", "display_name": "yngling", "link": "https://stackoverflow.com/users/427566/yngling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 1, "answer_count": 1, "score": 10, "last_activity_date": 1473174936, "creation_date": 1471163186, "last_edit_date": 1471165717, "question_id": 38940462, "link": "https://stackoverflow.com/questions/38940462/biometric-login-webauthn-in-go-how-to-verify-signature", "title": "Biometric login (webauthn) in Go, how to verify signature", "body": "<p>With the very recent\u00a0Windows Anniversary update, Edge now supports biometric authentication using Windows Hello (cf. <a href=\"https://developer.microsoft.com/en-us/microsoft-edge/platform/documentation/dev-guide/device/web-authentication/\">https://developer.microsoft.com/en-us/microsoft-edge/platform/documentation/dev-guide/device/web-authentication/</a>\u00a0, <a href=\"https://blogs.windows.com/msedgedev/2016/04/12/a-world-without-passwords-windows-hello-in-microsoft-edge/\">https://blogs.windows.com/msedgedev/2016/04/12/a-world-without-passwords-windows-hello-in-microsoft-edge/</a> )</p>\n\n<p>I have some samples in C#, PHP and Node.js, and am trying to make it work in Go.</p>\n\n<p>The following works in JS (I have hardcoded in the challenge and the key):</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>function parseBase64(s) {\n\u00a0 \u00a0 s = s.replace(/-/g, \"+\").replace(/_/g, \"/\").replace(/\\s/g, ''); \u00a0\n\u00a0 \u00a0 return new Uint8Array(Array.prototype.map.call(atob(s), function (c) { return c.charCodeAt(0) })); \u00a0\n}\n\nfunction concatUint8Array(a1,a2) {\n\u00a0 \u00a0 var d = new Uint8Array(a1.length + a2.length);\n\u00a0 \u00a0 d.set(a1);\n\u00a0 \u00a0 d.set(a2,a1.length);\n\u00a0 \u00a0 return d;\n}\n\nvar credAlgorithm = \"RSASSA-PKCS1-v1_5\";\nvar id,authenticatorData,signature,hash;\nwebauthn.getAssertion(\"chalenge\").then(function(assertion) {\n\u00a0 \u00a0 id = assertion.credential.id;\n\u00a0 \u00a0 authenticatorData = assertion.authenticatorData;\n\u00a0 \u00a0 signature = assertion.signature;\n\u00a0 \u00a0 return crypto.subtle.digest(\"SHA-256\",parseBase64(assertion.clientData));\n}).then(function(h) {\n\u00a0 \u00a0 hash = new Uint8Array(h);\n\u00a0 \u00a0 var publicKey = \"{\\\"kty\\\":\\\"RSA\\\",\\\"alg\\\":\\\"RS256\\\",\\\"ext\\\":false,\\\"n\\\":\\\"mEqGJwp0GL1oVwjRikkNfzd-Rkpb7vIbGodwQkTDsZT4_UE02WDaRa-PjxzL4lPZ4rUpV5SqVxM25aEIeGkEOR_8Xoqx7lpNKNOQs3E_o8hGBzQKpGcA7de678LeAUZdJZcnnQxXYjNf8St3aOIay7QrPoK8wQHEvv8Jqg7O1-pKEKCIwSKikCFHTxLhDDRo31KFG4XLWtLllCfEO6vmQTseT-_8OZPBSHOxR9VhIbY7VBhPq-PeAWURn3G52tQX-802waGmKBZ4B87YtEEPxCNbyyvlk8jRKP1KIrI49bgJhAe5Mow3yycQEnGuPDwLzmJ1lU6I4zgkyL1jI3Ghsw\\\",\\\"e\\\":\\\"AQAB\\\"}\";\n\u00a0 \u00a0 return crypto.subtle.importKey(\"jwk\",JSON.parse(publicKey),credAlgorithm,false,[\"verify\"]);\n}).then(function(key) {\n\u00a0 \u00a0 return crypto.subtle.verify({name:credAlgorithm, hash: { name: \"SHA-256\" }},key,parseBase64(signature),concatUint8Array(parseBase64(authenticatorData),hash));\n}).then(function(result) {\n\u00a0 \u00a0 console.log(\"ID=\" + id + \"\\r\\n\" + result);\n}).catch(function(err) {\n\u00a0 \u00a0 console.log('got err: ', err);\n});\n</code></pre>\n\n<p>In go I have the following code, meant to match the above JS code (req is a struct with strings from a JSON request body):</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>func webauthnSigninConversion(g string) ([]byte, error) {\n\u00a0\u00a0\u00a0 g = strings.Replace(g, \"-\", \"+\", -1)\n\u00a0\u00a0\u00a0 g = strings.Replace(g, \"_\", \"/\", -1)\n\u00a0\u00a0\u00a0 switch(len(g) % 4) { // Pad with trailing '='s\n\u00a0\u00a0\u00a0 case 0:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 // No pad chars in this case\n\u00a0\u00a0\u00a0 case 2:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 // Two pad chars\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 g = g + \"==\"\n\u00a0\u00a0\u00a0 case 3:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 // One pad char\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 g = g + \"=\";\n\u00a0\u00a0\u00a0 default:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 return nil, fmt.Errorf(\"invalid string in public key\")\n\u00a0\u00a0\u00a0 }\n\u00a0\u00a0\u00a0 b, err := base64.StdEncoding.DecodeString(g)\n\u00a0\u00a0\u00a0\u00a0if err != nil {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 return nil, err\n\u00a0\u00a0\u00a0 }\n\u00a0\u00a0\u00a0 return b, nil\n}\n\n\nclientData, err := webauthnSigninConversion(req.ClientData)\nif err != nil {\n\u00a0\u00a0\u00a0 return err\n}\n\nauthenticatorData, err := webauthnSigninConversion(req.AuthenticatorData)\nif err != nil {\n\u00a0\u00a0\u00a0 return err\n}\n\nsignature, err := webauthnSigninConversion(req.Signature)\nif err != nil {\n\u00a0\u00a0\u00a0 return err\n}\n\npublicKey := \"{\\\"kty\\\":\\\"RSA\\\",\\\"alg\\\":\\\"RS256\\\",\\\"ext\\\":false,\\\"n\\\":\\\"mEqGJwp0GL1oVwjRikkNfzd-Rkpb7vIbGodwQkTDsZT4_UE02WDaRa-PjxzL4lPZ4rUpV5SqVxM25aEIeGkEOR_8Xoqx7lpNKNOQs3E_o8hGBzQKpGcA7de678LeAUZdJZcnnQxXYjNf8St3aOIay7QrPoK8wQHEvv8Jqg7O1-pKEKCIwSKikCFHTxLhDDRo31KFG4XLWtLllCfEO6vmQTseT-_8OZPBSHOxR9VhIbY7VBhPq-PeAWURn3G52tQX-802waGmKBZ4B87YtEEPxCNbyyvlk8jRKP1KIrI49bgJhAe5Mow3yycQEnGuPDwLzmJ1lU6I4zgkyL1jI3Ghsw\\\",\\\"e\\\":\\\"AQAB\\\"}\" // this is really from\u00a0a db, not hardcoded\n// load json from public key, extract modulus and public exponent\nobj := strings.Replace(publicKey, \"\\\\\", \"\", -1) // remove escapes\nvar k struct {\n\u00a0\u00a0\u00a0 N string `json:\"n\"`\n\u00a0\u00a0\u00a0\u00a0E string `json:\"e\"`\n}\nif err = json.Unmarshal([]byte(obj), &amp;k); err != nil {\n\u00a0\u00a0\u00a0 return err\n}\nn, err := webauthnSigninConversion(k.N)\nif err != nil {\n\u00a0\u00a0\u00a0 return err\n}\ne, err := webauthnSigninConversion(k.E)\nif err != nil {\n\u00a0\u00a0\u00a0 return err\n}\npk := &amp;rsa.PublicKey{\n\u00a0\u00a0\u00a0 N: new(big.Int).SetBytes(n), // modulus\n\u00a0\u00a0\u00a0 E: int(new(big.Int).SetBytes(e).Uint64()), // public exponent\n}\n\u00a0\nhash := sha256.Sum256(clientData)\n\n// Create data buffer to verify signature over\nb := append(authenticatorData, hash[:]...)\n\u00a0\nif err = rsa.VerifyPKCS1v15(pk, crypto.SHA256, b, signature); err != nil {\n\u00a0\u00a0\u00a0 return err\n}\n\n// if no error, signature matches\n</code></pre>\n\n<p>This code fails with <code>crypto/rsa: input must be hashed message</code>. If I change to using <code>hash[:]</code> instead of <code>b</code> in <code>rsa.VerifyPKCS1v15</code>, it fails with <code>crypto/rsa: verification error</code>. The reason I believe I need to combine <code>authenticatorData</code> and <code>hash</code> is because that is what happens in the C# and PHP sample codes (cf,\u00a0 <a href=\"https://github.com/adrianba/fido-snippets/blob/master/csharp/app.cs\">https://github.com/adrianba/fido-snippets/blob/master/csharp/app.cs</a> ,\u00a0<a href=\"https://github.com/adrianba/fido-snippets/blob/master/php/fido-authenticator.php\">https://github.com/adrianba/fido-snippets/blob/master/php/fido-authenticator.php</a> ). </p>\n\n<p>Maybe Go does it a different way? </p>\n\n<p>I have printed the\u00a0byte arrays in JS and Go, and verified that <code>clientData</code>, <code>signatureData</code>, <code>authenticatorData</code>\u00a0and <code>hash</code> (and the combined array of the latter two) have the exact same values. I have not been able to extract the n and e fields from JS after creating the public key, so there might be a problem in how I create the public key.</p>\n"}, {"tags": ["php", "curl", "cookies", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1471162469, "post_id": 38939663, "comment_id": 65235906, "body": "Use an <a href=\"http://golang.org/pkg/net/http/#CookieJar\" rel=\"nofollow noreferrer\"><code>http.CookieJar</code></a> to manage cookies between multiple requests. For introduction see related question <a href=\"http://stackoverflow.com/questions/31270461/what-is-the-difference-between-cookie-and-cookiejar\">What is the difference between cookie and cookiejar?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7127, "user_id": 247002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f494e0363428b11d080c35ec3d199ff?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/247002/mark"}, "is_accepted": true, "score": 3, "last_activity_date": 1471161571, "creation_date": 1471161571, "answer_id": 38940294, "question_id": 38939663, "link": "https://stackoverflow.com/questions/38939663/curl-with-cookies-to-golang-http-request/38940294#38940294", "title": "Curl with cookies to Golang HTTP request", "body": "<p>To save a cookie:</p>\n\n<pre><code>// do whatever is needed to login and get the cookie\nresponse, err := http.PostForm(\"http://localhost:8080/login\", url.Values{\"username\": {\"foo\"}, \"password\": {\"bar\"}})\nif err != nil {\n    log.Fatal(err)\n}\n\nvar savedCookie *http.Cookie\n\nfor _, cookie := range response.Cookies() {\n    if cookie.Name == \"secret\" {\n        savedCookie = cookie\n    }\n}\n</code></pre>\n\n<p>Once you have the cookie you can build another request and add the cookie(s):</p>\n\n<pre><code>client := http.Client{}\nrequest, err := http.NewRequest(\"GET\", \"http://localhost:8080/protected\", nil)\nif err != nil {\n    log.Fatal(err)\n}\n\nrequest.AddCookie(savedCookie)\nresponse, err := client.Do(request)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>If you have multiple Cookies you can use a <a href=\"https://golang.org/pkg/net/http/#CookieJar\" rel=\"nofollow\">CookieJar</a> and set them directly in the Client:</p>\n\n<pre><code>client := &amp;http.Client{\n    Jar: jar,\n}\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 1345145, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/95e953e7ed701481fa93d3a2b67eff19?s=128&d=identicon&r=PG&f=1", "display_name": "asing", "link": "https://stackoverflow.com/users/1345145/asing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 0, "accepted_answer_id": 38940294, "answer_count": 1, "score": 0, "last_activity_date": 1471161571, "creation_date": 1471154956, "question_id": 38939663, "link": "https://stackoverflow.com/questions/38939663/curl-with-cookies-to-golang-http-request", "title": "Curl with cookies to Golang HTTP request", "body": "<p>I'm trying to get info from an old site that utilizes netscape HTTP cookie files to login. Here's my curl requests:</p>\n\n<pre><code>// Do login request and get cookie\ncurl -c cookies -X POST -i -v https://foobar.com/login\n\n// Use generated cookie file to get more data about the user\ncurl -b cookies -i -v https://foobar.com/data\n</code></pre>\n\n<p>In PHP, you could do something like: </p>\n\n<pre><code>// Do login request and get cookie\n$ch = curl_init();\ncurl_setopt($ch, CURLOPT_URL, 'https://foobar/login');\ncurl_setopt($ch, CURLOPT_POST, true);\ncurl_setopt($ch, CURLOPT_COOKIESESSION, true);\ncurl_setopt($ch, CURLOPT_COOKIEJAR, './cookies');\ncurl_setopt($ch, CURLOPT_COOKIEFILE, './cookies');  \n$user = curl_exec($ch);\n\n// Use generated cookie file to get data about the user \ncurl_setopt($ch, CURLOPT_URL, 'https://foobar/login');\ncurl_setopt($ch, CURLOPT_COOKIESESSION, true);\ncurl_setopt($ch, CURLOPT_COOKIEJAR, './cookies');\ncurl_setopt($ch, CURLOPT_COOKIEFILE, './cookies');  \n$data = curl_exec($ch);\n</code></pre>\n\n<p>Is there a way to do this using the std http package in Go?</p>\n"}, {"tags": ["variables", "dynamic", "go", "reflection", "go-reflect"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1471107352, "post_id": 38934539, "comment_id": 65225827, "body": "Yes, it is possible. It provides you package reflect. Disadvantage of reflect is usually big amount of work. On the other hand - without reflect can&#39;t be written such perfect packages like html/template or text/template where style of writting is like in interpreted language (like python) although go is compiled."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1471109168, "post_id": 38934539, "comment_id": 65226375, "body": "and reflect is slow, should be last resort."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 4, "creation_date": 1471114291, "post_id": 38934539, "comment_id": 65227805, "body": "If you really really need something like this, you should use (nested) maps, not hierarchies of struct values."}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1471142355, "post_id": 38934539, "comment_id": 65233135, "body": "Nested maps like <code>map[string]interface{}</code> are your friends"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 6, "last_activity_date": 1471148278, "last_edit_date": 1471148278, "creation_date": 1471146133, "answer_id": 38938929, "question_id": 38934539, "link": "https://stackoverflow.com/questions/38934539/golang-dynamic-variable-reference/38938929#38938929", "title": "Golang dynamic variable reference", "body": "<p>You may use <code>func (v Value) FieldByName(name string) Value</code> from <code>reflect</code> package:</p>\n\n<blockquote>\n  <p>FieldByName returns the struct field with the given name. It returns\n  the zero Value if no field was found. It panics if v's Kind is not\n  struct.</p>\n</blockquote>\n\n<p>Like this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\nfunc main() {\n    person := Person{}\n    person.name = \"testing\"\n    person.address.street = \"123 test st\"\n    person.address.city = \"tester\"\n    person.address.zip = 90210\n    person.billing.address.same = true\n\n    v := reflect.ValueOf(person)\n    f := v.FieldByName(\"address\")\n    key := f.FieldByName(\"zip\")\n    fmt.Println(key)                   // 90210\n    fmt.Println(f.FieldByName(\"city\")) // tester    \n}\n\ntype Person struct {\n    name    string\n    address Address\n    billing Billing\n}\ntype Billing struct {\n    address Address\n}\ntype Address struct {\n    street, city string\n    zip          int\n    same         bool\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>90210\ntester\n</code></pre>\n\n<hr>\n\n<p>And for your special case, you may use <code>fmt.Println(field(person, \"person.address.zip\"))</code>, like this working sample code (just for demonstration):  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\nimport \"strings\"\n\nfunc field(t interface{}, key string) reflect.Value {\n    strs := strings.Split(key, \".\")\n    v := reflect.ValueOf(t)\n    for _, s := range strs[1:] {\n        v = v.FieldByName(s)\n    }\n    return v\n}\nfunc main() {\n    person := Person{}\n    person.name = \"testing\"\n    person.address.street = \"123 test st\"\n    person.address.city = \"tester\"\n    person.address.zip = 90210\n    person.billing.address.same = true\n\n    fmt.Println(field(person, \"person.address.zip\"))  //90210\n    fmt.Println(field(person, \"person.address.city\")) //tester\n}\n\ntype Person struct {\n    name    string\n    address Address\n    billing Billing\n}\ntype Billing struct {\n    address Address\n}\ntype Address struct {\n    street, city string\n    zip          int\n    same         bool\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>90210\ntester\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 1, "last_activity_date": 1471174100, "creation_date": 1471174100, "answer_id": 38941768, "question_id": 38934539, "link": "https://stackoverflow.com/questions/38934539/golang-dynamic-variable-reference/38941768#38941768", "title": "Golang dynamic variable reference", "body": "<p>I'm not familiar with <em>protobuf</em>'s internals or if it provides any means to do that.</p>\n\n<p>But, <em>(1)</em> if you like to read the value in the way you described - by chaining fields dynamically and <em>(2)</em> you want to read it more than one time; I would just serialize it into <em>json</em> and use <a href=\"https://github.com/tidwall/gjson\" rel=\"nofollow\">this</a> package. It's very fast and gives you (almost) the same semantic you desire:</p>\n\n<pre><code>// assuming your object got marshaled to this for example\njson := `{\"name\":{\"first\":\"Janet\",\"last\":\"Prichard\"},\"age\":47}`\nvalue := gjson.Get(json, \"name.last\")\nprintln(value.String())\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 4893009, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c60c11b194736721a5b106e8057b0ed7?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/4893009/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5134, "favorite_count": 2, "accepted_answer_id": 38938929, "answer_count": 2, "score": 9, "last_activity_date": 1475745283, "creation_date": 1471104140, "last_edit_date": 1475745283, "question_id": 38934539, "link": "https://stackoverflow.com/questions/38934539/golang-dynamic-variable-reference", "title": "Golang dynamic variable reference", "body": "<p>In Go, I would like to do something like this. I have a big object with many structs (using Google's <code>protobuf</code>). here is a contrived example:</p>\n\n<pre><code>person.name = \"testing\"\nperson.address.street = \"123 test st\"\nperson.address.city = \"tester\"\nperson.address.zip = 90210\nperson.billing.address.same = true\n</code></pre>\n\n<p>I would like to be able to dynamically reference things. for example:</p>\n\n<pre><code>key := \"person.address.zip\"\nfmt.Println(\"the value of key: \" + key) // would like to get 90210\nkey := \"person.address.city\"\nfmt.Println(\"the value of key: \" + key) // would like to get \"tester\"\n</code></pre>\n\n<p>Is this possible in Go? if so, how could I do that? essentially, I'm creating a report which only contains a subset of the object and I want to be able to create a mapping file where the user can map keys/values together and my program will output the value. I have this working in python, but wanted to try using Go :)</p>\n"}, {"tags": ["heroku", "go", "godeps"], "answers": [{"tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 4, "last_activity_date": 1471184566, "last_edit_date": 1592644375, "creation_date": 1471163448, "answer_id": 38940489, "question_id": 38933957, "link": "https://stackoverflow.com/questions/38933957/dependencies-for-go-app-arent-installed-through-godep-on-heroku/38940489#38940489", "title": "Dependencies for Go app aren&#39;t installed through godep on Heroku", "body": "<p>Yes, You do need to have all dependencies into your repository.</p>\n<p>In fact when you run <code>godep save ./...</code> and you are using go 1.5 or greater, Godep will automatically put dependencies in a directory named <code>vendor</code> (inside root directory of your repo). You need to commit both Godep and vendor directory to your repository.</p>\n<p>On side note while adding vendor directory use -f flag to add all files in it. It is needed as some files/directory might not be committed depending on your gitignore file and that will cause build failure in heroku. As a standard practice you can exeute following command to after adding dependencies using godep.</p>\n<blockquote>\n<p>git add -f vendor/ Godep/</p>\n<p>git commit -a -m &quot;Vendorizing dependencies&quot;</p>\n</blockquote>\n"}], "owner": {"reputation": 2694, "user_id": 1317877, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o80B9.jpg?s=128&g=1", "display_name": "Kohei Mikami", "link": "https://stackoverflow.com/users/1317877/kohei-mikami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 2, "accepted_answer_id": 38940489, "answer_count": 1, "score": 4, "last_activity_date": 1471184566, "creation_date": 1471100238, "last_edit_date": 1471100937, "question_id": 38933957, "link": "https://stackoverflow.com/questions/38933957/dependencies-for-go-app-arent-installed-through-godep-on-heroku", "title": "Dependencies for Go app aren&#39;t installed through godep on Heroku", "body": "<p>I want to deploy Go application on Heroku, but I got an error like this:</p>\n\n<pre><code>remote: -----&gt; Go app detected\nremote: -----&gt; Checking Godeps/Godeps.json file.\nremote: -----&gt; Using go1.6.3\nremote:  !!    Installing package '.' (default)\nremote:  !!    \nremote:  !!    \nremote: -----&gt; Running: go install -v -tags heroku . \nremote: main.go:9:2: cannot find package \"github.com/go-martini/martini\" in any of:\nremote:     /app/tmp/cache/go1.6.3/go/src/github.com/go-martini/martini (from $GOROOT)\nremote:     /tmp/build_3c0222e075a91a3363e590a0169d6fb6/.heroku/go/src/github.com/go-martini/martini (from $GOPATH)\n</code></pre>\n\n<p>It works on my local environment and I added dependencies to <code>Godeps/Godeps.json</code> with <code>godeps save</code> command. What's the problem? I noticed official <a href=\"https://github.com/heroku/go-getting-started\" rel=\"nofollow\">go-getting-started</a> repo has <code>vendor</code> folder, so does it mean I have to have all dependencies into my repository?</p>\n\n<p>This is my <code>Godeps/Godeps.json</code>:</p>\n\n<pre><code>{\n    \"ImportPath\": \"github.com/mikamikuh/oauth2-server-tester\",\n    \"GoVersion\": \"go1.6\",\n    \"GodepVersion\": \"v74\",\n    \"Deps\": [\n        {\n            \"ImportPath\": \"github.com/codegangsta/inject\",\n            \"Comment\": \"v1.0-rc1-10-g33e0aa1\",\n            \"Rev\": \"33e0aa1cb7c019ccc3fbe049a8262a6403d30504\"\n        },\n        {\n            \"ImportPath\": \"github.com/go-martini/martini\",\n            \"Comment\": \"v1.0-185-gc257c41\",\n            \"Rev\": \"c257c412d547ac70fcaf5596c1a50a7cb832c1fc\"\n        }\n    ]\n}\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1471100008, "post_id": 38933898, "comment_id": 65223697, "body": "The go regexp package uses RE2 syntax, not PCRE <a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow noreferrer\">github.com/google/re2/wiki/Syntax</a>"}, {"owner": {"reputation": 6812, "user_id": 1410303, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UVBNS.png?s=128&g=1", "display_name": "SomeDude", "link": "https://stackoverflow.com/users/1410303/somedude"}, "edited": false, "score": 0, "creation_date": 1471100270, "post_id": 38933898, "comment_id": 65223773, "body": "<code>(?!re) \tbefore text not matching re (NOT SUPPORTED)</code> from the page <a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "reply_to_user": {"reputation": 6812, "user_id": 1410303, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UVBNS.png?s=128&g=1", "display_name": "SomeDude", "link": "https://stackoverflow.com/users/1410303/somedude"}, "edited": false, "score": 0, "creation_date": 1471104504, "post_id": 38933898, "comment_id": 65224977, "body": "@svasa Any alternate ways to make it work?"}, {"owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1471104735, "post_id": 38933898, "comment_id": 65225048, "body": "@JimB Thanks for the link. Any alternate way?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1471106310, "post_id": 38933898, "comment_id": 65225492, "body": "Use <code>regexp.MustCompile(&quot;^On\\\\s(.+?)wrote:$&quot;)</code> and <code>regexp.MustCompile(&quot;^On.*On\\\\s.+?wrote:&quot;)</code> and check if the first one is true and the second is false."}, {"owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1471106973, "post_id": 38933898, "comment_id": 65225699, "body": "@WiktorStribi\u017cew Thanks.."}, {"owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "edited": false, "score": 0, "creation_date": 1535644164, "post_id": 38933898, "comment_id": 91152749, "body": "I have this same issue, and am trying to reproduce it. It would help if I knew what this is supposed to match, so that I can apply the solution to my use case."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "edited": false, "score": 0, "creation_date": 1551746217, "post_id": 38933898, "comment_id": 96744391, "body": "@MikeWarren Go regex does not support lookarounds, thus, in each case, workarounds may be unique."}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 8, "last_activity_date": 1607544284, "last_edit_date": 1607544284, "creation_date": 1471107491, "answer_id": 38935027, "question_id": 38933898, "link": "https://stackoverflow.com/questions/38933898/error-parsing-regexp-invalid-or-unsupported-perl-syntax/38935027#38935027", "title": "error parsing regexp: invalid or unsupported Perl syntax: `(?!`", "body": "<p>Go regex does not support lookarounds.</p>\n<p>As a workaround, you may use</p>\n<pre><code>regexp.MustCompile(`^On\\s(.+?)wrote:$`)\n</code></pre>\n<p>and</p>\n<pre><code>regexp.MustCompile(`^On.*On\\s.+?wrote:`)\n</code></pre>\n<p>and check if the first one matches the string  and the second does not.</p>\n<p>You could also add an optional capturing group <code>(.*On)?</code></p>\n<pre><code>regexp.MustCompile(`^On(.*On)?\\s.+?wrote:`)\n</code></pre>\n<p>and check if there is a match and return <em>true</em> if the Group 1 ends with <code>On</code> - if yes, return <em>false</em>, else <em>true</em>.</p>\n"}], "owner": {"reputation": 4541, "user_id": 1091558, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/69188df1273c3c8c1fdeed66202c982b?s=128&d=identicon&r=PG", "display_name": "Giri", "link": "https://stackoverflow.com/users/1091558/giri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14780, "favorite_count": 2, "accepted_answer_id": 38935027, "answer_count": 1, "score": 17, "last_activity_date": 1607544284, "creation_date": 1471099827, "question_id": 38933898, "link": "https://stackoverflow.com/questions/38933898/error-parsing-regexp-invalid-or-unsupported-perl-syntax", "title": "error parsing regexp: invalid or unsupported Perl syntax: `(?!`", "body": "<p>When I try this regex in golang I'm getting regex parsing error. </p>\n\n<blockquote>\n  <p>error parsing regexp: invalid or unsupported Perl syntax: <code>(?!</code></p>\n</blockquote>\n\n<pre><code>regexp.MustCompile(\"^(?!On.*On\\\\s.+?wrote:)(On\\\\s(.+?)wrote:)$\"),\n</code></pre>\n\n<p>Can someone tell me why its not working and help me to fix this issue?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "string", "variables", "go"], "comments": [{"owner": {"reputation": 4258, "user_id": 1993909, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8a4896fd6dc637ba4ecb827021044bdd?s=128&d=identicon&r=PG", "display_name": "Daniel Cheung", "link": "https://stackoverflow.com/users/1993909/daniel-cheung"}, "edited": false, "score": 0, "creation_date": 1471095362, "post_id": 38933277, "comment_id": 65222299, "body": "You should tag your language as well. :)"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1471174420, "post_id": 38933277, "comment_id": 65238640, "body": "<code>strings.Split</code> does not returns an array but a slice of strings. And you have to actually check if <code>len(strs) &gt;= 2</code>. What&#39;s the content of the file?"}, {"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1471182394, "post_id": 38933277, "comment_id": 65240664, "body": "OH right..!! So...How do i assign slice values to currentSource and currentDest variables and the content of the file is multiple statements like C3,F3,C4,A4,C5,A1 @KavehShahbazian"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471103665, "post_id": 38933423, "comment_id": 65224747, "body": "The task for me was to read the input from a text file and yes im very sure  that it is fine, I dont understand why is it showing that error , the values are assigned correctly, but the program exits after that. As mentioned in the previous question I will wait, I&#39;m just looking for more help no offence @Toni Villena"}, {"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "reply_to_user": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471111164, "post_id": 38933423, "comment_id": 65226949, "body": "@Riya , I don&#39;t have offended, sorry if you thought that... :-)"}], "tags": [], "owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "is_accepted": true, "score": 0, "last_activity_date": 1471096366, "creation_date": 1471096366, "answer_id": 38933423, "question_id": 38933277, "link": "https://stackoverflow.com/questions/38933277/initializing-single-element-of-string-array-into-another-string-variable-in-go-l/38933423#38933423", "title": "Initializing single element of string array into another string variable in Go lang", "body": "<p>This works</p>\n\n<pre><code>var currentSource string\nvar currentDest string\n\nfunc main() {\n\n    file := \"A1,B2\\n\"\n    scanner := bufio.NewScanner(strings.NewReader(file))\n    for scanner.Scan() {\n        strs := strings.Split(scanner.Text(), \",\")\n\n        currentSource = strs[0]\n        currentDest = strs[1]\n\n        fmt.Println(strs)\n    }\n\n\n}\n</code></pre>\n\n<p>Are you sure your file (<code>chessin.txt</code>) it is ok?</p>\n\n<p><a href=\"https://play.golang.org/p/r-9FGaaJBZ\" rel=\"nofollow\">Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 0, "last_activity_date": 1471206546, "creation_date": 1471206546, "answer_id": 38946330, "question_id": 38933277, "link": "https://stackoverflow.com/questions/38933277/initializing-single-element-of-string-array-into-another-string-variable-in-go-l/38946330#38946330", "title": "Initializing single element of string array into another string variable in Go lang", "body": "<p>This code is almost the same as your code and it works correctly:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strings\"\n)\n\nvar currentSource string\nvar currentDest string\n\nfunc main() {\n\n    // content of this file is (no spaces between comas, not \\r or\n    // \\n or any other whitespace):\n    //C3,F3,C4,A4,C5,A1\n    file, err := os.Open(\"chessin.txt\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer file.Close()\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n        strs := strings.Split(scanner.Text(), \",\")\n\n        if len(strs) &lt; 2 {\n            panic(`not enough elements in the file, to proceed`)\n        }\n\n        currentSource = strs[0]\n        currentDest = strs[1]\n\n        break //(B)\n    }\n\n    if currentSource != \"C3\" {\n        panic(`currentSource IS NOT C3`)\n    }\n\n    if currentDest != \"F3\" {\n        panic(`currentDest is not F3`)\n    }\n\n    // if we are here, then we are good\n    fmt.Println(currentSource, currentDest)\n}\n</code></pre>\n\n<p>Just pay attention to the <code>break</code> statement at <em>(B)</em>. That causes the <code>for</code> loop to stop, after the first and second elements of the first line - not sure; but that might be what you want.</p>\n\n<p>So, if the program does not reach the <em>(A)</em> point, then there something wrong with <code>chessin.txt</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 38933423, "answer_count": 2, "score": 0, "last_activity_date": 1471206546, "creation_date": 1471095253, "last_edit_date": 1471095548, "question_id": 38933277, "link": "https://stackoverflow.com/questions/38933277/initializing-single-element-of-string-array-into-another-string-variable-in-go-l", "title": "Initializing single element of string array into another string variable in Go lang", "body": "<p>In this code, I read a text file for input (A1,B2) and Im using the split function to separate them at comma and store in strs, according to the function definition its returns a array in this case it is strs array, i want the first element in strs to be in currentSource and the second element to be in CurrentDest.I tried printing both the variables individually to check if its working,but the program exits after that and  I get a error saying Panic: index out of range. \nCan anybody help me out..!!!</p>\n\n<pre><code>var currentSource string\nvar currentDest string\n\nfunc main() {\n\n    file, err := os.Open(\"chessin.txt\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer file.Close()\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n        strs := strings.Split(scanner.Text(), \",\")\n\n        currentSource = strs[0]\n        currentDest = strs[1]\n}\n</code></pre>\n"}, {"tags": ["go", "jwt"], "comments": [{"owner": {"reputation": 7065, "user_id": 4275413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/diRiJ.png?s=128&g=1", "display_name": "Jakumi", "link": "https://stackoverflow.com/users/4275413/jakumi"}, "edited": false, "score": 1, "creation_date": 1471435831, "post_id": 38932802, "comment_id": 65344061, "body": "don&#39;t see right now where this might happen, but &quot;illegal base64 data at input byte 0&quot; basically means &quot;I expected a base 64 encoded string but got something else&quot;. (possibly something decoded or an error?) Happy debugging."}, {"owner": {"reputation": 4794, "user_id": 3791380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jI09M.jpg?s=128&g=1", "display_name": "Jakub Juszczak", "link": "https://stackoverflow.com/users/3791380/jakub-juszczak"}, "reply_to_user": {"reputation": 7065, "user_id": 4275413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/diRiJ.png?s=128&g=1", "display_name": "Jakumi", "link": "https://stackoverflow.com/users/4275413/jakumi"}, "edited": false, "score": 0, "creation_date": 1471465189, "post_id": 38932802, "comment_id": 65362801, "body": "It&#39;s super weird, because it only happens if I add the jwtMiddleware.Handler. If I remove the middleware and make the route public accessible, there are no errors."}, {"owner": {"reputation": 7065, "user_id": 4275413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/diRiJ.png?s=128&g=1", "display_name": "Jakumi", "link": "https://stackoverflow.com/users/4275413/jakumi"}, "edited": false, "score": 0, "creation_date": 1471504031, "post_id": 38932802, "comment_id": 65374981, "body": "well, a jwt has to be encoded (it&#39;s in the spec I think?) base64(header) &quot;.&quot; base64(payload) &quot;.&quot; base64(signature). So, if the first part doesn&#39;t begin with a base 64 char, it probably isn&#39;t encoded correctly. You should find out, how to correctly use the jwtMiddleware library, because that&#39;s <i>probably</i> the reason why it doesn&#39;t work. Depending on how your setup is ... could be that the &quot;token&quot; you&#39;re getting is an error. In any case, some debugging is in order"}], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 1014487, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5578ad09cf8a1c9d5283a39a40e6432a?s=128&d=identicon&r=PG", "display_name": "Adrian E. Labastida Ca&#241;izares", "link": "https://stackoverflow.com/users/1014487/adrian-e-labastida-ca%c3%b1izares"}, "edited": false, "score": 0, "creation_date": 1522319380, "post_id": 39375354, "comment_id": 86114599, "body": "This helped me with the same issue, darn tuts, thanks!"}], "tags": [], "owner": {"reputation": 2196, "user_id": 5179133, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cuo4J.jpg?s=128&g=1", "display_name": "Clay Risser", "link": "https://stackoverflow.com/users/5179133/clay-risser"}, "is_accepted": false, "score": 2, "last_activity_date": 1473266637, "creation_date": 1473266637, "answer_id": 39375354, "question_id": 38932802, "link": "https://stackoverflow.com/questions/38932802/illegal-base64-data-at-input-byte-0-in-go/39375354#39375354", "title": "illegal base64 data at input byte 0 in go", "body": "<p>Don't use curlies around your token. The documentation in many places is confusing because it wraps your token in curlies. It's meant to represent a placeholder. You're not actually supposed to wrap your token with them. Do NOT do it like this.</p>\n\n<pre><code>Bearer {my-special-token}\n</code></pre>\n\n<p>It should be done like this</p>\n\n<pre><code>Bearer my-special-token\n</code></pre>\n"}], "owner": {"reputation": 4794, "user_id": 3791380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jI09M.jpg?s=128&g=1", "display_name": "Jakub Juszczak", "link": "https://stackoverflow.com/users/3791380/jakub-juszczak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3097, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1473266637, "creation_date": 1471091836, "question_id": 38932802, "link": "https://stackoverflow.com/questions/38932802/illegal-base64-data-at-input-byte-0-in-go", "title": "illegal base64 data at input byte 0 in go", "body": "<p>I am starting with go and jwt. </p>\n\n<p>For testing purpose I have a hardcoded secret.\nAnd a route to get the key</p>\n\n<pre><code>const secretKey = \"YOLOSWAG\"\n\nvar mySigningKey = []byte(secretKey)\n\n\nvar GetTokenHandler = http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    token := jwt.New(jwt.SigningMethodHS256)\n    token.Claims = jwt.MapClaims{\n        \"admin\": true,\n        \"name\":  \"John Doe\",\n        \"exp\":   time.Now().Add(time.Hour * 24).Unix(),\n    }\n\n    tokenString, _ := token.SignedString(mySigningKey)\n\n    w.Write([]byte(tokenString))\n})\n\nvar jwtMiddleware = jwtmiddleware.New(jwtmiddleware.Options{\n    ValidationKeyGetter: func(token *jwt.Token) (interface{}, error) {\n        return mySigningKey, nil\n    },\n    SigningMethod: jwt.SigningMethodHS256,\n})\n</code></pre>\n\n<p>and later added the jwtMiddleware to my route</p>\n\n<pre><code>r.Handle(\"/protected\", jwtMiddleware.Handler(ProtectedTestHandler)).Methods(\"GET\")\n</code></pre>\n\n<p>So localhost:3000/protected will output an error Required authorization token not found</p>\n\n<p>this works.</p>\n\n<p>/token will output my token. This works too.</p>\n\n<p>And finally /protected with (in postman) Authorization: Bearer {token} </p>\n\n<p>Will output illegal base64 data at input byte 0\nI am really confused why this happens. </p>\n"}, {"tags": ["arrays", "function", "go", "copy", "return"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471088632, "post_id": 38932109, "comment_id": 65220435, "body": "It gives a error saying panic:index of out range @ToniVillena"}, {"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "reply_to_user": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471088859, "post_id": 38932109, "comment_id": 65220480, "body": "Could you give me a playgolang with your code, please? It would be easier"}, {"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471089089, "post_id": 38932109, "comment_id": 65220545, "body": "<a href=\"https://play.golang.org/p/fo5AkWNbEo\" rel=\"nofollow noreferrer\">play.golang.org/p/fo5AkWNbEo</a> here is the code, also if your good at traversals(dfs)and you think my code is not right at some point, please let me know I am happy to change it. @ToniVillena"}, {"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "reply_to_user": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471090442, "post_id": 38932109, "comment_id": 65220891, "body": "@Riya , your code has that fail because you try to do <code>strs[0] = currentSource</code>. And <code>currentSource</code> is initialized to zero (&quot;&quot;). When you execute <code>IsValid(currentSource)</code>, you try to access to <code>0</code> and <code>1</code> position of string <code>b</code> (currentSource) (<code>b[0]</code> and <code>b[1]</code>), but length of <code>currentSource</code> or <code>b</code> is 0. Try this <a href=\"https://play.golang.org/p/XMbXWDLY9m\" rel=\"nofollow noreferrer\">play.golang.org/p/XMbXWDLY9m</a>"}, {"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471092146, "post_id": 38932109, "comment_id": 65221364, "body": "Just to Clarify..My input is two positions on the chessboard, and im trying to find the shortest path between the two using dfs, so I will have text file that has input like :A3,B2 D3,C4 etc. Coming to the error part I&#39;m still getting the same error index out of range  @ToniVillena"}, {"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "reply_to_user": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471096554, "post_id": 38932109, "comment_id": 65222666, "body": "@Riya , I&#39;m viewing your playgolang. You have some fails so basic... If you wait, I will give you a playgolang. But, there are any things I don&#39;t understand too well"}, {"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471103469, "post_id": 38932109, "comment_id": 65224696, "body": "you can ask any questions related to that, i can explain and yes i will wait no problem @Toni Villena"}, {"owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "reply_to_user": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471111513, "post_id": 38932109, "comment_id": 65227025, "body": "@Riya, what kind of chess piece is? If your chess piece has &quot;A1&quot; position, it will have &quot;C2&quot; and &quot;B3&quot; how possible moves. Or, how does it works the movements? Has it a range? Is this behavior correct? <a href=\"https://play.golang.org/p/XdLlyFczX_\" rel=\"nofollow noreferrer\">play.golang.org/p/XdLlyFczX_</a>"}, {"owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "edited": false, "score": 0, "creation_date": 1471112320, "post_id": 38932109, "comment_id": 65227242, "body": "the chess piece is a knight, the function possible moves calculates moves for a given in the pattern of a knight, and the sort function below avoids the moves out of the board, the code you have written is correct instead the input should be from a text file. @Toni Villena"}], "tags": [], "owner": {"reputation": 547, "user_id": 5810474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108078f0353c37a619786a600fbbaec1?s=128&d=identicon&r=PG&f=1", "display_name": "Toni Villena", "link": "https://stackoverflow.com/users/5810474/toni-villena"}, "is_accepted": false, "score": 1, "last_activity_date": 1471088763, "last_edit_date": 1471088763, "creation_date": 1471086965, "answer_id": 38932109, "question_id": 38931901, "link": "https://stackoverflow.com/questions/38931901/how-to-copy-elements-of-one-array-to-another-from-different-functions-in-golang/38932109#38932109", "title": "How to copy elements of one array to another from different functions in Golang", "body": "<p><code>Copy</code> function is used with two slices as arguments <code>(1 -&gt; dst, 2 -&gt; src)</code>, then, you must use two slices or convert your <code>[8]int</code> arrays to slices, you could do it using <code>[:]</code> operator. This operator will return a slice that will have a reference to <code>[8]int</code> array.</p>\n\n<p><code>Posmoves</code> is undefined because you didn't define in any place. Then, you could create a global variable:</p>\n\n<pre><code>var Posmoves [8]int\n\nfunc main() {\n    PossibleMoves()\n    traversal()\n\n    fmt.Println(Posmoves)\n}\n\n\nfunc PossibleMoves() [8]int {\n    /* calculations*/\n    return Posmoves\n}\n\nfunc traversal() {\n\n    var currentarray [8]int\n\n    copy(Posmoves[:], currentarray[:])\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/9AHwF_bNMg\" rel=\"nofollow\">Playground</a></p>\n\n<p>It returns <code>[0 0 0 0 0 0 0 0]</code> because both arrays are initialized to zero value (default value).</p>\n\n<p>You could execute <code>trasversal()</code> too and this will get <code>Posmoval array</code> from <code>PossibleMoves()</code>. So:</p>\n\n<pre><code>func main() {\n    traversal()\n}\n\nfunc PossibleMoves() [8]int {\n    /* calculations*/\n\n    var Posmoves [8]int\n\n    return Posmoves\n}\n\nfunc traversal() {\n\n    var currentarray [8]int\n\n    Posmoves := PossibleMoves()\n\n    copy(Posmoves[:], currentarray[:])\n\n    fmt.Println(currentarray)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BwUSpcK_OM\" rel=\"nofollow\">Playground</a></p>\n\n<p>The output will be again: <code>[0 0 0 0 0 0 0 0]</code> </p>\n\n<p>I hope it helps you! :-)</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1471104186, "last_edit_date": 1471104186, "creation_date": 1471103700, "answer_id": 38934465, "question_id": 38931901, "link": "https://stackoverflow.com/questions/38931901/how-to-copy-elements-of-one-array-to-another-from-different-functions-in-golang/38934465#38934465", "title": "How to copy elements of one array to another from different functions in Golang", "body": "<p><a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow\">Slices</a> are <em>descriptors</em> (headers pointing to a backing array), not like <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow\">arrays</a> which are <em>values</em>. An array value means all its elements.</p>\n\n<p>So in order to copy all the elements from one array into another, you don't need any \"special\" copy function, you just need to <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow\">assign</a> the array value.</p>\n\n<p>Seriously, this is all what you need:</p>\n\n<pre><code>var currentarray [8]int = PossibleMoves()\n</code></pre>\n\n<p>Or you can use <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">short variable declaration</a> and then it's just</p>\n\n<pre><code>currentarray := PossibleMoves()\n</code></pre>\n\n<p>See this simple example:</p>\n\n<pre><code>var a [8]int\nvar b = [8]int{1, 2, 3, 4, 5, 6, 7, 8}\n\nfmt.Println(a, b)\na = b\nfmt.Println(a, b)\n\na[0] = 9\nfmt.Println(a, b)\n</code></pre>\n\n<p>Output (try it on the <kbd><a href=\"https://play.golang.org/p/ZKDPrs1oQ2\" rel=\"nofollow\">Go Playground</a></kbd>):</p>\n\n<pre><code>[0 0 0 0 0 0 0 0] [1 2 3 4 5 6 7 8]\n[1 2 3 4 5 6 7 8] [1 2 3 4 5 6 7 8]\n[9 2 3 4 5 6 7 8] [1 2 3 4 5 6 7 8]\n</code></pre>\n\n<p>As you can see, after the assignment (<code>a = b</code>), the <code>a</code> array contains the same elements as the <code>b</code> array.</p>\n\n<p>And the 2 arrays are distinct / independent: modifying an element of <code>a</code> does not modify the array <code>b</code>. We modified <code>a[0] = 9</code>, <code>b[0]</code> still remains <code>1</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 6661661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd339383006493102bae62d9d013083?s=128&d=identicon&r=PG&f=1", "display_name": "Riya", "link": "https://stackoverflow.com/users/6661661/riya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 38934465, "answer_count": 2, "score": 1, "last_activity_date": 1471104295, "creation_date": 1471085290, "last_edit_date": 1471104295, "question_id": 38931901, "link": "https://stackoverflow.com/questions/38931901/how-to-copy-elements-of-one-array-to-another-from-different-functions-in-golang", "title": "How to copy elements of one array to another from different functions in Golang", "body": "<p>I want to know how to copy elements of one array returned by a function into another array in a different function.</p>\n\n<p>Eg:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code> func PossibleMoves()[8] int{\n /* calculations*/\n return Posmoves[]\n}\n\nfunc traversal(){\n\n var currentarray [8] int\n\ncopy(Posmoves,currentarray)\n}\n</code></pre>\n\n<p>This shows an error saying undefined Posmoves, How should I correct it...</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1471080655, "post_id": 38931126, "comment_id": 65218586, "body": "OP, I simplified your exemple by removing the useless first allocation. You can revert if you disagree."}, {"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 2, "creation_date": 1471080838, "post_id": 38931126, "comment_id": 65218628, "body": "This really looks like the compiler wrongly thought it could optimize something out, and only keeps the correct value of b when it&#39;s printed after. I verified that this doesn&#39;t happen for example with 1.4.2. This should be brought to golang-nuts attention, in case there&#39;s not a bug already filled."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1471081617, "post_id": 38931126, "comment_id": 65218794, "body": "I understand, that this example can confuse you a lot. A nice article is <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>. Slice is something, that points into array - it has remember array, where it point, his lenght and capacity. Usually we don&#39;t care about capacity, but in append is very important. Append may share the memory with previous one, if there is enough space, but won&#39;t share if it is not. In our case put <i>fmt.Println(cap(a))</i> after a=[]byte. It returned me 8. That means, while b and c will be shorter, they will point to the same memory."}, {"owner": {"reputation": 63, "user_id": 5468251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f568f3111e41789efa737b2e09e3278?s=128&d=identicon&r=PG&f=1", "display_name": "Salitter", "link": "https://stackoverflow.com/users/5468251/salitter"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1471083860, "post_id": 38931126, "comment_id": 65219298, "body": "@lofcek I understand that, but I don&#39;t think that&#39;s what&#39;s causing issue here.  The cap() is different depending on whether a print statement is used at the end."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1471088908, "post_id": 38931126, "comment_id": 65220495, "body": "This is good point. The slice was created by a := []byte(&quot;AAA&quot;) - but there are no quarantines, what will be capacity of a at the begging. It could depends on version of go (like mentioned Amd), but also on something else like in example. But because you don&#39;t have quaranties, good code should not make any assumptions on capacity. But in our  case capacity of a decides, whether b and c will or won&#39;t point to the same address and it decides how will be the result."}, {"owner": {"reputation": 63, "user_id": 5468251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f568f3111e41789efa737b2e09e3278?s=128&d=identicon&r=PG&f=1", "display_name": "Salitter", "link": "https://stackoverflow.com/users/5468251/salitter"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1471089600, "post_id": 38931126, "comment_id": 65220680, "body": "@lofcek that&#39;s correct.  If you look at the play.golang.org example in the description though, I initialize the slice with capacity of 1000, and we still have the bug regardless."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 1, "creation_date": 1471101142, "post_id": 38931126, "comment_id": 65224032, "body": "That is not fully true - you initialize a to capacity 1000 elements, but in next line, you forgot this value and replace it with a new one."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1471101514, "post_id": 38931126, "comment_id": 65224151, "body": "Change line  a = []byte(&quot;AAA&quot;) to a = append(a, []byte(&quot;AAA&quot;)...)"}, {"owner": {"reputation": 63, "user_id": 5468251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f568f3111e41789efa737b2e09e3278?s=128&d=identicon&r=PG&f=1", "display_name": "Salitter", "link": "https://stackoverflow.com/users/5468251/salitter"}, "edited": false, "score": 0, "creation_date": 1471101842, "post_id": 38931126, "comment_id": 65224226, "body": "Ahh you&#39;re right - my mistake :)"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5468251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f568f3111e41789efa737b2e09e3278?s=128&d=identicon&r=PG&f=1", "display_name": "Salitter", "link": "https://stackoverflow.com/users/5468251/salitter"}, "edited": false, "score": 0, "creation_date": 1471101779, "post_id": 38931839, "comment_id": 65224209, "body": "Good to know this has been fixed!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 3, "last_activity_date": 1471087812, "last_edit_date": 1471087812, "creation_date": 1471084816, "answer_id": 38931839, "question_id": 38931126, "link": "https://stackoverflow.com/questions/38931126/strange-behavior-with-golang-append-being-affected-by-fmt-println/38931839#38931839", "title": "Strange behavior with Golang append() being affected by fmt.Println()", "body": "<p>You're right: \nThat is because <a href=\"https://play.golang.org/p/jJ-5ZxTBIn\" rel=\"nofollow\">The Go Playground</a> version is old (<code>go1.6.2</code>), use new version. </p>\n\n<hr>\n\n<p>The correct output (using <code>go version go1.7rc6</code>) is:</p>\n\n<pre><code> a:  AAA  b:  AAABBB\n a:  AAA  b:  AAACCC  c:  AAACCC\n</code></pre>\n\n<hr>\n\n<p>1- The Go Playground (<code>go1.6.2</code>):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := make([]byte, 100, 1000)\n    a = []byte(\"AAA\")\n\n    b := append(a, []byte(\"BBB\")...)\n    fmt.Println(\" a: \", string(a), \" b: \", string(b))\n\n    c := append(a, []byte(\"CCC\")...)\n    fmt.Println(\" a: \", string(a), \" b: \", string(b), \" c: \", string(c))\n\n    //fmt.Println(&amp;b) //try commenting this out and in and running the program\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code> a:  AAA  b:  AAABBB\n a:  AAA  b:  AAABBB  c:  AAACCC\n</code></pre>\n\n<hr>\n\n<p>2- The Go Playground (<code>go1.6.2</code>):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := make([]byte, 100, 1000)\n    a = []byte(\"AAA\")\n\n    b := append(a, []byte(\"BBB\")...)\n    fmt.Println(\" a: \", string(a), \" b: \", string(b))\n\n    c := append(a, []byte(\"CCC\")...)\n    fmt.Println(\" a: \", string(a), \" b: \", string(b), \" c: \", string(c))\n\n    fmt.Println(&amp;b) //try commenting this out and in and running the program\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code> a:  AAA  b:  AAABBB\n a:  AAA  b:  AAACCC  c:  AAACCC\n&amp;[65 65 65 67 67 67]\n</code></pre>\n\n<hr>\n\n<p>using <code>go version go1.7rc6</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := make([]byte, 100, 1000)\n    a = []byte(\"AAA\")\n\n    b := append(a, []byte(\"BBB\")...)\n    fmt.Println(\" a: \", string(a), \" b: \", string(b))\n\n    c := append(a, []byte(\"CCC\")...)\n    fmt.Println(\" a: \", string(a), \" b: \", string(b), \" c: \", string(c))\n\n    //fmt.Println(&amp;b) //try commenting this out and in and running the program\n}\n</code></pre>\n\n<p>output :</p>\n\n<pre><code> a:  AAA  b:  AAABBB\n a:  AAA  b:  AAACCC  c:  AAACCC\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1471419496, "post_id": 38934360, "comment_id": 65333397, "body": "This doesn&#39;t answer the question at all. The problem was a compiler bug."}], "tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 1, "last_activity_date": 1471102911, "creation_date": 1471102911, "answer_id": 38934360, "question_id": 38931126, "link": "https://stackoverflow.com/questions/38931126/strange-behavior-with-golang-append-being-affected-by-fmt-println/38934360#38934360", "title": "Strange behavior with Golang append() being affected by fmt.Println()", "body": "<p>I will summarize:</p>\n\n<pre><code>a := make([]byte, 100, 1000)\na = []byte(\"AAA\")\n</code></pre>\n\n<p>creates a slice, in first line, but in second it creates a new array and slice again.</p>\n\n<p>Capacity of this new array depends on version of compiler, therefore good written code should not make any other assumption, than it will be 3 or more.</p>\n\n<p>Be cautious when using append. Returned slice could be shallow or deep copy of previous slice. Which one depends on array capacity. If you need a deep copy, you have to do it manually.</p>\n\n<pre><code>b:=make([]byte, len(a))\ncopy(b,a)\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5468251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f568f3111e41789efa737b2e09e3278?s=128&d=identicon&r=PG&f=1", "display_name": "Salitter", "link": "https://stackoverflow.com/users/5468251/salitter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 38931839, "answer_count": 2, "score": 5, "last_activity_date": 1471102911, "creation_date": 1471079281, "last_edit_date": 1471085267, "question_id": 38931126, "link": "https://stackoverflow.com/questions/38931126/strange-behavior-with-golang-append-being-affected-by-fmt-println", "title": "Strange behavior with Golang append() being affected by fmt.Println()", "body": "<p>I noticed some strange behavior with Golang's append().  I understand the basic concept of how slice capacity affects whether a new underlying array gets allocated, but why is whether or not I use a <code>fmt.Println()</code> AFTER the append has happened affecting the result of the append?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := []byte(\"AAA\")\n\n    b := append(a, []byte(\"BBB\")...)\n    fmt.Println(\" a: \", string(a), \" b: \", string(b))\n\n    c := append(a, []byte(\"CCC\")...)\n    fmt.Println(\" a: \", string(a), \" b: \", string(b), \" c: \", string(c))\n\n    fmt.Println(&amp;b) //try commenting this out and in and running the program\n}\n</code></pre>\n\n<p>Link to run code here: <a href=\"https://play.golang.org/p/jJ-5ZxTBIn\" rel=\"nofollow\">https://play.golang.org/p/jJ-5ZxTBIn</a></p>\n"}, {"tags": ["methods", "go", "interface"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1471069749, "creation_date": 1471069749, "answer_id": 38929908, "question_id": 38929849, "link": "https://stackoverflow.com/questions/38929849/golang-method-param-interface/38929908#38929908", "title": "Golang method param interface{}", "body": "<p>Use <code>strV, ok := str.(*String)</code>,<br>\nLike this working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\ntype String struct{ Result string }\n\nfunc main() {\n    result := &amp;String{Result: \"value\"}    \n    testDataBase(result)\n    fmt.Println(result.Result)\n}\n\nfunc testDataBase(str interface{}) {\n    strV, ok := str.(*String)\n    if !ok {\n        panic(\"error\")\n    }\n    strV.Result = \"34\"\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>34\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3260264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pavUi.jpg?s=128&g=1", "display_name": "donsonzhang", "link": "https://stackoverflow.com/users/3260264/donsonzhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 38929908, "answer_count": 1, "score": 0, "last_activity_date": 1471069813, "creation_date": 1471069239, "last_edit_date": 1471069813, "question_id": 38929849, "link": "https://stackoverflow.com/questions/38929849/golang-method-param-interface", "title": "Golang method param interface{}", "body": "<p>code:</p>\n\n<pre><code>type String struct {\n    Result string\n}\n\nfunc main() {\n    result := &amp;String{Result:\"value\"}\n    //var test string= \"value\"\n    //result := &amp;test\n\n    testDataBase(result)\n    fmt.Print(result.Result) //expect:\"34\",but:\"value\"\n}\n\nfunc testDataBase(str interface{}) {\n    strV,ok := str.(String)\n    if ok {\n        strV.Result=\"34\"\n    }\n}\n</code></pre>\n\n<p>so,how can I get the result :34 ?</p>\n"}, {"tags": ["caching", "go", "redis", "beego"], "answers": [{"tags": [], "owner": {"reputation": 434, "user_id": 3406535, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/737799829/picture?type=large", "display_name": "shadab.tughlaq", "link": "https://stackoverflow.com/users/3406535/shadab-tughlaq"}, "is_accepted": false, "score": 0, "last_activity_date": 1471093619, "creation_date": 1471093619, "answer_id": 38933036, "question_id": 38929003, "link": "https://stackoverflow.com/questions/38929003/how-to-put-cache-with-no-expiration-in-redis-using-golang-beego/38933036#38933036", "title": "How to put cache with no expiration in redis using golang (beego)", "body": "<p>You may import \"github.com/garyburd/redigo/redis\"</p>\n\n<p>AND do the following </p>\n\n<pre><code>var conn, _ = redis.Dial(\"tcp\", \"X.X.X.X:6379\")\n\nconn.Do(\"SET\", \"key\", \"value\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5330073, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LYOSrbC5dt8/AAAAAAAAAAI/AAAAAAAABOY/bm8v8f0YuU0/photo.jpg?sz=128", "display_name": "arnel cabinti", "link": "https://stackoverflow.com/users/5330073/arnel-cabinti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510003512, "creation_date": 1471060279, "last_edit_date": 1510003512, "question_id": 38929003, "link": "https://stackoverflow.com/questions/38929003/how-to-put-cache-with-no-expiration-in-redis-using-golang-beego", "title": "How to put cache with no expiration in redis using golang (beego)", "body": "<p>I have a problem doing my cache in redis.\nI want to put data with no expiration. How can I do that?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>rediscache.Put(\"name\",arrayString, 10 * time.Second)\n</code></pre>\n"}, {"tags": ["regex", "string", "go", "split"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6711286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dfdc2a7cba00c08f19bf88e032d84a6?s=128&d=identicon&r=PG&f=1", "display_name": "Bob A.", "link": "https://stackoverflow.com/users/6711286/bob-a"}, "edited": false, "score": 0, "creation_date": 1471067230, "post_id": 38928813, "comment_id": 65215724, "body": "Can you explain the regex? Is that saying any word that starts with a capitalized letter followed by lower case with apostrophe, and ends in some kind of symbol?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 3, "user_id": 6711286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dfdc2a7cba00c08f19bf88e032d84a6?s=128&d=identicon&r=PG&f=1", "display_name": "Bob A.", "link": "https://stackoverflow.com/users/6711286/bob-a"}, "edited": false, "score": 0, "creation_date": 1471114667, "post_id": 38928813, "comment_id": 65227919, "body": "Added an explanation of the regular expression (and removed the unnecessary backslashes)."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 1, "last_activity_date": 1471114637, "last_edit_date": 1471114637, "creation_date": 1471057714, "answer_id": 38928813, "question_id": 38928220, "link": "https://stackoverflow.com/questions/38928220/golang-how-to-split-a-string-to-a-slice-containing-the-delimeters-using-a-regula/38928813#38928813", "title": "golang how to split a string to a slice containing the delimeters using a regular expression", "body": "<p>You can do that by creating a regular expression that matches either a word or one of your special characters. I don't know exactly what your rules are, but given the input and desired output, this works:</p>\n\n<pre><code>[A-Za-z']+|[*?()$.,!]\n</code></pre>\n\n<p>You can then use <code>FindAllString</code> to return the individual strings.</p>\n\n<p>See <a href=\"https://play.golang.org/p/se6B74G_Fv\" rel=\"nofollow\">https://play.golang.org/p/se6B74G_Fv</a>.</p>\n\n<p>The idea of the regular expression is to match either a word, here defined as a sequence of one or more upper or lower case letters or apostrophes, or a \"special character\", defined as any of the non-word characters in your sample input. The regular expression contains two parts separated by a <code>|</code>, meaning that either alternative can match. A set of characters contained within square brackets is called a <em>character class</em>, which means that any of the characters can match (and <code>a-z</code> means all characters from a to z). Since the left alternative is a character class followed by a <code>+</code>, one or more of the characters in the class will match. The portion on the right only matches one character. You may need to adjust this to behave exactly the way you want. For more information on Go regular expressions, see <a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow\">https://github.com/google/re2/wiki/Syntax</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 6711286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dfdc2a7cba00c08f19bf88e032d84a6?s=128&d=identicon&r=PG&f=1", "display_name": "Bob A.", "link": "https://stackoverflow.com/users/6711286/bob-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1637, "favorite_count": 0, "accepted_answer_id": 38928813, "answer_count": 1, "score": 0, "last_activity_date": 1471114637, "creation_date": 1471050112, "last_edit_date": 1471050642, "question_id": 38928220, "link": "https://stackoverflow.com/questions/38928220/golang-how-to-split-a-string-to-a-slice-containing-the-delimeters-using-a-regula", "title": "golang how to split a string to a slice containing the delimeters using a regular expression", "body": "<p>I want to split a string to a slice but want to keep the delimiters. Is there a way to do that in golang?</p>\n\n<p>For example</p>\n\n<p>Input: </p>\n\n<pre><code>\"Hello! It's, a? beautiful$ day* (today and tomorrow).\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[Hello | ! | It's | , | a | ? | beautiful | $ | day | * | ( | today | and | tomorrow | ) | . ]\n</code></pre>\n\n<p>where <code>|</code> represents the separation of elements. </p>\n\n<p>Can anyone help? </p>\n"}, {"tags": ["json", "go", "mime-types", "static-files", "raml"], "answers": [{"tags": [], "owner": {"reputation": 6990, "user_id": 329289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1536aecadab8356ff5e2d59da6c591?s=128&d=identicon&r=PG", "display_name": "Owen S.", "link": "https://stackoverflow.com/users/329289/owen-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1471047239, "creation_date": 1471047239, "answer_id": 38927993, "question_id": 38927971, "link": "https://stackoverflow.com/questions/38927971/how-do-i-serve-a-static-file-with-httprouter-with-correct-mime-type/38927993#38927993", "title": "How do I serve a static file with httprouter with correct MIME type?", "body": "<p>Yes, there's a way to do this. The <code>net/http</code> library uses the <code>mime</code> library under the hood to detect content types. In particular, it uses <a href=\"https://golang.org/pkg/mime/#TypeByExtension\" rel=\"nofollow\">TypeByExtension</a> to figure out whether the file extension is associated with a known content type. To configure that, simply call <a href=\"https://golang.org/pkg/mime/#AddExtensionType\" rel=\"nofollow\">AddExtensionType</a>, say, where you register your static file routing during app startup.</p>\n"}], "owner": {"reputation": 6990, "user_id": 329289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1536aecadab8356ff5e2d59da6c591?s=128&d=identicon&r=PG", "display_name": "Owen S.", "link": "https://stackoverflow.com/users/329289/owen-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471047239, "creation_date": 1471047083, "question_id": 38927971, "link": "https://stackoverflow.com/questions/38927971/how-do-i-serve-a-static-file-with-httprouter-with-correct-mime-type", "title": "How do I serve a static file with httprouter with correct MIME type?", "body": "<p>I'm using the <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"nofollow\">httprouter</a> Go library to implement a REST API service, and I decided to try <a href=\"https://godoc.org/github.com/julienschmidt/httprouter#Router.ServeFiles\" rel=\"nofollow\">ServeFiles</a> to serve some schema files associated with my API. I note that it uses Go's handy built-in <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow\">net/http</a> package under the hood for serving static files.</p>\n\n<p>It works almost perfectly, except for one nit: RAML files are served with the content type <code>text/plain</code>. I note, however, that the JSON schema files I have get served with <code>application/json</code>, so clearly there's some sort of MIME type association going on with the static file service. Is there a way to configure it to detect my RAML file as such, and serve it with, say, the content type <code>application/raml+yaml</code> instead?</p>\n\n<p>I follow the usual convention of <code>.raml</code> file extensions for the RAML files and <code>.json</code> for the JSON schemas.</p>\n"}, {"tags": ["java", "intellij-idea", "plugins", "go", "jvm"], "comments": [{"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 3, "creation_date": 1471046721, "post_id": 38927811, "comment_id": 65212752, "body": "&quot;Limited&quot; to JVM languages?  Why is that a problem?"}, {"owner": {"reputation": 29, "user_id": 3780841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/44blM.jpg?s=128&g=1", "display_name": "Sochacky", "link": "https://stackoverflow.com/users/3780841/sochacky"}, "reply_to_user": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 1, "creation_date": 1471078747, "post_id": 38927811, "comment_id": 65218166, "body": "Because it&#39;s slower."}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1471089073, "post_id": 38927811, "comment_id": 65220540, "body": "Slower to write or execute?"}], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 0, "last_activity_date": 1471175597, "creation_date": 1471175597, "answer_id": 38941961, "question_id": 38927811, "link": "https://stackoverflow.com/questions/38927811/is-writing-intellij-plugin-in-go-possible/38941961#38941961", "title": "Is writing Intellij plugin in Go possible?", "body": "<blockquote>\n  <p>I'd like to write Intellij plugin and I wonder is it possible to do it in Go language? </p>\n</blockquote>\n\n<p>As long as the language supports working with JVM it will be possible to do it. Otherwise no. As Go does not support this for now, the answer is no, you cannot.</p>\n\n<p>So far I know of plugins written in Java, Kotlin, Scala.</p>\n\n<blockquote>\n  <p>I want this to be fast and I hope it's not limited to JVM languages. </p>\n</blockquote>\n\n<p>In many many cases Java / JVM is just as fast if not faster then Go code. Keep in mind that the IDE is meant for being opened hours at a time and that gives the JVM a fairly good chance to optimize the code on-the-fly which can make it even faster than before.</p>\n\n<p>For example the Go plugin for IntelliJ had a long standing problem with Delve (the Go debugger) as it was sending requests too fast to be handled in-order by Go and a special RPC implementation was needed in Delve. No other editors were this fast.</p>\n"}], "owner": {"reputation": 29, "user_id": 3780841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/44blM.jpg?s=128&g=1", "display_name": "Sochacky", "link": "https://stackoverflow.com/users/3780841/sochacky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471175597, "creation_date": 1471045311, "last_edit_date": 1471079070, "question_id": 38927811, "link": "https://stackoverflow.com/questions/38927811/is-writing-intellij-plugin-in-go-possible", "title": "Is writing Intellij plugin in Go possible?", "body": "<p>I'd like to write Intellij plugin and I wonder is it possible to do it in Go language? If so, what are my options; as pure go? as compiled to bytecode program acting as service and incorporated in plugin jar? Maybe something else? I want this to be fast and I hope it's not limited to JVM languages.</p>\n"}, {"tags": ["go", "packages"], "comments": [{"owner": {"reputation": 35849, "user_id": 1424875, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/HFA9w.png?s=128&g=1", "display_name": "nanofarad", "link": "https://stackoverflow.com/users/1424875/nanofarad"}, "edited": false, "score": 0, "creation_date": 1471038171, "post_id": 38926778, "comment_id": 65210653, "body": "I&#39;ll answer for Java as was originally tagged: Say a file exists at <code>&#47;home&#47;mahdix&#47;projects&#47;foo&#47;src&#47;main&#47;com&#47;stackoverflow&#47;foo&#47;Som&zwnj;&#8203;ething.java</code>. How would <code>javac</code> know the package is <code>com.stackoverflow.foo</code> and not, say, <code>projects.foo.src.main.com.stackoverflow.foo</code>?"}, {"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "reply_to_user": {"reputation": 35849, "user_id": 1424875, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/HFA9w.png?s=128&g=1", "display_name": "nanofarad", "link": "https://stackoverflow.com/users/1424875/nanofarad"}, "edited": false, "score": 0, "creation_date": 1471039104, "post_id": 38926778, "comment_id": 65210946, "body": "I say, It can be in both of packages depending on how you define your CLASSPATH. Still it can be inferred by the compiler."}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 7, "last_activity_date": 1471038526, "creation_date": 1471038526, "answer_id": 38926926, "question_id": 38926778, "link": "https://stackoverflow.com/questions/38926778/what-is-purpose-of-package-keyword-when-it-can-be-inferred-by-compiler/38926926#38926926", "title": "What is purpose of &#39;package&#39; keyword when it can be inferred by compiler?", "body": "<p>Without <code>package</code> you wouldn't be able to distinguish between main programs and libraries.</p>\n\n<p>Furthermore, according to the <a href=\"https://golang.org/ref/spec#Package_clause\">language specification</a>, the language does not require a package to be identical with a directory:</p>\n\n<blockquote>\n  <p>An implementation may require that all source files for a package inhabit the same directory.</p>\n</blockquote>\n\n<p>And in practice some packages have different names than their import paths:</p>\n\n<blockquote>\n  <p>If the PackageName is omitted, it defaults to the identifier specified in the package clause of the imported package.</p>\n</blockquote>\n\n<p>Consider <a href=\"https://godoc.org/github.com/google/go-gcm\">github.com/google/go-gcm</a> which has <code>package gcm</code> in its files. Projects that use this library will have: </p>\n\n<pre><code>import \"github.com/google/go-gcm\"\n</code></pre>\n\n<p>And then call things like this:</p>\n\n<pre><code>res, err := gcm.SendHttp(APIKey, notification)\n</code></pre>\n\n<p>This is particularly common with <code>-</code> because you can't use it in an identifier.</p>\n"}], "owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 0, "closed_date": 1471149806, "accepted_answer_id": 38926926, "answer_count": 1, "score": 2, "last_activity_date": 1471084528, "creation_date": 1471037768, "last_edit_date": 1471084528, "question_id": 38926778, "link": "https://stackoverflow.com/questions/38926778/what-is-purpose-of-package-keyword-when-it-can-be-inferred-by-compiler", "closed_reason": "Duplicate", "title": "What is purpose of &#39;package&#39; keyword when it can be inferred by compiler?", "body": "<p>All of the Go source files inside directory <code>x</code> have package name <code>x</code> declared on top. I know this is not mandatory but doing otherwise will make things unnecessarily complex. So why the go compiler does not infer the package name from directory name?</p>\n\n<p>This exists in almost many other languages like Java or C# where you are forced to declare what can be easily calculated at compile time.</p>\n\n<p>What is the rationale?</p>\n"}, {"tags": ["go", "cgo", "lpcwstr"], "answers": [{"comments": [{"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "edited": false, "score": 1, "creation_date": 1471269842, "post_id": 38926883, "comment_id": 65267137, "body": "Does this look right? <a href=\"https://gist.github.com/icholy/f8a07551c5aa3b97521767b1a3223275\" rel=\"nofollow noreferrer\">gist.github.com/icholy/f8a07551c5aa3b97521767b1a3223275</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "edited": false, "score": 1, "creation_date": 1471308576, "post_id": 38926883, "comment_id": 65284836, "body": "@iliacholy: added some more info. You probably want to allocate the memory in C, since it may not always be safe to pass that pointer from go into your C code."}, {"owner": {"reputation": 4282, "user_id": 497403, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/070343c258641e3b9f27d77cd21c86ee?s=128&d=identicon&r=PG", "display_name": "David Airapetyan", "link": "https://stackoverflow.com/users/497403/david-airapetyan"}, "edited": false, "score": 1, "creation_date": 1600293250, "post_id": 38926883, "comment_id": 113045546, "body": "The C.calloc() needs to be matched by a C.free() to avoid memory leaks (as with any memory management, one would need to be aware of the object&#39;s life cycle and careful not to de-allocate the memory too early)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1471308535, "last_edit_date": 1471308535, "creation_date": 1471038265, "answer_id": 38926883, "question_id": 38926687, "link": "https://stackoverflow.com/questions/38926687/cgo-convert-between-lpcwstr-and-string/38926883#38926883", "title": "CGO: Convert between LPCWSTR and string", "body": "<p>You should be able to \"cast\" the <code>LPCWSTR</code> as a <code>[]uint16</code>, and use the <code>utf16</code> package to decode the characters</p>\n\n<pre><code>// take a C.wstr pointer, and convert it to a go slice\n// `sz` is the length of the LPCWSTR\nwstr := (*[1 &lt;&lt; 30-1]uint16)(unsafe.Pointer(C.wstr))[:sz:sz]\nrunes := utf16.Decode(wstr)\ngoString := string(runes)\n</code></pre>\n\n<p>You generally don't want to be passing Go pointers into your C code, so when converting from a string to an LPCWSTR, you will want to alloc the memory in C. A solution for converting from a Go string <code>s</code>  might look like:</p>\n\n<pre><code>func Encode(s string) C.LPCWSTR {\n    wstr := utf16.Encode([]rune(s))\n\n    p := C.calloc(C.size_t(len(wstr)+1), C.sizeof_uint16_t)\n    pp := (*[1 &lt;&lt; 30]uint16)(p)\n    copy(pp[:], wstr)\n\n    return (C.LPCWSTR)(p)\n}\n</code></pre>\n\n<p>There may also be some MFC macros that could help convert to and from cstrings which you could take advantage of with simple wrapper functions in C. This way you could easily copy the data in and out just using the builtin <code>C.CString</code> and <code>C.GoString</code> functions. </p>\n"}, {"tags": [], "owner": {"reputation": 4282, "user_id": 497403, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/070343c258641e3b9f27d77cd21c86ee?s=128&d=identicon&r=PG", "display_name": "David Airapetyan", "link": "https://stackoverflow.com/users/497403/david-airapetyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1600292971, "creation_date": 1600292971, "answer_id": 63928391, "question_id": 38926687, "link": "https://stackoverflow.com/questions/38926687/cgo-convert-between-lpcwstr-and-string/63928391#63928391", "title": "CGO: Convert between LPCWSTR and string", "body": "<p>As an alternative to allocating memory in C, one could just call syscall.UTF16PtrFromString:</p>\n<pre><code>func Encode(s string) C.LPCWSTR {\n    ptr, _ := syscall.UTF16PtrFromString(s)\n    return C.LPCWSTR(unsafe.Pointer(ptr))\n}\n</code></pre>\n<p>This assumes that the API you're trying to call (supposedly a win32 API since you're using an LPCWSTR) does not making any copies of the string pointers. If this is indeed the case, not allocating C memory should be safe if the GoLang's code scope is appropriate.</p>\n<p>For example, something along the lines of the code below should be okay:</p>\n<pre><code>func DoSomeWindowsStuff(arg string) {\n  CallWin32API(Encode(arg))\n}\n</code></pre>\n<p>Here the memory allocated for the string should survive until CallWin32API() returns.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 1, "last_activity_date": 1610160538, "creation_date": 1610160538, "answer_id": 65638871, "question_id": 38926687, "link": "https://stackoverflow.com/questions/38926687/cgo-convert-between-lpcwstr-and-string/65638871#65638871", "title": "CGO: Convert between LPCWSTR and string", "body": "<p>If you are sure input does not contain null bytes, you can do the encoding\nyourself:</p>\n<pre><code>import (\n   // #include &lt;windows.h&gt;\n   &quot;C&quot;\n   &quot;unicode/utf16&quot;\n   &quot;unsafe&quot;\n)\n\nfunc PtrFromString(s string) C.LPCWSTR {\n   r := []rune(s + &quot;\\x00&quot;)\n   e := utf16.Encode(r)\n   p := unsafe.Pointer(&amp;e[0])\n   return (C.LPCWSTR)(p)\n}\n</code></pre>\n<p><a href=\"https://golang.org/pkg/unicode/utf16\" rel=\"nofollow noreferrer\">https://golang.org/pkg/unicode/utf16</a></p>\n"}], "owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 38926883, "answer_count": 3, "score": 1, "last_activity_date": 1610160538, "creation_date": 1471037240, "question_id": 38926687, "link": "https://stackoverflow.com/questions/38926687/cgo-convert-between-lpcwstr-and-string", "title": "CGO: Convert between LPCWSTR and string", "body": "<p>I'm writing CGO bindings for a library which uses <code>LPCWSTR</code> for all of its string types. How do I convert from <code>C.LPCWSTR</code> to <code>string</code> and vice-versa?</p>\n"}, {"tags": ["arrays", "go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1471024265, "post_id": 38923237, "comment_id": 65204367, "body": "This doc might be useful to you: <a href=\"https://github.com/golang/go/wiki/CodeReviewComments\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/CodeReviewComments</a>: Also, that pcre package looks suspect -- it doesn&#39;t follow the standards used for package layout, and is quite old, so I wouldn&#39;t be surprised if there aren&#39;t other issues with it as well."}, {"owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1471028988, "post_id": 38923237, "comment_id": 65206709, "body": "Thank you Jim ! I used pcre instead of standard regex because according to my own benchmark, it is much more faster to find if a string is part of another one."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1471030374, "post_id": 38923237, "comment_id": 65207411, "body": "faster than <code>strings.Contains</code> for a simple substring match? (also, it&#39;s fine if it works, just giving you a warning that it has some indications it may not be a quality package)"}, {"owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1471033996, "post_id": 38923237, "comment_id": 65209069, "body": "I tested MatchString() from regexp, glob and pcre. glob was interesting but I did not manage to include a variable pattern in the search, MatchString() was much slower than pcre. I have to test strings.Contains to see if it is fast and powerful enough ;)"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1471024923, "last_edit_date": 1471024923, "creation_date": 1471023416, "answer_id": 38923623, "question_id": 38923237, "link": "https://stackoverflow.com/questions/38923237/goroutines-sharing-slices-trying-to-understand-a-data-race/38923623#38923623", "title": "Goroutines sharing slices : : trying to understand a data race", "body": "<p>The goroutines are only working on copies of the <em>slice headers</em>, the underlying arrays are the same. To make a copy of a slice, you need to use <code>copy</code> (or <code>append</code> to a different slice).</p>\n\n<pre><code>buf_Seq = append(buf_Seq, line)\nbufCopy := make([]string, len(buf_Seq))\ncopy(bufCopy, buf_Seq)\n</code></pre>\n\n<p>You can then safely pass <code>bufCopy</code> to the goroutines, or simply use it directly in the closure.</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1471024290, "post_id": 38923640, "comment_id": 65204382, "body": "This still has a race between the copy and the append in the main loop."}, {"owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "edited": false, "score": 0, "creation_date": 1471026938, "post_id": 38923640, "comment_id": 65205723, "body": "The race is fixed by the last modification of abhink ! Thank you very much everybody for your very helpful explanations !"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 0, "last_activity_date": 1471025599, "last_edit_date": 1471025599, "creation_date": 1471023469, "answer_id": 38923640, "question_id": 38923237, "link": "https://stackoverflow.com/questions/38923237/goroutines-sharing-slices-trying-to-understand-a-data-race/38923640#38923640", "title": "Goroutines sharing slices : : trying to understand a data race", "body": "<p>The data race exists because slices are reference types in Go. They are generally passed by value, but being reference types, any changes made to the one value is reflected in another. Consider:</p>\n\n<pre><code>func f(xs []string) {\n    xs[0] = \"changed_in_f\"\n}\n\nfunc main() {\n    xs := []string{\"set_in_ main\", \"asd\"}\n    fmt.Println(\"Before call:\", xs)\n    f(xs)\n    fmt.Println(\"After call:\", xs)\n\n    var ys []string\n    ys = xs\n    ys[0] = \"changed_through_ys\"\n    fmt.Println(\"After ys:\", xs)\n\n}\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>Before call: [set_in_main asd]\nAfter call: [changed_in_f asd]\nAfter ys: [changed_through_ys asd]\n</code></pre>\n\n<p>This happens because all three slices share the same underlying array in memory. More details <a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"nofollow\">here</a>.</p>\n\n<p>This is what might be happening when you pass <code>buf_Seq</code> to <code>search_gene2</code>. A new slice value is passed to each call, however, each slice value may be referring to the same underlying array, causing potential race condition (call to <code>append</code> may change the underlying array of a slice).</p>\n\n<p>To solve the problem, try this in your <code>main</code>:</p>\n\n<pre><code>bufCopy := make([]string, len(buf_Seq))\n// make a copy of buf_Seq in an entirely separate slice\ncopy(buffCopy, buf_Seq)\ngo func(genes, buf_Seq []string) {\n        defer wg.Done()\n        queue &lt;- search_gene2( genes, bufCopy)\n    }(genes, buf_Seq)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1471024381, "creation_date": 1471024381, "answer_id": 38923846, "question_id": 38923237, "link": "https://stackoverflow.com/questions/38923237/goroutines-sharing-slices-trying-to-understand-a-data-race/38923846#38923846", "title": "Goroutines sharing slices : : trying to understand a data race", "body": "<p>The slices are indeed copies, but slices themselves are <em>reference types</em>.  A slice, fundamentally, is a 3-word structure.  It contains a pointer to the start of an underlying array, an integer denoting the current number of elements in the slice, and another integer denoting the capacity of the underlying array.  When you pass a slice into a function, a copy is made of this slice \"header\" structure, but the header still refers to the same underlying array as the header that was passed in.</p>\n\n<p>This means any changes you make to the slice header itself, like sub-slicing it, appending to it enough to trigger a resize (and thus a reallocation to a new location, with a new start pointer), etc will only be reflected in the slice header inside that function.  Any changes to the underlying data itself, however, will be reflected even in the slice outside the function (unless you triggered a reallocation due by growing the slice past capacity).</p>\n\n<p>Example: <a href=\"https://play.golang.org/p/a2y5eGulXW\" rel=\"nofollow\">https://play.golang.org/p/a2y5eGulXW</a></p>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "edited": false, "score": 0, "creation_date": 1471074931, "post_id": 38927101, "comment_id": 65217374, "body": "Thank you very much Amd for this huge amount of advices !!!  My GO is far to be idiomatic, this is my 2nd program in GO ;)  I choose  to read and process 100 sequences / goroutines, because it gives me the maximum speed. What is still difficult to me is to optimize the size of the buffer channel (should I set this size  =   GOMAXPROCS ?) and the GOMAXPROCS ( = nb of available cores or not ? it is still unclear when I read documentation)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "edited": false, "score": 1, "creation_date": 1471087676, "post_id": 38927101, "comment_id": 65220200, "body": "@Fred  You should limit the number of goroutines (I&#39;d use <code>runtime.NumCPU() </code> as my first  working sample code). then one buffered channel I used in this sample code, and the size of buffer? ( It depends to your system performance: size of buffer <code>&gt;= min(</code> how many line per seconds <code>scanner.Scan()</code> reads, how many search per seconds <code>)</code>, I hope this helps."}, {"owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "edited": false, "score": 0, "creation_date": 1471095825, "post_id": 38927101, "comment_id": 65222440, "body": "Thank you Amd ! If I understand well,  is is not a problem to oversize the buffer channel, but if it is too small, the program will not run optimally or even worse some results would be uncomplete."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "edited": false, "score": 1, "creation_date": 1471096290, "post_id": 38927101, "comment_id": 65222580, "body": "@Fred It&#39;s OK If you have enough RAM, It is a concurrent safe FIFO, It is better to make it optimal by design, but even no buffered channel works well (may be not optimal), anyway it depends to the use case, there is no general rule, in your case , I&#39;d use the above simulated sample cde."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1471087218, "last_edit_date": 1471087218, "creation_date": 1471039739, "answer_id": 38927101, "question_id": 38923237, "link": "https://stackoverflow.com/questions/38923237/goroutines-sharing-slices-trying-to-understand-a-data-race/38927101#38927101", "title": "Goroutines sharing slices : : trying to understand a data race", "body": "<p>I think this is the <strong>idiomatic Go</strong> (for this job):<br>\nA code is worth a thousand comments:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>genes = readGenes(\"lists/genes.csv\") // read the gene list\nn := runtime.NumCPU()                // the number of goroutines\nwg.Add(n + 1)\ngo scan() // read the \"fasta/sequences.tsv\"\nfor i := 0; i &lt; n; i++ {\n    go search()\n}\ngo WaitClose()\nslice := []string{}\nfor t := range queue {\n    slice = append(slice, t)\n}\nfmt.Println(slice)\n</code></pre>\n\n<p><code>scan()</code> reads the \"fasta/sequences.tsv\" to this channel: <code>var ch = make(chan string, 100)</code> concurrently and  <code>search()</code> is CPU intensive goroutine so for performance reason the number of goroutines limited to <code>NumCPU</code>.</p>\n\n<p>Try this working sample code (simulated and tested):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    //\"os\"\n    \"runtime\"\n    \"strings\"\n    \"sync\"\n    //\"github.com/mathpl/golang-pkg-pcre/src/pkg/pcre\"\n)\n\nfunc main() {\n    genes = readGenes(\"lists/genes.csv\") // read the gene list\n    n := runtime.NumCPU()                // the number of goroutines\n    wg.Add(n + 1)\n    go scan() // read the \"fasta/sequences.tsv\"\n    for i := 0; i &lt; n; i++ {\n        go search()\n    }\n    go WaitClose()\n    slice := []string{}\n    for t := range queue {\n        slice = append(slice, t)\n    }\n    fmt.Println(slice)\n}\n\nvar wg sync.WaitGroup\nvar genes []string\nvar ch = make(chan string, 100)\nvar queue = make(chan string, 100)\n\nfunc scan() {\n    defer wg.Done()\n    defer close(ch)\n    scanner := bufio.NewScanner(strings.NewReader(strings.Join([]string{\"A2\", \"B2\", \"C2\", \"D2\", \"E2\", \"F2\", \"G2\", \"H2\", \"I2\"}, \"\\n\")))\n    /*f, err := os.Open(\"fasta/sequences.tsv\")\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n     scanner := bufio.NewScanner(f)*/\n    for scanner.Scan() {\n        ch &lt;- scanner.Text()\n    }\n}\n\nfunc match(pattern, seq string) bool {\n    //return pcre.MustCompile(pattern, 0).MatcherString(seq, 0).Matches()\n    return pattern[0] == seq[0]\n}\n\nfunc search() {\n    defer wg.Done()\n    for seq := range ch {\n        for _, gene := range genes {\n            if match(gene, seq) {\n                queue &lt;- seq\n                break\n            }\n        }\n    }\n}\n\nfunc WaitClose() {\n    wg.Wait()\n    close(queue)\n}\n\n// function read a list of genes and return a slice of gene names.\nfunc readGenes(filename string) []string {\n    return []string{\"A1\", \"B1\", \"C1\", \"D1\", \"E1\", \"F1\", \"G1\", \"H1\", \"I1\"}\n    /*var genes []string // slice of genes names\n    f, err := os.Open(filename)\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n    scanner := bufio.NewScanner(f)\n    for scanner.Scan() {\n        line := scanner.Text()\n        genes = append(genes, line)\n    }\n    return genes*/\n}\n</code></pre>\n\n<p>Output:  </p>\n\n<pre><code>[A2 B2 C2 D2 E2 F2 G2 H2 I2]\n</code></pre>\n\n<p>I hope this could help for your real case (comments switched in that code, not tested):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"runtime\"\n    //\"strings\"\n    \"sync\"\n\n    \"github.com/mathpl/golang-pkg-pcre/src/pkg/pcre\"\n    //pcre \"regexp\"\n)\n\nfunc main() {\n    genes = readGenes(\"lists/genes.csv\") // read the gene list\n    n := runtime.NumCPU()                // the number of goroutines\n    wg.Add(n + 1)\n    go scan() // read the \"fasta/sequences.tsv\"\n    for i := 0; i &lt; n; i++ {\n        go search()\n    }\n    go WaitClose()\n    slice := []string{}\n    for t := range queue {\n        slice = append(slice, t)\n    }\n    fmt.Println(slice)\n}\n\nvar wg sync.WaitGroup\nvar genes []string\nvar ch = make(chan string, 100)\nvar queue = make(chan string, 100)\n\nfunc scan() {\n    defer wg.Done()\n    defer close(ch)\n    //scanner := bufio.NewScanner(strings.NewReader(strings.Join([]string{\"A2\", \"B2\", \"C2\", \"D2\", \"E2\", \"F2\", \"G2\", \"H2\", \"I2\"}, \"\\n\")))\n    f, err := os.Open(\"fasta/sequences.tsv\")\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n    scanner := bufio.NewScanner(f)\n    for scanner.Scan() {\n        ch &lt;- scanner.Text()\n    }\n}\n\nfunc match(pattern, seq string) bool {\n    return pcre.MustCompile(pattern, 0).MatcherString(seq, 0).Matches()\n    //return pattern[0] == seq[0]\n    //return pcre.MustCompile(pattern).Match([]byte(seq))\n}\n\nfunc search() {\n    defer wg.Done()\n    for seq := range ch {\n        for _, gene := range genes {\n            if match(gene, seq) {\n                queue &lt;- seq\n                break\n            }\n        }\n    }\n}\n\nfunc WaitClose() {\n    wg.Wait()\n    close(queue)\n}\n\n// function read a list of genes and return a slice of gene names.\nfunc readGenes(filename string) []string {\n    //return []string{\"A1\", \"B1\", \"C1\", \"D1\", \"E1\", \"F1\", \"G1\", \"H1\", \"I1\"}\n    var genes []string // slice of genes names\n    f, err := os.Open(filename)\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n    scanner := bufio.NewScanner(f)\n    for scanner.Scan() {\n        line := scanner.Text()\n        genes = append(genes, line)\n    }\n    return genes\n}\n</code></pre>\n\n<hr>\n\n<p>problems of your code:<br>\n1- in <code>read_genes(filename string) []string</code> you should check for errors:  </p>\n\n<pre><code>f, err := os.Open(filename)\nif err!=nil{\n    panic(err)\n}\n</code></pre>\n\n<p>2- in <code>read_genes(filename string) []string</code> Close Opened file:</p>\n\n<pre><code>defer f.Close()\n</code></pre>\n\n<p>3- After<code>filename := \"fasta/sequences.tsv\"</code> you should check for errors:  </p>\n\n<pre><code>f, err := os.Open(filename)\nif err!=nil{\n    panic(err)\n}\n</code></pre>\n\n<p>4-  After<code>filename := \"fasta/sequences.tsv\"</code> Close Opened file:</p>\n\n<pre><code>defer f.Close()\n</code></pre>\n\n<p>5- Inside <code>for scanner.Scan() {</code> if this file <code>fasta/sequences.tsv</code> does not contain multiples of 100 lines <code>if n == read_buff {</code> will not succeeds for last slice and you will miss it.</p>\n\n<p>6- How many CPU cores do you have? You should limit the number of goroutines.<br>\n7- your main question:<br>\nI made a Minimal, Complete, and Verifiable example (still problem 5 exists):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n    \"sync\"\n)\n\nfunc match(pattern, str string) bool {\n    return pattern[0] == str[0]\n}\nfunc search_gene2(genes, seqs []string) (res []string) {\n    for _, r := range seqs {\n        for _, i := range genes {\n            if match(i, r) {\n                res = append(res, r) // is the gene matches the gene name is append to res\n                break\n            }\n        }\n    }\n    return\n}\n\nfunc main() {\n    read_buff := 2 // the number of sequences analysed by one goroutine\n    var wg sync.WaitGroup\n    queue := make(chan []string, read_buff)\n    genes := []string{\"A1\", \"B1\", \"C1\", \"D1\", \"E1\", \"F1\", \"G1\", \"H1\", \"I1\"}\n    sequences := strings.Join([]string{\"A2\", \"B2\", \"C2\", \"D2\", \"E2\", \"F2\", \"G2\", \"H2\", \"I2\"}, \"\\n\")\n    scanner := bufio.NewScanner(strings.NewReader(sequences))\n    buf_Seq := make([]string, 0, read_buff)\n    for n := 1; scanner.Scan(); n++ {\n        line := scanner.Text()\n        buf_Seq = append(buf_Seq, line) // store the sequences into buf_Seq\n        if n == read_buff {             // when the read buffer contains 100 sequences one goroutine analyses them\n            wg.Add(1)\n            temp := make([]string, n)\n            copy(temp, buf_Seq)\n            buf_Seq = buf_Seq[:0] // reset buf_Seq\n            n = 0                 // reset the sequences counter\n            go func(genes, Seq []string) {\n                defer wg.Done()\n                fmt.Println(Seq)\n                queue &lt;- search_gene2(genes, Seq)\n            }(genes, temp)\n        }\n    }\n    go func() {\n        wg.Wait()\n        close(queue)\n    }()\n    slice := []string{}\n    for t := range queue {\n        slice = append(slice, t...)\n    }\n    fmt.Println(slice)\n}\n</code></pre>\n\n<p>output (5: <code>I2</code> ?):</p>\n\n<pre><code>[A2 B2]\n[C2 D2]\n[E2 F2]\n[G2 H2]\n[A2 B2 C2 D2 E2 F2 G2 H2]\n</code></pre>\n\n<p>here is the solution to your main question (make a new slice and copy all data ):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>temp := make([]string, n)\ncopy(temp, buf_Seq)\nbuf_Seq = buf_Seq[:0] // reset buf_Seq\nn = 0                 // reset the sequences counter\ngo func(genes, Seq []string) {\n    defer wg.Done()\n    fmt.Println(Seq)\n    queue &lt;- search_gene2(genes, Seq)\n}(genes, temp)\n</code></pre>\n\n<p>cause of this:<br>\n    Found 1 data race(s)\n    exit status 66</p>\n\n<pre><code>    line 71 is : copy(bufCopy, buf_Seq)\n    line 63 is : buf_Seq = append(buf_Seq, line)\n    line 73 is :}(genes, buf_Seq)\n</code></pre>\n\n<p>As other answers said: you shared same underlying array of slice with all goroutines.</p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1529, "favorite_count": 0, "accepted_answer_id": 38923640, "answer_count": 4, "score": 2, "last_activity_date": 1471087218, "creation_date": 1471021879, "last_edit_date": 1471040221, "question_id": 38923237, "link": "https://stackoverflow.com/questions/38923237/goroutines-sharing-slices-trying-to-understand-a-data-race", "title": "Goroutines sharing slices : : trying to understand a data race", "body": "<p>I try to make a program in Go to find some genes in very large files of DNA sequences. I already made a Perl program to do that but I would like to take advantage of the goroutines to perform this search in parallel ;)</p>\n\n<p>Because the files are huge, my idea was to read 100 sequences at a time, then send the analysis to a goroutine, and read again 100 sequences etc.</p>\n\n<p>I would like to thank the member of this site for their really helpful explanations concerning slices and goroutines. </p>\n\n<p>I have made the suggested change, to use a copy of the slice processed by the goroutines. But the -race execution still detect one data race at the level of the <code>copy()</code> function :</p>\n\n<p>Thank you very much for your comments !</p>\n\n<pre><code>    ==================\nWARNING: DATA RACE\nRead by goroutine 6:\n  runtime.slicecopy()\n      /usr/lib/go-1.6/src/runtime/slice.go:113 +0x0\n  main.main.func1()\n      test_chan006.go:71 +0xd8\n\nPrevious write by main goroutine:\n  main.main()\n      test_chan006.go:63 +0x3b7\n\nGoroutine 6 (running) created at:\n  main.main()\n      test_chan006.go:73 +0x4c9\n==================\n[&gt;5HSAA098909 BA098909 ...]\nFound 1 data race(s)\nexit status 66\n\n    line 71 is : copy(bufCopy, buf_Seq)\n    line 63 is : buf_Seq = append(buf_Seq, line)\n    line 73 is :}(genes, buf_Seq)\n\n\n\n\n    package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"github.com/mathpl/golang-pkg-pcre/src/pkg/pcre\"\n    \"sync\"\n)\n\n// function read a list of genes and return a slice of gene names\nfunc read_genes(filename string) []string {\n    var genes []string // slice of genes names\n    // Open the file.\n    f, _ := os.Open(filename)\n    // Create a new Scanner for the file.\n    scanner := bufio.NewScanner(f)\n    // Loop over all lines in the file and print them.\n    for scanner.Scan() {\n          line := scanner.Text()\n        genes = append(genes, line)\n    }\n    return genes\n}\n\n// function find the sequences with a gene matching gene[] slice\nfunc search_gene2( genes []string, seqs []string) ([]string) {\n  var res []string\n\n  for r := 0 ; r &lt;= len(seqs) - 1; r++ {\n    for i := 0 ; i &lt;= len(genes) - 1; i++ {\n\n      match := pcre.MustCompile(genes[i], 0).MatcherString(seqs[r], 0)\n\n      if (match.Matches() == true) {\n          res = append( res, seqs[r])           // is the gene matches the gene name is append to res\n          break\n      }\n    }\n  }\n\n  return res\n}\n//###########################################\n\nfunc main() {\n    var slice []string\n    var buf_Seq []string\n    read_buff := 100    // the number of sequences analysed by one goroutine\n\n    var wg sync.WaitGroup\n    queue := make(chan []string, 100)\n\n    filename := \"fasta/sequences.tsv\"\n    f, _ := os.Open(filename)\n    scanner := bufio.NewScanner(f)\n    n := 0\n    genes := read_genes(\"lists/genes.csv\")\n\n    for scanner.Scan() {\n            line := scanner.Text()\n            n += 1\n            buf_Seq = append(buf_Seq, line) // store the sequences into buf_Seq\n            if n == read_buff {   // when the read buffer contains 100 sequences one goroutine analyses them\n\n          wg.Add(1)\n\n          go func(genes, buf_Seq []string) {\n            defer wg.Done()\n                        bufCopy := make([]string, len(buf_Seq))\n                        copy(bufCopy, buf_Seq)\n            queue &lt;- search_gene2( genes, bufCopy)\n            }(genes, buf_Seq)\n                        buf_Seq = buf_Seq[:0]   // reset buf_Seq\n              n = 0 // reset the sequences counter\n\n        }\n    }\n    go func() {\n            wg.Wait()\n            close(queue)\n        }()\n\n        for t := range queue {\n            slice = append(slice, t...)\n        }\n\n        fmt.Println(slice)\n}\n</code></pre>\n"}, {"tags": ["go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 762, "user_id": 766584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Itlls.png?s=128&g=1", "display_name": "djneely", "link": "https://stackoverflow.com/users/766584/djneely"}, "edited": false, "score": 0, "creation_date": 1471021294, "post_id": 38922676, "comment_id": 65202937, "body": "I&#39;ve made a little progress but still having other issues now. Turns out I did not have protoc install and then I did not have the golang protobufs installed. I got those installed along with that was adding in the $GOPATH/bin to my $PATH. However, now the error has moved away from the cloud/datastore off to: package google.golang.org/genproto/googleapis/type: no buildable Go source files in $GOPATH/src/google.golang.org/genproto/googleapis/type"}, {"owner": {"reputation": 762, "user_id": 766584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Itlls.png?s=128&g=1", "display_name": "djneely", "link": "https://stackoverflow.com/users/766584/djneely"}, "edited": false, "score": 0, "creation_date": 1471026476, "post_id": 38922676, "comment_id": 65205457, "body": "It would still be nice to know what is going on here but, what I wound up doing to get going was to rebuild a whole new environment. That is I created a whole new directory for my Go stuff. Updated my $GOPATH and other relevant $GO vars.  Created the src, bin, pkg directories, re-cloned my project into the src directory and magically go get -u ran without a hitch. MADDENING"}], "owner": {"reputation": 762, "user_id": 766584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Itlls.png?s=128&g=1", "display_name": "djneely", "link": "https://stackoverflow.com/users/766584/djneely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1471236619, "creation_date": 1471019431, "last_edit_date": 1471236619, "question_id": 38922676, "link": "https://stackoverflow.com/questions/38922676/cloud-datastore-no-buildable-go-source-files", "title": "cloud/datastore no buildable Go source files", "body": "<p>I have a project that I work on both at home and here at work. At home (my primary place of work on the project) the code is up and running fine. However, here at work after pulling down some updates. When I try to <code>go run app.go</code> or just do a <code>go get</code> or <code>go get -d</code> I'm seeing the following error. </p>\n\n<blockquote>\n  <p>../google.golang.org/cloud/datastore/save.go:25:2: no buildable Go\n  source files in $GOPATH/src/google.golang.org/genproto/googleapis/type</p>\n</blockquote>\n\n<p>I've gone into the $GOPATH/src and wiped all the source files from the other repos/packages and still get the error with the <code>go get</code> commands. Any insight would be mighty appreciated and thank you in advance.</p>\n"}, {"tags": ["go", "go-iris"], "answers": [{"comments": [{"owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "edited": false, "score": 0, "creation_date": 1479426927, "post_id": 38924072, "comment_id": 68565420, "body": "Was this issue moved to another repo? Issues are disabled for that repo currently."}], "tags": [], "owner": {"reputation": 1768, "user_id": 899671, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/EPYny.jpg?s=128&g=1", "display_name": "Michael Draper", "link": "https://stackoverflow.com/users/899671/michael-draper"}, "is_accepted": false, "score": 0, "last_activity_date": 1471025273, "creation_date": 1471025273, "answer_id": 38924072, "question_id": 38922585, "link": "https://stackoverflow.com/questions/38922585/how-to-serve-api-and-html5-spa-with-iris/38924072#38924072", "title": "How to serve /api and HTML5 SPA with Iris", "body": "<p>See the discussion answers on this topic:</p>\n\n<p><a href=\"https://github.com/iris-contrib/examples/issues/9\" rel=\"nofollow\">https://github.com/iris-contrib/examples/issues/9</a></p>\n"}], "owner": {"reputation": 1768, "user_id": 899671, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/EPYny.jpg?s=128&g=1", "display_name": "Michael Draper", "link": "https://stackoverflow.com/users/899671/michael-draper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527045248, "creation_date": 1471019078, "last_edit_date": 1527045248, "question_id": 38922585, "link": "https://stackoverflow.com/questions/38922585/how-to-serve-api-and-html5-spa-with-iris", "title": "How to serve /api and HTML5 SPA with Iris", "body": "<p>I'm trying to get iris (<a href=\"http://iris-go.com\" rel=\"nofollow\">http://iris-go.com</a>) to serve both /api/ routes and host an angular SPA (in html5 mode).  </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>package main\r\n\r\nimport (\r\n\"github.com/kataras/iris\"\r\n// \"github.com/kataras/iris/utils\"\r\n// \"strings\"\r\n)\r\n\r\nfunc allVendorBrandLabel(c *iris.Context) {\r\nc.WriteString(\"Hello, api :)\")\r\n\r\n}\r\nfunc main() {\r\n\r\n    iris.Get(\"/api/all\", allVendorBrandLabel)\r\n    iris.StaticWeb(\"/\", \"./www\", 2)\r\n    iris.Listen(\":8080\")\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Can't get this approach to work. Has anyone gotten iris to do this?</p>\n"}, {"tags": ["go", "fallback", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1471018537, "post_id": 38922080, "comment_id": 65201531, "body": "What version of go are you using? (this works in go1.7, I just don&#39;t remember when it was fixed)"}, {"owner": {"reputation": 5956, "user_id": 354132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1ac5fd6aa3d8027e6f022d789e92cddd?s=128&d=identicon&r=PG", "display_name": "Arnout Engelen", "link": "https://stackoverflow.com/users/354132/arnout-engelen"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1471172026, "post_id": 38922080, "comment_id": 65238073, "body": "I can confirm it works with 1.7beta2 on travis but not on go 1.6.1 on my local machine"}], "owner": {"reputation": 5956, "user_id": 354132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1ac5fd6aa3d8027e6f022d789e92cddd?s=128&d=identicon&r=PG", "display_name": "Arnout Engelen", "link": "https://stackoverflow.com/users/354132/arnout-engelen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1471017403, "creation_date": 1471017403, "question_id": 38922080, "link": "https://stackoverflow.com/questions/38922080/how-can-i-fallback-to-a-go-implementation-when-cgo-is-not-available-during-build", "title": "How can I fallback to a go implementation when cgo is not available during build?", "body": "<p>My project could benefit from some cgo code, but I have a fallback implementation in go to use when cgo is not available during build.</p>\n\n<p>However, when I build without cgo, I get the error <code>C source files not allowed when not using cgo or SWIG</code>.</p>\n\n<p>The C code is only used in a file marked with <code>// +build cgo</code> and there is an alternative available with <code>// +build !cgo</code>.</p>\n\n<p>How do I set things up so I can build with cgo where available, but also keep supporting the fallback behaviour?</p>\n\n<p>FWIW, the code is at <a href=\"https://github.com/raboof/connbeat/tree/tcp_diag\" rel=\"nofollow\">https://github.com/raboof/connbeat/tree/tcp_diag</a> and the error can be triggered with a 'make crosscompile'.</p>\n"}, {"tags": ["java", "tomcat", "go", "proxy"], "answers": [{"tags": [], "owner": {"reputation": 2547, "user_id": 2104280, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/234d450e0f4554acb818930ba5921524?s=128&d=identicon&r=PG", "display_name": "Jan-Willem Gmelig Meyling", "link": "https://stackoverflow.com/users/2104280/jan-willem-gmelig-meyling"}, "is_accepted": true, "score": 5, "last_activity_date": 1471380916, "last_edit_date": 1471380916, "creation_date": 1471380551, "answer_id": 38984218, "question_id": 38921437, "link": "https://stackoverflow.com/questions/38921437/can-i-proxy-a-golang-server-embedded-within-a-war/38984218#38984218", "title": "Can I proxy a Golang server embedded within a WAR?", "body": "<p>If HTTP is the only API your Go application exposes, then you're only left with the option to just send a HTTP request to Go. Yes you can start the Go executable as a child process from the JVM using a <code>ProcessBuilder</code>. But that's not truly embedding go within your WAR. You can use JNI (Go bindings are called <a href=\"https://github.com/abneptis/GoJVM\">GoJVM</a>) to invoke native routines in Go from Java, but then you have to make a lot of adjustments to your Go code base as well.</p>\n\n<p>What you are looking probably for is indeed a reverse proxy. It's not frequently done in servlets / application servers, because this is usually done in load balancers already. So usually that would be NGINX or httpd with <code>mod_rewrite</code>. For application servers, you can use a proxy servlet.</p>\n\n<p>Examples:</p>\n\n<ul>\n<li><a href=\"https://github.com/mitre/HTTP-Proxy-Servlet\">https://github.com/mitre/HTTP-Proxy-Servlet</a></li>\n<li><a href=\"https://sourceforge.net/projects/j2ep/\">https://sourceforge.net/projects/j2ep/</a></li>\n</ul>\n\n<p>The memory footprint is usually not to bad, because you're essentially only connecting the streams. The JVM will be able to track processor and memory utilisation - if implemented properly and the Go executable runs on the same server. Obviously the Java specific statistics don't make much sense anymore, as you're only using your Java server as a pass-through.</p>\n\n<p><em>Sounds like you will be in trouble though. If my strict requirement was a WAR-archive that can be deployed to an application server, I wouldn't accept another executable added to my stack. Reverse proxied or not.</em></p>\n"}, {"comments": [{"owner": {"reputation": 2547, "user_id": 2104280, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/234d450e0f4554acb818930ba5921524?s=128&d=identicon&r=PG", "display_name": "Jan-Willem Gmelig Meyling", "link": "https://stackoverflow.com/users/2104280/jan-willem-gmelig-meyling"}, "edited": false, "score": 0, "creation_date": 1471963730, "post_id": 39087965, "comment_id": 65555651, "body": "In a micro service environment, who cares about one service being written in Go, another in Node, another possibly using Dropwizard. The services are small anyway, and can easily be replaced if no one is around that is familiar with the language or framework. But if you have a J2ee stack, ops that run it and developers that maintain it, you&#39;re simply not going to get away with it, unless you&#39;ve had very good reasons for it (and discussed this beforehand). Assuming that these employees are long gone or even dead won&#39;t get you far. Not meeting strict requirements will mean no pay or court."}], "tags": [], "owner": {"reputation": 362892, "user_id": 256196, "user_type": "moderator", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d84b558fd67be10d5a718fb94231909d?s=128&d=identicon&r=PG", "display_name": "Bohemian", "link": "https://stackoverflow.com/users/256196/bohemian"}, "is_accepted": false, "score": 0, "last_activity_date": 1471896822, "creation_date": 1471896822, "answer_id": 39087965, "question_id": 38921437, "link": "https://stackoverflow.com/questions/38921437/can-i-proxy-a-golang-server-embedded-within-a-war/39087965#39087965", "title": "Can I proxy a Golang server embedded within a WAR?", "body": "<p>If they want war, give them war!</p>\n\n<p>Write a thin layer web service that has the executable embedded as a resource that executes it to bring up the go server and accepts web calls and does a pass through to the go service.</p>\n\n<p>Achieves nothing I hear you say? Well, neither does their arbitrary requirement that was probably put in place by someone who's long since left the company, and/or because they lack the confidence/experience/ knowledge to operationally deal with other forms of deployment. There is no particularly good reason to deny your service to be deployed except the work required to establish proper operational procedures (laziness).</p>\n\n<p>Just follow the letter of their rules, not the spirit, and be honest if asked about your implementation. They won't mind.</p>\n\n<p>This may sound like a rant, but IMHO and experience, this kind of approach is reality and the drivers for the requirement are emotionally based, so a somewhat emotional answer is warranted.</p>\n"}], "owner": {"reputation": 513, "user_id": 921374, "user_type": "registered", "profile_image": "https://graph.facebook.com/1269745557/picture?type=large", "display_name": "Johny Jose", "link": "https://stackoverflow.com/users/921374/johny-jose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 1, "accepted_answer_id": 38984218, "answer_count": 2, "score": 10, "last_activity_date": 1471896822, "creation_date": 1471015446, "last_edit_date": 1471355477, "question_id": 38921437, "link": "https://stackoverflow.com/questions/38921437/can-i-proxy-a-golang-server-embedded-within-a-war", "title": "Can I proxy a Golang server embedded within a WAR?", "body": "<p>One my customers has very strict requirements about how they can deploy a web application. They require it to be deploy-able as WAR within a Java server like Tomcat. Our application however is written in golang and compiles into an executable server. </p>\n\n<p><strong>The only solution I could think off would be</strong> to start a long lived golang process in the background which listens on a non-standard port like <code>8080</code> and then put some kind of a proxy in java which would transparently proxy all HTTP requests and responses to this process. </p>\n\n<p><strong>How should I go about implementing this ?</strong> I'm not at all familiar with Java Servlets and running long running processes like this in the background. </p>\n\n<p>My main concern is if something like this is standard, </p>\n\n<ol>\n<li>would it affect the JVM's memory usage, etc ?</li>\n<li>Would the server allow my golang process to allocate the required\namount of memory ?</li>\n<li>Would the JVM be able to track it's processor utilization ?</li>\n</ol>\n\n<p>Is there a better way to do this maybe ? Like some kind of inter-process communication mechanism ?</p>\n"}, {"tags": ["go", "enums", "code-generation", "marshalling", "thrift"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4181182, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006858331812/picture?type=large", "display_name": "Andrei Rudakov", "link": "https://stackoverflow.com/users/4181182/andrei-rudakov"}, "edited": false, "score": 0, "creation_date": 1471245838, "post_id": 38924630, "comment_id": 65256174, "body": "Interested in serialization in a user friendly JSON format. TJSONProtocol works fine, but isn&#39;t user friendly."}], "tags": [], "owner": {"reputation": 12067, "user_id": 499466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc0612ec9a2b6af96500cc6e4bfdc7c?s=128&d=identicon&r=PG", "display_name": "JensG", "link": "https://stackoverflow.com/users/499466/jensg"}, "is_accepted": false, "score": 0, "last_activity_date": 1471027702, "last_edit_date": 1495535321, "creation_date": 1471027702, "answer_id": 38924630, "question_id": 38918650, "link": "https://stackoverflow.com/questions/38918650/how-to-save-thrift-struct-in-a-user-friendly-json-format-with-enums-by-numbers-i/38924630#38924630", "title": "How to save thrift struct in a user friendly JSON format with enums by numbers in Golang?", "body": "<p>Use the <code>TJSONProtocol</code> instead, this provides you with an interchangeable, JSON-based data format. </p>\n\n<p>The <a href=\"https://stackoverflow.com/questions/31753659/how-to-convert-thrift-objects-to-readable-string-and-convert-it-back\"><code>TSimpleJSONProtocol</code> is not intended to be used as a serialization format, at least not when you plan to read it back into your program using Thrift</a>. </p>\n\n<p>Other than that, if <code>TSimpleJSONProtocol</code> produces different output for Java and Go, you may have found an inconsistency and consider filing a <a href=\"https://issues.apache.org/jira/browse/THRIFT\" rel=\"nofollow noreferrer\">JIRA</a> ticket including a suitable test case.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 4181182, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006858331812/picture?type=large", "display_name": "Andrei Rudakov", "link": "https://stackoverflow.com/users/4181182/andrei-rudakov"}, "is_accepted": false, "score": 0, "last_activity_date": 1471264845, "last_edit_date": 1471264845, "creation_date": 1471249819, "answer_id": 38951766, "question_id": 38918650, "link": "https://stackoverflow.com/questions/38918650/how-to-save-thrift-struct-in-a-user-friendly-json-format-with-enums-by-numbers-i/38951766#38951766", "title": "How to save thrift struct in a user friendly JSON format with enums by numbers in Golang?", "body": "<p>Remove <a href=\"https://github.com/apache/thrift/commit/549a9e1e6dfbfaf1f7685dc5e26440c501517738#diff-1b57800912b80e54a5fb23aee7873271R926\" rel=\"nofollow\">this</a> commit and re-make thrift-0.9.3 then use json.Marshal/Unmarshal.</p>\n"}], "owner": {"reputation": 3, "user_id": 4181182, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006858331812/picture?type=large", "display_name": "Andrei Rudakov", "link": "https://stackoverflow.com/users/4181182/andrei-rudakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1610, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471264845, "creation_date": 1471006894, "last_edit_date": 1471245998, "question_id": 38918650, "link": "https://stackoverflow.com/questions/38918650/how-to-save-thrift-struct-in-a-user-friendly-json-format-with-enums-by-numbers-i", "title": "How to save thrift struct in a user friendly JSON format with enums by numbers in Golang?", "body": "<p>Task.thrift <em>(Thrift version 0.9.3)</em></p>\n\n<pre><code>enum AttributeApp {\n  a = 1,\n  b = 2,\n  c = 3\n}\n\ntypedef i32 attrTypeId\n\nstruct Task {\n  1: required attrTypeId type_id,\n  2: required list&lt;AttributeApp&gt; app_to,\n}\n</code></pre>\n\n<p>Generated Apache Thrift code for Java marshal enums by numbers.</p>\n\n<blockquote>\n  <p>$ thrift -r --gen java Task.thrift</p>\n</blockquote>\n\n<pre><code>TSerializer serializer = new TSerializer(new TSimpleJSONProtocol.Factory());\nString json = serializer.toString(task);\nUtil.writeLog(\"task.json\", json);\n</code></pre>\n\n<p>How to generate Apache Thrift code for Golang with JSON marshal enum by number instead of name?</p>\n\n<blockquote>\n  <p>$ thrift -r --gen go Task.thrift</p>\n</blockquote>\n\n<p>This example make enums by strings:</p>\n\n<pre><code>bt, err := json.Marshal(task)\nif err != nil {\n    return err\n}\nerr = ioutil.WriteFile(\"task.json\", bt, 0666)\n</code></pre>\n\n<p>This example make enums by numbers, but add two extra numbers in any list of json:</p>\n\n<pre><code>transport := thrift.NewTMemoryBufferLen(1024)\nprotocol := thrift.NewTSimpleJSONProtocolFactory().GetProtocol(transport)\nts := &amp;thrift.TSerializer{transport, protocol}\nbt, err := ts.Write(task)\nif err != nil {\n    return err\n}\nerr = ioutil.WriteFile(\"task.json\", bt, 0666)\n</code></pre>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 2561951, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001736012903/picture?type=large", "display_name": "Vitalie Maldur", "link": "https://stackoverflow.com/users/2561951/vitalie-maldur"}, "edited": false, "score": 0, "creation_date": 1471005182, "post_id": 38917799, "comment_id": 65192989, "body": "Thx. Saved my day!"}], "tags": [], "owner": {"reputation": 94, "user_id": 5418667, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-baRILLW1ves/AAAAAAAAAAI/AAAAAAAAAJ4/9TIwxJEPc-k/photo.jpg?sz=128", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5418667/vlad"}, "is_accepted": true, "score": 3, "last_activity_date": 1471004270, "creation_date": 1471004270, "answer_id": 38917799, "question_id": 38917691, "link": "https://stackoverflow.com/questions/38917691/set-a-pointer-value-using-reflect/38917799#38917799", "title": "Set a pointer value using reflect?", "body": "<p>Your field must be public. Name it to Value.</p>\n"}], "owner": {"reputation": 505, "user_id": 2561951, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001736012903/picture?type=large", "display_name": "Vitalie Maldur", "link": "https://stackoverflow.com/users/2561951/vitalie-maldur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 38917799, "answer_count": 1, "score": 1, "last_activity_date": 1471004270, "creation_date": 1471003943, "question_id": 38917691, "link": "https://stackoverflow.com/questions/38917691/set-a-pointer-value-using-reflect", "title": "Set a pointer value using reflect?", "body": "<p>I have this piece of code, where I want to set the value of the pointer that is inside of a struct.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype MyStruct struct {\n    value *uint64 // value that I want to modify\n}\n\nfunc main() {\n    var i uint64 = 1\n    pointer := &amp;MyStruct{&amp;i}\n\n    elem := reflect.ValueOf(pointer).Elem()\n    field := elem.Field(0)\n    fmt.Println(field.CanSet(), field.Elem().CanSet())\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>false false\n</code></pre>\n\n<p>Unfortunately it is not settable. What can I do?</p>\n"}, {"tags": ["loops", "go", "delay", "easing"], "answers": [{"comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1471020509, "post_id": 38918182, "comment_id": 65202574, "body": "Using ticker or timer isn&#39;t the question, but how to implement the return of a penner&#39;s easing equation instead."}], "tags": [], "owner": {"reputation": 94, "user_id": 5418667, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-baRILLW1ves/AAAAAAAAAAI/AAAAAAAAAJ4/9TIwxJEPc-k/photo.jpg?sz=128", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5418667/vlad"}, "is_accepted": false, "score": 0, "last_activity_date": 1471005493, "creation_date": 1471005493, "answer_id": 38918182, "question_id": 38916676, "link": "https://stackoverflow.com/questions/38916676/applying-easing-to-a-loop-delay/38918182#38918182", "title": "Applying easing to a loop delay", "body": "<p>I think, you can use time.Ticker.</p>\n\n<pre><code>numLoops := 144\ntimePerIteration := time.Duration(3) * time.Second / time.Duration(numLoops)\nticker := time.NewTicker(timePerIteration)\nfor i := 0; i &lt; numLoops; i++ {\n    // your code\n    &lt;-ticker.C\n}\nticker.Stop()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1471027727, "post_id": 38924473, "comment_id": 65206086, "body": "Whoo, thanks a bunch, you made it so clear. So to use another easing function, i have to change how is calculated <code>this</code> and <code>last</code> with the same parameter ?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1471029112, "post_id": 38924473, "comment_id": 65206767, "body": "Exactly.  Incidentally, you can even do it dynamically with a bit of functional programming, if you want.  Example: <a href=\"https://play.golang.org/p/JQCIOWwxEs\" rel=\"nofollow noreferrer\">play.golang.org/p/JQCIOWwxEs</a>"}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1471029452, "post_id": 38924473, "comment_id": 65206915, "body": "Alright. Lasth thing, i suspect this is due to how you compute delay, but according to the graph of the <code>inOutQuad</code> equation (<a href=\"http://easings.net/fr#easeInOutQuad\" rel=\"nofollow noreferrer\">easings.net/fr#easeInOutQuad</a>), the delay should decrease-increase-decrease instead of increase-stagnate at frame 57-58-decrease."}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1471029791, "post_id": 38924473, "comment_id": 65207109, "body": "EDIT: I meant this to reproduce the effect of acceleration/deceleration, because otherwise it reflect the graph."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1471030929, "post_id": 38924473, "comment_id": 65207675, "body": "Technically, the <code>delay()</code> function is calculating a sort of poor-man&#39;s derivative of that graph.  It&#39;s returning the <i>change</i> in the graph from the last iteration to the current one.  It should start at zero, increase to some value, then decrease back to zero.  Since the quad equation is quadratic, the derivative should be linear, but InOut is piecewise, meaning the derivative is piecewise too.  <b>Edit:</b> broken link.  Paste this into <a href=\"http://www.wolframalpha.com\" rel=\"nofollow noreferrer\">wolframalpha.com</a>: <code>Plot[Piecewise[{{y=2*(x&#47;114)^2,x&lt;=57},{y=(x&#47;114)*(4-2(x&#47;114)&zwnj;&#8203;)-1, x &gt;= 57}}], {x, 0, 114}]</code>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1471031152, "post_id": 38924473, "comment_id": 65207765, "body": "Basically, it <i>is</i> reproducing acceleration and deceleration.  The total delay reflects your easing graph properly.  The key is that that graph is showing the <i>total delay so far</i>, <i>NOT</i> the delay since the last iteration."}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1471031537, "post_id": 38924473, "comment_id": 65207946, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/120835/discussion-between-william-poussier-and-kaedys\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 1, "last_activity_date": 1471029231, "last_edit_date": 1471029231, "creation_date": 1471027034, "answer_id": 38924473, "question_id": 38916676, "link": "https://stackoverflow.com/questions/38916676/applying-easing-to-a-loop-delay/38924473#38924473", "title": "Applying easing to a loop delay", "body": "<p>Penner's Equations fundamentally require two parameters: the current progress, and the total possible progress.  Alternatively, however, you can instead provide it with percentage-of-total-progress as a single parameter (as a value between 0 and 1), since that's what it uses the current and total to calculate anyway.</p>\n\n<p>Using your original code, if you want 114 iterations to take place within 3 seconds, the easiest way is to use your iteration index as the current progress, and 114 as the total, then multiply the calculated delay factor by your total duration 3.0s.</p>\n\n<p>Note, Penner's Equations calculate total displacement from start position, NOT relative displacement for each step, so you actually need to calculate that difference yourself.  Thus the delay for <em>this</em> iteration is the total displacement (delay) for this iteration minus the total displacement for the last iteration:</p>\n\n<pre><code>func DoStuffWithEasing() {\n    iterations := 114\n    runTime := 3 * time.Second\n\n    for i := 1; i &lt;= iterations; i++ {\n        // do a task\n        time.Sleep(easeInQuadDelay(i, iterations, runTime))\n    }\n}\n\nfunc easeInQuadDelay(c, t int, dur time.Duration) time.Duration {\n    if c &lt;= 0 || t == 0 { // invalid cases\n        return 0\n    }\n\n    // This return can be a single-liner, but I split it up for clarity\n    // Note that time.Durations are fundamentally int64s,\n    // so we can easily type convert them to float64s and back\n\n    this := math.Pow(float64(c)/float64(t), 2)\n    last := math.Pow(float64(c-1)/float64(t), 2)\n    return time.Duration((this - last) * float64(dur))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/TTgZUYUvxW\" rel=\"nofollow\">https://play.golang.org/p/TTgZUYUvxW</a></p>\n\n<p><a href=\"http://www.wolframalpha.com/input/?i=plot+y+%3D+3*%28x%2F114%29%5E2+from+0+to+114\" rel=\"nofollow\">Graph of the easing</a></p>\n"}], "owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 38924473, "answer_count": 2, "score": 0, "last_activity_date": 1471029231, "creation_date": 1471000635, "last_edit_date": 1495541689, "question_id": 38916676, "link": "https://stackoverflow.com/questions/38916676/applying-easing-to-a-loop-delay", "title": "Applying easing to a loop delay", "body": "<p>To speak simple, I am trying to figure out how to apply easing to a loop delay.</p>\n\n<pre><code>for (i := 0; i &lt; 114; i++) {\n    // do a task\n    time.Sleep(//delay before next job)\n}\n</code></pre>\n\n<p>As you can read it, this is very basic. Let say I want to complete the whole loop in 3s (job completion time is negligeable, <code>t &lt;= us</code>). What is the proper method with Penner's Equations to calculate for each iteration the proper eased delay ?</p>\n\n<p>So, with this function, to simulate an acceleration from zero-velocity, how should I use the <code>t</code> parameter each iteration of the loop to create the proper delay to sleep for ?</p>\n\n<pre><code>func easeInQuad(t float64) {\n  return math.Pow(t, 2)\n}\n</code></pre>\n\n<p>I would be very thankfull if you could help me about this. Equations has not been a problem so far, but how to use them with my use case instead.</p>\n\n<p>My question could looks like this one at first : <a href=\"https://stackoverflow.com/questions/12081547/applying-easing-to-settimeout-delays-within-a-loop\">Applying easing to setTimeout delays, within a loop</a>\nbut this one does not take the total time of the loop in account.</p>\n\n<p>However, I think it may be better to use equations rewritten to use only one parameter, in range [0,1] : <a href=\"https://gist.github.com/rezoner/713615dabedb59a15470\" rel=\"nofollow noreferrer\">https://gist.github.com/rezoner/713615dabedb59a15470</a></p>\n\n<p>From my understanding, I have to calculate the abstract \"percentage time elapsed\", and somehow interpolate this value with an easing function.</p>\n\n<p>This Node project seems to do just that : <a href=\"https://github.com/CharlotteGore/animation-timer\" rel=\"nofollow noreferrer\">https://github.com/CharlotteGore/animation-timer</a>, but again I can't figure out how to reproduce it.</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "edited": false, "score": 2, "creation_date": 1470984991, "post_id": 38911627, "comment_id": 65180913, "body": "Does the same issue occur with 100 goroutines rather than over 90000? It could be a restriction with your operating system such as through <code>ulimit</code>, or perhaps packets are being dropped due to there being too much traffic?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1471005890, "post_id": 38911627, "comment_id": 65193385, "body": "Using a single IP and no other configuration, you only have 16k-28k ephemeral ports (depending on the system defaults) for the client, so you can&#39;t connect 90k clients concurrently to begin with. Creating a new transport for each connection and then discarding it losing access the idle connections, and they will remain open using up resources -- the http.Client and http.Transport are meant for concurrent use. When trying to test the limits of the system, you can&#39;t just pick a &quot;really big number&quot; and then ask why it doesn&#39;t work, you need to start from a known working configuration and ramp up."}, {"owner": {"reputation": 88, "user_id": 810782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cHJvF.jpg?s=128&g=1", "display_name": "Ahmed Kamal", "link": "https://stackoverflow.com/users/810782/ahmed-kamal"}, "edited": false, "score": 0, "creation_date": 1471127074, "post_id": 38911627, "comment_id": 65230971, "body": "I think <a href=\"http://stackoverflow.com/questions/17714494/golang-http-request-results-in-eof-errors-when-making-multiple-requests-successi/23963271#23963271\">this answer</a> is much close to the reason."}], "owner": {"reputation": 88, "user_id": 810782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cHJvF.jpg?s=128&g=1", "display_name": "Ahmed Kamal", "link": "https://stackoverflow.com/users/810782/ahmed-kamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2577, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470992431, "creation_date": 1470984595, "last_edit_date": 1470992431, "question_id": 38911627, "link": "https://stackoverflow.com/questions/38911627/tcp-reset-connection-by-peer", "title": "tcp reset connection by peer", "body": "<p>I have a problem launching multiple go routines over 90000 to do http requests via POST to the same server, both the server and the client are locally, some of the requests are executed successfully and some of them giving me this response <strong>read: connection reset by peer</strong></p>\n\n<p>Please notice I am posting a small amount of data in the provided example\nbut actually I am sending a huge amount of data using protobuf.</p>\n\n<p>This is the server <a href=\"https://play.golang.org/p/r1-rYNuAos\" rel=\"nofollow\">https://play.golang.org/p/r1-rYNuAos</a></p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"log\"\n    \"encoding/json\"\n)\n\nvar port string\n\ntype problem struct{\n}\n\nfunc main() {\n    p := &amp;problem{}\n    p.server(\":9090\")\n}\n\nfunc (self *problem)server(port string) {\n    s := &amp;http.Server{\n        Addr:           port,\n        Handler:        self,\n    }\n    log.Println(\"Server started\")\n    // Should be last line as it is a blocking.\n    log.Fatal(s.ListenAndServe())\n}\n\nfunc (self *problem) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.WriteHeader(http.StatusCreated)\n    if err := json.NewEncoder(w).Encode(map[string]interface{}{\"created\": true}); err != nil {\n        log.Fatal(err.Error())\n    }\n}\n</code></pre>\n\n<p>And this is the client <a href=\"https://play.golang.org/p/Xx5qQoqrYm\" rel=\"nofollow\">https://play.golang.org/p/Xx5qQoqrYm</a></p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"bytes\"\n    \"io/ioutil\"\n    \"log\"\n    \"fmt\"\n)\n\ntype problem struct{\n}\n\nfunc main() {\n    p := &amp;problem{}\n    p.client(\":9090\")\n}\n\nfunc (self *problem)client(port string) {\n    var k int\n\n    for k=0;k&lt;90000;k++ {\n\n        go func(){\n\n            nativeRequest, err := http.NewRequest(\n                \"POST\",\n                \"http://127.0.0.1\" + port + \"/\",\n                bytes.NewBuffer([]byte(`testing`)),\n            )\n\n            nativeRequest.Close = true\n\n            if err != nil {\n                fmt.Println(err.Error())\n            }\n\n            client := &amp;http.Transport{\n            }\n            nativeResponse, err := client.RoundTrip(nativeRequest)\n\n            if err != nil {\n                log.Println(err.Error())\n            }\n\n            if nativeResponse != nil {\n                defer nativeResponse.Body.Close()\n\n                if err != nil {\n                        fmt.Println(err.Error())\n                }\n\n                body, err := ioutil.ReadAll(nativeResponse.Body)\n\n                if err != nil {\n                        fmt.Println(err.Error())\n                }\n\n                fmt.Println(string(body))\n            }\n        }()\n    }\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "testing", "go", "tdd"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1470994409, "post_id": 38911566, "comment_id": 65186389, "body": "Just wait a few days for Go 1.7 :-)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1470999287, "post_id": 38911566, "comment_id": 65189513, "body": "@Volker Good point, incorporated."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1471000021, "last_edit_date": 1592644375, "creation_date": 1470985165, "answer_id": 38911784, "question_id": 38911566, "link": "https://stackoverflow.com/questions/38911566/subset-of-table-driven-test/38911784#38911784", "title": "Subset of table driven test", "body": "<h2>With Go 1.6 (and below)</h2>\n<p>This is not supported directly by the <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\"><code>testing</code></a> package in Go 1.6 and below. You have to implement it yourself.</p>\n<p>But it's not that hard. You can use <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\"><code>flag</code></a> package to easily access command line arguments.</p>\n<p>Let's see an example. We define an <code>&quot;idx&quot;</code> command line parameter, which if present, only the case at that index will be executed, else all test cases.</p>\n<p>Define flag:</p>\n<pre><code>var idx = flag.Int(&quot;idx&quot;, -1, &quot;specify case index to run only&quot;)\n</code></pre>\n<p>Parse command line flags (actually, this is not required as <code>go test</code> already calls this, but just to be sure / complete):</p>\n<pre><code>func init() {\n    flag.Parse()\n}\n</code></pre>\n<p>Using this parameter:</p>\n<pre><code>for i, c := range cases {\n    if *idx != -1 &amp;&amp; *idx != i {\n        println(&quot;Skipping idx&quot;, i)\n        continue\n    }\n    if res := myfn(c.arg); res != c.expected {\n        t.Errorf(&quot;myfn(%q) should return %q, but it returns %q&quot;, c.arg, c.expected, res)\n    }\n}\n</code></pre>\n<p>Testing it with 3 test cases:</p>\n<pre><code>cases := []struct {\n    arg, expected string\n}{\n    {&quot;%a&quot;, &quot;[%a]&quot;},\n    {&quot;%-a&quot;, &quot;[%-a]&quot;},\n    {&quot;%+a&quot;, &quot;[%+a]&quot;},\n}\n</code></pre>\n<p>Without <code>idx</code> parameter:</p>\n<pre><code>go test\n</code></pre>\n<p>Output:</p>\n<pre><code>PASS\nok      play    0.172s\n</code></pre>\n<p>Specifying an index:</p>\n<pre><code>go test -idx=1\n</code></pre>\n<p>Output:</p>\n<pre><code>Skipping idx 0\nSkipping idx 2\nPASS\nok      play    0.203s\n</code></pre>\n<p>Of course you can implement more sophisticated filtering logic, e.g. you can have <code>minidx</code> and <code>maxidx</code> flags to run cases in a range:</p>\n<pre><code>var (\n    minidx = flag.Int(&quot;minidx&quot;, 0, &quot;min case idx to run&quot;)\n    maxidx = flag.Int(&quot;maxidx&quot;, -1, &quot;max case idx to run&quot;)\n)\n</code></pre>\n<p>And the filtering:</p>\n<pre><code>if i &lt; *minidx || *maxidx != -1 &amp;&amp; i &gt; *maxidx {\n    println(&quot;Skipping idx&quot;, i)\n    continue\n}\n</code></pre>\n<p>Using it:</p>\n<pre><code>go test -maxidx=1\n</code></pre>\n<p>Output:</p>\n<pre><code>Skipping idx 2\nPASS\nok      play    0.188s\n</code></pre>\n<h2>Starting with Go 1.7</h2>\n<p>Go 1.7 (to be released on August 18, 2016) adds the definition of <a href=\"https://tip.golang.org/doc/go1.7#testing\" rel=\"nofollow noreferrer\">subtests and sub-benchmarks</a>:</p>\n<blockquote>\n<p>The testing package now supports the definition of tests with subtests and benchmarks with sub-benchmarks. This support makes it easy to write table-driven benchmarks and to create hierarchical tests. It also provides a way to share common setup and tear-down code. See the <a href=\"https://tip.golang.org/pkg/testing/#hdr-Subtests_and_Sub_benchmarks\" rel=\"nofollow noreferrer\">package documentation</a> for details.</p>\n</blockquote>\n<p>With that, you can do things like:</p>\n<pre><code>func TestFoo(t *testing.T) {\n    // &lt;setup code&gt;\n    t.Run(&quot;A=1&quot;, func(t *testing.T) { ... })\n    t.Run(&quot;A=2&quot;, func(t *testing.T) { ... })\n    t.Run(&quot;B=1&quot;, func(t *testing.T) { ... })\n    // &lt;tear-down code&gt;\n}\n</code></pre>\n<p>Where the subtests are named <code>&quot;A=1&quot;</code>, <code>&quot;A=2&quot;</code>, <code>&quot;B=1&quot;</code>.</p>\n<blockquote>\n<p>The argument to the -run and -bench command-line flags is a slash-separated list of regular expressions that match each name element in turn. For example:</p>\n<pre><code>go test -run Foo     # Run top-level tests matching &quot;Foo&quot;.\ngo test -run Foo/A=  # Run subtests of Foo matching &quot;A=&quot;.\ngo test -run /A=1    # Run all subtests of a top-level test matching &quot;A=1&quot;.\n</code></pre>\n</blockquote>\n<p>How does this help your case? The names of subtests are <code>string</code> values, which can be generated on-the-fly, e.g.:</p>\n<pre><code>for i, c := range cases {\n    name := fmt.Sprintf(&quot;C=%d&quot;, i)\n    t.Run(name, func(t *testing.T) {\n        if res := myfn(c.arg); res != c.expected {\n            t.Errorf(&quot;myfn(%q) should return %q, but it returns %q&quot;,\n                c.arg, c.expected, res)\n        }\n    })\n}\n</code></pre>\n<p>To run the case at index <code>2</code>, you could start it like</p>\n<pre><code>go test -run /C=2\n</code></pre>\n<p>or</p>\n<pre><code>go test -run TestName/C=2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 0, "last_activity_date": 1471022123, "creation_date": 1471022123, "answer_id": 38923303, "question_id": 38911566, "link": "https://stackoverflow.com/questions/38911566/subset-of-table-driven-test/38923303#38923303", "title": "Subset of table driven test", "body": "<p>I wrote a simple code, that work fine with both, although with a bit different command line options. Version for 1.7 is:</p>\n\n<pre><code>// +build go1.7\n\npackage plist\n\nimport \"testing\"\n\nfunc runTest(name string, fn func(t *testing.T), t *testing.T) {\n    t.Run(name, fn)\n}\n</code></pre>\n\n<p>and 1.6 and older:</p>\n\n<pre><code>// +build !go1.7\n\npackage plist\n\nimport (\n    \"flag\"\n    \"testing\"\n    \"runtime\"\n    \"strings\"\n    \"fmt\"\n)\n\nfunc init() {\n    flag.Parse()\n}\n\nvar pattern = flag.String(\"pattern\", \"\", \"specify which test(s) should be executed\")\nvar verbose = flag.Bool(\"verbose\", false, \"write whether test was done\")\n\n// This is a hack, that a bit simulate t.Run available from go1.7\nfunc runTest(name string, fn func(t *testing.T), t *testing.T) {\n    // obtain name of caller\n    var pc[10]uintptr\n    runtime.Callers(2, pc[:])\n    var fnName = \"\"\n\n    f := runtime.FuncForPC(pc[0])\n    if f != nil {\n        fnName = f.Name()\n    }\n    names := strings.Split(fnName, \".\")\n    fnName = names[len(names)-1] + \"/\" + name\n    if strings.Contains(fnName, *pattern) {\n        if *verbose {\n            fmt.Printf(\"%s is executed\\n\", fnName)\n        }\n        fn(t)\n    } else {\n        if *verbose {\n            fmt.Printf(\"%s is skipped\\n\", fnName)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1471022123, "creation_date": 1470984351, "last_edit_date": 1470984648, "question_id": 38911566, "link": "https://stackoverflow.com/questions/38911566/subset-of-table-driven-test", "title": "Subset of table driven test", "body": "<p>For testing functions I could select which will run by option <code>-run</code>.</p>\n\n<pre><code>go test -run regex\n</code></pre>\n\n<p>Very common if we have dozens test cases is put it into array in order not to write function for each of that:</p>\n\n<pre><code>cases := []struct {\n  arg, expected string\n} {\n    {\"%a\", \"[%a]\"},\n    {\"%-a\", \"[%-a]\"},\n    // and many others\n}\nfor _, c := range cases {\n  res := myfn(c.arg) \n  if  res != c.expected {\n    t.Errorf(\"myfn(%q) should return %q, but it returns %q\", c.arg, c.expected, res)\n  }\n}\n</code></pre>\n\n<p>This work good, but problem is with maintanance. When I add a new testcase, while debugging I want to start just a new test case, but I cannot say something like:</p>\n\n<pre><code>go test -run TestMyFn.onlyThirdCase\n</code></pre>\n\n<p>Is there any elegant way, how to have many testcases in array together with ability to choose which testcase will run?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1470982309, "post_id": 38909166, "comment_id": 65179764, "body": "Interfaces describe behaviour. Embedding an interface twice is like saying: &quot;I want this behaviour and this behaviour again!&quot; Which seems rather strange. If an interface supports <code>foo()</code> than demanding it also supports <code>foo()</code> is pretty redundant."}], "answers": [{"comments": [{"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "edited": false, "score": 0, "creation_date": 1470973891, "post_id": 38909225, "comment_id": 65177100, "body": "Thanks, but I&#39;m looking for a general solution. You have assumed that I want to use <code>Reader</code> interface but that was just an example. Suppose we want to embed an interface (with any number of methods), twice in a struct."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "edited": false, "score": 0, "creation_date": 1470974401, "post_id": 38909225, "comment_id": 65177209, "body": "@mahdix : see new Edit (item 3)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 4, "last_activity_date": 1470974201, "last_edit_date": 1470974201, "creation_date": 1470971275, "answer_id": 38909225, "question_id": 38909166, "link": "https://stackoverflow.com/questions/38909166/go-how-to-embed-same-interface-twice/38909225#38909225", "title": "Go: How to embed same interface twice?", "body": "<p>1- Use <code>io.MultiReader</code>, see <code>func MultiReader(readers ...Reader) Reader</code> Docs:  </p>\n\n<blockquote>\n  <p>MultiReader returns a Reader that's the logical concatenation of  the\n  provided input readers. They're read sequentially. Once all  inputs\n  have returned EOF, Read will return EOF.  If any of the readers \n  return a non-nil, non-EOF error, Read will return that error.</p>\n</blockquote>\n\n<hr>\n\n<p>2- or name it:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type ReadHandler interface {\n    Read(p []byte) (n int, err error)\n    Read2(p []byte) (n int, err error)\n}\n</code></pre>\n\n<p>or:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type ReadHandler interface {\n    io.Reader\n    Read2(p []byte) (n int, err error)\n}\n</code></pre>\n\n<p>Demonstration working sample code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc main() {\n    s := my{[]byte{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}, []byte{10, 20, 30, 40, 50}}\n    buf := make([]byte, 5)\n    n, e := s.Read(buf)\n    fmt.Println(n, e, buf)\n    n, e = s.Read2(buf)\n    fmt.Println(n, e, buf)\n}\n\ntype ReadHandler interface {\n    io.Reader\n    Read2(p []byte) (n int, err error)\n}\n\ntype my struct {\n    buf  []byte\n    buf2 []byte\n}\n\nfunc (t *my) Read(p []byte) (n int, err error) {\n    if len(p) &gt; len(t.buf) {\n        return 0, errors.New(\"len(p)&gt;len(buf)\")\n    }\n    m := copy(p, t.buf)\n    return m, nil\n}\n\nfunc (t *my) Read2(p []byte) (n int, err error) {\n    if len(p) &gt; len(t.buf2) {\n        return 0, errors.New(\"len(p)&gt;len(buf2)\")\n    }\n    m := copy(p, t.buf2)\n    return m, nil\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>5 &lt;nil&gt; [1 2 3 4 5]\n5 &lt;nil&gt; [10 20 30 40 50]\n</code></pre>\n\n<hr>\n\n<p>3- name it:</p>\n\n<blockquote>\n  <p>Looking for a general solution to embed an interface (with any number\n  of methods), twice in a struct.</p>\n</blockquote>\n\n<pre><code>type my struct {\n    io.Reader\n    Rdr2 io.Reader\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>type my struct {\n    Rdrs []io.Reader\n}\n</code></pre>\n"}], "owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 38909225, "answer_count": 1, "score": -1, "last_activity_date": 1470974201, "creation_date": 1470970886, "last_edit_date": 1470972276, "question_id": 38909166, "link": "https://stackoverflow.com/questions/38909166/go-how-to-embed-same-interface-twice", "title": "Go: How to embed same interface twice?", "body": "<p>Suppose we have something like this: </p>\n\n<pre><code>type ReadHandler interface {\n     Reader\n     Reader\n }\n</code></pre>\n\n<p>Obviously, it will cause ambiguity when we call members of <code>Reader</code> interface on instances of <code>ReadHandeler</code>. So how can we achieve this in Golang?</p>\n"}, {"tags": ["go", "indexing", "nested"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1470956946, "post_id": 38907352, "comment_id": 65173361, "body": "The outer (BuilderMapObjs) is a map, the inner (NestedMapObj) is not a map but a struct and structs cannot be index. This has nothing to do with &quot;outer&quot; or &quot;inner&quot;, just map vs. struct."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1470966866, "post_id": 38907352, "comment_id": 65175553, "body": "@Volker: It is NestedMapObjs with the (s) actually. So it isn&#39;t a struct, it is an interface. But it has the same issue, you can&#39;t index an interface either. But you can call a function on it!"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1470982150, "post_id": 38907352, "comment_id": 65179695, "body": "Interfaces also do not allow indexing and that&#39;s what the compiler is telling you and you seem to know it. So what is the actual question?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1471008928, "post_id": 38907352, "comment_id": 65195361, "body": "(I didn&#39;t really dv/vtc/vtdelete, and I don&#39;t know [go], but good luck, and good first question)"}, {"owner": {"reputation": 53, "user_id": 4110451, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZY8hyLRV1EE/AAAAAAAAAAI/AAAAAAAAAd4/KnZOqFmdduU/photo.jpg?sz=128", "display_name": "Marco Vignati", "link": "https://stackoverflow.com/users/4110451/marco-vignati"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1472422813, "post_id": 38907352, "comment_id": 65733089, "body": "@ZanLynx Yes, is the way that I used to fix the problem... I created 2 function defined on that struct, one to get the key and one to append a new value. In this way I&#39;ve been able to build my completed structure."}], "owner": {"reputation": 53, "user_id": 4110451, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZY8hyLRV1EE/AAAAAAAAAAI/AAAAAAAAAd4/KnZOqFmdduU/photo.jpg?sz=128", "display_name": "Marco Vignati", "link": "https://stackoverflow.com/users/4110451/marco-vignati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470956438, "creation_date": 1470956438, "question_id": 38907352, "link": "https://stackoverflow.com/questions/38907352/golang-nested-map-doesnt-support-indexing-on-inner-level-while-outer-is-fine", "title": "Golang - nested map doesn&#39;t support indexing on inner level, while outer is fine", "body": "<p>Almost a go-newbie, and for the first time I have to made a question about it, about a problem with interfaces, types and maps.</p>\n\n<p>So, my starting point is a database query that retrieves an object like this one:</p>\n\n<pre><code>+-------------+---------------------+----------+------------+\n| category_id | category_name       | group_id | group_name |\n+-------------+---------------------+----------+------------+\n|           1 | Category1           |        1 | Group1     |\n|           1 | Category1           |        2 | Group2     |\n|           1 | Category1           |        3 | Group3     |\n|           1 | Category2           |        4 | Group4     |\n|           2 | Category2           |        5 | Group5     |\n+-------------+---------------------+----------+------------+\n</code></pre>\n\n<p>and my final goal is having a json object with the groups under the same category under that category, like this one:</p>\n\n<pre><code>{\n  \"id\": 1,\n  \"name\": \"category1\",\n  \"groups\": [\n    {\n      \"id\": 1,\n      \"name\": \"Group1\"\n    },\n    {\n      \"id\": 2,\n      \"name\": \"Group2\"\n    },\n    {\n      \"id\": 3,\n      \"name\": \"Group3\"\n    }\n  ]\n},\n{\n  \"id\": 2,\n  \"name\": \"Category2\",\n  \"groups\": [\n    {\n      \"id\": 4,\n      \"name\": \"Group4\"\n    },\n    {\n      \"id\": 5,\n      \"name\": \"Group5\"\n    }\n  ]\n}\n</code></pre>\n\n<p>I don't want to use multiple queries, cause this is just a part of the final query, I used just 2 field to be more clear with this example. In my current situation I just have 5 levels...</p>\n\n<p>So I created a struct that should be used on all levels of my object, that implements an interface:</p>\n\n<pre><code>type NestedMapObjs interface {\n  getOrderedKeys() []int\n}\n</code></pre>\n\n<p>and the type that implements this interface, that should be a <code>map of int</code> in order to append elements to the correct map:</p>\n\n<pre><code>type BuilderMapObjs map[int]NestedMapObj\n</code></pre>\n\n<p>when <code>NestedMapObject</code> is:</p>\n\n<pre><code>type NestedMapObj struct {\n    ID        int\n    Name      *string\n    NestedObj NestedMapObjs\n}\n</code></pre>\n\n<p>so, on my method that builds the map object that I want, I have no problem to add the first level of my object (<code>Category</code>) but, I found some problems on the second level, the group one. In particular, this is my function that adds a new row:</p>\n\n<pre><code>func (m BuilderMapObjs) addNewRow(scanned audienceBuilderScannedObject) error {\n  if _, ok := m[scanned.CategoryID]; !ok {\n\n    var innerObjs BuilderMapObjs\n    innerObjs = make(BuilderMapObjs, 0)\n\n    m[scanned.CategoryID] = NestedMapObj{\n      ID:        scanned.CategoryID,\n      Name:      &amp;scanned.CategoryName,\n      NestedObj: innerObjs,\n    }\n  }\n\n  if _, ok := m[scanned.CategoryID].NestedObj[scanned.GroupID]; !ok {\n    m[scanned.CategoryID].NestedObj[scanned.GroupID] = NestedMapObj{\n      ID:   scanned.GroupID,\n      Name: &amp;scanned.GroupName,\n    }\n  }\n\n  return nil\n}\n</code></pre>\n\n<p>(I know, I can refactor and make this code more readable, but this is not the point now...)</p>\n\n<p>The problem is when I try to get the inner object by its key, and when I try to add it. This line:</p>\n\n<p><code>m[scanned.CategoryID].NestedObj[scanned.GroupID]</code></p>\n\n<p>produce this error: <code>invalid operation: m[scanned.CategoryID].NestedObj[scanned.GroupID] (type NestedMapObjs does not support indexing)</code></p>\n\n<p>Actually, I just found that with a better implementation, implementing two more methods in the interface (<code>getIndex</code> and <code>addToIndex</code>) I fixed the problem, but I'd like to understand this problem. </p>\n\n<p>Why I have an error on the inner object and not on the outer one? </p>\n\n<p>Thanks for reading until this point! </p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1470954236, "post_id": 38907003, "comment_id": 65172544, "body": "Remove the comma before the <code>where</code> (or after the <code>now()</code>)."}, {"owner": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "edited": false, "score": 0, "creation_date": 1470988608, "post_id": 38907003, "comment_id": 65182806, "body": "Always, <b>always</b> show the exact error text. &quot;Syntax error&quot; is not a mystery code. It usually tells you where the error is and what is wrong. In this case it would&#39;ve output: <code>ERROR:  syntax error at or near &quot;WHERE&quot;</code> <code>LINE 3: WHERE id = 1;</code>. So you know to look around there, just before/after the error."}], "answers": [{"tags": [], "owner": {"reputation": 1318, "user_id": 2129425, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e5dbc30ff6937e57b5c3f338635ab55?s=128&d=identicon&r=PG", "display_name": "v2b", "link": "https://stackoverflow.com/users/2129425/v2b"}, "is_accepted": true, "score": 0, "last_activity_date": 1470956062, "creation_date": 1470956062, "answer_id": 38907296, "question_id": 38907003, "link": "https://stackoverflow.com/questions/38907003/setting-time-field-to-current-time-in-post-gres/38907296#38907296", "title": "Setting time field to current time in post gres", "body": "<p>As point out by someone you have an extra <code>,</code> that is causing the issue.\nYou can form the string correctly (<code>query</code> in the below example)and pass it to the db API.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    name := \"table_name\"\n    id := \"table_id\"\n    query := fmt.Sprintf(\"UPDATE %s SET update_at = %q WHERE id = %s\", name, time.Now(), id)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 6527908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91c02f36f6caf6d818188405dcba63ef?s=128&d=identicon&r=PG&f=1", "display_name": "Paarth", "link": "https://stackoverflow.com/users/6527908/paarth"}, "is_accepted": false, "score": 0, "last_activity_date": 1470981402, "creation_date": 1470981402, "answer_id": 38910899, "question_id": 38907003, "link": "https://stackoverflow.com/questions/38907003/setting-time-field-to-current-time-in-post-gres/38910899#38910899", "title": "Setting time field to current time in post gres", "body": "<p>As you mentioned </p>\n\n<blockquote>\n  <p>You want to set the value of a time field as current time</p>\n</blockquote>\n\n<p>You can try this, <code>Now()</code> provides current DateTime. After casting as <code>Time</code> we can get <code>currenttime</code></p>\n\n<pre><code>UPDATE table_name\nSET updated_at = now()::TIME\nWHERE id = _id\n</code></pre>\n\n<p>Alternately you can try</p>\n\n<pre><code>UPDATE table_name\n    SET updated_at = current_time --gives you current time with time zone\n    WHERE id = _id\n</code></pre>\n\n<p>please refer \n <a href=\"https://www.postgresql.org/docs/9.1/static/functions-datetime.html\" rel=\"nofollow\">https://www.postgresql.org/docs/9.1/static/functions-datetime.html</a> for more details.</p>\n\n<p>Hope it works for you.</p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 38907296, "answer_count": 2, "score": 0, "last_activity_date": 1470981402, "creation_date": 1470954087, "last_edit_date": 1470954242, "question_id": 38907003, "link": "https://stackoverflow.com/questions/38907003/setting-time-field-to-current-time-in-post-gres", "title": "Setting time field to current time in post gres", "body": "<p>So I'm pretty new to Post gres and am trying to set the value of a time field to be the current time.</p>\n\n<pre><code>UPDATE table_name\nSET updated_at = now(),\nWHERE id = :id\n</code></pre>\n\n<p>I'm executing this with golang and the above syntax errors.</p>\n\n<p>How do I enter the current time into the updated_at time field?</p>\n"}, {"tags": ["testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "edited": false, "score": 0, "creation_date": 1471057783, "post_id": 38908155, "comment_id": 65214295, "body": "Thanks for digging into this! And yes, <code>HasChildren</code> from the contrived example can definitely be a struct method : )"}], "tags": [], "owner": {"reputation": 151, "user_id": 1655275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9990ece5656ca2d39312d21877dcd9d8?s=128&d=identicon&r=PG", "display_name": "cmaglie", "link": "https://stackoverflow.com/users/1655275/cmaglie"}, "is_accepted": true, "score": 1, "last_activity_date": 1470962479, "creation_date": 1470962479, "answer_id": 38908155, "question_id": 38906954, "link": "https://stackoverflow.com/questions/38906954/generate-a-tree-of-structs-with-testing-quick-respecting-invariants/38908155#38908155", "title": "Generate a tree of structs with testing/quick, respecting invariants", "body": "<p>Looking at the <code>testing/quick</code> source code it seems that you can't create recursive custom generators and <strong>at the same time</strong> reuse the <code>quick</code> library facilities to generate the array part of the struct, because the <code>size</code> parameter, that is designed to limit the number of recursive calls, cannot be passed back into <code>quick.Value(...)</code></p>\n\n<p><a href=\"https://golang.org/src/testing/quick/quick.go\" rel=\"nofollow\">https://golang.org/src/testing/quick/quick.go</a> (see around line 50)</p>\n\n<p>in your case this lead to an infinite tree that quickly \"explodes\" with 1..50 leafs at each level (that's the reason for the stack overflow).</p>\n\n<p>If the function <code>quick.sizedValue()</code> had been public we could have used it to accomplish your task, but unfortunately this is not the case.</p>\n\n<p>BTW since HasChildren is an invariant, can't you simply make it a struct method?</p>\n\n<pre><code>type X struct {\n    Children    []*X\n}\n\nfunc (me *X) HasChildren() bool {\n    return len(me.Children) &gt; 0\n}\n\nfunc main() {\n    .... generate X ....\n    if x.HasChildren() {\n        .....\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 38908155, "answer_count": 1, "score": 1, "last_activity_date": 1470962479, "creation_date": 1470953818, "question_id": 38906954, "link": "https://stackoverflow.com/questions/38906954/generate-a-tree-of-structs-with-testing-quick-respecting-invariants", "title": "Generate a tree of structs with testing/quick, respecting invariants", "body": "<p>I have a tree of structs which I'd like to test using <code>testing/quick</code>, but constraining it to within my invariants.</p>\n\n<p>This example code works:</p>\n\n<pre><code>var rnd = rand.New(rand.NewSource(time.Now().UnixNano()))\ntype X struct {\n    HasChildren bool\n    Children    []*X\n}\nfunc TestSomething(t *testing.T) {\n    x, _ := quick.Value(reflect.TypeOf(X{}), rnd)\n    _ = x\n    // test some stuff here\n}\n</code></pre>\n\n<p>But we hold <code>HasChildren = true</code> whenever <code>len(Children) &gt; 0</code> as an invariant, so it'd be better to ensure that whatever <code>quick.Value()</code> generates respects that (rather than finding \"bugs\" that don't actually exist).</p>\n\n<p>I figured I could define a Generate function which uses <code>quick.Value()</code> to populate all the variable members:</p>\n\n<pre><code>func (X) Generate(rand *rand.Rand, size int) reflect.Value {\n    x := X{}\n\n    throwaway, _ := quick.Value(reflect.TypeOf([]*X{}), rand)\n    x.Children = throwaway.Interface().([]*X)\n\n    if len(x.Children) &gt; 0 {\n        x.HasChildren = true\n    } else {\n        x.HasChildren = false\n    }\n\n    return reflect.ValueOf(x)\n}\n</code></pre>\n\n<p>But this is panicking: </p>\n\n<blockquote>\n  <p>panic: value method main.X.Generate called using nil *X pointer [recovered]</p>\n</blockquote>\n\n<p>And when I change Children from <code>[]*X</code> to <code>[]X</code>, it dies with a stack overflow.</p>\n\n<p>The documentation is very thin on examples, and I'm finding almost nothing in web searches either.</p>\n\n<p>How can this be done?</p>\n"}, {"tags": ["go", "google-bigquery"], "comments": [{"owner": {"reputation": 2691, "user_id": 212435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xAkN2.jpg?s=128&g=1", "display_name": "shollyman", "link": "https://stackoverflow.com/users/212435/shollyman"}, "edited": false, "score": 3, "creation_date": 1470952020, "post_id": 38906503, "comment_id": 65171774, "body": "It appears this lacks any concurrency.  Once you have the initial datasets.list results, you can process the datasets independently."}, {"owner": {"reputation": 113, "user_id": 6575833, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E7J9j.png?s=128&g=1", "display_name": "Mark Wunsch", "link": "https://stackoverflow.com/users/6575833/mark-wunsch"}, "reply_to_user": {"reputation": 2691, "user_id": 212435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xAkN2.jpg?s=128&g=1", "display_name": "shollyman", "link": "https://stackoverflow.com/users/212435/shollyman"}, "edited": false, "score": 0, "creation_date": 1470959343, "post_id": 38906503, "comment_id": 65174010, "body": "@shollyman good call, was able to get it down to an average of 3 minutes with concurrency."}, {"owner": {"reputation": 115571, "user_id": 5221944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iqXab.png?s=128&g=1", "display_name": "Mikhail Berlyant", "link": "https://stackoverflow.com/users/5221944/mikhail-berlyant"}, "edited": false, "score": 1, "creation_date": 1470960545, "post_id": 38906503, "comment_id": 65174286, "body": "can you share code as an answer?"}, {"owner": {"reputation": 113, "user_id": 6575833, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E7J9j.png?s=128&g=1", "display_name": "Mark Wunsch", "link": "https://stackoverflow.com/users/6575833/mark-wunsch"}, "reply_to_user": {"reputation": 115571, "user_id": 5221944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iqXab.png?s=128&g=1", "display_name": "Mikhail Berlyant", "link": "https://stackoverflow.com/users/5221944/mikhail-berlyant"}, "edited": false, "score": 0, "creation_date": 1471016077, "post_id": 38906503, "comment_id": 65200016, "body": "@MikhailBerlyant good suggestion; done."}], "answers": [{"comments": [{"owner": {"reputation": 115571, "user_id": 5221944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iqXab.png?s=128&g=1", "display_name": "Mikhail Berlyant", "link": "https://stackoverflow.com/users/5221944/mikhail-berlyant"}, "edited": false, "score": 1, "creation_date": 1471016966, "post_id": 38921630, "comment_id": 65200591, "body": "nice. I tried similar approach yesterday but with channels and saw similar performance improvement."}], "tags": [], "owner": {"reputation": 113, "user_id": 6575833, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E7J9j.png?s=128&g=1", "display_name": "Mark Wunsch", "link": "https://stackoverflow.com/users/6575833/mark-wunsch"}, "is_accepted": true, "score": 2, "last_activity_date": 1471016008, "creation_date": 1471016008, "answer_id": 38921630, "question_id": 38906503, "link": "https://stackoverflow.com/questions/38906503/need-faster-way-to-list-all-datasets-tables-in-project/38921630#38921630", "title": "Need faster way to list all datasets/tables in project", "body": "<p>Here is an updated version of my code, with concurrency, that reduced the processing time from about 15 minutes to 3 minutes.</p>\n\n<pre><code>func populateExistingTableMap(service *bigquery.Service, cloudCtx context.Context, projectId string) (map[string]map[string]bool, error) {\n    tableMap = map[string]map[string]bool{}\n\n    call := service.Datasets.List(projectId)\n    //call.Fields(\"datasets/datasetReference\")\n\n    if err := call.Pages(cloudCtx, func(page *bigquery.DatasetList) error {\n        var wg sync.WaitGroup\n        wg.Add(len(page.Datasets))\n        for _, v := range page.Datasets {\n            if tableMap[v.DatasetReference.DatasetId] == nil {\n                tableMap[v.DatasetReference.DatasetId] = map[string]bool{}\n            }\n\n            go func(service *bigquery.Service, datasetID string, projectId string) {\n                defer wg.Done()\n                table_call := service.Tables.List(projectId, datasetID)\n                //table_call.Fields(\"tables/tableReference\")\n                if err := table_call.Pages(cloudCtx, func(page *bigquery.TableList) error {\n                    for _, t := range page.Tables {\n                        tableMap[datasetID][t.TableReference.TableId] = true\n                    }\n                    return nil // NOTE: returning a non-nil error stops pagination.\n                }); err != nil {\n                    // TODO: Handle error.\n                    fmt.Println(err)\n                }\n            }(service, v.DatasetReference.DatasetId, projectId)\n        }\n\n        wg.Wait()\n        return nil // NOTE: returning a non-nil error stops pagination.\n    }); err != nil {\n        return tableMap, err\n        // TODO: Handle error.\n    }\n\n    return tableMap, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6575833, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E7J9j.png?s=128&g=1", "display_name": "Mark Wunsch", "link": "https://stackoverflow.com/users/6575833/mark-wunsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 3, "accepted_answer_id": 38921630, "answer_count": 1, "score": 3, "last_activity_date": 1471016008, "creation_date": 1470951266, "last_edit_date": 1470952559, "question_id": 38906503, "link": "https://stackoverflow.com/questions/38906503/need-faster-way-to-list-all-datasets-tables-in-project", "title": "Need faster way to list all datasets/tables in project", "body": "<p>I am creating a utility that needs to be aware of all the datasets/tables that exist in my BigQuery project. My current code for getting this information is as follows (using Go API):</p>\n\n<pre><code>func populateExistingTableMap(service *bigquery.Service, cloudCtx context.Context, projectId string) (map[string]map[string]bool, error) {\n    tableMap := map[string]map[string]bool{}\n\n    call := service.Datasets.List(projectId)\n    //call.Fields(\"datasets/datasetReference\")\n\n    if err := call.Pages(cloudCtx, func(page *bigquery.DatasetList) error {\n        for _, v := range page.Datasets {\n\n            if tableMap[v.DatasetReference.DatasetId] == nil {\n                tableMap[v.DatasetReference.DatasetId] = map[string]bool{}\n            }\n\n            table_call := service.Tables.List(projectId, v.DatasetReference.DatasetId)\n            //table_call.Fields(\"tables/tableReference\")\n\n            if err := table_call.Pages(cloudCtx, func(page *bigquery.TableList) error {\n                for _, t := range page.Tables {\n                    tableMap[v.DatasetReference.DatasetId][t.TableReference.TableId] = true\n                }\n                return nil \n            }); err != nil {\n                return errors.New(\"Error Parsing Table\")\n            }\n        }\n        return nil \n    }); err != nil {\n        return tableMap, err\n    }\n\n    return tableMap, nil\n}\n</code></pre>\n\n<p>For a project with about 5000 datasets, each with up to 10 tables, this code takes almost 15 minutes to return. Is there a faster way to iterate through the names of all existing datasets/tables? I have tried using the Fields method to return only the fields I need (you can see those lines commented out above), but that results in only 50 (exactly 50) of my datasets being returned. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c++", "go", "namespaces"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1470943336, "post_id": 38904423, "comment_id": 65167714, "body": "@juanchopanza I&#39;m pretty sure the OP is looking for something like <code>using std::cout;</code> and then just be able toy use <code>cout</code> instead of <code>std::cout</code>."}, {"owner": {"reputation": 1069, "user_id": 3806343, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/tzFZo.png?s=128&g=1", "display_name": "cookieisaac", "link": "https://stackoverflow.com/users/3806343/cookieisaac"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1470943818, "post_id": 38904423, "comment_id": 65167948, "body": "@NathanOliver that&#39;s exactly what I&#39;m looking for."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1470950625, "post_id": 38904423, "comment_id": 65171201, "body": "If package naming and naming of exported stuff is well matched it is not much extra typing but a lot of extra readability."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 2, "last_activity_date": 1470943242, "creation_date": 1470943242, "answer_id": 38904512, "question_id": 38904423, "link": "https://stackoverflow.com/questions/38904423/whats-cs-using-equivalent-in-golang/38904512#38904512", "title": "What&#39;s C++&#39;s `using` equivalent in golang", "body": "<p>There is currently no such functionality in Go.</p>\n\n<p>That's not to say it will never be added: there is <a href=\"https://github.com/golang/go/issues/16339\" rel=\"nofollow\">open proposal to add \"Alias declarations\"</a> to the language.</p>\n"}, {"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": true, "score": 5, "last_activity_date": 1470943801, "creation_date": 1470943801, "answer_id": 38904666, "question_id": 38904423, "link": "https://stackoverflow.com/questions/38904423/whats-cs-using-equivalent-in-golang/38904666#38904666", "title": "What&#39;s C++&#39;s `using` equivalent in golang", "body": "<p>The following code comes close in terms of readability, but is less efficient, since the compiler cannot inline function calls anymore.</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"strings\"\n)\n\nvar (\n    Sprintf = fmt.Sprintf\n    HasPrefix = strings.HasPrefix\n)\n</code></pre>\n\n<p>And, it has the side-effect of importing the names <code>fmt</code> and <code>strings</code> into the file scope, which is something that C++'s <code>using</code> does not do.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1470981866, "last_edit_date": 1470981866, "creation_date": 1470981163, "answer_id": 38910838, "question_id": 38904423, "link": "https://stackoverflow.com/questions/38904423/whats-cs-using-equivalent-in-golang/38910838#38910838", "title": "What&#39;s C++&#39;s `using` equivalent in golang", "body": "<p>As others said, it is not possible in Go. In Go you import <em>packages</em>, not functions or types from packages.</p>\n\n<p>Note that you can easily achieve what you want if you create a <em>helper</em> package.</p>\n\n<p>Let's say you want \"using\" the <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow\"><code>fmt.Println()</code></a> and <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow\"><code>fmt.Printf()</code></a> functions only. Create a helper package:</p>\n\n<pre><code>package helper\n\nimport \"fmt\"\n\nfunc Println(a ...interface{}) (n int, err error) {\n    return fmt.Println(a...)\n}\n\nfunc Printf(format string, a ...interface{}) (n int, err error) {\n    return fmt.Printf(format, a...)\n}\n</code></pre>\n\n<p>And where you want the C++'s \"using\" functionality, import using a dot <code>.</code>:</p>\n\n<pre><code>import . \"helper\"\n\nfunc Something() {\n    Println(\"Hi\")\n    Printf(\"Using format string: %d\", 3)\n}\n</code></pre>\n\n<p>The result is that only the exported identifiers of the <code>helper</code> package will be in scope, nothing else from the <code>fmt</code> package. You can use this single <code>helper</code> package to make functions available from packages other than <code>fmt</code> of course, too. <code>helper</code> can import any other packages and have a \"proxy\" or delegator function publishing their functionality.</p>\n\n<p>Personally I don't feel the need of this. I would just import <code>fmt</code> and call its functions using <code>fmt.Println()</code> and <code>fmt.Printf()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "is_accepted": false, "score": 1, "last_activity_date": 1593699568, "last_edit_date": 1593699568, "creation_date": 1470997544, "answer_id": 38915698, "question_id": 38904423, "link": "https://stackoverflow.com/questions/38904423/whats-cs-using-equivalent-in-golang/38915698#38915698", "title": "What&#39;s C++&#39;s `using` equivalent in golang", "body": "<p>Perhaps you could rename the package:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import ( \n     c &quot;common&quot;\n     cout2 &quot;github.com/one/cout&quot; \n     cout2 &quot;github.com/two/cout&quot;\n)\n</code></pre>\n<p>Then you would only have to type <code>c.Platform</code></p>\n"}], "owner": {"reputation": 1069, "user_id": 3806343, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/tzFZo.png?s=128&g=1", "display_name": "cookieisaac", "link": "https://stackoverflow.com/users/3806343/cookieisaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1847, "favorite_count": 0, "accepted_answer_id": 38904666, "answer_count": 4, "score": 9, "last_activity_date": 1593699568, "creation_date": 1470942881, "last_edit_date": 1495540297, "question_id": 38904423, "link": "https://stackoverflow.com/questions/38904423/whats-cs-using-equivalent-in-golang", "title": "What&#39;s C++&#39;s `using` equivalent in golang", "body": "<p>What's C++'s <code>using some_namespace::object</code> equivalent in golang?</p>\n\n<p>According to the question <a href=\"https://stackoverflow.com/questions/12925450/importing-packages-in-go\">here</a> \nI can get <code>using namespace common</code> with statement below:</p>\n\n<pre><code>import (\n  . \"common\"\n)\n</code></pre>\n\n<p>But this would import the entire namespace. Right now I only want to use, say <code>platform</code> definition, something like <code>using common::platform</code></p>\n\n<p>Is there an equivalent for this in Go, so that I don't have to type <code>common.platform</code> all the time?</p>\n"}, {"tags": ["file", "go", "offset", "seek"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1470936031, "post_id": 38902092, "comment_id": 65163714, "body": "No, the default buffer size is 4096 bytes. Try it on a larger file."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 4, "last_activity_date": 1470936744, "last_edit_date": 1470936744, "creation_date": 1470936346, "answer_id": 38902614, "question_id": 38902092, "link": "https://stackoverflow.com/questions/38902092/does-bufio-newscanner-in-golang-reads-the-entire-file-in-memory-instead-of-a-lin/38902614#38902614", "title": "Does bufio.NewScanner in Golang reads the entire file in memory instead of a line each?", "body": "<p>see <code>func (s *Scanner) Buffer(buf []byte, max int)</code> Docs:</p>\n\n<blockquote>\n  <p>Buffer sets the initial buffer to use when scanning and the maximum \n  size of buffer that may be allocated during scanning. The maximum \n  token size is the larger of max and <code>cap(buf)</code>.<br>\n  If <code>max &lt;= cap(buf)</code>, \n  Scan will use this buffer only and do no allocation.</p>\n  \n  <p>By default, Scan uses an internal buffer and sets the  maximum token\n  size to <code>MaxScanTokenSize</code>.</p>\n  \n  <p>Buffer panics if it is called after scanning has started.</p>\n</blockquote>\n\n<p>And:</p>\n\n<blockquote>\n  <p>MaxScanTokenSize is the maximum size used to buffer a token  unless\n  the user provides an explicit buffer with Scan.Buffer.  The actual\n  maximum token size may be smaller as the buffer  may need to include,\n  for instance, a newline.    </p>\n\n<pre><code>MaxScanTokenSize = 64 * 1024\n\nstartBufSize = 4096 // Size of initial allocation for buffer.\n</code></pre>\n</blockquote>\n\n<p>No, as @JimB said it reads only buffer size, see this test sample:  </p>\n\n<p>For smaller than 4096 bytes it reads all file content to the buffer,<br>\nbut for big files just reads 4096 bytes,<br>\ntry this with big files:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    fd, err := os.Open(\"big.txt\")\n    if err != nil {\n        panic(err)\n    }\n    defer fd.Close()\n\n    n, err := fd.Seek(0, 0)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"n =\", n) // 0\n\n    scanner := bufio.NewScanner(fd)\n    for scanner.Scan() {\n        fmt.Println(scanner.Text())\n        break\n    }\n\n    offset, err := fd.Seek(0, 1)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"offset =\", offset) //4096\n\n    offsetreset, err := fd.Seek(offset, 0)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"offsetreset =\", offsetreset) //4096\n\n    offset, err = fd.Seek(0, 1)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"offset =\", offset) //4096\n\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>n = 0\n\noffset = 4096\noffsetreset = 4096\noffset = 4096\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1126, "user_id": 4595674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-sZKhhu4m_Eo/AAAAAAAAAAI/AAAAAAAAAN0/wjo2wquXsXU/photo.jpg?sz=128", "display_name": "Albi", "link": "https://stackoverflow.com/users/4595674/albi"}, "is_accepted": false, "score": 0, "last_activity_date": 1588358747, "creation_date": 1588358747, "answer_id": 61548762, "question_id": 38902092, "link": "https://stackoverflow.com/questions/38902092/does-bufio-newscanner-in-golang-reads-the-entire-file-in-memory-instead-of-a-lin/61548762#61548762", "title": "Does bufio.NewScanner in Golang reads the entire file in memory instead of a line each?", "body": "<p>You can increase your buffer size of your scanner</p>\n\n<p>eg:- </p>\n\n<pre><code>scanner := bufio.NewScanner(file)\nbuf := make([]byte, 0, 64*1024)\nscanner.Buffer(buf, 1024*1024) //1024*1024 =&gt; 1mb max (you can change value here to read larger files\nfor scanner.Scan() {\n    // do your stuff\n}\n</code></pre>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2122, "favorite_count": 1, "accepted_answer_id": 38902614, "answer_count": 2, "score": 3, "last_activity_date": 1588358747, "creation_date": 1470934332, "last_edit_date": 1470937446, "question_id": 38902092, "link": "https://stackoverflow.com/questions/38902092/does-bufio-newscanner-in-golang-reads-the-entire-file-in-memory-instead-of-a-lin", "title": "Does bufio.NewScanner in Golang reads the entire file in memory instead of a line each?", "body": "<p>I was trying to read a file line by line with the following function using <code>bufio.NewScanner</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func TailFromStart(fd *os.File, wg *sync.WaitGroup)  {\n\n    fd.Seek(0,0)\n    scanner := bufio.NewScanner(fd)\n    for scanner.Scan() {\n        line := scanner.Text()\n        offset, _ := fd.Seek(0, 1)\n        fmt.Println(offset)\n        fmt.Println(line)\n        offsetreset, _ := fd.Seek(offset, 0)\n        fmt.Println(offsetreset)\n    }\n    offset, err := fd.Seek(0, 1)\n    CheckError(err)\n    fmt.Println(offset)\n    wg.Done()\n\n}\n</code></pre>\n\n<p>I was expecting it to print offset in increasing order, however, it is printing the same value in each iteration until the file reaches <code>EOF</code>.</p>\n\n<pre><code>127.0.0.1 - - [11/Aug/2016:22:10:39 +0530] \"GET /ttt HTTP/1.1\" 404 437 \"-\" \"curl/7.38.0\"\n613\n613\n127.0.0.1 - - [11/Aug/2016:22:10:42 +0530] \"GET /qqq HTTP/1.1\" 404 437 \"-\" \"curl/7.38.0\"\n613\n</code></pre>\n\n<p>613 is the total number of characters in the file.</p>\n\n<pre><code>cat /var/log/apache2/access.log | wc\n  7      84     613\n</code></pre>\n\n<p>Am I understanding it wrong, or does <code>bufio.NewScanner</code> reads the entire file in memory, and iterates over that in-memory? If so, is there a better way to read line-by-line?</p>\n"}, {"tags": ["json", "validation", "go"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4751392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417eadb7a125168dc7d1dcef9ad78482?s=128&d=identicon&r=PG&f=1", "display_name": "stephank", "link": "https://stackoverflow.com/users/4751392/stephank"}, "edited": false, "score": 0, "creation_date": 1470929903, "post_id": 38900667, "comment_id": 65160308, "body": "Thanks. Yes I tried the implementation you linked. Unfortunately it doesn&#39;t seem to return the error position in case the validation fails."}, {"owner": {"reputation": 160456, "user_id": 89391, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bb5230985aa2c9ea7d022d1a16890f16?s=128&d=identicon&r=PG", "display_name": "miku", "link": "https://stackoverflow.com/users/89391/miku"}, "reply_to_user": {"reputation": 51, "user_id": 4751392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417eadb7a125168dc7d1dcef9ad78482?s=128&d=identicon&r=PG&f=1", "display_name": "stephank", "link": "https://stackoverflow.com/users/4751392/stephank"}, "edited": false, "score": 0, "creation_date": 1470990507, "post_id": 38900667, "comment_id": 65183916, "body": "I haven&#39;t tried the library myself. Maybe error position is something which could be added to it?"}, {"owner": {"reputation": 51, "user_id": 4751392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417eadb7a125168dc7d1dcef9ad78482?s=128&d=identicon&r=PG&f=1", "display_name": "stephank", "link": "https://stackoverflow.com/users/4751392/stephank"}, "edited": false, "score": 0, "creation_date": 1471357825, "post_id": 38900667, "comment_id": 65308092, "body": "I looked a bit more into xeipuuv&#39;s gojsonschema. It can print information about the error position: <code>fmt.Printf(&quot;- %s: %s\\n&quot;, error.Context().String(), error)</code>.  This prints:  <code>- (root).0: name: name is required</code>"}, {"owner": {"reputation": 51, "user_id": 4751392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417eadb7a125168dc7d1dcef9ad78482?s=128&d=identicon&r=PG&f=1", "display_name": "stephank", "link": "https://stackoverflow.com/users/4751392/stephank"}, "edited": false, "score": 0, "creation_date": 1471358996, "post_id": 38900667, "comment_id": 65308894, "body": "Is there a way to detect unexpected fields using JSON Schemas?"}, {"owner": {"reputation": 338, "user_id": 1527587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b328b428340a356d1ded86efaa2e3554?s=128&d=identicon&r=PG", "display_name": "Cristian", "link": "https://stackoverflow.com/users/1527587/cristian"}, "edited": false, "score": 2, "creation_date": 1475181251, "post_id": 38900667, "comment_id": 66853272, "body": "I wrote a lot of the error handling in that library. You can define a schema with <code>additionalProperties</code> set to <code>false</code> and then look for the <code>additional_property_not_allowed</code> error type from the library. You can extract the field name from <code>ResultError.Field()</code> to get the name of the unexpected field."}], "tags": [], "owner": {"reputation": 160456, "user_id": 89391, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bb5230985aa2c9ea7d022d1a16890f16?s=128&d=identicon&r=PG", "display_name": "miku", "link": "https://stackoverflow.com/users/89391/miku"}, "is_accepted": false, "score": 2, "last_activity_date": 1470929671, "creation_date": 1470929671, "answer_id": 38900667, "question_id": 38900544, "link": "https://stackoverflow.com/questions/38900544/validate-json-and-show-error-position/38900667#38900667", "title": "Validate JSON and show error position", "body": "<p>Have you looked at <a href=\"http://json-schema.org/\" rel=\"nofollow\">JSON schema</a>?</p>\n\n<blockquote>\n  <p>JSON Schema describes your JSON data format.</p>\n</blockquote>\n\n<p>I believe it is in Draft stage, but a lot of languages have validation libraries. Here's a Go implementation:</p>\n\n<ul>\n<li><a href=\"https://github.com/xeipuuv/gojsonschema\" rel=\"nofollow\">https://github.com/xeipuuv/gojsonschema</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2301, "user_id": 3448879, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/y7XPi.png?s=128&g=1", "display_name": "Jairo Lozano", "link": "https://stackoverflow.com/users/3448879/jairo-lozano"}, "is_accepted": false, "score": 0, "last_activity_date": 1612311646, "last_edit_date": 1612311646, "creation_date": 1612311137, "answer_id": 66019455, "question_id": 38900544, "link": "https://stackoverflow.com/questions/38900544/validate-json-and-show-error-position/66019455#66019455", "title": "Validate JSON and show error position", "body": "<p>You can also use the <code>encoding/json</code> JSON Decoder and force errors when unexpected keys are found. It won't tell you the line number, but it's a start and you don't require any external package.</p>\n<pre><code>package main\n\nimport (\n    &quot;bytes&quot;\n    &quot;encoding/json&quot;\n    &quot;fmt&quot;\n)\n\ntype MyType struct {\n    ExpectedKey string `json:&quot;expected_key&quot;`\n}\n\nfunc main() {\n    jsonBytes := []byte(`{&quot;expected_key&quot;:&quot;a&quot;, &quot;unexpected_key&quot;:&quot;b&quot;}`)\n\n    var typePlaceholder MyType\n\n    // Create JSON decoder\n    dec := json.NewDecoder(bytes.NewReader(jsonBytes))\n\n    // Force errors when unexpected keys are present\n    dec.DisallowUnknownFields()\n\n    if err := dec.Decode(&amp;typePlaceholder); err != nil {\n        fmt.Println(err.Error())\n    }\n\n}\n\n</code></pre>\n<p>You can see that working in playground <a href=\"https://play.golang.org/p/Oki7a1b_VM5\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 51, "user_id": 4751392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417eadb7a125168dc7d1dcef9ad78482?s=128&d=identicon&r=PG&f=1", "display_name": "stephank", "link": "https://stackoverflow.com/users/4751392/stephank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1612311646, "creation_date": 1470929326, "last_edit_date": 1531242618, "question_id": 38900544, "link": "https://stackoverflow.com/questions/38900544/validate-json-and-show-error-position", "title": "Validate JSON and show error position", "body": "<p>I want to parse and validate (custom) JSON configuration files within Go. I would like to be able to parse the file into a struct and validate that:</p>\n\n<ol>\n<li>no unexpected keys are present in the JSON file (in particular to detect typos)</li>\n<li>certain keys are present and have non-empty values</li>\n</ol>\n\n<p>In case the validation fails (or in case of a syntax error), I want to print an error message to the user that explains as detailed as possible where in the file the error happened (e.g. by stating the line number if possible).</p>\n\n<p>The JSON parser built into Go seems to just silently ignore unexpected keys. I also tried using jsonpb (Protobuf) to deserialize the JSON, which returns an error in case of an unexpected key, but does not report the position.</p>\n\n<p>To check for non-empty values, I could use an existing validation library, but I haven't seen any does reports detailed error messages. Alternatively, I could write custom code that validates the data returned by the built-in JSON parser, but it would be nice if there was a generic way.</p>\n\n<p>Is there a simple way to get the desired behaviour?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470926887, "post_id": 38899565, "comment_id": 65158030, "body": "Please post the relevant code, as you say the strings are built dynamically."}, {"owner": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470926963, "post_id": 38899565, "comment_id": 65158091, "body": "@WiktorStribi\u017cew Code that generates the log message or the regex code?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1470927165, "post_id": 38899565, "comment_id": 65158260, "body": "See <a href=\"https://ideone.com/hTE8f9\" rel=\"nofollow noreferrer\">ideone.com/hTE8f9</a>, your regex matches the input string. I just copied/pasted your data. Please add the relevant details so that we could repro the issue."}, {"owner": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470927776, "post_id": 38899565, "comment_id": 65158791, "body": "@WiktorStribi\u017cew I added the code above. I do see that your example works, which is why this is confusing me."}, {"owner": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470929546, "post_id": 38899565, "comment_id": 65160073, "body": "I figured it out. The log that I was getting back was HTML escaped, so the single quote was actually &amp;#39. That prevented matching with the single quote."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470932699, "post_id": 38899565, "comment_id": 65161986, "body": "You haven&#39;t specified it in the question. So, it is still off-topic. I suggest using the regex on <i>plain</i> text, either before it is entitized, or you will have to add <code>(?:&#39;|&amp;#39;)</code> group to match the single quote."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 6654927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92860a09db347567308e04c5cd69a762?s=128&d=identicon&r=PG&f=1", "display_name": "MustafaG", "link": "https://stackoverflow.com/users/6654927/mustafag"}, "is_accepted": false, "score": -1, "last_activity_date": 1470927846, "creation_date": 1470927846, "answer_id": 38900000, "question_id": 38899565, "link": "https://stackoverflow.com/questions/38899565/cant-capture-single-quote-in-regex/38900000#38900000", "title": "Can&#39;t capture single quote in regex", "body": "<p>Please try this slightly modified regex.</p>\n\n<pre><code>(\\d){4}\\/(\\d){2}\\/(\\d){2} (\\d){2}:(\\d){2}:(\\d){2} (\\[\\w*\\]){2} ([\\w ])+ '.*'\n</code></pre>\n\n<p>I hope it helps! If you have questions, please ask!</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1470939389, "last_edit_date": 1470939389, "creation_date": 1470938563, "answer_id": 38903229, "question_id": 38899565, "link": "https://stackoverflow.com/questions/38899565/cant-capture-single-quote-in-regex/38903229#38903229", "title": "Can&#39;t capture single quote in regex", "body": "<p>Try this working sample code (with <code>&amp;#39</code>): </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\nimport \"time\"\n\nvar rgx = regexp.MustCompile(`(\\d){4}\\/(\\d){2}\\/(\\d){2} (\\d){2}:(\\d){2}:(\\d){2} (\\[\\w*\\]){2} ([\\w ])+ &amp;#39.*&amp;#39`)\n\nfunc main() {\n    s := time.Now().UTC().Format(\"2006/01/02 15:04:05\") + ` [DEV][INFO] Executing Process &amp;#39Some process&amp;#39 `\n    r := rgx.FindAllString(s, -1)\n    fmt.Println(r)\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>[2016/08/11 18:13:41 [DEV][INFO] Executing Process &amp;#39Some process&amp;#39]\n</code></pre>\n\n<p>Try this working sample code (with <code>'</code>): </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\nimport \"time\"\n\nvar rgx = regexp.MustCompile(`(\\d){4}\\/(\\d){2}\\/(\\d){2} (\\d){2}:(\\d){2}:(\\d){2} (\\[\\w*\\]){2} ([\\w ])+ '.*'`)\n\nfunc main() {\n    s := time.Now().UTC().Format(\"2006/01/02 15:04:05\") + ` [DEV][INFO] Executing Process 'Some process' `\n    r := rgx.FindAllString(s, -1)\n    fmt.Println(r) //\n\n    s = `2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process'`\n    r = rgx.FindAllString(s, -1)\n    fmt.Println(r) // 2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process'\n    fmt.Println()\n\n    s = ` dfgfsdfg sdf gsdf gsdf 2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process' 2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process'`\n    r = rgx.FindAllString(s, -1)\n    fmt.Println(r) // [2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process' 2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process']\n    fmt.Println()\n\n    s = `aaaaaaaaaaaaaaaaa asdfsf 'asdfasdf'`\n    r = rgx.FindAllString(s, -1)\n    fmt.Println(r) // []\n}\n</code></pre>\n\n<p>output;</p>\n\n<pre><code>[2016/08/11 18:09:01 [DEV][INFO] Executing Process 'Some process']\n[2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process']\n\n[2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process' 2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process']\n\n[]\n</code></pre>\n"}], "owner": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470939450, "creation_date": 1470926683, "last_edit_date": 1470939450, "question_id": 38899565, "link": "https://stackoverflow.com/questions/38899565/cant-capture-single-quote-in-regex", "title": "Can&#39;t capture single quote in regex", "body": "<p>I am trying to capture lines that look like this, for example:</p>\n\n<pre><code>2016/07/27 21:37:50 [DEV][INFO] Executing Process 'Some process'\n</code></pre>\n\n<p>I am using the following regex pattern:</p>\n\n<pre><code>\\d{4}/\\d{2}/\\d{2} \\d{2}:\\d{2}:\\d{2} \\[.*\\]\\[.*\\] Executing Process '.*'\n</code></pre>\n\n<p>However, the line is not being captured. I noticed that it works all the way up to the single quote. But if I add the single quote, it fails. I thought there might possibly be two different types of single quotes, but I copied and pasted the quote being used, and it still didn't work. Also both quotes are being generated by the same code, so one single quote should be the same as another.</p>\n\n<p>EDIT:<br>\nThis the regex code.</p>\n\n<pre><code>regexPattern := `\\d{4}/\\d{2}/\\d{2} \\d{2}:\\d{2}:\\d{2} \\[.*\\]\\[.*\\] Executing Process '.*'`\n\nlog = highlight(log, regexPattern)\n...\nfunc highlight(log, pattern string) string {\n    regex := regexp.MustCompile(\n    matches := regex.FindAllString(log, -1)\n</code></pre>\n\n<p>Edit:<br>\nI figured it out. The log that I was getting back was HTML escaped, so the single quote was actually &amp;#39. That prevented matching with the single quote</p>\n"}, {"tags": ["go", "methods"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470921726, "post_id": 38897529, "comment_id": 65154078, "body": "I don&#39;t understand what your asking. Is this what you&#39;re trying to do? <a href=\"https://play.golang.org/p/VXuSOeGPd-\" rel=\"nofollow noreferrer\">play.golang.org/p/VXuSOeGPd-</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6636, "user_id": 1385242, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bce12c002581b804125a5675841f0f7f?s=128&d=identicon&r=PG", "display_name": "Rajkamal Subramanian", "link": "https://stackoverflow.com/users/1385242/rajkamal-subramanian"}, "edited": false, "score": 1, "creation_date": 1510877797, "post_id": 38897667, "comment_id": 81634849, "body": "How would you do it for method with pointer receivers ? I tried like shown in this link <a href=\"https://play.golang.org/p/mdi8htBnZ9\" rel=\"nofollow noreferrer\">play.golang.org/p/mdi8htBnZ9</a>. But i cannot figure out."}, {"owner": {"reputation": 6636, "user_id": 1385242, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bce12c002581b804125a5675841f0f7f?s=128&d=identicon&r=PG", "display_name": "Rajkamal Subramanian", "link": "https://stackoverflow.com/users/1385242/rajkamal-subramanian"}, "edited": false, "score": 0, "creation_date": 1510878681, "post_id": 38897667, "comment_id": 81635088, "body": "As i could not edit previous comment, adding a new comment. I tried as given in spec and came up with <a href=\"https://play.golang.org/p/7P9mU0uhke\" rel=\"nofollow noreferrer\">play.golang.org/p/7P9mU0uhke</a>. But i have one more question here. I was expecting the two addresses that are getting printed to be the same (address of Foo instance <code>f</code>)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6636, "user_id": 1385242, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bce12c002581b804125a5675841f0f7f?s=128&d=identicon&r=PG", "display_name": "Rajkamal Subramanian", "link": "https://stackoverflow.com/users/1385242/rajkamal-subramanian"}, "edited": false, "score": 1, "creation_date": 1510906308, "post_id": 38897667, "comment_id": 81643719, "body": "@rajkamal Inside <code>foo.A()</code> you&#39;re not printing the <code>f</code> pointer but the address of the pointer. <code>f</code> is already a pointer, so <code>&amp;f</code> will be of type <code>**foo</code>. If you change it to simply print the value of <code>f</code>, then you&#39;ll see the same pointer printed: <a href=\"https://play.golang.org/p/kfrOQVC494\" rel=\"nofollow noreferrer\">Go Playground</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 47, "last_activity_date": 1471847358, "last_edit_date": 1471847358, "creation_date": 1470921851, "answer_id": 38897667, "question_id": 38897529, "link": "https://stackoverflow.com/questions/38897529/pass-method-argument-to-function/38897667#38897667", "title": "Pass method argument to function", "body": "<p>Yes, it's possible. You have 2 (3) options:</p>\n\n<h3><a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"noreferrer\">Spec: Method expressions</a></h3>\n\n<p>The expression <code>Foo.A</code> yields a function equivalent to <code>A</code> but with an explicit receiver as its first argument; it has signature <code>func(f Foo)</code>.</p>\n\n<pre><code>var f Foo\nbar := func(m func(f Foo)) {\n    m(f)\n}\nbar(Foo.A)\nbar(Foo.B)\nbar(Foo.C)\n</code></pre>\n\n<p>Here the method receiver is explicit. You only pass the method name (with the type it belongs to) to <code>bar()</code>, and when calling it, you have to pass the actual receiver: <code>m(f)</code>.</p>\n\n<p>Output as expected (try it on the <a href=\"https://play.golang.org/p/Z_57EDE_ZU\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>A\nB\nC\n</code></pre>\n\n<h3><a href=\"https://golang.org/ref/spec#Method_values\" rel=\"noreferrer\">Spec: Method values</a></h3>\n\n<p>If <code>f</code> is a value of type <code>Foo</code>, the expression <code>f.A</code> yields a function value of type <code>func()</code> with implicit receiver value <code>f</code>.</p>\n\n<pre><code>var f Foo\nbar := func(m func()) {\n    m()\n}\nbar(f.A)\nbar(f.B)\nbar(f.C)\n</code></pre>\n\n<p>Note that here the method receiver is implicit, it is saved with the function value passed to <code>bar()</code>, and so it is called without explicitly specifying it: <code>m()</code>.</p>\n\n<p>Output is the same (try it on the <a href=\"https://play.golang.org/p/FQ8Kwnv8yq\" rel=\"noreferrer\">Go Playground</a>).</p>\n\n<h3>(For completeness: <a href=\"https://golang.org/pkg/reflect/\" rel=\"noreferrer\">reflection</a>)</h3>\n\n<p>Inferior to previous solutions (both in performance and in \"safeness\"), but you could pass the name of the method as a <code>string</code> value, and then use the <a href=\"https://golang.org/pkg/reflect/\" rel=\"noreferrer\"><code>reflect</code></a> package to call the method by that name. It could look like this:</p>\n\n<pre><code>var f Foo\nbar := func(name string) {\n    reflect.ValueOf(f).MethodByName(name).Call(nil)\n}\nbar(\"A\")\nbar(\"B\")\nbar(\"C\")\n</code></pre>\n\n<p>Try this on the <a href=\"https://play.golang.org/p/eCT34Da3Lr\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1599530165, "creation_date": 1599530165, "answer_id": 63786166, "question_id": 38897529, "link": "https://stackoverflow.com/questions/38897529/pass-method-argument-to-function/63786166#63786166", "title": "Pass method argument to function", "body": "<p>You could also use the \u201cmethod values\u201d option listed by @icza with different receivers.</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\ntype Foo int\ntype Goo int\n\nfunc (f Foo) A() { fmt.Println(&quot;A&quot;) }\nfunc (f Foo) B() { fmt.Println(&quot;B&quot;) }\nfunc (g Goo) A() { fmt.Println(&quot;A&quot;) }\n\nfunc main() {\n    //Method values with receiver f\n    var f Foo\n    bar2 := func(m func()) { m() }\n    bar2(f.A) //A\n    bar2(f.B) //B\n    //Method values with receivers f and g\n    var g Goo\n    bar2(f.A) //A\n    bar2(g.A) //A\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10865607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc6ec626ba038499952b8bc3b7d6fae?s=128&d=identicon&r=PG&f=1", "display_name": "pmg7670", "link": "https://stackoverflow.com/users/10865607/pmg7670"}, "is_accepted": false, "score": 0, "last_activity_date": 1617075482, "last_edit_date": 1617075482, "creation_date": 1617074480, "answer_id": 66864357, "question_id": 38897529, "link": "https://stackoverflow.com/questions/38897529/pass-method-argument-to-function/66864357#66864357", "title": "Pass method argument to function", "body": "<p>I played with this wanting a state machine type component that doesn't use a map[string]func() for containing state methods. My code allows a run method\nwhich is a simple for loop which breaks when pfunc == nil</p>\n<pre><code>type Foo struct {\n    name string\n    idx  int\n}\ntype X func(*Foo) X\n\nfunc (f *Foo) A() X {\n    f.name += fmt.Sprintf(&quot; A[%d]&quot;, f.idx)\n    fmt.Println(f.name)\n    if f.idx &gt; 10 {\n        fmt.Println(&quot;Foo is complete!&quot;)\n        return nil\n    } else {\n        f.idx += 1\n        return (*Foo).B\n    }\n}\nfunc (f *Foo) B() X {\n    f.name += fmt.Sprintf(&quot; B[%d]&quot;, f.idx)\n    fmt.Println(f.name)\n    f.idx += 2\n    return (*Foo).C\n}\nfunc (f *Foo) C() X {\n    f.name += fmt.Sprintf(&quot; C[%d]&quot;, f.idx)\n    fmt.Println(f.name)\n    f.idx += 3\n    return (*Foo).A\n}\n\nfunc main() {\n    bar := &amp;Foo{&quot;Ready!&quot;, 0}\n    pfunc := (*Foo).A\n    except := 1\n    for pfunc != nil &amp;&amp; except &lt; 10 {\n        pfunc = pfunc(bar)\n        except += 1\n    }\n}    \n</code></pre>\n<p>Output:<br/>\nReady! A[0]<br/>\nReady! A[0] B[1]<br/>\nReady! A[0] B[1] C[3]<br/>\nReady! A[0] B[1] C[3] A[6]<br/>\nReady! A[0] B[1] C[3] A[6] B[7]<br/>\nReady! A[0] B[1] C[3] A[6] B[7] C[9]<br/>\nReady! A[0] B[1] C[3] A[6] B[7] C[9] A[12]<br/>\nFoo is complete!</p>\n"}], "owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17430, "favorite_count": 8, "accepted_answer_id": 38897667, "answer_count": 3, "score": 30, "last_activity_date": 1617075482, "creation_date": 1470921466, "last_edit_date": 1588673235, "question_id": 38897529, "link": "https://stackoverflow.com/questions/38897529/pass-method-argument-to-function", "title": "Pass method argument to function", "body": "<p>I'm curious if this is possible in Go. I have a type with multiple methods. Is it possible to have a function which takes a method argument and then call it for the type?</p>\n\n<p>Here is a small example of what I would want:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Foo int\n\nfunc (f Foo) A() {\n    fmt.Println(\"A\")\n}\nfunc (f Foo) B() {\n    fmt.Println(\"B\")\n}\nfunc (f Foo) C() {\n    fmt.Println(\"C\")\n}\n\nfunc main() {\n    var f Foo\n    bar := func(foo func()) {\n        f.foo()\n    }\n    bar(A)\n    bar(B)\n    bar(C)\n}\n</code></pre>\n\n<p>Go thinks type <code>Foo</code> has a method called <code>foo()</code>, rather than replacing it with the passed in method name.</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "edited": false, "score": 2, "creation_date": 1470921741, "post_id": 38896729, "comment_id": 65154089, "body": "Your request is unclear. Please reduce the lines of example, and instead add information about what you tried, and what you expect."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1470921815, "post_id": 38896729, "comment_id": 65154149, "body": "The Tour of Go is a really helpful resource on how to do various things in Go. Why not work through once more?"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "edited": false, "score": 0, "creation_date": 1470970735, "post_id": 38898766, "comment_id": 65176358, "body": "Not exactly but with help of this I could do what i needed.Thanks"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1470925906, "last_edit_date": 1470925906, "creation_date": 1470924662, "answer_id": 38898766, "question_id": 38896729, "link": "https://stackoverflow.com/questions/38896729/i-am-having-trouble-creating-array-of-array-with-a-loop-in-golang/38898766#38898766", "title": "I am having trouble creating array of array with a loop in Golang", "body": "<p>simple array:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>a8 := [8]int{1, 2, 3, 4, 5, 6, 7, 8}\nfmt.Println(a8) // [1 2 3 4 5 6 7 8]\n</code></pre>\n\n<p>Also:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>a8 := [8]int{}\nfmt.Println(a8) // [0 0 0 0 0 0 0 0]\n</code></pre>\n\n<p>This is called array of array:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>b := [64][8]int{}\nfor i, v := range b {\n    for j, _ := range v {\n        b[i][j] = i*100 + j\n    }\n    fmt.Println(b[i])\n}\n</code></pre>\n\n<p>Demonstration working sample Code:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    aa := [64][8]int{}\n    fmt.Println(aa)\n\n    for i, v := range a {\n        for j, w := range v {\n            fmt.Println(\"a[\", i, \"]\", \"[\", j, \"]=\", a[i][j], \"=\", w)\n        }\n    }\n\n    fmt.Println()\n\n    for _, v := range a {\n        fmt.Println(v)\n    }\n}\n\nvar a = [64][8]int{[8]int{11, 0, 0, 0, 18, 0, 0, 0},\n    [8]int{12, 0, 0, 0, 19, 17, 0, 0},\n    [8]int{13, 9, 0, 0, 20, 18, 0, 0},\n    [8]int{14, 10, 0, 0, 21, 19, 0, 0},\n    [8]int{15, 11, 0, 0, 22, 20, 0, 0},\n    [8]int{16, 12, 0, 0, 23, 21, 0, 0},\n    [8]int{0, 13, 0, 0, 24, 22, 0, 0},\n    [8]int{0, 14, 0, 0, 0, 23, 0, 0},\n    [8]int{19, 0, 3, 0, 26, 0, 0, 0},\n    [8]int{20, 0, 4, 0, 27, 25, 0, 0},\n    [8]int{21, 17, 5, 1, 28, 26, 0, 0},\n    [8]int{22, 18, 6, 2, 29, 27, 0, 0},\n    [8]int{23, 19, 7, 3, 30, 28, 0, 0},\n    [8]int{24, 20, 8, 4, 31, 29, 0, 0},\n    [8]int{0, 21, 0, 5, 32, 30, 0, 0},\n    [8]int{0, 22, 0, 6, 0, 31, 0, 0},\n    [8]int{27, 0, 11, 0, 34, 0, 2, 0},\n    [8]int{28, 0, 12, 0, 35, 33, 3, 1},\n    [8]int{29, 25, 13, 9, 36, 34, 4, 2},\n    [8]int{30, 26, 14, 10, 37, 35, 5, 3},\n    [8]int{31, 27, 15, 11, 38, 36, 6, 4},\n    [8]int{32, 28, 16, 12, 39, 37, 7, 5},\n    [8]int{0, 29, 0, 13, 40, 38, 8, 6},\n    [8]int{0, 30, 0, 14, 0, 39, 0, 7},\n    [8]int{35, 0, 19, 0, 42, 0, 10, 0},\n    [8]int{36, 0, 20, 0, 43, 41, 11, 9},\n    [8]int{37, 33, 21, 17, 44, 42, 12, 10},\n    [8]int{38, 34, 22, 18, 45, 43, 13, 11},\n    [8]int{39, 35, 23, 19, 46, 44, 14, 12},\n    [8]int{40, 36, 24, 20, 47, 45, 15, 13},\n    [8]int{0, 37, 0, 21, 48, 46, 16, 14},\n    [8]int{0, 38, 0, 22, 0, 47, 0, 15},\n    [8]int{43, 0, 27, 0, 50, 0, 18, 0},\n    [8]int{44, 0, 28, 0, 51, 49, 19, 17},\n    [8]int{45, 41, 29, 25, 52, 50, 20, 18},\n    [8]int{46, 42, 30, 26, 53, 51, 21, 19},\n    [8]int{47, 43, 31, 27, 54, 52, 22, 20},\n    [8]int{48, 44, 32, 28, 55, 53, 23, 21},\n    [8]int{0, 45, 0, 29, 56, 54, 24, 22},\n    [8]int{0, 46, 0, 30, 0, 55, 0, 23},\n    [8]int{51, 0, 35, 0, 58, 0, 26, 0},\n    [8]int{52, 0, 36, 0, 59, 57, 27, 25},\n    [8]int{53, 49, 37, 33, 60, 58, 28, 26},\n    [8]int{54, 50, 38, 34, 61, 59, 29, 27},\n    [8]int{55, 51, 39, 35, 62, 60, 30, 28},\n    [8]int{56, 52, 40, 36, 63, 61, 31, 29},\n    [8]int{0, 53, 0, 37, 64, 62, 32, 30},\n    [8]int{0, 54, 0, 38, 0, 63, 0, 31},\n    [8]int{59, 0, 43, 0, 0, 0, 34, 0},\n    [8]int{60, 0, 44, 0, 0, 0, 35, 33},\n    [8]int{61, 57, 45, 41, 0, 0, 36, 34},\n    [8]int{62, 58, 46, 42, 0, 0, 37, 35},\n    [8]int{63, 59, 47, 43, 0, 0, 38, 36},\n    [8]int{64, 60, 48, 44, 0, 0, 39, 37},\n    [8]int{0, 61, 0, 45, 0, 0, 40, 38},\n    [8]int{0, 62, 0, 46, 0, 0, 0, 39},\n    [8]int{0, 0, 51, 0, 0, 0, 42, 0},\n    [8]int{0, 0, 52, 0, 0, 0, 43, 41},\n    [8]int{0, 0, 53, 49, 0, 0, 44, 42},\n    [8]int{0, 0, 54, 50, 0, 0, 45, 43},\n    [8]int{0, 0, 55, 51, 0, 0, 46, 44},\n    [8]int{0, 0, 56, 52, 0, 0, 47, 45},\n    [8]int{0, 0, 0, 53, 0, 0, 48, 46},\n    [8]int{0, 0, 0, 54, 0, 0, 0, 47},\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[[0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0]]\na[ 0 ] [ 0 ]= 11 = 11\na[ 0 ] [ 1 ]= 0 = 0\na[ 0 ] [ 2 ]= 0 = 0\na[ 0 ] [ 3 ]= 0 = 0\na[ 0 ] [ 4 ]= 18 = 18\na[ 0 ] [ 5 ]= 0 = 0\na[ 0 ] [ 6 ]= 0 = 0\na[ 0 ] [ 7 ]= 0 = 0\na[ 1 ] [ 0 ]= 12 = 12\na[ 1 ] [ 1 ]= 0 = 0\na[ 1 ] [ 2 ]= 0 = 0\na[ 1 ] [ 3 ]= 0 = 0\na[ 1 ] [ 4 ]= 19 = 19\na[ 1 ] [ 5 ]= 17 = 17\na[ 1 ] [ 6 ]= 0 = 0\na[ 1 ] [ 7 ]= 0 = 0\na[ 2 ] [ 0 ]= 13 = 13\na[ 2 ] [ 1 ]= 9 = 9\na[ 2 ] [ 2 ]= 0 = 0\na[ 2 ] [ 3 ]= 0 = 0\na[ 2 ] [ 4 ]= 20 = 20\na[ 2 ] [ 5 ]= 18 = 18\na[ 2 ] [ 6 ]= 0 = 0\na[ 2 ] [ 7 ]= 0 = 0\na[ 3 ] [ 0 ]= 14 = 14\na[ 3 ] [ 1 ]= 10 = 10\na[ 3 ] [ 2 ]= 0 = 0\na[ 3 ] [ 3 ]= 0 = 0\na[ 3 ] [ 4 ]= 21 = 21\na[ 3 ] [ 5 ]= 19 = 19\na[ 3 ] [ 6 ]= 0 = 0\na[ 3 ] [ 7 ]= 0 = 0\na[ 4 ] [ 0 ]= 15 = 15\na[ 4 ] [ 1 ]= 11 = 11\na[ 4 ] [ 2 ]= 0 = 0\na[ 4 ] [ 3 ]= 0 = 0\na[ 4 ] [ 4 ]= 22 = 22\na[ 4 ] [ 5 ]= 20 = 20\na[ 4 ] [ 6 ]= 0 = 0\na[ 4 ] [ 7 ]= 0 = 0\na[ 5 ] [ 0 ]= 16 = 16\na[ 5 ] [ 1 ]= 12 = 12\na[ 5 ] [ 2 ]= 0 = 0\na[ 5 ] [ 3 ]= 0 = 0\na[ 5 ] [ 4 ]= 23 = 23\na[ 5 ] [ 5 ]= 21 = 21\na[ 5 ] [ 6 ]= 0 = 0\na[ 5 ] [ 7 ]= 0 = 0\na[ 6 ] [ 0 ]= 0 = 0\na[ 6 ] [ 1 ]= 13 = 13\na[ 6 ] [ 2 ]= 0 = 0\na[ 6 ] [ 3 ]= 0 = 0\na[ 6 ] [ 4 ]= 24 = 24\na[ 6 ] [ 5 ]= 22 = 22\na[ 6 ] [ 6 ]= 0 = 0\na[ 6 ] [ 7 ]= 0 = 0\na[ 7 ] [ 0 ]= 0 = 0\na[ 7 ] [ 1 ]= 14 = 14\na[ 7 ] [ 2 ]= 0 = 0\na[ 7 ] [ 3 ]= 0 = 0\na[ 7 ] [ 4 ]= 0 = 0\na[ 7 ] [ 5 ]= 23 = 23\na[ 7 ] [ 6 ]= 0 = 0\na[ 7 ] [ 7 ]= 0 = 0\na[ 8 ] [ 0 ]= 19 = 19\na[ 8 ] [ 1 ]= 0 = 0\na[ 8 ] [ 2 ]= 3 = 3\na[ 8 ] [ 3 ]= 0 = 0\na[ 8 ] [ 4 ]= 26 = 26\na[ 8 ] [ 5 ]= 0 = 0\na[ 8 ] [ 6 ]= 0 = 0\na[ 8 ] [ 7 ]= 0 = 0\na[ 9 ] [ 0 ]= 20 = 20\na[ 9 ] [ 1 ]= 0 = 0\na[ 9 ] [ 2 ]= 4 = 4\na[ 9 ] [ 3 ]= 0 = 0\na[ 9 ] [ 4 ]= 27 = 27\na[ 9 ] [ 5 ]= 25 = 25\na[ 9 ] [ 6 ]= 0 = 0\na[ 9 ] [ 7 ]= 0 = 0\na[ 10 ] [ 0 ]= 21 = 21\na[ 10 ] [ 1 ]= 17 = 17\na[ 10 ] [ 2 ]= 5 = 5\na[ 10 ] [ 3 ]= 1 = 1\na[ 10 ] [ 4 ]= 28 = 28\na[ 10 ] [ 5 ]= 26 = 26\na[ 10 ] [ 6 ]= 0 = 0\na[ 10 ] [ 7 ]= 0 = 0\na[ 11 ] [ 0 ]= 22 = 22\na[ 11 ] [ 1 ]= 18 = 18\na[ 11 ] [ 2 ]= 6 = 6\na[ 11 ] [ 3 ]= 2 = 2\na[ 11 ] [ 4 ]= 29 = 29\na[ 11 ] [ 5 ]= 27 = 27\na[ 11 ] [ 6 ]= 0 = 0\na[ 11 ] [ 7 ]= 0 = 0\na[ 12 ] [ 0 ]= 23 = 23\na[ 12 ] [ 1 ]= 19 = 19\na[ 12 ] [ 2 ]= 7 = 7\na[ 12 ] [ 3 ]= 3 = 3\na[ 12 ] [ 4 ]= 30 = 30\na[ 12 ] [ 5 ]= 28 = 28\na[ 12 ] [ 6 ]= 0 = 0\na[ 12 ] [ 7 ]= 0 = 0\na[ 13 ] [ 0 ]= 24 = 24\na[ 13 ] [ 1 ]= 20 = 20\na[ 13 ] [ 2 ]= 8 = 8\na[ 13 ] [ 3 ]= 4 = 4\na[ 13 ] [ 4 ]= 31 = 31\na[ 13 ] [ 5 ]= 29 = 29\na[ 13 ] [ 6 ]= 0 = 0\na[ 13 ] [ 7 ]= 0 = 0\na[ 14 ] [ 0 ]= 0 = 0\na[ 14 ] [ 1 ]= 21 = 21\na[ 14 ] [ 2 ]= 0 = 0\na[ 14 ] [ 3 ]= 5 = 5\na[ 14 ] [ 4 ]= 32 = 32\na[ 14 ] [ 5 ]= 30 = 30\na[ 14 ] [ 6 ]= 0 = 0\na[ 14 ] [ 7 ]= 0 = 0\na[ 15 ] [ 0 ]= 0 = 0\na[ 15 ] [ 1 ]= 22 = 22\na[ 15 ] [ 2 ]= 0 = 0\na[ 15 ] [ 3 ]= 6 = 6\na[ 15 ] [ 4 ]= 0 = 0\na[ 15 ] [ 5 ]= 31 = 31\na[ 15 ] [ 6 ]= 0 = 0\na[ 15 ] [ 7 ]= 0 = 0\na[ 16 ] [ 0 ]= 27 = 27\na[ 16 ] [ 1 ]= 0 = 0\na[ 16 ] [ 2 ]= 11 = 11\na[ 16 ] [ 3 ]= 0 = 0\na[ 16 ] [ 4 ]= 34 = 34\na[ 16 ] [ 5 ]= 0 = 0\na[ 16 ] [ 6 ]= 2 = 2\na[ 16 ] [ 7 ]= 0 = 0\na[ 17 ] [ 0 ]= 28 = 28\na[ 17 ] [ 1 ]= 0 = 0\na[ 17 ] [ 2 ]= 12 = 12\na[ 17 ] [ 3 ]= 0 = 0\na[ 17 ] [ 4 ]= 35 = 35\na[ 17 ] [ 5 ]= 33 = 33\na[ 17 ] [ 6 ]= 3 = 3\na[ 17 ] [ 7 ]= 1 = 1\na[ 18 ] [ 0 ]= 29 = 29\na[ 18 ] [ 1 ]= 25 = 25\na[ 18 ] [ 2 ]= 13 = 13\na[ 18 ] [ 3 ]= 9 = 9\na[ 18 ] [ 4 ]= 36 = 36\na[ 18 ] [ 5 ]= 34 = 34\na[ 18 ] [ 6 ]= 4 = 4\na[ 18 ] [ 7 ]= 2 = 2\na[ 19 ] [ 0 ]= 30 = 30\na[ 19 ] [ 1 ]= 26 = 26\na[ 19 ] [ 2 ]= 14 = 14\na[ 19 ] [ 3 ]= 10 = 10\na[ 19 ] [ 4 ]= 37 = 37\na[ 19 ] [ 5 ]= 35 = 35\na[ 19 ] [ 6 ]= 5 = 5\na[ 19 ] [ 7 ]= 3 = 3\na[ 20 ] [ 0 ]= 31 = 31\na[ 20 ] [ 1 ]= 27 = 27\na[ 20 ] [ 2 ]= 15 = 15\na[ 20 ] [ 3 ]= 11 = 11\na[ 20 ] [ 4 ]= 38 = 38\na[ 20 ] [ 5 ]= 36 = 36\na[ 20 ] [ 6 ]= 6 = 6\na[ 20 ] [ 7 ]= 4 = 4\na[ 21 ] [ 0 ]= 32 = 32\na[ 21 ] [ 1 ]= 28 = 28\na[ 21 ] [ 2 ]= 16 = 16\na[ 21 ] [ 3 ]= 12 = 12\na[ 21 ] [ 4 ]= 39 = 39\na[ 21 ] [ 5 ]= 37 = 37\na[ 21 ] [ 6 ]= 7 = 7\na[ 21 ] [ 7 ]= 5 = 5\na[ 22 ] [ 0 ]= 0 = 0\na[ 22 ] [ 1 ]= 29 = 29\na[ 22 ] [ 2 ]= 0 = 0\na[ 22 ] [ 3 ]= 13 = 13\na[ 22 ] [ 4 ]= 40 = 40\na[ 22 ] [ 5 ]= 38 = 38\na[ 22 ] [ 6 ]= 8 = 8\na[ 22 ] [ 7 ]= 6 = 6\na[ 23 ] [ 0 ]= 0 = 0\na[ 23 ] [ 1 ]= 30 = 30\na[ 23 ] [ 2 ]= 0 = 0\na[ 23 ] [ 3 ]= 14 = 14\na[ 23 ] [ 4 ]= 0 = 0\na[ 23 ] [ 5 ]= 39 = 39\na[ 23 ] [ 6 ]= 0 = 0\na[ 23 ] [ 7 ]= 7 = 7\na[ 24 ] [ 0 ]= 35 = 35\na[ 24 ] [ 1 ]= 0 = 0\na[ 24 ] [ 2 ]= 19 = 19\na[ 24 ] [ 3 ]= 0 = 0\na[ 24 ] [ 4 ]= 42 = 42\na[ 24 ] [ 5 ]= 0 = 0\na[ 24 ] [ 6 ]= 10 = 10\na[ 24 ] [ 7 ]= 0 = 0\na[ 25 ] [ 0 ]= 36 = 36\na[ 25 ] [ 1 ]= 0 = 0\na[ 25 ] [ 2 ]= 20 = 20\na[ 25 ] [ 3 ]= 0 = 0\na[ 25 ] [ 4 ]= 43 = 43\na[ 25 ] [ 5 ]= 41 = 41\na[ 25 ] [ 6 ]= 11 = 11\na[ 25 ] [ 7 ]= 9 = 9\na[ 26 ] [ 0 ]= 37 = 37\na[ 26 ] [ 1 ]= 33 = 33\na[ 26 ] [ 2 ]= 21 = 21\na[ 26 ] [ 3 ]= 17 = 17\na[ 26 ] [ 4 ]= 44 = 44\na[ 26 ] [ 5 ]= 42 = 42\na[ 26 ] [ 6 ]= 12 = 12\na[ 26 ] [ 7 ]= 10 = 10\na[ 27 ] [ 0 ]= 38 = 38\na[ 27 ] [ 1 ]= 34 = 34\na[ 27 ] [ 2 ]= 22 = 22\na[ 27 ] [ 3 ]= 18 = 18\na[ 27 ] [ 4 ]= 45 = 45\na[ 27 ] [ 5 ]= 43 = 43\na[ 27 ] [ 6 ]= 13 = 13\na[ 27 ] [ 7 ]= 11 = 11\na[ 28 ] [ 0 ]= 39 = 39\na[ 28 ] [ 1 ]= 35 = 35\na[ 28 ] [ 2 ]= 23 = 23\na[ 28 ] [ 3 ]= 19 = 19\na[ 28 ] [ 4 ]= 46 = 46\na[ 28 ] [ 5 ]= 44 = 44\na[ 28 ] [ 6 ]= 14 = 14\na[ 28 ] [ 7 ]= 12 = 12\na[ 29 ] [ 0 ]= 40 = 40\na[ 29 ] [ 1 ]= 36 = 36\na[ 29 ] [ 2 ]= 24 = 24\na[ 29 ] [ 3 ]= 20 = 20\na[ 29 ] [ 4 ]= 47 = 47\na[ 29 ] [ 5 ]= 45 = 45\na[ 29 ] [ 6 ]= 15 = 15\na[ 29 ] [ 7 ]= 13 = 13\na[ 30 ] [ 0 ]= 0 = 0\na[ 30 ] [ 1 ]= 37 = 37\na[ 30 ] [ 2 ]= 0 = 0\na[ 30 ] [ 3 ]= 21 = 21\na[ 30 ] [ 4 ]= 48 = 48\na[ 30 ] [ 5 ]= 46 = 46\na[ 30 ] [ 6 ]= 16 = 16\na[ 30 ] [ 7 ]= 14 = 14\na[ 31 ] [ 0 ]= 0 = 0\na[ 31 ] [ 1 ]= 38 = 38\na[ 31 ] [ 2 ]= 0 = 0\na[ 31 ] [ 3 ]= 22 = 22\na[ 31 ] [ 4 ]= 0 = 0\na[ 31 ] [ 5 ]= 47 = 47\na[ 31 ] [ 6 ]= 0 = 0\na[ 31 ] [ 7 ]= 15 = 15\na[ 32 ] [ 0 ]= 43 = 43\na[ 32 ] [ 1 ]= 0 = 0\na[ 32 ] [ 2 ]= 27 = 27\na[ 32 ] [ 3 ]= 0 = 0\na[ 32 ] [ 4 ]= 50 = 50\na[ 32 ] [ 5 ]= 0 = 0\na[ 32 ] [ 6 ]= 18 = 18\na[ 32 ] [ 7 ]= 0 = 0\na[ 33 ] [ 0 ]= 44 = 44\na[ 33 ] [ 1 ]= 0 = 0\na[ 33 ] [ 2 ]= 28 = 28\na[ 33 ] [ 3 ]= 0 = 0\na[ 33 ] [ 4 ]= 51 = 51\na[ 33 ] [ 5 ]= 49 = 49\na[ 33 ] [ 6 ]= 19 = 19\na[ 33 ] [ 7 ]= 17 = 17\na[ 34 ] [ 0 ]= 45 = 45\na[ 34 ] [ 1 ]= 41 = 41\na[ 34 ] [ 2 ]= 29 = 29\na[ 34 ] [ 3 ]= 25 = 25\na[ 34 ] [ 4 ]= 52 = 52\na[ 34 ] [ 5 ]= 50 = 50\na[ 34 ] [ 6 ]= 20 = 20\na[ 34 ] [ 7 ]= 18 = 18\na[ 35 ] [ 0 ]= 46 = 46\na[ 35 ] [ 1 ]= 42 = 42\na[ 35 ] [ 2 ]= 30 = 30\na[ 35 ] [ 3 ]= 26 = 26\na[ 35 ] [ 4 ]= 53 = 53\na[ 35 ] [ 5 ]= 51 = 51\na[ 35 ] [ 6 ]= 21 = 21\na[ 35 ] [ 7 ]= 19 = 19\na[ 36 ] [ 0 ]= 47 = 47\na[ 36 ] [ 1 ]= 43 = 43\na[ 36 ] [ 2 ]= 31 = 31\na[ 36 ] [ 3 ]= 27 = 27\na[ 36 ] [ 4 ]= 54 = 54\na[ 36 ] [ 5 ]= 52 = 52\na[ 36 ] [ 6 ]= 22 = 22\na[ 36 ] [ 7 ]= 20 = 20\na[ 37 ] [ 0 ]= 48 = 48\na[ 37 ] [ 1 ]= 44 = 44\na[ 37 ] [ 2 ]= 32 = 32\na[ 37 ] [ 3 ]= 28 = 28\na[ 37 ] [ 4 ]= 55 = 55\na[ 37 ] [ 5 ]= 53 = 53\na[ 37 ] [ 6 ]= 23 = 23\na[ 37 ] [ 7 ]= 21 = 21\na[ 38 ] [ 0 ]= 0 = 0\na[ 38 ] [ 1 ]= 45 = 45\na[ 38 ] [ 2 ]= 0 = 0\na[ 38 ] [ 3 ]= 29 = 29\na[ 38 ] [ 4 ]= 56 = 56\na[ 38 ] [ 5 ]= 54 = 54\na[ 38 ] [ 6 ]= 24 = 24\na[ 38 ] [ 7 ]= 22 = 22\na[ 39 ] [ 0 ]= 0 = 0\na[ 39 ] [ 1 ]= 46 = 46\na[ 39 ] [ 2 ]= 0 = 0\na[ 39 ] [ 3 ]= 30 = 30\na[ 39 ] [ 4 ]= 0 = 0\na[ 39 ] [ 5 ]= 55 = 55\na[ 39 ] [ 6 ]= 0 = 0\na[ 39 ] [ 7 ]= 23 = 23\na[ 40 ] [ 0 ]= 51 = 51\na[ 40 ] [ 1 ]= 0 = 0\na[ 40 ] [ 2 ]= 35 = 35\na[ 40 ] [ 3 ]= 0 = 0\na[ 40 ] [ 4 ]= 58 = 58\na[ 40 ] [ 5 ]= 0 = 0\na[ 40 ] [ 6 ]= 26 = 26\na[ 40 ] [ 7 ]= 0 = 0\na[ 41 ] [ 0 ]= 52 = 52\na[ 41 ] [ 1 ]= 0 = 0\na[ 41 ] [ 2 ]= 36 = 36\na[ 41 ] [ 3 ]= 0 = 0\na[ 41 ] [ 4 ]= 59 = 59\na[ 41 ] [ 5 ]= 57 = 57\na[ 41 ] [ 6 ]= 27 = 27\na[ 41 ] [ 7 ]= 25 = 25\na[ 42 ] [ 0 ]= 53 = 53\na[ 42 ] [ 1 ]= 49 = 49\na[ 42 ] [ 2 ]= 37 = 37\na[ 42 ] [ 3 ]= 33 = 33\na[ 42 ] [ 4 ]= 60 = 60\na[ 42 ] [ 5 ]= 58 = 58\na[ 42 ] [ 6 ]= 28 = 28\na[ 42 ] [ 7 ]= 26 = 26\na[ 43 ] [ 0 ]= 54 = 54\na[ 43 ] [ 1 ]= 50 = 50\na[ 43 ] [ 2 ]= 38 = 38\na[ 43 ] [ 3 ]= 34 = 34\na[ 43 ] [ 4 ]= 61 = 61\na[ 43 ] [ 5 ]= 59 = 59\na[ 43 ] [ 6 ]= 29 = 29\na[ 43 ] [ 7 ]= 27 = 27\na[ 44 ] [ 0 ]= 55 = 55\na[ 44 ] [ 1 ]= 51 = 51\na[ 44 ] [ 2 ]= 39 = 39\na[ 44 ] [ 3 ]= 35 = 35\na[ 44 ] [ 4 ]= 62 = 62\na[ 44 ] [ 5 ]= 60 = 60\na[ 44 ] [ 6 ]= 30 = 30\na[ 44 ] [ 7 ]= 28 = 28\na[ 45 ] [ 0 ]= 56 = 56\na[ 45 ] [ 1 ]= 52 = 52\na[ 45 ] [ 2 ]= 40 = 40\na[ 45 ] [ 3 ]= 36 = 36\na[ 45 ] [ 4 ]= 63 = 63\na[ 45 ] [ 5 ]= 61 = 61\na[ 45 ] [ 6 ]= 31 = 31\na[ 45 ] [ 7 ]= 29 = 29\na[ 46 ] [ 0 ]= 0 = 0\na[ 46 ] [ 1 ]= 53 = 53\na[ 46 ] [ 2 ]= 0 = 0\na[ 46 ] [ 3 ]= 37 = 37\na[ 46 ] [ 4 ]= 64 = 64\na[ 46 ] [ 5 ]= 62 = 62\na[ 46 ] [ 6 ]= 32 = 32\na[ 46 ] [ 7 ]= 30 = 30\na[ 47 ] [ 0 ]= 0 = 0\na[ 47 ] [ 1 ]= 54 = 54\na[ 47 ] [ 2 ]= 0 = 0\na[ 47 ] [ 3 ]= 38 = 38\na[ 47 ] [ 4 ]= 0 = 0\na[ 47 ] [ 5 ]= 63 = 63\na[ 47 ] [ 6 ]= 0 = 0\na[ 47 ] [ 7 ]= 31 = 31\na[ 48 ] [ 0 ]= 59 = 59\na[ 48 ] [ 1 ]= 0 = 0\na[ 48 ] [ 2 ]= 43 = 43\na[ 48 ] [ 3 ]= 0 = 0\na[ 48 ] [ 4 ]= 0 = 0\na[ 48 ] [ 5 ]= 0 = 0\na[ 48 ] [ 6 ]= 34 = 34\na[ 48 ] [ 7 ]= 0 = 0\na[ 49 ] [ 0 ]= 60 = 60\na[ 49 ] [ 1 ]= 0 = 0\na[ 49 ] [ 2 ]= 44 = 44\na[ 49 ] [ 3 ]= 0 = 0\na[ 49 ] [ 4 ]= 0 = 0\na[ 49 ] [ 5 ]= 0 = 0\na[ 49 ] [ 6 ]= 35 = 35\na[ 49 ] [ 7 ]= 33 = 33\na[ 50 ] [ 0 ]= 61 = 61\na[ 50 ] [ 1 ]= 57 = 57\na[ 50 ] [ 2 ]= 45 = 45\na[ 50 ] [ 3 ]= 41 = 41\na[ 50 ] [ 4 ]= 0 = 0\na[ 50 ] [ 5 ]= 0 = 0\na[ 50 ] [ 6 ]= 36 = 36\na[ 50 ] [ 7 ]= 34 = 34\na[ 51 ] [ 0 ]= 62 = 62\na[ 51 ] [ 1 ]= 58 = 58\na[ 51 ] [ 2 ]= 46 = 46\na[ 51 ] [ 3 ]= 42 = 42\na[ 51 ] [ 4 ]= 0 = 0\na[ 51 ] [ 5 ]= 0 = 0\na[ 51 ] [ 6 ]= 37 = 37\na[ 51 ] [ 7 ]= 35 = 35\na[ 52 ] [ 0 ]= 63 = 63\na[ 52 ] [ 1 ]= 59 = 59\na[ 52 ] [ 2 ]= 47 = 47\na[ 52 ] [ 3 ]= 43 = 43\na[ 52 ] [ 4 ]= 0 = 0\na[ 52 ] [ 5 ]= 0 = 0\na[ 52 ] [ 6 ]= 38 = 38\na[ 52 ] [ 7 ]= 36 = 36\na[ 53 ] [ 0 ]= 64 = 64\na[ 53 ] [ 1 ]= 60 = 60\na[ 53 ] [ 2 ]= 48 = 48\na[ 53 ] [ 3 ]= 44 = 44\na[ 53 ] [ 4 ]= 0 = 0\na[ 53 ] [ 5 ]= 0 = 0\na[ 53 ] [ 6 ]= 39 = 39\na[ 53 ] [ 7 ]= 37 = 37\na[ 54 ] [ 0 ]= 0 = 0\na[ 54 ] [ 1 ]= 61 = 61\na[ 54 ] [ 2 ]= 0 = 0\na[ 54 ] [ 3 ]= 45 = 45\na[ 54 ] [ 4 ]= 0 = 0\na[ 54 ] [ 5 ]= 0 = 0\na[ 54 ] [ 6 ]= 40 = 40\na[ 54 ] [ 7 ]= 38 = 38\na[ 55 ] [ 0 ]= 0 = 0\na[ 55 ] [ 1 ]= 62 = 62\na[ 55 ] [ 2 ]= 0 = 0\na[ 55 ] [ 3 ]= 46 = 46\na[ 55 ] [ 4 ]= 0 = 0\na[ 55 ] [ 5 ]= 0 = 0\na[ 55 ] [ 6 ]= 0 = 0\na[ 55 ] [ 7 ]= 39 = 39\na[ 56 ] [ 0 ]= 0 = 0\na[ 56 ] [ 1 ]= 0 = 0\na[ 56 ] [ 2 ]= 51 = 51\na[ 56 ] [ 3 ]= 0 = 0\na[ 56 ] [ 4 ]= 0 = 0\na[ 56 ] [ 5 ]= 0 = 0\na[ 56 ] [ 6 ]= 42 = 42\na[ 56 ] [ 7 ]= 0 = 0\na[ 57 ] [ 0 ]= 0 = 0\na[ 57 ] [ 1 ]= 0 = 0\na[ 57 ] [ 2 ]= 52 = 52\na[ 57 ] [ 3 ]= 0 = 0\na[ 57 ] [ 4 ]= 0 = 0\na[ 57 ] [ 5 ]= 0 = 0\na[ 57 ] [ 6 ]= 43 = 43\na[ 57 ] [ 7 ]= 41 = 41\na[ 58 ] [ 0 ]= 0 = 0\na[ 58 ] [ 1 ]= 0 = 0\na[ 58 ] [ 2 ]= 53 = 53\na[ 58 ] [ 3 ]= 49 = 49\na[ 58 ] [ 4 ]= 0 = 0\na[ 58 ] [ 5 ]= 0 = 0\na[ 58 ] [ 6 ]= 44 = 44\na[ 58 ] [ 7 ]= 42 = 42\na[ 59 ] [ 0 ]= 0 = 0\na[ 59 ] [ 1 ]= 0 = 0\na[ 59 ] [ 2 ]= 54 = 54\na[ 59 ] [ 3 ]= 50 = 50\na[ 59 ] [ 4 ]= 0 = 0\na[ 59 ] [ 5 ]= 0 = 0\na[ 59 ] [ 6 ]= 45 = 45\na[ 59 ] [ 7 ]= 43 = 43\na[ 60 ] [ 0 ]= 0 = 0\na[ 60 ] [ 1 ]= 0 = 0\na[ 60 ] [ 2 ]= 55 = 55\na[ 60 ] [ 3 ]= 51 = 51\na[ 60 ] [ 4 ]= 0 = 0\na[ 60 ] [ 5 ]= 0 = 0\na[ 60 ] [ 6 ]= 46 = 46\na[ 60 ] [ 7 ]= 44 = 44\na[ 61 ] [ 0 ]= 0 = 0\na[ 61 ] [ 1 ]= 0 = 0\na[ 61 ] [ 2 ]= 56 = 56\na[ 61 ] [ 3 ]= 52 = 52\na[ 61 ] [ 4 ]= 0 = 0\na[ 61 ] [ 5 ]= 0 = 0\na[ 61 ] [ 6 ]= 47 = 47\na[ 61 ] [ 7 ]= 45 = 45\na[ 62 ] [ 0 ]= 0 = 0\na[ 62 ] [ 1 ]= 0 = 0\na[ 62 ] [ 2 ]= 0 = 0\na[ 62 ] [ 3 ]= 53 = 53\na[ 62 ] [ 4 ]= 0 = 0\na[ 62 ] [ 5 ]= 0 = 0\na[ 62 ] [ 6 ]= 48 = 48\na[ 62 ] [ 7 ]= 46 = 46\na[ 63 ] [ 0 ]= 0 = 0\na[ 63 ] [ 1 ]= 0 = 0\na[ 63 ] [ 2 ]= 0 = 0\na[ 63 ] [ 3 ]= 54 = 54\na[ 63 ] [ 4 ]= 0 = 0\na[ 63 ] [ 5 ]= 0 = 0\na[ 63 ] [ 6 ]= 0 = 0\na[ 63 ] [ 7 ]= 47 = 47\n\n[11 0 0 0 18 0 0 0]\n[12 0 0 0 19 17 0 0]\n[13 9 0 0 20 18 0 0]\n[14 10 0 0 21 19 0 0]\n[15 11 0 0 22 20 0 0]\n[16 12 0 0 23 21 0 0]\n[0 13 0 0 24 22 0 0]\n[0 14 0 0 0 23 0 0]\n[19 0 3 0 26 0 0 0]\n[20 0 4 0 27 25 0 0]\n[21 17 5 1 28 26 0 0]\n[22 18 6 2 29 27 0 0]\n[23 19 7 3 30 28 0 0]\n[24 20 8 4 31 29 0 0]\n[0 21 0 5 32 30 0 0]\n[0 22 0 6 0 31 0 0]\n[27 0 11 0 34 0 2 0]\n[28 0 12 0 35 33 3 1]\n[29 25 13 9 36 34 4 2]\n[30 26 14 10 37 35 5 3]\n[31 27 15 11 38 36 6 4]\n[32 28 16 12 39 37 7 5]\n[0 29 0 13 40 38 8 6]\n[0 30 0 14 0 39 0 7]\n[35 0 19 0 42 0 10 0]\n[36 0 20 0 43 41 11 9]\n[37 33 21 17 44 42 12 10]\n[38 34 22 18 45 43 13 11]\n[39 35 23 19 46 44 14 12]\n[40 36 24 20 47 45 15 13]\n[0 37 0 21 48 46 16 14]\n[0 38 0 22 0 47 0 15]\n[43 0 27 0 50 0 18 0]\n[44 0 28 0 51 49 19 17]\n[45 41 29 25 52 50 20 18]\n[46 42 30 26 53 51 21 19]\n[47 43 31 27 54 52 22 20]\n[48 44 32 28 55 53 23 21]\n[0 45 0 29 56 54 24 22]\n[0 46 0 30 0 55 0 23]\n[51 0 35 0 58 0 26 0]\n[52 0 36 0 59 57 27 25]\n[53 49 37 33 60 58 28 26]\n[54 50 38 34 61 59 29 27]\n[55 51 39 35 62 60 30 28]\n[56 52 40 36 63 61 31 29]\n[0 53 0 37 64 62 32 30]\n[0 54 0 38 0 63 0 31]\n[59 0 43 0 0 0 34 0]\n[60 0 44 0 0 0 35 33]\n[61 57 45 41 0 0 36 34]\n[62 58 46 42 0 0 37 35]\n[63 59 47 43 0 0 38 36]\n[64 60 48 44 0 0 39 37]\n[0 61 0 45 0 0 40 38]\n[0 62 0 46 0 0 0 39]\n[0 0 51 0 0 0 42 0]\n[0 0 52 0 0 0 43 41]\n[0 0 53 49 0 0 44 42]\n[0 0 54 50 0 0 45 43]\n[0 0 55 51 0 0 46 44]\n[0 0 56 52 0 0 47 45]\n[0 0 0 53 0 0 48 46]\n[0 0 0 54 0 0 0 47]\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 38898766, "answer_count": 1, "score": 0, "last_activity_date": 1470925961, "creation_date": 1470919355, "last_edit_date": 1470925961, "question_id": 38896729, "link": "https://stackoverflow.com/questions/38896729/i-am-having-trouble-creating-array-of-array-with-a-loop-in-golang", "title": "I am having trouble creating array of array with a loop in Golang", "body": "<p>What I am trying to do is create a set of arrays.<br>\nI need to get a set of 64 arrays which are mentioned below.<br>\nSo that I should be able to access each array individually.<br>\nI have seen a way to create multiple arrays in a loop in java but not in Go.<br>\nI don't want to hard-code  it as I have a function which generates these arrays for different arguments.</p>\n\n<pre><code>[11 0 0 0 18 0 0 0]  \n[12 0 0 0 19 17 0 0]\n[13 9 0 0 20 18 0 0]\n[14 10 0 0 21 19 0 0]\n[15 11 0 0 22 20 0 0]\n[16 12 0 0 23 21 0 0]\n[0 13 0 0 24 22 0 0]\n[0 14 0 0 0 23 0 0]\n[19 0 3 0 26 0 0 0]\n[20 0 4 0 27 25 0 0]\n[21 17 5 1 28 26 0 0]\n[22 18 6 2 29 27 0 0]\n[23 19 7 3 30 28 0 0]\n[24 20 8 4 31 29 0 0]\n[0 21 0 5 32 30 0 0]\n[0 22 0 6 0 31 0 0]\n[27 0 11 0 34 0 2 0]\n[28 0 12 0 35 33 3 1]\n[29 25 13 9 36 34 4 2]\n[30 26 14 10 37 35 5 3]\n[31 27 15 11 38 36 6 4]\n[32 28 16 12 39 37 7 5]\n[0 29 0 13 40 38 8 6]\n[0 30 0 14 0 39 0 7]\n[35 0 19 0 42 0 10 0]\n[36 0 20 0 43 41 11 9]\n[37 33 21 17 44 42 12 10]\n[38 34 22 18 45 43 13 11]\n[39 35 23 19 46 44 14 12]\n[40 36 24 20 47 45 15 13]\n[0 37 0 21 48 46 16 14]\n[0 38 0 22 0 47 0 15]\n[43 0 27 0 50 0 18 0]\n[44 0 28 0 51 49 19 17]\n[45 41 29 25 52 50 20 18]\n[46 42 30 26 53 51 21 19]\n[47 43 31 27 54 52 22 20]\n[48 44 32 28 55 53 23 21]\n[0 45 0 29 56 54 24 22]\n[0 46 0 30 0 55 0 23]\n[51 0 35 0 58 0 26 0]\n[52 0 36 0 59 57 27 25]\n[53 49 37 33 60 58 28 26]\n[54 50 38 34 61 59 29 27]\n[55 51 39 35 62 60 30 28]\n[56 52 40 36 63 61 31 29]\n[0 53 0 37 64 62 32 30]\n[0 54 0 38 0 63 0 31]\n[59 0 43 0 0 0 34 0]\n[60 0 44 0 0 0 35 33]\n[61 57 45 41 0 0 36 34]\n[62 58 46 42 0 0 37 35]\n[63 59 47 43 0 0 38 36]\n[64 60 48 44 0 0 39 37]\n[0 61 0 45 0 0 40 38]\n[0 62 0 46 0 0 0 39]\n[0 0 51 0 0 0 42 0]\n[0 0 52 0 0 0 43 41]\n[0 0 53 49 0 0 44 42]\n[0 0 54 50 0 0 45 43]\n[0 0 55 51 0 0 46 44]\n[0 0 56 52 0 0 47 45]\n[0 0 0 53 0 0 48 46]\n[0 0 0 54 0 0 0 47]\n</code></pre>\n"}, {"tags": ["go", "lang"], "owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1470913057, "creation_date": 1470913057, "question_id": 38894451, "link": "https://stackoverflow.com/questions/38894451/push-data-from-golang-to-opentstb", "title": "Push data from Golang to OpenTSTB", "body": "<p>I have stored the last one hour data into file. So I've to upload the previous data to openTSTB.</p>\n\n<p>So, the code is as follows:</p>\n\n<pre><code>go func() {\n        file, err := os.Open(\"/var/lib/agent/agent.db\")\n\n        if err != nil {\n            fmt.Println(err, \"Err\")\n        }\n\n        scanner := bufio.NewScanner(file)\n\n        for scanner.Scan() {\n            arr := []byte(scanner.Text())\n            url := \"http://192.168.2.40:4242/api/put\"\n            req, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(arr))\n            req.Header.Set(\"Content-Type\", \"\")\n            client := &amp;http.Client{}\n            resp, err := client.Do(req)\n            if err != nil {\n                panic(err)\n            }\n            defer resp.Body.Close()\n\n        }\n    }()\n</code></pre>\n\n<p>The above code pushes the last one hour data to openTSTB.</p>\n\n<p>Current data is also pushed to openTSTB using another GoRoutine.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>// Regular run\ngo func() {\n    timeStamp, _ := strconv.ParseInt(strconv.FormatInt(time.Now().UnixNano()/1e9, 10), 10, 64)\n    err := opentsdb.Put(\n        MetricName,\n        4,\n        timeStamp,\n        opentsdb.Tag{\"host\", hostname},\n    )\n}()\n</code></pre>\n\n<p>The problem is if last record is 4, my previous record has been uploaded with the old data [Ex: 4+4].</p>\n\n<p>If I run single GoRoutine, it is working correctly. If I go with old and current data, the result is wrong.</p>\n\n<p>How to fix this? Any help is greatly appreciated. Thanks in advance.</p>\n"}, {"tags": ["mongodb", "go", "mongodb-query", "mgo"], "comments": [{"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 3, "creation_date": 1470908721, "post_id": 38892436, "comment_id": 65145122, "body": "<code>&quot;$center&quot;: interface[]{interface[]{-73.94075,40.789138}, 5000}</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1470924234, "creation_date": 1470924234, "answer_id": 38898596, "question_id": 38892436, "link": "https://stackoverflow.com/questions/38892436/query-with-an-array-as-parameter-how-to-convert-to-golang-mgo/38898596#38898596", "title": "Query with an array as parameter, how to convert to GoLang mgo?", "body": "<p>Use this:</p>\n\n<pre><code>\"$center\": []interface{}{j.Location.Coordinates, 5000}\n</code></pre>\n\n<p>This line is probably an error:</p>\n\n<pre><code> time.Now().Unix() * 1000\n</code></pre>\n\n<p>Did you want <code>+ 1000</code>?</p>\n"}], "owner": {"reputation": 1542, "user_id": 443136, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/96f1ca62e16935890751ea3b4d7d84c8?s=128&d=identicon&r=PG", "display_name": "Valerio Santinelli", "link": "https://stackoverflow.com/users/443136/valerio-santinelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 38898596, "answer_count": 1, "score": 0, "last_activity_date": 1470924234, "creation_date": 1470907741, "last_edit_date": 1470908480, "question_id": 38892436, "link": "https://stackoverflow.com/questions/38892436/query-with-an-array-as-parameter-how-to-convert-to-golang-mgo", "title": "Query with an array as parameter, how to convert to GoLang mgo?", "body": "<p>I have the following query:</p>\n\n<pre><code>db.getCollection('spawnlocations').find({\n    'location': {\n        '$geoWithin': {\n            '$center': [[-73.94075, 40.789138], 5000]\n        }\n    }, \n    \"expirationtimems\": { \"$gte\": 1234567890 }, \n    \"_id\": { \"$gte\": \"2a920240836c40d8b374203a798a27fa.16\" }\n}).sort({\"_id\":1}).limit(50)\n</code></pre>\n\n<p>I am trying to convert the query to mgo using <code>bson.M</code> but I'm having a hard time with the array part of it. </p>\n\n<p>I thought this would work, but of course it doesn't</p>\n\n<pre><code>    q = bson.M{\n        \"location\": bson.M{\n            \"$geoWithin\": bson.M{\n                \"$center\": [\n                    j.Location.Coordinates,\n                    5000\n                ],\n            },\n        },\n        \"expirationtimems\": bson.M{\n            \"$gte\": time.Now().Unix() * 1000,\n        },\n        \"_id\": bson.M{\n            \"$gt\": p,\n        },\n    }\n</code></pre>\n"}, {"tags": ["string", "go", "char", "int", "chess"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1470909362, "last_edit_date": 1470909362, "creation_date": 1470907791, "answer_id": 38892450, "question_id": 38892197, "link": "https://stackoverflow.com/questions/38892197/how-to-convert-a-number-to-string-of-the-form-1-a1-2-a2-9-b1-64-h8-i/38892450#38892450", "title": "How to convert a number to string, of the form 1=A1, 2=A2, ... 9=B1, ... 64=H8 in Golang?", "body": "<p>Firstly, you're dividing by the wrong number. If you want the numbers only up to 8, you need to divide by 8.</p>\n\n<p>Secondly, you don't need to subtract one in the second string, but you do need to decrease the <code>n</code>.</p>\n\n<pre><code>func ToString(n int8) string {\n    n--\n    return string((n/8)+65) + string((n%8)+49)\n}\n\nfunc main() {\n    var i int8\n    for i = 1; i &lt;= 64; i++ {\n        fmt.Println(ToString(i))\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BdAce3C5JL\" rel=\"nofollow\">https://play.golang.org/p/BdAce3C5JL</a></p>\n"}, {"comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1470912073, "post_id": 38893496, "comment_id": 65147370, "body": "I keep being amazed by the thoroughness and the effort you put into your answers. You should write a book."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1470914830, "post_id": 38893496, "comment_id": 65149138, "body": "@Ainar-G And what would be its title?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1470926747, "post_id": 38893496, "comment_id": 65157922, "body": "If it&#39;s a tutorial book, &quot;Gopher&#39;s First Go&quot; sounds nice."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1471703941, "last_edit_date": 1471703941, "creation_date": 1470910492, "answer_id": 38893496, "question_id": 38892197, "link": "https://stackoverflow.com/questions/38892197/how-to-convert-a-number-to-string-of-the-form-1-a1-2-a2-9-b1-64-h8-i/38893496#38893496", "title": "How to convert a number to string, of the form 1=A1, 2=A2, ... 9=B1, ... 64=H8 in Golang?", "body": "<p>Let's see different approaches and performance improvements.</p>\n\n<p>All the solutions and the benchmarking code can be found on the <a href=\"https://play.golang.org/p/UGXfua171n\" rel=\"nofollow\">Go Playground</a>. The code on the Playground is a test file, not an executable. You have to save it into a file named <code>XX_test.go</code> and run it with <code>go test -bench .</code>.</p>\n\n<h3>String concatenation</h3>\n\n<p>Ainar-G's answer is cool (+1):</p>\n\n<pre><code>func ToStringConcat(n byte) string {\n    n--\n    return string((n/8)+65) + string((n%8)+49)\n}\n</code></pre>\n\n<h3>Byte slice</h3>\n\n<p>But note that the previous solution concatenates 2 <code>string</code> values which is \"costly\" especially if we want to call this <code>ToString()</code> many times.</p>\n\n<p><sup>One might think that we could spare the <code>string</code> concatenation if we would try to convert a single integer number containing the 2 codes (the first shifted left by 8 bits), but that wouldn't work as converting integer numbers to <code>string</code> results in a <code>string</code> value with a single <code>rune</code> (a <code>string</code> containing the UTF-8 representation of the integer).</sup></p>\n\n<p>But we may use a <code>[]byte</code> with 2 values (the letter code and the digit code), and then we only need to <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">convert</a> this single slice value to <code>string</code>:</p>\n\n<pre><code>func ToStringSlice(n byte) string {\n    n--\n    return string([]byte{(n / 8) + 65, (n % 8) + 49})\n}\n</code></pre>\n\n<h3>String constant and slicing</h3>\n\n<p><code>string</code> values are <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow\">slicable</a> in Go which results in a new <code>string</code> (new <code>string</code> header). So we may use a <code>string</code> constant of all the values, and do a simple slicing to get the part we need:</p>\n\n<pre><code>const values = \"  A1A2A3A4A5A6A7A8B1B2B3B4B5B6B7B8C1C2C3C4C5C6C7C8D1D2D3D4D5D6D7D8E1E2E3E4E5E6E7E8F1F2F3F4F5F6F7F8G1G2G3G4G5G6G7G8H1H2H3H4H5H6H7H8\"\n\nfunc ToStringConst(n byte) string {\n    n *= 2\n    return values[n : n+2]\n}\n</code></pre>\n\n<h3>Dictionary</h3>\n\n<p>Even though slicing a <code>string</code> results in a substring which shares the underlying array, it sill needs to create a new <code>string</code> header.</p>\n\n<p>Since we don't have a lot of possible values, best (fastest) solution is to prepare all the possible values, and just do a simple lookup. Since input is a number, we don't even need a <code>map</code>, we can use a simple <code>[]string</code> slice:</p>\n\n<pre><code>var dict = []string{\"\",\n    \"A1\", \"A2\", \"A3\", \"A4\", \"A5\", \"A6\", \"A7\", \"A8\",\n    \"B1\", \"B2\", \"B3\", \"B4\", \"B5\", \"B6\", \"B7\", \"B8\",\n    \"C1\", \"C2\", \"C3\", \"C4\", \"C5\", \"C6\", \"C7\", \"C8\",\n    \"D1\", \"D2\", \"D3\", \"D4\", \"D5\", \"D6\", \"D7\", \"D8\",\n    \"E1\", \"E2\", \"E3\", \"E4\", \"E5\", \"E6\", \"E7\", \"E8\",\n    \"F1\", \"F2\", \"F3\", \"F4\", \"F5\", \"F6\", \"F7\", \"F8\",\n    \"G1\", \"G2\", \"G3\", \"G4\", \"G5\", \"G6\", \"G7\", \"G8\",\n    \"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\", \"H7\", \"H8\",\n}\n\nfunc ToStringDict(n byte) string {\n    return dict[n]\n}\n</code></pre>\n\n<h2>Speed analysis (benchmark)</h2>\n\n<p>Let's benchmark speed of the above solutions:</p>\n\n<pre><code>func BenchmarkConcat(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { ToStringConcat(1) }\n}\n\nfunc BenchmarkSlice(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { ToStringSlice(1) }\n}\n\nfunc BenchmarkConst(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { ToStringConst(1) }\n}\n\nfunc BenchmarkDict(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ { ToStringDict(1) }\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>BenchmarkConcat-4       20000000               106 ns/op\nBenchmarkSlice-4        100000000               17.0 ns/op\nBenchmarkConst-4        2000000000               1.34 ns/op\nBenchmarkDict-4         2000000000               1.04 ns/op\n</code></pre>\n\n<p>Just by jumping from concatenation to slice conversion, it immediately becomes <strong>6 times faster</strong>.</p>\n\n<p>Utilizing string slicing, we again make it <strong>12 times faster</strong>.</p>\n\n<p>And pre-building all possible values and just doing a simple lookup, we further <strong>gain 22%</strong>.</p>\n\n<p>Comparing the final to the initial: the dictionary lookup is <strong>a hundred times faster</strong> than the original concatenation.</p>\n\n<h3>Using <code>fmt</code></h3>\n\n<p>For completeness, here's a solution using the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow\"><code>fmt</code></a> package:</p>\n\n<pre><code>func ToStringFmt(n byte) string {\n    n--\n    return fmt.Sprintf(\"%c%c\", (n/8)+65, (n%8)+49)\n}\n</code></pre>\n\n<p>But this one is slower by almost 2.5 times even than our slowest String concatenation solution, as this has to wrap arguments into <code>interface{}</code> values, create and put them into a slice (for the vararg), has to parse and analyze a format <code>string</code>, use reflection to process arguments, build the <code>string</code> representation in a buffer which finally is used to produce the returned <code>string</code> value. A lot of things happen which are for the \"general\" case and are not required for our \"special\" case.</p>\n"}], "owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 38892450, "answer_count": 2, "score": 1, "last_activity_date": 1471703941, "creation_date": 1470907091, "last_edit_date": 1470918558, "question_id": 38892197, "link": "https://stackoverflow.com/questions/38892197/how-to-convert-a-number-to-string-of-the-form-1-a1-2-a2-9-b1-64-h8-i", "title": "How to convert a number to string, of the form 1=A1, 2=A2, ... 9=B1, ... 64=H8 in Golang?", "body": "<p>This code is giving <code>A1..A9, B0..B9, C0..C9, ...</code>.</p>\n\n<p>But I only want <code>A1..A8, B1..B8, C1..C8, D1..D8, E1..E8, F1..F8, G1..G8, H1..H8</code> (1-64).</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc ToString(n int8) string {\n\n    return string((n/10)+65) + string(((n%10)+49)-1)\n\n}\n\nfunc main() {\n    var i int8\n    for i = 1; i &lt; 11; i++ {\n        fmt.Println(ToString(i))\n    }\n}\n</code></pre>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 12630, "user_id": 5247279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dcea97f3268621cecd89b0805434412?s=128&d=identicon&r=PG", "display_name": "Bernd Buffen", "link": "https://stackoverflow.com/users/5247279/bernd-buffen"}, "edited": false, "score": 4, "creation_date": 1470901667, "post_id": 38890255, "comment_id": 65140564, "body": "use <b>3306</b> instead of 3360 as port"}, {"owner": {"reputation": 53, "user_id": 4762560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2f30317b76a2f4975acaf713d587fb?s=128&d=identicon&r=PG&f=1", "display_name": "Anggit Muhamad Ginanjar", "link": "https://stackoverflow.com/users/4762560/anggit-muhamad-ginanjar"}, "reply_to_user": {"reputation": 12630, "user_id": 5247279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dcea97f3268621cecd89b0805434412?s=128&d=identicon&r=PG", "display_name": "Bernd Buffen", "link": "https://stackoverflow.com/users/5247279/bernd-buffen"}, "edited": false, "score": 0, "creation_date": 1470906011, "post_id": 38890255, "comment_id": 65143147, "body": "Yeay... It is working. Thanks a lot for your help. Very kind of you"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1470913354, "post_id": 38890255, "comment_id": 65148232, "body": "Note that port 3306 is the standard one for MySQL DB instances, so you might as well not specify it at all -- the driver should use that automatically. That is, you only need to specify the port when you want to override the default value -- for the case when your server listens on a non-standard port (or, say, a connection to it is &quot;port-forwarded&quot; using SSH or another tunneling solution)."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1470913479, "post_id": 38890255, "comment_id": 65148302, "body": "And another suggestion: next time, please specify the name of the package you&#39;re using to work with MySQL: neither Go itself nor its standard library contain any database drivers, and there exist several implementations of MySQL driver for Go. So if you question wasn&#39;t that simple, we&#39;d need to know which package you were using to try help you."}], "owner": {"reputation": 53, "user_id": 4762560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2f30317b76a2f4975acaf713d587fb?s=128&d=identicon&r=PG&f=1", "display_name": "Anggit Muhamad Ginanjar", "link": "https://stackoverflow.com/users/4762560/anggit-muhamad-ginanjar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470913221, "creation_date": 1470901433, "last_edit_date": 1470913221, "question_id": 38890255, "link": "https://stackoverflow.com/questions/38890255/cant-connect-to-a-mysql-database", "title": "Cant&#39; connect to a MySQL database", "body": "<p>I have a MySQL server on CentOS 7 and I want to try connecting a program written in Go to that database server. For the database server (MySQL) is work correctly and I tried to make one database and table.</p>\n\n<pre><code>+-----+------------+\n| no  | nama       |\n+-----+------------+\n| 001 | Example    |\n+-----+------------+\n\nMySQL username: golang\nMySQL password: cobadatabase\n</code></pre>\n\n<p><strong>CentOS 7 (MySQL Server) Machine's IP: <code>192.168.102.175:3306</code> (Default Port)</strong>\n<strong>and My laptop's IP: <code>192.168.102.170</code>\n**. So, Database server exist on different machine (remotely).</strong></p>\n\n<p>Here is my Go code:</p>\n\n<pre><code>func main() {\n    /* Ini konekin database-nya dulu */\n    app_database, err := sql.Open(\"mysql\", \"golang:cobadatabase@tcp(192.168.102.175:3360)/example\")\n\n    /* Nah klo ini Error Handling */\n    if err != nil {\n        log.Fatal(err)  // informasi log jika koneksi database gagal\n    }\n    defer app_database.Close() // Close koneksi jika benar-benar gagal\n    /* End of Error Handling Connection */\n\n    var (\n        no string\n        nama string\n    )\n\n    baris, err := app_database.Query(\"SELECT * FROM example_table\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer baris.Close()\n\n    for baris.Next() {\n        err := baris.Scan(&amp;no, &amp;nama)\n        if err != nil {\n            log.Fatal(err)\n        }\n        log.Println(no, nama)\n    }\n    err = baris.Err()\n\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>When I run my program, it fails with this error:</p>\n\n<blockquote>\n  <p>dial tcp 192.168.102.175:3360 connectex: A connection attempt failed because the connected party did not properly respond.</p>\n</blockquote>\n"}]