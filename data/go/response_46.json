[{"tags": ["unit-testing", "google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 2100, "user_id": 3296947, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fce43fe11b462f0881bafc600a4bf9db?s=128&d=identicon&r=PG&f=1", "display_name": "NewestStackOverflowUser", "link": "https://stackoverflow.com/users/3296947/neweststackoverflowuser"}, "edited": false, "score": 0, "creation_date": 1448742789, "post_id": 33963146, "comment_id": 55708562, "body": "This would work only If I have single &quot;Person&quot; entity kind. I could execute this in a for loop for all of my entity kinds, but I would have to add each new kind in an slice or something.  Is there a way query all kinds to be able to delete everything?"}, {"owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "reply_to_user": {"reputation": 2100, "user_id": 3296947, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fce43fe11b462f0881bafc600a4bf9db?s=128&d=identicon&r=PG&f=1", "display_name": "NewestStackOverflowUser", "link": "https://stackoverflow.com/users/3296947/neweststackoverflowuser"}, "edited": false, "score": 1, "creation_date": 1448743188, "post_id": 33963146, "comment_id": 55708695, "body": "@NewestStackOverflowUser, I did mention a kind-less query, but then mistakenly did restrain the query to a kind -- I have now edited my answer to make the query <i>actually</i> kind-less as I meant it to be since the start, answering your objection in your latest comment."}], "tags": [], "owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "is_accepted": true, "score": 1, "last_activity_date": 1448743121, "last_edit_date": 1448743121, "creation_date": 1448649448, "answer_id": 33963146, "question_id": 33928295, "link": "https://stackoverflow.com/questions/33928295/go-appengine-faster-datastore-tests/33963146#33963146", "title": "go/appengine: faster datastore tests", "body": "<p>A kindless, keys-only query (getting the keys of all entities, regardless of kind) should help:</p>\n\n<pre><code>   q := datastore.NewQuery(\"\").KeysOnly()\n</code></pre>\n\n<p>and then, you loop over all such keys and delete each of them, e.g:</p>\n\n<pre><code>   for t := q.Run(ctx); ; {\n        key, err := t.Next(nil)\n        if err == datastore.Done {\n            break\n        }\n        if err != nil {\n            serveError(c, w, err)\n            return\n        }\n        datastore.Delete(ctx, key)\n    }\n</code></pre>\n\n<p>It may be slightly faster to get the keys into an array and use <code>DeleteMulti</code>, but, on a local datastore, I suspect that would not make a measurable difference.</p>\n"}], "owner": {"reputation": 2100, "user_id": 3296947, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fce43fe11b462f0881bafc600a4bf9db?s=128&d=identicon&r=PG&f=1", "display_name": "NewestStackOverflowUser", "link": "https://stackoverflow.com/users/3296947/neweststackoverflowuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 33963146, "answer_count": 1, "score": 1, "last_activity_date": 1454045146, "creation_date": 1448494625, "last_edit_date": 1448497169, "question_id": 33928295, "link": "https://stackoverflow.com/questions/33928295/go-appengine-faster-datastore-tests", "title": "go/appengine: faster datastore tests", "body": "<p>Recently I've been playing around with golang and google's app engine.</p>\n\n<p>I've been experiencing really slow unit test executions when implementing repositories.</p>\n\n<p>The thing I do is to call <code>ctx,_ := aetest.NewContext(nil)</code> in each test in order to obtain a clean database. This starts a new server in each test and thus leads in slow testing.</p>\n\n<p>Lately I've been trying to work this around by starting it in  TestMain.</p>\n\n<pre><code>var ctx aetest.Context\n\nfunc TestMain(m *testing.M) {\n    ctx,_ = aetest.NewContext(nil)\n    code := m.Run()\n    ctx.Close()\n    os.Exit(code)\n}\n\nfunc TestMyRepository(t *testing.T){\n    cleanDatastore()\n    repo := &amp;MyRepository{ctx}\n    repo.DoSomething()\n}\n</code></pre>\n\n<p>In the function <a href=\"https://gist.github.com/NewestUser/9468b0a7b763c84a8625\" rel=\"nofollow\" title=\"gist\">cleanDatastore</a> I've been executing a bash script that basically runs a SQLite command to clean the local database saved in /tmp.</p>\n\n<pre><code>#!/usr/bin/env bash\n\nPATH=$1\ncd $PATH\n\necho \"Cleaning datastore...\"\n\n/usr/bin/sqlite3 datastore \"delete from \\\"dev~testapp!!EntitiesByProperty\\\";\"\n/usr/bin/sqlite3 datastore \"delete from \\\"dev~testapp!!Entities\\\";\"\n\necho \"Datastore is clean.\"\n</code></pre>\n\n<p>Is what I am trying to do making any sense or is there a simpler way to achieve better testing time. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "edited": false, "score": 0, "creation_date": 1448496938, "post_id": 33928247, "comment_id": 55618215, "body": "thanks for your answer, I have a follow up question, although I got answer to my original question. Interface solves the problem. But I wanted to not detect types (if possible, also I expect only either map or slice types) and then have a for loop using range over data. That doesnt seem to work: <a href=\"https://play.golang.org/p/jggFscxfHx\" rel=\"nofollow noreferrer\">play.golang.org/p/jggFscxfHx</a> . Because I cannot range over interface."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "edited": false, "score": 1, "creation_date": 1448497054, "post_id": 33928247, "comment_id": 55618243, "body": "@GauravSinha take a look at this Q/A <a href=\"http://stackoverflow.com/questions/14025833/range-over-interface-which-stores-a-slice\" title=\"range over interface which stores a slice\">stackoverflow.com/questions/14025833/&hellip;</a> It sounds exactly like the thing you want."}, {"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "edited": false, "score": 1, "creation_date": 1448497780, "post_id": 33928247, "comment_id": 55618408, "body": "nice, didn&#39;t know much about reflection. Thanks :) :thumbsup"}, {"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "edited": false, "score": 0, "creation_date": 1448498688, "post_id": 33928247, "comment_id": 55618619, "body": "Looking at my code now, I think I am still repeating my code in the new function. Only difference being it is now in the form of a switch case, rather than two functions. But good to learn about interfaces and reflection though."}], "tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": true, "score": 7, "last_activity_date": 1448494312, "creation_date": 1448494312, "answer_id": 33928247, "question_id": 33928175, "link": "https://stackoverflow.com/questions/33928175/how-to-pass-different-types-to-a-function/33928247#33928247", "title": "how to pass different types to a function", "body": "<p>You can use interfaces <kbd><a href=\"https://play.golang.org/p/TK2VA4v18l\" rel=\"noreferrer\">Go Playground</a></kbd></p>\n\n<pre><code>func F(data interface{}) {\n    switch data.(type){\n    case []int:\n        fmt.Println(\"Slice\")\n        fmt.Println(data)\n    case map[string]int:\n        fmt.Println(\"Map\")\n        fmt.Println(data)\n    }\n\n    fmt.Println()\n}\n</code></pre>\n\n<p>where you actually check for the type and do something based on the type. </p>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1448494429, "creation_date": 1448494429, "answer_id": 33928261, "question_id": 33928175, "link": "https://stackoverflow.com/questions/33928175/how-to-pass-different-types-to-a-function/33928261#33928261", "title": "how to pass different types to a function", "body": "<p>There are several ways you could do this, but the simple way would be to make it so <code>DoSomethingNew</code> accepts the <code>interface{}</code> type. Inside of the method you would then do a type switch or in this case with only two options, perhaps just one type assertion, followed by the other, returning error if both fail. Another option would be to have both as arguments and check for <code>nil</code> inside the function with a similar if, else-if, else pattern to handle the error if the input is of neither types you're looking for. To make your code more safe you could move to a more strict interface than the empty one which all types implement. You could also do some method chaining or even implement the method with using the types themselves as the receiving type. Here's an example that shows a few of the ideas; <a href=\"https://play.golang.org/p/_v2AyFjGzv\" rel=\"nofollow\">https://play.golang.org/p/_v2AyFjGzv</a></p>\n"}], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2118, "favorite_count": 1, "accepted_answer_id": 33928247, "answer_count": 2, "score": 4, "last_activity_date": 1448497613, "creation_date": 1448493930, "last_edit_date": 1448497613, "question_id": 33928175, "link": "https://stackoverflow.com/questions/33928175/how-to-pass-different-types-to-a-function", "title": "how to pass different types to a function", "body": "<p>I have two golang functions, doing exactly same thing, one takes input a slice and the other takes a map as input. I want to combine this into one function, to avoid duplication. </p>\n\n<pre><code>func DoSomething([]data) {\n//do something.\n}\n\nfunc DoSomething(map[string]data) {\n    //do something.\n}\n</code></pre>\n\n<p>Combined function may look like:</p>\n\n<pre><code>    func DoSomethingNew (param type) {\n       //param could be map or slice\n    }\n</code></pre>\n\n<p>I want to know if it is possible to pass different types to same function in golang and how. I googled but couldn't find anything relevant. </p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 329, "user_id": 4255617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-TlZ_zzZY14I/AAAAAAAAAAI/AAAAAAAAAEA/nDZqovmltJk/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/4255617/patrick"}, "edited": false, "score": 0, "creation_date": 1448487084, "post_id": 33926629, "comment_id": 55614428, "body": "I think I&#39;ve solved it, see below."}, {"owner": {"reputation": 23094, "user_id": 473914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333f7be87dc935f7a362cabb0a4abce7?s=128&d=identicon&r=PG", "display_name": "tobyodavies", "link": "https://stackoverflow.com/users/473914/tobyodavies"}, "edited": false, "score": 4, "creation_date": 1448487150, "post_id": 33926629, "comment_id": 55614465, "body": "That&#39;s a slice not an array."}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 4255617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-TlZ_zzZY14I/AAAAAAAAAAI/AAAAAAAAAEA/nDZqovmltJk/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/4255617/patrick"}, "edited": false, "score": 0, "creation_date": 1448487601, "post_id": 33926716, "comment_id": 55614670, "body": "Thanks, this makes more sense."}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 12, "last_activity_date": 1448486957, "creation_date": 1448486957, "answer_id": 33926716, "question_id": 33926629, "link": "https://stackoverflow.com/questions/33926629/how-to-create-a-three-dimensional-array-in-golang/33926716#33926716", "title": "How to create a three-dimensional array in Golang", "body": "<p>You have to initialize each layer on its own. Example (<a href=\"http://play.golang.org/p/gk1n6sfWGi\">on play</a>):</p>\n\n<pre><code>tiles = make([][][]*tile, x)\n\nfor i := range tiles {\n    tiles[i] = make([][]*tile, y)\n    for j := range tiles[i] {\n        tiles[i][j] = make([]*tile, z)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1448487395, "post_id": 33926775, "comment_id": 55614569, "body": "3d arrays are ugly, they have three dimensions. @nemo has a cleaner algorithm above though."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448489165, "post_id": 33926775, "comment_id": 55615463, "body": "If you would use an array (your code uses slices which are not arrays) it would be easier."}], "tags": [], "owner": {"reputation": 329, "user_id": 4255617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-TlZ_zzZY14I/AAAAAAAAAAI/AAAAAAAAAEA/nDZqovmltJk/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/4255617/patrick"}, "is_accepted": false, "score": -1, "last_activity_date": 1448487188, "creation_date": 1448487188, "answer_id": 33926775, "question_id": 33926629, "link": "https://stackoverflow.com/questions/33926629/how-to-create-a-three-dimensional-array-in-golang/33926775#33926775", "title": "How to create a three-dimensional array in Golang", "body": "<p>It works like this, but to me this feels very inefficient. Using the append-operation this many times. And it feels bloated, this should be possible in a simpler way.</p>\n\n<pre><code>func generateTiles(x int, y int, z int) [][][]*tile {\n    var tiles [][][]*tile\n\n    for i := 0; i &lt; z; i++ {\n        var layer [][]*tile\n        for j := 0; j &lt; y; j++ {\n            var row []*tile\n            for k := 0; k &lt; x; k++ {\n                var t *tile\n                t = &amp;tile{}\n                row = append(row, t)\n                count++\n            }\n            layer = append(layer, row)\n        }\n        tiles = append(tiles, layer)\n    }\n\n    return tiles\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 354, "user_id": 607102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8959c1702ab20b4c16f06f674d6a94e6?s=128&d=identicon&r=PG", "display_name": "deathly809", "link": "https://stackoverflow.com/users/607102/deathly809"}, "is_accepted": false, "score": 0, "last_activity_date": 1448487222, "creation_date": 1448487222, "answer_id": 33926783, "question_id": 33926629, "link": "https://stackoverflow.com/questions/33926629/how-to-create-a-three-dimensional-array-in-golang/33926783#33926783", "title": "How to create a three-dimensional array in Golang", "body": "<p>There is an example for creating a two dimensional array on GoByExample: <a href=\"https://gobyexample.com/arrays\" rel=\"nofollow\">https://gobyexample.com/arrays</a>.  You should be able to expand that into a three dimensional case.</p>\n\n<p>Here is what I came up with.</p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Tile struct {\n    value int\n}\n\nfunc create3D( x, y, z int) [][][]*Tile {\n    result := make([][][]*Tile,x)\n    for i := 0 ; i &lt; x ; i++ {\n        result[i] = make([][]*Tile,y);\n        for j := 0; j &lt; y; j++ {\n            result[i][j] = make([]*Tile,z);\n            for k := 0 ; k &lt; z; k++ {\n                result[i][j][k] = new(Tile)\n                result[i][j][k].value = i + j + k;\n            }\n        }\n    }\n    return result\n}\n\nfunc main() {\n    X := 3\n    Y := 4\n    Z := 5\n\n    mat := create3D( X , Y , Z);\n    for i := 0; i &lt; X; i++ {\n        for j := 0 ; j &lt; Y; j++ {\n            for k := 0 ; k &lt; Z; k++ {\n                fmt.Printf(\"%d \",mat[i][j][k].value)\n            }\n            fmt.Println();\n        }\n        fmt.Println();\n    }\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 329, "user_id": 4255617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-TlZ_zzZY14I/AAAAAAAAAAI/AAAAAAAAAEA/nDZqovmltJk/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/4255617/patrick"}, "edited": false, "score": 0, "creation_date": 1448809779, "post_id": 33929271, "comment_id": 55724064, "body": "I haven&#39;t though of this approach before. Thanks! I&#39;ll try this one too. Can you explain how exactly it will save on the performance?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 329, "user_id": 4255617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-TlZ_zzZY14I/AAAAAAAAAAI/AAAAAAAAAEA/nDZqovmltJk/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/4255617/patrick"}, "edited": false, "score": 1, "creation_date": 1448813892, "post_id": 33929271, "comment_id": 55725353, "body": "@Patrick well for a few reasons, 1. It&#39;s a one big block of contiguous memory instead of multiple fragmented blocks. 2. Only one bounds check per access instead of three (slice[xyz]  vs slice[x][y][z]), which can add up if you&#39;re looking for high performance."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 6, "last_activity_date": 1448502093, "last_edit_date": 1448502093, "creation_date": 1448501787, "answer_id": 33929271, "question_id": 33926629, "link": "https://stackoverflow.com/questions/33926629/how-to-create-a-three-dimensional-array-in-golang/33929271#33929271", "title": "How to create a three-dimensional array in Golang", "body": "<p>I'd personally use a 1D slice for performance reasons, I'm adding this as an alternative:</p>\n\n<pre><code>type Tile struct {\n    x, y, z int\n}\n\ntype Tiles struct {\n    t       []*Tile\n    w, h, d int\n}\n\nfunc New(w, h, d int) *Tiles {\n    return &amp;Tiles{\n        t: make([]*Tile, w*h*d),\n        w: w,\n        h: h,\n        d: d,\n    }\n}\n\n// indexing based on http://stackoverflow.com/a/20266350/145587\nfunc (t *Tiles) At(x, y, z int) *Tile {\n    idx := t.h*t.w*z + t.w*y\n    return t.t[idx+x]\n}\n\nfunc (t *Tiles) Set(x, y, z int, val *Tile) {\n    idx := t.h*t.w*z + t.w*y\n    t.t[idx+x] = val\n}\n\nfunc fillTiles(w int, h int, d int) *Tiles {\n    tiles := New(w, h, d)\n\n    for x := 0; x &lt; w; x++ {\n        for y := 0; y &lt; h; y++ {\n            for z := 0; z &lt; d; z++ {\n                tiles.Set(x, y, z, &amp;Tile{x, y, z})\n            }\n        }\n    }\n\n    return tiles\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/sdVbsE1hnS\" rel=\"noreferrer\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 329, "user_id": 4255617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-TlZ_zzZY14I/AAAAAAAAAAI/AAAAAAAAAEA/nDZqovmltJk/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/4255617/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4754, "favorite_count": 2, "accepted_answer_id": 33926716, "answer_count": 4, "score": 5, "last_activity_date": 1448502093, "creation_date": 1448486472, "question_id": 33926629, "link": "https://stackoverflow.com/questions/33926629/how-to-create-a-three-dimensional-array-in-golang", "title": "How to create a three-dimensional array in Golang", "body": "<p>I'm trying to create a three-dimensional array which contains blocks (like a rubiks-cube).</p>\n\n<p>I tried many things but I can't get it to work.</p>\n\n<pre><code>func generateTiles(x int, y int, z int) [][][]*tile{\n  var tiles [][][]*tile\n\n  // Something here\n  // resulting in a x by y by z array\n  // filled with *tile\n\n  return tiles\n}\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["json", "go", "interface", "decoding"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 7, "last_activity_date": 1448477830, "last_edit_date": 1448477830, "creation_date": 1448477431, "answer_id": 33924299, "question_id": 33924131, "link": "https://stackoverflow.com/questions/33924131/golang-convert-array-of-interfaces-to-strings/33924299#33924299", "title": "golang convert array of interfaces to strings", "body": "<p><code>m[\"t\"]</code> is of type <code>interface{}</code> and is the full array, if you wanted to get <code>str-b</code> it is at index one and you have to do some type assertion to get it as a string. Here's an example; <a href=\"https://play.golang.org/p/W7ZnMgicc7\" rel=\"noreferrer\">https://play.golang.org/p/W7ZnMgicc7</a></p>\n\n<p>If you want to check for it in the collection that would look like this;</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"encoding/json\"\n)\n\nfunc main() {\n    var m map[string]interface{}\n    sJSON := `{\"k\": \"v\", \"t\":[\"str-a\",\"str-b\",\"str-c\"]}`\n    _ = json.Unmarshal([]byte(sJSON),&amp;m)\n\n    // find out if one of the string values of \"t\" is \"str-b\"\n    for _, v := range m[\"t\"].([]interface{}) {\n         if v.(string) == \"str-b\" {\n              fmt.Println(\"match found!\")\n         }\n    }\n    //fmt.Println(m[\"t\"].([]interface{})[1].(string)) \n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/vo_90bKw92\" rel=\"noreferrer\">https://play.golang.org/p/vo_90bKw92</a></p>\n\n<p>If you want to avoid this 'unboxing' stuff, which I would recommend you do, you could instead define a struct to unmarshal into, itwould look like this;</p>\n\n<pre><code>type MyStruct struct {\n     K string `json:\"k\"`\n     T []string `json:\"t\"`\n}\n</code></pre>\n\n<p>Then you can just range over <code>T</code> without any type assertions and do the compare, working example here;  <a href=\"https://play.golang.org/p/ehPxOygGf5\" rel=\"noreferrer\">https://play.golang.org/p/ehPxOygGf5</a></p>\n"}], "owner": {"reputation": 97, "user_id": 5586999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d6ede0f59d47a14f8ab7659e08972c?s=128&d=identicon&r=PG&f=1", "display_name": "user208383", "link": "https://stackoverflow.com/users/5586999/user208383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8139, "favorite_count": 0, "accepted_answer_id": 33924299, "answer_count": 1, "score": 4, "last_activity_date": 1448492027, "creation_date": 1448476831, "last_edit_date": 1448492027, "question_id": 33924131, "link": "https://stackoverflow.com/questions/33924131/golang-convert-array-of-interfaces-to-strings", "title": "golang convert array of interfaces to strings", "body": "<p>I read JSON data from a remote source and convert it to a map. There's some array in the data of which I want to examine the string values. After converting I think m[\"t\"] is an array of interfaces. fmt.Print converts this to printed text on the console but I cannot figure a way to do a simple string comparison like</p>\n\n<pre><code>if val[0] == \"str-c\" {fmt.Println(\"success\")}\n</code></pre>\n\n<p>How do I iterate through that and do string comparisons?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\nfunc main() {\n    var m map[string]interface{}\n    sJSON := `{\"k\": \"v\", \"t\":[\"str-a\",\"str-b\",\"str-c\"]}`\n    _ = json.Unmarshal([]byte(sJSON),&amp;m)\n\n    // find out if one of the string values of \"t\" is \"str-b\"\n    fmt.Println(m[\"t\"]) \n}\n</code></pre>\n"}, {"tags": ["go", "repository-pattern"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 9, "creation_date": 1448476150, "post_id": 33922708, "comment_id": 55608757, "body": "I&#39;d recommend to not writing Java or C# code in Go."}, {"owner": {"reputation": 83, "user_id": 930448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9dc756d47427ec3edbd566452813edb?s=128&d=identicon&r=PG", "display_name": "solo12zw74", "link": "https://stackoverflow.com/users/930448/solo12zw74"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1448477506, "post_id": 33922708, "comment_id": 55609499, "body": "i dont write Java code in Go. I try to not duplicate my code . Is any ways to do it? Or it is not?"}], "answers": [{"comments": [{"owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 0, "creation_date": 1460836595, "post_id": 33924845, "comment_id": 60929743, "body": "quick question: Does <code>RepositoryItem</code> mean an entity?"}, {"owner": {"reputation": 1274, "user_id": 2056908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e377dc7a85bd71485eb514a49d64e362?s=128&d=identicon&r=PG", "display_name": "mattsch", "link": "https://stackoverflow.com/users/2056908/mattsch"}, "reply_to_user": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 1, "creation_date": 1460894044, "post_id": 33924845, "comment_id": 60942385, "body": "@Roylee it&#39;s a while since I&#39;ve looked at this, but I think yes, essentially."}], "tags": [], "owner": {"reputation": 1274, "user_id": 2056908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e377dc7a85bd71485eb514a49d64e362?s=128&d=identicon&r=PG", "display_name": "mattsch", "link": "https://stackoverflow.com/users/2056908/mattsch"}, "is_accepted": false, "score": 2, "last_activity_date": 1448479858, "last_edit_date": 1448479858, "creation_date": 1448479450, "answer_id": 33924845, "question_id": 33922708, "link": "https://stackoverflow.com/questions/33922708/golang-repostiory-pattern/33924845#33924845", "title": "Golang repostiory pattern", "body": "<p>Forgive me if I'm misunderstanding, but a better pattern might be something like the following:</p>\n\n<pre><code>type RepositoryItem interface {\n    Name() string // for example\n}\n\ntype Repository interface {\n    GetAll() ([]RepositoryItem, error)\n}\n</code></pre>\n\n<p>At the moment, you essentially have multiple interfaces for each type of repository, so unless you're going to implement multiple types of <code>RoleRepository</code>, you might as well not have the interface.</p>\n\n<p>Having generic <code>Repository</code> and <code>RepositoryItem</code> interfaces might make your code more extensible (not to mention easier to test) in the long run.</p>\n\n<p>A contrived example might be (if we assume a <code>Repository</code> vaguely correlates to a backend) implementations such as <code>MySQLRepository</code> and <code>MongoDBRepository</code>. By abstracting the functionality of the repository, you're protecting against future mutations.</p>\n\n<p>I would very much advise seeing @kostix's answer also, though.</p>\n"}, {"comments": [{"owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 0, "creation_date": 1460836024, "post_id": 33924859, "comment_id": 60929557, "body": "great info, so is there any other design pattern we can apply to abstract the data layer? Especially where DDD advocates Repository pattern, and you mentioned its a bad idea to have repository pattern in GO."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 4, "creation_date": 1461062595, "post_id": 33924859, "comment_id": 61017414, "body": "@Roylee, I&#39;m afraid you got fixated on those pesky &quot;patterns&quot; as oh so many folks do. Software engeneering is not about, when confronted with a problem, looking through a catalog of patterns to see which one fits. I&#39;d recommend 1) stop thinking about patterns; 2) look at what features the language has; 3) look at your problem; 4) work out what language features could help."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 1, "creation_date": 1461062788, "post_id": 33924859, "comment_id": 61017547, "body": "@Roylee, typically, that pattern gibberish gets invoked when one wants to abstract something away -- to ease testing (possibly through mocking) etc. If that&#39;s what you need, look at Go interfaces: note that the whole Go&#39;s standard library is built on them -- you will see things like <code>io.Reader</code> and <code>io.Writer</code> etc everywhere, and they are interfaces. Hence if you need to decouple two parts of the code apart, create a set of interfaces, and make the &quot;consumer&quot; part of the code use them, and the &quot;producer&quot; part of the code create things implementing those interface."}, {"owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 2, "creation_date": 1461063342, "post_id": 33924859, "comment_id": 61017926, "body": "<code>...its not about when confronted with a problem, looking through a catalog of patterns to see which one fits.</code>, this piercing straight into my heart. I understand now, and that&#39;s really good advice. Thank you @kostix"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 23, "last_activity_date": 1448479503, "creation_date": 1448479503, "answer_id": 33924859, "question_id": 33922708, "link": "https://stackoverflow.com/questions/33922708/golang-repostiory-pattern/33924859#33924859", "title": "Golang repostiory pattern", "body": "<p>No, <a href=\"http://tip.golang.org/doc/faq#generics\" rel=\"noreferrer\">Go does not have generics</a> and won't have them in the forseeable future.</p>\n\n<p>You have three options:</p>\n\n<ul>\n<li><p>Refactor your code so that you have a single function which accepts an SQL statement and another function, and:</p>\n\n<ol>\n<li>Queries the DB with the provided statement.</li>\n<li>Iterates over the result's rows.</li>\n<li>For each row, calls the provided function whose task is to\nscan the row.</li>\n</ol>\n\n<p>In this case, you'll have a single generic \"querying\" function,\nand the differences will be solely in \"scanning\" functions.</p>\n\n<p>Several variations on this are possible but I suspect you have the idea.</p></li>\n<li><p>Use the <a href=\"https://github.com/jmoiron/sqlx\" rel=\"noreferrer\"><code>sqlx</code></a> package which basically is to SQL-driven databases what <code>encoding/json</code> is to JSON data streams: it uses reflection on your types to create and execute SQL to populate them.</p>\n\n<p>This way you'll get reusability on another level: you simply won't write boilerplate code.</p></li>\n<li><p>Use <a href=\"https://blog.golang.org/generate\" rel=\"noreferrer\">code generation</a> which is <em>the</em> Go-native way of having \"code templates\" (that's what generics are about).</p>\n\n<p>This way, you (usually) write a Go program which takes some input (in whatever format you wish), reads it and writes out one or more files which contain Go code, which is then compiled.</p>\n\n<p>In your, very simple, case, you can start with a template of your Go function and some sort of a table which maps SQL statement to the types to create from the data selected.</p></li>\n</ul>\n\n<hr>\n\n<p>I'd note that your code indeed looks woefully unidiomatic.</p>\n\n<p>No one in their right mind implements \"repository patterns\" in Go, but that's sort of okay so long it keeps you happy&mdash;we all are indoctrinated to a certain degree with the languages/environments we're accustomed to,&mdash;but your <code>connection := r.provider.GetConnection()</code> looks alarming: the Go's <code>database/sql</code> is drastically different from \"popular\" environments and frameworks so I'd highly recommend to start with <a href=\"https://www.vividcortex.com/resources/building-database-driven-apps-with-go/\" rel=\"noreferrer\">this</a> and <a href=\"http://go-database-sql.org/\" rel=\"noreferrer\">this</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 19745, "user_id": 574632, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bb13b2bbc97ce81108b09be9a41120a1?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/574632/steve"}, "edited": false, "score": 4, "creation_date": 1502384987, "post_id": 33925224, "comment_id": 78198808, "body": "<code>IName</code> is a c# nameing convention for interfaces, which is likely where the op got the idea. Using those names for structs in this example is rather confusing"}, {"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "edited": false, "score": 0, "creation_date": 1610215351, "post_id": 33925224, "comment_id": 116064443, "body": "<code>interface{}</code> simply makes you lose all language semantics around intended type."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 0, "last_activity_date": 1448480887, "creation_date": 1448480887, "answer_id": 33925224, "question_id": 33922708, "link": "https://stackoverflow.com/questions/33922708/golang-repostiory-pattern/33925224#33925224", "title": "Golang repostiory pattern", "body": "<p><code>interface{}</code> is the \"generic type\" in Go. I can imagine doing something like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype IRole struct {\n    RoleId uint\n}\n\ntype ISaleChannel struct {\n    Profitable bool\n}\n\ntype GenericRepo interface{\n    GetAll([]interface{})\n}\n\n// conceptual repo to store all Roles and SaleChannels\ntype Repo struct {\n    IRoles        []IRole\n    ISaleChannels []ISaleChannel\n}\n\nfunc (r *Repo) GetAll(ifs []interface{}) {\n\n    // database implementation here before type switch \n\n    for _, v := range ifs {\n        switch v := v.(type) {\n        default:\n                fmt.Printf(\"unexpected type %T\\n\", v)\n        case IRole:\n                fmt.Printf(\"Role %t\\n\", v)            \n                r.IRoles = append(r.IRoles, v)\n        case ISaleChannel:\n                fmt.Printf(\"SaleChannel %d\\n\", v)\n                r.ISaleChannels = append(r.ISaleChannels, v)\n        }\n    }\n}\n\nfunc main() {\n\n    getter := new(Repo)\n\n    // mock slice\n    data := []interface{}{\n        IRole{1},\n        IRole{2},\n        IRole{3},\n        ISaleChannel{true},\n        ISaleChannel{false},\n        IRole{4},\n    }\n\n    getter.GetAll(data)\n\n    fmt.Println(\"IRoles: \", getter.IRoles)\n    fmt.Println(\"ISaleChannels: \", getter.ISales)\n}\n</code></pre>\n\n<p>This way you don't have to end up with two structs and/or interfaces for <code>IRole</code> and <code>ISale</code></p>\n"}], "owner": {"reputation": 83, "user_id": 930448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9dc756d47427ec3edbd566452813edb?s=128&d=identicon&r=PG", "display_name": "solo12zw74", "link": "https://stackoverflow.com/users/930448/solo12zw74"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14528, "favorite_count": 2, "accepted_answer_id": 33924859, "answer_count": 3, "score": 7, "last_activity_date": 1448480887, "creation_date": 1448472038, "question_id": 33922708, "link": "https://stackoverflow.com/questions/33922708/golang-repostiory-pattern", "title": "Golang repostiory pattern", "body": "<p>I try to implement repository pattern in Go app (simple web service) and try to find better way to escape code duplication.</p>\n\n<p>Here is a code</p>\n\n<h3>Interfaces are:</h3>\n\n<pre><code>type IRoleRepository interface {\n    GetAll() ([]Role, error)\n}\n\ntype ISaleChannelRepository interface {\n    GetAll() ([]SaleChannel, error)\n}\n</code></pre>\n\n<h3>And implementation:</h3>\n\n<pre><code>func (r *RoleRepository) GetAll() ([]Role, error) {\n        var result []Role\n        var err error\n        var rows *sql.Rows\n\n        if err != nil {\n            return result, err\n        }\n\n        connection := r.provider.GetConnection()\n        defer connection.Close()\n\n        rows, err = connection.Query(\"SELECT Id,Name FROM Position\")\n        defer rows.Close()\n\n        if err != nil {\n            return result, err\n        }\n\n        for rows.Next() {\n            entity := new(Role)\n            err = sqlstruct.Scan(entity, rows)\n\n            if err != nil {\n                return result, err\n            }\n\n            result = append(result, *entity)\n        }\n        err = rows.Err()\n        if err != nil {\n            return result, err\n        }\n\n        return result, err\n    }\n\n    func (r *SaleChannelRepository) GetAll() ([]SaleChannel, error) {\n        var result []SaleChannel\n        var err error\n        var rows *sql.Rows\n\n        if err != nil {\n            return result, err\n        }\n\n        connection := r.provider.GetConnection()\n        defer connection.Close()\n\n        rows, err = connection.Query(\"SELECT DISTINCT SaleChannel 'Name' FROM Employee\")\n        defer rows.Close()\n\n        if err != nil {\n            return result, err\n        }\n\n        for rows.Next() {\n            entity := new(SaleChannel)\n            err = sqlstruct.Scan(entity, rows)\n\n            if err != nil {\n                return result, err\n            }\n\n            result = append(result, *entity)\n        }\n        err = rows.Err()\n        if err != nil {\n            return result, err\n        }\n\n        return result, err\n    }\n</code></pre>\n\n<p>As you can see differences are in a few words. I try to find something like Generics from C#, but didnt find.</p>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["http", "networking", "go", "tcp", "http-proxy"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448470527, "post_id": 33922134, "comment_id": 55605379, "body": "What exactly do you mean by &quot;half open&quot;? That&#39;s often used to refer to a <i>embryonic</i> connection that&#39;s in the process of being established."}, {"owner": {"reputation": 451, "user_id": 936119, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/47a3cd741fbe2a7eb98ea833bfdfb1e7?s=128&d=identicon&r=PG", "display_name": "PatTheGamer", "link": "https://stackoverflow.com/users/936119/patthegamer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448471731, "post_id": 33922134, "comment_id": 55606125, "body": "When I say half opened I mean half opened as defined in this post <a href=\"http://blog.stephencleary.com/2009/05/detection-of-half-open-dropped.html\" rel=\"nofollow noreferrer\">blog.stephencleary.com/2009/05/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448472166, "post_id": 33922134, "comment_id": 55606401, "body": "That requires working at a lower level than the application layer. See <a href=\"http://stackoverflow.com/questions/5314038/simulating-host-unreachable-how-to-achieve-implement-it\" title=\"simulating host unreachable how to achieve implement it\">stackoverflow.com/questions/5314038/&hellip;</a>. You could simply stop sending and receiving data in your app, but the behavior at network level won&#39;t be exactly the same."}, {"owner": {"reputation": 451, "user_id": 936119, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/47a3cd741fbe2a7eb98ea833bfdfb1e7?s=128&d=identicon&r=PG", "display_name": "PatTheGamer", "link": "https://stackoverflow.com/users/936119/patthegamer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448474749, "post_id": 33922134, "comment_id": 55607979, "body": "If I close the read side of the tcp spcket on the server that will at least test if tcp keepalives are working correctly in the client application which may be enough..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448508243, "post_id": 33922134, "comment_id": 55620847, "body": "If you shutdown reads I&#39;m pretty sure the network stack is still going to replay to tcp keepalive packets (though it can&#39;t hurt to try)."}], "owner": {"reputation": 451, "user_id": 936119, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/47a3cd741fbe2a7eb98ea833bfdfb1e7?s=128&d=identicon&r=PG", "display_name": "PatTheGamer", "link": "https://stackoverflow.com/users/936119/patthegamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 650, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1448490141, "creation_date": 1448470339, "question_id": 33922134, "link": "https://stackoverflow.com/questions/33922134/simulate-tcp-half-open-with-golang", "title": "Simulate TCP half open with golang", "body": "<p>I'm writing a golang app <a href=\"https://github.com/GreyRockSoft/test-proxy\" rel=\"nofollow\">test-proxy</a> that works as an http proxy to simulate various network conditions so I can test the error handling paths in my other http applications.  Currently I'm simulating a request where partial data is returned, but I'm wanting to figure out how to add support for forcing a tcp half open condition.  What would be the best way to simulate this using golang?</p>\n"}, {"tags": ["mongodb", "go", "projection", "mgo", "database"], "comments": [{"owner": {"reputation": 3844, "user_id": 1419344, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fdc0a173c56f51e7b519526b90842741?s=128&d=identicon&r=PG&f=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/1419344/pio"}, "edited": false, "score": 0, "creation_date": 1448637027, "post_id": 33919366, "comment_id": 55677883, "body": "Did my answer solve the problem? If so please accept is a  a correct answer."}, {"owner": {"reputation": 661, "user_id": 1680568, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/RkIg1.png?s=128&g=1", "display_name": "William Yang", "link": "https://stackoverflow.com/users/1680568/william-yang"}, "reply_to_user": {"reputation": 3844, "user_id": 1419344, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fdc0a173c56f51e7b519526b90842741?s=128&d=identicon&r=PG&f=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/1419344/pio"}, "edited": false, "score": 0, "creation_date": 1448638446, "post_id": 33919366, "comment_id": 55678677, "body": "I used a pipeline that was different and faster than the one you had.. so not quite but close enough."}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 1680568, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/RkIg1.png?s=128&g=1", "display_name": "William Yang", "link": "https://stackoverflow.com/users/1680568/william-yang"}, "edited": false, "score": 0, "creation_date": 1448476459, "post_id": 33923169, "comment_id": 55608926, "body": "But I thought the floor is already inside an array inside Building? Did you read the code?? The unique ID&#39;s are there to make things handy. It has nothing to do with mongo&#39;s NoSQL philosophy."}], "tags": [], "owner": {"reputation": 3844, "user_id": 1419344, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fdc0a173c56f51e7b519526b90842741?s=128&d=identicon&r=PG&f=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/1419344/pio"}, "is_accepted": true, "score": 1, "last_activity_date": 1448494463, "last_edit_date": 1448494463, "creation_date": 1448473516, "answer_id": 33923169, "question_id": 33919366, "link": "https://stackoverflow.com/questions/33919366/mongodb-mgo-v2-projection-returns-parent-struct/33923169#33923169", "title": "MongoDB (Mgo v2) Projection returns parent struct", "body": "<p>You are querying for a <code>Building</code> document so <code>mongo</code> returns that to you even though you try to mask some of its fields using projection.</p>\n\n<p>I don't know of a way to count the number of elements in a <code>mongo</code> array in a <code>find</code> query, but you can use the aggregation framework, where you have the <a href=\"https://docs.mongodb.org/manual/reference/operator/aggregation/size/\" rel=\"nofollow\"><code>$size</code></a> operator that does exactly this. So you should send a query like this to <code>mongo</code> :</p>\n\n<pre><code>db.buildings.aggregate([\n{\n    \"$match\":\n    {\n        \"_id\": buildingID,\n        \"p\": {\n             \"$elemMatch\": {\"l\": fNum}\n         }\n    }\n},\n{\n    \"$project\":\n    {\n        nrOfFloors: {\n            \"$size\": \"$p\"\n        }\n    }\n}])\n</code></pre>\n\n<p>Which in <code>go</code> it would look like</p>\n\n<pre><code>result := []bson.M{}\nmatch := bson.M{\"$match\": bson.M{\"b\": bldg_uuid, \"p\": bson.M{\"$elemMatch\": bson.M{\"l\": fNum}}}}\ncount := bson.M{\"$project\": bson.M{\"nrOfFloors\": bson.M{\"$size\": \"$p\"}}}\noperations := []bson.M{match, count}\npipe := sess.DB(\"mgodb\").C(\"building\").Pipe(operations) \npipe.All(&amp;result)\n</code></pre>\n"}], "owner": {"reputation": 661, "user_id": 1680568, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/RkIg1.png?s=128&g=1", "display_name": "William Yang", "link": "https://stackoverflow.com/users/1680568/william-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 33923169, "answer_count": 1, "score": 0, "last_activity_date": 1501403878, "creation_date": 1448462512, "last_edit_date": 1506103077, "question_id": 33919366, "link": "https://stackoverflow.com/questions/33919366/mongodb-mgo-v2-projection-returns-parent-struct", "title": "MongoDB (Mgo v2) Projection returns parent struct", "body": "<p>I have here a Building Object where inside sits an Array of Floor Objects. </p>\n\n<p>When Projecting, my goal is to return or count the number of Floor Objects inside a Building Object after matching the elements accordingly. The code is as follows:</p>\n\n<p>Objects:</p>\n\n<pre><code>type Floor struct {\n    // Binary JSON Identity\n    ID bson.ObjectId `bson:\"_id,omitempty\"`\n    // App-level Identity\n    FloorUUID string `bson:\"f\"`\n    // Floor Info\n    FloorNumber int `bson:\"l\"`\n    // Units\n    FloorUnits []string `bson:\"u\"`\n    // Statistics\n    Created time.Time `bson:\"y\"`\n}\n\ntype Building struct {\n    // Binary JSON Identity\n    ID bson.ObjectId `bson:\"_id,omitempty\"`\n    // App-level Identity\n    BldgUUID string `bson:\"b\"`\n    // Address Info\n    BldgNumber  string `bson:\"i\"` // Street Number\n    BldgStreet  string `bson:\"s\"` // Street\n    BldgCity    string `bson:\"c\"` // City\n    BldgState   string `bson:\"t\"` // State\n    BldgCountry string `bson:\"x\"` // Country\n    // Building Info\n    BldgName      string `bson:\"w\"`\n    BldgOwner     string `bson:\"o\"`\n    BldgMaxTenant int    `bson:\"m\"`\n    BldgNumTenant int    `bson:\"n\"`\n    // Floors\n    BldgFloors []Floor `bson:\"p\"`\n    // Statistics\n    Created time.Time `bson:\"z\"`\n}\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>func InsertFloor(database *mgo.Database, bldg_uuid string, fnum int) error {\n\n    fmt.Println(bldg_uuid)\n    fmt.Println(fnum) // Floor Number\n\n    var result Floor // result := Floor{}\n\n    database.C(\"buildings\").Find(bson.M{\"b\": bldg_uuid}).Select(\n        bson.M{\"p\": bson.M{\"$elemMatch\": bson.M{\"l\": fnum}}}).One(&amp;result)\n\n    fmt.Printf(\"AHA %s\", result)\n    return errors.New(\"x\")\n}\n</code></pre>\n\n<p>It turns out, no matter how I try the query returns a Building Object, not a floor object? What changes do I need to make in order to have the query fetch and count Floors and not Buildings? </p>\n\n<p>This is done so to check if a Floor inside Building already exists before insertion. If there's a better a approach then I'll replace mine with the better!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 1, "creation_date": 1448460428, "post_id": 33918460, "comment_id": 55598216, "body": "Do not disregard errors by assigning them to underscores. Check them and print them. They will most probably provide you a solution."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1448460467, "post_id": 33918460, "comment_id": 55598250, "body": "Does <code>v := ret.([]string)</code> panic? If yes, what does the panic message say?"}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1448460867, "post_id": 33918460, "comment_id": 55598518, "body": "no, just get v is <code>[]</code> @Ainar-G"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448461067, "post_id": 33918460, "comment_id": 55598662, "body": "go types are not covariant. You need to iterate through the <code>[][]byte</code> and convert each slice to a string."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1448461759, "post_id": 33918460, "comment_id": 55599174, "body": "Read the Go FAQ: <a href=\"https://golang.org/doc/faq\" rel=\"nofollow noreferrer\">golang.org/doc/faq</a>. Do the Tour of Go: <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour.golang.org/welcome/1</a>. Do not use <code>interface {}</code>. Really. Don&#39;t."}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1448462315, "post_id": 33918460, "comment_id": 55599546, "body": "it is a API, not mine... @Volker"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448462603, "post_id": 33918460, "comment_id": 55599737, "body": "@simon_xia: you need to read the API documentation to find out what to expect for return values. It&#39;s definitely not returning <code>[]string</code> or <code>[][]byte</code>."}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1448463395, "post_id": 33918460, "comment_id": 55600379, "body": "why to downvote, guys?"}], "answers": [{"comments": [{"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1448462073, "post_id": 33919096, "comment_id": 55599373, "body": "I got a panic here: interface conversion: interface is []interface {}, not [][]uint8"}, {"owner": {"reputation": 864, "user_id": 2513353, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f3f72320428f212b133e8e02c190b815?s=128&d=identicon&r=PG", "display_name": "Ralph King", "link": "https://stackoverflow.com/users/2513353/ralph-king"}, "edited": false, "score": 0, "creation_date": 1448462896, "post_id": 33919096, "comment_id": 55599986, "body": "Why is your function that is supposed to be returning two strings (as you said) not returning two strings in the first place? Surely that&#39;s a better place to start."}], "tags": [], "owner": {"reputation": 41, "user_id": 5154031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/955ya.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5154031/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1448461769, "creation_date": 1448461769, "answer_id": 33919096, "question_id": 33918460, "link": "https://stackoverflow.com/questions/33918460/convert-interface-into-string-in-golang/33919096#33919096", "title": "Convert interface{} into []string in Golang", "body": "<p>You have a slice of slices, you need to cast each slice into what you want. Let's say they're bytes and you want to print each string in the slice, then:</p>\n\n<pre><code>ret, err := fun1(....)\nif err != nil {\n     panic(err)\n}\nfor idx, val := range ret.([][]byte) {\n     fmt.Println(\"At idx\", idx, \"string:\", string(val))\n}\n</code></pre>\n\n<p>Example with the data above: <a href=\"https://play.golang.org/p/VsZhSaGmQk\" rel=\"nofollow\">https://play.golang.org/p/VsZhSaGmQk</a></p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1448465897, "post_id": 33920462, "comment_id": 55602158, "body": "well that would have been helpful information in the question."}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448466752, "post_id": 33920462, "comment_id": 55602825, "body": "It really helps, that&#39;s just what @JimB says, ref: <a href=\"https://github.com/garyburd/redigo/blob/master/redis/reply.go#L250\" rel=\"nofollow noreferrer\">github.com/garyburd/redigo/blob/master/redis/reply.go#L250</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1448465591, "creation_date": 1448465591, "answer_id": 33920462, "question_id": 33918460, "link": "https://stackoverflow.com/questions/33918460/convert-interface-into-string-in-golang/33920462#33920462", "title": "Convert interface{} into []string in Golang", "body": "<p>I know from your other questions that you are asking about Redigo. Use the <a href=\"https://godoc.org/github.com/garyburd/redigo/redis#Strings\" rel=\"nofollow\">redis.Strings</a> function to get the reply from the server as a []string:</p>\n\n<pre><code>s, err := redis.Strings(fun1(....))\n</code></pre>\n\n<p>The variabile <code>s</code> is a []string.</p>\n\n<p>See the <a href=\"https://godoc.org/github.com/garyburd/redigo/redis#hdr-Reply_Helpers\" rel=\"nofollow\">documentation about reply helpers</a> for more information.</p>\n"}], "owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2766, "favorite_count": 1, "accepted_answer_id": 33920462, "answer_count": 2, "score": 0, "last_activity_date": 1448465591, "creation_date": 1448460006, "last_edit_date": 1448465044, "question_id": 33918460, "link": "https://stackoverflow.com/questions/33918460/convert-interface-into-string-in-golang", "title": "Convert interface{} into []string in Golang", "body": "<p>I am new to GO language and I am trying to get a value from a function which returns two strings, that is <code>[str1, str2]</code></p>\n\n<pre><code> ret, err := fun1(....)\n</code></pre>\n\n<p>And function's prototype is </p>\n\n<pre><code>func fun1(...) (interface{}, error)\n</code></pre>\n\n<p>I print <code>ret</code>, it is</p>\n\n<pre><code>[[57 57 56 56] [97 100 98 49 57 55 102 98 49 101 57 48 52 98 102 56 55 102 52 56 57 57 55 54 49 55 101 57 49 100 98 49]]\n</code></pre>\n\n<p>which looks like the type <code>[][]uint8</code>, so, I tried this way</p>\n\n<pre><code>    v, _ := ret.([][]uint8)\n    str1, _ := strconv.Atoi(string(v[0]))\n    str2, _ := strconv.Atoi(string(v[1]))\n</code></pre>\n\n<p>it failed, v is <code>[]</code></p>\n\n<p>And I also tried:</p>\n\n<pre><code>   v, _ := ret.([]string)\n</code></pre>\n\n<p>nothing changed</p>\n\n<p>How to solve this?\nAny help will be appreciated :)</p>\n\n<p>PS: I debug and find the first string is <code>\"9988\"</code></p>\n"}, {"tags": ["csv", "struct", "go", "string-concatenation"], "comments": [{"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 1, "creation_date": 1448457107, "post_id": 33917278, "comment_id": 55595850, "body": "<code>reflection</code> may do this for you."}], "answers": [{"tags": [], "owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "is_accepted": true, "score": 3, "last_activity_date": 1448457987, "creation_date": 1448457987, "answer_id": 33917691, "question_id": 33917278, "link": "https://stackoverflow.com/questions/33917278/how-to-get-field-in-a-struct-dynamically/33917691#33917691", "title": "How to get field in a struct dynamically", "body": "<p>Use <a href=\"https://godoc.org/reflect\" rel=\"nofollow\">reflect</a> to iterate the struct fields.</p>\n\n<p>Here is the example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"strings\"\n)\n\ntype Event struct {\n    B_id    string\n    B_nam   string\n    B_typ   string\n    B_uuid  string\n    B_mj_id string\n    B_mi_id string\n    B_uid   string\n    B_url   string\n    B_mac   string\n    E_typ   string\n    E_time  string\n    C_id    string\n    D_os    string\n    D_os_v  string\n    D_nam   string\n    D_v     string\n    Br_nam  string\n    Br_v    string\n    A_pkg   string\n    A_id    string\n    M_u_id  string\n    // bn_id   string  //FIXME: unexported fields not work for reflection?\n}\n\nfunc main() {\n    // initialize your struct, I only take a few of fields as example.\n    e := Event{A_id: \"hah\", M_u_id: \"dadas\"}\n    v := reflect.ValueOf(e)\n\n    values := make([]string, v.NumField())\n    for i := 0; i &lt; v.NumField(); i++ {\n        values[i] = v.Field(i).String()\n    }\n\n    fmt.Println(strings.Join(values, \",\"))\n}\n</code></pre>\n\n<p>May this be helpful.</p>\n\n<p>You can run it online: <a href=\"http://play.golang.org/p/ZheOnMFRnI\" rel=\"nofollow\">http://play.golang.org/p/ZheOnMFRnI</a></p>\n"}], "owner": {"reputation": 4695, "user_id": 4057655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7e07910ec39b9b672b770c1a5c7613cd?s=128&d=identicon&r=PG&f=1", "display_name": "sag", "link": "https://stackoverflow.com/users/4057655/sag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 33917691, "answer_count": 1, "score": 0, "last_activity_date": 1448457987, "creation_date": 1448456765, "last_edit_date": 1448457277, "question_id": 33917278, "link": "https://stackoverflow.com/questions/33917278/how-to-get-field-in-a-struct-dynamically", "title": "How to get field in a struct dynamically", "body": "<p>I have the below struct. I have the method csv which will return concatenate the fields in a string with comma separated value.  </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"strconv\"\n)\n\ntype Event struct {\n    B_id string\n    B_nam string\n    B_typ int\n    B_uuid string\n    B_mj_id int\n    B_mi_id int\n    B_uid string\n    B_url string\n    B_mac string\n    E_typ string\n    E_time string\n    C_id string\n    D_os string\n    D_os_v string\n    D_nam string\n    D_v string\n    Br_nam string\n    Br_v string\n    A_pkg string\n    A_id string\n    M_u_id string\n    bn_id string\n}\n\nfunc (e *Event) Csv() string {\n    var buffer bytes.Buffer\n    var comma string = \",\"\n\n    buffer.WriteString(e.B_id)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.B_nam)\n    buffer.WriteString(comma)\n    buffer.WriteString(strconv.Itoa(e.B_typ))\n    buffer.WriteString(comma)\n    buffer.WriteString(e.B_uuid)\n    buffer.WriteString(comma)\n    buffer.WriteString(strconv.Itoa(e.B_mj_id))\n    buffer.WriteString(comma)\n    buffer.WriteString(strconv.Itoa(e.B_mi_id))\n    buffer.WriteString(comma)\n    buffer.WriteString(e.B_uid)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.B_url)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.B_mac)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.E_typ)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.E_time)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.C_id)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.D_os)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.D_os_v)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.D_nam)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.D_v)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.Br_nam)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.Br_v)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.A_pkg)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.A_id)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.M_u_id)\n    buffer.WriteString(comma)\n    buffer.WriteString(e.bn_id)\n\n    return buffer.String()\n}\n</code></pre>\n\n<p>Here you can see that I adding each fields in a buffer and returning it as a string. This code does not looks nice. </p>\n\n<p>Is it possible to get the field value dynamically? Something like,</p>\n\n<pre><code>func (e *Event) Csv() string {\n    var buffer bytes.Buffer\n    var comma string = \",\"\n\n    var x [22]string fieldValues = //Somehow get the field Values\n    for i := 0; i &lt; 22; i++ {\n      buffer.WriteString(B_id)\n      buffer.WriteString(comma)\n    }\n\n    return buffer.String()\n}\n</code></pre>\n"}, {"tags": ["iis", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1448456050, "post_id": 33916771, "comment_id": 55595107, "body": "You&#39;ll have to reverse proxy from IIS to the port your Go application is listening on: <a href=\"http://weblogs.asp.net/owscott/creating-a-reverse-proxy-with-url-rewrite-for-iis\" rel=\"nofollow noreferrer\">weblogs.asp.net/owscott/&hellip;</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1448457234, "post_id": 33916771, "comment_id": 55595940, "body": "Go also has a <a href=\"https://golang.org/pkg/net/http/fcgi/\" rel=\"nofollow noreferrer\">FastCGI responder implementation</a> and with IIS 7+ a Go server using FastCGI backend <a href=\"http://www.iis.net/learn/application-frameworks/install-and-configure-php-applications-on-iis/using-fastcgi-to-host-php-applications-on-iis\" rel=\"nofollow noreferrer\">can be run as a FCGI application</a>.  Note that the FastCGI responder is rumored to be somewhat slower than HTTP&#39;s so it <i>might</i> be more performant to do reverse HTTP proxying as @elithrar suggests. Note that your Go server may well listen to HTTP and FCGI requests simultaneously."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1448458855, "post_id": 33916771, "comment_id": 55597045, "body": "Go&#39;s FastCGI server is objectively slower, so I wouldn&#39;t recommend it. I&#39;d have to dig up the benchmarks, but the Go team has admitted it hasn&#39;t seen a lot of perf. tuning due to low demand."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1448459147, "post_id": 33916771, "comment_id": 55597257, "body": "plus, FastCGI is a relic from before HTTP/1.1, which provides most of the same benefits. There&#39;s very few reasons to use FastCGI, unless it&#39;s your only option."}, {"owner": {"user_type": "does_not_exist", "display_name": "user495093"}, "edited": false, "score": 0, "creation_date": 1448459786, "post_id": 33916771, "comment_id": 55597750, "body": "I just want to test my app on local IIS. Because I don&#39;t have access to Linux server and I can&#39;t change my OS"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448460848, "post_id": 33916771, "comment_id": 55598510, "body": "Then there&#39;s no reason to use IIS at all, unless you have it serving other assets required by your app."}], "answers": [{"tags": [], "owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "is_accepted": true, "score": 8, "last_activity_date": 1522173049, "last_edit_date": 1522173049, "creation_date": 1448462142, "answer_id": 33919230, "question_id": 33916771, "link": "https://stackoverflow.com/questions/33916771/run-go-web-application-on-iis/33919230#33919230", "title": "Run go web application on IIS", "body": "<p>Your local IIS does not work simply because you need to install a separate component, called HttpPlatformHandler module,</p>\n\n<p><a href=\"https://azure.microsoft.com/en-us/blog/announcing-the-release-of-the-httpplatformhandler-module-for-iis-8/\" rel=\"nofollow noreferrer\">https://azure.microsoft.com/en-us/blog/announcing-the-release-of-the-httpplatformhandler-module-for-iis-8/</a></p>\n\n<p><a href=\"http://www.iis.net/downloads/microsoft/httpplatformhandler\" rel=\"nofollow noreferrer\">http://www.iis.net/downloads/microsoft/httpplatformhandler</a></p>\n\n<p>Reverse proxy or FastCGI were the older approaches which are no longer necessary with this new approach.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 2306278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04c75c401f0157d02d33d84f6cf190f?s=128&d=identicon&r=PG", "display_name": "Mossila", "link": "https://stackoverflow.com/users/2306278/mossila"}, "edited": false, "score": 0, "creation_date": 1539137470, "post_id": 52706079, "comment_id": 92388340, "body": "Thanks, I start from this question as well."}, {"owner": {"reputation": 2470, "user_id": 4271117, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/DhXtA.png?s=128&g=1", "display_name": "Weihui Guo", "link": "https://stackoverflow.com/users/4271117/weihui-guo"}, "reply_to_user": {"reputation": 129, "user_id": 2306278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04c75c401f0157d02d33d84f6cf190f?s=128&d=identicon&r=PG", "display_name": "Mossila", "link": "https://stackoverflow.com/users/2306278/mossila"}, "edited": false, "score": 0, "creation_date": 1539187979, "post_id": 52706079, "comment_id": 92413666, "body": "@Mossila You are welcome. I thought this may help somebody else. Glad it&#39;s helpful to you too."}, {"owner": {"reputation": 129, "user_id": 2306278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04c75c401f0157d02d33d84f6cf190f?s=128&d=identicon&r=PG", "display_name": "Mossila", "link": "https://stackoverflow.com/users/2306278/mossila"}, "edited": false, "score": 1, "creation_date": 1539227487, "post_id": 52706079, "comment_id": 92427276, "body": "Yes, I wrote this article after I pain from finding the right way to do it for week!."}, {"owner": {"reputation": 2470, "user_id": 4271117, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/DhXtA.png?s=128&g=1", "display_name": "Weihui Guo", "link": "https://stackoverflow.com/users/4271117/weihui-guo"}, "reply_to_user": {"reputation": 129, "user_id": 2306278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04c75c401f0157d02d33d84f6cf190f?s=128&d=identicon&r=PG", "display_name": "Mossila", "link": "https://stackoverflow.com/users/2306278/mossila"}, "edited": false, "score": 0, "creation_date": 1539258787, "post_id": 52706079, "comment_id": 92441857, "body": "Oh, I didn&#39;t realize that you are the author. I should thank you then :)"}], "tags": [], "owner": {"reputation": 2470, "user_id": 4271117, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/DhXtA.png?s=128&g=1", "display_name": "Weihui Guo", "link": "https://stackoverflow.com/users/4271117/weihui-guo"}, "is_accepted": false, "score": 6, "last_activity_date": 1539014326, "creation_date": 1539014326, "answer_id": 52706079, "question_id": 33916771, "link": "https://stackoverflow.com/questions/33916771/run-go-web-application-on-iis/52706079#52706079", "title": "Run go web application on IIS", "body": "<p>HttpPlatformHandler module doesn't work for me. I found <a href=\"https://medium.com/@mossila/running-go-behind-iis-ce1a610116df\" rel=\"noreferrer\">this post by Sutean Rutjanalard on Medium</a> very helpful, which use ASP.NET Core Module instead. </p>\n\n<p>Basically, you need to create Application pool with \"No Managed Code\" as you do with a .net core app. And the following is the web.config.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;configuration&gt;\n    &lt;system.webServer&gt;\n        &lt;handlers&gt;\n            &lt;add name=\"aspNetCore\" path=\"*\" verb=\"*\" modules=\"AspNetCoreModule\" resourceType=\"Unspecified\" /&gt;\n        &lt;/handlers&gt;\n        &lt;aspNetCore processPath=\".\\YourGoApp.exe\" /&gt;\n    &lt;/system.webServer&gt;\n&lt;/configuration&gt;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user495093"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8167, "favorite_count": 7, "accepted_answer_id": 33919230, "answer_count": 2, "score": 6, "last_activity_date": 1539014326, "creation_date": 1448455168, "question_id": 33916771, "link": "https://stackoverflow.com/questions/33916771/run-go-web-application-on-iis", "title": "Run go web application on IIS", "body": "<p>Is there a way to run Go web application on IIS?<br>\nI found a setting for azure but its not working on my dev machine<br>\nthis is a web config for azure :</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n    &lt;system.webServer&gt;\n        &lt;handlers&gt;\n            &lt;add name=\"httpplatformhandler\" path=\"*\" verb=\"*\" modules=\"httpPlatformHandler\" resourceType=\"Unspecified\" /&gt;\n        &lt;/handlers&gt;\n        &lt;httpPlatform processPath=\"d:\\home\\site\\wwwroot\\go\\bin\\go.exe\" \n                      arguments=\"run d:\\home\\site\\wwwroot\\server.go\" \n                      startupTimeLimit=\"60\"&gt;\n            &lt;environmentVariables&gt;\n              &lt;environmentVariable name=\"GOROOT\" value=\"d:\\home\\site\\wwwroot\\go\" /&gt;\n            &lt;/environmentVariables&gt;\n        &lt;/httpPlatform&gt;\n    &lt;/system.webServer&gt;\n&lt;/configuration&gt;\n</code></pre>\n"}, {"tags": ["json", "struct", "go"], "comments": [{"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 1, "creation_date": 1448453539, "post_id": 33916050, "comment_id": 55593507, "body": "What about a &#39;jsonable&#39; interface where structs know how to marshall themselves? I don&#39;t have a full answer unfortunately but that way you move the structToJSON requirement to your own objects."}], "answers": [{"comments": [{"owner": {"reputation": 864, "user_id": 2513353, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f3f72320428f212b133e8e02c190b815?s=128&d=identicon&r=PG", "display_name": "Ralph King", "link": "https://stackoverflow.com/users/2513353/ralph-king"}, "edited": false, "score": 0, "creation_date": 1448454421, "post_id": 33916492, "comment_id": 55594033, "body": "Ah ok, didn&#39;t think of that. So there&#39;s no real problem with using an empty interface as an argument, as stuff in the standard library does it loads I suppose. Thanks. I&#39;ll mark this as correct!"}, {"owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "reply_to_user": {"reputation": 864, "user_id": 2513353, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f3f72320428f212b133e8e02c190b815?s=128&d=identicon&r=PG", "display_name": "Ralph King", "link": "https://stackoverflow.com/users/2513353/ralph-king"}, "edited": false, "score": 1, "creation_date": 1448454677, "post_id": 33916492, "comment_id": 55594183, "body": "Yeah, sice go doesn&#39;t have generics and doesn&#39;t allow method overload we&#39;re pretty stuck passing <code>interface{}</code> as parameters."}], "tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": true, "score": 6, "last_activity_date": 1448454560, "last_edit_date": 1448454560, "creation_date": 1448454255, "answer_id": 33916492, "question_id": 33916050, "link": "https://stackoverflow.com/questions/33916050/go-passing-generic-struct-to-function/33916492#33916492", "title": "Go - passing generic struct to function", "body": "<p>The Marshal function also receives its parameters as <code>interface{}</code> therefore there's no way to detect if you are passing something invalid at compile time, it's all caught at runtime.</p>\n\n<p>One thing you can do to check if an invalid type was passed to Marshal is to check the error type, Marshal returns an <code>UnsupportedTypeError</code> when you try to Marshal an invalid type (like <code>chan</code> or <code>func</code>) so you can check for that error when Marshaling.</p>\n\n<p>So you could try something like that:</p>\n\n<pre><code>if err != nil {\n    _, ok := err.(*json.UnsupportedTypeError)\n    if ok {\n        return []byte(\"Tried to Marshal Invalid Type\")\n    } else {\n        return []byte(\"Venue does not exist\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 864, "user_id": 2513353, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f3f72320428f212b133e8e02c190b815?s=128&d=identicon&r=PG", "display_name": "Ralph King", "link": "https://stackoverflow.com/users/2513353/ralph-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9274, "favorite_count": 0, "accepted_answer_id": 33916492, "answer_count": 1, "score": 7, "last_activity_date": 1448454560, "creation_date": 1448453005, "question_id": 33916050, "link": "https://stackoverflow.com/questions/33916050/go-passing-generic-struct-to-function", "title": "Go - passing generic struct to function", "body": "<p>Considering the following code, which is responding to GET '/venues/:id':</p>\n\n<pre><code>func venueShow(w http.ResponseWriter, req *http.Request) {\n\n  // get ID from params\n  vars := mux.Vars(req)\n  id := vars[\"id\"]\n\n  // initialise new struct\n  var venue Venue\n\n  // select by id and scan into struct\n  db.First(&amp;venue, id).Scan(&amp;venue)\n\n  // turn it to json\n  response := structToJSON(&amp;venue)\n\n  // write headers and provide response\n  w.Header().Set(\"Content-Type\", \"application/json\")\n  w.Write(response)\n}\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>func structToJSON (s interface{}) (response []byte) {\n  // turn it into pretty-ish json\n  response, err := json.MarshalIndent(&amp;s, \"\", \"  \")\n  if err != nil {\n   return []byte(\"Venue does not exist\")\n  }\n  // return the json as the reponse\n  return response\n}\n</code></pre>\n\n<p>My structToJSON function is taking an empty interface as the argument, because I want to pass various different structs to the function and have them spewed out as JSON.</p>\n\n<p>However, it doesn't strike me as very safe. If anything satisfies an empty interface, I could pass whatever I wanted into that function, and all sorts of errors might happen when json.Marshal tries to do it's business. This (I suppose) would be caught by the compiler rather than at runtime, but is there a safer way?</p>\n\n<p>I could duplicate the structToJSON method for each different type of Struct/Model that I pass to it, but that's not very DRY.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["json", "parsing", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1448447748, "post_id": 33912505, "comment_id": 55589911, "body": "And the next one. Did you take the Go Tour? Did you read the whole documentation of encoding/json?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1527748781, "post_id": 33912505, "comment_id": 88245939, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11126793/json-and-dealing-with-unexported-fields\">JSON and dealing with unexported fields</a>"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5537016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ClcgiJMYyw/AAAAAAAAAAI/AAAAAAAACGY/4Zin8hJXlPA/photo.jpg?sz=128", "display_name": "Puja Roy", "link": "https://stackoverflow.com/users/5537016/puja-roy"}, "edited": false, "score": 0, "creation_date": 1448443312, "post_id": 33912589, "comment_id": 55587072, "body": "The example you quote is a starter example. Not that mine is any harder. I am specifically looking for a case where there is an array in the json. Can you please point out the error in my approach. I have attached a go playground link with the code for your convenience. Thanks for your time in advance. Appreciate it."}, {"owner": {"reputation": 61, "user_id": 5537016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ClcgiJMYyw/AAAAAAAAAAI/AAAAAAAACGY/4Zin8hJXlPA/photo.jpg?sz=128", "display_name": "Puja Roy", "link": "https://stackoverflow.com/users/5537016/puja-roy"}, "edited": false, "score": 0, "creation_date": 1448443588, "post_id": 33912589, "comment_id": 55587235, "body": "Updated the question with your tip and with a new go playground link."}, {"owner": {"reputation": 61, "user_id": 5537016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ClcgiJMYyw/AAAAAAAAAAI/AAAAAAAACGY/4Zin8hJXlPA/photo.jpg?sz=128", "display_name": "Puja Roy", "link": "https://stackoverflow.com/users/5537016/puja-roy"}, "edited": false, "score": 0, "creation_date": 1448444281, "post_id": 33912589, "comment_id": 55587668, "body": "dude you dont even know anything about golang. Why the hell are you ruining my question ?"}, {"owner": {"reputation": 97, "user_id": 2245457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aoulW.jpg?s=128&g=1", "display_name": "mikicaivosevic", "link": "https://stackoverflow.com/users/2245457/mikicaivosevic"}, "reply_to_user": {"reputation": 61, "user_id": 5537016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ClcgiJMYyw/AAAAAAAAAAI/AAAAAAAACGY/4Zin8hJXlPA/photo.jpg?sz=128", "display_name": "Puja Roy", "link": "https://stackoverflow.com/users/5537016/puja-roy"}, "edited": false, "score": 0, "creation_date": 1448445023, "post_id": 33912589, "comment_id": 55588146, "body": "Thank you for you comment, it&#39;s true, I don&#39;t know Go lang, but I have resolved you problem. Problem is in your structure, you can&#39;t use lowercase. <a href=\"https://play.golang.org/p/hAShmfDUA_\" rel=\"nofollow noreferrer\">play.golang.org/p/hAShmfDUA_</a> Now it works"}, {"owner": {"reputation": 61, "user_id": 5537016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ClcgiJMYyw/AAAAAAAAAAI/AAAAAAAACGY/4Zin8hJXlPA/photo.jpg?sz=128", "display_name": "Puja Roy", "link": "https://stackoverflow.com/users/5537016/puja-roy"}, "edited": false, "score": 0, "creation_date": 1448445441, "post_id": 33912589, "comment_id": 55588402, "body": "Cool thanks man. You are awesome. Sorry for the harsh words. I spent hours on this silly thing and studied the whole lot of parsing."}, {"owner": {"reputation": 97, "user_id": 2245457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aoulW.jpg?s=128&g=1", "display_name": "mikicaivosevic", "link": "https://stackoverflow.com/users/2245457/mikicaivosevic"}, "reply_to_user": {"reputation": 61, "user_id": 5537016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ClcgiJMYyw/AAAAAAAAAAI/AAAAAAAACGY/4Zin8hJXlPA/photo.jpg?sz=128", "display_name": "Puja Roy", "link": "https://stackoverflow.com/users/5537016/puja-roy"}, "edited": false, "score": 0, "creation_date": 1448446114, "post_id": 33912589, "comment_id": 55588827, "body": "No problem, I&#39;m glad I was of any help!"}], "tags": [], "owner": {"reputation": 97, "user_id": 2245457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aoulW.jpg?s=128&g=1", "display_name": "mikicaivosevic", "link": "https://stackoverflow.com/users/2245457/mikicaivosevic"}, "is_accepted": false, "score": 0, "last_activity_date": 1448445979, "last_edit_date": 1495541710, "creation_date": 1448443117, "answer_id": 33912589, "question_id": 33912505, "link": "https://stackoverflow.com/questions/33912505/how-to-parse-json-into-data-structure/33912589#33912589", "title": "How to parse JSON into data structure", "body": "<p>This is example how you can resolve your problem: <a href=\"http://play.golang.org/p/id4f4r9tEr\" rel=\"nofollow noreferrer\">http://play.golang.org/p/id4f4r9tEr</a></p>\n\n<p>You might need to use <code>strconv.Unquote</code> on your string.</p>\n\n<p>And this is probably duplicate: <a href=\"https://stackoverflow.com/questions/16846553/how-to-unmarsal-escaped-json-string-on-go\">How to unmarshal an escaped JSON string in Go?</a></p>\n\n<p><strong>Resolved</strong>: <a href=\"https://play.golang.org/p/hAShmfDUA_\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hAShmfDUA_</a></p>\n\n<pre><code>type Idlist struct {\n    Id []string `json:\"ids\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 88, "user_id": 2418812, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93b1e749e5cb698d6cd085d68e74a6cf?s=128&d=identicon&r=PG", "display_name": "novieq", "link": "https://stackoverflow.com/users/2418812/novieq"}, "is_accepted": true, "score": 1, "last_activity_date": 1448445747, "last_edit_date": 1495540763, "creation_date": 1448445747, "answer_id": 33913487, "question_id": 33912505, "link": "https://stackoverflow.com/questions/33912505/how-to-parse-json-into-data-structure/33913487#33913487", "title": "How to parse JSON into data structure", "body": "<p>Your struct has to look like :</p>\n\n<pre><code>type Idlist struct {\n    Id []string `json:\"ids\"`\n}\n</code></pre>\n\n<p>Golang assumes that the fields starting with capital case are public. Hence, your fields are not visible to json decoder. For more details please look into this post :\n<a href=\"https://stackoverflow.com/questions/21825322/why-golang-cannot-generate-json-from-struct-with-front-lowercase-character\">Why Golang cannot generate json from struct with front lowercase character?</a></p>\n"}], "owner": {"reputation": 61, "user_id": 5537016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ClcgiJMYyw/AAAAAAAAAAI/AAAAAAAACGY/4Zin8hJXlPA/photo.jpg?sz=128", "display_name": "Puja Roy", "link": "https://stackoverflow.com/users/5537016/puja-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 33913487, "answer_count": 2, "score": 0, "last_activity_date": 1527748736, "creation_date": 1448442886, "last_edit_date": 1527748736, "question_id": 33912505, "link": "https://stackoverflow.com/questions/33912505/how-to-parse-json-into-data-structure", "title": "How to parse JSON into data structure", "body": "<p>I am trying to parse a JSON of the type</p>\n\n<pre><code>\"{\\\"ids\\\":[\\\"a\\\",\\\"b\\\"]}\"\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/json\"\nimport \"strings\"\n\ntype Idlist struct {\n    id []string `json:\"ids\"`\n}\nfunc main() {\n    var val []byte = []byte(`\"{\\\"ids\\\":[\\\"a\\\",\\\"b\\\"]}\"`)\n    jsonBody, _ := strconv.Unquote(string(val))\n\n    var holder Idlist\n    if err := json.NewDecoder(strings.NewReader(jsonBody)).Decode(&amp;holder); err!= nil{\n        fmt.Print(err)\n    }\n    fmt.Print(holder)\n    fmt.Print(holder.id)\n}\n</code></pre>\n\n<p>However, I keep getting output </p>\n\n<pre><code>{[]}[]\n</code></pre>\n\n<p>I cannot get the data in the structure.\nWhere am I going wrong? Here is the playground link: <a href=\"https://play.golang.org/p/82BaUlfrua\" rel=\"nofollow noreferrer\">https://play.golang.org/p/82BaUlfrua</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 4, "creation_date": 1448441610, "post_id": 33911808, "comment_id": 55586053, "body": "It is always good to support your question with code. And from your question it is not clear as to what issue are you facing while initializing DB in init method and why you want another approach outside init method"}, {"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1448459731, "post_id": 33911808, "comment_id": 55597705, "body": "You don&#39;t have initialize you db from <code>init</code> function. You can initialize from the <code>main()</code> function which calls your <code>initDB()</code>, I guess"}], "answers": [{"tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": false, "score": 3, "last_activity_date": 1448455121, "creation_date": 1448455121, "answer_id": 33916757, "question_id": 33911808, "link": "https://stackoverflow.com/questions/33911808/can-an-init-function-in-golang-return-a-value/33916757#33916757", "title": "Can an init function in golang return a value?", "body": "<p>You cannot return a value with the <code>init()</code> function but what you can do is initialize global(package) variables with it so you can try something like that:</p>\n\n<pre><code>package mysql\n\nvar Conn Connection\n\nfunc init(){\n    Conn = ...\n}\n</code></pre>\n\n<p>And now the controllers can access your connection importing your package and accessing your already initialized connection.</p>\n\n<pre><code>package controllers\n\nimport(\n    \"mysql\"\n)\n\nfunc abc(){\n    mysql.Conn ...\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 2819046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517b723a54dac4eee60dd327a3729fe7?s=128&d=identicon&r=PG&f=1", "display_name": "DhruvKalaria", "link": "https://stackoverflow.com/users/2819046/dhruvkalaria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1655, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1448455121, "creation_date": 1448440730, "question_id": 33911808, "link": "https://stackoverflow.com/questions/33911808/can-an-init-function-in-golang-return-a-value", "title": "Can an init function in golang return a value?", "body": "<p>Can any one suggest any another approach to deal with initializing a database outside init function in my server.go program ?</p>\n\n<p>I am using a MySQL in my program and it is my requirement to initialize and connect and send the handler to the controllers.</p>\n"}, {"tags": ["json", "struct", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1448441621, "post_id": 33911712, "comment_id": 55586059, "body": "This is possible the 300th question about JSON (un)marshaling with non-exported fields. Meta-question: Is really nobody able to find this information in the documentation of package encoding/json? Is this so complicated to find on SO? Why is this beeing asked over and over again?"}, {"owner": {"reputation": 562, "user_id": 1075029, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f73c0730629c7b831fcd9443abf2a66?s=128&d=identicon&r=PG", "display_name": "triunenature", "link": "https://stackoverflow.com/users/1075029/triunenature"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448441928, "post_id": 33911712, "comment_id": 55586232, "body": "Honestly, I read like 5 questions and it wasn&#39;t until directly after I posted mine, that I found one talking about the required Caps on it.  I even watched a talk on it by Google Engineers, they used caps, but didn&#39;t explain the significance of that decision."}, {"owner": {"reputation": 562, "user_id": 1075029, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f73c0730629c7b831fcd9443abf2a66?s=128&d=identicon&r=PG", "display_name": "triunenature", "link": "https://stackoverflow.com/users/1075029/triunenature"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448443033, "post_id": 33911712, "comment_id": 55586884, "body": "Also, I have written plenty of code in my life, while many languages use caps to denote meaning, I&#39;ve never seen one strongly enforced like this."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1448447628, "post_id": 33911712, "comment_id": 55589838, "body": "It is the third page of the &quot;Basics&quot; chapter in the Go Tour: <a href=\"http://tour.golang.org/basics/3\" rel=\"nofollow noreferrer\">tour.golang.org/basics/3</a> . (And the Basics chapter is the first after the Welcome chapter.) The whole Tour covers almost everything needed to know and takes maybe two hours."}, {"owner": {"reputation": 562, "user_id": 1075029, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f73c0730629c7b831fcd9443abf2a66?s=128&d=identicon&r=PG", "display_name": "triunenature", "link": "https://stackoverflow.com/users/1075029/triunenature"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448448482, "post_id": 33911712, "comment_id": 55590386, "body": "Right, and I went through the tour when I started.  But that didn&#39;t really click.  It still doesn&#39;t make sense that they use caps to determine private v public methods."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448460033, "post_id": 33911712, "comment_id": 55597937, "body": "All languages have some seemingly arbitrary rules to learn. I could say it doesn&#39;t make sense that exported identifiers need to be redeclared in separate header files for some languages."}], "answers": [{"comments": [{"owner": {"reputation": 562, "user_id": 1075029, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f73c0730629c7b831fcd9443abf2a66?s=128&d=identicon&r=PG", "display_name": "triunenature", "link": "https://stackoverflow.com/users/1075029/triunenature"}, "edited": false, "score": 0, "creation_date": 1448441146, "post_id": 33911866, "comment_id": 55585780, "body": "Yep, you beat me to it, I just realized that.  Thanks!  (I&#39;ll accept in 3 min once timer allows)"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 1, "last_activity_date": 1448440905, "creation_date": 1448440905, "answer_id": 33911866, "question_id": 33911712, "link": "https://stackoverflow.com/questions/33911712/golang-sruct-to-json-not-converting/33911866#33911866", "title": "GoLang Sruct to JSON not converting", "body": "<p>Fields in your structures starts with lower case so they are not marshalled to JSON. Make them start with upper case letter.</p>\n\n<pre><code>package main\n\nimport \"encoding/json\"\nimport \"fmt\"\n\ntype Sim struct {\n    Yr, Ag, Av, Db, Wd, St []int\n    Withdrawal             []string\n}\n\nfunc main() {\n    // Creating simulation\n    var s Sim\n\n    // Converting to JSON, for transmission over web\n    data, err := json.Marshal(s)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    // Data is correct\n    fmt.Println(s)\n\n    // Prints: {}\n    fmt.Println(string(data))\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/lQ6EanAG0E\" rel=\"nofollow\">Playground</a></kbd></p>\n\n<p><a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow\">JSON serialization in GO</a></p>\n"}], "owner": {"reputation": 562, "user_id": 1075029, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f73c0730629c7b831fcd9443abf2a66?s=128&d=identicon&r=PG", "display_name": "triunenature", "link": "https://stackoverflow.com/users/1075029/triunenature"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "closed_date": 1448441976, "accepted_answer_id": 33911866, "answer_count": 1, "score": 1, "last_activity_date": 1448440905, "creation_date": 1448440414, "question_id": 33911712, "link": "https://stackoverflow.com/questions/33911712/golang-sruct-to-json-not-converting", "closed_reason": "Duplicate", "title": "GoLang Sruct to JSON not converting", "body": "<p>I am trying to convert my struct \"Sim\" into JSON, after being filled with data.</p>\n\n<p>When I print the var s, it shows correct information, when I print data, it shows blank.</p>\n\n<p>How do I convert Struct to JSON?</p>\n\n<p>Reduced Code Below:</p>\n\n<pre><code>type Sim struct {\n    yr, ag, av, db, wd, st []int\n    withdrawal []string\n}\n\nfunc main() {\n    // Creating simulation\n    var s Sim\n\n    // Filling with data\n    s = simulate(15000, 60, 65, 90, 2015, 10.0, 140000.0, true, s)\n\n    // Converting to JSON, for transmission over web\n    data, err := json.Marshal(s)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    // Data is correct\n    fmt.Println(s)\n\n    // Prints: {}\n    fmt.Println(string(data))\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 1, "creation_date": 1448459824, "post_id": 33909997, "comment_id": 55597780, "body": "It is always good to support your question with code."}], "answers": [{"tags": [], "owner": {"reputation": 2577, "user_id": 3512709, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/sA5RZ.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3512709/adam"}, "is_accepted": false, "score": 1, "last_activity_date": 1464740790, "last_edit_date": 1495539990, "creation_date": 1464740790, "answer_id": 37557636, "question_id": 33909997, "link": "https://stackoverflow.com/questions/33909997/having-trouble-getting-a-string-out-of-my-pgx-query-using-row-to-json-in-sql-in/37557636#37557636", "title": "Having trouble getting a string out of my pgx query using row_to_json in sql in golang", "body": "<p>Ok, here's what I did. I ended up using <code>QueryRow</code> instead of <code>Query</code> because I'm only expecting one json result. I then use <code>row.Scan()</code> to get the result into a string and then <code>w.Write([]byte(result))</code> to write the resulting string to the response.</p>\n\n<p>If you have multiple rows in your result, you might need to handle the result differently. <a href=\"https://stackoverflow.com/questions/19991541/dumping-mysql-tables-to-json-with-golang\">Possibly this might help</a>?</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    var result string\n    err := postgresConn.QueryRow(`My SQL Query`).Scan(&amp;result)\n    switch {\n    case err == sql.ErrNoRows:\n        log.Printf(\"No user with that ID.\")\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.Write([]byte(\"{}\"))\n    case err != nil:\n        log.Println(err)\n        w.WriteHeader(http.StatusInternalServerError)\n    default:\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.Write([]byte(result))\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 2489204, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0Wbpv.png?s=128&g=1", "display_name": "Carson Wright", "link": "https://stackoverflow.com/users/2489204/carson-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464740790, "creation_date": 1448433644, "last_edit_date": 1448597975, "question_id": 33909997, "link": "https://stackoverflow.com/questions/33909997/having-trouble-getting-a-string-out-of-my-pgx-query-using-row-to-json-in-sql-in", "title": "Having trouble getting a string out of my pgx query using row_to_json in sql in golang", "body": "<p>Is there a way to get back a string from a pgx query if you use row_to_json etc. to format the returned rows as json text?</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    rows, err := DB.Query(\"select row_to_json(rows) as data from (select * from userinfo) rows;\")\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.Write(rows)\n}\n</code></pre>\n"}, {"tags": ["go", "encapsulation", "embedding"], "answers": [{"comments": [{"owner": {"reputation": 1673, "user_id": 768446, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c0b755ceeab7998e877cc70793b9f83?s=128&d=identicon&r=PG", "display_name": "dtg", "link": "https://stackoverflow.com/users/768446/dtg"}, "edited": false, "score": 0, "creation_date": 1448479253, "post_id": 33909150, "comment_id": 55610506, "body": "I suspected as much. The downside to the named field is that, in this scenario, I have to implement several functions in <code>MyEntity</code> as part of a contract to several interfaces that <code>TheirEntity</code> implements. Embedding allows me to satisfy that contract without having to reimplement."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 4, "last_activity_date": 1448429765, "creation_date": 1448429765, "answer_id": 33909150, "question_id": 33908672, "link": "https://stackoverflow.com/questions/33908672/private-embedded-struct-when-importing-a-struct-from-another-package/33909150#33909150", "title": "Private embedded struct when importing a struct from another package", "body": "<blockquote>\n  <p>[I]s it possible to specify embedded structs as \"private\", even if they are imported from another package?</p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>How might one achieve the same thing in a more idiomatic fashion?</p>\n</blockquote>\n\n<p>By not-embedding but making it a unexported named field.</p>\n"}], "owner": {"reputation": 1673, "user_id": 768446, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c0b755ceeab7998e877cc70793b9f83?s=128&d=identicon&r=PG", "display_name": "dtg", "link": "https://stackoverflow.com/users/768446/dtg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 33909150, "answer_count": 1, "score": 1, "last_activity_date": 1448429765, "creation_date": 1448427029, "last_edit_date": 1448429737, "question_id": 33908672, "link": "https://stackoverflow.com/questions/33908672/private-embedded-struct-when-importing-a-struct-from-another-package", "title": "Private embedded struct when importing a struct from another package", "body": "<p>I have a project which relies on a struct imported from another package, which I will call <code>TheirEntity</code>.</p>\n\n<p>In the example below, I (ahem) embed <code>TheirEntity</code> in <code>MyEntity</code>, which is an extension of <code>TheirEntity</code>, with added functionality.</p>\n\n<p>However, I don't want to export <code>TheirEntity</code> in the <code>MyEntity</code> structure, as I would rather the consumer not access <code>TheirEntity</code> directly.</p>\n\n<p>I know that Go embedding is not the same as inheritance in classical OOP, so maybe this is not the correct approach, but is it possible to specify embedded structs as \"private\", even if they are imported from another package? How might one achieve the same thing in a more idiomatic fashion?</p>\n\n<pre><code>// TheirEntity contains functionality I would like to use...\n\ntype TheirEntity struct {\n    name string\n}\n\nfunc (t TheirEntity) PrintName() {\n    fmt.Println(t.name)\n}\n\nfunc NewTheirEntity(name string) *TheirEntity {\n    return &amp;TheirEntity{name: name}\n}\n\n// ... by embedding in MyEntity\n\ntype MyEntity struct {\n    *TheirEntity // However, I don't want to expose \n                 // TheirEntity directly. How to embed this\n                 // without exporting and not changing this\n                 // to a named field?\n\n    color        string\n}\n\nfunc (m MyEntity) PrintFavoriteColor() {\n    fmt.Println(m.color)\n}\n\nfunc NewMyEntity(name string, color string) *MyEntity {\n    return &amp;MyEntity{\n        TheirEntity: NewTheirEntity(name),\n        color:       color,\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "package-management"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448429971, "post_id": 33908307, "comment_id": 55580682, "body": "Are you sure these are dependencies of <code>gominiauth</code>? If yes: Why are you sure?"}, {"owner": {"reputation": 28206, "user_id": 624884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04a353473303cb908cd95f25277a4ba2?s=128&d=identicon&r=PG&f=1", "display_name": "F21", "link": "https://stackoverflow.com/users/624884/f21"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448430461, "post_id": 33908307, "comment_id": 55580869, "body": "By looking at the sources of <code>gomniauth</code> and its dependencies. <code>gomniauth</code> depends on <code>stretchr&#47;codecs</code> which depends on <code>clganning&#47;x2j</code>, <code>ugorji&#47;go&#47;codec</code> and <code>labix.org&#47;v2&#47;mgo&#47;bson</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1448432128, "post_id": 33909622, "comment_id": 55581479, "body": "Or just <code>go get github.com&#47;stretchr&#47;gomniauth&#47;...</code>"}, {"owner": {"reputation": 28206, "user_id": 624884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04a353473303cb908cd95f25277a4ba2?s=128&d=identicon&r=PG&f=1", "display_name": "F21", "link": "https://stackoverflow.com/users/624884/f21"}, "edited": false, "score": 0, "creation_date": 1448440691, "post_id": 33909622, "comment_id": 55585514, "body": "<code>go get github.com&#47;stretchr&#47;gomniauth&#47;...</code> Works for me. What does the <code>...</code> do? Doesn&#39;t appear in the docs for <code>go get</code>: <a href=\"https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies\" rel=\"nofollow noreferrer\">golang.org/cmd/go/&hellip;</a> Also, why the need for <code>...</code>? Wouldn&#39;t people installing things with <code>go get</code> want all the dependencies so that the packages work?"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1448441671, "post_id": 33909622, "comment_id": 55586078, "body": "It&#39;s a wildcard. See <a href=\"http://stackoverflow.com/questions/28031603/what-do-three-dots-mean-in-go-command-line-invocations\" title=\"what do three dots mean in go command line invocations\">stackoverflow.com/questions/28031603/&hellip;</a>"}, {"owner": {"reputation": 28206, "user_id": 624884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04a353473303cb908cd95f25277a4ba2?s=128&d=identicon&r=PG&f=1", "display_name": "F21", "link": "https://stackoverflow.com/users/624884/f21"}, "edited": false, "score": 0, "creation_date": 1448443470, "post_id": 33909622, "comment_id": 55587169, "body": "That makes sense, but why would the default behavior not automatically expand all the import paths so that all the dependencies are installed?"}, {"owner": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1474082640, "post_id": 33909622, "comment_id": 66398565, "body": "@AmitKumarGupta when I run &#39;go get github.com/stretchr/gomniauth/...&#39; I     <code>get go: missing Bazaar command. See https:&#47;&#47;golang.org&#47;s&#47;gogetcmd package labix.org&#47;v2&#47;mgo&#47;bson: exec: &quot;bzr&quot;: executable file not found in     %PATH%</code> I just installed Bazaar and set %PATH% and I am not sure what is going on?"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "reply_to_user": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "edited": false, "score": 0, "creation_date": 1474265408, "post_id": 33909622, "comment_id": 66443114, "body": "@hellyale It seems to me that you should install Bazaar first"}, {"owner": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "edited": false, "score": 0, "creation_date": 1474303618, "post_id": 33909622, "comment_id": 66466242, "body": "@RoninDev turns out I needed to restart my computer for the install to complete &#39;doh"}], "tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": true, "score": 8, "last_activity_date": 1448432140, "last_edit_date": 1448432140, "creation_date": 1448432045, "answer_id": 33909622, "question_id": 33908307, "link": "https://stackoverflow.com/questions/33908307/go-get-not-fetching-all-dependencies/33909622#33909622", "title": "Go get not fetching all dependencies", "body": "<p>Change directory to your project and then try <code>go get ./...</code><br>\nE.g.:</p>\n\n<pre><code>cd C:\\work\\src\\github.com\\stretchr\\gomniauth\ngo get ./...\n</code></pre>\n\n<p>Or just <code>go get github.com/stretchr/gomniauth/...</code> as <strong>Amit Kumar Gupta</strong> suggested</p>\n"}, {"tags": [], "owner": {"reputation": 6283, "user_id": 434792, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/11d0482f7d0ebdbe1d42c81f7817db5d?s=128&d=identicon&r=PG", "display_name": "michaelbn", "link": "https://stackoverflow.com/users/434792/michaelbn"}, "is_accepted": false, "score": 0, "last_activity_date": 1480512132, "creation_date": 1480512132, "answer_id": 40889540, "question_id": 33908307, "link": "https://stackoverflow.com/questions/33908307/go-get-not-fetching-all-dependencies/40889540#40889540", "title": "Go get not fetching all dependencies", "body": "<p>In my case I was missing the <a href=\"http://bazaar.canonical.com/\" rel=\"nofollow noreferrer\">bzr package</a>.</p>\n\n<p>After adding it using <code>dnf install bzr</code> and running @RoninDev suggestion it worked as expected:</p>\n\n<pre><code>cd $GOPATH/src/github.com/stretchr/gomniauth\ngo get ./...\n</code></pre>\n"}], "owner": {"reputation": 28206, "user_id": 624884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04a353473303cb908cd95f25277a4ba2?s=128&d=identicon&r=PG&f=1", "display_name": "F21", "link": "https://stackoverflow.com/users/624884/f21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4644, "favorite_count": 0, "accepted_answer_id": 33909622, "answer_count": 2, "score": 8, "last_activity_date": 1480512132, "creation_date": 1448424299, "question_id": 33908307, "link": "https://stackoverflow.com/questions/33908307/go-get-not-fetching-all-dependencies", "title": "Go get not fetching all dependencies", "body": "<p>I am using go 1.5.1 on Windows 8.1 64-bit. I do not have <code>GO15VENDOREXPERIMENT</code> set in my environment. I have the latest version of git and bazaar installed.</p>\n\n<p>I am trying to get the <code>gomniauth</code> package:</p>\n\n<pre><code>go get github.com/stretchr/gomniauth\n</code></pre>\n\n<p>Even though the process completes without any error, a lot of dependencies aren't pulled in.</p>\n\n<p>For example, when compiling my app (which depends on gomniauth), I get these errors:</p>\n\n<pre><code>..\\github.com\\stretchr\\codecs\\xml\\simple_xml_codec.go:5:2: cannot find package \"github.com/clbanning/x2j\" in any of:\n    C:\\Go\\src\\github.com\\clbanning\\x2j (from $GOROOT)\n    C:\\work\\src\\github.com\\clbanning\\x2j (from $GOPATH)\n..\\github.com\\stretchr\\codecs\\msgpack\\msgpack_codec.go:6:2: cannot find package \"github.com/ugorji/go/codec\" in any of:\n    C:\\Go\\src\\github.com\\ugorji\\go\\codec (from $GOROOT)\n    C:\\work\\src\\github.com\\ugorji\\go\\codec (from $GOPATH)\n..\\github.com\\stretchr\\codecs\\bson\\bson_codec.go:5:2: cannot find package \"labix.org/v2/mgo/bson\" in any of:\n    C:\\Go\\src\\labix.org\\v2\\mgo\\bson (from $GOROOT)\n    C:\\work\\src\\labix.org\\v2\\mgo\\bson (from $GOPATH)\n</code></pre>\n\n<p>It seems to pull in the direct dependencies for <code>gomniauth</code>, but doesn't pull in the dependencies of the dependencies. I have gone and deleted the <code>stretchr</code> folder from my <code>GOPATH/src</code> as well as <code>GOPATH/pkg</code>, but after running <code>go get</code> many times, it is still not pulling in the any dependencies beyond the second level.</p>\n\n<p>I am 100% confident there are no network issues on my end. I can  access those github repos using my browser or curl.</p>\n"}, {"tags": ["macos", "go", "atom-editor"], "comments": [{"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1448437371, "post_id": 33907929, "comment_id": 55583824, "body": "<a href=\"http://elfxp.com/mac-xcrun-error/\" rel=\"nofollow noreferrer\">elfxp.com/mac-xcrun-error</a>"}, {"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1448437413, "post_id": 33907929, "comment_id": 55583844, "body": "try this command <code>sudo xcode-select -switch</code>"}], "owner": {"reputation": 1, "user_id": 5602246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WhYtm.jpg?s=128&g=1", "display_name": "MILOSCRIPT", "link": "https://stackoverflow.com/users/5602246/miloscript"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484850395, "creation_date": 1448421502, "last_edit_date": 1484850395, "question_id": 33907929, "link": "https://stackoverflow.com/questions/33907929/fail-to-install-go-plus-package-in-atom-under-osx-10-11-1", "title": "fail to install &quot;go-plus&quot; package in Atom under OSX 10.11.1", "body": "<p>I am a freshman on programming. I want to start with Golang. When I was installing  the \"go-plus\"package in Atom. I met with such a problem.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Cn414.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cn414.png\" alt=\"problem screenshot\"></a></p>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 2, "creation_date": 1448413669, "post_id": 33906721, "comment_id": 55576264, "body": "A channel is like a conveyor belt. When you&#39;re doing things like <code>c &lt;- &quot;wait3 finished\\n&quot;</code> you&#39;re not storing that &quot;as&quot; a channel... you&#39;re sending it <i>down</i> a channel. Imagine it literally like a conveyor belt that you have workers putting strings of text on. One after the other they are sent down the belt and plucked off at the end when you receive them (the <code>&lt;-c, &lt;-c, &lt;-c</code> part does this)."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1448413724, "post_id": 33906721, "comment_id": 55576293, "body": "In addition to the above... perhaps this image makes it clearer for you? <a href=\"http://1.bp.blogspot.com/-GkVAtGeUzrs/UwIQ6AezJmI/AAAAAAAANYE/5XWpxN-zA3w/s1600/Screen+Shot+2014-02-17+at+8.38.15+AM.png\" rel=\"nofollow noreferrer\">1.bp.blogspot.com/-GkVAtGeUzrs/UwIQ6AezJmI/AAAAAAAANYE/&hellip;</a>"}, {"owner": {"reputation": 7, "user_id": 3974554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/782883359/picture?type=large", "display_name": "Takaaki Furuse", "link": "https://stackoverflow.com/users/3974554/takaaki-furuse"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1448500793, "post_id": 33906721, "comment_id": 55619152, "body": "Simon, I really love your picture and metaphor to conveyor belt. I&#39;ve been thinking that Go has created 3 different conveyor belt called &quot;c&quot;. Looks it&#39;s not."}], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1448434118, "post_id": 33906856, "comment_id": 55582279, "body": "Actually, I&#39;d rather compare a channel to a <a href=\"https://en.m.wikipedia.org/wiki/Named_pipe\" rel=\"nofollow noreferrer\">named pipe</a>: it has name, by which you can use it, it <b>is</b> a FIFO (no real priorities, first come, first serve) and once a value is read from it, it is removed from the queue."}], "tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": true, "score": 0, "last_activity_date": 1448413863, "creation_date": 1448413863, "answer_id": 33906856, "question_id": 33906721, "link": "https://stackoverflow.com/questions/33906721/go-channel-my-code-looks-overwriting-channels-but-works/33906856#33906856", "title": "Go Channel - My code looks overwriting channels but works.", "body": "<p>As far as I understood, you view channels as a variable. A variable that can hold some value. So if there was some <code>value1</code> and you wrote another <code>value2</code> you basically expect the <code>value1</code> to disappear. Which is wrong.</p>\n\n<p>Try to take a look at the channels as a buffer or a priority queue (some people find it crude comparison). Channel has it's size (your third variable <code>3</code>) which tells how many values can be simultaneously in it. Once you put something in the channel, you can view it as being processes with the priority equal to amount of time needed to finish this go-routine.</p>\n\n<p>So in your case you put 3 elements in your priority queue with <code>go wait()</code> and then extracted from a queue with <code>w1, w2, w3 := &lt;-c, &lt;-c, &lt;-c</code>. So nothing gets overwritten. </p>\n"}, {"tags": [], "owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "is_accepted": false, "score": 0, "last_activity_date": 1448470498, "creation_date": 1448470498, "answer_id": 33922187, "question_id": 33906721, "link": "https://stackoverflow.com/questions/33906721/go-channel-my-code-looks-overwriting-channels-but-works/33922187#33922187", "title": "Go Channel - My code looks overwriting channels but works.", "body": "<p>Unbuffered channels sync before sending data through.  So in this case, your successive calls to <code>&lt;-c</code> in your assignment line block until the wait functions on the other end sends something through.</p>\n\n<p>Markus makes an excellent point though and it should be pointed out that this <code>w1, w2, w3 := &lt;-c, &lt;-c, &lt;-c</code> only works because you've staggered the wait times for your different wait functions.  If those functions waited an arbitrary amount of time before sending data on the channel, you would not have any guarantee that w2 gets assigned to the result sent from wait2.  It would just be set to which ever value was the second value sent through the channel.</p>\n"}], "owner": {"reputation": 7, "user_id": 3974554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/782883359/picture?type=large", "display_name": "Takaaki Furuse", "link": "https://stackoverflow.com/users/3974554/takaaki-furuse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 33906856, "answer_count": 2, "score": 0, "last_activity_date": 1448470498, "creation_date": 1448412845, "question_id": 33906721, "link": "https://stackoverflow.com/questions/33906721/go-channel-my-code-looks-overwriting-channels-but-works", "title": "Go Channel - My code looks overwriting channels but works.", "body": "<p>I just started learning Go recently and I was confused when I learning Goroutine. \nHere's my code. This intends to finish 3 processes concurrently. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\nfunc wait1(c chan string) {\n    time.Sleep(1 * time.Second)\n    log.Print(\"waited 1 sec\")\n    c &lt;- \"wait1 finished\\n\"\n\n}\n\nfunc wait2(c chan string) {\n    time.Sleep(2 * time.Second)\n    log.Print(\"waited 2 sec\")\n    c &lt;- \"wait2 finished\\n\"\n}\n\nfunc wait3(c chan string) {\n    time.Sleep(3 * time.Second)\n    log.Print(\"waited 3 sec\")\n    c &lt;- \"wait3 finished\\n\"\n}\n\nfunc main() {\n    c := make(chan string, 3)\n    log.Print(\"started\")\n    go wait1(c)\n    go wait2(c)\n    go wait3(c)\n    w1, w2, w3 := &lt;-c, &lt;-c, &lt;-c\n    log.Print(\"finished\")\n    fmt.Println(w1, w2, w3)\n}\n</code></pre>\n\n<p>For me, this part looks inputting different functions into the same channel called c and trying to print the values received from c. </p>\n\n<pre><code>c := make(chan string, 3)\nlog.Print(\"started\")\ngo wait1(c)\ngo wait2(c)\ngo wait3(c)\nw1, w2, w3 := &lt;-c, &lt;-c, &lt;-c\nlog.Print(\"finished\")\nfmt.Println(w1, w2, w3)\n</code></pre>\n\n<p>However, as you can see, output is what I expected. It processes 3 functions at the same time and returns \"finished\" statement. </p>\n\n<pre><code>2015/11/25 09:41:31 started\n2015/11/25 09:41:32 waited 1 sec\n2015/11/25 09:41:33 waited 2 sec\n2015/11/25 09:41:34 waited 3 sec\n2015/11/25 09:41:34 finished\nwait1 finished\nwait2 finished\nwait3 finished\n</code></pre>\n\n<p>Why it's unnecessary to create 3 different channels like c1, c2, c3...?\nWhy value is not overwritten even though I'm using the same channel called c?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 3, "creation_date": 1448409439, "post_id": 33906141, "comment_id": 55574859, "body": "Truly global variables don&#39;t exist in Go and you shouldn&#39;t be using them here anyway. What you need is <code>func slope(inputX io.Scanner)</code> and then when you call it in <code>inputXfunc()</code> you should pass <code>inputX</code> into it."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 3, "creation_date": 1448409483, "post_id": 33906141, "comment_id": 55574875, "body": "If you want a variable that can be accessed by all the methods in your program above without having to pass it into any of them then just declare it above main outside any method and it will be &#39;package scoped&#39; which in this case is global cause you have on package <code>main</code>."}, {"owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "edited": false, "score": 0, "creation_date": 1448461066, "post_id": 33906141, "comment_id": 55598657, "body": "inputX io.Scanner DOES NOT WORK IN MY CODE it gives a undefined error on &quot;io&quot;"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1448478081, "post_id": 33906141, "comment_id": 55609840, "body": "you have to add import &quot;io&quot; to use io.Scanner"}, {"owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "edited": false, "score": 0, "creation_date": 1448501494, "post_id": 33906141, "comment_id": 55619303, "body": "already tried to import &quot;io &quot; to no avail."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "edited": false, "score": 0, "creation_date": 1448460782, "post_id": 33906196, "comment_id": 55598458, "body": "This code did not work for me at all. I am looking for a way to pass input from one section of the code to another function. Surely there is a way to do that in go."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "edited": false, "score": 1, "creation_date": 1448472446, "post_id": 33906196, "comment_id": 55606597, "body": "@liam yes and it&#39;s outlined in the second example and would work fine if you understood it and applied it to your program. There was a mistake in that I had <code>io.Scanner</code> instead of <code>bufio.Scanner</code> but it&#39;s just an example. In applying it to your program it should become clear that you&#39;re not importing the <code>io</code> package and <code>bufio</code> is the thing you call <code>NewScanner</code> from."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 7, "last_activity_date": 1448472470, "last_edit_date": 1448472470, "creation_date": 1448409610, "answer_id": 33906196, "question_id": 33906141, "link": "https://stackoverflow.com/questions/33906141/in-go-how-do-i-make-global-variables/33906196#33906196", "title": "In go, how do I make global variables", "body": "<p>I'm just putting my comment as an answer... I would recommend against this however you could just declare the variable at package scope. It would look like this;</p>\n\n<pre><code>package main \n\nimport (\n    \"fmt\"\n    \"bufio\"\n    \"os\"\n)\n\nvar inputX io.Scanner\n\nfunc main() {\n    fmt.Print(\"LOADED!\\n\")\n    fmt.Print(\"insert y value here: \")\n    inputY := bufio.NewScanner(os.Stdin)\n    inputY.Scan()\n    inputXfunc()\n}\n\nfunc inputXfunc() {\n    fmt.Print(\"insert x value here: \")\n    inputX = bufio.NewScanner(os.Stdin) // get rid of assignment initilize short hand here\n    inputX.Scan()\n    slope()\n}\n\nfunc slope() {\n    fmt.Println(inputX.Text())\n}\n</code></pre>\n\n<p>However a better choice would be to change your method definitions to accept arguments and pass the values into them as needed. This would like like so;</p>\n\n<pre><code>func slope(inputX bufio.Scanner) {\n        fmt.Println(inputX.Text())\n    }\n\n slope(myInputWhichIsOfTypeIOScanner)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 2, "last_activity_date": 1448475636, "creation_date": 1448475636, "answer_id": 33923785, "question_id": 33906141, "link": "https://stackoverflow.com/questions/33906141/in-go-how-do-i-make-global-variables/33923785#33923785", "title": "In go, how do I make global variables", "body": "<p>You can create an <code>init()</code> function and make use of it in the <code>main.go</code> by using package like <code>godotenv</code> to set os's environment variables:</p>\n\n<p><code>global.go</code> file </p>\n\n<pre><code>package global\n\nimport (\n    \"log\"\n    \"os\"\n    \"strconv\"\n\n    \"github.com/joho/godotenv\"\n)\n\nvar (\n    SERVER_HOST        string\n    SERVER_PORT        int\n)\n\nfunc InitConfig() {\n\n    err := godotenv.Load()\n    if err != nil {\n        log.Fatal(\"Error loading .env file\")\n    }\n\n    SERVER_HOST = os.Getenv(\"SERVER_HOST\")\n    SERVER_PORT, _ = strconv.Atoi(os.Getenv(\"SERVER_PORT\"))\n}\n</code></pre>\n\n<p><code>main.go</code> file</p>\n\n<pre><code>package main\n\nimport(\n    G \"path/to/config\"\n)\n\nfunc init() {\n    G.InitConfig()\n}\n\nfunc main() {\n    G.Init()\n}\n</code></pre>\n\n<p>You will still have to import \"G\" package in other packages to use the variables, but I think the best way to tackle global variables in Go (or any other languages) is to make use of environment variables.</p>\n"}], "owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16614, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1448475636, "creation_date": 1448409329, "question_id": 33906141, "link": "https://stackoverflow.com/questions/33906141/in-go-how-do-i-make-global-variables", "title": "In go, how do I make global variables", "body": "<pre><code>package main \n\nimport (\n    \"fmt\"\n    \"bufio\"\n    \"os\"\n)\n\nfunc main() {\n    fmt.Print(\"LOADED!\\n\")\n    fmt.Print(\"insert y value here: \")\n    inputY := bufio.NewScanner(os.Stdin)\n    inputY.Scan()\n    inputXfunc()\n}\n\nfunc inputXfunc() {\n    fmt.Print(\"insert x value here: \")\n    inputX := bufio.NewScanner(os.Stdin)\n    inputX.Scan()\n    slope()\n}\n\nfunc slope() {\n    fmt.Println(inputX.Text())\n}\n</code></pre>\n\n<p>Whenever I run this program, it says, that inputX and inputY are unidentified. How do I make this program use variables that are accessible to all of the functions? All I want to do is devide inputY by inputX then print out the result</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1448402291, "post_id": 33904503, "comment_id": 55571907, "body": "Can you show your code? You shouldn&#39;t be panicking on errors that you want to propagate to the user: return the error, inspect it, and return the appropriate status code."}, {"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1448404981, "post_id": 33904503, "comment_id": 55573178, "body": "@elithrar This is more like a generic approach. Let&#39;s say I have 10 routes on my rest API and handling this in each route is repetition . I want to define a handler and wrap with it much like recovery handler does."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1448405262, "post_id": 33904503, "comment_id": 55573292, "body": "Don&#39;t panic. Create a custom type that implements http.Handler but returns an error, so you can return status codes as needed and process then in the ServeHTTP method for your type. See my post here <a href=\"http://elithrar.github.io/article/http-handler-error-handling-revisited/\" rel=\"nofollow noreferrer\">elithrar.github.io/article/&hellip;</a> and a previous answer about custom handler types here: <a href=\"http://stackoverflow.com/a/33647455/556573\">stackoverflow.com/a/33647455/556573</a> - if you&#39;re still confused, I&#39;ll write a minimal example when I get off the bus!"}, {"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1448408815, "post_id": 33904503, "comment_id": 55574649, "body": "@elithrar I will give it a try. Thanks"}, {"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1448474261, "post_id": 33904503, "comment_id": 55607680, "body": "@elithrar see my updates to the question. Want to know whats the preferred approach between the 2 I mentioned (or any other better option)"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1448497948, "post_id": 33904503, "comment_id": 55618445, "body": "Again, there is honestly no reason to panic. A panic should represent an irrecoverable error, or (in certain cases), a way to unwind the stack from a deeply-nested function (which you should recover at the top level). None of this applies to a &#39;field missing&#39; case. See my answer in a few moments."}], "answers": [{"comments": [{"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1448513641, "post_id": 33928972, "comment_id": 55622276, "body": "This is similar to the first approach I mentioned in my question. sendErrorResponse handles the centralized error handling. However at every step developer is expected to check for error and call sendErrorResponse and return. This is a pain. In languages like Java/Python, idiomatic is to throw/raise exceptions and catch them. This raise/throw and catch is what I mentioned in 2nd approach. I see your point but I still feel its lot of unnecessary code inside handler which pollutes the main logic. <code>if foo,err =   func3(); err != nil { &#47;&#47;centralized handling of error ; return }</code> is repetitive."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 1, "creation_date": 1448514707, "post_id": 33928972, "comment_id": 55622591, "body": "The <code>if err != nil</code> idiom is part of Go&#39;s design. Your approach also has a cost (defer isn&#39;t free). Local error handling is common in Go programs. Go isn&#39;t Java and trying to force that will require you to do more work to get around it (as you are finding!)."}, {"owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "edited": false, "score": 0, "creation_date": 1448769720, "post_id": 33928972, "comment_id": 55714782, "body": "Perhaps go creators are more influenced by C language. Just wrote my first rest API in Go. Code is definitely ugly due to verbosity in error handling . I changed it use panics/recovery and code is much clean and easy to read now ."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 4, "last_activity_date": 1448499272, "creation_date": 1448499272, "answer_id": 33928972, "question_id": 33904503, "link": "https://stackoverflow.com/questions/33904503/go-gorilla-panic-handler-to-respond-with-custom-status/33928972#33928972", "title": "Go Gorilla panic handler to respond with custom status", "body": "<p>It is idiomatic to lean on the interfaces provided by the standard library as much as possible. In this case, the <code>http.Handler</code> interface from the <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow\">net/http</a> package.</p>\n\n<p>In your case, you can create a new type that allows your handlers to return an error type, and handle all of those error cases centrally.</p>\n\n<pre><code>// StatusError wraps an existing error with a HTTP status code.\ntype StatusError struct {\n    Status int\n    // Allows you to wrap another error\n    Err error\n}\n\nfunc (e *StatusError) Error() string {\n    return e.Error()\n}\n\ntype AppHandler func(w http.ResponseWriter, r *http.Request) error\n\n// Satisfies the http.Handler interface\nfunc (ah AppHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    // Centralises your error handling\n    err := ah(w, r)\n    if err != nil {\n        switch e := a.(type) {\n        case *StatusError:\n            switch e.Status {\n            case 400:\n                http.Error(w, e.Err.Error(), 400)\n                return\n            case 404:\n                http.NotFound(w, r)\n                return\n            default:\n                http.Error(w, http.StatusText(500), 500)\n                return\n        }\n        default:\n            http.Error(w, http.StatusText(500), 500)\n            return\n        }\n}\n\n// Your handlers will look like this\nfunc SomeHandler(w http.ResponseWriter, r *http.Request) error {\n    err := decode(r, myInstance)\n    if err != nil {\n        return &amp;StatusError{400, err}\n    }\n\n    err := file.validate()\n    if err != nil {\n        return &amp;StatusError{400, err}\n    }\n\n    // Continue on...\n    return nil\n}\n</code></pre>\n\n<p>The benefits you get here include:</p>\n\n<ul>\n<li>No panicking for errors that can be handled</li>\n<li>You can centralise your error handling in your <code>ServeHTTP</code> method - i.e. for 400 errors, you might write the error reason to the response. For 500 errors, you might return a generic message since a HTTP 500 isn't something the user can be expected to solve.</li>\n<li>Your handler functions return errors explicitly, and you no longer need to remember to use naked <code>return</code> statements to avoid continued execution.</li>\n<li>Your <code>StatusError</code> type wraps the error with a status code, but still allows you to inspect/log/write out the wrapped error easily.</li>\n</ul>\n\n<p>Further reading:</p>\n\n<ul>\n<li><a href=\"http://blog.golang.org/error-handling-and-go\" rel=\"nofollow\">http://blog.golang.org/error-handling-and-go</a></li>\n<li><a href=\"http://elithrar.github.io/article/http-handler-error-handling-revisited/\" rel=\"nofollow\">http://elithrar.github.io/article/http-handler-error-handling-revisited/</a></li>\n<li><a href=\"http://dave.cheney.net/2014/12/24/inspecting-errors\" rel=\"nofollow\">http://dave.cheney.net/2014/12/24/inspecting-errors</a></li>\n</ul>\n"}], "owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2054, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1448883885, "creation_date": 1448401697, "last_edit_date": 1448883885, "question_id": 33904503, "link": "https://stackoverflow.com/questions/33904503/go-gorilla-panic-handler-to-respond-with-custom-status", "title": "Go Gorilla panic handler to respond with custom status", "body": "<p>In Gorilla, using <a href=\"http://www.gorillatoolkit.org/pkg/handlers#RecoveryHandler\" rel=\"nofollow\">RecoveryHandler</a> we could suppress the panics. However is there a handler or a library method to respond with a specific Http status code and message for given error type.<br>\nFor example, in case of a Panic for <code>Mandatory field missing error</code>, one would want to respond with <code>Http 400</code> and a meaningful message of what exactly is wrong with the payload.<br></p>\n\n<p>What is the recommended approach to do this? <br> \n<strong>UPDATE</strong>\nIn code: 2 approaches are listed</p>\n\n<ol>\n<li>Handle errors returned at each method call and build the response.</li>\n<li>Instead of returning errors, panic with custom error types and defer the error recovery to a func to build the response. This makes the code easy to read and less repetitive.</li>\n</ol>\n\n<pre><code>func fooHandler(w http.ResponseWriter, r *http.Request) {\n    //decode the request body into a struct instance\n    if err := decode(r, myInstance); err != nil {\n        sendErrorResponse(w,err,http.StatusBadRequest)\n        return\n    }\n    //validate the struct instance for all mandatory keys presence\n    if err := file.validate(); err != nil {\n        sendErrorResponse(w,err,http.StatusBadRequest)\n        return\n    }\n    //call DB and validate the response and handle the error\n\n    //do some computation and again handle error.\n\n    //finally construct response \n}\n\nfunc barHandler(w http.ResponseWriter, r *http.Request) {\n    //similar to above handler many funcs are called before the response is contruscted\n}\n\nfunc tomHandler(w http.ResponseWriter, r *http.Request) {\n    //similar to above handler many funcs are called before the response is contruscted\n}\n\nfunc differentHandler(w http.ResponseWriter, r *http.Request) {\n    defer recoverForErrors(w,r)\n    // call as many funcs as you need.\n    // validation, decoding etc will panic instead of returning errors.\n    // This will avoid the repetitive boiler plate code of handling error and converting to meaningful error response\n    // instead all this logic is pushed to recoverForErrors func. Which retrieves the error from panic and checks for \n    // specific error type to construct the error http response\n}\n</code></pre>\n"}, {"tags": ["c++", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448400118, "post_id": 33903974, "comment_id": 55570715, "body": "Are you using swig? cgo only understands C, not C++."}, {"owner": {"reputation": 61, "user_id": 5580399, "user_type": "registered", "profile_image": "https://graph.facebook.com/918255471573213/picture?type=large", "display_name": "Alonso Vidales Migu&#233;lez", "link": "https://stackoverflow.com/users/5580399/alonso-vidales-migu%c3%a9lez"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448406326, "post_id": 33903974, "comment_id": 55573731, "body": "I&#39;m using cgo, but I made a wrapper for the libraries using extern &quot;C&quot; { ... } in order to reference the C++ code"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448407140, "post_id": 33903974, "comment_id": 55574000, "body": "I&#39;m not sure of the details around C++ and <code>extern &quot;C&quot;</code>, but I would first try to make a simple C program that calls the library in the same manner to establish if it actually has anything to do with Go. Maybe try swig, which may do something automatically which you&#39;re missing (the go build tool automatically uses swig files)."}], "owner": {"reputation": 61, "user_id": 5580399, "user_type": "registered", "profile_image": "https://graph.facebook.com/918255471573213/picture?type=large", "display_name": "Alonso Vidales Migu&#233;lez", "link": "https://stackoverflow.com/users/5580399/alonso-vidales-migu%c3%a9lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1448400183, "creation_date": 1448399764, "last_edit_date": 1448399902, "question_id": 33903974, "link": "https://stackoverflow.com/questions/33903974/invocation-static-vars-from-c-on-cgo", "title": "Invocation static vars from C++ on cgo", "body": "<p>I have a static var that calls to a constructor in a library in C++, something like this:</p>\n\n<pre><code>class ClassToBuild {\n public:\n  ClassToBuild() {\n    // Some cool stuff happens here...\n  }\n};\nstatic ClassToBuild classToBuild;\n</code></pre>\n\n<p>The problem is that when this file is included in C++, the constructor is being called before the main function, but when I include this libraries from Go, the constructor is not being called.\nThis are third part libraries that I can't modify, and the ClassToBuild is not exposed in the header, so I can't call it from outside.</p>\n\n<p>How can I do to execute the constructor?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["json", "go", "marshalling"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1448398493, "post_id": 33903552, "comment_id": 55569859, "body": "I&#39;d recommend revising your question slightly because I believe you&#39;re looking for a feature like <code>PreserveReferencesHandling</code> in newtonsoft&#39;s json.NET library (C#) however, I could correctly answer your question by unmarshalling something like <code>{&quot;name&quot;:&quot;evan&quot;,&quot;age&quot;:26}</code> because the last paragraph of your question isn&#39;t very specific. From that quote, it sounds like you need to implement <code>UnmarshalJSON</code> for your type. To be clear, you want to do this in Go; <a href=\"http://stackoverflow.com/questions/17818386/how-to-serialize-as-json-an-object-structure-with-circular-references\" title=\"how to serialize as json an object structure with circular references\">stackoverflow.com/questions/17818386/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1448398604, "post_id": 33903552, "comment_id": 55569917, "body": "Marshal a type which implements json.Marshaler by bringing its own MarshalJSON method and errors always. Dead simple. Absolutely no input(s) used."}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448398752, "post_id": 33903552, "comment_id": 55570013, "body": "Yes, thanks @Volker -- that&#39;s what I should have done. #facepalm"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448399353, "post_id": 33903552, "comment_id": 55570324, "body": "Not sure why this hase been downvotes... @Volker - I&#39;d gladly mark your comment as the accepted answer."}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448407833, "post_id": 33903552, "comment_id": 55574251, "body": "@JimB - I&#39;m not unmarshalling raw json into a structure. I&#39;m marshalling a structure to json and handling the potential error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448408916, "post_id": 33903552, "comment_id": 55574680, "body": "Yes sorry, completely misread."}, {"owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "edited": false, "score": 2, "creation_date": 1448455969, "post_id": 33903552, "comment_id": 55595033, "body": "To answer directly your question, if you pass channels or functions to the Marshal function you&#39;ll get a json.UnsupportedTypeError and if you pass a struct with a type that has value math.Inf or math.NaN you&#39;ll get a json.UnsupportedValueError"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "reply_to_user": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "edited": false, "score": 1, "creation_date": 1448652184, "post_id": 33903552, "comment_id": 55684658, "body": "Oh, if only you had submitted your comment as an actual answer @hbejgel..."}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 151741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0415ca8483fa8eefed7778824b3d68?s=128&d=identicon&r=PG", "display_name": "Jonathan Oliver", "link": "https://stackoverflow.com/users/151741/jonathan-oliver"}, "is_accepted": false, "score": 26, "last_activity_date": 1495825911, "last_edit_date": 1495825911, "creation_date": 1448485670, "answer_id": 33926433, "question_id": 33903552, "link": "https://stackoverflow.com/questions/33903552/what-input-will-cause-golangs-json-marshal-to-return-an-error/33926433#33926433", "title": "What input will cause golang&#39;s json.Marshal to return an error?", "body": "<p><strong>Update: now using a channel instead of a map[int]int to elicit the error</strong></p>\n\n<hr>\n\n<p>Go-specific structures,e.g. <code>func</code> or <code>chan</code> refuse to serialize:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    value := make(chan int)\n    _, err := json.Marshal(value)\n    fmt.Println(err)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9266, "user_id": 1465640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b64a91edcfaad3c6290039008deea285?s=128&d=identicon&r=PG", "display_name": "Pylinux", "link": "https://stackoverflow.com/users/1465640/pylinux"}, "edited": false, "score": 0, "creation_date": 1581497254, "post_id": 33964549, "comment_id": 106449908, "body": "Could this then be interpreted as &quot;as long as the type doesn&#39;t change&quot; the <code>err</code> can safely be ignored?"}], "tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": false, "score": 36, "last_activity_date": 1448656822, "creation_date": 1448656822, "answer_id": 33964549, "question_id": 33903552, "link": "https://stackoverflow.com/questions/33903552/what-input-will-cause-golangs-json-marshal-to-return-an-error/33964549#33964549", "title": "What input will cause golang&#39;s json.Marshal to return an error?", "body": "<p>Just to complement Jonathan's answer, the json.Marshal function can return two types of errors: <code>UnsupportedTypeError</code> or <code>UnsupportedValueError</code></p>\n\n<p>The first one can be caused, as Jonathan said by trying to Marshal an invalid type:</p>\n\n<pre><code>_, err := json.Marshal(make(chan int))\n_, ok := err.(*json.UnsupportedTypeError) // ok == true\n</code></pre>\n\n<p>On the other hand you can also have the Marshal function return an error by passing an invalid value:</p>\n\n<pre><code>_, err := json.Marshal(math.Inf(1))\n_, ok := err.(*json.UnsupportedValueError) // ok == true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2345, "user_id": 2102087, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0382d81dd8afcfa8058df1bdb27fe197?s=128&d=identicon&r=PG", "display_name": "Denis V", "link": "https://stackoverflow.com/users/2102087/denis-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1583076949, "creation_date": 1583076949, "answer_id": 60476743, "question_id": 33903552, "link": "https://stackoverflow.com/questions/33903552/what-input-will-cause-golangs-json-marshal-to-return-an-error/60476743#60476743", "title": "What input will cause golang&#39;s json.Marshal to return an error?", "body": "<p>A while ago I was solving a problem of serializing/deserializing cyclic references in golang, and all the links go to this question. However, it's slightly misleading as the question is broader.</p>\n\n<p>If you got into the same situation like me, and can't find a solution on how to deal with cyclic references, you can now use <a href=\"https://github.com/go-extras/tahwil\" rel=\"nofollow noreferrer\">tahwil</a> - a new library that I published on github. To my knowledge it's now the only library that facilitates serialization/deserialization of cyclic data structures in a generic way.</p>\n\n<p><a href=\"https://github.com/go-extras/tahwil/blob/master/README.md\" rel=\"nofollow noreferrer\">Readme</a> gives the information on how to use the library, so I will only duplicate the examples here.</p>\n\n<h3>Encoding:</h3>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n\n    \"github.com/go-extras/tahwil\"\n)\n\ntype Person struct {\n    Name     string\n    Parent   *Person\n    Children []*Person\n}\n\nfunc main() {\n    parent := &amp;Person{\n        Name: \"Arthur\",\n        Children: []*Person{\n            {\n                Name: \"Ford\",\n            },\n            {\n                Name: \"Trillian\",\n            },\n        },\n    }\n    parent.Children[0].Parent = parent\n    parent.Children[1].Parent = parent\n    v, err := tahwil.ToValue(parent)\n    if err != nil {\n        panic(err)\n    }\n    res, err := json.Marshal(v)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(res))\n}\n</code></pre>\n\n<h3>Decoding:</h3>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n\n    \"github.com/go-extras/tahwil\"\n)\n\ntype Person struct {\n    Name     string    `json:\"name\"`\n    Parent   *Person   `json:\"parent\"`\n    Children []*Person `json:\"children\"`\n}\n\nfunc prepareData() []byte {\n    parent := &amp;Person{\n        Name: \"Arthur\",\n        Children: []*Person{\n            {\n                Name: \"Ford\",\n            },\n            {\n                Name: \"Trillian\",\n            },\n        },\n    }\n    parent.Children[0].Parent = parent\n    parent.Children[1].Parent = parent\n    v, err := tahwil.ToValue(parent)\n    if err != nil {\n        panic(err)\n    }\n    res, err := json.Marshal(v)\n    if err != nil {\n        panic(err)\n    }\n    return res\n}\n\nfunc main() {\n    data := &amp;tahwil.Value{}\n    res := prepareData()\n    err := json.Unmarshal(res, data)\n    if err != nil {\n        panic(err)\n    }\n    person := &amp;Person{}\n    err = tahwil.FromValue(data, person)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(`Name: %s\nChildren:\n    - %s\n    -- parent name: %s\n    - %s\n    -- parent name: %s\n`, person.Name,\n        person.Children[0].Name,\n        person.Children[0].Parent.Name,\n        person.Children[1].Name,\n        person.Children[1].Parent.Name)\n}\n</code></pre>\n\n<p>The main idea is to transform the original data to <code>tahwil.Value{}</code>, which essentially adds <code>refid</code>'s to all of your fields. Whenever <code>tahwil</code> encounters a cyclic reference, it replaces the actual object with a reference. And after that the graph is technically not cyclic anymore and thus can be marshalled to json.</p>\n\n<p>Restoring the data means a reverse operation, i.e. any reference will be replaced by a pointer to an object.</p>\n\n<p>P.S. Why <code>tahwil</code>? I tried to find some uncommon word for the name, and found an Arabic word (\u062a\u062d\u0648\u064a\u0644) that means <em>conversion</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 129, "user_id": 8140152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kylGe.png?s=128&g=1", "display_name": "AnonymousX", "link": "https://stackoverflow.com/users/8140152/anonymousx"}, "is_accepted": false, "score": 5, "last_activity_date": 1610860292, "last_edit_date": 1610860292, "creation_date": 1599485956, "answer_id": 63778731, "question_id": 33903552, "link": "https://stackoverflow.com/questions/33903552/what-input-will-cause-golangs-json-marshal-to-return-an-error/63778731#63778731", "title": "What input will cause golang&#39;s json.Marshal to return an error?", "body": "<p>Read the source code you can found such a function to judge a encoder if not exist will return marshal error: <a href=\"https://github.com/golang/go/blob/master/src/encoding/json/encode.go\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/encoding/json/encode.go</a></p>\n<pre class=\"lang-golang prettyprint-override\"><code>func newTypeEncoder(t reflect.Type, allowAddr bool) encoderFunc {\n    // ignored\n    switch t.Kind() {\n    case reflect.Bool:\n        return boolEncoder\n    case reflect.Int, reflect.Int8, reflect.Int16, reflect.Int32, reflect.Int64:\n        return intEncoder\n    case reflect.Uint, reflect.Uint8, reflect.Uint16, reflect.Uint32, reflect.Uint64, reflect.Uintptr:\n        return uintEncoder\n    case reflect.Float32:\n        return float32Encoder\n    case reflect.Float64:\n        return float64Encoder\n    case reflect.String:\n        return stringEncoder\n    case reflect.Interface:\n        return interfaceEncoder\n    case reflect.Struct:\n        return newStructEncoder(t)\n    case reflect.Map:\n        return newMapEncoder(t)\n    case reflect.Slice:\n        return newSliceEncoder(t)\n    case reflect.Array:\n        return newArrayEncoder(t)\n    case reflect.Ptr:\n        return newPtrEncoder(t)\n    default:\n        return unsupportedTypeEncoder\n    }\n}\n</code></pre>\n<p>We can find all kinds enum\nat <a href=\"https://github.com/golang/go/blob/master/src/reflect/type.go\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/reflect/type.go</a></p>\n<p>So it's not hard to see that kinds not in above function are unable to marshal:</p>\n<pre><code>UnsafePointer,Complex64,Complex128,Chan,Func\n</code></pre>\n<p>Examples:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>        json.Marshal(unsafe.Pointer(nil)) // UnsafePointer\n        json.Marshal(complex64(1))        // Complex64\n        json.Marshal(complex128(1))       // Complex128\n        json.Marshal(make(chan struct{})) // Chan\n        json.Marshal(func() {})           // Func\n</code></pre>\n"}], "owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24134, "favorite_count": 4, "answer_count": 4, "score": 47, "last_activity_date": 1610860292, "creation_date": 1448398277, "question_id": 33903552, "link": "https://stackoverflow.com/questions/33903552/what-input-will-cause-golangs-json-marshal-to-return-an-error", "title": "What input will cause golang&#39;s json.Marshal to return an error?", "body": "<p>From the <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>JSON cannot represent cyclic data structures and Marshal does not handle them. Passing cyclic structures to Marshal will result in an infinite recursion.</p>\n</blockquote>\n\n<p>I've experienced this situation, which results in a runtime panic.</p>\n\n<p>What I'm wondering is if anyone can provide a working program that demonstrates a non-panic situation where json.Marshal returns a non-nil error. The best answers would <strong>clearly include the inputs used</strong>.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": false, "score": 7, "last_activity_date": 1448396638, "creation_date": 1448396638, "answer_id": 33903115, "question_id": 33903020, "link": "https://stackoverflow.com/questions/33903020/initializing-a-field-inside-an-anonymous-struct/33903115#33903115", "title": "Initializing a field inside an anonymous struct", "body": "<p>Yes, you can do this. Look at this example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    myMap := struct {\n        list       map[string]string\n        someStuff interface{}\n    }{\n        list: make(map[string]string),\n        someStuff: 2,\n    }\n\n    fmt.Println(myMap)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": true, "score": 11, "last_activity_date": 1448396666, "creation_date": 1448396666, "answer_id": 33903121, "question_id": 33903020, "link": "https://stackoverflow.com/questions/33903020/initializing-a-field-inside-an-anonymous-struct/33903121#33903121", "title": "Initializing a field inside an anonymous struct", "body": "<p>Here you go:</p>\n\n<pre><code>var myMap = struct {\n  list map[string]string\n  str string\n}{\n  list: map[string]string{\"hello\":\"string\"},\n  str: \"myString\",\n}\n</code></pre>\n\n<p>You can also do it this way:</p>\n\n<pre><code>var myMap = struct {\n  list map[string]string\n  str string\n}{map[string]string{\"hello\":\"string\"}, \"myString\"}\n</code></pre>\n\n<p>And a working example: <kbd><a href=\"https://play.golang.org/p/j1l2epoB_s\" rel=\"noreferrer\">Go PlayGround</a></kbd>.</p>\n\n<p>So you declare your structure and then in curly braces you initiate it. (I learned it from <a href=\"https://talks.golang.org/2012/10things.slide#3\" rel=\"noreferrer\">this old go talk</a>.)</p>\n"}], "owner": {"reputation": 3172, "user_id": 1290581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/22cb75bc69d807d5597d7b9922a3775c?s=128&d=identicon&r=PG", "display_name": "garbagecollector", "link": "https://stackoverflow.com/users/1290581/garbagecollector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4298, "favorite_count": 2, "accepted_answer_id": 33903121, "answer_count": 2, "score": 4, "last_activity_date": 1448396666, "creation_date": 1448396296, "question_id": 33903020, "link": "https://stackoverflow.com/questions/33903020/initializing-a-field-inside-an-anonymous-struct", "title": "Initializing a field inside an anonymous struct", "body": "<p>Given this anonymous struct:</p>\n\n<pre><code>var myMap struct {\n  list       map[string]string\n  someStuff *some.Object\n}\n</code></pre>\n\n<p>Can I initialize the <code>list</code> and <code>someStuff</code> in one declaration?</p>\n\n<p>This doesn't work:</p>\n\n<pre><code>var myMap struct {\n  list       map[string]string = make(map[string]string)\n  someStuff *some.Object = &amp;some.Object{}\n}\n</code></pre>\n"}, {"tags": ["go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": true, "score": 2, "last_activity_date": 1448396167, "creation_date": 1448396167, "answer_id": 33902991, "question_id": 33902212, "link": "https://stackoverflow.com/questions/33902212/go-gorilla-recoveryhandler-compile-error/33902991#33902991", "title": "Go Gorilla RecoveryHandler compile error", "body": "<p>It seems the documentation is incorrect. <code>handlers.RecoveryHandler</code> can not be used as a http handler middleware itself, it returns one. Looking at the signature</p>\n\n<pre><code>func RecoveryHandler(opts ...RecoveryOption) func(h http.Handler) http.Handler\n</code></pre>\n\n<p>we can see that it takes 0 or more <code>handlers.RecoveryOption</code>s and returns a <code>func(http.Handler) http.Handler</code>. That func that it returns is what we actually want to wrap around our router. We can write it as</p>\n\n<pre><code>recoveryHandler := handlers.RecoveryHandler()\nhttp.ListenAndServe(\":1123\", recoveryHandler(r))\n</code></pre>\n\n<p>Or you could do it all in one line</p>\n\n<pre><code>http.ListenAndServe(\":1123\", handlers.RecoveryHandler()(r))\n</code></pre>\n"}], "owner": {"reputation": 5728, "user_id": 2184930, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/460a48b8097cbd52e7315e349f6a84f3?s=128&d=identicon&r=PG", "display_name": "suman j", "link": "https://stackoverflow.com/users/2184930/suman-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 33902991, "answer_count": 1, "score": 1, "last_activity_date": 1448396167, "creation_date": 1448393499, "last_edit_date": 1448393818, "question_id": 33902212, "link": "https://stackoverflow.com/questions/33902212/go-gorilla-recoveryhandler-compile-error", "title": "Go Gorilla RecoveryHandler compile error", "body": "<p>Trying to use <a href=\"http://www.gorillatoolkit.org/pkg/handlers#RecoveryHandler\" rel=\"nofollow\">RecoverHandler</a>, compile from Intellij fails.</p>\n\n\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    panic(\"Unexpected error!\")\n})\n\nhttp.ListenAndServe(\":1123\", handlers.RecoveryHandler(r))\n</code></pre>\n\n<p>I get below errors. Above code is from gorilla documenation as-is used and I did run <code>go get github.com/gorilla/handlers</code>.</p>\n\n<pre>\nsrc/main.go:48: cannot use r (type *mux.Router) as type handlers.RecoveryOption in argument to handlers.RecoveryHandler\nsrc/main.go:48: cannot use handlers.RecoveryHandler(r) (type func(http.Handler) http.Handler) as type *mux.Router in assignment\n</pre>\n\n<p>How do I use RecoveryHandler of Gorilla?</p>\n"}, {"tags": ["mongodb", "data-structures", "go", "mgo"], "comments": [{"owner": {"reputation": 341, "user_id": 2124946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dcbb3b1808bf768d0868935eac39a54?s=128&d=identicon&r=PG&f=1", "display_name": "Phlex", "link": "https://stackoverflow.com/users/2124946/phlex"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1448398044, "post_id": 33901286, "comment_id": 55569582, "body": "Thanks for the tip about the pointers! I will get the actual code output here shortly. I tried playing around with it before, but was still getting errors (on the array I had a different declaration), but I will get the output here soon!"}, {"owner": {"reputation": 341, "user_id": 2124946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dcbb3b1808bf768d0868935eac39a54?s=128&d=identicon&r=PG&f=1", "display_name": "Phlex", "link": "https://stackoverflow.com/users/2124946/phlex"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1448398432, "post_id": 33901286, "comment_id": 55569815, "body": "Couldn&#39;t edit my comment, but here&#39;s the output of the error: <code>Cannot take the address of bson.objectId(findJ.ID)</code>"}, {"owner": {"reputation": 341, "user_id": 2124946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dcbb3b1808bf768d0868935eac39a54?s=128&d=identicon&r=PG&f=1", "display_name": "Phlex", "link": "https://stackoverflow.com/users/2124946/phlex"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1448399115, "post_id": 33901286, "comment_id": 55570214, "body": "Also, another error that has been popping up is <code>ObjectIDs must be exactly 12 bytes long (got 0)</code>."}, {"owner": {"reputation": 341, "user_id": 2124946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dcbb3b1808bf768d0868935eac39a54?s=128&d=identicon&r=PG&f=1", "display_name": "Phlex", "link": "https://stackoverflow.com/users/2124946/phlex"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1448400621, "post_id": 33901286, "comment_id": 55570994, "body": "After removing all pointers, the aforementioned of a 0 byte ObjectID was passed. Thanks for your help so far!"}, {"owner": {"reputation": 341, "user_id": 2124946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dcbb3b1808bf768d0868935eac39a54?s=128&d=identicon&r=PG&f=1", "display_name": "Phlex", "link": "https://stackoverflow.com/users/2124946/phlex"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1448402877, "post_id": 33901286, "comment_id": 55572175, "body": "Sorry, I mean the error specifically is saying it&#39;s not passing the proper ID. As in, if I print findJ.ID before, it outputs the value <code>ObjectIdHex(&quot;5654df213610fec33e7eb342&quot;) panic: ObjectIDs must be exactly 12 bytes long (got 0) </code> and then the panic happens right after, when it is trying to insert into the group (and yes, I am switching collections to group itself too)"}], "owner": {"reputation": 341, "user_id": 2124946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dcbb3b1808bf768d0868935eac39a54?s=128&d=identicon&r=PG&f=1", "display_name": "Phlex", "link": "https://stackoverflow.com/users/2124946/phlex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1324, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448390186, "creation_date": 1448390186, "question_id": 33901286, "link": "https://stackoverflow.com/questions/33901286/inserting-arrays-of-object-ids-in-mgo", "title": "Inserting arrays of Object IDs in mgo", "body": "<p>So recently I've been trying to insert different types of data into structures using mgo, and I've ran into a bit of a snag. When trying to insert an array of object IDs, I can't seem to figure out that format if I were to populate that object ID array within the structure.</p>\n\n<p>Here's the structure as follows</p>\n\n<pre><code>type Group struct {\nID        bson.ObjectId     `json:\"id\" bson:\"_id\"`\nGroupName string            `json:\"groupName\"`\nUserIDs   []*bson.ObjectId      `json:\"users\" bson:\"userid\"`\nExpected  []*int            `json:\"expected\"`\nActual    []*int            `json:\"actual\"`\n}\n</code></pre>\n\n<p>And the operation I am trying to run is to insert a new \"test\" table with a single userID into UserIDs.</p>\n\n<pre><code>array := []*bson.ObjectId{&amp;findJ.ID}\n\nc = Session.DB(\"test\").C(\"Group\")\nerr = c.Insert(&amp;Group{GroupName: \"test\", UserIDs: array})\nThisPanic(err) \n</code></pre>\n\n<p>Where findJ has it's own ID from a separate structure. What am I doing wrong here, as it is causing a panic on inserting the array.</p>\n"}, {"tags": ["json", "go", "types", "websocket", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 3659, "user_id": 2080324, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/137499a9336eeb82972414ee5b3efa62?s=128&d=identicon&r=PG", "display_name": "Rudi Strydom", "link": "https://stackoverflow.com/users/2080324/rudi-strydom"}, "is_accepted": false, "score": 3, "last_activity_date": 1448390509, "creation_date": 1448390509, "answer_id": 33901374, "question_id": 33901055, "link": "https://stackoverflow.com/questions/33901055/golang-working-with-types/33901374#33901374", "title": "Golang Working with types", "body": "<p>Sorry, I was being a bit stupid with this. The <code>message</code> is already a byte type interface. I didn't properly encode the data on the HTML / JavaScript frontend before sending it to the backend.</p>\n\n<p>What worked was stringifying it in the frontend:</p>\n\n<pre><code>var data = {};\ndata.type = \"user\";\ndata.value = user.val();\nconn.send(JSON.stringify(data));\nJSON.stringify(data)\n</code></pre>\n\n<p>Then I was able to unmarshall the JSON:</p>\n\n<pre><code>2015/11/24 20:36:04 {user fhgfhg}\n2015/11/24 20:36:04 user\n2015/11/24 20:36:04 fhgfhg\n</code></pre>\n"}], "owner": {"reputation": 3659, "user_id": 2080324, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/137499a9336eeb82972414ee5b3efa62?s=128&d=identicon&r=PG", "display_name": "Rudi Strydom", "link": "https://stackoverflow.com/users/2080324/rudi-strydom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448390509, "creation_date": 1448389371, "question_id": 33901055, "link": "https://stackoverflow.com/questions/33901055/golang-working-with-types", "title": "Golang Working with types", "body": "<p><strong>The Problem</strong></p>\n\n<p>I need some help working with types in Golang, I get super confused. I am trying to alter the websocket chat example from Gorilla, and I want to pass in JSON and process it accordingly. I need to be able to set for example a user, and send a message to the websocket. </p>\n\n<p>In the current implementation all it does is receive a string, and relays it back by broadcasting it to all connected clients. </p>\n\n<p>For example I want to be able to set a data structure as follows and process it differently. </p>\n\n<p>Incoming user would be:</p>\n\n<pre><code>{\n  'type': \"user\",\n  'value': \"John Doe\"\n}\n</code></pre>\n\n<p>Incomming message would be:</p>\n\n<pre><code>{\n  'type': \"message\",\n  'value': \"Hi There, how are you?\"\n}\n</code></pre>\n\n<p>Please refer to the following code:\n<a href=\"https://github.com/gorilla/websocket/blob/master/examples/chat/conn.go#L52\" rel=\"nofollow\">https://github.com/gorilla/websocket/blob/master/examples/chat/conn.go#L52</a></p>\n\n<pre><code>for {\n    _, message, err := c.ws.ReadMessage()\n    if err != nil {\n        break\n    }\n    h.broadcast &lt;- message\n}\n</code></pre>\n\n<p><strong>Data</strong></p>\n\n<p>So the above code works for single strings, because all the server does is pass the incoming message from any client to all. But I want to be able to save users, and send the list of active users back to the client along with the new message. </p>\n\n<p>To do this, in my mind I will need to handle the different incoming messages differently. I tried to unmarchal the incomming <code>message</code>, but when I print out the type it's this:</p>\n\n<pre><code>2015/11/24 20:03:10 []uint8\n</code></pre>\n\n<p><strong>THE QUESTION</strong></p>\n\n<p>How do I go about reading this input stream, and unmarshal it to JSON? This is the debugging I added to the section:</p>\n\n<pre><code>for {\n    _, dataString, err := c.ws.ReadMessage()\n    if err != nil {\n        break\n    }\n\n    log.Println(reflect.TypeOf(dataString))\n\n    var data MessageData\n    err = json.Unmarshal(dataString, &amp;data)\n    log.Println(data.Type)\n    log.Println(data.Value)\n\n    if err != nil {\n        log.Println(err)\n    }\n\n    h.broadcast &lt;- dataString\n}\n</code></pre>\n\n<p><strong>Which Returns</strong></p>\n\n<pre><code>2015/11/24 20:03:10 []uint8\n2015/11/24 20:03:10 \n2015/11/24 20:03:10 \n</code></pre>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448379812, "post_id": 33897193, "comment_id": 55558248, "body": "Why (un)marshal at all? Parse the XML and output the new structure on the fly."}, {"owner": {"reputation": 153, "user_id": 69564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ffdd924aee8399a11fa70294c6cdc0?s=128&d=identicon&r=PG", "display_name": "jihoonc", "link": "https://stackoverflow.com/users/69564/jihoonc"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448416450, "post_id": 33897193, "comment_id": 55577064, "body": "Just didn&#39;t want to parse XML by hand. My current xml data is way more complicated than the above example :).  So far seems like &quot;parsing the xml by hand&quot; or &quot;using a second struct&quot; is the only choice I have..."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1448378998, "creation_date": 1448378998, "answer_id": 33897606, "question_id": 33897193, "link": "https://stackoverflow.com/questions/33897193/restructuring-xml-by-using-only-one-struct-type-for-marshal-unmarshal-ing-in-go/33897606#33897606", "title": "Restructuring xml by using only one struct type for marshal/unmarshal-ing in go", "body": "<p>Using a second struct is the most convenient way I see. If you don't want to make it exported, you can actually hide the other type inside your <code>MarshalXML</code>:</p>\n\n<pre><code>func (r *Result) MarshalXML(enc *xml.Encoder, start xml.StartElement) error {\n    type Restructured struct {\n        Person string\n        ID     int `xml:\"Id\"`\n    }\n    rr := &amp;Restructured{Person: r.Person, ID: r.ID}\n    return enc.Encode(rr)\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/jZU2Jg0ZRZ\" rel=\"nofollow\">http://play.golang.org/p/jZU2Jg0ZRZ</a>.</p>\n"}], "owner": {"reputation": 153, "user_id": 69564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ffdd924aee8399a11fa70294c6cdc0?s=128&d=identicon&r=PG", "display_name": "jihoonc", "link": "https://stackoverflow.com/users/69564/jihoonc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448378998, "creation_date": 1448377885, "question_id": 33897193, "link": "https://stackoverflow.com/questions/33897193/restructuring-xml-by-using-only-one-struct-type-for-marshal-unmarshal-ing-in-go", "title": "Restructuring xml by using only one struct type for marshal/unmarshal-ing in go", "body": "<p>Say I have following block of xml data.</p>\n\n<pre><code>  &lt;Result&gt;\n      &lt;person&gt;\n          &lt;name&gt;Dave&lt;/name&gt;\n      &lt;/person&gt;\n      &lt;id&gt;\n          &lt;number&gt;1234&lt;/number&gt;\n      &lt;/id&gt;\n  &lt;/Result&gt;\n</code></pre>\n\n<p>and I want to restructure it to following.</p>\n\n<pre><code>  &lt;Restructured&gt;\n      &lt;Person&gt;Dave&lt;/Person&gt;\n      &lt;Id&gt;1234&lt;/Id&gt;\n  &lt;/Restructured&gt;\n</code></pre>\n\n<p>But only using one struct to do it. Is it possible?</p>\n\n<p>Attaching code below.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"os\"\n)\n\ntype Result struct {\n    Person string `xml:\"person&gt;name\"`\n    Id     int    `xml:\"id&gt;number\"`\n}\n\ntype Restructured struct {\n    Person string\n    Id     int\n}\n\nconst data = `\n&lt;Result&gt;\n    &lt;person&gt;\n        &lt;name&gt;Dave&lt;/name&gt;\n    &lt;/person&gt;\n    &lt;id&gt;\n        &lt;number&gt;1234&lt;/number&gt;\n    &lt;/id&gt;\n&lt;/Result&gt;`\n\nfunc main() {\n    v := Result{}\n    err := xml.Unmarshal([]byte(data), &amp;v)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        return\n    }\n\n    newV := Restructured{Person: v.Person, Id: v.Id}\n\n    output, err := xml.MarshalIndent(newV, \"  \", \"    \")\n    if err != nil {\n        fmt.Printf(\"error: %v\\n\", err)\n    }\n\n    os.Stdout.Write(output)\n}\n</code></pre>\n\n<p>I don't want to do it like this, allocating a new type of struct(\"newV\") and copying field by field.\nIs there any way to marshal automatically with different xml tags using original struct \"v\"?</p>\n"}, {"tags": ["json", "pointers", "dictionary", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 5586999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d6ede0f59d47a14f8ab7659e08972c?s=128&d=identicon&r=PG&f=1", "display_name": "user208383", "link": "https://stackoverflow.com/users/5586999/user208383"}, "edited": false, "score": 0, "creation_date": 1448376012, "post_id": 33895704, "comment_id": 55555420, "body": "Thank you very much!!! That helped me solve the problem! (However, I still don&#39;t understand why my other code did not work, but I hope I&#39;ll understand that once I&#39;m not that much of a newbie in golang anymore.)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 97, "user_id": 5586999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d6ede0f59d47a14f8ab7659e08972c?s=128&d=identicon&r=PG&f=1", "display_name": "user208383", "link": "https://stackoverflow.com/users/5586999/user208383"}, "edited": false, "score": 0, "creation_date": 1448376427, "post_id": 33895704, "comment_id": 55555742, "body": "@user208383: You seem to be stumbling on how pointers work more than Go specifically. Try working through the <a href=\"http://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Tour Of Go</a> which has examples that might be of help to you."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1448374553, "last_edit_date": 1448374553, "creation_date": 1448373894, "answer_id": 33895704, "question_id": 33895505, "link": "https://stackoverflow.com/questions/33895505/q-golang-pointer-to-mapstringinterface/33895704#33895704", "title": "Q: golang pointer to map[string]interface{}", "body": "<p>There's a number of things causing confusion here:</p>\n\n<ul>\n<li>You don't need <code>b</code> at all. You're passing a pointer to a byte slice that you're reassigning inside the function. Just use the string directly. </li>\n<li>There's no need to us a pointer to the <code>sJson</code> string. Strings are immutable, and you're not trying to reassign the <code>sJson</code> variable.</li>\n<li>You're unmarshaling into an empty interface, and then trying to reassign the <code>myMap</code> variable to the contents of <code>f</code>. Since <code>myMap</code> isn't a pointer, that assignment is only scoped to within the function. Just unmarshal directly into <code>myMap</code></li>\n</ul>\n\n<p>If you change those things, you'll find the <code>json2map</code> function ends up being one line, and can be dropped altogether:</p>\n\n<pre><code>func json2map(sJson string, myMap map[string]interface{}) error {\n    return json.Unmarshal([]byte(sJson), &amp;myMap)\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 5586999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d6ede0f59d47a14f8ab7659e08972c?s=128&d=identicon&r=PG&f=1", "display_name": "user208383", "link": "https://stackoverflow.com/users/5586999/user208383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2585, "favorite_count": 0, "accepted_answer_id": 33895704, "answer_count": 1, "score": 1, "last_activity_date": 1448424273, "creation_date": 1448373308, "last_edit_date": 1448424273, "question_id": 33895505, "link": "https://stackoverflow.com/questions/33895505/q-golang-pointer-to-mapstringinterface", "title": "Q: golang pointer to map[string]interface{}", "body": "<p>I (golang newbie) am trying to create a map[string]interfaces{} in a function. The code compiles and runs but the map is empty.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"   \n    \"encoding/json\" \n)\n\n\nfunc main() {\n    var f interface{}\n    var sJson string                    // JSON string from VT\n    var err error                       // errors\n    var b []byte                        // bytearray of JSON string\n    var rootMap map[string]interface{}\n\n    rootMap = make(map[string]interface{})\n\n    sJson=`{\"key\": \"foo\"}`\n\n    fmt.Println(sJson)\n\n    err = json2map(&amp;b, &amp;sJson, f, rootMap)\n\n    if err != nil { return }\n\n    switch v := rootMap[\"key\"].(type) {\n        case float64:\n            fmt.Printf(\"Value: %d\",v)\n        case string:\n            fmt.Printf(\"Value: %s\", v)\n        case nil:\n            fmt.Println(\"key is nil\")           \n        default:\n            fmt.Println(\"type is unknown\")          \n    }       \n}\n\nfunc json2map(b *[]byte, sJson *string, f interface{}, myMap map[string]interface{}) error {\n    var err error\n    *b = []byte(*sJson) \n    err = json.Unmarshal(*b,&amp;f) \n    myMap = f.(map[string]interface{})\n    return err\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>{\"key\": \"foo\"}\nkey is nil\n</code></pre>\n\n<p>I found <a href=\"http://www.goinggo.net/2013/07/understanding-pointers-and-memory.html\" rel=\"nofollow\">this article</a> which describes how to use map[string]string. This code works as expected:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype MyType struct {\n    Value1 int\n    Value2 string\n}\n\nfunc main() {\n    myMap := make(map[string]string)\n    myMap[\"key\"] = \"foo\"\n    ChangeMyMap(myMap)  \n    fmt.Printf(\"Value : %s\\n\",  myMap[\"key\"])    \n}\n\nfunc ChangeMyMap(TheMap map[string]string) {\n    TheMap[\"key\"] = \"bar\"\n}\n</code></pre>\n\n<p>So I think my problem has to do with the map being of type interface instead of string but I cannot tell why the first code doesn't work, while the 2nd does.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 818, "user_id": 4238326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5j2E9.jpg?s=128&g=1", "display_name": "vanarajcs", "link": "https://stackoverflow.com/users/4238326/vanarajcs"}, "edited": false, "score": 0, "creation_date": 1448366290, "post_id": 33892725, "comment_id": 55548982, "body": "Thanks Ronindev. type Result struct {     name   string     Objects []struct {         id int         name string         email string     } } How to add values for this?"}, {"owner": {"reputation": 818, "user_id": 4238326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5j2E9.jpg?s=128&g=1", "display_name": "vanarajcs", "link": "https://stackoverflow.com/users/4238326/vanarajcs"}, "edited": false, "score": 0, "creation_date": 1448367252, "post_id": 33892725, "comment_id": 55549684, "body": "RobinDev, How to add multiple variable in append?"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "reply_to_user": {"reputation": 818, "user_id": 4238326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5j2E9.jpg?s=128&g=1", "display_name": "vanarajcs", "link": "https://stackoverflow.com/users/4238326/vanarajcs"}, "edited": false, "score": 0, "creation_date": 1448367404, "post_id": 33892725, "comment_id": 55549766, "body": "@vanarajcs something like this <code>r.Objects = append(r.Objects, struct{ id int }{10}, struct{ id int }{20})</code>"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "reply_to_user": {"reputation": 818, "user_id": 4238326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5j2E9.jpg?s=128&g=1", "display_name": "vanarajcs", "link": "https://stackoverflow.com/users/4238326/vanarajcs"}, "edited": false, "score": 0, "creation_date": 1448367469, "post_id": 33892725, "comment_id": 55549808, "body": "It&#39;s better to use named type for your <code>struct{ id int }</code>, as @matt-schofield suggested"}, {"owner": {"reputation": 818, "user_id": 4238326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5j2E9.jpg?s=128&g=1", "display_name": "vanarajcs", "link": "https://stackoverflow.com/users/4238326/vanarajcs"}, "edited": false, "score": 0, "creation_date": 1448367757, "post_id": 33892725, "comment_id": 55550000, "body": "r.Objects = append(r.Objects, struct{ id int, string name}{ 10 &quot;Vanaraj&quot;}) is it right?"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "reply_to_user": {"reputation": 818, "user_id": 4238326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5j2E9.jpg?s=128&g=1", "display_name": "vanarajcs", "link": "https://stackoverflow.com/users/4238326/vanarajcs"}, "edited": false, "score": 0, "creation_date": 1448367988, "post_id": 33892725, "comment_id": 55550165, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/96028/discussion-between-ronindev-and-vanarajcs\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": false, "score": 3, "last_activity_date": 1448365283, "creation_date": 1448365283, "answer_id": 33892725, "question_id": 33892599, "link": "https://stackoverflow.com/questions/33892599/how-to-initialize-values-for-nested-struct-array-in-golang/33892725#33892725", "title": "How to initialize values for nested struct array in golang", "body": "<p><code>Objects</code> contains no elements. You need to <code>append</code> element first. Like this:  </p>\n\n<pre><code>r.Objects = append(r.Objects, struct{ id int }{}) \n</code></pre>\n\n<p>Also you can omit <code>r.Objects[0].id = 10;</code> using initialization of your struct like this:  </p>\n\n<pre><code>r.Objects = append(r.Objects, struct{ id int }{ 10 })\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4148, "user_id": 1362776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfQih.png?s=128&g=1", "display_name": "Roma Rush", "link": "https://stackoverflow.com/users/1362776/roma-rush"}, "edited": false, "score": 0, "creation_date": 1479996611, "post_id": 33892965, "comment_id": 68799413, "body": "length must be specified in make, isn&#39;t it? <code>make([]MyStruct, 0)</code>"}, {"owner": {"reputation": 739, "user_id": 3390851, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/HEm4K.jpg?s=128&g=1", "display_name": "Katiyman", "link": "https://stackoverflow.com/users/3390851/katiyman"}, "edited": false, "score": 0, "creation_date": 1558087821, "post_id": 33892965, "comment_id": 98993775, "body": "Is there a way without refactoring the code to initialize the array of Objects"}, {"owner": {"reputation": 1274, "user_id": 2056908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e377dc7a85bd71485eb514a49d64e362?s=128&d=identicon&r=PG", "display_name": "mattsch", "link": "https://stackoverflow.com/users/2056908/mattsch"}, "reply_to_user": {"reputation": 739, "user_id": 3390851, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/HEm4K.jpg?s=128&g=1", "display_name": "Katiyman", "link": "https://stackoverflow.com/users/3390851/katiyman"}, "edited": false, "score": 0, "creation_date": 1558268433, "post_id": 33892965, "comment_id": 99036844, "body": "@Katiyman if you mean that you want to initialise a list of, say, 10 Objects, I think you could use <code>r.Objects = make([]MyStruct, 10)</code>."}], "tags": [], "owner": {"reputation": 1274, "user_id": 2056908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e377dc7a85bd71485eb514a49d64e362?s=128&d=identicon&r=PG", "display_name": "mattsch", "link": "https://stackoverflow.com/users/2056908/mattsch"}, "is_accepted": false, "score": 19, "last_activity_date": 1479999596, "last_edit_date": 1479999596, "creation_date": 1448365932, "answer_id": 33892965, "question_id": 33892599, "link": "https://stackoverflow.com/questions/33892599/how-to-initialize-values-for-nested-struct-array-in-golang/33892965#33892965", "title": "How to initialize values for nested struct array in golang", "body": "<p>Firstly, I'd say it's more idiomatic to define a type for your struct, regardless of how simple the struct is. For example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type MyStruct struct {\n    MyField int\n}\n</code></pre>\n\n<p>This would mean changing your <code>Result</code> struct to be as follows:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Result struct {\n    name   string\n    Objects []MyStruct\n}\n</code></pre>\n\n<p>The reason your program panics is because you're trying to access an area in memory (an item in your <code>Object</code>s array) that hasn't been allocated yet.</p>\n\n<p>For arrays of structs, this needs to be done with <code>make</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>r.Objects = make([]MyStruct, 0)\n</code></pre>\n\n<p>Then, in order to add to your array safely, you're better off instantiating an individual <code>MyStruct</code>, i.e.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>ms := MyStruct{\n    MyField: 10,\n}\n</code></pre>\n\n<p>And then <code>append</code>ing this to your <code>r.Objects</code> array</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>r.Objects = append(r.Objects, ms)\n</code></pre>\n\n<p>For more information about <code>make</code>, see <a href=\"https://golang.org/doc/effective_go.html#allocation_make\" rel=\"noreferrer\">the docs</a></p>\n"}, {"comments": [{"owner": {"reputation": 917, "user_id": 3074057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kWsh7.png?s=128&g=1", "display_name": "Beezer", "link": "https://stackoverflow.com/users/3074057/beezer"}, "edited": false, "score": 0, "creation_date": 1561195008, "post_id": 55945868, "comment_id": 99990701, "body": "I wonder if it is possible to initialize the array Objects in using make: <code>Objects: make([]MyStruct, 0, 10)</code> in order to say initialize it to a slice?"}], "tags": [], "owner": {"reputation": 41408, "user_id": 309683, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/IHD28.jpg?s=128&g=1", "display_name": "\u03b2\u03behr\u03b1ng", "link": "https://stackoverflow.com/users/309683/%ce%b2%ce%behr%ce%b1ng"}, "is_accepted": false, "score": 13, "last_activity_date": 1556772816, "creation_date": 1556772816, "answer_id": 55945868, "question_id": 33892599, "link": "https://stackoverflow.com/questions/33892599/how-to-initialize-values-for-nested-struct-array-in-golang/55945868#55945868", "title": "How to initialize values for nested struct array in golang", "body": "<p>After defining the struct as suggested in <a href=\"https://stackoverflow.com/a/33892965/309683\">another answer</a>:</p>\n\n<pre><code>type MyStruct struct {\n    MyField int\n}\n\n\ntype Result struct {\n    Name   string\n    Objects []MyStruct\n}\n</code></pre>\n\n<p>Then you can initialize a <code>Result</code> object like this:</p>\n\n<pre><code>result := Result{\n    Name: \"I am Groot\",\n    Objects: []MyStruct{\n        {\n            MyField: 1,\n        },\n        {\n            MyField: 2,\n        },\n        {\n            MyField: 3,\n        },\n    },\n}\n</code></pre>\n\n<p>Full code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    result := Result{\n        Name: \"I am Groot\",\n        Objects: []MyStruct{\n            {\n                MyField: 1,\n            },\n            {\n                MyField: 2,\n            },\n            {\n                MyField: 3,\n            },\n        },\n    }\n\n    fmt.Println(result)\n\n}\n\ntype MyStruct struct {\n    MyField int\n}\n\ntype Result struct {\n    Name    string\n    Objects []MyStruct\n}\n</code></pre>\n\n<p>You can verify this in this <a href=\"https://play.golang.org/p/k8h3Ga3b1V9\" rel=\"noreferrer\">Go playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1615773870, "last_edit_date": 1615773870, "creation_date": 1615771910, "answer_id": 66631282, "question_id": 33892599, "link": "https://stackoverflow.com/questions/33892599/how-to-initialize-values-for-nested-struct-array-in-golang/66631282#66631282", "title": "How to initialize values for nested struct array in golang", "body": "<p>This is probably a dumb idea, but you can roundtrip it through JSON:</p>\n<pre><code>package main\n\nimport (\n   &quot;bytes&quot;\n   &quot;encoding/json&quot;\n)\n\ntype (\n   a []interface{}\n   m map[string]interface{}\n)\n\nfunc decode(in, out interface{}) {\n   var b bytes.Buffer\n   json.NewEncoder(&amp;b).Encode(in)\n   json.NewDecoder(&amp;b).Decode(out)\n}\n</code></pre>\n<p>Example:</p>\n<pre><code>package main\nimport &quot;fmt&quot;\n\ntype result struct {\n   Name string\n   Objects []struct {\n      Id int\n   }\n}\n\nfunc main() {\n   r := m{\n      &quot;Name&quot;: &quot;Vanaraj&quot;,\n      &quot;Objects&quot;: a{\n         m{&quot;Id&quot;: 10},\n      },\n   }\n   var s result\n   decode(r, &amp;s)\n   fmt.Printf(&quot;%+v\\n&quot;, s) // {Name:Vanaraj Objects:[{Id:10}]}\n}\n</code></pre>\n"}], "owner": {"reputation": 818, "user_id": 4238326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5j2E9.jpg?s=128&g=1", "display_name": "vanarajcs", "link": "https://stackoverflow.com/users/4238326/vanarajcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44977, "favorite_count": 3, "answer_count": 4, "score": 19, "last_activity_date": 1615773870, "creation_date": 1448364927, "last_edit_date": 1448365843, "question_id": 33892599, "link": "https://stackoverflow.com/questions/33892599/how-to-initialize-values-for-nested-struct-array-in-golang", "title": "How to initialize values for nested struct array in golang", "body": "<p>My struct </p>\n\n<pre><code>type Result struct {\n   name   string\n   Objects []struct {\n       id int\n   }\n}\n</code></pre>\n\n<p>Initialize values for this</p>\n\n<pre><code>func main() {\n   var r Result;\n   r.name  = \"Vanaraj\";\n   r.Objects[0].id = 10;\n   fmt.Println(r)\n}\n</code></pre>\n\n<p>I got this error. \"panic: runtime error: index out of range\"</p>\n\n<p>How to fix this?</p>\n"}, {"tags": ["arrays", "json", "go", "marshalling"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1486406759, "last_edit_date": 1486406759, "creation_date": 1448353879, "answer_id": 33888757, "question_id": 33888625, "link": "https://stackoverflow.com/questions/33888625/marshaling-slice-results-in-character-string/33888757#33888757", "title": "Marshaling slice results in character string", "body": "<p>That's because you use <code>uint8</code> type for your numbers, and <code>uint8</code> is an alias for <code>byte</code> (<a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"nofollow noreferrer\">Spec: Numeric types</a>). And by default byte arrays and slices are encoded using Base64 encoding, that's what you see (<code>\"AQIDBA==\"</code> is the Base64 encoded text of the bytes <code>[1, 2, 3, 4]</code>).</p>\n\n<p>Quoting from <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\"><code>json.Marhsal()</code></a> doc:</p>\n\n<blockquote>\n  <p>Array and slice values encode as JSON arrays, except that []byte encodes as a base64-encoded string, and a nil slice encodes as the null JSON object.</p>\n</blockquote>\n\n<p>Change your number type for <code>uint</code> or <code>int</code> for example, and then you will see what you expect.</p>\n\n<p>For example (<a href=\"https://play.golang.org/p/hQyXV_e5nc\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>type MyStruct struct {\n    Data []uint\n}\n\nd := new(MyStruct)\nd.Data = []uint{1, 2, 3, 4}\n\ndata, err := json.Marshal(d)\nfmt.Println(string(data), err)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"Data\":[1,2,3,4]} &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 33888757, "answer_count": 1, "score": 3, "last_activity_date": 1486406759, "creation_date": 1448353470, "last_edit_date": 1448353771, "question_id": 33888625, "link": "https://stackoverflow.com/questions/33888625/marshaling-slice-results-in-character-string", "title": "Marshaling slice results in character string", "body": "<p>I'm trying to json encode a slice of <code>uint8</code> values, but doing so results in a character string. As an example, this:</p>\n\n<pre><code>d := []uint8{1,2,3,4}\ndata, err := json.Marshal(d)\nfmt.Println(string(data), err)\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>\"AQIDBA==\" &lt;nil&gt;\n</code></pre>\n\n<p>I was expecting  <code>[1,2,3,4]</code>, but I am getting this odd character string instead. <a href=\"https://play.golang.org/p/BJfmzcV16r\" rel=\"nofollow\">Here</a> is a playground with this code on it.</p>\n"}, {"tags": ["rest", "logging", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448351682, "post_id": 33887656, "comment_id": 55539825, "body": "I&#39;d guess you are using the <code>DefaultDevStack</code>. Maybe reading the whole documentation for go-json-rest would be helpful?"}, {"owner": {"reputation": 4695, "user_id": 4057655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7e07910ec39b9b672b770c1a5c7613cd?s=128&d=identicon&r=PG&f=1", "display_name": "sag", "link": "https://stackoverflow.com/users/4057655/sag"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448354565, "post_id": 33887656, "comment_id": 55541339, "body": "Yes I am using DefaultDevStack and I did a quick look into the documentation and didn&#39;t find the information :("}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1448362700, "post_id": 33887656, "comment_id": 55546688, "body": "Take a look at what the DefaultDevStack contains and you&#39;ll see."}, {"owner": {"reputation": 4695, "user_id": 4057655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7e07910ec39b9b672b770c1a5c7613cd?s=128&d=identicon&r=PG&f=1", "display_name": "sag", "link": "https://stackoverflow.com/users/4057655/sag"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448365450, "post_id": 33887656, "comment_id": 55548444, "body": "Got it. I have to use DefaultCommonStack. Could you please add it as answer?"}, {"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1448460528, "post_id": 33887656, "comment_id": 55598295, "body": "Sometimes, dive  into the source code would be a better way to learn."}], "answers": [{"tags": [], "owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "is_accepted": true, "score": 1, "last_activity_date": 1448462019, "last_edit_date": 1448462019, "creation_date": 1448461642, "answer_id": 33919064, "question_id": 33887656, "link": "https://stackoverflow.com/questions/33887656/turn-off-access-logger-in-go-json-rest/33919064#33919064", "title": "Turn off access logger in go-json-rest", "body": "<p>You should know that it's <a href=\"https://godoc.org/github.com/ant0ine/go-json-rest/rest#AccessLogApacheMiddleware\" rel=\"nofollow\">AccessLogApacheMiddleware</a> that controls your logging, and <code>DefaultDevStack</code> <a href=\"https://github.com/ant0ine/go-json-rest/blob/master/rest/api.go#L52\" rel=\"nofollow\">contains</a> the <code>AccessLogApacheMiddleware</code>. </p>\n\n<p>Two ways to prevent logging:</p>\n\n<ol>\n<li>You can use a predefined variable like <a href=\"https://github.com/ant0ine/go-json-rest/blob/master/rest/api.go#L78\" rel=\"nofollow\">DefaultCommonStack</a> which doesn't contain the <code>AccessLogApacheMiddleware</code>;</li>\n<li>Construct your own <code>...Middlewares</code>. Since the <a href=\"https://godoc.org/github.com/ant0ine/go-json-rest/rest#Api.Use\" rel=\"nofollow\">Use</a> function is a <code>Variadic Functions</code>, which pass the multiple middlewares into the function. If you don't need <code>AccessLogApacheMiddleware</code>, you just ignore it. It gives you more power to control whatever middlewares you like.</li>\n</ol>\n\n<p>e.g.</p>\n\n<pre><code>api := rest.NewApi()\napi.Use(&amp;rest.TimerMiddleware{},\n    &amp;rest.RecorderMiddleware{},\n    &amp;rest.PoweredByMiddleware{},\n    &amp;rest.RecoverMiddleware{})\n</code></pre>\n\n<p>May this be helpful.</p>\n"}], "owner": {"reputation": 4695, "user_id": 4057655, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7e07910ec39b9b672b770c1a5c7613cd?s=128&d=identicon&r=PG&f=1", "display_name": "sag", "link": "https://stackoverflow.com/users/4057655/sag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 33919064, "answer_count": 1, "score": 0, "last_activity_date": 1448462019, "creation_date": 1448349890, "question_id": 33887656, "link": "https://stackoverflow.com/questions/33887656/turn-off-access-logger-in-go-json-rest", "title": "Turn off access logger in go-json-rest", "body": "<p>I am trying to write REST services in Go. As there are different frameworks for writing REST service in Go, we would like to do some performance testing before choosing the framework.</p>\n\n<p>Currently I did a sample using <a href=\"https://github.com/ant0ine/go-json-rest\" rel=\"nofollow\">go-json-rest</a>. \nBut when I execute this sample REST request, I see the following logs printed in my terminal.</p>\n\n<pre><code>24/Nov/2015:12:30:35 +0530 200 29\u03bcs \"GET /countries HTTP/1.1\" - \"Java/1.8.0_45\"\n</code></pre>\n\n<p>This logging will take some time and impact my performance report. \nHow can I switch of this logging?</p>\n"}, {"tags": ["data-structures", "go"], "comments": [{"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "edited": false, "score": 2, "creation_date": 1448341591, "post_id": 33885732, "comment_id": 55535660, "body": "looks fine to me, how are you unmarshalling?"}, {"owner": {"reputation": 704, "user_id": 5341512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ldmzU.jpg?s=128&g=1", "display_name": "throwit", "link": "https://stackoverflow.com/users/5341512/throwit"}, "edited": false, "score": 0, "creation_date": 1448351626, "post_id": 33885732, "comment_id": 55539804, "body": "You can check the <code>len(Products.Specs)</code> before unmarshalling"}, {"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1448462572, "post_id": 33885732, "comment_id": 55599717, "body": "LGTM. <a href=\"http://play.golang.org/p/f1qs5MPRrx\" rel=\"nofollow noreferrer\">play.golang.org/p/f1qs5MPRrx</a>  .  You can generate your struct     from <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">mholt.github.io/json-to-go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1095, "user_id": 1030873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81783d79b9967bf327cdafdcc0f4cd46?s=128&d=identicon&r=PG", "display_name": "Sly", "link": "https://stackoverflow.com/users/1030873/sly"}, "is_accepted": false, "score": 0, "last_activity_date": 1449005893, "creation_date": 1449005893, "answer_id": 34030676, "question_id": 33885732, "link": "https://stackoverflow.com/questions/33885732/golang-struct-for-unmarshal/34030676#34030676", "title": "golang struct for unmarshal", "body": "<p>It seems that you have already found a workaround for your problem, but you don't need to work around it.</p>\n\n<p>I'm not sure what language you're using to provide this JSON data, but you're turning the Specs into strings within the array.</p>\n\n<p>For example, the return from <code>JSON.stringify({ \"name\": \"test\" })</code> in Javascript will be <code>{\"name\":\"test\"}</code>. However, <code>JSON.stringify('{ \"name\": \"test\" }')</code> will return<br>\n<code>\"{ \\\\\"name\\\\\": \\\\\"test\\\\\" }\"</code>.</p>\n"}], "owner": {"reputation": 95, "user_id": 3398940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/16406ac47da87674b5ce8f203de8b5ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3398940", "link": "https://stackoverflow.com/users/3398940/user3398940"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449005893, "creation_date": 1448340901, "last_edit_date": 1448382221, "question_id": 33885732, "link": "https://stackoverflow.com/questions/33885732/golang-struct-for-unmarshal", "title": "golang struct for unmarshal", "body": "<p>I need to create a struct to unmarshal and access key \"name\" and receive its value.</p>\n\n<pre><code>{\n    \"product\":\"car\",\n    \"spec\":[\n        {\n            \"name\":\"bla_bla\",\n            \"info\":{\n                \"color\":\"black\",\n                \"year\":1991\n            }\n        }\n    ]\n} \n</code></pre>\n\n<p>Here is what my struct looks like now:</p>\n\n<pre><code>type Products struct {\nProduct string `json:\"product\"`\nSpecs []Spec  `json:\"spec\"`\n}\n\ntype Spec struct {\n    Name string  `json:\"name\"`\n    Info Inf `json:\"info\"`\n}\n\ntype Inf struct {\n    Color string `json:\"color\"`\n    Year  int  `json:\"year\"`\n}\n</code></pre>\n\n<p>With this struct I can only access <code>Products.Product</code>, the <code>Products.Specs</code> shows only <code>[ ]</code>.</p>\n\n<p>I checked json.unmarshal errors and origin response from websocket I found out that my json string look little bit diffrent.</p>\n\n<pre><code> c :=  `{\"product\":\"car\",\"spec\":[\"{\\\"name\\\":\\\"bla_bla\\\",\\\"info\\\":{\\\"color\\\":\\\"black\\\",\\\"year\\\":\\\"1991\\\"}}\"]}`\n</code></pre>\n\n<p>I used strings to replaced some chars and decoder. Now it works how I wanted it to work.</p>\n\n<pre><code>s_replacer := strings.NewReplacer(`\"{`, \"{\", `\"]`, \"]\", \"\\\\\", \"\")\nz := s_replacer.Replace(c)\ndec := json.NewDecoder(strings.NewReader(z))\n\nfor {\n    var m Products\n    if err := dec.Decode(&amp;m); err == io.EOF {\n        break\n    } else if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(m.Specs[0].Name)\n}\n</code></pre>\n\n<p>I think the problem was quotes in square bracket it treat it as array of string. Anyways thank for response I am still new to golang. </p>\n"}, {"tags": ["go", "fatal-error"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 3, "creation_date": 1448338175, "post_id": 33885235, "comment_id": 55534703, "body": "My hope would be that this code is absolutely unreachable. That an error that causes an idle connection to be still in the idle list while also being used as an active connection should not be something that should happen ever, and for it to occur should be something catastrophic. But since they appear to be using mutexes properly around the idle list and so forth, I have no idea why this loop and code would even be necessary.  Why they would further exit your program immediately rather than panicing is another mystery. Great question."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1448338330, "post_id": 33885235, "comment_id": 55534753, "body": "Are any of the tests in that package able to reach that line?"}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1448338767, "post_id": 33885235, "comment_id": 55534881, "body": "Good question, had a little look and cant see anything that looks like its specifically designed to reach that line.  Not conclusive yet ..."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 5, "creation_date": 1448338913, "post_id": 33885235, "comment_id": 55534923, "body": "&quot;Occasionally used in the standard library&quot; doesn&#39;t conflict with &quot;best practice&quot; - some of the std. lib was certainly written before best practices/idioms emerged. I would argue that in any <i>new</i> application, only a <code>package main</code> should call <code>log.Fatal</code>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448351294, "post_id": 33885235, "comment_id": 55539635, "body": "Some circumstances <i>are</i> fatal and continuing might be worse than aborting. Returning an error and hopeing the caller will react properly is often advisable, but assume some crypto routines detect that the random source is corrupted: Most probably you should not do much at all after this discovery except shred the hardware. log.Fatal seems appropriate here."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1448351363, "post_id": 33885235, "comment_id": 55539668, "body": "I&#39;d say that since <code>log.Fatal()</code> calls <code>os.Exit(1)</code> in the end, you should not do that\u2014use plain <code>panic()</code> instead: if it won&#39;t be caught, the application will terminate anyway, with nice stack traces printed, and if it will be caught, any panic emerged from a package&#39;s code means all bets are off anyway. So panicking just offers greater room for processing it to the package users."}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1448395420, "post_id": 33885235, "comment_id": 55568173, "body": "I do agree that it does not conflict with best practice.  @kostix your approach seems to be easier for the user of the package to have some semblance of controlled failure.   I also now consider that my concept of &#39;rising from the ashes&#39; is not useful, it is desirable though to have a controlled failure from main (not package code) which then ends execution."}, {"owner": {"reputation": 2687, "user_id": 45476, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c1ae39d152538e8d4ddf9913ddf9635?s=128&d=identicon&r=PG", "display_name": "limscoder", "link": "https://stackoverflow.com/users/45476/limscoder"}, "edited": false, "score": 0, "creation_date": 1526068649, "post_id": 33885235, "comment_id": 87615509, "body": "It&#39;s used in the golang grpc example too: <a href=\"https://grpc.io/docs/quickstart/go.html\" rel=\"nofollow noreferrer\">grpc.io/docs/quickstart/go.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 5, "creation_date": 1448372073, "post_id": 33890104, "comment_id": 55552820, "body": "I like your answer as it explains the points well (and resonates with my own ideas on this topic) but I&#39;m afraid it misses a crucial bit: the OP explicitly asked about using <code>log.Fatal</code> <i>in a package</i> -- that is, in a piece of code not controlled by whoever wrote <code>main()</code>. As you can see, this actually moves the question from a &quot;well-behaving process&quot; domain to the &quot;well-behaving package&quot; domain -- quite a different story for the question becomes: whether it&#39;s okay to irreversively fail someone else&#39;s program?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1448372433, "post_id": 33890104, "comment_id": 55553042, "body": "It is covered, albeit a bit implicit: I apply those rules regardless of wether I write a package or a cmd: an irrecoverable error is an irrecoverable error. It is a programs responsibility to give a package sanitized input. If that isn&#39;t possible, an error should be returned, but only if the input can not be sanitized beforehand. So fataling where appropriate actually helps the user of an package to write better code."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 5, "creation_date": 1448464918, "post_id": 33890104, "comment_id": 55601441, "body": "Thing is, it is not the package maintainer&#39;s call if something is irrecoverable or not. Sure, you failed to generate a thumbnail, but I was using that as a small part of my web server. If a thumbnail package calls os.Exit because it can&#39;t load a file, I would be incensed."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1448465310, "post_id": 33890104, "comment_id": 55601732, "body": "Well, that&#39;s of course true and the picture example was explicitly stated as per command line. The go packages I have created thus far are for my tools only, where I pass the logger around. Given that log.Logger isn&#39;t an interface and Logger is rather limited, I don&#39;t think I would do <b>any</b> logging in public packages (users might use incompatible loggers such as logxi) and work with returned errors only. *still scratching my head on the decision not to make Logger an interface*"}, {"owner": {"reputation": 579, "user_id": 1608682, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/pVLpr.jpg?s=128&g=1", "display_name": "I.Tyger", "link": "https://stackoverflow.com/users/1608682/i-tyger"}, "edited": false, "score": 0, "creation_date": 1543333574, "post_id": 33890104, "comment_id": 93875858, "body": "Totally agree . The fatal stops the program flow early enough to avoid continuity"}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 44, "last_activity_date": 1448358030, "creation_date": 1448358030, "answer_id": 33890104, "question_id": 33885235, "link": "https://stackoverflow.com/questions/33885235/should-a-go-package-ever-use-log-fatal-and-when/33890104#33890104", "title": "Should a Go package ever use log.Fatal and when?", "body": "<p>It might be just me, but here is how I use <code>log.Fatal</code>. As per UNIX conventions, a process which encounters an error should fail as early as possible with a non-zero exit code. This lead me to the following guidelines to use <code>log.Fatal</code> when\u2026</p>\n\n<ol>\n<li>\u2026an error happens in any of my <code>func init()</code>, as these happen when the imports are processed or before the main func is called, respectively. Conversely, I only do stuff not directly affecting the unit of work the library or cmd is supposed to do. For example, I set up logging and check wether we have a sane environment and parameters. No need to run main if we have invalid flags, right? And if we can not give proper feedback, we should tell this early.</li>\n<li>\u2026an error happens of which I know is irrecoverable. Let's assume we have a program which creates a thumbnail of an image file given on the command line. If this file does not exist or is unreadable because of insufficient permissions, there is no reason to continue and this error can not be recovered from. So we adhere to the conventions and fail.</li>\n<li>\u2026an error occurs during a process which might not be reversible. This is kind of a soft definition, I know. Let me illustrate that. Let's assume we have an implementation of  <code>cp</code>, and it was started to be non-interactive and recursively copy a directory. Now, let's assume we encounter a file in the target directory which has the same name (but different content) as a file to be copied there. Since we can not ask the user to decide what to do and we can not copy this file, we have a problem. Because the user will assume that the source and the target directories are exact copies when we finish with exit code zero, we can not simply skip the file in question. However, we can not simply overwrite it, since this might potentially destroy information. This is a situation we can not recover from per explicit request by the user, and so I'd use <code>log.Fatal</code> to explain the situation, hereby obeying the principle to fail as early as possible.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 492, "user_id": 605846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37512e7a7f034880c112f35bcf8e9c21?s=128&d=identicon&r=PG", "display_name": "jgpawletko", "link": "https://stackoverflow.com/users/605846/jgpawletko"}, "edited": false, "score": 0, "creation_date": 1595617039, "post_id": 59474451, "comment_id": 111547498, "body": "I agree with @moniecodes: packages should not crash your program, even if an error is deemed &quot;unrecoverable&quot; because a package does not have sufficient context to know what else in the caller needs to be cleaned up before an exit."}], "tags": [], "owner": {"reputation": 21, "user_id": 12593403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBAi5PPMNPqHKhyIxP7wKBYOJBBfp4bmbMsyZdLOw=k-s128", "display_name": "moniecodes", "link": "https://stackoverflow.com/users/12593403/moniecodes"}, "is_accepted": false, "score": 2, "last_activity_date": 1577235659, "creation_date": 1577235659, "answer_id": 59474451, "question_id": 33885235, "link": "https://stackoverflow.com/questions/33885235/should-a-go-package-ever-use-log-fatal-and-when/59474451#59474451", "title": "Should a Go package ever use log.Fatal and when?", "body": "<p>Marcus, I came across your response, and I think its excellent and very insightful, and I tend to agree with your breakdown. It is very hard to generalize, though I have been thinking about it this a little more, and as a newbie to Go. I think on a theoretical level, if we are looking to best practices in computing, regardless of OS, package framework or library, a logger's responsibility is to simply log. On any level, a logger's responsibilities:</p>\n\n<ul>\n<li>Format and print information consistently to the channel of my choosing.  </li>\n<li>Categorize, filter, display the different log levels [debug, info, warn, error]</li>\n<li>Handle and aggregate log entries across async and parallel jobs</li>\n</ul>\n\n<p>A logging package or any package does not and should not have authority to crash a program, if it is operating properly. Any middleware or library should follow a throw / catch pattern, with an opportunity for <strong>all</strong> exceptions thrown to be caught by the caller. This is also a good pattern to follow within an application, as you build foundations and packages that power various parts of your application, and potentially other applications, they should never crash an application directly. Rather, they should throw a fatal exception, allowing the program to handle. I think this also addresses some of your points Marcus, as it works to alert the caller immediately when uncaught, as a fatal crash.</p>\n\n<p>For the most part I can enjoy leveraging log.Fatal in Go directly for the purposes of direct user facing cli tools, which I think is the simplicity it was truly intended for. I don't think it makes good sense as a long term approach to handle fatal errors across packages.</p>\n"}], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27488, "favorite_count": 11, "accepted_answer_id": 33890104, "answer_count": 2, "score": 36, "last_activity_date": 1577235659, "creation_date": 1448337756, "last_edit_date": 1495540364, "question_id": 33885235, "link": "https://stackoverflow.com/questions/33885235/should-a-go-package-ever-use-log-fatal-and-when", "title": "Should a Go package ever use log.Fatal and when?", "body": "<p>I have so far avoided use of <code>log.Fatal</code>, but I recently co-incidentally discovered these questions; <a href=\"https://stackoverflow.com/questions/33873305/how-to-get-100-code-coverage-in-golang\">code-coverage</a> and <a href=\"https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal\">tests-using-log-fatal</a>.  </p>\n\n<p>One of the comments from the 100 code coverage questions says: </p>\n\n<blockquote>\n  <p>... In the vast majority of cases <code>log.Fatal</code> should be only be used in main, or init functions (or possibly some things meant to be called only directly from them)\"</p>\n</blockquote>\n\n<p>It go me thinking, so I began to look at the standard library code provided with Go.  There are lots of examples where the <strong>test</strong> code in the library makes use of <code>log.Fatal</code> which seems fine.  There are a few examples outside of the test code, such as in <a href=\"https://golang.org/src/net/http/transport.go?h=log.Fatal#L408\" rel=\"noreferrer\"><code>net/http</code></a>, shown below:</p>\n\n<pre><code>// net/http/transport.go \nfunc (t *Transport) putIdleConn(pconn *persistConn) bool {\n    ...\n    for _, exist := range t.idleConn[key] {\n        if exist == pconn {\n            log.Fatalf(\"dup idle pconn %p in freelist\", pconn)\n        }\n    }\n    ...\n}\n</code></pre>\n\n<p>If its is best practice to avoid use of <code>log.Fatal</code>, why is it used at all in the standard libraries, I would have expected just return an error.  It seems unfair to the user of the library to cause <code>os.Exit</code> to be called and not providing any chance for the application to clean-up.</p>\n\n<p>I may be naive, so hence my question as a better practice would seem to be to call <code>log.Panic</code> which can be recovered and my theoretical long running stable application might have a chance of rising from the ashes.</p>\n\n<p>So what would best-practise say for Go about when should log.Fatal should be used?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "edited": false, "score": 3, "creation_date": 1448337672, "post_id": 33885208, "comment_id": 55534572, "body": "I am 99% sure that this is a &quot;working directory&quot; problem. Do a quick call to list the contents of the current directory to make sure that it is in the right place."}, {"owner": {"reputation": 507, "user_id": 1956016, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21ecdf91b9eaafd76a95cd6dc1310821?s=128&d=identicon&r=PG", "display_name": "j5juice", "link": "https://stackoverflow.com/users/1956016/j5juice"}, "reply_to_user": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "edited": false, "score": 0, "creation_date": 1448338040, "post_id": 33885208, "comment_id": 55534675, "body": "Do you know how to make that call in Go? I am still very new to this language."}, {"owner": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "edited": false, "score": 1, "creation_date": 1448338281, "post_id": 33885208, "comment_id": 55534735, "body": "Hm, try <code>os.Getwd()</code>. It should give you the current working directory."}, {"owner": {"reputation": 507, "user_id": 1956016, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21ecdf91b9eaafd76a95cd6dc1310821?s=128&d=identicon&r=PG", "display_name": "j5juice", "link": "https://stackoverflow.com/users/1956016/j5juice"}, "reply_to_user": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "edited": false, "score": 0, "creation_date": 1448338622, "post_id": 33885208, "comment_id": 55534841, "body": "Okay yeah as I was afraid of I am in the directory main inside src when templates is a peer to src. So I need to back out of two folders to access templates like I want to. Not sure how to do that though..."}, {"owner": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "edited": false, "score": 1, "creation_date": 1448338717, "post_id": 33885208, "comment_id": 55534869, "body": "What if you do <code>basePath := &quot;..&#47;..&#47;templates&quot;</code>?"}, {"owner": {"reputation": 507, "user_id": 1956016, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21ecdf91b9eaafd76a95cd6dc1310821?s=128&d=identicon&r=PG", "display_name": "j5juice", "link": "https://stackoverflow.com/users/1956016/j5juice"}, "reply_to_user": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "edited": false, "score": 0, "creation_date": 1448338785, "post_id": 33885208, "comment_id": 55534887, "body": "Yes I found that just after I posted. Thank you for your help everything is working as intended now!!"}, {"owner": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "edited": false, "score": 0, "creation_date": 1448339015, "post_id": 33885208, "comment_id": 55534949, "body": "Awesome! I posted as an answer to summarize."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448386285, "post_id": 33885432, "comment_id": 55562710, "body": "FYI, your working directory has no relation to the application source, and is dependent on how you invoke you application. You should have a proper way to configure the template location in order to be deployed in a consistent manner."}], "tags": [], "owner": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "is_accepted": true, "score": 2, "last_activity_date": 1448338986, "creation_date": 1448338986, "answer_id": 33885432, "question_id": 33885208, "link": "https://stackoverflow.com/questions/33885208/no-such-file-or-directory-error-from-os-open/33885432#33885432", "title": "No such file or directory error from os.Open", "body": "<p>Per our discussion in the comments, it turned out that the issue was caused by the application running in an incorrect working directory.</p>\n\n<p>The fix was to modify the path, as such:</p>\n\n<pre><code>basePath := \"../../templates\"\n</code></pre>\n\n<p>You can also use <code>os.Chdir</code> to change the working directory permanently (for the duration of the process), and avoid using the <code>../..</code>. More info here: <a href=\"https://golang.org/pkg/os/#File.Chdir\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/#File.Chdir</a></p>\n"}], "owner": {"reputation": 507, "user_id": 1956016, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21ecdf91b9eaafd76a95cd6dc1310821?s=128&d=identicon&r=PG", "display_name": "j5juice", "link": "https://stackoverflow.com/users/1956016/j5juice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20365, "favorite_count": 0, "accepted_answer_id": 33885432, "answer_count": 1, "score": 2, "last_activity_date": 1595069645, "creation_date": 1448337569, "last_edit_date": 1595069645, "question_id": 33885208, "link": "https://stackoverflow.com/questions/33885208/no-such-file-or-directory-error-from-os-open", "title": "No such file or directory error from os.Open", "body": "<p>I am struggling to figure out an issue with os.Open. I keep getting a 'no such file or directory' error when using os.Open on a folder named templates. So I have my folder MVCApp with bin pkg src and templates in it. Then I have main in the src folder. So I have this code:</p>\n\n<pre><code>basePath := \"templates\"\ntemplateFolder, err := os.Open(basePath)\nif err != nil {\n    log.Fatal(err)\n}\ndefer templateFolder.Close()\n</code></pre>\n\n<p>I think it has something to do with the basePath that I am using with the open, but I cannot figure out how I need to preface \"templates\" in order for it to find this directory. I am sure this is an easy fix, but it has me perplexed. Any help would be greatly appreciated.</p>\n"}, {"tags": ["json", "struct", "go", "google-apps-script"], "comments": [{"owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 1, "creation_date": 1448338991, "post_id": 33885191, "comment_id": 55534941, "body": "When you say that you tried unmarshalling with no success, can provide more details. Also can you show your code that will help to understand what you are trying. As of now I see for Case struct except for ID all other fields are not exposed has they are not starting with capital letters and while unmarshalling they will not be populated."}, {"owner": {"reputation": 139, "user_id": 2099063, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5ECm9.jpg?s=128&g=1", "display_name": "Mardwan", "link": "https://stackoverflow.com/users/2099063/mardwan"}, "reply_to_user": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 0, "creation_date": 1448341566, "post_id": 33885191, "comment_id": 55535647, "body": "Thank you so much for that! I had not noticed. Please check the edit on the question. I have used it to answer your question :)"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 2099063, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5ECm9.jpg?s=128&g=1", "display_name": "Mardwan", "link": "https://stackoverflow.com/users/2099063/mardwan"}, "edited": false, "score": 0, "creation_date": 1448341788, "post_id": 33885534, "comment_id": 55535723, "body": "Thank you so much for the answer. I bet this solution would work if I could find a way to strip   <code>map[@type:type.googleapis.com&#47;google.apps.script.v1.Executio&zwnj;&#8203;nResponse result:[</code>   automatically using code and not manually. I might be wrong though :(. But take a look at this please <a href=\"http://play.golang.org/p/rmsvfPVx52\" rel=\"nofollow noreferrer\">play.golang.org/p/rmsvfPVx52</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 139, "user_id": 2099063, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5ECm9.jpg?s=128&g=1", "display_name": "Mardwan", "link": "https://stackoverflow.com/users/2099063/mardwan"}, "edited": false, "score": 1, "creation_date": 1448344669, "post_id": 33885534, "comment_id": 55536692, "body": "The text <code>map[@type:type.googleapis.com&#47;google.apps.script.v1.Executio&zwnj;&#8203;nResponse</code> is not valid JSON.  You will need to strip in manually if the server is in fact returning invalid JSON."}, {"owner": {"reputation": 139, "user_id": 2099063, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5ECm9.jpg?s=128&g=1", "display_name": "Mardwan", "link": "https://stackoverflow.com/users/2099063/mardwan"}, "edited": false, "score": 0, "creation_date": 1448345862, "post_id": 33885534, "comment_id": 55537167, "body": "Thanks. I wish there was an automated solution."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1448339941, "last_edit_date": 1448339941, "creation_date": 1448339613, "answer_id": 33885534, "question_id": 33885191, "link": "https://stackoverflow.com/questions/33885191/unmarshal-json-into-struct/33885534#33885534", "title": "Unmarshal JSON into struct", "body": "<p>You need to <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">export</a> the fields in Case by starting the name with an uppercase character.</p>\n\n<pre><code>type Case struct {\n  ID int            \n  CaseNumber string \n  DateDelivered string \n  Judge string \n  Court string \n  Location string                                   \n  Accused string \n  Prosecution string \n  Judgment string\n}\n</code></pre>\n\n<p>The encoding/json package and similar packages ignore unexported fields.</p>\n\n<p>Use a slice to decode a JSON array:</p>\n\n<pre><code>  var result []Case\n  err := json.Unmarshal(data, &amp;result)\n  if err != nil {\n     // handle error\n  }\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/IzMEHXQ0a7\" rel=\"nofollow\">Playground Example</a></kbd></p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 2099063, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5ECm9.jpg?s=128&g=1", "display_name": "Mardwan", "link": "https://stackoverflow.com/users/2099063/mardwan"}, "is_accepted": false, "score": 0, "last_activity_date": 1448365822, "creation_date": 1448365822, "answer_id": 33892936, "question_id": 33885191, "link": "https://stackoverflow.com/questions/33885191/unmarshal-json-into-struct/33892936#33892936", "title": "Unmarshal JSON into struct", "body": "<p>Where <code>c</code> is </p>\n\n<pre><code>map[@type:type.googleapis.com/google.apps.script.v1.ExecutionResponse result:[\n{\n\"id\": 1,\n\"casenumber\": \"Criminal Case 20 of 2012\",\n\"datedelivered\": \"2015-10-22T21:00:00.000Z\",\n\"judge\": \"George Matatia Abaleka Dulu\",\n\"court\": \"High Court\",\n\"location\": \"Garissa\",\n\"accused\": \"Abdi Sheikh Mohamed\",\n\"judgment\": \"The accused Abdi Sheikh Mohamed stands charged with the offence of murder contrary to Section 203 as read with Section 204 of the Penal Code.  The particulars of the offence are that on 8th May 2012 at Ifo Refugee camp, Lagdera District within Garissa County murdered Othon Ubang Alwal.  He has denied the charge.\"\n},\n{\n\"id\": 2,\n\"casenumber\": \"Criminal Case 21 of 2012\",\n\"datedelivered\": \"2015-11-22T21:00:00.000Z\",\n\"judge\": \"Lilo\",\n\"court\": \"High Court\",\n\"location\": \"Nairobi\",\n\"accused\": \"Stitch\",\n\"prosecution\": \"Milo\",\n\"judgment\": \"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum\"\n}\n]]\n</code></pre>\n\n<p>I did;</p>\n\n<pre><code>case:= c.(map[string]interface {})\nfmt.Println(case[\"result\"])\n</code></pre>\n\n<p>which gives;</p>\n\n<pre><code>[\n{\n    \"id\": 1,\n    \"casenumber\": \"Criminal Case 20 of 2012\",\n    \"datedelivered\": \"2015-10-22T21:00:00.000Z\",\n    \"judge\": \"George Matatia Abaleka Dulu\",\n    \"court\": \"High Court\",\n    \"location\": \"Garissa\",\n    \"accused\": \"Abdi Sheikh Mohamed\",\n    \"judgment\": \"The accused Abdi Sheikh Mohamed stands charged with the offence of murder contrary to Section 203 as read with Section 204 of the Penal Code.  The particulars of the offence are that on 8th May 2012 at Ifo Refugee camp, Lagdera District within Garissa County murdered Othon Ubang Alwal.  He has denied the charge.\"\n},\n{\n    \"id\": 2,\n    \"casenumber\": \"Criminal Case 21 of 2012\",\n    \"datedelivered\": \"2015-11-22T21:00:00.000Z\",\n    \"judge\": \"Lilo\",\n    \"court\": \"High Court\",\n    \"location\": \"Nairobi\",\n    \"accused\": \"Stitch\",\n    \"prosecution\": \"Milo\",\n    \"judgment\": \"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum\"\n}\n]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5154031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/955ya.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5154031/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1448376324, "creation_date": 1448376324, "answer_id": 33896600, "question_id": 33885191, "link": "https://stackoverflow.com/questions/33885191/unmarshal-json-into-struct/33896600#33896600", "title": "Unmarshal JSON into struct", "body": "<p>As @CodingPickle indicated above, you need to strip the non-valid json first:</p>\n\n<pre><code>data := `{\"result\":[\n{\n    \"id\": 1,\n    ...\n},\n{\n    \"id\": 2,\n    ...\n}]}`\n</code></pre>\n\n<p>As well, you need to add the json defn's to the struct:</p>\n\n<pre><code>type Result struct {\n    Result []Case `json:\"result\"`\n}\n\ntype Case struct {\n    ID            int    `json:\"id\"`\n    CaseNumber    string `json:\"casenumber\"`\n    DateDelivered string `json:\"datedelivered\"`\n    Judge         string `json:\"judge\"`\n    Court         string `json:\"court\"`\n    Location      string `json:\"location\"`\n    Accused       string `json:\"accused\"`\n    Prosecution   string `json:\"prosecution\"`\n    Judgment      string `json:\"judgement\"`\n}\n</code></pre>\n\n<p>Example:</p>\n\n<p><a href=\"http://play.golang.org/p/KUbDpSxMVI\" rel=\"nofollow\">http://play.golang.org/p/KUbDpSxMVI</a></p>\n"}], "owner": {"reputation": 139, "user_id": 2099063, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5ECm9.jpg?s=128&g=1", "display_name": "Mardwan", "link": "https://stackoverflow.com/users/2099063/mardwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1448376324, "creation_date": 1448337482, "last_edit_date": 1448342140, "question_id": 33885191, "link": "https://stackoverflow.com/questions/33885191/unmarshal-json-into-struct", "title": "Unmarshal JSON into struct", "body": "<p>My issue is very small but very frustrating since I can't seem to get the answer. I am trying to access the JSON part of a response from Google Script. In Golang, I have managed to strip it down to this </p>\n\n<pre><code>map[@type:type.googleapis.com/google.apps.script.v1.ExecutionResponse result:[\n{\n    \"id\": 1,\n    \"casenumber\": \"Criminal Case 20 of 2012\",\n    \"datedelivered\": \"2015-10-22T21:00:00.000Z\",\n    \"judge\": \"George Matatia Abaleka Dulu\",\n    \"court\": \"High Court\",\n    \"location\": \"Garissa\",\n    \"accused\": \"Abdi Sheikh Mohamed\",\n    \"judgment\": \"The accused Abdi Sheikh Mohamed stands charged with the offence of murder contrary to Section 203 as read with Section 204 of the Penal Code.  The particulars of the offence are that on 8th May 2012 at Ifo Refugee camp, Lagdera District within Garissa County murdered Othon Ubang Alwal.  He has denied the charge.\"\n},\n{\n    \"id\": 2,\n    \"casenumber\": \"Criminal Case 21 of 2012\",\n    \"datedelivered\": \"2015-11-22T21:00:00.000Z\",\n    \"judge\": \"Lilo\",\n    \"court\": \"High Court\",\n    \"location\": \"Nairobi\",\n    \"accused\": \"Stitch\",\n    \"prosecution\": \"Milo\",\n    \"judgment\": \"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum\"\n}\n]]\n</code></pre>\n\n<p>but I need to strip it down one level further by getting rid of</p>\n\n<pre><code>map[@type:type.googleapis.com/google.apps.script.v1.ExecutionResponse result:[\n</code></pre>\n\n<p>so I only have the results part. </p>\n\n<p>So far I have tried unmarshalling it to my struct with no success. Here is the struct</p>\n\n<pre><code>type Case struct {\n    ID int            \n    CaseNumber string \n    DateDelivered string \n    Judge string \n    Court string \n    Location string                                   \n    Accused string \n    Prosecution string \n    Judgment string\n}\n</code></pre>\n\n<p>Any help will be highly appreciated.</p>\n\n<p><strong>EDIT:</strong> What I meant by the unmarshaling part is that when I try unmarshaling into my struct (even after fixing the struct) I get the error</p>\n\n<pre><code>json: cannot unmarshal object into Go value of type []Case\n</code></pre>\n\n<p>This is the code I need to get to work <a href=\"http://play.golang.org/p/rmsvfPVx52\" rel=\"nofollow\">http://play.golang.org/p/rmsvfPVx52</a>.</p>\n"}, {"tags": ["templates", "go", "docker"], "answers": [{"comments": [{"owner": {"reputation": 1723, "user_id": 1342185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa26964073f9d7915d2be7566b727051?s=128&d=identicon&r=PG&f=1", "display_name": "JeffR", "link": "https://stackoverflow.com/users/1342185/jeffr"}, "edited": false, "score": 2, "creation_date": 1546610744, "post_id": 33884893, "comment_id": 94915854, "body": "In case others have this issue, in Windows Powershell I had to add either a backslash or a backtick before the double-quotes, both seem to work.  Otherwise I got the error <b>function &quot;com&quot; not defined</b>      <code>$ docker inspect -f &#39;{{ index .Config.Labels \\&quot;com.wherever.foo\\&quot; }}&#39; foo bang</code>"}, {"owner": {"reputation": 227, "user_id": 447227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oj0Pv.jpg?s=128&g=1", "display_name": "8znr", "link": "https://stackoverflow.com/users/447227/8znr"}, "edited": false, "score": 0, "creation_date": 1549454210, "post_id": 33884893, "comment_id": 95905931, "body": "Similar error fixed by double quote escaping \\&quot; is <code>Template parsing error: template: :1: function &quot;com.wherever.foo&quot; not defined</code> (PowerShell v.5),"}, {"owner": {"reputation": 91, "user_id": 1395958, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a877ddf3c0d4cf6c4736c5cd8dc8598f?s=128&d=identicon&r=PG", "display_name": "wapmorgan", "link": "https://stackoverflow.com/users/1395958/wapmorgan"}, "edited": false, "score": 0, "creation_date": 1566311302, "post_id": 33884893, "comment_id": 101611940, "body": "Does not work in docker-compose, is there any different option?"}, {"owner": {"reputation": 10721, "user_id": 953218, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/eZ9uT.jpg?s=128&g=1", "display_name": "Ben Davis", "link": "https://stackoverflow.com/users/953218/ben-davis"}, "edited": false, "score": 0, "creation_date": 1610173312, "post_id": 33884893, "comment_id": 116054024, "body": "How do you get more paths after that index? I tried `{{ index .Foo.Bar &quot;whatever&quot; .OtherKey }} and that doesn&#39;t work"}], "tags": [], "owner": {"reputation": 21578, "user_id": 115478, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/df66f5ffbf986ef9ff5a990f26dbd1f1?s=128&d=identicon&r=PG", "display_name": "leedm777", "link": "https://stackoverflow.com/users/115478/leedm777"}, "is_accepted": true, "score": 41, "last_activity_date": 1448335392, "creation_date": 1448335392, "answer_id": 33884893, "question_id": 33884870, "link": "https://stackoverflow.com/questions/33884870/how-can-i-get-a-docker-images-label-if-the-label-name-has-a-in-it/33884893#33884893", "title": "How can I get a Docker image&#39;s label if the label name has a &quot;.&quot; in it?", "body": "<p>The <code>index</code> function is what I was looking for. It can lookup arbitrary strings in the map.</p>\n\n<pre><code>$ docker inspect -f '{{ index .Config.Labels \"com.wherever.foo\" }}' foo\nbang\n</code></pre>\n"}], "owner": {"reputation": 21578, "user_id": 115478, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/df66f5ffbf986ef9ff5a990f26dbd1f1?s=128&d=identicon&r=PG", "display_name": "leedm777", "link": "https://stackoverflow.com/users/115478/leedm777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5450, "favorite_count": 5, "accepted_answer_id": 33884893, "answer_count": 1, "score": 26, "last_activity_date": 1448335392, "creation_date": 1448335200, "question_id": 33884870, "link": "https://stackoverflow.com/questions/33884870/how-can-i-get-a-docker-images-label-if-the-label-name-has-a-in-it", "title": "How can I get a Docker image&#39;s label if the label name has a &quot;.&quot; in it?", "body": "<p>The docker inspect command can be very useful for getting the labels on a Docker image:</p>\n\n<pre><code># -*- Dockerfile -*-\nFROM busybox\nLABEL foo=\"bar\"\nLABEL com.wherever.foo=\"bang\"\n</code></pre>\n\n<p>For simple label names, the inspect command has a <code>--format</code> option (which uses Go templates) that works nicely.</p>\n\n<pre><code>$ docker build -t foo .\n$ docker inspect -f '{{ .Config.Labels.foo }}' foo\nbar\n</code></pre>\n\n<p>But how do I access labels that have a dot in their name?</p>\n\n<pre><code>$ docker inspect -f '{{ .Config.Labels.com.wherever.foo }}' foo\n&lt;no value&gt;\n</code></pre>\n\n<p>I'm writing this in a bash script, where I'd like to avoid re-parsing the JSON output from <code>docker inspect</code>, if possible.</p>\n"}, {"tags": ["go", "server"], "comments": [{"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1448318027, "post_id": 33881867, "comment_id": 55528492, "body": "<a href=\"http://stackoverflow.com/questions/12830095/setting-http-headers-in-golang\" title=\"setting http headers in golang\">stackoverflow.com/questions/12830095/&hellip;</a>"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1448322962, "post_id": 33881867, "comment_id": 55530431, "body": "Keep in mind that HTTP and HTML aren&#39;t implicitly tied together. Go will try and inspect the MIME type of your content and set the Content-Type header appropriately, but in some cases it cannot do that."}], "answers": [{"comments": [{"owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "edited": false, "score": 0, "creation_date": 1448317829, "post_id": 33881938, "comment_id": 55528374, "body": "Oh I see -- Go is sending HTTP on its own, and my HTTP was passed after the actual HTTP. Thanks!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1448372839, "last_edit_date": 1448372839, "creation_date": 1448317701, "answer_id": 33881938, "question_id": 33881867, "link": "https://stackoverflow.com/questions/33881867/getting-a-simple-server-to-display-a-web-page/33881938#33881938", "title": "Getting a simple server to display a web page", "body": "<p>You need to set the proper <code>Content-Type</code> header in the <code>ResponseWriter</code> before you write the response. You don't need to send the HTTP header, as that's sent implicitly on the first call to <code>Write</code>, or explicitly via <code>WriterHeader</code>.</p>\n\n<pre><code>w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 2, "last_activity_date": 1448317962, "creation_date": 1448317962, "answer_id": 33882014, "question_id": 33881867, "link": "https://stackoverflow.com/questions/33881867/getting-a-simple-server-to-display-a-web-page/33882014#33882014", "title": "Getting a simple server to display a web page", "body": "<p>If you will open your page in any alternative of chrome inspector, you will see that it has:</p>\n\n<p><code>Content-Type:text/plain; charset=utf-8</code></p>\n\n<p>Which tells your browser how to interpret it. You can send additional header specifying the content type: <code>w.Header().Set(\"Content-Type\", \"text/html\")</code> or just remove all you <code>GET ...</code> leaving just:</p>\n\n<pre><code>text := \"&lt;h1&gt;page&lt;/h1&gt;&lt;span&gt;page2&lt;/span&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 10150, "user_id": 341362, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/deb483e59f08e28083464e8e35a352db?s=128&d=identicon&r=PG", "display_name": "Charles", "link": "https://stackoverflow.com/users/341362/charles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 33881938, "answer_count": 2, "score": 0, "last_activity_date": 1448372839, "creation_date": 1448317454, "question_id": 33881867, "link": "https://stackoverflow.com/questions/33881867/getting-a-simple-server-to-display-a-web-page", "title": "Getting a simple server to display a web page", "body": "<p>I'm writing a simple server as a project to help me learn Go. Here's its minimal form:</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"net/http\"\n)\n\nfunc serve(w http.ResponseWriter, r *http.Request) {\n    text := \"HTTP/1.1 200 OK\\r\\n\" +\n    \"Content-Type: text/html\\r\\n\" + \n    \"Host: localhost:1234\\r\\n\" + \n    \"Connection: close\\r\\n\" + \n    \"\\r\\n\" + \n    \"&lt;!doctype html&gt;\\r\\n\" + \n    \"&lt;html&gt;...&lt;/html&gt;\\r\\n\"\n\n    // Greet the user, ignoring their request.\n    io.WriteString(w, text)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", serve)\n    http.ListenAndServe(\":1234\", nil)\n}\n</code></pre>\n\n<p>It works as expected in terms that it sends the desired text when a client connects to <code>localhost:1234</code>. But for some reason my browser displays the output as text instead of HTML, as desired. What am I doing wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448316172, "post_id": 33881238, "comment_id": 55527564, "body": "What&#39;s wrong with just having a scratch file open in your editor, and using <code>go run</code>?  I&#39;ll usually have play file open in vim, and in the terminal I just repeat the last <code>go run play.go</code> command."}, {"owner": {"reputation": 2360, "user_id": 218012, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d73afdb3398bc101e028273454ac29a?s=128&d=identicon&r=PG", "display_name": "Josh Nankin", "link": "https://stackoverflow.com/users/218012/josh-nankin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448328791, "post_id": 33881238, "comment_id": 55532176, "body": "I dont get context with a scratch file. I have to manually recreate it which is often cumbersome"}], "answers": [{"comments": [{"owner": {"reputation": 2360, "user_id": 218012, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d73afdb3398bc101e028273454ac29a?s=128&d=identicon&r=PG", "display_name": "Josh Nankin", "link": "https://stackoverflow.com/users/218012/josh-nankin"}, "edited": false, "score": 0, "creation_date": 1448315319, "post_id": 33881283, "comment_id": 55527125, "body": "I actually have not.  I&#39;m brand new to go and hadn&#39;t heard of it until now.  But if I want to evaluate an expression in the context of a function call, it seems like this would be extremely difficult using gore"}], "tags": [], "owner": {"reputation": 6258, "user_id": 1527018, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62e4e73fe7386a5e9401f90dc98c7584?s=128&d=identicon&r=PG", "display_name": "mic4ael", "link": "https://stackoverflow.com/users/1527018/mic4ael"}, "is_accepted": false, "score": 1, "last_activity_date": 1448315085, "creation_date": 1448315085, "answer_id": 33881283, "question_id": 33881238, "link": "https://stackoverflow.com/questions/33881238/golang-experimentation-at-runtime/33881283#33881283", "title": "golang experimentation at runtime", "body": "<p>Have you already tried <a href=\"https://github.com/motemen/gore\" rel=\"nofollow\">https://github.com/motemen/gore</a> project?</p>\n"}, {"comments": [{"owner": {"reputation": 2360, "user_id": 218012, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d73afdb3398bc101e028273454ac29a?s=128&d=identicon&r=PG", "display_name": "Josh Nankin", "link": "https://stackoverflow.com/users/218012/josh-nankin"}, "edited": false, "score": 0, "creation_date": 1448328805, "post_id": 33881417, "comment_id": 55532179, "body": "Actually, this will work.  I&#39;m looking for the &#39;p&#39; in godebug.  The default debugger in goclipse is gdb and I thought it was the only one that people use.  I&#39;m new to go, so I didn&#39;t know there were alternatives."}, {"owner": {"reputation": 2360, "user_id": 218012, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d73afdb3398bc101e028273454ac29a?s=128&d=identicon&r=PG", "display_name": "Josh Nankin", "link": "https://stackoverflow.com/users/218012/josh-nankin"}, "edited": false, "score": 0, "creation_date": 1448329106, "post_id": 33881417, "comment_id": 55532266, "body": "p(rint) [expression]\tprint a variable or any other Go expression"}], "tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": true, "score": 1, "last_activity_date": 1448315594, "creation_date": 1448315594, "answer_id": 33881417, "question_id": 33881238, "link": "https://stackoverflow.com/questions/33881238/golang-experimentation-at-runtime/33881417#33881417", "title": "golang experimentation at runtime", "body": "<p>Most probably you are looking for a debugger (to insert breakpoints, stop at them and start playing with variables there).</p>\n\n<p>One of the debuggers is <a href=\"https://github.com/mailgun/godebug\" rel=\"nofollow\">https://github.com/mailgun/godebug</a> and you can read more how to use it in this <a href=\"https://blog.cloudflare.com/go-has-a-debugger-and-its-awesome/\" rel=\"nofollow\">blogpost</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2360, "user_id": 218012, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d73afdb3398bc101e028273454ac29a?s=128&d=identicon&r=PG", "display_name": "Josh Nankin", "link": "https://stackoverflow.com/users/218012/josh-nankin"}, "edited": false, "score": 0, "creation_date": 1448371674, "post_id": 33884645, "comment_id": 55552554, "body": "Yeah, I can get most of this functionality with goclipse as well, but watch expressions dont work which is what I&#39;m really looking for"}], "tags": [], "owner": {"reputation": 149, "user_id": 4196050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbff3e78a087f0ef6a94cece76b767b2?s=128&d=identicon&r=PG", "display_name": "Lonnie Webb", "link": "https://stackoverflow.com/users/4196050/lonnie-webb"}, "is_accepted": false, "score": 0, "last_activity_date": 1448333765, "creation_date": 1448333765, "answer_id": 33884645, "question_id": 33881238, "link": "https://stackoverflow.com/questions/33881238/golang-experimentation-at-runtime/33884645#33884645", "title": "golang experimentation at runtime", "body": "<p>Sublime and VIM now support the go plugin but the usage is a little esoteric.</p>\n\n<p>The JetBrains IdeaJ community IDE with the go debug plugin has worked really, really well for me.  That said, starting out, the value of a quick <code>go run</code> with <code>fmt.Println</code> can't be overstated.</p>\n"}], "owner": {"reputation": 2360, "user_id": 218012, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d73afdb3398bc101e028273454ac29a?s=128&d=identicon&r=PG", "display_name": "Josh Nankin", "link": "https://stackoverflow.com/users/218012/josh-nankin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 33881417, "answer_count": 3, "score": -3, "last_activity_date": 1448333765, "creation_date": 1448314905, "last_edit_date": 1448329293, "question_id": 33881238, "link": "https://stackoverflow.com/questions/33881238/golang-experimentation-at-runtime", "title": "golang experimentation at runtime", "body": "<p>Often when I'm coding I like to see how things work or what certain expressions yield at a specific area in my code base.</p>\n\n<p>Most other languages provide tools to evaluate new custom expressions at runtime.  Golang doesn't seem to provide this yet, or at least with the tools I've used  (sublime, goclipse).</p>\n\n<p>Currently I'm solving this by using Println or recreating a small test environment that sets up just what I need to run some on the fly expressions, but I'm figuring there must be a better way...</p>\n\n<p>I could use something like play.golang.org, but often I have a lot of dependencies or it would require a lot of copy and pasting to make my simple trial-and-error code work.</p>\n"}, {"tags": ["caching", "go", "webserver"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 1561721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42985ff419df1beea68361a9c75a3849?s=128&d=identicon&r=PG", "display_name": "eyecarver", "link": "https://stackoverflow.com/users/1561721/eyecarver"}, "edited": false, "score": 0, "creation_date": 1448317119, "post_id": 33881296, "comment_id": 55528018, "body": "I&#39;ve already got the no cache headers set in index.html, but it appears that the decision is being made by looking at the file timestamp before checking the headers."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 155, "user_id": 1561721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42985ff419df1beea68361a9c75a3849?s=128&d=identicon&r=PG", "display_name": "eyecarver", "link": "https://stackoverflow.com/users/1561721/eyecarver"}, "edited": false, "score": 1, "creation_date": 1448317377, "post_id": 33881296, "comment_id": 55528142, "body": "Your browser/HTTP client can&#39;t &quot;see&quot; the timestamp, but yes, <code>http.FileServer</code> will set it via <code>serveContent</code> <a href=\"https://golang.org/src/net/http/fs.go?#L417\" rel=\"nofollow noreferrer\">here</a> and will set the <code>Last-Modified</code> header as per <a href=\"https://golang.org/src/net/http/fs.go?#L282\" rel=\"nofollow noreferrer\">here</a>. The other alternative is to call <code>http.ServeContent</code> directly inside your own handler and pass <code>time.Now()</code> as the <code>modTime</code>."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 16, "last_activity_date": 1448315138, "creation_date": 1448315138, "answer_id": 33881296, "question_id": 33880343, "link": "https://stackoverflow.com/questions/33880343/go-webserver-dont-cache-files-using-timestamp/33881296#33881296", "title": "Go webserver - don&#39;t cache files using timestamp", "body": "<p>Assuming your file server code is like the <a href=\"https://golang.org/pkg/net/http/#example_FileServer_stripPrefix\" rel=\"noreferrer\">example in the docs</a>: </p>\n\n<pre><code>http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"/static\"))))\n</code></pre>\n\n<p>You can write a handler that sets the appropriate cache headers to prevent this behaviour by stripping ETag headers and setting <code>Cache-Control: no-cache, private, max-age=0</code> to prevent caching (both locally and in upstream proxies):</p>\n\n<pre><code>var epoch = time.Unix(0, 0).Format(time.RFC1123)\n\nvar noCacheHeaders = map[string]string{\n    \"Expires\":         epoch,\n    \"Cache-Control\":   \"no-cache, private, max-age=0\",\n    \"Pragma\":          \"no-cache\",\n    \"X-Accel-Expires\": \"0\",\n}\n\nvar etagHeaders = []string{\n    \"ETag\",\n    \"If-Modified-Since\",\n    \"If-Match\",\n    \"If-None-Match\",\n    \"If-Range\",\n    \"If-Unmodified-Since\",\n}\n\nfunc NoCache(h http.Handler) http.Handler {\n    fn := func(w http.ResponseWriter, r *http.Request) {\n        // Delete any ETag headers that may have been set\n        for _, v := range etagHeaders {\n            if r.Header.Get(v) != \"\" {\n                r.Header.Del(v)\n            }\n        }\n\n        // Set our NoCache headers\n        for k, v := range noCacheHeaders {\n            w.Header().Set(k, v)\n        }\n\n        h.ServeHTTP(w, r)\n    }\n\n    return http.HandlerFunc(fn)\n}\n</code></pre>\n\n<p>Use it like so:</p>\n\n<pre><code>http.Handle(\"/static/\", NoCache(http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"/static\")))))\n</code></pre>\n\n<p>Note: I originally wrote this at <a href=\"https://github.com/zenazn/goji/blob/master/web/middleware/nocache.go\" rel=\"noreferrer\">github.com/zenazn/goji/middleware</a>, so you can also just import that, but it's a simple piece of code to write and I wanted to show a full example for posterity! </p>\n"}], "owner": {"reputation": 155, "user_id": 1561721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42985ff419df1beea68361a9c75a3849?s=128&d=identicon&r=PG", "display_name": "eyecarver", "link": "https://stackoverflow.com/users/1561721/eyecarver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3705, "favorite_count": 1, "accepted_answer_id": 33881296, "answer_count": 1, "score": 5, "last_activity_date": 1448315255, "creation_date": 1448311450, "question_id": 33880343, "link": "https://stackoverflow.com/questions/33880343/go-webserver-dont-cache-files-using-timestamp", "title": "Go webserver - don&#39;t cache files using timestamp", "body": "<p>I'm running a webserver written in go on an embedded system. The timestamp of index.html may go backwards if someone has downgraded the firmware version. If index.html is older than the previous version, the server sends a http 304 response (not modified), and serves a cached version of the file.</p>\n\n<p>The webserver code is using http.FileServer() and http.ListenAndServe().</p>\n\n<p>The problem can easily reproduced by modifying the timestamp of index.html using the Posix command <code>touch</code></p>\n\n<pre><code>touch -d\"23:59\" index.html\n</code></pre>\n\n<p>reloading the page, then</p>\n\n<pre><code>touch -d\"23:58\" index.html\n</code></pre>\n\n<p>reloading this time will give a 304 response on index.html.</p>\n\n<p>Is there a way to prevent timestamp based caching?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5556204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6148a35865d5734fb5dffc4a60663d6a?s=128&d=identicon&r=PG&f=1", "display_name": "over300laughs", "link": "https://stackoverflow.com/users/5556204/over300laughs"}, "edited": false, "score": 0, "creation_date": 1448311923, "post_id": 33880238, "comment_id": 55525220, "body": "Yep that was the issue. Thanks for the mapping explanation!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1448311074, "creation_date": 1448311074, "answer_id": 33880238, "question_id": 33880196, "link": "https://stackoverflow.com/questions/33880196/how-to-decode-map-json-objects-using-newdecode-golang-and-req-http-request/33880238#33880238", "title": "How to Decode &amp; Map JSON Objects using NewDecode, Golang and req *http.Request", "body": "<p>Tag your struct fields so the decoder knows how to map the json keys to your struct.</p>\n\n<pre><code>type Message struct {\n    CompanyDomain string `json:\"company_domain\"`\n    Username      string `json:\"user_name\"`\n    Password      string `json:\"password\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 0, "last_activity_date": 1448311184, "creation_date": 1448311184, "answer_id": 33880271, "question_id": 33880196, "link": "https://stackoverflow.com/questions/33880196/how-to-decode-map-json-objects-using-newdecode-golang-and-req-http-request/33880271#33880271", "title": "How to Decode &amp; Map JSON Objects using NewDecode, Golang and req *http.Request", "body": "<p>You just need to add <code>json:\"field_name\"</code> to your struct:</p>\n\n<pre><code>type Message struct {\n    CompanyDomain string `json:\"company_domain\"`\n    Username      string `json:\"user_name\"`\n    Password      string `json:\"password\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5556204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6148a35865d5734fb5dffc4a60663d6a?s=128&d=identicon&r=PG&f=1", "display_name": "over300laughs", "link": "https://stackoverflow.com/users/5556204/over300laughs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 33880238, "answer_count": 2, "score": 0, "last_activity_date": 1448312056, "creation_date": 1448310911, "last_edit_date": 1448312056, "question_id": 33880196, "link": "https://stackoverflow.com/questions/33880196/how-to-decode-map-json-objects-using-newdecode-golang-and-req-http-request", "title": "How to Decode &amp; Map JSON Objects using NewDecode, Golang and req *http.Request", "body": "<p>Coming from PHP I'm a TOTAL Golang newb here. I read a question that is VERY similar to mine but my implementation is slightly off. Whenever I go to decode using the following code the variable msg.Username is always blank. Golang doesn't throw errors here so I know I'm missing something super small here and very important but I have no idea what it could be. I would be a very appreciative of any help and am of course expecting this to be a fist-to-foerhead epiphany. Thanks! </p>\n\n<pre><code>//The JSON I'm posting to my local server is  \n//{\"company_domain\":\"example.com\", \"user_name\":\"testu\",\"password\":\"testpw\"}\n\nfunc Login(w http.ResponseWriter, req *http.Request) {\n  type Message struct {\n      CompanyDomain string\n      Username      string\n      Password      string\n  }\n  //decode\n  var msg Message\n  decoder := json.NewDecoder(req.Body)\n  err := decoder.Decode(&amp;msg)\n  if err != nil {\n      err.Error())\n  }\n  w.Write([]byte(msg.Username))// &lt;- This print statement always comes in blank \n  authorize, err := models.VerifyAuth(msg.Username, msg.Password, msg.CompanyDomain, w)\n  if err != nil {\n      err.Error())\n  }\n  ...\n</code></pre>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448293874, "post_id": 33874992, "comment_id": 55513749, "body": "what version of Go are you running 1.4 or 1.5?"}, {"owner": {"reputation": 21, "user_id": 5595907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc9a60512a30c98dc82c12cad0d8b076?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/5595907/christian"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448293949, "post_id": 33874992, "comment_id": 55513814, "body": "latest version 1.5.1"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1448294010, "post_id": 33874992, "comment_id": 55513861, "body": "Take a look at <a href=\"http://stackoverflow.com/questions/24863164/how-to-analyse-golang-memory\">this</a> answer, that explains that no memory is released to os once it has been used by the program."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448296764, "post_id": 33874992, "comment_id": 55515678, "body": "What OS are you using, and how are you measuring actual memory usage? <code>HeapIdle</code> and <code>HeapReleased</code> may refer to the same memory, and new allocations may take away from both of those stats. (Also the OS isn&#39;t obligated to &quot;free&quot; the memory from the process, but you need to measure that from the OS)"}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1448308592, "post_id": 33874992, "comment_id": 55523135, "body": "I found this question &amp; answer very useful on how the garbage collector is operating and there is a delay before the memory is handed back to the OS:  <a href=\"http://stackoverflow.com/questions/24376817/go-1-3-garbage-collector-not-releasing-server-memory-back-to-system\" title=\"go 1 3 garbage collector not releasing server memory back to system\">stackoverflow.com/questions/24376817/&hellip;</a>"}, {"owner": {"reputation": 73, "user_id": 1244183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8450a1f77d8b8ed9889078288741f3b3?s=128&d=identicon&r=PG", "display_name": "kongxx", "link": "https://stackoverflow.com/users/1244183/kongxx"}, "edited": false, "score": 0, "creation_date": 1484196369, "post_id": 33874992, "comment_id": 70412717, "body": "Maybe this post can help you. <a href=\"http://stackoverflow.com/questions/24863164/how-to-analyse-golang-memory?answertab=votes#tab-top\" title=\"how to analyse golang memory\">stackoverflow.com/questions/24863164/&hellip;</a>"}], "owner": {"reputation": 21, "user_id": 5595907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc9a60512a30c98dc82c12cad0d8b076?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/5595907/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1448293466, "creation_date": 1448293466, "question_id": 33874992, "link": "https://stackoverflow.com/questions/33874992/memory-consumption-in-go", "title": "Memory consumption in Go", "body": "<p>I have a server written in Go which does not release the consumed memory. I started the program with the <code>GODEBUG=gctrace=1</code> option and I get the following output:</p>\n\n<pre><code>scvg44: inuse: 1, idle: 423, sys: 425, released: 423, consumed: 1 (MB)\nscvg45: inuse: 1, idle: 423, sys: 425, released: 423, consumed: 1 (MB)\n...\nscvg49: inuse: 1, idle: 423, sys: 425, released: 423, consumed: 1 (MB)\nscvg50: inuse: 1, idle: 423, sys: 425, released: 423, consumed: 1 (MB)\n</code></pre>\n\n<p>So while the output says that 423 MB are released to the OS that seems not to be the case. The program has 423 MB idle memory for hours. Why does the program not release the memory?</p>\n"}, {"tags": ["testing", "go", "code-coverage"], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 3, "last_activity_date": 1448288850, "creation_date": 1448288850, "answer_id": 33873429, "question_id": 33873305, "link": "https://stackoverflow.com/questions/33873305/how-to-get-100-code-coverage-in-golang/33873429#33873429", "title": "How to get 100% code coverage in Golang?", "body": "<p>One trick I can suggest is instead of calling <code>log.Fatal</code>, make your own fatal func with the same signature:</p>\n\n<pre><code>var fatal func(...interface{}) = log.Fatal\n</code></pre>\n\n<p>anywhere in your package. It can be unexported so other packages cannot set or use it. Then in your test you can replace it with:</p>\n\n<pre><code>fatal = func(v ...interface){\n    panic(fmt.Sprint(v...))\n}\n</code></pre>\n\n<p>or whatever you want to do.</p>\n\n<p>I use this kind of trick when I need to test time.Now or something of this sort.</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 3242022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54bAn.jpg?s=128&g=1", "display_name": "getting_better", "link": "https://stackoverflow.com/users/3242022/getting-better"}, "edited": false, "score": 0, "creation_date": 1585924565, "post_id": 33873685, "comment_id": 107943771, "body": "I hate this return-error-up thing in go but for sync code it works. For async code however that runs on a separate <code>goroutine</code> this can go only to some extend. For async the rule is try <code>return</code> top and then <code>panic</code> and <code>recover</code>. This will satisfy the coverage god if you do it right. But yes panicking in async is counter-intuitive"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 6, "last_activity_date": 1448289562, "creation_date": 1448289562, "answer_id": 33873685, "question_id": 33873305, "link": "https://stackoverflow.com/questions/33873305/how-to-get-100-code-coverage-in-golang/33873685#33873685", "title": "How to get 100% code coverage in Golang?", "body": "<p>For this reason I find it useful for all functions and packages besides main to return errors rather than call log.Fatal directly. Then it can be main's decision to exit or not on errors. Trying to get 100% test coverage no matter what may give diminishing returns in a lot of cases though, so it may also be ok to call it good enough.</p>\n"}], "owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2269, "favorite_count": 1, "closed_date": 1448305759, "accepted_answer_id": 33873685, "answer_count": 2, "score": 3, "last_activity_date": 1448289562, "creation_date": 1448288519, "last_edit_date": 1495541706, "question_id": 33873305, "link": "https://stackoverflow.com/questions/33873305/how-to-get-100-code-coverage-in-golang", "closed_reason": "Duplicate", "title": "How to get 100% code coverage in Golang?", "body": "<p>I cannot get 100% code coverage as I cannot test Fatals in Golang. </p>\n\n<p><a href=\"https://i.stack.imgur.com/5K3oN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5K3oN.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have found some Q&amp;As including <a href=\"https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal\">this one</a>, but I am lost as the answers to the posts are contradictory. On the one hand it is possible to <a href=\"https://stackoverflow.com/questions/10516662/how-to-measure-code-coverage-in-golang\">check the code coverage in Golang.</a> On the other hand some advocate to ignore the testing of e.g. <code>log.Fatal(err)</code>, resulting in a code coverage of less than <code>100%</code>.</p>\n\n<hr>\n\n<p><strong>Attempts</strong></p>\n\n<p>As a workaround I replaced all <code>log.Fatal</code> by <code>panic</code> and thanks to <a href=\"https://stackoverflow.com/a/31596110/2777965\">this answer</a> I am able to test all the panics and to achieve 100% code coverage.</p>\n\n<hr>\n\n<p><strong>Problem</strong></p>\n\n<p>Although I am able to get 100% code coverage I am not happy as I am basically misusing <code>panic</code> to get 100% code coverage. According to <a href=\"https://stackoverflow.com/questions/28472922/when-to-use-os-exit-and-panic-golang/28473339#28473339\">this answer</a> a <code>panic</code> is used: </p>\n\n<blockquote>\n  <p>when the program, or its part, has reached an unrecoverable state</p>\n</blockquote>\n\n<p>Based on this definition there are multiple snippets in my code that can throw a panic, while a <code>log.Fatal</code> should be used.</p>\n"}, {"tags": ["go", "cross-platform", "binaryfiles", "computer-architecture"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448287454, "post_id": 33872612, "comment_id": 55509353, "body": "I&#39;m not sure what you&#39;re asking. Binaries are portable between systems with the same OS and architecture. Go builds the binary for your host GOOS and GOARCH unless you specify otherwise. You can&#39;t take a 64bit binary and run it on a 32bit system."}, {"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448287534, "post_id": 33872612, "comment_id": 55509397, "body": "That hasn&#39;t been my experience with creating binaries that are meant to be cross platform."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1448287560, "post_id": 33872612, "comment_id": 55509424, "body": "To answer your question: &quot;Not at all.&quot; Simply because this is impossible to do. No compiler/linker/loader/toolchain can do this. Google cross compilation which is trivial with Go."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448290947, "post_id": 33872612, "comment_id": 55511748, "body": "If that hans&#39;t been your experience, then you need to show us the problem you&#39;re having. The question &quot;how static/portable is go&#39;s linker/compiler?&quot; doesn&#39;t make much sense."}, {"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 2, "creation_date": 1448463146, "post_id": 33872612, "comment_id": 55600182, "body": "Off topic. This tool easy your life <a href=\"https://github.com/mitchellh/gox\" rel=\"nofollow noreferrer\">github.com/mitchellh/gox</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": true, "score": 49, "last_activity_date": 1448287559, "creation_date": 1448287559, "answer_id": 33873000, "question_id": 33872612, "link": "https://stackoverflow.com/questions/33872612/are-golang-binaries-portable/33873000#33873000", "title": "Are Golang binaries portable?", "body": "<ol>\n<li>Yes it will; this is true of basically all binaries compiled for 64-bit Linux, not just those written in Go (except for shared libraries, which Go doesn't rely on)</li>\n<li>You can set the <code>GOOS</code> and <code>GOARCH</code> environment variables before building: <code>GOOS=windows GOARCH=386 go build</code> (or <code>go install</code> or whatever), etc</li>\n<li>By default a binary will be built for the system you're running, but this isn't necessary - see 2</li>\n</ol>\n"}], "owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13660, "favorite_count": 6, "accepted_answer_id": 33873000, "answer_count": 1, "score": 40, "last_activity_date": 1448287559, "creation_date": 1448286297, "question_id": 33872612, "link": "https://stackoverflow.com/questions/33872612/are-golang-binaries-portable", "title": "Are Golang binaries portable?", "body": "<p>Suppose I'm a primarily Linux user, but I'm developing an application in Go that I want to be cross platform. I've searched around, but I can't seem to find information to absolve the following:</p>\n\n<ol>\n<li>If I <code>go install</code> a binary on my amd64 Ubuntu system, will it also work on <em>anyone else's</em> 64-bit Ubuntu/Debian system?</li>\n<li>How can I use <code>go install</code> to build an x86_64 binary that will also run out-of-the-box on 32-bit Debianlikes?</li>\n<li>If I must use Windows to make a binary which will run on Windows, how can I also ensure that even if my Windows system is 64-bit the executable will be built for x86_64?</li>\n</ol>\n\n<p>My questions in effect boil down to, \"how static/portable is go's linker/compiler?\"</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2293, "user_id": 1098584, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7ab6b6d44e367a743580c3089026b7bc?s=128&d=identicon&r=PG", "display_name": "sontags", "link": "https://stackoverflow.com/users/1098584/sontags"}, "edited": false, "score": 0, "creation_date": 1448290815, "post_id": 33873957, "comment_id": 55511641, "body": "Seems like was a bit locked in my idea of remove and append. Your approach is way prettier! Thanks"}], "tags": [], "owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "is_accepted": true, "score": 1, "last_activity_date": 1448290355, "creation_date": 1448290355, "answer_id": 33873957, "question_id": 33872452, "link": "https://stackoverflow.com/questions/33872452/delete-element-from-custom-type-slice-of-pointers-in-go/33873957#33873957", "title": "Delete element from custom type (slice of pointers) in Go", "body": "<p>From you requirement, what I understand is that you need to replace strut whose key matches with new strut with updated value and point Old to the previous one getting replaced. \nOne way to do as follows, where you don't need to remove from slice. </p>\n\n<p>Please note in this case your insertion order fro the new foo, 3 which is inserted after bar will not be maintained, and will be the replace the foo, 1 at position 0, before bar.</p>\n\n<pre><code>func (m *MergedVars) Insert(key string, value int) {\n    v := &amp;Merged{\n        Key:   key,\n        Value: value,\n    }\n\n    found := false\n    for k, mv := range *m {\n        if mv.Key == key {\n            v.Old = mv\n            m1 := *m\n            m1[k] = v\n            found = true\n        }\n    }\n\n    if !found {\n        *m = append(*m, v)\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/KINvnAP08Q\" rel=\"nofollow\">http://play.golang.org/p/KINvnAP08Q</a></p>\n"}], "owner": {"reputation": 2293, "user_id": 1098584, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7ab6b6d44e367a743580c3089026b7bc?s=128&d=identicon&r=PG", "display_name": "sontags", "link": "https://stackoverflow.com/users/1098584/sontags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "closed_date": 1449035508, "accepted_answer_id": 33873957, "answer_count": 1, "score": 0, "last_activity_date": 1448290355, "creation_date": 1448285821, "last_edit_date": 1448288951, "question_id": 33872452, "link": "https://stackoverflow.com/questions/33872452/delete-element-from-custom-type-slice-of-pointers-in-go", "closed_reason": "Not suitable for this site", "title": "Delete element from custom type (slice of pointers) in Go", "body": "<p>I have to remove an element from custom type \"MergedVars\" (which is a slice of pointers) while running a method of that custom type:</p>\n\n<pre><code>type Merged struct {\n    Key          string\n    Value        int\n    Old          *Merged\n}\n\ntype MergedVars []*Merged\n\n\nfunc (m MergedVars) String() string {\n    var out string\n\n    for _, v := range m {\n        out += fmt.Sprintf(\"Key: `%s`, Value: `%d`, Old: `%v`\\n\", v.Key, v.Value, v.Old)\n    }\n\n    return out\n}\n\n\nfunc (m *MergedVars) Insert(key string, value int) {\n    v := &amp;Merged{\n        Key:          key,\n        Value:        value,\n    }\n\n    for k, mv := range *m {\n        if mv.Key == key {\n            v.Old = mv\n            m.remove(k)\n        }\n    }\n\n    *m = append(*m, v)\n}\n\n\n// This fails\nfunc (m *MergedVars) remove(pos int) {\n    // https://github.com/golang/go/wiki/SliceTricks\n    m, m[len(m)-1] = append(m[:pos], m[pos+1:]...), nil\n}\n</code></pre>\n\n<p>So running this...</p>\n\n<pre><code>m := MergedVars{}\nm.Insert(\"foo\", 1)\nm.Insert(\"bar\", 2)\nm.Insert(\"foo\", 3)\n</code></pre>\n\n<p>... should get me a slice of two elements where the element with the key \"foo\" has value 3 and its \"old\" field points to \"foo\": 1</p>\n\n<p>See it (not) working at:</p>\n\n<p><a href=\"http://play.golang.org/p/0-cx8tdOZD\" rel=\"nofollow\">http://play.golang.org/p/0-cx8tdOZD</a></p>\n\n<p>How do I have to implement the remove function proparly?</p>\n"}, {"tags": ["python", "go", "celery", "task-queue"], "comments": [{"owner": {"reputation": 6055, "user_id": 956660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/67d04ae3dfdf060c4a2fa2dfea9b6b22?s=128&d=identicon&r=PG", "display_name": "Cyrbil", "link": "https://stackoverflow.com/users/956660/cyrbil"}, "edited": false, "score": 0, "creation_date": 1448285972, "post_id": 33872305, "comment_id": 55508364, "body": "Maybe be use the method  <a href=\"http://docs.celeryproject.org/en/latest/reference/celery.result.html#celery.result.AsyncResult.forget\" rel=\"nofollow noreferrer\"><code>.forget()</code></a> on a return from a task creation."}], "owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448285529, "creation_date": 1448285353, "last_edit_date": 1448285529, "question_id": 33872305, "link": "https://stackoverflow.com/questions/33872305/how-to-cancel-revoke-a-delayed-task-in-another-language-other-than-python", "title": "How to cancel/revoke a delayed task in another language other than Python?", "body": "<p>We are using Celery as a task queue. It serves both our Django application and another app written in Go.</p>\n\n<p>To create a task in celery in Go language, I can post a message directly into RabbitMQ with something like this:\n<a href=\"https://github.com/bsphere/celery\" rel=\"nofollow\">https://github.com/bsphere/celery</a></p>\n\n<p>But our Go app also needs to cancel a delayed task before it is executed. How can I do this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 974, "user_id": 1454877, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e931c7352cde70c76c1eb25a8a8f749?s=128&d=identicon&r=PG", "display_name": "Engineer81", "link": "https://stackoverflow.com/users/1454877/engineer81"}, "edited": false, "score": 0, "creation_date": 1448285604, "post_id": 33872316, "comment_id": 55508140, "body": "I had a suspicion this might be the case. The problem that I had when I was handling in the same function is that I was blocking or it was slowing down the despatch of new devices and/or messages for each device. I&#39;ll give it another try anyway and I&#39;ll take a look at <code>time.Timer</code>, thanks"}, {"owner": {"reputation": 974, "user_id": 1454877, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e931c7352cde70c76c1eb25a8a8f749?s=128&d=identicon&r=PG", "display_name": "Engineer81", "link": "https://stackoverflow.com/users/1454877/engineer81"}, "edited": false, "score": 0, "creation_date": 1448294774, "post_id": 33872316, "comment_id": 55514401, "body": "OK, I&#39;ve given this a whirl @rob-napier but I&#39;m not sure that I&#39;ve understood correctly. I&#39;m getting some odd errors if I try to process too many <code>thing</code>s at a time. I&#39;ve edited my question accordingly, if you don&#39;t mind taking a look :) Thanks!"}, {"owner": {"reputation": 974, "user_id": 1454877, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e931c7352cde70c76c1eb25a8a8f749?s=128&d=identicon&r=PG", "display_name": "Engineer81", "link": "https://stackoverflow.com/users/1454877/engineer81"}, "edited": false, "score": 0, "creation_date": 1448296374, "post_id": 33872316, "comment_id": 55515420, "body": "Thanks for the <code>strconv.Itoa(i)</code> pointer, @rob-napier. That was exactly it. All sorted and working perfectly now!"}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 6, "last_activity_date": 1448296197, "last_edit_date": 1448296197, "creation_date": 1448285389, "answer_id": 33872316, "question_id": 33872157, "link": "https://stackoverflow.com/questions/33872157/golang-map-len-reports-0-when-map-is-empty/33872316#33872316", "title": "Golang map len() reports &gt; 0 when map is empty", "body": "<p><code>map</code> is not thread-safe. You cannot access a <code>map</code> on multiple goroutines safely. You can corrupt the map, as you're seeing in this case.</p>\n\n<p>Rather than allow the goroutine to modify the map, the goroutine should write their identifier to a channel before returning. The main loop should watch that channel, and when an identifier comes back, should remove that element from the map.</p>\n\n<p>You'll probably want to read up on Go concurrency patterns. In particular, you may want to look at <a href=\"http://blog.golang.org/pipelines\" rel=\"nofollow\">Fan-out/Fan-in</a>. Look at the links at the bottom. The Go blog has a lot of information on concurrency.</p>\n\n<p>Note that your goroutine is busy waiting to check for timeout. There's no reason for that. The fact that you \"sleep(1 second)\") should be a clue that there's a mistake. Instead, look at <code>time.Timer</code> which will give you a chan that will receive a value after some time, which you can reset.</p>\n\n<hr>\n\n<p>Your problem is how you're converting numbers to strings:</p>\n\n<pre><code>        id:   string(i),\n</code></pre>\n\n<p>That creates a string using <code>i</code> as a rune (<code>int32</code>). For example <code>string(65)</code> is <code>A</code>. Some unequal Runes resolve to equal strings. You get a collision and close the same channel twice. See <a href=\"http://play.golang.org/p/__KpnfQc1V\" rel=\"nofollow\">http://play.golang.org/p/__KpnfQc1V</a></p>\n\n<p>You meant this:</p>\n\n<pre><code>        id:   strconv.Itoa(i),\n</code></pre>\n"}], "owner": {"reputation": 974, "user_id": 1454877, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e931c7352cde70c76c1eb25a8a8f749?s=128&d=identicon&r=PG", "display_name": "Engineer81", "link": "https://stackoverflow.com/users/1454877/engineer81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1643, "favorite_count": 0, "accepted_answer_id": 33872316, "answer_count": 1, "score": 3, "last_activity_date": 1448296778, "creation_date": 1448284900, "last_edit_date": 1448296778, "question_id": 33872157, "link": "https://stackoverflow.com/questions/33872157/golang-map-len-reports-0-when-map-is-empty", "title": "Golang map len() reports &gt; 0 when map is empty", "body": "<p><strong>Short story:</strong></p>\n\n<p>I'm having an issue where a map that previously had data but should now be empty is reporting a <code>len()</code> of > 0 even though it appears to be empty, and I have no idea why.</p>\n\n<p><strong>Longer story:</strong></p>\n\n<p>I need to process a number of <em>devices</em> at a time. Each <em>device</em> can have a number of messages. The concurrency of Go seemed like an obvious place to begin, so I wrote up some code to handle it and it seems to be going <em>mostly</em> very well. However...</p>\n\n<p>I started a single goroutine for each <em>device</em>. In the <code>main()</code> function I have a <code>map</code> that contains each of the <em>devices</em>. When a message comes in I check to see whether the <em>device</em> already exists and if not I create it, store it in the map, and then pass the message into the device's receiving buffered channel.</p>\n\n<p>This works great, and each device is being processed nicely. However, I need the device (and its goroutine) to terminate when it doesn't receive any messages for a preset amount of time. I've done this by checking in the goroutine itself how much time has passed since the last message was received, and if the goroutine is considered <em>stale</em> then the receiving channel is closed. But how to remove from the map?</p>\n\n<p>So I passed in a pointer to the map, and I have the goroutine delete the <em>device</em> from the map and close the receiving channel before returning. The problem though is that at the end I'm finding that the <code>len()</code> function returns a value > 0, but when I output the map itself I see that it's empty.</p>\n\n<p>I've written up a toy example to try to replicate the fault, and indeed I'm seeing that <code>len()</code> is reporting > 0 when the map is apparently empty. The last time I tried it I saw 10. The time before that 14. The time before that one, 53.</p>\n\n<p>So I can replicate the fault, but I'm not sure whether the fault is with me or with Go. How is <code>len()</code> reporting > 0 when there are apparently no items in it?</p>\n\n<p>Here's an example of how I've been able to replicate. I'm using Go v1.5.1 windows/amd64</p>\n\n<p>There are two things here, as far as I'm concerned:</p>\n\n<ol>\n<li>Am I managing the goroutines properly (probably not) and</li>\n<li>Why does <code>len(m)</code> report > 0 when there are no items in it?</li>\n</ol>\n\n<p>Thanks all</p>\n\n<p><strong>Example Code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"time\"\n)\n\nconst (\n    chBuffSize        = 100             // How large the thing's channel buffer should be\n    thingIdleLifetime = time.Second * 5 // How long things can live for when idle\n    thingsToMake      = 1000            // How many things and associated goroutines to make\n    thingMessageCount = 10              // How many messages to send to the thing\n)\n\n// The thing that we'll be passing into a goroutine to process -----------------\ntype thing struct {\n    id string\n    ch chan bool\n}\n\n// Go go gadget map test -------------------------------------------------------\nfunc main() {\n    // Make all of the things!\n    things := make(map[string]thing)\n    for i := 0; i &lt; thingsToMake; i++ {\n        t := thing{\n            id: string(i),\n            ch: make(chan bool, chBuffSize),\n        }\n        things[t.id] = t\n\n        // Pass the thing into it's own goroutine\n        go doSomething(t, &amp;things)\n\n        // Send (thingMessageCount) messages to the thing\n        go func(t thing) {\n            for x := 0; x &lt; thingMessageCount; x++ {\n                t.ch &lt;- true\n            }\n        }(t)\n    }\n\n    // Check the map of things to see whether we're empty or not\n    size := 0\n    for {\n        if size == len(things) &amp;&amp; size != thingsToMake {\n            log.Println(\"Same number of items in map as last time\")\n            log.Println(things)\n            os.Exit(1)\n        }\n        size = len(things)\n        log.Printf(\"Map size: %d\\n\", size)\n        time.Sleep(time.Second)\n    }\n}\n\n// Func for each goroutine to run ----------------------------------------------\n//\n// Takes two arguments:\n// 1) the thing that it is working with\n// 2) a pointer to the map of things\n//\n// When this goroutine is ready to terminate, it should remove the associated\n// thing from the map of things to clean up after itself\nfunc doSomething(t thing, things *map[string]thing) {\n    lastAccessed := time.Now()\n    for {\n        select {\n        case &lt;-t.ch:\n            // We received a message, so extend the lastAccessed time\n            lastAccessed = time.Now()\n        default:\n            // We haven't received a message, so check if we're allowed to continue\n            n := time.Now()\n            d := n.Sub(lastAccessed)\n            if d &gt; thingIdleLifetime {\n                // We've run for &gt;thingIdleLifetime, so close the channel, delete the\n                // associated thing from the map and return, terminating the goroutine\n                close(t.ch)\n                delete(*things, string(t.id))\n                return\n            }\n        }\n\n        // Just sleep for a second in each loop to prevent the CPU being eaten up\n        time.Sleep(time.Second)\n    }\n}\n</code></pre>\n\n<p>Just to add; in my original code this is looping forever. The program is designed to listen for TCP connections and receive and process the data, so the function that is checking the map count is running in it's own goroutine. However, this example has exactly the same symptom even though the map <code>len()</code> check is in the <code>main()</code> function and it is designed to handle an initial burst of data and then break out of the loop.</p>\n\n<p><strong>UPDATE 2015/11/23 15:56 UTC</strong></p>\n\n<p>I've refactored my example below. I'm not sure if I've misunderstood @RobNapier or not but this works much better. However, if I change <code>thingsToMake</code> to a larger number, say 100000, then I get lots of errors like this:</p>\n\n<pre><code>goroutine 199734 [select]:\nmain.doSomething(0xc0d62e7680, 0x4, 0xc0d64efba0, 0xc082016240)\n        C:/Users/anttheknee/go/src/maptest/maptest.go:83 +0x144\ncreated by main.main\n        C:/Users/anttheknee/go/src/maptest/maptest.go:46 +0x463\n</code></pre>\n\n<p>I'm not sure if the problem is that I'm asking Go to do too much, or if I've made a hash of understanding the solution. Any thoughts?</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"time\"\n)\n\nconst (\n    chBuffSize        = 100             // How large the thing's channel buffer should be\n    thingIdleLifetime = time.Second * 5 // How long things can live for when idle\n    thingsToMake      = 10000           // How many things and associated goroutines to make\n    thingMessageCount = 10              // How many messages to send to the thing\n)\n\n// The thing that we'll be passing into a goroutine to process -----------------\ntype thing struct {\n    id   string\n    ch   chan bool\n    done chan string\n}\n\n// Go go gadget map test -------------------------------------------------------\nfunc main() {\n    // Make all of the things!\n    things := make(map[string]thing)\n\n    // Make a channel to receive completion notification on\n    doneCh := make(chan string, chBuffSize)\n\n    log.Printf(\"Making %d things\\n\", thingsToMake)\n    for i := 0; i &lt; thingsToMake; i++ {\n        t := thing{\n            id:   string(i),\n            ch:   make(chan bool, chBuffSize),\n            done: doneCh,\n        }\n        things[t.id] = t\n\n        // Pass the thing into it's own goroutine\n        go doSomething(t)\n\n        // Send (thingMessageCount) messages to the thing\n        go func(t thing) {\n            for x := 0; x &lt; thingMessageCount; x++ {\n                t.ch &lt;- true\n                time.Sleep(time.Millisecond * 10)\n            }\n        }(t)\n    }\n    log.Printf(\"All %d things made\\n\", thingsToMake)\n\n    // Receive on doneCh when the goroutine is complete and clean the map up\n    for {\n        id := &lt;-doneCh\n        close(things[id].ch)\n        delete(things, id)\n        if len(things) == 0 {\n            log.Printf(\"Map: %v\", things)\n            log.Println(\"All done. Exiting\")\n            os.Exit(0)\n        }\n    }\n}\n\n// Func for each goroutine to run ----------------------------------------------\n//\n// Takes two arguments:\n// 1) the thing that it is working with\n// 2) the channel to report that we're done through\n//\n// When this goroutine is ready to terminate, it should remove the associated\n// thing from the map of things to clean up after itself\nfunc doSomething(t thing) {\n    timer := time.NewTimer(thingIdleLifetime)\n    for {\n        select {\n        case &lt;-t.ch:\n            // We received a message, so extend the timer\n            timer.Reset(thingIdleLifetime)\n        case &lt;-timer.C:\n            // Timer returned so we need to exit now\n            t.done &lt;- t.id\n            return\n        }\n    }\n}\n</code></pre>\n\n<p><strong>UPDATE 2015/11/23 16:41 UTC</strong></p>\n\n<p>The completed code that appears to be working properly. Do feel free to let me know if there are any improvements that could be made, but this works (sleeps are deliberate to see progress as it's otherwise too fast!)</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"strconv\"\n    \"time\"\n)\n\nconst (\n    chBuffSize        = 100             // How large the thing's channel buffer should be\n    thingIdleLifetime = time.Second * 5 // How long things can live for when idle\n    thingsToMake      = 100000          // How many things and associated goroutines to make\n    thingMessageCount = 10              // How many messages to send to the thing\n)\n\n// The thing that we'll be passing into a goroutine to process -----------------\ntype thing struct {\n    id       string\n    receiver chan bool\n    done     chan string\n}\n\n// Go go gadget map test -------------------------------------------------------\nfunc main() {\n    // Make all of the things!\n    things := make(map[string]thing)\n\n    // Make a channel to receive completion notification on\n    doneCh := make(chan string, chBuffSize)\n\n    log.Printf(\"Making %d things\\n\", thingsToMake)\n\n    for i := 0; i &lt; thingsToMake; i++ {\n        t := thing{\n            id:       strconv.Itoa(i),\n            receiver: make(chan bool, chBuffSize),\n            done:     doneCh,\n        }\n        things[t.id] = t\n\n        // Pass the thing into it's own goroutine\n        go doSomething(t)\n\n        // Send (thingMessageCount) messages to the thing\n        go func(t thing) {\n            for x := 0; x &lt; thingMessageCount; x++ {\n                t.receiver &lt;- true\n                time.Sleep(time.Millisecond * 100)\n            }\n        }(t)\n    }\n    log.Printf(\"All %d things made\\n\", thingsToMake)\n\n    // Check the `len()` of things every second and exit when empty\n    go func() {\n        for {\n            time.Sleep(time.Second)\n            m := things\n            log.Printf(\"Map length: %v\", len(m))\n            if len(m) == 0 {\n                log.Printf(\"Confirming empty map: %v\", things)\n                log.Println(\"All done. Exiting\")\n                os.Exit(0)\n            }\n        }\n    }()\n\n    // Receive on doneCh when the goroutine is complete and clean the map up\n    for {\n        id := &lt;-doneCh\n        close(things[id].receiver)\n        delete(things, id)\n    }\n}\n\n// Func for each goroutine to run ----------------------------------------------\n//\n// When this goroutine is ready to terminate it should respond through t.done to\n// notify the caller that it has finished and can be cleaned up. It will wait\n// for `thingIdleLifetime` until it times out and terminates on it's own\nfunc doSomething(t thing) {\n    timer := time.NewTimer(thingIdleLifetime)\n    for {\n        select {\n        case &lt;-t.receiver:\n            // We received a message, so extend the timer\n            timer.Reset(thingIdleLifetime)\n        case &lt;-timer.C:\n            // Timer expired so we need to exit now\n            t.done &lt;- t.id\n            return\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "rest", "go"], "answers": [{"tags": [], "owner": {"reputation": 5418, "user_id": 1886753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSGad.png?s=128&g=1", "display_name": "GRosenberg", "link": "https://stackoverflow.com/users/1886753/grosenberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1448239970, "creation_date": 1448239970, "answer_id": 33862182, "question_id": 33861992, "link": "https://stackoverflow.com/questions/33861992/how-to-display-all-data-from-a-map-in-json-format-golang/33862182#33862182", "title": "How to display all data from a map in json format - Golang?", "body": "<p>At least two different problems.</p>\n\n<p>First, a JSON Map cannot have an `int' key. That is part of the JSON spec. Either change it to a string or you will have to implement the MarshalJSON and UnmarshalJSON interfaces for the map, i.e, for the type</p>\n\n<pre><code>    type MyMap map[int]string\n</code></pre>\n\n<p>Google <code>golang UnmarshalJSON time.Duration</code> for a number of basic examples. Also, against map and your specific key type.</p>\n\n<p>Second, for a slice type</p>\n\n<pre><code>    type Users []Data\n</code></pre>\n\n<p>adding elements requires append</p>\n\n<pre><code>    uj := make(Users,0)\n    for k, v := range datamap {\n        d := Data{k,v}\n        uj = append(uj, d) \n    }\n</code></pre>\n\n<p>Of course, marshaling a slice produces a keyless JSON map -- likely not what you want.</p>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 33862182, "answer_count": 1, "score": 0, "last_activity_date": 1448245013, "creation_date": 1448238308, "last_edit_date": 1448245013, "question_id": 33861992, "link": "https://stackoverflow.com/questions/33861992/how-to-display-all-data-from-a-map-in-json-format-golang", "title": "How to display all data from a map in json format - Golang?", "body": "<p>I am creating a API in golang which will simply display all data from a map in json format. \nendpoint: /keys</p>\n\n<pre><code>type UserController struct{}\n\n// NewUserController function\nfunc NewUserController() *UserController {\n    return &amp;UserController{}\n}\n\n// Data struct\ntype Data struct {\n    Datakey   int    `json:\"key\"`\n    Datavalue string `json:\"value\"`\n}\n\nvar datamap = make(map[int]string)\n\nfunc (uc UserController) getallkeys(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n    type Users []Data\n    var uj Users\n    for k, v := range datamap {\n        uj = Users{\n            Data{\n                Datakey:   k,\n                Datavalue: v,\n            },\n        }\n    }\n\n    result, _ := json.Marshal(uj)\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.WriteHeader(200)\n    fmt.Fprintf(w, \"%s\", result)\n}\n</code></pre>\n\n<p>For eg:\nThe response should be something like</p>\n\n<pre><code>[\n  {\n    \"key\":somekey,\n    \"value\":\"somevalue\"\n  },\n  {\n    \"key\":somekey,\n    \"value\":\"somevalue\"\n  }\n]\n</code></pre>\n\n<p>I am not clear how to implement this. The above code is displaying just the last data from the map. This is incorrect but I am not sure how to proceed. It would be great if someone could help me with this.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["html", "templates", "go", "hugo"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1448233298, "post_id": 33860961, "comment_id": 55487104, "body": "Don&#39;t use a map but a slice. Dead simple."}, {"owner": {"reputation": 27694, "user_id": 194175, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/56badf521701d4f9b3a394d3ef6e90c4?s=128&d=identicon&r=PG", "display_name": "rdegges", "link": "https://stackoverflow.com/users/194175/rdegges"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448233601, "post_id": 33860961, "comment_id": 55487183, "body": "Would you mind posting an example of how to make it work with a slice? I&#39;m quite new to Go templates."}], "answers": [{"comments": [{"owner": {"reputation": 27694, "user_id": 194175, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/56badf521701d4f9b3a394d3ef6e90c4?s=128&d=identicon&r=PG", "display_name": "rdegges", "link": "https://stackoverflow.com/users/194175/rdegges"}, "edited": false, "score": 0, "creation_date": 1448256587, "post_id": 33862260, "comment_id": 55492588, "body": "Thanks! This is really helpful, and saved me &lt;3 Really appreciate the assist!"}, {"owner": {"reputation": 1386, "user_id": 3973292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71393bd67bd84015884ff6127afc5ed1?s=128&d=identicon&r=PG&f=1", "display_name": "bep", "link": "https://stackoverflow.com/users/3973292/bep"}, "edited": false, "score": 0, "creation_date": 1452806086, "post_id": 33862260, "comment_id": 57342916, "body": "Go maps have no guaranteed order."}, {"owner": {"reputation": 1386, "user_id": 3973292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71393bd67bd84015884ff6127afc5ed1?s=128&d=identicon&r=PG&f=1", "display_name": "bep", "link": "https://stackoverflow.com/users/3973292/bep"}, "edited": false, "score": 0, "creation_date": 1452812328, "post_id": 33862260, "comment_id": 57345955, "body": "@CodingPickle - no, that is not true. The Go template engine does nothing magic out-of-the-box with the datastructures given, so a Go map is a ... Go map. And since Go 1.1, the order of the keys when you range over a Go map has not been guaranteed. It may seem consistent, but it isn&#39;t."}, {"owner": {"reputation": 164, "user_id": 3976229, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LaRhT.png?s=128&g=1", "display_name": "havoc1", "link": "https://stackoverflow.com/users/3976229/havoc1"}, "edited": false, "score": 3, "creation_date": 1498598080, "post_id": 33862260, "comment_id": 76560806, "body": "It looks to me like the template maintainers added sorting by default to the {{range}} action back in 2012. Take a look at this <a href=\"https://github.com/golang/go/commit/a5950df89e129e93f76aa8391f84beb460ef82be\" rel=\"nofollow noreferrer\">github commit</a>. Am I reading this wrong?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1448240638, "creation_date": 1448240638, "answer_id": 33862260, "question_id": 33860961, "link": "https://stackoverflow.com/questions/33860961/sorted-map-iteration-in-go-templates/33862260#33862260", "title": "Sorted Map Iteration in Go Templates?", "body": "<p>Go templates sort maps by key. If you want to force a specific order, then use a slice:</p>\n\n<p>Here's the YAML:</p>\n\n<pre><code>baseurl: \"https://www.rdegges.com/\"\nlanguageCode: \"en-us\"\ntitle: \"Randall Degges\"\nparams:\n    navLinks: \n        - title: Twitter\n          url: https://twitter.com/rdegges\n        - title: Facebook\n          url: https://www.facebook.com/rdegges\n</code></pre>\n\n<p>... and the template:</p>\n\n<pre><code>&lt;nav&gt;\n  &lt;ul&gt;\n    {{ range $link := .Site.Params.navLinks }}\n      &lt;li&gt;&lt;a href=\"{{ $link.url }}\"&gt;{{ $link.title }}&lt;/a&gt;&lt;/li&gt;\n    {{ end }}\n  &lt;/ul&gt;\n&lt;/nav&gt;\n</code></pre>\n"}], "owner": {"reputation": 27694, "user_id": 194175, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/56badf521701d4f9b3a394d3ef6e90c4?s=128&d=identicon&r=PG", "display_name": "rdegges", "link": "https://stackoverflow.com/users/194175/rdegges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3425, "favorite_count": 0, "accepted_answer_id": 33862260, "answer_count": 1, "score": 3, "last_activity_date": 1448240638, "creation_date": 1448230957, "question_id": 33860961, "link": "https://stackoverflow.com/questions/33860961/sorted-map-iteration-in-go-templates", "title": "Sorted Map Iteration in Go Templates?", "body": "<p>I'm building a website in Go, using the <a href=\"http://gohugo.io/\" rel=\"nofollow\">Hugo static site generator</a>. What I'm trying to do is build a dynamic navigation bar for my web pages.</p>\n\n<p>Here's what I'm doing:</p>\n\n<p>In my <code>config.yml</code> file, I've defined a Map of links that I'd like to appear in my navbar -- here's what this file looks like:</p>\n\n<pre><code>baseurl: \"https://www.rdegges.com/\"\nlanguageCode: \"en-us\"\ntitle: \"Randall Degges\"\nparams:\n  navLinks: {\"Twitter\": \"https://twitter.com/rdegges\", \"Facebook\": \"https://www.facebook.com/rdegges\", \"Google+\": \"https://plus.google.com/109157194342162880262\", \"Github\": \"https://github.com/rdegges\"}\n</code></pre>\n\n<p>So, I've also got an <code>index.html</code> template in Hugo that contains a navbar which looks like this:</p>\n\n<pre><code>&lt;nav&gt;\n  &lt;ul&gt;\n    {{ range sort $title, $link := .Site.Params.navLinks }}\n      &lt;li&gt;&lt;a href=\"{{ $link }}\"&gt;{{ $title }}&lt;/a&gt;&lt;/li&gt;\n    {{ end }}\n  &lt;/ul&gt;\n&lt;/nav&gt;\n</code></pre>\n\n<p>This above code works correctly, with one exception: I'd like to order the results of my links instead of having them randomly ordered each time.</p>\n\n<p>I know that Maps are not inherently structured in Go -- but is there a way to retain the original ordering of my navigation elements in some way?</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["json", "encoding", "go"], "answers": [{"tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": false, "score": 5, "last_activity_date": 1448229865, "last_edit_date": 1448229865, "creation_date": 1448226780, "answer_id": 33860257, "question_id": 33859665, "link": "https://stackoverflow.com/questions/33859665/retrieving-a-value-from-an-empty-interface/33860257#33860257", "title": "Retrieving a value from an empty interface", "body": "<p>If you did something this to unmarshel the json </p>\n\n<pre><code>var f interface{}\nerr := json.Unmarshal(b, &amp;f)\n</code></pre>\n\n<p>You can use a type assertion to access <code>f</code>'s underlying map[string]interface{}:</p>\n\n<pre><code>m := f.(map[string]interface{})\n</code></pre>\n\n<p>For more detail read <a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow\">this</a> blog post.</p>\n\n<p>Try It on <kbd><a href=\"http://play.golang.org/p/Y9a5rvnRxJ\" rel=\"nofollow\"> Go Playground</a></kbd></p>\n"}], "owner": {"reputation": 10557, "user_id": 1358522, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/xjQAi.png?s=128&g=1", "display_name": "Patrick Reck", "link": "https://stackoverflow.com/users/1358522/patrick-reck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448231012, "creation_date": 1448223375, "last_edit_date": 1448231012, "question_id": 33859665, "link": "https://stackoverflow.com/questions/33859665/retrieving-a-value-from-an-empty-interface", "title": "Retrieving a value from an empty interface", "body": "<p>I have an empty interface to which I have parsed some <em>json</em> data. </p>\n\n<pre><code>type Event interface {\n}\n</code></pre>\n\n<p>As of now, the only value is <code>name</code>, and this is being set correctly. However, I cannot figure how to actually retrieve the value of this variable. How do I do that?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 19, "last_activity_date": 1448290422, "last_edit_date": 1448290422, "creation_date": 1448223236, "answer_id": 33859638, "question_id": 33859066, "link": "https://stackoverflow.com/questions/33859066/slicing-out-of-bounds-error-in-go/33859638#33859638", "title": "Slicing: Out of bounds error in Go", "body": "<p><strong>Foreword:</strong> The question is good, the source of downvotes is because at first glance the question does seem like the asker simply doesn't know what the valid bounds are when slicing. But the case is uncommon! It is very rare that someone slices a slice in a way that even the lower bound is beyond the length of the slice!</p>\n\n<hr>\n\n<p><strong>In short:</strong> The problem is not with the lower bound which can be equal to or greater than <code>len()</code> (the upper limit is dictated by <code>cap()</code> in case of slices). The problem is with the <strong>higher</strong> bound: it must be greater than or equal to the lower bound. And since you didn't specify the higher bound, it defaults to <code>len()</code> (and not to <code>cap()</code>!) which is <code>0</code>. And <code>1</code> is not less than or equal to <code>0</code>.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"noreferrer\">Spec: Slice expressions:</a></p>\n\n<blockquote>\n  <p>For arrays or strings, the indices are <em>in range</em> if <code>0 &lt;= low &lt;= high &lt;= len(a)</code>, otherwise they are out of range. For slices, the upper index bound is the slice capacity <code>cap(a)</code> rather than the length.</p>\n</blockquote>\n\n<p>Since you are slicing a slice, indices are in range if:</p>\n\n<pre><code>0 &lt;= low &lt;= high &lt;= cap(a)\n</code></pre>\n\n<p>So this line:</p>\n\n<pre><code>c := b[1:]\n</code></pre>\n\n<p>Is invalid, because:</p>\n\n<blockquote>\n  <p>A missing low index defaults to zero; a missing high index defaults to the <strong>length</strong> of the sliced operand.</p>\n</blockquote>\n\n<p>So in your case <code>low = 1</code> and <code>high = 0</code> (implicit), which does not satisfy:</p>\n\n<pre><code>0 &lt;= low &lt;= high &lt;= cap(a)\n</code></pre>\n\n<p>So for example the following expressions are valid:</p>\n\n<pre><code>c := b[1:1]        // c len=0 cap=4 []\nc := b[1:2]        // c len=1 cap=4 [0]\nc := b[1:cap(b)]   // c len=4 cap=4 [0 0 0 0]\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 3242948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58214a9f2c286b5058813490becc3dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Loki", "link": "https://stackoverflow.com/users/3242948/loki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6187, "favorite_count": 3, "answer_count": 1, "score": 15, "last_activity_date": 1448290422, "creation_date": 1448219753, "last_edit_date": 1448260481, "question_id": 33859066, "link": "https://stackoverflow.com/questions/33859066/slicing-out-of-bounds-error-in-go", "title": "Slicing: Out of bounds error in Go", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := make([]int, 5)\n    printSlice(\"a\", a)\n    b := make([]int, 0, 5)\n    printSlice(\"b\", b)\n    c := b[1:]\n    printSlice(\"c\", c)\n}\n\n\nfunc printSlice(s string, x []int) {\n    fmt.Printf(\"%s len=%d cap=%d %v\\n\",\n        s, len(x), cap(x), x)\n}\n</code></pre>\n\n<p>The above gives me an out of bounds error:</p>\n\n<pre><code>a len=5 cap=5 [0 0 0 0 0]\nb len=0 cap=5 []\npanic: runtime error: slice bounds out of range\n\ngoroutine 1 [running]:\nmain.main()\n   /private/var/folders/q_/53gv6r4s0y5f50v9p26qhs3h00911v/T/compile117.go:10 +0x150\n</code></pre>\n\n<p>Why is the slicing expression to create the <code>c</code> slice results in an error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1448213733, "post_id": 33857756, "comment_id": 55480239, "body": "My guess is that they named those like the unterlying OS-Methods like in the syscall package and just changed the first letter for export reasons."}], "answers": [{"comments": [{"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1448213926, "post_id": 33857904, "comment_id": 55480315, "body": "No, you are wrong, because those functions also adre name in contrast to the general Naming scheme in go: Mixed Caps. See for example IsExist. See my comment above."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "reply_to_user": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1448215630, "post_id": 33857904, "comment_id": 55480947, "body": "What part is wrong? What you said is also correct, there&#39;s no contradiction."}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1448215858, "post_id": 33857904, "comment_id": 55481034, "body": "Because they even contradict the general Camel-Case Naming Conventions in go. It should be GetPID for example. But you are right about the application of the Getter/Setter rule."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "reply_to_user": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1448216329, "post_id": 33857904, "comment_id": 55481184, "body": "Sure, camel case naming convention was never part of the question."}, {"owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "edited": false, "score": 0, "creation_date": 1500463168, "post_id": 33857904, "comment_id": 77344960, "body": "No idea why someone downvoted this answer - it&#39;s the first thing I thought of too and completely correct as regards getter method naming (look at the title of this question)."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 3, "last_activity_date": 1448213728, "creation_date": 1448213728, "answer_id": 33857904, "question_id": 33857756, "link": "https://stackoverflow.com/questions/33857756/idiomatic-way-of-naming-getters-in-go/33857904#33857904", "title": "Idiomatic way of naming Getters in Go", "body": "<p>The term \"getters\" refers to <em>methods</em> on <em>structs</em> that allow you to read values of (often unexported) <em>fields</em> on that struct. The functions you're pointing to are <em>top-level functions</em> which allow you to read values <em>from the OS</em>.  That idiomatic rule is not relevant to this case.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 7, "last_activity_date": 1448223876, "creation_date": 1448223876, "answer_id": 33859763, "question_id": 33857756, "link": "https://stackoverflow.com/questions/33857756/idiomatic-way-of-naming-getters-in-go/33859763#33859763", "title": "Idiomatic way of naming Getters in Go", "body": "<p>These names are not consistent with Go naming by design. Rob Pike, one of the Go creators, <a href=\"https://groups.google.com/d/topic/golang-nuts/6joQwydzNyg/discussion\" rel=\"noreferrer\">says this about the names in the OS package</a>:</p>\n\n<blockquote>\n  <p>There are inconsistencies but this is the key point. It should be Stdout not StdOut, because that name is coming from the underlying system. Similarly it's Fprintf not FPrintf or FPrintF because that is a very familiar name. These names are coming into Go, not being created there, and the initial cap is the admission fee.</p>\n</blockquote>\n\n<p>The names will not be changed in a future version of Go.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1448225668, "last_edit_date": 1448225668, "creation_date": 1448224333, "answer_id": 33859840, "question_id": 33857756, "link": "https://stackoverflow.com/questions/33857756/idiomatic-way-of-naming-getters-in-go/33859840#33859840", "title": "Idiomatic way of naming Getters in Go", "body": "<blockquote>\n  <p><a href=\"https://groups.google.com/d/msg/golang-nuts/3FK1G08AfVA/B68aMDIqEOkJ\" rel=\"nofollow\">[go-nuts] FunctionName caseinconsistencies</a></p>\n  \n  <p>A lot of the all lowercase names were chosen before we had really\n  figured out what the naming conventions should be. The rule we\n  adopted, which might be worth revisiting later, was that entry points\n  in package <code>os</code> or <code>syscall</code>, which are named after equivalents in C, just\n  had a single capital at the beginning, to avoid needing to decide\n  where the internal capitalizations are in abbreviations like <code>geteuid</code>\n  or <code>getwd</code> or <code>chdir</code>.  Names like <code>Readdirnames</code>, which are actual words,\n  might be worth revisiting at some point.</p>\n  \n  <p>Russ</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://github.com/golang/go/issues/1187\" rel=\"nofollow\">os: inconsistent casing in names #1187</a> </p>\n  \n  <p>Is there any sort of rule about the casing of functions used in the\n  \"<code>os</code>\" package?  Looking through, it doesn't sound like it's very easy\n  to recall whether a given function should be called <code>LikeThat</code> or\n  <code>Likethat</code>.</p>\n  \n  <p>For instance:</p>\n\n<pre><code>Mkdir\nMkdirAll\nTempDir\nGetenv\nForkExec\nReadlink\nReadAt\nReaddir\n</code></pre>\n  \n  <p>It feels very ad-hoc, and hard to recall.</p>\n</blockquote>\n\n<p>It's a known issue. It's unplanned.</p>\n"}], "owner": {"reputation": 31539, "user_id": 367985, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/761edb9c3cf7a0a643e73ef40666a1f7?s=128&d=identicon&r=PG", "display_name": "CuriousMind", "link": "https://stackoverflow.com/users/367985/curiousmind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 2, "accepted_answer_id": 33859840, "answer_count": 3, "score": 2, "last_activity_date": 1551801012, "creation_date": 1448212928, "last_edit_date": 1551801012, "question_id": 33857756, "link": "https://stackoverflow.com/questions/33857756/idiomatic-way-of-naming-getters-in-go", "title": "Idiomatic way of naming Getters in Go", "body": "<p>The Effective go has following advice on naming of getters:</p>\n\n<blockquote>\n  <p>Go doesn't provide automatic support for getters and setters. There's\n  nothing wrong with providing getters and setters yourself, and it's\n  often appropriate to do so, but it's neither idiomatic nor necessary\n  to put Get into the getter's name. If you have a field called owner\n  (lower case, unexported), the getter method should be called Owner\n  (upper case, exported), not GetOwner. The use of upper-case names for\n  export provides the hook to discriminate the field from the method. A\n  setter function, if needed, will likely be called SetOwner. Both names\n  read well in practice:</p>\n</blockquote>\n\n<p>Source: <a href=\"https://golang.org/doc/effective_go.html#Getters\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#Getters</a></p>\n\n<p>Now, this advice doesn't seem to consistent as the stdlib itself violates this multiple times. \n<a href=\"https://i.stack.imgur.com/t497e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t497e.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see in above screenshot, there are multiple methods  which use GetX naming convention which is advised against in the effective go guide.</p>\n\n<p>So the question is is the advice given in guide wrong or these methods are named wrongly &amp; would be fixed in future versions?</p>\n"}, {"tags": ["math", "go", "trigonometry"], "comments": [{"owner": {"reputation": 1034, "user_id": 3462308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXwKl.jpg?s=128&g=1", "display_name": "alephao", "link": "https://stackoverflow.com/users/3462308/alephao"}, "edited": false, "score": 1, "creation_date": 1448208635, "post_id": 33856426, "comment_id": 55478230, "body": "Y increasing to the bottom should not be a problem! If y increases to the bottom and you want the angle between horizontal line and the straight line between player and click, the angle would be <code>math.Atan2(ydiff * -1, xdiff)</code>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1448209402, "post_id": 33856426, "comment_id": 55478522, "body": "@Atomic_alarm: It&#39;s not very helpful to ask a user to provide an MCVE. You need to explain what that is. Even better, provide a link to Stack Overflow&#39;s explanation: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>."}, {"owner": {"reputation": 144, "user_id": 4389372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60267334e55bb8b7de806cb335ff930?s=128&d=identicon&r=PG", "display_name": "David Etler", "link": "https://stackoverflow.com/users/4389372/david-etler"}, "edited": false, "score": 1, "creation_date": 1448210062, "post_id": 33856426, "comment_id": 55478766, "body": "One option is to forgo angles entirely and represent your vector in cartesian form. So you&#39;d have a vector with {xdiff, ydiff} instead of {Radians, Distance}. After all, taking the arctangent and then taking sin/cos is just a useless conversion from cartesian to polar and immediately back to cartesian. Besides that, what exactly is the problem with the code you have? What about it doesn&#39;t work?"}, {"owner": {"reputation": 90, "user_id": 2626428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/963b0a4540ae03db2e4dc89e186211fd?s=128&d=identicon&r=PG", "display_name": "Zach Taylor", "link": "https://stackoverflow.com/users/2626428/zach-taylor"}, "edited": false, "score": 0, "creation_date": 1448212203, "post_id": 33856426, "comment_id": 55479584, "body": "Thank you for responses so far. I have posted MCVE."}, {"owner": {"reputation": 90, "user_id": 2626428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/963b0a4540ae03db2e4dc89e186211fd?s=128&d=identicon&r=PG", "display_name": "Zach Taylor", "link": "https://stackoverflow.com/users/2626428/zach-taylor"}, "reply_to_user": {"reputation": 1034, "user_id": 3462308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXwKl.jpg?s=128&g=1", "display_name": "alephao", "link": "https://stackoverflow.com/users/3462308/alephao"}, "edited": false, "score": 0, "creation_date": 1448212816, "post_id": 33856426, "comment_id": 55479861, "body": "@alaphao I have modified my program to use <code>math.Atan2(ydiff * -1, xdiff)</code> and that does not solve the issue. Can post output if desired. @DavidEtler I may switch to {xdiff, ydiff} vector type instead. I like that suggestion."}, {"owner": {"reputation": 1034, "user_id": 3462308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXwKl.jpg?s=128&g=1", "display_name": "alephao", "link": "https://stackoverflow.com/users/3462308/alephao"}, "reply_to_user": {"reputation": 144, "user_id": 4389372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60267334e55bb8b7de806cb335ff930?s=128&d=identicon&r=PG", "display_name": "David Etler", "link": "https://stackoverflow.com/users/4389372/david-etler"}, "edited": false, "score": 0, "creation_date": 1448214529, "post_id": 33856426, "comment_id": 55480560, "body": "@ZachTaylor I think you will have to check some conditions (something like <code>if playerX &gt;= cursorX  { angle = atan(dy&#47;dx) + pi</code> ) to work as yo expect, but it is probably better to work with vectors like @DavidEtler said"}], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 2626428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/963b0a4540ae03db2e4dc89e186211fd?s=128&d=identicon&r=PG", "display_name": "Zach Taylor", "link": "https://stackoverflow.com/users/2626428/zach-taylor"}, "edited": false, "score": 1, "creation_date": 1448224012, "post_id": 33858894, "comment_id": 55483960, "body": "I have finished implementing this change and it works as I expected. Thank you in particular for the snippet to create a vector of the appropriate size including move speed"}], "tags": [], "owner": {"reputation": 144, "user_id": 4389372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60267334e55bb8b7de806cb335ff930?s=128&d=identicon&r=PG", "display_name": "David Etler", "link": "https://stackoverflow.com/users/4389372/david-etler"}, "is_accepted": true, "score": 3, "last_activity_date": 1448218988, "creation_date": 1448218988, "answer_id": 33858894, "question_id": 33856426, "link": "https://stackoverflow.com/questions/33856426/how-to-use-trig-on-screen-coordinates-to-calculate-angle-between-points/33858894#33858894", "title": "How to use trig on screen coordinates to calculate angle between points", "body": "<p>This is what your code would look like if you chose to go with Cartesian coordinates like I suggested in the comments:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"math\"\n)\n\nfunc main() {\n  position1 := &amp;Position{550, 200}\n  position2 := &amp;Position{700, 500}\n  vector1 := CreatePathVector(position1, position2, 70)\n\n  fmt.Printf(\"position1: %v\\nposition2: %v\\n\", position1, position2)\n\n  position := position1\n  for i := 0; i &lt; 5; i++ {\n    position = position.Add(vector1)\n    fmt.Printf(\"next position: %v\\n\", position)\n  }\n\n  position3 := &amp;Position{400, 500}\n  position4 := &amp;Position{700, 400}\n  vector2 := CreatePathVector(position3, position4, 50)\n\n  fmt.Printf(\"position3: %v\\nposition4: %v\\n\", position3, position4)\n\n  position = position3\n  for i := 0; i &lt; 5; i++ {\n    position = position.Add(vector2)\n    fmt.Printf(\"next position: %v\\n\", position)\n  }\n}\n\ntype Position struct {\n  X float64\n  Y float64\n}\n\ntype Vector struct {\n  dX  float64\n  dY float64\n}\n\nfunc CreatePathVector(pos1 *Position, pos2 *Position, speed int) *Vector {\n  ydiff := pos2.Y - pos1.Y\n  xdiff := pos2.X - pos1.X\n  mag := math.Sqrt(xdiff*xdiff+ydiff*ydiff)\n\n\n  return &amp;Vector{\n    dX:  xdiff/mag*float64(speed),\n    dY:  ydiff/mag*float64(speed),\n  }\n}\n\nfunc (p *Position) Add(v *Vector) *Position {\n  return &amp;Position{\n    X: p.X + v.dX,\n    Y: p.Y + v.dY,\n  }\n}\n</code></pre>\n\n<p>If you want to stick with angles, just switch the <code>Cos</code> and <code>Sin</code> in the <code>Add</code>. This is because the orientation of the screen does not matter: if you take <code>t = arctan(y/x)</code> you get <code>y</code> back from <code>sin(t)</code> and <code>x</code> back from <code>cos(t)</code> regardless of what <code>x</code> and <code>y</code> represent. So add should be this:</p>\n\n<pre><code>func (p *Position) Add(v *Vector) *Position {\n  return &amp;Position{\n    X: p.X + math.Cos(v.Radians)*v.Distance,\n    Y: p.Y + math.Sin(v.Radians)*v.Distance,\n  }\n}\n</code></pre>\n\n<p>I've made small games before myself, and I too have tried to use angles for movement. My suggestion is don't even try. If you want to add more realistic physics to your game, vectors and linear algebra will be your best friend. Angles and trig gets too messy in my opinion.</p>\n"}], "owner": {"reputation": 90, "user_id": 2626428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/963b0a4540ae03db2e4dc89e186211fd?s=128&d=identicon&r=PG", "display_name": "Zach Taylor", "link": "https://stackoverflow.com/users/2626428/zach-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 33858894, "answer_count": 1, "score": 4, "last_activity_date": 1448218988, "creation_date": 1448205736, "last_edit_date": 1448211927, "question_id": 33856426, "link": "https://stackoverflow.com/questions/33856426/how-to-use-trig-on-screen-coordinates-to-calculate-angle-between-points", "title": "How to use trig on screen coordinates to calculate angle between points", "body": "<p>I am working on a game. This game is top down, real-time, and must feature pathing. My game must calculate the angle between a player's current position and the one they click to walk to.<br>\nProblem is, I am using screen coordinates, as in \"x increases to the right, y increases to the bottom\"</p>\n\n<p>Here's where I'm at with some code</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"math\"\n)\n\nfunc main() {\n  position1 := &amp;Position{550, 200}\n  position2 := &amp;Position{700, 500}\n  vector1 := CreatePathVector(position1, position2, 50)\n\n  fmt.Printf(\"position1: %v\\nposition2: %v\\n\", position1, position2)\n\n  position := position1\n  for i := 0; i &lt; 5; i++ {\n    position = position.Add(vector1)\n    fmt.Printf(\"next position: %v\\n\", position)\n  }\n\n  position3 := &amp;Position{400, 500}\n  position4 := &amp;Position{700, 400}\n  vector2 := CreatePathVector(position3, position4, 50)\n\n  fmt.Printf(\"position3: %v\\nposition4: %v\\n\", position3, position4)\n\n  position = position3\n  for i := 0; i &lt; 5; i++ {\n    position = position.Add(vector2)\n    fmt.Printf(\"next position: %v\\n\", position)\n  }\n}\n\ntype Position struct {\n  X float64\n  Y float64\n}\n\ntype Vector struct {\n  Radians  float64\n  Distance float64\n}\n\nfunc CreatePathVector(pos1 *Position, pos2 *Position, speed int) *Vector {\n  ydiff := pos2.Y - pos1.Y\n  xdiff := pos2.X - pos1.X\n  radians := math.Atan2(ydiff, xdiff)\n\n  return &amp;Vector{\n    Radians:  radians,\n    Distance: float64(speed),\n  }\n}\n\nfunc (p *Position) Add(v *Vector) *Position {\n  return &amp;Position{\n    X: p.X + math.Sin(v.Radians)*v.Distance,\n    Y: p.Y + math.Cos(v.Radians)*v.Distance,\n  }\n}\n</code></pre>\n\n<p>Here is the output</p>\n\n<pre><code>position1: &amp;{550 200}\nposition2: &amp;{700 500}\nnext position: &amp;{594.7213595499958 222.3606797749979}\nnext position: &amp;{639.4427190999916 244.72135954999578}\nnext position: &amp;{684.1640786499873 267.0820393249937}\nnext position: &amp;{728.8854381999831 289.44271909999156}\nnext position: &amp;{773.6067977499789 311.80339887498945}\nposition3: &amp;{400 500}\nposition4: &amp;{700 400}\nnext position: &amp;{384.1886116991581 547.4341649025257}\nnext position: &amp;{368.37722339831623 594.8683298050514}\nnext position: &amp;{352.56583509747435 642.3024947075771}\nnext position: &amp;{336.75444679663246 689.7366596101028}\nnext position: &amp;{320.9430584957906 737.1708245126285}\n</code></pre>\n\n<p>As you can see, in both examples, the steps of adding the vector repeatedly does not steer towards the destination</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 2, "creation_date": 1448191862, "post_id": 33854191, "comment_id": 55472749, "body": "since go uses a linear regex parser, unlike python, this might be more difficult to implement and thus is probably not in the standard library."}, {"owner": {"reputation": 691, "user_id": 5266452, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ea07a3ee8a8f9a3f997377e06edd689?s=128&d=identicon&r=PG&f=1", "display_name": "Maiko Ohkawa", "link": "https://stackoverflow.com/users/5266452/maiko-ohkawa"}, "reply_to_user": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1448340032, "post_id": 33854191, "comment_id": 55535244, "body": "@FilipHaglund, Thank you. I see. On Python, I have the same probrem, I can&#39;t do that in the standard library too. If you know some library or code that someone write on Go, please could you tell me?"}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1448356120, "post_id": 33854191, "comment_id": 55542229, "body": "I would suggest writing your own. The sre_yield in the linked python question is open source, so porting/rewriting it in go should be possible in about a thousand lines of code or so. Otherwise, calling the a python executable running sre_yield could be an option. Slower execution, but faster to write."}, {"owner": {"reputation": 691, "user_id": 5266452, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ea07a3ee8a8f9a3f997377e06edd689?s=128&d=identicon&r=PG&f=1", "display_name": "Maiko Ohkawa", "link": "https://stackoverflow.com/users/5266452/maiko-ohkawa"}, "reply_to_user": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 1, "creation_date": 1448424828, "post_id": 33854191, "comment_id": 55579144, "body": "@FilipHaglund, Thank you for your advice. I see, as you say, I try porting sre_yield to Go from Python. Thank you."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1448437723, "post_id": 33854191, "comment_id": 55583968, "body": "Post the github link here if you decide to make it open source :)"}], "owner": {"reputation": 691, "user_id": 5266452, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ea07a3ee8a8f9a3f997377e06edd689?s=128&d=identicon&r=PG&f=1", "display_name": "Maiko Ohkawa", "link": "https://stackoverflow.com/users/5266452/maiko-ohkawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448202858, "creation_date": 1448191324, "last_edit_date": 1495542658, "question_id": 33854191, "link": "https://stackoverflow.com/questions/33854191/how-can-i-generate-array-of-strings-from-regex", "title": "How can I generate array of strings from regex?", "body": "<p>Few days ago, I posted the same question on Python.\nThen, just curious, how can I do the same thing on Go?</p>\n\n<hr>\n\n<p>I'm making a crawler.\nI'm wanting to take a user's given regex as an input and generate a list of strings to download data.</p>\n\n<p>User's regex  sample is:</p>\n\n<pre><code>http://xxx/abc[x-z]/image(9|10|11)\\.png\n</code></pre>\n\n<p>I want to download these.</p>\n\n<pre><code>http://xxx/abcx/image9.png\nhttp://xxx/abcy/image9.png\nhttp://xxx/abcz/image9.png\nhttp://xxx/abcx/image10.png\nhttp://xxx/abcy/image10.png\nhttp://xxx/abcz/image10.png\nhttp://xxx/abcx/image11.png\nhttp://xxx/abcy/image11.png\nhttp://xxx/abcz/image11.png\n</code></pre>\n\n<p>Can I generate the array from regex strings? Or, can I use each string in <code>for</code> block?</p>\n\n<blockquote>\n  <p>python - Can I create list from regular expressions? - Stack Overflow\n  <a href=\"https://stackoverflow.com/questions/33827603/can-i-create-list-from-regular-expressions\">Can I create list from regular expressions?</a></p>\n</blockquote>\n"}, {"tags": ["api", "go", "github-api"], "answers": [{"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": false, "score": 4, "last_activity_date": 1448201764, "last_edit_date": 1448201764, "creation_date": 1448181958, "answer_id": 33853051, "question_id": 33852854, "link": "https://stackoverflow.com/questions/33852854/mismatched-types-string-and-string/33853051#33853051", "title": "mismatched types *string and string", "body": "<p>From the error message it looks like you are trying to compare a <code>string pointer</code> (<code>*string</code>) to an actual <code>string</code>. </p>\n\n<ul>\n<li><code>release.Name</code> is a <code>*string</code> (a pointer to a <code>string</code> value)</li>\n<li><code>\"\"</code> is a <code>string</code> (is a <code>string</code> value)</li>\n</ul>\n\n<p>They are two different types. So you can't compare them.</p>\n\n<p>What you probably want to do instead is <code>release.Name == nil</code></p>\n\n<p>When a pointer that <strong>references</strong> to nothing (equals to <code>nil</code>) is tried to be <strong>dereferenced</strong> you get that second error. So in your case <code>*release.Name</code> panics because infact <code>release.Name</code> is <code>nil</code></p>\n"}, {"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 3, "last_activity_date": 1448182188, "creation_date": 1448182188, "answer_id": 33853077, "question_id": 33852854, "link": "https://stackoverflow.com/questions/33852854/mismatched-types-string-and-string/33853077#33853077", "title": "mismatched types *string and string", "body": "<pre><code>var release github.RepositoryTag\n</code></pre>\n\n<p>You never assign any value to that var. That's why <code>*release.Name</code> gives you a \"runtime error\": <code>release.Name</code> is a nil pointer</p>\n"}, {"comments": [{"owner": {"reputation": 754, "user_id": 7440787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/173fa595898e11e4225d09de28dca22e?s=128&d=identicon&r=PG&f=1", "display_name": "user7440787", "link": "https://stackoverflow.com/users/7440787/user7440787"}, "edited": false, "score": 0, "creation_date": 1598385383, "post_id": 33853292, "comment_id": 112440910, "body": "it would be great to have an example, that would specially help any go language beginners"}], "tags": [], "owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "is_accepted": true, "score": 1, "last_activity_date": 1448184141, "creation_date": 1448184141, "answer_id": 33853292, "question_id": 33852854, "link": "https://stackoverflow.com/questions/33852854/mismatched-types-string-and-string/33853292#33853292", "title": "mismatched types *string and string", "body": "<p>As per your code you have declared  var release github.RepositoryTag, but you have not initialized it.</p>\n\n<p>In structure RepositoryTag, Name is declared as *string which is a pointer and in case  of release.Name == \"\", string comparison is attempted which is incorrect hence \"mismatched types *string and string\" error. </p>\n\n<p>In case of *release.Name == \"\", since release is not yet initialized, it is complaining \"invalid memory address or nil pointer dereference\" </p>\n\n<p>You need to do two things, 1st initialize, release and second, check release.Name = nil.</p>\n"}], "owner": {"reputation": 2467, "user_id": 926190, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/098f89dd510cdc23243f3c19902a2af8?s=128&d=identicon&r=PG&f=1", "display_name": "jmreicha", "link": "https://stackoverflow.com/users/926190/jmreicha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7242, "favorite_count": 0, "accepted_answer_id": 33853292, "answer_count": 3, "score": 1, "last_activity_date": 1448214498, "creation_date": 1448179949, "last_edit_date": 1448214498, "question_id": 33852854, "link": "https://stackoverflow.com/questions/33852854/mismatched-types-string-and-string", "title": "mismatched types *string and string", "body": "<p>I am attempting to run a conditional to basically see if the object is empty but I keep getting (similar variations) of this error:</p>\n\n<pre><code>invalid operation: release.Name == \"\" (mismatched types *string and string)\n</code></pre>\n\n<p>Here is the code that is dying:</p>\n\n<pre><code>import (\n    \"github.com/google/go-github/github\"\n)\n\nfunc TestLatestTag(user, project string) {\n\n    var client *github.Client\n    client = github.NewClient(nil)\n\n    releases, _, err := client.Repositories.ListTags(user, project, nil)\n    var release github.RepositoryTag\n\n    if err != nil {\n        fmt.Println(\"Error\")\n    } else {\n        if release.Name == \"\" {\n            fmt.Println(\"None\")\n        } else {\n            fmt.Println(releases[0])\n        }\n    }\n}\n</code></pre>\n\n<p>If I change the if statement to <code>*release.Name == \"\"</code> as the error suggests I get a different error, which I don't really understand:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x26fd]\n\ngoroutine 1 [running]:\n</code></pre>\n\n<p>I'm sure there is any easy way to do this but I am not very familiar with handling objects/structs</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1448177131, "creation_date": 1448177131, "answer_id": 33852582, "question_id": 33852394, "link": "https://stackoverflow.com/questions/33852394/passing-structures-named-fields-to-other-functions/33852582#33852582", "title": "Passing structure&#39;s named fields to other functions", "body": "<p>GLBList is defined as Array of struct. In go, there is nothing called as struct{}. All the go type implements empty interface, hence to pass struct (in this case struct without name) empty interface can be used. For more details <a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow\">http://blog.golang.org/json-and-go</a></p>\n"}, {"comments": [{"owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1448179044, "post_id": 33852697, "comment_id": 55469660, "body": "So, to consume each <code>structure</code>, I define a separate structure? That seems like a lot of duplicate code to me."}, {"owner": {"reputation": 3038, "user_id": 568689, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a68e2585beb59c1bd2a19c46045f57b?s=128&d=identicon&r=PG", "display_name": "Eden", "link": "https://stackoverflow.com/users/568689/eden"}, "reply_to_user": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1448181015, "post_id": 33852697, "comment_id": 55470061, "body": "You define one structure and then an Array. Like you did in your code: struct A{} struct B{  []x A }"}, {"owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1448189137, "post_id": 33852697, "comment_id": 55472043, "body": "I&#39;ve have updated the answer to have the solution. Thanks!"}], "tags": [], "owner": {"reputation": 3038, "user_id": 568689, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a68e2585beb59c1bd2a19c46045f57b?s=128&d=identicon&r=PG", "display_name": "Eden", "link": "https://stackoverflow.com/users/568689/eden"}, "is_accepted": true, "score": 3, "last_activity_date": 1448178269, "creation_date": 1448178269, "answer_id": 33852697, "question_id": 33852394, "link": "https://stackoverflow.com/questions/33852394/passing-structures-named-fields-to-other-functions/33852697#33852697", "title": "Passing structure&#39;s named fields to other functions", "body": "<p>You should really consider define the struct explicitly and reuse it. The all point of using a langauge with support for static typing is to define your types whenever you can, it helps the compiler to find bugs and produce a faster code. </p>\n\n<p>Also, if you would like to have a more compact code you can use the concept of <a href=\"http://golangtutorials.blogspot.co.il/2011/06/anonymous-fields-in-structs-like-object.html\" rel=\"nofollow\">anonymous fields</a>, although I don't think that is the best scenario for this. </p>\n"}], "owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 33852697, "answer_count": 2, "score": -1, "last_activity_date": 1448188655, "creation_date": 1448175063, "last_edit_date": 1448188655, "question_id": 33852394, "link": "https://stackoverflow.com/questions/33852394/passing-structures-named-fields-to-other-functions", "title": "Passing structure&#39;s named fields to other functions", "body": "<p>This is my first <code>golang</code> program rather than just reading docs so please bear with me. </p>\n\n<p>I've a structure like:- (comes from a parsed yaml)</p>\n\n<pre><code>type GLBConfig struct {\n    GLBList []struct {\n        Failover string `json:\"failover\" yaml:\"failover\"`\n        GLB      string `json:\"glb\" yaml:\"glb\"`\n        Pool     []struct {\n            Fqdn              string `json:\"fqdn\" yaml:\"fqdn\"`\n            PercentConsidered int    `json:\"percent_considered\" yaml:\"percent_considered\"`\n        } `json:\"pool\" yaml:\"pool\"`\n    } `json:\"glb_list\" yaml:\"glb_list\"`\n}\n</code></pre>\n\n<p>Now, in my main function, there's a for loop which does processing of each GLB:- </p>\n\n<pre><code>for _, glb := range config_file.GLBList {\n    processGLB(glb)\n}\n</code></pre>\n\n<p><strong>What will be the function definition of <code>processGLB</code> to receive this type?</strong></p>\n\n<p>I tried doing this but it doesn't work and <strong>I would like to know why.</strong></p>\n\n<pre><code>func processGLB(glb struct{}) {\n    fmt.Println(glb)\n}\n\n./glb_workers.go:42: cannot use glb (type struct { Failover string \"json:\\\"failover\\\" yaml:\\\"failover\\\"\"; Glb string \"json:\\\"glb\\\" yaml:\\\"glb\\\"\"; Pool []struct { Fqdn string \"json:\\\"fqdn\\\" yaml:\\\"fqdn\\\"\"; PercentConsidered int \"json:\\\"percent_considered\\\" yaml:\\\"percent_considered\\\"\" } \"json:\\\"pool\\\" yaml:\\\"pool\\\"\" }) as type struct {} in argument to processGLB\n</code></pre>\n\n<p>Then, some googling later, this works. </p>\n\n<pre><code>func processGLB(glb interface{}) {\n    fmt.Println(glb)\n}\n</code></pre>\n\n<p>Is it a good idea to do this? <strong>Why do I have to use interfaces to pass a simple structure named field?</strong></p>\n\n<p>In the end, what's the most elegant/right way to do this in golang? </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Simple solution was to define the structure separately. </p>\n\n<pre><code>type GLBList struct {\n        Failover string `json:\"failover\" yaml:\"failover\"`\n        GLB      string `json:\"glb\" yaml:\"glb\"`\n        Pool     []struct {\n                Fqdn              string `json:\"fqdn\" yaml:\"fqdn\"`\n                PercentConsidered int    `json:\"percent_considered\" yaml:\"percent_considered\"`\n        } `json:\"pool\" yaml:\"pool\"`\n}\n\ntype GLBConfig struct {\n        GLBs []GLBList `json:\"glb_list\" yaml:\"glb_list\"`\n}\n</code></pre>\n\n<p>And then a function definition like:- </p>\n\n<pre><code>func processGLB(glb GLBList) {\n}\n</code></pre>\n"}, {"tags": ["string", "go", "floating-point", "typecast-operator"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594260293, "post_id": 33852140, "comment_id": 111066200, "body": "<code>fmt.Sprintf(&quot;%.4f&quot;, f)</code> to set a float64 to a string as per a required format. See <a href=\"https://stackoverflow.com/a/62753031/12817546\">stackoverflow.com/a/62753031/12817546</a>. <code>strconv.ParseFloat(s, 64)</code> to set a string to a float64 as per a required format. See <a href=\"https://stackoverflow.com/a/62740786/12817546\">stackoverflow.com/a/62740786/12817546</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 1, "creation_date": 1448173125, "post_id": 33852199, "comment_id": 55468633, "body": "If you want to be sure to never get an exponent, also use the &#39;f&#39; flag instead of &#39;g&#39;"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1448174185, "last_edit_date": 1495541788, "creation_date": 1448172691, "answer_id": 33852199, "question_id": 33852140, "link": "https://stackoverflow.com/questions/33852140/convert-float-to-string-in-go-lang-as-per-the-required-format/33852199#33852199", "title": "Convert float to string in go lang as per the required format .", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/strconv/\" rel=\"nofollow noreferrer\">Package strconv</a></p>\n  \n  <p>import \"strconv\" > <a href=\"https://golang.org/pkg/strconv/#FormatFloat\" rel=\"nofollow noreferrer\">func FormatFloat</a></p>\n\n<pre><code>func FormatFloat(f float64, fmt byte, prec, bitSize int) string\n</code></pre>\n  \n  <p>FormatFloat converts the floating-point number f to a string,\n  according to the format fmt and precision prec. It rounds the result\n  assuming that the original was obtained from a floating-point value of\n  bitSize bits (32 for float32, 64 for float64).</p>\n  \n  <p>The format fmt is one of 'b' (-ddddp\u00b1ddd, a binary exponent), 'e'\n  (-d.dddde\u00b1dd, a decimal exponent), 'E' (-d.ddddE\u00b1dd, a decimal\n  exponent), 'f' (-ddd.dddd, no exponent), 'g' ('e' for large exponents,\n  'f' otherwise), or 'G' ('E' for large exponents, 'f' otherwise).</p>\n  \n  <p>The precision prec controls the number of digits (excluding the\n  exponent) printed by the 'e', 'E', 'f', 'g', and 'G' formats. For 'e',\n  'E', and 'f' it is the number of digits after the decimal point. For\n  'g' and 'G' it is the total number of digits. The special precision -1\n  uses the smallest number of digits necessary such that ParseFloat will\n  return f exactly.</p>\n</blockquote>\n\n<p>Use a precision of <code>-1</code>, not <code>1</code>. Use a format of <code>f</code>, not <code>g</code> to avoid  exponent form for large exponents (see <a href=\"https://stackoverflow.com/users/1685538/hectorj\">HectorJ's</a> comment). </p>\n\n<p><code>startLat := strconv.FormatFloat(o.Coordinate.Longitude, 'f', -1, 64)</code></p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    f := 64.2345\n    s := strconv.FormatFloat(f, 'g', 1, 64)\n    fmt.Println(s)\n    s = strconv.FormatFloat(f, 'f', -1, 64)\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>6e+01\n64.2345\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1615923566, "creation_date": 1615923566, "answer_id": 66662282, "question_id": 33852140, "link": "https://stackoverflow.com/questions/33852140/convert-float-to-string-in-go-lang-as-per-the-required-format/66662282#66662282", "title": "Convert float to string in go lang as per the required format .", "body": "<p>Some other options:</p>\n<pre><code>package main\nimport &quot;fmt&quot;\n\nfunc main() {\n   n := 64.2345\n   // example 1\n   s1 := fmt.Sprint(n)\n   // example 2\n   s2 := fmt.Sprintf(&quot;%v&quot;, n)\n   // example 3\n   s3 := fmt.Sprintf(&quot;%g&quot;, n)\n   // print\n   fmt.Println(s1 == &quot;64.2345&quot;, s2 == &quot;64.2345&quot;, s3 == &quot;64.2345&quot;)\n}\n</code></pre>\n<ul>\n<li><a href=\"https://golang.org/pkg/fmt#Sprint\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt#Sprint</a></li>\n<li><a href=\"https://golang.org/pkg/fmt#Sprintf\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt#Sprintf</a></li>\n</ul>\n"}], "owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5748, "favorite_count": 1, "accepted_answer_id": 33852199, "answer_count": 2, "score": 5, "last_activity_date": 1615923566, "creation_date": 1448172237, "question_id": 33852140, "link": "https://stackoverflow.com/questions/33852140/convert-float-to-string-in-go-lang-as-per-the-required-format", "title": "Convert float to string in go lang as per the required format .", "body": "<p>I have 4 float values(startLat,startLon,endLat,endLon)in go . I want to append(replace) these values to below string:</p>\n\n<pre><code>var etaString = []byte(`{\"start_latitude\":\"` + startLat + `\",\"start_longitude\":\"` + startLon + `\",\"end_latitude\":\"` + endLat + `\",\"end_longitude\":\"` + endLon }`)\n</code></pre>\n\n<p>I have to typecast them to string before doing so. </p>\n\n<pre><code>startLat := strconv.FormatFloat(o.Coordinate.Longitude, 'g', 1, 64)\n</code></pre>\n\n<p>However when I do so, I get the values of these parameters as <code>\"4e+01 -1e+02 4e+01 -1e+02\"</code>\nBut I just want something like this : \"64.2345\" . </p>\n\n<p>How can I achieve this ?\nTIA :) </p>\n"}, {"tags": ["postgresql", "go", "sqlx"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1448173289, "post_id": 33851705, "comment_id": 55468676, "body": "What do you mean by &quot;not querying correctly&quot;?"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1448173302, "post_id": 33851705, "comment_id": 55468678, "body": "Also, can you show us the definition of page.AudPage?"}, {"owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 2, "creation_date": 1448175134, "post_id": 33851705, "comment_id": 55468985, "body": "Not querying correctly meaning nothing is being returned whereas this query within the pg console or pgAdmin3 does in-fact return the expected result."}, {"owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 1, "creation_date": 1448175408, "post_id": 33851705, "comment_id": 55469033, "body": "I have added the AudPage struct per your request, additionally you should note that I preform several queries using select on this struct throughout the application in question. So I have ruled out the possibility of columns in the DB not being present in the struct."}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 2, "creation_date": 1448175525, "post_id": 33851705, "comment_id": 55469061, "body": "Side note: instead of using Sprintf, you should just use place holders (<code>?</code> by default) and pass your arguments to Select (without converting them to string)"}, {"owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 1, "creation_date": 1448175676, "post_id": 33851705, "comment_id": 55469086, "body": "Yes I normally do that. However I converted it to use use fmt.Sprintf() in order to output the result of the string to the console in an attempt to debug the query. As I believe I mentioned, when said query string is outputted, copping that string into pgAdmin preforms the querying successfully, however not in the go application using sqlx"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1448223942, "post_id": 33851705, "comment_id": 55483935, "body": "What do you see if you log the struct after the query?"}, {"owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1448234461, "post_id": 33851705, "comment_id": 55487463, "body": "@Datsik I am attempting to map the response to a slice of the structs in question. If I attempt to log that I have an empty struct with a length of 0."}], "owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544188749, "creation_date": 1448167669, "last_edit_date": 1544188749, "question_id": 33851705, "link": "https://stackoverflow.com/questions/33851705/select-function-not-querying-correctly-with-postgresql-no-errors-thrown", "title": "Select function not querying correctly with PostgreSql, no errors thrown", "body": "<p>I have the following function, which is a work in progress. Additionally, the query I am attempting to execute has been a brain teaser to say the least:</p>\n\n<p>The function:</p>\n\n<pre><code>func OptimizedKeywordPagesBYKeywords(DB *sqlx.DB, PageableId, auditId int, PageableType, keyword, source string) ([]page.AudPage, error) {\n    auditIdString := strconv.Itoa(auditId)\n    PageableIdString := strconv.Itoa(PageableId)\n\n    base := `SELECT \"pages\".* FROM \"pages\" \n    INNER JOIN \"keyword_pages\" ON \"keyword_pages\".\"page_id\" = \"pages\".\"id\" \n    INNER JOIN \"keyword_statistics\" ON \"keyword_statistics\".\"id\" = \"keyword_pages\".\"keyword_statistic_id\" \n    INNER JOIN \"keyword_frequencies\" ON   \"keyword_frequencies\".\"keyword_statistic_id\" = \"keyword_statistics\".\"id\" \n        WHERE ((pageable_id = '%s' AND pageable_type = '%s') \n        AND (meta_description ~* '%s\\M' or title ~* '%s\\M' or h1_1 ~* '%s\\M' or h2_1 ~* '%s\\M' or h2_2 ~* '%s\\M' or path ~* '%s\\M' or content ~* '%s\\M')) \n        AND \"keyword_pages\".\"source\" = '%s' \n        AND \"keyword_pages\".\"optimized\" = 't' \n        AND \"keyword_frequencies\".\"audit_id\" = '%s' \n            GROUP BY pages.id`\n\n    query := fmt.Sprintf(base, PageableIdString, PageableType, keyword, keyword, keyword, keyword, keyword, keyword, keyword, source, auditIdString)\n\n    var pages []page.AudPage\n\n    err := DB.Select(&amp;pages, query)\n\n    if err != nil {\n        return pages, err\n    }\n\n    return pages, nil\n}\n\n\ntype AudPage struct {\n    Id                        sql.NullInt64  `db:\"id\"`\n    PageableId                sql.NullInt64  `db:\"pageable_id\"`\n    PageableType              sql.NullString `db:\"pageable_type\"`\n    Url                       sql.NullString `db:\"url\"`\n    Path                      sql.NullString `db:\"path\"`\n    ContentType               sql.NullString `db:\"content_type\"`\n    StatusCode                sql.NullString `db:\"status_code\"`\n    Status                    sql.NullString `db:\"status\"`\n    Title                     sql.NullString `db:\"title\"`\n    TitleLength               sql.NullInt64  `db:\"title_length\"`\n    TitlePixelWidth           sql.NullInt64  `db:\"title_pixel_width\"`\n    MetaDescription           sql.NullString `db:\"meta_description\"`\n    MetaDescriptionLength     sql.NullInt64  `db:\"meta_description_length\"`\n    MetaDescriptionPixelWidth sql.NullInt64  `db:\"meta_description_pixel_width\"`\n    MetaKeyword               sql.NullString `db:\"meta_keyword\"`\n    MetaKeywordLength         sql.NullInt64  `db:\"meta_keyword_length\"`\n    MetaRobot1                sql.NullString `db:\"meta_robot_1\"`\n    MetaRobot2                sql.NullString `db:\"meta_robot_2\"`\n    MetaRefresh               sql.NullString `db:\"meta_refresh\"`\n    CanonicalLink             sql.NullString `db:\"canonical_link\"`\n    H11                       sql.NullString `db:\"h1_1\"`\n    H1_1_Length               sql.NullInt64  `db:\"h1_1_length\"`\n    H21                       sql.NullString `db:\"h2_1\"`\n    H21Length                 sql.NullInt64  `db:\"h2_1_length\"`\n    H22                       sql.NullString `db:\"h2_2\"`\n    H22Length                 sql.NullInt64  `db:\"h2_2_length\"`\n    FileSize                  sql.NullInt64  `db:\"file_size\"`\n    WordCount                 sql.NullInt64  `db:\"word_count\"`\n    DepthLevel                sql.NullInt64  `db:\"depth_level\"`\n    InLinkSize                sql.NullInt64  `db:\"in_link_size\"`\n    OutLinkSize               sql.NullInt64  `db:\"out_link_size\"`\n    ExternalOutLinkSize       sql.NullInt64  `db:\"external_out_link_size\"`\n    ContentHash               sql.NullString `db:\"content_hash\"`\n    StartDate                 time.Time      `db:\"start_date\"`\n    EndDate                   time.Time      `db:\"end_date\"`\n    CreatedAt                 time.Time      `db:\"created_at\"`\n    UpdatedAt                 time.Time      `db:\"updated_at\"`\n    BodyContent               sql.NullString `db:\"body_content\"`\n    Content                   sql.NullString `db:\"content\"`\n}\n</code></pre>\n\n<p>The problem:</p>\n\n<ul>\n<li>I know for a fact this query works, as I wrote it within pgAdmin3.</li>\n<li>I have also logged the output the result of the query variable, and the query runs as expected, again this was using pgAdmin3.</li>\n<li>The Select function returns no error</li>\n<li>I have scanned over the docs for sqlx and attempted to google the issue with no solutions presenting themselves. </li>\n</ul>\n\n<p>Using:</p>\n\n<ul>\n<li>Postgres: 9.4.1</li>\n<li>Go: 1.5</li>\n</ul>\n\n<p>Additional information:</p>\n\n<pre><code>- message from running the query in pgAdmin3:\nTotal query runtime: 33 ms.\n1 row retrieved.\n</code></pre>\n\n<p>Please let me know if there is a portion of the documentation I have missed, or another function within sqlx I should be using rather than select, or if any additional information is required from me.</p>\n"}, {"tags": ["go", "file-descriptor"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1448171475, "post_id": 33851692, "comment_id": 55468346, "body": "I confirm I can reproduce on my computer."}], "answers": [{"comments": [{"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 1, "creation_date": 1486671364, "post_id": 33852107, "comment_id": 71458361, "body": "This solved my problem, except in my case I had <code>os.O_WRONLY</code> in the <code>os.OpenFile</code> method in a wrapper function, and I was calling that from elsewhere and trying to read from the file it returned, but of course it was set to write-only so I was getting the same error. Fixed by changing to <code>os.O_RDWR</code>."}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 73, "last_activity_date": 1570711703, "last_edit_date": 1570711703, "creation_date": 1448171783, "answer_id": 33852107, "question_id": 33851692, "link": "https://stackoverflow.com/questions/33851692/golang-bad-file-descriptor/33852107#33852107", "title": "Golang bad file descriptor", "body": "<p>You need to add the <code>O_WRONLY</code> flag :</p>\n\n<pre><code>if f, err := os.OpenFile(\"./log.log\", os.O_APPEND|os.O_WRONLY, os.ModeAppend); err != nil { /*[...]*/ }\n</code></pre>\n\n<p>To explain, here is the linux documentation for <code>open</code>: <a href=\"http://man7.org/linux/man-pages/man2/openat.2.html\" rel=\"noreferrer\">http://man7.org/linux/man-pages/man2/openat.2.html</a> :</p>\n\n<blockquote>\n  <p>The argument flags must include one of the following access modes:\n         O_RDONLY, O_WRONLY, or O_RDWR.  These request opening the file read-\n         only, write-only, or read/write, respectively.</p>\n</blockquote>\n\n<p>If you check <a href=\"https://github.com/golang/go/blob/900ebcfe4d592486dd5bc50f5e8101ba65e32948/src/syscall/zerrors_linux_amd64.go#L660\" rel=\"noreferrer\">/usr/local/go/src/syscall/zerrors_linux_amd64.go:660</a>, you can see that:</p>\n\n<pre><code>O_RDONLY                         = 0x0\nO_RDWR                           = 0x2\nO_WRONLY                         = 0x1\n</code></pre>\n\n<p>So by default you get a read-only file descriptor.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8404251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee0eaa8c3dbb67907b97ab476358728?s=128&d=identicon&r=PG&f=1", "display_name": "jack wu", "link": "https://stackoverflow.com/users/8404251/jack-wu"}, "is_accepted": false, "score": 2, "last_activity_date": 1560482563, "creation_date": 1560482563, "answer_id": 56590981, "question_id": 33851692, "link": "https://stackoverflow.com/questions/33851692/golang-bad-file-descriptor/56590981#56590981", "title": "Golang bad file descriptor", "body": "<p>it used for me</p>\n\n<p>the code before:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>os.OpenFile(fileName, os.O_CREATE|os.O_APPEND, os.ModePerm)\n</code></pre>\n\n<p>and it occured the error: bad file descriptor,</p>\n\n<p>then i add the os.O_WRONLY into the function</p>\n\n<p>the code after:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>os.OpenFile(fileName, os.O_CREATE|os.O_WRONLY|os.O_APPEND, os.ModePerm)\n</code></pre>\n\n<p>and it did't occured the problem.</p>\n"}, {"comments": [{"owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "edited": false, "score": 1, "creation_date": 1582205212, "post_id": 60320753, "comment_id": 106702679, "body": "Welcome to StackOverflow! So you are telling that at windows it is enough to use only os.O_APPEND but for linux you need to add os.O_WRONLY explicitly, right? Please extend your answer to help future visitors instantly see solution and call examples (like such piece of code work at Windows but not work on Linux and such piece of code would have identical behavior)"}, {"owner": {"reputation": 11, "user_id": 12932351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f1c9327505d93b43a9459cb4557ac09?s=128&d=identicon&r=PG&f=1", "display_name": "Trenjeska Schutte", "link": "https://stackoverflow.com/users/12932351/trenjeska-schutte"}, "reply_to_user": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "edited": false, "score": 1, "creation_date": 1582210240, "post_id": 60320753, "comment_id": 106705638, "body": "@MaximSagaydachny yes in windows just the append flag is enough (updated in post) and thanks :)"}], "tags": [], "owner": {"reputation": 11, "user_id": 12932351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f1c9327505d93b43a9459cb4557ac09?s=128&d=identicon&r=PG&f=1", "display_name": "Trenjeska Schutte", "link": "https://stackoverflow.com/users/12932351/trenjeska-schutte"}, "is_accepted": false, "score": 1, "last_activity_date": 1582210144, "last_edit_date": 1582210144, "creation_date": 1582204338, "answer_id": 60320753, "question_id": 33851692, "link": "https://stackoverflow.com/questions/33851692/golang-bad-file-descriptor/60320753#60320753", "title": "Golang bad file descriptor", "body": "<p>This appears to be a discrepancy between windows and linux.\nOn windows os.O_APPEND implies write access, as can be seen in the code in syscall_windows.go.</p>\n\n<pre><code>if mode&amp;O_APPEND != 0 {\n    access &amp;^= GENERIC_WRITE\n    access |= FILE_APPEND_DATA\n}\n</code></pre>\n\n<p>in linux the openflags are passed as-is to a linux syscall</p>\n\n<p>So in DOS/WINDOWS you do not need to explicitly add a write flag with an append flag, as it is implied. (this has been default behaviour since the DOS days)\nGo in linux does need the extra flag added to work.</p>\n\n<p>(...but imo it should not <em>need</em> this flag, as appending implicitly implies that I want to write. Should I bugreport this to golang ?)</p>\n"}], "owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28646, "favorite_count": 3, "accepted_answer_id": 33852107, "answer_count": 3, "score": 33, "last_activity_date": 1582210144, "creation_date": 1448167562, "question_id": 33851692, "link": "https://stackoverflow.com/questions/33851692/golang-bad-file-descriptor", "title": "Golang bad file descriptor", "body": "<p>I am getting a bad file descriptor when trying to append to a logging file within my go routine. </p>\n\n<p><code>write ./log.log: bad file descriptor</code></p>\n\n<p>The file exists and has 666 for permissions. At first I thought well maybe it is because each one of them is trying to open the file at the same time. I implemented a mutex to try and avoid that but got the same issue so I removed it. </p>\n\n<pre><code>logCh := make(chan string, 150)\ngo func() {\n    for {\n        msg, ok := &lt;-logCh\n        if ok {\n            if f, err := os.OpenFile(\"./log.log\", os.O_APPEND, os.ModeAppend); err != nil {\n                panic(err)\n            } else {\n                logTime := time.Now().Format(time.RFC3339)\n                if _, err := f.WriteString(logTime + \" - \" + msg); err != nil {\n                    fmt.Print(err)\n                }\n                f.Close()\n            }\n        } else {\n            fmt.Print(\"Channel closed! \\n\")\n            break\n        }\n    }\n}()\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1448164248, "post_id": 33851372, "comment_id": 55467118, "body": "Ah thats awesome thank you, how come I should pass the  <code>dbUsername</code> channel to the goroutine, could I just pass it by putting it in there, is it not in the scope? Just confused on why I should pass wg as its self (I understand that its not a copy) but then I pass a copy of the channel to the function and that works fine?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1448165020, "post_id": 33851372, "comment_id": 55467244, "body": "Yes, added that. You don&#39;t really need any parameters to your two goroutines, and you probably don&#39;t need the WaitGroup at all."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1448165946, "post_id": 33851372, "comment_id": 55467383, "body": "Thanks again, non-buffered channels are blocking right? Which makes sense on using that and not the wait groups."}, {"owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "edited": false, "score": 0, "creation_date": 1541054356, "post_id": 33851372, "comment_id": 93088701, "body": "Using &quot;go vet&quot; will warn if you copy a sync.WaitGroup - eg as in this case - passing by value to the go-routine. BTW the reason it&#39;s OK to pass a channel by &quot;value&quot; is that it is a reference type, but never pass a WaitGroup by value (use a pointer to it), or capture it in a closure as suggested above."}], "tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": true, "score": 1, "last_activity_date": 1448164996, "last_edit_date": 1448164996, "creation_date": 1448163895, "answer_id": 33851372, "question_id": 33851312, "link": "https://stackoverflow.com/questions/33851312/how-can-i-do-multiple-concurrent-requests-properly/33851372#33851372", "title": "How can I do multiple concurrent requests properly?", "body": "<p>You're passing in a copy of your <code>WaitGroup</code> to your two functions, </p>\n\n<p>Instead pass in a pointer, <code>waiter *sync.WaitGroup</code>, so your code that waits on the WaitGroup and the goroutines all operates on the same WaitGroup.</p>\n\n<p>This is also noted in the <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow\">documentation</a>: </p>\n\n<blockquote>\n  <p>Values containing the types defined in this package should not be copied.</p>\n</blockquote>\n\n<p>However, in your case your goroutine functions can access the variables declared in the outer scope, so you don't need to pass in any arguments at all. You might not need the WaitGroup either, as receiving of <code>&lt;-dbUsername</code>  and <code>&lt;-dbEmail</code> will anyway wait until the goroutines are done - as long as you make both your goroutines send a value on their respective channels. And you don't need buffered channels here either.</p>\n\n<p>As for this:</p>\n\n<blockquote>\n  <p>is it possible to declare a buffered channel with var e.g. var blah chan string 1</p>\n</blockquote>\n\n<p>Yes, remember that channels need to be created using <code>make()</code> </p>\n\n<pre><code>var blah chan string \nblah = make(chan string, 1)\n</code></pre>\n\n<p>Or <code>var blah chan string = make(chan string, 1)</code></p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 33851372, "answer_count": 1, "score": 0, "last_activity_date": 1448164996, "creation_date": 1448163131, "question_id": 33851312, "link": "https://stackoverflow.com/questions/33851312/how-can-i-do-multiple-concurrent-requests-properly", "title": "How can I do multiple concurrent requests properly?", "body": "<p>Hi guys I'm trying to make multiple requests to a database, and I found doing them in order synchronously is quite slow and exponentially increases response time while waiting for each request to finish, this is what I have so far:</p>\n\n<pre><code>var wg sync.WaitGroup\ndbUsername := make(chan string, 1)\ndbEmail := make(chan string, 1)\n\nwg.Add(2)\ngo func(username chan string, waiter sync.WaitGroup) {\n    defer waiter.Done()\n    err = db.QueryRow(\"SELECT username FROM user WHERE username = ?\", vals.Get(\"username\")).Scan(&amp;result)\n    if err != nil {\n        log.Println(err)\n    }\n}(dbUsername, wg)\n\ngo func(email chan string, waiter sync.WaitGroup) {\n    defer waiter.Done()\n    err = db.QueryRow(\"SELECT email FROM user WHERE email = ?\", vals.Get(\"email\")).Scan(&amp;result)\n    if err != nil {\n        log.Println(err)\n    }\n}(dbEmail, wg)\n\nwg.Wait()\n\n\n\nif &lt;-dbUsername != \"\" {\n    formErrors = append(formErrors, \"Username has already been taken.\")\n}\nif &lt;-dbEmail != \"\" {\n    formErrors = append(formErrors, \"Email has already been taken.\")\n}\n</code></pre>\n\n<p>but it doesn't seem to work correctly, I've followed the <code>WaitGroup</code> example to the dot, but it seems to hang on <code>wg.Wait()</code> and I'm not sure why. And is there a prettier way to do this or is what I have mocked up normal?</p>\n\n<p><em>also small sub question</em>:</p>\n\n<p>is it possible to declare a buffered channel with <code>var</code> e.g. <code>var blah chan string 1</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1448163620, "post_id": 33851189, "comment_id": 55467028, "body": "This simplified example demonstrates the issue: <a href=\"http://play.golang.org/p/fDlTowmJOy\" rel=\"nofollow noreferrer\">play.golang.org/p/fDlTowmJOy</a>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5405922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6fe3b9840c8fd74129e12433327bbfdc?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5405922/ryan"}, "edited": false, "score": 0, "creation_date": 1448164952, "post_id": 33851384, "comment_id": 55467231, "body": "After seeing you simplified example, it is more clear to me now and I think you answer is reasonable. Your &quot;never save off a reference&quot; is what they called non-addressable in the book, and I guess that&#39;s why you can&#39;t access the field without saving the new struct as a variable first."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 1, "last_activity_date": 1448164094, "creation_date": 1448164094, "answer_id": 33851384, "question_id": 33851189, "link": "https://stackoverflow.com/questions/33851189/struct-field-assignment-difference-of-pointer-non-pointer-type/33851384#33851384", "title": "struct field assignment difference of pointer/non-pointer type", "body": "<p>This <a href=\"http://play.golang.org/p/fDlTowmJOy\" rel=\"nofollow\">simplified example</a> demonstrates the issue:</p>\n\n<pre><code>package main\n\ntype t struct {\n    int\n}\n\nfunc newT() *t { return &amp;t{} }\n//func newT() t { return t{} }\n\nfunc main() {\n    newT().int = 0\n}\n</code></pre>\n\n<p>My guess is that if you use the version of <code>newT</code> that does not return a pointer, and never save off a reference to the result of <code>newT()</code>, then setting the value of its <code>int</code> field can never meaningfully do anything.  It's similar to setting an unused variable.</p>\n\n<p>If instead you the non-pointer version of <code>newT</code> but you have something like:</p>\n\n<pre><code>x := newT()\nx.int = 0\n</code></pre>\n\n<p>Then you'd be fine.</p>\n\n<p>Alternatively, using the pointer version of <code>newT</code> above is fine, because it could be returning some state you already had defined previously, see <a href=\"http://play.golang.org/p/jzdLkZOTO3\" rel=\"nofollow\">example</a>:</p>\n\n<pre><code>package main\n\ntype t struct {\n    int\n}\n\nvar dilbert = &amp;t{3}\n\nfunc newT() *t { return dilbert }\n\n//func newT() t { return t{} }\n\nfunc main() {\n    println(dilbert.int)\n    newT().int = 0\n    println(dilbert.int)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 4566048, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vFaQTCQaz9k/AAAAAAAAAAI/AAAAAAAAACA/z6k7NsmafK0/photo.jpg?sz=128", "display_name": "xuefeng huang", "link": "https://stackoverflow.com/users/4566048/xuefeng-huang"}, "is_accepted": false, "score": 2, "last_activity_date": 1489391793, "creation_date": 1489391793, "answer_id": 42758779, "question_id": 33851189, "link": "https://stackoverflow.com/questions/33851189/struct-field-assignment-difference-of-pointer-non-pointer-type/42758779#42758779", "title": "struct field assignment difference of pointer/non-pointer type", "body": "<p>I have researched on this topic, and I think the problem if you change to Employee instead of *Employee, then EmployeeByID(id) will be a unaddressable value since it is not assigned to a variable. It is OK if you assign it a variable like below:</p>\n\n<pre><code>e1 := EmployeeByID(id)\ne1.Salary = 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 3680194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTrlX.png?s=128&g=1", "display_name": "Song", "link": "https://stackoverflow.com/users/3680194/song"}, "is_accepted": false, "score": 1, "last_activity_date": 1499097352, "creation_date": 1499097352, "answer_id": 44889813, "question_id": 33851189, "link": "https://stackoverflow.com/questions/33851189/struct-field-assignment-difference-of-pointer-non-pointer-type/44889813#44889813", "title": "struct field assignment difference of pointer/non-pointer type", "body": "<pre><code>func EmployeeByID(id int) *Employee { /* ... */ }\n</code></pre>\n\n<p>This return a pointer to an Employee variable.</p>\n\n<pre><code>func EmployeeByID(id int) Employee { /* ... */ }\n</code></pre>\n\n<p>This returns a <strong>value</strong> copied from an Employee variable. You need to assign it to a variable before using it.</p>\n"}], "owner": {"reputation": 67, "user_id": 5405922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6fe3b9840c8fd74129e12433327bbfdc?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5405922/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 33851384, "answer_count": 3, "score": 4, "last_activity_date": 1499097352, "creation_date": 1448161575, "last_edit_date": 1448163116, "question_id": 33851189, "link": "https://stackoverflow.com/questions/33851189/struct-field-assignment-difference-of-pointer-non-pointer-type", "title": "struct field assignment difference of pointer/non-pointer type", "body": "<p>In section 4.4 (Structs) of The Go Programming Language, there is a code excerpt:</p>\n\n<pre><code>var dilbert Employee\nfunc EmployeeByID(id int) *Employee { /* ... */ }\nid := dilbert.ID\nEmployeeByID(id).salary = 0\n</code></pre>\n\n<p>with the remark</p>\n\n<blockquote>\n  <p>If the result type of <code>EmployeeByID</code> were changed to <code>Employee</code> instead of <code>*Employee</code>, the assignment statement would not compile since its left-hand side would not identify a variable.</p>\n</blockquote>\n\n<p>I don't understand why changing the result type of <code>EmployeeByID</code> to <code>Employee</code> would cause LHS not identify a variable.</p>\n"}, {"tags": ["delphi", "go", "cryptography", "lockbox-3"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5588595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a1a7fd012f4b170cc5611f90951c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunter", "link": "https://stackoverflow.com/users/5588595/bughunter"}, "edited": false, "score": 0, "creation_date": 1448326691, "post_id": 33862282, "comment_id": 55531628, "body": "Thanks for your answer.You remind me the difference of hash,I remember that I traced the RSA in lockbox to compare to Golang,it&#39;s the problem of sha-1,in Golang,you can pass a hash in. There are no demo of OpenSSL in lockbox,I even don&#39;t know how to use it.Oher RSA library for delphi? no,lockbox is the best,if lockbox can&#39;t solve,I don&#39;t think there are. Thanks for your relply again."}], "tags": [], "owner": {"reputation": 12159, "user_id": 10823, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69d49d43101b3ba3adb7e53d23369551?s=128&d=identicon&r=PG", "display_name": "Sean B. Durkin", "link": "https://stackoverflow.com/users/10823/sean-b-durkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1448240823, "creation_date": 1448240823, "answer_id": 33862282, "question_id": 33850935, "link": "https://stackoverflow.com/questions/33850935/rsa-to-encrypt-decrypt-between-delphilockbox-and-go1-5/33862282#33862282", "title": "RSA to encrypt/decrypt between delphi(lockbox) and go1.5", "body": "<p>The TP Lockbox 3 native RSA codec implements RSA/PKCS#1 version 2.1 (<a href=\"http://www.ietf.org/rfc/rfc3447.txt\" rel=\"nofollow\">http://www.ietf.org/rfc/rfc3447.txt</a>). This algorithm is parameterized by the choice of hash function and mask generation function. If two RSA codecs have different hash function or mask generation function, they will not be \ninteroperable.</p>\n\n<p>The hash function and the mask generation function in LB3, can be found in procedure MGF1() in unit TPLB3.RSA_Primitives, and is based on SHA-1. You would\nhave to find out what hash and mask generation function goLang uses to find out if there is even a chance for interoperability. The standard gives recommendations (which were adopted by LB3), but none are standardised.</p>\n\n<p>As well as that, it appears from your goLang listing, that goLang encooding the keys in PEM format. LB3's native RSA does not use the PEM format.</p>\n\n<p>For your best chance at interoperability, try LB's OpenSSL component instead of the native RSA codec.</p>\n\n<p>For Delphi to Delphi, LB3 is a great cryptographic library. Very flexible, modular, with plenty of ciphers and block chaining methods, and the only FOSS library I know with a published and extensive set of unit tests. But its great weakness is interoperability. If interoperability between other languages or systems is important, then you should probably choose another library.</p>\n"}], "owner": {"reputation": 11, "user_id": 5588595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a1a7fd012f4b170cc5611f90951c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunter", "link": "https://stackoverflow.com/users/5588595/bughunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2072, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1448240823, "creation_date": 1448158631, "question_id": 33850935, "link": "https://stackoverflow.com/questions/33850935/rsa-to-encrypt-decrypt-between-delphilockbox-and-go1-5", "title": "RSA to encrypt/decrypt between delphi(lockbox) and go1.5", "body": "<p>When I use RSA to encrypt/decrypt the data,they are working good in delphi.But when I use them with other program, they seems not work.</p>\n\n<p>I use the golang 1.5 in server side,when I use EncryptOAEP/DecryptOAEP,EncryptPKCS1v15/DecryptPKCS1v15,these pair functions are all good.</p>\n\n<p>When I try to put all of these together,they can't recognized each other,I tried lots of kind of combination,for their own,they work fine.</p>\n\n<p>1.Delphi xe6\n2.lockbox Release v3.6.3.0\n3.some code</p>\n\n<h1><strong>golang on serverside</strong></h1>\n\n<pre><code>import (\n    \"errors\"    \n    \"strings\"\n    \"strconv\"\n    \"log\"\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n    //\"strconv\"\n    \"encoding/base64\"\n    \"encoding/json\"\n    \"bytes\"\n    //\"strings\"\n)\n\nvar privateKey = []byte(`\n-----BEGIN RSA PRIVATE KEY-----\nMIICXQIBAAKBgQDZsfv1qscqYdy4vY+P4e3cAtmvppXQcRvrF1cB4drkv0haU24Y\n7m5qYtT52Kr539RdbKKdLAM6s20lWy7+5C0DgacdwYWd/7PeCELyEipZJL07Vro7\nAte8Bfjya+wltGK9+XNUIHiumUKULW4KDx21+1NLAUeJ6PeW+DAkmJWF6QIDAQAB\nAoGBAJlNxenTQj6OfCl9FMR2jlMJjtMrtQT9InQEE7m3m7bLHeC+MCJOhmNVBjaM\nZpthDORdxIZ6oCuOf6Z2+Dl35lntGFh5J7S34UP2BWzF1IyyQfySCNexGNHKT1G1\nXKQtHmtc2gWWthEg+S6ciIyw2IGrrP2Rke81vYHExPrexf0hAkEA9Izb0MiYsMCB\n/jemLJB0Lb3Y/B8xjGjQFFBQT7bmwBVjvZWZVpnMnXi9sWGdgUpxsCuAIROXjZ40\nIRZ2C9EouwJBAOPjPvV8Sgw4vaseOqlJvSq/C/pIFx6RVznDGlc8bRg7SgTPpjHG\n4G+M3mVgpCX1a/EU1mB+fhiJ2LAZ/pTtY6sCQGaW9NwIWu3DRIVGCSMm0mYh/3X9\nDAcwLSJoctiODQ1Fq9rreDE5QfpJnaJdJfsIJNtX1F+L3YceeBXtW0Ynz2MCQBI8\n9KP274Is5FkWkUFNKnuKUK4WKOuEXEO+LpR+vIhs7k6WQ8nGDd4/mujoJBr5mkrw\nDPwqA3N5TMNDQVGv8gMCQQCaKGJgWYgvo3/milFfImbp+m7/Y3vCptarldXrYQWO\nAQjxwc71ZGBFDITYvdgJM1MTqc8xQek1FXn1vfpy2c6O\n-----END RSA PRIVATE KEY-----\n`)\nvar publicKey = []byte(`\n-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDZsfv1qscqYdy4vY+P4e3cAtmv\nppXQcRvrF1cB4drkv0haU24Y7m5qYtT52Kr539RdbKKdLAM6s20lWy7+5C0Dgacd\nwYWd/7PeCELyEipZJL07Vro7Ate8Bfjya+wltGK9+XNUIHiumUKULW4KDx21+1NL\nAUeJ6PeW+DAkmJWF6QIDAQAB\n-----END PUBLIC KEY-----\n`)\ntype DebugKeysRPC_Args struct {\n\n}\ntype DebugKeysRPC_Reply struct {\n    PubN        string\n    PubE        uint64\n    PrvN        string\n    PrvD        string\n    PrvP        string\n    PrvQ        string\n    Dp          string\n    Dq          string\n    Qinv        string\n    CRTValues   string\n    ID      uint64\n    Key     string\n    Dest    string  \n}\n\nfunc (t *AccessDB) DebugKeysRPC(args *DebugKeysRPC_Args, reply *DebugKeysRPC_Reply) error { \n    log.Println(\"DebugKeysRPC\")\n\n    if pubN,pubE,PrvN,PrvD,PrvP,PrvQ,Dp,Dq,Qinv,CRTValues,err:=ReadKeyFields(publicKey,privateKey);err==nil{\n        log.Println(\"ok read\")\n        reply.PubN=base64.StdEncoding.EncodeToString(pubN)\n        reply.PubE=uint64(pubE)\n        reply.PrvN=base64.StdEncoding.EncodeToString(PrvN)\n        reply.PrvD=base64.StdEncoding.EncodeToString(PrvD)\n        reply.PrvP=base64.StdEncoding.EncodeToString(PrvP)\n        reply.PrvQ=base64.StdEncoding.EncodeToString(PrvQ)\n        reply.Dp=base64.StdEncoding.EncodeToString(Dp)\n        reply.Dq=base64.StdEncoding.EncodeToString(Dq)\n        reply.Qinv=base64.StdEncoding.EncodeToString(Qinv)\n        reply.CRTValues=base64.StdEncoding.EncodeToString(CRTValues)\n        reply.ID=1\n        //origData:=[]byte(\"abcdefghijklmnopqrstuvwxyz\")\n        origData:=[]byte(\"1234567890123456\")\n        if resultRsa,err:=DbgRasEncryptOAEP(origData,publicKey);err==nil{\n        //if resultRsa,err:=RsaEncrypt(origData,publicKey);err==nil{\n            log.Printf(\"resultRsa(%d): % x\", len(resultRsa),resultRsa)\n            reply.Dest=base64.StdEncoding.EncodeToString(resultRsa)\n            if resultRsaP,err:=DbgRsaDecryptOAEP(resultRsa,privateKey);err==nil{\n                //log.Printf(\"RsaDecrypt ok % x\", resultRsaP)   \n                log.Println(\"RsaDecrypt ok\")\n                log.Printf(\"resultRsaP(%d): %s\", len(string(resultRsaP)),string(resultRsaP))\n            }else{\n                log.Println(\"RsaDecrypt\",err)\n            }\n        }else{\n            log.Println(\"RsaEncrypt\",err)\n        }                   \n    }else{\n        WatchPublicKey(publicKey)\n        WatchPrivateKey(privateKey)\n        log.Println(err)\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>===============================================================================\n<strong>some code in delphi side(I haven't install the lockbox,I insert all source into project).</strong></p>\n\n<p>===============================================================================</p>\n\n<pre><code>procedure RsaEncrypt( const PublicKey: TStream; const srcStream : TStream;tgtStream:TStream);\nvar\n  Codec : TCodec;\n  wasAborted: boolean;\n  KeyPair: TAsymetricKeyPair;\n  Key: TSymetricKey;\n  lib : TCryptographicLibrary;\nbegin\n  Codec := TCodec.Create(Nil);\n  lib := TCryptographicLibrary.Create(Nil);\n  try\n    //0. Reset\n    Codec.Reset;\n    Codec.CryptoLibrary := lib;\n    Codec.ChainModeId := ECB_ProgId;\n    Codec.StreamCipherId := 'native.RSA';\n\n    //1. Set the cipher to RSA encryption.\n    Codec.StreamCipherId := RSA_ProgId;\n\n    //2. Load our pre-fabricated public key.\n    PublicKey.Position := 0;\n    Codec.AsymetricKeySizeInBits := 1024;\n    Key := Codec.Asymetric_Engine.CreateFromStream(PublicKey, [partPublic]);\n\n    //3. Now set the key.\n    Codec.InitFromKey(Key);\n    Codec.EncryptStream(srcStream,tgtStream);\n  finally\n    lib.Free;\n    Codec.Free;\n  end;\nend;\n\nprocedure RsaDecrypt( const PrivateKey: TStream; const srcStream : TStream;tgtStream:TStream);\nvar\n  Codec : TCodec;\n  wasAborted: boolean;\n  KeyPair: TAsymetricKeyPair;\n  //Key: TSymetricKey;\n  lib : TCryptographicLibrary;\nbegin\n  Codec := TCodec.Create(Nil);\n  lib := TCryptographicLibrary.Create(Nil);\n  try\n   //0. Reset\n   Codec.Reset;\n   Codec.CryptoLibrary := lib;\n   Codec.ChainModeId := ECB_ProgId;\n   Codec.StreamCipherId := 'native.RSA';\n\n    //1. Set the cipher to RSA encryption.\n    Codec.StreamCipherId := RSA_ProgId;\n\n    //2. Load our pre-fabricated private key.\n    PrivateKey.Position := 0;\n    Codec.AsymetricKeySizeInBits := 1024;\n    KeyPair := Codec.Asymetric_Engine.CreateFromStream(PrivateKey, [partPrivate]);\n\n    //3. Now set the key.\n    Codec.InitFromKey(KeyPair);\n\n    Codec.DecryptStream(tgtStream,srcStream);\n  finally\n    lib.Free;\n    Codec.Free;\n  end;\nend;\n\nprocedure Sign(privateKey,srcStream,tgtStream:TMemoryStream);\nvar\n  sign:TSignature;\nbegin\n  try\n    sign:=TSignature.Create;\n    privateKey.Seek(0,soBeginning);\n    sign.m_Signatory.LoadKeysFromStream(privateKey,[partPrivate]);\n\n    sign.m_Signatory.Sign(srcStream,tgtStream);\n  finally\n    sign.Free;\n  end;\nend;\n\nfunction Verify(publicKey,srcStream,tgtStream:TMemoryStream):Boolean;\nvar\n  sign:TSignature;\n  vResult:TVerifyResult;\n  nDbg:Integer;\nbegin\n  try\n    result:=False;\n    publicKey.Seek(0,soBeginning);\n    srcStream.Seek(0,soBeginning);\n    tgtStream.Seek(0,soBeginning);\n    sign:=TSignature.Create;\n    sign.m_Signatory.LoadKeysFromStream(publicKey,[partPublic]);\n\n    vResult:=sign.m_Signatory.Verify(srcStream,tgtStream);\n    if vResult=vPass then\n    begin\n      nDbg:=0;\n      result:=True;\n    end\n    else if vResult=vFail then\n    begin\n      nDbg:=1;\n    end\n    else if vResult=vUserAbort then\n      nDbg:=3\n    else nDbg:=4;\n  finally\n    sign.Free;\n  end;\nend;\n\nprocedure readPubKey(pubN:TStream;pubE:TStream);\nvar\n  publicKey:TMemoryStream;\n  Codec : TCodec;\n  Key: TAsymetricKeyPair;\n  lib : TCryptographicLibrary;\nbegin\n  try\n    publicKey:=TMemoryStream.Create;\n\n    publicKey.LoadFromFile('e:\\public.key');\n\n    Codec := TCodec.Create(Nil);\n    lib := TCryptographicLibrary.Create(Nil);\n    try\n      //0. Reset\n      Codec.Reset;\n      Codec.CryptoLibrary := lib;\n      Codec.ChainModeId := ECB_ProgId;\n\n      //1. Set the cipher to RSA encryption.\n      Codec.StreamCipherId := RSA_ProgId;\n\n      //2. Load our pre-fabricated public key.\n      PublicKey.Position := 0;\n      Codec.AsymetricKeySizeInBits := 1024;\n      Key := Codec.Asymetric_Engine.CreateFromStream(publicKey, [partPublic]);\n      //pubN.Write(Key.F_RSA_n.Value,sizeof(Key.F_RSA_n.Value));\n      //pubE.Write(Key.F_RSA_n.Value,sizeof(Key.F_RSA_e.Value));\n      pubN.CopyFrom((TRSAKeyPair(Key)).F_RSA_n.Value.FValue,0);\n      pubE.CopyFrom((TRSAKeyPair(Key)).F_RSA_e.Value.FValue,0);\n    finally\n      lib.Free;\n      Codec.Free;\n    end;\n\n  finally\n    publicKey.Free;\n  end;\nend;\n\nprocedure dbgRsaKeys();\nvar\n  publicKey:TMemoryStream;\n  privateKey:TMemoryStream;\n  tgtStream:TMemoryStream;\n  srcStream:TStringStream;\n  src:string;\n  rstStream:TStringStream;\n  sResult:string;\nbegin\n  publicKey:=TMemoryStream.Create;\n  privateKey:=TMemoryStream.Create;\n  rstStream:=TStringStream.Create;\n  srcStream:=TStringStream.Create;\n  tgtStream:=TMemoryStream.Create;\n  try\n    src:='tell me why,tell me how,tell me where';\n    srcStream.WriteString(src);\n    srcStream.Seek(0,soBeginning);\n    publicKey.LoadFromFile('e:\\public.key');\n    privateKey.LoadFromFile('e:\\private.key');\n\n    RsaEncrypt( PublicKey,srcStream ,tgtStream);\n\n    RsaDecrypt( PrivateKey,tgtStream,rstStream);\n    sResult:=rstStream.DataString;\n  finally\n    publicKey.Free;\n    privateKey.Free;\n    srcStream.Free;\n    tgtStream.Free;\n    rstStream.Free;\n  end;\nend;\nprocedure TestEncrypt();\nvar\n  publicKey:TMemoryStream;\n  srcStream,tgtStream:TMemoryStream;\nbegin\n  try\n    publicKey:=TMemoryStream.Create;\n\n    srcStream:=TMemoryStream.Create;\n    srcStream.LoadFromFile('e:\\scanconfig.txt');\n    tgtStream:=TMemoryStream.Create;\n    publicKey.LoadFromFile('e:\\public.key');\n\n    RsaEncrypt( PublicKey,srcStream ,tgtStream);\n\n    tgtStream.SaveToFile('e:\\scanconfig.enc');\n  finally\n    publicKey.Free;\n    srcStream.Free;\n    tgtStream.Free;\n  end;\nend;\n\nprocedure TestDecrypt(srcStream:TMemoryStream);\nvar\n  privateKey:TMemoryStream;\n  tgtStream:TStringStream;\n  sResult:String;\nbegin\n  //dbgRsaKeys();\n  privateKey:=TMemoryStream.Create;\n  tgtStream:=TStringStream.Create;\n  try\n    srcStream.Seek(0,soBeginning);\n    privateKey.LoadFromFile('e:\\private.key');\n    RsaDecrypt( privateKey,srcStream,tgtStream);\n    sResult:=tgtStream.DataString;\n  finally\n    privateKey.Free;\n    tgtStream.Free;\n  end;\nend;\n</code></pre>\n\n<p>================================================================================</p>\n"}, {"tags": ["arrays", "matrix", "multidimensional-array", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1448143629, "last_edit_date": 1448143629, "creation_date": 1448139848, "answer_id": 33848553, "question_id": 33848424, "link": "https://stackoverflow.com/questions/33848424/finding-the-length-of-2d-slices-in-go/33848553#33848553", "title": "Finding the length of 2D slices in go", "body": "<p>Note that since every \"row\" in a 2D slice may have arbitrary length, you should check the length of each of the corresponding rows (having the same index) if they are equal.</p>\n\n<p>Here's a function that does that:</p>\n\n<pre><code>func match(m1, m2 [][]int) bool {\n    if len(m1) != len(m2) {\n        return false\n    }\n\n    for i, row1 := range m1 {\n        row2 := m2[i]\n        if len(row1) != len(row2) {\n            return false\n        }\n    }\n\n    return true\n}\n</code></pre>\n\n<p>See usage examples:</p>\n\n<pre><code>m1 := [][]int{{1, 2, 3}, {4, 5, 6}}\nm2 := [][]int{{7, 8, 9}, {10, 11, 12}}\nfmt.Println(match(m1, m2))\n\nm1 = [][]int{{1, 2, 3}, {4, 5, 6, 7, 8}}\nm2 = [][]int{{7, 8, 9}, {10, 11, 12, 12, 13}}\nfmt.Println(match(m1, m2))\n\nm1 = [][]int{{1, 2, 3}, {4, 5, 6, 7, 8}}\nm2 = [][]int{{7, 8, 9}, {10, 11, 12, 12}}\nfmt.Println(match(m1, m2))\n\nm1 = [][]int{{1, 2, 3}}\nm2 = [][]int{{7, 8, 9}, {10, 11, 12, 12}}\nfmt.Println(match(m1, m2))\n</code></pre>\n\n<p>Output (as expected):</p>\n\n<pre><code>true\ntrue\nfalse\nfalse\n</code></pre>\n\n<p><strong>Simplification for Special case:</strong></p>\n\n<p>If you have guarantee that in all of your matrices all rows have the same length, you can make a big simplification: in this case if number of rows matches, it's enough to compare the length of one of the rows only from each matrices, practically the first row.</p>\n\n<p>It could look like this:</p>\n\n<pre><code>func match2(m1, m2 [][]int) bool {\n    if len(m1) != len(m2) {\n        return false\n    }\n    return len(m1) == 0 || len(m1[0]) == len(m2[0])\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>m1 = [][]int{{1, 2, 3}, {4, 5, 6}}\nm2 = [][]int{{7, 8, 9}, {10, 11, 12}}\nfmt.Println(match2(m1, m2))\n\nm1 = [][]int{{1, 2, 3, 4}, {5, 6, 7, 8}}\nm2 = [][]int{{7, 8, 9}, {10, 11, 12}}\nfmt.Println(match2(m1, m2))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>true\nfalse\n</code></pre>\n\n<p>Try these on the <kbd><a href=\"http://play.golang.org/p/uZIRvLDdTY\" rel=\"nofollow\">Go Playground</a></kbd>.</p>\n"}], "owner": {"reputation": 9, "user_id": 4141104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146cfe0ef345032d682b5137905b7ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Anupma Raj", "link": "https://stackoverflow.com/users/4141104/anupma-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "accepted_answer_id": 33848553, "answer_count": 1, "score": 1, "last_activity_date": 1448143629, "creation_date": 1448139037, "last_edit_date": 1448140455, "question_id": 33848424, "link": "https://stackoverflow.com/questions/33848424/finding-the-length-of-2d-slices-in-go", "title": "Finding the length of 2D slices in go", "body": "<p>I want to check if the matrices are of the same size: if both matrices have the same number of rows and the same number of columns.</p>\n\n<pre><code>matrix1 := [][]int{{1,2,3} ,{4,5,6}}\nmatrix2 := [][]int{{7,8,9}, {10,11,12}}\n</code></pre>\n\n<p>I get <code>len(matrix1) == len(matrix2) == 2</code>. Which is the correct number of rows. </p>\n\n<p>How can I check the length of each row (i.e. the number of columns, which should be 3) if I'm declaring the matrices as shown above?</p>\n"}, {"tags": ["algorithm", "go"], "answers": [{"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 2, "last_activity_date": 1448139861, "last_edit_date": 1448139861, "creation_date": 1448139554, "answer_id": 33848513, "question_id": 33848258, "link": "https://stackoverflow.com/questions/33848258/similar-go-functions-appending-strings-and-arrays-do-not-behave-as-expected/33848513#33848513", "title": "Similar Go functions appending strings and arrays do not behave as expected", "body": "<p>While <code>str1+str2</code> does return new (unrelated in terms of memory) string, <code>append</code> doesn't behave this way. For example <code>append(str[0:i], str[i+1:]...)</code> will destroy original content of <code>str</code>, overwriting <code>str[i:]</code> with <code>str[i+1:]</code>. This is because <code>str[0:i]</code> will have capacity to append <code>str[i+1:]</code> without allocating new buffer.</p>\n\n<p>The solution would be to create a completely new array in every iteration. At least for <code>str</code>, as <code>append(prefix, str[i])</code> is immune to this problem. For example:</p>\n\n<pre><code>for i := 0; i &lt; n; i++ {\n    var s []int\n    s = append(s, str[0:i]...)\n    s = append(s, str[i+1:]...)\n    permutation(append(prefix, str[i]), s)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/lXwu39AA0V\" rel=\"nofollow\">https://play.golang.org/p/lXwu39AA0V</a></p>\n\n<p>More about slices and mechanism of append:</p>\n\n<p><a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">http://blog.golang.org/go-slices-usage-and-internals</a></p>\n\n<p><a href=\"https://blog.golang.org/slices\" rel=\"nofollow\">https://blog.golang.org/slices</a></p>\n"}], "owner": {"reputation": 2041, "user_id": 1333724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/acc5cea42dca926af89f94eb56fbbdbb?s=128&d=identicon&r=PG", "display_name": "maxm", "link": "https://stackoverflow.com/users/1333724/maxm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 33848513, "answer_count": 1, "score": 1, "last_activity_date": 1448139861, "creation_date": 1448137841, "question_id": 33848258, "link": "https://stackoverflow.com/questions/33848258/similar-go-functions-appending-strings-and-arrays-do-not-behave-as-expected", "title": "Similar Go functions appending strings and arrays do not behave as expected", "body": "<p>I have two Go functions:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>func permutation(prefix, str []int) {\n    n := len(str)\n    if n == 0 {\n        fmt.Println(prefix)\n    } else {\n        for i := 0; i &lt; n; i++ {\n            permutation(\n                append(prefix, str[i]),\n                append(str[0:i], str[i+1:]...),\n            )\n        }\n    }\n}\n\nfunc perms(prefix, str string) {\n    n := len(str)\n    if n == 0 {\n        fmt.Println(prefix)\n    } else {\n        for i := 0; i &lt; n; i++ {\n            perms(\n                prefix+string(str[i]),\n                string(str[0:i])+string(str[i+1:]),\n            )\n        }\n    }\n}\n</code></pre>\n\n<p>The first takes an array of ints, the second takes a string. They both then calculate all permutations of the array, or the string.</p>\n\n<p>I can run them like so:</p>\n\n<pre><code>permutation([]int{}, []int{1, 2, 3})\nperms(\"\", \"123\")\n</code></pre>\n\n<p>Their output is not the same:</p>\n\n<pre><code>$ go run main.go\n[1 2 3]\n[1 3 3]\n[3 3 3]\n[3 3 3]\n[3 3 3]\n[3 3 3]\n123\n132\n213\n231\n312\n321\n</code></pre>\n\n<p>I guess there is some nuance to appending arrays that I am missing. I can't seem to figure it out. Any idea what's going on?</p>\n"}, {"tags": ["heroku", "go", "godeps"], "comments": [{"owner": {"reputation": 231, "user_id": 465382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84498591c7335f4b515a26edca5a0b8?s=128&d=identicon&r=PG", "display_name": "Christian Niles", "link": "https://stackoverflow.com/users/465382/christian-niles"}, "edited": false, "score": 0, "creation_date": 1448132317, "post_id": 33847277, "comment_id": 55459157, "body": "I&#39;ve come across an issue in the Godep repo which exactly describes the issue I&#39;m having as well.  <a href=\"https://github.com/tools/godep/issues/306\" rel=\"nofollow noreferrer\">github.com/tools/godep/issues/306</a>"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1448154813, "post_id": 33847277, "comment_id": 55465608, "body": "You could also run <code>migrate</code> against your Heroku Postgres DB remotely from your dev machine."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1448173274, "creation_date": 1448173274, "answer_id": 33852243, "question_id": 33847277, "link": "https://stackoverflow.com/questions/33847277/how-do-i-build-utilities-with-my-go-web-app-on-heroku/33852243#33852243", "title": "How do I build utilities with my Go web app on Heroku?", "body": "<p>Just create a file where you include the executable path.</p>\n\n<p>See <a href=\"https://bitbucket.org/liamstask/goose/\" rel=\"nofollow\">this issue for Goose</a> (mattes/migrate competitor)</p>\n\n<p>I'd expect the equivalent for mattes/migrate would be:</p>\n\n<pre><code>package main\n\nimport _ \"github.com/mattes/migrate\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 231, "user_id": 465382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84498591c7335f4b515a26edca5a0b8?s=128&d=identicon&r=PG", "display_name": "Christian Niles", "link": "https://stackoverflow.com/users/465382/christian-niles"}, "is_accepted": false, "score": 0, "last_activity_date": 1448178354, "creation_date": 1448178354, "answer_id": 33852708, "question_id": 33847277, "link": "https://stackoverflow.com/questions/33847277/how-do-i-build-utilities-with-my-go-web-app-on-heroku/33852708#33852708", "title": "How do I build utilities with my Go web app on Heroku?", "body": "<p>Heroku's current recommended solution is to simply clone the command into your own repo (see github.com/tools/godep/issues/306).</p>\n\n<p>I copied the <code>mattes/migrate/main.go</code> into the <code>cmd/migrate</code> directory in my own project. This builds the command just like my own server command.</p>\n\n<p>It's not ideal, but it works.</p>\n"}], "owner": {"reputation": 231, "user_id": 465382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84498591c7335f4b515a26edca5a0b8?s=128&d=identicon&r=PG", "display_name": "Christian Niles", "link": "https://stackoverflow.com/users/465382/christian-niles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1448178354, "creation_date": 1448131996, "question_id": 33847277, "link": "https://stackoverflow.com/questions/33847277/how-do-i-build-utilities-with-my-go-web-app-on-heroku", "title": "How do I build utilities with my Go web app on Heroku?", "body": "<p>I've developed a web app using Go, which I've deployed to Heroku. I'm using <a href=\"https://github.com/mattes/migrate\" rel=\"nofollow\">mattes/migrate</a> to manage migrations. It works great locally, but the <code>migrate</code> command-line binary isn't available when I deploy to Heroku.</p>\n\n<p>The only binaries that are included are my own. Is there a way to have Godeps compile and install binaries provided by a dependency?</p>\n"}, {"tags": ["sql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 1, "creation_date": 1448133626, "post_id": 33847013, "comment_id": 55459589, "body": "Where are you seeing this sample code?"}, {"owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "reply_to_user": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1448226953, "post_id": 33847013, "comment_id": 55484944, "body": "Well most of the ORM is using it. All in their own way mainly Gorm"}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1448154700, "post_id": 33848172, "comment_id": 55465592, "body": "In addition, for many non-ORM libraries (e.g. <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">sqlx</a>), the struct tags are used to map column names to struct fields - e.g. <code>EmailAddress</code> in your source to <code>email_address</code> in your DB."}, {"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1515511542, "post_id": 33848172, "comment_id": 83322338, "body": "having issues with auto_increment unique id fields with gorm and default values. plain just dont work on insert of a row."}], "tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": true, "score": 8, "last_activity_date": 1448137279, "creation_date": 1448137279, "answer_id": 33848172, "question_id": 33847013, "link": "https://stackoverflow.com/questions/33847013/why-use-sql-tags-in-struct-in-some-go-libs-like-gorm/33848172#33848172", "title": "Why use sql tags in struct in some go libs like gorm?", "body": "<p>I think you are referring to an ORM library like <a href=\"https://github.com/jinzhu/gorm\">gorm</a></p>\n\n<p>In that case, metadata like <code>sql:\"primary_key\"</code> or <code>sql:\"index\"</code> will just tell the ORM to create an index while trying to setup the tables or maybe migrate them.</p>\n\n<p>A couple of examples in <a href=\"https://github.com/jinzhu/gorm\">gorm</a> could be: indexes, primary keys, foreign keys, many2many relations or when trying to adapt an exiting schema into your <a href=\"https://github.com/jinzhu/gorm\">gorm</a> models, setting the type explicitly, like for example: </p>\n\n<pre><code>type Address struct {\n    ID       int\n    Address1 string         `sql:\"not null;unique\"` // Set field as not nullable and unique\n    Address2 string         `sql:\"type:varchar(100);unique\"`\n    Post     sql.NullString `sql:\"not null\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8658, "favorite_count": 0, "accepted_answer_id": 33848172, "answer_count": 1, "score": 11, "last_activity_date": 1450342550, "creation_date": 1448130498, "last_edit_date": 1450342550, "question_id": 33847013, "link": "https://stackoverflow.com/questions/33847013/why-use-sql-tags-in-struct-in-some-go-libs-like-gorm", "title": "Why use sql tags in struct in some go libs like gorm?", "body": "<p>Well I know the necessity of tags in struct in golang and how is it accessed by reflect in golang. But I have searched and could not find a reliable answer to the question of why I should use sql tags in struct while writing struct for sql results. I have explored many sample code and people are using <code>sql:\"index\"</code> in the struct and <code>sql:\"primary_key\"</code> in the struct.</p>\n\n<p>Now I have done indexing in the database layer, isn\u2019t it enough? Should I have to use <code>sql:\"index\"</code> too get the best results? Like so I have defined primary key attribute in the database should I have to specify <code>sql:\"primary_key\"</code> as well?</p>\n\n<p>My code seems to work fine without those. Just want to know their benefit and usages.</p>\n"}, {"tags": ["ssh", "go", "scp"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448135064, "post_id": 33846959, "comment_id": 55460113, "body": "First, start by properly executing the scp command, either by passing it to a shell, or splitting the arguments yourself (can&#39;t remember which ssh does)"}, {"owner": {"reputation": 735, "user_id": 2162742, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b67fb1eacc7bda976b1856af6ffbec8?s=128&d=identicon&r=PG", "display_name": "arkhon", "link": "https://stackoverflow.com/users/2162742/arkhon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448211458, "post_id": 33846959, "comment_id": 55479326, "body": "Ok, i parsed the cmd string and the scp command will be executed with the given arguments. But i have no clue at all how the actual file is passed to scp. Is it in the r.Payload or will it be transmitted over the ssh.Channel? I can&#39;t even find the -t option in the scp man page."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448221693, "post_id": 33846959, "comment_id": 55483159, "body": "The command is in the payload, you already parsed that in your code. The files are transferred over the channel, and handled by the scp command you exec. (As for <code>-t</code>, the scp command isn&#39;t part of the ssh spec. The openssh scp source is probably the best resource for all options)"}, {"owner": {"reputation": 735, "user_id": 2162742, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b67fb1eacc7bda976b1856af6ffbec8?s=128&d=identicon&r=PG", "display_name": "arkhon", "link": "https://stackoverflow.com/users/2162742/arkhon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448231288, "post_id": 33846959, "comment_id": 55486469, "body": "Thanks for your help but I still struggle to solve the problem how to pass the file/dir from the ssh.Channel to the scp command i exec."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448234226, "post_id": 33846959, "comment_id": 55487385, "body": "You don&#39;t have a file or directory to pass to the scp command, that&#39;s sent from the client scp (scp technically has nothing to do with ssh, it just knows how to invoke ssh and use it as a pipe). All you need to do is connect the client&#39;s scp instance with the stdin and stdout of the exec&#39;ed command."}], "answers": [{"tags": [], "owner": {"reputation": 433, "user_id": 211150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d61f03f7a165e578efbd84f9acf7e9f?s=128&d=identicon&r=PG", "display_name": "icefex", "link": "https://stackoverflow.com/users/211150/icefex"}, "is_accepted": false, "score": 1, "last_activity_date": 1498405823, "last_edit_date": 1498405823, "creation_date": 1488540228, "answer_id": 42577604, "question_id": 33846959, "link": "https://stackoverflow.com/questions/33846959/golang-ssh-server-how-to-handle-file-transfer-with-scp/42577604#42577604", "title": "Golang SSH-Server: How to handle file transfer with scp?", "body": "<p>I just ran into the problem of executing scp and custom commands over my ssh server and as it is undocumented how to do this I pieced together some code from the tests in crypto.ssh (<a href=\"https://github.com/golang/crypto/blob/master/ssh/session.go\" rel=\"nofollow noreferrer\">https://github.com/golang/crypto/blob/master/ssh/session.go</a> and <a href=\"https://github.com/golang/crypto/blob/master/ssh/session_test.go\" rel=\"nofollow noreferrer\">https://github.com/golang/crypto/blob/master/ssh/session_test.go</a>) It works with OpenSSH and the crypto.ssh client. You can for instance call session.Run() on your client and handle e.g. scp or custom commands with it.</p>\n\n<pre><code>type exitStatusMsg struct {\n    Status uint32\n}\n\n// RFC 4254 Section 6.5.\ntype execMsg struct {\n    Command string\n}\n\ngo func(in &lt;-chan *ssh.Request, channel ssh.Channel) {\n        for req := range in {\n            if req.Type == \"exec\" {\n                var msg execMsg\n                if err := ssh.Unmarshal(req.Payload, &amp;msg); err != nil {\n                    log.Printf(\"error parsing ssh execMsg: %s\\n\", err)\n                    req.Reply(false, nil)\n                    return\n                }\n                go func(msg execMsg, ch ssh.Channel) {\n                    // ch can be used as a ReadWriteCloser if there should be interactivity\n                    runYourCommand(msg.Command, ch)\n                    ex := exitStatusMsg{\n                        Status: 0,\n                    }\n                    // return the status code\n                    if _, err := ch.SendRequest(\"exit-status\", false, ssh.Marshal(&amp;ex)); err != nil {\n                        log.Printf(\"unable to send status: %v\", err)\n                    }\n                    ch.Close()\n                }(msg, channel)\n                req.Reply(true, nil) // tell the other end that we can run the request\n            } else {\n                req.Reply(req.Type == \"shell\", nil)\n            }\n        }\n    }(requests, channel)\n</code></pre>\n\n<p>You need to replace runYourCommand with whatever function then executes your command and set the exit code to whatever your command/process returns.</p>\n"}], "owner": {"reputation": 735, "user_id": 2162742, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b67fb1eacc7bda976b1856af6ffbec8?s=128&d=identicon&r=PG", "display_name": "arkhon", "link": "https://stackoverflow.com/users/2162742/arkhon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3858, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1498405849, "creation_date": 1448130148, "last_edit_date": 1498405849, "question_id": 33846959, "link": "https://stackoverflow.com/questions/33846959/golang-ssh-server-how-to-handle-file-transfer-with-scp", "title": "Golang SSH-Server: How to handle file transfer with scp?", "body": "<p>I have written a small SSH-Server in golang with the crypto/ssh package.</p>\n\n<p>It supports returning an interactive shell and immediate command execution.</p>\n\n<p>Here is a minimal example of the server:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net\"\n    \"os/exec\"\n\n    \"golang.org/x/crypto/ssh\"\n)\n\nfunc main() {\n    c := &amp;ssh.ServerConfig{\n        PasswordCallback: func(c ssh.ConnMetadata, pass []byte) (*ssh.Permissions, error) {\n            if c.User() == \"foo\" &amp;&amp; string(pass) == \"bar\" {\n                return nil, nil\n            }\n            return nil, fmt.Errorf(\"password rejected for %q\", c.User())\n        },\n    }\n\n    keyBytes, _ := ioutil.ReadFile(\"key\")\n    key, _ := ssh.ParsePrivateKey(keyBytes)\n    c.AddHostKey(key)\n\n    listener, _ := net.Listen(\"tcp\", \"0.0.0.0:2200\")\n    for {\n        tcpConn, _ := listener.Accept()\n        _, chans, reqs, _ := ssh.NewServerConn(tcpConn, c)\n        go ssh.DiscardRequests(reqs)\n        go handleChannels(chans)\n    }\n}\n\nfunc handleChannels(chans &lt;-chan ssh.NewChannel) {\n    for newChannel := range chans {\n        go handleChannel(newChannel)\n    }\n}\n\nfunc handleChannel(newChannel ssh.NewChannel) {\n    channel, requests, _ := newChannel.Accept()\n    for req := range requests {\n        switch req.Type {\n        case \"shell\":\n            go handleShell(channel)\n        case \"exec\":\n            go handleExec(channel, req)\n        }\n    }\n}\n\nfunc handleShell(c ssh.Channel) {}\nfunc handleExec(c ssh.Channel, r *ssh.Request) {\n    cmdString, args, _ := parseCommand(r.Payload)\n    log.Printf(\"exec: %s\\n\", cmdString)\n    for i := range args {\n        log.Printf(\"arg %d: %s\\n\", i, args[i])\n    }\n    cmd := exec.Command(cmdString, args...)\n    cmd.Run()\n}\n\nfunc parseCommand(b []byte) (string, []string, error) {\n    cmdString := strings.TrimSpace(string(b))\n    cmdArray := strings.Split(cmdString, \" \")\n\n    cmd := strings.Trim(cmdArray[0], \" \")\n    args := cmdArray[1:]\n\n    return cmd, args, nil\n}\n</code></pre>\n\n<p>If I run the server and execute scp as follows:</p>\n\n<pre><code>scp -P 2200 test.file foo@localhost:~/\n</code></pre>\n\n<p>the handleExec function is called.</p>\n\n<p>The output of the cmdString shows:</p>\n\n<pre><code>2015/11/22 17:49:14 exec: scp\n2015/11/22 17:49:14 arg 0: -t\n2015/11/22 17:49:14 arg 1: ~/\n</code></pre>\n\n<p>But how can I implement the handleExec function to actually save the file/dir I passed via scp?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 3, "last_activity_date": 1448129391, "creation_date": 1448129391, "answer_id": 33846834, "question_id": 33846790, "link": "https://stackoverflow.com/questions/33846790/does-maxheaderbytes-really-works/33846834#33846834", "title": "Does MaxHeaderBytes really works?", "body": "<p>Yes, it does, but they add a bit of padding to whatever you specify. In <a href=\"https://golang.org/src/net/http/server.go#L548\" rel=\"nofollow\">the code</a> they add 4096 bytes to the limit for some reason.</p>\n"}], "owner": {"reputation": 502, "user_id": 4896540, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87995a686ab93aa90a57360c43ea00b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4896540/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 33846834, "answer_count": 1, "score": 5, "last_activity_date": 1448129391, "creation_date": 1448129106, "question_id": 33846790, "link": "https://stackoverflow.com/questions/33846790/does-maxheaderbytes-really-works", "title": "Does MaxHeaderBytes really works?", "body": "<pre><code>srv := &amp;http.Server{\n    Addr:           \"127.0.0.1:8080\",\n    Handler:        r,\n    MaxHeaderBytes: 1,\n}\nsrv.ListenAndServe()\n</code></pre>\n\n<p>I made several requests by curl with custom headers, and app serving it, without any errors. What I am doing wrong?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1448140835, "post_id": 33846652, "comment_id": 55461954, "body": "See <a href=\"http://stackoverflow.com/a/28263846/1643939\">stackoverflow.com/a/28263846/1643939</a>"}], "owner": {"reputation": 61, "user_id": 5580399, "user_type": "registered", "profile_image": "https://graph.facebook.com/918255471573213/picture?type=large", "display_name": "Alonso Vidales Migu&#233;lez", "link": "https://stackoverflow.com/users/5580399/alonso-vidales-migu%c3%a9lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1448128357, "creation_date": 1448128357, "question_id": 33846652, "link": "https://stackoverflow.com/questions/33846652/best-way-to-deal-with-namespaces-on-cgo", "title": "Best way to deal with namespaces on cgo", "body": "<p>I\u2019m working on a project that makes usage of some C++ libraries, this libraries use namespaces like:</p>\n\n<pre><code>namespace ns {\n    void hello();\n}\n</code></pre>\n\n<p>All compiles, and I can use the functions out of namespaces, but I can\u2019t find docu about how to work with namespaces in order to access to this method from Go.\n    My first idea was to use a small wrapper using the cgo comments like:\n    package stuff</p>\n\n<pre><code>// #import &lt;some_libs.h&gt;\n/*\nvoid hello() {\n    ns::hello();\n}\n*/\nimport \u201cC\u201d\n</code></pre>\n\n<p>But this fails with an:</p>\n\n<blockquote>\n  <p>error: expected expression before \u2018:'</p>\n</blockquote>\n\n<p>another option is to prepare the wrapper out of the .go file, but this is going to make a bit more complicated the installation, etc of the libraries.\n    What is the best approach?, can I just call to this method using the C lib? something like: C.ns.hello()??</p>\n\n<p>Thanks!,</p>\n"}, {"tags": ["json", "encoding", "go"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4182012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38e07b53b07ff536385386b366e048a?s=128&d=identicon&r=PG&f=1", "display_name": "eax_rabb1t", "link": "https://stackoverflow.com/users/4182012/eax-rabb1t"}, "edited": false, "score": 0, "creation_date": 1448130221, "post_id": 33846773, "comment_id": 55458465, "body": "Thats helpful, thanks! and just one more thing, what would i have to do if json was like this [ { samejson here } ] ? Thanks again!"}, {"owner": {"reputation": 27, "user_id": 4182012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38e07b53b07ff536385386b366e048a?s=128&d=identicon&r=PG&f=1", "display_name": "eax_rabb1t", "link": "https://stackoverflow.com/users/4182012/eax-rabb1t"}, "edited": false, "score": 0, "creation_date": 1448130609, "post_id": 33846773, "comment_id": 55458596, "body": "I have updated the code on play golang with the actual question regarding my last comment, here&#39;s  link <a href=\"http://play.golang.org/p/cpYsnXa-b9\" rel=\"nofollow noreferrer\">play.golang.org/p/cpYsnXa-b9</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 27, "user_id": 4182012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38e07b53b07ff536385386b366e048a?s=128&d=identicon&r=PG&f=1", "display_name": "eax_rabb1t", "link": "https://stackoverflow.com/users/4182012/eax-rabb1t"}, "edited": false, "score": 1, "creation_date": 1448131985, "post_id": 33846773, "comment_id": 55459061, "body": "Your example on the playground is not valid JSON as the error message indicates. Not sure what&#39;s intended."}, {"owner": {"reputation": 27, "user_id": 4182012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38e07b53b07ff536385386b366e048a?s=128&d=identicon&r=PG&f=1", "display_name": "eax_rabb1t", "link": "https://stackoverflow.com/users/4182012/eax-rabb1t"}, "edited": false, "score": 0, "creation_date": 1448132800, "post_id": 33846773, "comment_id": 55459315, "body": "It is a valid json, and i found a solution using <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">mholt.github.io/json-to-go</a>. Thanks for answers anyway!"}, {"owner": {"reputation": 1344, "user_id": 1608670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b2ed05ecccc3ba0780dd388ae719cd?s=128&d=identicon&r=PG", "display_name": "Ivan Chau", "link": "https://stackoverflow.com/users/1608670/ivan-chau"}, "edited": false, "score": 0, "creation_date": 1448164010, "post_id": 33846773, "comment_id": 55467082, "body": "Use <a href=\"http://jsonlint.com\" rel=\"nofollow noreferrer\">jsonlint.com</a> to ensure the JSON is valid."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1448129015, "creation_date": 1448129015, "answer_id": 33846773, "question_id": 33846393, "link": "https://stackoverflow.com/questions/33846393/golang-json-parsing/33846773#33846773", "title": "Golang json parsing", "body": "<p><a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">Export</a> the field names by starting them with an uppercase letter:</p>\n\n<pre><code>type DisassembleOutput struct {\n  Offset, Fcn_addr, Fcn_last, Size int\n  Opcode, Bytes                    string\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/9qMfGGnFS_\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 27, "user_id": 4182012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38e07b53b07ff536385386b366e048a?s=128&d=identicon&r=PG&f=1", "display_name": "eax_rabb1t", "link": "https://stackoverflow.com/users/4182012/eax-rabb1t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "closed_date": 1448129092, "answer_count": 1, "score": -1, "last_activity_date": 1448131408, "creation_date": 1448126821, "last_edit_date": 1448131408, "question_id": 33846393, "link": "https://stackoverflow.com/questions/33846393/golang-json-parsing", "closed_reason": "Duplicate", "title": "Golang json parsing", "body": "<p>I have a json string like this:</p>\n\n<pre><code>    {\n\"offset\":4224368,\n\"fcn_addr\":4224368,\n\"fcn_last\":4224408,\n\"size\":2,\n\"opcode\":\"add byte [rax], al\",\n\"bytes\":\"0000\",\n\"type\":\"add\",\n\"type_num\":17,\n\"type2_num\":0,\n\"flags\":[\n\"entry0\",\n\"sym._start\",\n\"section_end..plt\",\n\"section..text\"\n],\n\"comment\":\"WzEzXSB2YT0weDAwNDA3NTcwIHBhPTB4MDAwMDc1NzAgc3o9MTA5OTE4NiB2c3o9MTA5OTE4NiByd3g9LXIteCAudGV4dA==\"\n},\n{\n\"offset\":4224370,\n\"fcn_addr\":4224368,\n\"fcn_last\":4224408,\n\"size\":2,\n\"opcode\":\"add byte [rax], al\",\n\"bytes\":\"0000\",\n\"type\":\"add\",\n\"type_num\":17,\n\"type2_num\":0\n}}\n</code></pre>\n\n<p>and i have created a struct </p>\n\n<pre><code>type DisassembleOutput struct {\n    offset, fcn_addr, fcn_last, size int\n    opcode, bytes string\n}\n</code></pre>\n\n<p>i just want to save this json into the struct like this one.\nSo the problem is in unmarshaling with encoding/json lib, i can't get it to work ( <strong>error is always unable to unmarshal json data into main.Disas structure</strong>).\nI'm a golang newbie btw.\n<br><br>\n<strong>EDIT:</strong></p>\n\n<p>This is actually the problem <a href=\"http://play.golang.org/p/cpYsnXa-b9\" rel=\"nofollow\">http://play.golang.org/p/cpYsnXa-b9</a>. \nhow to parse one by one items fromm [{ ... }]</p>\n"}, {"tags": ["go", "one-to-many", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 684412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/325c985d5d810fb7457195f6cea521e9?s=128&d=identicon&r=PG", "display_name": "Nithin Meppurathu", "link": "https://stackoverflow.com/users/684412/nithin-meppurathu"}, "is_accepted": false, "score": 0, "last_activity_date": 1455393083, "creation_date": 1455393083, "answer_id": 35384606, "question_id": 33845949, "link": "https://stackoverflow.com/questions/33845949/has-many-relation-giving-empty-result/35384606#35384606", "title": "&quot;Has many&quot; relation giving empty result", "body": "<p>use gorm built in model gorm.Model so that your not messing up the \"ID\" constant</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5060245, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F21O5z3nONk/AAAAAAAAAAI/AAAAAAAAAEY/PtcUhxteKf8/photo.jpg?sz=128", "display_name": "Prince Khanna", "link": "https://stackoverflow.com/users/5060245/prince-khanna"}, "is_accepted": false, "score": 0, "last_activity_date": 1595305036, "last_edit_date": 1595305036, "creation_date": 1555681070, "answer_id": 55762754, "question_id": 33845949, "link": "https://stackoverflow.com/questions/33845949/has-many-relation-giving-empty-result/55762754#55762754", "title": "&quot;Has many&quot; relation giving empty result", "body": "<p>The solution to your problem is very simple.</p>\n<p>Rather than querying</p>\n<pre><code>var user models.User\nvar activities models.UserActivity\nquery := DB.Debug().Find(&amp;user, 1).Model(&amp;user).Related(&amp;activities).Error\n</code></pre>\n<p>just query</p>\n<pre><code>var user models.User\nquery := DB.Debug().Find(&amp;user, 1).Model(&amp;user).Related(&amp;user.UserActivities).Error\n</code></pre>\n"}], "owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1377, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1595305036, "creation_date": 1448124442, "last_edit_date": 1554731717, "question_id": 33845949, "link": "https://stackoverflow.com/questions/33845949/has-many-relation-giving-empty-result", "title": "&quot;Has many&quot; relation giving empty result", "body": "<p>I am trying to define one to many relation with gorm ORM . I have read all the docs over and over again . Could not find a way to do it.</p>\n\n<pre><code>func GetUser1(c *gin.Context) {\n    var user models.User\n    var activities models.UserActivity\n    query := DB.Debug().Find(&amp;user, 1).Model(&amp;user).Related(&amp;activities).Error\n    if query != nil {\n        panic(query)\n    }\n    c.JSON(200, &amp;user)\n}\n</code></pre>\n\n<p>My Models are ..</p>\n\n<pre><code>type User struct {\n    Id       int64\n    Username string\n    Password string `json:\"-\"`\n    Email    string `json:\",omitempty\"`\n    UserActivities []UserActivity\n}\ntype UserActivity struct {\n    Id         int64\n    UserId     int64 `json:\"-\"`\n    ActorId    int64\n    CreatedAt  time.Time\n}\n</code></pre>\n\n<p>Debug Results are </p>\n\n<pre><code>[2015-11-21 22:21:54]  [3.17ms]  SELECT  * FROM `users`  WHERE (`id` = '1')\n[2015-11-21 22:21:54]  [1.39ms]  SELECT  * FROM `user_activities`  WHERE (`user_id` = '1')\n</code></pre>\n\n<p>But I am getting null results</p>\n\n<pre><code>{\n    \"Id\": 1,\n    \"Username\": \"test1\",\n    \"Email\": \"test1@friesen.com\",\n    \"UserActivities\": null\n}\n</code></pre>\n\n<p>All the primary keys and Indexes are right . I have also tried puttin <code>gorm:\"primary_key\"</code> and <code>sql:\"index\"</code> in <code>UserActivities</code> no luck so far .\n However if I replace <code>UserActivities []UserActivity</code> with <code>UserActivities UserActivity</code> then i get only one row which seems to be right but why <code>UserActivities []UserActivity</code> giving no results </p>\n"}, {"tags": ["http", "go", "download"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448135808, "post_id": 33845770, "comment_id": 55460395, "body": "also see <a href=\"http://stackoverflow.com/questions/11692860/how-can-i-efficiently-download-a-large-file-using-go\" title=\"how can i efficiently download a large file using go\">stackoverflow.com/questions/11692860/&hellip;</a>"}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448264462, "post_id": 33845770, "comment_id": 55495511, "body": "Please provide me with some constructive comment as to how I can fix the problems that made you down vote this post."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448287316, "post_id": 33845770, "comment_id": 55509257, "body": "This is a low quality question, in that it&#39;s simply asking for code to do something that would take little effort to look up in the documentation. But, since you posted it with the intent of providing the code yourself, I&#39;ll give you an up vote for effort ;)"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1448135669, "post_id": 33845771, "comment_id": 55460331, "body": "<code>log.Fatal</code> calls <code>os.Exit</code>, so the panics do nothing (plus, you generally shouldn&#39;t panic over basic errors). You&#39;re not closing the response body (please read the <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">http package docs</a>), which will leak connections. There&#39;s no reason to buffer the entire file in memory, you can copy the download directly to an open file."}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448187079, "post_id": 33845771, "comment_id": 55471535, "body": "Thanks for the update. I will check it out. I&#39;m quite new to go. For me there is no reason not to download the whole file as I know the file size. I will fix the leak and the logs though. Please up vote if your happy with the new result."}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448187811, "post_id": 33845771, "comment_id": 55471711, "body": "If you want to point me in the right direction with the buffering issue I would be happy. @JimB"}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448188625, "post_id": 33845771, "comment_id": 55471919, "body": "I fixed the issues. Thanks! :D"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1448237271, "post_id": 33845771, "comment_id": 55488167, "body": "don&#39;t defer before checking your errors, since the value you have may not be valid and can panic."}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448263606, "post_id": 33845771, "comment_id": 55495118, "body": "Thanks! What will happen if a panic is triggered? Don&#39;t I want the defers to run then?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448286784, "post_id": 33845771, "comment_id": 55508919, "body": "@PabloKarlsson: You don&#39;t want the defer to run if the result was nil, because that&#39;s where it&#39;s going to panic. A panic is usually a mistake in your code, you shouldn&#39;t see them at all."}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448286985, "post_id": 33845771, "comment_id": 55509044, "body": "@JimB But you agree with the current version or do you think there are still some flaws?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448287141, "post_id": 33845771, "comment_id": 55509148, "body": "This latest version OK."}], "tags": [], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "is_accepted": true, "score": 7, "last_activity_date": 1448263878, "last_edit_date": 1448263878, "creation_date": 1448123289, "answer_id": 33845771, "question_id": 33845770, "link": "https://stackoverflow.com/questions/33845770/how-do-i-download-a-file-with-a-http-request-in-go-language/33845771#33845771", "title": "How do I download a file with a http request in go language", "body": "<p>After some research I came up with this.</p>\n\n<pre><code>import (\n    \"os\"\n    \"net/http\"\n    \"io\"\n)\n\nfunc downloadFile(filepath string, url string) (err error) {\n\n  // Create the file\n  out, err := os.Create(filepath)\n  if err != nil  {\n    return err\n  }\n  defer out.Close()\n\n  // Get the data\n  resp, err := http.Get(url)\n  if err != nil {\n    return err\n  }\n  defer resp.Body.Close()\n\n  // Writer the body to file\n  _, err = io.Copy(out, resp.Body)\n  if err != nil  {\n    return err\n  }\n\n  return nil\n}\n</code></pre>\n\n<p>It works well but might need a bit of refinement for use in production.</p>\n"}], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8820, "favorite_count": 1, "accepted_answer_id": 33845771, "answer_count": 1, "score": 2, "last_activity_date": 1448264214, "creation_date": 1448123289, "last_edit_date": 1448264214, "question_id": 33845770, "link": "https://stackoverflow.com/questions/33845770/how-do-i-download-a-file-with-a-http-request-in-go-language", "title": "How do I download a file with a http request in go language", "body": "<p>I want to download a file from an url in go lang using the go http package and save the image to disk for later display on my webpage. How do I do this?</p>\n\n<p>I need to do this because I want to download images from instagram and save them to my public folder for display on my webpage.</p>\n\n<p>I created an answer below for others to use the code I came up with.</p>\n"}, {"tags": ["go", "build"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 6, "creation_date": 1448118547, "post_id": 33844849, "comment_id": 55454161, "body": "<code>go run</code> takes an explicit list of files to compile; it does not check the filename for any potential build constrains. You will notice that running <code>go build</code> on your package will work without error."}, {"owner": {"reputation": 1950, "user_id": 1405130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/irv7D.jpg?s=128&g=1", "display_name": "Paradiesstaub", "link": "https://stackoverflow.com/users/1405130/paradiesstaub"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1448119085, "post_id": 33844849, "comment_id": 55454396, "body": "But it will work with the windows file too... I noticed that when moving <code>hello</code> to another package, everything works as expected."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1448119138, "post_id": 33844849, "comment_id": 55454420, "body": "<code>go run</code> is a convenience tool for a file or two. Use <code>go install</code> or <code>go build</code>."}, {"owner": {"reputation": 1950, "user_id": 1405130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/irv7D.jpg?s=128&g=1", "display_name": "Paradiesstaub", "link": "https://stackoverflow.com/users/1405130/paradiesstaub"}, "edited": false, "score": 1, "creation_date": 1448119277, "post_id": 33844849, "comment_id": 55454484, "body": "Now I understand, thanks. Please add an answer so that I can mark the question as resolved."}], "owner": {"reputation": 1950, "user_id": 1405130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/irv7D.jpg?s=128&g=1", "display_name": "Paradiesstaub", "link": "https://stackoverflow.com/users/1405130/paradiesstaub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448118214, "creation_date": 1448118214, "question_id": 33844849, "link": "https://stackoverflow.com/questions/33844849/conditional-compilation-not-working", "title": "Conditional Compilation not working", "body": "<p>OS: linux/amd64<br>\nGO: 1.5.1</p>\n\n<p>When running (<code>go run *.go</code>) the below code I get the following error and I don't understand what I'm doing wrong. I've read the <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow\">official doc</a> about build constrains. Shouldn't <code>foo_windows.go</code> be ignored?</p>\n\n<pre><code># command-line-arguments\n./foo_windows.go:3: hello redeclared in this block\n        previous declaration at ./foo_linux.go:3\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(hello())\n}\n</code></pre>\n\n<p><strong>foo_linux.go</strong></p>\n\n<pre><code>package main\n\nfunc hello() string {\n    return \"hello form linux\"\n}\n</code></pre>\n\n<p><strong>foo_windows.go</strong></p>\n\n<pre><code>package main\n\nfunc hello() string {\n    return \"hello form windows\"\n}\n</code></pre>\n"}, {"tags": ["go", "instagram", "instagram-api"], "comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1448117825, "post_id": 33844707, "comment_id": 55453910, "body": "<code>RecentMedia()</code> returns an error as its last value; you&#39;re throwing that error away. What is the error?"}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1448118138, "post_id": 33844707, "comment_id": 55454001, "body": "I am going to check that. sorry for not checking Immediately."}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1448118226, "post_id": 33844707, "comment_id": 55454036, "body": "I have now checked and there is no error returned. Just nil."}], "answers": [{"comments": [{"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1448118299, "post_id": 33844840, "comment_id": 55454067, "body": "Thank you that should be easily fixed then. Do you want to do the pull req or should I?"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1448118398, "post_id": 33844840, "comment_id": 55454101, "body": "Go right ahead. I don&#39;t use this library and can&#39;t test the results. Personally I would remove this function entirely. Don&#39;t check &quot;do I think Instagram will accept this.&quot; Just ask Instagram. If it won&#39;t accept it, you&#39;ll get an error."}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1448118449, "post_id": 33844840, "comment_id": 55454126, "body": "I agree. Or if you check at least provide the default option of not checking."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 1, "last_activity_date": 1448118174, "creation_date": 1448118174, "answer_id": 33844840, "question_id": 33844707, "link": "https://stackoverflow.com/questions/33844707/scandinavian-characters-not-working-in-go-lang-go-instagram-api-bindings/33844840#33844840", "title": "Scandinavian characters not working in go-lang go-instagram API bindings", "body": "<p>The problem is in <a href=\"https://github.com/carbocation/go-instagram/blob/master/instagram/tags.go#L130-L143\" rel=\"nofollow\"><code>validTagName()</code></a>:</p>\n\n<pre><code>// Strip out things we know Instagram won't accept. For example, hyphens.\nfunc validTagName(tagName string) (bool, error) {\n    //\\W matches any non-word character\n    reg, err := regexp.Compile(`\\W`)\n    if err != nil {\n        return false, err\n    }\n\n    if reg.MatchString(tagName) {\n        return false, nil\n    }\n\n    return true, nil\n}\n</code></pre>\n\n<p>In Go, <a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow\"><code>\\W</code> matches precisely <code>[^0-9A-Za-z_]</code></a>. This validation check is incorrect.</p>\n"}], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 33844840, "answer_count": 1, "score": 0, "last_activity_date": 1448118174, "creation_date": 1448117501, "question_id": 33844707, "link": "https://stackoverflow.com/questions/33844707/scandinavian-characters-not-working-in-go-lang-go-instagram-api-bindings", "title": "Scandinavian characters not working in go-lang go-instagram API bindings", "body": "<p>Hi I'm trying to wrap my head around what seems to be a problem with multibyte support in this open source library (<a href=\"https://github.com/carbocation/go-instagram/\" rel=\"nofollow\">https://github.com/carbocation/go-instagram/</a>). I am using the code below to retrieve information about the tag blue in swedish. How ever I get an empty array when trying.</p>\n\n<pre><code>fmt.Println(\"Starting instagram download.\")\nclient := instagram.NewClient(nil)\nclient.ClientID = \"myid\"\nmedia, _, _ := client.Tags.RecentMedia(\"bl\u00e5\", nil)\nfmt.Println(media)\n</code></pre>\n\n<p>I have tried using the api trough the browser and there are several pictures tagged with the tag. I have also tried using the code snippet with tags in English like blue and that returns the latest pictures as well. I would be glad if any one could explain why this might happen. Id like to update the lib so it supports multi-byte but I haven't got the go knowledge required. Is this a go problem or a problem with the library? </p>\n\n<p>Thank you</p>\n"}, {"tags": ["pointers", "go", "reflection", "interface"], "comments": [{"owner": {"reputation": 473, "user_id": 279890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c814f355aec49a73a7c3bbcc3b0eb27?s=128&d=identicon&r=PG", "display_name": "Yannick", "link": "https://stackoverflow.com/users/279890/yannick"}, "edited": false, "score": 0, "creation_date": 1448098457, "post_id": 33841630, "comment_id": 55448241, "body": "But why? Can you not use a boolean."}, {"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "reply_to_user": {"reputation": 473, "user_id": 279890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c814f355aec49a73a7c3bbcc3b0eb27?s=128&d=identicon&r=PG", "display_name": "Yannick", "link": "https://stackoverflow.com/users/279890/yannick"}, "edited": false, "score": 0, "creation_date": 1448100379, "post_id": 33841630, "comment_id": 55448708, "body": "@yene: I like to keep my interface design cleaner."}, {"owner": {"reputation": 14981, "user_id": 2679935, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wU0qy.jpg?s=128&g=1", "display_name": "julienc", "link": "https://stackoverflow.com/users/2679935/julienc"}, "edited": false, "score": 0, "creation_date": 1448103335, "post_id": 33841630, "comment_id": 55449501, "body": "I don&#39;t see how it could be done without returning <code>nil</code> directly from the function. Just think about <code>setNil(3)</code> for instance."}], "answers": [{"comments": [{"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 0, "creation_date": 1448120456, "post_id": 33842865, "comment_id": 55454907, "body": "Thanks icza , but I want avoid my client to know about <code>unsafe.Pointer</code> , and I don&#39;t want my client pass the type as <code>*interface{}</code>. so could you make this work ?=&gt; <a href=\"http://play.golang.org/p/KhR4-BHMPW\" rel=\"nofollow noreferrer\">play.golang.org/p/KhR4-BHMPW</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 1, "creation_date": 1448120596, "post_id": 33842865, "comment_id": 55454959, "body": "@Mohsen See edited answer. I added a 3rd way, using only reflection  inside the function. You have to pass the address of the variable, you can&#39;t avoid that, but this one does not use <code>unsafe.Pointer</code>."}, {"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 0, "creation_date": 1448122116, "post_id": 33842865, "comment_id": 55455549, "body": ":Thx very much icza, but I have to , take a look : <a href=\"http://play.golang.org/p/aPslX_vgiJ\" rel=\"nofollow noreferrer\">play.golang.org/p/aPslX_vgiJ</a> (why doesn&#39;t go have generic!) :-)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 7, "last_activity_date": 1476110393, "last_edit_date": 1476110393, "creation_date": 1448105891, "answer_id": 33842865, "question_id": 33841630, "link": "https://stackoverflow.com/questions/33841630/set-an-interface-to-nil-in-golang/33842865#33842865", "title": "Set an interface to nil in Golang", "body": "<p>The thing is you don't have an interface value. You have a pointer value, a pointer to a concrete type. That is not the same as an interface value.</p>\n\n<p>If you want to change the value of a variable of any type, you have to pass a pointer to it. This also includes variables of interface type, and also variables of pointer type. This is one of those very rare cases when a pointer to <code>interface{}</code> makes sense (<code>*interface{}</code>), in fact it's inevitable.</p>\n\n<p>But if your function expects an interface and you pass a non-interface value, an interface value will be created implicitly and you could only <code>nil</code> this implicitly created value.</p>\n\n<p>So we have 2 different / distinct cases:</p>\n\n<h3>Function to <code>nil</code> an <code>interface{}</code></h3>\n\n<pre><code>func setNilIf(v *interface{}) {\n    *v = nil\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>var i interface{} = \"Bob\"\nfmt.Printf(\"Before: %v\\n\", i)\nsetNilIf(&amp;i)\nfmt.Printf(\"After: %v\\n\", i)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Before: Bob\nAfter: &lt;nil&gt;\n</code></pre>\n\n<p>So it works.</p>\n\n<h3>Function to <code>nil</code> a pointer; using <code>unsafe</code></h3>\n\n<p>Actually this is your case. We want to change the value of a variable of pointer type. To accept a pointer to any type, we can use <a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow\"><code>unsafe.Pointer</code></a>. <code>unsafe.Pointer</code> is a <a href=\"https://golang.org/ref/spec#Package_unsafe\" rel=\"nofollow\">language support</a>, it's a special pointer type which can be converted from and to any pointer type.</p>\n\n<p>We want to accept the address (pointer) of the pointer variable, which is something like <code>**SomeType</code>. To actually be able to assign a new value (<code>nil</code>) to the pointer variable, we have to dereference it (<code>*</code> operator). But <code>unsafe.Pointer</code> cannot be dereferenced, so first we have to convert it to a pointer to pointer to \"something\", but since we only want to assign <code>nil</code> (which is the same to all pointer types regardless of the type of the pointed value), the \"something\" doesn't matter, I will just use <code>int</code>, and so I will convert the <code>unsafe.Pointer</code> pointer value to <code>**int</code>.</p>\n\n<pre><code>func setNilPtr(p unsafe.Pointer) {\n    *(**int)(p) = nil\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>typ := &amp;TYP{InternalState: \"filled\"}\nfmt.Printf(\"Before: %v\\n\", typ)\nsetNilPtr(unsafe.Pointer(&amp;typ))\nfmt.Printf(\"After: %v\\n\", typ)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Before: &amp;{filled}\nAfter: &lt;nil&gt;\n</code></pre>\n\n<p>So this one also works. There is still another way using reflection:</p>\n\n<h3>Function to <code>nil</code> a pointer; using <code>reflect</code></h3>\n\n<p>You can also <code>nil</code> a pointer using reflection only (<a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow\"><code>reflect</code></a> package). We still have to pass the address of the variable of pointer type. Note that in this case the type of the parameter will simply be <code>interface{}</code>. And it will contain a dynamic type like <code>**SomeType</code>. Since pointers have zero value <code>nil</code>, we can obtain such a value with <a href=\"https://golang.org/pkg/reflect/#Zero\" rel=\"nofollow\"><code>reflect.Zero()</code></a> which we will set using <a href=\"https://golang.org/pkg/reflect/#Value.Set\" rel=\"nofollow\"><code>Value.Set()</code></a>:</p>\n\n<pre><code>func setNilPtr2(i interface{}) {\n    v := reflect.ValueOf(i)\n    v.Elem().Set(reflect.Zero(v.Elem().Type()))\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>typ2 := &amp;TYP{InternalState: \"filled\"}\nfmt.Printf(\"Before: %v\\n\", typ2)\nsetNilPtr2(&amp;typ2)\nfmt.Printf(\"After: %v\\n\", typ2)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Before: &amp;{filled}\nAfter: &lt;nil&gt;\n</code></pre>\n\n<p>So this one also works. Try these on the <a href=\"http://play.golang.org/p/20soSdSoQR\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<hr>\n\n<p>But seriously: if you want to <code>nil</code> something, assign <code>nil</code> to it. Do not complicate things unnecessarily.</p>\n\n<pre><code>i = nil\ntyp = nil\n</code></pre>\n"}], "owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12313, "favorite_count": 3, "answer_count": 1, "score": 5, "last_activity_date": 1539326031, "creation_date": 1448096879, "last_edit_date": 1539326031, "question_id": 33841630, "link": "https://stackoverflow.com/questions/33841630/set-an-interface-to-nil-in-golang", "title": "Set an interface to nil in Golang", "body": "<p>I'm trying to set an internal value of an interface to <code>nil</code> something like the following :</p>\n\n<pre><code>typ := &amp;TYP{InternalState: \"filled\"}\nsetNil(typ)\n\nfmt.Printf(\"Expecting that %v to be nil\", typ)\n</code></pre>\n\n<p>And I need to know how to implement the <code>setNil(typ interface{})</code> method.</p>\n\n<p>For more details <a href=\"http://play.golang.org/p/W-0yw1NrD9\" rel=\"nofollow noreferrer\">see this code in play.golang.org</a>.</p>\n"}, {"tags": ["go", "synchronization", "goroutine"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1448109168, "post_id": 33841585, "comment_id": 55451117, "body": "I&#39;m assuming you are talking about the second check of <code>awake</code> (the one done in a loop). The first one is obviously here to check that <code>c.Wait()</code> did wait for broadcast"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1448109775, "post_id": 33841585, "comment_id": 55451312, "body": "Here is the codereview discussion for the commit introducing this code: <a href=\"https://codereview.appspot.com/3775048\" rel=\"nofollow noreferrer\">codereview.appspot.com/3775048</a>"}, {"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1448120297, "post_id": 33841585, "comment_id": 55454852, "body": "@HectorJ why does the code need to check if c.Wait() did wait for the broadcast? Is it not the intention of C.Wait to wait for the broadcast?"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1448123620, "post_id": 33841585, "comment_id": 55456068, "body": "It is the intention, and so it needs to be tested."}, {"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1448124159, "post_id": 33841585, "comment_id": 55456281, "body": "@HectorJ got it, I have rephrased my question."}], "answers": [{"comments": [{"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "edited": false, "score": 0, "creation_date": 1448164675, "post_id": 33846457, "comment_id": 55467179, "body": "thank you, in the code the &quot;start&quot; function waits for all the &quot;n&quot; go-routines to start executing before it broadcasts. So the scenario where a go routine starts its execution and the signal has already been broadcast, does not occur? Potentially the test for p.done is required in other cases where this is not true?"}, {"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "edited": false, "score": 0, "creation_date": 1448164891, "post_id": 33846457, "comment_id": 55467221, "body": "also does Wait and Broadcast require the caller to lock to unlock, only to enable manipulation of condition variable (p.done - in case above), or are there any other reasons?"}], "tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": true, "score": 0, "last_activity_date": 1448127857, "last_edit_date": 1448127857, "creation_date": 1448127237, "answer_id": 33846457, "question_id": 33841585, "link": "https://stackoverflow.com/questions/33841585/sync-cond-test-broadcast-why-check-in-a-loop/33846457#33846457", "title": "sync.Cond Test Broadcast - why check in a loop?", "body": "<p>Condition variables doesn't stay signaled, they only wake up other go routines that are blocking in .Wait(). So this presents a race condition unless you have a predicate where you check if you even need to wait, or if the thing you want to wait for has already happened.</p>\n\n<p>In your particular case, you have added synchronization between the go routines calling <code>.Wait()</code> and the one calling <code>.BroadCast()</code> by using your <code>p.started</code> channel, in a manner that as far as I can tell should not present the race condition I'm describing further on in this post. Though I wouldn't bet on it, and personally I would just do it the idiomatic way like the documentation describes.</p>\n\n<p>Consider your <code>start()</code> function is executing the broadcast in these  lines:</p>\n\n<pre><code>p.c.L.Lock()\np.c.Broadcast()\n</code></pre>\n\n<p>At that specific point in time consider that one of your other go routines have come to this point in your <code>process()</code> function</p>\n\n<pre><code>fmt.Printf(\"fork : %d\\n\", f)\n</code></pre>\n\n<p>The next thing that go routine will do is lock the mutex (which it isn't going to own at least until the go routine in <code>start()</code> releases that mutex) and wait on the condition variable.</p>\n\n<pre><code>p.c.L.Lock()\np.started &lt;- f\np.c.Wait()\n</code></pre>\n\n<p>But Wait is never going to return, since at this point there's noone that will signal/broadcast it - the signal has already happened.</p>\n\n<p>So you need another condition that you can test yourself so you don't need to call Wait() when you already know the condition has happened, e.g.</p>\n\n<pre><code>type processor struct {\n    n       int\n    c       *sync.Cond\n    started chan int\n    done    bool //added\n}\n\n...\n\nfunc (p *processor) start() {\n\n    for i := 0; i &lt; p.n; i++ {\n        go p.process(i)\n    }\n\n    for i := 0; i &lt; p.n; i++ {\n        &lt;-p.started\n    }\n    p.c.L.Lock()\n    p.done = true //added\n    p.c.Broadcast()\n    p.c.L.Unlock()\n\n}\n\nfunc (p *processor) process(f int) {\n\n    fmt.Printf(\"fork : %d\\n\", f)\n\n    p.c.L.Lock()\n    p.started &lt;- f\n    for !p.done { //added\n        p.c.Wait()\n    }\n    p.c.L.Unlock()\n    fmt.Printf(\"process: %d - out of wait\\n\", f)\n}\n</code></pre>\n"}], "owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "accepted_answer_id": 33846457, "answer_count": 1, "score": 1, "last_activity_date": 1448127857, "creation_date": 1448096567, "last_edit_date": 1448125840, "question_id": 33841585, "link": "https://stackoverflow.com/questions/33841585/sync-cond-test-broadcast-why-check-in-a-loop", "title": "sync.Cond Test Broadcast - why check in a loop?", "body": "<p>I was trying to use sync.Cond - Wait and Broadcast. I could not understand some parts of it:</p>\n\n<p>The comment for Wait calls says: </p>\n\n<pre><code>   41    // Because c.L is not locked when Wait first resumes, the caller\n   42    // typically cannot assume that the condition is true when\n   43    // Wait returns.  Instead, the caller should Wait in a loop:\n   44    //\n   45    //    c.L.Lock()\n   46    //    for !condition() {\n   47    //        c.Wait()\n   48    //    }\n   49    //    ... make use of condition ...\n   50    //    c.L.Unlock()\n</code></pre>\n\n<p>What is the reason this is required?</p>\n\n<p>So this means the following program may not be correct (all though it works):</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"sync\"\n)\n\ntype processor struct {\n    n       int\n    c       *sync.Cond\n    started chan int\n}\n\nfunc newProcessor(n int) *processor {\n\n    p := new(processor)\n    p.n = n\n\n    p.c = sync.NewCond(&amp;sync.Mutex{})\n\n    p.started = make(chan int, n)\n\n    return p\n}\n\nfunc (p *processor) start() {\n\n    for i := 0; i &lt; p.n; i++ {\n        go p.process(i)\n    }\n\n    for i := 0; i &lt; p.n; i++ {\n        &lt;-p.started\n    }\n    p.c.L.Lock()\n    p.c.Broadcast()\n    p.c.L.Unlock()\n\n}\n\nfunc (p *processor) process(f int) {\n\n    fmt.Printf(\"fork : %d\\n\", f)\n\n    p.c.L.Lock()\n    p.started &lt;- f\n    p.c.Wait()\n    p.c.L.Unlock()\n    fmt.Printf(\"process: %d - out of wait\\n\", f)\n}\n\nfunc main() {\n\n    p := newProcessor(5)\n    p.start()\n\n    reader := bufio.NewReader(os.Stdin)\n    _,_ =reader.ReadString('\\n')\n\n}\n</code></pre>\n"}, {"tags": ["go", "httprequest", "handler"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1448103242, "post_id": 33841459, "comment_id": 55449467, "body": "Your error is likely from this line - <code>fn(w, r, m[2])</code> - which is because that signature doesn&#39;t match that of <code>http.HandleFunc</code>&#39;s. You would be much better served by using a router like <a href=\"http://www.gorillatoolkit.org/pkg/mux\" rel=\"nofollow noreferrer\"><code>gorilla&#47;mux</code></a> to handle the regex/path matching separate to your handler, and then just returning a normal <code>http.HandlerFunc</code> via <code>fn(w, r)</code>."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1448177445, "post_id": 33841459, "comment_id": 55469385, "body": "True. But I developed the application without using these packages. It will be a major change I have to make to use these packages again. I was trying to use a dummy handler which takes 2 inputs and throttles. Then pass it to the makeHandler function and return as 3 arguments. But couldn&#39;t succeed in that approach. Is there any similar way to achieve this?"}], "answers": [{"tags": [], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "is_accepted": false, "score": 1, "last_activity_date": 1448217078, "last_edit_date": 1448217078, "creation_date": 1448216220, "answer_id": 33858342, "question_id": 33841459, "link": "https://stackoverflow.com/questions/33841459/http-handlefunc-argument-in-golang/33858342#33858342", "title": "http HandleFunc argument in golang", "body": "<p>I'm on my phone so this may be difficult to type but you could use the <code>http.Handle</code> function which takes an interface of <code>Handler</code> something like</p>\n\n<pre><code>type makeHandler struct {\n    YourVariable string\n}\n\nfunc (m *makeHandler) ServeHTTP (w http.ResponseWriter, r *http.Request) {\n    yourVariableYouNeed := m.YourVariable\n    // do whatever \n    w.Write()\n}\n\n// do whatever you need to get your variable\nblah := &amp;makeHandler{ yourThing }\n\nhttp.Handle(\"/views\", blah)\n</code></pre>\n\n<p>On my phone so can't test but it should work, let me know if it doesn't. </p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2648, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449008889, "creation_date": 1448095504, "last_edit_date": 1449008889, "question_id": 33841459, "link": "https://stackoverflow.com/questions/33841459/http-handlefunc-argument-in-golang", "title": "http HandleFunc argument in golang", "body": "<p>I want to use a rate limiting or throttler library to limit the number of client requests. I use a vendor library in my code base. I want to pass in a <code>ResponseWriter</code>, <code>Request</code> and a third variable retrieved from the URL. When I use the library for throttling, it gives me back a handler that only handles two arguments. How can I pass my third argument into the handler?</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/didip/tollbooth\"\n    \"net/http\"\n    )\n\nfunc viewHandler(\n    w http.ResponseWriter, \n    r *http.Request, \n    uniqueId string,\n    ) {\n    //data := getData(uniqueId)\n    fmt.Println(\"Id:\", uniqueId)\n    p := &amp;objects.ModelApp{LoggedUser: \"Ryan Hardy\", ViewData: \"data\"}\n    renderTemplate(w, \"view\", p)\n}\n\n//URL validation for basic web services\nvar validPath = regexp.MustCompile(\"^/$|/(home|about|view)/(|[a-zA-Z0-9]+)$\")\n\nfunc makeHandler(\n    fn func(\n        http.ResponseWriter, \n        *http.Request, string,\n        )) http.HandlerFunc {\n    return func(\n        w http.ResponseWriter, \n        r *http.Request,\n        ) {\n        m := validPath.FindStringSubmatch(r.URL.Path)\n        if m == nil {\n            http.NotFound(w, r)\n            return\n        }\n        fn(w, r, m[2])\n    }\n}\n\nfunc main() {\n    http.Handle(\"/view/\", makeHandler(tollbooth.LimitFuncHandler(tollbooth.NewLimiter(1, time.Second), viewHandler)))\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Could anyone help me with this?</p>\n"}, {"tags": ["xml", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 275, "user_id": 3205784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213012f39ccb8156f7058d4b2ef8880a?s=128&d=identicon&r=PG", "display_name": "mammothbane", "link": "https://stackoverflow.com/users/3205784/mammothbane"}, "is_accepted": true, "score": 1, "last_activity_date": 1448081598, "last_edit_date": 1448081598, "creation_date": 1448081250, "answer_id": 33839828, "question_id": 33839577, "link": "https://stackoverflow.com/questions/33839577/golang-xml-doesnt-unmarshal/33839828#33839828", "title": "Golang xml doesn&#39;t unmarshal", "body": "<p>Remove the <code>innerxml</code> tag on <code>DocumentType</code>, and give it the name of the element to to match (<code>xml:\"documentType\"</code>). From <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow\">the xml library docs</a>: </p>\n\n<blockquote>\n  <p>If the struct has a field of type <code>[]byte</code> or <code>string</code> with tag \",innerxml\", <code>Unmarshal</code> accumulates the raw XML nested inside the element in that field. The rest of the rules still apply.</p>\n</blockquote>\n\n<p>You don't need to store unprocessed XML. You're looking for the value of the field, so you don't need the tag.</p>\n\n<p><a href=\"http://play.golang.org/p/FlhUIdsqr6\" rel=\"nofollow\">Working version</a></p>\n\n<p>*edit: For that matter, the <code>\",innerxml\"</code> tag will also break the <code>SchemaVersion</code> field as well&mdash;without a matching element (and since <code>SchemaVersion</code> is a string), it stores the whole document.</p>\n"}, {"tags": [], "owner": {"reputation": 595, "user_id": 5443590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c3c26c54f6d700cd85d73e1f0cc4b5f?s=128&d=identicon&r=PG&f=1", "display_name": "GKV", "link": "https://stackoverflow.com/users/5443590/gkv"}, "is_accepted": false, "score": 2, "last_activity_date": 1463647601, "creation_date": 1463647601, "answer_id": 37318224, "question_id": 33839577, "link": "https://stackoverflow.com/questions/33839577/golang-xml-doesnt-unmarshal/37318224#37318224", "title": "Golang xml doesn&#39;t unmarshal", "body": "<pre><code>I tried to do as much i could please suggest and help . \nI use this method please comment and suggest.  \nhttps://play.golang.org/p/kb0HF8ykHW\n\n  package main;\n    import (\n        \"fmt\"\n        \"encoding/xml\"  \n    )\n\n    func main(){\n    dxml := `\n    &lt;?xml version=\"1.0\"?&gt;\n    &lt;ownershipDocument&gt;\n        &lt;schemaVersion&gt;X0306&lt;/schemaVersion&gt;\n        &lt;documentType&gt;4&lt;/documentType&gt;\n        &lt;periodOfReport&gt;2015-11-18&lt;/periodOfReport&gt;\n        &lt;issuer&gt;\n            &lt;issuerCik&gt;0000820081&lt;/issuerCik&gt;\n            &lt;issuerName&gt;CAMBREX CORP&lt;/issuerName&gt;\n            &lt;issuerTradingSymbol&gt;CBM&lt;/issuerTradingSymbol&gt;\n        &lt;/issuer&gt;\n        &lt;reportingOwner&gt;\n            &lt;reportingOwnerId&gt;\n                &lt;rptOwnerCik&gt;0001227832&lt;/rptOwnerCik&gt;\n                &lt;rptOwnerName&gt;KORB WILLIAM B&lt;/rptOwnerName&gt;\n            &lt;/reportingOwnerId&gt;\n            &lt;reportingOwnerAddress&gt;\n                &lt;rptOwnerStreet1&gt;1 MEADOWLANDS PLAZA&lt;/rptOwnerStreet1&gt;\n                &lt;rptOwnerStreet2/&gt;\n                &lt;rptOwnerCity&gt;EAST RUTHERFORD&lt;/rptOwnerCity&gt;\n                &lt;rptOwnerState&gt;NJ&lt;/rptOwnerState&gt;\n                &lt;rptOwnerZipCode&gt;07073&lt;/rptOwnerZipCode&gt;\n                &lt;rptOwnerStateDescription/&gt;\n            &lt;/reportingOwnerAddress&gt;\n            &lt;reportingOwnerRelationship&gt;\n                &lt;isDirector&gt;1&lt;/isDirector&gt;\n                &lt;isOfficer&gt;0&lt;/isOfficer&gt;\n                &lt;isTenPercentOwner&gt;0&lt;/isTenPercentOwner&gt;\n                &lt;isOther&gt;0&lt;/isOther&gt;\n            &lt;/reportingOwnerRelationship&gt;\n        &lt;/reportingOwner&gt;\n        &lt;nonDerivativeTable&gt;\n            &lt;nonDerivativeTransaction&gt;\n                &lt;securityTitle&gt;\n                    &lt;value&gt;Common Stock&lt;/value&gt;\n                &lt;/securityTitle&gt;\n                &lt;transactionDate&gt;\n                    &lt;value&gt;2015-11-18&lt;/value&gt;\n                &lt;/transactionDate&gt;\n                &lt;transactionCoding&gt;\n                    &lt;transactionFormType&gt;4&lt;/transactionFormType&gt;\n                    &lt;transactionCode&gt;S&lt;/transactionCode&gt;\n                    &lt;equitySwapInvolved&gt;0&lt;/equitySwapInvolved&gt;\n                &lt;/transactionCoding&gt;\n                &lt;transactionAmounts&gt;\n                    &lt;transactionShares&gt;\n                        &lt;value&gt;10000&lt;/value&gt;\n                    &lt;/transactionShares&gt;\n                    &lt;transactionPricePerShare&gt;\n                        &lt;value&gt;50.18&lt;/value&gt;\n                        &lt;footnoteId id=\"F1\"/&gt;\n                    &lt;/transactionPricePerShare&gt;\n                    &lt;transactionAcquiredDisposedCode&gt;\n                        &lt;value&gt;D&lt;/value&gt;\n                    &lt;/transactionAcquiredDisposedCode&gt;\n                &lt;/transactionAmounts&gt;\n                &lt;postTransactionAmounts&gt;\n                    &lt;sharesOwnedFollowingTransaction&gt;\n                        &lt;value&gt;36562&lt;/value&gt;\n                    &lt;/sharesOwnedFollowingTransaction&gt;\n                &lt;/postTransactionAmounts&gt;\n                &lt;ownershipNature&gt;\n                    &lt;directOrIndirectOwnership&gt;\n                        &lt;value&gt;D&lt;/value&gt;\n                    &lt;/directOrIndirectOwnership&gt;\n                    &lt;natureOfOwnership&gt;\n                        &lt;value/&gt;\n                    &lt;/natureOfOwnership&gt;\n                &lt;/ownershipNature&gt;\n            &lt;/nonDerivativeTransaction&gt;\n        &lt;/nonDerivativeTable&gt;\n        &lt;footnotes&gt;\n            &lt;footnote id=\"F1\"&gt;The price reported in Column 4 is a weighted average price. These shares were sold in multiple transactions at prices ranging from $50.00 to $50.58 inclusive. The reporting person undertakes to provide to Cambrex Corporation, any security holder of Cambrex Corporation, or the staff of the Securities and Exchange Commission, upon request, full information regarding the number of shares sold at each separate price within the range set forth in this Footnote 1 to this Form 4.&lt;/footnote&gt;\n        &lt;/footnotes&gt;\n        &lt;remarks/&gt;\n        &lt;ownerSignature&gt;\n            &lt;signatureName&gt;Samantha Hanley for William B. Korb by POA&lt;/signatureName&gt;\n            &lt;signatureDate&gt;2015-11-20&lt;/signatureDate&gt;\n        &lt;/ownerSignature&gt;\n    &lt;/ownershipDocument&gt;\n\n    `\n\n        defer func() {\n            if errD := recover(); errD != nil {\n                    fmt.Println(\"!!!!!!!!!!!!!!!!Panic Occured and Recovered in func main(), Error Info: \", errD)\n                }\n        }()\n\n        var Owner Ownershipdocs \n\n        err := xml.Unmarshal([]byte(dxml), &amp;Owner)\n            fmt.Println(\"xml.unmarshal error info :\",err)\n                fmt.Println(\"SchemaVersion : \",Owner.SchemaVersion)\n                fmt.Println(\"DocumentType : \",Owner.DocumentType)\n                fmt.Println(\"PeriodOfReport : \",Owner.PeriodOfReport)\n                fmt.Println(\"IssuerCik : \",Owner.IssuerCik)\n                fmt.Println(\"IssuerName : \",Owner.IssuerName)\n                fmt.Println(\"IssuerTradingSymbol : \",Owner.IssuerTradingSymbol)\n                fmt.Println(\"RptOwnerCik : \",Owner.RptOwnerCik)\n                fmt.Println(\"RptOwnerName : \",Owner.RptOwnerName)\n                fmt.Println(\"RptOwnerStreet1 : \",Owner.RptOwnerStreet1)\n                fmt.Println(\"RptOwnerCity :  \",Owner.RptOwnerCity)\n                fmt.Println(\"RptOwnerState : \",Owner.RptOwnerState)\n                fmt.Println(\"RptOwnerZipCode : \",Owner.RptOwnerZipCode)\n                fmt.Println(\"IsDirector : \",Owner.IsDirector)   \n                fmt.Println(\"IsOfficer :  \",Owner.IsOfficer)\n\n                fmt.Println(\"IsTenPercentOwner : \",Owner.IsTenPercentOwner)\n                fmt.Println(\"IsOther : \",Owner.IsOther)\n                fmt.Println(\"SecurityTitleValue : \",Owner.SecurityTitleValue)\n                fmt.Println(\"TransactionDatevalue : \",Owner.TransactionDatevalue)\n                fmt.Println(\"TransactionFormType : \",Owner.TransactionFormType)\n                fmt.Println(\"TransactionCode : \",Owner.TransactionCode)\n                fmt.Println(\"EquitySwapInvolved : \",Owner.EquitySwapInvolved)\n                fmt.Println(\"TransactionSharesValue : \",Owner.TransactionSharesValue)\n                fmt.Println(\"TransactionPricePerShareValue : \",Owner.TransactionPricePerShareValue)\n                fmt.Println(\"TransactionPricePerSharefootnoteId :  \",Owner.TransactionPricePerSharefootnoteId)\n                fmt.Println(\"TransactionAcquiredDisposedCodeValue : \",Owner.TransactionAcquiredDisposedCodeValue)\n\n                fmt.Println(\"Footnote.Footnote : \",Owner.Footnote.Footnote)\n                fmt.Println(\"OwnerSignaturesignatureName : \",Owner.OwnerSignaturesignatureName)\n                fmt.Println(\"OwnerSignaturesignatureDate    : \",Owner.OwnerSignaturesignatureDate)  \n\n    }\n\n    type Ownershipdocs struct{\n        SchemaVersion           string `xml:\"schemaVersion\"`\n        DocumentType            string `xml:\"documentType\"`\n        PeriodOfReport          string `xml:\"periodOfReport\"`\n        IssuerCik               string `xml:\"issuer&gt;issuerCik\"`\n        IssuerName              string `xml:\"issuer&gt;issuerName\"`\n        IssuerTradingSymbol     string `xml:\"issuer&gt;issuerTradingSymbol\"`\n        RptOwnerCik             string `xml:\"reportingOwner&gt;reportingOwnerId&gt;rptOwnerCik\"`\n        RptOwnerName            string `xml:\"reportingOwner&gt;reportingOwnerId&gt;rptOwnerName\"`\n\n        RptOwnerStreet1         string `xml:\"reportingOwner&gt;reportingOwnerAddress&gt;rptOwnerStreet1\"`\n        RptOwnerCity            string `xml:\"reportingOwner&gt;reportingOwnerAddress&gt;rptOwnerCity\"`\n        RptOwnerState           string `xml:\"reportingOwner&gt;reportingOwnerAddress&gt;rptOwnerState\"`\n        RptOwnerZipCode         string `xml:\"reportingOwner&gt;reportingOwnerAddress&gt;rptOwnerZipCode\"`\n\n        IsDirector              string `xml:\"reportingOwner&gt;reportingOwnerRelationship&gt;isDirector\"`\n        IsOfficer               string `xml:\"reportingOwner&gt;reportingOwnerRelationship&gt;isOfficer\"`  \n        IsTenPercentOwner       string `xml:\"reportingOwner&gt;reportingOwnerRelationship&gt;isTenPercentOwner\"`\n        IsOther                 string `xml:\"reportingOwner&gt;reportingOwnerRelationship&gt;isOther\"`        \n\n        SecurityTitleValue      string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;securityTitle&gt;value\"`\n        TransactionDatevalue    string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;transactionDate&gt;value\"`    \n        TransactionFormType     string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;transactionCoding&gt;transactionFormType\"`\n        TransactionCode         string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;transactionCoding&gt;transactionCode\"`\n        EquitySwapInvolved      string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;transactionCoding&gt;equitySwapInvolved\"`\n\n\n        TransactionSharesValue                  string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;transactionAmounts&gt;transactionShares&gt;value\"`\n        TransactionPricePerShareValue           string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;transactionAmounts&gt;transactionPricePerShare&gt;value\"`\n        TransactionPricePerSharefootnoteId      string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;transactionAmounts&gt;transactionPricePerShare&gt;footnoteId\"`\n        TransactionAcquiredDisposedCodeValue    string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;transactionAmounts&gt;transactionAcquiredDisposedCode&gt;value\"`\n\n        SharesOwnedFollowingTransactionValue    string `xml:\"nonDerivativeTable&gt;nonDerivativeTransaction&gt;ownershipNature&gt;directOrIndirectOwnership&gt;value\"`\n\n        Footnote                                Footnotes   `xml:\"footnotes\"`\n        OwnerSignaturesignatureName             string       `xml:\"ownerSignature&gt;signatureName\"`\n        OwnerSignaturesignatureDate             string       `xml:\"ownerSignature&gt;signatureDate\"`\n\n    }\n\n    type Footnotes struct{\n        ID          string `xml:\"id,attr\"`\n        Footnote    string `xml:\"footnote\"`\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 33839828, "answer_count": 2, "score": 0, "last_activity_date": 1463647601, "creation_date": 1448078582, "question_id": 33839577, "link": "https://stackoverflow.com/questions/33839577/golang-xml-doesnt-unmarshal", "title": "Golang xml doesn&#39;t unmarshal", "body": "<p>Im trying to unmarshal the following code that has the go playground at the bottom. The data.DocumentType always returns 0 and should return the inner xml 4. Can someone tell me why this doesnt work? </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n\n)\n\ntype doc struct {\n    XMLName       xml.Name `xml:\"ownershipDocument\"`\n    SchemaVersion string   `xml:\",innerxml\"`\n    DocumentType  int      `xml:\",innerxml\"`\n}\n\nfunc main() {\n    var Data doc\n    xml.Unmarshal([]byte(VV), &amp;Data)\n    fmt.Println(Data.DocumentType)\n\n}\n\nconst VV = `&lt;?xml version=\"1.0\"?&gt;\n&lt;ownershipDocument&gt;\n\n    &lt;schemaVersion&gt;X0306&lt;/schemaVersion&gt;\n\n    &lt;documentType&gt;4&lt;/documentType&gt;\n\n    &lt;periodOfReport&gt;2015-11-18&lt;/periodOfReport&gt;\n\n    &lt;issuer&gt;\n        &lt;issuerCik&gt;0000820081&lt;/issuerCik&gt;\n        &lt;issuerName&gt;CAMBREX CORP&lt;/issuerName&gt;\n        &lt;issuerTradingSymbol&gt;CBM&lt;/issuerTradingSymbol&gt;\n    &lt;/issuer&gt;\n\n    &lt;reportingOwner&gt;\n        &lt;reportingOwnerId&gt;\n            &lt;rptOwnerCik&gt;0001227832&lt;/rptOwnerCik&gt;\n            &lt;rptOwnerName&gt;KORB WILLIAM B&lt;/rptOwnerName&gt;\n        &lt;/reportingOwnerId&gt;\n        &lt;reportingOwnerAddress&gt;\n            &lt;rptOwnerStreet1&gt;1 MEADOWLANDS PLAZA&lt;/rptOwnerStreet1&gt;\n            &lt;rptOwnerStreet2&gt;&lt;/rptOwnerStreet2&gt;\n            &lt;rptOwnerCity&gt;EAST RUTHERFORD&lt;/rptOwnerCity&gt;\n            &lt;rptOwnerState&gt;NJ&lt;/rptOwnerState&gt;\n            &lt;rptOwnerZipCode&gt;07073&lt;/rptOwnerZipCode&gt;\n            &lt;rptOwnerStateDescription&gt;&lt;/rptOwnerStateDescription&gt;\n        &lt;/reportingOwnerAddress&gt;\n        &lt;reportingOwnerRelationship&gt;\n            &lt;isDirector&gt;1&lt;/isDirector&gt;\n            &lt;isOfficer&gt;0&lt;/isOfficer&gt;\n            &lt;isTenPercentOwner&gt;0&lt;/isTenPercentOwner&gt;\n            &lt;isOther&gt;0&lt;/isOther&gt;\n        &lt;/reportingOwnerRelationship&gt;\n    &lt;/reportingOwner&gt;\n\n    &lt;nonDerivativeTable&gt;\n        &lt;nonDerivativeTransaction&gt;\n            &lt;securityTitle&gt;\n                &lt;value&gt;Common Stock&lt;/value&gt;\n            &lt;/securityTitle&gt;\n            &lt;transactionDate&gt;\n                &lt;value&gt;2015-11-18&lt;/value&gt;\n            &lt;/transactionDate&gt;\n            &lt;transactionCoding&gt;\n                &lt;transactionFormType&gt;4&lt;/transactionFormType&gt;\n                &lt;transactionCode&gt;S&lt;/transactionCode&gt;\n                &lt;equitySwapInvolved&gt;0&lt;/equitySwapInvolved&gt;\n            &lt;/transactionCoding&gt;\n            &lt;transactionAmounts&gt;\n                &lt;transactionShares&gt;\n                    &lt;value&gt;10000&lt;/value&gt;\n                &lt;/transactionShares&gt;\n                &lt;transactionPricePerShare&gt;\n                    &lt;value&gt;50.18&lt;/value&gt;\n                    &lt;footnoteId id=\"F1\"/&gt;\n                &lt;/transactionPricePerShare&gt;\n                &lt;transactionAcquiredDisposedCode&gt;\n                    &lt;value&gt;D&lt;/value&gt;\n                &lt;/transactionAcquiredDisposedCode&gt;\n            &lt;/transactionAmounts&gt;\n            &lt;postTransactionAmounts&gt;\n                &lt;sharesOwnedFollowingTransaction&gt;\n                    &lt;value&gt;36562&lt;/value&gt;\n                &lt;/sharesOwnedFollowingTransaction&gt;\n            &lt;/postTransactionAmounts&gt;\n            &lt;ownershipNature&gt;\n                &lt;directOrIndirectOwnership&gt;\n                    &lt;value&gt;D&lt;/value&gt;\n                &lt;/directOrIndirectOwnership&gt;\n                &lt;natureOfOwnership&gt;\n                    &lt;value&gt;&lt;/value&gt;\n                &lt;/natureOfOwnership&gt;\n            &lt;/ownershipNature&gt;\n        &lt;/nonDerivativeTransaction&gt;\n    &lt;/nonDerivativeTable&gt;\n\n    &lt;footnotes&gt;\n        &lt;footnote id=\"F1\"&gt;The price reported in Column 4 is a weighted average price. These shares were sold in multiple transactions at prices ranging from $50.00 to $50.58 inclusive. The reporting person undertakes to provide to Cambrex Corporation, any security holder of Cambrex Corporation, or the staff of the Securities and Exchange Commission, upon request, full information regarding the number of shares sold at each separate price within the range set forth in this Footnote 1 to this Form 4.&lt;/footnote&gt;\n    &lt;/footnotes&gt;\n\n    &lt;remarks&gt;&lt;/remarks&gt;\n\n    &lt;ownerSignature&gt;\n        &lt;signatureName&gt;Samantha Hanley for William B. Korb by POA&lt;/signatureName&gt;\n        &lt;signatureDate&gt;2015-11-20&lt;/signatureDate&gt;\n    &lt;/ownerSignature&gt;\n&lt;/ownershipDocument&gt;`\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/nJbAF0zKSJ\" rel=\"nofollow\">http://play.golang.org/p/nJbAF0zKSJ</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1448060946, "post_id": 33837440, "comment_id": 55440502, "body": "Interesting problem. Seems like something of a catch-22. Can&#39;t assign <code>int64</code> to <code>myInt64</code> but then if you try to do a conversion that fails too :|"}], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1448064635, "post_id": 33837598, "comment_id": 55441557, "body": "Do you know why <code>val.Convert(fieldType)</code> is allowed but you can&#39;t do the conversion like <code>myInt64(val)</code> ? I assume <code>Convert</code> is something in the reflect package with a different implementation but it seems a bit silly to me that it&#39;s use is required when the other conversion <i>should</i> succeed, or at least I can&#39;t see any good reason why it&#39;s not possible to do."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1448067046, "post_id": 33837598, "comment_id": 55442113, "body": "@evanmcdonnal <code>val</code> is a <code>reflect.Value</code>, not an <code>int64</code>."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1448067167, "post_id": 33837598, "comment_id": 55442138, "body": "yeah I get that but the error ends up saying <code>panic: reflect.Set: value of type int64 is not assignable to type main.myInt64</code>. I tried to convert to <code>int64</code> and then to <code>myInt64</code> and ran into the same type if error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1448115473, "post_id": 33837598, "comment_id": 55453165, "body": "@evanmcdonnal if you get that a <code>reflect.Value</code> is a different underlying type from an <code>int64</code> then I don&#39;t understand what the confusion is. You can&#39;t convert between the two, and that&#39;s why there&#39;s the <code>Convert</code> and <code>ConvertibleTo</code> methods."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1448061135, "creation_date": 1448061135, "answer_id": 33837598, "question_id": 33837440, "link": "https://stackoverflow.com/questions/33837440/how-to-set-struct-field-using-base-type-in-go/33837598#33837598", "title": "How to set struct field using base type in Go", "body": "<p>You have to provide the correct type for the assignment. There are no implicit type conversions.</p>\n\n<p>You can either provide a <code>myInt64</code> to your function </p>\n\n<pre><code>myData := make(map[string]interface{})\nmyData[\"Name\"] = \"Tony\"\nmyData[\"Age\"] = myInt64(23)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/sbOdAnbz8n\" rel=\"nofollow\">http://play.golang.org/p/sbOdAnbz8n</a></p>\n\n<p>Or you can convert the values during assignment</p>\n\n<pre><code>for name, value := range m {\n    structFieldValue := structValue.FieldByName(name)\n    fieldType := structFieldValue.Type()\n\n    val := reflect.ValueOf(value)\n\n    structFieldValue.Set(val.Convert(fieldType))\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/kl0fEENY9b\" rel=\"nofollow\">http://play.golang.org/p/kl0fEENY9b</a></p>\n"}], "owner": {"reputation": 3732, "user_id": 1283020, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd2b1d4e7e61071b0c144d2d952e2213?s=128&d=identicon&r=PG", "display_name": "Krut", "link": "https://stackoverflow.com/users/1283020/krut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2532, "favorite_count": 1, "accepted_answer_id": 33837598, "answer_count": 1, "score": 4, "last_activity_date": 1448061135, "creation_date": 1448060244, "question_id": 33837440, "link": "https://stackoverflow.com/questions/33837440/how-to-set-struct-field-using-base-type-in-go", "title": "How to set struct field using base type in Go", "body": "<p>If I defined a type <code>type myInt64 int64</code> how would I set it using reflection?  Code below panics reflect.Set: value of type int64 is not assignable to type main.myInt64\n<a href=\"http://play.golang.org/p/scsXq4ofk6\" rel=\"nofollow\">http://play.golang.org/p/scsXq4ofk6</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype myInt64 int64\n\ntype MyStruct struct {\n    Name string\n    Age  myInt64\n}\n\nfunc FillStruct(m map[string]interface{}, s interface{}) error {\n    structValue := reflect.ValueOf(s).Elem()\n\n    for name, value := range m {\n        structFieldValue := structValue.FieldByName(name)\n\n        val := reflect.ValueOf(value)\n\n        structFieldValue.Set(val)\n    }\n    return nil\n}\n\nfunc main() {\n    myData := make(map[string]interface{})\n    myData[\"Name\"] = \"Tony\"\n    myData[\"Age\"] = int64(23)\n\n    result := &amp;MyStruct{}\n    err := FillStruct(myData, result)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(result)\n}\n</code></pre>\n"}, {"tags": ["go", "amazon-cloudwatch"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4175995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ueycb4G14ds/AAAAAAAAAAI/AAAAAAAAADA/PbxgFNPCuZE/photo.jpg?sz=128", "display_name": "James Loh", "link": "https://stackoverflow.com/users/4175995/james-loh"}, "is_accepted": false, "score": 0, "last_activity_date": 1478753454, "creation_date": 1478753454, "answer_id": 40520159, "question_id": 33837062, "link": "https://stackoverflow.com/questions/33837062/unable-to-get-cloudwatchlogs-working-despite-no-errors-from-go-aws-sdk/40520159#40520159", "title": "Unable to get CloudWatchLogs working despite no errors from GO AWS SDK", "body": "<p>Your nextSequenceToken() returns a trailing character. Here is the corrected function.</p>\n\n<pre><code>func nextSequenceToken() (string, error) {\n    params := &amp;cloudwatchlogs.DescribeLogStreamsInput{\n        LogGroupName:        aws.String(config.AwsLogGroup), // Required\n        LogStreamNamePrefix: aws.String(config.AwsLogStream),\n        Descending:          aws.Bool(true),\n        Limit:               aws.Int64(1),\n    }\n    resp, err := config.AwsCloudWatchLogsSvc.DescribeLogStreams(params)\n    if err != nil {\n        return \"\", err\n    }\n\n    return *(resp.LogStreams[0].UploadSequenceToken), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 6304, "user_id": 390722, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/64fc18734e843f8bb227765cb1b62137?s=128&d=identicon&r=PG&f=1", "display_name": "StartupGuy", "link": "https://stackoverflow.com/users/390722/startupguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1078, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478753454, "creation_date": 1448058220, "question_id": 33837062, "link": "https://stackoverflow.com/questions/33837062/unable-to-get-cloudwatchlogs-working-despite-no-errors-from-go-aws-sdk", "title": "Unable to get CloudWatchLogs working despite no errors from GO AWS SDK", "body": "<p>I have put together some code closely based on the AWS GO SDK <a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/cloudwatchlogs/examples_test.go#L445\" rel=\"nofollow\">example</a> for the <code>InvalidSequenceTokenException</code> method. The SDK seems to have some bugs that I have got around and I am getting the expected response for a successful call to the API which returns the next sequence token to use for a subsequent call. Here is my code</p>\n\n<pre><code>import (\n    \"github.com/aws/aws-sdk-go/service/cloudwatchlogs\"\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/opensoft/dvs-api/config\"\n    \"strings\"\n)\n\nfunc nextSequenceToken() (string, error) {\n    params := &amp;cloudwatchlogs.DescribeLogStreamsInput{\n        LogGroupName:        aws.String(config.AwsLogGroup), // Required\n        LogStreamNamePrefix: aws.String(config.AwsLogStream),\n        Descending:          aws.Bool(true),\n        Limit:               aws.Int64(1),\n    }\n    resp, err := config.AwsCloudWatchLogsSvc.DescribeLogStreams(params)\n    if err != nil {\n        return \"\", err\n    }\n\n    // Parsing from string because resp.NextToken is *always* empty ... bug?\n    parsed := \"\"\n    parts := strings.Split(resp.GoString(), \"\\n\")\n    for _, part := range parts {\n        if strings.Contains(part, \"UploadSequenceToken\") {\n            parsed = strings.TrimLeft(part, \"UploadSequenceToken: \\\"\")\n            parsed = strings.TrimRight(parsed, \"\\\"\")\n        }\n    }\n    return parsed, nil\n}\n\nfunc LogEvent(message string, unixTime int64) error {\n    nextToken, te := nextSequenceToken()\n    if te != nil {\n        return te\n    }\n\n    params := &amp;cloudwatchlogs.PutLogEventsInput{\n        LogEvents: []*cloudwatchlogs.InputLogEvent{// Required\n            {// Required\n                Message:   aws.String(message), // Required\n                Timestamp: aws.Int64(unixTime), // Required\n            },\n            // More values...\n        },\n        LogGroupName:  aws.String(config.AwsLogGroup), // Required\n        LogStreamName: aws.String(config.AwsLogStream), // Required\n    }\n    if nextToken != \"\" {\n        params.SequenceToken = &amp;nextToken\n    }\n\n    resp, err := config.AwsCloudWatchLogsSvc.PutLogEvents(params)\n    if err != nil {\n        return err\n    }\n\n    // Parsing from string because resp.NextSequenceToken is *always* empty ... bug?\n    parsed := \"\"\n    parts := strings.Split(resp.GoString(), \"\\n\")\n    for _, part := range parts {\n        if strings.Contains(part, \"NextSequenceToken\") {\n            parsed = strings.TrimLeft(part, \"NextSequenceToken: \\\"\")\n            parsed = strings.TrimRight(parsed, \"\\\",\")\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>I also went ahead and deleted the log stream from the group just to make sure there was a connection and I did get an error back from AWS telling me the log stream is invalid and likewise, recreating the log stream fixed everything. </p>\n\n<p>So my code appears to be correct, however nothing that I am logging shows up at CloudWatch Logs and my log remains empty.  If I my code is correct and not returning any errors from AWS then where else should I look for problems?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5416275, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WvpAkm7xU9w/AAAAAAAAAAI/AAAAAAAAB4U/9pzRM6KPb74/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/5416275/tim"}, "edited": false, "score": 0, "creation_date": 1448314536, "post_id": 33839367, "comment_id": 55526714, "body": "Thank you so much. After sifting through the spew dump for a few minutes the ast package is much more approachable.  Also thanks for adding the example too!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1448076239, "creation_date": 1448076239, "answer_id": 33839367, "question_id": 33836358, "link": "https://stackoverflow.com/questions/33836358/parsing-go-src-trying-to-convert-ast-gendecl-to-types-interface/33839367#33839367", "title": "Parsing go src, trying to convert *ast.GenDecl to types.Interface", "body": "<p>When working with the AST, I find it helpful to dump an example using the <a href=\"https://godoc.org/github.com/davecgh/go-spew/spew\" rel=\"noreferrer\">spew</a> package:</p>\n\n<pre><code>    fset := token.NewFileSet()\n    f, _ := parser.ParseFile(fset, \"/tmp/tmp.go\", `package service ....`)\n    spew.Dump(f)\n</code></pre>\n\n<p>I find it easy to write the required code from the spew output. </p>\n\n<p>Here's some code to get you started. It prints interface and method names:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"go/ast\"\n  \"go/parser\"\n  \"go/token\"\n)\n\nfunc main() {\n  fset := token.NewFileSet()\n  f, _ := parser.ParseFile(fset, \"/tmp/tmp.go\", `package service\n\n    type ServiceInterface interface {\n                    Create(NewServiceRequest) (JsonResponse, error)\n                    Delete(DelServiceRequest) (JsonResponse, error)\n    }`, 0)\n  for _, x := range f.Decls {\n    if x, ok := x.(*ast.GenDecl); ok {\n        if x.Tok != token.TYPE {\n            continue\n        }\n        for _, x := range x.Specs {\n            if x, ok := x.(*ast.TypeSpec); ok {\n                iname := x.Name\n                if x, ok := x.Type.(*ast.InterfaceType); ok {\n                    for _, x := range x.Methods.List {\n                        if len(x.Names) == 0 {\n                            continue\n                        }\n                        mname := x.Names[0].Name\n                        fmt.Println(\"interface:\", iname, \"method:\", mname)\n\n                    }\n                }\n            }\n        }\n    }\n  }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/eNyB7O6FIc\" rel=\"noreferrer\">http://play.golang.org/p/eNyB7O6FIc</a></p>\n"}], "owner": {"reputation": 63, "user_id": 5416275, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WvpAkm7xU9w/AAAAAAAAAAI/AAAAAAAAB4U/9pzRM6KPb74/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/5416275/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 961, "favorite_count": 0, "accepted_answer_id": 33839367, "answer_count": 1, "score": 3, "last_activity_date": 1448076239, "creation_date": 1448054867, "question_id": 33836358, "link": "https://stackoverflow.com/questions/33836358/parsing-go-src-trying-to-convert-ast-gendecl-to-types-interface", "title": "Parsing go src, trying to convert *ast.GenDecl to types.Interface", "body": "<p>I am trying to parse go source files that contain interfaces and find the interfaces defined methods / signatures. I am using ast to parse the file. I am able to get some high level declarations, such as *ast.GenDecl, but I am not able to get to the next level of determining if this type is an interface and what its methods are.</p>\n\n<p>This is for a scaffolding type problem I am trying to solve where a user defines the interface for a service and a tool will build out the skeleton of the service</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"go/ast\"\n        \"go/parser\"\n        \"go/token\"\n        \"reflect\"\n)\n\nfunc main() {\n        fset := token.NewFileSet()\n        f, _ := parser.ParseFile(fset, \"/tmp/tmp.go\", `package service\n\n        type ServiceInterface interface {\n                        Create(NewServiceRequest) (JsonResponse, error)\n                        Delete(DelServiceRequest) (JsonResponse, error)\n        }`, 0)\n        for _, v := range f.Decls {\n\n            switch t := v.(type) {\n            case *ast.FuncDecl:\n                    fmt.Println(\"func \", t.Name.Name)\n            case *ast.GenDecl:\n                    switch x := t.Specs[0].(type) {\n                    default:\n                            fmt.Println(x, reflect.TypeOf(x))\n                    }\n            default:\n                    fmt.Printf(\"skipping %t\\n\", t)\n            }\n\n    }\n}\n</code></pre>\n\n<p>Results in but I cant seem to find anything about the internals of interface declaration at all.</p>\n\n<pre><code>&amp;{&lt;nil&gt; ServiceInterface 0x8202d8260 &lt;nil&gt;} *ast.TypeSpec\n</code></pre>\n"}, {"tags": ["arrays", "data-structures", "struct", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1448054321, "post_id": 33835925, "comment_id": 55437744, "body": "Go doesn&#39;t have inheritance, so approaching a problem in this manner is usually the wrong choice. Also, the reason you can&#39;t do this is that there are no generics, and go types are invariant."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1448054398, "post_id": 33835925, "comment_id": 55437781, "body": "Use interfaces.  can&#39;t find it right now,but there are multiple duplicates of this topic."}], "answers": [{"comments": [{"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1448054675, "post_id": 33836248, "comment_id": 55437909, "body": "Well, Vehicle can be a type.  But he <i>also</i> needs an interface with methods that all vehicles can do, like start, move, shutdown, etc...  That would allow him to embed Vehicle in his other types and store them together in an array of types that implement IVehicle or whatever, right?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 1, "creation_date": 1448055422, "post_id": 33836248, "comment_id": 55438224, "body": "@saarrrr yeah, sorry if that was unclear. I used <code>IVehicle</code> in the second paragraph because that would be the sensible choice assuming he keeps the <code>Vehicle</code> type. In the last paragraph I&#39;m talking about his current implementation and just trying to give some broader conceptual information about embedding. The &quot;is a&quot;, &quot;has a&quot; crap is the way I remember academics explaining it ;)"}, {"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1448056071, "post_id": 33836248, "comment_id": 55438530, "body": "That&#39;s what I thought, just making sure my own understand wasn&#39;t whacked to all hell.  Thanks, great answer."}, {"owner": {"reputation": 386, "user_id": 1432051, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0a7761ff6709f6a086a4fe7160be930?s=128&d=identicon&r=PG", "display_name": "jamesmstone", "link": "https://stackoverflow.com/users/1432051/jamesmstone"}, "edited": false, "score": 0, "creation_date": 1448067582, "post_id": 33836248, "comment_id": 55442245, "body": "Not sure if in needs a follow up question but how could you ensurer the data structure is correctly encoded as JSON  <a href=\"https://play.golang.org/p/W0luNEuZ40\" rel=\"nofollow noreferrer\">play.golang.org/p/W0luNEuZ40</a>"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 2, "last_activity_date": 1448054382, "creation_date": 1448054382, "answer_id": 33836248, "question_id": 33835925, "link": "https://stackoverflow.com/questions/33835925/array-of-go-structs-with-the-same-anonymous-filed-but-different-types/33836248#33836248", "title": "Array of Go structs with the same anonymous filed, but different types", "body": "<p><code>Vehicle</code> is embedded in <code>Car</code> and <code>Bus</code> so you got things going in the wrong direction... It's not like <code>Vehicle</code> is a parent class so you can't get the polymorphic behavior you're looking for out of this design. What you need is an interface.</p>\n\n<p>To show you a working example I'm just going to use empty interface (it will allow you to store any type in the collection). For your actual program you might want to make something like an <code>IVehicle</code> interface and put whatever common method all the vehicles will have on it, maybe something like <code>Start()</code> or whatever...</p>\n\n<p><a href=\"https://play.golang.org/p/iPJbFYlo7o\" rel=\"nofollow\">https://play.golang.org/p/iPJbFYlo7o</a></p>\n\n<p>To expand on that embedding thing a little bit... This isn't inheritance. You can accomplish the same things with it however the statement \"Car <em>is a</em> Vehicle\" is not true. This is actually more like composition, \"Car has a Vehicle\". It's just that <code>Vehicle</code>'s fields and methods are 'hoisted' up to <code>Car</code>, meaning they can be accessed from an instance of <code>Car</code> without another layer of indirection like <code>Car.Vehicle.FieldOnVehicle</code>. That's not really what you're looking for. If you want to say \"Car is a Vehicle\" and it be true, then <code>Vehicle</code> needs to be an interface which <code>Car</code> implements.</p>\n"}], "owner": {"reputation": 386, "user_id": 1432051, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0a7761ff6709f6a086a4fe7160be930?s=128&d=identicon&r=PG", "display_name": "jamesmstone", "link": "https://stackoverflow.com/users/1432051/jamesmstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 33836248, "answer_count": 1, "score": 1, "last_activity_date": 1448054382, "creation_date": 1448052933, "question_id": 33835925, "link": "https://stackoverflow.com/questions/33835925/array-of-go-structs-with-the-same-anonymous-filed-but-different-types", "title": "Array of Go structs with the same anonymous filed, but different types", "body": "<p>If you imagine I have the following declarations:</p>\n\n<pre><code>type Car struct {\n    Vehicle\n    engineType string\n}\n\ntype Bus struct {\n    Vehicle\n    public     bool\n    engineType string\n}\n\ntype Bike struct {\n    Vehicle\n    motorbike bool\n}\n\ntype Vehicle struct {\n    NumberWheels     int\n    NumberPassengers int\n    Owner            string\n}\n\ntype Vehicles []Vehicle\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/P6sOojM4ko\" rel=\"nofollow\">Playground</a></p>\n\n<p>I'm trying to have an array of Vehicles. However this is not possible as they each have a different type ( i.e <code>Car</code>, <code>Bus</code>, <code>Bike</code>, etc...)</p>\n\n<pre><code>var myCar = Car{Vehicle{4, 4, \"Me\"}, \"Manual\"}\nvar myBike = Bike{Vehicle{2, 0, \"Bob and I\"}, false}\nvar myVehicles = Vehicles{myCar, myBike}\nfor i := range myVehicles {\n    fmt.Println(myVehicles[i])\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/P6sOojM4ko\" rel=\"nofollow\">Playground</a></p>\n\n<p>How would you achieve something like this. Or am I trying to tackle this problem from the wrong angle. I'm new to Go.</p>\n"}, {"tags": ["variables", "go", "assign"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1448051910, "post_id": 33835636, "comment_id": 55436625, "body": "There is nothing like Java&#39;s <code>this</code> in Go. What you did is the simplest, cleanest way to do what you wanted to do."}, {"owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1448052123, "post_id": 33835636, "comment_id": 55436723, "body": "Thanks for the answer"}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1448051928, "creation_date": 1448051928, "answer_id": 33835676, "question_id": 33835636, "link": "https://stackoverflow.com/questions/33835636/short-declaration-operator-shadows-global-variable/33835676#33835676", "title": "Short-declaration operator shadows global variable", "body": "<p>No. Your example that declares <code>var err error</code> is the idiomatic way to do what you want.</p>\n"}], "owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1502336395, "creation_date": 1448051765, "last_edit_date": 1502336395, "question_id": 33835636, "link": "https://stackoverflow.com/questions/33835636/short-declaration-operator-shadows-global-variable", "title": "Short-declaration operator shadows global variable", "body": "<p>There is <code>oneFunction</code> that returns 2 values of types <code>int</code> and <code>error</code>.\nI want to assign the first value to already existing variable and assign second value to a new variable.</p>\n\n<hr>\n\n<p>If I use short declaration operator <code>:=</code>, there will be created 2 new variables <code>x</code> and <code>err</code>.</p>\n\n<pre><code>var x int\nx, err := oneFunction()\n</code></pre>\n\n<hr>\n\n<p>To get rid of creating new <code>x</code> variable I must not use <code>:=</code> operator and declare <code>err</code> before calling <code>oneFunction</code></p>\n\n<pre><code>    var x int\n    var err error\n    glob, err = oneFunction()\n</code></pre>\n\n<hr>\n\n<p>I'd like to know if there is another way to set first value to global variable instead of creating a new one? </p>\n"}, {"tags": ["arrays", "go", "append", "slice"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1545366542, "post_id": 33834777, "comment_id": 94605353, "body": "Is there a way to append to a slice without reassigning it?"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 38, "last_activity_date": 1448049141, "last_edit_date": 1448049141, "creation_date": 1448048351, "answer_id": 33834777, "question_id": 33834742, "link": "https://stackoverflow.com/questions/33834742/remove-and-adding-elements-to-array-in-go-lang/33834777#33834777", "title": "Remove and adding elements to array in GO lang", "body": "<p>For the <code>output</code> array you need to use <code>append</code> or allocate it with an initial capacity to match the size of <code>input</code>.</p>\n\n<pre><code>// before the loop\noutput := make([]string, len(input))\n</code></pre>\n\n<p>would be my recommendation because <code>append</code> causes a bunch of needless reallocations and you already know what capacity you need since it's based on the <code>input</code>.</p>\n\n<p>The other thing would be:</p>\n\n<pre><code>output = append(output, input[index])\n</code></pre>\n\n<p>But like I said, from what I've observed append grows the initial capacity exponentially. This will be base 2 if you haven't specified anything which means you're going to be doing several unneeded reallocations before reaching the desired capacity.</p>\n"}, {"tags": [], "owner": {"reputation": 736, "user_id": 5835014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bagBl.png?s=128&g=1", "display_name": "TonnyL", "link": "https://stackoverflow.com/users/5835014/tonnyl"}, "is_accepted": false, "score": 17, "last_activity_date": 1516285058, "last_edit_date": 1516285058, "creation_date": 1516277944, "answer_id": 48321191, "question_id": 33834742, "link": "https://stackoverflow.com/questions/33834742/remove-and-adding-elements-to-array-in-go-lang/48321191#48321191", "title": "Remove and adding elements to array in GO lang", "body": "<p>You could find some useful tricks at <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"noreferrer\">golang/SliceTricks</a>.</p>\n\n<p>Since the introduction of the <code>append</code> built-in, most of the functionality of the <code>container/vector</code> package, which was removed in Go 1, can be replicated using <code>append</code> and <code>copy</code>.</p>\n\n<p>Here are the vector methods and their slice-manipulation analogues:</p>\n\nAppendVector\n\n<pre><code>a = append(a, b...)\n</code></pre>\n\nCopy\n\n<pre><code>b = make([]T, len(a))\ncopy(b, a)\n// or\nb = append([]T(nil), a...)\n</code></pre>\n\nCut\n\n<pre><code>a = append(a[:i], a[j:]...)\n</code></pre>\n\nDelete\n\n<pre><code>a = append(a[:i], a[i+1:]...)\n// or\na = a[:i+copy(a[i:], a[i+1:])]\n</code></pre>\n\nDelete without preserving order\n\n<pre><code>a[i] = a[len(a)-1] \na = a[:len(a)-1]\n</code></pre>\n\n<p><strong>NOTE</strong> If the type of the element is a <em>pointer</em> or a struct with pointer fields, which need to be garbage collected, the above implementations of <code>Cut</code> and <code>Delete</code> have a potential <em>memory leak</em> problem: some elements with values are still referenced by slice <code>a</code> and thus can not be collected. The following code can fix this problem:</p>\n\n<blockquote>\n  <p><strong>Cut</strong></p>\n</blockquote>\n\n<pre><code>copy(a[i:], a[j:])\nfor k, n := len(a)-j+i, len(a); k &lt; n; k++ {\n    a[k] = nil // or the zero value of T\n}\na = a[:len(a)-j+i]\n</code></pre>\n\n<blockquote>\n  <p><strong>Delete</strong></p>\n</blockquote>\n\n<pre><code>copy(a[i:], a[i+1:])\na[len(a)-1] = nil // or the zero value of T\na = a[:len(a)-1]\n</code></pre>\n\n<blockquote>\n  <p><strong>Delete without preserving order</strong></p>\n</blockquote>\n\n<pre><code>a[i] = a[len(a)-1]\na[len(a)-1] = nil\na = a[:len(a)-1]\n</code></pre>\n\nExpand\n\n<pre><code>a = append(a[:i], append(make([]T, j), a[i:]...)...)\n</code></pre>\n\nExtend\n\n<pre><code>a = append(a, make([]T, j)...)\n</code></pre>\n\nInsert\n\n<pre><code>a = append(a[:i], append([]T{x}, a[i:]...)...)\n</code></pre>\n\n<p><strong>NOTE</strong> The second <code>append</code> creates a new slice with its own underlying storage and  copies elements in <code>a[i:]</code> to that slice, and these elements are then copied back to slice <code>a</code> (by the first <code>append</code>). The creation of the new slice (and thus memory garbage) and the second copy can be avoided by using an alternative way:</p>\n\n<blockquote>\n  <p><strong>Insert</strong></p>\n</blockquote>\n\n<pre><code>s = append(s, 0)\ncopy(s[i+1:], s[i:])\ns[i] = x\n</code></pre>\n\nInsertVector\n\n<pre><code>a = append(a[:i], append(b, a[i:]...)...)\n</code></pre>\n\nPop\n\n<pre><code>x, a = a[0], a[1:]\n</code></pre>\n\nPop Back\n\n<pre><code>x, a = a[len(a)-1], a[:len(a)-1]\n</code></pre>\n\nPush\n\n<pre><code>a = append(a, x)\n</code></pre>\n\nPush Front\n\n<pre><code>a = append([]T{ x }, a...)\n</code></pre>\n\nShift\n\n<pre><code>x, a := a[0], a[1:]\n</code></pre>\n\nUnshift\n\n<pre><code>a = append([]T{x}, a...)\n</code></pre>\n\n<h2>Additional Tricks</h2>\n\n<h3>Filtering without allocating</h3>\n\n<p>This trick uses the fact that a slice shares the same backing array and capacity as the original, so the storage is reused for the filtered slice. Of course, the original contents are modified.</p>\n\n<pre><code>b := a[:0]\nfor _, x := range a {\n    if f(x) {\n        b = append(b, x)\n    }\n}\n</code></pre>\n\n<h3>Reversing</h3>\n\n<p>To replace the contents of a slice with the same elements but in reverse order:</p>\n\n<pre><code>for i := len(a)/2-1; i &gt;= 0; i-- {\n    opp := len(a)-1-i\n    a[i], a[opp] = a[opp], a[i]\n}\n</code></pre>\n\n<p>The same thing, except with two indices:</p>\n\n<pre><code>for left, right := 0, len(a)-1; left &lt; right; left, right = left+1, right-1 {\n    a[left], a[right] = a[right], a[left]\n}\n</code></pre>\n\n<h3>Shuffling</h3>\n\n<p>Fisher\u2013Yates algorithm:</p>\n\n<pre><code>for i := len(a) - 1; i &gt; 0; i-- {\n    j := rand.Intn(i + 1)\n    a[i], a[j] = a[j], a[i]\n}\n</code></pre>\n"}], "owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56748, "favorite_count": 8, "accepted_answer_id": 33834777, "answer_count": 2, "score": 28, "last_activity_date": 1516285058, "creation_date": 1448048234, "last_edit_date": 1486629345, "question_id": 33834742, "link": "https://stackoverflow.com/questions/33834742/remove-and-adding-elements-to-array-in-go-lang", "title": "Remove and adding elements to array in GO lang", "body": "<p>I have 2 arrays declared as : \n<code>var input []string</code> and <code>var output []string</code> . </p>\n\n<p>The input array is filled with some IDs initially. Output array is NULL.</p>\n\n<p>After every iteration I want to remove a random element from input array and add it to output array. </p>\n\n<p>At the end all the elements in output array will be same as input array (but with different ordering(indexing)). </p>\n\n<pre><code>for index := 0; index &lt; len(input); index++ {\n    if !visited[index] {\n        //do something\n    }\n}\noutput[#iteration index] = input[current index]\n</code></pre>\n\n<p>When I try to do this, I get <code>array out of bounds error</code>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 3, "creation_date": 1448042312, "post_id": 33832762, "comment_id": 55431349, "body": "Please don&#39;t use line numbers. It makes it hard for people to copy and paste your program to reproduce your problem."}], "answers": [{"tags": [], "owner": {"reputation": 404, "user_id": 1164802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9a17bccaa575860b464a1739488782?s=128&d=identicon&r=PG", "display_name": "dahc", "link": "https://stackoverflow.com/users/1164802/dahc"}, "is_accepted": false, "score": 1, "last_activity_date": 1448043844, "creation_date": 1448043844, "answer_id": 33833533, "question_id": 33832762, "link": "https://stackoverflow.com/questions/33832762/how-do-i-make-a-go-program-wait-until-there-is-user-input/33833533#33833533", "title": "How do I make a GO program wait until there is user input?", "body": "<p>Scanner isn't really ideal for reading command line input (see the answer HectorJ referenced above), but if you want to make it work, it's a call to Scan() that you're missing (also note that Text() is a method call):</p>\n\n<pre><code>func main() {\n    fmt.Print(\"insert y value here: \")\n    input := bufio.NewScanner(os.Stdin)\n    input.Scan()\n    fmt.Println(input.Text())\n}\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6815, "favorite_count": 1, "closed_date": 1449065493, "answer_count": 1, "score": 2, "last_activity_date": 1448043844, "creation_date": 1448040945, "last_edit_date": 1448042243, "question_id": 33832762, "link": "https://stackoverflow.com/questions/33832762/how-do-i-make-a-go-program-wait-until-there-is-user-input", "closed_reason": "Duplicate", "title": "How do I make a GO program wait until there is user input?", "body": "<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    fmt.Println(\"insert y value here: \")\n    input := bufio.NewScanner(os.Stdin)\n    fmt.Println(input.Text)\n}\n</code></pre>\n\n<p>How do I make the program wait, until the user inputs data?</p>\n"}, {"tags": ["dictionary", "go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1448039098, "last_edit_date": 1448039098, "creation_date": 1448038704, "answer_id": 33832096, "question_id": 33831908, "link": "https://stackoverflow.com/questions/33831908/how-to-take-all-keys-and-values-of-a-map-and-pass-as-args-to-a-function-in-golan/33832096#33832096", "title": "How to take all keys and values of a map and pass as args to a function in golang?", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc fn(args ...string) { fmt.Println(args) }\n\nfunc main() {\n    m := map[string]string{\"k1\": \"v1\", \"k2\": \"v2\"}\n    args := make([]string, 0, 2*len(m))\n    for key, value := range m {\n        args = append(args, key)\n        args = append(args, value)\n    }\n    fmt.Println(args)\n    fn(args...)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[k1 v1 k2 v2]\n[k1 v1 k2 v2]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1448171875, "post_id": 33832193, "comment_id": 55468413, "body": "yes, this order is rare, but I have to. the lua script of redis take args like that.  thank you, it works well"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1471849827, "last_edit_date": 1471849827, "creation_date": 1448039013, "answer_id": 33832193, "question_id": 33831908, "link": "https://stackoverflow.com/questions/33831908/how-to-take-all-keys-and-values-of-a-map-and-pass-as-args-to-a-function-in-golan/33832193#33832193", "title": "How to take all keys and values of a map and pass as args to a function in golang?", "body": "<p>We can query the length of the map with the builtin <a href=\"https://golang.org/pkg/builtin/#len\" rel=\"nofollow noreferrer\"><code>len()</code></a> function. So we can create a big-enough slice to hold all the keys and all the values.</p>\n\n<p>After that it's enough to iterate over the map only once, and you can fill the first half of the slice with the keys, and the second half of the slice with the values.</p>\n\n<p>This is as efficient as it can get: no builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\"><code>append()</code></a> is called, and we iterate over the map only once.</p>\n\n<p>Let's see an example function that will receive the keys and values. This one just prints all of them:</p>\n\n<pre><code>func pairs(keysvalues ...string) {\n    for _, s := range keysvalues {\n        fmt.Print(s, \", \")\n    }\n}\n</code></pre>\n\n<p>And the code that creates the <code>keysvalues</code> slice:</p>\n\n<pre><code>m := map[string]string{\n    \"a\": \"A\",\n    \"b\": \"B\",\n    \"c\": \"C\",\n}\n\ncount := len(m)\nall := make([]string, count*2)\n\ni := 0\nfor k, v := range m {\n    all[i], all[count+i] = k, v\n    i++\n}\n</code></pre>\n\n<p>Once you have the <code>all</code> slice, you can call the <code>pairs()</code> function like this:</p>\n\n<pre><code>pairs(all...)\n</code></pre>\n\n<p>Note though that the iteration order over a map is not deterministic, it may change from iteration to iteration.</p>\n\n<p>Example output (try it on the <a href=\"http://play.golang.org/p/DEHxsscjEZ\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>a, b, c, A, B, C, \n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>In your question you indicated that all keys come first and then follow all the values:</p>\n\n<blockquote>\n<pre><code>func(key1, key2, ..., value1, value2, ...)\n</code></pre>\n</blockquote>\n\n<p>In practice this is rare and often the key-value pairs are listed. It's much easier to work/process this variant:</p>\n\n<pre><code>func pairs(key1, value1, key2, value2, ... keyn, valuen)\n</code></pre>\n\n<p>If we would want to produce this key-value pair list, very similarly it would look like this:</p>\n\n<pre><code>count := len(m)\nall := make([]string, count*2)\n\ni := 0\nfor k, v := range m {\n    all[i], all[i+1] = k, v\n    i += 2\n}\n</code></pre>\n"}], "owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1283, "favorite_count": 1, "accepted_answer_id": 33832193, "answer_count": 2, "score": 3, "last_activity_date": 1471849827, "creation_date": 1448038082, "last_edit_date": 1448040460, "question_id": 33831908, "link": "https://stackoverflow.com/questions/33831908/how-to-take-all-keys-and-values-of-a-map-and-pass-as-args-to-a-function-in-golan", "title": "How to take all keys and values of a map and pass as args to a function in golang?", "body": "<p>I encountered such a situation\uff1a</p>\n\n<p>Got a map first, and <strong>its size is unknown</strong>.</p>\n\n<p>E.g.: <code>myMap map[string]string</code></p>\n\n<p>And then, I would take all the keys and values of the map as a function's args</p>\n\n<p>e.g <code>func(key1, key2, ..., value1, value2, ...)</code></p>\n\n<p>An example func: <a href=\"https://godoc.org/github.com/garyburd/redigo/redis#Script.Do\" rel=\"nofollow\">https://godoc.org/github.com/garyburd/redigo/redis#Script.Do</a></p>\n\n<p>How to achieve this in go?</p>\n\n<p>As efficient as impossible.</p>\n\n<p>Any help will be appreciated :)</p>\n"}, {"tags": ["intellij-idea", "go"], "answers": [{"comments": [{"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "edited": false, "score": 0, "creation_date": 1465490739, "post_id": 33843764, "comment_id": 62934724, "body": "My issue is that I don&#39;t know what my &quot;system environment&quot; is. IntelliJ is detecting a GOPATH value that doesn&#39;t seem to exist anywhere on my file system. I grep&#39;d the entire disk and was unable to find the magical GOPATH value that IntelliJ is reading from my &quot;system environment.&quot;"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "edited": false, "score": 0, "creation_date": 1465597305, "post_id": 33843764, "comment_id": 62985138, "body": "The plugin won&#39;t use magic so there are a few places where you can search for this which come to mind: - idea.sh or your equivalent on your OS - if you are launching this from the command line then use <code>go env</code> to figure out this (it might be from your shell) - if you are launching this from an UI then check that please  Finally, if this doesn&#39;t help, please open an issue on the tracker <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/new\" rel=\"nofollow noreferrer\">github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/new</a> and explain it as much as possible. Thank you!"}, {"owner": {"reputation": 696, "user_id": 1364759, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3b01238f289cc93432a681999f9e07d8?s=128&d=identicon&r=PG", "display_name": "Shadoninja", "link": "https://stackoverflow.com/users/1364759/shadoninja"}, "edited": false, "score": 0, "creation_date": 1465789418, "post_id": 33843764, "comment_id": 63030321, "body": "It was reading it from my ~/.profile file. I am running CentOS 7. Tricky!"}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 0, "last_activity_date": 1448111601, "creation_date": 1448111601, "answer_id": 33843764, "question_id": 33831719, "link": "https://stackoverflow.com/questions/33831719/what-is-the-meaning-of-system-environment-in-intellijs-golang-plugin/33843764#33843764", "title": "What is the meaning of &quot;system environment&quot; in IntelliJ&#39;s golang plugin?", "body": "<p>the Go plugin currently uses the term Go Libraries for different GOPATH values.\nIf you have a single GOPATH that you'd like to use for all the projects, then you can add it to the \"Global Libraries\". For example, my $GOPATH is /home/florin/golang and in the plugin I've set the Global Libraries from the Go Libraries setting to reflect that (see this screenshot).</p>\n\n<p><a href=\"https://i.stack.imgur.com/6KdUl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6KdUl.png\" alt=\"Single GOPATH manual setting\"></a></p>\n\n<p>If the plugin can automatically detect the GOPATH, and you have the check box ticked for that, then the plugin will try and use that value as the GOPATH value, see the next screenshot</p>\n\n<p><a href=\"https://i.stack.imgur.com/7McBh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7McBh.png\" alt=\"Automaticaly detected GOPATH\"></a></p>\n\n<p>Also, the plugin has three different types of GOPATH values right now:</p>\n\n<ul>\n<li>the Global Libraries -> you should set GOPATH entries here for GOPATH values that you want to share between different projects (most use-cases)</li>\n<li>Project Libraries -> you should set the GOPATH entries here for GOPATH values that are specific to the current project only (when you want to have a single GOPATH per project approach)</li>\n<li>Module Libraries -> this is a very specific setting, it's only used in case you have different modules in your project and you want to have a different GOPATH configuration for each of the modules. The module in this case is a specific logical grouping of the source code in the IDE, not in the packages that the Go project uses (think of the ability to have a Python module, a Go module and an Android module all in the same project).</li>\n</ul>\n\n<p>There's a ticket that plans to simplify this further and your input will be included.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 33843764, "answer_count": 1, "score": 0, "last_activity_date": 1459470518, "creation_date": 1448037565, "last_edit_date": 1459470518, "question_id": 33831719, "link": "https://stackoverflow.com/questions/33831719/what-is-the-meaning-of-system-environment-in-intellijs-golang-plugin", "title": "What is the meaning of &quot;system environment&quot; in IntelliJ&#39;s golang plugin?", "body": "<p><a href=\"https://i.stack.imgur.com/RVwuk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RVwuk.png\" alt=\"enter image description here\"></a>I was attempting to use intellij's golang plugin, but it sais there is no GOPATH defined.</p>\n\n<ul>\n<li>the plugin allows you to configure some sort of \"GO Libraries\" window, however</li>\n<li>Its not clear what the configuration is meant to do, and there are no tool tips regarding what should be entered.</li>\n<li>There are \"global libraries\", \"project libraries\", and so on defined.  </li>\n</ul>\n\n<p>In my case, I simply want to use a GOPATH.</p>\n\n<p>Screenshot attached:  The primary question here: How and where should I set GOPATH when using intellij's Golang plugin?  </p>\n\n<p><strong>Some context:</strong> I don't mind setting gopath globally on my mac, but it seems that is a heavy-handed approach for an IDE to use**</p>\n"}, {"tags": ["algorithm", "go", "precision"], "comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 2, "creation_date": 1448038189, "post_id": 33831699, "comment_id": 55429005, "body": "This is a standard rounding error that is fundamental to any implementation of binary floating point (or any base other than 10). For a deeper background see <a href=\"http://floating-point-gui.de/\" rel=\"nofollow noreferrer\">floating-point-gui.de</a>"}, {"owner": {"reputation": 9, "user_id": 5586250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b227c8b90729fed14591e29fb6519c38?s=128&d=identicon&r=PG&f=1", "display_name": "user5586250", "link": "https://stackoverflow.com/users/5586250/user5586250"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1448139452, "post_id": 33831699, "comment_id": 55461582, "body": "I thought that if you write a number on the base 10, the program must keep it and perform operations in the same format?"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1448142512, "post_id": 33831699, "comment_id": 55462434, "body": "That was your mistake. Hopefully the links will help you understand floating point better. Good luck!"}], "owner": {"reputation": 9, "user_id": 5586250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b227c8b90729fed14591e29fb6519c38?s=128&d=identicon&r=PG&f=1", "display_name": "user5586250", "link": "https://stackoverflow.com/users/5586250/user5586250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1448038147, "answer_count": 0, "score": 0, "last_activity_date": 1448037482, "creation_date": 1448037482, "question_id": 33831699, "link": "https://stackoverflow.com/questions/33831699/golang-how-to-work-with-floating-point-numbers", "closed_reason": "Duplicate", "title": "Golang: How to Work With Floating Point Numbers?", "body": "<p>I was very surprised when started to work with the type of floating-point (float32 &amp; float64).\nIn this example, I have collected only a few options from the set:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var sum, price, count float64\n    sum, price, count = 1000, 166.67, 5\n    fmt.Printf(\"%v - %v * %v = %v\\n\", sum, price, count, sum-price*count)\n    price, count = 7.35, 3\n    fmt.Printf(\"%v * %v = %v\\n\", price, count, price*count)\n    var a, b, c float64\n    a, b = 2, 1.1\n    fmt.Printf(\"%v - %v = %v\\n\", a, b, a-b)\n    a, b, c = 0.1, 0.2, 0.3\n    fmt.Printf(\"%v + %v - %v = %v\\n\", a, b, c, a+b-c)\n}\n</code></pre>\n\n<p>It prints:</p>\n\n<pre><code>1000 - 166.67 * 5 = 166.6500000000001\n7.35 * 3 = 22.049999999999997\n2 - 1.1 = 0.8999999999999999\n0.1 + 0.2 - 0.3 = 5.551115123125783e-17\n2.4 / 0.1 = 23.999999999999996\n</code></pre>\n\n<p>The problem occurs after the execution of arithmetic operations: +, -, *, /</p>\n\n<p>Now I'm absolutely not sure that my algorithm would give me the correct result.</p>\n\n<p>I solved the problem by normalized the value after each operation - rounded up to the lower accuracy than the error:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    var sum, price, count float64\n    sum, price, count = 1000, 166.67, 5\n    fmt.Printf(\"%v - %v * %v = %v\\n\", sum, price, count, Normalize(sum-price*count))\n    price, count = 7.35, 3\n    fmt.Printf(\"%v * %v = %v\\n\", price, count, Normalize(price*count))\n    var a, b, c float64\n    a, b = 2, 1.1\n    fmt.Printf(\"%v - %v = %v\\n\", a, b, Normalize(a-b))\n    a, b, c = 0.1, 0.2, 0.3\n    fmt.Printf(\"%v + %v - %v = %v\\n\", a, b, c, Normalize(a+b-c))\n    a, b = 2.4, 0.1\n    fmt.Printf(\"%v / %v = %v\\n\", a, b, Normalize(a/b))\n}\n\nfunc Normalize(value float64) float64 {\n    return RoundViaFloat(value, 4)\n}\n\nfunc RoundViaFloat(x float64, prec int) float64 {\n    var rounder float64\n    pow := math.Pow(10, float64(prec))\n    intermed := x * pow\n    _, frac := math.Modf(intermed)\n    x = .5\n    if frac &lt; 0.0 {\n        x = -.5\n    }\n    if frac &gt;= x {\n        rounder = math.Ceil(intermed)\n    } else {\n        rounder = math.Floor(intermed)\n    }\n    return rounder / pow\n}\n</code></pre>\n\n<p>It prints:</p>\n\n<pre><code>1000 - 166.67 * 5 = 166.65\n7.35 * 3 = 22.05\n2 - 1.1 = 0.9\n0.1 + 0.2 - 0.3 = 0\n2.4 / 0.1 = 24\n</code></pre>\n\n<p>But it seems to me, is not normal :-(</p>\n\n<p><strong>Can anyone help me solve this problem?</strong></p>\n\n<p>thanx</p>\n"}, {"tags": ["struct", "go"], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1448050893, "post_id": 33831574, "comment_id": 55436102, "body": "Yes, that&#39;s exactly what I wanted. Why did I use <code>struct</code> as a return type in the first place!? While your answer is really clear and concise, I&#39;ll have to mark @icza&#39;s as the right one since it was more elaborate and actually provided the embedded type solution first. Appreciate it though. Thanks!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1448038209, "last_edit_date": 1448038209, "creation_date": 1448037078, "answer_id": 33831574, "question_id": 33831454, "link": "https://stackoverflow.com/questions/33831454/unexpected-return-of-anonymous-struct/33831574#33831574", "title": "Unexpected return of anonymous struct", "body": "<p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n\n<p><a href=\"https://golang.org/ref/spec#Keywords\" rel=\"nofollow\">Keywords</a></p>\n\n<p>The following keywords are reserved and may not be used as identifiers.</p>\n\n<pre><code>break        default      func         interface    select\ncase         defer        go           map          struct\nchan         else         goto         package      switch\nconst        fallthrough  if           range        type\ncontinue     for          import       return       var\n</code></pre>\n\n<p>.</p>\n\n<pre><code>func (p *Project) OmitUsername() *struct {\n}\n</code></pre>\n\n<p><code>struct</code> is a reserved keyword.</p>\n\n<p>Without more information about what you are trying to do, it's hard to know what you want, pehaps something like this?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n)\n\ntype Scheme struct{}\n\ntype Project struct {\n    Id     uint\n    Alias  string\n    Data   *json.RawMessage\n    Scheme Scheme\n}\n\ntype UserProject struct {\n    Username string\n    Project\n}\n\nfunc (u *UserProject) GetProject() *Project {\n    return &amp;u.Project\n}\n\nfunc main() {}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 1, "creation_date": 1448051012, "post_id": 33831833, "comment_id": 55436167, "body": "While your answer is very elaborate and open new knowledge for me. So, the <code>struct</code> isn&#39;t a type without its definition! That&#39;s something I never knew before."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1448054831, "post_id": 33831833, "comment_id": 55437979, "body": "However, the embedded type does introduce more complexity when declaring new values for <code>Project</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1504793282, "last_edit_date": 1504793282, "creation_date": 1448037903, "answer_id": 33831833, "question_id": 33831454, "link": "https://stackoverflow.com/questions/33831454/unexpected-return-of-anonymous-struct/33831833#33831833", "title": "Unexpected return of anonymous struct", "body": "<h3>With \"truly\" anonymous struct return value</h3>\n\n<p>If you want to use an anonymous struct return value, that's gonna look really ugly.</p>\n\n<p>Why? Because when you define the return type, you have to describe the anonymous struct. And when you write a <code>return</code> statement, you have to provide the return value which will be a struct literal. A struct literal for an anonymous struct also has to describe the struct!</p>\n\n<p>When you attempt to write this:</p>\n\n<pre><code>func (p *Project) OmitUsername() *struct {\n    // return somethig\n}\n</code></pre>\n\n<p>This syntax is not what you think: it doesn't contain the struct definition. Basically in your example the first <code>{</code> is the opening bracket of the anonymous struct definition, and <strong>not</strong> the opening bracket of the function body. And as such, the subsequent <code>return</code> is interpreted as being inside the anonymous struct definition which is invalid syntax, this is exactly what the error message states too (<code>\"syntax error: unexpected return\"</code>).</p>\n\n<p>It should look like this:</p>\n\n<pre><code>func (p *Project) OmitUsername() *struct {\n    Id     uint\n    Alias  string\n    Data   *json.RawMessage\n    Scheme Scheme\n} {\n    // And now here comes the return statement\n}\n</code></pre>\n\n<p>And if you also add the return statement which has to repeat the anonymous struct definition:</p>\n\n<pre><code>func (p *Project) OmitUsername() *struct {\n    Id     uint\n    Alias  string\n    Data   *json.RawMessage\n    Scheme Scheme\n} {\n    return &amp;struct {\n        Id     uint\n        Alias  string\n        Data   *json.RawMessage\n        Scheme Scheme\n    }{p.Id, p.Alias, p.Data, p.Scheme}\n}\n</code></pre>\n\n<p>Yes, it's ugly. You can make it a little simpler by using named return value, and not returning a pointer, because zero value of pointers is <code>nil</code>, and to return something, you'd have to initialize it which would also involve repeating the anonymous struct! If you use a non-pointer, named return value, you will have a value of the anonymous struct right away, and you don't have to repeat the anonymous struct definition again, just assign values to its fields:</p>\n\n<pre><code>func (p *Project) OmitUsername2() (ret struct {\n    Id     uint\n    Alias  string\n    Data   *json.RawMessage\n    Scheme Scheme\n}) {\n    ret.Id = p.Id\n    ret.Alias = p.Alias\n    ret.Data = p.Data\n    ret.Scheme = p.Scheme\n    return\n}\n</code></pre>\n\n<p>Using them:</p>\n\n<pre><code>p := Project{\"Bob\", 1, \"bobie\", nil, nil}\nfmt.Println(p.OmitUsername())\nfmt.Println(p.OmitUsername2())\n</code></pre>\n\n<p>Output (try these on the <a href=\"http://play.golang.org/p/YLSTOwDjsC\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{1 bobie &lt;nil&gt; &lt;nil&gt;}\n{1 bobie &lt;nil&gt; &lt;nil&gt;}\n</code></pre>\n\n<p>Still ugly...</p>\n\n<h3>With another named type, using embedding</h3>\n\n<p>...Best would be to provide another named type to return and not an anonymous struct. You may utilize <em>embedding</em> to make this solution practical and short:</p>\n\n<pre><code>type BaseProject struct {\n    Id     uint\n    Alias  string\n    Data   *json.RawMessage\n    Scheme Scheme\n}\n\ntype Project struct {\n    BaseProject\n    Username string\n}\n\nfunc (p *Project) OmitUsername() BaseProject {\n    return p.BaseProject\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>p := Project{BaseProject{1, \"bobie\", nil, nil}, \"Bob\"}\nfmt.Println(p.OmitUsername())\n</code></pre>\n\n<p>Output (try this on the <a href=\"http://play.golang.org/p/QUv9SO-E1X\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{1 bobie &lt;nil&gt; &lt;nil&gt;}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Embedding is not really necessary, but this way the fields of the embedded type (<code>BaseProject</code>) will be promoted and so you can refer to them like <code>p.Id</code> as if they were defined in <code>Project</code>. Defining it as a regular field would also work.</p>\n"}], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2919, "favorite_count": 2, "accepted_answer_id": 33831833, "answer_count": 2, "score": 4, "last_activity_date": 1504793282, "creation_date": 1448036740, "last_edit_date": 1448040607, "question_id": 33831454, "link": "https://stackoverflow.com/questions/33831454/unexpected-return-of-anonymous-struct", "title": "Unexpected return of anonymous struct", "body": "<p>I am trying to implement a method that returns a modified struct based on the original one, such as:</p>\n\n<pre><code>type Project struct {\n    Username string           \n    Id       uint      \n    Alias    string           \n    Data     *json.RawMessage \n    Scheme   Scheme          \n}\n\nfunc (p *Project) OmitUsername() *struct {\n\n    return &amp;struct {\n        Id      uint         \n        Alias   string   \n        Data    *json.RawMessage\n        Scheme  Scheme          \n    }{\n        p.Id,\n        p.Alias,\n        p.Data,\n        p.Scheme\n    })\n}\n</code></pre>\n\n<p>And I get the following error:</p>\n\n<pre><code>models/project.go:22: syntax error: unexpected return \nmodels/project.go:24: non-declaration statement outside function body \nmodels/project.go:25: non-declaration statement outside function body \nmodels/project.go:25: syntax error: unexpected string literal, expecting semicolon or newline \nmodels/project.go:26: non-declaration statement outside function body\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["go", "concurrency", "httpserver"], "comments": [{"owner": {"reputation": 175, "user_id": 1071180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249c231021b499fb02bd0642af21f63f?s=128&d=identicon&r=PG", "display_name": "Gladmir", "link": "https://stackoverflow.com/users/1071180/gladmir"}, "edited": false, "score": 0, "creation_date": 1448036224, "post_id": 33830945, "comment_id": 55427673, "body": "Your response is always http 204 even your avro serialization or kafka transport fails but I think this is not a concern in your case. In terms of concurrency, your way of doing it is completely legit and more importantly simple."}, {"owner": {"reputation": 291, "user_id": 1380169, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2c56375fda28d2bc21d65758e05eea56?s=128&d=identicon&r=PG", "display_name": "alexandra.s", "link": "https://stackoverflow.com/users/1380169/alexandra-s"}, "reply_to_user": {"reputation": 175, "user_id": 1071180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249c231021b499fb02bd0642af21f63f?s=128&d=identicon&r=PG", "display_name": "Gladmir", "link": "https://stackoverflow.com/users/1071180/gladmir"}, "edited": false, "score": 0, "creation_date": 1448036665, "post_id": 33830945, "comment_id": 55427982, "body": "@Gladmir It is intended that the response is always 204."}, {"owner": {"reputation": 175, "user_id": 1071180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249c231021b499fb02bd0642af21f63f?s=128&d=identicon&r=PG", "display_name": "Gladmir", "link": "https://stackoverflow.com/users/1071180/gladmir"}, "edited": false, "score": 0, "creation_date": 1448037371, "post_id": 33830945, "comment_id": 55428454, "body": "10K is generally acceptable :) Would you mind sharing your cpu/mem stats around 10K traffic? Also, consider these steps; a) For every http request, a new tcp socket is being created, this is cpu/mem intensive. b) Both parsing from the body and serialization are also cpu/mem intensive c) Your kafka endpoint is also streaming based (I hope) but its most probably pooled. So you have 3 choke points you need to focus on. Edit: You need profiling :)"}, {"owner": {"reputation": 291, "user_id": 1380169, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2c56375fda28d2bc21d65758e05eea56?s=128&d=identicon&r=PG", "display_name": "alexandra.s", "link": "https://stackoverflow.com/users/1380169/alexandra-s"}, "reply_to_user": {"reputation": 175, "user_id": 1071180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249c231021b499fb02bd0642af21f63f?s=128&d=identicon&r=PG", "display_name": "Gladmir", "link": "https://stackoverflow.com/users/1071180/gladmir"}, "edited": false, "score": 0, "creation_date": 1448039242, "post_id": 33830945, "comment_id": 55429635, "body": "Cpu / mem stats: 8 cores, 32GB."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1448040542, "post_id": 33830945, "comment_id": 55430351, "body": "HTTP handlers do not need to close the request body. Because HTTP handlers run in a per-connection goroutine, starting a new goroutine in handler may not provide a benefit."}], "owner": {"reputation": 291, "user_id": 1380169, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2c56375fda28d2bc21d65758e05eea56?s=128&d=identicon&r=PG", "display_name": "alexandra.s", "link": "https://stackoverflow.com/users/1380169/alexandra-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448036708, "creation_date": 1448035113, "last_edit_date": 1448036708, "question_id": 33830945, "link": "https://stackoverflow.com/questions/33830945/use-of-go-routines-in-a-go-server", "title": "Use of go routines in a Go server", "body": "<p>I need to write a simple web server in Go. It accepts requests, maps the request to avro object and sends it to Kafka. The requirement is that it answers immediately to keep the latency low for the users. Mapping to avro object and sending to Kafka can happen asynchronously. I came up with the following design, but I wonder if it is using Go structures in the intended way or if it can be optimized using channels for example. I'm omitting private methods and initializing structures. The problem is that the server can handle up to 10500 requests a second and then the response time goes up dramatically. So I was wondering if there is a way to optimize it.</p>\n\n<pre><code>func main() {\n runtime.GOMAXPROCS(runtime.NumCPU()) // not needed in Go 1.5.0\n server := &amp;Server{\n    Producer: newProducer(brokerList),\n }\n defer func() {\n    if err := server.Close(); err != nil {\n        Error.Println(\"Failed to close server\", err)\n    }\n  }()\n  Error.Fatal(server.Run(*addr))\n}\n\nfunc (s *Server) Run(addr string) error {\n  httpServer := &amp;http.Server{\n    Addr:    addr,\n    Handler: s.Handler(),\n  }\n  return httpServer.ListenAndServe()\n}\n\nfunc (s *Server) Handler() http.Handler {\n  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    defer r.Body.Close()\n    req, err := ParseRequest(r.Body)\n    if err != nil {\n        Warning.Println(\"Failed to parse request\", err.Error())\n    } else {\n        go handleRequest(s, req)\n    }\n    w.WriteHeader(204) // respond with 'no bid'\n  )\n}\n\nfunc handleRequest(s *Server, req *openrtb.BidRequest) {\n  req.Validate()\n  var avroObject, err = createAvro(req)\n  if err != nil {\n        Warning.Printf(err.Error())\n  }\n  if avroObject != nil {\n    sendToKafka(avroObject, s)\n  }\n }\n}\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code"], "answers": [{"comments": [{"owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "edited": false, "score": 11, "creation_date": 1548751081, "post_id": 33828870, "comment_id": 95643536, "body": "This is not longer up-to-date."}], "tags": [], "owner": {"reputation": 35619, "user_id": 84539, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/277f6eb5c0f422fa7bec5b1d2cb51e82?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/84539/jon"}, "is_accepted": true, "score": 5, "last_activity_date": 1448028930, "creation_date": 1448028930, "answer_id": 33828870, "question_id": 33828470, "link": "https://stackoverflow.com/questions/33828470/how-to-run-go-fmt-on-save-in-visual-studio-code/33828870#33828870", "title": "How to run `go fmt` on save, in Visual Studio Code?", "body": "<p>Its not possible at the moment but its being worked on <a href=\"https://github.com/Microsoft/vscode-go/issues/14\">https://github.com/Microsoft/vscode-go/issues/14</a></p>\n"}, {"comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1448140333, "post_id": 33843805, "comment_id": 55461815, "body": "<code>gofmt</code> takes a string (the content of the current file opened in editor) via <code>stdin</code> and gives a formatted Go code to us via <code>stdout</code> or some errors if any via <code>stderr</code>. So basically (best I wish for) I want to feed the changed content to <code>gofmt</code> and take the output and if there were no errors, save it to the file. I&#39;ll play around this to see what I can do in a meaningful timeframe (otherwise I&#39;ll fall back to LiteIDE for now). Thanks;"}], "tags": [], "owner": {"reputation": 9562, "user_id": 20489, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8daed6e147b68f7d82fde4963d30bbdb?s=128&d=identicon&r=PG", "display_name": "bingles", "link": "https://stackoverflow.com/users/20489/bingles"}, "is_accepted": false, "score": 4, "last_activity_date": 1448660407, "last_edit_date": 1448660407, "creation_date": 1448111892, "answer_id": 33843805, "question_id": 33828470, "link": "https://stackoverflow.com/questions/33828470/how-to-run-go-fmt-on-save-in-visual-studio-code/33843805#33843805", "title": "How to run `go fmt` on save, in Visual Studio Code?", "body": "<p>I'm not familiar with 'go fmt' specifically, but you can create a simple vscode extension to handle on save event and execute any arbitrary command passing the file path as an argument.</p>\n\n<p>Here's a sample that just calls <code>echo $filepath</code>:</p>\n\n<pre><code>import * as vscode from 'vscode';\nimport {exec} from 'child_process';\n\nexport function activate(context: vscode.ExtensionContext) {\n\n    vscode.window.showInformationMessage('Run command on save enabled.');\n\n    var cmd = vscode.commands.registerCommand('extension.executeOnSave', () =&gt; {\n\n        var onSave = vscode.workspace.onDidSaveTextDocument((e: vscode.TextDocument) =&gt; {\n\n            // execute some child process on save\n            var child = exec('echo ' + e.fileName);\n            child.stdout.on('data', (data) =&gt; {\n                vscode.window.showInformationMessage(data);\n            });\n        });\n        context.subscriptions.push(onSave);\n    });\n\n    context.subscriptions.push(cmd);\n}\n</code></pre>\n\n<p>And the package file:</p>\n\n<pre><code>{\n    \"name\": \"Custom onSave\",\n    \"description\": \"Execute commands on save.\",\n    \"version\": \"0.0.1\",\n    \"publisher\": \"Emeraldwalk\",\n    \"engines\": {\n        \"vscode\": \"^0.10.1\"\n    },\n    \"categories\": [\n        \"Other\"\n    ],\n    \"activationEvents\": [\n        \"onCommand:extension.executeOnSave\"\n    ],\n    \"main\": \"./out/src/extension\",\n    \"contributes\": {\n        \"commands\": [{\n            \"command\": \"extension.executeOnSave\",\n            \"title\": \"Execute on Save\"\n        }]\n    },\n    \"scripts\": {\n        \"vscode:prepublish\": \"node ./node_modules/vscode/bin/compile\",\n        \"compile\": \"node ./node_modules/vscode/bin/compile -watch -p ./\"\n    },\n    \"devDependencies\": {\n        \"typescript\": \"^1.6.2\",\n        \"vscode\": \"0.10.x\"\n    }\n}\n</code></pre>\n\n<p>The extension is enabled via cmd+shift+p then typing \"Execute on Save\", but it could be reconfigured to start via another command including \"*\" which would cause it to load any time VSCode loads.</p>\n\n<p>Once the extension is enabled, the event handler will fire whenever a file is saved (NOTE: this doesn't appear to work when file is first created or on Save as...)</p>\n\n<p>This is just a minor modification of a yo code scaffolded extension as outlined here: <a href=\"https://code.visualstudio.com/docs/extensions/example-hello-world\" rel=\"nofollow\">https://code.visualstudio.com/docs/extensions/example-hello-world</a></p>\n\n<p><strong>Update</strong></p>\n\n<p>Here's a Visual Studio Code extension I wrote for running commands on file save. <a href=\"https://marketplace.visualstudio.com/items/emeraldwalk.RunOnSave\" rel=\"nofollow\">https://marketplace.visualstudio.com/items/emeraldwalk.RunOnSave</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2384, "user_id": 102315, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c8b935f2e5d916f361ffe33fe94a3d10?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/102315/alper"}, "edited": false, "score": 1, "creation_date": 1565878325, "post_id": 53513867, "comment_id": 101490114, "body": "I think this should even be the default setting if you newly install the Go extension."}, {"owner": {"reputation": 994, "user_id": 1515111, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f37396d5b39c24a20e6a839f22e9191a?s=128&d=identicon&r=PG&f=1", "display_name": "rd22", "link": "https://stackoverflow.com/users/1515111/rd22"}, "edited": false, "score": 0, "creation_date": 1592904244, "post_id": 53513867, "comment_id": 110584664, "body": "Is there a way to change the formatting options? I have enabled the indent with space option but after the file is saved go fmt converts it back to tabs."}, {"owner": {"reputation": 4604, "user_id": 516512, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9tqAX.jpg?s=128&g=1", "display_name": "Farshid", "link": "https://stackoverflow.com/users/516512/farshid"}, "edited": false, "score": 0, "creation_date": 1618430378, "post_id": 53513867, "comment_id": 118602242, "body": "Remember that if you have a different formatter (like Prettier) already set up in VS, this solution will need a final step: You need to change the &quot;default formatter&quot; in settings to &quot;Go&quot;."}], "tags": [], "owner": {"reputation": 790, "user_id": 9131728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DAEpf.jpg?s=128&g=1", "display_name": "Yann C.", "link": "https://stackoverflow.com/users/9131728/yann-c"}, "is_accepted": false, "score": 26, "last_activity_date": 1593145041, "last_edit_date": 1593145041, "creation_date": 1543388553, "answer_id": 53513867, "question_id": 33828470, "link": "https://stackoverflow.com/questions/33828470/how-to-run-go-fmt-on-save-in-visual-studio-code/53513867#53513867", "title": "How to run `go fmt` on save, in Visual Studio Code?", "body": "<p>Now, the feature has been implemented, you can enable format on save:</p>\n<ol>\n<li>Open Settings (<code>Ctrl + ,</code>)</li>\n<li>Search for <code>editor.formatOnSave</code> and set it to <code>true</code></li>\n</ol>\n<p>Your Go code will be formatted automatically on <code>Ctrl + s</code></p>\n"}], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21971, "favorite_count": 0, "accepted_answer_id": 33828870, "answer_count": 3, "score": 20, "last_activity_date": 1618783675, "creation_date": 1448027745, "last_edit_date": 1618783675, "question_id": 33828470, "link": "https://stackoverflow.com/questions/33828470/how-to-run-go-fmt-on-save-in-visual-studio-code", "title": "How to run `go fmt` on save, in Visual Studio Code?", "body": "<p>How to make Visual Studio Code (or Go Programming Language Extension) to run <code>go fmt</code> (or other tools/commands) on save? Even auto save?</p>\n<p><strong>Update:</strong>\nIt is working now perfectly inside VSCode, at this time; just need to add some config files inside <em>.vscode</em> directory (I use <a href=\"https://github.com/dc0d/plumber/tree/master/.vscode\" rel=\"noreferrer\">these</a>).</p>\n<p><strong>Update 2019:</strong>\nThis question is old. The VSCode Go extension has all you need to develop in Go, now.</p>\n<p><strong>Last Update 2019</strong>\nBTW It worth mentioning that right above the package declaration inside your test files appears a <em>run package tests</em>. If you click it, you can see your code coverage of your code. The covered and not-covered parts are highlighted in different colors.</p>\n<p><strong>Update 2020</strong>\nAnd now, the Go Extension for VSCode, is under the supervision of Go Team! \ud83c\udf89</p>\n<p><a href=\"https://i.stack.imgur.com/fiXDF.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/fiXDF.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["arrays", "go", "append", "slice"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448016762, "post_id": 33824711, "comment_id": 55414954, "body": "<code>shortestPathSLice</code> is a 2d array of type <code>[][]int</code>. So <code>shortestPathSLice[0][index]</code> selects the int at <code>0.index</code>. The first arg for append must however be a slice, so either your <code>0</code> of <code>index</code> should be omitted."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448016853, "post_id": 33824711, "comment_id": 55415039, "body": "I think what you are trying to do is: <code>shortestPathSLice[0][index] = lowEstimate[0]</code>. That would assign int? <code>lowEstimate[0]</code> to slice index <code>0.index</code>."}, {"owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448017192, "post_id": 33824711, "comment_id": 55415308, "body": "@RickyA Thanks for replying .For 1st iteration, My LowEstimate array is :  [6 12 12 18 27] and I want shortestPathSLice as [[0 6 0 0 0]]  For 2nditeration, My LowEstimate array is :  [35 37 38 39] and I want shortestPathSLice as [[0 6 35 0 0]]"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448017836, "post_id": 33824711, "comment_id": 55415712, "body": "Ok, that means that you should go with <code>shortestPathSLice[0][index] = lowEstimate[0]</code> in your inner loop."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448017933, "post_id": 33824711, "comment_id": 55415783, "body": "Take a look at <a href=\"https://gobyexample.com/slices\" rel=\"nofollow noreferrer\">this</a> page for initializing 2d slices"}, {"owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448017941, "post_id": 33824711, "comment_id": 55415790, "body": "@RickyA , I tried that before using append method but it gave me error like http: panic serving [::1]:49897: runtime error: index out of range"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448018104, "post_id": 33824711, "comment_id": 55415908, "body": "Yes, you need two <code>make</code> statements here. That panic is caused because the inner slice is not initialized yet. <code>make([][]int, 5)</code> creates this: <code>[[]int,[]int,[]int,[]int,[]int]</code>, not <code>[[int,int,int,int,int]]</code>"}, {"owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448018217, "post_id": 33824711, "comment_id": 55415984, "body": "@RickyA , So I made shortestPathSLice[index] = make([]int, len(lowEstimate)); shortestPathSLice[0][index] = lowEstimate[0]  but it still gave me index out of range error :( Anything you feel I am missing ?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448018409, "post_id": 33824711, "comment_id": 55416094, "body": "I think that should be <code>shortestPathSLice[0] = make([]int, len(lowEstimate))</code>, since <code>index</code> is not always 0. Can you show your code, I think you have some structural errors there."}, {"owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448018781, "post_id": 33824711, "comment_id": 55416328, "body": "var shortestPathSLice = make([][]int, 5) lowEstimate := make([]int, len(priceestimatestruct.Prices)) \tfor i := 0; i &lt; len(priceestimatestruct.Prices); i++ { \t\tlowEstimate[i] = priceestimatestruct.Prices[i].LowEstimate \t}  \tsort.Ints(lowEstimate) \tfmt.Println(&quot;LowEstimate array : &quot;, lowEstimate) \tshortestPathSLice[0] = make([]int, len(lowEstimate)) \tshortestPathSLice[0][index] = lowEstimate[0]"}, {"owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448018833, "post_id": 33824711, "comment_id": 55416357, "body": "I am sorry , I dont have enough reputations to chat with you :(  I am adding code in the question"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1448019056, "post_id": 33824711, "comment_id": 55416495, "body": "I am missing the outer loop and declaration of <code>shortestPathSLice</code>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1448026300, "last_edit_date": 1448026300, "creation_date": 1448022653, "answer_id": 33826818, "question_id": 33824711, "link": "https://stackoverflow.com/questions/33824711/dynamically-append-each-values-into-2d-slice/33826818#33826818", "title": "Dynamically append each values into 2D slice", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow\">Appending to and copying slices</a></p>\n  \n  <p>The built-in functions append and copy assist in common slice\n  operations. For both functions, the result is independent of whether\n  the memory referenced by the arguments overlaps.</p>\n  \n  <p>The variadic function append appends zero or more values x to s of\n  type S, which must be a slice type, and returns the resulting slice,\n  also of type S. The values x are passed to a parameter of type ...T\n  where T is the element type of S and the respective parameter passing\n  rules apply. As a special case, append also accepts a first argument\n  assignable to type []byte with a second argument of string type\n  followed by .... This form appends the bytes of the string.</p>\n\n<pre><code>append(s S, x ...T) S  // T is the element type of S\n</code></pre>\n  \n  <p>If the capacity of s is not large enough to fit the additional values,\n  append allocates a new, sufficiently large underlying array that fits\n  both the existing slice elements and the additional values. Otherwise,\n  append re-uses the underlying array.</p>\n</blockquote>\n\n<p>For example, using <code>append</code> and using an index,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    { // using append\n        dim := 5\n        matrix := make([][]int, dim) // dim*dim matrix\n        for i := 0; i &lt; dim; i++ {\n            matrix[i] = make([]int, 0, dim)\n            vector := make([]int, dim)\n            for j := 0; j &lt; dim; j++ {\n                vector[j] = i*dim + j\n                matrix[i] = append(matrix[i], vector[j])\n            }\n        }\n        fmt.Println(matrix)\n    }\n    { // using index\n        dim := 5\n        matrix := make([][]int, dim) // dim*dim matrix\n        for i := range matrix {\n            matrix[i] = make([]int, dim)\n            vector := make([]int, dim)\n            for j := range matrix[i] {\n                vector[j] = i*dim + j\n                matrix[i][j] = vector[j]\n            }\n        }\n        fmt.Println(matrix)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[[0 1 2 3 4] [5 6 7 8 9] [10 11 12 13 14] [15 16 17 18 19] [20 21 22 23 24]]\n[[0 1 2 3 4] [5 6 7 8 9] [10 11 12 13 14] [15 16 17 18 19] [20 21 22 23 24]]\n</code></pre>\n"}], "owner": {"reputation": 703, "user_id": 5375370, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4578caca7daa0c83e8b83735bfe35b91?s=128&d=identicon&r=PG&f=1", "display_name": "fnaticRC ggwp", "link": "https://stackoverflow.com/users/5375370/fnaticrc-ggwp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6600, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1593866519, "creation_date": 1448016385, "last_edit_date": 1593866519, "question_id": 33824711, "link": "https://stackoverflow.com/questions/33824711/dynamically-append-each-values-into-2d-slice", "title": "Dynamically append each values into 2D slice", "body": "<p>I wish to have a datastructure(array or slice) to look like this : </p>\n\n<pre><code>[[a b c d e][f g h i j] [k l m n o] [p q r s t] [u v w x y]] \n</code></pre>\n\n<p>such that a is the distance between node from \"A\" to \"A\" . (which shall be 0)\nb is the distance between node from \"A\" to \"B\" .\nc is the distance between node from \"A\" to \"C\" .</p>\n\n<p>f is the distance between node from \"B\" to \"A\" .\ng is the distance between node from \"B\" to \"B\" . (which shall be 0)\nh is the distance between node from \"B\" to \"C\" .</p>\n\n<p>Now I have created a slice like  : \n<code>var shortestPathSLice = make([][]int, 5)</code> to store this 2D data. </p>\n\n<p>In my for loop within a function, I am trying to fill this slice dynamically as follows : </p>\n\n<pre><code>shortestPathSLice = append(shortestPathSLice[0][index], lowEstimate[0])\n</code></pre>\n\n<p>where lowestimate[0] is value of the smallest distances between two nodes.</p>\n\n<p>However, I get an error with this : <strong>first argument to append must be slice; have int</strong></p>\n\n<p><strong>Can anyone tell me how can I dynamically append values in EACH ELEMENT in my slice ?</strong></p>\n\n<p>**CODE **</p>\n\n<pre><code>    var shortestPathSLice = make([][]int, 5)\n    for index := 0; index &lt; len(t.Location_ids); index++ {\n    lowEstimate := make([]int, len(priceestimatestruct.Prices))\n        for i := 0; i &lt; len(priceestimatestruct.Prices); i++ {\n            lowEstimate[i] = priceestimatestruct.Prices[i].LowEstimate\n        }\n\n        sort.Ints(lowEstimate)\n        fmt.Println(\"LowEstimate array : \", lowEstimate)\n        shortestPathSLice[0] = make([]int, len(lowEstimate))\n        shortestPathSLice[0][index] = lowEstimate[0]\n}\n</code></pre>\n"}, {"tags": ["go", "structure", "proc"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1448015688, "post_id": 33824410, "comment_id": 55414167, "body": "I do not understand your question. Maybe you could provide a minimal example which does not require knowledge of external packages."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 3327477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0d7926b947286bc9d044a0702192fb?s=128&d=identicon&r=PG&f=1", "display_name": "r3dlight", "link": "https://stackoverflow.com/users/3327477/r3dlight"}, "edited": false, "score": 0, "creation_date": 1448024417, "post_id": 33824754, "comment_id": 55419571, "body": "Many thanks icza for your clear explanation, it works perfectly now"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1448024608, "last_edit_date": 1448024608, "creation_date": 1448016520, "answer_id": 33824754, "question_id": 33824410, "link": "https://stackoverflow.com/questions/33824410/go-creating-a-structure-dynamically/33824754#33824754", "title": "Go creating a structure dynamically", "body": "<p>In statically typed languages (Go is one of them) type info (of variables, fields etc.) have to be present and compile-time, so you can't do something like:</p>\n\n<pre><code>type Info struct {\n    stat       reflect.TypeOf(sstat)\n}\n</code></pre>\n\n<p>Because <code>reflect.TypeOf()</code> is a function which will run at run-time. If you don't know the type of something, you may use <code>interface{}</code>, but then you won't get any compile-time type checking from the compiler.</p>\n\n<p>Since you just want to marshal the results, you can use <code>interface{}</code> as the type of the fields. Also note that field names must be exported (must start with a capital letter) in order to be included in JSON output.</p>\n\n<p>So try the following:</p>\n\n<pre><code>type Info struct {\n    Stat       interface{}\n    Diskstats  interface{}\n    Loadavg    interface{}\n    Meminfo    interface{}\n    Mounts     interface{}\n    Netstat    interface{}\n    Devstat    interface{}\n    Sockstat   interface{}\n    Vmstat     interface{}\n}\n\ntype infos []Info\n\ninfos := info{\n    Stat : sstat,\n    Diskstats : sdiskstats,\n    Loadavg : sloadavg,\n    Meminfo : smeminfo,\n    Mounts : smounts,\n    Netstat : snetstat,\n    Devstat : sdevstat,\n    Sockstat : ssockstat,\n    Vmstat : svmstat,\n}\n\njson.NewEncoder(w).Encode(infos)\n</code></pre>\n\n<p>Note that you could also just use a simple <code>map[string]interface{}</code>:</p>\n\n<pre><code>infos := map[string]interface{}{\n    \"stat\" : sstat,\n    \"diskstats\" : sdiskstats,\n    \"loadavg\" : sloadavg,\n    \"meminfo\" : smeminfo,\n    \"mounts\" : smounts,\n    \"netstat\" : snetstat,\n    \"devstat\" : sdevstat,\n    \"sockstat\" : ssockstat,\n    \"vmstat\" : svmstat,\n}\njson.NewEncoder(w).Encode(infos)\n</code></pre>\n\n<p>Also please do not forget about and do not omit error handling: store returned errors and check whether they are <code>nil</code>!</p>\n"}], "owner": {"reputation": 101, "user_id": 3327477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0d7926b947286bc9d044a0702192fb?s=128&d=identicon&r=PG&f=1", "display_name": "r3dlight", "link": "https://stackoverflow.com/users/3327477/r3dlight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448024608, "creation_date": 1448015554, "question_id": 33824410, "link": "https://stackoverflow.com/questions/33824410/go-creating-a-structure-dynamically", "title": "Go creating a structure dynamically", "body": "<p>This script does not work. How may I create a new struc dynamically by getting the types of incoming variables like proc.ReadStat ? (type of proc.ReadStat is *linux.Stat as shown by reflect.TypeOf() )</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    //\"html\"\n    \"log\"\n    \"net/http\"\n    //\"time\"\n    \"encoding/json\"\n    \"github.com/gorilla/mux\"\n    proc \"github.com/c9s/goprocinfo/linux\"\n)\n\n\n\nfunc sysinfo(w http.ResponseWriter, r *http.Request) {\n\n\n    sstat, _ := proc.ReadStat(\"/proc/stat\")\n    sdiskstats, _ := proc.ReadDiskStats(\"/proc/diskstats\")\n    sloadavg, _ := proc.ReadLoadAvg(\"/proc/loadavg\")\n    smeminfo,_ := proc.ReadMemInfo(\"/proc/meminfo\")\n    smounts, _ := proc.ReadMounts(\"/proc/mounts\")\n    snetstat, _ := proc.ReadNetStat(\"/proc/net/netstat\")\n    sdevstat, _ := proc.ReadNetworkStat(\"/proc/net/dev\")\n    ssockstat, _ := proc.ReadSockStat(\"/proc/net/sockstat\")\n    svmstat, _ := proc.ReadVMStat(\"/proc/vmstat\")\n\nt   /* type Info interface {\n        stat      *linux.Stat\n        diskstats []linux.DiskStat\n        loadavg   *linux.LoadAvg\n        meminfo   *linux.MemInfo\n        mounts    *linux.Mounts\n        netstat   *linux.NetStat\n        devstat   []linux.NetworkStat\n        sockstat  *linux.SockStat \n        vmstat    *linux.VMStat\n    }*/\n    type Info struct {\n        stat       reflect.TypeOf(sstat)\n        diskstats  reflect.TypeOf(sdiskstats)\n        loadavg    reflect.TypeOf(sloadavg)\n        meminfo    reflect.TypeOf(smeminfo)\n        mounts     reflect.TypeOf(smounts)\n        netstat    reflect.TypeOf(snetstat)\n        devstat    reflect.TypeOf(sdevstat)\n        sockstat   reflect.TypeOf(ssockstat)\n        vmstat     reflect.TypeOf(svmstat)\n    }\n\n    type infos []Info\n\n\n    infos := info{\n        stat : sstat,\n        diskstats : sdiskstats,\n        loadavg : sloadavg,\n        meminfo : smeminfo,\n        mounts : smounts,\n        netstat : snetstat,\n        devstat : sdevstat,\n        sockstat : ssockstat,\n        vmstat : svmstat,\n    }\n\n    json.NewEncoder(w).Encode(infos)\n\n\n}\n\nfunc main() {\n\n    router := mux.NewRouter().StrictSlash(true)\n    router.HandleFunc(\"/\", sysinfo)\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n\n}\n</code></pre>\n"}, {"tags": ["go", "scope"], "answers": [{"comments": [{"owner": {"reputation": 4647, "user_id": 1493455, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dkgT2.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1493455/rob"}, "edited": false, "score": 0, "creation_date": 1448012495, "post_id": 33823294, "comment_id": 55411996, "body": "Ah! That was so obvious I didn&#39;t see it. Great, thank you :)"}, {"owner": {"reputation": 4647, "user_id": 1493455, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dkgT2.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1493455/rob"}, "edited": false, "score": 0, "creation_date": 1448012599, "post_id": 33823294, "comment_id": 55412053, "body": "And indeed, i forgot the %s in the formatted string. But Println works well for this too."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1480971509, "last_edit_date": 1480971509, "creation_date": 1448012115, "answer_id": 33823294, "question_id": 33823209, "link": "https://stackoverflow.com/questions/33823209/variable-in-for-loop-undefined-outside/33823294#33823294", "title": "Variable in for loop undefined outside", "body": "<p>See the relevant section from the spec: <a href=\"http://golang.org/ref/spec#Declarations_and_scope\" rel=\"noreferrer\">Declarations and scope</a>:</p>\n\n<blockquote>\n  <p>The scope of a constant or variable identifier declared inside a function begins at the end of the ConstSpec or VarSpec (ShortVarDecl for short variable declarations) and <strong>ends at the end of the innermost containing block</strong>.</p>\n</blockquote>\n\n<p>Define it in the scope in which you want to access it: before the <code>for</code> (in the scope of the <code>main()</code> function).</p>\n\n<p>Also note that <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"noreferrer\"><code>fmt.Sprintf()</code></a> requires an additional parameter besides the ones to be printed: a format string. Either provide a format string (e.g. include a <code>%s</code> verb for the <code>randomString</code> parameter) or alternatively you may use <a href=\"https://golang.org/pkg/fmt/#Sprintln\" rel=\"noreferrer\"><code>fmt.Sprintln()</code></a>.</p>\n\n<pre><code>func main() {\n    var randomString string\n    for i := 0; i &lt; 10000; i++ {\n        randomString = fmt.Sprintf(\"a%sa\\n\", \"test\")\n    }\n    fmt.Println(\"Made 10000 random strings like\", randomString)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Made 10000 random strings like atesta\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/IKHK3Z_Uec\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 4647, "user_id": 1493455, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dkgT2.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1493455/rob"}, "edited": false, "score": 0, "creation_date": 1448012531, "post_id": 33823303, "comment_id": 55412018, "body": "Thanks, but I&#39;ve checked that page before asking the question - it didn&#39;t clear things out for me. I knew I had scoping issues so thats why I asked."}, {"owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "reply_to_user": {"reputation": 4647, "user_id": 1493455, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dkgT2.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1493455/rob"}, "edited": false, "score": 0, "creation_date": 1448013676, "post_id": 33823303, "comment_id": 55412820, "body": "@RobQuist The relevant part for this case would be &quot;The scope of a constant or variable identifier declared inside a function begins at the end of the ConstSpec or VarSpec (ShortVarDecl for short variable declarations) and ends at the end of the innermost containing block.&quot;"}, {"owner": {"reputation": 4647, "user_id": 1493455, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dkgT2.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1493455/rob"}, "edited": false, "score": 0, "creation_date": 1448021212, "post_id": 33823303, "comment_id": 55417742, "body": "Exactly :) Thanks for the effort though!"}], "tags": [], "owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "is_accepted": false, "score": 2, "last_activity_date": 1448012145, "creation_date": 1448012145, "answer_id": 33823303, "question_id": 33823209, "link": "https://stackoverflow.com/questions/33823209/variable-in-for-loop-undefined-outside/33823303#33823303", "title": "Variable in for loop undefined outside", "body": "<p>This is scoping issue, in Go the scope of <code>randomString</code> is the loop body, in JS it would be the whole function. Scoping rules differ in the different languages.</p>\n\n<p>Check the Go spec:</p>\n\n<p><a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">https://golang.org/ref/spec#Declarations_and_scope</a></p>\n"}], "owner": {"reputation": 4647, "user_id": 1493455, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dkgT2.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1493455/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16479, "favorite_count": 2, "accepted_answer_id": 33823294, "answer_count": 2, "score": 7, "last_activity_date": 1567235246, "creation_date": 1448011851, "last_edit_date": 1567235246, "question_id": 33823209, "link": "https://stackoverflow.com/questions/33823209/variable-in-for-loop-undefined-outside", "title": "Variable in for loop undefined outside", "body": "<p>I am wondering why the following piece of code is not working:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    for i := 0; i &lt; 10000; i++ {\n        var randomString = fmt.Sprintf(\"a%sa\\n\", \"test\")\n    }\n    fmt.Printf(\"Made 10000 random strings like\", randomString);\n}\n</code></pre>\n\n<p>I've stripped some unrelevant code (as this is obviously not really random).</p>\n\n<p>The issue i'm having is that just under the for-loop, \"randomString\" is undefined.</p>\n\n<p>I've tried setting it using <code>randomString := fmt.Sprintf()</code> and with the var you've seen above.</p>\n\n<p>I'm quite sure this is a scoping issue (the randomString variable is not in the scope outside of the for-loop), but as a PHP / JS developer, i'm not used to this and would say that variable is also available after the for loop.</p>\n\n<p>How can I access that variable from that point? Basically just displaying the last generated string.</p>\n"}, {"tags": ["go", "redis", "docker", "docker-compose"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1448004605, "post_id": 33820025, "comment_id": 55407873, "body": "before invoke the source, use telnet or nc to check the connectivity."}], "answers": [{"comments": [{"owner": {"reputation": 619, "user_id": 1009774, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1bbb715054f18161771f171463ac047e?s=128&d=identicon&r=PG", "display_name": "Mr Wilde", "link": "https://stackoverflow.com/users/1009774/mr-wilde"}, "edited": false, "score": 2, "creation_date": 1448126835, "post_id": 33823697, "comment_id": 55457298, "body": "Thank you so much. I simply changed app.go to Addr: &quot;db:6379&quot;,"}, {"owner": {"reputation": 619, "user_id": 1009774, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1bbb715054f18161771f171463ac047e?s=128&d=identicon&r=PG", "display_name": "Mr Wilde", "link": "https://stackoverflow.com/users/1009774/mr-wilde"}, "edited": false, "score": 1, "creation_date": 1448127195, "post_id": 33823697, "comment_id": 55457430, "body": "<a href=\"https://github.com/davidwilde/docker-compose-golang-redis/tree/stackoverflow_answer\" rel=\"nofollow noreferrer\">Working version on github</a>"}], "tags": [], "owner": {"reputation": 175, "user_id": 1071180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249c231021b499fb02bd0642af21f63f?s=128&d=identicon&r=PG", "display_name": "Gladmir", "link": "https://stackoverflow.com/users/1071180/gladmir"}, "is_accepted": true, "score": 7, "last_activity_date": 1448013258, "creation_date": 1448013258, "answer_id": 33823697, "question_id": 33820025, "link": "https://stackoverflow.com/questions/33820025/connecting-golang-and-redis-through-docker/33823697#33823697", "title": "Connecting golang and redis through docker", "body": "<p>So we have two different containers which means two different \"localhost\" in this case.</p>\n\n<pre><code>client := redis.NewClient(&amp;redis.Options{\n    Addr: \"localhost:6379\",\n    Password: \"\",\n    DB: 0,\n})\n</code></pre>\n\n<p>So, your app is making requests to its own sandboxed container, not to your \"other\" sandboxed container which includes redis.</p>\n\n<p>You have two options;</p>\n\n<p>Give a mapping in your compose file like redisdb:db and pass that information instead of localhost.</p>\n\n<p>Or, use the \"--net=host\" option in order to provide common networking for your containers without changing your code.</p>\n\n<p>edit: typo</p>\n"}], "owner": {"reputation": 619, "user_id": 1009774, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1bbb715054f18161771f171463ac047e?s=128&d=identicon&r=PG", "display_name": "Mr Wilde", "link": "https://stackoverflow.com/users/1009774/mr-wilde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5961, "favorite_count": 0, "accepted_answer_id": 33823697, "answer_count": 1, "score": 5, "last_activity_date": 1448127021, "creation_date": 1447999560, "last_edit_date": 1448127021, "question_id": 33820025, "link": "https://stackoverflow.com/questions/33820025/connecting-golang-and-redis-through-docker", "title": "Connecting golang and redis through docker", "body": "<p>I'm trying to connect golang and reds through Docker using docker-compose but I'm not having much luck. I have published my attempt at <a href=\"https://github.com/davidwilde/docker-compose-golang-redis/tree/stackoverflow_question\" rel=\"nofollow\">https://github.com/davidwilde/docker-compose-golang-redis/tree/stackoverflow_question</a> and listed the logs below.</p>\n\n<p>Redis says it is ready to accept connections but my golang app using <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow\">gopkg.in/redis.v3</a> says no.</p>\n\n<pre><code> ~/workspace/composetest \ue0b0 \ue0a0 master \u25cf \ue0b0 docker-compose up\nStarting composetest_db_1...\nStarting composetest_web_1...\n.\n.\n.\nur kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.\ndb_1  | 1:M 20 Nov 05:58:33.371 * DB loaded from disk: 0.000 seconds\ndb_1  | 1:M 20 Nov 05:58:33.371 * The server is now ready to accept connections on port 6379\nweb_1 | panic: dial tcp [::1]:6379: getsockopt: connection refused\nweb_1 |\nweb_1 | goroutine 1 [running]:\nweb_1 | main.main()\nweb_1 |     /go/src/app/app.go:19 +0x131\nweb_1 |\nweb_1 | goroutine 17 [syscall, locked to thread]:\nweb_1 | runtime.goexit()\nweb_1 |     /usr/local/go/src/runtime/asm_amd64.s:1696 +0x1\nweb_1 | panic: dial tcp [::1]:6379: getsockopt: connection refused\nweb_1 |\nweb_1 | goroutine 1 [running]:\nweb_1 | main.main()\nweb_1 |     /go/src/app/app.go:19 +0x131\nweb_1 |\nweb_1 | goroutine 17 [syscall, locked to thread]:\nweb_1 | runtime.goexit()\nweb_1 |     /usr/local/go/src/runtime/asm_amd64.s:1696 +0x1\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1448002704, "post_id": 33819546, "comment_id": 55407032, "body": "Basically it tests if the interface value passed to <code>panic()</code> holds a value of type <code>Exit</code>, and if so, it extracts the exit code from it and passes it to <code>os.Exit()</code>, if not, it re-panics."}, {"owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1448002800, "post_id": 33819546, "comment_id": 55407074, "body": "Yeah, I figured the flow was similar. I was really looking for what that operation is called. (TypeAssertion)"}], "owner": {"reputation": 3467, "user_id": 2958455, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4bf81a9aa9aa3619f1197c901f079268?s=128&d=identicon&r=PG", "display_name": "Jared Mackey", "link": "https://stackoverflow.com/users/2958455/jared-mackey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1447997674, "answer_count": 0, "score": 1, "last_activity_date": 1447997186, "creation_date": 1447996877, "last_edit_date": 1447997186, "question_id": 33819546, "link": "https://stackoverflow.com/questions/33819546/understanding-variable-type-in-go", "closed_reason": "Duplicate", "title": "Understanding variable.(Type) in go", "body": "<p>I don't really understand how this code works, specifically <code>e.(Exit)</code>, could someone explain?  </p>\n\n<pre><code>type Exit struct{ Code int }\nfunc handleExit() {\n    if e := recover(); e != nil {\n        if exit, ok := e.(Exit); ok == true {\n            os.Exit(exit.Code)\n        }\n        panic(e)\n     }\n}\n\nfunc main() {\n    defer handleExit()\n    panic(Exit{1})\n}\n</code></pre>\n"}, {"tags": ["android", "go"], "comments": [{"owner": {"reputation": 1210, "user_id": 2172816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbced86c37020bf376028b8ef8abc7c9?s=128&d=identicon&r=PG", "display_name": "user2172816", "link": "https://stackoverflow.com/users/2172816/user2172816"}, "edited": false, "score": 0, "creation_date": 1447991645, "post_id": 33818187, "comment_id": 55403169, "body": "Did you have <code>&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; &#47;&gt;</code> in your <code>AndroidManifest.xml</code> file?"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1447997878, "post_id": 33818187, "comment_id": 55405183, "body": "<code>adb logcat | grep &quot;GoLog&quot;</code> worked for me to filter out logs printed from the go app. Make sure usb debugging is on."}, {"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1448050182, "post_id": 33818187, "comment_id": 55435708, "body": "Yes I need permissions! thank you for your helps!"}], "answers": [{"tags": [], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1448050330, "last_edit_date": 1495542616, "creation_date": 1448050330, "answer_id": 33835327, "question_id": 33818187, "link": "https://stackoverflow.com/questions/33818187/golang-android-apps-with-gomobile-crash-when-connect-in-udp/33835327#33835327", "title": "Golang: Android apps with gomobile crash when connect in UDP", "body": "<p>By now we have to manually add permissions to AndroidManifest.xml, gomobile package is not doing that (feature request is filed). Before they implement this feature we have to do it manually.</p>\n\n<p>For more information please refer to this question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/33815541/golang-gomobile-app-cannot-generate-files/33819669#33819669\">Golang: Gomobile app cannot generate files</a></p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 33835327, "answer_count": 1, "score": 0, "last_activity_date": 1448050330, "creation_date": 1447987801, "last_edit_date": 1495541039, "question_id": 33818187, "link": "https://stackoverflow.com/questions/33818187/golang-android-apps-with-gomobile-crash-when-connect-in-udp", "title": "Golang: Android apps with gomobile crash when connect in UDP", "body": "<p>I wrote Android apps in go with mobile package, the apps crash after reaching the following code:</p>\n\n<pre><code>ServerAddr,_ := net.ResolveUDPAddr(\"udp\",SERVER_IP_AND_PORT)\nLocalAddr, _ := net.ResolveUDPAddr(\"udp\", \":0\")\nConn, err := net.DialUDP(\"udp\", LocalAddr, ServerAddr)\nbuf := []byte(\"lalala\")\n_,err := Conn.Write(buf) //apps crash on this line\n</code></pre>\n\n<p>Where (actual ip is represented by \"x\"):</p>\n\n<pre><code>const SERVER_IP_AND_PORT string = \"xxx.xx.xx.xxx:10001\" \n</code></pre>\n\n<p>I tested the code on my laptop and they work perfectly fine. I use mobile package only for creating apk files to do the UDP tests. </p>\n\n<p>I tried to use \"log\" package to trace errors but it doesn't work. I downloaded many logcat apps but none can catch the error logs (or even log.Print(\"AAA\")). I also tried to write logs in files but don't work either, please check out <a href=\"https://stackoverflow.com/questions/33815541/golang-gomobile-app-cannot-generate-files\">this question</a>.</p>\n\n<p>Anyway, does anyone have any idea about what the problem is, or any ways to locate the bug? (And please avoid using Android Studio which I have a thousand more problems to even install it correctly)</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["pointers", "dictionary", "go", "slice"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 2, "creation_date": 1447985186, "post_id": 33817562, "comment_id": 55401397, "body": "Perhaps if you express the desired outcome and what <code>respond</code> does exactly, we could help better than recommending something as unfriendly as <code>map[string][]interface{}</code>, which may be too generic. As your question is currently worded, it&#39;s difficult to know what to recommend because it&#39;s impossible to know what your goal with <code>respond</code> is. You provided too few details about what you want to do for anybody to provide a good recommendation. What does <code>respond</code> do? What is <code>*params</code> and how does it affect things?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1500912031, "last_edit_date": 1500912031, "creation_date": 1448002526, "answer_id": 33820698, "question_id": 33817562, "link": "https://stackoverflow.com/questions/33817562/generic-value-type-of-go-map/33820698#33820698", "title": "Generic value type of Go map", "body": "<p>So generally you store <code>[]string</code> values for <code>string</code> keys. Most of the time. And once in a while you'd like to store a <code>map[string][]string</code> value for a <code>string</code> key.</p>\n\n<p>First, drop the pointer from the map type: maps are already small descriptors, you can pass maps which will pass a copy of the descriptor and not the whole content, and if you add a new key-value pair to the copy, you will see that in the original. Passing a map by value is efficient and has the desired effect / working.</p>\n\n<p><sup>To be precise: map types are actually pointers to a map descriptor under the hood, but this is an implementation detail, you don't need to know this to use / work with maps. Only thing that matters is you can pass around map values efficiently.</sup></p>\n\n<p>Keeping only one map and being able to store values of both type <code>[]string</code> and <code>map[string][]string</code> would require you to change the value type to <code>interface{}</code>, but then this would require you to use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">Type assertion</a> every time you access an element in the params map, something like:</p>\n\n<pre><code>params := map[string]interface{}{}\nparams[\"a\"] = []string{\"b\", \"c\"}\n\nif list, ok := params[\"a\"].([]string); ok {\n    fmt.Println(list)\n}\n</code></pre>\n\n<p>Of course you could create a new type with <code>map[string]interface{}</code> being its underlying type, and add <code>Get()</code> and <code>Set()</code> methods for the most common value type <code>[]string</code>, but instead I recommend a wrapper <code>struct</code> for the params, with multiple maps in multiple fields:</p>\n\n<pre><code>type Params struct {\n    P map[string][]string\n    M map[string]map[string][]string\n}\n</code></pre>\n\n<p>Your code may use the map whichever has the value type that suits the value to be stored, for example:</p>\n\n<pre><code>params2 := Params{map[string][]string{}, map[string]map[string][]string{}}\nparams2.P[\"a\"] = []string{\"b\", \"c\"}\n\nparams2.M[\"B\"] = map[string][]string{\n    \"x\": []string{\"X\", \"Y\"},\n}\n\nfmt.Println(params2.P[\"a\"])\nfmt.Println(params2.M[\"B\"])\n</code></pre>\n\n<p>You may also add <code>Get()</code> and <code>Set()</code> methods to <code>Params</code> that get and set elements from the most frequently used <code>Params.P</code> map.</p>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/mV96TD8vH3\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 429, "user_id": 3957528, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9cl47.jpg?s=128&g=1", "display_name": "Hua2308", "link": "https://stackoverflow.com/users/3957528/hua2308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2368, "favorite_count": 0, "accepted_answer_id": 33820698, "answer_count": 1, "score": 1, "last_activity_date": 1500912253, "creation_date": 1447983454, "last_edit_date": 1500912253, "question_id": 33817562, "link": "https://stackoverflow.com/questions/33817562/generic-value-type-of-go-map", "title": "Generic value type of Go map", "body": "<p>I am working on a web app with Go language. The <code>respond(writer, html, *params)</code> function needs a list of parameters which can be used to render an HTML page. I came up with a map as this which works fine:</p>\n\n<pre><code>&amp;map[string][]string\n</code></pre>\n\n<p>However, recently I need to squeeze in a value pair in the format of <code>{string, map[string][]string}</code> which obviously blew up the compiler. So I am wondering if there is any generic type I can utilize, i.e. <code>map[string]GenericType</code>.</p>\n\n<p>Any thoughts is welcomed.</p>\n"}, {"tags": ["go", "gomobile"], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1448048342, "post_id": 33819669, "comment_id": 55434690, "body": "A few comments for people who is looking for solution:"}, {"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1448048381, "post_id": 33819669, "comment_id": 55434710, "body": "<a href=\"http://stackoverflow.com/questions/3593420/is-there-a-way-to-get-the-source-code-from-an-apk-file\" title=\"is there a way to get the source code from an apk file\">stackoverflow.com/questions/3593420/&hellip;</a>"}, {"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1448048455, "post_id": 33819669, "comment_id": 55434755, "body": "Step 3 of that solution can extract xml files. After finish modification put the modified xml under the same directory of the .go file(s) and compile as usual, gomobile will compile with the new xml file together."}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 2, "last_activity_date": 1447997562, "creation_date": 1447997562, "answer_id": 33819669, "question_id": 33815541, "link": "https://stackoverflow.com/questions/33815541/golang-gomobile-app-cannot-generate-files/33819669#33819669", "title": "Golang: Gomobile app cannot generate files", "body": "<p>To write to a file your app needs some form of permission. </p>\n\n<p>If you don't have one create an <code>AndroidManifest.xml</code>. You can see the content of the file <code>gomobile</code> automatically create for you using the <code>-v</code> flag. (<code>gomobile build -v</code>)</p>\n\n<p>Add the following line between <code>&lt;manifest&gt;</code> and <code>&lt;/manifest&gt;</code> tags.  </p>\n\n<p><code>&lt;uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" /&gt;</code></p>\n\n<p>Build the app again. Make sure <code>gomobile</code> is using your manifest file using the <code>-v</code> flag. I was able to create the file by <code>os.Create(\"/sdcard/zzz.txt\")</code>. I also needed this for debugging so I didn't mind writing to a specific location, namely my sdcard.\nOf course in your phone the location may change.  </p>\n\n<p>Additionally, If you just want some logs you can install Android Debug Bridge and use <a href=\"http://developer.android.com/tools/help/logcat.html\" rel=\"nofollow\">adb logcat</a>. To filter out the logs from your Go app <code>adb logcat | grep \"I/GoLog\"</code> would work.</p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1578, "favorite_count": 0, "accepted_answer_id": 33819669, "answer_count": 1, "score": 1, "last_activity_date": 1496242182, "creation_date": 1447972124, "last_edit_date": 1496242182, "question_id": 33815541, "link": "https://stackoverflow.com/questions/33815541/golang-gomobile-app-cannot-generate-files", "title": "Golang: Gomobile app cannot generate files", "body": "<p>Does anyone use gomobile app before and have successfully create files in phones? I tried the following code on Galaxy S4 with Android 4.4.2:</p>\n\n<pre><code>package main\nimport (\n    \"golang.org/x/mobile/app\"\n    \"golang.org/x/mobile/event/lifecycle\"\n    \"golang.org/x/mobile/event/paint\"\n    \"os\"\n)\nfunc main() {\n    os.Create(\"zzz.txt\")\n    app.Main(func(a app.App) {\n        for e := range a.Events() {\n            switch e := a.Filter(e).(type) {\n            case lifecycle.Event:\n                _=e\n            case paint.Event:\n                a.Publish()\n            }\n        }\n    })\n}\n</code></pre>\n\n<p>However no file is created in the phone.</p>\n\n<p>I also tried an app called \"AnGoIde\" which allow us to write Go and compile directly in Android, and the following code is able to create the \"zzz.txt\" file:</p>\n\n<pre><code>package main\nimport \"os\"\nfunc main(){\n    os.Create(\"zzz.txt\")\n}\n</code></pre>\n\n<p>Eventually I would like to save all errors in a file so I can see what cause my apps to crash, and AnGoIde doesn't support many packages so I cannot use it for my tests. Does anyone successfully generated files with gomobile apps before?</p>\n\n<p>p.s. I tried to specify the directory to \"/storage/emulated/0/Go/\" which is the same place I store the apk file but doesn't work.</p>\n"}, {"tags": ["arrays", "mongodb", "go", "bson"], "comments": [{"owner": {"reputation": 1017, "user_id": 2576956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/98TKO.jpg?s=128&g=1", "display_name": "bvpx", "link": "https://stackoverflow.com/users/2576956/bvpx"}, "edited": false, "score": 2, "creation_date": 1447967380, "post_id": 33814370, "comment_id": 55394337, "body": "Can you share more code / please specify the mongo DB driver you&#39;re using"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1447970638, "post_id": 33814370, "comment_id": 55396043, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33045404/golang-mongodb-mgo-is-not-inserting-docs\">golang mongodb (mgo) is not inserting docs</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 4, "last_activity_date": 1447975306, "creation_date": 1447975306, "answer_id": 33816195, "question_id": 33814370, "link": "https://stackoverflow.com/questions/33814370/store-slices-and-nested-structures-in-mongodb-golang/33816195#33816195", "title": "Store slices and nested structures in MongoDB Golang", "body": "<p>You need to <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">export</a> the field names by starting the field name with an uppercase letter. Use the bson field tag to specify the named used in the database.</p>\n\n<pre><code>type A struct {\n  Feature []string `bson:\"feature\"`\n}\n\ntype B struct {\n  Title string       `bson:\"title\"`\n  Other_feature []A  `bson:\"other_feature\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5583243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f23b808648bba2dd06e9e8c8c94ca2?s=128&d=identicon&r=PG&f=1", "display_name": "Sebmon", "link": "https://stackoverflow.com/users/5583243/sebmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1447975306, "creation_date": 1447967226, "question_id": 33814370, "link": "https://stackoverflow.com/questions/33814370/store-slices-and-nested-structures-in-mongodb-golang", "title": "Store slices and nested structures in MongoDB Golang", "body": "<p>I have built a program in Go with the next structure</p>\n\n<pre><code>type A struct {\n  feature []string\n}\n\ntype B struct {\n  title string\n  other_feature []A\n}\n</code></pre>\n\n<p>I tried to use the bson package but only the title appears on the database after execution. Does anyone have a solution?</p>\n"}]