[{"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1453327997, "post_id": 34910997, "comment_id": 57558910, "body": "I was able to reproduce this and now it&#39;s working with the same code posted by OP. Try using <a href=\"http://www.gorillatoolkit.org/pkg/mux#Route.GetError\" rel=\"nofollow noreferrer\">GetError()</a> to see if registering a route gives you any issue. Something like:   <code>err := router.Methods(route.Method).Path(route.Pattern).Name(route.&zwnj;&#8203;Name).Handler(route.&zwnj;&#8203;HandlerFunc).GetErro&zwnj;&#8203;r()</code>"}, {"owner": {"reputation": 121, "user_id": 2066888, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lpund.png?s=128&g=1", "display_name": "CGideon", "link": "https://stackoverflow.com/users/2066888/cgideon"}, "reply_to_user": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1453329162, "post_id": 34910997, "comment_id": 57559444, "body": "Adding .GetError() didn&#39;t return anything different then what I currently see."}, {"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1453329245, "post_id": 34910997, "comment_id": 57559485, "body": "Weird ... last thing I did that made it work was remove the <code>.Name()</code> function call when registering the routes.. try doing that and make sure you are not caching the responses."}, {"owner": {"reputation": 121, "user_id": 2066888, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lpund.png?s=128&g=1", "display_name": "CGideon", "link": "https://stackoverflow.com/users/2066888/cgideon"}, "reply_to_user": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1453329478, "post_id": 34910997, "comment_id": 57559601, "body": "Removed the .Name() call and the appropriate field in the Route and still no luck, I&#39;ve added my updated Router.go file to the question."}, {"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1453329861, "post_id": 34910997, "comment_id": 57559751, "body": "Oh .. make sure to save the returned error:   <code>err := router.Methods()...GetError()</code> and check if it returns an error <code>if err != nil{ log.Println(err) }</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453331911, "post_id": 34910997, "comment_id": 57560596, "body": "Are you certain you&#39;re working with the version of your router package shown here? Try putting all your code into one <code>main</code> file and testing the routes from there."}, {"owner": {"reputation": 121, "user_id": 2066888, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lpund.png?s=128&g=1", "display_name": "CGideon", "link": "https://stackoverflow.com/users/2066888/cgideon"}, "reply_to_user": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1453383648, "post_id": 34910997, "comment_id": 57584086, "body": "@AbelardoMendoza I added the code you suggested and this is all it output  2016/01/21 07:38:44 &amp;{0xc8200124b0 0x5c840 [[GET] 0xc820018180] 0xc820010d20 true false Index &lt;nil&gt; &lt;nil&gt;} but I was able to get it to work. I don&#39;t know what I did to fix it, but I deleted the route, ran the app, then recreated the route with a different name and calling a different HandlerFunc and it works. There must have been a typo or artifact that it was holding onto."}, {"owner": {"reputation": 121, "user_id": 2066888, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lpund.png?s=128&g=1", "display_name": "CGideon", "link": "https://stackoverflow.com/users/2066888/cgideon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453384126, "post_id": 34910997, "comment_id": 57584430, "body": "@JimB I think you were onto the route cause of the problem, since my Router.go is in a different package than my Main.go it pulls in a copy of Router.go to the same directory instead of referencing the one in the subfolder. I&#39;m thinking it wasn&#39;t pulling in the newest version of the Router.go because I was able to get it to run after removing the copied files and then running the app. Then adding in the route again."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1453389621, "post_id": 34926343, "comment_id": 57588446, "body": "Do not use relative imports. Always import via the full path to avoid this, and other problems."}], "tags": [], "owner": {"reputation": 121, "user_id": 2066888, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lpund.png?s=128&g=1", "display_name": "CGideon", "link": "https://stackoverflow.com/users/2066888/cgideon"}, "is_accepted": false, "score": 1, "last_activity_date": 1453386282, "creation_date": 1453386282, "answer_id": 34926343, "question_id": 34910997, "link": "https://stackoverflow.com/questions/34910997/gorilla-mux-routes-not-resolving/34926343#34926343", "title": "Gorilla Mux routes not resolving", "body": "<p>It appears that my project was holding onto old versions of the Router.go and Handlers.go files in the main src directory. By removing these duplicate files and re-running Main.go with go run Main.go I was able to get the route to be recognized.</p>\n"}], "owner": {"reputation": 121, "user_id": 2066888, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lpund.png?s=128&g=1", "display_name": "CGideon", "link": "https://stackoverflow.com/users/2066888/cgideon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2105, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593090845, "creation_date": 1453325549, "last_edit_date": 1495539894, "question_id": 34910997, "link": "https://stackoverflow.com/questions/34910997/gorilla-mux-routes-not-resolving", "title": "Gorilla Mux routes not resolving", "body": "<p>So, I'm working on a simple RESTful API using Go and Gorilla Mux. I'm having issues with with my second route not working, it's returning a 404 error. I'm not sure what the problem is as I'm new to Go and Gorilla. I'm sure it's something really simple, but I can't seem to find it. I think it might be a problem with the fact that I'm using different custom packages. </p>\n\n<p>This question is similar, <a href=\"https://stackoverflow.com/questions/28831190/routes-returning-404-for-mux-gorilla\">Routes returning 404 for mux gorilla</a>, but the accepted solution didn't fix my problem </p>\n\n<p>Here's what my code looks like:</p>\n\n<p>Router.go:</p>\n\n<pre><code>package router\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n)\n\ntype Route struct {\n    Name        string\n    Method      string\n    Pattern     string\n    HandlerFunc http.HandlerFunc\n}\n\ntype Routes []Route\n\nfunc NewRouter() *mux.Router {\n\nrouter := mux.NewRouter().StrictSlash(true)\n    for _, route := range routes {\n        router.\n        Methods(route.Method).\n        Path(route.Pattern).\n        Name(route.Name).\n        Handler(route.HandlerFunc)\n    }\n\n    return router\n}\n\nvar routes = Routes{\n    Route{\n        \"CandidateList\",\n        \"GET\",\n        \"/candidate\",\n        CandidateList,\n    },\n    Route{\n        \"Index\",\n        \"GET\",\n        \"/\",\n        Index,\n    },\n}\n</code></pre>\n\n<p>Handlers.go</p>\n\n<pre><code>package router\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"Welcome!\")\n}\n\nfunc CandidateList(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"CandidateList!\")\n}\n</code></pre>\n\n<p>Main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"./router\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    rout := router.NewRouter()\n    log.Fatal(http.ListenAndServe(\":8080\", rout))\n}\n</code></pre>\n\n<p>Going to just localhost:8080 returns Welcome! but going to localhost:8080/candidate returns a 404 Page Not Found error. I appreciate any input and help! Thanks!</p>\n\n<p>This is an updated version of my Router.go file, there is still the same issue happening.</p>\n\n<p>Router.go</p>\n\n<pre><code>package router\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n)\n\ntype Route struct {\n    Method      string\n    Pattern     string\n    HandlerFunc http.HandlerFunc\n}\n\ntype Routes []Route\n\nfunc NewRouter() *mux.Router {\n\n    router := mux.NewRouter().StrictSlash(true)\n    for _, route := range routes {\n        router.\n            Methods(route.Method).\n            Path(route.Pattern).\n            Handler(route.HandlerFunc).GetError()\n    }\n\n    return router\n}\n\nvar routes = Routes{\n   Route{\n      \"GET\",\n      \"/candidate\",\n      CandidateList,\n   },\n   Route{\n       \"GET\",\n       \"/\",\n       Index,\n    },\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1453325121, "post_id": 34910808, "comment_id": 57557342, "body": "<code>[]*SampleMessage != []Message</code>; you need to change <code>messages</code>&#39;s declaration to: <code>var messages []Message</code>"}, {"owner": {"reputation": 31, "user_id": 1658836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bbf3367730e912ac16022cea27ff23?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/1658836/anthony"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1453325498, "post_id": 34910808, "comment_id": 57557530, "body": "It works fine if I pass Results(messages[0], messages[1]), so why won&#39;t Results([ ]SampleMessage). I guess you might be right though"}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1453325321, "creation_date": 1453325321, "answer_id": 34910920, "question_id": 34910808, "link": "https://stackoverflow.com/questions/34910808/how-to-pass-an-interface-argument-to-a-variadic-function-in-golang/34910920#34910920", "title": "How to pass an interface argument to a variadic function in Golang?", "body": "<p>You need to restructure slightly. The issue is that a <code>[]*SampleMessage</code> cannot convert to <code>[]Message</code>. The way to handle this though, is to declare the <code>messages</code> slice as being of type <code>[]Message</code>. Then you can append instances of <code>SampleMessage</code> to it without any problems and pass them into your variadic function with the <code>...</code> syntax. Here's your example modified to compile; <a href=\"http://play.golang.org/p/cQUIZTz_vo\" rel=\"nofollow\">http://play.golang.org/p/cQUIZTz_vo</a> - only change is on the first line of main where I have <code>var messages []Message</code>. If you try to do this in the reverse order (like use a []*SampleMessages then do a conversion with <code>[]Message(messages)</code> as you pass it) it will fail. So as far as I know, this is the most practical way to solve your problem.</p>\n"}], "owner": {"reputation": 31, "user_id": 1658836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bbf3367730e912ac16022cea27ff23?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/1658836/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3297, "favorite_count": 0, "closed_date": 1453325940, "answer_count": 1, "score": 0, "last_activity_date": 1453325321, "creation_date": 1453324934, "question_id": 34910808, "link": "https://stackoverflow.com/questions/34910808/how-to-pass-an-interface-argument-to-a-variadic-function-in-golang", "closed_reason": "Duplicate", "title": "How to pass an interface argument to a variadic function in Golang?", "body": "<p>I have a variadic function Result <code>func Results(messages ...Message)</code> that accepts an interface <code>Message</code>. It works fine if I pass a single message of type Message, but if i pass a slice of message <code>Result(slice...)</code></p>\n\n<p>Here is the error I get:</p>\n\n<p><code>prog.go:38: cannot use messages (type []*SampleMessage) as type []Message in argument to Results</code></p>\n\n<p><a href=\"http://play.golang.org/p/rNYwiZ0BZB\" rel=\"nofollow\">Sample Code</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1453322425, "post_id": 34910033, "comment_id": 57555837, "body": "You could have a file locally like that or it could just be a string literal in code (depends on how the method is written, if it takes filepath then ofc you need to read a file, if it takes file contents as string or bytes then you don&#39;t). Typical work flow would be something like this; 1) declare the expected result 2) call parseFile method 3) compare expected to actual"}], "answers": [{"tags": [], "owner": {"reputation": 1525, "user_id": 2119660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae09f6f1f1e7eabb4438fcde4ddef8b?s=128&d=identicon&r=PG", "display_name": "Jeff Sisson", "link": "https://stackoverflow.com/users/2119660/jeff-sisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1453322929, "creation_date": 1453322929, "answer_id": 34910226, "question_id": 34910033, "link": "https://stackoverflow.com/questions/34910033/how-to-write-a-test-for-parsefile-in-go/34910226#34910226", "title": "How to write a test for parseFile in Go", "body": "<p>You should be able to commit a file to the same folder as your test, and read in a relative path by way of <code>os.Open(\"./path_to_file\")</code>.</p>\n\n<p>If the issue is that you're looking for a file in a specific location, I'd recommend parameterizing whichever method loads the information to accept different filepaths.</p>\n"}, {"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1453340439, "creation_date": 1453340439, "answer_id": 34913920, "question_id": 34910033, "link": "https://stackoverflow.com/questions/34910033/how-to-write-a-test-for-parsefile-in-go/34913920#34913920", "title": "How to write a test for parseFile in Go", "body": "<p>You can do exactly the same in Go, albeit it is handled a bit differently.\nCreate a folder called \"testdata\" next to your <code>*_test.go</code> files.</p>\n\n<p>This folder <a href=\"https://groups.google.com/forum/m/#!topic/golang-nuts/VPVlIiO5yXw\" rel=\"nofollow\">is by convention ignored by the go tools</a>, as are all folders beginning with an underscore. This is why I name my resources directories for web applications <code>_components</code> instead of <code>bower_components</code>, for example.</p>\n\n<p>Now, you can access said folder with a relative path from your tests, and it won't pollute your namespace or sth.</p>\n"}], "owner": {"reputation": 313, "user_id": 5737452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17e1cbf59bde9523ef8a433fbe774cad?s=128&d=identicon&r=PG&f=1", "display_name": "desi Joe", "link": "https://stackoverflow.com/users/5737452/desi-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1453340439, "creation_date": 1453322297, "question_id": 34910033, "link": "https://stackoverflow.com/questions/34910033/how-to-write-a-test-for-parsefile-in-go", "title": "How to write a test for parseFile in Go", "body": "<p>I have a parseFile function that given a file parsing for certain information and returns a struct. How do I write a test for this function?\nWith Java, I could have a file in the test folder but I not sure how to best do it in Go. </p>\n\n<p>Thanks and regards </p>\n"}, {"tags": ["json", "go", "marshalling", "hl7-fhir"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1453320022, "creation_date": 1453320022, "answer_id": 34909385, "question_id": 34909177, "link": "https://stackoverflow.com/questions/34909177/how-can-i-override-json-tags-in-a-go-struct/34909385#34909385", "title": "How can I override json tags in a Go struct?", "body": "<p>You can't change it, but you don't have to.</p>\n\n<p>Easiest solution is to create your own struct, define your own json tags (how you want them to appear in the output), copy the fields, and marshal a value of your own struct.</p>\n\n<p>E.g. let's say you want to marshal the <code>Id</code> and <code>Url</code>fields, then:</p>\n\n<pre><code>type MyValueSet struct {\n    Id string  `json:\"MyId\"`\n    Url string `json:\"MyUrl\"`\n}\n\nvar vs ValueSet = ... // Comes from somewhere\n\nmvs := MyValueSet {\n    Id:  vs.Id,\n    Url: vs.Url,\n}\n\ndata, err := json.Marshal(&amp;mvs)\n// Check err\n</code></pre>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 951, "favorite_count": 0, "accepted_answer_id": 34909385, "answer_count": 1, "score": 1, "last_activity_date": 1453408023, "creation_date": 1453319289, "last_edit_date": 1453319860, "question_id": 34909177, "link": "https://stackoverflow.com/questions/34909177/how-can-i-override-json-tags-in-a-go-struct", "title": "How can I override json tags in a Go struct?", "body": "<p>I'd like to marshal part of <a href=\"https://github.com/intervention-engine/fhir/blob/master/models/valueset.go\" rel=\"nofollow\">this struct</a>:</p>\n\n<pre><code>type ValueSet struct {\n    Id           string                       `json:\"id\" bson:\"_id\"`\n    Url          string                       `bson:\"url,omitempty\" json:\"url,omitempty\"`\n    Identifier   *Identifier                  `bson:\"identifier,omitempty\" json:\"identifier,omitempty\"`\n    Version      string                       `bson:\"version,omitempty\" json:\"version,omitempty\"`\n    Name         string                       `bson:\"name,omitempty\" json:\"name,omitempty\"`\n    Status       string                       `bson:\"status,omitempty\" json:\"status,omitempty\"`\n    Experimental *bool                        `bson:\"experimental,omitempty\" json:\"experimental,omitempty\"`\n    Publisher    string                       `bson:\"publisher,omitempty\" json:\"publisher,omitempty\"`\n    Contact      []ValueSetContactComponent   `bson:\"contact,omitempty\" json:\"contact,omitempty\"`\n    Date         *FHIRDateTime                `bson:\"date,omitempty\" json:\"date,omitempty\"`\n    LockedDate   *FHIRDateTime                `bson:\"lockedDate,omitempty\" json:\"lockedDate,omitempty\"`\n    Description  string                       `bson:\"description,omitempty\" json:\"description,omitempty\"`\n    UseContext   []CodeableConcept            `bson:\"useContext,omitempty\" json:\"useContext,omitempty\"`\n    Immutable    *bool                        `bson:\"immutable,omitempty\" json:\"immutable,omitempty\"`\n    Requirements string                       `bson:\"requirements,omitempty\" json:\"requirements,omitempty\"`\n    Copyright    string                       `bson:\"copyright,omitempty\" json:\"copyright,omitempty\"`\n    Extensible   *bool                        `bson:\"extensible,omitempty\" json:\"extensible,omitempty\"`\n    CodeSystem   *ValueSetCodeSystemComponent `bson:\"codeSystem,omitempty\" json:\"codeSystem,omitempty\"`\n    Compose      *ValueSetComposeComponent    `bson:\"compose,omitempty\" json:\"compose,omitempty\"`\n    Expansion    *ValueSetExpansionComponent  `bson:\"expansion,omitempty\" json:\"expansion,omitempty\"`\n}\n</code></pre>\n\n<p>which is part of a Go implementation of <a href=\"https://www.hl7.org/fhir/\" rel=\"nofollow\">HL7 FHIR</a>, including only the metadata fields, and omitting the three content three fields (codeSystem, compose and expansion). I can't (and shouldn't) change the JSON tags in the original source code, since other code strongly depends on it working the way it's written. How can I tell json.Marshal to override the existing JSON tags on these struct elements?</p>\n"}, {"tags": ["html", "go", "onclick"], "comments": [{"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 3, "creation_date": 1453318768, "post_id": 34908835, "comment_id": 57553790, "body": "Go cannot do this. Your sample code is part of Go&#39;s template package which parses and executes the template before sending the HTML to the client. Go knows nothing about the client after it serves its response, so you&#39;d have to do this in JS."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1453319275, "post_id": 34908835, "comment_id": 57554061, "body": "This has nothing to do with Go, you need to write the correct html and javascript for the client."}, {"owner": {"reputation": 12067, "user_id": 499466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc0612ec9a2b6af96500cc6e4bfdc7c?s=128&d=identicon&r=PG", "display_name": "JensG", "link": "https://stackoverflow.com/users/499466/jensg"}, "edited": false, "score": 2, "creation_date": 1453320857, "post_id": 34908835, "comment_id": 57554902, "body": "The entire concept you have about how things work in the web has &quot;room for improvents&quot; as they say. In short: HTML is rendered in a browser, that&#39;s also where events happen. The browser and your (Go) HTML server are two entirely different processes. In the browser you may catch click events using JavaScript (but not with Go), and send an AJAX request back to your server, which then usually is programmed (by you) to respond with some suitable JSON. To make these AJAX things easier, have a look at the jQuery library (to name just one)."}], "answers": [{"comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1453326058, "post_id": 34910626, "comment_id": 57557837, "body": "Thanks. Answer accepted. I assumed that would be the case."}], "tags": [], "owner": {"reputation": 24853, "user_id": 446681, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cBjgR.jpg?s=128&g=1", "display_name": "Hector Correa", "link": "https://stackoverflow.com/users/446681/hector-correa"}, "is_accepted": true, "score": 3, "last_activity_date": 1453324357, "creation_date": 1453324357, "answer_id": 34910626, "question_id": 34908835, "link": "https://stackoverflow.com/questions/34908835/can-go-capture-a-click-event-in-an-html-document-it-is-serving/34910626#34910626", "title": "Can Go capture a click event in an HTML document it is serving?", "body": "<blockquote>\n  <p>does anyone know of a way to do this strictly in Go?</p>\n</blockquote>\n\n<p>As others have indicated in the comments, no, Go cannot capture the event in the browser. </p>\n\n<p>For that you will need to use some JavaScript to send to the server (where Go runs) the web request for more information. </p>\n\n<p>You could also push all the required information to the browser when you first serve the page and hide/show it based on CSS/JavaScript event but again, that's just regular web development and nothing to do with Go.</p>\n"}], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 34910626, "answer_count": 1, "score": -2, "last_activity_date": 1453324357, "creation_date": 1453318144, "question_id": 34908835, "link": "https://stackoverflow.com/questions/34908835/can-go-capture-a-click-event-in-an-html-document-it-is-serving", "title": "Can Go capture a click event in an HTML document it is serving?", "body": "<p>I am writing a program for managing an inventory. It serves up html based on records from a postresql database, or writes to the database using html forms.</p>\n\n<p>Different functions (adding records, searching, etc.) are accessible using <code>&lt;a&gt;&lt;/a&gt;</code> tags or form submits, which in turn call functions using <code>http.HandleFunc()</code>, functions then generate queries, parse results and render these to html templates.</p>\n\n<p>The search function renders query results to an html table. To keep the search results page ideally usable and uncluttered I intent to provide only the most relevant information there.  However, since there are many more details stored in the database, I need a way to access that information too. In order to do that I wanted to have each table row clickable, displaying the details of the selected record in a status area at the bottom or side of the page for instance.</p>\n\n<p>I could try to follow the pattern that works for running the other functions, that is use <code>&lt;a&gt;&lt;/a&gt;</code> tags and <code>http.HandleFunc()</code> to render new content but this isn't exactly what I want for a couple of reasons.</p>\n\n<p>First: There should be no need to navigate away from the search result page to view the additional details; there are not so many details that a single record's full data should not be able to be rendered on the same page as the search results.</p>\n\n<p>Second: I want the whole row clickable, not merely the text within a table cell, which is what the <code>&lt;a&gt;&lt;/a&gt;</code> tags get me.</p>\n\n<p>Using the id returned from the database in an attribute, as in <code>&lt;div id=\"search-result-row-id-{{.ID}}\"&gt;&lt;/div&gt;</code> I am able to work with individual records but I have yet to find a way to then capture a click in Go.</p>\n\n<p>Before I run off and write this in javascript, does anyone know of a way to do this strictly in Go? I am not particularly adverse to using the tried-and-true js methods but I am curious to see if it could be done without it.</p>\n"}, {"tags": ["oop", "go", "polymorphism"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1453318112, "post_id": 34908695, "comment_id": 57553379, "body": "You&#39;ll have to rethink your model because method overriding simply does not work with Go&#39;s constructs for OOP. Like if you embed A in B and then call a method C that was defined on both A and B, which version is invoked isn&#39;t even defined; there are no method resolution rules in the spec. Don&#39;t try to do it. Whatever you want to accomplish can be done equally effectively with slightly different relationships between objects."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1453318404, "post_id": 34908695, "comment_id": 57553555, "body": "@evanmcdonnal: it&#39;s not undefined, it&#39;s defined as ambiguous. You&#39;ll get a compile time error that says &quot;ambiguous selector&quot; if there are conflicting embedded identifiers."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1453318629, "post_id": 34908695, "comment_id": 57553710, "body": "@Harlam: you can&#39;t structure go types as if there&#39;s inheritance. The embedded type can&#39;t call the outer type (and knows nothing about it), since embedding is nothing more than automatic delegation. There is no <code>step2</code> for B inside of A, there is only a shorthand version of <code>B.A.step1()</code>."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453330167, "post_id": 34908695, "comment_id": 57559876, "body": "@JimB I&#39;m not sure what you mean... I can embed a type <code>A</code> which contains a method <code>C</code> into a type <code>B</code> which also contains a definition for a method <code>C</code> and I can compile and run the program and when I call <code>B.C()</code> the behavior is undefined - ie the spec mentions nothing about how method resolution is handled, unlike say C# which gives a list of rules which would guarantee me the execution of B&#39;s version of C rather than A&#39;s."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1453330906, "post_id": 34908695, "comment_id": 57560217, "body": "@evanmcdonnal: your <a href=\"http://play.golang.org/p/BPDZP3Lzwt\" rel=\"nofollow noreferrer\">description of this code</a> is perfectly valid - that&#39;s how you &quot;override&quot; an embedded method, and we do it all the time. If there&#39;s multiple possible fields (<a href=\"http://play.golang.org/p/b_2Ivi3wcB\" rel=\"nofollow noreferrer\">example</a>), then you get compile error. The <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">spec on selectors</a> is very clear on this, and there&#39;s certainly no undefined behavior."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453331068, "post_id": 34908695, "comment_id": 57560272, "body": "@JimB oh I see. that makes more sense."}], "answers": [{"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 7, "last_activity_date": 1453321574, "creation_date": 1453321574, "answer_id": 34909818, "question_id": 34908695, "link": "https://stackoverflow.com/questions/34908695/polymorphism-in-golang/34909818#34909818", "title": "Polymorphism in Golang", "body": "<p>Go doesn't do polymorphism.  You have to recast what you want to do in terms of interfaces, and functions (not methods) that take those interfaces.</p>\n\n<p>So think what interface does each object need to satisfy, then what functions you need to work on that interface.  There are lots of great examples in the go standard library, eg <code>io.Reader</code>, <code>io.Writer</code> and the functions which work on those, eg <code>io.Copy</code>.</p>\n\n<p><a href=\"http://play.golang.org/p/BluerSTorq\">Here is my attempt</a> to recast your example into that style.  It doesn't make a lot of sense, but hopefully it will give you something to work on.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype A struct {\n}\n\ntype steps interface {\n    step1()\n    step2()\n}\n\nfunc (a *A) step1() {\n    fmt.Println(\"step1 A\")\n}\n\nfunc (a *A) step2() {\n    fmt.Println(\"get A\")\n}\n\ntype B struct {\n    A\n}\n\nfunc (b *B) step2() {\n    fmt.Println(\"get B\")\n}\n\nfunc step1(f steps) {\n    f.step1()\n    f.step2()\n}\n\nfunc main() {\n    obj := B{}\n    step1(&amp;obj)\n}\n</code></pre>\n"}], "owner": {"reputation": 358, "user_id": 4536186, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nNlUY.png?s=128&g=1", "display_name": "Harlam", "link": "https://stackoverflow.com/users/4536186/harlam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 1, "accepted_answer_id": 34909818, "answer_count": 1, "score": 1, "last_activity_date": 1453321574, "creation_date": 1453317753, "question_id": 34908695, "link": "https://stackoverflow.com/questions/34908695/polymorphism-in-golang", "title": "Polymorphism in Golang", "body": "<p>It's simple example what I want: </p>\n\n<p>I have object of B and use function step1 from struct A (common functionality). I need to redefine function step2 for B which runs inside A.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype A struct {}\n\nfunc (a *A) step1() {\n    a.step2();\n}\n\nfunc (a *A) step2 () {\n   fmt.Println(\"get A\");\n}\n\n\ntype B struct {\n   A\n}\n\nfunc (b *B) step2 () {\n   fmt.Println(\"get B\");\n}\n\nfunc main() {\n    obj := B{}\n    obj.step1() \n}\n</code></pre>\n\n<p>How can I do it?</p>\n\n<pre><code>// maybe \nfunc step1(a *A) {\n   self.step2(a);\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "concurrency", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1453325419, "post_id": 34907909, "comment_id": 57557496, "body": "The first error you see may be just the timeout in normal operation, the 2nd is likely because of write contention. More on this: <a href=\"https://cloud.google.com/appengine/articles/handling_datastore_errors\" rel=\"nofollow noreferrer\">Handling Datastore Errors</a>"}, {"owner": {"reputation": 597, "user_id": 515320, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/56bb98d5e22200a138bbcbf68047cb6f?s=128&d=identicon&r=PG", "display_name": "Andy Haskell", "link": "https://stackoverflow.com/users/515320/andy-haskell"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1453332321, "post_id": 34907909, "comment_id": 57560731, "body": "Thanks! Keep being awesome!"}], "answers": [{"tags": [], "owner": {"reputation": 1261, "user_id": 22079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a07336bf2b6ecaca5e87cda7b99b9253?s=128&d=identicon&r=PG", "display_name": "Jeff Allen", "link": "https://stackoverflow.com/users/22079/jeff-allen"}, "is_accepted": false, "score": 1, "last_activity_date": 1454821883, "creation_date": 1454821883, "answer_id": 35249983, "question_id": 34907909, "link": "https://stackoverflow.com/questions/34907909/what-is-the-difference-between-appengine-datastore-timeout-errors-5-and-11/35249983#35249983", "title": "What is the difference between appengine datastore timeout errors 5 and 11?", "body": "<p>The first error you see may be just the timeout in normal operation, the 2nd is likely because of write contention. More on this: Handling Datastore Errors <a href=\"https://cloud.google.com/appengine/articles/handling_datastore_errors\" rel=\"nofollow\">https://cloud.google.com/appengine/articles/handling_datastore_errors</a></p>\n"}, {"tags": [], "owner": {"reputation": 1220, "user_id": 366254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b19b02a49b433c9e2e6e6c43785d2bfb?s=128&d=identicon&r=PG", "display_name": "raggi", "link": "https://stackoverflow.com/users/366254/raggi"}, "is_accepted": false, "score": 3, "last_activity_date": 1459721570, "creation_date": 1459721570, "answer_id": 36391878, "question_id": 34907909, "link": "https://stackoverflow.com/questions/34907909/what-is-the-difference-between-appengine-datastore-timeout-errors-5-and-11/36391878#36391878", "title": "What is the difference between appengine datastore timeout errors 5 and 11?", "body": "<p>These errors come from two different places, the first, the call error, is a local error that is caused by a timeout in the RPC client. It indicates that there was a timeout waiting for completion of an RPC. The default RPC timeout in google.golang.org/appengine is 60 seconds.</p>\n\n<p>The second error comes from the service side. This error indicates that a timeout occurred performing operations within datastore. Some of these operations have timeouts much shorter than 60s, and typically this may indicate contention.</p>\n\n<p>A possibly simpler way to understand the differences is that you will find that if you make a single multi operation with a very large number of changes, you can trigger the first timeout with ease. If you create a significant number of concurrent operations against a single key or small set of keys, you will more readily trigger the latter. As timeouts are general indicators of saturation of shared resources, there are of course many ways and combinations to generate them. In general, one will want to retry operations as appropriate, and also size operations appropriately, as well as aggregating operations on hot keys as best as possible to reduce the chance of contention related issues. As others have suggested, the python and java docs have some examples of this already.</p>\n\n<p>You may wish to make use of <a href=\"https://godoc.org/google.golang.org/appengine#IsTimeoutError\" rel=\"nofollow\">https://godoc.org/google.golang.org/appengine#IsTimeoutError</a> and if you need to increase the timeout for the first error class, you may be able to adjust the context deadline, see the methods here: <a href=\"https://godoc.org/golang.org/x/net/context#WithDeadline\" rel=\"nofollow\">https://godoc.org/golang.org/x/net/context#WithDeadline</a> Note: you will not be able to extend the deadline beyond that of a request deadline, however, if you are running in tasks or VMs you can extend to long deadlines.</p>\n"}], "owner": {"reputation": 597, "user_id": 515320, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/56bb98d5e22200a138bbcbf68047cb6f?s=128&d=identicon&r=PG", "display_name": "Andy Haskell", "link": "https://stackoverflow.com/users/515320/andy-haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1474814611, "creation_date": 1453315162, "last_edit_date": 1474814611, "question_id": 34907909, "link": "https://stackoverflow.com/questions/34907909/what-is-the-difference-between-appengine-datastore-timeout-errors-5-and-11", "title": "What is the difference between appengine datastore timeout errors 5 and 11?", "body": "<p>I'm trying to speed up a Google App Engine request handler that has a big datastore <code>PutMulti</code> call (500 entities) by splitting it into batches of entities and running concurrent goroutines to send smaller<code>PutMulti</code> calls (100 entities each).</p>\n\n<p>Before this, I had often been getting the datastore error <code>Call error 11: Deadline exceeded (timeout)</code> from my <code>PutMulti</code> calls going over the deadline when I tested the handler on many concurrent requests. After the parallelization, the handler did speed up, but I still occasionally got that error and also another type of error, <code>API error 5 (datastore_v3: TIMEOUT): The datastore operation timed out, or the data was temporarily unavailable</code>.</p>\n\n<p>Is this error 5 due to contention in the datastore, and what is the difference between errors 5 and 11?</p>\n"}, {"tags": ["memory", "go", "profiling", "heap-memory"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1453311380, "post_id": 34906668, "comment_id": 57549493, "body": "io.Writer doesn&#39;t have a buffer, it&#39;s an interface. In your code, why are you buffering a buffer?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1453311692, "post_id": 34906668, "comment_id": 57549688, "body": "Who said all your allocs are in the <code>io.Writer</code>? What do you think <code>command := strings.TrimSpace(scanner.Text())</code> does? I think it&#39;s responsible for about 2 million allocs."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1453311743, "post_id": 34906668, "comment_id": 57549716, "body": "<code>fmt.Sprintf</code> causes a lot of allocs too."}, {"owner": {"reputation": 4800, "user_id": 46871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H7vPm.jpg?s=128&g=1", "display_name": "tlehman", "link": "https://stackoverflow.com/users/46871/tlehman"}, "edited": false, "score": 0, "creation_date": 1453311763, "post_id": 34906668, "comment_id": 57549733, "body": "Right, I am not asking the right question, also, good catch, I&#39;ve unbuffered my bytes.Buffer, in newest master"}, {"owner": {"reputation": 4800, "user_id": 46871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H7vPm.jpg?s=128&g=1", "display_name": "tlehman", "link": "https://stackoverflow.com/users/46871/tlehman"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1453311825, "post_id": 34906668, "comment_id": 57549779, "body": "@evanmcdonnal it was a guess, I am thinking JimB is on to something too"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1453312019, "post_id": 34906668, "comment_id": 57549932, "body": "It&#39;s useful to avoid string manipulation if you want to reduce allocations. Use and reuse []byte slices as much as possible."}], "owner": {"reputation": 4800, "user_id": 46871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H7vPm.jpg?s=128&g=1", "display_name": "tlehman", "link": "https://stackoverflow.com/users/46871/tlehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1072, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453311017, "creation_date": 1453311017, "question_id": 34906668, "link": "https://stackoverflow.com/questions/34906668/avoiding-excessive-memory-allocation-in-golang-when-using-an-io-writer", "title": "Avoiding excessive memory allocation in golang when using an io.Writer", "body": "<p>I am working on a command line tool in Go called <a href=\"https://github.com/tlehman/redis-mass\" rel=\"nofollow\">redis-mass</a> that converts a bunch of redis commands into <a href=\"http://redis.io/topics/protocol\" rel=\"nofollow\">redis protocol format</a>.</p>\n\n<p>The first step was to port the node.js version, almost literally to Go. I used <code>ioutil.ReadFile(inputFileName)</code> to get a string version of the file and then returned an encoded string as output.</p>\n\n<p>When I ran this on a file with 2,000,000 redis commands, it took about 8 seconds, compared to about 16 seconds with the node version. I guessed that the reason it was only twice as fast was because it was reading the whole file into memory first, so I changed my encoding function to accept a pair <code>(raw io.Reader, enc io.Writer)</code>, and it looks like this:</p>\n\n<pre><code>func EncodeStream(raw io.Reader, enc io.Writer) {\n    var args []string\n    var length int\n\n    scanner := bufio.NewScanner(raw)\n\n    for scanner.Scan() {\n            command := strings.TrimSpace(scanner.Text())\n            args = parse(command)\n            length = len(args)\n            if length &gt; 0 {\n                    io.WriteString(enc, fmt.Sprintf(\"*%d\\r\\n\", length))\n                    for _, arg := range args {\n                            io.WriteString(enc, fmt.Sprintf(\"$%d\\r\\n%s\\r\\n\", len(arg), arg))\n                    }\n            }\n    }\n}\n</code></pre>\n\n<p>However, this took 12 seconds on the 2 million line file, so I used github.com/pkg/profile to see how it was using memory, and it looks like the number of memory allocations is huge:</p>\n\n<pre><code># Alloc = 3162912\n# TotalAlloc = 1248612816\n# Mallocs = 46001048\n# HeapAlloc = 3162912\n</code></pre>\n\n<p>Can I constrain the <code>io.Writer</code> to use a fixed sized buffer and avoid all those allocations?</p>\n\n<p>More generally, how can I avoid excessive allocations in this method? <a href=\"https://github.com/tlehman/redis-mass/blob/master/redis_protocol.go\" rel=\"nofollow\">Here's the full source for more context</a></p>\n"}, {"tags": ["go", "gorilla", "mux"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 2066888, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lpund.png?s=128&g=1", "display_name": "CGideon", "link": "https://stackoverflow.com/users/2066888/cgideon"}, "edited": false, "score": 0, "creation_date": 1453308544, "post_id": 34905580, "comment_id": 57547600, "body": "Oh my gosh that&#39;s embarrassing! That was exactly what it was... Thank you so much for your answer!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1453307930, "creation_date": 1453307930, "answer_id": 34905580, "question_id": 34905339, "link": "https://stackoverflow.com/questions/34905339/go-cannot-call-newrouter-function/34905580#34905580", "title": "Go cannot call NewRouter() function", "body": "<p>If your <code>main</code> package consists of multiple <code>.go</code> files, you have to pass all to <code>go run</code>, e.g.:</p>\n\n<pre><code>go run Main.go Router.go\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 2066888, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lpund.png?s=128&g=1", "display_name": "CGideon", "link": "https://stackoverflow.com/users/2066888/cgideon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 1, "closed_date": 1453309153, "accepted_answer_id": 34905580, "answer_count": 1, "score": 0, "last_activity_date": 1453307930, "creation_date": 1453307246, "question_id": 34905339, "link": "https://stackoverflow.com/questions/34905339/go-cannot-call-newrouter-function", "closed_reason": "Duplicate", "title": "Go cannot call NewRouter() function", "body": "<p>I'm new to Go, but I'm trying to create a RESTful API using Gorilla Mux to create my router based on this article <a href=\"http://thenewstack.io/make-a-restful-json-api-go/\" rel=\"nofollow\">http://thenewstack.io/make-a-restful-json-api-go/</a></p>\n\n<p>I have a Router file with the below code in it.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n)\n\ntype Route struct {\n    Name        string\n    Method      string\n    Pattern     string\n    HandlerFunc http.HandlerFunc\n}\n\ntype Routes []Route\n\nfunc NewRouter() *mux.Router {\n\n    router := mux.NewRouter().StrictSlash(true)\n    for _, route := range routes {\n        router.\n            Methods(route.Method).\n            Path(route.Pattern).\n            Name(route.Name).\n            Handler(route.HandlerFunc)\n    }\n    return router\n}\n\nvar routes = Routes{\n    Route{\n        \"Index\",\n        \"GET\",\n        \"/\",\n        Index,\n    },\n}\n</code></pre>\n\n<p>And in my Main.go I have this:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    router := NewRouter()\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n</code></pre>\n\n<p>From what I know about Go and how to call a method in one file from another this should work. But when I run: go build Main.go I get this error in my console:</p>\n\n<pre><code>go run Main.go\n# command-line-arguments\n./Main.go:10: undefined: NewRouter\n</code></pre>\n\n<p>I've run <em>go get</em> in my src folder which has all my files in it to get gorilla, but that didn't fix it. What am I doing wrong here?</p>\n"}, {"tags": ["go", "ssl-certificate", "pki"], "answers": [{"tags": [], "owner": {"reputation": 437, "user_id": 2952763, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a368475adb5b26f532180d2b4a383aed?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg", "link": "https://stackoverflow.com/users/2952763/oleg"}, "is_accepted": false, "score": 1, "last_activity_date": 1453320913, "last_edit_date": 1453320913, "creation_date": 1453320590, "answer_id": 34909541, "question_id": 34905063, "link": "https://stackoverflow.com/questions/34905063/pki-infrastructure/34909541#34909541", "title": "PKI infrastructure", "body": "<p>What I had to know before ask question <a href=\"http://www.oasis-pki.org/pdfs/Understanding_Path_construction-DS2.pdf\" rel=\"nofollow\">http://www.oasis-pki.org/pdfs/Understanding_Path_construction-DS2.pdf</a></p>\n\n<p>DN names (Subject in CA certificate and Issuer in server certificate) must be the same. But DN names of subject and issuer must no be equal. DN's make up the link between Issuer and Subject.</p>\n\n<p>In my case I used only O=Organization filed in</p>\n\n<pre><code>ca := x509.Certificate{\n    Subject: pkix.Name{\n                Organization: []string{\"O\"},\n            }\n}\nserver := x509.Certificate{\n    Subject: pkix.Name{\n                Organization: []string{\"O\"},\n            }\n}\n</code></pre>\n\n<p>DN's are the same for the issuer and for the subject.That is why browser can't find path. It is simply to add more info to pkix, for example, CommonName. It will make the DN unique.</p>\n\n<pre><code>ca := x509.Certificate{\n    Subject: pkix.Name{\n                CommonName:   []string{\"CA\"},\n                Organization: []string{\"XUnit\"},\n            }\n}\nserver := x509.Certificate{\n    Subject: pkix.Name{\n                CommonName:   []string{\"server\"},\n                Organization: []string{\"XUnit\"},\n            }\n}\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 2952763, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a368475adb5b26f532180d2b4a383aed?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg", "link": "https://stackoverflow.com/users/2952763/oleg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1453320913, "creation_date": 1453306504, "question_id": 34905063, "link": "https://stackoverflow.com/questions/34905063/pki-infrastructure", "title": "PKI infrastructure", "body": "<p>How to establish simply chain using golang .x509 package? \nLet say I need self-signed CA certificate and certificate for server issued by CA.\nWhen I use </p>\n\n<pre><code>x509.CreateCertificate(rand.Reader, &amp;issuer, &amp;issuer, publicKeyIssuer, privateKeyIssuer)\n</code></pre>\n\n<p>then </p>\n\n<pre><code>x509.CreateCertificate(rand.Reader, &amp;subject, &amp;issuer, publicKeySubject, privateKeyIssuer)\n</code></pre>\n\n<p>it doesn't work. Certificate is created and when server sends it to a browser the browser doesn't see path from server to ca. </p>\n\n<p>If I use openssl and create certificate request for server and then certificate then it's all good</p>\n\n<pre><code>openssl req -key server.key -new -out server.req -sha256\nopenssl x509 -req -in server.req -CA ca.crt -CAkey ca.key -out server.crt\n</code></pre>\n\n<p>I know that there is x509.CreateCertificateReuest but I don't now how to link request with creating of certificate?\nWhat I am doing wrong or may be don't now much about x509.CreateCertificate? </p>\n"}, {"tags": ["go", "exec", "stdin"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1453306688, "post_id": 34904956, "comment_id": 57546283, "body": "Read is a bash command, not an executable in your PATH like echo. Maybe invoking read inside bash could work. I&#39;d suggest to find a Go-only solution."}, {"owner": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1453307256, "post_id": 34904956, "comment_id": 57546700, "body": "@Volker I just want to capture <code>spacebar</code> that&#39;s all. Do you have any suggestion for a simple go-only solution?"}], "answers": [{"comments": [{"owner": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "edited": false, "score": 0, "creation_date": 1453307131, "post_id": 34905162, "comment_id": 57546594, "body": "Thank for your answer @JimB. I&#39;ve tried your code, it&#39;s sound good, but I got &quot;&quot; from <code>out</code> every times I input."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "edited": false, "score": 0, "creation_date": 1453307445, "post_id": 34905162, "comment_id": 57546853, "body": "@terces907: that&#39;s because <code>read</code> isn&#39;t printing any output. What are you trying to do?"}, {"owner": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "edited": false, "score": 0, "creation_date": 1453307616, "post_id": 34905162, "comment_id": 57546959, "body": "I just want to get a given input character."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "edited": false, "score": 0, "creation_date": 1453308081, "post_id": 34905162, "comment_id": 57547264, "body": "@terces907: I added some more info. Why not just do it in Go?"}, {"owner": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "edited": false, "score": 0, "creation_date": 1453308216, "post_id": 34905162, "comment_id": 57547372, "body": "I just want to capture <code>spacebar</code> which input from keyboard without entering from user. For sure, it can be done by code you&#39;ve given me above. Any simpler way for golang-only code please suggest @JimB."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "edited": false, "score": 1, "creation_date": 1453308545, "post_id": 34905162, "comment_id": 57547603, "body": "@terces907: bash puts the tty in raw mode for <code>read</code>. See <a href=\"http://stackoverflow.com/questions/15159118/read-a-character-from-standard-input-in-go-without-pressing-enter\" title=\"read a character from standard input in go without pressing enter\">stackoverflow.com/questions/15159118/&hellip;</a>, and <a href=\"http://stackoverflow.com/questions/14094190/golang-function-similar-to-getchar\" title=\"golang function similar to getchar\">stackoverflow.com/questions/14094190/&hellip;</a>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1453308059, "last_edit_date": 1453308059, "creation_date": 1453306792, "answer_id": 34905162, "question_id": 34904956, "link": "https://stackoverflow.com/questions/34904956/can-not-run-bash-read-command-from-golang/34905162#34905162", "title": "Can not run bash `read` command from Golang", "body": "<p>You're not providing the command with stdin, so there's nothing it can read and it exits immediately. </p>\n\n<p>If you want to hook it up the same stdin as the calling program, you can use:</p>\n\n<pre><code>cmd := exec.Command(\"read\", \"-t\", \"5\", \"-n\", \"1\")\ncmd.Stdin = os.Stdin\nout, err := cmd.CombinedOutput()\n\nfmt.Println(\"error:\", err)\nfmt.Printf(\"output: %q\\n\", out)\n</code></pre>\n\n<p>This however won't output anything, since the <code>/usr/bin/read</code> script isn't going to print anything. You probably want the shell builtin <code>read</code> to be called in the context of a shell. This would print the character read:</p>\n\n<pre><code>cmd := exec.Command(\"bash\", \"-c\", \"read -t 5 -n 1 C &amp;&amp; echo -n $C\")\ncmd.Stdin = os.Stdin\n</code></pre>\n\n<p>But in the end, you should probably just read directly from stdin in go.</p>\n"}], "owner": {"reputation": 3597, "user_id": 829496, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XXTbx.jpg?s=128&g=1", "display_name": "fronthem", "link": "https://stackoverflow.com/users/829496/fronthem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "closed_date": 1453308574, "accepted_answer_id": 34905162, "answer_count": 1, "score": 1, "last_activity_date": 1453308059, "creation_date": 1453306253, "question_id": 34904956, "link": "https://stackoverflow.com/questions/34904956/can-not-run-bash-read-command-from-golang", "closed_reason": "Duplicate", "title": "Can not run bash `read` command from Golang", "body": "<p>I tried to use a basic bash command <code>read</code> to capture a single character from a keyboard. But it seemed difficult to get the output even I try several ways.</p>\n\n<p>Sample code:</p>\n\n<pre><code>fmt.Println(exec.Command(\"read\", \"-t\", \"5\", \"-n\", \"1\").Output())\n</code></pre>\n\n<p>Its meaning is \"waiting for 5 seconds to get 1 input character from the keyboard\". From code above I expected to see my input character printed out together with its error but what do I get is</p>\n\n<p>Output:</p>\n\n<pre><code>[] exit status 1\n</code></pre>\n\n<p>This output is just immediately printed in lesser than 1 second which conflicts to <code>\"-t\", \"5\"</code> argument of <code>read</code> command which stands for waiting for 5 second. I try to type some character within 1 second but it seems doesn't work at all.</p>\n\n<p>BTW, if try this</p>\n\n<pre><code>fmt.Println(exec.Command(\"echo\", \"\\\"Hi!\\\"\").Output())\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[34 104 105 34 10] &lt;nil&gt;\n</code></pre>\n\n<p>It seems work here with simple <code>echo</code> here.</p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1453306138, "post_id": 34904822, "comment_id": 57545876, "body": "Because <a href=\"https://github.com/golang/go/blob/27d5c0ede5b4411089f4bf52a41dd2f4eed36123/src/log/log.go#L230\" rel=\"nofollow noreferrer\">SetFlags already does</a>. The really interesting question is, why <i>do</i> they use locks in <code>SetOutput</code> instead of just doing <code>std.SetOutput(w)</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1453306304, "post_id": 34904822, "comment_id": 57545998, "body": "@Ainar-G: Logger didn&#39;t always have its own SetOutput method. (added in 1.5 I think)"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453306519, "post_id": 34904822, "comment_id": 57546161, "body": "@JimB <a href=\"https://golang.org/doc/go1.5#minor_library_changes\" rel=\"nofollow noreferrer\">You&#39;re right</a>."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1453306125, "creation_date": 1453306125, "answer_id": 34904907, "question_id": 34904822, "link": "https://stackoverflow.com/questions/34904822/why-didnt-use-lock-to-sync-in-log-package/34904907#34904907", "title": "why didn&#39;t use lock to sync in log package", "body": "<p><code>SetOutput</code> is altering the internal state of the <code>std</code> default Logger.</p>\n\n<p><code>log.SetFlags</code> is calling <a href=\"https://golang.org/pkg/log/#Logger.SetFlags\" rel=\"nofollow\"><code>SetFlags</code></a> on <code>std</code>, which already locks the logger itself. </p>\n"}], "owner": {"reputation": 6950, "user_id": 5371821, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/gHZQr.jpg?s=128&g=1", "display_name": "starkshang", "link": "https://stackoverflow.com/users/5371821/starkshang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 34904907, "answer_count": 1, "score": 0, "last_activity_date": 1453306125, "creation_date": 1453305877, "question_id": 34904822, "link": "https://stackoverflow.com/questions/34904822/why-didnt-use-lock-to-sync-in-log-package", "title": "why didn&#39;t use lock to sync in log package", "body": "<p>I'm reading <a href=\"https://golang.org/src/log/log.go?s=8938:8966#L289\" rel=\"nofollow\">log source code</a>,I'm confused in here:</p>\n\n<pre><code>// SetOutput sets the output destination for the standard logger.\nfunc SetOutput(w io.Writer) {\n    std.mu.Lock()\n    defer std.mu.Unlock()\n    std.out = w\n}\n\n// Flags returns the output flags for the standard logger.\nfunc Flags() int {\n    return std.Flags()\n}\n\n// SetFlags sets the output flags for the standard logger.\nfunc SetFlags(flag int) {\n    std.SetFlags(flag)\n}\n</code></pre>\n\n<p>why <code>SetOutPut</code> use <code>mu</code> to lock but <code>SetFlags</code> don't use <code>mu</code> to lock?</p>\n"}, {"tags": ["function", "pointers", "go", "function-pointers"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1453296758, "post_id": 34901307, "comment_id": 57538943, "body": "The first error message is pretty clear. <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">Functions are only comparable to <code>nil</code></a>."}, {"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1453297132, "post_id": 34901307, "comment_id": 57539203, "body": "Wouldn&#39;t an interface be clearer (and obviously solve the problem) ?"}], "answers": [{"comments": [{"owner": {"reputation": 2005, "user_id": 292382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1273e01f22fc4ee1f2b29587c37a294e?s=128&d=identicon&r=PG", "display_name": "antichris", "link": "https://stackoverflow.com/users/292382/antichris"}, "edited": false, "score": 1, "creation_date": 1600327823, "post_id": 34901626, "comment_id": 113054073, "body": "<code>reflect.ValueOf(handler.Post).Pointer() != reflect.ValueOf(Undefined).Pointer()</code> is enough."}], "tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": false, "score": 4, "last_activity_date": 1453297197, "creation_date": 1453297197, "answer_id": 34901626, "question_id": 34901307, "link": "https://stackoverflow.com/questions/34901307/how-to-compare-2-functions-in-go/34901626#34901626", "title": "How to compare 2 functions in Go?", "body": "<p>Nevermind, found the answer:</p>\n\n<pre><code>runtime.FuncForPC(reflect.ValueOf(handler.Post).Pointer()).Name() != \n   runtime.FuncForPC(reflect.ValueOf(Undefined).Pointer()).Name()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "edited": false, "score": 1, "creation_date": 1486663681, "post_id": 34901677, "comment_id": 71453932, "body": "Can you elaborate on the pitfalls of comparing function addresses?  Also, if the function has an address in memory, why is it not directly addressable? Can you tell me whether in your opinion, the string address value of a function is acceptable <a href=\"http://stackoverflow.com/q/42140758/1375316\">for my use case</a>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "edited": false, "score": 0, "creation_date": 1486677623, "post_id": 34901677, "comment_id": 71461810, "body": "@threeve Answered in your question: <a href=\"http://stackoverflow.com/questions/42140758/collection-of-unique-functions-in-go/42147285#42147285\">Collection of Unique Functions in Go</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1481213239, "last_edit_date": 1481213239, "creation_date": 1453297298, "answer_id": 34901677, "question_id": 34901307, "link": "https://stackoverflow.com/questions/34901307/how-to-compare-2-functions-in-go/34901677#34901677", "title": "How to compare 2 functions in Go?", "body": "<p>Before going further: you should refactor and not compare function value addresses.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">Spec: Comparison operators:</a></p>\n\n<blockquote>\n  <p>Slice, map, and function values are not comparable. However, as a special case, a slice, map, or function value may be compared to the predeclared identifier <code>nil</code>.</p>\n</blockquote>\n\n<p>Function values are not comparable. What you may do is compare if the addresses of the function values are the same (not the address of variables holding function values, but the function values themselves).</p>\n\n<p><a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"noreferrer\">You can't take the address of a function</a>, but if you print it with the <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\"><code>fmt</code></a> package, it prints its address. So you can use <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"noreferrer\"><code>fmt.Sprintf()</code></a> to get the address of a function value.</p>\n\n<p>See this example (based on your code):</p>\n\n<pre><code>hand := &amp;Handler{Undefined, Defined}\np1 := fmt.Sprintf(\"%v\", Undefined)\np2 := fmt.Sprintf(\"%v\", hand.Get)\nfmt.Println(\"Expecting true:\", p1 == p2)\n\nfmt.Println(\"Expecting false:\", fmt.Sprintf(\"%v\", Defined) == fmt.Sprintf(\"%v\", hand.Get))\nfmt.Println(\"Expecting true:\", fmt.Sprintf(\"%v\", Defined) == fmt.Sprintf(\"%v\", hand.Post))\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/SxhvOZi0Uu\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Expecting true: true\nExpecting false: false\nExpecting true: true\n</code></pre>\n\n<p>Another option would be to use <a href=\"https://golang.org/pkg/reflect/#Value.Pointer\" rel=\"noreferrer\"><code>reflect.Value.Pointer()</code></a> to get the address of the function values, this is exactly what the <code>fmt</code> package does: <code>fmt/print.go</code>:</p>\n\n<pre><code>func (p *pp) fmtPointer(value reflect.Value, verb rune) {\n    // ...\n    case reflect.Chan, reflect.Func, reflect.Map, reflect.Ptr, reflect.Slice,\n            reflect.UnsafePointer:\n        u = value.Pointer()\n    // ...\n}\n</code></pre>\n\n<p>But you should refactor and not compare function value addresses.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 1869633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6563c8537ae3d360673910880538e6e7?s=128&d=identicon&r=PG", "display_name": "Arief Darmawan", "link": "https://stackoverflow.com/users/1869633/arief-darmawan"}, "is_accepted": false, "score": 0, "last_activity_date": 1453300811, "creation_date": 1453300811, "answer_id": 34903008, "question_id": 34901307, "link": "https://stackoverflow.com/questions/34901307/how-to-compare-2-functions-in-go/34903008#34903008", "title": "How to compare 2 functions in Go?", "body": "<p>You can't compare function. It need to be stored into a variable instead and reference it as pointer.</p>\n\n<p><a href=\"http://play.golang.org/p/sflsjjCHN5\" rel=\"nofollow\">http://play.golang.org/p/sflsjjCHN5</a></p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5661, "favorite_count": 0, "accepted_answer_id": 34901677, "answer_count": 3, "score": 6, "last_activity_date": 1579168563, "creation_date": 1453296266, "last_edit_date": 1579168563, "question_id": 34901307, "link": "https://stackoverflow.com/questions/34901307/how-to-compare-2-functions-in-go", "title": "How to compare 2 functions in Go?", "body": "<p>For example I have list of functions that I want to compare:</p>\n\n<p><a href=\"http://play.golang.org/p/_rCys6rynf\" rel=\"nofollow\">http://play.golang.org/p/_rCys6rynf</a></p>\n\n<pre><code>type Action func(foo string)\n\ntype Handler struct {\n  Get Action\n  Post Action\n}\n\nvar routes map[string]Handler\n\nfunc Undefined(foo string) {\n}\n\nfunc Defined(foo string) {\n}\n\nfunc init() {\n  routes = map[string]Handler{\n    `/`: Handler{Defined,Undefined},\n  }\n}\n\nfunc main() {\n  for _, handler := range routes {\n    if handler.Post != Undefined { \n      // do something\n    } // invalid operation: (func(string))(handler.Post) != Undefined (func can only be compared to nil)\n\n\n    if &amp;handler.Post != &amp;Undefined { \n      // do something \n    } // cannot take the address of Undefined\n    // invalid operation: &amp;handler.Post != &amp;Undefined (mismatched types *Action and *func(string))\n  }\n}\n</code></pre>\n\n<p>What is the correct way to compare if two functions are the same?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1453313904, "post_id": 34901259, "comment_id": 57551092, "body": "Your error indicates that your import statement is actually aliasing the packages and then you&#39;re not referring to those aliases. ie yo uhave <code>import moetemplat &quot;github.com&#47;golangframework&#47;htmlparts&quot;</code>. With <code>File</code> you have the alias <code>file</code> which is why you get those other errors because your code continues to reference <code>File</code> when now the package is referred to as <code>file</code> in that scope."}], "answers": [{"tags": [], "owner": {"reputation": 243983, "user_id": 35070, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f92354195e8874dbee44d5c8714d506?s=128&d=identicon&r=PG", "display_name": "phihag", "link": "https://stackoverflow.com/users/35070/phihag"}, "is_accepted": false, "score": 2, "last_activity_date": 1453297863, "creation_date": 1453297863, "answer_id": 34901894, "question_id": 34901259, "link": "https://stackoverflow.com/questions/34901259/go-imported-and-not-used-as-undefined/34901894#34901894", "title": "go imported and not used: as, undefined", "body": "<p>Note the different capitalization of <code>file</code> and <code>File</code>. Since you talk about renaming file, I'm assuming that your code really is like</p>\n\n<pre><code>package main\n\nimport (\n    file \"github.com/golangframework/File\"\n)\n\nfunc main() {\n    File.ReadAllBytes(\"foo\")\n}\n</code></pre>\n\n<p>Either don't rename your <code>File</code> module (remove the <code>file</code> in the import) or refer to it as <code>file</code> instead of <code>File</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 5816064, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRdaZfH--Ws/AAAAAAAAAAI/AAAAAAAAAHQ/RWZLKeeSkz8/photo.jpg?sz=128", "display_name": "li peng", "link": "https://stackoverflow.com/users/5816064/li-peng"}, "is_accepted": false, "score": 0, "last_activity_date": 1453352145, "creation_date": 1453352145, "answer_id": 34915669, "question_id": 34901259, "link": "https://stackoverflow.com/questions/34901259/go-imported-and-not-used-as-undefined/34915669#34915669", "title": "go imported and not used: as, undefined", "body": "<p>oh,,,sorry,I check the goroot scr,and find the old moetemplate.go and file.go still exist</p>\n\n<p>so I delete those,and go get from github,than OK </p>\n"}], "owner": {"reputation": 9, "user_id": 5816064, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRdaZfH--Ws/AAAAAAAAAAI/AAAAAAAAAHQ/RWZLKeeSkz8/photo.jpg?sz=128", "display_name": "li peng", "link": "https://stackoverflow.com/users/5816064/li-peng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1357, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453352145, "creation_date": 1453296156, "question_id": 34901259, "link": "https://stackoverflow.com/questions/34901259/go-imported-and-not-used-as-undefined", "title": "go imported and not used: as, undefined", "body": "<p>I renamed file as File,and renamed  moetemplate as htmlparts\nthen go build</p>\n\n<pre><code>./router.go:8: imported and not used: \"github.com/golangframework/File\" as file\n./router.go:11: imported and not used: \"github.com/golangframework/htmlparts\" as moetemplate\n./router.go:21: undefined: File in File.ReadAllBytes\n./router.go:61: undefined: htmlparts in htmlparts.LoadPartFile\n./router.go:62: undefined: File in File.ReadAllText\n./router.go:65: undefined: htmlparts in htmlparts.Render\n</code></pre>\n\n<p>my import is this</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/golangframework/File\"\n    \"github.com/golangframework/JSON\"\n    \"github.com/golangframework/Object\"\n    \"github.com/golangframework/htmlparts\"\n    \"github.com/golangframework/httpmongo\"\n    \"github.com/golangframework/moeregexp\"\n)\n</code></pre>\n\n<p>and i also cleaned goroot pkg,updated src\nwhy build error?</p>\n"}, {"tags": ["go", "snmp"], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 4877754, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kiPTywCG5mE/AAAAAAAAAAI/AAAAAAAAAQ4/eppFQTCEcQo/photo.jpg?sz=128", "display_name": "Clark Wierda", "link": "https://stackoverflow.com/users/4877754/clark-wierda"}, "is_accepted": false, "score": 0, "last_activity_date": 1454205456, "creation_date": 1454205456, "answer_id": 35109484, "question_id": 34900438, "link": "https://stackoverflow.com/questions/34900438/snmp-agent-in-go/35109484#35109484", "title": "SNMP agent in Go", "body": "<p>I got the following Googling \"golang snmp agent\".</p>\n\n<p><a href=\"https://github.com/posteo/go-agentx\" rel=\"nofollow\">https://github.com/posteo/go-agentx</a></p>\n\n<p>and</p>\n\n<p><a href=\"https://github.com/k-sone/snmpgo\" rel=\"nofollow\">https://github.com/k-sone/snmpgo</a></p>\n\n<p>Even if these aren't what you are looking for, they should be a good start in the right direction.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 897945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/becb09aadbe7f132cfd1a1ed64674129?s=128&d=identicon&r=PG", "display_name": "Sadeq", "link": "https://stackoverflow.com/users/897945/sadeq"}, "edited": false, "score": 0, "creation_date": 1525688319, "post_id": 41465969, "comment_id": 87440633, "body": "Why it use dial instead of listen as SNMP Agent?"}], "tags": [], "owner": {"reputation": 21, "user_id": 1097925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cde88b682de8965d5ad8e0b47cf9881?s=128&d=identicon&r=PG", "display_name": "Mart&#237;n Claro", "link": "https://stackoverflow.com/users/1097925/mart%c3%adn-claro"}, "is_accepted": false, "score": 2, "last_activity_date": 1483539388, "creation_date": 1483539388, "answer_id": 41465969, "question_id": 34900438, "link": "https://stackoverflow.com/questions/34900438/snmp-agent-in-go/41465969#41465969", "title": "SNMP agent in Go", "body": "<p>As <a href=\"https://github.com/posteo/go-agentx\" rel=\"nofollow noreferrer\">https://github.com/posteo/go-agentx</a> is not under active development and has some bugs, I forked it into a new project to fix the bugs and accept contributions: <a href=\"https://github.com/martinclaro/go-agentx\" rel=\"nofollow noreferrer\">https://github.com/martinclaro/go-agentx</a></p>\n\n<p>Feel free to use it, report bugs, and contribute for a better solution.</p>\n"}], "owner": {"reputation": 122, "user_id": 4937124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa736aefaad64cc684ba2fb258d2fe99?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Cerri", "link": "https://stackoverflow.com/users/4937124/marcelo-cerri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5110, "favorite_count": 2, "closed_date": 1558597893, "answer_count": 2, "score": 0, "last_activity_date": 1558596154, "creation_date": 1453293860, "question_id": 34900438, "link": "https://stackoverflow.com/questions/34900438/snmp-agent-in-go", "closed_reason": "Not suitable for this site", "title": "SNMP agent in Go", "body": "<p>I need to write a SNMP agent and I would like to implement it in Go in order to keep it with a small footprint.</p>\n\n<p>However, I haven't found any Go library that supports SNMP agents. Is there any library or alternative available, such as calling a library in C?</p>\n"}, {"tags": ["go", "gmail", "gmail-api"], "comments": [{"owner": {"reputation": 3799, "user_id": 105282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76eb5847f0ecf87aba817ee37547c537?s=128&d=identicon&r=PG", "display_name": "booyaa", "link": "https://stackoverflow.com/users/105282/booyaa"}, "edited": false, "score": 0, "creation_date": 1453291951, "post_id": 34898052, "comment_id": 57535724, "body": "Which go package are you using to connect connect to Gmail?"}, {"owner": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "reply_to_user": {"reputation": 3799, "user_id": 105282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76eb5847f0ecf87aba817ee37547c537?s=128&d=identicon&r=PG", "display_name": "booyaa", "link": "https://stackoverflow.com/users/105282/booyaa"}, "edited": false, "score": 0, "creation_date": 1453295357, "post_id": 34898052, "comment_id": 57538023, "body": "&quot;google.golang.org/api/gmail/v1&quot;"}, {"owner": {"reputation": 3799, "user_id": 105282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76eb5847f0ecf87aba817ee37547c537?s=128&d=identicon&r=PG", "display_name": "booyaa", "link": "https://stackoverflow.com/users/105282/booyaa"}, "edited": false, "score": 0, "creation_date": 1453300443, "post_id": 34898052, "comment_id": 57541650, "body": "you probably want to set the get parameter <code>format</code> to <code>raw</code> so you get base64: <a href=\"https://developers.google.com/gmail/api/v1/reference/users/messages/get\" rel=\"nofollow noreferrer\">developers.google.com/gmail/api/v1/reference/users/messages/&zwnj;&#8203;get</a> it looks like there&#39;s a method you need to use before call Do. <a href=\"https://github.com/google/google-api-go-client/blob/master/gmail/v1/gmail-gen.go#L3393\" rel=\"nofollow noreferrer\">github.com/google/google-api-go-client/blob/master/gmail/v1/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "reply_to_user": {"reputation": 3799, "user_id": 105282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76eb5847f0ecf87aba817ee37547c537?s=128&d=identicon&r=PG", "display_name": "booyaa", "link": "https://stackoverflow.com/users/105282/booyaa"}, "edited": false, "score": 0, "creation_date": 1453304344, "post_id": 34898052, "comment_id": 57544530, "body": "Seeing this one <a href=\"http://stackoverflow.com/questions/24745006/gmail-api-parse-message-content-base64-decoding-with-javascript\" title=\"gmail api parse message content base64 decoding with javascript\">stackoverflow.com/questions/24745006/&hellip;</a> and trying your idea, then let you know"}, {"owner": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "reply_to_user": {"reputation": 3799, "user_id": 105282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76eb5847f0ecf87aba817ee37547c537?s=128&d=identicon&r=PG", "display_name": "booyaa", "link": "https://stackoverflow.com/users/105282/booyaa"}, "edited": false, "score": 0, "creation_date": 1453305324, "post_id": 34898052, "comment_id": 57545246, "body": "Same goes with raw input...the base64 decode fails"}], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "is_accepted": true, "score": 4, "last_activity_date": 1453366382, "creation_date": 1453366382, "answer_id": 34919127, "question_id": 34898052, "link": "https://stackoverflow.com/questions/34898052/get-attachments-in-gmail-api/34919127#34919127", "title": "Get attachments in GMail API", "body": "<p>The problem is in the base64 encoding: as the documentation say the payload (either in \"full\" or \"raw\" mode) is in base64URL encoding, not base64.\nSo this code is working:</p>\n\n<pre><code>attach, _ := srv.Users.Messages.Attachments.Get(user, messageid, attachmentid).Do()\ndecoded, err := base64.URLEncoding.DecodeString(attach.Data)\nfileout, err := os.OpenFile(...\n</code></pre>\n\n<p>That said, I saw the full mode (default) is easier to handle\n:)</p>\n"}], "owner": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1840, "favorite_count": 0, "accepted_answer_id": 34919127, "answer_count": 1, "score": 2, "last_activity_date": 1463168761, "creation_date": 1453287277, "last_edit_date": 1463168761, "question_id": 34898052, "link": "https://stackoverflow.com/questions/34898052/get-attachments-in-gmail-api", "title": "Get attachments in GMail API", "body": "<p>I am trying to get an attachment from a mail in golang. The problem is in the base64 payload read from Gmail giving me the error</p>\n\n<pre><code>illegal base64 data at input byte 13\n</code></pre>\n\n<p>Here's my code (err handling omitted)\n..</p>\n\n<pre><code>attach, _ := srv.Users.Messages.Attachments.Get(user, messageid, attachmentid).Do()\ndecoded, err := base64.StdEncoding.DecodeString(attach.Data)\n</code></pre>\n\n<p>This throws the mentioned error and if I look at the original message in GMail  can see after the headers this:</p>\n\n<pre><code>begin 644 filename-of-the-attachment.extension\nM'XL(`/Y;GU8``^S]R[(&gt;R9&amp;E\"\\[[*5)JVI*6;N9WS(_TD3/J0&lt;U:&gt;H`*;F9\"...\n</code></pre>\n\n<p>Any help appreciated \nThanks</p>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine", "panic"], "comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 3, "creation_date": 1453287055, "post_id": 34897843, "comment_id": 57532356, "body": "How would we know? Ask on google golang group, maybe one of the authors will answer you. I can think of one reason. It just a good design to close a channel on producer side. Panicking forces you to design your application in such a way."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1453289524, "post_id": 34897843, "comment_id": 57534157, "body": "Closing a channel is a signal that here will be no more values. Writing to a closed channel is a program error, which panics."}], "answers": [{"tags": [], "owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "is_accepted": true, "score": 29, "last_activity_date": 1453897064, "last_edit_date": 1453897064, "creation_date": 1453290193, "answer_id": 34899098, "question_id": 34897843, "link": "https://stackoverflow.com/questions/34897843/why-does-go-panic-on-writing-to-a-closed-channel/34899098#34899098", "title": "Why does Go panic on writing to a closed channel?", "body": "<p>From the <a href=\"https://golang.org/ref/spec#Close\" rel=\"noreferrer\">Go Language Spec</a>:</p>\n\n<blockquote>\n  <p>For a channel c, the built-in function close(c) records that no more\n  values will be sent on the channel. It is an error if c is a\n  receive-only channel. Sending to or closing a closed channel causes a\n  run-time panic. Closing the nil channel also causes a run-time panic.\n  After calling close, and after any previously sent values have been\n  received, receive operations will return the zero value for the\n  channel's type without blocking. The multi-valued receive operation\n  returns a received value along with an indication of whether the\n  channel is closed.</p>\n</blockquote>\n\n<p>If you write to a closed channel, your program will panic. You could potentially <a href=\"http://golang.org/ref/spec#Handling_panics\" rel=\"noreferrer\">catch this error with recover</a> if you really want to do that, but being in a situation where you don't know whether the channel you are writing to is open is usually a sign of a bug in the program.</p>\n\n<p>Some quotes:</p>\n\n<blockquote>\n  <p>Here is a motivation: </p>\n  \n  <p>A channel \"close\" is really just a send of a special value on a \n  channel.  It is a special value that promises that no more values will \n  be sent.  Attempting to send a value on a channel after it has been \n  closed will panic, since actually sending the value would violate the \n  guarantee provided by close.  Since a close is just a special kind of \n  send, it is also not permitted after the channel has been closed. </p>\n  \n  <p>Here is another: </p>\n  \n  <p>The only use of channel close is to signal to the reader that there \n  are no more values to come.  That only makes sense when there is a \n  single source of values, or when multiple sources coordinate.  There \n  is no reasonable program in which multiple goroutines close a channel \n  without communicating.  That would imply that multiple goroutines \n  would know that there are no more values to send--how could they \n  determine that if they don't communicate? </p>\n  \n  <p>(Ian Lance Taylor)</p>\n</blockquote>\n\n<p>--</p>\n\n<blockquote>\n  <p>Here is another: </p>\n  \n  <p>Closing a channel releases it as a resource. It makes no more sense to \n  close a channel multiple times than it makes to close a file \n  descriptor multiple times, or free a block of allocated memory \n  multiple times. Such actions imply the code is broken, which is why \n  closing a closed channel triggers a panic.</p>\n  \n  <p>(Rob Pike)</p>\n</blockquote>\n\n<p>--</p>\n\n<p>Source: <a href=\"https://groups.google.com/d/msg/golang-nuts/_Q6FCjWIr18/Wb_NlyusRL8J\" rel=\"noreferrer\">Go design detail rationale question - channel close</a></p>\n"}], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21424, "favorite_count": 7, "accepted_answer_id": 34899098, "answer_count": 1, "score": 23, "last_activity_date": 1453897064, "creation_date": 1453286729, "question_id": 34897843, "link": "https://stackoverflow.com/questions/34897843/why-does-go-panic-on-writing-to-a-closed-channel", "title": "Why does Go panic on writing to a closed channel?", "body": "<p>Why does Go panic on writing to a closed channel?</p>\n\n<p>While one can use the <code>value, ok := &lt;-channel</code> idiom for reading from channels, and thus the ok result can be tested for hitting a closed channel:</p>\n\n<pre><code>// reading from closed channel\n\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    ch := make(chan int, 1)\n    ch &lt;- 2\n    close(ch)\n\n    read(ch)\n    read(ch)\n    read(ch)\n}\n\nfunc read(ch &lt;-chan int) {\n    i,ok := &lt;- ch   \n    if !ok {\n        fmt.Printf(\"channel is closed\\n\")\n        return\n    }\n    fmt.Printf(\"read %d from channel\\n\", i)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>read 2 from channel\nchannel is closed\nchannel is closed\n</code></pre>\n\n<p>Run \"reading from closed channel\" on <a href=\"http://play.golang.org/p/oJoLGeRI4S\" rel=\"noreferrer\">Playground</a></p>\n\n<p>Writing to a possibly closed channel is more convoluted, because Go will panic if you simply try to write when the channel is closed:</p>\n\n<pre><code>//writing to closed channel\n\npackage main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    output := make(chan int, 1) // create channel\n    write(output, 2)\n    close(output) // close channel\n    write(output, 3)\n    write(output, 4)\n}\n\n// how to write on possibly closed channel\nfunc write(out chan int, i int) (err error) {\n\n    defer func() {\n        // recover from panic caused by writing to a closed channel\n        if r := recover(); r != nil {\n            err = fmt.Errorf(\"%v\", r)\n            fmt.Printf(\"write: error writing %d on channel: %v\\n\", i, err)\n            return\n        }\n\n        fmt.Printf(\"write: wrote %d on channel\\n\", i)\n    }()\n\n    out &lt;- i // write on possibly closed channel\n\n    return err\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>write: wrote 2 on channel\nwrite: error writing 3 on channel: send on closed channel\nwrite: error writing 4 on channel: send on closed channel\n</code></pre>\n\n<p>Run \"writing to closed channel\" on <a href=\"http://play.golang.org/p/qL7z3SVeqX\" rel=\"noreferrer\">Playground</a></p>\n\n<p>As far as I know, there is not a simpler idiom for writing into a possibly closed channel without panicking. Why not? What is the reasoning behind such an asymmetric behavior between read and write?</p>\n"}, {"tags": ["web-services", "networking", "go"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1453286497, "post_id": 34897604, "comment_id": 57531929, "body": "Does the <code>http.ListenAndServe</code> call return an error?"}, {"owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1453286938, "post_id": 34897604, "comment_id": 57532266, "body": "@mrd0ll4r, No, I can even do another test without restarting the http server."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 10, "creation_date": 1453290128, "post_id": 34897604, "comment_id": 57534515, "body": "Stop using <code>ab</code>. You&#39;re running out of ports. See <a href=\"http://stackoverflow.com/questions/30352725/why-is-my-hello-world-go-server-getting-crushed-by-apachebench/30357879\" title=\"why is my hello world go server getting crushed by apachebench\">stackoverflow.com/questions/30352725/&hellip;</a>"}, {"owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453291576, "post_id": 34897604, "comment_id": 57535465, "body": "Thank you @JimB, that answered my question and also blew my mind."}], "owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 3, "closed_date": 1453291627, "answer_count": 0, "score": 0, "last_activity_date": 1453286072, "creation_date": 1453286072, "question_id": 34897604, "link": "https://stackoverflow.com/questions/34897604/go-net-http-hang-after-constantly-number-of-requests", "closed_reason": "Duplicate", "title": "Go net/http hang after constantly number of requests", "body": "<p>I setup a very simple and basic http server with Go <code>net/http</code> like this:</p>\n\n<pre><code>package main\n\nimport (\n  \"net/http\"\n  \"fmt\"\n)\n\nfunc defaultHttpPing(w http.ResponseWriter, r *http.Request) {\n  fmt.Fprint(w, \"Pong\")\n}\n\nfunc main() {\n  http.HandleFunc(\"/ping\", defaultHttpPing)\n  http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>I believe that this is the minimal Go http server I can write and it shouldn't have any application bugs. Unfortunately, when I use <code>ab</code> to do a stress test on this server:</p>\n\n<pre><code>ab -n 100000 -c 100 http://localhost:8080/ping\n</code></pre>\n\n<p>It failed with this output:</p>\n\n<pre><code>Benchmarking localhost (be patient)\nCompleted 10000 requests\napr_pollset_poll: The timeout specified has expired (70007)\nTotal of 16482 requests completed\n</code></pre>\n\n<p>I was so surprised because my previous <code>ab</code> tests with fewer number of requests with the same concurrency level such as <code>-n 10000 -c 100</code> are successful. I also tried more <code>-n 100000 -c 100</code> tests and it kept failing with around <code>16K</code> successful requests consistently.</p>\n\n<p>What's wrong with my server? I also think that Go's <code>net/http</code> has some weird problems. Maybe, just a sense that's something to deal with memory leak.</p>\n\n<p><em>Additional environment info:</em></p>\n\n<p>OS: Mac OS, El Capitan\nlimits: </p>\n\n<pre><code>-t: cpu time (seconds)              unlimited\n-f: file size (blocks)              unlimited\n-d: data seg size (kbytes)          unlimited\n-s: stack size (kbytes)             8192\n-c: core file size (blocks)         0\n-v: address space (kbytes)          unlimited\n-l: locked-in-memory size (kbytes)  unlimited\n-u: processes                       709\n-n: file descriptors                524288\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1453282639, "post_id": 34896190, "comment_id": 57529361, "body": "There&#39;s a very nice <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">wiki page</a> that has a lot of slice tricks. In your case, you&#39;d have to find the index of the element first. Also think about what happens if the element is present more than once"}, {"owner": {"reputation": 373, "user_id": 4090307, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2ce489fcc1d7945ef5807d69e729d134?s=128&d=identicon&r=PG&f=1", "display_name": "Morty Choi", "link": "https://stackoverflow.com/users/4090307/morty-choi"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1453283223, "post_id": 34896190, "comment_id": 57529757, "body": "So these function is not included the sdk?"}], "owner": {"reputation": 373, "user_id": 4090307, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2ce489fcc1d7945ef5807d69e729d134?s=128&d=identicon&r=PG&f=1", "display_name": "Morty Choi", "link": "https://stackoverflow.com/users/4090307/morty-choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1453282663, "answer_count": 0, "score": 0, "last_activity_date": 1453282186, "creation_date": 1453282186, "question_id": 34896190, "link": "https://stackoverflow.com/questions/34896190/how-to-delete-item-from-a-slice", "closed_reason": "Duplicate", "title": "How to delete item from a slice?", "body": "<p>Lets say we have a slice of string <code>[\"a\" , \"b\", \"c\"]</code>, what is the idiomatic way to delete \"b\" from the slice when the input is <code>\"b\"</code>.</p>\n\n<p>In order language, this seem be fairly easy. But when it comes to Go, it seems a little bit unclear for a beginner Gopher.</p>\n"}, {"tags": ["go", "timeout", "channel", "channels"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1453279561, "last_edit_date": 1453279561, "creation_date": 1453278929, "answer_id": 34895064, "question_id": 34894927, "link": "https://stackoverflow.com/questions/34894927/golang-timeout-is-not-executed-with-channels/34895064#34895064", "title": "Golang timeout is not executed with channels", "body": "<p>Your timeout doesn't happen, because one of your goroutine sends a value on your <code>c1</code> channel in every 1.5 seconds (or so) repeatedly, and your timeout would only happen if there is no value to be received from <code>c1</code> for 2 seconds.</p>\n\n<p>Once a value is received from <code>c1</code>, in the next iteration executing <code>select</code> again a <strong>new</strong> <code>time.After()</code> call will be made which which returns a <strong>new</strong> channel on which a value will only be sent after another 2 seconds. The timeout channel from the previous <code>select</code> execution is discarded and is not used anymore.</p>\n\n<p>To receive the timeout after 2 seconds, create the timeout channel only once, e.g.:</p>\n\n<pre><code>timeout := time.After(2000 * time.Millisecond)\nfor {\n    select {\n    case i := &lt;-c1:\n        fmt.Println(i)\n    case &lt;-timeout:\n        fmt.Println(\"TIMEOUT\") // Will get executed after 2 sec\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>10\nTIMEOUT\n10\n10\n10\n...\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5814652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ab4d97a5d174f4f364a9d8764d1d0a?s=128&d=identicon&r=PG&f=1", "display_name": "neohwang", "link": "https://stackoverflow.com/users/5814652/neohwang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 1, "accepted_answer_id": 34895064, "answer_count": 1, "score": 2, "last_activity_date": 1475843374, "creation_date": 1453278417, "last_edit_date": 1475843374, "question_id": 34894927, "link": "https://stackoverflow.com/questions/34894927/golang-timeout-is-not-executed-with-channels", "title": "Golang timeout is not executed with channels", "body": "<p>I am using goroutines/channels.\nHere is my code.\nWhy is the timeout case not getting executed?</p>\n\n<pre><code>func main() {\n    c1 := make(chan int, 1)\n\n    go func() {\n        for {\n            time.Sleep(1500 * time.Millisecond)\n            c1 &lt;- 10\n        }\n    }()\n\n    go func() {\n        for {\n            select {\n            case i := &lt;-c1:\n                fmt.Println(i)\n            case &lt;-time.After(2000 * time.Millisecond):\n                fmt.Println(\"TIMEOUT\") // &lt;-- Not Executed\n            }\n        }\n    }()\n\n    fmt.Scanln()\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 31, "user_id": 5814111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MFghY.jpg?s=128&g=1", "display_name": "rince chacko", "link": "https://stackoverflow.com/users/5814111/rince-chacko"}, "edited": false, "score": 0, "creation_date": 1453281581, "post_id": 34894455, "comment_id": 57528644, "body": "got the answer .    err := GetTemplate(&quot;login&quot;).Execute(response, viewModel )"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1453306710, "last_edit_date": 1495541718, "creation_date": 1453280070, "answer_id": 34895423, "question_id": 34894455, "link": "https://stackoverflow.com/questions/34894455/pass-a-string-to-template-in-golang/34895423#34895423", "title": "Pass a string to template in golang", "body": "<p>The error is in this line:</p>\n\n<pre><code>t, err := template.New(\"foo\").Parse(template.HTML(\"login\"))\n</code></pre>\n\n<p>The <a href=\"https://golang.org/pkg/html/template/#Template.Parse\" rel=\"nofollow noreferrer\"><code>template.Parse()</code></a> method expects one argument of type <code>string</code>, and you pass it an argument of type <a href=\"https://golang.org/pkg/html/template/#HTML\" rel=\"nofollow noreferrer\"><code>template.HTML</code></a>.</p>\n\n<p>This: <code>template.HTML(\"login\")</code> is a type conversion, it converts the <code>string</code> value <code>\"login\"</code> to type <code>template.HTML</code>. This is not needed. Simply use:</p>\n\n<pre><code>t, err := template.New(\"foo\").Parse(\"login\")\n</code></pre>\n\n<p>Although this is hardly what you want, you have to pass the template text to the <code>Parse()</code> method, not a file name! Most likely you wanted to call <a href=\"https://golang.org/pkg/html/template/#Template.ParseFiles\" rel=\"nofollow noreferrer\"><code>Template.ParseFiles()</code></a>.</p>\n\n<p>In fact, since this is what follows (which is a syntax error btw):</p>\n\n<pre><code>err := GetTemplate(\"login\").Execute(response, nil, )\n</code></pre>\n\n<p>You don't even need the line where you have error... so simply remove these 2 lines:</p>\n\n<pre><code>t, err := template.New(\"foo\").Parse(template.HTML(\"login\"))\nerr = t.ExecuteTemplate(response, \"T\", viewModel)\n</code></pre>\n\n<p>And looks you want to pass <code>viewModel</code> as the parameter to the template, so do so in the next line and remove the last comma <code>,</code> to make it compile:</p>\n\n<pre><code>err := GetTemplate(\"login\").Execute(response, viewModel)\n</code></pre>\n\n<p><strong>A word of advice:</strong> Do not parse templates in your handlers, very inefficient, instead parse them when your app starts, and just reuse the parsed templates. Read this question for more explanation:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28451675/it-takes-too-much-time-when-using-template-package-to-generate-a-dynamic-web-p\">It takes too much time when using &quot;template&quot; package to generate a dynamic web page to client in golang</a></p>\n"}], "owner": {"reputation": 31, "user_id": 5814111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MFghY.jpg?s=128&g=1", "display_name": "rince chacko", "link": "https://stackoverflow.com/users/5814111/rince-chacko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6677, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1564940172, "creation_date": 1453276597, "last_edit_date": 1564940172, "question_id": 34894455, "link": "https://stackoverflow.com/questions/34894455/pass-a-string-to-template-in-golang", "title": "Pass a string to template in golang", "body": "<p>I've been scouring the internet and can't find much at all about posting to html template and form in golang . This is my attempt at it</p>\n\n<p><strong>my error</strong>\ncannot use \"html/template\".HTML(\"\nlogin\") (type \"html/template\".HTML) as type string in argument to \"html/template\n\".New(\"foo\").Parse</p>\n\n<p>i want to pass a value to {{.ErrorMessage}} in html file</p>\n\n<p>My HTML (login.html)</p>\n\n<pre><code>{{ define \"content\"}}\n&lt;h2&gt; {{.ErrorMessage}}&lt;/h2&gt;\n\n\nform action=\"/login\" method=\"POST\"&gt;\nUsername:input type=\"username\" name=\"username\"&gt;\nPassword:input type=\"password\" name=\"password\"&gt;\ninput type=\"submit\" value=\"Submit\"&gt;\n/form&gt;\n\n{{end}}\n\n{{define \"extra_head\"}} &lt;title&gt;Title&lt;/title&gt;{{end}}\n{{define \"nav\"}}{{end}}\n\n\n{{define \"extra_footer\"}}&lt;footer&gt;copyright@xyz.com&lt;/footer&gt;{{end}}\n{{template \"_layout.html\" .}}\n</code></pre>\n\n<p><strong>MAIN.G0</strong></p>\n\n<pre><code>package main\n\nimport (\n\n\"net/http\"\n\"ere.com/handlers\"\n)\n\nfunc main() {\nhttp.HandleFunc(\"/register\", handlers.RegisterHandler) // setting router rule\nhttp.HandleFunc(\"/sucess\", handlers.RegisterSucessHandler)\nhttp.HandleFunc(\"/login\", handlers.LoginHandler)\nhttp.HandleFunc(\"/update\", handlers.UpdateHandler)\nhttp.HandleFunc(\"/logout\", handlers.LogoutHandler)\nhttp.HandleFunc(\"/header\", handlers.HeaderHandler)\n\n\nif err := http.ListenAndServe(\":8181\", nil); err != nil {\n    //log.Fatal(\"http.ListenAndServe: \", err)\n}\n\n\n}\n</code></pre>\n\n<p><strong>handler int</strong></p>\n\n<pre><code>    package handlers\n      import (\n      \"html/template\"\n       )\n\nfunc GetTemplate(name string) *template.Template{\ntmpl := template.Must(template.ParseFiles(\n    \"frontend/templates/_layout.html\",\n    \"frontend/templates/\" + name + \".html\",\n))\n\n\nreturn tmpl\n}\n</code></pre>\n\n<p><strong>LoginHandler</strong></p>\n\n<pre><code>    type viewModel    struct {\nId          bson.ObjectId\nEmail       string\nPassword    string\nFirstName   string\nLastName    string\nErrorMessage    string\n}\n    func LoginHandler (response http.ResponseWriter, request *http.Request) {\nviewModel:=viewmodels.RegisterViewModel{}\n\nif (request.Method == \"POST\") {\n\n    request.ParseForm()\n    user := models.User{}\n    user.Email = request.Form.Get(\"username\")\n    user.Password = request.Form.Get(\"password\")\n    boolUser, userID := user.FindUserDB()\n\n    if (boolUser != true) {\n\n        viewModel.ErrorMessage = \"incorrect username or password\"\n\n      //need help here\n\n        t, err := template.New(\"foo\").Parse(template.HTML(\"login\"))\n        err = t.ExecuteTemplate(response, \"T\", viewModel)\n\n\n        err := GetTemplate(\"login\").Execute(response, nil, )\n\n        if err != nil {\n            panic(err)\n        }\n\n    }else {\n\n        setSession(userID, response)\n        http.Redirect(response, request, \"/update\", 302)\n    }\n\n\n}else {\n    err := GetTemplate(\"login\").Execute(response, nil,)\n\n    if err != nil {\n        panic(err)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1453278636, "post_id": 34892941, "comment_id": 57526833, "body": "Understand why as a beginner you might start out writing <code>readByte</code> with a C-like interface that writes changes back through <code>int*</code>s, but that&#39;s relatively rare in Go. (Sometimes folks use multiple return values.) For reading a byte in particular, check <a href=\"https://godoc.org/bufio#Reader.ReadByte\" rel=\"nofollow noreferrer\"><code>(*bufio.Reader).ReadByte</code></a>. (Also, know it&#39;s sample code, but check errors! Skipping the check feels like a shortcut until the first time it makes a bug hard to find, heh. <a href=\"http://github.com/kisielk/errcheck\" rel=\"nofollow noreferrer\">errcheck</a> or <a href=\"https://github.com/alecthomas/gometalinter\" rel=\"nofollow noreferrer\">gometalinter</a> can help.)"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1453272156, "last_edit_date": 1453272156, "creation_date": 1453271836, "answer_id": 34893091, "question_id": 34892941, "link": "https://stackoverflow.com/questions/34892941/server-not-receiving-data-from-tcp-client-in-go/34893091#34893091", "title": "Server not receiving Data from TCP Client in GO", "body": "<p>The client2 application must <a href=\"https://godoc.org/bufio#Writer.Flush\" rel=\"nofollow\">flush</a> the buffer.</p>\n\n<pre><code>bw := bufio.NewWriter(conn)\nn,err := fmt.Fprintf(bw, \"write %v %v %v\\r\\n%v\\r\\n\", name, exptime, len(contents), contents)\nbw.Flush()\n</code></pre>\n\n<p>The application should also check errors.</p>\n\n<pre><code>bw := bufio.NewWriter(conn)\n_, err := fmt.Fprintf(bw, \"write %v %v %v\\r\\n%v\\r\\n\", name, exptime, len(contents), contents)\nif err != nil {\n     // handle error\n}\nif err := bw.Flush(); err != nil {\n     // handle error\n}\n</code></pre>\n\n<p>fmt.Fprintf buffers internally. If this is the only write to the connection, then remove the buffered writer.</p>\n\n<pre><code>_, err := fmt.Fprintf(conn, \"write %v %v %v\\r\\n%v\\r\\n\", name, exptime, len(contents), contents)\nif err != nil {\n    // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 3975448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e972c68f3c59e8bc5d519882db39f149?s=128&d=identicon&r=PG&f=1", "display_name": "tourism", "link": "https://stackoverflow.com/users/3975448/tourism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 34893091, "answer_count": 1, "score": 0, "last_activity_date": 1453272156, "creation_date": 1453271182, "question_id": 34892941, "link": "https://stackoverflow.com/questions/34892941/server-not-receiving-data-from-tcp-client-in-go", "title": "Server not receiving Data from TCP Client in GO", "body": "<p>Hello I have implemented a server in GO which reads data from a client and print it. For reading from the network stream, I am reading from the conn.Read() method on server.</p>\n\n<p>Below is my code to read a byte from network stream</p>\n\n<pre><code>// return a single byte after reading from buffer\nfunc readByte(conn net.Conn,buf []byte,numberofbytes *int,bufCurrPos *int) (byte){\n    fmt.Printf(\"Byte read\")\n    if *bufCurrPos == *numberofbytes {\n        for {\n                *bufCurrPos = 0\n                *numberofbytes,_ = conn.Read(buf)\n                if *numberofbytes ==0 {\n                continue\n            } else {\n                break\n            }\n        }\n    }\n    b := buf[*bufCurrPos]\n    *bufCurrPos++\n    return b\n}\n</code></pre>\n\n<p>Now I have created two client which write data to server.</p>\n\n<p>First Client write to the stream using conn.Write() method while second method write to the stream using fmt.Fprintf(bufio.NewWriter(),format string) method.</p>\n\n<p>Client 1</p>\n\n<pre><code>conn, err := net.Dial(\"tcp\",\"localhost:8080\")\nif err != nil {\n    checkError(err)\n}\ngo readHandler(conn)\nfor {\n    reader := bufio.NewReader(os.Stdin)\n    text, _ := reader.ReadString('\\n')\n    conn.Write([]byte(text[0:len(text)-1]+\"\\r\\n\"))\n}\n</code></pre>\n\n<p>client 2 :</p>\n\n<pre><code>name := \"hi.txt\"\n        contents := \"bye\"\n        exptime := 300000\n        conn, err := net.Dial(\"tcp\", \"localhost:8080\")\n        if err != nil {\n                t.Error(err.Error()) // report error through testing framework\n        }\n        scanner := bufio.NewScanner(conn)\n\n        // Write a file\n\n        n,err := fmt.Fprintf(bufio.NewWriter(conn), \"write %v %v %v\\r\\n%v\\r\\n\", name, exptime, len(contents), contents)\n        if err !=nil {\n                fmt.Printf(\"error in writing in buffer\\n\")\n        }\n</code></pre>\n\n<p>Server read the data properly with first client but for the second client, it just read 0 byte always.</p>\n\n<p>I am begginer in GO and don't know the reason for that.\nCould somebody please help me in that</p>\n"}, {"tags": ["go", "dependencies"], "answers": [{"comments": [{"owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 0, "creation_date": 1453275516, "post_id": 34893976, "comment_id": 57525370, "body": "thanks for the answer @icza, however it&#39;s about finding who depends on a given pkg, not the pkg depending on who. not sure if you have such answers?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 0, "creation_date": 1453275559, "post_id": 34893976, "comment_id": 57525383, "body": "@JasonXu Please read the whole answer. What you&#39;re looking for is in the output of the given commands."}, {"owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 0, "creation_date": 1453276101, "post_id": 34893976, "comment_id": 57525664, "body": "it works for me, as tested I can run &quot;go list -f &quot;{{.ImportPath}} {{.Imports}}&quot; ./... |grep my_pkg_path &quot; in my root project folder to get what I want. thanks."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1453277933, "last_edit_date": 1495540325, "creation_date": 1453275036, "answer_id": 34893976, "question_id": 34892909, "link": "https://stackoverflow.com/questions/34892909/whos-using-my-go-package/34893976#34893976", "title": "who&#39;s using my Go package", "body": "<p>Support for this is included in the <code>go</code> tool itself. From question: <a href=\"https://stackoverflow.com/questions/28166249/how-to-list-installed-go-packages\">How to list installed go packages</a></p>\n\n<p>You can use</p>\n\n<pre><code>go list -f \"{{.ImportPath}} {{.Imports}}\" ./...\n</code></pre>\n\n<p>to list packages and their dependencies (packages that a package imports). Execute it in the <code>src</code> folder of your Go workspace. Or</p>\n\n<pre><code>go list -f \"{{.ImportPath}} {{.Deps}}\" ./...\n</code></pre>\n\n<p>Which lists packages and their dependencies recursively.</p>\n\n<p>Yes, this is not the direction you want because you want packages that import a specific package. But you can easily search in the output of the above commands for your package name. Lines where your package is listed as a dependency are the ones you are looking for; the first \"token\" of these lines will be the packages (with path to workspace <code>src</code> folder) that import your package.</p>\n\n<p>On Unix systems you can use <code>|grep</code> to filter for these lines, e.g.</p>\n\n<pre><code>go list -f \"{{.ImportPath}} {{.Imports}}\" ./... |grep yourpackage\n</code></pre>\n\n<p>(This will also list a line containing your package and its dependencies.)</p>\n\n<p><strong>Example:</strong></p>\n\n<p>Let's say you have 2 packages: <code>my/pack1</code> and <code>my/pack2</code>, where <code>my/pack1</code> imports nothing, and <code>my/pack2</code> imports <code>fmt</code> and <code>my/pack1</code>, the output of the above commands will include:</p>\n\n<pre><code>path/to/workspace/src/my/pack1\npath/to/workspace/src/my/pack2 [fmt my/pack1]\n</code></pre>\n\n<p>And you are looking for packages that import <code>my/pack1</code>: you can see <code>my/pack2</code> imports it because <code>my/pack1</code> is listed as a dependency for <code>my/pack2</code></p>\n\n<p>There is also an open-source project doing just this: <a href=\"https://github.com/cespare/deplist\" rel=\"nofollow noreferrer\">https://github.com/cespare/deplist</a></p>\n"}], "owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 34893976, "answer_count": 1, "score": 3, "last_activity_date": 1453277933, "creation_date": 1453271027, "question_id": 34892909, "link": "https://stackoverflow.com/questions/34892909/whos-using-my-go-package", "title": "who&#39;s using my Go package", "body": "<p>My scenario is we have many small projects in development, and some of them have dependency on each other. and we are trying to provide some automated tests based on dependency relationship. e.g. when a package is changed, make sure all depending packages pass their own unit-test. </p>\n\n<p>So the question is, in Go, is there a way/tool to list which packages (local work space) are referring to a given package?</p>\n"}, {"tags": ["go", "architecture", "network-programming", "server", "distributed"], "comments": [{"owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "edited": false, "score": 1, "creation_date": 1453272618, "post_id": 34892507, "comment_id": 57524029, "body": "Maybe what u need is only the <code>SetReadDeadline</code> for conn.  <code>if netErr, ok := err.(net.Error); ok &amp;&amp; netErr.Timeout()  doSomething</code>"}, {"owner": {"reputation": 317, "user_id": 3740387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/569d27732cfc28ce3dd092fe30d2e900?s=128&d=identicon&r=PG&f=1", "display_name": "user3740387", "link": "https://stackoverflow.com/users/3740387/user3740387"}, "reply_to_user": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "edited": false, "score": 0, "creation_date": 1453278021, "post_id": 34892507, "comment_id": 57526546, "body": "@Justlike Thanks! Thats what I need. But can you help me with the syntax. I am using err2 := conn.SetReadDeadline(time.Now().Add(5 * time.Second))  |  bytes_read, err := conn.Read(tmp)   |  err.Timeout()  which results in the error that err.Timeout undefined (type error has no field or method Timeout). I want to check whether Timeout() is true or false"}, {"owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "edited": false, "score": 0, "creation_date": 1453280078, "post_id": 34892507, "comment_id": 57527667, "body": "^_^ Check the post below."}], "answers": [{"tags": [], "owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "is_accepted": true, "score": 13, "last_activity_date": 1453279994, "creation_date": 1453279994, "answer_id": 34895402, "question_id": 34892507, "link": "https://stackoverflow.com/questions/34892507/reading-from-a-tcp-connection-in-golang/34895402#34895402", "title": "Reading from a tcp connection in golang", "body": "<p>Hope this can help u. ^_^</p>\n\n<pre><code>for {\n    // set SetReadDeadline\n    err := conn.SetReadDeadline(time.Now().Add(5 * time.Second))\n    if err != nil {\n        log.Println(\"SetReadDeadline failed:\", err)\n        // do something else, for example create new conn\n        return\n    }\n\n    recvBuf := make([]byte, 1024)\n\n    n, err = conn.Read(recvBuf[:]) // recv data\n    if err != nil {\n        if netErr, ok := err.(net.Error); ok &amp;&amp; netErr.Timeout() {\n            log.Println(\"read timeout:\", err)\n            // time out\n        } else {\n            log.Println(\"read error:\", err)\n            // some error else, do something else, for example create new conn\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 3740387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/569d27732cfc28ce3dd092fe30d2e900?s=128&d=identicon&r=PG&f=1", "display_name": "user3740387", "link": "https://stackoverflow.com/users/3740387/user3740387"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10187, "favorite_count": 1, "accepted_answer_id": 34895402, "answer_count": 1, "score": 4, "last_activity_date": 1453279994, "creation_date": 1453269297, "question_id": 34892507, "link": "https://stackoverflow.com/questions/34892507/reading-from-a-tcp-connection-in-golang", "title": "Reading from a tcp connection in golang", "body": "<p>In a statement like bytes_read, err := conn.Read(tmp), I wish the read be attempted for x seconds and if no read begins I want the code to proceed ahead check some connections and again loop back and try to read. I could use select-case and spawn two goroutines, one attempting the read and the other for timeout. But here, in case of timeout happening first the code will go ahead, check the conditions and again spawn a routine to try to read from the connection while the previous read routines is still alive. I wish that the previous routine dies when timeout takes place.</p>\n\n<p>Any suggestion on how I can proceed?</p>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 1306089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f15df786fd57f190a5002b3541e40134?s=128&d=identicon&r=PG", "display_name": "SunRunAway", "link": "https://stackoverflow.com/users/1306089/sunrunaway"}, "is_accepted": false, "score": 1, "last_activity_date": 1453313234, "creation_date": 1453313234, "answer_id": 34907347, "question_id": 34892455, "link": "https://stackoverflow.com/questions/34892455/stubbing-methods-in-golang-unit-testing/34907347#34907347", "title": "Stubbing methods in Golang unit testing", "body": "<p>Making filename a field of the struct is an elegant way.\nThe <code>filename</code> should be defined when new the struct.</p>\n\n<pre><code>type fileStruct {\n    filename string\n}\n\nfunc newFileStruct(x int) *fileStruct {\n    filename := fmt.Sprintf(\"%s/%d.log\", exportPath, x)\n    return &amp;fileStruct{filename: filename}\n}\n\nfunc (f *fileStruct) write (data []byte) {\n    ...\n    file = os.File.Open(f.filename)\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 440, "user_id": 1682175, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/de309c739284b45e27fe8ab11fa7a0e9?s=128&d=identicon&r=PG", "display_name": "AlexeyKarasev", "link": "https://stackoverflow.com/users/1682175/alexeykarasev"}, "is_accepted": false, "score": 0, "last_activity_date": 1453317839, "creation_date": 1453317839, "answer_id": 34908719, "question_id": 34892455, "link": "https://stackoverflow.com/questions/34892455/stubbing-methods-in-golang-unit-testing/34908719#34908719", "title": "Stubbing methods in Golang unit testing", "body": "<p>Ended up making my structs 100% injectable, the code looks clear and concise and  tests like a charm!</p>\n"}], "owner": {"reputation": 440, "user_id": 1682175, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/de309c739284b45e27fe8ab11fa7a0e9?s=128&d=identicon&r=PG", "display_name": "AlexeyKarasev", "link": "https://stackoverflow.com/users/1682175/alexeykarasev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1590555070, "creation_date": 1453269019, "last_edit_date": 1590555070, "question_id": 34892455, "link": "https://stackoverflow.com/questions/34892455/stubbing-methods-in-golang-unit-testing", "title": "Stubbing methods in Golang unit testing", "body": "<p>I've been thinking about this whole night, but still cannot find an elegant way to do this thing. Let's say I have a struct</p>\n\n<pre><code>type file struct {\n    x int\n}\n\nfunc (f *file) filename() string {\n    return fmt.Sprintf(\"%s/%d.log\", exportPath, f.x)\n}\n\nfunc (f *file) write(data []byte) {\n    ...\n    aFile = os.File.Open(f.filename())\n    ...\n}\n</code></pre>\n\n<p>Now I want to test write method and stub filename method to return temp filename. How can I do this? To the moment I found two options:</p>\n\n<ol>\n<li>declare filename = func(f* file) and override it in test</li>\n<li>make filename a field of the struct</li>\n</ol>\n\n<p>But they both seem wrong in this case. So the question is - can I stub in any way this method? And in general - how to stub internal methods for testing (for external obviously dependency injection could work)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 48375, "user_id": 188331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UhYfd.jpg?s=128&g=1", "display_name": "Raptor", "link": "https://stackoverflow.com/users/188331/raptor"}, "edited": false, "score": 0, "creation_date": 1453261929, "post_id": 34891261, "comment_id": 57520631, "body": "Read this: <a href=\"https://www.socketloop.com/tutorials/golang-how-to-validate-url-the-right-way\" rel=\"nofollow noreferrer\">socketloop.com/tutorials/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1453272116, "post_id": 34891261, "comment_id": 57523826, "body": "Are you tyring the undoable?"}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 4714525, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/24d28783dc3ba3a318ec3ebe1bd372b1?s=128&d=identicon&r=PG&f=1", "display_name": "kbinstance", "link": "https://stackoverflow.com/users/4714525/kbinstance"}, "edited": false, "score": 0, "creation_date": 1453262424, "post_id": 34891287, "comment_id": 57520774, "body": "I tried using this. It doesn&#39;t give me an error for any of the above cases. For e.g. : url.Parse(&quot;////:9000&quot;) does not return an  error."}, {"owner": {"reputation": 316, "user_id": 4714525, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/24d28783dc3ba3a318ec3ebe1bd372b1?s=128&d=identicon&r=PG&f=1", "display_name": "kbinstance", "link": "https://stackoverflow.com/users/4714525/kbinstance"}, "edited": false, "score": 0, "creation_date": 1453262872, "post_id": 34891287, "comment_id": 57520914, "body": "Since in the above case url is not absolute. There is no protocol given."}], "tags": [], "owner": {"reputation": 10902, "user_id": 1025963, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/l89Iu.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1025963/joseph"}, "is_accepted": false, "score": 2, "last_activity_date": 1453262045, "creation_date": 1453262045, "answer_id": 34891287, "question_id": 34891261, "link": "https://stackoverflow.com/questions/34891261/how-to-detect-valid-urls-in-go/34891287#34891287", "title": "How to detect valid URLs in go?", "body": "<p>You'll want to use <code>net/url.Parse()</code>. </p>\n\n<pre><code> import (\n         \"net/url\"\n )\n\n_, err := url.Parse(args[0])\n</code></pre>\n"}], "owner": {"reputation": 316, "user_id": 4714525, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/24d28783dc3ba3a318ec3ebe1bd372b1?s=128&d=identicon&r=PG&f=1", "display_name": "kbinstance", "link": "https://stackoverflow.com/users/4714525/kbinstance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453262045, "creation_date": 1453261820, "last_edit_date": 1453261873, "question_id": 34891261, "link": "https://stackoverflow.com/questions/34891261/how-to-detect-valid-urls-in-go", "title": "How to detect valid URLs in go?", "body": "<p>I wanted to try check for valid urls when i enter it in my program before I send requests to it using the rest API. I used the regexp package in go. The following is my regexp :</p>\n\n<pre><code>urlRegex := \"^(https?://)[-a-zA-Z0-9+&amp;@#/%?=~_|!:,.;]*[-a-zA-Z0-9+&amp;@#/%=~_|]\"\n</code></pre>\n\n<p>I match it to my input using the <code>regexp.MatchString()</code> method. </p>\n\n<pre><code>match, _ := regexp.MatchString(urlRegex, args[0])\n</code></pre>\n\n<p>However this gives me a valid url for cases such as <code>http:////:9000 or http://a.</code></p>\n\n<p>Are there any packages in go that I can import for more robust url checking ?</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1453260908, "post_id": 34890942, "comment_id": 57520338, "body": "The Go struct <code>S</code> and the C struct <code>S</code> are very likely not compatible on your system. You can&#39;t treat a pointer to one as a pointer to the other. Create an object of the type of the C structure instead \u2014 you can create and use a C structure from Go directly."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453298533, "post_id": 34890942, "comment_id": 57540236, "body": "Use specific sized types, like <code>int64</code>, in a struct that needs to match a C struct. In this case use int64, or get the struct from the C definition. Since you can&#39;t access typedef structs through cgo, it&#39;s common to make a C wrapper to access them, rather than matching the struct manually in Go. That way you can let cgo generate them automatically, rather than manually checking the size and alignment."}], "answers": [{"comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1453305906, "post_id": 34903128, "comment_id": 57545710, "body": "This is still the wrong answer. It will fail on Windows. The correct answer is to create a <code>C.S</code> and use it directly; don&#39;t try to force a Go structure whose items will definitely be of a different size or alignment into a C structure."}], "tags": [], "owner": {"reputation": 2634, "user_id": 5138909, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/qBvCy.png?s=128&g=1", "display_name": "KiYugadgeter", "link": "https://stackoverflow.com/users/5138909/kiyugadgeter"}, "is_accepted": false, "score": 2, "last_activity_date": 1453379312, "last_edit_date": 1453379312, "creation_date": 1453301165, "answer_id": 34903128, "question_id": 34890942, "link": "https://stackoverflow.com/questions/34890942/does-not-display-printf-result-in-cgo/34903128#34903128", "title": "Does not display printf result in cgo", "body": "<p>Thanks for comments.</p>\n\n<p>I can got expected result with below codes</p>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\n/*\n#include \"c.h\"\n\n*/\nimport \"C\"\n\nimport (\n    \"unsafe\"\n)\n\ntype S struct {\n    A int64 // 64bit int\n    B int64 // 64bit int \n}\n\nfunc main() {\n    s := &amp;S{A: 4, B: 89}\n    pass_to_c := (*C.S)(unsafe.Pointer(s))\n    C.gostruct(pass_to_c)\n}\n</code></pre>\n\n<p>c.h:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    long long int A; // 64bit int\n    long long int B; // 64bit int\n} S;\n\nextern void gostruct(S *struct_s) {\n    printf(\"{A: %lld, B: %lld}\\n\", struct_s-&gt;A, struct_s-&gt;B);\n}\n</code></pre>\n\n<p>I suppose struct field must use same type between languages. \nIn question code, struct fields type are not same. \n(C struct: 32bit int, Go struct: 64bit int)</p>\n\n<p>In answer code, struct field is same between language.\n(both struct: 64bit int)</p>\n\n<p><em>Note that My architecture is <code>darwin/amd64</code></em></p>\n"}, {"tags": [], "owner": {"reputation": 911, "user_id": 4896468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae9d4b1a95b2fa9bc21f732988c3218?s=128&d=identicon&r=PG", "display_name": "yurenchen", "link": "https://stackoverflow.com/users/4896468/yurenchen"}, "is_accepted": false, "score": 1, "last_activity_date": 1615568648, "last_edit_date": 1615568648, "creation_date": 1615382228, "answer_id": 66565564, "question_id": 34890942, "link": "https://stackoverflow.com/questions/34890942/does-not-display-printf-result-in-cgo/66565564#66565564", "title": "Does not display printf result in cgo", "body": "<p>I run program in LiteIDE, not show c printf output.</p>\n<p>But run the same program in terminal,\nthen c printf output displayed.</p>\n"}], "owner": {"reputation": 2634, "user_id": 5138909, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/qBvCy.png?s=128&g=1", "display_name": "KiYugadgeter", "link": "https://stackoverflow.com/users/5138909/kiyugadgeter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1358, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1615568648, "creation_date": 1453259796, "question_id": 34890942, "link": "https://stackoverflow.com/questions/34890942/does-not-display-printf-result-in-cgo", "title": "Does not display printf result in cgo", "body": "<p>When I ran this code, I expected to printing result like <code>A: 4, B: 89</code>.\nBut actually, Does not display nothing.</p>\n\n<p>Why this program does not display result to stdout?</p>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\n/*\n#include \"c.h\"\n\n*/\nimport \"C\"\n\nimport (\n    \"unsafe\"\n)\n\ntype S struct {\n    A int\n    B int\n}\n\nfunc main() {\n    s := &amp;S{A: 4, B: 89}\n    pass_to_c := (*C.S)(unsafe.Pointer(s))\n    C.gostruct(pass_to_c)\n}\n</code></pre>\n\n<hr>\n\n<p>c.h</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    long int A;\n    long int B;\n} S;\n\nextern void gostruct(S *struct_s) {\n    printf(\"A: %ld, B: %ld\\n\", struct_s-&gt;A, struct_s-&gt;B);\n}\n</code></pre>\n"}, {"tags": ["go", "timer"], "comments": [{"owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "edited": false, "score": 0, "creation_date": 1453258667, "post_id": 34890589, "comment_id": 57519706, "body": "time.After may be better."}, {"owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "edited": false, "score": 0, "creation_date": 1453258669, "post_id": 34890589, "comment_id": 57519708, "body": "time.After(...) Maybe better."}], "answers": [{"tags": [], "owner": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "is_accepted": true, "score": 4, "last_activity_date": 1522356703, "last_edit_date": 1522356703, "creation_date": 1453267276, "answer_id": 34892121, "question_id": 34890589, "link": "https://stackoverflow.com/questions/34890589/how-do-i-find-the-time-remaining-for-a-timer-to-fire/34892121#34892121", "title": "How do I find the time remaining for a Timer to fire?", "body": "<p>There is a simpler way. You can still use a <code>time.Timer</code> to accomplish what you want, you just need to keep track of <code>end time.Time</code>:</p>\n\n<pre><code>type SecondsTimer struct {\n    timer *time.Timer\n    end   time.Time\n}\n\nfunc NewSecondsTimer(t time.Duration) *SecondsTimer {\n    return &amp;SecondsTimer{time.NewTimer(t), time.Now().Add(t)}\n}\n\nfunc (s *SecondsTimer) Reset(t time.Duration) {\n    s.timer.Reset(t)\n    s.end = time.Now().Add(t)\n}\n\nfunc (s *SecondsTimer) Stop() {\n    s.timer.Stop()\n}\n</code></pre>\n\n<p>so time remaining is easy:</p>\n\n<pre><code>func (s *SecondsTimer) TimeRemaining() time.Duration {\n    return s.end.Sub(time.Now())\n}\n</code></pre>\n"}], "owner": {"reputation": 4222, "user_id": 2072269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xNPjb.png?s=128&g=1", "display_name": "muru", "link": "https://stackoverflow.com/users/2072269/muru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1955, "favorite_count": 0, "accepted_answer_id": 34892121, "answer_count": 1, "score": 0, "last_activity_date": 1522356703, "creation_date": 1453257474, "question_id": 34890589, "link": "https://stackoverflow.com/questions/34890589/how-do-i-find-the-time-remaining-for-a-timer-to-fire", "title": "How do I find the time remaining for a Timer to fire?", "body": "<p>I need to run a function after <code>x</code> seconds, with some ability to control (reset the timer, stop the timer, find time remaining for execution). <code>time.Timer</code> is a close fit - the only thing missing is that it seems to provide no way of finding how much time is left.</p>\n\n<p>What options do I have?</p>\n\n<p>At the moment, I'm thinking of something like:</p>\n\n<pre><code>package main\n\nimport \"time\"\n\ntype SecondsTimer struct {\n    T       time.Duration\n    C       chan time.Time\n    control chan time.Duration\n    running bool\n}\n\nfunc (s *SecondsTimer) run() {\n    for s.T.Seconds() &gt; 0 {\n        time.Sleep(time.Second)\n        select {\n        case f := &lt;-s.control:\n            if f &gt; 0 {\n                s.T = f\n            } else {\n                s.running = false\n                break\n            }\n        default:\n            s.T = s.T - 1\n        }\n    }\n    s.C &lt;- time.Now()\n}\nfunc (s *SecondsTimer) Reset(t time.Duration) {\n    if s.running {\n        s.control &lt;- t\n    } else {\n        s.T = t\n        go s.run()\n    }\n\n}\nfunc (s *SecondsTimer) Stop() {\n    if s.running {\n        s.control &lt;- 0\n    }\n}\nfunc NewSecondsTimer(t time.Duration) *SecondsTimer {\n    time := SecondsTimer{t, make(chan time.Time), make(chan time.Duration), false}\n    go time.run()\n    return &amp;time\n}\n</code></pre>\n\n<p>Now I can use <code>s.T.Seconds()</code> as needed.</p>\n\n<p>But I'm wary of race conditions and other such problems. Is this the way to go, or is there something more native I can use?</p>\n"}, {"tags": ["xml", "go", "decoding"], "answers": [{"comments": [{"owner": {"reputation": 596, "user_id": 2473975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0bd38ac51782df4c39da1f86c76d2550?s=128&d=identicon&r=PG&f=1", "display_name": "Aye Mon Chit", "link": "https://stackoverflow.com/users/2473975/aye-mon-chit"}, "edited": false, "score": 0, "creation_date": 1453259187, "post_id": 34890834, "comment_id": 57519835, "body": "Hello Thank you for the answer. May I know where shall i use this method? Should i pass xml_string input to this method ?"}, {"owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "reply_to_user": {"reputation": 596, "user_id": 2473975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0bd38ac51782df4c39da1f86c76d2550?s=128&d=identicon&r=PG&f=1", "display_name": "Aye Mon Chit", "link": "https://stackoverflow.com/users/2473975/aye-mon-chit"}, "edited": false, "score": 0, "creation_date": 1453259552, "post_id": 34890834, "comment_id": 57519942, "body": "<code>xml_string</code> is not utf-16 here unless it is the  content of file which encoding type is utf-16."}, {"owner": {"reputation": 596, "user_id": 2473975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0bd38ac51782df4c39da1f86c76d2550?s=128&d=identicon&r=PG&f=1", "display_name": "Aye Mon Chit", "link": "https://stackoverflow.com/users/2473975/aye-mon-chit"}, "edited": false, "score": 1, "creation_date": 1453259609, "post_id": 34890834, "comment_id": 57519966, "body": "No this is not what i want. What i want is convert encoding=&quot;UTF-16&quot; to &quot;UTF-8&quot; since go only support UTF 8 internally."}, {"owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "reply_to_user": {"reputation": 596, "user_id": 2473975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0bd38ac51782df4c39da1f86c76d2550?s=128&d=identicon&r=PG&f=1", "display_name": "Aye Mon Chit", "link": "https://stackoverflow.com/users/2473975/aye-mon-chit"}, "edited": false, "score": 0, "creation_date": 1453259857, "post_id": 34890834, "comment_id": 57520029, "body": "What is the type of <code>response </code>? []byte?"}, {"owner": {"reputation": 596, "user_id": 2473975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0bd38ac51782df4c39da1f86c76d2550?s=128&d=identicon&r=PG&f=1", "display_name": "Aye Mon Chit", "link": "https://stackoverflow.com/users/2473975/aye-mon-chit"}, "edited": false, "score": 0, "creation_date": 1453260175, "post_id": 34890834, "comment_id": 57520120, "body": "Your method response Chinese character. And this answer is not relate to my question."}, {"owner": {"reputation": 2078, "user_id": 1968365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tzh.jpg?s=128&g=1", "display_name": "Victor Barrantes", "link": "https://stackoverflow.com/users/1968365/victor-barrantes"}, "edited": false, "score": 0, "creation_date": 1472111466, "post_id": 34890834, "comment_id": 65623530, "body": "The answer was useful for me because it converts from utf-16 to utf-8, just what I was looking for. . . regardless to what you want to apply it to."}], "tags": [], "owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "is_accepted": false, "score": 0, "last_activity_date": 1453259088, "creation_date": 1453259088, "answer_id": 34890834, "question_id": 34890522, "link": "https://stackoverflow.com/questions/34890522/how-to-convert-xml-encoding-utf-16-to-utf-8-in-golang/34890834#34890834", "title": "How to convert xml encoding UTF-16 to UTF-8 in golang", "body": "<pre><code>import \"unicode/utf16\"\nimport \"unicode/utf8\"\nimport \"bytes\"\n\nfunc DecodeUTF16(b []byte) (string, error) {\n\n    if len(b)%2 != 0 {\n        return \"\", fmt.Errorf(\"Must have even length byte slice\")\n    }\n\n    u16s := make([]uint16, 1)\n\n    ret := &amp;bytes.Buffer{}\n\n    b8buf := make([]byte, 4)\n\n    lb := len(b)\n    for i := 0; i &lt; lb; i += 2 {\n        u16s[0] = uint16(b[i]) + (uint16(b[i+1]) &lt;&lt; 8)\n        r := utf16.Decode(u16s)\n        n := utf8.EncodeRune(b8buf, r[0])\n        ret.Write(b8buf[:n])\n    }\n\n    return ret.String(), nil\n}\n</code></pre>\n\n<p>Hope This helps u. ^_^</p>\n"}], "owner": {"reputation": 596, "user_id": 2473975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0bd38ac51782df4c39da1f86c76d2550?s=128&d=identicon&r=PG&f=1", "display_name": "Aye Mon Chit", "link": "https://stackoverflow.com/users/2473975/aye-mon-chit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1758, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453259088, "creation_date": 1453257091, "question_id": 34890522, "link": "https://stackoverflow.com/questions/34890522/how-to-convert-xml-encoding-utf-16-to-utf-8-in-golang", "title": "How to convert xml encoding UTF-16 to UTF-8 in golang", "body": "<p>My code as below </p>\n\n<pre><code>xml_string = `&lt;?xml version=\"1.0\" encoding=\"UTF-16\"?&gt;&lt;a&gt;&lt;/a&gt;`\nvar req Request\n\ntext := strings.NewReader(string(response))\nnr, _ = charset.NewReaderLabel(\"utf-16\", text)\ndecoder := xml.NewDecoder(nr)\nerr := decoder.Decode(&amp;req)\n</code></pre>\n\n<p>By the way I am getting EOF error and nil decoded response. Not seem to make it work.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1453259044, "last_edit_date": 1453259044, "creation_date": 1453258738, "answer_id": 34890778, "question_id": 34890480, "link": "https://stackoverflow.com/questions/34890480/are-unexported-identifier-package-public-in-golang/34890778#34890778", "title": "Are unexported identifier package public in Golang?", "body": "<p>All top level constants, types variables and functions have package scope.  This includes unexported identifiers of these kinds. The exact <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">language from the specification is</a>:</p>\n\n<blockquote>\n  <p>The scope of an identifier denoting a constant, type, variable, or\n  function (but not method) declared at top level (outside any function)\n  is the package block.</p>\n</blockquote>\n\n<p>Imported package names are the only entity with file scope.</p>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 34890778, "answer_count": 1, "score": -1, "last_activity_date": 1453259044, "creation_date": 1453256812, "question_id": 34890480, "link": "https://stackoverflow.com/questions/34890480/are-unexported-identifier-package-public-in-golang", "title": "Are unexported identifier package public in Golang?", "body": "<p>As the subject says, are unexported identifiers <code>package public</code> in Golang? \nI read the <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">spec</a> but can't find anything. The compiler seems to treat unexported function names as file private (and not package public).</p>\n"}, {"tags": ["python", "testing", "go", "fixtures", "reusability"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 1, "creation_date": 1453261741, "post_id": 34889721, "comment_id": 57520575, "body": "Check out <a href=\"https://onsi.github.io/ginkgo\" rel=\"nofollow noreferrer\">Ginkgo</a> which has <code>BeforeEach</code> and <code>AfterEach</code>."}], "answers": [{"comments": [{"owner": {"reputation": 567, "user_id": 628081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d9aff6385aad2a75f6d1b464c9d6d4?s=128&d=identicon&r=PG", "display_name": "Duncan Harris", "link": "https://stackoverflow.com/users/628081/duncan-harris"}, "edited": false, "score": 0, "creation_date": 1578492088, "post_id": 34997731, "comment_id": 105455864, "body": "Note you don&#39;t need <code>flag.Parse()</code> in there. It&#39;s only required if you need access to command line flags in your <code>TestMain</code>."}], "tags": [], "owner": {"reputation": 751, "user_id": 3926156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5lMum.png?s=128&g=1", "display_name": "alecdwm", "link": "https://stackoverflow.com/users/3926156/alecdwm"}, "is_accepted": false, "score": 9, "last_activity_date": 1453740163, "creation_date": 1453740163, "answer_id": 34997731, "question_id": 34889721, "link": "https://stackoverflow.com/questions/34889721/fixtures-in-golang-testing/34997731#34997731", "title": "Fixtures in Golang testing", "body": "<p>If you want to use the standard Go testing tools, you can define a function with the signature <code>TestMain(m *testing.M)</code> and put your fixture code in there.</p>\n\n<p>From the <a href=\"https://golang.org/pkg/testing/\" rel=\"noreferrer\">testing package wiki</a>:</p>\n\n<blockquote>\n  <p>It is sometimes necessary for a test program to do extra setup or teardown before or after testing. It is also sometimes necessary for a test to control which code runs on the main thread. To support these and other cases, if a test file contains a function:</p>\n  \n  <p><code>func TestMain(m *testing.M)</code></p>\n  \n  <p>then the generated test will call TestMain(m) instead of running the tests directly. TestMain runs in the main goroutine and can do whatever setup and teardown is necessary around a call to m.Run. It should then call os.Exit with the result of m.Run. When TestMain is called, flag.Parse has not been run. If TestMain depends on command-line flags, including those of the testing package, it should call flag.Parse explicitly.</p>\n  \n  <p>A simple implementation of TestMain is:</p>\n\n<pre><code>func TestMain(m *testing.M) {\n    flag.Parse()\n    os.Exit(m.Run())\n}\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 11979, "user_id": 101923, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FVQn0.jpg?s=128&g=1", "display_name": "Tim Swast", "link": "https://stackoverflow.com/users/101923/tim-swast"}, "edited": false, "score": 0, "creation_date": 1611611685, "post_id": 52704268, "comment_id": 116503553, "body": "Nice! I think this is about as similar as you can get to the pytest fixtures I&#39;m used to."}], "tags": [], "owner": {"reputation": 4129, "user_id": 2081133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/KDQEz.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2081133/james"}, "is_accepted": false, "score": 5, "last_activity_date": 1539008207, "creation_date": 1539008207, "answer_id": 52704268, "question_id": 34889721, "link": "https://stackoverflow.com/questions/34889721/fixtures-in-golang-testing/52704268#52704268", "title": "Fixtures in Golang testing", "body": "<p>I know this is an old question, but this still came up in a search result so I thought I'd give a possible answer.</p>\n\n<p>You can isolate code out to helper functions that return a \"teardown\" function to clean up after itself. Here's one possible way to go about starting a server and have it close at the end of the test case.</p>\n\n<pre><code>func setUpServer() (string, func()) {\n    h := func(w http.ResponseWriter, r *http.Request) {\n        code := http.StatusTeapot\n        http.Error(w, http.StatusText(code), code)\n    }\n\n    ts := httptest.NewServer(http.HandlerFunc(h))\n    return ts.URL, ts.Close\n}\n\nfunc TestWithServer(t *testing.T) {\n    u, close := setUpServer()\n    defer close()\n\n    rsp, err := http.Get(u)\n    assert.Nil(t, err)\n    assert.Equal(t, http.StatusTeapot, rsp.StatusCode)\n}\n</code></pre>\n\n<p>This starts up a server with <code>net/http/httptest</code> and returns its URL along with a function that acts as the \"teardown.\" This function is added to the defer stack so it's always called regardless of how the test case exits.</p>\n\n<p>Optionally, you can pass in the <code>*testing.T</code> if you have a more complicated set up going on in there and you need to handle errors. This example shows the set up function returning a <code>*url.URL</code> instead of a URL formatted string, and the parse can possibly return an error.</p>\n\n<pre><code>func setUpServer(t *testing.T) (*url.URL, func()) {\n    h := func(w http.ResponseWriter, r *http.Request) {\n        code := http.StatusTeapot\n        http.Error(w, http.StatusText(code), code)\n    }\n\n    ts := httptest.NewServer(http.HandlerFunc(h))\n    u, err := url.Parse(ts.URL)\n    assert.Nil(t, err)\n    return u, ts.Close\n}\n\nfunc TestWithServer(t *testing.T) {\n    u, close := setUpServer(t)\n    defer close()\n\n    u.Path = \"/a/b/c/d\"\n    rsp, err := http.Get(u.String())\n    assert.Nil(t, err)\n    assert.Equal(t, http.StatusTeapot, rsp.StatusCode)\n}\n</code></pre>\n"}], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5184, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1560246329, "creation_date": 1453251560, "question_id": 34889721, "link": "https://stackoverflow.com/questions/34889721/fixtures-in-golang-testing", "title": "Fixtures in Golang testing", "body": "<p>Coming from the python world, fixtures are very useful (Fixtures defines a Python contract for reusable state / support logic, primarily for unit testing). I was wondering if there's similar support in Golang which can allow me to run my tests with some predefined fixtures like setting up server, tearing it down, doing some repeated tasks each time a test is run ? Can someone point me to some examples of doing the same in Golang ?</p>\n"}, {"tags": ["debugging", "testing", "go", "ide", "intellij-15"], "comments": [{"owner": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "edited": false, "score": 0, "creation_date": 1453249766, "post_id": 34889319, "comment_id": 57517287, "body": "I&#39;ve had success using LiteIDE to do this though it gets fairly wonky sometimes. <a href=\"https://github.com/visualfc/liteide\" rel=\"nofollow noreferrer\">github.com/visualfc/liteide</a>"}, {"owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "reply_to_user": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "edited": false, "score": 0, "creation_date": 1453251298, "post_id": 34889319, "comment_id": 57517763, "body": "I did try that but found IntelliJ more convenient and thus exploring a way to debug the tests here. LiteIDE is definitely one option. Thanks."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1453285505, "post_id": 34889319, "comment_id": 57531293, "body": "The IntelliJ plugin uses Delve as a debugging backend whereas LiteIDE uses GDB. GDB has poor support for Go that&#39;s why it produces a bad results. On the other side, Delve is not yet mature and will still have issues of its own. I find Delve to be more stable in general however."}], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 3, "last_activity_date": 1453285401, "creation_date": 1453285401, "answer_id": 34897365, "question_id": 34889319, "link": "https://stackoverflow.com/questions/34889319/go-tests-debugging/34897365#34897365", "title": "Go tests debugging", "body": "<p>Currently it's not possible to debug tests, please watch over <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/1855\" rel=\"nofollow\">this issue</a> to see when this will be supported.</p>\n"}, {"tags": [], "owner": {"reputation": 435, "user_id": 4457564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3d84b316c9cc9b7272bae964ac6b5a?s=128&d=identicon&r=PG&f=1", "display_name": "Ewa", "link": "https://stackoverflow.com/users/4457564/ewa"}, "is_accepted": false, "score": 4, "last_activity_date": 1507572848, "creation_date": 1507572848, "answer_id": 46652614, "question_id": 34889319, "link": "https://stackoverflow.com/questions/34889319/go-tests-debugging/46652614#46652614", "title": "Go tests debugging", "body": "<p>It is <strong>possible in Gogland: 1.0 Preview, Build EAP 12, 172.3757.46</strong>.</p>\n\n<p>This version has an expiration date: November 9, 2017, but there are already <a href=\"https://www.jetbrains.com/go/download/#section=linux\" rel=\"nofollow noreferrer\">newer versions released</a> and they probably have later expiration dates.</p>\n"}], "owner": {"reputation": 1147, "user_id": 2583637, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c97742947c8d51a11a6c627aacaafb6d?s=128&d=identicon&r=PG", "display_name": "psbits", "link": "https://stackoverflow.com/users/2583637/psbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6567, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1507572848, "creation_date": 1453248893, "last_edit_date": 1459895798, "question_id": 34889319, "link": "https://stackoverflow.com/questions/34889319/go-tests-debugging", "title": "Go tests debugging", "body": "<p>Is there a way to debug tests in Go using an IDE like IntelliJ ? I am using the Go plugin for intelliJ and seems like when providing a debug configuration, the debug button is disabled. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 4, "creation_date": 1453231426, "post_id": 34885238, "comment_id": 57508205, "body": "if they are in the same package you can just refer to symbols between them without any imports or anything."}, {"owner": {"reputation": 193, "user_id": 3381698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/24bc6787664f67ada71486557e85fdd8?s=128&d=identicon&r=PG&f=1", "display_name": "jCoder", "link": "https://stackoverflow.com/users/3381698/jcoder"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1453234097, "post_id": 34885238, "comment_id": 57509868, "body": "Thanks! TIL not to overcomplicate things."}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1453235419, "post_id": 34885238, "comment_id": 57510712, "body": "If you are accessing functions and methods from the same package but  different <code>.go</code> files on running the main file you should include these files in the order which you are referencing them."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1453237504, "post_id": 34885238, "comment_id": 57512010, "body": "@SimoEndre Can you elaborate that a bit? Some sources would be nice, also."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1453237962, "post_id": 34885238, "comment_id": 57512252, "body": "@MarkusWMahlberg I think @SimoEndre is referring to a situation where you do <code>go run foo.go bar.go main.go</code>"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1453274760, "post_id": 34885238, "comment_id": 57524982, "body": "@MarkusWMahlberg Yes exactly this is the case."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 0, "last_activity_date": 1453875690, "last_edit_date": 1453875690, "creation_date": 1453262634, "answer_id": 34891384, "question_id": 34885238, "link": "https://stackoverflow.com/questions/34885238/refer-to-another-go-file-in-the-library/34891384#34891384", "title": "Refer to another .go file in the library", "body": "<p>In Go, two or more files with the same package name are considered one package, meaning everything is accessible within the namespace, including private (lowercased) and public (capitalized) symbols.</p>\n\n<p>For instance, if <code>hashtable.go</code> and <code>linkedlist.go</code> share the same package name:</p>\n\n<pre><code>package hashtable\n\nimport (\n        ...\n)\n</code></pre>\n\n<p>Then both are considered the same file.</p>\n\n<p>However, if they have different package name, the best practice is to keep them in separate directory.</p>\n\n<pre><code>// hashtable.go\npackage hashtable\n\nimport (\n        ...\n)\n\ntype Hashtable struct {}\n\n// linkedlist.go\npackage linkedlist\nimport (\n        ...\n)\n\ntype Linkedlist struct {}\n</code></pre>\n\n<p>Then organizing them this way:</p>\n\n<pre><code>project/\n\u251c\u2500\u2500 hashtable\n|   \u2514\u2500\u2500 hashtable.go\n\u2514\u2500\u2500 linkedlist\n    \u2514\u2500\u2500 linkedlist.go\n</code></pre>\n\n<p>And for example, in <code>hashtable.go</code>, import <code>linkedlist</code> to use its public variables:</p>\n\n<pre><code>// hashtable.go\npackage hashtable\n\nimport (\n        ../linkedlist\n)\n\nli = linkedlist.Linkedlist{}\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3381698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/24bc6787664f67ada71486557e85fdd8?s=128&d=identicon&r=PG&f=1", "display_name": "jCoder", "link": "https://stackoverflow.com/users/3381698/jcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 34891384, "answer_count": 1, "score": -2, "last_activity_date": 1453875690, "creation_date": 1453231244, "question_id": 34885238, "link": "https://stackoverflow.com/questions/34885238/refer-to-another-go-file-in-the-library", "title": "Refer to another .go file in the library", "body": "<p>I am very new to Go and I have gone through <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How to Write Go Code</a> </p>\n\n<p>While it was very helpful, I'm confused about how to use a go file from within the same library.</p>\n\n<p>For example, this is my structure : <br></p>\n\n<pre><code>~/src/\n    hashtable/\n      hashtable.go\n      linkedlist.go\n</code></pre>\n\n<p>I want to use linkedlist in hashtable. What should be my directory structure and what package names should I use?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 3262, "user_id": 1900537, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/I7rTU.jpg?s=128&g=1", "display_name": "romants", "link": "https://stackoverflow.com/users/1900537/romants"}, "edited": false, "score": 1, "creation_date": 1453229260, "post_id": 34884570, "comment_id": 57506979, "body": "Are you sure that&#39;s the reason? Because the given code finishes fine for me. In any case, have you tried simple <code>return</code>?"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 3262, "user_id": 1900537, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/I7rTU.jpg?s=128&g=1", "display_name": "romants", "link": "https://stackoverflow.com/users/1900537/romants"}, "edited": false, "score": 0, "creation_date": 1453229858, "post_id": 34884570, "comment_id": 57507285, "body": "I don&#39;t know where you tried, but on my computer this code doesn&#39;t finish. I don&#39;t know how to use <code>return</code> with goroutines. All calculates inside goroutine and result can&#39;t be &quot;return&quot;."}, {"owner": {"reputation": 3262, "user_id": 1900537, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/I7rTU.jpg?s=128&g=1", "display_name": "romants", "link": "https://stackoverflow.com/users/1900537/romants"}, "edited": false, "score": 0, "creation_date": 1453229898, "post_id": 34884570, "comment_id": 57507298, "body": "<code>go func() { return }()</code> ?"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 3262, "user_id": 1900537, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/I7rTU.jpg?s=128&g=1", "display_name": "romants", "link": "https://stackoverflow.com/users/1900537/romants"}, "edited": false, "score": 0, "creation_date": 1453229940, "post_id": 34884570, "comment_id": 57507322, "body": "And I know (after manual calc) success result are missed... Because os.Exit didn&#39;t work when is needed."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 3262, "user_id": 1900537, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/I7rTU.jpg?s=128&g=1", "display_name": "romants", "link": "https://stackoverflow.com/users/1900537/romants"}, "edited": false, "score": 0, "creation_date": 1453230141, "post_id": 34884570, "comment_id": 57507439, "body": "I added a playground link for show my code logic (just structure example)"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453230603, "post_id": 34884986, "comment_id": 57507696, "body": "JimB, I added a playground link in the topic, can you view and modify my example for success work? Thanks."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1453416603, "last_edit_date": 1453416603, "creation_date": 1453230383, "answer_id": 34884986, "question_id": 34884570, "link": "https://stackoverflow.com/questions/34884570/golang-why-os-exit-doesnt-work-inside-goroutines/34884986#34884986", "title": "Golang: Why os.Exit doesn&#39;t work inside goroutines", "body": "<p>You terminate a goroutine by returning from the function. If you need to ensure that the goruotine runs to completion, you need to wait for the goroutine to complete. This is usually done with a <code>sync.WaitGroup</code>, or by synchronizing the goroutines via channels. </p>\n\n<p>In your example, you first need to ensure that there is no possibility of spawning an infinite number of goroutines. Because there's no synchronization points between <code>main</code> and the new goroutines, there's no guarantee that any of them will execute the <code>os.Exit</code> call while the main loop is running. </p>\n\n<p>The usual way of waiting for any number of goroutines to complete is to use a <code>sync.WaitGroup</code>, which will ensure they have all executed before <code>main</code> exits.  </p>\n\n<pre><code>wg := sync.WaitGroup{}\nfor i := 0; i &lt; 10000; i++ {\n    wg.Add(1)\n    go func() { defer wg.Done() }()\n}\n\nwg.Wait()\nfmt.Println(\"done\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 2, "creation_date": 1453230736, "post_id": 34885000, "comment_id": 57507772, "body": "Or you can change GOMAXPROCS to something &gt;1 and it will work without modification. Pretty obvious one when you find out that  GOMAXPROCS is 1 in the playground."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453230979, "post_id": 34885000, "comment_id": 57507918, "body": "Actually that&#39;s probably not it. If he&#39;s running go1.5, GOMAXPROCS defaults to the number of CPU cores he has (almost certainly more than 1). The issue is that GOMAXPROCS is not the number of OS threads to run - it&#39;s the <i>maximum</i> number of OS threads to run, and if there&#39;s only one running at the beginning, his code will never kick the scheduler into spawning new ones."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453231025, "post_id": 34885000, "comment_id": 57507954, "body": "(he said &quot;I&#39;m wait one day, two day.... What?&quot;, which makes me think he was running it on a computer, not just on the playground)."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453231230, "post_id": 34885000, "comment_id": 57508081, "body": "Thanks. I modify my example as you proposed, but without success <a href=\"http://play.golang.org/p/Io8NUXh0UR\" rel=\"nofollow noreferrer\">play.golang.org/p/Io8NUXh0UR</a> (Process took too long)"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1453231416, "post_id": 34885000, "comment_id": 57508195, "body": "I think you&#39;re just getting unlucky with the process taking a while; check out what happens when you change the constant to 10: <a href=\"https://play.golang.org/p/SkZzYHC_on\" rel=\"nofollow noreferrer\">play.golang.org/p/SkZzYHC_on</a>"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453231503, "post_id": 34885000, "comment_id": 57508256, "body": "Well, as I understand it, GOMAXPROCS lets you define exact number of OS threads that will be used as processors i.e. execution units for goroutines. When I was reading about the scheduler I did some tests with infinite loops and how it affects the program depending on GOMAXPROCS value. And GOMAXPROCS &gt; 1 solved deadlocking everytime. Why wouldn&#39;t, that the whole point. And on older go runtimes, maybe even just before 1.5 GOMAXPROCS was always equal to 1 regardless of available CPU cores"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1453231639, "post_id": 34885000, "comment_id": 57508339, "body": "It&#39;s not the exact number, but the maximum. But you&#39;re right that the default used to be 1."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453231653, "post_id": 34885000, "comment_id": 57508349, "body": "About compiler inserting scheduler calls. That doesn&#39;t work as simple as that. It will only insert calls if there is a function call. Compiler might inline the function  or throw it away completely and you will get deadlock. When I did my tests I had to disable inlining and had to make pretty big function before it started working as it supposed to."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453231736, "post_id": 34885000, "comment_id": 57508395, "body": "May be maximum but it shouldn&#39;t give you deadlock it such a simple case. And it&#39;s not unrealistic either."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453231782, "post_id": 34885000, "comment_id": 57508420, "body": "I can&#39;t in real program to increase or decrease &quot;compared&quot; values, It&#39;s undefined. How I can will stop goroutines when inside is Boolean <code>true</code>? :)"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1453231822, "post_id": 34885000, "comment_id": 57508446, "body": "That&#39;s true, but in a real program the runtime won&#39;t kill your process if you run for a bit too long ;)"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453231905, "post_id": 34885000, "comment_id": 57508484, "body": "Guys, I don&#39;t know about &quot;GOMAXPROCS&quot;, I&#39;m started learn Go week ago. I use 1.5.2 (last) version. My code very-very similar as <a href=\"http://play.golang.org/p/Io8NUXh0UR\" rel=\"nofollow noreferrer\">play.golang.org/p/Io8NUXh0UR</a> but compared values undefined."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453232027, "post_id": 34885000, "comment_id": 57508563, "body": "Can you give us a more realisic example? As for GOMAXPROCS, checkout this <a href=\"http://play.golang.org/p/pbEC7J3133\" rel=\"nofollow noreferrer\">play.golang.org/p/pbEC7J3133</a> Only thing I changed is added <code>runtime.GOMAXPROCS(2)</code> Now it works like it should"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453232086, "post_id": 34885000, "comment_id": 57508604, "body": "@creker - I know that the function might be inlined, but apparently it wasn&#39;t ;)"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453232381, "post_id": 34885000, "comment_id": 57508778, "body": "@joshlf, but it still unreliable. I changed count to 2 and it still deadlocks. Playground keeps killing the process. Check out this <a href=\"https://play.golang.org/p/Dk0VFzyYEQ\" rel=\"nofollow noreferrer\">play.golang.org/p/Dk0VFzyYEQ</a> I ran it many times - <code>show</code> doesn&#39;t get called even ones. Good thing is in real applications there will be real function calls and even blocking ones so everything will work fine even with GOMAXPROCS=1"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1453232688, "post_id": 34885000, "comment_id": 57508973, "body": "I think the only thing happening here is that the playground is getting pissy about how long it&#39;s running, but it&#39;s not actually deadlocked - try running it on a real computer."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453233155, "post_id": 34885000, "comment_id": 57509263, "body": "I tried - had to reboot my PC. It deadlocked and kept spawning goroutines until my RAM was filled and whole OS just froze. Of course I launched it with GOMAXPROCS=1. So, no, scheduler call is not inserted in that case. My example above shows that goroutines don&#39;t get a single chance to run"}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453233317, "post_id": 34885000, "comment_id": 57509368, "body": "More real example in <a href=\"http://play.golang.org/p/XvebObOhDA\" rel=\"nofollow noreferrer\">play.golang.org/p/XvebObOhDA</a> - diff with my code only in numbers size, I&#39;m using big.Int. All yours proposed ideas I tried on real computer (every time modify my code) but without success."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1453233583, "post_id": 34885000, "comment_id": 57509536, "body": "Hmm ok. Try <code>time.Sleep(1)</code> instead."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453233639, "post_id": 34885000, "comment_id": 57509582, "body": "@AL: that last example doesn&#39;t work, because main is exiting before anything happens."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453233947, "post_id": 34885000, "comment_id": 57509777, "body": "@JimB it&#39;s not true. Because if you modify last example to  <a href=\"http://play.golang.org/p/WSFozjw65Z\" rel=\"nofollow noreferrer\">play.golang.org/p/WSFozjw65Z</a> (marked THIS LINE ADDED) and run <code>go run code.go &gt; res.txt</code> you will see result."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453234293, "post_id": 34885000, "comment_id": 57510008, "body": "@joshlf Where I should add this line? And I don&#39;t like stop every iteration even on the 1 sec. Because speed is important.... <code>Billions iterations * 1sec != not good idea</code>, imho :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453234305, "post_id": 34885000, "comment_id": 57510013, "body": "@AL: so the scheduler gets a chance to switch goroutines before exiting. There&#39;s nothing unexpected here. Realistic code which doesn&#39;t spawn a possibly infinite number of goroutines,  and then waits for them to finish will <i>always</i> works as expected."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453234522, "post_id": 34885000, "comment_id": 57510152, "body": "@JimB I say to you Thank you, and for all guys, but I&#39;m not ready to learn &quot;how work scheduler&quot; and I need in one thing: how to terminate goroutine, when inside is TRUE? :) Thanks."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1453234962, "post_id": 34885000, "comment_id": 57510408, "body": "OK, technically the best thing to do would be <a href=\"https://golang.org/pkg/runtime/#Gosched\" rel=\"nofollow noreferrer\"><code>runtime.Gosched</code></a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453235398, "post_id": 34885000, "comment_id": 57510698, "body": "@AL: that still isn&#39;t the correct solution, since there is no guarantee that the goroutine will run at all. My previous comment wan&#39;t about learning how the scheduler works, it was about creating a deterministic logic flow in the program."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453236085, "post_id": 34885000, "comment_id": 57511144, "body": "Sorry @JimB. My last reply is not aggressive, my brain work very hard to understand one thing and my criticism to Golang only. I thinking simple - programming lang must be simple, and shouldn&#39;t brake the work or take the &quot;golden time&quot; to learn. Thanks. )"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453236453, "post_id": 34885000, "comment_id": 57511366, "body": "@AL: that&#39;s fine, but Gosched is almost always the wrong answer. If you wanted to know why os.Exit wasn&#39;t being called in this specific case, then you need to know something about the scheduler. If you want to know how to do it correctly, then you have some sort of synchronization to ensure your goroutines execute, and all this talk about the scheduler is moot."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453236967, "post_id": 34885000, "comment_id": 57511698, "body": "@JimB Thanks. Synchronization is &quot;dark forest&quot; for me :) I think about channels, but I don&#39;t have a time to learn that. Maybe later..."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453237470, "post_id": 34885000, "comment_id": 57511986, "body": "@AL I think what @JimB is saying is that if you use proper synchronization (for example, channels), you won&#39;t have to understand how the scheduler works to know that your program will work correctly. That said, I agree that if you only want a quick-and-dirty solution that will work for your purposes right now, <code>runtime.Gosched</code> will do that for you. But in the long run, you&#39;ll probably want to figure out how to do this sort of thing with channels."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453237750, "post_id": 34885000, "comment_id": 57512137, "body": "@AL: then see my answer for a solution without channels. You simply cannot use concurrency without synchronization -- it can&#39;t work. joshlf, like I said before, Gosched might make the program work more often on a specific version of the runtime, but there&#39;s still no guarantee that the goroutines will run to completion, or at all."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 2, "creation_date": 1453247580, "post_id": 34885000, "comment_id": 57516625, "body": "@AL, go IS simple. When you write proper idiomatic code using goroutines and channels everything will just work. But what&#39;s simple on the surface is  complex on the inside. Golang simplicity is about complexity of the runtime and how much it does for you. So when you find an edge case like this one you have to dig deeper to understand what&#39;s going on. Deadlocking and goroutines starvation is an edge case when you have an infinite loop without function calls and your GOMAXPROCS=1. It&#39;s a known one and expected but hard to understand without understanding the basics of go scheduler."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453247623, "post_id": 34885000, "comment_id": 57516645, "body": "@AL, can you please post the output of <code>fmt.Println(runtime.GOMAXPROCS(0))</code> on your machine."}, {"owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "edited": false, "score": 0, "creation_date": 1453255099, "post_id": 34885000, "comment_id": 57518786, "body": "News: <b>1.</b> GOMAXPROCS = 4 <b>2.</b> Gosched works, but a) very slow, slower than without goroutine b) as I see Gosched didn&#39;t use all processors, or merge goroutines to &quot;stream&quot; - like line <b>3.</b> Later I try to modify my code with channels. <b>4.</b> Also I have a plan write to Dave Cheney or Dmitry Vyukov, maybe anyone write about this problem for newbies :D.... See later."}], "tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": false, "score": 15, "last_activity_date": 1453235078, "last_edit_date": 1453235078, "creation_date": 1453230425, "answer_id": 34885000, "question_id": 34884570, "link": "https://stackoverflow.com/questions/34884570/golang-why-os-exit-doesnt-work-inside-goroutines/34885000#34885000", "title": "Golang: Why os.Exit doesn&#39;t work inside goroutines", "body": "<p>You've run into a sticky corner of the Go scheduler. The answer is that <code>os.Exit</code> <em>does</em> cause the entire process to exit, but the way you had it, the goroutines were never running.</p>\n\n<p>What probably happened was that the for loop kept adding new goroutines to the list of available goroutines, but since the entire process was only running in one OS thread, the Go scheduler never got around to actually scheduling a different goroutine, and just kept running that for loop without ever running any of the goroutines you'd spawned. Try this instead:</p>\n\n<pre><code>package main\n\nimport \"os\"\n\nfunc main() {\n    for {\n        go func() { os.Exit(0) }()\n        func() {}()\n    }\n}\n</code></pre>\n\n<p>If you run it on the Go Playground, it should work (in fact, <a href=\"https://play.golang.org/p/KS3MwEPjkO\" rel=\"noreferrer\">here's a link</a>).</p>\n\n<p>OK, the fact that the above code works while yours doesn't should be pretty mysterious. The reason this works is that the Go scheduler is actually non-preempting. What that means is that unless a given goroutine voluntarily decides to give the scheduler the option to run something else, nothing else will run. </p>\n\n<p>Now obviously you've never written code that includes commands to give the scheduler a chance to run. What happens is that when your code is compiled, the Go compiler automatically inserts these into your code. And here's the key to why the above code works: one of the times that a goroutine might decide to run the scheduler is when a function is called. So by adding the <code>func() {}()</code> call (which obviously does nothing), we've allowed the compiler to add in a call to the scheduler, giving this code the opportunity to schedule different goroutines. Thus, one of the spawned goroutines runs, calls <code>os.Exit</code>, and the process exits.</p>\n\n<p><strong>EDIT</strong>: The function call itself may not be sufficient in the event that the compiler inlines the call (or, in this case, removes it entirely since it does nothing). <a href=\"https://golang.org/pkg/runtime/#Gosched\" rel=\"noreferrer\"><code>runtime.Gosched()</code></a>, on the other hand, is guaranteed to work.</p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 4337190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35203e1a7bb6f9b68ebefcd6713cba5d?s=128&d=identicon&r=PG&f=1", "display_name": "maurice", "link": "https://stackoverflow.com/users/4337190/maurice"}, "is_accepted": false, "score": -4, "last_activity_date": 1453313237, "creation_date": 1453313237, "answer_id": 34907352, "question_id": 34884570, "link": "https://stackoverflow.com/questions/34884570/golang-why-os-exit-doesnt-work-inside-goroutines/34907352#34907352", "title": "Golang: Why os.Exit doesn&#39;t work inside goroutines", "body": "<p>Implement a deadhand or kill switch</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"time\"\n        \"os\"\n)\n\nconst maxNoTickle = 50          // will bail out after this many no tickles\nconst maxWorking = 20           // pretendWork() will tickle this many times\nconst deadTicks = 250           // milliseconds for deadHand() to check for tickles\nconst reportTickles = 4         // consecutive tickles or no tickles to print something\n\nvar (\n        tickleMe bool           // tell deadHand() we're still alive\n        countNoTickle int       // consecutive no tickles\n        countGotTickle int      // consecutive tickles\n)\n\n/**\n*       deadHand() - callback to kill program if nobody checks in after some period\n*/\nfunc deadHand() {\n        if !tickleMe {\n                countNoTickle++\n                countGotTickle = 0\n                if countNoTickle &gt; maxNoTickle {\n                        fmt.Println(\"No tickle max time reached. Bailing out!\")\n                        // panic(\"No real panic. Just checking stack\")\n                        os.Exit(0)\n                }\n                if countNoTickle % reportTickles == 0 {\n                        // print dot for consecutive no tickles\n                        fmt.Printf(\".\")\n                }\n        } else {\n                countNoTickle = 0\n                countGotTickle++\n                tickleMe = false        // FIXME: might have race condition here\n                if countGotTickle % reportTickles == 0 {\n                        // print tilda for consecutive tickles\n                        fmt.Printf(\"~\")\n                }\n        }\n        // call ourselves again\n        time.AfterFunc(deadTicks * time.Millisecond, deadHand)\n}\n\n/**\n*       init() - required to start deadHand\n*/\nfunc init() {\n        time.AfterFunc(250 * time.Millisecond, deadHand)\n        tickleMe = true\n}\n\n/**\n*       pretendWork() - your stuff that does its thing\n*/\nfunc pretendWork() {\n        for count := 0; count &lt; maxWorking; count++ {\n                tickleMe = true // FIXME: might have race condition here\n                // print W pretending to be busy\n                fmt.Printf(\"W\")\n                time.Sleep(100 * time.Millisecond)\n        }\n}\n\nfunc main() {\n        go workTillDone()\n        for {\n                // oops, program went loop-d-loopy\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 5782947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada63a02ba07f75b7812959796032bb2?s=128&d=identicon&r=PG&f=1", "display_name": "A L", "link": "https://stackoverflow.com/users/5782947/a-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4831, "favorite_count": 2, "answer_count": 3, "score": 8, "last_activity_date": 1453416603, "creation_date": 1453228978, "last_edit_date": 1453230175, "question_id": 34884570, "link": "https://stackoverflow.com/questions/34884570/golang-why-os-exit-doesnt-work-inside-goroutines", "title": "Golang: Why os.Exit doesn&#39;t work inside goroutines", "body": "<p>I have a research program with very simple algorithm. When success is coming goroutine should be close (end) via os.Exit(0). I'm wait one day, two day.... What? :)</p>\n\n<p>Here is the simple code</p>\n\n<pre><code>package main\n\nimport \"os\"\n\nfunc main() {\n    for {\n        go func() { os.Exit(0) }()\n    }\n}\n</code></pre>\n\n<p>And my questions: </p>\n\n<ol>\n<li>Why os.Exit doesn't terminate the goroutine?</li>\n<li>What is correct way to terminate (stop) goroutine execute?</li>\n</ol>\n\n<p>Playground: <a href=\"http://play.golang.org/p/GAeOI-1Ksc\" rel=\"noreferrer\">http://play.golang.org/p/GAeOI-1Ksc</a></p>\n"}, {"tags": ["json", "go", "byte"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1453223005, "creation_date": 1453223005, "answer_id": 34882731, "question_id": 34882694, "link": "https://stackoverflow.com/questions/34882694/set-array-of-byts-to-json-rawmessage/34882731#34882731", "title": "set array of byts to json.RawMessage", "body": "<p>You need a <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">type conversion</a>, not a literal:</p>\n\n<pre><code>data := json.RawMessage(obj_data)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 1845055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e7365312513f2c2fb8a4f80f055d?s=128&d=identicon&r=PG", "display_name": "user1845055", "link": "https://stackoverflow.com/users/1845055/user1845055"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 34882731, "answer_count": 1, "score": 1, "last_activity_date": 1453223005, "creation_date": 1453222902, "question_id": 34882694, "link": "https://stackoverflow.com/questions/34882694/set-array-of-byts-to-json-rawmessage", "title": "set array of byts to json.RawMessage", "body": "<p>I have array of bytes in golang:</p>\n\n<pre><code>obj_data, _ := json.Marshal(obj)\n</code></pre>\n\n<p>And a want set this array of bytes into json.RawMessage\nI thought that it would work:</p>\n\n<pre><code>data := json.RawMessage{obj_data}\n</code></pre>\n\n<p>but i have error:</p>\n\n<pre><code>cannot use obj_data (type []byte) as type byte in array element\n</code></pre>\n\n<p>please help me! =)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1453219926, "post_id": 34881555, "comment_id": 57501215, "body": "<code>Port</code> <a href=\"https://github.com/tarm/serial/blob/master/serial_linux.go#L98\" rel=\"nofollow noreferrer\">implements</a> <code>io.Reader</code> itself."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 0, "last_activity_date": 1453263152, "creation_date": 1453263152, "answer_id": 34891471, "question_id": 34881555, "link": "https://stackoverflow.com/questions/34881555/structure-member-used-instead-of-structure-itself/34891471#34891471", "title": "Structure Member used instead of structure itself", "body": "<p><code>Port</code> has method <code>Read(b []byte) (n int, err error)</code> thus it implements <code>io.Reader</code>.</p>\n\n<p>See <a href=\"https://github.com/tarm/serial/blob/master/serial_posix.go#L128-L130\" rel=\"nofollow\">the source</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5811293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc77d58caa33e92770e660d9ce4e6f0?s=128&d=identicon&r=PG", "display_name": "Anoop Anand", "link": "https://stackoverflow.com/users/5811293/anoop-anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453263152, "creation_date": 1453219764, "last_edit_date": 1495541248, "question_id": 34881555, "link": "https://stackoverflow.com/questions/34881555/structure-member-used-instead-of-structure-itself", "title": "Structure Member used instead of structure itself", "body": "<p>So this is related to <a href=\"https://github.com/tarm/serial\" rel=\"nofollow noreferrer\">tarm's Go Serial Package</a>.</p>\n\n<p>I was trying to use it to read a '\\r\\n' terminated string from serial. While it doesn't have this as a built in function, I found <a href=\"https://stackoverflow.com/questions/17599232/reading-from-serial-port-with-while-loop\">this answer</a> and got things working from there (using a scanner on the created port with a custom split function).</p>\n\n<p>Now my question is exactly that, why does this work? The port stuct is as follows (from the package source code): </p>\n\n<pre><code>type Port struct {\n    // We intentionly do not use an \"embedded\" struct so that we\n    // don't export File\n    f *os.File\n}\n</code></pre>\n\n<p>So the file pointer is only a field of the Port type, It's not embedded or anything.</p>\n\n<p>But the following code works: </p>\n\n<pre><code>func handler(port *serial.Port) {\n\n    scanner := bufio.NewScanner(port)\n\n    scanner.Split(scanMessageLine)\n\n    for {\n\n        scanner.Scan()\n\n        messageBytes := scanner.Bytes()\n    }\n}\n</code></pre>\n\n<p>How am I able to create a Scanner, which requires the io.Reader interface with the port; While its only a member of port that implements the interface, not port itself? </p>\n\n<p>Also, the code completion in Webstorm (I use it with the Golang plugin) suggests the functions on f as direct members of port, but if I println the port stuct instance it just contains a pointer? </p>\n\n<p>Just to eliminate the IDE doing something weird I built the program from the command line and it still works.</p>\n\n<p>Is there some fancy pointer voodoo I'm missing here? Or a is it a commonly used Golang feature? Is there a provision for a stuct with a single member to expose it's member's methods directly? Even if it isn't embedded?</p>\n\n<p>Since its entirely possible that I've completely misunderstood this whole interface thing, if there's some nice in depth material that you guys suggest I should read, I'd love to do that. Considering how interfaces are all over the place in go, I want to understand them properly.</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 3329, "user_id": 7438973, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/bbf9cd835054e12d27a93ef23194fd1b?s=128&d=identicon&r=PG&f=1", "display_name": "nagendra547", "link": "https://stackoverflow.com/users/7438973/nagendra547"}, "edited": false, "score": 0, "creation_date": 1544078985, "post_id": 34880766, "comment_id": 94150470, "body": "Thanks a lot. I also faced this issue and your solution worked!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1453219790, "last_edit_date": 1453219790, "creation_date": 1453217628, "answer_id": 34880766, "question_id": 34880504, "link": "https://stackoverflow.com/questions/34880504/golang-create-struct-in-different-way/34880766#34880766", "title": "Golang create struct in different way", "body": "<p>In <code>test2</code> you're passing in the address of the <code>interface{}</code> containing a <code>Test</code> value. When the value is dereferenced by the json package it only sees an <code>interface{}</code>, and therefor it unmarshals into the default types.</p>\n\n<p>What you need is an <code>interface{}</code> containing a pointer to a <code>Test</code> value. </p>\n\n<pre><code>// reflect.New is creating a *Test{} value.\n// You don't want to dereference that with Elem()\na := reflect.New(m[\"test\"]).Interface()\n\n// 'a' contains a *Test value. You already have a pointer, and you\n// don't want the address of the interface value.\nerr := json.Unmarshal([]byte(`{\"X\":1,\"Y\":\"x\"}`), a)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5811118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g8jQLpDzwrA/AAAAAAAAAAI/AAAAAAAAAA0/QolIRHpu_OM/photo.jpg?sz=128", "display_name": "BinaryLeeward", "link": "https://stackoverflow.com/users/5811118/binaryleeward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 1, "accepted_answer_id": 34880766, "answer_count": 1, "score": 4, "last_activity_date": 1453219790, "creation_date": 1453216813, "question_id": 34880504, "link": "https://stackoverflow.com/questions/34880504/golang-create-struct-in-different-way", "title": "Golang create struct in different way", "body": "<p>guys! I am a beginner in Go. I have some doubts When I learning <code>reflect</code> package ,here's the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc checkError(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\ntype Test struct {\n    X int\n    Y string\n}\n\nfunc main() {\n    fmt.Println(\"hello world!\")\n    test1()\n    test2()\n}\n\nfunc test1() {\n    a := Test{}\n    fmt.Printf(\"a: %v %T \\n\", a, a)\n    fmt.Println(a)\n    err := json.Unmarshal([]byte(`{\"X\":1,\"Y\":\"x\"}`), &amp;a)\n    checkError(err)\n    fmt.Printf(\"a: %v %T \\n\", a, a)\n}\n\nfunc test2() {\n    fmt.Println(\"===========================\")\n    m := make(map[string]reflect.Type)\n    m[\"test\"] = reflect.TypeOf(Test{})\n    a := reflect.New(m[\"test\"]).Elem().Interface()\n    fmt.Printf(\"a: %v %T \\n\", a, a)\n    fmt.Println(a)\n    err := json.Unmarshal([]byte(`{\"X\":1,\"Y\":\"x\"}`), &amp;a)\n    checkError(err)\n    fmt.Printf(\"a: %v %T \\n\", a, a)\n}\n</code></pre>\n\n<p>and the result :</p>\n\n<pre><code>a: {0 } main.Test \n{0 }\na: {1 x} main.Test \n===========================\na: {0 } main.Test \n{0 }\na: map[X:1 Y:x] map[string]interface {}\n</code></pre>\n\n<p>Why these two way make different result, Could anyone tell me why, many thanks.</p>\n"}, {"tags": ["checkbox", "go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 7, "last_activity_date": 1453500331, "last_edit_date": 1453500331, "creation_date": 1453214326, "answer_id": 34879607, "question_id": 34879373, "link": "https://stackoverflow.com/questions/34879373/golang-how-to-get-all-the-value-of-checkbox-r-formvalue-is-not-working/34879607#34879607", "title": "Golang - How to get all the value of checkbox? r.FormValue is not working?", "body": "<p><a href=\"https://golang.org/pkg/net/http/#Request.FormValue\" rel=\"nofollow\"><code>Request.FormValue</code></a> only returns the first value if there is more than one. From the Documentation:</p>\n\n<blockquote>\n  <p>FormValue returns the first value for the named component of the query.</p>\n  \n  <p>...</p>\n  \n  <p>To access multiple values of the same key, call <code>ParseForm</code> and then\n  inspect <code>Request.Form</code> directly.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5810968, "user_type": "registered", "profile_image": "https://graph.facebook.com/1262708623744955/picture?type=large", "display_name": "Sravan Bonthala", "link": "https://stackoverflow.com/users/5810968/sravan-bonthala"}, "is_accepted": false, "score": 5, "last_activity_date": 1453215694, "creation_date": 1453215694, "answer_id": 34880099, "question_id": 34879373, "link": "https://stackoverflow.com/questions/34879373/golang-how-to-get-all-the-value-of-checkbox-r-formvalue-is-not-working/34880099#34880099", "title": "Golang - How to get all the value of checkbox? r.FormValue is not working?", "body": "<p><code>r.FormValue</code> returns the first value from the list of options\ninstead use <code>r.Form</code> , this returns a list.\nyou can access your values by\n<code>r.Form[\"product_image_id\"]</code></p>\n"}, {"tags": [], "owner": {"reputation": 4635, "user_id": 1411589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2a6b1a1c31198db776d76af7f04c1bbd?s=128&d=identicon&r=PG", "display_name": "deepakssn", "link": "https://stackoverflow.com/users/1411589/deepakssn"}, "is_accepted": false, "score": 3, "last_activity_date": 1477565304, "creation_date": 1477565304, "answer_id": 40282676, "question_id": 34879373, "link": "https://stackoverflow.com/questions/34879373/golang-how-to-get-all-the-value-of-checkbox-r-formvalue-is-not-working/40282676#40282676", "title": "Golang - How to get all the value of checkbox? r.FormValue is not working?", "body": "<p>HTML</p>\n\n<pre><code>    &lt;form method=\"post\" name=\"myform\" action=\"http://localhost:8081/post\" &gt;\n     &lt;input type=\"checkbox\" name=\"product_image_id\" value=\"Apple\" /&gt;\n     &lt;input type=\"checkbox\" name=\"product_image_id\" value=\"Orange\" /&gt;\n     &lt;input type=\"checkbox\" name=\"product_image_id\" value=\"Grape\" /&gt;\n     &lt;input type=\"submit\"&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>Go</p>\n\n<pre><code>// ProcessCheckboxes will process checkboxes\nfunc ProcessCheckboxes(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    fmt.Printf(\"%+v\\n\", r.Form)\n    productsSelected := r.Form[\"product_image_id\"]\n    log.Println(contains(productsSelected, \"Grape\"))\n}\n\nfunc contains(slice []string, item string) bool {\n    set := make(map[string]struct{}, len(slice))\n    for _, s := range slice {\n        set[s] = struct{}{}\n    }\n    _, ok := set[item]\n    return ok\n}\n</code></pre>\n\n<p>Output</p>\n\n<p>Orange and Grape checboxes are checked and submitted</p>\n\n<pre><code>map[product_image_id:[Orange Grape]]\n2016/10/27 16:16:06 true\n</code></pre>\n\n<p>Apple and Orange checboxes are checked and submitted</p>\n\n<pre><code>map[product_image_id:[Apple Orange]]\n2016/10/27 16:17:21 false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 8414569, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XELGZJ_VbXs/AAAAAAAAAAI/AAAAAAAAAyo/6kpKqnc2JFY/photo.jpg?sz=128", "display_name": "Jun", "link": "https://stackoverflow.com/users/8414569/jun"}, "is_accepted": false, "score": 2, "last_activity_date": 1502352863, "creation_date": 1502352863, "answer_id": 45608038, "question_id": 34879373, "link": "https://stackoverflow.com/questions/34879373/golang-how-to-get-all-the-value-of-checkbox-r-formvalue-is-not-working/45608038#45608038", "title": "Golang - How to get all the value of checkbox? r.FormValue is not working?", "body": "<p>HTML</p>\n\n<pre><code>&lt;input type=\"checkbox\" name=\"product_image_id\" value=\"0\" /&gt;\n&lt;input type=\"checkbox\" name=\"product_image_id\" value=\"1\" checked/&gt;\n&lt;input type=\"checkbox\" name=\"product_image_id\" value=\"2\" checked/&gt;\n&lt;input type=\"checkbox\" name=\"product_image_id\" value=\"3\" /&gt;\n&lt;input type=\"checkbox\" name=\"product_image_id\" value=\"4\" checked/&gt;\n</code></pre>\n\n<p>GO</p>\n\n<pre><code>r.Form[\"product_image_id\"][0] == \"1\"\nr.Form[\"product_image_id\"][1] == \"2\"\nr.Form[\"product_image_id\"][2] == \"4\"\n</code></pre>\n\n<p>It will be working.<br>\nAm I late?</p>\n"}], "owner": {"reputation": 641, "user_id": 3087000, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/4dd1dcaf7efecd574bb2273a5a8c06fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3087000", "link": "https://stackoverflow.com/users/3087000/user3087000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6755, "favorite_count": 1, "answer_count": 4, "score": 3, "last_activity_date": 1502352863, "creation_date": 1453213702, "question_id": 34879373, "link": "https://stackoverflow.com/questions/34879373/golang-how-to-get-all-the-value-of-checkbox-r-formvalue-is-not-working", "title": "Golang - How to get all the value of checkbox? r.FormValue is not working?", "body": "<p>This is my HTML :</p>\n\n<pre><code>&lt;input type=\"checkbox\" name=\"product_image_id\" value=\"0\" /&gt;\n&lt;input type=\"checkbox\" name=\"product_image_id\" value=\"1\" /&gt;\n&lt;input type=\"checkbox\" name=\"product_image_id\" value=\"2\" /&gt;\n</code></pre>\n\n<p>If I check all the options and I use <code>r.FormValue(\"product_image_id\")</code> to get the value of checked options, I will only get the value <code>0</code>.</p>\n\n<p>I mean I can only get the first value, and I can't get other value although it was checked.</p>\n\n<p>Please help me. Thanks.</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "edited": false, "score": 2, "creation_date": 1453207106, "post_id": 34876574, "comment_id": 57491784, "body": "Hi Airomega, I think the error is right, are you sure that the table exist exist in your pq database ?  Can you do <code>db.Collections()</code> and print the response ?  <code>&#47;&#47; Collections() returns the names of all non-system sources or tables within the active database.</code> <a href=\"https://godoc.org/upper.io/db#Database\" rel=\"nofollow noreferrer\">doc for this function</a>"}, {"owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "reply_to_user": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "edited": false, "score": 0, "creation_date": 1453210760, "post_id": 34876574, "comment_id": 57494364, "body": "I think your onto something however I&#39;m still confused...  In my main.go I basically run a SELECT(<i>) function and the the insert function. The SELECT(</i>) executes raw SQL using .Query(string). It works.  However the dbCollections is returning blank. This seems to say that I&#39;m connecting to the db to view but not when inserting.  Output:     result len: [{1 test address true}] // raw sql Select     Collection list: [] //db.Collections()"}, {"owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "reply_to_user": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "edited": false, "score": 0, "creation_date": 1453211191, "post_id": 34876574, "comment_id": 57494686, "body": "Full select statement is SELECT * FROM schema.table - this works. It&#39;s as if UpperIO needs the schema context too to get it working. Is there any way to do that?"}], "owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 310, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453205718, "creation_date": 1453205718, "question_id": 34876574, "link": "https://stackoverflow.com/questions/34876574/inserting-record-to-postgres-schema-using-go-and-upper-io", "title": "Inserting record to Postgres schema using GO and Upper.IO", "body": "<p>I've got a postgres table whose fully qualified name is schema_name.table_name. I want to append to insert a row to table_name.</p>\n\n<p>When I try</p>\n\n<pre><code> tableCollection, err := db.Collection(\"schema_name.table_name\")\n</code></pre>\n\n<p>I get a \"Collection does not exist.\" error\n<br/><br/><br/>\nIf I change it to </p>\n\n<pre><code>tableCollection, err := db.Collection(\"table_name\")\n</code></pre>\n\n<p>and then try </p>\n\n<pre><code>_,err =tableCollection.Append(myStruct)\n</code></pre>\n\n<p>I get an error \"pq: relation \\\"table_name\\\" does not exist\" </p>\n\n<p>So it seems that UpperIO doesn't like the schema name and postgres needs to have it. Is this a bug or is there something I'm missing?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 7, "last_activity_date": 1453205461, "creation_date": 1453205461, "answer_id": 34876492, "question_id": 34876438, "link": "https://stackoverflow.com/questions/34876438/what-is-the-difference-between-type-func-and-type-func/34876492#34876492", "title": "What is the difference between &quot;(type func())&quot; and &quot;type func()&quot;", "body": "<p>There is no difference but you're misinterpreting the error message. What it's saying is that type <code>FuncName</code> which is <code>func()</code> cannot be used as <code>func() error</code> because it doesn't return an error.</p>\n"}], "owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 34876492, "answer_count": 1, "score": 1, "last_activity_date": 1453278131, "creation_date": 1453205305, "last_edit_date": 1453278131, "question_id": 34876438, "link": "https://stackoverflow.com/questions/34876438/what-is-the-difference-between-type-func-and-type-func", "title": "What is the difference between &quot;(type func())&quot; and &quot;type func()&quot;", "body": "<p>I'm trying to build a code example and I get the following error:</p>\n\n<pre><code>cannot use FuncName (type func()) as type func() error in field value\n</code></pre>\n\n<p>What does the wrapping parenthesis mean?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453204321, "post_id": 34875888, "comment_id": 57490035, "body": "If you are the one that closed it, don&#39;t you know if it&#39;s closed? You can read from it and check the error if you really want to."}, {"owner": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453204432, "post_id": 34875888, "comment_id": 57490104, "body": "@JimB, i see it. However, what i mean is that whether there is a already exist flag function in <code>golang</code> like <code>Closed()</code> to check."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453211906, "post_id": 34875888, "comment_id": 57495230, "body": "Presumably, if you need to know if the listener is closed, it&#39;s because you want to call <code>Accept</code> -- in that case just call accept and see if there&#39;s an error (since there could be other error conditions). If you&#39;re not checking in order to call <code>Accept</code>, it&#39;s for of some other logic in your program which should be handled separately, and not coupled to the listener."}], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 1683251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6fsxn.jpg?s=128&g=1", "display_name": "MaC", "link": "https://stackoverflow.com/users/1683251/mac"}, "reply_to_user": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "edited": false, "score": 0, "creation_date": 1453302220, "post_id": 34879997, "comment_id": 57542948, "body": "I&#39;m sorry but I&#39;m afraid that I don&#39;t understand your comment. The snippet I post in Go will simply try to open a socket to the specified host and port. err will be nil if that tcp host and port is open and will throw an error if it&#39;s closed or doesn&#39;t exists. I have edit the answer"}], "tags": [], "owner": {"reputation": 431, "user_id": 1683251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6fsxn.jpg?s=128&g=1", "display_name": "MaC", "link": "https://stackoverflow.com/users/1683251/mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1453302211, "last_edit_date": 1453302211, "creation_date": 1453215428, "answer_id": 34879997, "question_id": 34875888, "link": "https://stackoverflow.com/questions/34875888/how-to-tell-whether-a-tcplistener-is-closed/34879997#34879997", "title": "How to tell whether a tcplistener is closed?", "body": "<p>You could dial to the socket before using it:</p>\n\n<pre><code>_, err = net.Dial(\"tcp\", \"127.0.0.1:8021\")    //8021 is a closed socket\nif err != nil {\n    panic(\"Error, socket not opened\")\n}\n</code></pre>\n\n<p><strong>EDIT:</strong>\nMaybe this way is more clear:</p>\n\n<pre><code>isOpen := true\n_, err = net.Dial(\"tcp\", \"127.0.0.1:8021\")    //8021 is a closed socket\nif err != nil {\n    isOpen = false\n}\n\nif isOpen {\n    //Your logic here\n}\n</code></pre>\n"}], "owner": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453302211, "creation_date": 1453203673, "question_id": 34875888, "link": "https://stackoverflow.com/questions/34875888/how-to-tell-whether-a-tcplistener-is-closed", "title": "How to tell whether a tcplistener is closed?", "body": "<p>In Golang, i can <code>close</code> a <code>TCPListener</code>, however, i can not tell whether a <code>TCPListener</code> is closed or not. This info could be used to do some other logic in program.</p>\n"}, {"tags": ["http", "go", "filereader"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1453178241, "post_id": 34868502, "comment_id": 57476286, "body": "Are you checking those errors?"}, {"owner": {"reputation": 4858, "user_id": 5739035, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-RQUt7m42pBk/AAAAAAAAAAI/AAAAAAAAAyw/mLHBtE-PQic/photo.jpg?sz=128", "display_name": "Adi Levin", "link": "https://stackoverflow.com/users/5739035/adi-levin"}, "edited": false, "score": 0, "creation_date": 1453188268, "post_id": 34868502, "comment_id": 57479909, "body": "Can you share the contents of /config.json?"}], "answers": [{"comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 943, "user_id": 2321728, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/74fa106ad05a21a6006c99652c369eb5?s=128&d=identicon&r=PG", "display_name": "user2321728", "link": "https://stackoverflow.com/users/2321728/user2321728"}, "edited": false, "score": 0, "creation_date": 1453185532, "post_id": 34869247, "comment_id": 57478682, "body": "what <code>content-type</code> your server required?"}, {"owner": {"reputation": 943, "user_id": 2321728, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/74fa106ad05a21a6006c99652c369eb5?s=128&d=identicon&r=PG", "display_name": "user2321728", "link": "https://stackoverflow.com/users/2321728/user2321728"}, "edited": false, "score": 0, "creation_date": 1453186814, "post_id": 34869247, "comment_id": 57479255, "body": "application/json; charset=utf-8"}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 0, "last_activity_date": 1453193220, "last_edit_date": 1453193220, "creation_date": 1453182085, "answer_id": 34869247, "question_id": 34868502, "link": "https://stackoverflow.com/questions/34868502/golang-read-contents-from-file-and-send-as-body-data-in-http-request/34869247#34869247", "title": "golang, read contents from file, and send as body data in HTTP request", "body": "<p>please check <code>content-type</code> your server required, and build the body as <code>content-type</code> required.</p>\n\n<p>as your <code>content-type</code> is <code>application/json; charset=utf-8</code>, you try to set it manully</p>\n\n<pre><code>req.Header.Set(\"Content-Type\", \"application/json; charset=utf-8\")\n</code></pre>\n\n<p>if it still not work, make a http load capture please.</p>\n"}], "owner": {"reputation": 943, "user_id": 2321728, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/74fa106ad05a21a6006c99652c369eb5?s=128&d=identicon&r=PG", "display_name": "user2321728", "link": "https://stackoverflow.com/users/2321728/user2321728"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1063, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453193220, "creation_date": 1453177545, "last_edit_date": 1453184336, "question_id": 34868502, "link": "https://stackoverflow.com/questions/34868502/golang-read-contents-from-file-and-send-as-body-data-in-http-request", "title": "golang, read contents from file, and send as body data in HTTP request", "body": "<pre><code>//read data from a file config.json\n//the contents of config.json is\n//{\"key1\":\"...Z-DAaFpGT0t...\",\"key2\":\"...\"}\n client :=   &amp;http.Client{}\n dat, err := ioutil.ReadFile(\"/config.json\")\n req, err := http.NewRequest(\"PUT\", url, bytes.NewBuffer(dat))\n resp, err := client.Do(req)\n</code></pre>\n\n<p>Then I will get error from server saying \"400 Bad Request\", \" \"invalid character '\u00ef' looking for beginning of value\"\".</p>\n\n<p>It seems the data is not properly decoded.</p>\n\n<p>While code below works</p>\n\n<pre><code> client :=   &amp;http.Client{}\n //dat, err := ioutil.ReadFile(\"/config.json\")\n var dat = []byte(`{\"key1\":\"...Z-DAaFpGT0t...\",\"key2\":\"...\"}`)\n req, err := http.NewRequest(\"PUT\", url, bytes.NewBuffer(dat))\n resp, err := client.Do(req)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1453167973, "post_id": 34867203, "comment_id": 57473601, "body": "check every <code>error</code> returned."}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1453168212, "post_id": 34867203, "comment_id": 57473673, "body": "@JiangYD exec.Command doesn&#39;t return an error, it reutrns a *Cmd"}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 4, "creation_date": 1453168270, "post_id": 34867203, "comment_id": 57473687, "body": "o, maybe I have to call <code>Run</code> on the command! (and Run returns an error)"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 11472902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b18ba6d10809f83cde33babe541618?s=128&d=identicon&r=PG&f=1", "display_name": "JCastillo", "link": "https://stackoverflow.com/users/11472902/jcastillo"}, "edited": false, "score": 0, "creation_date": 1614893623, "post_id": 34874205, "comment_id": 117532352, "body": "This will clone the repo in my project dir, what if i wanted to copy the repo to another dir, how would i go about this?"}], "tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": true, "score": 4, "last_activity_date": 1453198905, "creation_date": 1453198905, "answer_id": 34874205, "question_id": 34867203, "link": "https://stackoverflow.com/questions/34867203/cloning-a-repo-with-os-execgit-clone/34874205#34874205", "title": "cloning a repo with os.exec(&quot;git&quot;, &quot;clone&quot;)", "body": "<p>You need to call <code>Run</code> to actually execute the command.</p>\n\n<pre><code>cmd := exec.Command(\"git\", \"clone\", repo)\nerr := cmd.Run()\nif err != nil {\n    // something went wrong\n}\n</code></pre>\n"}], "owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2705, "favorite_count": 0, "accepted_answer_id": 34874205, "answer_count": 1, "score": -2, "last_activity_date": 1453198905, "creation_date": 1453167923, "question_id": 34867203, "link": "https://stackoverflow.com/questions/34867203/cloning-a-repo-with-os-execgit-clone", "title": "cloning a repo with os.exec(&quot;git&quot;, &quot;clone&quot;)", "body": "<p>Running the code below, I expected the github hosted project <code>username/mysuperrepo</code> to be cloned (once I visit the <code>clone</code>  path) into the repo where this go project is running, but it doesn't work. After stopping the application, there's no directory for <code>mysuperrepo</code> no any of the files that I would expect from running <code>git clone https://github.com/username/mysuperrepo.git</code> from the command line</p>\n\n<p>Question: Why wouldn't the code below produce a clone of the repo in the directory where the go program is running?  </p>\n\n<pre><code>func clone(w http.ResponseWriter, r *http.Request){\n  var repo = \"https://github.com/username/mysuperrepo.git\"\n  exec.Command(\"git\", \"clone\", repo)\n  w.Write([]byte(repo))\n}\nfunc main(){\n  http.HandleFunc(\"/clone/\", clone)\n  log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n"}, {"tags": ["arrays", "go", "stack-overflow"], "answers": [{"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 9, "last_activity_date": 1453173664, "last_edit_date": 1453173664, "creation_date": 1453172237, "answer_id": 34867805, "question_id": 34867195, "link": "https://stackoverflow.com/questions/34867195/why-is-the-stack-overflow-depending-on-how-to-access-the-array-in-go/34867805#34867805", "title": "Why is the stack overflow depending on how to access the array in Go?", "body": "<p>According to the <a href=\"https://golang.org/ref/spec\">Go specification</a>:</p>\n\n<blockquote>\n  <p>The range expression is evaluated once before beginning the loop, with one exception: if the range expression is an array or a pointer to an array and at most one iteration variable is present, only the range expression's length is evaluated</p>\n</blockquote>\n\n<p>So in the first program only the length of buffer is evaluated and placed on the stack.</p>\n\n<p>In the second program the whole buffer is placed on the stack before iterating over it. Because the size of the buffer is known during compilation the Go compiler places instruction at the beginning of the function to pre-allocate stack space. That is why panic trace points to the beginning of the function.</p>\n\n<p>In both cases <code>buffer</code> is allocated on the heap. This can be confirmed by</p>\n\n<pre><code>$ go build -gcflags=-m\n./main.go:4: moved to heap: buffer\n</code></pre>\n\n<p>Note that the program will behave similarly if you make <code>buffer</code> a global variable. </p>\n\n<p>However if you change <code>buffer</code> to be a slice (<code>buffer := make([]float64, 100000000)</code>) the program will succeed in both cases. This happens because a slice is just a pointer to the actual array and it takes only a few bytes on the stack independently of the backing array size. So the simplest way to fix your second program is to make it iterate over slice instead of array:</p>\n\n<pre><code>....\nfor i, value = range buffer[:] {\n    ....\n}\n</code></pre>\n\n<p>Surprisingly if you try to create a bigger array <code>[1000000000]float64</code> then the compiler will complain (stack frame too large (>2GB)). I think it should complain when compiling your second program as well instead of letting it panic. You might want to report this issue to <a href=\"http://github.com/golang/go/issues\">http://github.com/golang/go/issues</a></p>\n"}], "owner": {"reputation": 6511, "user_id": 188108, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b091399da83212608f7ce92128d73030?s=128&d=identicon&r=PG", "display_name": "Torsten Bronger", "link": "https://stackoverflow.com/users/188108/torsten-bronger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 34867805, "answer_count": 1, "score": 7, "last_activity_date": 1453173664, "creation_date": 1453167807, "question_id": 34867195, "link": "https://stackoverflow.com/questions/34867195/why-is-the-stack-overflow-depending-on-how-to-access-the-array-in-go", "title": "Why is the stack overflow depending on how to access the array in Go?", "body": "<p>Consider the following Go program:</p>\n\n<pre><code>package main\n\nfunc main() {\n    var buffer [100000000]float64\n    var i int\n    for i = range buffer {\n        buffer[i] = float64(i)\n    }\n}\n</code></pre>\n\n<p>With \"go run test1.go\", it works.  (Unless you have too little RAM.)</p>\n\n<p>Now, I expand this program trivially:</p>\n\n<pre><code>package main\n\nfunc main() {\n    var buffer [100000000]float64\n    var i int\n    var value float64\n    for i, value = range buffer {\n        value = value\n        buffer[i] = float64(i)\n    }\n}\n</code></pre>\n\n<p>\"go run test2.go\" yields:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>runtime: goroutine stack exceeds 1000000000-byte limit\nfatal error: stack overflow\n\nruntime stack:\nruntime.throw(0x473350, 0xe)\n        /usr/local/go/src/runtime/panic.go:527 +0x90\nruntime.newstack()\n        /usr/local/go/src/runtime/stack1.go:794 +0xb17\nruntime.morestack()\n        /usr/local/go/src/runtime/asm_amd64.s:330 +0x7f\n\ngoroutine 1 [stack growth]:\nmain.main()\n        /home/bronger/src/go-test/test3.go:3 fp=0xc860075e50 sp=0xc860075e48\nruntime.main()\n        /usr/local/go/src/runtime/proc.go:111 +0x2b0 fp=0xc860075ea0 sp=0xc860075e50\nruntime.goexit()\n        /usr/local/go/src/runtime/asm_amd64.s:1696 +0x1 fp=0xc860075ea8 sp=0xc860075ea0\nexit status 2\n</code></pre>\n\n<p>It seems to me that in test1.go, the heap was used, whereas in test2.go, the stack was used.  Why?</p>\n"}, {"tags": ["http", "go", "reactjs"], "comments": [{"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1453183172, "post_id": 34866002, "comment_id": 57477707, "body": "Is there a particular reason you want to serve the static content with Go? You could setup nginx to serve static content and forward everything else to your Go program."}, {"owner": {"reputation": 437, "user_id": 4195224, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cCglv.jpg?s=128&g=1", "display_name": "goofiw", "link": "https://stackoverflow.com/users/4195224/goofiw"}, "reply_to_user": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1453219318, "post_id": 34866002, "comment_id": 57500762, "body": "I don&#39;t have experience using nginx and I know it is doable with go :)"}], "answers": [{"comments": [{"owner": {"reputation": 437, "user_id": 4195224, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cCglv.jpg?s=128&g=1", "display_name": "goofiw", "link": "https://stackoverflow.com/users/4195224/goofiw"}, "edited": false, "score": 0, "creation_date": 1453162547, "post_id": 34866415, "comment_id": 57472156, "body": "Bingo, I was thinking it might have something to do with the lack of action on the ResponseWriter.  Unfortunately my other static files in that folder (css and js) are not coming through."}, {"owner": {"reputation": 404, "user_id": 1164802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9a17bccaa575860b464a1739488782?s=128&d=identicon&r=PG", "display_name": "dahc", "link": "https://stackoverflow.com/users/1164802/dahc"}, "reply_to_user": {"reputation": 437, "user_id": 4195224, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cCglv.jpg?s=128&g=1", "display_name": "goofiw", "link": "https://stackoverflow.com/users/4195224/goofiw"}, "edited": false, "score": 0, "creation_date": 1453163100, "post_id": 34866415, "comment_id": 57472310, "body": "I think that&#39;s because of how specific the route pattern is. Even index.html won&#39;t come back if you call it by name, only as &#39;/&#39;. Perhaps something like &quot;/{file}&quot; instead of &quot;/&quot;, depending on how that interacts with other routes you have (though you might not want to be serving all of your static content out of the root path anyway)."}, {"owner": {"reputation": 437, "user_id": 4195224, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cCglv.jpg?s=128&g=1", "display_name": "goofiw", "link": "https://stackoverflow.com/users/4195224/goofiw"}, "edited": false, "score": 0, "creation_date": 1453163327, "post_id": 34866415, "comment_id": 57472378, "body": "I&#39;m actually serving out of a /dist (not /views as seen above) folder.  /{file} is getting a 404 as well"}, {"owner": {"reputation": 437, "user_id": 4195224, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cCglv.jpg?s=128&g=1", "display_name": "goofiw", "link": "https://stackoverflow.com/users/4195224/goofiw"}, "edited": false, "score": 1, "creation_date": 1453164095, "post_id": 34866415, "comment_id": 57472567, "body": "I added a PathPrefix to the router ```\trouter.PathPrefix(&quot;/&quot;).Handler(http.FileServer(http.Dir(&zwnj;&#8203;&quot;./dist&quot;))) ```  and now my other files are being served"}], "tags": [], "owner": {"reputation": 404, "user_id": 1164802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9a17bccaa575860b464a1739488782?s=128&d=identicon&r=PG", "display_name": "dahc", "link": "https://stackoverflow.com/users/1164802/dahc"}, "is_accepted": true, "score": 2, "last_activity_date": 1453162272, "creation_date": 1453162272, "answer_id": 34866415, "question_id": 34866002, "link": "https://stackoverflow.com/questions/34866002/serving-a-single-page-application-with-go-net-http-mux/34866415#34866415", "title": "Serving a single page application with go net/http mux", "body": "<p>In handler.go, your Index function is actually a no-op, since <code>http.FileServer()</code> returns a Handler, which is never passed the ResponseWriter or Request, hence the blank page.</p>\n\n<p>Maybe try something like this to at least get past that:</p>\n\n<pre><code>func Index(w http.ResponseWriter, r *http.Request) {\n    http.FileServer(http.Dir(\"./views\")).ServeHTTP(w, r)\n}\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 4195224, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cCglv.jpg?s=128&g=1", "display_name": "goofiw", "link": "https://stackoverflow.com/users/4195224/goofiw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2910, "favorite_count": 0, "accepted_answer_id": 34866415, "answer_count": 1, "score": 1, "last_activity_date": 1453162272, "creation_date": 1453159650, "last_edit_date": 1495542208, "question_id": 34866002, "link": "https://stackoverflow.com/questions/34866002/serving-a-single-page-application-with-go-net-http-mux", "title": "Serving a single page application with go net/http mux", "body": "<p>I'm building an api that also serves my react front end app, but am having an issue serving my index.html </p>\n\n<p>Given that it's not really a go template I'm not using html/template. </p>\n\n<p>I'm not seeing a strait forward way to serve the static html root of my app on all pages that do not start /api in the route.</p>\n\n<p>I'm purposely trying not to use any go frameworks beyond gorilla's mux</p>\n\n<p>My handler.go:</p>\n\n<pre><code>func Index(w http.ResponseWriter, r *http.Request) {\n    http.FileServer(http.Dir(\"./views\"))\n}\n</code></pre>\n\n<p>Routes.go:</p>\n\n<pre><code>type Route struct {\n    Name        string\n    Method      string\n    Pattern     string\n    HandlerFunc http.HandlerFunc\n}\n\ntype Routes []Route\n\nvar routes = Routes{\n    Route{\n        \"Index\",\n        \"GET\",\n        \"/\",\n        Index,\n    },\n}\n</code></pre>\n\n<p>router.go</p>\n\n<pre><code>import (\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc NewRouter() *mux.Router {\n\n    router := mux.NewRouter().StrictSlash(true)\n    for _, route := range routes {\n        var handler http.Handler\n\n        handler = route.HandlerFunc\n        handler = Logger(handler, route.Name)\n\n        router.\n            Methods(route.Method).\n            Path(route.Pattern).\n            Name(route.Name).\n            Handler(handler)\n\n    }\n\n    return router\n}\n</code></pre>\n\n<p>main: </p>\n\n<pre><code>package main\n\nimport (\n    \"./server\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n\n    router := server.NewRouter()\n\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n</code></pre>\n\n<p>Currently a blank page shows up, and thats it.  My index.html is located in <code>/views/index.html</code> in relation to the executable (but I've tried it in relation to the handler as well)</p>\n\n<p><strong>Update</strong></p>\n\n<p>I was able to serve the html file using the method shown in this question: <a href=\"https://stackoverflow.com/questions/26559557/how-do-you-serve-a-static-html-file-using-a-go-web-server\">How do you serve a static html file using a go web server?</a>  However using mux and the more modularized file structure still yields a nice pretty, clean blank page.</p>\n"}, {"tags": ["go", "rabbitmq", "amqp"], "answers": [{"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1453154898, "creation_date": 1453154898, "answer_id": 34864956, "question_id": 34864046, "link": "https://stackoverflow.com/questions/34864046/rabbitmq-round-robin/34864956#34864956", "title": "RabbitMQ Round Robin", "body": "<p><strong>Disclaimer:</strong> I haven't worked with the Go AMQP client, but the AMQP protocol semantics should be universal across client implementations, so I'll take a shot.</p>\n\n<hr>\n\n<p>You've already correctly identified the <code>prefetch-size</code> and <code>prefetch-count</code> parameters as the configuration variables to adjust. The <a href=\"https://www.rabbitmq.com/consumer-prefetch.html\" rel=\"nofollow\">RabbitMQ documentation</a> says the following in this regard:<sup>1</sup></p>\n\n<blockquote>\n  <p>AMQP specifies the <code>basic.qos</code> method to allow you to <strong>limit the number of unacknowledged messages</strong> on a channel (or connection) when consuming (aka \"prefetch count\").</p>\n</blockquote>\n\n<p>If you want each consumer to be sent only one message at a time, you should set <code>prefetch-count</code> to 1, and leave <code>prefetch-size</code> undefined (i.e. 0):</p>\n\n<pre><code>err := channel.Qos(1, 0, false)\nif err != nil {\n    // ...\n}\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup>\nThere's also a longer description in <a href=\"https://www.rabbitmq.com/amqp-0-9-1-reference.html\" rel=\"nofollow\">RabbitMQ's AMQP reference</a> on this one:</p>\n\n<blockquote>\n  <p><strong>long prefetch-size</strong></p>\n  \n  <p>The client can request that messages be sent in advance so that when the client finishes processing a message, the following message is already held locally, rather than needing to be sent down the channel. <em>[...]</em> The server will send a message in advance if it is equal to or smaller in size than the available prefetch size (and also falls into other prefetch limits). <strong>May be set to zero, meaning \"no specific limit\", although other prefetch limits may still apply.</strong> The prefetch-size is ignored if the no-ack option is set.</p>\n  \n  <p><em>[...]</em></p>\n  \n  <p><strong>short prefetch-count</strong></p>\n  \n  <p>Specifies a prefetch window in terms of whole messages. This field may be used in combination with the prefetch-size field; a message will only be sent in advance if both prefetch windows (and those at the channel and connection level) allow it. <em>[...]</em></p>\n</blockquote>\n"}], "owner": {"reputation": 327, "user_id": 1617663, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3fbf3487d8768d11ba7a5c4fac63a972?s=128&d=identicon&r=PG", "display_name": "icebox3d", "link": "https://stackoverflow.com/users/1617663/icebox3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 34864956, "answer_count": 1, "score": 0, "last_activity_date": 1453154898, "creation_date": 1453151056, "question_id": 34864046, "link": "https://stackoverflow.com/questions/34864046/rabbitmq-round-robin", "title": "RabbitMQ Round Robin", "body": "<p>I am trying to build a system where a master service creates a bunch of messages and routes them to the correct queue based on the routing key. I have that working and the messages are being consumed on the worker/slave side. However I want the worker to only take one message from the queue and not all 15 that get put into it.</p>\n\n<p>I was looking at this <a href=\"https://github.com/streadway/amqp/blob/master/channel.go#L616\" rel=\"nofollow\">https://github.com/streadway/amqp/blob/master/channel.go#L616</a> however I am not sure how to set it up so only one event is taken.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go", "revel"], "answers": [{"comments": [{"owner": {"reputation": 20027, "user_id": 534476, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e8e6bab996ec82323d119dc21edc015f?s=128&d=identicon&r=PG", "display_name": "Demian Brecht", "link": "https://stackoverflow.com/users/534476/demian-brecht"}, "edited": false, "score": 0, "creation_date": 1453154882, "post_id": 34863869, "comment_id": 57469246, "body": "This doesn&#39;t quite work as-is. <code>err</code> apparently isn&#39;t part of the return data (it&#39;s a <code>bool</code> now). <code>c</code> is <code>$3 = (struct github.com&#47;revel&#47;revel.Controller *) 0xc20805b130 (gdb)</code>, which doesn&#39;t upcast to <code>controllers.Auth</code> (still get the same infinite loop). I&#39;ve been able to just do a simple check on the controller <code>.Name</code> attribute, but it just seems a little wrong to me that I can&#39;t do this same thing through type assertions. Maybe something in the revel underpinnings that I haven&#39;t dug through yet.."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 20027, "user_id": 534476, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e8e6bab996ec82323d119dc21edc015f?s=128&d=identicon&r=PG", "display_name": "Demian Brecht", "link": "https://stackoverflow.com/users/534476/demian-brecht"}, "edited": false, "score": 0, "creation_date": 1453155965, "post_id": 34863869, "comment_id": 57469714, "body": "@DemianBrecht yeah, sorry little mistake with error as the second return type instead of <code>bool</code>. I don&#39;t entirely follow your comment though, with the code after my edit, it doesn&#39;t do what you want?"}, {"owner": {"reputation": 20027, "user_id": 534476, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e8e6bab996ec82323d119dc21edc015f?s=128&d=identicon&r=PG", "display_name": "Demian Brecht", "link": "https://stackoverflow.com/users/534476/demian-brecht"}, "edited": false, "score": 0, "creation_date": 1453156643, "post_id": 34863869, "comment_id": 57469986, "body": "Nah, unfortunately it doesn&#39;t and I have to get a little more familiar with both the type system and how revel instantiates controllers to speak to it more authoritatively. It /seems/ like the controller passed in doesn&#39;t pass the type assertion, even when the Name attribute is as expected. I see that revel instantiates controllers using reflection, so perhaps there&#39;s something there that&#39;s causing the type assertion to fail."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 20027, "user_id": 534476, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e8e6bab996ec82323d119dc21edc015f?s=128&d=identicon&r=PG", "display_name": "Demian Brecht", "link": "https://stackoverflow.com/users/534476/demian-brecht"}, "edited": false, "score": 0, "creation_date": 1453156962, "post_id": 34863869, "comment_id": 57470113, "body": "@DemianBrecht I&#39;d have to look into <code>revel</code> myself a bit to provide further guidance but at the high level, <code>c</code> is not of type <code>controllers.Auth</code> so this code is working as expected, it&#39;s just the type isn&#39;t what you expected. As a test you might want to import reflect and print the type out here. I was assuming <code>Controller</code> is an interface and the actual type would be <code>controllers.Auth</code>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 20027, "user_id": 534476, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e8e6bab996ec82323d119dc21edc015f?s=128&d=identicon&r=PG", "display_name": "Demian Brecht", "link": "https://stackoverflow.com/users/534476/demian-brecht"}, "edited": false, "score": 0, "creation_date": 1453157193, "post_id": 34863869, "comment_id": 57470221, "body": "@DemianBrecht oh one other thing that just came to mind... If <code>Controller</code> is in fact an interface, then passing it by value may solve your problem. I would also want to read a little bit before making any statement about why this is however in most cases you want to avoid pointer to interface in Go."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1453156564, "last_edit_date": 1453156564, "creation_date": 1453150384, "answer_id": 34863869, "question_id": 34863775, "link": "https://stackoverflow.com/questions/34863775/type-switch-on-controller/34863869#34863869", "title": "Type switch on controller", "body": "<p>I believe for your switch you need a base case. You end up in it infinitely because c's type is not <code>controllers.Auth</code> and you have no other cases. But, in your use case, there is no reason to use a switch and I personally wouldn't. It's binary, so just type assert on <code>controllers.Auth</code>, if it's not that then you redirect.</p>\n\n<pre><code>func setUser(c *revel.Controller) revel.Result {\n    if _, ok := c.(controllers.Auth); ok {\n             return c.Redirect(controllers.Auth.Index)   \n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 20027, "user_id": 534476, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e8e6bab996ec82323d119dc21edc015f?s=128&d=identicon&r=PG", "display_name": "Demian Brecht", "link": "https://stackoverflow.com/users/534476/demian-brecht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453156564, "creation_date": 1453149985, "question_id": 34863775, "link": "https://stackoverflow.com/questions/34863775/type-switch-on-controller", "title": "Type switch on controller", "body": "<p>I'm implementing a simple interceptor using revel, who's sole responsibility is to ensure that a user is authenticated and redirect to auth page if not. I have something to the effect of</p>\n\n<pre><code>func setUser(c *revel.Controller) revel.Result {\n    switch interface{}(c.Type).(type) {\n    case controllers.Auth:\n        return nil\n    }\n    return c.Redirect(controllers.Auth.Index)\n}\n</code></pre>\n\n<p>The type case <code>controllers.Auth</code> is never encountered, effectively resulting in an infinite loop. I'm assuming there's something obvious I'm missing, but while I figure out how to run a revel app through gdb to try and debug this, figured I'd ask here.</p>\n"}, {"tags": ["xml", "go", "struct", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1473775691, "last_edit_date": 1473775691, "creation_date": 1453148874, "answer_id": 34863510, "question_id": 34862991, "link": "https://stackoverflow.com/questions/34862991/xml-parsing-in-go-with-repetitive-tags/34863510#34863510", "title": "xml parsing in go with repetitive tags", "body": "<p>If you have multiple tags with the same name under the same parent tag, you can always use a slice which will hold all the occurrences of the tag, regardless if they are enumerated next to each other or there are other tags between them.</p>\n\n<p>To be complete, this is the XML fragment you want to parse:</p>\n\n<pre><code>&lt;cap:geocode&gt;\n    &lt;valueName&gt;FIPS6&lt;/valueName&gt;\n    &lt;value&gt;002090 002290&lt;/value&gt;\n    &lt;valueName&gt;UGC&lt;/valueName&gt;\n    &lt;value&gt;AKZ222&lt;/value&gt;\n&lt;/cap:geocode&gt;\n</code></pre>\n\n<p>So simply change your <code>geocode</code> struct from this:</p>\n\n<pre><code>type geocode struct {\n    ValueName1 string `xml:\"valueName\"`\n    Value1     string `xml:\"value\"`\n    ValueName2 string `xml:\"valueName\"`\n    Value2     string `xml:\"value\"`\n}\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>type geocode struct {\n    ValueNames []string `xml:\"valueName\"`\n    Values     []string `xml:\"value\"`\n}\n</code></pre>\n\n<p>And code to print them:</p>\n\n<pre><code>gc := v.Entries[0].Geocode\nlog.Println(len(gc.Values))\nlog.Println(gc.ValueNames)\nlog.Println(gc.Values)\nfor i := range gc.Values {\n    fmt.Printf(\"ValueName=%s, Value=%s\\n\", gc.ValueNames[i], gc.Values[i])\n}\n</code></pre>\n\n<p>Output (try your modified source on the <a href=\"https://play.golang.org/p/QrCDmgVyrY\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:00 2\n2009/11/10 23:00:00 [FIPS6 UGC]\n2009/11/10 23:00:00 [002090 002290 AKZ222]\nValueName=FIPS6, Value=002090 002290\nValueName=UGC, Value=AKZ222\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 944, "favorite_count": 0, "accepted_answer_id": 34863510, "answer_count": 1, "score": 4, "last_activity_date": 1536075890, "creation_date": 1453146947, "last_edit_date": 1536075890, "question_id": 34862991, "link": "https://stackoverflow.com/questions/34862991/xml-parsing-in-go-with-repetitive-tags", "title": "xml parsing in go with repetitive tags", "body": "<p>When an xml feed has multiple tags within a structure I am having issues parsing it:</p>\n\n<pre><code>&lt;feed&gt;\n&lt;entry&gt;\n:\n:\n&lt;/entry&gt;\n&lt;entry&gt;\n:\n:\n\n&lt;/entry&gt;\n&lt;/feed&gt;\n</code></pre>\n\n<p>In this case I have no issues parsing the entry by defining an array of []entries\nHowever one of the entries is a geocode tag which has valuename and value tag repeated twice.  How does one define a structure in such a case.?</p>\n\n<pre><code>&lt;geocode&gt;\n&lt;valueName&gt;abc&lt;/valueName&gt;\n&lt;value&gt;a1&lt;/value&gt;\n&lt;valueName&gt;def&lt;/valueName&gt;\n&lt;value&gt;d1&lt;/value&gt;\n&lt;/geocode&gt;\n</code></pre>\n\n<p>Here is the go program that I am having issues with\n<a href=\"https://play.golang.org/p/SE8RXTNbYl\" rel=\"nofollow\">https://play.golang.org/p/SE8RXTNbYl</a></p>\n"}, {"tags": ["string", "unicode", "encoding", "go", "utf-8"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1453141616, "post_id": 34861479, "comment_id": 57462414, "body": "If your encoding is UTF-8: <a href=\"https://godoc.org/unicode/utf8#Valid\" rel=\"nofollow noreferrer\"><code>unicode&#47;utf8.Valid</code></a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1453142682, "post_id": 34861479, "comment_id": 57462946, "body": "Read <a href=\"http://blog.golang.org/strings\" rel=\"nofollow noreferrer\">blog.golang.org/strings</a> -- the <code>string</code> conversion is just a byte-for-byte copy, and you&#39;ll run into the invalid UTF-8 when you <code>range</code> over the code points (or convert to a <code>[]rune</code>) and get 0xFFFD, the Unicode replacement character (spec&#39;d <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">here</a>). None of that crashes, so you only need to check validity if it&#39;s independently important for your app (or if you plan to do something else that <i>will</i> crash on bad utf8)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1453142859, "post_id": 34861479, "comment_id": 57463040, "body": "Here&#39;s a sample with invalid UTF-8: <a href=\"http://play.golang.org/p/6yHonH0Mae\" rel=\"nofollow noreferrer\">play.golang.org/p/6yHonH0Mae</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 17, "last_activity_date": 1585951248, "last_edit_date": 1585951248, "creation_date": 1453147730, "answer_id": 34863211, "question_id": 34861479, "link": "https://stackoverflow.com/questions/34861479/how-to-detect-when-bytes-cant-be-converted-to-string-in-go/34863211#34863211", "title": "How to detect when bytes can&#39;t be converted to string in Go?", "body": "<p>You can, as Tim Cooper noted, test UTF-8 validity with <a href=\"https://godoc.org/unicode/utf8#Valid\" rel=\"nofollow noreferrer\"><code>utf8.Valid</code></a>.</p>\n\n<p>But! You might be thinking that converting non-UTF-8 bytes to a Go <code>string</code> is impossible. In fact, <a href=\"http://blog.golang.org/strings\" rel=\"nofollow noreferrer\">\"In Go, a string is in effect a read-only slice of bytes\"</a>; it can contain bytes that aren't valid UTF-8 which you can print, access via indexing, or even round-trip back to a <code>[]byte</code> (to <code>Write</code>, say).</p>\n\n<p>There are two places in the language that Go does do UTF-8 decoding of <code>string</code>s for you. </p>\n\n<ul>\n<li>when you do <code>for i, r := range s</code> the <code>r</code> is a Unicode code point as a value of type <code>rune</code></li>\n<li>when you do the conversion <code>[]rune(s)</code>, Go decodes the whole string to runes.</li>\n</ul>\n\n<p>(Note that <code>rune</code> is an alias for <code>int32</code>, not a completely different type.)</p>\n\n<p>In both these instances invalid UTF-8 is replaced with <code>U+FFFD</code>, the <a href=\"https://en.wikipedia.org/wiki/Specials_(Unicode_block)#Replacement_character\" rel=\"nofollow noreferrer\">replacement character</a> reserved for uses like this. More is in the spec sections on <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\"><code>for</code> statements</a> and <a href=\"https://golang.org/ref/spec#Conversions_to_and_from_a_string_type\" rel=\"nofollow noreferrer\">conversions between <code>string</code>s and other types</a>. <strong>These conversions never crash, so you only need to actively check for UTF-8 validity if it's relevant to your application, like if you want to throw an error on mis-encoded input.</strong></p>\n\n<p>Since that behavior's baked into the language, you can expect it from libraries, too. <code>U+FFFD</code> is <a href=\"https://godoc.org/unicode/utf8#pkg-constants\" rel=\"nofollow noreferrer\"><code>utf8.RuneError</code></a> and returned by functions in <code>utf8</code>.</p>\n\n<p>Here's a sample program showing what Go does with a <code>[]byte</code> holding invalid UTF-8:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := []byte{0xff}\n    s := string(a)\n    fmt.Println(s)\n    for _, r := range s {\n        fmt.Println(r)\n    }\n    rs := []rune(s)\n    fmt.Println(rs)\n}\n</code></pre>\n\n<p>Output will look different in different environments, but in the Playground it looks like</p>\n\n<pre><code>\ufffd\n65533\n[65533]\n</code></pre>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5769, "favorite_count": 0, "accepted_answer_id": 34863211, "answer_count": 1, "score": 9, "last_activity_date": 1585951248, "creation_date": 1453141255, "last_edit_date": 1453185417, "question_id": 34861479, "link": "https://stackoverflow.com/questions/34861479/how-to-detect-when-bytes-cant-be-converted-to-string-in-go", "title": "How to detect when bytes can&#39;t be converted to string in Go?", "body": "<p>There are <a href=\"https://en.wikipedia.org/wiki/UTF-8#Invalid_byte_sequences\" rel=\"noreferrer\">invalid byte sequences</a> that can't be converted to Unicode strings. How do I detect that when converting <code>[]byte</code> to <code>string</code> in Go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1453138421, "post_id": 34860692, "comment_id": 57460709, "body": "Stop ignoring the returned errors so you can see what the problem is."}, {"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 0, "creation_date": 1453138426, "post_id": 34860692, "comment_id": 57460711, "body": "I&#39;d start by not ignoring the error values that might be returned by both <code>t.ParseFiles</code> and <code>t.Execute</code>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1453138542, "post_id": 34860692, "comment_id": 57460777, "body": "As mentioned by the other two, if your code isn&#39;t working as expected a good starting point would be to check the errors returned. Maybe <code>ParseFiles</code> fails? Additionally, you should print some information about what value <code>t</code> holds. Does it actually have anything to print? Maybe the file it read had no data in it and you just have an empty string now."}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1453138593, "post_id": 34860692, "comment_id": 57460800, "body": "guys, strangely enough, when I added an <code>err</code> instead of <code>_</code> to  <code>ParseFiles</code> assignment, I get <code>undefined: err</code>. So please be specific on how to do so."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1453139004, "post_id": 34860692, "comment_id": 57461022, "body": "That&#39;s because you&#39;re using <code>t, _ =</code> meaning everything on the left hand side has already been declared, which is not the case with err. So you need <code>var err error</code> above those two lines or <code>:=</code> with a variable other than <code>t</code> for the first return value (<code>t2, err :=</code>)."}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1453140092, "post_id": 34860692, "comment_id": 57461615, "body": "@evanmcdonnal The template file is not empty. It has some basic html but don&#39;t know why is rendered as <code>&amp;{&lt;nil&gt; 0xc820010e00 &lt;nil&gt; 0xc82000bcc0}</code>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1453141103, "post_id": 34860692, "comment_id": 57462140, "body": "Yeah I asked that question not because I thought your template file was actually empty but to get you thinking about the places where failures could occur. Inspect that template a bit further. Perhaps there is a syntax error which is causing the parse to fail. Was err nil?"}], "answers": [{"tags": [], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "is_accepted": false, "score": 0, "last_activity_date": 1453141349, "last_edit_date": 1453141349, "creation_date": 1453140589, "answer_id": 34861313, "question_id": 34860692, "link": "https://stackoverflow.com/questions/34860692/why-go-template-not-rendered/34861313#34861313", "title": "Why go template not rendered?", "body": "<p>Well, I realised what caused the problem:\nWhen I define the New template, the name in <code>\"\"</code> should be same as the one <code>ParseFiles</code> line. </p>\n\n<p>So one correct whay to do it:</p>\n\n<pre><code>func UserCreateForm(w http.ResponseWriter, r *http.Request) {\n    var err error\n    t := template.New(\"interface.html\")     // notice .html is added\n    t, err = t.ParseFiles(\"interface.html\") // Parse template file.\n    log.Println(t)\n    t.Execute(w, t)\n    log.Println(\"rendering template\")\n    log.Println(err)\n    }\n</code></pre>\n\n<p>More elegantly, one can get the template in one line, like:</p>\n\n<pre><code>func UserCreateForm(w http.ResponseWriter, r *http.Request) {\n    t, err := template.ParseFiles(\"interface.html\") // Parse template file.\n    log.Println(t)\n    t.Execute(w, t)\n    log.Println(\"rendering template\")\n    log.Println(err)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 816, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1453141349, "creation_date": 1453138256, "last_edit_date": 1453139328, "question_id": 34860692, "link": "https://stackoverflow.com/questions/34860692/why-go-template-not-rendered", "title": "Why go template not rendered?", "body": "<p>I'm very new to Go and try to render an html form template <code>interface.html</code> which is on the same directory as my hello.go.</p>\n\n<p>The relevant function in <code>hello.go</code> is:</p>\n\n<pre><code>func UserCreateForm(w http.ResponseWriter, r *http.Request) {\n\n    var err error\n    t := template.New(\"interface\")        // Create a template.\n    t, err = t.ParseFiles(\"interface.html\") // Parse template file.\n    log.Println(t)\n    t.Execute(w, t)\n    log.Println(\"template rendered\")\n    log.Println(err)\n\n}\n</code></pre>\n\n<p>When I <code>GET</code> the url, the <code>template rendered</code> is logged on terminal but no template is being rendered. </p>\n\n<p>How can I fix this?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I add <code>log.Println(t)</code> . It prints out <code>&amp;{&lt;nil&gt; 0xc8200fa0c0 &lt;nil&gt; 0xc8201060a0}</code> while the html file is clearly there and not empty.\nAlso <code>log.Println(err)</code> returns <code>&lt;nil&gt;</code></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1453135332, "last_edit_date": 1453135332, "creation_date": 1453134900, "answer_id": 34859671, "question_id": 34859449, "link": "https://stackoverflow.com/questions/34859449/unmarshaljson-results-in-stack-overflow/34859671#34859671", "title": "UnmarshalJSON results in stack overflow", "body": "<p>This</p>\n\n<pre><code>dec.Decode(&amp;i)\n</code></pre>\n\n<p>will call your <code>UnmarshalJSON</code>, which in turn will call <code>Decode</code>, and so on. If you need to unmarshal your JSON and then do something with it, one neat technique is to declare a local type, unmarshal your data into it, and then convert back to your desired type:</p>\n\n<pre><code>// Type a has no UnmarshalJSON.\ntype a A\ni := a{}\ndec := json.NewDecoder(bytes.NewReader(data))\nif err := dec.Decode(&amp;i); err != nil {\n    return err\n}\n// Convert back to A.\ntt := A(i)\ntt.Printer()\n*t = tt\n// ...\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/HWamV3MbvW\" rel=\"nofollow\">http://play.golang.org/p/HWamV3MbvW</a>.</p>\n\n<p>The type <code>a</code> has no methods (so no stack overflow), but is <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">convertible</a> to <code>A</code>.</p>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 34859671, "answer_count": 1, "score": 1, "last_activity_date": 1453137135, "creation_date": 1453134281, "last_edit_date": 1453137135, "question_id": 34859449, "link": "https://stackoverflow.com/questions/34859449/unmarshaljson-results-in-stack-overflow", "title": "UnmarshalJSON results in stack overflow", "body": "<p>This works: <a href=\"http://play.golang.org/p/-Kv3xAguDR\" rel=\"nofollow\">http://play.golang.org/p/-Kv3xAguDR</a>.</p>\n\n<p>This results in a stack overflow: <a href=\"http://play.golang.org/p/1-AsHFj51O\" rel=\"nofollow\">http://play.golang.org/p/1-AsHFj51O</a>.</p>\n\n<p>I fail to understand why. What is the correct way use the <code>JSONUnmarshaler</code> interface in this case?</p>\n\n<pre><code>package main\n\nimport (\n    //\"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype T interface {\n    Printer()\n}\n\ntype A struct{ JA string }\n\nfunc (t A) Printer() { fmt.Print(\"A\") }\n\n/*\nfunc (t *A) UnmarshalJSON(data []byte) error {\n    i := A{}\n    dec := json.NewDecoder(bytes.NewReader(data))\n    if err := dec.Decode(&amp;i); err != nil {\n        return err\n    }\n    i.Printer()\n    *t = i\n    return nil\n}\n*/\n\nvar vI []T\n\nfunc main() {\n    vI = []T{&amp;A{}}\n    get()\n}\n\nfunc get() {\n    dec := json.NewDecoder(strings.NewReader(\"[{\\\"JA\\\":\\\"OK\\\"}]\"))\n    if err := dec.Decode(&amp;vI); err != nil {\n        fmt.Print(err)\n    }\n    for _, v := range vI {\n        v.Printer()\n    }\n}\n</code></pre>\n"}, {"tags": ["xml", "go", "xml-parsing"], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 3, "last_activity_date": 1453161149, "last_edit_date": 1453161149, "creation_date": 1453139294, "answer_id": 34860959, "question_id": 34859030, "link": "https://stackoverflow.com/questions/34859030/general-xml-parser-in-go/34860959#34860959", "title": "General XML parser in Go", "body": "<p>Well, two things.</p>\n\n<p><strong>First</strong>, you are not obliged to define Go types which map to <em>complex</em> elements to parse XML with nothing but <code>encoding/xml</code>.\nOn the contrary, you can parse XML documents purely procedurally and calling <code>xml.Unmarshal()</code> only on primitive (non-nested) elements&mdash;to parse them as values of \"primitive\" types (such as <code>string</code> or <code>int32</code> or <code>time.Time</code> etc).</p>\n\n<p>That would be a lot of code, for sure, but that's just approaching the same problem from a more dynamic angle.  To understand what I mean, consider your fully-parsed XML document in the form of a DOM object.  To extract useful data from it, you have to query that object somehow or iterate over the tree.  With the approach the blog post you've referred to presents, you traverse your XML document as you parse it&mdash;essentially combining parsing with querying/traversing.</p>\n\n<p>This may or may not work for you as applicability of a particular approach to parsing of XML-formatted datum highly depends on its structure and the intended outcome of its parsing.  For instance, if you need to perform several queries over the document with the later queries depending on the former, procedural decoding from that blog post hardly works.</p>\n\n<p><strong>Second</strong>, alternative libraries exist.  For instance, look at <a href=\"https://godoc.org/aqwari.net/xml/xmltree\" rel=\"nofollow\"><code>xmltree</code></a> and <a href=\"https://godoc.org/gopkg.in/xmlpath.v2\" rel=\"nofollow\"><code>xmlpath</code></a>.\nWhile these two are written in pure Go, there exist a couple of packages wrapping <code>libxml</code>, for instance, <a href=\"https://godoc.org/github.com/martende/goxml\" rel=\"nofollow\"><code>goxml</code></a>.  With them, you can have DOM-oriented parsing if you like.</p>\n\n<p>Yet another approach is to parse XML into a set of nested key/value maps using <a href=\"https://godoc.org/github.com/clbanning/mxj\" rel=\"nofollow\"><code>mxj</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1473775669, "last_edit_date": 1473775669, "creation_date": 1453190329, "answer_id": 34871316, "question_id": 34859030, "link": "https://stackoverflow.com/questions/34859030/general-xml-parser-in-go/34871316#34871316", "title": "General XML parser in Go", "body": "<blockquote>\n  <p>All the examples I found show how to read using unmarshaling functionality into the objects I need to define, but it's quite time consuming as I need to define a lot of staff that I'm not going to use.</p>\n</blockquote>\n\n<p>Then <em>don't</em> define what you're not going to use, define <em>only</em> what you're going to use. You don't have to create a Go model that perfectly covers the XML structure.</p>\n\n<p>Let's assume you have an XML like this:</p>\n\n<pre><code>&lt;blog id=\"1234\"&gt;\n    &lt;meta keywords=\"xml,parsing,partial\" /&gt;\n    &lt;name&gt;Partial XML parsing&lt;/name&gt;\n    &lt;url&gt;http://somehost.com/xml-blog&lt;/url&gt;\n    &lt;entries count=\"2\"&gt;\n        &lt;entry time=\"2016-01-19 08:40:00\"&gt;\n            &lt;author&gt;Bob&lt;/author&gt;\n            &lt;content&gt;First entry&lt;/content&gt;\n        &lt;/entry&gt;\n        &lt;entry time=\"2016-01-19 08:30:00\"&gt;\n            &lt;author&gt;Alice&lt;/author&gt;\n            &lt;content&gt;Second entry&lt;/content&gt;\n        &lt;/entry&gt;\n    &lt;/entries&gt;\n&lt;/blog&gt;\n</code></pre>\n\n<p>And let's assume you only need the following info out of this XML:</p>\n\n<ul>\n<li>id</li>\n<li>keywords</li>\n<li>blog name</li>\n<li>authors names</li>\n</ul>\n\n<p>You can model these wanted pieces of information with the following struct:</p>\n\n<pre><code>type Data struct {\n    Id   string `xml:\"id,attr\"`\n    Meta struct {\n        Keywords string `xml:\"keywords,attr\"`\n    } `xml:\"meta\"`\n    Name    string   `xml:\"name\"`\n    Authors []string `xml:\"entries&gt;entry&gt;author\"`\n}\n</code></pre>\n\n<p>And now you can parse only these information with the following code:</p>\n\n<pre><code>d := Data{}\nif err := xml.Unmarshal([]byte(s), &amp;d); err != nil {\n    panic(err)\n}\nfmt.Printf(\"%+v\", d)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/X-TPbbKxgU\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>{Id:1234 Meta:{Keywords:xml,parsing,partial} Name:Partial XML parsing Authors:[Bob Alice]}\n</code></pre>\n"}], "owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 34871316, "answer_count": 2, "score": 2, "last_activity_date": 1473775669, "creation_date": 1453132900, "last_edit_date": 1453190521, "question_id": 34859030, "link": "https://stackoverflow.com/questions/34859030/general-xml-parser-in-go", "title": "General XML parser in Go", "body": "<p>Is there some general approach of reading XML document in Go? Something similar to XmlDocument or XDocument in C#?</p>\n\n<p>All the examples I found show how to read using unmarshaling functionality into the objects I need to define, but it's quite time consuming as I need to define a lot of staff that I'm not going to use.</p>\n\n<pre><code>xml.Unmarshal(...)\n</code></pre>\n\n<p>Another approach is forward only reading using:</p>\n\n<pre><code>xml.NewDecoder(xmlFile) \n</code></pre>\n\n<p>Described here: <a href=\"http://blog.davidsingleton.org/parsing-huge-xml-files-with-go/\" rel=\"nofollow\">http://blog.davidsingleton.org/parsing-huge-xml-files-with-go/</a></p>\n"}, {"tags": ["http", "go", "stream", "streaming"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 16, "last_activity_date": 1453121989, "creation_date": 1453121989, "answer_id": 34855405, "question_id": 34855343, "link": "https://stackoverflow.com/questions/34855343/how-to-stream-an-io-readcloser-into-a-http-responsewriter/34855405#34855405", "title": "How to stream an io.ReadCloser into a http.ResponseWriter", "body": "<p>You can use <a href=\"https://golang.org/pkg/io/#Copy\" rel=\"noreferrer\"><code>io.Copy()</code></a> which does exactly this.</p>\n\n<blockquote>\n  <p>Copy copies from src to dst until either EOF is reached on src or an error occurs. It returns the number of bytes copied and the first error encountered while copying, if any.</p>\n</blockquote>\n\n<pre><code>n, err := io.Copy(w, res.Body)\n// check err\n</code></pre>\n\n<p>Also note that <code>Copy()</code> will not return <code>io.EOF</code> but <code>nil</code> because if it can \"copy\" everything until <code>src</code> reports <code>io.EOF</code>, that is not considered an error.</p>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6626, "favorite_count": 5, "accepted_answer_id": 34855405, "answer_count": 1, "score": 8, "last_activity_date": 1576423184, "creation_date": 1453121781, "last_edit_date": 1576423184, "question_id": 34855343, "link": "https://stackoverflow.com/questions/34855343/how-to-stream-an-io-readcloser-into-a-http-responsewriter", "title": "How to stream an io.ReadCloser into a http.ResponseWriter", "body": "<p>I have a client which makes a request to download a file, the web server forwards this request on to the resource server that actually holds the file. The *http.Response back from the resource server has the Body io.ReaderCloser streaming the file contents from the resource server. But I'm then at the point where I want to start writing that into the original http.ResponseWriter that came from the client. Looking at the http.ResponseWriter interface it only contains a Write method which takes a slice of bytes, which makes me think that the only way to get the file contents back to the client is to read the Body io.ReaderCloser into a buffer and then put that into the http.ResponseWriter's Write method. which I dont want to do since that is hugely inefficient and it would be much better to stream it through my web server. Is this possible?</p>\n\n<p>here is some code to illustrate:</p>\n\n<pre><code>getFile() *http.Response {\n    //make a request to resource server and return the response object\n}\n\n// handle request from client\nhttp.HandleFunc(\"/getFile\", func(w http.ResponseWriter, r *http.Request){\n    res := getFile()\n    //how can I stream res.Body into w without buffering ?\n})\n</code></pre>\n"}, {"tags": ["rest", "go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 1, "last_activity_date": 1453120104, "creation_date": 1453120104, "answer_id": 34854809, "question_id": 34853904, "link": "https://stackoverflow.com/questions/34853904/should-restful-service-in-golang-include-client-interface/34854809#34854809", "title": "Should RESTful service in Golang include Client interface?", "body": "<p>It's usually preferable to do this, and most companies do, but provide documentation for working directly with the API. The main use case for that is people working with different languages than the ones you intended.</p>\n\n<p>You can have a look at a new RESTful framework I wrote, that includes infrastructure to automatically compile clients with Go templates, although I haven't gotten to writing a Go client compiler. If you want to write one it would be greatly appreciated :)  <a href=\"https://github.com/EverythingMe/vertex\" rel=\"nofollow\">https://github.com/EverythingMe/vertex</a></p>\n"}, {"tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": false, "score": 1, "last_activity_date": 1453120182, "creation_date": 1453120182, "answer_id": 34854839, "question_id": 34853904, "link": "https://stackoverflow.com/questions/34853904/should-restful-service-in-golang-include-client-interface/34854839#34854839", "title": "Should RESTful service in Golang include Client interface?", "body": "<p>Testing is important in Go, so writing testable code is something you should do. If you use direct http requests you will have a harder time writing unit tests, compared to using a mocked struct.</p>\n\n<p>Is there any reason to use a <code>Client</code> rather than calling the functions that call the REST endpoints? It's usually harder to mock a bigger thing, such as a Client struct, rather than a group of small functions. </p>\n\n<p>You should put the client at <code>booking.Client</code> to avoid repeating yourself (<code>booking.BookingClient</code>) and maybe rename <code>Client</code> to something more descriptive. </p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 2, "last_activity_date": 1453127070, "creation_date": 1453127070, "answer_id": 34857045, "question_id": 34853904, "link": "https://stackoverflow.com/questions/34853904/should-restful-service-in-golang-include-client-interface/34857045#34857045", "title": "Should RESTful service in Golang include Client interface?", "body": "<p>In general, no \u2013 if you provide a client in a particular language it'd only be a convenience, so (some) users can use your API easier. This of course assumes your client is well designed. I wouldn't provide merely an interface in Go just to indicate a set of possible API calls. This would be beneficial to a very narrow range of audience, probably for people developing a client for your API themselves, in programming language which just happened to be the same as implementation of your server. And even then they might not really like the idea of using the interface (e.g. they might only need a specific set of methods).</p>\n\n<p>If you want to provide a client for your API, go ahead, do it, but separate it from the actual server (different package, maybe even different repo). In general one develops APIs over HTTP to allow for wide range of clients to access it, which could be written in any language. Instead of providing some interfaces I would invest my time in writing a good documentation.</p>\n\n<p>In my opinion the answer to your question, assuming there is no more context provided, should be no different if you asked yourself if you should provide a client in, say, Python. The whole situation might change though if, for example, your API is used internally by your company and you develop mainly in Go.</p>\n"}], "owner": {"reputation": 536, "user_id": 1804618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33dfa3278a67442de02221285198d1c?s=128&d=identicon&r=PG", "display_name": "upitau", "link": "https://stackoverflow.com/users/1804618/upitau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 34857045, "answer_count": 3, "score": 0, "last_activity_date": 1453127070, "creation_date": 1453117356, "question_id": 34853904, "link": "https://stackoverflow.com/questions/34853904/should-restful-service-in-golang-include-client-interface", "title": "Should RESTful service in Golang include Client interface?", "body": "<p>If I develop Booking REST service in Golang (i.e., in package booking). Is it a \"GO way\" to create BookingClient interface (backed up by struct) with business operations allowed, so that clients of my restful service would use BookingClient (imported from package booking) instead of sending http requests directly?</p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1453104635, "post_id": 34849790, "comment_id": 57439704, "body": "Your code prints the log file properly on my machine. Perhaps you&#39;re viewing it on Windows and it&#39;s a matter of \\n vs \\r\\n?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1453104646, "post_id": 34849790, "comment_id": 57439712, "body": "<code>log.Println()</code> appends a newline (which is OS dependent). Most likely on the OS you run it is just the <code>&#39;\\n&#39;</code> and your console or text viewer doesn&#39;t start a new line (e.g. Windows Notepad only starts newline if <code>&quot;\\r\\n&quot;</code> is the terminator)."}, {"owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "edited": false, "score": 0, "creation_date": 1453105017, "post_id": 34849790, "comment_id": 57439903, "body": "Thank you for your answer."}], "answers": [{"tags": [], "owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "is_accepted": true, "score": 1, "last_activity_date": 1453112462, "creation_date": 1453112462, "answer_id": 34852298, "question_id": 34849790, "link": "https://stackoverflow.com/questions/34849790/save-each-log-in-a-separate-line-in-golang/34852298#34852298", "title": "Save each log in a separate line in Golang", "body": "<p>Maybe This code will help u (\"\\n\" -> \"\\n\\r\")<em>(\"\\n\\r\" works same as \"\\r\\n\")</em>:</p>\n\n<pre><code>log.SetPrefix(\"\\r\")\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 34852298, "answer_count": 1, "score": -1, "last_activity_date": 1453112462, "creation_date": 1453104196, "question_id": 34849790, "link": "https://stackoverflow.com/questions/34849790/save-each-log-in-a-separate-line-in-golang", "title": "Save each log in a separate line in Golang", "body": "<p>I tried to add log for my code but i couldn't get each log on a separate line</p>\n\n<p>This is my code</p>\n\n<pre><code>  package main\n\n import (\n         \"log\"\n         \"os\"\n )\n\nfunc update(){\n    log.Println(1,\"update\")\n    log.Println(1,\"update\")\n    log.Println(1,\"update\")\n    log.Println(1,\"update\")\n}\nfunc install(){\n\n    log.Println(1,\"install\")\n    log.Println(1,\"install\")\n    log.Println(1,\"install\")\n    log.Println(1,\"install\")\n\n\n}\n func main() {\n\n         // make sure log.txt exists first\n         // use touch command to create if log.txt does not exist\n         os.Create(\"log/Installationlog.txt\")\n         logFile, err := os.OpenFile(\"log/Installationlog.txt\", os.O_WRONLY, 0666)\n\n         if err != nil {\n                 panic(err)\n         }\n\n         defer logFile.Close()\n\n         // direct all log messages to log.txt\n         log.SetOutput(logFile)\n\n         log.Println(\"ERROR::First log message!\")\n         install()\n         update()\n }\n</code></pre>\n\n<p>The output of my code is </p>\n\n<pre><code>2016/01/18 13:30:51 ERROR::First log message! 2016/01/18 13:30:51 1 install 2016/01/18 13:30:51 1 install 2016/01/18 13:30:51 1 install 2016/01/18 13:30:51 1 install 2016/01/18 13:30:51 1 update 2016/01/18 13:30:51 1 update 2016/01/18 13:30:51 1 update 2016/01/18 13:30:51 1 update\n</code></pre>\n\n<p>All in a single line i want each of them to be in separate line</p>\n\n<p>Thanks in Advance</p>\n"}, {"tags": ["testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 1, "last_activity_date": 1453103894, "creation_date": 1453103894, "answer_id": 34849718, "question_id": 34849475, "link": "https://stackoverflow.com/questions/34849475/golang-newrequest-passing-post-parameter-to-the-api-for-testing/34849718#34849718", "title": "Golang NewRequest passing POST parameter to the API for testing", "body": "<p>You need to properly set the content-type header for your request.</p>\n\n<pre><code>request, err := http.NewRequest(\"POST\", serverHttp.URL+url1, b)\n\nrequest.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n\nres, err := http.DefaultClient.Do(request)\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 2219116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cWP58.jpg?s=128&g=1", "display_name": "Mahesh Haldar", "link": "https://stackoverflow.com/users/2219116/mahesh-haldar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1172, "favorite_count": 2, "accepted_answer_id": 34849718, "answer_count": 1, "score": 0, "last_activity_date": 1453103894, "creation_date": 1453102886, "question_id": 34849475, "link": "https://stackoverflow.com/questions/34849475/golang-newrequest-passing-post-parameter-to-the-api-for-testing", "title": "Golang NewRequest passing POST parameter to the API for testing", "body": "<p>This is my test method which creates a new request and passes POST param.</p>\n\n<pre><code>url1 := \"/api/addprospect\"\ndata := url.Values{}\ndata.Add(\"customer_name\", \"value\")\nb := bytes.NewBuffer([]byte(data.Encode()))\nrequest, err := http.NewRequest(\"POST\", serverHttp.URL+url1, b)\nres, err := http.DefaultClient.Do(request)\n</code></pre>\n\n<p>The problem is the <code>POST param</code> is not getting picked up by the function handler of the url.</p>\n\n<p>Can you please help me with setting up right request?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "aop"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1453106606, "post_id": 34848961, "comment_id": 57440668, "body": "You cannot do this. (Of course you can parse the code and insert these print statements, e.g. like the cover tool does it. But probably this is not the answer you&#39;d like to hear.)"}], "answers": [{"comments": [{"owner": {"reputation": 2051, "user_id": 474002, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Oqy8c.jpg?s=128&g=1", "display_name": "Browny Lin", "link": "https://stackoverflow.com/users/474002/browny-lin"}, "edited": false, "score": 0, "creation_date": 1453103354, "post_id": 34849154, "comment_id": 57439098, "body": "it still needs to write <code>fmt.Println(&quot;Name of function: &quot; + funcName())</code> at each member function. Is there any better way to write once and run at the beginning of each member function?"}, {"owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "reply_to_user": {"reputation": 2051, "user_id": 474002, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Oqy8c.jpg?s=128&g=1", "display_name": "Browny Lin", "link": "https://stackoverflow.com/users/474002/browny-lin"}, "edited": false, "score": 0, "creation_date": 1453107206, "post_id": 34849154, "comment_id": 57440963, "body": "Sorry. I know what u want but i dont know how to do it.  Maybe u dont need it infact. It will be a big cost for cpu. If u just want to debug, just add fmt each time where u want."}], "tags": [], "owner": {"reputation": 1336, "user_id": 3331750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MlZX7.jpg?s=128&g=1", "display_name": "Justlike", "link": "https://stackoverflow.com/users/3331750/justlike"}, "is_accepted": false, "score": 0, "last_activity_date": 1453101569, "last_edit_date": 1495541717, "creation_date": 1453101569, "answer_id": 34849154, "question_id": 34848961, "link": "https://stackoverflow.com/questions/34848961/golang-how-to-run-the-same-logic-at-the-beginning-of-every-struct-member-functi/34849154#34849154", "title": "Golang: How to run the same logic at the beginning of every struct member functions?", "body": "<pre><code>package main\n\nimport \"fmt\"\nimport \"runtime\"\n\nfunc main() {\n    pc, _, _, _ := runtime.Caller(0)\n    fmt.Println(\"Name of function: \" + runtime.FuncForPC(pc).Name())\n    fmt.Println()\n\n    // or, define a function for it\n    fmt.Println(\"Name of function: \" + funcName())\n    x()\n}\n\nfunc funcName() string {\n    pc, _, _, _ := runtime.Caller(1)\n    return runtime.FuncForPC(pc).Name()\n}\n\nfunc x() {\n    fmt.Println(\"Name of function: \" + funcName())\n    y()\n}\n\nfunc y() {\n    fmt.Println(\"Name of function: \" + funcName())\n    z()\n}\nfunc z() {\n    fmt.Println(\"Name of function: \" + funcName())\n}\n</code></pre>\n\n<blockquote>\n  <p>Output:</p>\n</blockquote>\n\n<pre><code>Name of function: main.main\n\nName of function: main.main\nName of function: main.x\nName of function: main.y\nName of function: main.z\n</code></pre>\n\n<p>(<em>Copyed from <a href=\"https://stackoverflow.com/a/10743805/3331750\">here</a></em> )</p>\n"}], "owner": {"reputation": 2051, "user_id": 474002, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Oqy8c.jpg?s=128&g=1", "display_name": "Browny Lin", "link": "https://stackoverflow.com/users/474002/browny-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453101569, "creation_date": 1453100750, "question_id": 34848961, "link": "https://stackoverflow.com/questions/34848961/golang-how-to-run-the-same-logic-at-the-beginning-of-every-struct-member-functi", "title": "Golang: How to run the same logic at the beginning of every struct member functions?", "body": "<p>For example, I want to print out the function name of every functions of some struct. </p>\n\n<p>Besides I use <code>fmt.Println</code> at the beginning of every member function, any better way to do it?</p>\n"}, {"tags": ["go", "syntax"], "answers": [{"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1453088346, "post_id": 34846902, "comment_id": 57434076, "body": "Nice tip about leaving the operator at the end. It worked."}, {"owner": {"reputation": 35158, "user_id": 395202, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c422b640dd62b019c125836b1059e231?s=128&d=identicon&r=PG", "display_name": "Adrian Shum", "link": "https://stackoverflow.com/users/395202/adrian-shum"}, "edited": false, "score": 1, "creation_date": 1463539438, "post_id": 34846902, "comment_id": 62103303, "body": "wrapping in parenthesis does not work in go afaik.  Go still insert the semicolon within parenthesis"}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1471896396, "post_id": 34846902, "comment_id": 65523461, "body": "I just tried it, and Go really inserts an invisible semicolon, even inside parentheses. So this only works in Python, not in Go."}, {"owner": {"reputation": 23094, "user_id": 473914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333f7be87dc935f7a362cabb0a4abce7?s=128&d=identicon&r=PG", "display_name": "tobyodavies", "link": "https://stackoverflow.com/users/473914/tobyodavies"}, "reply_to_user": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1471921548, "post_id": 34846902, "comment_id": 65530923, "body": "@RolandIllig This definitely works: <a href=\"https://play.golang.org/p/oFKaxLTphU\" rel=\"nofollow noreferrer\">play.golang.org/p/oFKaxLTphU</a>"}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1471935094, "post_id": 34846902, "comment_id": 65535420, "body": "Sorry for my wording, I was referring to the use of parentheses (but didn&#39;t write that). Wrapping the expression in parentheses may work in Python, but doesn&#39;t work in Go."}], "tags": [], "owner": {"reputation": 23094, "user_id": 473914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333f7be87dc935f7a362cabb0a4abce7?s=128&d=identicon&r=PG", "display_name": "tobyodavies", "link": "https://stackoverflow.com/users/473914/tobyodavies"}, "is_accepted": false, "score": 25, "last_activity_date": 1453088109, "creation_date": 1453088109, "answer_id": 34846902, "question_id": 34846848, "link": "https://stackoverflow.com/questions/34846848/how-to-break-a-long-line-of-code-in-golang/34846902#34846902", "title": "How to break a long line of code in Golang?", "body": "<p>The simplest way is to simply leave the operator (<code>.</code>) on the first line. </p>\n\n<p><code>\\</code> line continuations are also discouraged in many python style guides, you could wrap the whole expression in parens if you are moving back and forth between go and python as this technique works in both languages.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 17, "last_activity_date": 1453091647, "creation_date": 1453091647, "answer_id": 34847390, "question_id": 34846848, "link": "https://stackoverflow.com/questions/34846848/how-to-break-a-long-line-of-code-in-golang/34847390#34847390", "title": "How to break a long line of code in Golang?", "body": "<p>It's a matter of style, but I like:</p>\n\n<pre><code>err := database.QueryRow(\n    \"select * from users where user_id=?\", id,\n).Scan(\n    &amp;ReadUser.ID, &amp;ReadUser.Name, &amp;ReadUser.First, &amp;ReadUser.Last, &amp;ReadUser.Email,\n)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59346, "user_id": 444036, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/My2AZ.jpg?s=128&g=1", "display_name": "Paulo Scardine", "link": "https://stackoverflow.com/users/444036/paulo-scardine"}, "edited": false, "score": 3, "creation_date": 1453136376, "post_id": 34848928, "comment_id": 57459489, "body": "I keep putting a comma at the end of javascript literals.  #hatejs"}, {"owner": {"reputation": 1397, "user_id": 2695414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1ilF.jpg?s=128&g=1", "display_name": "Peeter Kokk", "link": "https://stackoverflow.com/users/2695414/peeter-kokk"}, "edited": false, "score": 30, "creation_date": 1469470555, "post_id": 34848928, "comment_id": 64538597, "body": "TL;DR: <b>Typically you can break your lines after comma ,, after opening parenthesis e.g. (, [, {, and after a dot . which may be referencing a field or method of some value.</b>"}, {"owner": {"reputation": 13572, "user_id": 657427, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd071a6a7c97ba637c558c5e71137c7b?s=128&d=identicon&r=PG", "display_name": "Christophe Roussy", "link": "https://stackoverflow.com/users/657427/christophe-roussy"}, "edited": false, "score": 2, "creation_date": 1478345433, "post_id": 34848928, "comment_id": 68122621, "body": "Having to add an extra comma at the end reminds me of some old IE js bugs, terrible"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 13572, "user_id": 657427, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd071a6a7c97ba637c558c5e71137c7b?s=128&d=identicon&r=PG", "display_name": "Christophe Roussy", "link": "https://stackoverflow.com/users/657427/christophe-roussy"}, "edited": false, "score": 5, "creation_date": 1478358182, "post_id": 34848928, "comment_id": 68126286, "body": "@ChristopheRoussy It&#39;s subjective, I for one love that all lines have to end with a comma, and I can rearrange and add new lines with ease without having to take care of adding / removing commas."}, {"owner": {"reputation": 13572, "user_id": 657427, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd071a6a7c97ba637c558c5e71137c7b?s=128&d=identicon&r=PG", "display_name": "Christophe Roussy", "link": "https://stackoverflow.com/users/657427/christophe-roussy"}, "edited": false, "score": 0, "creation_date": 1478522441, "post_id": 34848928, "comment_id": 68175056, "body": "@icza, I also like them to end with a comma, but not having to do it for the last one :)"}, {"owner": {"reputation": 7195, "user_id": 384954, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/eb7bd28bf9bee8c0f477c76c6effd84e?s=128&d=identicon&r=PG", "display_name": "OregonTrail", "link": "https://stackoverflow.com/users/384954/oregontrail"}, "reply_to_user": {"reputation": 59346, "user_id": 444036, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/My2AZ.jpg?s=128&g=1", "display_name": "Paulo Scardine", "link": "https://stackoverflow.com/users/444036/paulo-scardine"}, "edited": false, "score": 0, "creation_date": 1550682816, "post_id": 34848928, "comment_id": 96361871, "body": "@PauloScardine as of ES2017 trailing commas are allowed in all contexts in JavaScript <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Trailing_commas\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/&hellip;</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 130, "last_activity_date": 1478358251, "last_edit_date": 1478358251, "creation_date": 1453100554, "answer_id": 34848928, "question_id": 34846848, "link": "https://stackoverflow.com/questions/34846848/how-to-break-a-long-line-of-code-in-golang/34848928#34848928", "title": "How to break a long line of code in Golang?", "body": "<p>First some background. The formal grammar of Go uses semicolons <code>\";\"</code> as terminators in many productions, but Go programs may omit most of them (and they should to have a clearer, easily readable source; <code>gofmt</code> also removes unnecessary semicolons).</p>\n\n<p>The specification lists the exact rules. <a href=\"https://golang.org/ref/spec#Semicolons\" rel=\"noreferrer\">Spec: Semicolons:</a></p>\n\n<blockquote>\n  <p>The formal grammar uses semicolons \";\" as terminators in a number of productions. Go programs may omit most of these semicolons using the following two rules:</p>\n  \n  <ol>\n  <li><p>When the input is broken into tokens, a semicolon is automatically inserted into the token stream immediately after a line's final token if that token is</p>\n  \n  <ul>\n  <li>an <a href=\"https://golang.org/ref/spec#Identifiers\" rel=\"noreferrer\">identifier</a></li>\n  <li>an <a href=\"https://golang.org/ref/spec#Integer_literals\" rel=\"noreferrer\">integer</a>, <a href=\"https://golang.org/ref/spec#Floating-point_literals\" rel=\"noreferrer\">floating-point</a>, <a href=\"https://golang.org/ref/spec#Imaginary_literals\" rel=\"noreferrer\">imaginary</a>, <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"noreferrer\">rune</a>, or <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"noreferrer\">string</a> literal</li>\n  <li>one of the <a href=\"https://golang.org/ref/spec#Keywords\" rel=\"noreferrer\">keywords</a> <code>break</code>, <code>continue</code>, <code>fallthrough</code>, or <code>return</code></li>\n  <li>one of the <a href=\"https://golang.org/ref/spec#Operators_and_Delimiters\" rel=\"noreferrer\">operators and delimiters</a> ++, --, ), ], or }</li>\n  </ul></li>\n  <li><p>To allow complex statements to occupy a single line, a semicolon may be omitted before a closing \")\" or \"}\".</p></li>\n  </ol>\n</blockquote>\n\n<p>So as you can see if you insert a newline character after the parenthesis <code>)</code>, a semicolon <code>;</code> will be inserted automatically and so the next line will not be treated as the continuation of the previous line. This is what happened in your case, and so the next line starting with <code>.Scan(&amp;ReadUser.ID,...</code> will give you a compile-time error as this standing by <em>itself</em> (without the previous line) is a compile-time error: <code>syntax error: unexpected .</code></p>\n\n<p>So you may break your line at any point which does not conflict with the rules listed under point <code>1.</code> above.</p>\n\n<p><strong>Typically you can break your lines after comma <code>,</code>, after <em>opening</em> parenthesis e.g. <code>(</code>, <code>[</code>, <code>{</code>, and after a dot <code>.</code> which may be referencing a field or method of some value. You can also break your line after binary operators (those that require 2 operands), e.g.:</strong></p>\n\n<pre><code>i := 1 +\n        2\nfmt.Println(i) // Prints 3\n</code></pre>\n\n<p>One thing worth noting here is that if you have a struct or slice or map literal listing the initial values, and you want to break line after listing the last value, you have to put a mandatory comma <code>,</code> even though this is the last value and no more will follow, e.g.:</p>\n\n<pre><code>s := []int {\n    1, 2, 3,\n    4, 5, 6,  // Note it ends with a comma\n}\n</code></pre>\n\n<p>This is to conform with the semicolon rules, and also so that you can rearrange and add new lines without having to take care of adding / removing the final comma; e.g. you can simply swap the 2 lines without having to remove and to add a new comma:</p>\n\n<pre><code>s := []int {\n    4, 5, 6,\n    1, 2, 3,\n}\n</code></pre>\n\n<p>The same applies when listing arguments to a function call:</p>\n\n<pre><code>fmt.Println(\"first\",\n    \"second\",\n    \"third\",       // Note it ends with a comma\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 629, "user_id": 1221275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PFdid.jpg?s=128&g=1", "display_name": "halorium", "link": "https://stackoverflow.com/users/1221275/halorium"}, "is_accepted": false, "score": 17, "last_activity_date": 1547096115, "last_edit_date": 1547096115, "creation_date": 1528135394, "answer_id": 50686349, "question_id": 34846848, "link": "https://stackoverflow.com/questions/34846848/how-to-break-a-long-line-of-code-in-golang/50686349#50686349", "title": "How to break a long line of code in Golang?", "body": "<p>As mentioned, this is a matter of style preference. I understand that the creators of Go have suggested a style based on their experience of which I learn from but also keep some of my own style from my experience.</p>\n\n<p>Below is how I would format this:</p>\n\n<pre><code>err := database.\n  QueryRow(\"select * from users where user_id=?\", id).\n  Scan(\n    &amp;ReadUser.ID,\n    &amp;ReadUser.Name,\n    &amp;ReadUser.First,\n    &amp;ReadUser.Last,\n    &amp;ReadUser.Email,\n  )\n</code></pre>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62997, "favorite_count": 26, "accepted_answer_id": 34848928, "answer_count": 4, "score": 116, "last_activity_date": 1569913386, "creation_date": 1453087775, "last_edit_date": 1569913386, "question_id": 34846848, "link": "https://stackoverflow.com/questions/34846848/how-to-break-a-long-line-of-code-in-golang", "title": "How to break a long line of code in Golang?", "body": "<p>Coming from Python, I'm not used to see code lines longer than 80 columns.\nSo when I encounter this:</p>\n\n<pre><code>err := database.QueryRow(\"select * from users where user_id=?\", id).Scan(&amp;ReadUser.ID, &amp;ReadUser.Name, &amp;ReadUser.First, &amp;ReadUser.Last, &amp;ReadUser.Email)\n</code></pre>\n\n<p>I tried to break it to </p>\n\n<pre><code>err := database.QueryRow(\"select * from users where user_id=?\", id) \\\n    .Scan(&amp;ReadUser.ID, &amp;ReadUser.Name, &amp;ReadUser.First, &amp;ReadUser.Last, &amp;ReadUser.Email)\n</code></pre>\n\n<p>But I get </p>\n\n<pre><code> syntax error: unexpected \\\n</code></pre>\n\n<p>I also tried just breaking the line with hitting enter and put a semicolon at the end:</p>\n\n<pre><code>err := database.QueryRow(\"select * from users where user_id=?\", id) \n.Scan(&amp;ReadUser.ID, &amp;ReadUser.Name, &amp;ReadUser.First, &amp;ReadUser.Last, &amp;ReadUser.Email);\n</code></pre>\n\n<p>But the I again get:</p>\n\n<pre><code>syntax error: unexpected .\n</code></pre>\n\n<p>So I'm wondering what's the golangic way to do so?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1453085891, "post_id": 34846401, "comment_id": 57433543, "body": "<a href=\"http://stackoverflow.com/questions/32428797/go-rpc-call-is-fine-locally-marshalling-issue-when-using-rpc/32430429#32430429\" title=\"go rpc call is fine locally marshalling issue when using rpc\">stackoverflow.com/questions/32428797/&hellip;</a>"}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1453086585, "post_id": 34846401, "comment_id": 57433710, "body": "I will make a second example doing it your way, because I was also stuck when unmarshalling <code>vI</code> that way"}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1453088999, "post_id": 34846401, "comment_id": 57434215, "body": "<a href=\"http://play.golang.org/p/6-80cgADTB\" rel=\"nofollow noreferrer\">play.golang.org/p/6-80cgADTB</a>"}], "answers": [{"tags": [], "owner": {"reputation": 439, "user_id": 2314047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7cs4.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/2314047/david"}, "is_accepted": true, "score": 2, "last_activity_date": 1453090418, "creation_date": 1453090418, "answer_id": 34847230, "question_id": 34846401, "link": "https://stackoverflow.com/questions/34846401/how-to-store-different-structs-in-a-interface-for-json/34847230#34847230", "title": "How to store different structs in a interface for json", "body": "<p>Since you expect the decoder to fill the fields of a struct, you have to use pointers. Define methods of the interface on the pointer of the type like this: <a href=\"http://play.golang.org/p/WUMt9Ok9Xp\" rel=\"nofollow\">http://play.golang.org/p/WUMt9Ok9Xp</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype T interface {\n    Printer()\n}\n\ntype A struct {\n    JA string\n}\n\nfunc (a *A) Printer() {\n    fmt.Printf(\"A: %v\\n\", a.JA)\n}\n\ntype B struct {\n    JB string\n}\n\nfunc (b *B) Printer() {\n    fmt.Printf(\"B: %v\\n\", b.JB)\n}\n\nfunc main() {\n    vI := []T{&amp;A{}, &amp;B{}}\n    dec := json.NewDecoder(strings.NewReader(\"[{\\\"JA\\\":\\\"OKA\\\"}, {\\\"JB\\\":\\\"OKB\\\"}]\"))\n    if err := dec.Decode(&amp;vI); err != nil {\n        fmt.Print(err)\n    }\n    for _, v := range vI {\n        v.Printer()\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 34847230, "answer_count": 1, "score": 0, "last_activity_date": 1453090418, "creation_date": 1453084195, "question_id": 34846401, "link": "https://stackoverflow.com/questions/34846401/how-to-store-different-structs-in-a-interface-for-json", "title": "How to store different structs in a interface for json", "body": "<p><a href=\"http://play.golang.org/p/JJnU5ag234\" rel=\"nofollow\">http://play.golang.org/p/JJnU5ag234</a></p>\n\n<p>I can only make vA work directly, if I want to use my vI to store A or B in it depending on the json I expect, I get</p>\n\n<p>json: cannot unmarshal object into Go value of type main.TA</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype T interface {\n    Printer()\n}\n\ntype A struct{ JA string }\n\nfunc (t A) Printer() { fmt.Print(\"A\") }\n\ntype B struct{ JB string }\n\nfunc (t B) Printer() { fmt.Print(\"B\") }\n\nvar vA []A\nvar vB []B\nvar vI []T\n\nfunc main() {\n    // vA = []A{A{}}\n    // vI = []T{B{}}\n    vI = []T{A{}}\n    get()\n}\n\nfunc get() {\n\n    dec := json.NewDecoder(strings.NewReader(\"[{\\\"JA\\\":\\\"OK\\\"}]\"))\n    if err := dec.Decode(&amp;vI); err != nil {\n        fmt.Print(err)\n    }\n\n    for _, v := range vI {\n        v.Printer()\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "cassandra", "gocql"], "comments": [{"owner": {"reputation": 8472, "user_id": 873530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa96040bb4211cad1c66f385d8cb77b?s=128&d=identicon&r=PG", "display_name": "doanduyhai", "link": "https://stackoverflow.com/users/873530/doanduyhai"}, "edited": false, "score": 1, "creation_date": 1453098953, "post_id": 34846153, "comment_id": 57437078, "body": "Just a wild guess, look likes protocol version mismatch, what is your Cassandra version ?"}, {"owner": {"reputation": 131, "user_id": 5645343, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aceafcadfded241dc64799a0a326cf83?s=128&d=identicon&r=PG&f=1", "display_name": "batflaps", "link": "https://stackoverflow.com/users/5645343/batflaps"}, "reply_to_user": {"reputation": 8472, "user_id": 873530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa96040bb4211cad1c66f385d8cb77b?s=128&d=identicon&r=PG", "display_name": "doanduyhai", "link": "https://stackoverflow.com/users/873530/doanduyhai"}, "edited": false, "score": 0, "creation_date": 1453145680, "post_id": 34846153, "comment_id": 57464494, "body": "3.1.1. I just switched this line <code>cluster.ProtoVersion = 3</code> as a test to reflect 3.x, but now it says <code>no response received from cassandra within timeout period</code>"}, {"owner": {"reputation": 8472, "user_id": 873530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa96040bb4211cad1c66f385d8cb77b?s=128&d=identicon&r=PG", "display_name": "doanduyhai", "link": "https://stackoverflow.com/users/873530/doanduyhai"}, "edited": false, "score": 0, "creation_date": 1453148666, "post_id": 34846153, "comment_id": 57466157, "body": "Starting from Cassandra 3.x.x, the protocol version should be 4 normally. If you&#39;re having issue with the go driver using protocol v4, raise an issue at their github. I&#39;m using the Java driver and it works with protocol v4"}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 5645343, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aceafcadfded241dc64799a0a326cf83?s=128&d=identicon&r=PG&f=1", "display_name": "batflaps", "link": "https://stackoverflow.com/users/5645343/batflaps"}, "is_accepted": false, "score": 3, "last_activity_date": 1453488319, "creation_date": 1453488319, "answer_id": 34953808, "question_id": 34846153, "link": "https://stackoverflow.com/questions/34846153/golang-gocql-failed-to-connect-to-127-0-0-19042-not-enough-bytes-to-read-header/34953808#34953808", "title": "golang gocql failed to connect to 127.0.0.1:9042 not enough bytes to read header require 9 got: 8", "body": "<p>Okay, I sorted out with @Zariel on the github issue #538 thread. You have to put the ProtoVersion = 4 up by the first gocql stuff like:</p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"log\"\nimport \"github.com/gocql/gocql\"\n\nvar (\n    name, sex, age string\n)\n\nfunc main() {\n    // connect to the cluster\n    cluster := gocql.NewCluster(\"127.0.0.1\")\n    cluster.ProtoVersion = 4\n    cluster.Keyspace = \"dbaccess\"\n    session, _ := cluster.CreateSession()\n    defer session.Close()\n\n    if err := session.Query(\"SELECT name, age FROM people WHERE name='doug'\").Scan(&amp;name, &amp;age); \n    err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(name, age)\n}\n</code></pre>\n\n<p>Hope that helps someone else :)</p>\n"}], "owner": {"reputation": 131, "user_id": 5645343, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aceafcadfded241dc64799a0a326cf83?s=128&d=identicon&r=PG&f=1", "display_name": "batflaps", "link": "https://stackoverflow.com/users/5645343/batflaps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1378, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453488319, "creation_date": 1453082235, "question_id": 34846153, "link": "https://stackoverflow.com/questions/34846153/golang-gocql-failed-to-connect-to-127-0-0-19042-not-enough-bytes-to-read-header", "title": "golang gocql failed to connect to 127.0.0.1:9042 not enough bytes to read header require 9 got: 8", "body": "<p>I get this error trying to compile:</p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"log\"\nimport \"github.com/gocql/gocql\"\nvar (\n    name, sex string\n    age int\n)\nfunc main() {\n    // connect to the cluster\n    cluster := gocql.NewCluster(\"127.0.0.1\")\n    cluster.Keyspace = \"dbaccess\"\n    session, _ := cluster.CreateSession()\n    defer session.Close()\n    cluster.ProtoVersion = 4\n    if err := session.Query(\"SELECT name, age FROM people WHERE name='doug'\").Scan(&amp;name, &amp;age); \n    err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(name, age)\n}\n</code></pre>\n\n<p>I added the line </p>\n\n<pre><code>cluster.ProtoVersion = 4\n</code></pre>\n\n<p>After reading about it <a href=\"https://github.com/gocql/gocql/issues/538\" rel=\"nofollow\">here</a> but I'm too new to understand if that's my issue, or I did something wrong elsewhere. Do I have to wait for an update to gocql that fixes this, or what should I do?</p>\n"}, {"tags": ["go", "error-handling", "stack-trace", "panic"], "comments": [{"owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "edited": false, "score": 0, "creation_date": 1453057182, "post_id": 34842322, "comment_id": 57425385, "body": "Related question <a href=\"https://stackoverflow.com/questions/30062949/golang-checking-for-panic-without-recovering-from-it\" title=\"golang checking for panic without recovering from it\">stackoverflow.com/questions/30062949/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "edited": false, "score": 1, "creation_date": 1453065788, "post_id": 34843111, "comment_id": 57428398, "body": "That would work in some cases, but not for me. I call handleError only if there actually is an error. What handleError does is to cause some other gorutines to terminate so that they do not deadlock. I do not want to kill them when there was no error. When there is no error, I do something different. I added a <code>cleanUp()</code> call to the question to show what I mean."}, {"owner": {"reputation": 439, "user_id": 2314047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7cs4.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/2314047/david"}, "edited": false, "score": 2, "creation_date": 1453094469, "post_id": 34843111, "comment_id": 57435563, "body": "Then you can set a boolean variable, named &quot;succ&quot;, initially set to false, and set to true at the end of the function. If succ is set, do not call handleError."}], "tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": false, "score": 6, "last_activity_date": 1453061964, "last_edit_date": 1453061964, "creation_date": 1453061472, "answer_id": 34843111, "question_id": 34842322, "link": "https://stackoverflow.com/questions/34842322/can-i-recover-from-panic-handle-the-error-then-panic-again-and-keep-the-origin/34843111#34843111", "title": "Can I recover from panic, handle the error, then panic again and keep the original stack trace?", "body": "<p>Defered functions higher up in the stack will run on panic, even if they don't call <code>recover()</code>.</p>\n\n<p>Simply remove the if-statement and the re-panic. Then handle your error, and let the panic continue up the stack.</p>\n\n<pre><code>func do() {\n    defer handleError()\n    doStuff()\n}\n</code></pre>\n\n<p>a simple demo:</p>\n\n<p><a href=\"https://play.golang.org/p/UiRou5MhUR\" rel=\"noreferrer\">https://play.golang.org/p/UiRou5MhUR</a></p>\n\n<pre><code>func a() {\n    defer func() {\n        fmt.Println(\"a\")\n    }()\n    panic(\"test\")\n}\nfunc b() {\n    defer func() {\n        fmt.Println(\"b\")\n    }()\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    b()\n}\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>Hello, playground\nb\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 606941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e53a44aef23e2230e37d1612bbe6a3d?s=128&d=identicon&r=PG", "display_name": "debuggr", "link": "https://stackoverflow.com/users/606941/debuggr"}, "edited": false, "score": 4, "creation_date": 1524081333, "post_id": 34851179, "comment_id": 86831872, "body": "Note that this approach means you shouldn&#39;t return anywhere in <code>do()</code> except at the end, below <code>panicked = false</code>. Or you&#39;ll have to explicitly set <code>panicked = false</code> before any other return statement, which is error-prone. Anyone modifying this function later needs to understand this or will regress the logic in the deferred func. I do wish <code>panic</code>s could be &quot;re-thrown&quot; as in Java or C# to preserve the original stack trace without resorting to this."}, {"owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "reply_to_user": {"reputation": 51, "user_id": 606941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e53a44aef23e2230e37d1612bbe6a3d?s=128&d=identicon&r=PG", "display_name": "debuggr", "link": "https://stackoverflow.com/users/606941/debuggr"}, "edited": false, "score": 0, "creation_date": 1549553622, "post_id": 34851179, "comment_id": 95951229, "body": "This proposed Go feature will help accomplish it better: <a href=\"https://github.com/golang/go/issues/29934\" rel=\"nofollow noreferrer\">proposal: Go 2 error values #29934</a>"}], "tags": [], "owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "is_accepted": true, "score": 10, "last_activity_date": 1534443602, "last_edit_date": 1534443602, "creation_date": 1453109030, "answer_id": 34851179, "question_id": 34842322, "link": "https://stackoverflow.com/questions/34842322/can-i-recover-from-panic-handle-the-error-then-panic-again-and-keep-the-origin/34851179#34851179", "title": "Can I recover from panic, handle the error, then panic again and keep the original stack trace?", "body": "<p>The solution is to not call <code>recover</code>, because then neither rethrowing nor accessing the stack trace is possible. Use a bool flag instead of <code>recover</code> to check for panic.</p>\n\n<p><a href=\"https://play.golang.org/p/PKeP9s-3tF\" rel=\"noreferrer\">https://play.golang.org/p/PKeP9s-3tF</a></p>\n\n<pre><code>func do() {\n    panicked := true\n    defer func() {\n        cleanUp()\n        if panicked {\n            handleError()\n        }\n    }()\n    doStuff()\n    panicked = false\n}\n</code></pre>\n"}], "owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2210, "favorite_count": 2, "accepted_answer_id": 34851179, "answer_count": 2, "score": 8, "last_activity_date": 1534443602, "creation_date": 1453057089, "last_edit_date": 1453109082, "question_id": 34842322, "link": "https://stackoverflow.com/questions/34842322/can-i-recover-from-panic-handle-the-error-then-panic-again-and-keep-the-origin", "title": "Can I recover from panic, handle the error, then panic again and keep the original stack trace?", "body": "<p>Is it possible to \"rethrow\" an error from <code>recover</code> and keep the original stack trace? The best I know how to do is to panic again, but that does create a new stacktrace.</p>\n\n<pre><code>func do() {\n    defer func() {\n        cleanUp()\n        if x := recover(); x != nil {\n            handleError()\n            panic(x)\n        }\n    }()\n    doStuff()\n}\n</code></pre>\n\n<p>My motivation for wanting this is that unless my function exits normally or <code>handleError</code> runs, my program deadlocks. And unless I preserve the original strack trace, I do not know where it crashed.</p>\n"}, {"tags": ["go", "lua"], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 1011543, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9b5da400fe5a7e17a019a55ee52e622?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1011543/michael"}, "edited": false, "score": 0, "creation_date": 1453119770, "post_id": 34844950, "comment_id": 57448794, "body": "You are right! It took me some time but I think I&#39;ve figured this out finally. I&#39;ll wrap up and post my solution later for future generations... Thank you @rochet2"}], "tags": [], "owner": {"reputation": 984, "user_id": 3586583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ff364c78d225c26158cda484102447?s=128&d=identicon&r=PG", "display_name": "Rochet2", "link": "https://stackoverflow.com/users/3586583/rochet2"}, "is_accepted": true, "score": 1, "last_activity_date": 1453072532, "creation_date": 1453072532, "answer_id": 34844950, "question_id": 34841773, "link": "https://stackoverflow.com/questions/34841773/golua-declaring-lua-class-with-defined-methods/34844950#34844950", "title": "golua - declaring lua class with defined methods", "body": "<p>I have not used go, but it looks like you never set <code>Book</code> as a metatable for the new book you create. Im <em>fairly sure</em> this does not happen automatically.</p>\n\n<p>See an example I found here <a href=\"https://github.com/stevedonovan/luar/blob/master/luar.go#L52\" rel=\"nofollow\">https://github.com/stevedonovan/luar/blob/master/luar.go#L52</a></p>\n\n<p>What is important here is that when a userdata or any object is made (your book), you need to get the global metatable and then set it as metatable with <code>L.SetMetaTable(-2)</code></p>\n"}, {"tags": [], "owner": {"reputation": 421, "user_id": 1011543, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9b5da400fe5a7e17a019a55ee52e622?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1011543/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1453133348, "last_edit_date": 1592644375, "creation_date": 1453133348, "answer_id": 34859174, "question_id": 34841773, "link": "https://stackoverflow.com/questions/34841773/golua-declaring-lua-class-with-defined-methods/34859174#34859174", "title": "golua - declaring lua class with defined methods", "body": "<p>After <a href=\"https://stackoverflow.com/users/3586583/rochet2\">@Rochet2</a>'s answer and after reading <a href=\"http://www.lua.org/pil/28.html\" rel=\"nofollow noreferrer\">Chapter 28. User-Defined Types in C</a> of <a href=\"http://www.lua.org/pil/contents.html\" rel=\"nofollow noreferrer\">Programming in Lua</a> I've came up with working solution. I know nothing about Lua and just a little about Go so I might be wrong in my conclusions.</p>\n<blockquote>\n<p>This edition of <em>Programming in Lua</em> was written for Lua 5.0 - <a href=\"https://github.com/aarzilli/golua\" rel=\"nofollow noreferrer\">golua</a> utilizes Lua 5.1 (for now).</p>\n</blockquote>\n<hr />\n<h3><code>BookCreate</code> function</h3>\n<p>We create new <em>userdata</em> instead of pushing plain Go <em>struct</em> to stack. Then we set <em>metatable</em> of newly created <code>book</code> to &quot;Book&quot;.</p>\n<p><code>L.NewUserdata</code> returns <code>unsafe.Pointer</code> so we cast it to <code>Book</code>.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>func BookCreate(L *lua.State) int {\n    title := L.ToString(1)\n    book := (*Book)(L.NewUserdata(uintptr(unsafe.Sizeof(Book{}))))\n\n    L.LGetMetaTable(&quot;Book&quot;)\n    L.SetMetaTable(-2)\n\n    book.Id = 1;\n    book.Title = title;\n\n    return 1\n}\n</code></pre>\n<hr />\n<h3><code>BookToString</code> function</h3>\n<p>Here we just take <em>userdata</em> from stack and cast it to <code>Book</code>.</p>\n<blockquote>\n<p>Be aware that what we pop out of stack might not be pointer to <code>Book</code> struct so if we want to prevent nil pointers / other Go errors some basic type check might be required.</p>\n</blockquote>\n<pre><code>func BookToString(L *lua.State) int {\n    book := (*Book)(L.ToUserdata(1))\n    L.PushString(fmt.Sprintf(&quot;Book(Id=%d, Title=\\&quot;%s\\&quot;)&quot;, book.Id, book.Title))\n\n    return 1\n}\n</code></pre>\n<hr />\n<h3><code>main</code> function</h3>\n<p>We initialize new &quot;Book&quot; metatable and make itself its own metatble. We add two methods <code>Create</code> and <code>__tostring</code> and make &quot;Book&quot; a global.</p>\n<pre><code>L := lua.NewState()\ndefer L.Close()\nL.OpenLibs()\n\nL.NewMetaTable(&quot;Book&quot;)\nL.PushString(&quot;__index&quot;)\nL.PushValue(-2)\nL.SetTable(-3)\nL.SetMetaMethod(&quot;Create&quot;, BookCreate)\nL.SetMetaMethod(&quot;__tostring&quot;, BookToString)\nL.SetGlobal(&quot;Book&quot;)\n</code></pre>\n<p>This is what we can do in Lua now:</p>\n<pre><code>local book = Book.Create('Le Petit Prince')\nprint(book)\nprint(book:__tostring())\nprint(Book.__tostring(book))\n\n--out:\nBook(Id=1, Title=&quot;Le Petit Prince&quot;)\nBook(Id=1, Title=&quot;Le Petit Prince&quot;)\nBook(Id=1, Title=&quot;Le Petit Prince&quot;)\n</code></pre>\n<p>I hope someone will find it useful. <a href=\"http://pastebin.com/xDjgXzst\" rel=\"nofollow noreferrer\">Full code here</a>.</p>\n"}], "owner": {"reputation": 421, "user_id": 1011543, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9b5da400fe5a7e17a019a55ee52e622?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1011543/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 34844950, "answer_count": 2, "score": 1, "last_activity_date": 1453133348, "creation_date": 1453054069, "question_id": 34841773, "link": "https://stackoverflow.com/questions/34841773/golua-declaring-lua-class-with-defined-methods", "title": "golua - declaring lua class with defined methods", "body": "<p>I'm trying to use <a href=\"https://github.com/aarzilli/golua\" rel=\"nofollow\">golua package</a> to build an extension API for my application written in Go. My idea is to have several classes exposed to lua VM, for example <code>Book</code> class:</p>\n\n<pre class=\"lang-lua prettyprint-override\"><code>local book = Book.Create(\"Le Petit Prince\")\nprint(book)\nbook:save()\n</code></pre>\n\n<p>What I'm able to do now is just basic:</p>\n\n<pre><code>type Book struct {\n    Id int64\n    Title string\n}\n\nfunc BookCreate(L *lua.State) int {\n    title := L.ToString(1)\n    p := &amp;Book{Id: 1, Title: title}\n    L.PushGoStruct(p)\n    return 1\n}\n\nfunc BookToString(L *lua.State) int {\n    book, _ := L.ToGoStruct(1).(*Book)\n    L.PushString(fmt.Sprintf(\"Book(Id=%d, Title=\\\"%s\\\")\", book.Id, book.Title))\n    return 1\n}\n\nL := lua.NewState()\ndefer L.Close()\nL.OpenLibs()\n\nL.NewMetaTable(\"Book\")\nL.SetMetaMethod(\"Create\", BookCreate)\nL.SetMetaMethod(\"tostring\", BookToString)\nL.SetGlobal(\"Book\")\n</code></pre>\n\n<p>Which allows me to do this:</p>\n\n<pre class=\"lang-lua prettyprint-override\"><code>local book = Book.Create(\"Le Petit Prince\")\nprint(Book.tostring(book))\n</code></pre>\n\n<p>But not this:</p>\n\n<pre><code>local book = Book.Create(\"Le Petit Prince\")\nprint(book:tostring())\n\n// reflect: call of reflect.Value.Type on zero Value\n</code></pre>\n\n<h3>My questions</h3>\n\n<ol>\n<li>How to create lua class equivalent to one described in <a href=\"http://lua-users.org/wiki/SimpleLuaClasses\" rel=\"nofollow\">A Simplified Way to Declare Lua Classes</a>?</li>\n<li>How to add \"magic methods\" to class like <code>__tostring</code> <a href=\"http://www.wellho.net/resources/ex.php4?item=u107/meta2\" rel=\"nofollow\">here</a></li>\n</ol>\n"}, {"tags": ["json", "recursion", "go"], "answers": [{"comments": [{"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 0, "creation_date": 1453056821, "post_id": 34841672, "comment_id": 57425245, "body": "Oh, it&#39;s a copy! I figured range is an iterator so it would probably return a reference. Thanks, I should have seen that!"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 0, "creation_date": 1453060021, "post_id": 34841672, "comment_id": 57426382, "body": "@W.K.S you could also declare menu items like <code>[]*MenuItem</code> then when you ranged over the items you would be dealing with a pointer and been able to modify directly."}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1453053552, "creation_date": 1453053552, "answer_id": 34841672, "question_id": 34841327, "link": "https://stackoverflow.com/questions/34841327/parsing-nested-list-does-not-go-down-to-level-3/34841672#34841672", "title": "Parsing nested list does not go down to level 3", "body": "<p>This loop in the <code>TryAdd</code> function is most probably your issue:</p>\n\n<pre><code>for _, sub := range m.Subs {\n    if found := sub.TryAdd(other); found {\n        return true\n    }\n}\n</code></pre>\n\n<p>The <code>sub</code> variable in this loop is actually a <em>copy</em> of the slice element. Any changes you make there will not persist back to the the element that is stored in the slice.</p>\n\n<p>You should be able to solve this issue by not working with the element's copy, but referencing it by its index instead:</p>\n\n<pre><code>for i := range m.Subs {\n    if found := m.Subs[i].TryAdd(other); found {\n        return true\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 34841672, "answer_count": 1, "score": 0, "last_activity_date": 1453053552, "creation_date": 1453051755, "question_id": 34841327, "link": "https://stackoverflow.com/questions/34841327/parsing-nested-list-does-not-go-down-to-level-3", "title": "Parsing nested list does not go down to level 3", "body": "<p>I have a JSON representing menu items.</p>\n\n<p>A menu item can have a sub menu item, which in turn can have another sub menu item and so son.</p>\n\n<p>The input JSON relates the menu items through a parent id. I'm trying to convert this to a model where each menu item has a slice of its sub menu items. </p>\n\n<p>The sub menus go three levels deep. I've managed to parse upto two levels but I have no idea why the third level isn't being parsed. I've been debugging this problem for hours. I would appreciate some help.</p>\n\n<p><strong>menu2.sjon</strong></p>\n\n<pre><code>[\n  {\n    \"category_id\": 4,\n    \"category_id_400\": \"'SCHOO\",\n    \"name\": \"School Supplies\",\n    \"parent_id\": 2,\n    \"position\": 2,\n    \"level\": 2,\n    \"status\": 1,\n    \"url\": \"http://www.booksrus.kw/sa-en/school-supplies.html\"\n  },\n  {\n    \"category_id\": 141,\n    \"category_id_400\": \"'SCHBA\",\n    \"name\": \"School Bags\",\n    \"parent_id\": 4,\n    \"position\": 12,\n    \"level\": 3,\n    \"status\": 1,\n    \"url\": \"http://www.booksrus.kw/sa-en/school-supplies/school-bags.html\"\n  },\n  {\n    \"category_id\": 269,\n    \"category_id_400\": \"'AEP\",\n    \"name\": \"Bags Knapsack with Trolley\",\n    \"parent_id\": 141,\n    \"position\": 1,\n    \"level\": 4,\n    \"status\": 1,\n    \"url\": \"http://www.booksrus.kw/sa-en/school-supplies/school-bags/bags-knapsack-with-trolley.html\"\n  }\n]\n</code></pre>\n\n<p><strong>menu.go</strong></p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"encoding/json\"\n    \"io/ioutil\"\n    \"sort\"\n    \"bytes\"\n)\n\ntype MenuItems []MenuItem\n\nfunc (a MenuItems) Len() int           { return len(a) }\nfunc (a MenuItems) Swap(i, j int)      { a[i], a[j] = a[j], a[i] }\nfunc (a MenuItems) Less(i, j int) bool { return a[i].Category_id &lt; a[j].Category_id }\n\ntype MenuItem struct{\n    Category_id int `json:\"category_id\"`\n    Category_id_400 string `json:\"category_id_400\"`\n    Name string `json:\"name\"`\n    Parent_id int `json:\"parent_id\"`\n    Position int `json:\"position\"`\n    Level int `json:\"level\"`\n    Status int `json:\"status\"`\n    Url string  `json:\"url\"`\n    Subs []MenuItem `json:\"subs\"`\n}\n\nfunc (m MenuItem) String() string{\n\n     var buffer bytes.Buffer\n     buffer.WriteString(fmt.Sprintf(\"%d %s\\n\",m.Category_id,m.Name))\n    for _,s := range m.Subs{\n        buffer.WriteString(fmt.Sprintf(\"&gt;   %s\\n\",s.String()));\n    }\n\n    return buffer.String()\n    //return fmt.Sprintf(\"CategoryId: %d, ParentId: %d,Name: %s, Sub: %v\\n\",m.Category_id,m.Parent_id,m.Name,m.Subs);\n}\n\nfunc (m *MenuItem) TryAdd(other MenuItem) bool{\n\n    if other.Parent_id == m.Category_id {\n\n        m.Subs = append(m.Subs,other);\n        return true\n    }else{\n        for _,sub := range m.Subs{\n            if found := sub.TryAdd(other);found{\n                return true\n            }\n        }\n    }\n\n    return false\n}\n\nfunc main() {\n    rootItems := make([]MenuItem,0)\n    bytes, err := ioutil.ReadFile(\"menu2.json\")\n\n    if err != nil{\n        fmt.Printf(\"Reading: %s\\n\",err.Error())\n        return;\n    }\n\n    var menuItems []MenuItem\n    err = json.Unmarshal(bytes,&amp;menuItems)\n\n    if err != nil{\n        fmt.Println(err.Error())\n        return\n    }\n\n    sort.Sort(MenuItems(menuItems))\n\n    for _,item := range menuItems{\n        if item.Parent_id == 2{\n            rootItems = append(rootItems,item)\n        }else{\n            for i:=0;i&lt;len(rootItems);i++{\n                if found := rootItems[i].TryAdd(item); found{\n                    break;\n                }else{\n                    fmt.Printf(\"No Action: Id: %d, Name: %s, Parent: %d.\\n\",item.Category_id,item.Name,item.Parent_id)\n                }\n            }\n        }\n    }\n\n    fmt.Printf(\"\\nRootitems:\\n%s\\n\",rootItems)\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>Rootitems:\n[4 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0School Supplies\n&gt;   141 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0School Bags\n//Third level should appear here\n]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 13086, "user_id": 1431239, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e0085b2fdc60b5c84310fa29529a6648?s=128&d=identicon&r=PG", "display_name": "Mike Mackintosh", "link": "https://stackoverflow.com/users/1431239/mike-mackintosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1453129632, "creation_date": 1453129632, "answer_id": 34857905, "question_id": 34840050, "link": "https://stackoverflow.com/questions/34840050/go-rice-load-templates-into-gin/34857905#34857905", "title": "go.rice load templates into gin", "body": "<p><code>SetHTMLTemplate</code> will override the template every time it's called in the loop.</p>\n\n<p>After looking at the following, you can try <a href=\"https://github.com/gin-gonic/gin/issues/320\" rel=\"nofollow\">https://github.com/gin-gonic/gin/issues/320</a>:</p>\n\n<pre><code>func loadTemplates() multitemplate.Render {\n  templateBox, err := rice.FindBox(\"templates\")\n  if err != nil {\n      fmt.Println(err)\n  }\n\n  r := multitemplate.New()\n\n  list := [...]string{\"foo.html\", \"bar.html\"}\n  for _, x := range list {\n    templateString, err := templateBox.String(x)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    tmplMessage, err := template.New(x).Parse(templateString)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    r.Add(x, tmplMessage)\n  }\n\n  return r\n}\n</code></pre>\n\n<p>Then in your route definition:</p>\n\n<pre><code>router.HTMLRender = loadTemplates()\n</code></pre>\n"}], "owner": {"reputation": 6305, "user_id": 72987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9d1484425e9a125402f85497c7f86a00?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/72987/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 1, "accepted_answer_id": 34857905, "answer_count": 1, "score": 2, "last_activity_date": 1453129632, "creation_date": 1453044453, "question_id": 34840050, "link": "https://stackoverflow.com/questions/34840050/go-rice-load-templates-into-gin", "title": "go.rice load templates into gin", "body": "<p>I have the following dir layout</p>\n\n<pre><code>$ ls templates/\nbar.html    foo.html\n</code></pre>\n\n<p>I have run the following command</p>\n\n<pre><code>$ rice embed-go\n</code></pre>\n\n<p>My code looks like</p>\n\n<p>package main</p>\n\n<pre><code>import (\n  \"github.com/gin-gonic/gin\"\n  \"github.com/GeertJohan/go.rice\"\n  \"fmt\"\n  \"html/template\"\n)\n\n\nfunc main() {\n  router := gin.Default()\n\n  //html := template.Must(template.ParseFiles(\"templates/foo.html\", \"templates/bar.html\"))\n  //router.SetHTMLTemplate(html)\n\n  templateBox, err := rice.FindBox(\"templates\")\n  if err != nil {\n      fmt.Println(err)\n  }\n\n  list := [...]string{\"foo.html\", \"bar.html\"}\n  for _, x := range list {\n    templateString, err := templateBox.String(x)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    tmplMessage, err := template.New(x).Parse(templateString)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    router.SetHTMLTemplate(tmplMessage)\n  }\n\n\n  router.GET(\"/index\", func(c *gin.Context) {\n      c.HTML(200, \"foo.html\", gin.H{\n          \"Message\": \"Main website\",\n      })\n  })\n  router.GET(\"/bar\", func(c *gin.Context) {\n      c.HTML(200, \"bar.html\", gin.H{\n          \"Message\": \"so much bar\",\n      })\n  })\n  router.Run(\":8080\")\n}\n</code></pre>\n\n<p>The issue I am having is I can curl the following URL just fine</p>\n\n<pre><code>$ curl 0:8080/bar\nbar so much bar\n</code></pre>\n\n<p>The issue is the /index url isn't working because the <code>SetHTMLTemplate</code> is overwriting it. </p>\n\n<p>I'm wondering how I can pass multiple loaded templates from a bindata file created by go.rice into gin.</p>\n\n<p>I get the following error</p>\n\n<pre><code>[GIN-debug] [ERROR] html/template: \"foo.html\" is undefined\n[GIN] 2016/01/17 - 07:19:40 | 500 |      67.033\u00b5s | 127.0.0.1:52467 |   GET     /index\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "static-linking"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1453213591, "last_edit_date": 1453213591, "creation_date": 1453045483, "answer_id": 34840225, "question_id": 34839897, "link": "https://stackoverflow.com/questions/34839897/how-to-statically-link-a-go-binary-that-uses-crypto-tls/34840225#34840225", "title": "How to statically link a Go binary that uses crypto/tls?", "body": "<p>The only OS where <code>crypto/tls</code> uses cgo is darwin, where it needs to call <code>FetchPEMRoots</code>to get the root CAs. </p>\n\n<p>The reason your program is using cgo is because <code>crypto/tls</code> imports the <code>net</code> package, which links to the host resolver by default. You can build the <code>net</code> package without cgo using the \"netgo\" build tag.</p>\n\n<pre><code>go build -tags netgo\n</code></pre>\n\n<p>Or if you're on a release where the std lib packages won't be built by default, you can trigger them to be compiled with a new installsuffix</p>\n\n<pre><code>go build -installsuffix netgo -tags netgo\n</code></pre>\n\n<p>Since you're not going to have the need or ability to use cgo in your environment, you may want to just build everything with <code>CGO_ENABLED=0</code> to disable cgo entirely. </p>\n"}], "owner": {"reputation": 2642, "user_id": 2016404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4a26772f20e8b554ce5c67f2d0ec348?s=128&d=identicon&r=PG", "display_name": "cyphar", "link": "https://stackoverflow.com/users/2016404/cyphar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 3, "accepted_answer_id": 34840225, "answer_count": 1, "score": 7, "last_activity_date": 1453213591, "creation_date": 1453043533, "question_id": 34839897, "link": "https://stackoverflow.com/questions/34839897/how-to-statically-link-a-go-binary-that-uses-crypto-tls", "title": "How to statically link a Go binary that uses crypto/tls?", "body": "<p>If you try to compile the following Go program:</p>\n\n<pre><code>package main\n\nimport _ \"crypto/tls\"\n\nfunc main() {\n\n}\n</code></pre>\n\n<p>You'll wind up with a dynamically linked Go binary. This is annoying for me (I'm building a Go binary inside a Docker container, which uses a different libc from my host, which will result in the binary not running on my host).</p>\n\n<p>How does one <strong>force</strong> Go to build such a program statically?</p>\n"}, {"tags": ["html", "arrays", "forms", "go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1453043710, "post_id": 34839811, "comment_id": 57420526, "body": "<a href=\"http://stackoverflow.com/questions/23713817/how-to-parse-form-array-in-golang-beego\" title=\"how to parse form array in golang beego\">stackoverflow.com/questions/23713817/&hellip;</a>"}, {"owner": {"reputation": 1007, "user_id": 5727424, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Djr2s.jpg?s=128&g=1", "display_name": "David Lavieri", "link": "https://stackoverflow.com/users/5727424/david-lavieri"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1453044171, "post_id": 34839811, "comment_id": 57420682, "body": "Nah, that does not help... Note my Form Data array have independent keys, even if there  were no keys no way to identify correctly which one correspond to which one..."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1453047692, "post_id": 34839811, "comment_id": 57421810, "body": "You can pretty easily write your own form parser that traverses all the keys in the form, and groups all &quot;Name[Key]&quot; fields into one sub dictionary."}, {"owner": {"reputation": 1007, "user_id": 5727424, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Djr2s.jpg?s=128&g=1", "display_name": "David Lavieri", "link": "https://stackoverflow.com/users/5727424/david-lavieri"}, "edited": false, "score": 0, "creation_date": 1453048167, "post_id": 34839811, "comment_id": 57421956, "body": "Since I couldn&#39;t find anything like it, thats pretty much what I did, my own func... Well I gonna make a struct for that to save the parsed form and use it as I need"}], "answers": [{"comments": [{"owner": {"reputation": 450, "user_id": 2965665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc4f155dbe24567ff73e58704359028f?s=128&d=identicon&r=PG&f=1", "display_name": "Russo", "link": "https://stackoverflow.com/users/2965665/russo"}, "edited": false, "score": 1, "creation_date": 1598633158, "post_id": 34841218, "comment_id": 112532537, "body": "I have to add req.PostFormValue(&quot;&quot;) before your code if err := req.ParseForm(); ... for it to work! I don&#39;t know why... Thank you"}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 21, "last_activity_date": 1453051239, "creation_date": 1453051239, "answer_id": 34841218, "question_id": 34839811, "link": "https://stackoverflow.com/questions/34839811/how-to-retrieve-form-data-as-map-like-php-and-ruby-in-go-golang/34841218#34841218", "title": "How to retrieve form-data as map (like PHP and Ruby) in Go (Golang)", "body": "<blockquote>\n  <p>Is there a easier way to get my Form Array as an actual map in Golang like PHP does?</p>\n</blockquote>\n\n<p>You can use the <code>PostForm</code> member of the <code>http.Request</code> type. It is of type <a href=\"https://golang.org/pkg/net/url/#Values\"><code>url.Values</code></a> -- which is actually (ta-da) a <code>map[string][]string</code>, and you can treat is as such. You'll still need to call <code>req.ParseForm()</code> first, though.</p>\n\n<pre><code>if err := req.ParseForm(); err != nil {\n    // handle error\n}\n\nfor key, values := range req.PostForm {\n    // [...]\n}\n</code></pre>\n\n<p><strong>Note that <code>PostForm</code> is a map of <em>lists of strings</em></strong>. That's because in theory, each field could be present multiple times in the POST body. The <code>PostFormValue()</code> method handles this by implicitly returning the <em>first</em> of multiple values (meaning, when your POST body is <code>&amp;foo=bar&amp;foo=baz</code>, then <code>req.PostFormValue(\"foo\")</code> will always return <code>\"bar\"</code>).</p>\n\n<p><strong>Also note that <code>PostForm</code> will never contain <em>nested structures</em></strong> like you are used from PHP. As Go is statically typed, a POST form value will <em>always</em> be a mapping of <code>string</code> (name) to <code>[]string</code> (value/s).</p>\n\n<p>Personally, I wouldn't use the bracket syntax (<code>contact[email]</code>) for POST field names in Go applications; that's a PHP specific construct, anyway and as you've already noticed, Go does not support it very well.</p>\n\n<blockquote>\n  <p>Should I retrieve the data one by one (Tedious as much and I may change the Form data at some point and recompile...) or iterate the whole thing as I've done in the 2nd example.</p>\n</blockquote>\n\n<p>There's probably no correct answer for that. If you are mapping your POST fields to a struct with static fields, you'll have to explicitly map them at some point (or use <a href=\"https://golang.org/pkg/reflect/\"><code>reflect</code></a> to implement some magical auto-mapping).</p>\n"}, {"tags": [], "owner": {"reputation": 8949, "user_id": 2325596, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2297878f20b8b95376bf21bfe876924d?s=128&d=identicon&r=PG", "display_name": "Elliot Larson", "link": "https://stackoverflow.com/users/2325596/elliot-larson"}, "is_accepted": false, "score": 4, "last_activity_date": 1463073207, "creation_date": 1463073207, "answer_id": 37193436, "question_id": 34839811, "link": "https://stackoverflow.com/questions/34839811/how-to-retrieve-form-data-as-map-like-php-and-ruby-in-go-golang/37193436#37193436", "title": "How to retrieve form-data as map (like PHP and Ruby) in Go (Golang)", "body": "<p>I had the same question.  The submission of array form params is also idiomatic in the Ruby/Rails world where I'm coming from.  But, after some research, it looks like this is not really the \"Go-way\".  </p>\n\n<p>I've been using the dot prefix convention: <code>contact.name</code>, <code>contact.email</code>, etc.</p>\n\n<pre><code>func parseFormHandler(writer http.ResponseWriter, request *http.Request) {\n    request.ParseForm()\n\n    userParams := make(map[string]string)\n\n    for key, _ := range request.Form {\n        if strings.HasPrefix(key, \"contact.\") {\n            userParams[string(key[8:])] = request.Form.Get(key)\n        }\n    }\n\n    fmt.Fprintf(writer, \"%#v\\n\", userParams)\n}\n\nfunc main() {\n    server := http.Server{Addr: \":8088\"}\n    http.HandleFunc(\"/\", parseFormHandler)\n    server.ListenAndServe()\n}\n</code></pre>\n\n<p>Running this server and then curling it:</p>\n\n<pre><code>$ curl -id \"contact.name=Jeffrey%20Lebowski&amp;contact.email=thedude@example.com&amp;contact.message=I%20hate%20the%20Eagles,%20man.\" http://localhost:8088\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>HTTP/1.1 200 OK\nDate: Thu, 12 May 2016 16:41:44 GMT\nContent-Length: 113\nContent-Type: text/plain; charset=utf-8\n\nmap[string]string{\"name\":\"Jeffrey Lebowski\", \"email\":\"thedude@example.com\", \"message\":\"I hate the Eagles, man.\"}\n</code></pre>\n\n<h2>Using the Gorilla Toolkit</h2>\n\n<p>You can also use the <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"nofollow\">Gorilla Toolkit's Schema Package</a> to parse the form params into a struct, like so:</p>\n\n<pre><code>type Submission struct {\n    Contact Contact\n}\n\ntype Contact struct {\n    Name    string\n    Email   string\n    Message string\n}\n\nfunc parseFormHandler(writer http.ResponseWriter, request *http.Request) {\n    request.ParseForm()\n\n    decoder := schema.NewDecoder()\n    submission := new(Submission)\n    err := decoder.Decode(submission, request.Form)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Fprintf(writer, \"%#v\\n\", submission)\n}\n</code></pre>\n\n<p>Running this server and then curling it:</p>\n\n<pre><code>$ curl -id \"Contact.Name=Jeffrey%20Lebowski&amp;Contact.Email=thedude@example.com&amp;Contact.Message=I%20hate%20the%20Eagles,%20man.\" http://localhost:8088\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>HTTP/1.1 200 OK\nDate: Thu, 12 May 2016 17:03:38 GMT\nContent-Length: 128\nContent-Type: text/plain; charset=utf-8\n\n&amp;main.Submission{Contact:main.Contact{Name:\"Jeffrey Lebowski\", Email:\"thedude@example.com\", Message:\"I hate the Eagles, man.\"}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13857, "user_id": 1039, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/08bc3fc74454a8f22ac8e52d686dd058?s=128&d=identicon&r=PG", "display_name": "d4nt", "link": "https://stackoverflow.com/users/1039/d4nt"}, "is_accepted": false, "score": 7, "last_activity_date": 1490319076, "creation_date": 1490319076, "answer_id": 42989901, "question_id": 34839811, "link": "https://stackoverflow.com/questions/34839811/how-to-retrieve-form-data-as-map-like-php-and-ruby-in-go-golang/42989901#42989901", "title": "How to retrieve form-data as map (like PHP and Ruby) in Go (Golang)", "body": "<p>I had a similar problem, so I wrote this function</p>\n\n<pre><code>func ParseFormCollection(r *http.Request, typeName string) []map[string]string {\n    var result []map[string]string\n    r.ParseForm()\n    for key, values := range r.Form {\n        re := regexp.MustCompile(typeName + \"\\\\[([0-9]+)\\\\]\\\\[([a-zA-Z]+)\\\\]\")\n        matches := re.FindStringSubmatch(key)\n\n        if len(matches) &gt;= 3 {\n\n            index, _ := strconv.Atoi(matches[1])\n\n            for ; index &gt;= len(result); {\n                result = append(result, map[string]string{})\n            }\n\n            result[index][matches[2]] = values[0]\n        }\n    }\n    return result\n}\n</code></pre>\n\n<p>It turns a collection of form key value pairs into a list of string maps. For example, if I have form data like this:</p>\n\n<pre><code>Contacts[0][Name] = Alice\nContacts[0][City] = Seattle\nContacts[1][Name] = Bob\nContacts[1][City] = Boston\n</code></pre>\n\n<p>I can call my function passing the typeName of \"Contacts\":</p>\n\n<pre><code>for _, contact := range ParseFormCollection(r, \"Contacts\") {\n    // ...\n}\n</code></pre>\n\n<p>And it will return a list of two map objects, each map containing keys for \"Name\" and \"City\". In JSON notation, it would look like this:</p>\n\n<pre><code>[\n  {\n    \"Name\": \"Alice\",\n    \"City\": \"Seattle\"\n  },\n  {\n    \"Name\": \"Bob\",\n    \"City\": \"Boston\"\n  }\n]\n</code></pre>\n\n<p>Which incidentally, is exactly how I'm posting the data up to the server in an ajax request:</p>\n\n<pre><code>$.ajax({\n  method: \"PUT\",\n  url: \"/api/example/\",\n  dataType: \"json\",\n  data: {\n    Contacts: [\n      {\n        \"Name\": \"Alice\",\n        \"City\": \"Seattle\"\n      },\n      {\n        \"Name\": \"Bob\",\n        \"City\": \"Boston\"\n      }\n    ]\n  }\n})\n</code></pre>\n\n<p>If your form data key structure doesn't quite match mine, then I you could probably adapt the Regex that I'm using to suit your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 499, "user_id": 7715823, "user_type": "registered", "profile_image": "https://graph.facebook.com/1310061149060662/picture?type=large", "display_name": "Fanan Dala", "link": "https://stackoverflow.com/users/7715823/fanan-dala"}, "is_accepted": false, "score": 0, "last_activity_date": 1593861814, "last_edit_date": 1593861814, "creation_date": 1593265550, "answer_id": 62610820, "question_id": 34839811, "link": "https://stackoverflow.com/questions/34839811/how-to-retrieve-form-data-as-map-like-php-and-ruby-in-go-golang/62610820#62610820", "title": "How to retrieve form-data as map (like PHP and Ruby) in Go (Golang)", "body": "<blockquote>\n<p>I've been using the dot prefix convention: contact.name, contact.email</p>\n</blockquote>\n<p>I decided to leave a script here so people don't have to spend so much time writing their own custom parser.</p>\n<p>Here is a simple script that traverses the form data and puts the values in a struct that follows a format close to PHP and Ruby's.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package formparser\n\nimport (\n    &quot;strings&quot;\n    &quot;mime/multipart&quot;\n)\n\ntype NestedFormData struct {\n    Value *ValueNode\n    File *FileNode\n}\n\ntype ValueNode struct {\n    Value []string\n    Children map[string]*ValueNode\n}\n\ntype FileNode struct {\n    Value []*multipart.FileHeader\n    Children map[string]*FileNode\n}\n\nfunc (fd *NestedFormData) ParseValues(m map[string][]string){\n    n := &amp;ValueNode{\n        Children: make(map[string]*ValueNode),\n    }\n    for key, val := range m {\n        keys := strings.Split(key,&quot;.&quot;)\n        fd.nestValues(n, &amp;keys, val)\n    }\n    fd.Value = n\n}\n\nfunc (fd *NestedFormData) ParseFiles(m map[string][]*multipart.FileHeader){\n    n := &amp;FileNode{\n        Children: make(map[string]*FileNode),\n    }\n    for key, val := range m {\n        keys := strings.Split(key,&quot;.&quot;)\n        fd.nestFiles(n, &amp;keys, val)\n    }\n    fd.File = n\n}\n\nfunc (fd *NestedFormData) nestValues(n *ValueNode, k *[]string, v []string) {\n    var key string\n    key, *k = (*k)[0], (*k)[1:]\n    if len(*k) == 0 {\n            if _, ok := n.Children[key]; ok {\n                    n.Children[key].Value = append(n.Children[key].Value, v...)\n            } else {\n                    cn := &amp;ValueNode{\n                            Value: v,\n                            Children: make(map[string]*ValueNode),\n                    }\n                    n.Children[key] = cn\n            }\n    } else {\n        if _, ok := n.Children[key]; ok {\n            fd.nestValues(n.Children[key], k,v)\n        } else {\n            cn := &amp;ValueNode{\n                Children: make(map[string]*ValueNode),\n            }\n            n.Children[key] = cn\n            fd.nestValues(cn, k,v)\n        }\n    }\n}\n\nfunc (fd *NestedFormData) nestFiles(n *FileNode, k *[]string, v []*multipart.FileHeader){\n    var key string\n    key, *k = (*k)[0], (*k)[1:]\n    if len(*k) == 0 {\n        if _, ok := n.Children[key]; ok {\n            n.Children[key].Value = append(n.Children[key].Value, v...)\n        } else {\n            cn := &amp;FileNode{\n                Value: v,\n                Children: make(map[string]*FileNode),\n            }\n            n.Children[key] = cn\n        }\n    } else {\n        if _, ok := n.Children[key]; ok {\n            fd.nestFiles(n.Children[key], k,v)\n        } else {\n            cn := &amp;FileNode{\n                Children: make(map[string]*FileNode),\n            }\n            n.Children[key] = cn\n            fd.nestFiles(cn, k,v)\n        }\n    }\n}\n</code></pre>\n<p>Then you can use the package like so:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n &quot;MODULE_PATH/formparser&quot;\n &quot;strconv&quot;\n &quot;fmt&quot;\n)\n\nfunc main(){\n    formdata := map[string][]string{\n        &quot;contact.name&quot;: []string{&quot;John Doe&quot;},\n        &quot;avatars.0.type&quot;: []string{&quot;water&quot;},\n        &quot;avatars.0.name&quot;: []string{&quot;Korra&quot;},\n        &quot;avatars.1.type&quot;: []string{&quot;air&quot;},\n        &quot;avatars.1.name&quot;: []string{&quot;Aang&quot;},\n    }\n    f := &amp;formparser.NestedFormData{}\n    f.ParseValues(formdata)\n    //then access form values like so\n    fmt.Println(f.Value.Children[&quot;contact&quot;].Children[&quot;name&quot;].Value)\n    fmt.Println(f.Value.Children[&quot;avatars&quot;].Children[strconv.Itoa(0)].Children[&quot;name&quot;].Value)\n    fmt.Println(f.Value.Children[&quot;avatars&quot;].Children[strconv.Itoa(0)].Children[&quot;type&quot;].Value)\n    fmt.Println(f.Value.Children[&quot;avatars&quot;].Children[strconv.Itoa(1)].Children[&quot;name&quot;].Value)\n    fmt.Println(f.Value.Children[&quot;avatars&quot;].Children[strconv.Itoa(1)].Children[&quot;type&quot;].Value)\n    //or traverse  the Children in a loop\n    for key, child := range f.Value.Children {\n        fmt.Println(&quot;Key:&quot;, key, &quot;Value:&quot;, child.Value)\n        if child.Children != nil {\n            for k, c := range child.Children {\n                fmt.Println(key + &quot;'s child key:&quot;, k, &quot;Value:&quot;, c.Value)\n            }\n        }\n    }\n    //if you want to access files do not forget to call f.ParseFiles()\n}\n</code></pre>\n"}], "owner": {"reputation": 1007, "user_id": 5727424, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Djr2s.jpg?s=128&g=1", "display_name": "David Lavieri", "link": "https://stackoverflow.com/users/5727424/david-lavieri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25488, "favorite_count": 7, "accepted_answer_id": 34841218, "answer_count": 4, "score": 13, "last_activity_date": 1593861814, "creation_date": 1453043098, "last_edit_date": 1593277717, "question_id": 34839811, "link": "https://stackoverflow.com/questions/34839811/how-to-retrieve-form-data-as-map-like-php-and-ruby-in-go-golang", "title": "How to retrieve form-data as map (like PHP and Ruby) in Go (Golang)", "body": "<p>I'm a PHP Dev. But currently moving to Golang... I'm trying to retrieve data from a Form (Post method):</p>\n\n<pre><code>&lt;!-- A really SIMPLE form --&gt;\n&lt;form class=\"\" action=\"/Contact\" method=\"post\"&gt;\n  &lt;input type=\"text\" name=\"Contact[Name]\" value=\"Something\"&gt;   \n  &lt;input type=\"text\" name=\"Contact[Email]\" value=\"Else\"&gt;\n  &lt;textarea name=\"Contact[Message]\"&gt;For this message&lt;/textarea&gt;\n  &lt;button type=\"submit\"&gt;Submit&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>In PHP I would simple use this to get the data:</p>\n\n<pre><code>&lt;?php \n   print_r($_POST[\"Contact\"])\n?&gt;\n// Output would be something like this:\nArray\n(\n    [Name] =&gt; Something\n    [Email] =&gt; Else\n    [Message] =&gt; For this message\n)\n</code></pre>\n\n<p>BUT in go... either I get one by one or the whole thing but not the Contact[] Array only such as PHP</p>\n\n<p>I thought about 2 solutions:</p>\n\n<p>1) Get one by one:</p>\n\n<pre><code>// r := *http.Request\nerr := r.ParseForm()\n\nif err != nil {\n    w.Write([]byte(err.Error()))\n    return\n}\n\ncontact := make(map[string]string)\n\ncontact[\"Name\"] = r.PostFormValue(\"Contact[Name]\")\ncontact[\"Email\"] = r.PostFormValue(\"Contact[Email]\")\ncontact[\"Message\"] = r.PostFormValue(\"Contact[Message]\")\n\nfmt.Println(contact)\n\n// Output\nmap[Name:Something Email:Else Message:For this Message]\n</code></pre>\n\n<p>Note that the map keys are the whole: \"Contact[Name]\"...</p>\n\n<p>2) Range whole map <code>r.Form</code> and \"parse|obtain\" those values with Prefix \n\"Contact[\" and then replacing \"Contact[\" and \"]\" with empty string \nso I can get the Form array Key only such the PHP Example</p>\n\n<p>I went for this work around by my own but... ranging over the whole form may not be a good idea (?)</p>\n\n<pre><code>// ContactPost process the form sent by the user\nfunc ContactPost(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n    err := r.ParseForm()\n\n    if err != nil {\n        w.Write([]byte(err.Error()))\n        return\n    }\n\n    contact := make(map[string]string)\n\n   for i := range r.Form {\n       if strings.HasPrefix(i, \"Contact[\") {\n           rp := strings.NewReplacer(\"Contact[\", \"\", \"]\", \"\")\n           contact[rp.Replace(i)] = r.Form.Get(i)\n       }\n   }\n\n    w.Write([]byte(fmt.Sprint(contact)))\n}\n//Output\nmap[Name:Something Email:Else Message:For this Message]\n</code></pre>\n\n<p>Both solutions give me the same output... But in the 2nd example I don't necessarily need to know the keys of \"Contact[]\"</p>\n\n<p>I know... I may just forget about that \"Form Array\" and use <code>name=\"Email\"</code> on my inputs and retrieve one by one but... I've passing through some scenarios where I use ONE form that contain more than 2 arrays of data and do different things with each one, like ORMs</p>\n\n<p><strong>Question 1</strong>: Is there a easier way to get my Form Array as an actual map in Golang like PHP does?</p>\n\n<p><strong>Question 2</strong>: Should I retrieve the data one by one (Tedious as much and I may change the Form data at some point and recompile...) or iterate the whole thing as I've done in the 2nd example.</p>\n\n<p>Sorry for my bad English... Thanks in advance!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1453043906, "post_id": 34839856, "comment_id": 57420606, "body": "This does not handle multi-byte unicode characters. Try <code>s := &quot;\u65e5\u672c\u8a9e&quot;</code>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1453045524, "post_id": 34839856, "comment_id": 57421102, "body": "@FilipHaglund: Fixed."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1453045633, "post_id": 34839856, "comment_id": 57421134, "body": "Nice, i was thinking of using range, but didn&#39;t think of obly using the index to avoid copying the string."}, {"owner": {"reputation": 1995, "user_id": 473249, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e40b77e8148e074c95c189d98f40022b?s=128&d=identicon&r=PG&f=1", "display_name": "fazy", "link": "https://stackoverflow.com/users/473249/fazy"}, "edited": false, "score": 0, "creation_date": 1453048462, "post_id": 34839856, "comment_id": 57422095, "body": "Awesome, thanks! I guess <code>if len(s) &gt; max</code> is an optimisation (see <a href=\"https://play.golang.org/p/P0fM6PNQYN\" rel=\"nofollow noreferrer\">play.golang.org/p/P0fM6PNQYN</a>) but worth keeping. It still seems like a lot of work in Go, but I&#39;ve found the <a href=\"https://github.com/huandu/xstrings\" rel=\"nofollow noreferrer\">xstrings library</a> so will give that a try if I need this kind of thing often."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1453046396, "last_edit_date": 1453046396, "creation_date": 1453043322, "answer_id": 34839856, "question_id": 34839659, "link": "https://stackoverflow.com/questions/34839659/how-can-i-easily-get-a-substring-in-go-while-guarding-against-slice-bounds-out/34839856#34839856", "title": "How can I easily get a substring in Go while guarding against &quot;slice bounds out of range&quot; error?", "body": "<p>Use a simple function to hide the implementation details. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc maxString(s string, max int) string {\n    if len(s) &gt; max {\n        r := 0\n        for i := range s {\n            r++\n            if r &gt; max {\n                return s[:i]\n            }\n        }\n    }\n    return s\n}\n\nfunc main() {\n    s := \"\u65e5\u672c\u8a9e\"\n    fmt.Println(s)\n    fmt.Println(maxString(s, 2))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u65e5\u672c\u8a9e\n\u65e5\u672c\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1995, "user_id": 473249, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e40b77e8148e074c95c189d98f40022b?s=128&d=identicon&r=PG&f=1", "display_name": "fazy", "link": "https://stackoverflow.com/users/473249/fazy"}, "edited": false, "score": 0, "creation_date": 1453048754, "post_id": 34839874, "comment_id": 57422195, "body": "Thanks. I hadn&#39;t thought of unicode issues TBH. This is also a good solution, in case the original string isn&#39;t needed."}], "tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": false, "score": 2, "last_activity_date": 1453044733, "last_edit_date": 1453044733, "creation_date": 1453043425, "answer_id": 34839874, "question_id": 34839659, "link": "https://stackoverflow.com/questions/34839659/how-can-i-easily-get-a-substring-in-go-while-guarding-against-slice-bounds-out/34839874#34839874", "title": "How can I easily get a substring in Go while guarding against &quot;slice bounds out of range&quot; error?", "body": "<p>Assuming you want to keep at most <code>maxLen</code> characters, i.e. what your code says, rather than what your string says. </p>\n\n<p>If you don't need the original myString, you can overwrite it like this:</p>\n\n<pre><code>const maxLen = 100\n\nfunc main() {\n    myString := \"This string might be longer, so we'll keep the first 100 bytes.\"\n\n    if len(myString) &gt;= maxLen {\n        myString = myString[:maxLen] // slicing is a constant time operation in go\n    }\n\n    fmt.Println(myString) // Prints the first 100 bytes, or the whole string if shorter\n}\n</code></pre>\n\n<p>This might cut unicode characters in half, leaving some garbage at the end. If you need to handle multi-byte unicode, which you probably do, try this:</p>\n\n<pre><code>func main() {\n    myString := \"\u65e5\u672c\u8a9e\"\n\n    mid := maxLen\n    for len(myString) &gt;= mid &amp;&amp; utf8.ValidString(myString[:mid]) == false {\n        mid++ // add another byte from myString until we have a whole multi-byte character\n    }\n    if len(myString) &gt; mid {\n        myString = myString[:mid]\n    }\n\n    fmt.Println(myString) // Prints the first 100 bytes, or the whole string if shorter\n}\n</code></pre>\n\n<p>Or, if you can accept removing up to one character from the output, this version is a bit cleaner</p>\n\n<pre><code>func main() {\n    myString := \"\u65e5\u672c\u8a9e\"\n\n    for len(myString) &gt;= maxLen || utf8.ValidString(myString) == false {\n        myString = myString[:len(myString)-1] // remove a byte\n    }\n\n    fmt.Println(myString) // Prints the first 100 bytes, or the whole string if shorter\n}\n</code></pre>\n"}], "owner": {"reputation": 1995, "user_id": 473249, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e40b77e8148e074c95c189d98f40022b?s=128&d=identicon&r=PG&f=1", "display_name": "fazy", "link": "https://stackoverflow.com/users/473249/fazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 1, "accepted_answer_id": 34839856, "answer_count": 2, "score": 2, "last_activity_date": 1453046396, "creation_date": 1453042151, "question_id": 34839659, "link": "https://stackoverflow.com/questions/34839659/how-can-i-easily-get-a-substring-in-go-while-guarding-against-slice-bounds-out", "title": "How can I easily get a substring in Go while guarding against &quot;slice bounds out of range&quot; error?", "body": "<p>Using Go, I want to truncate long strings to an arbitrary length (e.g. for logging).</p>\n\n<pre><code>const maxLen = 100\n\nfunc main() {\n    myString := \"This string might be longer, so we'll keep all except the first 100 bytes.\"\n\n    fmt.Println(myString[:10])      // Prints the first 10 bytes\n    fmt.Println(myString[:maxLen])  // panic: runtime error: slice bounds out of range\n}\n</code></pre>\n\n<p>For now, I can solve it with an extra variable and <code>if</code> statement, but that seems very long-winded:</p>\n\n<pre><code>const maxLen = 100\n\nfunc main() {\n    myString := \"This string might be longer, so we'll keep all except the first 100 bytes.\"\n\n    limit := len(myString)\n    if limit &gt; maxLen {\n        limit = maxLen\n    }\n\n    fmt.Println(myString[:limit]) // Prints the first 100 bytes, or the whole string if shorter\n}\n</code></pre>\n\n<p>Is there a shorter/cleaner way?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453048984, "post_id": 34839113, "comment_id": 57422277, "body": "You&#39;re passing a slice of <code>int</code> (which might be an int32 or int64 depending on the system), and interpreting them as <code>GLfloat</code>. Because you&#39;re using <code>unsafe</code> you need to be absolutely sure your types match."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 0, "last_activity_date": 1453042068, "last_edit_date": 1453042068, "creation_date": 1453041316, "answer_id": 34839515, "question_id": 34839113, "link": "https://stackoverflow.com/questions/34839113/how-can-i-pass-go-arrays-to-c/34839515#34839515", "title": "How can I pass Go arrays to C?", "body": "<p>That's correct for an array, but here you have a go slice. Use the address of the first element to get the address of the underlying array</p>\n\n<pre><code>ptr := unsafe.Pointer(&amp;test[0])\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 3318040, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/5b295dd3671f965c2ad052d2b6956ea9?s=128&d=identicon&r=PG&f=1", "display_name": "Gippeumi", "link": "https://stackoverflow.com/users/3318040/gippeumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 34839515, "answer_count": 1, "score": 0, "last_activity_date": 1453042068, "creation_date": 1453038808, "question_id": 34839113, "link": "https://stackoverflow.com/questions/34839113/how-can-i-pass-go-arrays-to-c", "title": "How can I pass Go arrays to C?", "body": "<p>I was struggling with OpenGL ES. It didn't worked well.\nAnd I got similar thing working in C.(I just copied Go code and modified(syntax) and removed(non-important function call) some things for C.)</p>\n\n<p>I finally found that Go arrays were not passed to C function.(So, arrays as vertex array, indices couldn't be passed well and did something wrong when I render.)</p>\n\n<p>I tested with this code:</p>\n\n<p>C function part:</p>\n\n<pre><code>void passTest(void *Ptr){\n    int *test = (GLfloat *)Ptr;\n    printf(\"C: test=%p\\n\", test);\n    printf(\"C: test[0]=%d\\ntest[1]=%d\\ntest[2]=%d\\ntest[3]=%d\\n\", test[0], test[1], test[2], test[3]);\n}\n</code></pre>\n\n<p>And this is Go part:</p>\n\n<pre><code>test := []int{ 0, 3, 9, 81018 }\nvar ptr unsafe.Pointer = (unsafe.Pointer)(&amp;test)\nfmt.Printf(\"Go: test=%p\\n\", ptr)\nfmt.Printf(\"Go: test[0]=%d\\ntest[1]=%d\\ntest[2]=%d\\ntest[3]=%d\\n\", test[0], test[1], test[2], test[3])\nC.passTest(ptr)\n</code></pre>\n\n<p>Result is:</p>\n\n<pre><code>Go: test=0x10300010\nGo: test[0]=0\ntest[1]=3\ntest[2]=9\ntest[3]=81018\nC: test=0x10300010\nC: test[0]=271581216\ntest[1]=4\ntest[2]=4\ntest[3]=0\n</code></pre>\n\n<p>As you can see, pointer value passed well. But, printed value is wrong.\nAm I doing something wrong with passing arrays to C?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1453041617, "post_id": 34839381, "comment_id": 57419811, "body": "But the former also has fewer bounds checks, and b might never leave a register.  You can&#39;t make any assumptions without benchmarking and / or inspecting the generated assembly."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453044038, "post_id": 34839381, "comment_id": 57420649, "body": "@JimB: Thanks for the input \u2013 again, the meaning of a split &quot;assume&quot; comes true. Since you were friendly enough not to down vote me, I&#39;d do it myself as an act of repentance, if it was possible."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1453058164, "post_id": 34839381, "comment_id": 57425754, "body": "FYI, the former is measurably faster on my machine with go1.6"}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1453040555, "creation_date": 1453040555, "answer_id": 34839381, "question_id": 34838862, "link": "https://stackoverflow.com/questions/34838862/golangwhich-way-is-more-efficient-about-using-for-range/34839381#34839381", "title": "Golang:which way is more efficient about using &quot;for range&quot;", "body": "<p>The former has more memory operations, namely on <code>b</code>: it is allocated in the first run of the loop and reassigned in each subsequent run in addition to <code>i</code> <em>and</em> the original slice is modified, whereas in the second example, only <code>i</code> is allocated and reassigned and used to make modifications to the original slice.</p>\n"}], "owner": {"reputation": 49, "user_id": 5797406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rO76N.jpg?s=128&g=1", "display_name": "rench", "link": "https://stackoverflow.com/users/5797406/rench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1453097818, "creation_date": 1453037441, "last_edit_date": 1453097818, "question_id": 34838862, "link": "https://stackoverflow.com/questions/34838862/golangwhich-way-is-more-efficient-about-using-for-range", "title": "Golang:which way is more efficient about using &quot;for range&quot;", "body": "<pre><code>type path []byte\n\nfunc (p path) ToUpper() {\n    for i, b := range p {\n        if 'a' &lt;= b &amp;&amp; b &lt;= 'z' {\n            p[i] = b + 'A' - 'a'\n        }\n    }\n}\n</code></pre>\n\n<p>in the above(this example is copy from \"The Go Blog\"), if ToUpper change like this:</p>\n\n<pre><code>func (p path) ToUpper() {\n    for i, _ := range p {\n        if 'a' &lt;= p[i] &amp;&amp; p[i] &lt;= 'z' {\n            p[i] = p[i] + 'A' - 'a'\n        }\n    }\n}\n</code></pre>\n\n<p>which will be more efficient </p>\n\n<p>WHY?</p>\n\n<p>\"The Go Blog\" says with the former one:\n\"Here the ToUpper method uses two variables in the for range construct to capture the index and slice element. This form of loop avoids writing p[i] multiple times in the body.\"</p>\n\n<p>what is mean?</p>\n"}, {"tags": ["go", "comparison-operators"], "comments": [{"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 3, "creation_date": 1453031788, "post_id": 34837805, "comment_id": 57416861, "body": "I think you mean <code>str == &quot;&quot;</code> rather than <code>len(str) != &quot;&quot;</code> (the last one is a syntax error)"}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1453111787, "post_id": 34837805, "comment_id": 57443844, "body": "Thanks, I just fixed :)"}], "answers": [{"tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": true, "score": 6, "last_activity_date": 1453033824, "last_edit_date": 1453033824, "creation_date": 1453030901, "answer_id": 34837911, "question_id": 34837805, "link": "https://stackoverflow.com/questions/34837805/lenstring-0-or-lenstring-1/34837911#34837911", "title": "len(string) == 0 or len(string) &lt; 1", "body": "<p>Since the empty string is the nil value of a string, you should compare against that. </p>\n\n<pre><code>str == \"\"\n</code></pre>\n\n<p>Checking variables against their nil values to see if they are empty is the Go way of doing this. </p>\n\n<p>In terms of performance, there's no notable difference. Using <code>len(str)</code> is a function call, so it should in theory be slower.</p>\n\n<p><strong>EDIT: Some evidence:</strong></p>\n\n<p>I benchmarked this code:</p>\n\n<pre><code>func BenchmarkNil(b *testing.B) {\n    str := \"asd\"\n    cnt := 0\n    for i := 0; i &lt; b.N; i++ {\n        if str == \"\" {\n            cnt++\n        }\n    }\n}\n</code></pre>\n\n<p>with the three different checks in the if-statement: <code>str == \"\"</code>, <code>len(str) == 0</code> and <code>len(str) &lt; 1</code>.</p>\n\n<pre><code>BenchmarkLenEq-8        2000000000               0.77 ns/op\nBenchmarkLenLess-8      2000000000               0.76 ns/op\nBenchmarkNil-8          2000000000               0.50 ns/op\n</code></pre>\n\n<p>For checking against an empty string (<code>str := \"\"</code> instead of <code>str := \"asd\"</code>), there is no measurable difference. Checking against a non-empty string takes more time, and there, the nil check is noticeably faster.</p>\n\n<pre><code>BenchmarkLenEq-8        2000000000               0.34 ns/op\nBenchmarkLenLess-8      2000000000               0.33 ns/op\nBenchmarkNil-8          2000000000               0.33 ns/op\n</code></pre>\n\n<p><strong>EDIT2:</strong>\nThe only thing you can do these days to be somewhat sure of how fast something is is to benchmark it. Modern CPU's are superscalar, so one clock cycle per instruction is simply not true anymore. The benchmark code comparing against the empty string ran at 2.94GHz (2.94*10^9 op/s) on my 4GHz 6700k, which is less than two clock cycles per loop iteration. The nil check against the non-empty string ran at 2GHz (2*10^9 op/s) on the same CPU. </p>\n\n<p>This means 2 cpu cycles per loop iteration on the nil check, and 3 on the len check, or a single instruction per loop iteration on the check against the empty string. </p>\n"}, {"tags": [], "owner": {"reputation": 4049, "user_id": 1133802, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c77d19fe400931dea2eb52303a851bb6?s=128&d=identicon&r=PG", "display_name": "mostruash", "link": "https://stackoverflow.com/users/1133802/mostruash"}, "is_accepted": false, "score": 0, "last_activity_date": 1453031628, "last_edit_date": 1495540751, "creation_date": 1453031628, "answer_id": 34838015, "question_id": 34837805, "link": "https://stackoverflow.com/questions/34837805/lenstring-0-or-lenstring-1/34838015#34838015", "title": "len(string) == 0 or len(string) &lt; 1", "body": "<p>If you check <a href=\"https://en.wikibooks.org/wiki/X86_Assembly/Control_Flow#Jump_on_Equality\" rel=\"nofollow noreferrer\">X86 Assembly control flows</a>, you see that there are jump on equality and jump on inequality instructions. So in theory and if you make some simple assumptions about Go compiler, <code>!=</code> and <code>&lt;</code> would perform the same (1 CPU clock). </p>\n\n<p>If you are really into it, you can see <a href=\"https://stackoverflow.com/questions/23789951/easy-to-read-golang-assembly-output\">this answer</a> and compare what assembly is produced for each of them.</p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 34837911, "answer_count": 2, "score": 2, "last_activity_date": 1453111628, "creation_date": 1453030123, "last_edit_date": 1453111628, "question_id": 34837805, "link": "https://stackoverflow.com/questions/34837805/lenstring-0-or-lenstring-1", "title": "len(string) == 0 or len(string) &lt; 1", "body": "<p>In <a href=\"https://golang.org/\" rel=\"nofollow\">Go</a>, to check if a string is empty this can be used:</p>\n\n<pre><code>len(str) == 0\n</code></pre>\n\n<p>or </p>\n\n<pre><code>len(str) &lt; 1\n</code></pre>\n\n<p>or </p>\n\n<pre><code>str == \"\"\n</code></pre>\n\n<p>Basically is just a meter of choosing an operator <code>==</code>, <code>&lt;</code>, <code>!=</code>, but in terms of performance wish option is better ?</p>\n\n<p>My guess is that <code>==</code> just compares and don't iterate through the values like <code>&lt;</code> or either <code>&lt;==</code> could do, therefore wondering what is the best approach practice for this.</p>\n"}, {"tags": ["ios", "xcode", "go", "app-store", "app-store-connect"], "comments": [{"owner": {"reputation": 5592, "user_id": 5234233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/vDRdy.jpg?s=128&g=1", "display_name": "Lumialxk", "link": "https://stackoverflow.com/users/5234233/lumialxk"}, "edited": false, "score": 0, "creation_date": 1453030159, "post_id": 34837776, "comment_id": 57416411, "body": "Sorry,as I konw,you can&#39;t load an .app to your iPhone(.ipa OK)."}, {"owner": {"reputation": 5592, "user_id": 5234233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/vDRdy.jpg?s=128&g=1", "display_name": "Lumialxk", "link": "https://stackoverflow.com/users/5234233/lumialxk"}, "edited": false, "score": 0, "creation_date": 1453030360, "post_id": 34837776, "comment_id": 57416462, "body": "2.You should make out info of app first."}], "answers": [{"tags": [], "owner": {"reputation": 448, "user_id": 2498983, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/730d1cba4bbb41ff5f30e3fe2311bea1?s=128&d=identicon&r=PG&f=1", "display_name": "Mirek", "link": "https://stackoverflow.com/users/2498983/mirek"}, "is_accepted": false, "score": 2, "last_activity_date": 1453035642, "creation_date": 1453035642, "answer_id": 34838596, "question_id": 34837776, "link": "https://stackoverflow.com/questions/34837776/how-will-i-able-to-upload-app-to-appstore-not-via-xcode/34838596#34838596", "title": "How will I able to upload *.app to Appstore not via Xcode?", "body": "<p>For submission part there is Apple tool called Application Loader. It is a part of Xcode, but I think can still be downloaded separately. It can deliver app to App Store without having to use Xcode Organiser interface.</p>\n\n<p>You need to deliver your app as .ipa file. If your .app is properly signed and contains a valid .mobileprovision (which is a different question), all you need to do is to create a new folder named \"Payload\", put copy your .app into ito it. Then you can rename the .zip file to .ipa and upload it using Application loader.</p>\n"}], "owner": {"reputation": 1554, "user_id": 335637, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/04a2900986f7e18c37a8c07774c025b6?s=128&d=identicon&r=PG", "display_name": "LIAL", "link": "https://stackoverflow.com/users/335637/lial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453035642, "creation_date": 1453029908, "question_id": 34837776, "link": "https://stackoverflow.com/questions/34837776/how-will-i-able-to-upload-app-to-appstore-not-via-xcode", "title": "How will I able to upload *.app to Appstore not via Xcode?", "body": "<p>I have application for iOS created on Go language, I compiled it to .app file. Can anyone tell me what should I do to:</p>\n\n<ol>\n<li>Load application to my iPhone</li>\n<li>Load application to iTunes connect (I loaded another via Xcode, but there are no objective c or swift code here to do so)</li>\n</ol>\n\n<p>PS: I have valid developer account, able to create any certificates that will need. Versions: XCode 7.2, iOS 9.2</p>\n\n<p>Thanks a lot for your help.</p>\n"}, {"tags": ["go", "code-coverage", "functional-testing"], "answers": [{"comments": [{"owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "edited": false, "score": 1, "creation_date": 1453039818, "post_id": 34838432, "comment_id": 57419220, "body": "the fact it is slow / bigger is not at all a problem as said, it&#39;s just the time the automated functionnal test are run, the integration tests / end to end are end are run with a normal build,  and <code>go test</code> only run the test in go, not the binary itself right?"}], "tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": false, "score": 0, "last_activity_date": 1453034511, "creation_date": 1453034511, "answer_id": 34838432, "question_id": 34837542, "link": "https://stackoverflow.com/questions/34837542/golang-generate-code-coverage-of-functional-test/34838432#34838432", "title": "golang generate code coverage of functional test", "body": "<p>You probably don't want to do that. Running code with coverage, race detection and/or other tools increases the binary size and makes it much slower. Running both the race detector and code coverage is 25 times slower on my computer.</p>\n\n<p>Simply use <code>go test -cover -race</code> for testing, and <code>go build</code> when deploying. This will give you the output you want, albeit not in exactly the way you wanted it.</p>\n"}, {"tags": [], "owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "is_accepted": true, "score": 4, "last_activity_date": 1453045711, "creation_date": 1453045711, "answer_id": 34840266, "question_id": 34837542, "link": "https://stackoverflow.com/questions/34837542/golang-generate-code-coverage-of-functional-test/34840266#34840266", "title": "golang generate code coverage of functional test", "body": "<p>Based on <a href=\"https://www.elastic.co/blog/code-coverage-for-your-golang-system-tests\" rel=\"nofollow\">this post</a>   here's what I did:</p>\n\n<ol>\n<li><p>created a <code>main_test.go</code> with this content:</p>\n\n<pre><code>package main\n\n// code based on technique explained here:\n// https://www.elastic.co/blog/code-coverage-for-your-golang-system-tests\n// you can look there if you want to see how not to execute this test\n// when running unit test etc.\n\n// This file is mandatory as otherwise the packetbeat.test binary is not generated correctly.\n\nimport (\n    \"testing\"\n)\n\n// Test started when the test binary is started. Only calls main.\nfunc TestSystem(t *testing.T) {\n    main()\n}\n</code></pre></li>\n<li><p>as it was a web services (and hence in an infinite loop), I needed a way to gracefully exit on SIGTERM (without it being considered a failure), so I used the package <code>go get gopkg.in/tylerb/graceful.v1</code> and replaced (I use <code>go-restful</code>) in main.go the line </p>\n\n<pre><code>    -       log.Fatal(http.ListenAndServe(\":\"+port, nil))\n    +       graceful.Run(\":\"+port, 10*time.Second, nil)\n</code></pre></li>\n<li><p>then I would run the test like this</p>\n\n<ul>\n<li><code>go test -c -covermode=count -coverpkg ./...  -o foo.test</code></li>\n<li><code>./foo.test -test.coverprofile coverage.cov &amp; echo $! &gt; /tmp/test.pid</code></li>\n<li>run my test suite</li>\n<li><code>kill \"$(cat /tmp/test.pid)\"</code></li>\n</ul></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 241, "user_id": 5057547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fb9c52f95ea216ae3f951e24e3deed?s=128&d=identicon&r=PG&f=1", "display_name": "CarlJi", "link": "https://stackoverflow.com/users/5057547/carlji"}, "is_accepted": false, "score": 0, "last_activity_date": 1591521555, "creation_date": 1591521555, "answer_id": 62243303, "question_id": 34837542, "link": "https://stackoverflow.com/questions/34837542/golang-generate-code-coverage-of-functional-test/62243303#62243303", "title": "golang generate code coverage of functional test", "body": "<p><code>go test -c -cover</code> solution has some disadvantages like the service under tests must be stopped when to generate the code coverage profile. and it would also inject some unnecessary flags into the covered binary like \"-test.v\", which may break the service's original starting way.</p>\n\n<p>We use <a href=\"https://github.com/qiniu/goc\" rel=\"nofollow noreferrer\">goc</a> instead, it help us collect code coverage of system tests (API tests or e2e tests) at runtime easily, i think it's more elegant.</p>\n"}], "owner": {"reputation": 3170, "user_id": 1185460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CREfl.png?s=128&g=1", "display_name": "allan.simon", "link": "https://stackoverflow.com/users/1185460/allan-simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1971, "favorite_count": 0, "accepted_answer_id": 34840266, "answer_count": 3, "score": 3, "last_activity_date": 1591521555, "creation_date": 1453028334, "question_id": 34837542, "link": "https://stackoverflow.com/questions/34837542/golang-generate-code-coverage-of-functional-test", "title": "golang generate code coverage of functional test", "body": "<p>I have a go webservices (a REST Api) for which we have unit test, and for which go cover works fine.</p>\n\n<p>Now we have a test suite written in python that launch a instance of the server, run the test , stop the server.</p>\n\n<p>I would like to know if there's some tools that would permit me to run my server binary with a specific flag , so that at the end it prints coverage of the tests executed by my \"blackbox\" testing ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "coreos", "etcd"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1453065215, "post_id": 34835836, "comment_id": 57428201, "body": "Everything is possible. Usually when you prefer to have fixed keys, you decide to put the data into struct. When keys are not fixed, than you choose map[string]X and X depends on members. In your case - map[string]map[string]int would be enough. But when you don&#39;t want to fix depth - it will be map[string]interface{}. And only small notice - please try to think whether you really need so flexible data structure."}, {"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1453065806, "post_id": 34835836, "comment_id": 57428407, "body": "So, the &#39;key&#39; field needs to have Dir: true in set options and the value can be a struct?"}, {"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1453190151, "post_id": 34835836, "comment_id": 57480864, "body": "So, the Dir: true in the client is useful for creating directories. However I still have to make 2 calls for creating directories, and 4 calls for creating the keys. Anyway that this can be done all together?"}], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1453190019, "post_id": 34871227, "comment_id": 57480787, "body": "I have to use the etcd golang client, not the CLI"}, {"owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "reply_to_user": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 1, "creation_date": 1453190443, "post_id": 34871227, "comment_id": 57481027, "body": "then read the code and you will find it: <code>mkdirCommandFunc(c, mustNewKeyAPI(c), client.PrevIgnore)</code>"}, {"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1453190536, "post_id": 34871227, "comment_id": 57481076, "body": "Is there a single etcd api call I can make apart from using 4 different calls to get this structure?"}, {"owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "reply_to_user": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1453190572, "post_id": 34871227, "comment_id": 57481094, "body": "consider etcdctl to be the &#39;demo&#39; of the etcd client: it does all the client can do."}, {"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1453190646, "post_id": 34871227, "comment_id": 57481129, "body": "Thats an idea. I will look into whether a single etcdctl command can take multiple key values as input and write to the datastore or not."}, {"owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "reply_to_user": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1453224284, "post_id": 34871227, "comment_id": 57504006, "body": "you cannot read/ write multiple keys unless you&#39;re just listing directories (with <code>ls --recursive</code>) but you can save your whole structure as one object and pull it back as one object in one call. then parse the structure in your code."}, {"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1453272850, "post_id": 34871227, "comment_id": 57524141, "body": "Can you please elaborate on how can I save and retrieve entire object in one call?"}, {"owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "reply_to_user": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 1, "creation_date": 1453273287, "post_id": 34871227, "comment_id": 57524314, "body": "the key is a string, the value is a string: you can put anything you want there as long as it&#39;s a string... so JSON is a string, and you can put your json string there like anything else. when you need it back you pull the json string and parse it."}, {"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1453274006, "post_id": 34871227, "comment_id": 57524649, "body": "Thanks. I didn&#39;t think of it that way. I will do that."}, {"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1453401531, "post_id": 34871227, "comment_id": 57596278, "body": "can you please post your up-voted comment as an answer and I will accept it. Thanks. That really helped."}], "tags": [], "owner": {"reputation": 14729, "user_id": 2494262, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4a9b1f56d8fca99b42c3cf56affb943b?s=128&d=identicon&r=PG", "display_name": "MrE", "link": "https://stackoverflow.com/users/2494262/mre"}, "is_accepted": true, "score": -2, "last_activity_date": 1453403183, "last_edit_date": 1453403183, "creation_date": 1453189928, "answer_id": 34871227, "question_id": 34835836, "link": "https://stackoverflow.com/questions/34835836/how-to-create-a-directory-node-using-the-golang-etcd-client/34871227#34871227", "title": "How to create a directory node using the golang etcd client?", "body": "<p>to create a directory</p>\n\n<p><code>etcdctl mkdir &lt;my_dir&gt;</code></p>\n\n<p>to do what you want, there is this option:</p>\n\n<p><code>etcdctl set myobject '{\"a\":[\"b\":1, \"c\":2],\"x\":[\"y\":3, \"z\":4]}'</code> </p>\n\n<p>will save the json as an object that you can pull back in one call (with <code>get</code>)</p>\n\n<p>the key is a string, the value is a string: so you can put anything you want there as long as it's a string... so JSON is a string, and you can put your json string there like anything else. </p>\n\n<p>when you need it back you pull the json string and parse it. </p>\n"}], "owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1178, "favorite_count": 0, "accepted_answer_id": 34871227, "answer_count": 1, "score": 0, "last_activity_date": 1453403183, "creation_date": 1453012791, "last_edit_date": 1453030687, "question_id": 34835836, "link": "https://stackoverflow.com/questions/34835836/how-to-create-a-directory-node-using-the-golang-etcd-client", "title": "How to create a directory node using the golang etcd client?", "body": "<p>I would preferably like to have a structure like this in json:</p>\n\n<pre><code>{\n\"a\":[\"b\":1, \"c\":2],\n\"x\":[\"y\":3, \"z\":4]\n}\n</code></pre>\n\n<p>I can work with \"a\" &amp; \"x\" as directories &amp; have nodes under them to store data. I cannot find it in the documentation or example of how to get this done.</p>\n\n<p>EDIT: I just created it as a directory by calling the /a/b, /a/c, /x/y &amp; /x/z for Set. This creates the necessary structure, but am looking for a simplified version perhaps to do the same, instead of 4 etcd calls.</p>\n"}, {"tags": ["go", "idioms"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453001897, "post_id": 34834261, "comment_id": 57410991, "body": "A function that returns nothing in go is just that. There&#39;s no name for it, because it&#39;s nothing special in itself."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1453001617, "post_id": 34834395, "comment_id": 57410943, "body": "The go language is pretty much done as you see it, and changes have an extremely high bar to be accepted. Making an exception to the language spec to essentially save a new line character isn&#39;t likely to be accepted."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1453010514, "post_id": 34834395, "comment_id": 57412290, "body": "@JimB: Go allows an empty return. It just doesn&#39;t allow returning the empty return from another function. This doesn&#39;t seem like a big change to me. Could at least try and see if the change could be done."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4888, "user_id": 947478, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c5cd23c47d911ce446c57c658f22f10?s=128&d=identicon&r=PG&f=1", "display_name": "HellaMad", "link": "https://stackoverflow.com/users/947478/hellamad"}, "edited": false, "score": 1, "creation_date": 1453051963, "post_id": 34834395, "comment_id": 57423391, "body": "@DC_: A <a href=\"https://golang.org/ref/spec#Return_statements\" rel=\"nofollow noreferrer\">return statement</a> may contain 0 or more <a href=\"https://golang.org/ref/spec#Expressions\" rel=\"nofollow noreferrer\">expressions</a>. An expression results in a <i>value</i> by definition. Also in the spec: &quot;In a function without a result type, a &quot;return&quot; statement must not specify any result values&quot;. Even minor language changes may have unintended consequences that need to be maintained for the life of the language, and it could be a large price to pay to condense 2 lines into one (note that proposals like combining for+select to save a line have been rejected too)"}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 0, "last_activity_date": 1452997008, "creation_date": 1452997008, "answer_id": 34834395, "question_id": 34834261, "link": "https://stackoverflow.com/questions/34834261/return-void-function-with-result-of-another-void-function/34834395#34834395", "title": "Return void function with result of another void function?", "body": "<p>C++ allows this. It is very handy for templates.</p>\n\n<p>But as you see Go does not. I am not sure of the exact steps, but this seems like something you could ask to be added to Go, perhaps it could make it in for 1.7.</p>\n\n<p>As for a solution right now, perhaps you could return a unused <code>error</code>. Just return it as <code>nil</code> from your <code>Error</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 5770592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/353dede534c99f20a869153dbb0ebb3d?s=128&d=identicon&r=PG&f=1", "display_name": "G&#252;nther Wutz", "link": "https://stackoverflow.com/users/5770592/g%c3%bcnther-wutz"}, "is_accepted": false, "score": 0, "last_activity_date": 1453034230, "creation_date": 1453034230, "answer_id": 34838372, "question_id": 34834261, "link": "https://stackoverflow.com/questions/34834261/return-void-function-with-result-of-another-void-function/34838372#34838372", "title": "Return void function with result of another void function?", "body": "<p>I am not sure but i would do it with the if-else fashion</p>\n\n<pre><code>func HandleSomething(w http.ResponseWriter, r *http.Request) {\n  if someCondition != true {\n    Error(w, 500, \"Some error occurred!\")\n  } else if someOtherCondition != true {\n    Error(w, 500, \"Some other error occurred!\")\n  } else if yetAnotherCondition != true {\n    Error(w, 500, \"Yet another error occurred!\")\n  } else if andFinallyOneLastCondition != true {\n    Error(w, 500, \"One final error occurred!\")\n  } else {\n    // All good! Send back some real data.\n    w.WriteJson(someObject)\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 4888, "user_id": 947478, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1c5cd23c47d911ce446c57c658f22f10?s=128&d=identicon&r=PG&f=1", "display_name": "HellaMad", "link": "https://stackoverflow.com/users/947478/hellamad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3058, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1453227886, "creation_date": 1452995745, "last_edit_date": 1452997310, "question_id": 34834261, "link": "https://stackoverflow.com/questions/34834261/return-void-function-with-result-of-another-void-function", "title": "Return void function with result of another void function?", "body": "<p>I'm trying to come up with a very compact way of handling problems that may arise in HTTP requests for a REST API. </p>\n\n<p>There are many conditions that I need to test for, and many potential error responses for the failure of any of these conditions.</p>\n\n<p>I've gotten my handling flow down to something that looks similar to the following:</p>\n\n<pre><code>// Error is actually a method on some struct, so it's only relevant for demonstration purposes.\nfunc Error(w http.ResponseWriter, status int, message string) {\n  // Lots of stuff omitted\n  w.WriteHeader(status)\n  w.WriteJson(r)\n}\n\nfunc HandleSomething(w http.ResponseWriter, r *http.Request) {\n  if someCondition != true {\n    Error(w, 500, \"Some error occurred!\")\n    return\n  }\n  if someOtherCondition != true {\n    Error(w, 500, \"Some other error occurred!\")\n    return\n  }\n  if yetAnotherCondition != true {\n    Error(w, 500, \"Yet another error occurred!\")\n    return\n  }\n  if andFinallyOneLastCondition != true {\n    Error(w, 500, \"One final error occurred!\")\n    return\n  }\n  // All good! Send back some real data.\n  w.WriteJson(someObject)\n}\n</code></pre>\n\n<p>Since there are often 5-10 conditions that I need to test for, and other errors that can arise during other operations, it would be nice to be able to compact it to the following:</p>\n\n<pre><code>func HandleSomething(w http.ResponseWriter, r *http.Request) {\n  if someCondition != true {\n    return Error(w, 500, \"Some error occurred!\")\n  }\n  if someOtherCondition != true {\n    return Error(w, 500, \"Some other error occurred!\")\n  }\n  if yetAnotherCondition != true {\n    return Error(w, 500, \"Yet another error occurred!\")\n  }\n  if andFinallyOneLastCondition != true {\n    return Error(w, 500, \"One final error occurred!\")\n  }\n  // All good! Send back some real data.\n  w.WriteJson(someObject)\n}\n</code></pre>\n\n<p>However, the Go compiler doesn't like this.</p>\n\n<p>It complains both that I'm trying to use the result of <code>Error()</code> as a value, and that I'm trying to return too many arguments. The exact error messages are:</p>\n\n<pre><code>foo.go:41: bar.Response.Error(400, \"InvalidRequest\", \"Error decoding request\") used as value\nfoo.go:41: too many arguments to return\n</code></pre>\n\n<p>But both <code>Error()</code> and <code>HandleSomething()</code> have the same return signature (e.g. they both return nothing), so shouldn't this work?</p>\n\n<p>It's important that each <code>if</code> statement contains a <code>return</code>, because the function should be exited immediately. If <code>Error()</code> could somehow stop the execution of the calling function, that would also work for me. Sort of like <code>testing.FailNow()</code>, but I believe that relies on Goroutines. </p>\n\n<p><em>As an aside: I realize that these aren't really \"void\" functions, but couldn't think of a more appropriate name. Is there a proper name for functions that return nothing in Go?</em></p>\n"}, {"tags": ["caching", "go", "go-html-template"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1452976156, "post_id": 34831763, "comment_id": 57405145, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28830543/how-to-use-a-field-of-struct-or-variable-value-as-template-name\">How to use a field of struct or variable value as template name?</a>"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1452981657, "post_id": 34831763, "comment_id": 57406839, "body": "Go 1.6 will allow you to redefine blocks as per <a href=\"https://tip.golang.org/doc/go1.6#template\" rel=\"nofollow noreferrer\">tip.golang.org/doc/go1.6#template</a> - currently you can &#39;cheat&#39; this with a bit of extra wrangling: <a href=\"http://elithrar.github.io/article/approximating-html-template-inheritance/\" rel=\"nofollow noreferrer\">elithrar.github.io/article/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "is_accepted": false, "score": 0, "last_activity_date": 1453950848, "creation_date": 1453950848, "answer_id": 35052214, "question_id": 34831763, "link": "https://stackoverflow.com/questions/34831763/golang-multiple-template-caching/35052214#35052214", "title": "Golang multiple template caching", "body": "<p>I believe elithrar has what you are looking for, but unfortunately it's not currently supported.  The typical way of handling this problem would be defining your header and footer in their own templates and doing the inverse of your approach.  And you can pass the struct being given to the template parser into those templates to render your pages.</p>\n\n<pre><code>{{define \"header\"}}\n&lt;html&gt;...\n{{end}}\n\n{{define \"footer\"}}\n...&lt;/html&gt;\n{{end}}\n\n{{define \"Content\"}}\n{{template \"header\" .}}\nHTML\n{{template \"footer\" .}}\n{{end}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 3904614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0a0780a21d417b70994c7f8072295e?s=128&d=identicon&r=PG&f=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/3904614/zack"}, "is_accepted": false, "score": 0, "last_activity_date": 1476146596, "creation_date": 1476146596, "answer_id": 39968840, "question_id": 34831763, "link": "https://stackoverflow.com/questions/34831763/golang-multiple-template-caching/39968840#39968840", "title": "Golang multiple template caching", "body": "<p>How are you parsing your templates? You can't have two templates with the same name in the same template tree. However, you could create a custom parsing function that will only add one template named \"Content\"  to your template tree. </p>\n\n<p>Example: <a href=\"https://play.golang.org/p/35X3i_jPzS\" rel=\"nofollow\">https://play.golang.org/p/35X3i_jPzS</a></p>\n"}], "owner": {"reputation": 397, "user_id": 2791236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUsEw.jpg?s=128&g=1", "display_name": "Sune", "link": "https://stackoverflow.com/users/2791236/sune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1153, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476146596, "creation_date": 1452975890, "question_id": 34831763, "link": "https://stackoverflow.com/questions/34831763/golang-multiple-template-caching", "title": "Golang multiple template caching", "body": "<p>Is it possible to render multiple html templates with the same name in golang. The reason is, that i want to make a layout and reuse it for multiple views. For example:</p>\n\n<pre><code>{{define \"MainLayout\"}}\n&lt;html&gt;\n\n  &lt;head&gt;\n    &lt;title&gt;{{.Title}}&lt;/title&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n\n    &lt;div&gt;{{template \"Content\" .}}&lt;/div&gt;\n\n  &lt;/body&gt;\n\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>Content could be different templates, that all are defined by {{define \"Content\"}}</p>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1452974506, "post_id": 34831396, "comment_id": 57404609, "body": "Simplest and recommended solution is to use another channel that <code>main</code> will block on and receive a result of the operation."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1452974938, "post_id": 34831396, "comment_id": 57404735, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/32383063/shutdown-worker-go-routine-after-buffer-is-empty\">Shutdown \u201cworker\u201d go routine after buffer is empty</a>"}, {"owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1453011903, "post_id": 34831396, "comment_id": 57412503, "body": "@icza : I agree partly; that question involves a simpler (sort-of star) topology. In my case, only the last goroutine in the pipe must signal shutdown, <i>once it knows it&#39;s last</i> . I think I&#39;m close to the final answer, which I&#39;ll end up posting here. BTW delightful constructs to use!"}, {"owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1453011981, "post_id": 34831396, "comment_id": 57412518, "body": "@creker : Thank you. That&#39;s helped me to see how I have to solve the problem, so if you care to post as an answer, I&#39;ll accept. I also plan to post the result as my own answer."}], "answers": [{"tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": false, "score": 2, "last_activity_date": 1452980904, "last_edit_date": 1452980904, "creation_date": 1452979563, "answer_id": 34832318, "question_id": 34831396, "link": "https://stackoverflow.com/questions/34831396/what-is-an-elegant-way-to-shut-down-a-chain-of-goroutines-linked-by-channels/34832318#34832318", "title": "What is an elegant way to shut down a chain of goroutines linked by channels?", "body": "<p><strong>As for your title question, killing worker goroutines when you don't need them anymore:</strong>\nYou could use the Done idiom. Reads from a closed channel yield the zero value. </p>\n\n<p>Make a new channel <code>done</code>. When reads from this channel succeed, the goroutines know they should quit. Close the channel in main when you have all the values you need.</p>\n\n<p>Check if you can read from a channel <code>done</code>, and exit by returning, or read from next when that's available. This partially replaces the assignment to <code>next</code> in you for loop:</p>\n\n<pre><code>select {\ncase &lt;-done:\nreturn\ncase next = &lt;- inch:\n}\n</code></pre>\n\n<p>Ranging over a channel also works, since closing that channel exits the loop.</p>\n\n<p><strong>As for the reverse, your body question, waiting for a set of goroutines to finish:</strong></p>\n\n<p>Use <code>sync.WaitGroup</code>. </p>\n\n<pre><code>var wg sync.WaitGroup\nwg.Add(goroutineCount)\n</code></pre>\n\n<p>And when each goroutine finishes:</p>\n\n<pre><code>wg.Done()\n</code></pre>\n\n<p>Or use defer:</p>\n\n<pre><code>defer wg.Done()\n</code></pre>\n\n<p>To wait for all of them to report as Done:</p>\n\n<pre><code>wg.Wait()\n</code></pre>\n\n<p>In your example, simply call <code>wg.Add(1)</code> when you start a new goroutine, before you call <code>wg.Done()</code> and return. As long as you only reach zero once, <code>wg.Wait()</code> works as expected, so <code>wg.Add(1)</code> before <code>wg.Done</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 4337190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35203e1a7bb6f9b68ebefcd6713cba5d?s=128&d=identicon&r=PG&f=1", "display_name": "maurice", "link": "https://stackoverflow.com/users/4337190/maurice"}, "edited": false, "score": 0, "creation_date": 1453100833, "post_id": 34836565, "comment_id": 57437903, "body": "In sieve(), you define a local &#39;start&#39; variable by using the &#39;:=&#39; syntax. That means each sieve goproc you invoke will think it is the starting proc."}, {"owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "reply_to_user": {"reputation": 171, "user_id": 4337190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35203e1a7bb6f9b68ebefcd6713cba5d?s=128&d=identicon&r=PG&f=1", "display_name": "maurice", "link": "https://stackoverflow.com/users/4337190/maurice"}, "edited": false, "score": 0, "creation_date": 1453135631, "post_id": 34836565, "comment_id": 57459009, "body": "@maurice Sorry, the name may have been badly chosen. The intent of the start variable is that it is local to each goroutine, and tells it whether or not it has completed startup by reading the first prime that makes it all the way down the pipe so far to this goroutine. Have I got that wrong? (I&#39;ve always been bad at choosing variable names.)"}, {"owner": {"reputation": 171, "user_id": 4337190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35203e1a7bb6f9b68ebefcd6713cba5d?s=128&d=identicon&r=PG&f=1", "display_name": "maurice", "link": "https://stackoverflow.com/users/4337190/maurice"}, "edited": false, "score": 0, "creation_date": 1453143019, "post_id": 34836565, "comment_id": 57463126, "body": "ah, I see now that you allow each goproc sieve to close the child input only if it spawned a child. Got it. Thx."}, {"owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "reply_to_user": {"reputation": 171, "user_id": 4337190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35203e1a7bb6f9b68ebefcd6713cba5d?s=128&d=identicon&r=PG&f=1", "display_name": "maurice", "link": "https://stackoverflow.com/users/4337190/maurice"}, "edited": false, "score": 0, "creation_date": 1453145778, "post_id": 34836565, "comment_id": 57464555, "body": "@maurice : Yes, that&#39;s it. All the &#171;goproc sieve&#187;s that have spawned a downstream instance close the channel to it; the last instance, which hasn&#39;t spawned, just closes the &#171;done&#187; channel to signal the main task to end."}], "tags": [], "owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "is_accepted": false, "score": 0, "last_activity_date": 1453020010, "last_edit_date": 1495540766, "creation_date": 1453020010, "answer_id": 34836565, "question_id": 34831396, "link": "https://stackoverflow.com/questions/34831396/what-is-an-elegant-way-to-shut-down-a-chain-of-goroutines-linked-by-channels/34836565#34836565", "title": "What is an elegant way to shut down a chain of goroutines linked by channels?", "body": "<p>After <a href=\"https://stackoverflow.com/users/1705598/icza\">@izca</a> unblocked my logjam, and after a few false starts involving deadlocks when everything finished, here's my solution working correctly:</p>\n\n<pre><code>// esieve implements a Sieve of Eratosthenes\n// as a series of channels connected together\n// by goroutines\npackage main\n\nimport \"fmt\"\n\nfunc sieve(mine int,                  // This instance's own prime\n           inch chan int,             // Input channel from lower primes\n           done chan int,             // Channel for signalling shutdown\n           count int) {               // Number of primes - counter\n    start := true                     // First-number switch\n    ouch := make(chan int)            // Output channel, this instance\n    fmt.Printf(\"%v \", mine)           // Print this instance's prime\n    for next := &lt;-inch; next &gt; 0; next = &lt;-inch { // Read input channel\n        if (next % mine) &gt; 0 {        // Divisible by my prime?\n            if start {                // No; first time through?\n                go sieve(next, ouch, done, count+1) // First number,\n                                                    // create instance for it\n                start = false         // First time done\n            } else {                  // Not first time\n                ouch &lt;- next          // Pass to next instance\n            }\n        }\n    }\n    if start {                        // Just starting?\n        close(done)                   // Yes - we're last in pipe - signal done\n        print(\"\\n\",count,\" primes\\n\") // Number of primes/goroutines\n    } else {\n        close(ouch)                   // No - send the signal down the pipe\n    }\n}\n\nfunc main() {\n    lim := 100                        // Let's do up to 100\n    done := make(chan int)            // Create the done return channel\n    ouch := make(chan int)            // Create the first segment of the pipe\n    go sieve(2, ouch, done, 1)        // Create the first instance for '2'\n    for prime := 3; prime &lt; lim; prime += 1 { // Generate odd numbers\n        ouch &lt;- prime                         // Send numbers down the pipe\n    }\n    close(ouch)                       // Send the done signal down the pipe\n    &lt;- done                           // and wait for it to come back\n}\n</code></pre>\n\n<p>I'm tremendously impressed with the elegance and simplicity of Go for this kind of programming, when compared with many other languages. Of course, the warts I claim for myself.</p>\n\n<p>If appropriate here, I'd welcome critical comments.</p>\n"}], "owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1453020010, "creation_date": 1452973914, "question_id": 34831396, "link": "https://stackoverflow.com/questions/34831396/what-is-an-elegant-way-to-shut-down-a-chain-of-goroutines-linked-by-channels", "title": "What is an elegant way to shut down a chain of goroutines linked by channels?", "body": "<p>I'm a Go learner. In order better to understand the care and feeding of channels and goroutines, I'm trying to build a Sieve of Eratosthenes as a set of goroutines connected into a pipeline by channels.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>// esieve implements a Sieve of Eratosthenes\n// as a series of channels connected together\n// by goroutines\npackage main\n\nimport \"fmt\"\n\nfunc sieve(mine int, inch chan int) {\n    start := true                        // First-number switch\n    ouch := make(chan int)               // Output channel for this instance\n    fmt.Printf(\"%v\\n\", mine)             // Print this instance's prime\n    for next := &lt;-inch; next &gt; 0; next = &lt;-inch {  // Read input channel\n        fmt.Printf(\"%v &lt;- %v\\n\",mine,next)         // (Trace)\n        if (next % mine) &gt; 0 {                     // Divisible by my prime?\n            if start {                   // No; is it the first number through? \n                go sieve(next, ouch)     // First number - create instance for it\n                start = false            // First time done\n            } else {                     // Not first time\n                ouch &lt;- next             // Pass it to the next instance\n            }\n        }\n    }\n}\n\nfunc main() {\n    lim := 30                     // Let's do up to 30\n    fmt.Printf(\"%v\\n\", 2)         // Treat 2 as a special case\n    ouch := make(chan int)        // Create the first segment of the pipe\n    go sieve(3, ouch)             // Create the instance for '3'\n    for prime := 3; prime &lt; lim; prime += 2 { // Generate 3, 5, ...\n        fmt.Printf(\"Send %v\\n\", prime)        // Trace\n        ouch &lt;- prime                         // Send it down the pipe\n    }\n}\n</code></pre>\n\n<p>And as far as it goes, it works nicely.</p>\n\n<p>However, when I finish the main loop, <code>main</code> exits before all the numbers still in the pipeline of <code>sieve</code> instances have propagated down to the end.</p>\n\n<p>What is the simplest, most elegant, or generally accepted way to make a main routine wait for a set of goroutines (about which it only 'knows' of the first one) to complete?</p>\n"}, {"tags": ["go", "static", "webserver"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1452971552, "post_id": 34830888, "comment_id": 57403607, "body": "Only the path <code>&#47;static</code> is handled by mux; any sub-paths are not. You&#39;ll have to tell mux to handle things matching <code>&#47;static&#47;*</code>."}, {"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1452971723, "post_id": 34830888, "comment_id": 57403669, "body": "I just tried changing the <code>Handle</code> call to <code>Handle(&quot;&#47;static&#47;.*&quot;, ...</code> and <code>Handle(&quot;&#47;static&#47;*&quot;, ...</code>. Neither worked."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1452971916, "post_id": 34830888, "comment_id": 57403728, "body": "<code>&#47;static&#47;{.*}</code> will work"}, {"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1452972022, "post_id": 34830888, "comment_id": 57403771, "body": "That worked! (Finally, after many hours). Make your comments into a proper answer so I can up-vote it and select it as the chosen one."}], "answers": [{"comments": [{"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 1, "creation_date": 1452972582, "post_id": 34831101, "comment_id": 57403966, "body": "I am certain I tried that earlier, but it is working now. Thanks."}], "tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": true, "score": 4, "last_activity_date": 1452972094, "creation_date": 1452972094, "answer_id": 34831101, "question_id": 34830888, "link": "https://stackoverflow.com/questions/34830888/cannot-serve-static-files-in-a-go-gorilla-server/34831101#34831101", "title": "Cannot serve static files in a Go Gorilla server", "body": "<p>Here's an example of how you can serve any requests to a file in <code>/static/</code> from a folder called <code>public</code>.</p>\n\n<pre><code>router := mux.NewRouter()\n//router.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"public\"))))\nrouter.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"public/\"))))\nlog.Fatal(http.ListenAndServe(\":3001\", router))\n</code></pre>\n"}], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 34831101, "answer_count": 1, "score": 0, "last_activity_date": 1452972094, "creation_date": 1452970820, "last_edit_date": 1452971435, "question_id": 34830888, "link": "https://stackoverflow.com/questions/34830888/cannot-serve-static-files-in-a-go-gorilla-server", "title": "Cannot serve static files in a Go Gorilla server", "body": "<p>I am playing with a small toy server to learn Go web programming.</p>\n\n<p>My project directory structure has the following <code>public</code> directory:</p>\n\n<pre><code>public\\\n  | style.css\n</code></pre>\n\n<p>The permissions on <code>public</code> and <code>style.css</code> are <code>r-x</code> and <code>r--</code> for everyone.</p>\n\n<p>In <code>main.go</code>, I have the following lines:</p>\n\n<pre><code>router := mux.NewRouter()\nrouter.Handle(\"/static/\",\n  http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"public\"))))\nlog.Fatal(http.ListenAndServe(\":3001\", router))\n</code></pre>\n\n<p>Every time I call <code>http://localhost:3001/static/style.css</code>\nthe server returns a 404.</p>\n\n<p>I have tried all combinations of leading and trailing slashes in the paths, but none make any difference.</p>\n\n<p>I am running Go v1.5.3 on Ubuntu 15.10 (x64).</p>\n"}, {"tags": ["go", "format", "format-string"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1452966046, "post_id": 34829606, "comment_id": 57401698, "body": "50% is 50% +- 0.5%; 50.00% is 50.00% +- 0.005%. They are not the same."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1452973904, "post_id": 34829606, "comment_id": 57404410, "body": "True, but for what I&#39;m doing that doesn&#39;t matter."}], "answers": [{"comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1452964404, "post_id": 34829722, "comment_id": 57401071, "body": "Yeah, that&#39;s what I&#39;m trying to avoid, but it might come to that."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1452966535, "post_id": 34829722, "comment_id": 57401845, "body": "You can&#39;t use modulo on a <code>float64</code>"}, {"owner": {"reputation": 11, "user_id": 5789328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f130a46fdc6017d5240ad5cf3f8858?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Bartrum", "link": "https://stackoverflow.com/users/5789328/sam-bartrum"}, "edited": false, "score": 0, "creation_date": 1452968174, "post_id": 34829722, "comment_id": 57402471, "body": "Ah ok I did not know this. It is not too hard to write something which is largely equivalent though and so the if else logic would work."}], "tags": [], "owner": {"reputation": 11, "user_id": 5789328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f130a46fdc6017d5240ad5cf3f8858?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Bartrum", "link": "https://stackoverflow.com/users/5789328/sam-bartrum"}, "is_accepted": false, "score": 0, "last_activity_date": 1452964261, "creation_date": 1452964261, "answer_id": 34829722, "question_id": 34829606, "link": "https://stackoverflow.com/questions/34829606/variable-floating-point-precision-format-string/34829722#34829722", "title": "Variable floating-point precision format string", "body": "<p>One way could be to have an if statement controlling the print output, i.e. if the result is cleanly divisible by 1 (result%1 == 0) then print the result to no decimal places. Otherwise print to .2f as you've done above. Not sure if there is a shorter way of doing this, but I think this should work.</p>\n"}, {"tags": [], "owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": true, "score": 2, "last_activity_date": 1452966454, "last_edit_date": 1452966454, "creation_date": 1452964901, "answer_id": 34829815, "question_id": 34829606, "link": "https://stackoverflow.com/questions/34829606/variable-floating-point-precision-format-string/34829815#34829815", "title": "Variable floating-point precision format string", "body": "<p>There's no direct solution with the <code>fmt</code> package.</p>\n\n<p>But you can remove the dot and zeros at end with a regular expression:</p>\n\n<pre><code>r, _ := regexp.Compile(`\\.?0*$`)\nfmt.Printf(\"%s%%\\n\", r.ReplaceAllString(fmt.Sprintf(\"%.2f\", 100*(value/total)),\"\"))\n</code></pre>\n\n<p>Bonus: the same regex works for any number of trailing zeros.</p>\n\n<p>Side note: You'll display <code>50.0041</code> the same way than <code>50</code>, which might be a little misleading.</p>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1452966410, "last_edit_date": 1452966410, "creation_date": 1452966046, "answer_id": 34830031, "question_id": 34829606, "link": "https://stackoverflow.com/questions/34829606/variable-floating-point-precision-format-string/34830031#34830031", "title": "Variable floating-point precision format string", "body": "<p>There's no way to do that inside <code>fmt</code> with e.g. another flag or what have you. You'll have to write out the logic yourself. You could do something like:</p>\n\n<pre><code>var final string\ndoubledecimal := fmt.Sprintf(\"%.2f\", 100*value/total)\nif doubledecimal[len(doubledecimal)-2:] == \"00\" {\n    final = doubledecimal[:len(doubledecimal)-3]\n} else {\n    final = doubledecimal\n}\nfmt.Printf(\"%s%%\\n, final)\n</code></pre>\n\n<p>You could similarly use <code>strings.Split</code> to split on the decimal point and work from there.</p>\n\n<p>You could even adjust this to turn <code>50.10%</code> into <code>50.1%</code>.</p>\n\n<pre><code>doubledecimal := fmt.Sprintf(\"%.2f\", 100*value/total)\n// Strip trailing zeroes\nfor doubledecimal[len(doubledecimal)-1] == 0 {\n    doubledecimal = doubledecimal[:len(doubledecimal)-1]\n}\n// Strip the decimal point if it's trailing.\nif doubledecimal[len(doubledecimal)-1] == \".\" {\n    doubledecimal = doubledecimal[:len(doubledecimal)-1]\n}\nfmt.Printf(\"%s%%\\n\", doubledecimal)\n</code></pre>\n"}], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 1, "accepted_answer_id": 34829815, "answer_count": 3, "score": 1, "last_activity_date": 1452966454, "creation_date": 1452963566, "question_id": 34829606, "link": "https://stackoverflow.com/questions/34829606/variable-floating-point-precision-format-string", "title": "Variable floating-point precision format string", "body": "<p>I'm trying to print floating point numbers as percentages, and I'd like for the number of digits after the decimal place to vary as needed. Currently I have:</p>\n\n<pre><code>fmt.Printf(\"%.2f%%\\n\", 100*(value/total))\n</code></pre>\n\n<p>The problem is that if my percentage is, say, exactly 50, I will get the following output:</p>\n\n<pre><code>50.00%\n</code></pre>\n\n<p>While what I want is to get:</p>\n\n<pre><code>50%\n</code></pre>\n\n<p>Is there any way for the format string to indicate that a <em>maximum</em> of 2 digits of precision should be used, but only if needed?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 23234, "user_id": 4333555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i9zgM.jpg?s=128&g=1", "display_name": "chris85", "link": "https://stackoverflow.com/users/4333555/chris85"}, "edited": false, "score": 0, "creation_date": 1452957756, "post_id": 34828408, "comment_id": 57398886, "body": "Looking at the doc it sounds like the <code>compile</code> uses PCRE and the other POSIX; <a href=\"http://php.net/manual/en/reference.pcre.pattern.posix.php\" rel=\"nofollow noreferrer\">php.net/manual/en/reference.pcre.pattern.posix.php</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 6, "last_activity_date": 1452959412, "last_edit_date": 1452959412, "creation_date": 1452957621, "answer_id": 34828610, "question_id": 34828408, "link": "https://stackoverflow.com/questions/34828408/what-is-the-difference-between-regexp-compile-and-regexp-compileposix/34828610#34828610", "title": "What is the difference between regexp.Compile and regexp.CompilePOSIX?", "body": "<p>Perl- and POSIX-compatible regular expressions are similar in large parts, but differ in some key aspects, like for example <strong>submatching</strong>. This is mentioned <a href=\"https://swtch.com/~rsc/regexp/regexp2.html#posix\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>POSIX defines that to resolve submatches, first chose the match that starts leftmost in the string. (This is traditional Perl behavior but here things diverge.) Among the submatches starting at the leftmost position in the string, choose the longest one overall.</p>\n</blockquote>\n\n<p>Say you have a regular expression <code>(foo|foobar)</code>. When matching this expression against a string that would match several of the subexpressions (for example, <code>foobarbaz</code> would match both subpatterns, <code>foo</code> and <code>foobar</code>), a Perl-compatible regex would return the <strong>first match</strong> (<code>foo</code>), while a POSIX-compatible regex would return the <strong>longest match</strong> (<code>foobar</code>).</p>\n\n<p>Some example code (<a href=\"https://play.golang.org/p/kldUzzH8ZO\" rel=\"nofollow\">playground</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\n\nfunc main() {\n    pattern := \"(foo|foobar)\"\n    str := []byte(\"foobarbaz\")\n\n    rPCRE, _ := regexp.Compile(pattern)\n    rPOSIX, _ := regexp.CompilePOSIX(pattern)\n\n    matchesPCRE := rPCRE.Find(str)\n    fmt.Println(string(matchesPCRE))\n    // prints \"foo\"\n\n    matchesPOSIX := rPOSIX.Find(str)\n    fmt.Println(string(matchesPOSIX))\n    // prints \"foobar\"\n}\n</code></pre>\n"}], "owner": {"reputation": 5403, "user_id": 431698, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/59b288f9d5793f1c114f30837ae0ec44?s=128&d=identicon&r=PG", "display_name": "Jingguo Yao", "link": "https://stackoverflow.com/users/431698/jingguo-yao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 34828610, "answer_count": 1, "score": 4, "last_activity_date": 1452964520, "creation_date": 1452956475, "last_edit_date": 1452964520, "question_id": 34828408, "link": "https://stackoverflow.com/questions/34828408/what-is-the-difference-between-regexp-compile-and-regexp-compileposix", "title": "What is the difference between regexp.Compile and regexp.CompilePOSIX?", "body": "<p>Can anyone provide some examples to explain the differences between <a href=\"https://golang.org/pkg/regexp/#Compile\" rel=\"nofollow\"><code>regexp.Compile</code></a> and <a href=\"https://golang.org/pkg/regexp/#CompilePOSIX\" rel=\"nofollow\"><code>regexp.CompilePOSIX</code></a>? I read the documentation. But I can't get an intuitive understanding.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452950864, "post_id": 34824934, "comment_id": 57396684, "body": "Why are you panicking in the first place? Are you trying to use panics as an exception mechanism? As you can see, you shouldn&#39;t do anything that might also panic while trying to recover."}, {"owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452966869, "post_id": 34824934, "comment_id": 57401983, "body": "I&#39;m definitely not over using panics. In my usage a panic will only ever occur due to programmer error, not user error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452969836, "post_id": 34824934, "comment_id": 57403070, "body": "Hmm, I&#39;m not sure what the &quot;testing&quot; package is doing different right now. It would be useful to try and figure out how to replicate this as a standalone example, to see if it&#39;s a bug or not."}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "edited": false, "score": 0, "creation_date": 1452935408, "post_id": 34825288, "comment_id": 57392603, "body": "Yes that&#39;s the work-around I settled on, but I&#39;d love a more complete explanation of why it doesn&#39;t work..."}], "tags": [], "owner": {"reputation": 1853, "user_id": 3186886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3336bbf9f0d7330e06dc19753106a322?s=128&d=identicon&r=PG", "display_name": "mraron", "link": "https://stackoverflow.com/users/3186886/mraron"}, "is_accepted": false, "score": 0, "last_activity_date": 1452935229, "creation_date": 1452935229, "answer_id": 34825288, "question_id": 34824934, "link": "https://stackoverflow.com/questions/34824934/is-it-possible-to-recover-from-a-panic-inside-a-panic/34825288#34825288", "title": "Is it possible to recover from a panic inside a panic?", "body": "<p>I think it solves your problem to replace this</p>\n\n<pre><code>panic(e1)\n</code></pre>\n\n<p>by this</p>\n\n<pre><code>panic(e1.Error())\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/fXpX2ch9eF\" rel=\"nofollow\">http://play.golang.org/p/fXpX2ch9eF</a></p>\n\n<p>And the question here is interesting: why? This is the hard part and I don't know the exact answer. Probably the problem here is that we panicing after all deffered functions executed (so when Go does try to print the panic error string). Any correction is welcomed if it's not correct!</p>\n"}], "owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452935229, "creation_date": 1452932072, "question_id": 34824934, "link": "https://stackoverflow.com/questions/34824934/is-it-possible-to-recover-from-a-panic-inside-a-panic", "title": "Is it possible to recover from a panic inside a panic?", "body": "<p>It looks like it's not possible to recover from a panic inside a panic?</p>\n\n<pre><code>func TestError(t *testing.T) {\n\n    e := &amp;myErr{p: false}\n    fmt.Println(e.Error())  // this prints \"returned\"\n    panic(e)                // this prints \"panic: returned\"\n\n    e1 := &amp;myErr{p: true}\n    fmt.Println(e1.Error()) // this prints \"recovered\"\n    panic(e1)               // this prints \"panic: panic: paniced\n                            //              fatal error: panic holding locks \n                            //              panic during panic\"\n}\n\ntype myErr struct {\n    p bool\n}\n\nfunc (m *myErr) Error() (out string) {\n    defer func() {\n        if r := recover(); r != nil {\n            out = \"recovered\"\n        }\n    }()\n    if m.p {\n        panic(\"paniced\")\n    }\n    return \"returned\"\n}\n</code></pre>\n\n<p>Backstory: My error Error() function uses os.Getwd, which seems to always panic when inside a panic, so I'd like to handle this gracefully.</p>\n"}, {"tags": ["string", "dictionary", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 2255715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iT2ME.jpg?s=128&g=1", "display_name": "Stian OK", "link": "https://stackoverflow.com/users/2255715/stian-ok"}, "edited": false, "score": 0, "creation_date": 1452931586, "post_id": 34824833, "comment_id": 57391755, "body": "Actually <code>cmd[3]</code> is the string <code>:hey</code> so <code>cmd[3][1:]</code> is <code>hey</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 522, "user_id": 2255715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iT2ME.jpg?s=128&g=1", "display_name": "Stian OK", "link": "https://stackoverflow.com/users/2255715/stian-ok"}, "edited": false, "score": 0, "creation_date": 1452934365, "post_id": 34824833, "comment_id": 57392360, "body": "@StianOK Then your <code>cmd[3]</code> is not the <code>string</code> <code>&quot;:hey&quot;</code>. See edit to verify it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1475355165, "last_edit_date": 1475355165, "creation_date": 1452931244, "answer_id": 34824833, "question_id": 34824590, "link": "https://stackoverflow.com/questions/34824590/unexpected-value-when-getting-value-from-a-map/34824833#34824833", "title": "Unexpected value when getting value from a map", "body": "<p>Getting the value based on the value of a variable works:</p>\n\n<pre><code>m := map[string]string{\"hey\": \"found\"}\nfmt.Println(m[\"hey\"]) // found\n\ncmd := []string{\"1\", \"2\", \"3\", \"hey\"}\nfmt.Println(m[cmd[3]]) // found\n</code></pre>\n\n<p>It even works if the variable is of <code>string</code> type and you slice its value, e.g.:</p>\n\n<pre><code>cmd = []string{\"1\", \"2\", \"3\", \"Hhey\"}\nfmt.Println(m[cmd[3][1:]]) // found\n</code></pre>\n\n<p>You issue is most likely <code>cmd[3]</code> is the <code>string</code> <code>\"hey\"</code> itself, but if you slice it like <code>cmd[3][1:]</code>, it will cut off the first character (or to be precise: the first byte from its UTF-8 encoding sequence, the memory representation of <code>string</code>s, but the characters of <code>\"hey\"</code> map to bytes one-to-one), so it will be <code>\"ey\"</code>, for which you will not find any associated value in the map of course:</p>\n\n<pre><code>cmd = []string{\"1\", \"2\", \"3\", \"hey\"}\nfmt.Println(m[cmd[3][1:]]) // NOT FOUND (empty string - zero value)\n</code></pre>\n\n<p>Try these on the <a href=\"http://play.golang.org/p/iGHq3PNzL6\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p>If <code>cmd[3]</code> is <code>\"hey\"</code>, no need to slice it, just use it as a key.</p>\n\n<p><strong>Edit:</strong> You claim <code>cmd[3]</code> contains the <code>string</code> <code>\":hey\"</code>. If it would, it would also work:</p>\n\n<pre><code>cmd = []string{\"1\", \"2\", \"3\", \":hey\"}\nfmt.Println(m[cmd[3][1:]]) // found\n</code></pre>\n\n<p>So your <code>cmd[3]</code> is not what you think it is. It may contain <code>0</code> bytes or unprintable characters. Print its bytes to verify. For example bytes of the <code>string</code> <code>\":hey\"</code> are: <code>[58 104 101 121]</code></p>\n\n<pre><code>fmt.Println([]byte(\":hey\")) // Prints [58 104 101 121]\n</code></pre>\n\n<p>Print your <code>cmd[3]</code> to verify:</p>\n\n<pre><code>fmt.Println([]byte(cmd[3]))\n</code></pre>\n\n<p>You could also compare it to the <code>strings</code> you think it is, but that will only tell you whether they are equal (and won't tell you where the difference is):</p>\n\n<pre><code>fmt.Println(cmd[3] == \":hey\", cmd[3][1:] == \"hey\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 522, "user_id": 2255715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iT2ME.jpg?s=128&g=1", "display_name": "Stian OK", "link": "https://stackoverflow.com/users/2255715/stian-ok"}, "is_accepted": true, "score": 0, "last_activity_date": 1453029879, "creation_date": 1453029879, "answer_id": 34837773, "question_id": 34824590, "link": "https://stackoverflow.com/questions/34824590/unexpected-value-when-getting-value-from-a-map/34837773#34837773", "title": "Unexpected value when getting value from a map", "body": "<p>Trimming the string solves the problem.</p>\n\n<pre><code>strings.TrimSpace(cmd[3])\n</code></pre>\n"}], "owner": {"reputation": 522, "user_id": 2255715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iT2ME.jpg?s=128&g=1", "display_name": "Stian OK", "link": "https://stackoverflow.com/users/2255715/stian-ok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 34837773, "answer_count": 2, "score": 2, "last_activity_date": 1475355165, "creation_date": 1452929051, "last_edit_date": 1452931376, "question_id": 34824590, "link": "https://stackoverflow.com/questions/34824590/unexpected-value-when-getting-value-from-a-map", "title": "Unexpected value when getting value from a map", "body": "<p>So I have a struct like this:</p>\n\n<pre><code>type Magni struct {\n    ...\n    Handlers map[string]func(*Message)\n    ...\n}\n</code></pre>\n\n<p>And I have a function to create a new instance of the struct:</p>\n\n<pre><code>func New(nick, user, real string) *Magni {\n    return &amp;Magni{\n        ...\n        Handlers: make(map[string]func(*Message)),\n        ...\n    }\n}\n</code></pre>\n\n<p>But I can't get something from the <code>Handlers</code> map with the key <code>\"hey\"</code> when <code>\"hey\"</code> is in a variable, it only works if I type it myself. Here is a method of the struct <code>Magni</code> and <code>m</code> is a pointer to the struct <code>Magni</code>:</p>\n\n<pre><code>handler := m.Handlers[cmd[3][1:]] // cmd[3][1:] contains string \"hey\"\nhandler2 := m.Handlers[\"hey\"]\n</code></pre>\n\n<p>For some reason, the value of <code>handler</code> is <code>nil</code> and the value of <code>handler2</code> is <code>0x401310</code>, basically I am not expecting <code>handler</code> to be <code>nil</code>.</p>\n\n<p>Am I doing something wrong or is this the expected behavior?</p>\n"}, {"tags": ["go", "https"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452961498, "post_id": 34823724, "comment_id": 57400025, "body": "I would guess that there is a network appliance between you and the server which drops the idle connection, but you would need a network capture (possible on both sides) to be sure. Regardless, network failures are something you need to account for, so you should be able to work around it."}, {"owner": {"reputation": 1525, "user_id": 2119660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae09f6f1f1e7eabb4438fcde4ddef8b?s=128&d=identicon&r=PG", "display_name": "Jeff Sisson", "link": "https://stackoverflow.com/users/2119660/jeff-sisson"}, "edited": false, "score": 0, "creation_date": 1452965048, "post_id": 34823724, "comment_id": 57401342, "body": "It might be helpful to see more surrounding context of how you standup your <code>Server</code> \u2014 the fact that the log notes that the incoming connection was via port <code>:51463</code> would suggest that somewhere in your code, the stdlib HTTP library is choosing a random port for serving traffic (other than 443)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1525, "user_id": 2119660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae09f6f1f1e7eabb4438fcde4ddef8b?s=128&d=identicon&r=PG", "display_name": "Jeff Sisson", "link": "https://stackoverflow.com/users/2119660/jeff-sisson"}, "edited": false, "score": 0, "creation_date": 1452969906, "post_id": 34823724, "comment_id": 57403095, "body": "@JeffSisson, that is the remote port. It makes no sense for the http package to be serving from a random port."}], "answers": [{"comments": [{"owner": {"reputation": 2040, "user_id": 7090655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jPFQs.jpg?s=128&g=1", "display_name": "L&#234; Quang B\u1ea3o", "link": "https://stackoverflow.com/users/7090655/l%c3%aa-quang-b%e1%ba%a3o"}, "edited": false, "score": 8, "creation_date": 1552983720, "post_id": 34889113, "comment_id": 97205901, "body": "To anyone, whom got this problem when testing with Postman. You can turn off <b>SSL certificate verification</b> in the setting."}], "tags": [], "owner": {"reputation": 1006, "user_id": 1840304, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2a5492335264f0d38608fcce610bec65?s=128&d=identicon&r=PG", "display_name": "Sathya", "link": "https://stackoverflow.com/users/1840304/sathya"}, "is_accepted": true, "score": 9, "last_activity_date": 1453247395, "creation_date": 1453247395, "answer_id": 34889113, "question_id": 34823724, "link": "https://stackoverflow.com/questions/34823724/golang-tls-handshake-error/34889113#34889113", "title": "Golang - TLS handshake error", "body": "<p>I enabled tcp keepalive and this problem got solved. I was running my VM in google compute engine and probably the firewall terminated idle connections.</p>\n\n<p><a href=\"http://tldp.org/HOWTO/TCP-Keepalive-HOWTO/overview.html\" rel=\"noreferrer\">TCP Keep alive</a></p>\n\n<p><a href=\"http://tldp.org/HOWTO/TCP-Keepalive-HOWTO/usingkeepalive.html\" rel=\"noreferrer\">Configuring tcp keep alive in linux</a></p>\n\n<p>Golang http server automatically picked this up, so no change was required in my golang code.</p>\n\n<p>Regards,</p>\n\n<p>Sathya</p>\n"}, {"tags": [], "owner": {"reputation": 1398, "user_id": 403849, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c621d6fd088d4441d9037922af06aac7?s=128&d=identicon&r=PG", "display_name": "adavea", "link": "https://stackoverflow.com/users/403849/adavea"}, "is_accepted": false, "score": 0, "last_activity_date": 1615908833, "creation_date": 1615908833, "answer_id": 66658409, "question_id": 34823724, "link": "https://stackoverflow.com/questions/34823724/golang-tls-handshake-error/66658409#66658409", "title": "Golang - TLS handshake error", "body": "<p>I was receiving the same error as OP, but in my case the TLSHandshakeTimeout value I was specifying was too low.  I'm not sure what an appropriate value is but moving it to 700ms from 100ms eliminated the error for me.  For others experiencing the same error and who are specifying non-default http.Transport config values in their http.Client setup, you might want to make sure your TLSHandshakeTimeout is set to a high enough value.</p>\n<pre><code>&amp;http.Client{\n  Transport: &amp;http.Transport{\n    TLSHandshakeTimeout:   700 * time.Millisecond, //&lt;-- I was receiving OP's error when I had this set to 100ms\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 1006, "user_id": 1840304, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2a5492335264f0d38608fcce610bec65?s=128&d=identicon&r=PG", "display_name": "Sathya", "link": "https://stackoverflow.com/users/1840304/sathya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16985, "favorite_count": 1, "accepted_answer_id": 34889113, "answer_count": 2, "score": 6, "last_activity_date": 1615908833, "creation_date": 1452920851, "question_id": 34823724, "link": "https://stackoverflow.com/questions/34823724/golang-tls-handshake-error", "title": "Golang - TLS handshake error", "body": "<p>I am running a https web server in go. I am testing it using a angular web app (Chrome browser) that makes ajax calls to the web server. </p>\n\n<p>If I keep hitting the web server continuously everything seems working. But whenever I leave it idle for sometime and hit the web server the ajax call from browser doesn't get a response. Almost always I see this log line in my server log.</p>\n\n<p><code>2016/01/16 04:06:47.006977 http: TLS handshake error from 42.21.139.47:51463: EOF</code></p>\n\n<p>I can confirm that the IP address is my IP address. </p>\n\n<p>I am starting my https server like this:</p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/status\", handleStatus)\nsetUpLoginEndpoint(&amp;cfg.Session, r)\nsetUpLogoutEndpoint(cfg.Session.CookieName, r)\nsetUpChangePasswordEndpoint(cfg.Session.CookieName, r)\nsetUpMetricSinkEndpoint(cfg.Metric.SinkApiKey, r)\nsetUpMetricQueryEndpoint(cfg.Session.CookieName, r)\nhttp.ListenAndServeTLS(\":443\", \"../cert.pem\", \"../keys.pem\", &amp;Server{r})\n</code></pre>\n\n<p>I can confirm that I am closing the request body in every handler using defer r.Body.Close().</p>\n\n<p>I am using go 1.5.2. </p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Regards,</p>\n\n<p>Sathya</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1452917382, "last_edit_date": 1452917382, "creation_date": 1452916298, "answer_id": 34823338, "question_id": 34823289, "link": "https://stackoverflow.com/questions/34823289/whats-the-difference-between-decoderuneinternal-and-decoderuneinstringinternal/34823338#34823338", "title": "what&#39;s the difference between decodeRuneInternal and decodeRuneInStringInternal", "body": "<p>The two functions avoid the memory allocation in the conversion <code>[]byte(s)</code> in the case where the string function wraps the []byte function or the memory allocation in the conversion <code>string(p)</code> in the case where the []byte function wraps the string function.</p>\n"}], "owner": {"reputation": 49, "user_id": 5797406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rO76N.jpg?s=128&g=1", "display_name": "rench", "link": "https://stackoverflow.com/users/5797406/rench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 34823338, "answer_count": 1, "score": 0, "last_activity_date": 1452917382, "creation_date": 1452915723, "last_edit_date": 1452916966, "question_id": 34823289, "link": "https://stackoverflow.com/questions/34823289/whats-the-difference-between-decoderuneinternal-and-decoderuneinstringinternal", "title": "what&#39;s the difference between decodeRuneInternal and decodeRuneInStringInternal", "body": "<p>In golang's std package, \"func decodeRuneInternal\" and \"func decodeRuneInStringInternal\" are the same except the args, that is:</p>\n\n<pre><code>func decodeRuneInternal(p []byte) (r rune, size int, short bool)\nfunc decodeRuneInStringInternal(s string) (r rune, size int, short bool)\n</code></pre>\n\n<p>Why not just define decodeRuneInStringInternal as:</p>\n\n<pre><code>func decodeRuneInStringInternal(s string) (r rune, size int, short bool) {\n    return decodeRuneInternal([]byte(s)) (r rune, size int, short bool)\n}\n</code></pre>\n\n<p>in utf8.go, decodeRuneInStringInternal's  implementations is the same with decodeRuneInternal.</p>\n\n<p>WHY?</p>\n"}, {"tags": ["arrays", "go"], "answers": [{"comments": [{"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "edited": false, "score": 0, "creation_date": 1452929876, "post_id": 34822459, "comment_id": 57391395, "body": "awesome, that fixed the problem."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1452907084, "last_edit_date": 1452907084, "creation_date": 1452906781, "answer_id": 34822459, "question_id": 34822405, "link": "https://stackoverflow.com/questions/34822405/println-turning-up-as-empty-string-in-go/34822459#34822459", "title": "println turning up as empty string in go", "body": "<p>The expression </p>\n\n<pre><code> string(cells[dial])\n</code></pre>\n\n<p>yields the UTF-8 representation of the integer value <code>cells[dial]</code>. Print the quoted string output to see what's going on:</p>\n\n<pre><code>    fmt.Printf(\"%q\\n\", processturing(\"&gt; &gt; &gt; + + + . .\")) // prints \"\\x03 \\x03 \"\n</code></pre>\n\n<p>I think you want the decimal representation of the integer:</p>\n\n<pre><code> strconv.Itoa(cells[dial])\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/quGCE3wKMj\">playground example</a>.</p>\n"}], "owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 34822459, "answer_count": 1, "score": 0, "last_activity_date": 1452907084, "creation_date": 1452906414, "question_id": 34822405, "link": "https://stackoverflow.com/questions/34822405/println-turning-up-as-empty-string-in-go", "title": "println turning up as empty string in go", "body": "<p>So I wrote this small go program, that gives instructions to a turing machine, and prints selected cells from it:</p>\n\n<pre><code>    package main\n\nimport \"fmt\"\nimport s \"strings\"\n\nfunc main() {\n  fmt.Println(processturing(\"&gt; &gt; &gt; + + + . .\"));\n}\n\nfunc processturing(arguments string) string{\n    result := \"\"\n    dial := 0\n    cells := make([]int, 30000)\n    commands := splitstr(arguments, \" \")\n    for i := 0;i&lt;len(commands);i++ {\n        switch commands[i] {\n        case \"&gt;\":\n            dial += 1\n        case \"&lt;\":\n            dial -= 1\n        case \"+\":\n            cells[dial] += 1\n        case \"-\":\n            cells[dial] -= 1\n        case \".\":\n            result += string(cells[dial]) + \" \"\n        }\n    }\n    return result\n}\n\n//splits strings be a delimeter\nfunc splitstr(input, delim string) []string{\n    return s.Split(input, delim)\n}\n</code></pre>\n\n<p>Problem is, when this is run, the console doesn't display anything. It just displays nothing. How do I make this work to <code>fmt.println</code> the resulting string from my function?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "edited": false, "score": 0, "creation_date": 1452896405, "post_id": 34820746, "comment_id": 57384270, "body": "@LearnGo it very much does. I just tested it and will copy over the full example."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "edited": false, "score": 0, "creation_date": 1452896848, "post_id": 34820746, "comment_id": 57384426, "body": "@LearnGo if this isn&#39;t working, please post a more complete example so we can identify what else might be wrong."}, {"owner": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "edited": false, "score": 0, "creation_date": 1452899181, "post_id": 34820746, "comment_id": 57385244, "body": "<a href=\"https://play.golang.org/p/kZ-EtLS27D\" rel=\"nofollow noreferrer\">play.golang.org/p/kZ-EtLS27D</a> I have pasted information here. Both the actual xml file and the output and code in the golang page."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "edited": false, "score": 0, "creation_date": 1452901670, "post_id": 34820746, "comment_id": 57385991, "body": "@LearnGo alright, there&#39;s a lot more to your actual data. I&#39;ll have a look at it when I get some time."}, {"owner": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "edited": false, "score": 0, "creation_date": 1452901880, "post_id": 34820746, "comment_id": 57386054, "body": "Thanks so much .Appreciate the help. Its actually an Atom feed So not sure if that is making the difference."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "edited": false, "score": 0, "creation_date": 1452902081, "post_id": 34820746, "comment_id": 57386117, "body": "@LearnGo hey could you make a working playground example that has the xml as a string? Your object definition doesn&#39;t match the xml that is posted there however I&#39;m not sure if that was just a mistake in you copying it (xml isn&#39;t valid either, you didn&#39;t include the closing elements) or an indication that your code needs to be changed. Also, the program just won&#39;t run for various reasons, I fixed it so it can but then there is no file to read, so just declare the data as a <code>[]byte</code> and pass it into unmarshal directly. If you can do that then I&#39;ll make it work."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1452896461, "last_edit_date": 1452896461, "creation_date": 1452895879, "answer_id": 34820746, "question_id": 34820549, "link": "https://stackoverflow.com/questions/34820549/unable-to-parse-xml-in-go-with-in-tags/34820746#34820746", "title": "Unable to parse xml in GO with : in tags", "body": "<p>You just need to escape the colon. So change your xml tag to <code>xml:\"cap\\:event\"</code> and it will work as you expect.</p>\n\n<pre><code>type Entry struct{\n    Summary    string   `xml:\"summary\"`\n    Cevent     string   `xml:\"cap\\:event\"`\n}\n</code></pre>\n\n<p>Tested this on the xml page using the unmarshal example with minor modification;</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nfunc main() {\n    type Email struct {\n        Where string `xml:\"where,attr\"`\n        Addr  string\n    }\n    type Address struct {\n        City, State string\n    }\n    type Result struct {\n        XMLName xml.Name `xml:\"Person\"`\n        Name    string   `xml:\"Full\\:Name\"`\n        Phone   string\n        Email   []Email\n        Groups  []string `xml:\"Group&gt;Value\"`\n        Address\n    }\n    v := Result{Name: \"none\", Phone: \"none\"}\n\n    data := `\n        &lt;Person&gt;\n            &lt;Full:Name&gt;Grace R. Emlin&lt;/Full:Name&gt;\n            &lt;Company&gt;Example Inc.&lt;/Company&gt;\n            &lt;Email where=\"home\"&gt;\n                &lt;Addr&gt;gre@example.com&lt;/Addr&gt;\n            &lt;/Email&gt;\n            &lt;Email where='work'&gt;\n                &lt;Addr&gt;gre@work.com&lt;/Addr&gt;\n            &lt;/Email&gt;\n            &lt;Group&gt;\n                &lt;Value&gt;Friends&lt;/Value&gt;\n                &lt;Value&gt;Squash&lt;/Value&gt;\n            &lt;/Group&gt;\n            &lt;City&gt;Hanga Roa&lt;/City&gt;\n            &lt;State&gt;Easter Island&lt;/State&gt;\n        &lt;/Person&gt;\n    `\n    err := xml.Unmarshal([]byte(data), &amp;v)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        return\n    }\n    fmt.Printf(\"XMLName: %#v\\n\", v.XMLName)\n    fmt.Printf(\"Name: %q\\n\", v.Name)\n    fmt.Printf(\"Phone: %q\\n\", v.Phone)\n    fmt.Printf(\"Email: %v\\n\", v.Email)\n    fmt.Printf(\"Groups: %v\\n\", v.Groups)\n    fmt.Printf(\"Address: %v\\n\", v.Address)\n}\n</code></pre>\n\n<p>Remove the escape and it will print \"none\" for Name. Use a space instead of <code>:</code> or <code>\\:</code> and it will also work. A space in the xml will cause a parse error because it's invalid apparently.</p>\n"}, {"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1452896062, "post_id": 34820757, "comment_id": 57384137, "body": "This works too. Not sure why one would be chosen over another though or if their equivalent."}, {"owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "edited": false, "score": 0, "creation_date": 1452896199, "post_id": 34820757, "comment_id": 57384181, "body": "Here&#39;s a <a href=\"https://play.golang.org/p/soUud-lKPe\" rel=\"nofollow noreferrer\">playground</a> with a working example."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "edited": false, "score": 0, "creation_date": 1452904532, "post_id": 34820757, "comment_id": 57386794, "body": "@LearnGo: <code>cap</code> is the namespace identifier, but doesn&#39;t mean anything without the namespace declaration. You need to handle the correct namespace for your document."}, {"owner": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "edited": false, "score": 0, "creation_date": 1452904867, "post_id": 34820757, "comment_id": 57386869, "body": "Very new to go and xml. How do we do that in go Here is the code play.golang.org/p/MJKCfSnAIs"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452961682, "post_id": 34820757, "comment_id": 57400083, "body": "This doesn&#39;t work on the actual document, because <code>cap</code> isn&#39;t the namespace, it&#39;s the namespace identifier for that block of the document."}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 3, "last_activity_date": 1452962050, "last_edit_date": 1452962050, "creation_date": 1452895941, "answer_id": 34820757, "question_id": 34820549, "link": "https://stackoverflow.com/questions/34820549/unable-to-parse-xml-in-go-with-in-tags/34820757#34820757", "title": "Unable to parse xml in GO with : in tags", "body": "<p><code>cap</code> is not part of the tag name, but a namespace identifier (short for <code>urn:oasis:names:tc:emergency:cap:1.1</code>, as you've provided in comments). This is the correct notation:</p>\n\n<pre><code>type Entry struct{\n    Summary    string   `xml:\"summary\"`\n    Cevent     string   `xml:\"urn:oasis:names:tc:emergency:cap:1.1:cap event\"`\n}\n</code></pre>\n\n<p>Mind the space <code></code> instead of <code>:</code> to denote the namespace. Also note that just using the namespace identifier (like <code>xml:\"cap event\"</code>) <strong>does not work</strong>.</p>\n\n<p>Working example (<a href=\"https://play.golang.org/p/rjkb2esGgv\" rel=\"nofollow\">https://play.golang.org/p/rjkb2esGgv</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/xml\"\n\ntype Entry struct{\n    Summary    string   `xml:\"summary\"`\n    Cevent     string   `xml:\"urn:oasis:names:tc:emergency:cap:1.1:cap event\"`\n}\n\nfunc main() {\n    xmlString := []byte(`\n        &lt;doc xmlns:cap = 'urn:oasis:names:tc:emergency:cap:1.1'&gt;\n            &lt;summary&gt;...AIR QUALITY ALERT &lt;/summary&gt;\n            &lt;cap:event&gt;Air Quality Alert&lt;/cap:event&gt;\n        &lt;/doc&gt;\n    `)\n    entry := new(Entry)\n\n    if err := xml.Unmarshal(xmlString, entry); err == nil {\n        fmt.Println(entry)\n    } \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1453397967, "last_edit_date": 1495535274, "creation_date": 1452907722, "answer_id": 34822547, "question_id": 34820549, "link": "https://stackoverflow.com/questions/34820549/unable-to-parse-xml-in-go-with-in-tags/34822547#34822547", "title": "Unable to parse xml in GO with : in tags", "body": "<p><code>cap</code> is the namespace identifier, not part of the tag name. Here it is shorthand for <code>urn:oasis:names:tc:emergency:cap:1.1</code> </p>\n\n<p>(This answer looks like it may have a good condensed explanation of namespaces: <a href=\"https://stackoverflow.com/questions/1181888/what-does-xmlns-in-xml-mean\">What does &quot;xmlns&quot; in XML mean?</a>)</p>\n\n<p>The Go \"encoding/xml\" package does not handle namespaces well, but if there are no conflicting tags, you can elide the namespace altogether</p>\n\n<pre><code>type Entry struct {\n    Summary string `xml:\"summary\"`\n    Event   string `xml:\"event\"`\n}\n</code></pre>\n\n<p>The proper way to specify event, especially in the case of identical tags in different namespaces, would be with the full namespace like:</p>\n\n<pre><code>type Entry struct {\n    Summary string `xml:\"summary\"`\n    Event   string `xml:\"urn:oasis:names:tc:emergency:cap:1.1 event\"`\n}\n</code></pre>\n\n<p>Here's a working example: <a href=\"https://play.golang.org/p/ry55F2pWKY\" rel=\"noreferrer\">https://play.golang.org/p/ry55F2pWKY</a></p>\n"}], "owner": {"reputation": 95, "user_id": 5796776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a8c5a4915fbd454c71f0dd52408351?s=128&d=identicon&r=PG&f=1", "display_name": "LearnGo", "link": "https://stackoverflow.com/users/5796776/learngo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 1, "accepted_answer_id": 34822547, "answer_count": 3, "score": 5, "last_activity_date": 1453397967, "creation_date": 1452895049, "last_edit_date": 1452895617, "question_id": 34820549, "link": "https://stackoverflow.com/questions/34820549/unable-to-parse-xml-in-go-with-in-tags", "title": "Unable to parse xml in GO with : in tags", "body": "<p>I find that if tags in XML file have <code>:</code> in them the unmarshal code in Go does not seem to work. Any insights ?</p>\n\n<p>For example, in the XML file below, <code>Summary</code> works but not <code>Cevent</code>. </p>\n\n<pre><code>&lt;summary&gt;...AIR QUALITY ALERT &lt;/summary&gt;\n&lt;cap:event&gt;Air Quality Alert&lt;/cap:event&gt;\n</code></pre>\n\n\n\n<pre><code>type Entry struct{\n    Summary    string   `xml:\"summary\"`\n    Cevent     string   `xml:\"cap:event\"`\n}\n</code></pre>\n"}, {"tags": ["go", "types"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1452894740, "post_id": 34820469, "comment_id": 57383484, "body": "<i>What comparison am I making in the code above?</i> None, because it doesn&#39;t compile."}], "answers": [{"tags": [], "owner": {"reputation": 3625, "user_id": 249552, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kQlfx.png?s=128&g=1", "display_name": "jacob", "link": "https://stackoverflow.com/users/249552/jacob"}, "is_accepted": false, "score": 8, "last_activity_date": 1452894883, "last_edit_date": 1495535470, "creation_date": 1452894883, "answer_id": 34820514, "question_id": 34820469, "link": "https://stackoverflow.com/questions/34820469/can-i-compare-variable-types-with-type-in-golang/34820514#34820514", "title": "Can I compare variable types with .(type) in Golang?", "body": "<p>You'd need to specify the type. That syntax is used to make <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">type assertions</a> about interfaces, not about checking the specific type.\nYou'll have to use <code>reflect.TypeOf</code> for that.</p>\n\n<p>You can view this <a href=\"https://stackoverflow.com/a/6373426/249552\">answer</a> for a proper use of type assertions.</p>\n"}, {"comments": [{"owner": {"reputation": 946, "user_id": 232332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/41323b9e976f8dbc02bba0b0474004e4?s=128&d=identicon&r=PG", "display_name": "russell_h", "link": "https://stackoverflow.com/users/232332/russell-h"}, "edited": false, "score": 9, "creation_date": 1471994831, "post_id": 34820553, "comment_id": 65571573, "body": "Note that the second example will panic if both variables are not of type <code>int</code>."}, {"owner": {"reputation": 871, "user_id": 2508466, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/UHx7w.jpg?s=128&g=1", "display_name": "yaccob", "link": "https://stackoverflow.com/users/2508466/yaccob"}, "edited": false, "score": 4, "creation_date": 1571242633, "post_id": 34820553, "comment_id": 103177982, "body": "The question is about comparing types, not about comparing values of the same type."}, {"owner": {"reputation": 1274, "user_id": 5483193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c2bb28b62bf9fc8c2cf9422691e066d?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy R.T.", "link": "https://stackoverflow.com/users/5483193/jimmy-r-t"}, "edited": false, "score": 0, "creation_date": 1610462774, "post_id": 34820553, "comment_id": 116136956, "body": "What does the second code have to do with the question?"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 14, "last_activity_date": 1452895056, "creation_date": 1452895056, "answer_id": 34820553, "question_id": 34820469, "link": "https://stackoverflow.com/questions/34820469/can-i-compare-variable-types-with-type-in-golang/34820553#34820553", "title": "Can I compare variable types with .(type) in Golang?", "body": "<p><code>someInterface.(type)</code> is <em>only used</em> in type switches. In fact if you tried to run that you'd see that in the error message.</p>\n\n<pre><code>func main() {\n    var a, b interface{}\n    a = 1\n    b = 1\n\n    fmt.Println(a.(type) == b.(type))\n}\n</code></pre>\n\n<blockquote>\n  <p>prog.go:10: use of .(type) outside type switch</p>\n</blockquote>\n\n<p>What you could do instead is <code>a.(int) == b.(int)</code>, which is really no different from <code>int(a) == int(b)</code></p>\n\n<pre><code>func main() {\n    var a, b interface{}\n    a = 1\n    b = 1\n\n    fmt.Println(a.(int) == b.(int))\n}\n</code></pre>\n\n<blockquote>\n  <p>true</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1587698572, "post_id": 53986351, "comment_id": 108618886, "body": "Similar syntax: <a href=\"https://stackoverflow.com/a/26976477/12817546\">stackoverflow.com/a/26976477/12817546</a>"}], "tags": [], "owner": {"reputation": 59, "user_id": 10851592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb7d9add9091785c5767012ed1533780?s=128&d=identicon&r=PG&f=1", "display_name": "Gabor725", "link": "https://stackoverflow.com/users/10851592/gabor725"}, "is_accepted": false, "score": 5, "last_activity_date": 1546252102, "creation_date": 1546252102, "answer_id": 53986351, "question_id": 34820469, "link": "https://stackoverflow.com/questions/34820469/can-i-compare-variable-types-with-type-in-golang/53986351#53986351", "title": "Can I compare variable types with .(type) in Golang?", "body": "<p>Please try this:</p>\n\n<pre><code>for key, value := range data {\n    switch v := value.(type) {\n    case string:\n        fmt.Println(key, value, \"(string)\")\n    case float64:\n        fmt.Println(key, value, \"(float64)\")\n    case []interface{}:\n        fmt.Println(key, value, \"(interface)\")\n    }\n }\n</code></pre>\n\n<p>...\nand you can use for all types in any interface...</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14877036, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b170cb096cd1253c71426abcdc2ce964?s=128&d=identicon&r=PG", "display_name": "Eric Brown", "link": "https://stackoverflow.com/users/14877036/eric-brown"}, "is_accepted": false, "score": 0, "last_activity_date": 1608717731, "last_edit_date": 1608717731, "creation_date": 1608717061, "answer_id": 65422200, "question_id": 34820469, "link": "https://stackoverflow.com/questions/34820469/can-i-compare-variable-types-with-type-in-golang/65422200#65422200", "title": "Can I compare variable types with .(type) in Golang?", "body": "<pre><code>func isType(a, b interface{}) bool {\n    return fmt.Sprintf(&quot;%T&quot;, a) == fmt.Sprintf(&quot;%T&quot;, b)\n}\n</code></pre>\n<p>The <code>&quot;%T&quot;</code> fmt option uses reflection under the hood, which would make the above statement practically that same as:</p>\n<pre><code>func isType(a, b interface{}) bool {\n    return reflect.TypeOf(a) == reflect.TypeOf(b)\n}\n</code></pre>\n<p>Either one would work, and won't cause a panic trying to utilize any kind of type assertion like some of the other suggestions.</p>\n"}], "owner": {"reputation": 185, "user_id": 4396517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d20a12a0638586b073d44e2fe1ba41?s=128&d=identicon&r=PG&f=1", "display_name": "user44168", "link": "https://stackoverflow.com/users/4396517/user44168"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25465, "favorite_count": 0, "accepted_answer_id": 34820553, "answer_count": 4, "score": 10, "last_activity_date": 1608717731, "creation_date": 1452894640, "question_id": 34820469, "link": "https://stackoverflow.com/questions/34820469/can-i-compare-variable-types-with-type-in-golang", "title": "Can I compare variable types with .(type) in Golang?", "body": "<p>I'm quite confused about the .(type) syntax for interface variables. Is it possible to use it like this:</p>\n\n<pre><code>var a,b interface{}\n// some code\nif first.(type) == second.(type) {\n}\n</code></pre>\n\n<p>or is reflect.TypeOf() the only option to check if the underlying types of a and b are the same type? What comparison am I making in the code above?</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 4, "last_activity_date": 1452905475, "last_edit_date": 1452905475, "creation_date": 1452904739, "answer_id": 34822205, "question_id": 34818798, "link": "https://stackoverflow.com/questions/34818798/sync-waitgroup-why-closer-in-a-goroutine/34822205#34822205", "title": "Sync.WaitGroup, why closer in a goroutine", "body": "<p>The problem is that <code>sizes</code> is not a buffered <code>chan</code>, so only one of the anonymous goroutines can actually complete before <code>sizes</code> needs to be read from. That makes <code>wg.Wait()</code> wait forever (since the next goroutine is blocking on <code>sizes &lt;-</code> and can't <code>defer wg.Done()</code>) and deadlocks.</p>\n\n<p>By throwing the closer in a separate goroutine, it can close the <code>sizes</code> chan whenever it's ready to do so, and process from <code>sizes</code> in between. Ultimately this is a great use of a goroutine -- fire and forget closing!</p>\n\n<p>To make this code work without the closer goroutine, you can simply initialize <code>sizes</code> as a buffered chan with a buffer >= the length of <code>filenames</code>.</p>\n\n<pre><code>func makeThumbnails(filenames &lt;-chan string, result chan&lt;- int64) int64 {\n    sizes := make(chan int64, 10) // buffered channel, now!\n    // if filenames sends more than 10 strings, though, we're in trouble!!\n\n    var wg sync.WaitGroup\n    for f := range filenames {\n        wg.Add(1)\n        go func(f string) {\n            defer wg.Done()\n            sizes &lt;- int64(len(f))\n        }(f)\n    }\n\n    // **closer**, this guy doesn't need to be a goroutine!!\n    wg.Wait()\n    close(sizes)\n\n    var total int64\n    for size := range sizes {\n        total += size\n    }\n    result &lt;- total\n    return total\n}\n</code></pre>\n\n<p>However since <code>filenames</code>'s length is unknowable at runtime, it's not possible to do this easily. You'd have to read through <code>filenames</code>, store it into a slice, then initialize sizes and <code>for</code> over <code>range filenamesSlice</code> and.... yeah basically you've just re-written the whole function at that point.</p>\n"}], "owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 34822205, "answer_count": 1, "score": 1, "last_activity_date": 1452905475, "creation_date": 1452887532, "question_id": 34818798, "link": "https://stackoverflow.com/questions/34818798/sync-waitgroup-why-closer-in-a-goroutine", "title": "Sync.WaitGroup, why closer in a goroutine", "body": "<p>Below is the example code in the Go programming book. I do not understand why the closer needs to be its own goroutine. I tried to move the <strong>closer</strong> into the main but it crashes. Somebody could explain why the closer needs to be in a separate goroutine?</p>\n\n<p>Thanks!</p>\n\n<pre><code>func makeThumbnails(filenames &lt;-chan string, result chan&lt;- int64) int64 {\n  sizes := make(chan int64)\n  var wg sync.WaitGroup\n  for f := range filenames {\n      wg.Add(1)\n      go func(f string) {\n        defer wg.Done()\n        sizes &lt;- int64(len(f))\n      }(f)\n  }\n\n  // **closer**, why this guy needs to be in a goroutine???\n  go func() {\n    wg.Wait()\n    close(sizes)\n  }()\n\n  var total int64\n  for size := range sizes {\n    total += size\n  }\n  result &lt;- total\n  return total\n}\n</code></pre>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452886452, "post_id": 34817188, "comment_id": 57379186, "body": "Your edit is probably more like what you intended, but then there&#39;s no point to the interface, since you can only assign the exact same type."}, {"owner": {"reputation": 907, "user_id": 1279730, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c143e62707810f29f4fb207c1cf797ad?s=128&d=identicon&r=PG", "display_name": "machete", "link": "https://stackoverflow.com/users/1279730/machete"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452890509, "post_id": 34817188, "comment_id": 57381276, "body": "yup absolutely right :D"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1452918675, "post_id": 34817188, "comment_id": 57389351, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33841630/set-an-interface-to-nil-in-golang\">Set an interface to nil in Golang</a>"}], "answers": [{"comments": [{"owner": {"reputation": 907, "user_id": 1279730, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c143e62707810f29f4fb207c1cf797ad?s=128&d=identicon&r=PG", "display_name": "machete", "link": "https://stackoverflow.com/users/1279730/machete"}, "edited": false, "score": 0, "creation_date": 1452890750, "post_id": 34817347, "comment_id": 57381408, "body": "ok one more question then, how does it work that <code>json.Encode(interface{})</code> or <code>gob.Encode(interface{})</code> use interfaces as args but are still able to write the values somehow"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 907, "user_id": 1279730, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c143e62707810f29f4fb207c1cf797ad?s=128&d=identicon&r=PG", "display_name": "machete", "link": "https://stackoverflow.com/users/1279730/machete"}, "edited": false, "score": 1, "creation_date": 1452892573, "post_id": 34817347, "comment_id": 57382376, "body": "@machete: Those use reflection and type assertions, and you have to pass in a pointer to be assigned. You still can&#39;t change the dynamic type of the interface, i.e. if you pass in a <code>*string</code>, you can&#39;t replace it with an <code>*int</code>. A similar function via reflection: <a href=\"http://play.golang.org/p/u_lBBPeRfz\" rel=\"nofollow noreferrer\">play.golang.org/p/u_lBBPeRfz</a>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1452886384, "last_edit_date": 1452886384, "creation_date": 1452882021, "answer_id": 34817347, "question_id": 34817188, "link": "https://stackoverflow.com/questions/34817188/replace-value-of-interface/34817347#34817347", "title": "Replace value of interface", "body": "<p>Like most things in Go, interfaces are simply values. Assigning a new value within a function isn't going to change the value copied into the function arguments. </p>\n\n<p>Because you want to replace the interface value, you need a pointer to the value just like you would any other. It's a very rare case where you could use a pointer to an interface: <a href=\"http://play.golang.org/p/EZEh3X8yHC\" rel=\"nofollow\">http://play.golang.org/p/EZEh3X8yHC</a></p>\n\n<pre><code>func swap(fooer *Fooer) {\n    z := Fooer(&amp;Foo{foo: \"new\"})\n    *fooer = z\n}\n\nfunc main() {\n    var f Fooer = &amp;Foo{foo: \"old\"}\n    fmt.Printf(\"%s (want &amp;{old})\\n\", f)\n    swap(&amp;f)\n    fmt.Printf(\"%s (want &amp;{new})\", f)\n}\n</code></pre>\n\n<p>But, since a pointer to an interface is almost always a mistake (you can see we have to be very explicit to make this work), you should <em>really</em> have a good reason for implementing something this way, and document it well.</p>\n\n<p>What you most likely want is to extract the pointer from the interface, and assign a new value in there (which is what you added to end of your question). This is a much better construct, but the type must match, so the interface isn't needed. </p>\n"}], "owner": {"reputation": 907, "user_id": 1279730, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c143e62707810f29f4fb207c1cf797ad?s=128&d=identicon&r=PG", "display_name": "machete", "link": "https://stackoverflow.com/users/1279730/machete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3496, "favorite_count": 0, "accepted_answer_id": 34817347, "answer_count": 1, "score": 2, "last_activity_date": 1452886384, "creation_date": 1452881386, "last_edit_date": 1452881994, "question_id": 34817188, "link": "https://stackoverflow.com/questions/34817188/replace-value-of-interface", "title": "Replace value of interface", "body": "<p>I want to replace an interface's value like this:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\ntype Fooer interface {Foo(string)}\n\ntype Foo struct {foo string}\n\nfunc (f *Foo) Foo(bar string) {f.foo = bar}\n\nvar z = &amp;Foo{foo : \"new\"}\n\nfunc swap(fooer Fooer) {fooer = z}\n\nfunc main() {\n    f :=  &amp;Foo{foo: \"old\"}\n    fmt.Printf(\"%s (want &amp;{old})\\n\", f)\n    swap(f)\n    fmt.Printf(\"%s (want &amp;{new})\", f)\n}\n</code></pre>\n\n<p>But i get:</p>\n\n<pre><code>&amp;{old}\n&amp;{old}\n</code></pre>\n\n<p>I tried around with various calls (<code>fooer *= z</code>, <code>*fooer = *z</code>, ..) but I cant seem to get it right.</p>\n\n<p>You can try this example at play.golang: <a href=\"http://play.golang.org/p/EZEh3X8yHC\" rel=\"nofollow\">http://play.golang.org/p/EZEh3X8yHC</a></p>\n\n<hr>\n\n<p>Okay, I think it works like this:</p>\n\n<pre><code>func swap(fooer Fooer) {\n    foo, _ := fooer.(*Foo)\n    *foo = *z\n}\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1452895073, "post_id": 34816839, "comment_id": 57383659, "body": "side comment: Id should be ID. <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#initialisms\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/CodeReviewComments#initialisms</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4817, "user_id": 3817025, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/02fd68a33285e876c0b9652ccb9fbc3a?s=128&d=identicon&r=PG", "display_name": "Jeff Sloyer", "link": "https://stackoverflow.com/users/3817025/jeff-sloyer"}, "edited": false, "score": 0, "creation_date": 1452956667, "post_id": 34820704, "comment_id": 57398501, "body": "That did not work, I got the following...  <code>[2016-01-16 10:04:11]  invalid association [column:pickup_nyct2010_gid]  </code>"}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "reply_to_user": {"reputation": 4817, "user_id": 3817025, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/02fd68a33285e876c0b9652ccb9fbc3a?s=128&d=identicon&r=PG", "display_name": "Jeff Sloyer", "link": "https://stackoverflow.com/users/3817025/jeff-sloyer"}, "edited": false, "score": 0, "creation_date": 1452958922, "post_id": 34820704, "comment_id": 57399237, "body": "Sorry. See updated answer. I will try to reproduce your error meanwhile. Can you post a sql with a table creation script?"}, {"owner": {"reputation": 4817, "user_id": 3817025, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/02fd68a33285e876c0b9652ccb9fbc3a?s=128&d=identicon&r=PG", "display_name": "Jeff Sloyer", "link": "https://stackoverflow.com/users/3817025/jeff-sloyer"}, "edited": false, "score": 0, "creation_date": 1453073852, "post_id": 34820704, "comment_id": 57430875, "body": "I now get the following.  It seems gorm is ignoring the correct field and wants to use <code>id</code> instead.  <code>[2016-01-17 18:36:39]  [124.81ms]  SELECT  * FROM &quot;trips&quot;  WHERE (&quot;id&quot; = &#39;2112111736&#39;) ORDER BY &quot;trips&quot;.&quot;id&quot; ASC LIMIT 1</code>   <code>[2016-01-17 18:36:39]  pq: column &quot;id&quot; does not exist </code>  <code>[2016-01-17 18:36:39]  [57.39ms]  SELECT  * FROM &quot;nyct2010&quot;  WHERE (&quot;id&quot; = &#39;1475&#39;) [2016-01-17 18:36:39]  pq: column &quot;id&quot; does not exist</code>"}], "tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": false, "score": 0, "last_activity_date": 1452958864, "last_edit_date": 1452958864, "creation_date": 1452895722, "answer_id": 34820704, "question_id": 34816839, "link": "https://stackoverflow.com/questions/34816839/one-one-relationship-with-different-table-namesin-gorm/34820704#34820704", "title": "One-one relationship with different table namesin Gorm", "body": "<p>Try this:</p>\n\n<pre><code>type Nyct2010 struct {\n    ID        uint `gorm:\"primary_key column:gid\"`\n    Borocode  int\n}\n\nvar trip Trip\nvar nyct2010 Nyct2010\n\ndb.First(&amp;trip, 2112111736)\ndb.Model(&amp;trip).Related(&amp;nyct2010,\"pickup_nyct2010_gid\")\n</code></pre>\n"}], "owner": {"reputation": 4817, "user_id": 3817025, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/02fd68a33285e876c0b9652ccb9fbc3a?s=128&d=identicon&r=PG", "display_name": "Jeff Sloyer", "link": "https://stackoverflow.com/users/3817025/jeff-sloyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452958864, "creation_date": 1452879912, "question_id": 34816839, "link": "https://stackoverflow.com/questions/34816839/one-one-relationship-with-different-table-namesin-gorm", "title": "One-one relationship with different table namesin Gorm", "body": "<p>I have the following tables.</p>\n\n<p><strong>nyct2010</strong>\n<a href=\"https://i.stack.imgur.com/gFfnt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gFfnt.png\" alt=\"enter image description here\"></a></p>\n\n<p>and</p>\n\n<p><strong>trips</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/UoBJy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UoBJy.png\" alt=\"enter image description here\"></a></p>\n\n<p>The models I have defined are below.</p>\n\n<pre><code>type Nyct2010 struct {\n    Id      int `gorm:\"column:gid\"`\n    Borocode int\n}\n\ntype Trip struct {\n    Id               int\n    PickupLongitude  float64   `gorm:\"column:pickup_longitude\"`\n    PickupLatitude   float64   `gorm:\"column:pickup_latitude\"`\n    DropoffLongitude float64   `gorm:\"column:dropoff_longitude\"`\n    DropoffLatitude  float64   `gorm:\"column:dropoff_latitude\"`\n    PickupTime       time.Time `gorm:\"column:pickup_datetime\"`\n    DropoffTime      time.Time `gorm:\"column:dropoff_datetime\"`\n    Fare             float64   `gorm:\"column:fare_amount\"`\n    Tip              float64   `gorm:\"column:tip_amount\"`\n    Total            float64   `gorm:\"column:total_amount\"`\n    PaymentType      string    `gorm:\"column:payment_type\"`\n    Tax              float64   `gorm:\"column:mta_tax\"`\n\n    Nyct2010   Nyct2010\n    Nyct2010Id int `gorm:\"column:pickup_nyct2010_gid\"`\n}\n</code></pre>\n\n<p>I am trying to get the related entry from <code>nyct2010</code>.  It is related to <code>pickup_nyc2010_gid</code>.</p>\n\n<pre><code>var trip Trip\ndb.First(&amp;trip, 2112111736)\n\ndb.Model(trip).Related(&amp;trip.Nyct2010)\n</code></pre>\n\n<p>The above code produces the following debug messages.</p>\n\n<pre><code>[2016-01-15 12:34:04]  [160.31ms]  SELECT  * FROM \"trips\"  WHERE (\"id\" = '2112111736') ORDER BY \"trips\".\"id\" ASC LIMIT 1\n\n[2016-01-15 12:34:04]  pq: zero-length delimited identifier at or near \"\"\"\" \n\n[2016-01-15 12:34:04]  [77.29ms]  SELECT  * FROM \"nyct2010\"  WHERE (\"\" = '1475')\n\n[2016-01-15 12:34:04]  pq: zero-length delimited identifier at or near \"\"\"\" \n</code></pre>\n\n<p>For some reason gorm is ignoring the field that I am mapping <code>Nyct2010.Id</code> to, I am trying to map it to <code>Nyct2010.gid</code>.</p>\n\n<p>Am I going about this wrong or is this an error with Gorm?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1452879611, "post_id": 34816623, "comment_id": 57375621, "body": "thx, for the answer, I know that I don&#39;t need a custom type and that I can use sort.StringSplice(s); the other thing is I don&#39;t want to sort, just to return the reverse."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1452880099, "post_id": 34816623, "comment_id": 57375887, "body": "@RockNinja See edit. As you already know, <code>sort.Reverse</code> doesn&#39;t do what you want, but it&#39;s still easy to do."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 12, "last_activity_date": 1452880065, "last_edit_date": 1452880065, "creation_date": 1452879123, "answer_id": 34816623, "question_id": 34816489, "link": "https://stackoverflow.com/questions/34816489/reverse-slice-of-strings/34816623#34816623", "title": "Reverse Slice of strings", "body": "<p><a href=\"https://golang.org/pkg/sort/#Reverse\" rel=\"noreferrer\"><code>sort.Reverse</code></a> doesn't sort the data, but rather returns a new <code>sort.Interface</code> that will sort the data in reverse order. So you don't really need your own type:</p>\n\n<pre><code>func Reverse(input string) string {\n    s := strings.Split(input, \" \")\n    sort.Sort(sort.Reverse(sort.StringSlice(s)))\n    return strings.Join(s, \" \")\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/w49FDCEHo3\" rel=\"noreferrer\">http://play.golang.org/p/w49FDCEHo3</a>.</p>\n\n<p><strong>EDIT:</strong> If you just need to reverse a slice of strings, just do:</p>\n\n<pre><code>func reverse(ss []string) {\n    last := len(ss) - 1\n    for i := 0; i &lt; len(ss)/2; i++ {\n        ss[i], ss[last-i] = ss[last-i], ss[i]\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/UptIRFV_SI\" rel=\"noreferrer\">http://play.golang.org/p/UptIRFV_SI</a></p>\n"}, {"comments": [{"owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1452879839, "post_id": 34816629, "comment_id": 57375746, "body": "I wanted to reverse my string without sorting it, and I played a bit with sort.Reverse and I had the feeling that is reversing the input without being wrapped by sort.Sort, my bad :("}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1452880101, "post_id": 34816629, "comment_id": 57375888, "body": "@RockNinja: if you don&#39;t want to sort it, don&#39;t use the &quot;sort&quot; package -- just reverse the slice yourself."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1452879143, "creation_date": 1452879143, "answer_id": 34816629, "question_id": 34816489, "link": "https://stackoverflow.com/questions/34816489/reverse-slice-of-strings/34816629#34816629", "title": "Reverse Slice of strings", "body": "<p>Nothing is wrong with your <code>RevStr</code> type (though you could just use <code>sort.StringSlice</code>). You're not calling <code>sort.Sort</code> on the reversed implementation:</p>\n\n<p><a href=\"https://golang.org/pkg/sort/#example_Reverse\" rel=\"nofollow\">https://golang.org/pkg/sort/#example_Reverse</a></p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc main() {\n    s := []int{5, 2, 6, 3, 1, 4} // unsorted\n    sort.Sort(sort.Reverse(sort.IntSlice(s)))\n    fmt.Println(s)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1853, "user_id": 3186886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3336bbf9f0d7330e06dc19753106a322?s=128&d=identicon&r=PG", "display_name": "mraron", "link": "https://stackoverflow.com/users/3186886/mraron"}, "is_accepted": false, "score": 2, "last_activity_date": 1452932486, "creation_date": 1452932486, "answer_id": 34824969, "question_id": 34816489, "link": "https://stackoverflow.com/questions/34816489/reverse-slice-of-strings/34824969#34824969", "title": "Reverse Slice of strings", "body": "<p>Although @Ainar-G has provided a way to reverse a slice of strings, I think it's nicer to use two variables in for loop to reverse. But it's only my personal opinion, a matter of style :)</p>\n\n<pre><code>func reverse(s []string) []string {\n    for i, j := 0, len(s)-1; i &lt; j; i, j = i+1, j-1 {\n        s[i], s[j] = s[j], s[i]\n    }\n    return s\n}\n</code></pre>\n\n<p>Playground link with example of usage: <a href=\"http://play.golang.org/p/v1Cy61NFv1\" rel=\"nofollow\">http://play.golang.org/p/v1Cy61NFv1</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15128668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kECVH.png?s=128&g=1", "display_name": "andhikaprbw", "link": "https://stackoverflow.com/users/15128668/andhikaprbw"}, "is_accepted": false, "score": 0, "last_activity_date": 1619021545, "creation_date": 1619021545, "answer_id": 67199574, "question_id": 34816489, "link": "https://stackoverflow.com/questions/34816489/reverse-slice-of-strings/67199574#67199574", "title": "Reverse Slice of strings", "body": "<p>More simple way, without using built-in sorting feature :</p>\n<pre><code>   func reverse(s []string) []string {\n       for i := len(s) - 1; i &gt;= 0; i-- {\n         result = append(result, s[i])\n       }\n    return s\n   }\n</code></pre>\n"}], "owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10955, "favorite_count": 0, "accepted_answer_id": 34816623, "answer_count": 4, "score": 4, "last_activity_date": 1619021545, "creation_date": 1452878506, "last_edit_date": 1452879624, "question_id": 34816489, "link": "https://stackoverflow.com/questions/34816489/reverse-slice-of-strings", "title": "Reverse Slice of strings", "body": "<p>I don't understand what is wrong with the below implementation, I had a look at <code>sort.StringSlice</code> and it looks the same.</p>\n\n<pre><code>type RevStr []string\n\nfunc(s RevStr) Len() int { return len(s) }\nfunc(s RevStr) Less(i, j int) bool { return s[i] &lt; s[j] }\nfunc(s RevStr) Swap(i, j int) { s[i], s[j] = s[j], s[i] }\n\nfunc Reverse(input string) string {\n  rs := RevStr(strings.Split(input, \" \"))\n  sort.Reverse(rs)\n  return strings.Join(rs, \" \")\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 3087000, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/4dd1dcaf7efecd574bb2273a5a8c06fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3087000", "link": "https://stackoverflow.com/users/3087000/user3087000"}, "edited": false, "score": 0, "creation_date": 1452876111, "post_id": 34815762, "comment_id": 57373677, "body": "Thank you. So if you have any better solution to this problem?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 641, "user_id": 3087000, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/4dd1dcaf7efecd574bb2273a5a8c06fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3087000", "link": "https://stackoverflow.com/users/3087000/user3087000"}, "edited": false, "score": 0, "creation_date": 1452876208, "post_id": 34815762, "comment_id": 57373729, "body": "@user3087000: yes, don&#39;t use relative imports, and structure your code as described in the docs: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 641, "user_id": 3087000, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/4dd1dcaf7efecd574bb2273a5a8c06fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3087000", "link": "https://stackoverflow.com/users/3087000/user3087000"}, "edited": false, "score": 0, "creation_date": 1452876527, "post_id": 34815762, "comment_id": 57373932, "body": "But like the code I posted in the content, I need a way to organize my models. How can I achieve the same goal but not use the relative path?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 641, "user_id": 3087000, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/4dd1dcaf7efecd574bb2273a5a8c06fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3087000", "link": "https://stackoverflow.com/users/3087000/user3087000"}, "edited": false, "score": 0, "creation_date": 1452877094, "post_id": 34815762, "comment_id": 57374258, "body": "@user3087000: Use the full import path, which is rooted at <code>$GOPATH&#47;src&#47;</code>, e.g. <code>project&#47;models</code>. Please read through the document I linked, which provides many examples."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1452876176, "last_edit_date": 1452876176, "creation_date": 1452875864, "answer_id": 34815762, "question_id": 34815455, "link": "https://stackoverflow.com/questions/34815455/golang-why-cant-i-import-local-package-in-gopath-src-project-but-can-in-home/34815762#34815762", "title": "Golang - Why can&#39;t I import local package in GOPATH/src/project but can in home directory?", "body": "<p><a href=\"https://golang.org/cmd/go/#hdr-Relative_import_paths\" rel=\"nofollow\">Relative import paths</a> are only allowed as a convenience, mostly for experimentation. They are not fully supported by <code>go build</code> and <code>go install</code>. If you want your package to work with the <code>go</code> tools, don't use relative imports. Structure your code as described in <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How to Write Go Code</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 641, "user_id": 3087000, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/4dd1dcaf7efecd574bb2273a5a8c06fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3087000", "link": "https://stackoverflow.com/users/3087000/user3087000"}, "edited": false, "score": 0, "creation_date": 1452876214, "post_id": 34815799, "comment_id": 57373735, "body": "I have run <code>go get</code> before <code>go run</code>. As I said, it only not wok inside GOPATH/src."}], "tags": [], "owner": {"reputation": 21, "user_id": 3332833, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000894475192/picture?type=large", "display_name": "Prashant Kumar", "link": "https://stackoverflow.com/users/3332833/prashant-kumar"}, "is_accepted": false, "score": -1, "last_activity_date": 1452876013, "creation_date": 1452876013, "answer_id": 34815799, "question_id": 34815455, "link": "https://stackoverflow.com/questions/34815455/golang-why-cant-i-import-local-package-in-gopath-src-project-but-can-in-home/34815799#34815799", "title": "Golang - Why can&#39;t I import local package in GOPATH/src/project but can in home directory?", "body": "<p>As you are using \"github.com/gin-gonic/gin\" in your code. It is an external import. So go compiler will try to find this package in your workspace. So you need manually download those package in your go workspace or build path\n\"go get github.com/gin-gonic/gin\".</p>\n"}], "owner": {"reputation": 641, "user_id": 3087000, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/4dd1dcaf7efecd574bb2273a5a8c06fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3087000", "link": "https://stackoverflow.com/users/3087000/user3087000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5667, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1452876176, "creation_date": 1452874894, "question_id": 34815455, "link": "https://stackoverflow.com/questions/34815455/golang-why-cant-i-import-local-package-in-gopath-src-project-but-can-in-home", "title": "Golang - Why can&#39;t I import local package in GOPATH/src/project but can in home directory?", "body": "<p>I have a project, its folder structure is like following:</p>\n\n<pre><code>    /project\n        models/\n            Product.go\n        main.go\n</code></pre>\n\n<p>The content of main.go is:</p>\n\n<pre><code>package main\n\nimport (\n    \"./models\"\n    \"fmt\"\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    r := gin.Default()\n    fmt.Println(models.Product{})\n    r.GET(\"/\", func(c *gin.Context) {\n        c.String(200, \"he\")\n    })\n\n    r.Run(\":3000\")\n}\n</code></pre>\n\n<p>The content of Product.go is:</p>\n\n<pre><code>package models\n\ntype Product struct {\n    Name string\n}\n</code></pre>\n\n<p>What I get from typing <code>go env</code> is:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/Mac/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/Cellar/go/1.5.3/libexec\"\nGOTOOLDIR=\"/usr/local/Cellar/go/1.5.3/libexec/pkg/tool/darwin_amd64\"\nGO15VENDOREXPERIMENT=\"\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -    fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>When the location of the project directory is <code>$GOPATH/src/project</code>, If I run <code>go run main.go</code>, what I get is this error message: <code>./main.go:: can't find import: \"github.com/gin-gonic/gin\"</code>.</p>\n\n<p>But when the location of project directory is <code>~/project</code>, <code>go run main.go</code> can work as expected.</p>\n\n<p>I use go1.5.3.</p>\n\n<p>Can anyone help me. Thanks.</p>\n"}, {"tags": ["go", "ldap"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452873767, "post_id": 34814834, "comment_id": 57372206, "body": "Just like the error says, the client library is trying to connect with StartTLS, which the server doesn&#39;t support. Is &quot;github.com/jtblin/go-ldap-client&quot; your code, or have you actually checked that someone&#39;s github repo with a single commit and no unit tests does what you expect?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 4, "creation_date": 1452874706, "post_id": 34814834, "comment_id": 57372816, "body": "<a href=\"https://github.com/jtblin/go-ldap-client/blob/master/ldap-client.go#L39\" rel=\"nofollow noreferrer\">This</a>. So, I&#39;d recommend to just use <a href=\"https://gopkg.in/ldap.v2\" rel=\"nofollow noreferrer\">gopkg.in/ldap.v2</a> directly. Contrary to what the author of the wrapper library you&#39;re using wrote in their README, using a low-level LDAP library is not hard (I know from the experience) and provides you with a full control over what is being done. <code>go-ldap-client</code> is a works-in-my-environment product: if it works in yours, great; if it isn&#39;t -- you&#39;re on your own."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1452874861, "post_id": 34814834, "comment_id": 57372930, "body": "To provide more background, SSL/TLS can be used in LDAP on two levels: 1) the LDAP server might listen on a port which speaks SSL/TLS right away. That&#39;s what controlled by the <code>UseSSL</code> setting. 2) the LDAP server might accept a special protocol command, typically known as &quot;STARTTLS&quot; (it&#39;s also present in extensions to SMTP, and IMAP for instance). Should the server support this command, the client might use it to &quot;upgrade&quot; the current connection to an SSL/TLS tunnel and then restart exchanging LDAP traffic over it."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1452875034, "post_id": 34814834, "comment_id": 57373045, "body": "The author of <code>go-ldap-client</code> should check the error returned from attempting to use <code>STARTTLS</code> and supposedly fallback to not using SSL/TLS at all if the server rejected that command.  Now look closer: <code>go-ldap-client</code> explicitly disables validation of the server&#39;s certificate during the STARTTLS handshake, making it prone to MitM attacks. In reality it must be <i>your</i> decision, and you have to have full control over this. So, again, I&#39;d recommend to just be explicit and use <code>gopkg.in&#47;ldap.v2</code>."}, {"owner": {"reputation": 2341, "user_id": 2188467, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/68085543cab0d93a5955c41b551754ed?s=128&d=identicon&r=PG&f=1", "display_name": "Christos Papoulas", "link": "https://stackoverflow.com/users/2188467/christos-papoulas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452876784, "post_id": 34814834, "comment_id": 57374079, "body": "@JimB: No it is not my code, but something that I have cloned"}, {"owner": {"reputation": 2341, "user_id": 2188467, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/68085543cab0d93a5955c41b551754ed?s=128&d=identicon&r=PG&f=1", "display_name": "Christos Papoulas", "link": "https://stackoverflow.com/users/2188467/christos-papoulas"}, "edited": false, "score": 0, "creation_date": 1452876958, "post_id": 34814834, "comment_id": 57374175, "body": "kostix:Thanks for your feedback. It really helpfull. Finally I overcome the error using the <code>ldap.v1</code> with the <code>go-ldap-client</code> but after your considerations I will implement my own with <code>ldap.v2</code>"}, {"owner": {"reputation": 464, "user_id": 2023188, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ePBsH.jpg?s=128&g=1", "display_name": "antman1p", "link": "https://stackoverflow.com/users/2023188/antman1p"}, "edited": false, "score": 0, "creation_date": 1485364546, "post_id": 34814834, "comment_id": 70899060, "body": "@ChristosPapoulas how did you get this to work?  Or can anyone explain to me how to get the user&#39;s groups, using ldap.v2 ?"}, {"owner": {"reputation": 1589, "user_id": 470769, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/dbe3fcaf80de993f945b9e71d0a31c30?s=128&d=identicon&r=PG", "display_name": "Dan Tenenbaum", "link": "https://stackoverflow.com/users/470769/dan-tenenbaum"}, "edited": false, "score": 0, "creation_date": 1576686344, "post_id": 34814834, "comment_id": 104981711, "body": "I don&#39;t know if it matters, but <code>readonlysuer</code> is probably supposed to be <code>readonlyuser</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "is_accepted": true, "score": 12, "last_activity_date": 1503990782, "last_edit_date": 1503990782, "creation_date": 1475502093, "answer_id": 39833111, "question_id": 34814834, "link": "https://stackoverflow.com/questions/34814834/golang-communicate-with-ldap/39833111#39833111", "title": "Golang communicate with LDAP", "body": "<p>Ok, so let's try authentication using <code>github.com/go-ldap/ldap</code>. First you need to create a an <code>*ldap.Conn</code>. I suggest using TLS, if your LDAP server supports it:</p>\n\n<pre><code>// TLS, for testing purposes disable certificate verification, check https://golang.org/pkg/crypto/tls/#Config for further information.\ntlsConfig := &amp;tls.Config{InsecureSkipVerify: true}\nl, err := ldap.DialTLS(\"tcp\", \"ldap.example.com:636\", tlsConfig)\n\n// No TLS, not recommended\nl, err := ldap.Dial(\"tcp\", \"ldap.example.com:389\")\n</code></pre>\n\n<p>Now you should have an active connection to your LDAP server. Using this connection you have to execute a bind:</p>\n\n<pre><code>err := l.Bind(\"user@test.com\", \"password\")\nif err != nil {\n    // error in ldap bind\n    log.Println(err)\n}\n// successful bind\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2477, "user_id": 2378429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3208c57486859807197c6d3125ba137?s=128&d=identicon&r=PG", "display_name": "O.O.Balance", "link": "https://stackoverflow.com/users/2378429/o-o-balance"}, "edited": false, "score": 0, "creation_date": 1526379109, "post_id": 50347181, "comment_id": 87710937, "body": "Please format your post properly and add some more details: How does that line solve the OP&#39;s problem, and where should it be applied?"}], "tags": [], "owner": {"reputation": 75, "user_id": 6588057, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XKJ6Jj8WUsc/AAAAAAAAAAI/AAAAAAAAAFU/8MU1MmmR5a8/photo.jpg?sz=128", "display_name": "vaishnavi athipatla", "link": "https://stackoverflow.com/users/6588057/vaishnavi-athipatla"}, "is_accepted": false, "score": -2, "last_activity_date": 1526377918, "creation_date": 1526377918, "answer_id": 50347181, "question_id": 34814834, "link": "https://stackoverflow.com/questions/34814834/golang-communicate-with-ldap/50347181#50347181", "title": "Golang communicate with LDAP", "body": "<p>In one line we can say..</p>\n\n<p>conn, err := ldap.DialTLS(\"tcp\", ldapServer, &amp;tls.Config{InsecureSkipVerify: true})</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 13614941, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hPaFJpwhtWA/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnL5bjmjjB01CEIH6eU8vJLVnBiNg/photo.jpg?sz=128", "display_name": "shaj13", "link": "https://stackoverflow.com/users/13614941/shaj13"}, "is_accepted": false, "score": 0, "last_activity_date": 1590796190, "creation_date": 1590796190, "answer_id": 62096147, "question_id": 34814834, "link": "https://stackoverflow.com/questions/34814834/golang-communicate-with-ldap/62096147#62096147", "title": "Golang communicate with LDAP", "body": "<p>Another possible solution to use <a href=\"https://github.com/shaj13/go-guardian\" rel=\"nofollow noreferrer\">go-guardian</a> <a href=\"https://pkg.go.dev/github.com/shaj13/go-guardian@v1.0.0/auth/strategies/ldap?tab=doc\" rel=\"nofollow noreferrer\">LDAP strategy</a></p>\n\n<p>A working example based on <a href=\"https://www.forumsys.com/tutorials/integration-how-to/ldap/online-ldap-test-server/\" rel=\"nofollow noreferrer\">Online LDAP Test Server</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/shaj13/go-guardian/auth/strategies/ldap\"\n    \"net/http\"\n)\n\nfunc main() {\n    cfg := ldap.Config{\n        BaseDN:       \"dc=example,dc=com\",\n        BindDN:       \"cn=read-only-admin,dc=example,dc=com\",\n        Port:         \"389\",\n        Host:         \"ldap.forumsys.com\",\n        BindPassword: \"password\",\n        Filter:       \"(uid=%s)\",\n    }\n\n    r, _ := http.NewRequest(\"GET\", \"/\", nil)\n    r.SetBasicAuth(\"tesla\", \"password\")\n\n    user, err := ldap.New(&amp;cfg).Authenticate(r.Context(), r)\n    fmt.Println(user, err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 4511042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vza0g.jpg?s=128&g=1", "display_name": "Sumit Jindal", "link": "https://stackoverflow.com/users/4511042/sumit-jindal"}, "is_accepted": false, "score": 0, "last_activity_date": 1591348393, "last_edit_date": 1591348393, "creation_date": 1591254822, "answer_id": 62188823, "question_id": 34814834, "link": "https://stackoverflow.com/questions/34814834/golang-communicate-with-ldap/62188823#62188823", "title": "Golang communicate with LDAP", "body": "<p>The issue is that by default the \"SkipTLS\" flag is not set in the aforementioned LDAP client. You need to explicitly set the parameter to false:</p>\n\n<pre><code>client := &amp;ldap.LDAPClient{\n        Base:         \"dc=example,dc=com\",\n        Host:         \"ldap.example.com\",\n        Port:         389,\n        UseSSL:       false,\n        BindDN:       \"uid=readonlysuer,ou=People,dc=example,dc=com\",\n        BindPassword: \"readonlypassword\",\n        UserFilter:   \"(uid=%s)\",\n        GroupFilter:  \"(memberUid=%s)\",\n        SkipTLS:      true,\n        Attributes:   []string{\"givenName\", \"sn\", \"mail\", \"uid\"},\n    }\n</code></pre>\n\n<p>I set the SkipTLS to true and it worked.\nHope this helps!</p>\n"}], "owner": {"reputation": 2341, "user_id": 2188467, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/68085543cab0d93a5955c41b551754ed?s=128&d=identicon&r=PG&f=1", "display_name": "Christos Papoulas", "link": "https://stackoverflow.com/users/2188467/christos-papoulas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17716, "favorite_count": 2, "accepted_answer_id": 39833111, "answer_count": 4, "score": 7, "last_activity_date": 1591348393, "creation_date": 1452872891, "question_id": 34814834, "link": "https://stackoverflow.com/questions/34814834/golang-communicate-with-ldap", "title": "Golang communicate with LDAP", "body": "<p>I'm trying to connect and authenticate a user to ldap with golang.</p>\n\n<p>I'm using the <a href=\"https://github.com/jtblin/go-ldap-client\" rel=\"noreferrer\">go-ldap-client</a> with the following example code:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"github.com/jtblin/go-ldap-client\"\n)\n\nfunc main() {\n    client := &amp;ldap.LDAPClient{\n        Base:         \"dc=example,dc=com\",\n        Host:         \"ldap.example.com\",\n        Port:         389,\n        UseSSL:       false,\n        BindDN:       \"uid=readonlysuer,ou=People,dc=example,dc=com\",\n        BindPassword: \"readonlypassword\",\n        UserFilter:   \"(uid=%s)\",\n        GroupFilter: \"(memberUid=%s)\",\n        Attributes:   []string{\"givenName\", \"sn\", \"mail\", \"uid\"},\n    }\n    # It is the responsibility of the caller to close the connection\n    defer client.Close()\n\n    ok, user, err := client.Authenticate(\"username\", \"password\")\n    if err != nil {\n        log.Fatalf(\"Error authenticating user %s: %+v\", \"username\", err)\n    }\n    if !ok {\n        log.Fatalf(\"Authenticating failed for user %s\", \"username\")\n    }\n    log.Printf(\"User: %+v\", user)\n\n    groups, err := client.GetGroupsOfUser(\"username\")\n    if err != nil {\n        log.Fatalf(\"Error getting groups for user %s: %+v\", \"username\", err)\n    }\n    log.Printf(\"Groups: %+v\", groups) \n}\n</code></pre>\n\n<p>The dependency to gopkg.in/ldap.v2 is installed. </p>\n\n<p>The <strong>problem</strong> is that I'm getting the following <strong>error</strong>:</p>\n\n<pre><code>2016/01/15 17:34:55 Error authenticating user username: LDAP Result Code 2 \"Protocol Error\": ldap: cannot StartTLS (unsupported extended operation)\nexit status 1\n</code></pre>\n\n<p>Any hint about this error?</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-sdk", "aws-device-farm"], "comments": [{"owner": {"reputation": 2826, "user_id": 3179469, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/100002493023511/picture?type=large", "display_name": "Elheni Mokhles", "link": "https://stackoverflow.com/users/3179469/elheni-mokhles"}, "edited": false, "score": 0, "creation_date": 1506692032, "post_id": 34813647, "comment_id": 79934350, "body": "can you provide the solution code"}, {"owner": {"reputation": 760, "user_id": 4816308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lDkUFTTPIwE/AAAAAAAAAAI/AAAAAAAAAGE/OZsIpsn7ebU/photo.jpg?sz=128", "display_name": "Artem Nikitin", "link": "https://stackoverflow.com/users/4816308/artem-nikitin"}, "reply_to_user": {"reputation": 2826, "user_id": 3179469, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/100002493023511/picture?type=large", "display_name": "Elheni Mokhles", "link": "https://stackoverflow.com/users/3179469/elheni-mokhles"}, "edited": false, "score": 0, "creation_date": 1506692465, "post_id": 34813647, "comment_id": 79934606, "body": "Something like that: <a href=\"https://gist.github.com/artemnikitin/d8caa2862c0b7762064f5fec39804f91\" rel=\"nofollow noreferrer\">gist.github.com/artemnikitin/d8caa2862c0b7762064f5fec39804f9&zwnj;&#8203;1</a>"}], "answers": [{"comments": [{"owner": {"reputation": 760, "user_id": 4816308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lDkUFTTPIwE/AAAAAAAAAAI/AAAAAAAAAGE/OZsIpsn7ebU/photo.jpg?sz=128", "display_name": "Artem Nikitin", "link": "https://stackoverflow.com/users/4816308/artem-nikitin"}, "edited": false, "score": 0, "creation_date": 1452942164, "post_id": 34818308, "comment_id": 57394194, "body": "Thanks for an answer. It was really unclear, that I need to use pre-signed URL. But it still don&#39;t work for me.  Based on your link I should send a simple HTTP PUT request with file in body. I do that and in response I got HTTP 403 with an error  <code>&lt;Code&gt;SignatureDoesNotMatch&lt;&#47;Code&gt; &lt;Message&gt;The request signature we calculated does not match the signature you provided. Check your key and signing method.&lt;&#47;Message&gt; </code>"}, {"owner": {"reputation": 760, "user_id": 4816308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lDkUFTTPIwE/AAAAAAAAAAI/AAAAAAAAAGE/OZsIpsn7ebU/photo.jpg?sz=128", "display_name": "Artem Nikitin", "link": "https://stackoverflow.com/users/4816308/artem-nikitin"}, "edited": false, "score": 0, "creation_date": 1452971046, "post_id": 34818308, "comment_id": 57403459, "body": "If in <code>&amp;devicefarm.CreateUploadInput</code> specify <code>ContentType: aws.String(&quot;application&#47;octet-stream&quot;)</code> and set the same header in the PUT request after, then error will be different: HTTP 501 <code>&lt;Code&gt;NotImplemented&lt;&#47;Code&gt;&lt;Message&gt;A header you provided implies functionality that is not implemented&lt;&#47;Message&gt;&lt;Header&gt;Transfer-Encoding&lt;&#47;Header&gt;</code>"}, {"owner": {"reputation": 760, "user_id": 4816308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lDkUFTTPIwE/AAAAAAAAAAI/AAAAAAAAAGE/OZsIpsn7ebU/photo.jpg?sz=128", "display_name": "Artem Nikitin", "link": "https://stackoverflow.com/users/4816308/artem-nikitin"}, "edited": false, "score": 0, "creation_date": 1452972284, "post_id": 34818308, "comment_id": 57403866, "body": "I figured it out. As described here: <a href=\"https://github.com/aws/aws-sdk-go/issues/467\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-go/issues/467</a>. It requires to manually set Content-Length value. After it all working fine."}], "tags": [], "owner": {"reputation": 844, "user_id": 5683782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WJnNR.jpg?s=128&g=1", "display_name": "Michael Willingham", "link": "https://stackoverflow.com/users/5683782/michael-willingham"}, "is_accepted": true, "score": 2, "last_activity_date": 1452885814, "creation_date": 1452885814, "answer_id": 34818308, "question_id": 34813647, "link": "https://stackoverflow.com/questions/34813647/android-app-uploaded-in-device-farm-via-aws-sdk-for-go-never-changed-status-from/34818308#34818308", "title": "Android app uploaded in Device Farm via AWS SDK for Go never changed status from INITIALIZED", "body": "<p>When you call the CreateUpload API, Device Farm will return an \"Upload\" response containing a \"Url\" field.</p>\n\n<p><code>{\n  Upload: {\n    Arn: \"arn:aws:devicefarm:us-west-2:....\",\n    Created: 2016-01-15 14:27:31 +0000 UTC,\n    Name: \"app-name.apk\",\n    Status: \"INITIALIZED\",\n    Type: \"ANDROID_APP\",\n    Url: \"bla-bla-bla\"\n  }\n}</code></p>\n\n<p>The returned url, \"bla-bla-bla\", is a pre-signed S3 url for you to upload your application. Documentation on using a pre-signed url to upload an object: <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/dev/PresignedUrlUploadObject.html\" rel=\"nofollow\">http://docs.aws.amazon.com/AmazonS3/latest/dev/PresignedUrlUploadObject.html</a></p>\n\n<p>Once your application has been uploaded, the app will be processed. The status of your upload will change to \"PROCESSING\" and \"SUCCEEDED\" (or \"FAILED\" if something is wrong). Once it's in \"SUCCEEDED\" status, you can use it to schedule a run.</p>\n"}], "owner": {"reputation": 760, "user_id": 4816308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lDkUFTTPIwE/AAAAAAAAAAI/AAAAAAAAAGE/OZsIpsn7ebU/photo.jpg?sz=128", "display_name": "Artem Nikitin", "link": "https://stackoverflow.com/users/4816308/artem-nikitin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 34818308, "answer_count": 1, "score": 2, "last_activity_date": 1453020731, "creation_date": 1452869243, "last_edit_date": 1453020731, "question_id": 34813647, "link": "https://stackoverflow.com/questions/34813647/android-app-uploaded-in-device-farm-via-aws-sdk-for-go-never-changed-status-from", "title": "Android app uploaded in Device Farm via AWS SDK for Go never changed status from INITIALIZED", "body": "<p>I'm trying to use AWS SDK for Go to automate app runs in AWS Device Farm. But any app that uploaded with Go version of SDK never changed status from \"INITIALIZED\". If I upload them via AWS Console web UI, then all will be fine.</p>\n\n<p><strong>Example of code for upload:</strong>\n<code>\nfunc uploadApp(client *devicefarm.DeviceFarm, appType, projectArn string) string {\n    params := &amp;devicefarm.CreateUploadInput{\n        Name:       aws.String(*appName),\n        ProjectArn: aws.String(projectArn),\n        Type:       aws.String(appType),\n    }\n    resp, err := client.CreateUpload(params)\n    if err != nil {\n        log.Fatal(\"Failed to upload an app because of: \", err.Error())\n    }\n    log.Println(\"Upload ARN:\", *resp.Upload.Arn)\n    return *resp.Upload.Arn\n}\n</code>\n<strong>In response I got something like:</strong><br>\n<code>\n{\n  Upload: {\n    Arn: \"arn:aws:devicefarm:us-west-2:091463382595:upload:c632e325-266b-4bda-a74d-0acec1e2a5ae/9fbbf140-e377-4de9-b7df-dd18a21b2bca\",\n    Created: 2016-01-15 14:27:31 +0000 UTC,\n    Name: \"app-debug-unaligned.apk\",\n    Status: \"INITIALIZED\",\n    Type: \"ANDROID_APP\",\n    Url: \"bla-bla-bla\"\n  }\n}\n</code><br>\nWith time status never changes from \"INITIALIZED\". As I mentioned, apps which run scheduled from UI works fine.</p>\n\n<p>How to figure it out reason of this ? </p>\n\n<p>=======================================     </p>\n\n<h3>Solution:</h3>\n\n<p>1) After <code>CreateUpload</code> it requires to upload a file using pre-signed S3 link in the response<br>\n2) Upload should be executed via HTTP PUT request by received URL with file content in the body<br>\n3) In <code>&amp;devicefarm.CreateUploadInput</code> should be specified <code>ContentType</code>parameter. For PUT request same value for <code>Content-Type</code> header should be used<br>\n4) If PUT request will be send from Go code, then <code>Content-Length</code> header should be set manually </p>\n"}, {"tags": ["html", "go"], "answers": [{"comments": [{"owner": {"reputation": 5895, "user_id": 1279005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c64c420648367c4731d652862fb53d0d?s=128&d=identicon&r=PG", "display_name": "Dmytro Sadovnychyi", "link": "https://stackoverflow.com/users/1279005/dmytro-sadovnychyi"}, "edited": false, "score": 0, "creation_date": 1452938010, "post_id": 34812947, "comment_id": 57393188, "body": "I like this idea, but I&#39;m still looking for solution to get high precision. Tokenizer does not work properly with low buffer size, and precision is too low with high buffer size."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 3, "last_activity_date": 1452867194, "creation_date": 1452867194, "answer_id": 34812947, "question_id": 34812279, "link": "https://stackoverflow.com/questions/34812279/extracting-positional-offset-of-html-node-in-golang/34812947#34812947", "title": "Extracting positional offset of *html.Node in Golang", "body": "<p>Not an answer, but too long for a comment. The following could work to some extent:</p>\n\n<ul>\n<li>Use a <code>Tokenizer</code> and step through each element one by one.</li>\n<li>Wrap your input into a custom reader which records lines and\ncolumn offsets as the Tokenizer reads from it.</li>\n<li>Query your custom reader for the position before and after calling Next()\nto record the approximate position information you need.</li>\n</ul>\n\n<p>This is a bit painful and not <em>too</em> accurate but probably the best you could do.</p>\n"}, {"tags": [], "owner": {"reputation": 5895, "user_id": 1279005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c64c420648367c4731d652862fb53d0d?s=128&d=identicon&r=PG", "display_name": "Dmytro Sadovnychyi", "link": "https://stackoverflow.com/users/1279005/dmytro-sadovnychyi"}, "is_accepted": true, "score": 0, "last_activity_date": 1453537934, "last_edit_date": 1453537934, "creation_date": 1453531852, "answer_id": 34960550, "question_id": 34812279, "link": "https://stackoverflow.com/questions/34812279/extracting-positional-offset-of-html-node-in-golang/34960550#34960550", "title": "Extracting positional offset of *html.Node in Golang", "body": "<p>I come up with solution where we extend (please fix me if there's another way to do it) original HTML package with additional <code>custom.go</code> file with new exported function. This function is able to access unexported <code>data</code> property of <code>Tokenizer</code>, which holds exactly start and end position of current <code>Node</code>. We have to adjust positions after each buffer read. See <code>globalBufDif</code>.</p>\n\n<p>I don't really like that I have to fork the package only to access couple of properties, but seems like this is a Go way.</p>\n\n<pre><code>func parseWithIndexes(p *parser) (map[*Node][2]int, error) {\n    // Iterate until EOF. Any other error will cause an early return.\n    var err error\n    var globalBufDif int\n    var prevEndBuf int\n    var tokenIndex [2]int\n    tokenMap := make(map[*Node][2]int)\n    for err != io.EOF {\n        // CDATA sections are allowed only in foreign content.\n        n := p.oe.top()\n        p.tokenizer.AllowCDATA(n != nil &amp;&amp; n.Namespace != \"\")\n\n        t := p.top().FirstChild\n        for {\n            if t != nil &amp;&amp; t.NextSibling != nil {\n                t = t.NextSibling\n            } else {\n                break\n            }\n        }\n        tokenMap[t] = tokenIndex\n        if prevEndBuf &gt; p.tokenizer.data.end {\n            globalBufDif += prevEndBuf\n        }\n        prevEndBuf = p.tokenizer.data.end\n        // Read and parse the next token.\n        p.tokenizer.Next()\n        tokenIndex = [2]int{p.tokenizer.data.start + globalBufDif, p.tokenizer.data.end + globalBufDif}\n\n        p.tok = p.tokenizer.Token()\n        if p.tok.Type == ErrorToken {\n            err = p.tokenizer.Err()\n            if err != nil &amp;&amp; err != io.EOF {\n                return tokenMap, err\n            }\n        }\n        p.parseCurrentToken()\n    }\n    return tokenMap, nil\n}\n\n// ParseFragmentWithIndexes parses a fragment of HTML and returns the nodes\n// that were found. If the fragment is the InnerHTML for an existing element,\n// pass that element in context.\nfunc ParseFragmentWithIndexes(r io.Reader, context *Node) ([]*Node, map[*Node][2]int, error) {\n    contextTag := \"\"\n    if context != nil {\n        if context.Type != ElementNode {\n            return nil, nil, errors.New(\"html: ParseFragment of non-element Node\")\n        }\n        // The next check isn't just context.DataAtom.String() == context.Data because\n        // it is valid to pass an element whose tag isn't a known atom. For example,\n        // DataAtom == 0 and Data = \"tagfromthefuture\" is perfectly consistent.\n        if context.DataAtom != a.Lookup([]byte(context.Data)) {\n            return nil, nil, fmt.Errorf(\"html: inconsistent Node: DataAtom=%q, Data=%q\", context.DataAtom, context.Data)\n        }\n        contextTag = context.DataAtom.String()\n    }\n    p := &amp;parser{\n        tokenizer: NewTokenizerFragment(r, contextTag),\n        doc: &amp;Node{\n            Type: DocumentNode,\n        },\n        scripting: true,\n        fragment:  true,\n        context:   context,\n    }\n\n    root := &amp;Node{\n        Type:     ElementNode,\n        DataAtom: a.Html,\n        Data:     a.Html.String(),\n    }\n    p.doc.AppendChild(root)\n    p.oe = nodeStack{root}\n    p.resetInsertionMode()\n\n    for n := context; n != nil; n = n.Parent {\n        if n.Type == ElementNode &amp;&amp; n.DataAtom == a.Form {\n            p.form = n\n            break\n        }\n    }\n\n    tokenMap, err := parseWithIndexes(p)\n    if err != nil {\n        return nil, nil, err\n    }\n\n    parent := p.doc\n    if context != nil {\n        parent = root\n    }\n\n    var result []*Node\n    for c := parent.FirstChild; c != nil; {\n        next := c.NextSibling\n        parent.RemoveChild(c)\n        result = append(result, c)\n        c = next\n    }\n    return result, tokenMap, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 5895, "user_id": 1279005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c64c420648367c4731d652862fb53d0d?s=128&d=identicon&r=PG", "display_name": "Dmytro Sadovnychyi", "link": "https://stackoverflow.com/users/1279005/dmytro-sadovnychyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1354, "favorite_count": 0, "accepted_answer_id": 34960550, "answer_count": 2, "score": 2, "last_activity_date": 1453537934, "creation_date": 1452864867, "question_id": 34812279, "link": "https://stackoverflow.com/questions/34812279/extracting-positional-offset-of-html-node-in-golang", "title": "Extracting positional offset of *html.Node in Golang", "body": "<p>How do I can extract positional offset for specific node of already parsed HTML document? For example, for document <code>&lt;div&gt;Hello, &lt;b&gt;World!&lt;/b&gt;&lt;/div&gt;</code> I want to be able to know that offset of <code>World!</code> is <code>15:21</code>. Document may be changed while parsing.</p>\n\n<p>I have a solution to render whole document with special marks, but it's really bad for performance. Any ideas?</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"golang.org/x/net/html\"\n    \"golang.org/x/net/html/atom\"\n    \"log\"\n    \"strings\"\n)\n\nfunc nodeIndexOffset(context *html.Node, node *html.Node) (int, int) {\n    if node.Type != html.TextNode {\n        node = node.FirstChild\n    }\n    originalData := node.Data\n\n    var buf bytes.Buffer\n    node.Data = \"|start|\" + originalData\n    _ = html.Render(&amp;buf, context.FirstChild)\n    start := strings.Index(buf.String(), \"|start|\")\n\n    buf = bytes.Buffer{}\n    node.Data = originalData + \"|end|\"\n    _ = html.Render(&amp;buf, context.FirstChild)\n    end := strings.Index(buf.String(), \"|end|\")\n\n    node.Data = originalData\n    return start, end\n}\n\nfunc main() {\n    s := \"&lt;div&gt;Hello, &lt;b&gt;World!&lt;/b&gt;&lt;/div&gt;\"\n    var context html.Node\n    context = html.Node{\n        Type:     html.ElementNode,\n        Data:     \"body\",\n        DataAtom: atom.Body,\n    }\n    nodes, err := html.ParseFragment(strings.NewReader(s), &amp;context)\n    if err != nil {\n        log.Fatal(err)\n    }\n    for _, node := range nodes {\n        context.AppendChild(node)\n    }\n    world := nodes[0].FirstChild.NextSibling.FirstChild\n    log.Println(\"target\", world)\n    log.Println(nodeIndexOffset(&amp;context, world))\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452864926, "post_id": 34811933, "comment_id": 57366340, "body": "The job of the garbage collection isn&#39;t to free memory. Is it <code>m.Sys</code> you&#39;re concerned about?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1452866404, "post_id": 34811933, "comment_id": 57367262, "body": "Why? That&#39;s how much heap memory you&#39;ve used. Again GC doesn&#39;t free memory, the heap scavenger does. I&#39;d be more concerned that you&#39;ve allocated 2GB of stack."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1452872126, "post_id": 34811933, "comment_id": 57371090, "body": "2.6GB of stacks*, 1000000 stacks, 2.6KB average per stack."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1452873147, "post_id": 34811933, "comment_id": 57371780, "body": "@thwd: Goroutine stacks start at exactly 2K, with no need to grow here either, and the rest is all heap. BTW, those stacks will be reclaimed now when the scavenger runs, so this proc&#39;s RSS will drop back down to the 400-500MB of heap that&#39;s left. I&#39;m actually curios as to what is left on the heap. I assume some normally negligible bookkeeping that only shows up with way too many goroutines."}], "answers": [{"tags": [], "owner": {"reputation": 385, "user_id": 671006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f05d597cc06068b0f1d745d1a11cd6df?s=128&d=identicon&r=PG", "display_name": "KilledKenny", "link": "https://stackoverflow.com/users/671006/killedkenny"}, "is_accepted": true, "score": 2, "last_activity_date": 1452881134, "creation_date": 1452881134, "answer_id": 34817124, "question_id": 34811933, "link": "https://stackoverflow.com/questions/34811933/golang-goroutine-memory-leak/34817124#34817124", "title": "Golang goroutine memory leak", "body": "<p>There is no memory leak in your code. However you do cause a lot of memory to be reserved and that's what you see.</p>\n\n<p>When i look for any kind of leak i prefer to do the test more then once. This is easily done whit your code. Just add:</p>\n\n<pre><code>func init(){\n    for{\n        main()\n    }\n}\n</code></pre>\n\n<p>The new output will reveal that no memory was lost during the run:</p>\n\n<pre><code>Memory Acquired:  2885880\nMemory Used    :  14848\nMemory Acquired:  2594885728\nMemory Used    :  297108312\nMemory Acquired:  2594885728\nMemory Used    :  297108984\nMemory Acquired:  2624143456\nMemory Used    :  297108312\nMemory Acquired:  2624143456\nMemory Used    :  297108984\nMemory Acquired:  2624143456\nMemory Used    :  297108312\nMemory Acquired:  2624143456\nMemory Used    :  297108984\nMemory Acquired:  2624143456\nMemory Used    :  297108312\nMemory Acquired:  2624143456\nMemory Used    :  297108984\nMemory Acquired:  2624143456\nMemory Used    :  297108312\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 2047651, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eb4b591a471ab2bfba93d4ca9a50420e?s=128&d=identicon&r=PG", "display_name": "Hepri", "link": "https://stackoverflow.com/users/2047651/hepri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 0, "accepted_answer_id": 34817124, "answer_count": 1, "score": 2, "last_activity_date": 1452881134, "creation_date": 1452863781, "last_edit_date": 1452864539, "question_id": 34811933, "link": "https://stackoverflow.com/questions/34811933/golang-goroutine-memory-leak", "title": "Golang goroutine memory leak", "body": "<p>I can't understand why memory is not freed. Memory profile shows that almost all of the memory used by <strong>runtime.malg</strong>. If I remove range over channel in DoSomeWork everything works fine.</p>\n\n<p>Here of the output of fmt.Println:</p>\n\n<pre><code>Memory Acquired:  4196600\nMemory Used    :  745192\n\nMemory Acquired:  2651299576\nMemory Used    :  393923440\n</code></pre>\n\n<p>Source code:</p>\n\n<pre><code>func DoSomeWork(work chan int) {\n    for _ = range work {\n    }\n}\n\nfunc main() {\n    k := make(chan int)\n    m := &amp;runtime.MemStats{}\n    runtime.ReadMemStats(m)\n    fmt.Println(\"Memory Acquired: \", m.Sys)\n    fmt.Println(\"Memory Used    : \", m.Alloc)\n\n    wg := new(sync.WaitGroup)\n    // generate a lot of goroutines that reads from channel\n    for i:=0;i&lt;1000000;i++ {\n        wg.Add(1)\n        go func() {\n            DoSomeWork(k)\n            wg.Done()\n        }()\n    }\n\n    close(k)\n    wg.Wait()\n\n    // make GC\n    runtime.GC()\n\n    // show memory after garbage collector\n    runtime.ReadMemStats(m)\n    fmt.Println(\"Memory Acquired: \", m.Sys)\n    fmt.Println(\"Memory Used    : \", m.Alloc)\n}\n</code></pre>\n"}, {"tags": ["ssl", "go", "reverse-proxy"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1452881026, "post_id": 34811905, "comment_id": 57376341, "body": "You&#39;re not showing all the relevant code. Please show a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 431, "user_id": 1683251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6fsxn.jpg?s=128&g=1", "display_name": "MaC", "link": "https://stackoverflow.com/users/1683251/mac"}, "edited": false, "score": 0, "creation_date": 1453216234, "post_id": 34811905, "comment_id": 57498375, "body": "Please, provide all the relevant code. Anyways it seems that you aren&#39;t using NewMultipleHostReverseProxy in this snippet (the one that you usually use for reverse proxy)"}, {"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "edited": false, "score": 0, "creation_date": 1453707961, "post_id": 34811905, "comment_id": 57703191, "body": "Sorry Guys forgot about that part of the code... Added some more code now."}], "owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453712529, "creation_date": 1452863690, "last_edit_date": 1453712529, "question_id": 34811905, "link": "https://stackoverflow.com/questions/34811905/golang-reverseproxy-to-different-ip-doesnt-work", "title": "Golang ReverseProxy to different ip doesn&#39;t work", "body": "<p>i am trying to make my own ReverseProxy in go.\nSo it should connect my Apache Webserver with another Go Webserver.</p>\n\n<p>So when I request \"/\" the proxy should send the request to apache and serve the website of the apache server. \nWhen I request \"/gotest\" it should send the request to the go webserver</p>\n\n<p>But the ReverseProxy and the Apache Webserver should run on different ip-adresses.But all should run with SSL.\nExample: ReverseProxy runs on : 192.168.2.1\n         Apache Server runs on: 192.168.2.5</p>\n\n<p>If both run on same ip but different ports, it works verry well.\nBut when I run Apache on different ip, the reverseproxy get one request and website is shown. But then my reverseproxy doesn't get new reqeusts.</p>\n\n<p>Have anyone an idea what I am doing wrong?</p>\n\n<pre><code>type Proxy struct {\n    listener    net.Listener\n    TlsConfig   *tls.Config //config of the TLS-Connection\n    mux         *http.ServeMux\n    goHandler   http.Handler //Handler to send Requests to GO-Webserver\n    mainHandler http.Handler //Handler to send Requests to the main webserver\n    Host        string       //Host of the Reverse-Proxy\n    Port        int          //Port of the Reverse-Proxy\n}\n\n\n//New returns a new ReverseProxy with the configuration of the given toml file\nfunc New(configPath string) *Proxy {\n\n    if err := common.READCONFIG(configPath); err != nil {\n        log.Fatalf(err.Error())\n    }\n\n    p := &amp;Proxy{\n        mux:  http.NewServeMux(),\n        Host: common.CONFIG.ReverseProxy.Host,\n        Port: common.CONFIG.ReverseProxy.Port,\n    }\n\n    p.goHandler = &amp;httputil.ReverseProxy{\n        Director:      p.directorGo,\n        FlushInterval: 1 * time.Millisecond,\n    }\n\n    p.mainHandler = &amp;httputil.ReverseProxy{\n        Director:      p.directorMain,\n        FlushInterval: 1 * time.Millisecond,\n    }\n\n    pathCert := common.CONFIG.PathCert\n    pathKey := common.CONFIG.PathPrivateKey\n    //Loads the ssl-cert and private-keyn\n    cert, err := tls.LoadX509KeyPair(pathCert, pathKey)\n    if err != nil {\n        common.Log.Critical(\"ReverseProxy: load SSL-Keys: %s\", err)\n    }\n    //Change Transport to avoid ssl-certificate error:\"certificate signed by unknown authority\"\n    http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config{InsecureSkipVerify: true}\n\n    p.TlsConfig = &amp;tls.Config{Certificates: []tls.Certificate{cert}}\n\n    listener, err := net.Listen(\"tcp\",\n        net.JoinHostPort(p.Host, strconv.Itoa(p.Port)))\n\n    if err != nil {\n        common.Log.Critical(\"ReverseProxy: can't listen: %s\", err)\n        os.Exit(1)\n    }\n\n    p.listener = tls.NewListener(listener, p.TlsConfig)\n\n    //Each request should be handled by the proxy\n    p.mux.Handle(\"/\", p)\n\n    return p\n}\n\n//isGoRequest checks if the given Request is for the go-webserver\nfunc (p *Proxy) getProxyAdress() string {\n    return fmt.Sprintf(\"%s:%d\", p.Host, p.Port)\n}\n\n//isGoRequest checks if the given Request is for the go-webserver\nfunc (p *Proxy) isGoRequest(req *http.Request) bool {\n    if strings.Contains(req.URL.Path, common.CONFIG.ReverseProxy.GoUrlPath) {\n        return true\n    } else {\n        return false\n    }\n}\n\n//directorMain modifies the request to a new request for the main-webserver\nfunc (p *Proxy) directorMain(req *http.Request) {\n    mainServer := fmt.Sprintf(\"%s:%d\", common.CONFIG.ReverseProxy.HostMain, common.CONFIG.ReverseProxy.PortMain)\n    req.URL.Scheme = \"https\"\n    req.URL.Host = mainServer\n}\n\n//directorGo modifies the request to a new request for the go-webserver\nfunc (p *Proxy) directorGo(req *http.Request) {\n    goServer := fmt.Sprintf(\"%s:%d\", common.CONFIG.Pointstreamer.Host, common.CONFIG.Pointstreamer.Port)\n    req.URL.Scheme = \"https\"\n    req.URL.Host = goServer\n}\n\n// ServeHTTP implements the http.Handler interface.\nfunc (p *Proxy) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    fmt.Println(req.URL.Path)\n    if p.isGoRequest(req) {\n        p.goHandler.ServeHTTP(rw, req)\n        return\n    }\n    p.mainHandler.ServeHTTP(rw, req)\n}\n\nfunc main() {\n    var configPath = flag.String(\"conf\", \"../../configDevel.toml\", \"Path to the toml config file.\")\n\n    flag.Parse()\n    proxy := New(*configPath)\n\n    httpsServer := &amp;http.Server{\n        Handler:   proxy.mux,\n        TLSConfig: proxy.TlsConfig,\n    }\n    common.Log.Info(\"Server listens on\", proxy.getProxyAdress(), \"Main Redirect\", common.CONFIG.ReverseProxy.HostMain)\n\n    if err := httpsServer.Serve(proxy.listener); err != nil {\n        common.Log.Critical(\"ReverseProxy Server Error:\", err)\n        os.Exit(1)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["arrays", "for-loop", "go", "slice"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 4, "creation_date": 1452861544, "post_id": 34811167, "comment_id": 57364389, "body": "<code>integer</code> is not a Go type. It is <code>int</code> indeed. And <code>int</code> is either 32 or 64 bits depending on the platform, meaning if your slice is large enough to need a 64-bit index, it means you are on a 64-bit platform, so int is effectively the same size as an int64."}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1452861596, "post_id": 34811167, "comment_id": 57364410, "body": "@SirDarius That&#39;s actually an answer not a comment."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 2, "creation_date": 1452861690, "post_id": 34811167, "comment_id": 57364459, "body": "@Grzegorz\u017bur no, the question is whether it is possible to use the <code>int64</code> type as an index, which I don&#39;t address. I merely pointed out that int and int64 are essentially the same in that case, questioning the question&#39;s relevance. Don&#39;t forget that even though int and int64 might have the same size, the spec is very clear that they are considered as distinct types."}, {"owner": {"reputation": 2364, "user_id": 671072, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/08c18df25af21cbdb106d7ecd5295a01?s=128&d=identicon&r=PG", "display_name": "ShuaiYuan", "link": "https://stackoverflow.com/users/671072/shuaiyuan"}, "edited": false, "score": 0, "creation_date": 1452862152, "post_id": 34811167, "comment_id": 57364746, "body": "I&#39;ll accept the answer from icza but the first comment is the most helpful :)"}], "answers": [{"comments": [{"owner": {"reputation": 1063, "user_id": 132012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6734bef1296e6841b89be106c9f8b5?s=128&d=identicon&r=PG", "display_name": "db_", "link": "https://stackoverflow.com/users/132012/db"}, "edited": false, "score": 0, "creation_date": 1578579352, "post_id": 34811441, "comment_id": 105490648, "body": "according to spec, index is always not negative. So, in theory, it should be uint."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1063, "user_id": 132012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6734bef1296e6841b89be106c9f8b5?s=128&d=identicon&r=PG", "display_name": "db_", "link": "https://stackoverflow.com/users/132012/db"}, "edited": false, "score": 0, "creation_date": 1578652328, "post_id": 34811441, "comment_id": 105517066, "body": "@db_ <code>int</code> is the general integer type, and in go you can&#39;t perform operations on values of different type. E.g. if you write <code>j := 3</code>, it will have a type of <code>int</code>, and you could not write <code>i + j</code> without having to convert the index first, e.g. <code>int(i) + j</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1452864215, "last_edit_date": 1452864215, "creation_date": 1452862073, "answer_id": 34811441, "question_id": 34811167, "link": "https://stackoverflow.com/questions/34811167/can-i-make-the-index-int64-in-golangs-for-range-iteration/34811441#34811441", "title": "Can I make the index int64 in golang&#39;s for-range iteration?", "body": "<p>No, the <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow\">spec specifies</a> the type of index to be <code>int</code> if you use a \"for\" statement with a \"range\" clause:</p>\n\n<pre><code>Range expression                          1st value          2nd value\n\narray or slice  a  [n]E, *[n]E, or []E    index    i  int    a[i]       E\nstring          s  string type            index    i  int    see below  rune\nmap             m  map[K]V                key      k  K      m[k]       V\nchannel         c  chan E, &lt;-chan E       element  e  E\n</code></pre>\n\n<p>Nothing you can do about it, and nothing you should do about it. The length of the slice/array will fit into <code>int</code>.</p>\n\n<p>It is not possible to make a slice bigger than max <code>int</code>. Attempting to make a larger slice with a constant expression is a compile-time error:</p>\n\n<pre><code>x := make([]struct{}, 3123456789)\n</code></pre>\n\n<p>Compile-time error: <code>len argument too large in make([]struct {})</code></p>\n\n<p><em>Note: size of <code>int</code> is implementation-specific: it is either 32-bit or 64-bit. The constant expressions here to produce the errors are for 32-bit <code>int</code>s (the Go Playground uses 32-bit <code>int</code>s).</em></p>\n\n<p>If length is a runtime expression, it panics:</p>\n\n<pre><code>i := uint(3123456789)\ny := make([]struct{}, i)\n</code></pre>\n\n<p>Runtime error: <code>panic: runtime error: makeslice: len out of range</code></p>\n\n<p>And length of array types must also fit into <code>int</code>: <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow\">Spec: Array types:</a></p>\n\n<blockquote>\n  <p>The length is part of the array's type; it must evaluate to a non-negative <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow\">constant</a> representable by a value of type <code>int</code>.</p>\n</blockquote>\n\n<p>Attempting to use a larger length is a compile-time error:</p>\n\n<pre><code>var x [3123456789]struct{}\ntype t1 [3123456789]byte\ntype t2 [3123456789]struct{}\n</code></pre>\n\n<p>All compile-time error: <code>array bound is too large</code></p>\n"}], "owner": {"reputation": 2364, "user_id": 671072, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/08c18df25af21cbdb106d7ecd5295a01?s=128&d=identicon&r=PG", "display_name": "ShuaiYuan", "link": "https://stackoverflow.com/users/671072/shuaiyuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2843, "favorite_count": 0, "accepted_answer_id": 34811441, "answer_count": 1, "score": 3, "last_activity_date": 1475315196, "creation_date": 1452861135, "last_edit_date": 1495541213, "question_id": 34811167, "link": "https://stackoverflow.com/questions/34811167/can-i-make-the-index-int64-in-golangs-for-range-iteration", "title": "Can I make the index int64 in golang&#39;s for-range iteration?", "body": "<p>According to the <a href=\"https://github.com/golang/go/wiki/Range\" rel=\"nofollow noreferrer\">spec</a> the </p>\n\n<pre><code>for idx, val range a_slice \n</code></pre>\n\n<p>statement returns <code>idx</code> as an <code>integer</code>. </p>\n\n<p>Since creating a large size slice is <a href=\"https://stackoverflow.com/questions/27647737/maximum-length-of-a-slice-in-go\">possible</a>, is there a way to chance <code>idx</code> to <code>int64</code>?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["string", "go", "type-conversion"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1452859697, "last_edit_date": 1452859697, "creation_date": 1452851950, "answer_id": 34808496, "question_id": 34808465, "link": "https://stackoverflow.com/questions/34808465/how-do-int-to-string-casts-work-in-go/34808496#34808496", "title": "How do int-to-string casts work in Go?", "body": "<p>This is covered in the <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">Spec: Conversions: Conversions to and from a string type:</a></p>\n\n<blockquote>\n  <p>Converting a signed or unsigned integer value to a string type yields a string containing the UTF-8 representation of the integer. Values outside the range of valid Unicode code points are converted to <code>\"\\uFFFD\"</code>.</p>\n</blockquote>\n\n<p>So effectively when you convert a numeric value to <code>string</code>, it can only yield a <code>string</code> having one <code>rune</code> (character). And since Go stores <code>strings</code> as the UTF-8 encoded byte sequences in memory, that is what you will see if you convert your <code>string</code> to <code>[]byte</code>:</p>\n\n<blockquote>\n  <p>Converting a value of a string type to a slice of bytes type yields a slice whose successive elements are the bytes of the string.</p>\n</blockquote>\n\n<p>When you try to conver the <code>0x12345678</code>, <code>0x10000000</code> and <code>0x20000000</code> values to <code>string</code>, since they are outside of the range of valid Unicode code points, as per spec they are converted to <code>\"\\uFFFD\"</code> which in UTF-8 encoding is <code>[]byte{239, 191, 189}</code>; when encoded to hex string:</p>\n\n<pre><code>fmt.Println(hex.EncodeToString([]byte(\"\\uFFFD\"))) // Output: efbfbd\n</code></pre>\n\n<p>Or simply:</p>\n\n<pre><code>fmt.Printf(\"%x\", \"\\uFFFD\") // Output: efbfbd\n</code></pre>\n\n<p>Read the blog post <a href=\"https://blog.golang.org/strings\" rel=\"nofollow\">Strings, bytes, runes and characters in Go</a> for more details about <code>string</code> internals.</p>\n\n<p>And btw since Go 1.5 the Go runtime is implemented (mostly) in Go, so these conversions are now implemented in Go and can be found in the <a href=\"https://golang.org/pkg/runtime/\" rel=\"nofollow\"><code>runtime</code></a> package: <a href=\"https://golang.org/src/runtime/string.go\" rel=\"nofollow\"><code>runtime/string.go</code></a>, look for the <code>intstring()</code> function.</p>\n"}], "owner": {"reputation": 780, "user_id": 783711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe5df40223a35927e1f8d22c63d009d?s=128&d=identicon&r=PG&f=1", "display_name": "tsn", "link": "https://stackoverflow.com/users/783711/tsn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 34808496, "answer_count": 1, "score": 3, "last_activity_date": 1475354078, "creation_date": 1452851801, "last_edit_date": 1475354078, "question_id": 34808465, "link": "https://stackoverflow.com/questions/34808465/how-do-int-to-string-casts-work-in-go", "title": "How do int-to-string casts work in Go?", "body": "<p>I only started Go today, so this may be obvious but I couldn't find anything on it.</p>\n\n<p>What does <code>var x uint64 = 0x12345678; y := string(x)</code> give <code>y</code>?</p>\n\n<p>I know <code>var x uint8 = 65; y := string(x)</code> would give <code>y</code> the byte 65, character <code>A</code>, and common sense would suggest (since types larger than <code>uint8</code> are allowed to be cast to strings) that they would simply be packed in to native byte order (i.e little endian) and assigned to the variable.</p>\n\n<p>This does not seem to be the case:</p>\n\n<pre><code>hex.EncodeToString([]byte(y)) ==&gt; \"efbfbd\"\n</code></pre>\n\n<p>First thought says this is an address with the last byte being left off because of some weird null terminator thingy, but if I allocate two <code>x</code> and <code>y</code> variables with two different values and print them out I get the same result.</p>\n\n<pre><code>var x, x2 uint64 = 0x10000000, 0x20000000\ny, y2 := string(x), string(x2)\nfmt.Println(hex.EncodeToString([]byte(y))) // \"efbfbd\"\nfmt.Println(hex.EncodeToString([]byte(y2))) // \"efbfbd\"\n</code></pre>\n\n<p>Maddeningly I can't find the implementation for the string type anywhere although I probably haven't looked hard enough.</p>\n"}, {"tags": ["go", "deadlock", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 14588, "user_id": 244393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55eb813499c0cf9fd47e95690782bf83?s=128&d=identicon&r=PG", "display_name": "Crast", "link": "https://stackoverflow.com/users/244393/crast"}, "edited": false, "score": 0, "creation_date": 1452897624, "post_id": 34807942, "comment_id": 57384711, "body": "That will result in a panic because he spawns multiple worker goroutines - they will all try to close c"}], "tags": [], "owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "is_accepted": true, "score": 2, "last_activity_date": 1452958499, "last_edit_date": 1452958499, "creation_date": 1452850027, "answer_id": 34807942, "question_id": 34807804, "link": "https://stackoverflow.com/questions/34807804/go-routine-dead-lock/34807942#34807942", "title": "go routine dead lock?", "body": "<p>You never close <code>c</code>, so your <code>for range</code> loop waits forever. Close it like this:</p>\n\n<pre><code>var wg sync.WaitGroup\nfor i := 0; i &lt; clvl; i++ {\n    wg.Add(1)\n    go func(i int) {\n        defer wg.Done()\n        for jdId := range work {\n            time.Sleep(time.Second * 1)\n            c &lt;- fmt.Sprintf(\"done %d\", jdId)\n        }\n    }(i)\n}\n\ngo func() {\n    for i := 0; i &lt; 10; i++ {\n        work &lt;- i\n    }\n\n    close(work)\n    wg.Wait()\n    close(c)\n}()\n</code></pre>\n\n<p><strong>EDIT</strong>: Fixed the panic, thanks Crast</p>\n"}], "owner": {"reputation": 6317, "user_id": 2849157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/81de56159f8a6f58c78e3e7d88d7fbe5?s=128&d=identicon&r=PG&f=1", "display_name": "roger", "link": "https://stackoverflow.com/users/2849157/roger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 34807942, "answer_count": 1, "score": 0, "last_activity_date": 1452958499, "creation_date": 1452849577, "last_edit_date": 1452849976, "question_id": 34807804, "link": "https://stackoverflow.com/questions/34807804/go-routine-dead-lock", "title": "go routine dead lock?", "body": "<p>I am new to <code>golang</code>, and I am puzzled with this deadlock (<a href=\"http://play.golang.org/p/1CjQrnyQzQ\" rel=\"nofollow\">run here</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"time\"\n)\n\nfunc main() {\n    c := make(chan string)\n    work := make(chan int, 1)\n    clvl := runtime.NumCPU()\n    count := 0\n    for i := 0; i &lt; clvl; i++ {\n        go func(i int) {\n            for jdId := range work {\n                time.Sleep(time.Second * 1)\n                c &lt;- fmt.Sprintf(\"done %d\", jdId)\n            }\n        }(i)\n    }\n\n    go func() {\n        for i := 0; i &lt; 10; i++ {\n            work &lt;- i\n        }\n\n        close(work)\n    }()\n\n    for resp := range c {\n        fmt.Println(resp, count)\n        count += 1\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1452851502, "last_edit_date": 1452851502, "creation_date": 1452850011, "answer_id": 34807938, "question_id": 34807802, "link": "https://stackoverflow.com/questions/34807802/is-it-always-safe-to-include-err-error-in-the-response/34807938#34807938", "title": "Is it always safe to include err.Error() in the response?", "body": "<p>Effectively you answered your own question: you pointed out it may contain sensitive information which means it is <strong>not</strong> always safe to include them in responses visible to the users.</p>\n\n<p>It may also contain information related to your implementation (e.g. package names, type names, call hierarchy), and also configuration data (e.g. server name, database name, user names etc.), potentially exposing private and sensitive architecture and business information.</p>\n\n<p>Think about it: you're a package author and you create the <code>error</code> values (error messages) returned by your functions / methods. You create descriptive error messages describing why a requested function cannot complete normally, <em>intended for the callers of that function/method</em> (the developers), and <em>not</em> for the end users - who shouldn't know what's going on under the hood.</p>\n\n<p><code>error.Error()</code> messages are for the developers. They are also useful during testing. And they are indispensable for hunting down bugs. You should not show them to the users, instead log them to which you have access, and provide a more general or a user friendly error message to the users, ensuring them that the dev team has been notified and are looking into the problem. Showing original error messages may cause confusion in inexperienced users, and may raise security issues.</p>\n"}, {"tags": [], "owner": {"reputation": 881, "user_id": 1624112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cc1cL.jpg?s=128&g=1", "display_name": "Specode", "link": "https://stackoverflow.com/users/1624112/specode"}, "is_accepted": false, "score": 1, "last_activity_date": 1452850064, "creation_date": 1452850064, "answer_id": 34807958, "question_id": 34807802, "link": "https://stackoverflow.com/questions/34807802/is-it-always-safe-to-include-err-error-in-the-response/34807958#34807958", "title": "Is it always safe to include err.Error() in the response?", "body": "<p>The best way is to write to the error log, And custom database error info for return.</p>\n\n<p>like:</p>\n\n<pre><code>var (\n    ErrEventNotFound = \"Event not found.\"\n)\n\nerr := Db.Find(&amp;event, id).Error\nif err != nil {\n    // Log to file\n    c.JSON(500, ErrEventNotFound)\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 1347, "user_id": 1559202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3dabf6305a8fd64f9c020d2257263fbb?s=128&d=identicon&r=PG", "display_name": "John Kenn", "link": "https://stackoverflow.com/users/1559202/john-kenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 34807938, "answer_count": 2, "score": 2, "last_activity_date": 1452851502, "creation_date": 1452849572, "question_id": 34807802, "link": "https://stackoverflow.com/questions/34807802/is-it-always-safe-to-include-err-error-in-the-response", "title": "Is it always safe to include err.Error() in the response?", "body": "<p>Example:</p>\n\n<pre><code>err := Db.Find(&amp;event, id).Error\nif err != nil {\n    c.JSON(500, err.Error())\n    return\n}\n</code></pre>\n\n<p>I'm worried that it might include sensitive information. Example: when connecting to a database and the db credentials are invalid, I'm worried that the error message might be something like: \"invalid username: sample and password: xxx\"</p>\n"}]